         TITLE '************** IDCRS02: IDCAMS RESETCAT ROUTINE ********00001000
               *********'                                               00002000
IDCRS02  CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IDCRS02   77.115'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         USING @PSTART,@12                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@10                                    0001 00017000
         USING @PSTART+12285,@09                                   0001 00018000
         USING @DATD,@08  DATA BASE REGISTER                            00019000
         L     @15,@SIZDATD  SIZE OF AUTOMATIC DATA                     00020000
         LA    @15,0(0,@15)  CLEAR SUBPOOL                              00021000
         STM   @09,@12,RS02RG09(REG6)  SAVE BASE REGISTERS              00022000
*        RETURN CODE(REG15);  /*REG 15 HAS LENGTH OF AUTO DATA*/   0297 00023000
         L     @14,12(,@13)                                        0297 00024000
         LM    @00,@12,20(@13)                                     0297 00025000
         BR    @14                                                 0297 00026000
*/********************************************************************/ 00027000
*/*                                                                  */ 00028000
*/*            RESETCAT LOCAL DECLARATIONS                           */ 00029000
*/*                                                                  */ 00030000
*/********************************************************************/ 00031000
*                                                                  0298 00032000
*DCL MODID CHAR(4) CONSTANT('RS02');   /*MODID FOR UEPIL             */ 00033000
*                                                                  0298 00034000
*DCL                                                               0299 00035000
*   1 PATCH    CHAR(800)               /*PATCH AREA                  */ 00036000
*              LOCAL STATIC BDY(WORD), /* 5 PERCENT                  */ 00037000
*     2 *      CHAR(36)                /*PATCHAREA                   */ 00038000
*              INIT('PATCHAREA 800 BYTES LAST USED 000000'), /*ID    */ 00039000
*     2 *(764) CHAR(1)                 /*FORMAT UNUSED AREA          */ 00040000
*              INIT((764)'00'X);       /*WITH ZEROS                  */ 00041000
*  DECLARE                                                         0300 00042000
*      AIXNR    CHAR(1) CONSTANT('2'), /*AIX NONRESET ASSOC TBL ID   */ 00043000
*      CLNR     CHAR(1) CONSTANT('1'), /*CLUSTER NONRESET ASSOC ID   */ 00044000
*      NV       CHAR(1) CONSTANT('3'); /*GDG DATA SET ASSOC TBL ID   */ 00045000
*  DECLARE                                                         0301 00046000
*      EXTRAB   FIXED(15) CONSTANT(4); /* EXTENSION RAB              */ 00047000
*      /**************************************************************/ 00048000
*      /*                                                            */ 00049000
*      /* THE FOLLOWING TABLES ARE USED BY ASSOC AND ITS             */ 00050000
*      /* SUBPROCESSORS TO PROCESS A SET OF RECORDS. ONE TABLE       */ 00051000
*      /* FOR EACH SET OF RECORDS TO BE PROCESSED. EACH TABLE        */ 00052000
*      /* CONTAINS ALL VALID RECORD TYPES FOR THIS SET OF RECORDS    */ 00053000
*      /* PLUS WHETHER THAT TYPE SHOULD BE READ AND SCANNED          */ 00054000
*      /* AND VERIFIED. IT ALSO CONTAINS THE RAB TO BE USED          */ 00055000
*      /* IN DOING THE READ.                                         */ 00056000
*      /*                                                            */ 00057000
*      /* NOTE * THERE IS A DEPENDENCY THAT THE RAB SPECIFIED FOR    */ 00058000
*      /*     THE FIRST SUBTYPE WITHIN THE SET OF RECORDS (I.E., THE */ 00059000
*      /*     BASE RECORD) BE UNIQUE FOR THAT SET OF RECORDS.        */ 00060000
*      /*                                                            */ 00061000
*      /**************************************************************/ 00062000
*                                                                  0302 00063000
*  DECLARE                                                         0302 00064000
*    1 ASSOCC  BDY(WORD) STATIC LOCAL, /*CLUSTER TABLE               */ 00065000
*      2 *        CHAR(1)   INIT('C'), /*  ID = C                    */ 00066000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00067000
*      2 *        FIXED(15) INIT(7),   /*  7 ENTRIES                 */ 00068000
*      2 ASSOCC1  CHAR(4),             /*CLUSTER                     */ 00069000
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */ 00070000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00071000
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */ 00072000
*      2 ASSOCC2  CHAR(4),             /*DATA                        */ 00073000
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */ 00074000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00075000
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */ 00076000
*      2 ASSOCC3  CHAR(4),             /*INDEX                       */ 00077000
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */ 00078000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00079000
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */ 00080000
*      2 ASSOCC4  CHAR(4),             /*EXTENSION                   */ 00081000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00082000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00083000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00084000
*      2 ASSOCC5  CHAR(4),             /*PATH                        */ 00085000
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */ 00086000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00087000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00088000
*      2 ASSOCC6  CHAR(4),             /*ALTERNATEINDEX              */ 00089000
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */ 00090000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00091000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00092000
*      2 ASSOCC7  CHAR(4),             /*UPGRADE                     */ 00093000
*        3 *        CHAR(1) INIT('Y'), /*  RECORD TYPE = Y           */ 00094000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00095000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00096000
*                                                                  0302 00097000
*  DECLARE                                                         0303 00098000
*    1 ASSOG   BDY(WORD) STATIC LOCAL, /*ALTERNATEINDEX TABLE        */ 00099000
*      2 *        CHAR(1)   INIT('G'), /*  ID = G                    */ 00100000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00101000
*      2 *        FIXED(15) INIT(6),   /*  6 ENTRIES                 */ 00102000
*      2 ASSOG1   CHAR(4),             /*ALTERNATEINDEX              */ 00103000
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */ 00104000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00105000
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */ 00106000
*      2 ASSOG2   CHAR(4),             /*DATA                        */ 00107000
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */ 00108000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00109000
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */ 00110000
*      2 ASSOG3   CHAR(4),             /*INDEX                       */ 00111000
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */ 00112000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00113000
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */ 00114000
*      2 ASSOG4   CHAR(4),             /*EXTENSION                   */ 00115000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00116000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00117000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00118000
*      2 ASSOG5   CHAR(4),             /*PATH                        */ 00119000
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */ 00120000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00121000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00122000
*      2 ASSOG6   CHAR(4),             /*CLUSTER                     */ 00123000
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */ 00124000
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */ 00125000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00126000
*  DECLARE                                                         0304 00127000
*    1 ASSOR   BDY(WORD) STATIC LOCAL, /*PATH TABLE                  */ 00128000
*      2 *        CHAR(1)   INIT('R'), /*  ID = R                    */ 00129000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00130000
*      2 *        FIXED(15) INIT(6),   /*  6 ENTRIES                 */ 00131000
*      2 ASSOR1   CHAR(4),             /*PATH                        */ 00132000
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */ 00133000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00134000
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */ 00135000
*      2 ASSOR2   CHAR(4),             /*EXTENSION                   */ 00136000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00137000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00138000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00139000
*      2 ASSOR3   CHAR(4),             /*CLUSTER                     */ 00140000
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */ 00141000
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */ 00142000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00143000
*      2 ASSOR4   CHAR(4),             /*DATA                        */ 00144000
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */ 00145000
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */ 00146000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00147000
*      2 ASSOR5   CHAR(4),             /*INDEX                       */ 00148000
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */ 00149000
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */ 00150000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00151000
*      2 ASSOR6   CHAR(4),             /*ALTERNATEINDEX              */ 00152000
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */ 00153000
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */ 00154000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00155000
*  DECLARE                                                         0305 00156000
*    1 ASSOY   BDY(WORD) STATIC LOCAL, /*UPGRADE TABLE               */ 00157000
*      2 *        CHAR(1)   INIT('Y'), /*  ID = Y                    */ 00158000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00159000
*      2 *        FIXED(15) INIT(4),   /*  4 ENTRIES                 */ 00160000
*      2 ASSOY1   CHAR(4),             /*UPGRADE                     */ 00161000
*        3 *        CHAR(1) INIT('Y'), /*  RECORD TYPE = Y           */ 00162000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00163000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00164000
*      2 ASSOY2   CHAR(4),             /*EXTENSION                   */ 00165000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00166000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00167000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00168000
*      2 ASSOY3   CHAR(4),             /*DATA                        */ 00169000
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */ 00170000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00171000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00172000
*      2 ASSOY4   CHAR(4),             /*INDEX                       */ 00173000
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */ 00174000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00175000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00176000
*  DECLARE                                                         0306 00177000
*    1 ASSOA   BDY(WORD) STATIC LOCAL, /*NON-VSAM TABLE              */ 00178000
*      2 *        CHAR(1)   INIT('A'), /*  ID = A                    */ 00179000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00180000
*      2 *        FIXED(15) INIT(4),   /*  4 ENTRIES                 */ 00181000
*      2 ASSOA1   CHAR(4),             /*NON-VSAM                    */ 00182000
*        3 *        CHAR(1) INIT('A'), /*  RECORD TYPE = A           */ 00183000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00184000
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */ 00185000
*      2 ASSOA2   CHAR(4),             /*EXTENSION                   */ 00186000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00187000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00188000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00189000
*      2 ASSOA3   CHAR(4),             /*ALIAS                       */ 00190000
*        3 *        CHAR(1) INIT('X'), /*  RECORD TYPE = X           */ 00191000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00192000
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */ 00193000
*      2 ASSOA4   CHAR(4),             /*GDG BASE                    */ 00194000
*        3 *        CHAR(1) INIT('B'), /*  RECORD TYPE = B           */ 00195000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE - DELETE IF FOUND  */ 00196000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00197000
*  DECLARE                                                         0307 00198000
*    1 ASSOB   BDY(WORD) STATIC LOCAL, /*GDG BASE TABLE              */ 00199000
*      2 *        CHAR(1)   INIT('B'), /*  ID = B                    */ 00200000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00201000
*      2 *        FIXED(15) INIT(3),   /*  3 ENTRIES                 */ 00202000
*      2 ASSOB1   CHAR(4),             /*GDG BASE                    */ 00203000
*        3 *        CHAR(1) INIT('B'), /*  RECORD TYPE = B           */ 00204000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00205000
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */ 00206000
*      2 ASSOB2   CHAR(4),             /*EXTENSION                   */ 00207000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00208000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00209000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00210000
*      2 ASSOB3   CHAR(4),             /*NON-VSAM                    */ 00211000
*        3 *        CHAR(1) INIT('A'), /*  RECORD TYPE = A           */ 00212000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00213000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00214000
*  DECLARE                                                         0308 00215000
*    1 ASSO3A  BDY(WORD) STATIC LOCAL EXTERNAL,                    0308 00216000
*                                      /*GDG DATA SET ENTRY TABLE    */ 00217000
*      2 *        CHAR(1)   INIT('3'), /*  ID = 3                    */ 00218000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00219000
*      2 *        FIXED(15) INIT(4),   /*  4 ENTRIES                 */ 00220000
*      2 ASSO3A1  CHAR(4),             /*NON-VSAM                    */ 00221000
*        3 *        CHAR(1) INIT('A'), /*  RECORD TYPE = A           */ 00222000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00223000
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */ 00224000
*      2 ASSO3A2  CHAR(4),             /*EXTENSION                   */ 00225000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00226000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00227000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00228000
*      2 ASSO3A3  CHAR(4),             /*ALIAS                       */ 00229000
*        3 *        CHAR(1) INIT('X'), /*  RECORD TYPE = X           */ 00230000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00231000
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */ 00232000
*      2 ASSO3A4  CHAR(4),             /*GDG BASE                    */ 00233000
*        3 *        CHAR(1) INIT('B'), /*  RECORD TYPE = B           */ 00234000
*        3 *        CHAR(1) INIT('90'X), /*READ-EXIST                */ 00235000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00236000
*  DECLARE                                                         0309 00237000
*    1 ASSOU   BDY(WORD) STATIC LOCAL, /*USERCATALOG TABLE           */ 00238000
*      2 *        CHAR(1)   INIT('A'), /*  ID = U                    */ 00239000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00240000
*      2 *        FIXED(15) INIT(3),   /*  3 ENTRIES                 */ 00241000
*      2 ASSOU1   CHAR(4),             /*USERCATALOG                 */ 00242000
*        3 *        CHAR(1) INIT('U'), /*  RECORD TYPE = U           */ 00243000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00244000
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */ 00245000
*      2 ASSOU2   CHAR(4),             /*EXTENSION                   */ 00246000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00247000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00248000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00249000
*      2 ASSOU3   CHAR(4),             /*ALIAS                       */ 00250000
*        3 *        CHAR(1) INIT('X'), /*  RECORD TYPE = X           */ 00251000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00252000
*        3 *        FIXED(15) INIT(3); /*  RAB3                      */ 00253000
*  DECLARE                                                         0310 00254000
*    1 ASSOV   BDY(WORD) STATIC LOCAL, /*VOLUME TABLE                */ 00255000
*      2 *        CHAR(1)   INIT('V'), /*  ID = V                    */ 00256000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00257000
*      2 *        FIXED(15) INIT(2),   /*  2 ENTRIES                 */ 00258000
*      2 ASSOV1   CHAR(4),             /*VOLUME                      */ 00259000
*        3 *        CHAR(1) INIT('V'), /*  RECORD TYPE = V           */ 00260000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00261000
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */ 00262000
*      2 ASSOV2   CHAR(4),             /*EXTENSION                   */ 00263000
*        3 *        CHAR(1) INIT('W'), /*  RECORD TYPE = W           */ 00264000
*        3 *        CHAR(1) INIT('E0'X), /*READ-SCAN-VERIFY          */ 00265000
*        3 *        FIXED(15) INIT(4); /*  RAB4                      */ 00266000
*  DECLARE                                                         0311 00267000
*    1 ASSO1C BDY(WORD) STATIC LOCAL,  /*CLUSTER TABLE - NON-RESET   */ 00268000
*      2 *        CHAR(1)   INIT('1'), /*  ID = 1                    */ 00269000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00270000
*      2 *        FIXED(15) INIT(7),   /*  7 ENTRIES                 */ 00271000
*      2 ASSO1C1 CHAR(4),              /*CLUSTER                     */ 00272000
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */ 00273000
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */ 00274000
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */ 00275000
*      2 ASSO1C2 CHAR(4),              /*DATA                        */ 00276000
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */ 00277000
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */ 00278000
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */ 00279000
*      2 ASSO1C3 CHAR(4),              /*INDEX                       */ 00280000
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */ 00281000
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */ 00282000
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */ 00283000
*      2 ASSO1C4 CHAR(4),              /*EXTENSION                   */ 00284000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00285000
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */ 00286000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00287000
*      2 ASSO1C5 CHAR(4),              /*PATH                        */ 00288000
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */ 00289000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00290000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00291000
*      2 ASSO1C6 CHAR(4),              /*ALTERNATEINDEX              */ 00292000
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */ 00293000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00294000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00295000
*      2 ASSO1C7 CHAR(4),              /*UPGRADE                     */ 00296000
*        3 *        CHAR(1) INIT('Y'), /*  RECORD TYPE = Y           */ 00297000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00298000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00299000
*                                                                  0311 00300000
*  DECLARE                                                         0312 00301000
*    1 ASSO2G  BDY(WORD) STATIC LOCAL, /*ALTERNATEINDEX TBL - NRESET */ 00302000
*      2 *        CHAR(1)   INIT('2'), /*  ID = 2                    */ 00303000
*      2 *        CHAR(1),             /*  UNUSED                    */ 00304000
*      2 *        FIXED(15) INIT(6),   /*  6 ENTRIES                 */ 00305000
*      2 ASSO2G1  CHAR(4),             /*ALTERNATEINDEX              */ 00306000
*        3 *        CHAR(1) INIT('G'), /*  RECORD TYPE = G           */ 00307000
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */ 00308000
*        3 *        FIXED(15) INIT(1), /*  RAB1                      */ 00309000
*      2 ASSO2G2  CHAR(4),             /*DATA                        */ 00310000
*        3 *        CHAR(1) INIT('D'), /*  RECORD TYPE = D           */ 00311000
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */ 00312000
*        3 *        FIXED(15) INIT(2), /*  RAB2                      */ 00313000
*      2 ASSO2G3  CHAR(4),             /*INDEX                       */ 00314000
*        3 *        CHAR(1) INIT('I'), /*  RECORD TYPE = I           */ 00315000
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */ 00316000
*        3 *        FIXED(15) INIT(3), /*  RAB3                      */ 00317000
*      2 ASSO2G4  CHAR(4),             /*EXTENSION                   */ 00318000
*        3 *        CHAR(1) INIT('E'), /*  RECORD TYPE = E           */ 00319000
*        3 *        CHAR(1) INIT('C0'X), /*READ-SCAN                 */ 00320000
*        3 *        FIXED(15) INIT(4), /*  RAB4                      */ 00321000
*      2 ASSO2G5  CHAR(4),             /*PATH                        */ 00322000
*        3 *        CHAR(1) INIT('R'), /*  RECORD TYPE = R           */ 00323000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE                    */ 00324000
*        3 *        FIXED(15),         /*  UNUSED                    */ 00325000
*      2 ASSO2G6  CHAR(4),             /*CLUSTER                     */ 00326000
*        3 *        CHAR(1) INIT('C'), /*  RECORD TYPE = C           */ 00327000
*        3 *        CHAR(1) INIT('00'X), /*IGNORE IT                 */ 00328000
*        3 *        FIXED(15);         /*  UNUSED                    */ 00329000
*/********************************************************************/ 00330000
*/*                                                                  */ 00331000
*/* PROCEDURE NAME - ASSOC                                           */ 00332000
*/*                                                                  */ 00333000
*/* FUNCTION -                                                       */ 00334000
*/*    THIS SEGMENT CONTROLS THE CHECKING OF ALL CONTROL INTERVAL    */ 00335000
*/*    NUMBERS (CINS) IN ALL RECORDS BEING RESET. IT FURTHER         */ 00336000
*/*    ENSURES THAT A COMPLETE SET OF RECORDS IS RESET. FINALLY,     */ 00337000
*/*    THE VOLUMES BEING RESET ARE CHECKED TO ENSURE THAT THERE      */ 00338000
*/*    ARE NO CONFLICTING SPACE REQUESTS.                            */ 00339000
*/*                                                                  */ 00340000
*/* INPUT -                                                          */ 00341000
*/*    PRIMARY INPUT CONSISTS OF THE WORKFILE RECORDS.               */ 00342000
*/*                                                                  */ 00343000
*/* OUTPUT -                                                         */ 00344000
*/*    ALL CINS IN THE LKR RECORDS HAVE BEEN UPDATE IF               */ 00345000
*/*    REASSIGNMENT TOOK PLACE.                                      */ 00346000
*/*                                                                  */ 00347000
*/********************************************************************/ 00348000
*      GENERATE;                                                   0313 00349000
         DS    0F                                                       00350000
NAME0002 DC    CL8'ASSOC'                                               00351000
*ASSOC: PROCEDURE                                                  0314 00352000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0314 00353000
*                                                                  0314 00354000
         B     @PB00002                                            0314 00355000
ASSOC    DS    0H                                                  0315 00356000
*      GENERATE REFS(RS02RG08, REG6);                              0315 00357000
*                                                                  0315 00358000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          00359000
         LR    @15,@13  OLD SAVE AREA                                   00360000
         LA    @13,72(@13)  NEW SAVE AREA                               00361000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     00362000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        00363000
         ENTRY ASSOC  ENTRY POINT                                       00364000
         LM    @08,@12,RS02RG08(REG6)  PRIME BASE AND DATA REGS         00365000
         MVC   0(4,@15),NAME0002  PROCNAME TO REGSAVE                   00366000
*        OLDERID2 = NEWERID2;                                      0316 00367000
         L     @07,GDTTR2(,REG5)                                   0316 00368000
         MVC   @TS00001(95),NEWERID2(@07)                          0316 00369000
         MVC   OLDERID2(95,@07),@TS00001                           0316 00370000
*        NEWID2 = 'RSAS';                                          0317 00371000
*                                                                  0317 00372000
         MVC   NEWID2(4,@07),@CC03741                              0317 00373000
*        /************************************************************/ 00374000
*        /*                                                          */ 00375000
*        /* INITIALIZATION - CLEAR WORKFILE GRAB                     */ 00376000
*        /*                                                          */ 00377000
*        /************************************************************/ 00378000
*                                                                  0318 00379000
*        RSGRABCU = ADDR(GRABSWF);                                 0318 00380000
         L     @07,RSIOTBL(,REG6)                                  0318 00381000
         ST    @07,RSGRABCU(,REG6)                                 0318 00382000
*        GRABAFLS = ''B;                                           0319 00383000
*                                                                  0319 00384000
         XC    GRABAFLS(2,@07),GRABAFLS(@07)                       0319 00385000
*        DO;                                                       0320 00386000
*          RSRECREQ = ''B;                                         0321 00387000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0321 00388000
*          RSRTERM = ON;     /* TERMRCD */                         0322 00389000
         OI    RSRTERM(REG6),B'00000010'                           0322 00390000
*          RSRWF = ON;       /* WORKFILE */                        0323 00391000
*                                                                  0323 00392000
         OI    RSRWF(REG6),B'10000000'                             0323 00393000
*        /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT             */ 00394000
*        CALL RECMGMT;                                             0324 00395000
         L     @15,@CV03458                                        0324 00396000
         BALR  @14,@15                                             0324 00397000
*          RFY RTNREG RSTD;                                        0325 00398000
*          TESTRC = RTNREG;                                        0326 00399000
         STH   RTNREG,TESTRC(,REG6)                                0326 00400000
*          RFY RTNREG UNRSTD;                                      0327 00401000
*        END;                                                      0328 00402000
*                                                                  0328 00403000
*        /************************************************************/ 00404000
*        /*                                                          */ 00405000
*        /* INITIALIZATION - SET UP THE LENGTH AND SIZE OF           */ 00406000
*        /* THE CITAB, DITAB, AND PTWORK                             */ 00407000
*        /*                                                          */ 00408000
*        /************************************************************/ 00409000
*                                                                  0329 00410000
*        RSPTWKLN = LENGTH(PTWORK);                                0329 00411000
         MVC   RSPTWKLN(4,REG6),@CF03934                           0329 00412000
*        RSPTWKUG = POOL10;                                        0330 00413000
*                                                                  0330 00414000
         MVC   RSPTWKUG(4,REG6),@CC00903                           0330 00415000
*        RSGCITLN = LENGTH(GCITS);                                 0331 00416000
         LA    @07,4080                                            0331 00417000
         ST    @07,RSGCITLN(,REG6)                                 0331 00418000
*        RSGCITEN = LENGTH(CITABE);                                0332 00419000
         MVC   RSGCITEN(2,REG6),@CH00931                           0332 00420000
*        RSGCITUG = POOL10;                                        0333 00421000
*                                                                  0333 00422000
         MVC   RSGCITUG(4,REG6),@CC00903                           0333 00423000
*        RSGDITLN = LENGTH(GDITS);                                 0334 00424000
         ST    @07,RSGDITLN(,REG6)                                 0334 00425000
*        RSGDITEN = LENGTH(DITABE);                                0335 00426000
         MVC   RSGDITEN(2,REG6),@CH00471                           0335 00427000
*        RSGDITUG = POOL10;                                        0336 00428000
*                                                                  0336 00429000
         MVC   RSGDITUG(4,REG6),@CC00903                           0336 00430000
*        /************************************************************/ 00431000
*        /*                                                          */ 00432000
*        /* FOR EACH RESET CRA VOLUME, LOCATE THE VOLUME RECORD      */ 00433000
*        /* AND THEN FO TO PROCTYPE TO ENSURE THAT THE BASE V        */ 00434000
*        /* RECORD IS O.K. THIS SCAN WILL VERIFY THE V AND ITS       */ 00435000
*        /* EXTENSIONS; IT WILL NOT VERIFY THE DATA SET              */ 00436000
*        /* DIRECTORIES (DSDIRS).                                    */ 00437000
*        /*                                                          */ 00438000
*        /************************************************************/ 00439000
*                                                                  0337 00440000
*        RSASSTBL = ADDR(ASSOV);       /*USE VOLUME ASSOC TABLE      */ 00441000
         LA    @07,ASSOV                                           0337 00442000
         ST    @07,RSASSTBL(,REG6)                                 0337 00443000
*        RSSRNSCN = OFF;               /*SET TO START SCAN OF RESVOL */ 00444000
         NI    RSSRNSCN(REG6),B'10111111'                          0338 00445000
*        RFY RESVOL BASED(RSENTPT);                                0339 00446000
*        RFY VOLSERTB BASED(RSVTBENT);                             0340 00447000
*                                                                  0340 00448000
* VOLSRCHK:                                                        0341 00449000
*        DO UNTIL(RSENTPT = 0);        /*CHECK EACH RESET VOLUME     */ 00450000
*                                                                  0341 00451000
VOLSRCHK DS    0H                                                  0341 00452000
@DL00341 DS    0H                                                  0342 00453000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST           */ 00454000
*          CALL IDCRS5SR('N','A',RSENTPT,NULLPTR);                 0342 00455000
         MVC   @AL00001(16),@AL00342                               0342 00456000
         LA    @07,RSENTPT(,REG6)                                  0342 00457000
         ST    @07,@AL00001+8                                      0342 00458000
         L     @15,@CV03445                                        0342 00459000
         LA    @01,@AL00001                                        0342 00460000
         BALR  @14,@15                                             0342 00461000
*                                      /* GET NEXT RESET VOLSER      */ 00462000
*                                                                  0343 00463000
*        /************************************************************/ 00464000
*        /*                                                          */ 00465000
*        /*     PROCESS ALL RESET VOLUMES.                           */ 00466000
*        /*       ALLOW FOR NO VOLUME RECORD. THIS OCCURS WHEN A CRA */ 00467000
*        /*       IS BEING RESET AND NO VOLUME RECORD WAS FOUND IN   */ 00468000
*        /*       THE CRA.                                           */ 00469000
*        /*                                                          */ 00470000
*        /************************************************************/ 00471000
*                                                                  0343 00472000
*          IF RSENTPT ^= 0 & RESVLBAD = OFF THEN                   0343 00473000
         L     @07,RSENTPT(,REG6)                                  0343 00474000
         LTR   @07,@07                                             0343 00475000
         BZ    @RF00343                                            0343 00476000
         TM    RESVLBAD(@07),B'00010000'                           0343 00477000
         BNZ   @RF00343                                            0343 00478000
*            DO;                                                   0344 00479000
*              RSCRVL = ADDR(RESVLSER);                            0345 00480000
         LA    @07,RESVLSER(,@07)                                  0345 00481000
         ST    @07,RSCRVL(,REG6)                                   0345 00482000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNVLST       */ 00483000
*              CALL IDCRS5SV(RSVTBENT,RSCRVL);                     0346 00484000
         LA    @07,RSVTBENT(,REG6)                                 0346 00485000
         ST    @07,@AL00001                                        0346 00486000
         LA    @07,RSCRVL(,REG6)                                   0346 00487000
         ST    @07,@AL00001+4                                      0346 00488000
         L     @15,@CV03444                                        0346 00489000
         LA    @01,@AL00001                                        0346 00490000
         BALR  @14,@15                                             0346 00491000
*                                      /*LOCATE THE VOLUME RECORD    */ 00492000
*                                                                  0347 00493000
*        /************************************************************/ 00494000
*        /*                                                          */ 00495000
*        /*     GET THE VOLUME RECORD                                */ 00496000
*        /*                                                          */ 00497000
*        /************************************************************/ 00498000
*                                                                  0347 00499000
*              GRABCURR = GRABRAB1;    /* USE RAB 1                  */ 00500000
*                                                                  0347 00501000
         L     @07,RSGRABCU(,REG6)                                 0347 00502000
         L     @04,GRABRAB1(,@07)                                  0347 00503000
         ST    @04,GRABCURR(,@07)                                  0347 00504000
*              DO;                                                 0348 00505000
*                RSRTYPE = ''B;                                    0349 00506000
         MVI   RSRTYPE(REG6),X'00'                                 0349 00507000
*                RSRGET = ON;      /* GETRCD  */                   0350 00508000
         OI    RSRGET(REG6),B'10000000'                            0350 00509000
*                RSRUPD = ON;      /* UPDATE  */                   0351 00510000
         OI    RSRUPD(REG6),B'00001000'                            0351 00511000
*                RSRDS = ''B;                                      0352 00512000
         NI    RSRDS(REG6),B'00011111'                             0352 00513000
*                RSRWF = ON;       /* WORKFILE  */                 0353 00514000
*                RSRDIR = ON;      /* DIRECT  */                   0354 00515000
*                RSRKEY = ON;      /* KEY  */                      0355 00516000
         OI    RSRWF(REG6),B'10010100'                             0355 00517000
*                RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/           0356 00518000
         OI    RSVIAFCR(REG6),B'10000000'                          0356 00519000
*                RSVIACRA = VOLSRSER; /*SET VOLSER */              0357 00520000
         L     @07,RSVTBENT(,REG6)                                 0357 00521000
         MVC   RSVIACRA(6,REG6),VOLSRSER(@07)                      0357 00522000
*                RSVIACIN = VOLSRCI; /*SET CI NUMBER */            0358 00523000
*                                                                  0358 00524000
         MVC   RSVIACIN(3,REG6),VOLSRCI+1(@07)                     0358 00525000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA        */ 00526000
*              CALL GETVIA;                                        0359 00527000
         L     @15,@CV03442                                        0359 00528000
         BALR  @14,@15                                             0359 00529000
*              END;                                                0360 00530000
*                                                                  0360 00531000
*        /************************************************************/ 00532000
*        /*                                                          */ 00533000
*        /*     PROCESS THE VOLUME RECORD TO ENSURE                  */ 00534000
*        /*     THAT A TIGHT CONNECTION EXISTS BETWEEN               */ 00535000
*        /*     THE VOLUME RECORD AND ITS EXTENSIONS.                */ 00536000
*        /*                                                          */ 00537000
*        /************************************************************/ 00538000
*                                                                  0361 00539000
*              CALL PROCTYPE;                                      0361 00540000
*                                                                  0361 00541000
         BAL   @14,PROCTYPE                                        0361 00542000
*        /************************************************************/ 00543000
*        /*                                                          */ 00544000
*        /*     FREE ALL RPLS NOT FREED                              */ 00545000
*        /*                                                          */ 00546000
*        /************************************************************/ 00547000
*                                                                  0362 00548000
*                                                                  0362 00549000
*              DO;                                                 0362 00550000
*                RSRECREQ = ''B;                                   0363 00551000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0363 00552000
*                RSRTERM = ON;     /* TERMRCD */                   0364 00553000
         OI    RSRTERM(REG6),B'00000010'                           0364 00554000
*                RSRWF = ON;       /* WORKFILE */                  0365 00555000
*                                                                  0365 00556000
         OI    RSRWF(REG6),B'10000000'                             0365 00557000
*              /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT       */ 00558000
*              CALL RECMGMT;                                       0366 00559000
         L     @15,@CV03458                                        0366 00560000
         BALR  @14,@15                                             0366 00561000
*                RFY RTNREG RSTD;                                  0367 00562000
*                TESTRC = RTNREG;                                  0368 00563000
         STH   RTNREG,TESTRC(,REG6)                                0368 00564000
*                RFY RTNREG UNRSTD;                                0369 00565000
*              END;                                                0370 00566000
*            END;                      /*END OF THIS VOLUME          */ 00567000
*        END VOLSRCHK;                 /* END OF VOLUME CHECK        */ 00568000
@RF00343 DS    0H                                                  0372 00569000
@DE00341 L     @07,RSENTPT(,REG6)                                  0372 00570000
         LTR   @07,@07                                             0372 00571000
         BNZ   @DL00341                                            0372 00572000
*        RFY RESVOL;                   /*REVERT                      */ 00573000
*        RFY VOLSERTB;                 /*REVERT                      */ 00574000
*        /************************************************************/ 00575000
*        /*                                                          */ 00576000
*        /* ASSOCIATION CHECK -                                      */ 00577000
*        /*     CHECK ALL RESET RECORDS FOR VALID ASSOCIATIONS,      */ 00578000
*        /*     UPDATE REASSIGNED CINS, AND VERIFY SPACE             */ 00579000
*        /*     REQUESTS AGAINST RESET CRAS FROM NON-RESET           */ 00580000
*        /*     RECORDS.                                             */ 00581000
*        /*                                                          */ 00582000
*        /************************************************************/ 00583000
*                                                                  0375 00584000
*        /************************************************************/ 00585000
*        /*                                                          */ 00586000
*        /*     PROCESS CURRENT CATALOG EXTENTS IN THE WORKFILE.     */ 00587000
*        /*     THE END OF THE CATALOG EXTENTS TO BE CHECKED         */ 00588000
*        /*     IS UP TO THE FIRST UNFORMATTED FREE CIN.             */ 00589000
*        /*                                                          */ 00590000
*        /************************************************************/ 00591000
*                                                                  0375 00592000
* ASSOCCHK:                                                        0375 00593000
*        DO RSASSEXT = 1 TO DIM(RSXCIENT)                          0375 00594000
*          WHILE(RSXCIBEG(RSASSEXT) < RSCAFUCI);                   0375 00595000
*                                                                  0375 00596000
ASSOCCHK LA    @07,1                                               0375 00597000
         STH   @07,RSASSEXT(,REG6)                                 0375 00598000
@DL00375 LH    @07,RSASSEXT(,REG6)                                 0375 00599000
         SLA   @07,4                                               0375 00600000
         L     @04,RSCIXLTA(,REG6)                                 0375 00601000
         LA    @01,0(@07,@04)                                      0375 00602000
         AL    @01,@CF03953                                        0375 00603000
         L     @15,RSXCIBEG-8(,@01)                                0375 00604000
         C     @15,RSCAFUCI(,REG6)                                 0375 00605000
         BNL   @DC00375                                            0375 00606000
*        /************************************************************/ 00607000
*        /*                                                          */ 00608000
*        /*     PROCESS EACH LOW KEY RANGE(LKR) RECORD UNTIL THE     */ 00609000
*        /*     FIRST UNFORMATTED FREE CIN IS HIT.                   */ 00610000
*        /*                                                          */ 00611000
*        /************************************************************/ 00612000
*                                                                  0376 00613000
*          RSASSEND = RSXCIBEG(RSASSEXT) + RSXCILN(RSASSEXT) - 1;  0376 00614000
         LR    @14,@15                                             0376 00615000
         LA    @01,0(@07,@04)                                      0376 00616000
         AL    @01,@CF03954                                        0376 00617000
         AL    @14,RSXCILN-12(,@01)                                0376 00618000
         BCTR  @14,0                                               0376 00619000
         ST    @14,RSASSEND(,REG6)                                 0376 00620000
*                                      /*HIGH CIN IN THIS EXTENT     */ 00621000
*          IF RSXCIRNG(RSASSEXT) = OFF THEN /*IF LKR                 */ 00622000
         ALR   @04,@07                                             0377 00623000
         TM    RSXCIRNG-16(@04),B'10000000'                        0377 00624000
         BNZ   @RF00377                                            0377 00625000
*            DO RSASSCIN = RSXCIBEG(RSASSEXT) TO RSASSEND          0378 00626000
*              WHILE(RSASSCIN < RSCAFUCI); /*PROCESS THIS EXTENT     */ 00627000
*                                                                  0378 00628000
         B     @DE00378                                            0378 00629000
@DL00378 CLC   RSASSCIN(4,REG6),RSCAFUCI(REG6)                     0378 00630000
         BNL   @DC00378                                            0378 00631000
*        /************************************************************/ 00632000
*        /*                                                          */ 00633000
*        /*     THERE ARE TWO PASSES FOR NON-VSAM. THE FIRST         */ 00634000
*        /*     PASS WILL HANDLE THE GDG BASE RECORD IF ONE          */ 00635000
*        /*     EXISTS AND THE SECOND PASS WILL RE-PROCESS           */ 00636000
*        /*     THE NON-VSAM ENTRY AS A NON-VSAM ENTRY.              */ 00637000
*        /*                                                          */ 00638000
*        /************************************************************/ 00639000
*                                                                  0379 00640000
*              RSASSEPA = ON;          /*ALLOW AT LEAST 1 PASS       */ 00641000
         OI    RSASSEPA(REG6),B'10000000'                          0379 00642000
*              DO RSASSPAS = 1 TO 2 WHILE(RSASSEPA=ON);            0380 00643000
         LA    @07,1                                               0380 00644000
         STH   @07,RSASSPAS(,REG6)                                 0380 00645000
@DL00380 TM    RSASSEPA(REG6),B'10000000'                          0380 00646000
         BNO   @DC00380                                            0380 00647000
*                RSASSEPA = OFF;       /*ONE PASS UNLESS REQUESTED   */ 00648000
*                                                                  0381 00649000
         NI    RSASSEPA(REG6),B'01111111'                          0381 00650000
*        /************************************************************/ 00651000
*        /*                                                          */ 00652000
*        /*     GET THE NEXT RECORD IN THIS EXTENT.                  */ 00653000
*        /*                                                          */ 00654000
*        /************************************************************/ 00655000
*                                                                  0382 00656000
*                RSGRABCU = ADDR(GRABSWF); /*READ FROM WORK FILE     */ 00657000
         L     @07,RSIOTBL(,REG6)                                  0382 00658000
         ST    @07,RSGRABCU(,REG6)                                 0382 00659000
*                GRABCURR = GRABRAB1;  /*USE FIRST BUFFER            */ 00660000
         L     @04,GRABRAB1(,@07)                                  0383 00661000
         ST    @04,GRABCURR(,@07)                                  0383 00662000
*                RABRCDA = RSASSCIN;   /*SEQUENTIAL SCAN             */ 00663000
*                                                                  0384 00664000
         L     @07,RSASSCIN(,REG6)                                 0384 00665000
         ST    @07,RABRCDA(,@04)                                   0384 00666000
*                DO;                                               0385 00667000
*                  RSRTYPE = ''B;                                  0386 00668000
         MVI   RSRTYPE(REG6),X'00'                                 0386 00669000
*                  RSRGET = ON;      /* GETRCD  */                 0387 00670000
         OI    RSRGET(REG6),B'10000000'                            0387 00671000
*                  RSRUPD = ON;      /* UPDATE  */                 0388 00672000
         OI    RSRUPD(REG6),B'00001000'                            0388 00673000
*                  RSRDS = ''B;                                    0389 00674000
         NI    RSRDS(REG6),B'00011111'                             0389 00675000
*                  RSRWF = ON;       /* WORKFILE  */               0390 00676000
*                  RSRDIR = ON;      /* DIRECT  */                 0391 00677000
*                  RSRKEY = ON;      /* KEY  */                    0392 00678000
*                                                                  0392 00679000
         OI    RSRWF(REG6),B'10010100'                             0392 00680000
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */ 00681000
*                CALL RECMGMT;                                     0393 00682000
         L     @15,@CV03458                                        0393 00683000
         BALR  @14,@15                                             0393 00684000
*                  RFY RTNREG RSTD;                                0394 00685000
*                  TESTRC = RTNREG;                                0395 00686000
         STH   RTNREG,TESTRC(,REG6)                                0395 00687000
*                  RFY RTNREG UNRSTD;                              0396 00688000
*                END;                                              0397 00689000
*                                                                  0397 00690000
*        /************************************************************/ 00691000
*        /*                                                          */ 00692000
*        /*     IF NOT ALREADY ASSOCIATION CHECKED AND THE           */ 00693000
*        /*     RECORD CAME FROM A CRA BEING RESET, THEN CHECK       */ 00694000
*        /*     IT OUT.                                              */ 00695000
*        /*     IGNORE INVALID CINS - THEY/VE BEEN REASSIGNED TO     */ 00696000
*        /*     NEW CIN VALUES AND WILL EVENTUALLY BE FOUND.         */ 00697000
*        /*                                                          */ 00698000
*        /************************************************************/ 00699000
*                                                                  0398 00700000
*                RSASSTBL = 0;         /*NO ASSOCIATION TO PERFORM   */ 00701000
         SLR   @07,@07                                             0398 00702000
         ST    @07,RSASSTBL(,REG6)                                 0398 00703000
*                IF RSWASSCK=OFF & RSWFCRA=ON & RSWINVCI=OFF THEN  0399 00704000
         L     @07,RSGRABCU(,REG6)                                 0399 00705000
         L     @07,GRABCURR(,@07)                                  0399 00706000
         TM    RSWFCRA(@07),B'10000000'                            0399 00707000
         BNO   @RF00399                                            0399 00708000
         TM    RSWASSCK(@07),B'00000010'                           0399 00709000
         BNZ   @RF00399                                            0399 00710000
         TM    RSWINVCI(@07),B'10000000'                           0399 00711000
         BNZ   @RF00399                                            0399 00712000
*                  DO;                                             0400 00713000
*                                                                  0400 00714000
*        /************************************************************/ 00715000
*        /*                                                          */ 00716000
*        /*     ASSOCIATION CHECK A SET OF RECORDS. ORIENT ON THE    */ 00717000
*        /*     CLUSTER(C), GDG BASE(B), USERCATALOG(U), AND         */ 00718000
*        /*     NON-VSAM(A). FROM THESE BASES ALL SUBSETS WILL BE    */ 00719000
*        /*     CHECKED.  NOTE THAT THE VOLUME RECORD (V-W) WAS      */ 00720000
*        /*     ALREADY PROCESSED.                                   */ 00721000
*        /*                                                          */ 00722000
*        /************************************************************/ 00723000
*                                                                  0401 00724000
*                    IF RCDID=CLID THEN                            0401 00725000
         CLI   RCDID+8(@07),C'C'                                   0401 00726000
         BNE   @RF00401                                            0401 00727000
*                      RSASSTBL=ADDR(ASSOCC); /*CLUSTER TABLE        */ 00728000
         LA    @07,ASSOCC                                          0402 00729000
         ST    @07,RSASSTBL(,REG6)                                 0402 00730000
*                    IF RCDID=GDGID THEN                           0403 00731000
@RF00401 L     @07,RSGRABCU(,REG6)                                 0403 00732000
         L     @07,GRABCURR(,@07)                                  0403 00733000
         CLI   RCDID+8(@07),C'B'                                   0403 00734000
         BNE   @RF00403                                            0403 00735000
*                      RSASSTBL=ADDR(ASSOB); /*GDG BASE TABLE        */ 00736000
         LA    @07,ASSOB                                           0404 00737000
         ST    @07,RSASSTBL(,REG6)                                 0404 00738000
*                    IF RCDID=UCATID THEN                          0405 00739000
@RF00403 L     @07,RSGRABCU(,REG6)                                 0405 00740000
         L     @07,GRABCURR(,@07)                                  0405 00741000
         CLI   RCDID+8(@07),C'U'                                   0405 00742000
         BNE   @RF00405                                            0405 00743000
*                      RSASSTBL=ADDR(ASSOU); /*USERCATALOG TABLE     */ 00744000
         LA    @07,ASSOU                                           0406 00745000
         ST    @07,RSASSTBL(,REG6)                                 0406 00746000
*                    IF RCDID=NVID THEN                            0407 00747000
@RF00405 L     @07,RSGRABCU(,REG6)                                 0407 00748000
         L     @04,GRABCURR(,@07)                                  0407 00749000
         CLI   RCDID+8(@04),C'A'                                   0407 00750000
         BNE   @RF00407                                            0407 00751000
*                                      /*CHECK FOR NON-VSAM ENTRY    */ 00752000
*                      IF RSASSPAS = 1 THEN /*IF FIRST PASS          */ 00753000
         CLC   RSASSPAS(2,REG6),@CH00212                           0408 00754000
         BNE   @RF00408                                            0408 00755000
*                        DO;                                       0409 00756000
*                                                                  0409 00757000
*        /************************************************************/ 00758000
*        /*                                                          */ 00759000
*        /*     ON THE FIRST PASS CHECK TO SEE IF THE NON-VSAM       */ 00760000
*        /*     ENTRY IS A GDG DATA SET. IF IT IS, PROCESS THE       */ 00761000
*        /*     GDG BASE ENTRY FIRST. ON THE SECOND PASS,           */  00762000
*        /*     PROCESS THE NON-VSAM ENTRY, IF THE BASE FAILED       */ 00763000
*        /*     ASSOCIATION CHECKING OR THE NON-VSAM ENTRY IS        */ 00764000
*        /*     NOT A GDG.                                           */ 00765000
*        /*                                                          */ 00766000
*        /************************************************************/ 00767000
*                                                                  0410 00768000
*                          RSASSEPA = ON; /*SECOND PASS REQUIRED     */ 00769000
*                                                                  0410 00770000
         OI    RSASSEPA(REG6),B'10000000'                          0410 00771000
*        /************************************************************/ 00772000
*        /*                                                          */ 00773000
*        /*     GET ALL OF THE ASSOCIATIONS FOR THIS NON-VSAM ENTRY  */ 00774000
*        /*                                                          */ 00775000
*        /************************************************************/ 00776000
*                                                                  0411 00777000
*                                                                  0411 00778000
*                           DO;                                    0411 00779000
*                             GRABBB = GRABCURR;                   0412 00780000
         ST    @04,GRABBB(,@07)                                    0412 00781000
*                             RSWGCODE = ASGC;                     0413 00782000
         MVI   RSWGCODE(REG6),X'02'                                0413 00783000
*                                      /*SPECIFY GROUP CODE          */ 00784000
*                             RSWFONE = OFF;                       0414 00785000
         NI    RSWFONE(REG6),B'01111111'                           0414 00786000
*                                      /*FIND ALL OCCURRENCES        */ 00787000
*                             /* CALL THE FIND SUBROUTINE */       0415 00788000
*                                                                  0415 00789000
*                           /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIN 00790000
*                                                                    */ 00791000
*                           CALL FIND;                             0415 00792000
         L     @15,@CV03441                                        0415 00793000
         BALR  @14,@15                                             0415 00794000
*                           END;                                   0416 00795000
*                                      /*FIND ALL ASSOCIATIONS       */ 00796000
*                                                                  0417 00797000
*        /************************************************************/ 00798000
*        /*                                                          */ 00799000
*        /*     CHECK IF THIS IS A GDG DATA SET                      */ 00800000
*        /*                                                          */ 00801000
*        /************************************************************/ 00802000
*                                                                  0417 00803000
*                          RSFAENT = RSFCADR; /*GET FIRST ASSOC      */ 00804000
         L     @07,RSWASNVT(,REG6)                                 0417 00805000
         L     @04,RSFCADR(,@07)                                   0417 00806000
         ST    @04,RSFAENT(,@07)                                   0417 00807000
*                          IF RSFENTLN ^= 0 THEN                   0418 00808000
         CLI   RSFENTLN(@07),0                                     0418 00809000
         BE    @RF00418                                            0418 00810000
*                            DO;       /*CHECK ALL ASSOCIATIONS      */ 00811000
*                              DO RSFCNDX = 1 TO RSFHNDX           0420 00812000
*                                WHILE(SNTYPE^='B');               0420 00813000
         LA    @07,1                                               0420 00814000
         B     @DE00420                                            0420 00815000
@DL00420 L     @07,RSWASNVT(,REG6)                                 0420 00816000
         L     @04,RSFAENT(,@07)                                   0420 00817000
         CLI   SNTYPE(@04),C'B'                                    0420 00818000
         BE    @DC00420                                            0420 00819000
*                                RSFAENT = RSFAENT + RSFENTLN;     0421 00820000
         SLR   @15,@15                                             0421 00821000
         IC    @15,RSFENTLN(,@07)                                  0421 00822000
         ALR   @04,@15                                             0421 00823000
         ST    @04,RSFAENT(,@07)                                   0421 00824000
*                              END;                                0422 00825000
*                                                                  0422 00826000
         L     @04,RSWASNVT(,REG6)                                 0422 00827000
         LA    @07,1                                               0422 00828000
         AH    @07,RSFCNDX(,@04)                                   0422 00829000
@DE00420 L     @04,RSWASNVT(,REG6)                                 0422 00830000
         STH   @07,RSFCNDX(,@04)                                   0422 00831000
         L     @04,RSWASNVT(,REG6)                                 0422 00832000
         CH    @07,RSFHNDX(,@04)                                   0422 00833000
         BNH   @DL00420                                            0422 00834000
@DC00420 DS    0H                                                  0423 00835000
*        /************************************************************/ 00836000
*        /*                                                          */ 00837000
*        /*     IF A GDG ASSOCIATION WAS FOUND THEN PROCESS THE      */ 00838000
*        /*     GDG BASE.                                            */ 00839000
*        /*                                                          */ 00840000
*        /************************************************************/ 00841000
*                                                                  0423 00842000
*                              IF SNTYPE = GDGID THEN              0423 00843000
         L     @07,RSWASNVT(,REG6)                                 0423 00844000
         L     @07,RSFAENT(,@07)                                   0423 00845000
         CLI   SNTYPE(@07),C'B'                                    0423 00846000
         BNE   @RF00423                                            0423 00847000
*                                DO;                               0424 00848000
*                                                                  0424 00849000
*                                  DO;                             0425 00850000
*                                    RSRTYPE = ''B;                0426 00851000
         MVI   RSRTYPE(REG6),X'00'                                 0426 00852000
*                                    RSRFREE = ON;     /* FREERCD  */   00853000
         OI    RSRFREE(REG6),B'00000001'                           0427 00854000
*                                    RSRUPD = ON;      /* UPDATE  */    00855000
         OI    RSRUPD(REG6),B'00001000'                            0428 00856000
*                                    RSRDS = ''B;                  0429 00857000
         NI    RSRDS(REG6),B'00011111'                             0429 00858000
*                                    RSRWF = ON;       /* WORKFILE  */  00859000
*                                    RSRDIR = ON;      /* DIRECT  */    00860000
*                                    RSRKEY = ON;      /* KEY  */  0432 00861000
*                                                                  0432 00862000
         OI    RSRWF(REG6),B'10010100'                             0432 00863000
*                                  /* CALL TO MODULE IDCRS06 FOR PROCED 00864000
*RE RECMGMT                                                          */ 00865000
*                                  CALL RECMGMT;                   0433 00866000
         L     @15,@CV03458                                        0433 00867000
         BALR  @14,@15                                             0433 00868000
*                                    RFY RTNREG RSTD;              0434 00869000
*                                    TESTRC = RTNREG;              0435 00870000
         STH   RTNREG,TESTRC(,REG6)                                0435 00871000
*                                    RFY RTNREG UNRSTD;            0436 00872000
*                                  END; /*FREE BFR 1             */     00873000
*                                                                  0437 00874000
*                                  DO;                             0438 00875000
*                                    RSRTYPE = ''B;                0439 00876000
         MVI   RSRTYPE(REG6),X'00'                                 0439 00877000
*                                    RSRGET = ON;      /* GETRCD  */    00878000
         OI    RSRGET(REG6),B'10000000'                            0440 00879000
*                                    RSRUPD = ON;      /* UPDATE  */    00880000
         OI    RSRUPD(REG6),B'00001000'                            0441 00881000
*                                    RSRDS = ''B;                  0442 00882000
         NI    RSRDS(REG6),B'00011111'                             0442 00883000
*                                    RSRWF = ON;       /* WORKFILE  */  00884000
*                                    RSRDIR = ON;      /* DIRECT  */    00885000
*                                    RSRKEY = ON;      /* KEY  */  0445 00886000
         OI    RSRWF(REG6),B'10010100'                             0445 00887000
*                                    RSVIAFCR = ON;  /*INDICATE CRA SEA 00888000
*CH*/                                RSVIACRA = RCDCRAVL; /*SET VOLSER  00889000
*/                                   RSVIACIN = SNNAME; /*SET CI NUMBER 00890000
**/                                                                0446 00891000
         OI    RSVIAFCR(REG6),B'10000000'                          0446 00892000
         L     @07,RSGRABCU(,REG6)                                 0447 00893000
         L     @07,GRABCURR(,@07)                                  0447 00894000
         MVC   RSVIACRA(6,REG6),RCDCRAVL+8(@07)                    0447 00895000
         L     @07,RSWASNVT(,REG6)                                 0448 00896000
         L     @07,RSFAENT(,@07)                                   0448 00897000
         MVC   RSVIACIN(3,REG6),SNNAME(@07)                        0448 00898000
*                                  /* CALL TO MODULE IDCRS05 FOR PROCED 00899000
*RE GETVIA                                                           */ 00900000
*                                  CALL GETVIA;                    0449 00901000
         L     @15,@CV03442                                        0449 00902000
         BALR  @14,@15                                             0449 00903000
*                                  END;                            0450 00904000
*                                      /*GET THE GDG BASE RECORD     */ 00905000
*                                                                  0451 00906000
*        /************************************************************/ 00907000
*        /*                                                          */ 00908000
*        /*       PROCESS THE GDG IF THE GDG IS FOUND AND            */ 00909000
*        /*         NOT ALREADY ASSOCIATION CHECKED.                 */ 00910000
*        /*                                                          */ 00911000
*        /************************************************************/ 00912000
*                                                                  0451 00913000
*                                  IF RABNRF=OFF & RCDID=GDGID &   0451 00914000
*                                   RSWASSCK=OFF THEN              0451 00915000
         L     @07,RSGRABCU(,REG6)                                 0451 00916000
         L     @07,GRABCURR(,@07)                                  0451 00917000
         TM    RABNRF(@07),B'00000010'                             0451 00918000
         BNZ   @RF00451                                            0451 00919000
         CLI   RCDID+8(@07),C'B'                                   0451 00920000
         BNE   @RF00451                                            0451 00921000
         TM    RSWASSCK(@07),B'00000010'                           0451 00922000
         BNZ   @RF00451                                            0451 00923000
*                                    RSASSTBL = ADDR(ASSOB);       0452 00924000
         LA    @07,ASSOB                                           0452 00925000
         ST    @07,RSASSTBL(,REG6)                                 0452 00926000
*                                  RABNRF = OFF;                   0453 00927000
@RF00451 L     @07,RSGRABCU(,REG6)                                 0453 00928000
         L     @07,GRABCURR(,@07)                                  0453 00929000
         NI    RABNRF(@07),B'11111101'                             0453 00930000
*                                      /*RESET NO RECORD FOUND INDR  */ 00931000
*                                END;  /*END OF B CHECKING           */ 00932000
*                            END;      /*END OF SNTABLE CHECKING     */ 00933000
@RF00423 DS    0H                                                  0456 00934000
*                          RSFENTLN = 0; /*FREE ASSN SNTAB           */ 00935000
@RF00418 L     @07,RSWASNVT(,REG6)                                 0456 00936000
         MVI   RSFENTLN(@07),X'00'                                 0456 00937000
*                        END;          /*END OF PASS 1 - GDG         */ 00938000
*                                                                  0457 00939000
*        /************************************************************/ 00940000
*        /*                                                          */ 00941000
*        /*     NON-VSAM PASS2 - CHECK THE NON-VSAM ENTRY            */ 00942000
*        /*                                                          */ 00943000
*        /************************************************************/ 00944000
*                                                                  0458 00945000
*                      ELSE                                        0458 00946000
*                        RSASSTBL = ADDR(ASSOA);                   0458 00947000
*                                                                  0458 00948000
         B     @RC00408                                            0458 00949000
@RF00408 LA    @07,ASSOA                                           0458 00950000
         ST    @07,RSASSTBL(,REG6)                                 0458 00951000
*        /************************************************************/ 00952000
*        /*                                                          */ 00953000
*        /*     IF THE RECORD IS THE BASE FOR DOING AN ASSOCIATION   */ 00954000
*        /*     CHECK THEN GO TO PROCTYPE TO DO IT                   */ 00955000
*        /*                                                          */ 00956000
*        /************************************************************/ 00957000
*                                                                  0459 00958000
*                    IF RSASSTBL ^= 0 THEN                         0459 00959000
@RC00408 DS    0H                                                  0459 00960000
@RF00407 L     @07,RSASSTBL(,REG6)                                 0459 00961000
         LTR   @07,@07                                             0459 00962000
         BZ    @RF00459                                            0459 00963000
*                      DO;                                         0460 00964000
*                        CALL PROCTYPE;                            0461 00965000
*                                                                  0461 00966000
         BAL   @14,PROCTYPE                                        0461 00967000
*                        DO;                                       0462 00968000
*                          RSRECREQ = ''B;                         0463 00969000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0463 00970000
*                          RSRTERM = ON;     /* TERMRCD */         0464 00971000
         OI    RSRTERM(REG6),B'00000010'                           0464 00972000
*                          RSRWF = ON;       /* WORKFILE */        0465 00973000
*                                                                  0465 00974000
         OI    RSRWF(REG6),B'10000000'                             0465 00975000
*                        /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGM 00976000
*                                                                    */ 00977000
*                        CALL RECMGMT;                             0466 00978000
         L     @15,@CV03458                                        0466 00979000
         BALR  @14,@15                                             0466 00980000
*                          RFY RTNREG RSTD;                        0467 00981000
*                          TESTRC = RTNREG;                        0468 00982000
         STH   RTNREG,TESTRC(,REG6)                                0468 00983000
*                          RFY RTNREG UNRSTD;                      0469 00984000
*                        END;                                      0470 00985000
*                                      /*FREE ANY RPLS STILL HELD    */ 00986000
*                      END;                                        0471 00987000
*                                                                  0471 00988000
*                  END;                                            0472 00989000
*                                      /*END OF CHECK FOR ASSOC TYPE */ 00990000
*                                                                  0473 00991000
*        /************************************************************/ 00992000
*        /*                                                          */ 00993000
*        /*     IF NON-RESET CLUSTER OR ALTERNATEINDEX THEN CHECK    */ 00994000
*        /*     THE DATA AND INDEX TO ENSURE THAT IF THERE IS A      */ 00995000
*        /*     A CLAIM FOR SPACE ON A VOLUME BEING RESET THAT       */ 00996000
*        /*     THERE EXISTS A DATA SET DIRECTORY ENTRY (DSDIR)      */ 00997000
*        /*     ON THAT VOLUME RECORD FOR THIS DATA OR INDEX.        */ 00998000
*        /*                                                          */ 00999000
*        /************************************************************/ 01000000
*                                                                  0473 01001000
*                ELSE                                              0473 01002000
*                  IF RSWFCRA=OFF & RSWDLCAT=OFF THEN              0473 01003000
         B     @RC00399                                            0473 01004000
@RF00399 L     @07,RSGRABCU(,REG6)                                 0473 01005000
         L     @07,GRABCURR(,@07)                                  0473 01006000
         TM    RSWFCRA(@07),B'11000000'                            0473 01007000
         BNZ   @RF00473                                            0473 01008000
*                    DO;                                           0474 01009000
*                      IF RCDID=CLID THEN                          0475 01010000
         CLI   RCDID+8(@07),C'C'                                   0475 01011000
         BNE   @RF00475                                            0475 01012000
*                        RSASSTBL=ADDR(ASSO1C); /*NONRESET CLUSTER   */ 01013000
         LA    @07,ASSO1C                                          0476 01014000
         ST    @07,RSASSTBL(,REG6)                                 0476 01015000
*                      IF RCDID=AIXID THEN                         0477 01016000
@RF00475 L     @07,RSGRABCU(,REG6)                                 0477 01017000
         L     @07,GRABCURR(,@07)                                  0477 01018000
         CLI   RCDID+8(@07),C'G'                                   0477 01019000
         BNE   @RF00477                                            0477 01020000
*                        RSASSTBL=ADDR(ASSO2G); /*NONRESET AIX       */ 01021000
         LA    @07,ASSO2G                                          0478 01022000
         ST    @07,RSASSTBL(,REG6)                                 0478 01023000
*                      IF RSASSTBL^=0 THEN                         0479 01024000
@RF00477 L     @07,RSASSTBL(,REG6)                                 0479 01025000
         LTR   @07,@07                                             0479 01026000
         BZ    @RF00479                                            0479 01027000
*                        DO;                                       0480 01028000
*                          CALL PROCTYPE;                          0481 01029000
*                                                                  0481 01030000
         BAL   @14,PROCTYPE                                        0481 01031000
*                          DO;                                     0482 01032000
*                            RSRECREQ = ''B;                       0483 01033000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0483 01034000
*                            RSRTERM = ON;     /* TERMRCD */       0484 01035000
         OI    RSRTERM(REG6),B'00000010'                           0484 01036000
*                            RSRWF = ON;       /* WORKFILE */      0485 01037000
*                                                                  0485 01038000
         OI    RSRWF(REG6),B'10000000'                             0485 01039000
*                          /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECM 01040000
*MT                                                                  */ 01041000
*                          CALL RECMGMT;                           0486 01042000
         L     @15,@CV03458                                        0486 01043000
         BALR  @14,@15                                             0486 01044000
*                            RFY RTNREG RSTD;                      0487 01045000
*                            TESTRC = RTNREG;                      0488 01046000
         STH   RTNREG,TESTRC(,REG6)                                0488 01047000
*                            RFY RTNREG UNRSTD;                    0489 01048000
*                          END;                                    0490 01049000
*                                      /*FREE ANY HELD RPLS          */ 01050000
*                        END;                                      0491 01051000
*                    END;                                          0492 01052000
*                                                                  0492 01053000
@RF00479 DS    0H                                                  0493 01054000
*        /************************************************************/ 01055000
*        /*                                                          */ 01056000
*        /*     FREE THE RPL HELD BY THE SEQUENTIAL WORKFILE SCAN.   */ 01057000
*        /*                                                          */ 01058000
*        /************************************************************/ 01059000
*                                                                  0493 01060000
*                GRABCURR = GRABRAB1;  /*BUFFER1                     */ 01061000
*                                                                  0493 01062000
@RF00473 DS    0H                                                  0493 01063000
@RC00399 L     @07,RSGRABCU(,REG6)                                 0493 01064000
         L     @04,GRABRAB1(,@07)                                  0493 01065000
         ST    @04,GRABCURR(,@07)                                  0493 01066000
*                DO;                                               0494 01067000
*                  RSRTYPE = ''B;                                  0495 01068000
         MVI   RSRTYPE(REG6),X'00'                                 0495 01069000
*                  RSRFREE = ON;     /* FREERCD  */                0496 01070000
         OI    RSRFREE(REG6),B'00000001'                           0496 01071000
*                  RSRUPD = ON;      /* UPDATE  */                 0497 01072000
         OI    RSRUPD(REG6),B'00001000'                            0497 01073000
*                  RSRDS = ''B;                                    0498 01074000
         NI    RSRDS(REG6),B'00011111'                             0498 01075000
*                  RSRWF = ON;       /* WORKFILE  */               0499 01076000
*                  RSRDIR = ON;      /* DIRECT  */                 0500 01077000
*                  RSRKEY = ON;      /* KEY  */                    0501 01078000
*                                                                  0501 01079000
         OI    RSRWF(REG6),B'10010100'                             0501 01080000
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */ 01081000
*                CALL RECMGMT;                                     0502 01082000
         L     @15,@CV03458                                        0502 01083000
         BALR  @14,@15                                             0502 01084000
*                  RFY RTNREG RSTD;                                0503 01085000
*                  TESTRC = RTNREG;                                0504 01086000
         STH   RTNREG,TESTRC(,REG6)                                0504 01087000
*                  RFY RTNREG UNRSTD;                              0505 01088000
*                END;                                              0506 01089000
*              END;                    /*END OF PASS                 */ 01090000
         LA    @07,1                                               0507 01091000
         AH    @07,RSASSPAS(,REG6)                                 0507 01092000
         STH   @07,RSASSPAS(,REG6)                                 0507 01093000
         C     @07,@CF00149                                        0507 01094000
         BNH   @DL00380                                            0507 01095000
@DC00380 DS    0H                                                  0508 01096000
*            END;                      /*END OF LKR EXTENT           */ 01097000
         LA    @15,1                                               0508 01098000
         AL    @15,RSASSCIN(,REG6)                                 0508 01099000
@DE00378 ST    @15,RSASSCIN(,REG6)                                 0508 01100000
         C     @15,RSASSEND(,REG6)                                 0508 01101000
         BNH   @DL00378                                            0508 01102000
@DC00378 DS    0H                                                  0509 01103000
*        END ASSOCCHK;                 /*END OF LKR                  */ 01104000
*                                                                  0509 01105000
@RF00377 LA    @07,1                                               0509 01106000
         AH    @07,RSASSEXT(,REG6)                                 0509 01107000
         STH   @07,RSASSEXT(,REG6)                                 0509 01108000
         C     @07,@CF01845                                        0509 01109000
         BNH   @DL00375                                            0509 01110000
@DC00375 DS    0H                                                  0510 01111000
*        /************************************************************/ 01112000
*        /*                                                          */ 01113000
*        /* FREE ALL STORAGE FOR ASSOC AND ITS SUBPROCESSORS         */ 01114000
*        /*                                                          */ 01115000
*        /************************************************************/ 01116000
*                                                                  0510 01117000
*        CALL IDCSAFP0(GDTTBL,POOL10);                             0510 01118000
         ST    REG5,@AL00001                                       0510 01119000
         LA    @07,@CC00903                                        0510 01120000
         ST    @07,@AL00001+4                                      0510 01121000
         MVI   @AL00001+4,X'80'                                    0510 01122000
         L     @15,GDTFPL(,REG5)                                   0510 01123000
         LA    @01,@AL00001                                        0510 01124000
         BALR  @14,@15                                             0510 01125000
*        /************************************************************/ 01126000
*        /*                                                          */ 01127000
*        /* SPACE CHECK                                              */ 01128000
*        /*     FOR EVERY VOLUME, CHECK CLAIMS FOR SPACE BY          */ 01129000
*        /*     PROCESSING ALL OF THE DATA SET DIRECTORY ENTRIES     */ 01130000
*        /*     (DSDIRS) FOR THAT VOLUME.                            */ 01131000
*        /*                                                          */ 01132000
*        /************************************************************/ 01133000
*                                                                  0511 01134000
* SPCCHK:                                                          0511 01135000
*                                                                  0511 01136000
*        DO;                                                       0511 01137000
SPCCHK   DS    0H                                                  0512 01138000
*          RSRECREQ = ''B;                                         0512 01139000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0512 01140000
*          RSRTERM = ON;     /* TERMRCD */                         0513 01141000
         OI    RSRTERM(REG6),B'00000010'                           0513 01142000
*          RSRWF = ON;       /* WORKFILE */                        0514 01143000
*                                                                  0514 01144000
         OI    RSRWF(REG6),B'10000000'                             0514 01145000
*        /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT             */ 01146000
*        CALL RECMGMT;                                             0515 01147000
         L     @15,@CV03458                                        0515 01148000
         BALR  @14,@15                                             0515 01149000
*          RFY RTNREG RSTD;                                        0516 01150000
*          TESTRC = RTNREG;                                        0517 01151000
         STH   RTNREG,TESTRC(,REG6)                                0517 01152000
*          RFY RTNREG UNRSTD;                                      0518 01153000
*        END;               /*CLEAR ALL RPLS              */       0519 01154000
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE PROCVOL             */ 01155000
*        CALL PROCVOL;                                             0520 01156000
*                                                                  0520 01157000
         L     @15,@CV03434                                        0520 01158000
         BALR  @14,@15                                             0520 01159000
*        /************************************************************/ 01160000
*        /*                                                          */ 01161000
*        /* DUMP POINT PRIOR TO EXIT                                 */ 01162000
*        /*                                                          */ 01163000
*        /************************************************************/ 01164000
*                                                                  0521 01165000
*        IF GDTDBG = NULLPTR                                       0521 01166000
*          THEN;                                                   0521 01167000
         L     @07,GDTDBG(,REG5)                                   0521 01168000
         LTR   @07,@07                                             0521 01169000
         BZ    @RT00521                                            0521 01170000
*          ELSE                                                    0523 01171000
*            CALL IDCDB010(GDTTBL,'RSA1');                         0523 01172000
*                                                                  0523 01173000
         ST    REG5,@AL00001                                       0523 01174000
         LA    @07,@CC03754                                        0523 01175000
         ST    @07,@AL00001+4                                      0523 01176000
         MVI   @AL00001+4,X'80'                                    0523 01177000
         L     @15,GDTDBG(,REG5)                                   0523 01178000
         LA    @01,@AL00001                                        0523 01179000
         BALR  @14,@15                                             0523 01180000
*        /************************************************************/ 01181000
*        /*                                                          */ 01182000
*        /* FREE ALL STORAGE FOR FIND/MODGO/DELGO                    */ 01183000
*        /*                                                          */ 01184000
*        /************************************************************/ 01185000
*                                                                  0524 01186000
*        CALL IDCSAFP0(GDTTBL,POOL4);                              0524 01187000
@RT00521 ST    REG5,@AL00001                                       0524 01188000
         LA    @07,@CC00901                                        0524 01189000
         ST    @07,@AL00001+4                                      0524 01190000
         MVI   @AL00001+4,X'80'                                    0524 01191000
         L     @15,GDTFPL(,REG5)                                   0524 01192000
         LA    @01,@AL00001                                        0524 01193000
         BALR  @14,@15                                             0524 01194000
*        RSWAFINF = 0;                 /*CLEAR ANCHOR FOR WORK AREA  */ 01195000
*                                                                  0525 01196000
         SLR   @07,@07                                             0525 01197000
         ST    @07,RSWAFINF(,REG6)                                 0525 01198000
*  CALL EXIT;  /*TERMINATE*/                                       0526 01199000
         BAL   @14,EXIT                                            0526 01200000
*  END ASSOC; /*END OF PROCEDURE*/                                 0527 01201000
@EL00002 DS    0H                                                  0527 01202000
@EF00002 DS    0H                                                  0527 01203000
@ER00002 BR    @14                                                 0527 01204000
@PB00002 DS    0H                                                  0528 01205000
*/********************************************************************/ 01206000
*/*                                                                  */ 01207000
*/* PROCEDURE NAME - CINALTER                                        */ 01208000
*/*                                                                  */ 01209000
*/* FUNCTION -                                                       */ 01210000
*/*     CINALTER MODIFIES CONTROL INTERVAL NUMBERS (CINS) IN         */ 01211000
*/*     CATALOG RECORDS FOR HORIZONTAL EXTENSION POINTERS,           */ 01212000
*/*     GROUP OCCURRENCE POINTERS(GOPS), AND GROUP OCCURRENCES       */ 01213000
*/*     (GOS) OR DELETES HORIZONTAL EXTENSION POINTERS AND GOPS.     */ 01214000
*/*                                                                  */ 01215000
*/* INPUT -                                                          */ 01216000
*/*     PTCITWK - ADDRESS OF THE CITABE FOR REASSIGNED CIN          */  01217000
*/*     PTDITCUR - ADDRESS OF THE DITABE FOR DELETE OR MODIFY        */ 01218000
*/*       DITDEL - DELETE THE HORIZ EXT PTR, OR GOP                  */ 01219000
*/*     GRABCURR - ADDRESS OF RECORD IN BUFFER                       */ 01220000
*/*                                                                  */ 01221000
*/* OUTPUT -                                                         */ 01222000
*/*     THE RECORD IS UPDATE IN THE BUFFER.                          */ 01223000
*/*                                                                  */ 01224000
*/********************************************************************/ 01225000
*      GENERATE;                                                   0528 01226000
         DS    0F                                                       01227000
NAME0032 DC    CL8'CINALTER'                                            01228000
*CINALTER: PROCEDURE                                               0529 01229000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0529 01230000
*                                                                  0529 01231000
         B     @PB00003                                            0529 01232000
CINALTER DS    0H                                                  0530 01233000
*      GENERATE REFS(RS02RG08, REG6);                              0530 01234000
*                                                                  0530 01235000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          01236000
         LR    @15,@13  OLD SAVE AREA                                   01237000
         LA    @13,72(@13)  NEW SAVE AREA                               01238000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     01239000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        01240000
         MVC   0(4,@15),NAME0032  PROCNAME TO REGSAVE                   01241000
*        OLDERID2 = NEWERID2;                                      0531 01242000
         L     @07,GDTTR2(,REG5)                                   0531 01243000
         MVC   @TS00001(95),NEWERID2(@07)                          0531 01244000
         MVC   OLDERID2(95,@07),@TS00001                           0531 01245000
*        NEWID2 = 'RSCA';                                          0532 01246000
         MVC   NEWID2(4,@07),@CC03760                              0532 01247000
*        RFY CITABE BASED(PTCITWK);                                0533 01248000
*                                                                  0533 01249000
*        /************************************************************/ 01250000
*        /*                                                          */ 01251000
*        /* GET BASE POINTERS FOR THE CATALOG RECORD                 */ 01252000
*        /*                                                          */ 01253000
*        /************************************************************/ 01254000
*                                                                  0534 01255000
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE CATRCDSU            */ 01256000
*        CALL CATRCDSU;                                            0534 01257000
*                                                                  0534 01258000
         L     @15,@CV03430                                        0534 01259000
         BALR  @14,@15                                             0534 01260000
*        /************************************************************/ 01261000
*        /*                                                          */ 01262000
*        /* MARK RECORD FOR UPDATE IN CATALOG AND CRA                */ 01263000
*        /*                                                          */ 01264000
*        /************************************************************/ 01265000
*                                                                  0535 01266000
*        RSWUPCAT = ON;                                            0535 01267000
         L     @07,RSGRABCU(,REG6)                                 0535 01268000
         L     @07,GRABCURR(,@07)                                  0535 01269000
         OI    RSWUPCAT(@07),B'00100000'                           0535 01270000
*        /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR             */ 01271000
*        CALL ADDUPCR;                                             0536 01272000
*                                                                  0536 01273000
         L     @15,@CV03448                                        0536 01274000
         BALR  @14,@15                                             0536 01275000
*        /************************************************************/ 01276000
*        /*                                                          */ 01277000
*        /*     POINT TO THE GOP                                     */ 01278000
*        /*                                                          */ 01279000
*        /************************************************************/ 01280000
*                                                                  0537 01281000
*        RSCPE5 = RSCPE1 + DITOFS;                                 0537 01282000
         L     @07,RSPTWKC(,REG6)                                  0537 01283000
         L     @07,PTDITCUR(,@07)                                  0537 01284000
         LH    @04,DITOFS(,@07)                                    0537 01285000
         AL    @04,RSCPE1(,REG6)                                   0537 01286000
         ST    @04,RSCPE5(,REG6)                                   0537 01287000
*        IF DITFB256 = ON THEN                                     0538 01288000
         TM    DITFB256(@07),B'00000001'                           0538 01289000
         BNO   @RF00538                                            0538 01290000
*          RSCPE5 = RSCPE5 +  256;                                 0539 01291000
*                                                                  0539 01292000
         AL    @04,@CF03188                                        0539 01293000
         ST    @04,RSCPE5(,REG6)                                   0539 01294000
*        /************************************************************/ 01295000
*        /*                                                          */ 01296000
*        /*     DELETE CIN IN HORIZONTAL OR GROUP OCCURRENCE         */ 01297000
*        /*                                                          */ 01298000
*        /************************************************************/ 01299000
*                                                                  0540 01300000
*        IF DITFADEL = ON THEN                                     0540 01301000
@RF00538 L     @07,RSPTWKC(,REG6)                                  0540 01302000
         L     @07,PTDITCUR(,@07)                                  0540 01303000
         TM    DITFADEL(@07),B'00010000'                           0540 01304000
         BNO   @RF00540                                            0540 01305000
*          IF DITFBHEP = ON THEN                                   0541 01306000
         TM    DITFBHEP(@07),B'10000000'                           0541 01307000
         BNO   @RF00541                                            0541 01308000
*            EXTGOCI = 0;              /*DELETE HORIZONTAL           */ 01309000
         L     @07,RSCPE2(,REG6)                                   0542 01310000
         SLR   @04,@04                                             0542 01311000
         STCM  @04,7,EXTGOCI(@07)                                  0542 01312000
*          ELSE                                                    0543 01313000
*            IF DITFBGOE = ON THEN                                 0543 01314000
         B     @RC00541                                            0543 01315000
@RF00541 L     @07,RSPTWKC(,REG6)                                  0543 01316000
         L     @07,PTDITCUR(,@07)                                  0543 01317000
         TM    DITFBGOE(@07),B'01000000'                           0543 01318000
         BNO   @RF00543                                            0543 01319000
*              DO;                                                 0544 01320000
*                CATGODEL = ON;        /*DELETE GOP                  */ 01321000
         L     @07,RSCPE5(,REG6)                                   0545 01322000
         OI    CATGODEL(@07),B'01000000'                           0545 01323000
*                CATGOCI = 0;          /*CLEAR CIN                   */ 01324000
         SLR   @04,@04                                             0546 01325000
         STCM  @04,7,CATGOCI(@07)                                  0546 01326000
*              END;                                                0547 01327000
*            ELSE                                                  0548 01328000
*                                                                  0548 01329000
*              DO;                                                 0548 01330000
         B     @RC00543                                            0548 01331000
@RF00543 DS    0H                                                  0549 01332000
*              /*CALL CKERR*/                                      0549 01333000
*                RSCKERR = RSCKERR && RSCKERR;                     0549 01334000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0549 01335000
*                RSCKERN = RSE100;                                 0550 01336000
         MVC   RSCKERN(2,REG6),@CH00143                            0550 01337000
*                RSCKTERM = 'TERM';                                0551 01338000
*                                                                  0551 01339000
         MVC   RSCKTERM(4,REG6),@CC03762                           0551 01340000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */ 01341000
*              CALL CKERR;                                         0552 01342000
         L     @15,@CV03449                                        0552 01343000
         BALR  @14,@15                                             0552 01344000
*              END; /*BUG                        */                0553 01345000
*                                                                  0553 01346000
*        /************************************************************/ 01347000
*        /*                                                          */ 01348000
*        /*     UPDATE REASSIGNED CIN                                */ 01349000
*        /*                                                          */ 01350000
*        /************************************************************/ 01351000
*                                                                  0554 01352000
*        ELSE                                                      0554 01353000
*          IF DITFBHEP = ON THEN                                   0554 01354000
         B     @RC00540                                            0554 01355000
@RF00540 L     @07,RSPTWKC(,REG6)                                  0554 01356000
         L     @04,PTDITCUR(,@07)                                  0554 01357000
         TM    DITFBHEP(@04),B'10000000'                           0554 01358000
         BNO   @RF00554                                            0554 01359000
*            EXTGOCI = CITRCIN;        /*HORIZONTAL REASSIGNED       */ 01360000
         L     @04,RSCPE2(,REG6)                                   0555 01361000
         L     @07,PTCITWK(,@07)                                   0555 01362000
         MVC   EXTGOCI(3,@04),CITRCIN(@07)                         0555 01363000
*          ELSE                                                    0556 01364000
*            IF DITFBGOE = ON THEN                                 0556 01365000
         B     @RC00554                                            0556 01366000
@RF00554 L     @07,RSPTWKC(,REG6)                                  0556 01367000
         L     @04,PTDITCUR(,@07)                                  0556 01368000
         TM    DITFBGOE(@04),B'01000000'                           0556 01369000
         BNO   @RF00556                                            0556 01370000
*              CATGOCI = CITRCIN;      /*GOP REASSIGNED              */ 01371000
         L     @04,RSCPE5(,REG6)                                   0557 01372000
         L     @07,PTCITWK(,@07)                                   0557 01373000
         MVC   CATGOCI(3,@04),CITRCIN(@07)                         0557 01374000
*            ELSE                                                  0558 01375000
*              DO;                                                 0558 01376000
         B     @RC00556                                            0558 01377000
@RF00556 DS    0H                                                  0559 01378000
*                RSCPE6 = RSCPE3 + CATGODSP; /*POINT TO GO           */ 01379000
         L     @07,RSCPE5(,REG6)                                   0559 01380000
         ICM   @07,12,CATGODSP(@07)                                0559 01381000
         SRA   @07,16                                              0559 01382000
         AL    @07,RSCPE3(,REG6)                                   0559 01383000
         ST    @07,RSCPE6(,REG6)                                   0559 01384000
*                IF DITFBAS1 = ON THEN                             0560 01385000
         L     @04,RSPTWKC(,REG6)                                  0560 01386000
         L     @04,PTDITCUR(,@04)                                  0560 01387000
         TM    DITFBAS1(@04),B'00100000'                           0560 01388000
         BNO   @RF00560                                            0560 01389000
*                  IF DITCITAB = 0 THEN                            0561 01390000
         L     @04,DITCITAB-1(,@04)                                0561 01391000
         LA    @04,0(,@04)                                         0561 01392000
         LTR   @04,@04                                             0561 01393000
         BNZ   @RF00561                                            0561 01394000
*                    ASCI = 0;         /*REPAIR ALIAS CHAIN          */ 01395000
         SLR   @04,@04                                             0562 01396000
         STCM  @04,7,ASCI(@07)                                     0562 01397000
*                  ELSE                                            0563 01398000
*                    ASCI = CITRCIN;   /*ASSN NAME1 REASSIGNED       */ 01399000
         B     @RC00561                                            0563 01400000
@RF00561 L     @07,RSCPE6(,REG6)                                   0563 01401000
         L     @04,RSPTWKC(,REG6)                                  0563 01402000
         L     @04,PTCITWK(,@04)                                   0563 01403000
         MVC   ASCI(3,@07),CITRCIN(@04)                            0563 01404000
*                ELSE                                              0564 01405000
*                  IF DITFBAS2 = ON THEN                           0564 01406000
         B     @RC00560                                            0564 01407000
@RF00560 L     @07,RSPTWKC(,REG6)                                  0564 01408000
         L     @04,PTDITCUR(,@07)                                  0564 01409000
         TM    DITFBAS2(@04),B'00010000'                           0564 01410000
         BNO   @RF00564                                            0564 01411000
*                    ASCI2 = CITRCIN;  /*ASSN NAME2 REASSIGNED       */ 01412000
         L     @04,RSCPE6(,REG6)                                   0565 01413000
         L     @07,PTCITWK(,@07)                                   0565 01414000
         MVC   ASCI2(3,@04),CITRCIN(@07)                           0565 01415000
*                  ELSE                                            0566 01416000
*                                                                  0566 01417000
*                    DO;                                           0566 01418000
         B     @RC00564                                            0566 01419000
@RF00564 DS    0H                                                  0567 01420000
*                    /*CALL CKERR*/                                0567 01421000
*                      RSCKERR = RSCKERR && RSCKERR;               0567 01422000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0567 01423000
*                      RSCKERN = RSE100;                           0568 01424000
         MVC   RSCKERN(2,REG6),@CH00143                            0568 01425000
*                      RSCKTERM = 'TERM';                          0569 01426000
*                                                                  0569 01427000
         MVC   RSCKTERM(4,REG6),@CC03762                           0569 01428000
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR   */ 01429000
*                    CALL CKERR;                                   0570 01430000
         L     @15,@CV03449                                        0570 01431000
         BALR  @14,@15                                             0570 01432000
*                    END; /*BAD DITABE           */                0571 01433000
*              END;                                                0572 01434000
*                                                                  0572 01435000
@RC00564 DS    0H                                                  0572 01436000
@RC00560 DS    0H                                                  0573 01437000
*        RFY CITABE;                   /*REVERT                      */ 01438000
@RC00556 DS    0H                                                  0573 01439000
@RC00554 DS    0H                                                  0573 01440000
@RC00540 DS    0H                                                  0574 01441000
* CALL EXIT;  /*TERMINATE*/                                        0574 01442000
         BAL   @14,EXIT                                            0574 01443000
* END CINALTER; /*END OF PROCEDURE*/                               0575 01444000
@EL00003 DS    0H                                                  0575 01445000
@EF00003 DS    0H                                                  0575 01446000
@ER00003 BR    @14                                                 0575 01447000
@PB00003 DS    0H                                                  0576 01448000
*/********************************************************************/ 01449000
*/*                                                                  */ 01450000
*/* PROCEDURE NAME - LOCDIT                                          */ 01451000
*/*                                                                  */ 01452000
*/* FUNCTION -                                                       */ 01453000
*/*    LOCDIT LOCATES A DITABE; I.E., A CIN WITHIN A RECORD.         */ 01454000
*/*    IT HAS 2 MODES:                                               */ 01455000
*/*      (1) START SCAN - PTLOC IS ALL ZEROS EXCEPT:                 */ 01456000
*/*              PTLBCIT - INDEX OF BASE CITABE                      */ 01457000
*/*              PTLDITFB - FLAG B MATCH                             */ 01458000
*/*              PTLDITTYP - RECORD TYPE MATCH                       */ 01459000
*/*      (2) CONTINUE SCAN - SUBSEQUENT CALL, SCANS FROM THE LAST    */ 01460000
*/*              ENTRY RETURNED PREVIOUSLY.                          */ 01461000
*/*                                                                  */ 01462000
*/*    LOCDIT WILL TRY TO LOCATE A DITABE OFF THE BASE WITH A        */ 01463000
*/*    MATCHING FLAG BYTE AND MATCHING RECORD TYPE.                  */ 01464000
*/*    FOR UNCONDITIONAL NEXT ENTRY REQUESTS SET PTLDITFB AND        */ 01465000
*/*    PTLDITTYP TO ZERO.                                            */ 01466000
*/*                                                                  */ 01467000
*/* INPUT -                                                          */ 01468000
*/*    PTLBCITX - INDEX OF CITABE TO SCAN                            */ 01469000
*/*    PTLDITFB - FLAB BYTE B MASK FOR DITABE                        */ 01470000
*/*               IF ANY MATCH OR THIS IS 0 THEN ENTRY IS DESIRED.   */ 01471000
*/*    PTLDITTYP - RECORD ID                                         */ 01472000
*/*               IF SAME AS DITABE OR ZERO THEN ENTRY IS DESIRED.   */ 01473000
*/*    PTLSN - SEQUENCE NUMBER DESIRED                               */ 01474000
*/*                                                                  */ 01475000
*/* OUTPUT -                                                         */ 01476000
*/*    PTLCDIT - ADDRESS OF DITABE                                   */ 01477000
*/*                                                                  */ 01478000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 01479000
*/*                                                                  */ 01480000
*/********************************************************************/ 01481000
*      GENERATE;                                                   0576 01482000
         DS    0F                                                       01483000
NAME0040 DC    CL8'LOCDIT'                                              01484000
*LOCDIT: PROCEDURE                                                 0577 01485000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0577 01486000
*                                                                  0577 01487000
         B     @PB00004                                            0577 01488000
LOCDIT   DS    0H                                                  0578 01489000
*      GENERATE REFS(RS02RG08, REG6);                              0578 01490000
*                                                                  0578 01491000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          01492000
         LR    @15,@13  OLD SAVE AREA                                   01493000
         LA    @13,72(@13)  NEW SAVE AREA                               01494000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     01495000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        01496000
         ENTRY LOCDIT  ENTRY POINT                                      01497000
         LM    @08,@12,RS02RG08(REG6)  PRIME BASE AND DATA REGS         01498000
         MVC   0(4,@15),NAME0040  PROCNAME TO REGSAVE                   01499000
*        OLDERID2 = NEWERID2;                                      0579 01500000
         L     @07,GDTTR2(,REG5)                                   0579 01501000
         MVC   @TS00001(95),NEWERID2(@07)                          0579 01502000
         MVC   OLDERID2(95,@07),@TS00001                           0579 01503000
*        NEWID2 = 'RSLO';                                          0580 01504000
*                                                                  0580 01505000
         MVC   NEWID2(4,@07),@CC03767                              0580 01506000
*        RFY CITABE BASED(PTLCCIT);                                0581 01507000
*                                                                  0581 01508000
*        /************************************************************/ 01509000
*        /*                                                          */ 01510000
*        /* IF THIS IS THE START OF THE SCAN THEN START THE SCAN     */ 01511000
*        /* AT THE BASE RECORD SPECIFIED.                            */ 01512000
*        /*                                                          */ 01513000
*        /************************************************************/ 01514000
*                                                                  0582 01515000
*        IF PTLCCIT = 0 THEN                                       0582 01516000
         L     @07,RSPTWKC(,REG6)                                  0582 01517000
         L     @04,PTLCCIT(,@07)                                   0582 01518000
         LTR   @04,@04                                             0582 01519000
         BNZ   @RF00582                                            0582 01520000
*          DO;                                                     0583 01521000
*            RSTANCHR = ADDR(RSGCITS); /*CI TABLE SCAN               */ 01522000
         LA    @04,RSGCITS(,REG6)                                  0584 01523000
         ST    @04,RSTANCHR(,REG6)                                 0584 01524000
*            RSTENTIX = PTLBCITX;      /*SCAN OF BASE                */ 01525000
         MVC   RSTENTIX(3,REG6),PTLBCITX(@07)                      0585 01526000
*            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE        */ 01527000
*            CALL GETNEXTE;                                        0586 01528000
         L     @15,@CV03436                                        0586 01529000
         BALR  @14,@15                                             0586 01530000
*            PTLCCIT = RSTENTAD;       /*CITABE ADDRESS              */ 01531000
         L     @07,RSPTWKC(,REG6)                                  0587 01532000
         L     @04,RSTENTAD(,REG6)                                 0587 01533000
         ST    @04,PTLCCIT(,@07)                                   0587 01534000
*            PTLNDIT = CITDITAB;       /*FIRST DITABE INDEX          */ 01535000
         MVC   PTLNDIT(3,@07),CITDITAB(@04)                        0588 01536000
*          END;                                                    0589 01537000
*                                                                  0589 01538000
*        /************************************************************/ 01539000
*        /*                                                          */ 01540000
*        /*  IF CONTINUOUS SCAN, THEN POINT TO THE NEXT CIN IN THE   */ 01541000
*        /*  RECORD (OR OUT OF THE RECORD)                           */ 01542000
*        /*                                                          */ 01543000
*        /************************************************************/ 01544000
*                                                                  0590 01545000
*        ELSE                                                      0590 01546000
*          PTLNDIT = PTLNDIT + 1;                                  0590 01547000
*                                                                  0590 01548000
         B     @RC00582                                            0590 01549000
@RF00582 L     @07,RSPTWKC(,REG6)                                  0590 01550000
         LA    @04,1                                               0590 01551000
         L     @15,PTLNDIT-1(,@07)                                 0590 01552000
         LA    @15,0(,@15)                                         0590 01553000
         ALR   @04,@15                                             0590 01554000
         STCM  @04,7,PTLNDIT(@07)                                  0590 01555000
*        /************************************************************/ 01556000
*        /*                                                          */ 01557000
*        /* SCAN THE RECORD AND ALL OF ITS EXTENSIONS FOR THE        */ 01558000
*        /* DESIRED ENTRY.                                           */ 01559000
*        /*                                                          */ 01560000
*        /************************************************************/ 01561000
*                                                                  0591 01562000
*        PTF1HIT = OFF;                /*INDICATE ENTRY NOT FOUND    */ 01563000
@RC00582 L     @07,RSPTWKC(,REG6)                                  0591 01564000
         NI    PTF1HIT(@07),B'01111111'                            0591 01565000
*        DO WHILE (PTF1HIT=OFF & PTLCCIT^=0);                      0592 01566000
*                                                                  0592 01567000
         B     @DE00592                                            0592 01568000
@DL00592 DS    0H                                                  0593 01569000
*        /************************************************************/ 01570000
*        /*                                                          */ 01571000
*        /*     SCAN ALL CINS IN THIS RECORD FOR A MATCH             */ 01572000
*        /*                                                          */ 01573000
*        /************************************************************/ 01574000
*                                                                  0593 01575000
*        RFY DITABE BASED(PTLCDIT);                                0593 01576000
*          IF (PTLNDIT ^= 0) & (PTLNDIT =< (CITDITAB + CITDICNT - 1))   01577000
*           THEN                                                   0594 01578000
*                                                                  0594 01579000
         L     @07,RSPTWKC(,REG6)                                  0594 01580000
         L     @04,PTLNDIT-1(,@07)                                 0594 01581000
         LA    @04,0(,@04)                                         0594 01582000
         LTR   @04,@04                                             0594 01583000
         BZ    @RF00594                                            0594 01584000
         L     @07,PTLCCIT(,@07)                                   0594 01585000
         L     @15,CITDITAB-1(,@07)                                0594 01586000
         LA    @15,0(,@15)                                         0594 01587000
         SLR   @14,@14                                             0594 01588000
         IC    @14,CITDICNT(,@07)                                  0594 01589000
         ALR   @15,@14                                             0594 01590000
         BCTR  @15,0                                               0594 01591000
         CR    @04,@15                                             0594 01592000
         BH    @RF00594                                            0594 01593000
*            DO PTLNDIT = PTLNDIT TO (CITDITAB + CITDICNT - 1)     0595 01594000
*             WHILE(PTF1HIT=OFF);                                  0595 01595000
*                                                                  0595 01596000
         B     @DE00595                                            0595 01597000
@DL00595 L     @07,RSPTWKC(,REG6)                                  0595 01598000
         TM    PTF1HIT(@07),B'10000000'                            0595 01599000
         BNZ   @DC00595                                            0595 01600000
*        /************************************************************/ 01601000
*        /*                                                          */ 01602000
*        /*     GET THE NEXT CIN IN THE RECORD                       */ 01603000
*        /*                                                          */ 01604000
*        /************************************************************/ 01605000
*                                                                  0596 01606000
*              RSTANCHR = ADDR(RSGDITS);                           0596 01607000
         LA    @04,RSGDITS(,REG6)                                  0596 01608000
         ST    @04,RSTANCHR(,REG6)                                 0596 01609000
*              RSTENTIX = PTLNDIT;     /*DITABE LOCATE               */ 01610000
         MVC   RSTENTIX(3,REG6),PTLNDIT(@07)                       0597 01611000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 01612000
*              CALL GETNEXTE;                                      0598 01613000
         L     @15,@CV03436                                        0598 01614000
         BALR  @14,@15                                             0598 01615000
*              PTLCDIT = RSTENTAD;     /*SAVE ENTRY ADDRESS          */ 01616000
*                                                                  0599 01617000
         L     @07,RSPTWKC(,REG6)                                  0599 01618000
         L     @04,RSTENTAD(,REG6)                                 0599 01619000
         ST    @04,PTLCDIT(,@07)                                   0599 01620000
*        /************************************************************/ 01621000
*        /*                                                          */ 01622000
*        /*     CHECK FOR MATCHING TYPE                              */ 01623000
*        /*                                                          */ 01624000
*        /************************************************************/ 01625000
*                                                                  0600 01626000
*              IF (PTLDITFB='00'X) | ((PTLDITFB&DITFLB)^='00'X)    0600 01627000
*               THEN                                               0600 01628000
*                                                                  0600 01629000
         CLI   PTLDITFB(@07),X'00'                                 0600 01630000
         BE    @RT00600                                            0600 01631000
         MVC   @TS00001(1),PTLDITFB(@07)                           0600 01632000
         NC    @TS00001(1),DITFLB(@04)                             0600 01633000
         CLI   @TS00001,X'00'                                      0600 01634000
         BE    @RF00600                                            0600 01635000
@RT00600 DS    0H                                                  0601 01636000
*        /************************************************************/ 01637000
*        /*                                                          */ 01638000
*        /*     CHECK FOR MATCHING RECORD ID                         */ 01639000
*        /*       IGNORE ENTRY TYPE CHECK FOR ALIAS ASSOCIATION      */ 01640000
*        /*       FORWARD OR BACKWARD CHAIN OF 0. THERE IS NO        */ 01641000
*        /*       CITABLE ENTRY FOR THIS ASSOCIATION.                */ 01642000
*        /*                                                          */ 01643000
*        /************************************************************/ 01644000
*                                                                  0601 01645000
*                DO;                                               0601 01646000
*                  IF PTLDITID = '00'X |                           0602 01647000
*                   (PTLDITID = ALIASID & DITCITAB = 0)            0602 01648000
*                   THEN;              /*UNCOND OR ALIAS END         */ 01649000
         L     @07,RSPTWKC(,REG6)                                  0602 01650000
         CLI   PTLDITID(@07),X'00'                                 0602 01651000
         BE    @RT00602                                            0602 01652000
         CLI   PTLDITID(@07),C'X'                                  0602 01653000
         BNE   @RF00602                                            0602 01654000
         L     @07,PTLCDIT(,@07)                                   0602 01655000
         L     @07,DITCITAB-1(,@07)                                0602 01656000
         LA    @07,0(,@07)                                         0602 01657000
         LTR   @07,@07                                             0602 01658000
         BZ    @RT00602                                            0602 01659000
*                  ELSE                /*CONDITIONAL LOCATE          */ 01660000
*                    DO;                                           0604 01661000
@RF00602 DS    0H                                                  0605 01662000
*                      RSTANCHR = ADDR(RSGCITS); /*FIND CITABE       */ 01663000
         LA    @07,RSGCITS(,REG6)                                  0605 01664000
         ST    @07,RSTANCHR(,REG6)                                 0605 01665000
*                      RSTENTIX = DITCITAB; /*INDEX OF CI TAB ENTRY  */ 01666000
         L     @07,RSPTWKC(,REG6)                                  0606 01667000
         L     @07,PTLCDIT(,@07)                                   0606 01668000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      0606 01669000
*                      /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE 01670000
*                                                                    */ 01671000
*                      CALL GETNEXTE;                              0607 01672000
         L     @15,@CV03436                                        0607 01673000
         BALR  @14,@15                                             0607 01674000
*                    END;                                          0608 01675000
*                  IF (PTLDITID='00'X) |                           0609 01676000
*                   (PTLDITID = ALIASID & DITCITAB = 0) |          0609 01677000
*                   (RSTENTAD->CITTYPE=PTLDITID) THEN              0609 01678000
*                                                                  0609 01679000
@RT00602 L     @07,RSPTWKC(,REG6)                                  0609 01680000
         CLI   PTLDITID(@07),X'00'                                 0609 01681000
         BE    @RT00609                                            0609 01682000
         CLI   PTLDITID(@07),C'X'                                  0609 01683000
         BNE   @GL00009                                            0609 01684000
         L     @07,PTLCDIT(,@07)                                   0609 01685000
         L     @07,DITCITAB-1(,@07)                                0609 01686000
         LA    @07,0(,@07)                                         0609 01687000
         LTR   @07,@07                                             0609 01688000
         BZ    @RT00609                                            0609 01689000
@GL00009 L     @07,RSTENTAD(,REG6)                                 0609 01690000
         L     @04,RSPTWKC(,REG6)                                  0609 01691000
         CLC   CITTYPE(1,@07),PTLDITID(@04)                        0609 01692000
         BNE   @RF00609                                            0609 01693000
@RT00609 DS    0H                                                  0610 01694000
*                    IF (PTLSN=0) | (PTLSN=DITSN) THEN             0610 01695000
         L     @07,RSPTWKC(,REG6)                                  0610 01696000
         LH    @04,PTLSN(,@07)                                     0610 01697000
         LTR   @04,@04                                             0610 01698000
         BZ    @RT00610                                            0610 01699000
         L     @07,PTLCDIT(,@07)                                   0610 01700000
         CH    @04,DITSN(,@07)                                     0610 01701000
         BNE   @RF00610                                            0610 01702000
@RT00610 DS    0H                                                  0611 01703000
*                      PTF1HIT = ON; /*FOUND MATCH                   */ 01704000
*                                                                  0611 01705000
         L     @07,RSPTWKC(,REG6)                                  0611 01706000
         OI    PTF1HIT(@07),B'10000000'                            0611 01707000
*                END;                                              0612 01708000
@RF00610 DS    0H                                                  0612 01709000
@RF00609 DS    0H                                                  0613 01710000
*            END;                                                  0613 01711000
@RF00600 L     @07,RSPTWKC(,REG6)                                  0613 01712000
         LA    @04,1                                               0613 01713000
         L     @07,PTLNDIT-1(,@07)                                 0613 01714000
         LA    @07,0(,@07)                                         0613 01715000
         ALR   @04,@07                                             0613 01716000
         L     @07,RSPTWKC(,REG6)                                  0613 01717000
         STCM  @04,7,PTLNDIT(@07)                                  0613 01718000
@DE00595 L     @07,RSPTWKC(,REG6)                                  0613 01719000
         L     @07,PTLCCIT(,@07)                                   0613 01720000
         L     @01,RSPTWKC(,REG6)                                  0613 01721000
         L     @01,PTLCCIT(,@01)                                   0613 01722000
         L     @07,CITDITAB-1(,@07)                                0613 01723000
         LA    @07,0(,@07)                                         0613 01724000
         SLR   @00,@00                                             0613 01725000
         IC    @00,CITDICNT(,@01)                                  0613 01726000
         ALR   @07,@00                                             0613 01727000
         BCTR  @07,0                                               0613 01728000
         CR    @04,@07                                             0613 01729000
         BNH   @DL00595                                            0613 01730000
@DC00595 DS    0H                                                  0614 01731000
*        RFY DITABE;                   /*REVERT                      */ 01732000
*                                                                  0614 01733000
@RF00594 DS    0H                                                  0615 01734000
*        /************************************************************/ 01735000
*        /*                                                          */ 01736000
*        /*     IF ENTRY NOT FOUND, CONTINUE AT EXTENSION.           */ 01737000
*        /*                                                          */ 01738000
*        /************************************************************/ 01739000
*                                                                  0615 01740000
*          PTLNDIT = PTLNDIT - 1;      /*GET TRUE DITABE INDEX       */ 01741000
         L     @07,RSPTWKC(,REG6)                                  0615 01742000
         L     @04,PTLNDIT-1(,@07)                                 0615 01743000
         LA    @04,0(,@04)                                         0615 01744000
         BCTR  @04,0                                               0615 01745000
         STCM  @04,7,PTLNDIT(@07)                                  0615 01746000
*          IF PTF1HIT = OFF THEN                                   0616 01747000
         TM    PTF1HIT(@07),B'10000000'                            0616 01748000
         BNZ   @RF00616                                            0616 01749000
*            IF CITEXTCH = 0 THEN      /*NO MORE EXTENSIONS          */ 01750000
         L     @04,PTLCCIT(,@07)                                   0617 01751000
         L     @04,CITEXTCH-1(,@04)                                0617 01752000
         LA    @04,0(,@04)                                         0617 01753000
         LTR   @04,@04                                             0617 01754000
         BNZ   @RF00617                                            0617 01755000
*              PTLCCIT = 0;                                        0618 01756000
         SLR   @04,@04                                             0618 01757000
         ST    @04,PTLCCIT(,@07)                                   0618 01758000
*            ELSE                      /*EXTENSION EXISTS            */ 01759000
*              DO;                                                 0619 01760000
         B     @RC00617                                            0619 01761000
@RF00617 DS    0H                                                  0620 01762000
*                RSTANCHR = ADDR(RSGCITS);                         0620 01763000
         LA    @07,RSGCITS(,REG6)                                  0620 01764000
         ST    @07,RSTANCHR(,REG6)                                 0620 01765000
*                RSTENTIX = CITEXTCH;                              0621 01766000
         L     @07,RSPTWKC(,REG6)                                  0621 01767000
         L     @07,PTLCCIT(,@07)                                   0621 01768000
         MVC   RSTENTIX(3,REG6),CITEXTCH(@07)                      0621 01769000
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE    */ 01770000
*                CALL GETNEXTE;                                    0622 01771000
         L     @15,@CV03436                                        0622 01772000
         BALR  @14,@15                                             0622 01773000
*                PTLCCIT = RSTENTAD;   /*EXTENSION RECORD            */ 01774000
         L     @07,RSPTWKC(,REG6)                                  0623 01775000
         L     @04,RSTENTAD(,REG6)                                 0623 01776000
         ST    @04,PTLCCIT(,@07)                                   0623 01777000
*                PTLNDIT = CITDITAB;   /*FIRST CIN IN THE RECORD     */ 01778000
         MVC   PTLNDIT(3,@07),CITDITAB(@04)                        0624 01779000
*              END;                                                0625 01780000
*        END;                                                      0626 01781000
*                                                                  0626 01782000
@RC00617 DS    0H                                                  0626 01783000
@RF00616 DS    0H                                                  0626 01784000
@DE00592 L     @07,RSPTWKC(,REG6)                                  0626 01785000
         TM    PTF1HIT(@07),B'10000000'                            0626 01786000
         BNZ   @DC00592                                            0626 01787000
         L     @07,PTLCCIT(,@07)                                   0626 01788000
         LTR   @07,@07                                             0626 01789000
         BNZ   @DL00592                                            0626 01790000
@DC00592 DS    0H                                                  0627 01791000
*        /************************************************************/ 01792000
*        /*                                                          */ 01793000
*        /*  IF NO ENTRY FOUND, INDICATE NO DITABE                   */ 01794000
*        /*                                                          */ 01795000
*        /************************************************************/ 01796000
*                                                                  0627 01797000
*        IF PTF1HIT = OFF THEN                                     0627 01798000
         L     @07,RSPTWKC(,REG6)                                  0627 01799000
         TM    PTF1HIT(@07),B'10000000'                            0627 01800000
         BNZ   @RF00627                                            0627 01801000
*          PTLCDIT = 0;                                            0628 01802000
         SLR   @04,@04                                             0628 01803000
         ST    @04,PTLCDIT(,@07)                                   0628 01804000
*        RFY CITABE;                   /*REVERT                      */ 01805000
@RF00627 DS    0H                                                  0630 01806000
* CALL EXIT;  /*TERMINATE*/                                        0630 01807000
         BAL   @14,EXIT                                            0630 01808000
* END LOCDIT; /*END OF PROCEDURE*/                                 0631 01809000
@EL00004 DS    0H                                                  0631 01810000
@EF00004 DS    0H                                                  0631 01811000
@ER00004 BR    @14                                                 0631 01812000
@PB00004 DS    0H                                                  0632 01813000
*/********************************************************************/ 01814000
*/*                                                                  */ 01815000
*/* PROCEDURE NAME - PROCCI                                          */ 01816000
*/*                                                                  */ 01817000
*/* FUNCTION -                                                       */ 01818000
*/*    PROCCI RECEIVES A CIN FROM A RECORD ON A CALL FROM SCANCI.    */ 01819000
*/*    A DITABE (DISPLACEMENT TABLE ENTRY) WILL BE CREATED TO        */ 01820000
*/*    REPRESENT THIS CIN IN THE RECORD BEING PROCESSED BY SCANCI.   */ 01821000
*/*    THE DITABE DESCRIBES THE OFFSET INTO THE RECORD TO THE CIN    */ 01822000
*/*    AND WHAT THE CIN REPRESENTS (E.G., ASSOCIATION). THE CITABE   */ 01823000
*/*    (CI TABLE) FOR THIS SET OF RECORDS IS SCANNED TO DETERMINE    */ 01824000
*/*    IF THE CIN ALREADY EXISTS IN ANOTHER RECORD; IT NOT A CITAB   */ 01825000
*/*    (CI TABLE ENTRY) IS CREATED FOR THIS CIN. THE DITABE WILL     */ 01826000
*/*    POINT TO THE CIN IT REPRESENTS AND THE CITABE FOR THE RECORD  */ 01827000
*/*    BEING PROCESSED WILL POINT TO THE FIRST DITABE FOR THAT       */ 01828000
*/*    RECORD.                                                       */ 01829000
*/*                                                                  */ 01830000
*/* INPUT -                                                          */ 01831000
*/*    RSCPE5 - ADDRESS OF THE CIN(HORIZONTAL) OR GOP                */ 01832000
*/*    RSCITDUM - THE DUMMY CITABE CREATED TO REPRESENT THIS CIN.    */ 01833000
*/*    PTCITCUR - ADDRESS OF THE CITABE FOR THE RECORD BEING SCANNED */ 01834000
*/*                                                                  */ 01835000
*/* OUTPUT -                                                         */ 01836000
*/*    NO INFORMATION IS RETURNED. THE ENTRY IS ADDED PER THE        */ 01837000
*/*    FUNCTION DESCRIPTION.                                         */ 01838000
*/*                                                                  */ 01839000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 01840000
*/*                                                                  */ 01841000
*/********************************************************************/ 01842000
*      GENERATE;                                                   0632 01843000
         DS    0F                                                       01844000
NAME0046 DC    CL8'PROCCI'                                              01845000
*PROCCI: PROCEDURE                                                 0633 01846000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0633 01847000
*                                                                  0633 01848000
         B     @PB00005                                            0633 01849000
PROCCI   DS    0H                                                  0634 01850000
*      GENERATE REFS(RS02RG08, REG6);                              0634 01851000
*                                                                  0634 01852000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          01853000
         LR    @15,@13  OLD SAVE AREA                                   01854000
         LA    @13,72(@13)  NEW SAVE AREA                               01855000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     01856000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        01857000
         MVC   0(4,@15),NAME0046  PROCNAME TO REGSAVE                   01858000
*         OLDERID2 = NEWERID2;                                     0635 01859000
         L     @07,GDTTR2(,REG5)                                   0635 01860000
         MVC   @TS00001(95),NEWERID2(@07)                          0635 01861000
         MVC   OLDERID2(95,@07),@TS00001                           0635 01862000
*         NEWID2 = 'RSPT';                                         0636 01863000
*                                                                  0636 01864000
         MVC   NEWID2(4,@07),@CC03774                              0636 01865000
*        /************************************************************/ 01866000
*        /*                                                          */ 01867000
*        /* GET A DITABE FOR THIS CIN                                */ 01868000
*        /*                                                          */ 01869000
*        /************************************************************/ 01870000
*                                                                  0637 01871000
*        RSTANCHR = ADDR(RSGDITS);     /*POINT TO DITAB BASE         */ 01872000
*                                                                  0637 01873000
         LA    @07,RSGDITS(,REG6)                                  0637 01874000
         ST    @07,RSTANCHR(,REG6)                                 0637 01875000
*        /* GET A FREE DITABE */                                   0638 01876000
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETFIT              */ 01877000
*        CALL GETFIT;                                              0638 01878000
*                                                                  0638 01879000
         L     @15,@CV03435                                        0638 01880000
         BALR  @14,@15                                             0638 01881000
*        IF PTDITI = 0 THEN            /*FIRST GDIT - RECORD         */ 01882000
         L     @07,RSPTWKC(,REG6)                                  0639 01883000
         L     @04,PTDITI-1(,@07)                                  0639 01884000
         LA    @04,0(,@04)                                         0639 01885000
         LTR   @04,@04                                             0639 01886000
         BNZ   @RF00639                                            0639 01887000
*          DO;                                                     0640 01888000
*            PTDITI = RSGDITNU;        /*INDEX OF FIRST DITABE       */ 01889000
         MVC   PTDITI(3,@07),RSGDITNU(REG6)                        0641 01890000
*            PTDITF = RSTENTAD;        /*ADDRESS OF FIRST DITABE     */ 01891000
         L     @04,RSTENTAD(,REG6)                                 0642 01892000
         ST    @04,PTDITF(,@07)                                    0642 01893000
*          END;                                                    0643 01894000
*        PTDITL = RSGDITNU;            /*LAST ENTRY INDEX            */ 01895000
@RF00639 L     @07,RSPTWKC(,REG6)                                  0644 01896000
         MVC   PTDITL(3,@07),RSGDITNU(REG6)                        0644 01897000
*        PTDITNC = RSGDITNU;           /*DITABE CURR = ONE ALLOCATED */ 01898000
         MVC   PTDITNC(3,@07),RSGDITNU(REG6)                       0645 01899000
*        PTDITCUR = RSTENTAD;          /*POINT TO NEW DITABE         */ 01900000
*                                                                  0646 01901000
         L     @04,RSTENTAD(,REG6)                                 0646 01902000
         ST    @04,PTDITCUR(,@07)                                  0646 01903000
*        /************************************************************/ 01904000
*        /*                                                          */ 01905000
*        /* IF THIS IS THE FIRST DISPACEMENT TABLE ENTRY FOR         */ 01906000
*        /* THIS RECORD THEN CHAIN THE CI TABLE ENTRY TO THIS        */ 01907000
*        /* DISPLACEMENT TABLE ENTRY.                                */ 01908000
*        /*                                                          */ 01909000
*        /************************************************************/ 01910000
*                                                                  0647 01911000
*        IF CITDICNT = 0 THEN                                      0647 01912000
         L     @04,PTCITCUR(,@07)                                  0647 01913000
         CLI   CITDICNT(@04),0                                     0647 01914000
         BNE   @RF00647                                            0647 01915000
*          CITDITAB = PTDITNC;         /*INDEX OF 1ST DITABE         */ 01916000
         MVC   CITDITAB(3,@04),PTDITNC(@07)                        0648 01917000
*        CITDICNT = CITDICNT + 1;      /*INCR NUM DITABE FOR THIS RCD*/ 01918000
*                                                                  0649 01919000
@RF00647 L     @07,RSPTWKC(,REG6)                                  0649 01920000
         L     @04,PTCITCUR(,@07)                                  0649 01921000
         LA    @15,1                                               0649 01922000
         SLR   @14,@14                                             0649 01923000
         IC    @14,CITDICNT(,@04)                                  0649 01924000
         ALR   @15,@14                                             0649 01925000
         STC   @15,CITDICNT(,@04)                                  0649 01926000
*        /************************************************************/ 01927000
*        /*                                                          */ 01928000
*        /* FORMAT A DISPLACEMENT TABLE ENTRY                        */ 01929000
*        /*   INDICATE HORIZONTAL EXTENSION                          */ 01930000
*        /*   INDICATE GOP(GROUP OCCURRENCE POINTER)                 */ 01931000
*        /*   SET THE OFFSET TO THE CIN IN THE RECORD                */ 01932000
*        /*       FOR HORIZONTAL - OFFSET TO HORIZONTAL              */ 01933000
*        /*       FOR GOP - OFFSET TO GOP                            */ 01934000
*        /*       FOR GO - OFFSET TO GOP(YES THAT'S GOP)             */ 01935000
*        /*                                                          */ 01936000
*        /************************************************************/ 01937000
*                                                                  0650 01938000
*        RFY DITABE BASED(PTDITCUR);   /*PT NEW DITABE               */ 01939000
*        RFY CITABE BASED(ADDR(RSCITDUM)); /*PT DUMMY CITABE THIS CIN*/ 01940000
*                                                                  0651 01941000
*        DITABE = DITABE&&DITABE;                                  0652 01942000
         L     @07,PTDITCUR(,@07)                                  0652 01943000
         XC    DITABE(16,@07),DITABE(@07)                          0652 01944000
*        IF CITFAHEP = ON THEN         /*HORIZONTAL EXTENSION        */ 01945000
         TM    CITFAHEP+48(REG6),B'00010000'                       0653 01946000
         BNO   @RF00653                                            0653 01947000
*          DITFBHEP = ON;                                          0654 01948000
         OI    DITFBHEP(@07),B'10000000'                           0654 01949000
*        IF CITFAGOE = ON THEN         /*GOP - GROUP OCCUR PTR       */ 01950000
@RF00653 TM    CITFAGOE+48(REG6),B'00001000'                       0655 01951000
         BNO   @RF00655                                            0655 01952000
*          DITFBGOE = ON;                                          0656 01953000
         L     @07,RSPTWKC(,REG6)                                  0656 01954000
         L     @07,PTDITCUR(,@07)                                  0656 01955000
         OI    DITFBGOE(@07),B'01000000'                           0656 01956000
*        IF (RSCPE5-RSCPE1) >=  256 THEN /*CHECK OFFSET OVER 255     */ 01957000
@RF00655 LA    @07,256                                             0657 01958000
         L     @04,RSCPE5(,REG6)                                   0657 01959000
         SL    @04,RSCPE1(,REG6)                                   0657 01960000
         CR    @04,@07                                             0657 01961000
         BL    @RF00657                                            0657 01962000
*          DO;                                                     0658 01963000
*            DITFB256 = ON;                                        0659 01964000
         L     @01,RSPTWKC(,REG6)                                  0659 01965000
         L     @15,PTDITCUR(,@01)                                  0659 01966000
         OI    DITFB256(@15),B'00000001'                           0659 01967000
*            DITOFS = RSCPE5 - RSCPE1 -  256;                      0660 01968000
         SLR   @04,@07                                             0660 01969000
         STH   @04,DITOFS(,@15)                                    0660 01970000
*          END;                                                    0661 01971000
*        ELSE                                                      0662 01972000
*          DITOFS = RSCPE5 - RSCPE1;                               0662 01973000
         B     @RC00657                                            0662 01974000
@RF00657 L     @07,RSPTWKC(,REG6)                                  0662 01975000
         L     @07,PTDITCUR(,@07)                                  0662 01976000
         L     @04,RSCPE5(,REG6)                                   0662 01977000
         SL    @04,RSCPE1(,REG6)                                   0662 01978000
         STH   @04,DITOFS(,@07)                                    0662 01979000
*          IF CITFAHEP = OFF THEN      /*MUST BE GOP OR GO           */ 01980000
@RC00657 TM    CITFAHEP+48(REG6),B'00010000'                       0663 01981000
         BNZ   @RF00663                                            0663 01982000
*            IF RSGOPLEN = CATGOPLN THEN                           0664 01983000
         CLC   RSGOPLEN(2,REG6),@CH00280                           0664 01984000
         BNE   @RF00664                                            0664 01985000
*              DITOSN = CATGOSEQ;      /*CAT GOP SEQUENCE NUM        */ 01986000
         L     @07,RSPTWKC(,REG6)                                  0665 01987000
         L     @07,PTDITCUR(,@07)                                  0665 01988000
         L     @04,RSCPE5(,REG6)                                   0665 01989000
         IC    @15,CATGOSEQ(,@04)                                  0665 01990000
         STC   @15,DITOSN(,@07)                                    0665 01991000
*            ELSE                                                  0666 01992000
*              DITVSN = CATSN;        /*VOL GOP SEQUENCE NUMBER      */ 01993000
*                                                                  0666 01994000
         B     @RC00664                                            0666 01995000
@RF00664 L     @07,RSPTWKC(,REG6)                                  0666 01996000
         L     @07,PTDITCUR(,@07)                                  0666 01997000
         L     @04,RSCPE5(,REG6)                                   0666 01998000
         MVC   DITVSN(2,@07),CATSN+4(@04)                          0666 01999000
*        /************************************************************/ 02000000
*        /*                                                          */ 02001000
*        /* IF THE CIN IS AN ASSOCIATION FOR AN ALIAS RECORD         */ 02002000
*        /* THE CIN VALUE MAY BE ZERO. SINCE ALIAS ASSOCIATIONS      */ 02003000
*        /* FORWARD AND BACKWARD CHAIN TO ONE ANOTHER, THE           */ 02004000
*        /* FIRST BACK CHAIN IS 0 AND THE LAST FORWARD CHAIN         */ 02005000
*        /* IS 0. HENCE THE DITABE ENTRY WILL BE MADE BUT WITHOUT    */ 02006000
*        /* A CONNECTOR TO A CITABE.                                 */ 02007000
*        /*                                                          */ 02008000
*        /************************************************************/ 02009000
*                                                                  0667 02010000
*        IF PTCITCUR->CITTYPE = ALIASID & CITCIN = 0 THEN;         0667 02011000
@RC00664 DS    0H                                                  0667 02012000
@RF00663 L     @07,RSPTWKC(,REG6)                                  0667 02013000
         L     @07,PTCITCUR(,@07)                                  0667 02014000
         CLI   CITTYPE(@07),C'X'                                   0667 02015000
         BNE   @RF00667                                            0667 02016000
         L     @07,CITCIN+47(,REG6)                                0667 02017000
         LA    @07,0(,@07)                                         0667 02018000
         LTR   @07,@07                                             0667 02019000
         BZ    @RT00667                                            0667 02020000
*                                      /*IGNORE 0 CIN IN ALIAS RECORD * 02021000
*                                                                  0669 02022000
*        /************************************************************/ 02023000
*        /*                                                          */ 02024000
*        /* TRY TO LOCATE AN EXISTING CI TABLE ENTRY FOR             */ 02025000
*        /* THIS CIN.                                                */ 02026000
*        /*                                                          */ 02027000
*        /************************************************************/ 02028000
*                                                                  0669 02029000
*        ELSE                                                      0669 02030000
*          DO;                                                     0669 02031000
@RF00667 DS    0H                                                  0670 02032000
*            RSTANCHR = ADDR(RSGCITS);                             0670 02033000
         LA    @07,RSGCITS(,REG6)                                  0670 02034000
         ST    @07,RSTANCHR(,REG6)                                 0670 02035000
*            PTF1HIT = OFF;            /*INIT NOT FOUND              */ 02036000
*                                                                  0671 02037000
         L     @07,RSPTWKC(,REG6)                                  0671 02038000
         NI    PTF1HIT(@07),B'01111111'                            0671 02039000
*            DO RSTENTIX = PTCITI TO PTCITL WHILE(PTF1HIT=OFF);    0672 02040000
         L     @07,PTCITI-1(,@07)                                  0672 02041000
         LA    @07,0(,@07)                                         0672 02042000
         B     @DE00672                                            0672 02043000
@DL00672 L     @07,RSPTWKC(,REG6)                                  0672 02044000
         TM    PTF1HIT(@07),B'10000000'                            0672 02045000
         BNZ   @DC00672                                            0672 02046000
*                                      /*SEARCH FOR EXISTING CITABE  */ 02047000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 02048000
*              CALL GETNEXTE;       /*GET CITABE                  */    02049000
         L     @15,@CV03436                                        0673 02050000
         BALR  @14,@15                                             0673 02051000
*              IF RSTENTAD->CITCIN = CITCIN THEN /*EXISTING ENTRY    */ 02052000
         L     @07,RSTENTAD(,REG6)                                 0674 02053000
         CLC   CITCIN(3,@07),CITCIN+48(REG6)                       0674 02054000
         BNE   @RF00674                                            0674 02055000
*                PTF1HIT = ON;                                     0675 02056000
         L     @07,RSPTWKC(,REG6)                                  0675 02057000
         OI    PTF1HIT(@07),B'10000000'                            0675 02058000
*            END;                                                  0676 02059000
*                                                                  0676 02060000
@RF00674 LA    @07,1                                               0676 02061000
         L     @04,RSTENTIX-1(,REG6)                               0676 02062000
         LA    @04,0(,@04)                                         0676 02063000
         ALR   @07,@04                                             0676 02064000
@DE00672 STCM  @07,7,RSTENTIX(REG6)                                0676 02065000
         L     @04,RSPTWKC(,REG6)                                  0676 02066000
         L     @04,PTCITL-1(,@04)                                  0676 02067000
         LA    @04,0(,@04)                                         0676 02068000
         CR    @07,@04                                             0676 02069000
         BNH   @DL00672                                            0676 02070000
@DC00672 DS    0H                                                  0677 02071000
*        /************************************************************/ 02072000
*        /*                                                          */ 02073000
*        /* IF CI TABLE ENTRY NOT FOUND THEN CREATE A NEW ONE        */ 02074000
*        /*                                                          */ 02075000
*        /************************************************************/ 02076000
*                                                                  0677 02077000
*            IF PTF1HIT = OFF THEN                                 0677 02078000
         L     @07,RSPTWKC(,REG6)                                  0677 02079000
         TM    PTF1HIT(@07),B'10000000'                            0677 02080000
         BNZ   @RF00677                                            0677 02081000
*              DO;                                                 0678 02082000
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETFIT      */ 02083000
*                CALL GETFIT;       /*GET NEW CITABE              */    02084000
         L     @15,@CV03435                                        0679 02085000
         BALR  @14,@15                                             0679 02086000
*                RSTENTAD->CITABE = CITABE; /*MOVE IN NEW ENTRY      */ 02087000
         L     @07,RSTENTAD(,REG6)                                 0680 02088000
         MVC   CITABE(20,@07),CITABE+48(REG6)                      0680 02089000
*                PTCITL = RSGCITNU;    /*SET LAST CITABE             */ 02090000
         L     @04,RSPTWKC(,REG6)                                  0681 02091000
         MVC   PTCITL(3,@04),RSGCITNU(REG6)                        0681 02092000
*                DITCITAB = RSGCITNU;  /*HOOK DITABE TO CITABE       */ 02093000
*                                                                  0682 02094000
         L     @04,PTDITCUR(,@04)                                  0682 02095000
         MVC   DITCITAB(3,@04),RSGCITNU(REG6)                      0682 02096000
*        /************************************************************/ 02097000
*        /*                                                          */ 02098000
*        /* IF EXTENSION RECORD THEN FORWARD CHAIN FROM              */ 02099000
*        /* THE BASE RECORD TO THIS ONE - THE CHAIN IS A             */ 02100000
*        /* FORWARD CHAIN THROUGH ALL THE EXTENSION RECORDS          */ 02101000
*        /* FOR THIS BASE.                                           */ 02102000
*        /* ALSO POINT THE EXTENSION TO THE BASE                     */ 02103000
*        /*                                                          */ 02104000
*        /************************************************************/ 02105000
*                                                                  0683 02106000
*                IF RSTENTAD->CITTYPE = VOLEXTID |                 0683 02107000
*                  RSTENTAD->CITTYPE = CATEXTID THEN               0683 02108000
         CLI   CITTYPE(@07),C'W'                                   0683 02109000
         BE    @RT00683                                            0683 02110000
         CLI   CITTYPE(@07),C'E'                                   0683 02111000
         BNE   @RF00683                                            0683 02112000
@RT00683 DS    0H                                                  0684 02113000
*                  DO;                                             0684 02114000
*                    IF PTCITCUR->CITEXTBA = 0 THEN                0685 02115000
         L     @07,RSPTWKC(,REG6)                                  0685 02116000
         L     @04,PTCITCUR(,@07)                                  0685 02117000
         L     @04,CITEXTBA-1(,@04)                                0685 02118000
         LA    @04,0(,@04)                                         0685 02119000
         LTR   @04,@04                                             0685 02120000
         BNZ   @RF00685                                            0685 02121000
*                                      /*CURRENT CI IS THE BASE      */ 02122000
*                      RSTENTAD->CITEXTBA = PTCITNC;               0686 02123000
         L     @04,RSTENTAD(,REG6)                                 0686 02124000
         MVC   CITEXTBA(3,@04),PTCITNC(@07)                        0686 02125000
*                    ELSE              /*BORROW BASE FROM EXTENSION  */ 02126000
*                      RSTENTAD->CITEXTBA = PTCITCUR->CITEXTBA;    0687 02127000
*                                                                  0687 02128000
         B     @RC00685                                            0687 02129000
@RF00685 L     @07,RSTENTAD(,REG6)                                 0687 02130000
         L     @04,RSPTWKC(,REG6)                                  0687 02131000
         L     @04,PTCITCUR(,@04)                                  0687 02132000
         MVC   CITEXTBA(3,@07),CITEXTBA(@04)                       0687 02133000
*                    PTCITWK = PTCITCUR; /*POINT TO CURRENT CIT      */ 02134000
@RC00685 L     @07,RSPTWKC(,REG6)                                  0688 02135000
         L     @04,PTCITCUR(,@07)                                  0688 02136000
         ST    @04,PTCITWK(,@07)                                   0688 02137000
*                    DO WHILE (PTCITWK->CITEXTCH ^= 0);            0689 02138000
         B     @DE00689                                            0689 02139000
@DL00689 DS    0H                                                  0690 02140000
*                      RSTENTIX = PTCITWK->CITEXTCH;               0690 02141000
         L     @07,RSPTWKC(,REG6)                                  0690 02142000
         L     @07,PTCITWK(,@07)                                   0690 02143000
         MVC   RSTENTIX(3,REG6),CITEXTCH(@07)                      0690 02144000
*                                      /*GET EXTENSION INDEX         */ 02145000
*                      /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE 02146000
*                                                                    */ 02147000
*                      CALL GETNEXTE;                              0691 02148000
         L     @15,@CV03436                                        0691 02149000
         BALR  @14,@15                                             0691 02150000
*                      PTCITWK = RSTENTAD;                         0692 02151000
         L     @07,RSPTWKC(,REG6)                                  0692 02152000
         L     @04,RSTENTAD(,REG6)                                 0692 02153000
         ST    @04,PTCITWK(,@07)                                   0692 02154000
*                                      /*EXTENSION CITABE            */ 02155000
*                    END;                                          0693 02156000
@DE00689 L     @07,RSPTWKC(,REG6)                                  0693 02157000
         L     @07,PTCITWK(,@07)                                   0693 02158000
         L     @04,CITEXTCH-1(,@07)                                0693 02159000
         LA    @04,0(,@04)                                         0693 02160000
         LTR   @04,@04                                             0693 02161000
         BNZ   @DL00689                                            0693 02162000
*                    PTCITWK->CITEXTCH = RSGCITNU; /*ADD EXT TO CHAIN*/ 02163000
         MVC   CITEXTCH(3,@07),RSGCITNU(REG6)                      0694 02164000
*                  END;                                            0695 02165000
*                                                                  0695 02166000
*              END;                                                0696 02167000
*                                                                  0696 02168000
*        /************************************************************/ 02169000
*        /*                                                          */ 02170000
*        /* HOOK DISPLACEMENT TABLE ENTRY INTO CI TABLE ENTRY        */ 02171000
*        /*                                                          */ 02172000
*        /************************************************************/ 02173000
*                                                                  0697 02174000
*            ELSE                                                  0697 02175000
*              DITCITAB = RSTENTIX - 1; /*HOOK TO PREV CITABE        */ 02176000
*                                                                  0697 02177000
         B     @RC00677                                            0697 02178000
@RF00677 L     @07,RSPTWKC(,REG6)                                  0697 02179000
         L     @07,PTDITCUR(,@07)                                  0697 02180000
         L     @04,RSTENTIX-1(,REG6)                               0697 02181000
         LA    @04,0(,@04)                                         0697 02182000
         BCTR  @04,0                                               0697 02183000
         STCM  @04,7,DITCITAB(@07)                                 0697 02184000
*          END;                                                    0698 02185000
*                                                                  0698 02186000
@RC00677 DS    0H                                                  0699 02187000
*        IF GDTDBG = NULLPTR                                       0699 02188000
*          THEN;                                                   0699 02189000
@RT00667 L     @07,GDTDBG(,REG5)                                   0699 02190000
         LTR   @07,@07                                             0699 02191000
         BZ    @RT00699                                            0699 02192000
*          ELSE                                                    0701 02193000
*            CALL IDCDB010(GDTTBL,'RSP4');                         0701 02194000
         ST    REG5,@AL00001                                       0701 02195000
         LA    @07,@CC03778                                        0701 02196000
         ST    @07,@AL00001+4                                      0701 02197000
         MVI   @AL00001+4,X'80'                                    0701 02198000
         L     @15,GDTDBG(,REG5)                                   0701 02199000
         LA    @01,@AL00001                                        0701 02200000
         BALR  @14,@15                                             0701 02201000
*        RFY CITABE;                   /*REVERT                      */ 02202000
@RT00699 DS    0H                                                  0703 02203000
*        RFY DITABE;                   /*REVERT                      */ 02204000
*  CALL EXIT;  /*TERMINATE*/                                       0704 02205000
         BAL   @14,EXIT                                            0704 02206000
*  END PROCCI; /*END OF PROCEDURE*/                                0705 02207000
@EL00005 DS    0H                                                  0705 02208000
@EF00005 DS    0H                                                  0705 02209000
@ER00005 BR    @14                                                 0705 02210000
@PB00005 DS    0H                                                  0706 02211000
*/********************************************************************/ 02212000
*/*                                                                  */ 02213000
*/* PROCEDURE NAME - PROCTYPE                                        */ 02214000
*/*                                                                  */ 02215000
*/* FUNCTION -                                                       */ 02216000
*/*    PROCTYPE PROCESSES A SET OF RECORDS; THIS IS THE PRINCIPAL    */ 02217000
*/*    DRIVER OF ASSOCIATION CHECKING ON A SET OF RECORDS. FIRST     */ 02218000
*/*    RECORDS ARE SCANNED FOR CONTROL INTERVAL NUMBERS (CINS),      */ 02219000
*/*    TO DETERMINE WHICH OTHER RECORDS ARE MEMBERS OF THIS          */ 02220000
*/*    SET AND TO DETERMINE WHERE, WITHIN THE SET OF RECORDS,        */ 02221000
*/*    CINS EXIST. VERCI IS CALLED TO VERIFY ASSOCIATIONS AND        */ 02222000
*/*    DETERMINE SUBSET OF RECORDS PROCESSING. SETCI WILL UPDATE     */ 02223000
*/*    ALL CINS IN A SET OF RECORDS, WHICH HAVE BEEN REASSIGNED OR   */ 02224000
*/*    ARE INVALID. FINALLY, VERDSDIR IS CALLED FOR CLUSTER AND      */ 02225000
*/*    ALTERNATEINDEXES, TO VERIFY DATA SET DIRECTORY ENTRIES        */ 02226000
*/*    (DSDIRS).                                                     */ 02227000
*/*                                                                  */ 02228000
*/* INPUT -                                                          */ 02229000
*/*    GRABCURR - CONTAINS THE ADDRESS OF THE CURRENT RAB WHICH      */ 02230000
*/*               HAS THE BASE RECORD IN THE BUFFER                  */ 02231000
*/*    RSASSTBL - CONTAINS THE ADDRESS OF THE ASSOCIATION TABLE      */ 02232000
*/*               FOR THIS SET OF RECORDS.                           */ 02233000
*/*                                                                  */ 02234000
*/* OUTPUT -                                                         */ 02235000
*/*    NONE.                                                         */ 02236000
*/*                                                                  */ 02237000
*/********************************************************************/ 02238000
*      GENERATE;                                                   0706 02239000
         DS    0F                                                       02240000
NAME0052 DC    CL8'PROCTYPE'                                            02241000
*PROCTYPE: PROCEDURE                                               0707 02242000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0707 02243000
*                                                                  0707 02244000
         B     @PB00006                                            0707 02245000
PROCTYPE DS    0H                                                  0708 02246000
*      GENERATE REFS(RS02RG08, REG6);                              0708 02247000
*                                                                  0708 02248000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          02249000
         LR    @15,@13  OLD SAVE AREA                                   02250000
         LA    @13,72(@13)  NEW SAVE AREA                               02251000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     02252000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        02253000
         ENTRY PROCTYPE  ENTRY POINT                                    02254000
         LM    @08,@12,RS02RG08(REG6)  PRIME BASE AND DATA REGS         02255000
         MVC   0(4,@15),NAME0052  PROCNAME TO REGSAVE                   02256000
*        OLDERID2 = NEWERID2;                                      0709 02257000
         L     @07,GDTTR2(,REG5)                                   0709 02258000
         MVC   @TS00001(95),NEWERID2(@07)                          0709 02259000
         MVC   OLDERID2(95,@07),@TS00001                           0709 02260000
*        NEWID2 = 'RSPT';                                          0710 02261000
*                                                                  0710 02262000
         MVC   NEWID2(4,@07),@CC03774                              0710 02263000
*        /************************************************************/ 02264000
*        /*                                                          */ 02265000
*        /* GET A WORK AREA FOR THIS RECURSION                       */ 02266000
*        /*                                                          */ 02267000
*        /************************************************************/ 02268000
*                                                                  0711 02269000
*        RSTANCHR = ADDR(RSPSTACK);    /*PTWORK STACK                */ 02270000
         LA    @07,RSPSTACK(,REG6)                                 0711 02271000
         ST    @07,RSTANCHR(,REG6)                                 0711 02272000
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETTAB              */ 02273000
*        CALL GETTAB;                                              0712 02274000
         L     @15,@CV03437                                        0712 02275000
         BALR  @14,@15                                             0712 02276000
*        PTYPEDTA = PTYPEDTA && PTYPEDTA; /*CLEAR PTWORK             */ 02277000
*                                                                  0713 02278000
         L     @07,RSPTWKC(,REG6)                                  0713 02279000
         XC    PTYPEDTA(192,@07),PTYPEDTA(@07)                     0713 02280000
*        /************************************************************/ 02281000
*        /*                                                          */ 02282000
*        /* SAVE THE ASSOC TABLE AND BASE RECORD FOR THIS            */ 02283000
*        /* RECURSION.                                               */ 02284000
*        /*                                                          */ 02285000
*        /************************************************************/ 02286000
*                                                                  0714 02287000
*        PTASSOC = RSASSTBL;                                       0714 02288000
         L     @04,RSASSTBL(,REG6)                                 0714 02289000
         ST    @04,PTASSOC(,@07)                                   0714 02290000
*        RFY TASSO BASED(PTASSOC);                                 0715 02291000
*        PTBASE = ADDR(RABBUF);                                    0716 02292000
         L     @04,RSGRABCU(,REG6)                                 0716 02293000
         L     @04,GRABCURR(,@04)                                  0716 02294000
         LA    @15,RABBUF(,@04)                                    0716 02295000
         ST    @15,PTBASE(,@07)                                    0716 02296000
*        PTCRAVL = RCDCRAVL;           /*SAVE THE DEFAULT CRA VOLSER */ 02297000
*                                                                  0717 02298000
         MVC   PTCRAVL(6,@07),RCDCRAVL+8(@04)                      0717 02299000
*        /************************************************************/ 02300000
*        /*                                                          */ 02301000
*        /* READ AND SCAN                                            */ 02302000
*        /*     EACH RECORD MUST BE READ AND SCANNED FOR CINS,       */ 02303000
*        /*     AS INDICATED IN THE ASSOCIATION TABLE. THE           */ 02304000
*        /*     TABLE INDICATES BY RECORD TYPE WHETHER IT            */ 02305000
*        /*     SHOULD BE READ AND SCANNED.                          */ 02306000
*        /*                                                          */ 02307000
*        /************************************************************/ 02308000
*                                                                  0718 02309000
*  READSCAN:                                                       0718 02310000
*        DO PTCITNC = PTCITNC TO PTCITL;                           0718 02311000
READSCAN L     @07,RSPTWKC(,REG6)                                  0718 02312000
         L     @07,PTCITNC-1(,@07)                                 0718 02313000
         LA    @07,0(,@07)                                         0718 02314000
         B     @DE00718                                            0718 02315000
@DL00718 DS    0H                                                  0719 02316000
*                                      /*PROCESS EACH CITABLE ENTRY  */ 02317000
*                                                                  0719 02318000
*        /************************************************************/ 02319000
*        /*                                                          */ 02320000
*        /*     THE FIRST RECORD ALREADY EXISTS IN THE CURRENT RAB   */ 02321000
*        /*                                                          */ 02322000
*        /************************************************************/ 02323000
*                                                                  0719 02324000
*          PTASSCUR = ADDR(TASSEN(1)); /*DEFAULT TO FIRST SUBTYPE    */ 02325000
         L     @07,RSPTWKC(,REG6)                                  0719 02326000
         L     @04,PTASSOC(,@07)                                   0719 02327000
         LA    @04,TASSEN(,@04)                                    0719 02328000
         ST    @04,PTASSCUR(,@07)                                  0719 02329000
*          IF PTCITCUR = 0 THEN;                                   0720 02330000
*                                                                  0720 02331000
         L     @07,PTCITCUR(,@07)                                  0720 02332000
         LTR   @07,@07                                             0720 02333000
         BZ    @RT00720                                            0720 02334000
*        /************************************************************/ 02335000
*        /*                                                          */ 02336000
*        /*     CHECK TO SEE IF THE NEXT CITABLE ENTRY SHOULD        */ 02337000
*        /*     BE READ.                                             */ 02338000
*        /*                                                          */ 02339000
*        /************************************************************/ 02340000
*                                                                  0722 02341000
*          ELSE                                                    0722 02342000
*            DO;                                                   0722 02343000
*              RSTANCHR = ADDR(RSGCITS);                           0723 02344000
         LA    @07,RSGCITS(,REG6)                                  0723 02345000
         ST    @07,RSTANCHR(,REG6)                                 0723 02346000
*              RSTENTIX = PTCITNC;     /*ENTRY INDEX                 */ 02347000
         L     @07,RSPTWKC(,REG6)                                  0724 02348000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       0724 02349000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 02350000
*              CALL GETNEXTE;                                      0725 02351000
         L     @15,@CV03436                                        0725 02352000
         BALR  @14,@15                                             0725 02353000
*              PTCITCUR = RSTENTAD;                                0726 02354000
         L     @07,RSPTWKC(,REG6)                                  0726 02355000
         L     @04,RSTENTAD(,REG6)                                 0726 02356000
         ST    @04,PTCITCUR(,@07)                                  0726 02357000
*                                      /*GET THE NEXT CITAB ENTRY    */ 02358000
*                                                                  0727 02359000
*        /************************************************************/ 02360000
*        /*                                                          */ 02361000
*        /*       SEARCH FOR THE ASSOCIATION TABLE ENTRY             */ 02362000
*        /*       FOR THIS RECORD TYPE BEING PROCESSED               */ 02363000
*        /*                                                          */ 02364000
*        /************************************************************/ 02365000
*                                                                  0727 02366000
*              PTASSCUR = PTASSCUR + LENGTH(TASSENT);              0727 02367000
         LA    @04,4                                               0727 02368000
         AL    @04,PTASSCUR(,@07)                                  0727 02369000
         ST    @04,PTASSCUR(,@07)                                  0727 02370000
*                                      /*ADDRESS OF FIRST SUBTYPE    */ 02371000
*              DO PTINDX1 = 2 TO TASSNENT                          0728 02372000
*                WHILE(TASSTYPE ^= CITTYPE);                       0728 02373000
         LA    @07,2                                               0728 02374000
         B     @DE00728                                            0728 02375000
@DL00728 L     @07,RSPTWKC(,REG6)                                  0728 02376000
         L     @04,PTASSCUR(,@07)                                  0728 02377000
         L     @01,PTCITCUR(,@07)                                  0728 02378000
         CLC   TASSTYPE(1,@04),CITTYPE(@01)                        0728 02379000
         BE    @DC00728                                            0728 02380000
*                PTASSCUR = PTASSCUR + LENGTH(TASSEN);             0729 02381000
         AL    @04,@CF00038                                        0729 02382000
         ST    @04,PTASSCUR(,@07)                                  0729 02383000
*                                      /*ADDRESS OF NEXT ASSOC ENT   */ 02384000
*              END;                                                0730 02385000
         L     @04,RSPTWKC(,REG6)                                  0730 02386000
         LA    @07,1                                               0730 02387000
         AH    @07,PTINDX1(,@04)                                   0730 02388000
@DE00728 L     @04,RSPTWKC(,REG6)                                  0730 02389000
         STH   @07,PTINDX1(,@04)                                   0730 02390000
         L     @04,RSPTWKC(,REG6)                                  0730 02391000
         L     @04,PTASSOC(,@04)                                   0730 02392000
         CH    @07,TASSNENT(,@04)                                  0730 02393000
         BNH   @DL00728                                            0730 02394000
@DC00728 DS    0H                                                  0731 02395000
*              IF PTINDX1 > TASSNENT THEN                          0731 02396000
         L     @07,RSPTWKC(,REG6)                                  0731 02397000
         L     @04,PTASSOC(,@07)                                   0731 02398000
         LH    @15,PTINDX1(,@07)                                   0731 02399000
         CH    @15,TASSNENT(,@04)                                  0731 02400000
         BNH   @RF00731                                            0731 02401000
*                                      /*INV ASSOC IF TYPE NOT KNOWN */ 02402000
*                CITFAINV = ON;                                    0732 02403000
         L     @07,PTCITCUR(,@07)                                  0732 02404000
         OI    CITFAINV(@07),B'00000010'                           0732 02405000
*        /************************************************************/ 02406000
*        /*                                                          */ 02407000
*        /*     READ                                                 */ 02408000
*        /*       CHECK TO SEE IF THIS ENTRY TYPE IS TO BE READ.     */ 02409000
*        /*                                                          */ 02410000
*        /************************************************************/ 02411000
*                                                                  0733 02412000
*  READCIT:                                                        0733 02413000
*              IF CITFAINV=OFF & TASSREAD=ON THEN                  0733 02414000
@RF00731 DS    0H                                                  0733 02415000
READCIT  L     @07,RSPTWKC(,REG6)                                  0733 02416000
         L     @04,PTCITCUR(,@07)                                  0733 02417000
         TM    CITFAINV(@04),B'00000010'                           0733 02418000
         BNZ   @RF00733                                            0733 02419000
         L     @04,PTASSCUR(,@07)                                  0733 02420000
         TM    TASSREAD(@04),B'10000000'                           0733 02421000
         BNO   @RF00733                                            0733 02422000
*                DO;                                               0734 02423000
*                                                                  0734 02424000
*        /************************************************************/ 02425000
*        /*                                                          */ 02426000
*        /*       SCAN ALL PREVIOUS CI TABLES TO DETERMINE IF        */ 02427000
*        /*       THIS RECORD HAS ALREADY BEEN READ AND SCANNED      */ 02428000
*        /*       AT A HIGHER LEVEL. IF SO, THEN COPY THE ENTRY      */ 02429000
*        /*       TO THIS TABLE AND USE IT.                          */ 02430000
*        /*                                                          */ 02431000
*        /************************************************************/ 02432000
*                                                                  0735 02433000
*                  RSTANCHR = ADDR(RSGCITS);                       0735 02434000
         LA    @04,RSGCITS(,REG6)                                  0735 02435000
         ST    @04,RSTANCHR(,REG6)                                 0735 02436000
*                  RSTENTIX = 0;       /*ORIENT TO FIRST ENTRY       */ 02437000
         SLR   @04,@04                                             0736 02438000
         STCM  @04,7,RSTENTIX(REG6)                                0736 02439000
*                  PTF1HIT = OFF;      /*CLEAR FOUND INDR            */ 02440000
         NI    PTF1HIT(@07),B'01111111'                            0737 02441000
*                  DO UNTIL(RSTENTAD=PTCITCUR | PTF1HIT=ON);       0738 02442000
@DL00738 DS    0H                                                  0739 02443000
*                                      /*SCAN UNTIL FND OR THIS ENTRY * 02444000
*                    RSTENTIX = RSTENTIX + 1; /*NEXT ENTRY           */ 02445000
         LA    @07,1                                               0739 02446000
         L     @04,RSTENTIX-1(,REG6)                               0739 02447000
         LA    @04,0(,@04)                                         0739 02448000
         ALR   @07,@04                                             0739 02449000
         STCM  @07,7,RSTENTIX(REG6)                                0739 02450000
*                    /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE*/ 02451000
*                    CALL GETNEXTE;                                0740 02452000
         L     @15,@CV03436                                        0740 02453000
         BALR  @14,@15                                             0740 02454000
*                                      /*GET THE NEXT CITABE         */ 02455000
*                    IF RSTENTAD->CITCIN=PTCITCUR->CITCIN &        0741 02456000
*                      RSTENTAD->CITTYPE = PTCITCUR->CITTYPE &     0741 02457000
*                      RSTENTAD->CITFASCA=ON THEN                  0741 02458000
         L     @07,RSTENTAD(,REG6)                                 0741 02459000
         L     @04,RSPTWKC(,REG6)                                  0741 02460000
         L     @15,PTCITCUR(,@04)                                  0741 02461000
         CLC   CITCIN(3,@07),CITCIN(@15)                           0741 02462000
         BNE   @RF00741                                            0741 02463000
         CLC   CITTYPE(1,@07),CITTYPE(@15)                         0741 02464000
         BNE   @RF00741                                            0741 02465000
         TM    CITFASCA(@07),B'00000100'                           0741 02466000
         BNO   @RF00741                                            0741 02467000
*                                      /*CHK FOR CIN AND SCANNED     */ 02468000
*                      DO;                                         0742 02469000
*                        PTF1HIT = ON; /*ENTRY ALREADY SCANNED       */ 02470000
         OI    PTF1HIT(@04),B'10000000'                            0743 02471000
*                        PTCITCUR->CITABE=RSTENTAD->CITABE;        0744 02472000
         MVC   CITABE(20,@15),CITABE(@07)                          0744 02473000
*                                      /*COPY THE CITAB ENTRY        */ 02474000
*                      END;                                        0745 02475000
*                  END;                                            0746 02476000
*                                                                  0746 02477000
@RF00741 DS    0H                                                  0746 02478000
@DE00738 L     @07,RSPTWKC(,REG6)                                  0746 02479000
         CLC   RSTENTAD(4,REG6),PTCITCUR(@07)                      0746 02480000
         BE    @DC00738                                            0746 02481000
         TM    PTF1HIT(@07),B'10000000'                            0746 02482000
         BNO   @DL00738                                            0746 02483000
@DC00738 DS    0H                                                  0747 02484000
*        /************************************************************/ 02485000
*        /*                                                          */ 02486000
*        /*       IF THE ENTRY SHOULD HAVE BEEN FOUND IN A HIGHER    */ 02487000
*        /*       SCAN, THEN THE BASE RECORD CONTAINS AN INVALID     */ 02488000
*        /*       ASSOCIATION TO THIS ENTRY.                         */ 02489000
*        /*                                                          */ 02490000
*        /************************************************************/ 02491000
*                                                                  0747 02492000
*                  IF TASSIS = ON THEN                             0747 02493000
         L     @07,RSPTWKC(,REG6)                                  0747 02494000
         L     @04,PTASSCUR(,@07)                                  0747 02495000
         TM    TASSIS(@04),B'00010000'                             0747 02496000
         BNO   @RF00747                                            0747 02497000
*                    IF PTF1HIT = OFF THEN                         0748 02498000
         TM    PTF1HIT(@07),B'10000000'                            0748 02499000
         BNZ   @RF00748                                            0748 02500000
*                      CITFAINV = ON;                              0749 02501000
         L     @07,PTCITCUR(,@07)                                  0749 02502000
         OI    CITFAINV(@07),B'00000010'                           0749 02503000
*                    ELSE;                                         0750 02504000
*                                                                  0750 02505000
@RF00748 DS    0H                                                  0751 02506000
*        /************************************************************/ 02507000
*        /*                                                          */ 02508000
*        /*           *******READ THE RECORD*******                  */ 02509000
*        /*                                                          */ 02510000
*        /************************************************************/ 02511000
*                                                                  0751 02512000
*                  ELSE                                            0751 02513000
*                    DO;                                           0751 02514000
         B     @RC00747                                            0751 02515000
@RF00747 DS    0H                                                  0752 02516000
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */ 02517000
*                                                                  0752 02518000
         L     @07,RSGRABCU(,REG6)                                 0752 02519000
         L     @04,RSPTWKC(,REG6)                                  0752 02520000
         L     @01,PTASSCUR(,@04)                                  0752 02521000
         LH    @15,TASSRAB(,@01)                                   0752 02522000
         SLA   @15,2                                               0752 02523000
         L     @15,RABARRAY-4(@15,@07)                             0752 02524000
         ST    @15,GRABCURR(,@07)                                  0752 02525000
*                      DO;                                         0753 02526000
*                        RSRTYPE = ''B;                            0754 02527000
         MVI   RSRTYPE(REG6),X'00'                                 0754 02528000
*                        RSRGET = ON;      /* GETRCD  */           0755 02529000
         OI    RSRGET(REG6),B'10000000'                            0755 02530000
*                        RSRUPD = ON;      /* UPDATE  */           0756 02531000
         OI    RSRUPD(REG6),B'00001000'                            0756 02532000
*                        RSRDS = ''B;                              0757 02533000
         NI    RSRDS(REG6),B'00011111'                             0757 02534000
*                        RSRWF = ON;       /* WORKFILE  */         0758 02535000
*                        RSRDIR = ON;      /* DIRECT  */           0759 02536000
*                        RSRKEY = ON;      /* KEY  */              0760 02537000
         OI    RSRWF(REG6),B'10010100'                             0760 02538000
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   0761 02539000
         OI    RSVIAFCR(REG6),B'10000000'                          0761 02540000
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       0762 02541000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@04)                       0762 02542000
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     0763 02543000
*                                                                  0763 02544000
         L     @07,PTCITCUR(,@04)                                  0763 02545000
         MVC   RSVIACIN(3,REG6),CITCIN(@07)                        0763 02546000
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/ 02547000
*                      CALL GETVIA;                                0764 02548000
         L     @15,@CV03442                                        0764 02549000
         BALR  @14,@15                                             0764 02550000
*                      END;                                        0765 02551000
*                                                                  0765 02552000
*        /************************************************************/ 02553000
*        /*                                                          */ 02554000
*        /*     ENSURE THE RECORD TYPE READ IS THE ONE EXPECTED. IF  */ 02555000
*        /*     NOT, TREAT AS NO RECORD FOUND.                       */ 02556000
*        /*                                                          */ 02557000
*        /************************************************************/ 02558000
*                                                                  0766 02559000
*                      IF RABNRF = OFF & RCDID ^= CITTYPE THEN     0766 02560000
         L     @07,RSGRABCU(,REG6)                                 0766 02561000
         L     @07,GRABCURR(,@07)                                  0766 02562000
         TM    RABNRF(@07),B'00000010'                             0766 02563000
         BNZ   @RF00766                                            0766 02564000
         L     @04,RSPTWKC(,REG6)                                  0766 02565000
         L     @04,PTCITCUR(,@04)                                  0766 02566000
         CLC   RCDID+8(1,@07),CITTYPE(@04)                         0766 02567000
         BE    @RF00766                                            0766 02568000
*                        RABNRF = ON;                              0767 02569000
*                                                                  0767 02570000
         OI    RABNRF(@07),B'00000010'                             0767 02571000
*        /************************************************************/ 02572000
*        /*                                                          */ 02573000
*        /*       IF THE RECORD WAS NOT FOUND MARK AS INVALID.       */ 02574000
*        /*       IF THE RECORD IS AN EXTENSION RECORD, ISSUE        */ 02575000
*        /*       MESSAGE IDC21022I.                                 */ 02576000
*        /*                                                          */ 02577000
*        /************************************************************/ 02578000
*                                                                  0768 02579000
*                      IF RABNRF = ON THEN                         0768 02580000
@RF00766 L     @07,RSGRABCU(,REG6)                                 0768 02581000
         L     @07,GRABCURR(,@07)                                  0768 02582000
         TM    RABNRF(@07),B'00000010'                             0768 02583000
         BNO   @RF00768                                            0768 02584000
*                        DO;                                       0769 02585000
*                          RABNRF = OFF; /*RESET NO RECORD FOUND     */ 02586000
         NI    RABNRF(@07),B'11111101'                             0770 02587000
*                          CITFAINV = ON; /*INVALID                  */ 02588000
         L     @07,RSPTWKC(,REG6)                                  0771 02589000
         L     @07,PTCITCUR(,@07)                                  0771 02590000
         OI    CITFAINV(@07),B'00000010'                           0771 02591000
*                          IF CITTYPE = CATEXTID |                 0772 02592000
*                           CITTYPE = VOLEXTID THEN                0772 02593000
         CLI   CITTYPE(@07),C'E'                                   0772 02594000
         BE    @RT00772                                            0772 02595000
         CLI   CITTYPE(@07),C'W'                                   0772 02596000
         BNE   @RF00772                                            0772 02597000
@RT00772 DS    0H                                                  0773 02598000
*                            IF TASSID = VOLID THEN                0773 02599000
*                                                                  0773 02600000
         L     @07,RSPTWKC(,REG6)                                  0773 02601000
         L     @04,PTASSOC(,@07)                                   0773 02602000
         CLI   TASSID(@04),C'V'                                    0773 02603000
         BNE   @RF00773                                            0773 02604000
*                              DO;                                 0774 02605000
*                              /*CALL CKERR*/                      0775 02606000
*                                RSCKERR = RSCKERR && RSCKERR;     0775 02607000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0775 02608000
*                                RSCKERN = RSE063;                 0776 02609000
         MVC   RSCKERN(2,REG6),@CH01010                            0776 02610000
*                                RSCKTERM = 'RETU';                0777 02611000
         MVC   RSCKTERM(4,REG6),@CC03787                           0777 02612000
*                                RSCKMVAR(1) = ADDR(PTBASE->CNAME);     02613000
         L     @04,PTBASE(,@07)                                    0778 02614000
         LA    @15,CNAME(,@04)                                     0778 02615000
         ST    @15,RSCKMVAR(,REG6)                                 0778 02616000
*                                RSCKMVAR(2) = ADDR(PTBASE->RCDID);     02617000
         LA    @04,RCDID(,@04)                                     0779 02618000
         ST    @04,RSCKMVAR+4(,REG6)                               0779 02619000
*                                RSCKMVAR(3) = ADDR(CITCIN);       0780 02620000
         L     @07,PTCITCUR(,@07)                                  0780 02621000
         LA    @04,CITCIN(,@07)                                    0780 02622000
         ST    @04,RSCKMVAR+8(,REG6)                               0780 02623000
*                                RSCKMVAR(4) = ADDR(CITTYPE);      0781 02624000
*                                                                  0781 02625000
         LA    @07,CITTYPE(,@07)                                   0781 02626000
         ST    @07,RSCKMVAR+12(,REG6)                              0781 02627000
*                              /* CALL TO MODULE IDCRS05 FOR PROCEDURE  02628000
*KERR                                                                */ 02629000
*                              CALL CKERR;                         0782 02630000
         L     @15,@CV03449                                        0782 02631000
         BALR  @14,@15                                             0782 02632000
*                              END;                                0783 02633000
*                            ELSE                                  0784 02634000
*                              IF TASSID = UPGID THEN              0784 02635000
*                                                                  0784 02636000
         B     @RC00773                                            0784 02637000
@RF00773 L     @07,RSPTWKC(,REG6)                                  0784 02638000
         L     @04,PTASSOC(,@07)                                   0784 02639000
         CLI   TASSID(@04),C'Y'                                    0784 02640000
         BNE   @RF00784                                            0784 02641000
*                                DO;                               0785 02642000
*                                /*CALL CKERR*/                    0786 02643000
*                                  RSCKERR = RSCKERR && RSCKERR;   0786 02644000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0786 02645000
*                                  RSCKERN = RSE025;               0787 02646000
         MVC   RSCKERN(2,REG6),@CH00940                            0787 02647000
*                                  RSCKTERM = 'RETU';              0788 02648000
         MVC   RSCKTERM(4,REG6),@CC03787                           0788 02649000
*                                  RSCKMVAR(1) = ADDR(ADDR(GRABRAB5->RA 02650000
*BUF)->CNAME);                                                     0789 02651000
         L     @04,RSGRABCU(,REG6)                                 0789 02652000
         L     @04,GRABRAB5(,@04)                                  0789 02653000
         LA    @04,CNAME+8(,@04)                                   0789 02654000
         ST    @04,RSCKMVAR(,REG6)                                 0789 02655000
*                                  RSCKMVAR(2) = ADDR(PTBASE->RCDID);   02656000
         L     @04,PTBASE(,@07)                                    0790 02657000
         LA    @04,RCDID(,@04)                                     0790 02658000
         ST    @04,RSCKMVAR+4(,REG6)                               0790 02659000
*                                  RSCKMVAR(3) = ADDR(CITCIN);     0791 02660000
         L     @07,PTCITCUR(,@07)                                  0791 02661000
         LA    @04,CITCIN(,@07)                                    0791 02662000
         ST    @04,RSCKMVAR+8(,REG6)                               0791 02663000
*                                  RSCKMVAR(4) = ADDR(CITTYPE);    0792 02664000
*                                                                  0792 02665000
         LA    @07,CITTYPE(,@07)                                   0792 02666000
         ST    @07,RSCKMVAR+12(,REG6)                              0792 02667000
*                                /* CALL TO MODULE IDCRS05 FOR PROCEDUR 02668000
* CKERR                                                              */ 02669000
*                                CALL CKERR;                       0793 02670000
         L     @15,@CV03449                                        0793 02671000
         BALR  @14,@15                                             0793 02672000
*                                END;                              0794 02673000
*                               ELSE                               0795 02674000
*                                                                  0795 02675000
*                                 DO;                              0795 02676000
         B     @RC00784                                            0795 02677000
@RF00784 DS    0H                                                  0796 02678000
*                                 /*CALL CKERR*/                   0796 02679000
*                                   RSCKERR = RSCKERR && RSCKERR;  0796 02680000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0796 02681000
*                                   RSCKERN = RSE025;              0797 02682000
         MVC   RSCKERN(2,REG6),@CH00940                            0797 02683000
*                                   RSCKTERM = 'RETU';             0798 02684000
         MVC   RSCKTERM(4,REG6),@CC03787                           0798 02685000
*                                   RSCKMVAR(1) = ADDR(PTBASE->CNAME);  02686000
         L     @07,RSPTWKC(,REG6)                                  0799 02687000
         L     @04,PTBASE(,@07)                                    0799 02688000
         LA    @15,CNAME(,@04)                                     0799 02689000
         ST    @15,RSCKMVAR(,REG6)                                 0799 02690000
*                                   RSCKMVAR(2) = ADDR(PTBASE->RCDID);  02691000
         LA    @04,RCDID(,@04)                                     0800 02692000
         ST    @04,RSCKMVAR+4(,REG6)                               0800 02693000
*                                   RSCKMVAR(3) = ADDR(CITCIN);    0801 02694000
         L     @07,PTCITCUR(,@07)                                  0801 02695000
         LA    @04,CITCIN(,@07)                                    0801 02696000
         ST    @04,RSCKMVAR+8(,REG6)                               0801 02697000
*                                   RSCKMVAR(4) = ADDR(CITTYPE);   0802 02698000
*                                                                  0802 02699000
         LA    @07,CITTYPE(,@07)                                   0802 02700000
         ST    @07,RSCKMVAR+12(,REG6)                              0802 02701000
*                                 /* CALL TO MODULE IDCRS05 FOR PROCEDU 02702000
*E CKERR                                                             */ 02703000
*                                 CALL CKERR;                      0803 02704000
         L     @15,@CV03449                                        0803 02705000
         BALR  @14,@15                                             0803 02706000
*                                 END;                             0804 02707000
*                        END;                                      0805 02708000
*        /************************************************************/ 02709000
*        /*                                                          */ 02710000
*        /*     IF RECORD FOUND, INDICATE WHETHER IT WAS REASSIGNED  */ 02711000
*        /*                                                          */ 02712000
*        /************************************************************/ 02713000
*                      ELSE                                        0806 02714000
*                        IF RSWRASCI = ON THEN                     0806 02715000
         B     @RC00768                                            0806 02716000
@RF00768 L     @07,RSGRABCU(,REG6)                                 0806 02717000
         L     @07,GRABCURR(,@07)                                  0806 02718000
         TM    RSWRASCI(@07),B'00000100'                           0806 02719000
         BNO   @RF00806                                            0806 02720000
*                          DO;                                     0807 02721000
*                            CITFARAS = ON;                        0808 02722000
         L     @04,RSPTWKC(,REG6)                                  0808 02723000
         L     @04,PTCITCUR(,@04)                                  0808 02724000
         OI    CITFARAS(@04),B'00100000'                           0808 02725000
*                            CITRCIN = RABRCDA; /*NEW CIN            */ 02726000
         MVC   CITRCIN(3,@04),RABRCDA+1(@07)                       0809 02727000
*                          END;                                    0810 02728000
*                                                                  0810 02729000
*                    END;                                          0811 02730000
@RF00806 DS    0H                                                  0811 02731000
@RC00768 DS    0H                                                  0812 02732000
*                END;                                              0812 02733000
@RC00747 DS    0H                                                  0813 02734000
*              END;                    /*END OF READCIT              */ 02735000
@RF00733 DS    0H                                                  0814 02736000
*        /************************************************************/ 02737000
*        /*                                                          */ 02738000
*        /*     SCAN                                                 */ 02739000
*        /*       IF SCAN INDICATED AND NOT ALREADY DONE THEN        */ 02740000
*        /*       SCAN THE RECORD FOR CINS.                          */ 02741000
*        /*                                                          */ 02742000
*        /************************************************************/ 02743000
*                                                                  0814 02744000
*  SCANCIT:                                                        0814 02745000
*          IF PTCITCUR=0 |                                         0814 02746000
*            (CITFAINV=OFF & CITFASCA=OFF & TASSSCAN = ON) THEN    0814 02747000
@RT00720 DS    0H                                                  0814 02748000
SCANCIT  L     @07,RSPTWKC(,REG6)                                  0814 02749000
         L     @04,PTCITCUR(,@07)                                  0814 02750000
         LTR   @04,@04                                             0814 02751000
         BZ    @RT00814                                            0814 02752000
         TM    CITFAINV(@04),B'00000110'                           0814 02753000
         BNZ   @RF00814                                            0814 02754000
         L     @07,PTASSCUR(,@07)                                  0814 02755000
         TM    TASSSCAN(@07),B'01000000'                           0814 02756000
         BNO   @RF00814                                            0814 02757000
@RT00814 DS    0H                                                  0815 02758000
*            DO;                                                   0815 02759000
*              CALL SCANCI;                                        0816 02760000
         BAL   @14,SCANCI                                          0816 02761000
*              CITFASCA = ON;          /*INDICATE SCAN COMPLETE      */ 02762000
         L     @07,RSPTWKC(,REG6)                                  0817 02763000
         L     @07,PTCITCUR(,@07)                                  0817 02764000
         OI    CITFASCA(@07),B'00000100'                           0817 02765000
*            END;                                                  0818 02766000
*                                                                  0818 02767000
*        END READSCAN;                                             0819 02768000
@RF00814 L     @04,RSPTWKC(,REG6)                                  0819 02769000
         LA    @07,1                                               0819 02770000
         L     @04,PTCITNC-1(,@04)                                 0819 02771000
         LA    @04,0(,@04)                                         0819 02772000
         ALR   @07,@04                                             0819 02773000
         L     @04,RSPTWKC(,REG6)                                  0819 02774000
         STCM  @07,7,PTCITNC(@04)                                  0819 02775000
@DE00718 L     @04,RSPTWKC(,REG6)                                  0819 02776000
         L     @04,PTCITL-1(,@04)                                  0819 02777000
         LA    @04,0(,@04)                                         0819 02778000
         CR    @07,@04                                             0819 02779000
         BNH   @DL00718                                            0819 02780000
*        /************************************************************/ 02781000
*        /*                                                          */ 02782000
*        /* THE CI TABLE NOW REFLECTS ALL CINS FOR THIS SET OF       */ 02783000
*        /* RECORDS. THE DI TABLE DESCRIBES THE CINS INSIDE EACH     */ 02784000
*        /* RECORD. CALL VERCI TO VERIFY EACH RECORD TYPE. VERCI     */ 02785000
*        /* IS SENSITIVE TO EACH RECORD'S SUBSETS AND CONTROLS THE   */ 02786000
*        /* CHECKING OF EACH SUBSET FOR PROPER ASSOCIATIONS AND      */ 02787000
*        /* ADEQUATE BASE RECORDS TO PERMIT THE ENTRY TO EXIST       */ 02788000
*        /* IN THE CATALOG.                                          */ 02789000
*        /*                                                          */ 02790000
*        /************************************************************/ 02791000
*                                                                  0820 02792000
*        IF ADDR(PTASSOC->TASSEN(1))->TASSVER=ON THEN              0820 02793000
         L     @07,RSPTWKC(,REG6)                                  0820 02794000
         L     @07,PTASSOC(,@07)                                   0820 02795000
         LA    @07,TASSEN(,@07)                                    0820 02796000
         TM    TASSVER(@07),B'00100000'                            0820 02797000
         BNO   @RF00820                                            0820 02798000
*                                      /*IF THIS SHOULD BE VERIFIED  */ 02799000
*          CALL VERCI;                                             0821 02800000
*                                                                  0821 02801000
         BAL   @14,VERCI                                           0821 02802000
*        RSASSTBL = PTASSOC;           /*RESTORE ASSOC TABLE ADDR    */ 02803000
*                                                                  0822 02804000
@RF00820 L     @07,RSPTWKC(,REG6)                                  0822 02805000
         L     @07,PTASSOC(,@07)                                   0822 02806000
         ST    @07,RSASSTBL(,REG6)                                 0822 02807000
*        /************************************************************/ 02808000
*        /*                                                          */ 02809000
*        /* THE SET OF RECORDS BEING VERIFIED MAY REFERENCE          */ 02810000
*        /* REASSIGNED OR INVALID CINS. SETCI WILL UPDATE OR DELETE  */ 02811000
*        /* THESE CINS. FURTHER, SETCI WILL MARK ALL PREVIOUS        */ 02812000
*        /* CI TABLES WITH THE RESULTS FOR COMMON ENTRIES. SETCI     */ 02813000
*        /* IS THE ONE WHO INDICATES IN THE WORKFILE RECORDS THAT    */ 02814000
*        /* THE RECORD HAS PASSED ASSOCIATION CHECKING.              */ 02815000
*        /*                                                          */ 02816000
*        /************************************************************/ 02817000
*                                                                  0823 02818000
*        IF ADDR(PTASSOC->TASSEN(1))->TASSVER=ON THEN              0823 02819000
         LA    @07,TASSEN(,@07)                                    0823 02820000
         TM    TASSVER(@07),B'00100000'                            0823 02821000
         BNO   @RF00823                                            0823 02822000
*          CALL SETCI;                                             0824 02823000
*                                                                  0824 02824000
         BAL   @14,SETCI                                           0824 02825000
*        /************************************************************/ 02826000
*        /*                                                          */ 02827000
*        /* FOR NON-RESET CLUSTERS AND ALTERNATEINDEXES,             */ 02828000
*        /* PROCTYPE SCANNED FOR CINS AND READ THE CLUSTER, OR       */ 02829000
*        /* AIX AND THE DATA AND INDEX.                              */ 02830000
*        /*                                                          */ 02831000
*        /* BOTH RESET AND NON-RESET CLUSTER AND AIXS ARE CHECKED AT */ 02832000
*        /* THIS POINT FOR SPACE CLAIMS. NONRESET ENTRIES ARE        */ 02833000
*        /* CHECKED FOR EACH RESET VOLUME THAT THEY CLAIM SPACE ON   */ 02834000
*        /* TO ENSURE THAT A CORRESPONDING DSDIR EXISTS. RESET       */ 02835000
*        /* ENTRIES ARE CHECKED FOR ALL VOLUMES THAT THEY CLAIM      */ 02836000
*        /* SPACE ON TO ENSURE THAT A CORRESPONDING DSDIR EXISTS.    */ 02837000
*        /*                                                          */ 02838000
*        /************************************************************/ 02839000
*                                                                  0825 02840000
*        IF (PTCITF->CITFAVER=ON & (TASSID=CLID | TASSID=AIXID)) | 0825 02841000
*         (TASSID=CLNR | TASSID=AIXNR) THEN                        0825 02842000
@RF00823 L     @07,RSPTWKC(,REG6)                                  0825 02843000
         L     @04,PTCITF(,@07)                                    0825 02844000
         TM    CITFAVER(@04),B'01000000'                           0825 02845000
         BNO   @GL00024                                            0825 02846000
         L     @07,PTASSOC(,@07)                                   0825 02847000
         CLI   TASSID(@07),C'C'                                    0825 02848000
         BE    @RT00825                                            0825 02849000
         CLI   TASSID(@07),C'G'                                    0825 02850000
         BE    @RT00825                                            0825 02851000
@GL00024 L     @07,RSPTWKC(,REG6)                                  0825 02852000
         L     @07,PTASSOC(,@07)                                   0825 02853000
         CLI   TASSID(@07),C'1'                                    0825 02854000
         BE    @RT00825                                            0825 02855000
         CLI   TASSID(@07),C'2'                                    0825 02856000
         BNE   @RF00825                                            0825 02857000
@RT00825 DS    0H                                                  0826 02858000
*          CALL VERDSDIR;                                          0826 02859000
         BAL   @14,VERDSDIR                                        0826 02860000
*        /************************************************************/ 02861000
*        /*                                                          */ 02862000
*        /* DUMP AFTER PROCESSING A SET OF RECORDS                   */ 02863000
*        /*                                                          */ 02864000
*        /************************************************************/ 02865000
*                                                                  0827 02866000
*          IF GDTDBG = NULLPTR                                     0827 02867000
*            THEN;                                                 0827 02868000
@RF00825 L     @07,GDTDBG(,REG5)                                   0827 02869000
         LTR   @07,@07                                             0827 02870000
         BZ    @RT00827                                            0827 02871000
*            ELSE                                                  0829 02872000
*              CALL IDCDB010(GDTTBL,'RSP3');                       0829 02873000
*                                                                  0829 02874000
         ST    REG5,@AL00001                                       0829 02875000
         LA    @07,@CC03794                                        0829 02876000
         ST    @07,@AL00001+4                                      0829 02877000
         MVI   @AL00001+4,X'80'                                    0829 02878000
         L     @15,GDTDBG(,REG5)                                   0829 02879000
         LA    @01,@AL00001                                        0829 02880000
         BALR  @14,@15                                             0829 02881000
*        /************************************************************/ 02882000
*        /*                                                          */ 02883000
*        /* FREE THE RESOURCES USED ON THIS RECURSION.               */ 02884000
*        /*                                                          */ 02885000
*        /************************************************************/ 02886000
*                                                                  0830 02887000
*        RSTANCHR = ADDR(RSGCITS);     /*GCITS                       */ 02888000
@RT00827 LA    @07,RSGCITS(,REG6)                                  0830 02889000
         ST    @07,RSTANCHR(,REG6)                                 0830 02890000
*        RSTENTIX = PTCITI - 1;        /*PREVIOUS LAST ENTRY         */ 02891000
         L     @07,RSPTWKC(,REG6)                                  0831 02892000
         L     @07,PTCITI-1(,@07)                                  0831 02893000
         LA    @07,0(,@07)                                         0831 02894000
         BCTR  @07,0                                               0831 02895000
         STCM  @07,7,RSTENTIX(REG6)                                0831 02896000
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE            */ 02897000
*        CALL GETNEXTE;                                            0832 02898000
         L     @15,@CV03436                                        0832 02899000
         BALR  @14,@15                                             0832 02900000
*                                      /*GET THE GCIT                */ 02901000
*        TABC = RSTABAD;               /*RESET CURRENT TABLE         */ 02902000
         L     @07,RSTANCHR(,REG6)                                 0833 02903000
         L     @04,RSTABAD(,REG6)                                  0833 02904000
         ST    @04,TABC(,@07)                                      0833 02905000
*        TABCURR = RSTWKIX;            /*RESET LAST ALLOC ENTRY      */ 02906000
         L     @07,RSTWKIX-1(,REG6)                                0834 02907000
         LA    @07,0(,@07)                                         0834 02908000
         STH   @07,TABCURR(,@04)                                   0834 02909000
*        RSGCITNU = PTCITI - 1;        /*RESET NUM ENTRIES USED      */ 02910000
*                                                                  0835 02911000
         L     @07,RSPTWKC(,REG6)                                  0835 02912000
         L     @04,PTCITI-1(,@07)                                  0835 02913000
         LA    @04,0(,@04)                                         0835 02914000
         BCTR  @04,0                                               0835 02915000
         STCM  @04,7,RSGCITNU(REG6)                                0835 02916000
*        IF PTDITI ^= 0 THEN           /*FREE GDIT IF GOTTEN         */ 02917000
         L     @07,PTDITI-1(,@07)                                  0836 02918000
         LA    @07,0(,@07)                                         0836 02919000
         LTR   @07,@07                                             0836 02920000
         BZ    @RF00836                                            0836 02921000
*          DO;                                                     0837 02922000
*            RSTANCHR = ADDR(RSGDITS); /*GDITS                       */ 02923000
         LA    @04,RSGDITS(,REG6)                                  0838 02924000
         ST    @04,RSTANCHR(,REG6)                                 0838 02925000
*            RSTENTIX = PTDITI - 1;    /*PREVIOUS LAST ENTRY         */ 02926000
         BCTR  @07,0                                               0839 02927000
         STCM  @07,7,RSTENTIX(REG6)                                0839 02928000
*            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE        */ 02929000
*            CALL GETNEXTE;                                        0840 02930000
         L     @15,@CV03436                                        0840 02931000
         BALR  @14,@15                                             0840 02932000
*                                      /*GET THE GDIT                */ 02933000
*            TABC = RSTABAD;           /*RESET CURRENT TABLE         */ 02934000
         L     @07,RSTANCHR(,REG6)                                 0841 02935000
         L     @04,RSTABAD(,REG6)                                  0841 02936000
         ST    @04,TABC(,@07)                                      0841 02937000
*            TABCURR = RSTWKIX;        /*RESET LAST ALLOC ENTRY      */ 02938000
         L     @07,RSTWKIX-1(,REG6)                                0842 02939000
         LA    @07,0(,@07)                                         0842 02940000
         STH   @07,TABCURR(,@04)                                   0842 02941000
*            RSGDITNU = PTDITI - 1;    /*RESET NUM ENTRIES USED      */ 02942000
         L     @07,RSPTWKC(,REG6)                                  0843 02943000
         L     @07,PTDITI-1(,@07)                                  0843 02944000
         LA    @07,0(,@07)                                         0843 02945000
         BCTR  @07,0                                               0843 02946000
         STCM  @07,7,RSGDITNU(REG6)                                0843 02947000
*          END;                                                    0844 02948000
*                                                                  0844 02949000
*        RSPTWKC = RSPTWKC->TABBACKW;  /*RETURN PTWORK               */ 02950000
*                                                                  0845 02951000
@RF00836 L     @07,RSPTWKC(,REG6)                                  0845 02952000
         L     @07,TABBACKW(,@07)                                  0845 02953000
         ST    @07,RSPTWKC(,REG6)                                  0845 02954000
*        RFY TASSO;                    /*REVERT                      */ 02955000
* CALL EXIT;  /*TERMINATE*/                                        0847 02956000
         BAL   @14,EXIT                                            0847 02957000
* END PROCTYPE; /*END OF PROCEDURE*/                               0848 02958000
@EL00006 DS    0H                                                  0848 02959000
@EF00006 DS    0H                                                  0848 02960000
@ER00006 BR    @14                                                 0848 02961000
@PB00006 DS    0H                                                  0849 02962000
*/********************************************************************/ 02963000
*/*                                                                  */ 02964000
*/* PROCEDURE NAME - SCANCI                                          */ 02965000
*/*                                                                  */ 02966000
*/* FUNCTION -                                                       */ 02967000
*/*    FOR A GIVEN CATALOG RECORD THIS SUBFUNCTION IS CALLED BY      */ 02968000
*/*    PROCTYPE TO SCAN THE RECORD FOR CONTROL INTERVAL NUMBERS      */ 02969000
*/*    (CIN) AND FOR EACH CIN FOUND CALLS PROCCI TO SAVE INFORMATION */ 02970000
*/*    ABOUT THAT CIN.                                               */ 02971000
*/*                                                                  */ 02972000
*/*    FOR A SET OF RECORDS, A CI TABLE WILL BE BUILT. EACH CIN      */ 02973000
*/*    WITHIN THAT SET OF RECORDS WILL HAVE ONE AND ONLY ONE CI      */ 02974000
*/*    PROCESSED, AND, AS CINS ARE FOUND IN THAT RECORD, DISPLACEMENT*/ 02975000
*/*    TABLE ENTRIES ARE MADE (POINTED TO BY THE CI TABLE ENTRY)     */ 02976000
*/*    WHICH DESCRIBE THE CIN IN THAT RECORD. WHENEVER A CIN IS      */ 02977000
*/*    FOUND WHICH IS NOT YET DESCRIBED IN THE CI TABLE, A CI        */ 02978000
*/*    TABLE ENTRY WILL BE CREATED.                                  */ 02979000
*/*                                                                  */ 02980000
*/* INPUT -                                                          */ 02981000
*/*    RSGRABCU->GRABCURR->(RAB AND RECORD TO BE PROCESSED)          */ 02982000
*/*    PTWORK - THE WORK AREA FOR PROCTYPE & SUBFUNCTIONS.           */ 02983000
*/*             THE PRIMARY DATA IN PTWORK IS:                       */ 02984000
*/*      PTCITCUR->CITABE(CURRENT CI TABLE ENTRY FOR THE RECORD      */ 02985000
*/*                     TO BE PROCESSED).                            */ 02986000
*/*         IF PTCITCUR = 0, THIS INDICATES THAT THIS IS THE         */ 02987000
*/*         FIRST RECORD PROCESSED IN A SET OF RECORDS, AND A        */ 02988000
*/*         NEW CI TABLE WILL BE GOTTEN.                             */ 02989000
*/*                                                                  */ 02990000
*/* OUTPUT -                                                         */ 02991000
*/*    OUTPUT FROM SCANCI CONSISTS OF CHANGES TO THE INPUT TABLES    */ 02992000
*/*    (CITABE/DITABE) TO REFLECT INFORMATION ABOUT THE CIN FOUND    */ 02993000
*/*    BY SCANCI IN THE INPUT RECORD (SEE PROCCI). ALSO PTWORK       */ 02994000
*/*    (PTCITN) WILL BE UPDATED TO CONTAIN THE TOTAL NUMBER OR       */ 02995000
*/*    CI TABLE ENTRIES.                                             */ 02996000
*/*                                                                  */ 02997000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 02998000
*/*                                                                  */ 02999000
*/********************************************************************/ 03000000
*      GENERATE;                                                   0849 03001000
         DS    0F                                                       03002000
NAME0071 DC    CL8'SCANCI'                                              03003000
*SCANCI: PROCEDURE                                                 0850 03004000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0850 03005000
*                                                                  0850 03006000
         B     @PB00007                                            0850 03007000
SCANCI   DS    0H                                                  0851 03008000
*      GENERATE REFS(RS02RG08, REG6);                              0851 03009000
*                                                                  0851 03010000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          03011000
         LR    @15,@13  OLD SAVE AREA                                   03012000
         LA    @13,72(@13)  NEW SAVE AREA                               03013000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     03014000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        03015000
         MVC   0(4,@15),NAME0071  PROCNAME TO REGSAVE                   03016000
*         OLDERID2 = NEWERID2;                                     0852 03017000
         L     @07,GDTTR2(,REG5)                                   0852 03018000
         MVC   @TS00001(95),NEWERID2(@07)                          0852 03019000
         MVC   OLDERID2(95,@07),@TS00001                           0852 03020000
*         NEWID2 = 'RSSC';                                         0853 03021000
*                                                                  0853 03022000
         MVC   NEWID2(4,@07),@CC03798                              0853 03023000
*        /************************************************************/ 03024000
*        /*                                                          */ 03025000
*        /* IF THIS IS THE FIRST RECORD IN A SET OF RECORDS          */ 03026000
*        /* THEN GO AND GET A CI TABLE FOR THIS SET OF RECORDS.      */ 03027000
*        /*                                                          */ 03028000
*        /************************************************************/ 03029000
*                                                                  0854 03030000
*        IF PTCITCUR = 0 THEN          /*FIRST RCD OF A SET OF RCDS  */ 03031000
         L     @07,RSPTWKC(,REG6)                                  0854 03032000
         L     @07,PTCITCUR(,@07)                                  0854 03033000
         LTR   @07,@07                                             0854 03034000
         BNZ   @RF00854                                            0854 03035000
*          DO;                                                     0855 03036000
*            RSTANCHR = ADDR(RSGCITS);                             0856 03037000
*                                                                  0856 03038000
         LA    @07,RSGCITS(,REG6)                                  0856 03039000
         ST    @07,RSTANCHR(,REG6)                                 0856 03040000
*            /* GET FIRST CITABE */                                0857 03041000
*            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETFIT          */ 03042000
*            CALL GETFIT;                                          0857 03043000
*                                                                  0857 03044000
         L     @15,@CV03435                                        0857 03045000
         BALR  @14,@15                                             0857 03046000
*            PTCITCUR = RSTENTAD;                                  0858 03047000
         L     @07,RSPTWKC(,REG6)                                  0858 03048000
         L     @04,RSTENTAD(,REG6)                                 0858 03049000
         ST    @04,PTCITCUR(,@07)                                  0858 03050000
*            PTCITI = RSGCITNU;        /*INDEX OF FIRST CITABE       */ 03051000
         MVC   PTCITI(3,@07),RSGCITNU(REG6)                        0859 03052000
*            PTCITL = RSGCITNU;        /*INIT LAST CIN FOUND         */ 03053000
         MVC   PTCITL(3,@07),RSGCITNU(REG6)                        0860 03054000
*            PTCITNC = RSGCITNU;       /*CURRENT CIN ENTRY = FIRST   */ 03055000
         MVC   PTCITNC(3,@07),RSGCITNU(REG6)                       0861 03056000
*            PTCITF = PTCITCUR;        /*ADDRESS OF FIRST CITABE     */ 03057000
*                                                                  0862 03058000
         ST    @04,PTCITF(,@07)                                    0862 03059000
*        /************************************************************/ 03060000
*        /*                                                          */ 03061000
*        /* FORMAT THE FIRST RECORD IN THE CI TABLE                  */ 03062000
*        /*                                                          */ 03063000
*        /************************************************************/ 03064000
*                                                                  0863 03065000
*            CITABE = CITABE && CITABE;                            0863 03066000
         XC    CITABE(20,@04),CITABE(@04)                          0863 03067000
*            CITCIN = RCDCINO;         /*ENTER CI NUMBER             */ 03068000
         L     @07,RSGRABCU(,REG6)                                 0864 03069000
         L     @07,GRABCURR(,@07)                                  0864 03070000
         LA    @15,8                                               0864 03071000
         ALR   @15,@07                                             0864 03072000
         MVC   CITCIN(3,@04),RCDCINO(@15)                          0864 03073000
*            CITTYPE = RCDID;          /*ENTER RECORD TYPE           */ 03074000
*                                                                  0865 03075000
         MVC   CITTYPE(1,@04),RCDID(@15)                           0865 03076000
*        /************************************************************/ 03077000
*        /*                                                          */ 03078000
*        /* UPDATE INFORMATION ABOUT THE CURRENT RECORD BEING        */ 03079000
*        /* PROCESSED IN ITS RESPECTIVE CI TABLE ENTRY.              */ 03080000
*        /*                                                          */ 03081000
*        /************************************************************/ 03082000
*                                                                  0866 03083000
*            IF RSWRASCI = ON THEN     /*CIN REASSIGNED              */ 03084000
         TM    RSWRASCI(@07),B'00000100'                           0866 03085000
         BNO   @RF00866                                            0866 03086000
*              DO;                                                 0867 03087000
*                CITFARAS = ON;        /*INDICATE REASSIGNED CIN     */ 03088000
         OI    CITFARAS(@04),B'00100000'                           0868 03089000
*                CITRCIN = RABRCDA;    /*SAVE THE NEWLY ASSIGNED CIN */ 03090000
         MVC   CITRCIN(3,@04),RABRCDA+1(@07)                       0869 03091000
*              END;                                                0870 03092000
*          END;                                                    0871 03093000
*                                                                  0871 03094000
@RF00866 DS    0H                                                  0872 03095000
*        /************************************************************/ 03096000
*        /*                                                          */ 03097000
*        /* PROCESS THE RECORD FOR ALL CINS IN THE RECORD.           */ 03098000
*        /* THIS INCLUDES THE FOLLOWING:                             */ 03099000
*        /*     HORIZONTAL EXTENSION POINTER                         */ 03100000
*        /*     CIN IN GOP                                           */ 03101000
*        /*     CIN IN ASSOCIATION GROUP OCCURRENCES                 */ 03102000
*        /*                                                          */ 03103000
*        /************************************************************/ 03104000
*                                                                  0872 03105000
*        /* GET ADDRESS OF GOPS AND GOS FOR LKR RECORD */          0872 03106000
*        /* CALL TO MODULE IDCRS03 FOR PROCEDURE CATRCDSU            */ 03107000
*        CALL CATRCDSU;                                            0872 03108000
*                                                                  0872 03109000
@RF00854 L     @15,@CV03430                                        0872 03110000
         BALR  @14,@15                                             0872 03111000
*        RFY CITABE BASED(ADDR(RSCITDUM)); /*DUMMY CITABE FR PROCCI  */ 03112000
*                                                                  0873 03113000
*        /************************************************************/ 03114000
*        /*                                                          */ 03115000
*        /* HORIZONTAL EXTENSION                                     */ 03116000
*        /*     IF A HORIZONTAL EXTENSION IS PRESENT CALL            */ 03117000
*        /*     PROCCI TO HANDLE IT.                                 */ 03118000
*        /*                                                          */ 03119000
*        /************************************************************/ 03120000
*                                                                  0874 03121000
*        IF EXTGOCI ^= 0 THEN                                      0874 03122000
         L     @07,RSCPE2(,REG6)                                   0874 03123000
         ICM   @04,7,EXTGOCI(@07)                                  0874 03124000
         BZ    @RF00874                                            0874 03125000
*          DO;                                                     0875 03126000
*            CITABE = CITABE && CITABE;                            0876 03127000
         LA    @07,48                                              0876 03128000
         ALR   @07,REG6                                            0876 03129000
         XC    CITABE(20,@07),CITABE(@07)                          0876 03130000
*            CITFAHEP = ON;            /*INDICATE HORIZONTAL EXT     */ 03131000
         OI    CITFAHEP(@07),B'00010000'                           0877 03132000
*            IF PTCITCUR->CITTYPE = VOLID |                        0878 03133000
*              PTCITCUR->CITTYPE = VOLEXTID THEN                   0878 03134000
         L     @07,RSPTWKC(,REG6)                                  0878 03135000
         L     @07,PTCITCUR(,@07)                                  0878 03136000
         CLI   CITTYPE(@07),C'V'                                   0878 03137000
         BE    @RT00878                                            0878 03138000
         CLI   CITTYPE(@07),C'W'                                   0878 03139000
         BNE   @RF00878                                            0878 03140000
@RT00878 DS    0H                                                  0879 03141000
*              CITTYPE = VOLEXTID;     /*VOL RCD EXTENSION TYPE W    */ 03142000
         MVI   CITTYPE+48(REG6),C'W'                               0879 03143000
*            ELSE                                                  0880 03144000
*              CITTYPE = CATEXTID;     /*EXTENSION RECORD TYPE       */ 03145000
         B     @RC00878                                            0880 03146000
@RF00878 MVI   CITTYPE+48(REG6),C'E'                               0880 03147000
*            CITCIN = EXTGOCI;         /*SET CIN IN CITABE           */ 03148000
@RC00878 L     @07,RSCPE2(,REG6)                                   0881 03149000
         MVC   CITCIN+48(3,REG6),EXTGOCI(@07)                      0881 03150000
*            RSCPE5 = ADDR(EXTGOCI);   /*ADDR OFFSET DATA FOR PROCCI */ 03151000
*                                                                  0882 03152000
         ST    @07,RSCPE5(,REG6)                                   0882 03153000
*            /* PROCESS THIS CIN */                                0883 03154000
*            CALL PROCCI;                                          0883 03155000
*                                                                  0883 03156000
         BAL   @14,PROCCI                                          0883 03157000
*          END;                                                    0884 03158000
*                                                                  0884 03159000
*        /************************************************************/ 03160000
*        /*                                                          */ 03161000
*        /* GOP (GROUP OCCURRENCE POINTER)                           */ 03162000
*        /*     SCAN THROUGH ALL OF THE GOPS IN THIS RECORD.         */ 03163000
*        /*     IF THE GOP POINTS TO AN EXTENSION RECORD (CIN)       */ 03164000
*        /*     THEN CALL PROCCI FOR THAT CIN. IF THE GOP            */ 03165000
*        /*     POINTS TO A GO (GROUP OCCURRENCE) IN THIS RECORD     */ 03166000
*        /*     THEN CHECK TO SEE IF THE GO IS EITHER AN             */ 03167000
*        /*     ASSOCIATION GO OR A DATA SET DIRECTORY GO.           */ 03168000
*        /*     IF IT IS EITHER ONE OF THESE THEN IT CONTAINS A      */ 03169000
*        /*     CIN AS PART OF ITS DATA.                             */ 03170000
*        /*                                                          */ 03171000
*        /************************************************************/ 03172000
*                                                                  0885 03173000
*        RSCPE5 = ADDR(REPGOPT);       /*POINT TO FIRST GOP          */ 03174000
*                                                                  0885 03175000
@RF00874 L     @07,RSCPE2(,REG6)                                   0885 03176000
         LA    @07,REPGOPT(,@07)                                   0885 03177000
         ST    @07,RSCPE5(,REG6)                                   0885 03178000
*        DO RSIDX = 1 TO REPCNT;       /*SCAN THE GOPS               */ 03179000
*                                                                  0886 03180000
         LA    @07,1                                               0886 03181000
         B     @DE00886                                            0886 03182000
@DL00886 DS    0H                                                  0887 03183000
*        /************************************************************/ 03184000
*        /*                                                          */ 03185000
*        /*  ASPT - AVAILABLE SPACE POINTER.                         */ 03186000
*        /*     ALWAYS FLAGGED DELETED. THIS IS THE FIRST GOP AND HAS * 03187000
*        /*     A GROUP CODE OF ZERO. IF THE CIN IS NON-ZERO, THIS   */ 03188000
*        /*     INDICATES THAT THE VERTICAL EXISTS.                  */ 03189000
*        /*  OTHERWISE - IF GOP FLAGGED DELETED, DON'T PROCESS IT.   */ 03190000
*        /*                                                          */ 03191000
*        /************************************************************/ 03192000
*                                                                  0887 03193000
*          IF (RSIDX=1 & CATGOEXT=ON & CATGODEL=ON &               0887 03194000
*              (CATGOCI&TRUEGC)='00'X & CATGOCI ^= 0) |            0887 03195000
*             CATGODEL = OFF THEN                                  0887 03196000
         CLC   RSIDX(2,REG6),@CH00212                              0887 03197000
         BNE   @GL00029                                            0887 03198000
         L     @07,RSCPE5(,REG6)                                   0887 03199000
         TM    CATGOEXT(@07),B'11000000'                           0887 03200000
         BNO   @GL00029                                            0887 03201000
         MVC   @TS00001(1),CATGOCI(@07)                            0887 03202000
         NI    @TS00001,X'3F'                                      0887 03203000
         CLI   @TS00001,X'00'                                      0887 03204000
         BNE   @GL00029                                            0887 03205000
         ICM   @04,7,CATGOCI(@07)                                  0887 03206000
         BNZ   @RT00887                                            0887 03207000
@GL00029 L     @07,RSCPE5(,REG6)                                   0887 03208000
         TM    CATGODEL(@07),B'01000000'                           0887 03209000
         BNZ   @RF00887                                            0887 03210000
@RT00887 DS    0H                                                  0888 03211000
*            DO;                                                   0888 03212000
*              IF CATGOEXT = ON THEN   /*CHECK IF POINTER TO EXT     */ 03213000
         L     @07,RSCPE5(,REG6)                                   0889 03214000
         TM    CATGOEXT(@07),B'10000000'                           0889 03215000
         BNO   @RF00889                                            0889 03216000
*                DO;                                               0890 03217000
*                                                                  0890 03218000
*        /************************************************************/ 03219000
*        /*                                                          */ 03220000
*        /* GOP CONTAINS A CIN                                       */ 03221000
*        /*                                                          */ 03222000
*        /************************************************************/ 03223000
*                                                                  0891 03224000
*                  CITABE = CITABE && CITABE;                      0891 03225000
         LA    @07,48                                              0891 03226000
         ALR   @07,REG6                                            0891 03227000
         XC    CITABE(20,@07),CITABE(@07)                          0891 03228000
*                  CITFAGOE = ON;      /*INDICATE GOP HAS EXT PTR    */ 03229000
         OI    CITFAGOE(@07),B'00001000'                           0892 03230000
*                  IF PTCITCUR->CITTYPE = VOLID |                  0893 03231000
*                    PTCITCUR->CITTYPE = VOLEXTID THEN             0893 03232000
         L     @07,RSPTWKC(,REG6)                                  0893 03233000
         L     @07,PTCITCUR(,@07)                                  0893 03234000
         CLI   CITTYPE(@07),C'V'                                   0893 03235000
         BE    @RT00893                                            0893 03236000
         CLI   CITTYPE(@07),C'W'                                   0893 03237000
         BNE   @RF00893                                            0893 03238000
@RT00893 DS    0H                                                  0894 03239000
*                    CITTYPE = VOLEXTID; /*VOL RCD EXTENSION TYPE W  */ 03240000
         MVI   CITTYPE+48(REG6),C'W'                               0894 03241000
*                  ELSE                                            0895 03242000
*                    CITTYPE = CATEXTID; /*NORMAL EXTENSION RECORD   */ 03243000
         B     @RC00893                                            0895 03244000
@RF00893 MVI   CITTYPE+48(REG6),C'E'                               0895 03245000
*                  CITCIN = CATGOCI;   /*PUT CIN IN CI TABLE         */ 03246000
*                                                                  0896 03247000
@RC00893 L     @07,RSCPE5(,REG6)                                   0896 03248000
         MVC   CITCIN+48(3,REG6),CATGOCI(@07)                      0896 03249000
*                  /* PROCESS THIS CIN */                          0897 03250000
*                  CALL PROCCI;                                    0897 03251000
*                                                                  0897 03252000
         BAL   @14,PROCCI                                          0897 03253000
*                END;                                              0898 03254000
*                                                                  0898 03255000
*        /************************************************************/ 03256000
*        /*                                                          */ 03257000
*        /* ASSOCIATION GO (GROUP OCCURRENCE)                        */ 03258000
*        /*     CHECK IF THE GROUP CODE IS 2(ASSOCIATION), IF        */ 03259000
*        /*     SO THEN THE GO (GROUP OCCURRENCE CONTAINS A CIN.     */ 03260000
*        /*                                                          */ 03261000
*        /************************************************************/ 03262000
*                                                                  0899 03263000
*              ELSE                                                0899 03264000
*                IF (CATGOGC1&TRUEGC) = ASGC THEN                  0899 03265000
         B     @RC00889                                            0899 03266000
@RF00889 L     @07,RSCPE5(,REG6)                                   0899 03267000
         LA    @04,63                                              0899 03268000
         SLR   @15,@15                                             0899 03269000
         IC    @15,CATGOGC1(,@07)                                  0899 03270000
         NR    @04,@15                                             0899 03271000
         C     @04,@CF00149                                        0899 03272000
         BNE   @RF00899                                            0899 03273000
*                  DO;                                             0900 03274000
*                    RSCPE6 = RSCPE3 + CATGODSP; /*ADDRESS OF GO     */ 03275000
         ICM   @07,12,CATGODSP(@07)                                0901 03276000
         SRA   @07,16                                              0901 03277000
         AL    @07,RSCPE3(,REG6)                                   0901 03278000
         ST    @07,RSCPE6(,REG6)                                   0901 03279000
*                    CITABE = CITABE && CITABE;                    0902 03280000
         LA    @04,48                                              0902 03281000
         ALR   @04,REG6                                            0902 03282000
         XC    CITABE(20,@04),CITABE(@04)                          0902 03283000
*                    CITTYPE = ASTYPE; /*SET TYPE OF RECORD          */ 03284000
         IC    @15,ASTYPE(,@07)                                    0903 03285000
         STC   @15,CITTYPE(,@04)                                   0903 03286000
*                    CITCIN = ASCI;    /*PUT CIN IN CI TABLE         */ 03287000
*                                                                  0904 03288000
         MVC   CITCIN(3,@04),ASCI(@07)                             0904 03289000
*                    /* PROCESS THIS CIN */                        0905 03290000
*                    CALL PROCCI;                                  0905 03291000
*                                                                  0905 03292000
         BAL   @14,PROCCI                                          0905 03293000
*                    PTDITCUR->DITFBAS1 = ON; /*IND ASSOCIATION 1    */ 03294000
*                                                                  0906 03295000
         L     @07,RSPTWKC(,REG6)                                  0906 03296000
         L     @04,PTDITCUR(,@07)                                  0906 03297000
         OI    DITFBAS1(@04),B'00100000'                           0906 03298000
*        /************************************************************/ 03299000
*        /*                                                          */ 03300000
*        /* ASSOCIATION GO (GROUP OCCURRENCE)                        */ 03301000
*        /*     IF THIS IS AN UPGRADE ASSOCIATION IT CONTAINS 2      */ 03302000
*        /*     CINS IN THE DATA.                                    */ 03303000
*        /*                                                          */ 03304000
*        /************************************************************/ 03305000
*                                                                  0907 03306000
*                    IF LENFIX>(LENGTH(CNTRLINF)+LENGTH(ASG1)) &   0907 03307000
*                     PTCITF->CITTYPE = UPGID THEN                 0907 03308000
         L     @04,RSCPE6(,REG6)                                   0907 03309000
         CLI   LENFIX(@04),6                                       0907 03310000
         BNH   @RF00907                                            0907 03311000
         L     @07,PTCITF(,@07)                                    0907 03312000
         CLI   CITTYPE(@07),C'Y'                                   0907 03313000
         BNE   @RF00907                                            0907 03314000
*                      DO;                                         0908 03315000
*                        CITABE = CITABE && CITABE;                0909 03316000
         LA    @07,48                                              0909 03317000
         ALR   @07,REG6                                            0909 03318000
         XC    CITABE(20,@07),CITABE(@07)                          0909 03319000
*                        CITTYPE = ASTYPE2; /*CIN RCD TYPE           */ 03320000
         IC    @15,ASTYPE2(,@04)                                   0910 03321000
         STC   @15,CITTYPE(,@07)                                   0910 03322000
*                        CITCIN = ASCI2; /*PUT CIN IN CI TABLE       */ 03323000
*                                                                  0911 03324000
         MVC   CITCIN(3,@07),ASCI2(@04)                            0911 03325000
*                        /* PROCESS THIS CIN */                    0912 03326000
*                        CALL PROCCI;                              0912 03327000
*                                                                  0912 03328000
         BAL   @14,PROCCI                                          0912 03329000
*                        PTDITCUR->DITFBAS2 = ON; /*IND ASSOC 2      */ 03330000
         L     @07,RSPTWKC(,REG6)                                  0913 03331000
         L     @07,PTDITCUR(,@07)                                  0913 03332000
         OI    DITFBAS2(@07),B'00010000'                           0913 03333000
*                      END;                                        0914 03334000
*                                                                  0914 03335000
*        /************************************************************/ 03336000
*        /*                                                          */ 03337000
*        /*  ASSOCIATION GO (GROUP OCCURRENCE)                       */ 03338000
*        /*       IF THIS IS A GDG BASE ASSOCIATION, THEN SAVE       */ 03339000
*        /*       THE GDG LEVEL NUMBER.                              */ 03340000
*        /*                                                          */ 03341000
*        /************************************************************/ 03342000
*                                                                  0915 03343000
*                    IF (PTCITF->CITTYPE = GDGID |                 0915 03344000
*                     PTCITF->CITTYPE = NVID) &                    0915 03345000
*                     LENFIX = LENGTH(ASGOGDG)                     0915 03346000
*                     THEN                                         0915 03347000
@RF00907 L     @07,RSPTWKC(,REG6)                                  0915 03348000
         L     @07,PTCITF(,@07)                                    0915 03349000
         CLI   CITTYPE(@07),C'B'                                   0915 03350000
         BE    @GL00035                                            0915 03351000
         CLI   CITTYPE(@07),C'A'                                   0915 03352000
         BNE   @RF00915                                            0915 03353000
@GL00035 L     @07,RSCPE6(,REG6)                                   0915 03354000
         CLI   LENFIX(@07),10                                      0915 03355000
         BNE   @RF00915                                            0915 03356000
*                      PTDITCUR->DITDGML = ASGDGLVL;               0916 03357000
*                                                                  0916 03358000
         L     @04,RSPTWKC(,REG6)                                  0916 03359000
         L     @04,PTDITCUR(,@04)                                  0916 03360000
         MVC   DITDGML(4,@04),ASGDGLVL(@07)                        0916 03361000
*                  END;                /*END OF ASSOCIATIONS DO      */ 03362000
*                                                                  0917 03363000
@RF00915 DS    0H                                                  0918 03364000
*        /************************************************************/ 03365000
*        /*                                                          */ 03366000
*        /* THE GOP OR GO HAS BEEN PROCESSED NOW GET THE NEXT        */ 03367000
*        /*                                                          */ 03368000
*        /************************************************************/ 03369000
*                                                                  0918 03370000
*            END;                                                  0918 03371000
*                                                                  0918 03372000
@RF00899 DS    0H                                                  0918 03373000
@RC00889 DS    0H                                                  0919 03374000
*          RSCPE5 = RSCPE5 + RSGOPLEN;   /*POINT TO NEXT GOP         */ 03375000
*                                                                  0919 03376000
@RF00887 LH    @07,RSGOPLEN(,REG6)                                 0919 03377000
         AL    @07,RSCPE5(,REG6)                                   0919 03378000
         ST    @07,RSCPE5(,REG6)                                   0919 03379000
*        END;                          /*NO MORE GOPS OR GOS         */ 03380000
*                                                                  0920 03381000
         LA    @07,1                                               0920 03382000
         AH    @07,RSIDX(,REG6)                                    0920 03383000
@DE00886 STH   @07,RSIDX(,REG6)                                    0920 03384000
         L     @04,RSCPE2(,REG6)                                   0920 03385000
         SLR   @15,@15                                             0920 03386000
         IC    @15,REPCNT(,@04)                                    0920 03387000
         CR    @07,@15                                             0920 03388000
         BNH   @DL00886                                            0920 03389000
*        RFY CITABE;                   /*REVERT                      */ 03390000
*  CALL EXIT;  /*TERMINATE*/                                       0922 03391000
         BAL   @14,EXIT                                            0922 03392000
*  END SCANCI; /*END OF PROCEDURE*/                                0923 03393000
@EL00007 DS    0H                                                  0923 03394000
@EF00007 DS    0H                                                  0923 03395000
@ER00007 BR    @14                                                 0923 03396000
@PB00007 DS    0H                                                  0924 03397000
*/********************************************************************/ 03398000
*/*                                                                  */ 03399000
*/* PROCEDURE - SETCI                                                */ 03400000
*/*                                                                  */ 03401000
*/* FUNCTION -                                                       */ 03402000
*/*     . IF THE BASE WAS VERIFIED, MARK ALL VALID RECORDS AS        */ 03403000
*/*       ASSOCIATION CHECKED.                                       */ 03404000
*/*     . UPDATE ALL CINS IN VERIFIED RECORDS TO THEIR REASSIGNED    */ 03405000
*/*       VALUE                                                      */ 03406000
*/*     . DELETE ALL CINS WHICH FAILED CHECKING IN ALL VERIFIED      */ 03407000
*/*       RECORDS                                                    */ 03408000
*/*                                                                  */ 03409000
*/* INPUT -                                                          */ 03410000
*/*    CI TABLE AND DI TABLE FOR THE CLUSTER                         */ 03411000
*/*                                                                  */ 03412000
*/* OUTPUT -                                                         */ 03413000
*/*     RSWASSCK - SET ON IN ALL RECORDS TO BE VERIFIED              */ 03414000
*/*                THAT PASSED ASSOCIATION CHECKING                  */ 03415000
*/*     WORKFILE RECORDS - UPDATED PER THE FUNCTION DEXCRIPTION      */ 03416000
*/*                                                                  */ 03417000
*/* MESSAGES -                                                       */ 03418000
*/*     IDC21026I - ENTRY DELETED                                    */ 03419000
*/*                                                                  */ 03420000
*/********************************************************************/ 03421000
*      GENERATE;                                                   0924 03422000
         DS    0F                                                       03423000
NAME0079 DC    CL8'SETCI'                                               03424000
*SETCI: PROCEDURE                                                  0925 03425000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0925 03426000
*                                                                  0925 03427000
         B     @PB00008                                            0925 03428000
SETCI    DS    0H                                                  0926 03429000
*      GENERATE REFS(RS02RG08, REG6);                              0926 03430000
*                                                                  0926 03431000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          03432000
         LR    @15,@13  OLD SAVE AREA                                   03433000
         LA    @13,72(@13)  NEW SAVE AREA                               03434000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     03435000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        03436000
         MVC   0(4,@15),NAME0079  PROCNAME TO REGSAVE                   03437000
*        OLDERID2 = NEWERID2;                                      0927 03438000
         L     @07,GDTTR2(,REG5)                                   0927 03439000
         MVC   @TS00001(95),NEWERID2(@07)                          0927 03440000
         MVC   OLDERID2(95,@07),@TS00001                           0927 03441000
*        NEWID2 = 'RSSE';                                          0928 03442000
*                                                                  0928 03443000
         MVC   NEWID2(4,@07),@CC03804                              0928 03444000
*        RFY TASSO BASED(PTASSOC);     /*RECURSIVE ASSOC TABLE       */ 03445000
*        RFY DITABE BASED(PTLCDIT);    /*SCAN DITABE                 */ 03446000
*                                                                  0930 03447000
*        /************************************************************/ 03448000
*        /*                                                          */ 03449000
*        /* IF THE BASE VERIFIED THEN UPDATE ALL OF THE              */ 03450000
*        /* CINS IN THIS SET OF RECORDS.                             */ 03451000
*        /*                                                          */ 03452000
*        /************************************************************/ 03453000
*                                                                  0931 03454000
*        PTF1DELT = OFF;               /*INDICATE NO DELETE REQD     */ 03455000
         L     @07,RSPTWKC(,REG6)                                  0931 03456000
         NI    PTF1DELT(@07),B'11101111'                           0931 03457000
*        IF PTCITF->CITFAVER=ON THEN                               0932 03458000
         L     @07,PTCITF(,@07)                                    0932 03459000
         TM    CITFAVER(@07),B'01000000'                           0932 03460000
         BNO   @RF00932                                            0932 03461000
*  SETPROC:                                                        0933 03462000
*          DO;                                                     0933 03463000
*                                                                  0933 03464000
SETPROC  DS    0H                                                  0934 03465000
*        /************************************************************/ 03466000
*        /*                                                          */ 03467000
*        /* GET EACH CI TABLE ENTRY DESCRIBING A RECORD IN THIS      */ 03468000
*        /* SET OF RECORDS.                                          */ 03469000
*        /*                                                          */ 03470000
*        /************************************************************/ 03471000
*                                                                  0934 03472000
*  SETCIT:                                                         0934 03473000
*            DO PTCITNC = PTCITI TO PTCITL;                        0934 03474000
SETCIT   L     @07,RSPTWKC(,REG6)                                  0934 03475000
         L     @07,PTCITI-1(,@07)                                  0934 03476000
         LA    @07,0(,@07)                                         0934 03477000
         B     @DE00934                                            0934 03478000
@DL00934 DS    0H                                                  0935 03479000
*              RSTANCHR = ADDR(RSGCITS);                           0935 03480000
         LA    @07,RSGCITS(,REG6)                                  0935 03481000
         ST    @07,RSTANCHR(,REG6)                                 0935 03482000
*              RSTENTIX = PTCITNC;                                 0936 03483000
         L     @07,RSPTWKC(,REG6)                                  0936 03484000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       0936 03485000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 03486000
*              CALL GETNEXTE;                                      0937 03487000
         L     @15,@CV03436                                        0937 03488000
         BALR  @14,@15                                             0937 03489000
*              PTCITCUR = RSTENTAD;    /*SAVE THE CITABE ADDRESS     */ 03490000
*                                                                  0938 03491000
         L     @07,RSPTWKC(,REG6)                                  0938 03492000
         L     @04,RSTENTAD(,REG6)                                 0938 03493000
         ST    @04,PTCITCUR(,@07)                                  0938 03494000
*        /************************************************************/ 03495000
*        /*                                                          */ 03496000
*        /* IF THE RECORD IS NOT VALID, IGNORE IT                    */ 03497000
*        /*                                                          */ 03498000
*        /************************************************************/ 03499000
*                                                                  0939 03500000
*              IF CITFAINV = ON THEN;                              0939 03501000
*                                                                  0939 03502000
         TM    CITFAINV(@04),B'00000010'                           0939 03503000
         BO    @RT00939                                            0939 03504000
*        /************************************************************/ 03505000
*        /*                                                          */ 03506000
*        /* LOCATE THE ASSOC TABLE ENTRY FOR THIS RECORD TYPE        */ 03507000
*        /* TO DETERMINE IF THIS RECORD WAS TO BE VERIFIED WITHIN    */ 03508000
*        /* THIS SET OF RECORDS.                                     */ 03509000
*        /* THERE IS LOGIC FOR THE FORCE SETTING OF CINS (CURRENTLY  */ 03510000
*        /* NO ONE USES IT).                                         */ 03511000
*        /*                                                          */ 03512000
*        /*  NOTE * FOR VERIFIED SETS OF RECORDS ALL RECORDS, EXCEPT */ 03513000
*        /*     EXTENSIONS, MUST INDICATE VERIFIED.                  */ 03514000
*        /*                                                          */ 03515000
*        /************************************************************/ 03516000
*                                                                  0941 03517000
*              ELSE                                                0941 03518000
*                DO;                                               0941 03519000
*                  PTASSCUR = ADDR(TASSEN(1)); /*FIRST ASSOC ENTRY   */ 03520000
         L     @07,RSPTWKC(,REG6)                                  0942 03521000
         L     @04,PTASSOC(,@07)                                   0942 03522000
         LA    @04,TASSEN(,@04)                                    0942 03523000
         ST    @04,PTASSCUR(,@07)                                  0942 03524000
*                  DO PTINDX3 = 1 TO TASSNENT                      0943 03525000
*                   WHILE(TASSTYPE ^= CITTYPE);                    0943 03526000
         LA    @07,1                                               0943 03527000
         B     @DE00943                                            0943 03528000
@DL00943 L     @07,RSPTWKC(,REG6)                                  0943 03529000
         L     @04,PTASSCUR(,@07)                                  0943 03530000
         L     @01,PTCITCUR(,@07)                                  0943 03531000
         CLC   TASSTYPE(1,@04),CITTYPE(@01)                        0943 03532000
         BE    @DC00943                                            0943 03533000
*                    PTASSCUR = PTASSCUR + LENGTH(TASSENT);        0944 03534000
         AL    @04,@CF00038                                        0944 03535000
         ST    @04,PTASSCUR(,@07)                                  0944 03536000
*                  END;                                            0945 03537000
         L     @04,RSPTWKC(,REG6)                                  0945 03538000
         LA    @07,1                                               0945 03539000
         AH    @07,PTINDX3(,@04)                                   0945 03540000
@DE00943 L     @04,RSPTWKC(,REG6)                                  0945 03541000
         STH   @07,PTINDX3(,@04)                                   0945 03542000
         L     @04,RSPTWKC(,REG6)                                  0945 03543000
         L     @04,PTASSOC(,@04)                                   0945 03544000
         CH    @07,TASSNENT(,@04)                                  0945 03545000
         BNH   @DL00943                                            0945 03546000
@DC00943 DS    0H                                                  0946 03547000
*                  IF (TASSVER=ON & (TASSTYPE=VOLEXTID |           0946 03548000
*                   TASSTYPE=CATEXTID | CITFAVER=ON)) |            0946 03549000
*                   TASSSET=ON THEN                                0946 03550000
         L     @07,RSPTWKC(,REG6)                                  0946 03551000
         L     @04,PTASSCUR(,@07)                                  0946 03552000
         TM    TASSVER(@04),B'00100000'                            0946 03553000
         BNO   @GL00037                                            0946 03554000
         CLI   TASSTYPE(@04),C'W'                                  0946 03555000
         BE    @RT00946                                            0946 03556000
         CLI   TASSTYPE(@04),C'E'                                  0946 03557000
         BE    @RT00946                                            0946 03558000
         L     @07,PTCITCUR(,@07)                                  0946 03559000
         TM    CITFAVER(@07),B'01000000'                           0946 03560000
         BO    @RT00946                                            0946 03561000
@GL00037 L     @07,RSPTWKC(,REG6)                                  0946 03562000
         L     @07,PTASSCUR(,@07)                                  0946 03563000
         TM    TASSSET(@07),B'00001000'                            0946 03564000
         BNO   @RF00946                                            0946 03565000
@RT00946 DS    0H                                                  0947 03566000
*  TOBEVER:                                                        0947 03567000
*                    DO;                                           0947 03568000
*                                                                  0947 03569000
TOBEVER  DS    0H                                                  0948 03570000
*        /************************************************************/ 03571000
*        /*                                                          */ 03572000
*        /*     GET THE RECORD INTO STORAGE                          */ 03573000
*        /*                                                          */ 03574000
*        /************************************************************/ 03575000
*                                                                  0948 03576000
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */ 03577000
*                                                                  0948 03578000
         L     @07,RSGRABCU(,REG6)                                 0948 03579000
         L     @04,RSPTWKC(,REG6)                                  0948 03580000
         L     @01,PTASSCUR(,@04)                                  0948 03581000
         LH    @15,TASSRAB(,@01)                                   0948 03582000
         SLA   @15,2                                               0948 03583000
         L     @15,RABARRAY-4(@15,@07)                             0948 03584000
         ST    @15,GRABCURR(,@07)                                  0948 03585000
*                      DO;                                         0949 03586000
*                        RSRTYPE = ''B;                            0950 03587000
         MVI   RSRTYPE(REG6),X'00'                                 0950 03588000
*                        RSRGET = ON;      /* GETRCD  */           0951 03589000
         OI    RSRGET(REG6),B'10000000'                            0951 03590000
*                        RSRUPD = ON;      /* UPDATE  */           0952 03591000
         OI    RSRUPD(REG6),B'00001000'                            0952 03592000
*                        RSRDS = ''B;                              0953 03593000
         NI    RSRDS(REG6),B'00011111'                             0953 03594000
*                        RSRWF = ON;       /* WORKFILE  */         0954 03595000
*                        RSRDIR = ON;      /* DIRECT  */           0955 03596000
*                        RSRKEY = ON;      /* KEY  */              0956 03597000
         OI    RSRWF(REG6),B'10010100'                             0956 03598000
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   0957 03599000
         OI    RSVIAFCR(REG6),B'10000000'                          0957 03600000
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       0958 03601000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@04)                       0958 03602000
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     0959 03603000
*                                                                  0959 03604000
         L     @07,PTCITCUR(,@04)                                  0959 03605000
         MVC   RSVIACIN(3,REG6),CITCIN(@07)                        0959 03606000
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/ 03607000
*                      CALL GETVIA;                                0960 03608000
         L     @15,@CV03442                                        0960 03609000
         BALR  @14,@15                                             0960 03610000
*                      END;                                        0961 03611000
*                      IF RABNRF = ON THEN                         0962 03612000
*                                                                  0962 03613000
         L     @07,RSGRABCU(,REG6)                                 0962 03614000
         L     @07,GRABCURR(,@07)                                  0962 03615000
         TM    RABNRF(@07),B'00000010'                             0962 03616000
         BNO   @RF00962                                            0962 03617000
*                        DO;                                       0963 03618000
*                        /*CALL CKERR*/                            0964 03619000
*                          RSCKERR = RSCKERR && RSCKERR;           0964 03620000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0964 03621000
*                          RSCKERN = RSE100;                       0965 03622000
         MVC   RSCKERN(2,REG6),@CH00143                            0965 03623000
*                          RSCKTERM = 'TERM';                      0966 03624000
*                                                                  0966 03625000
         MVC   RSCKTERM(4,REG6),@CC03762                           0966 03626000
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  03627000
*                                                                    */ 03628000
*                        CALL CKERR;                               0967 03629000
         L     @15,@CV03449                                        0967 03630000
         BALR  @14,@15                                             0967 03631000
*                        END;                                      0968 03632000
*                                      /*SHOULD ALWAYS FIND RCD      */ 03633000
*                                                                  0969 03634000
*        /************************************************************/ 03635000
*        /*                                                          */ 03636000
*        /*     FOR RECORDS TO BE VERIFIED, MARK ASSOCIATION         */ 03637000
*        /*     CHECKED                                              */ 03638000
*        /*                                                          */ 03639000
*        /************************************************************/ 03640000
*                                                                  0969 03641000
*                      IF TASSVER = ON THEN                        0969 03642000
@RF00962 L     @07,RSPTWKC(,REG6)                                  0969 03643000
         L     @04,PTASSCUR(,@07)                                  0969 03644000
         TM    TASSVER(@04),B'00100000'                            0969 03645000
         BNO   @RF00969                                            0969 03646000
*                        DO;                                       0970 03647000
*                          CITFAVER = ON; /*MARK EXT VERIFIED        */ 03648000
         L     @07,PTCITCUR(,@07)                                  0971 03649000
         OI    CITFAVER(@07),B'01000000'                           0971 03650000
*                          RSWASSCK = ON;                          0972 03651000
         L     @07,RSGRABCU(,REG6)                                 0972 03652000
         L     @07,GRABCURR(,@07)                                  0972 03653000
         OI    RSWASSCK(@07),B'00000010'                           0972 03654000
*                        END;                                      0973 03655000
*                                                                  0973 03656000
*        /************************************************************/ 03657000
*        /*                                                          */ 03658000
*        /*     SCAN ALL CINS IN THIS RECORD TO UPDATE ANY THAT      */ 03659000
*        /*     HAVE BEEN REASSIGNED OR DELETE ANY NO LONGER VALID   */ 03660000
*        /*                                                          */ 03661000
*        /************************************************************/ 03662000
*                                                                  0974 03663000
*                      PTLOC = PTLOC && PTLOC;                     0974 03664000
@RF00969 L     @07,RSPTWKC(,REG6)                                  0974 03665000
         XC    PTLOC(20,@07),PTLOC(@07)                            0974 03666000
*                      PTLBCITX = PTCITNC;                         0975 03667000
         MVC   PTLBCITX(3,@07),PTCITNC(@07)                        0975 03668000
*                      IF CITDICNT ^= 0 THEN                       0976 03669000
         L     @07,PTCITCUR(,@07)                                  0976 03670000
         CLI   CITDICNT(@07),0                                     0976 03671000
         BE    @RF00976                                            0976 03672000
*  SETDIT:                                                         0977 03673000
*                        DO PTDITNC=CITDITAB TO (CITDITAB+CITDICNT-1);  03674000
*                                                                  0977 03675000
SETDIT   L     @07,RSPTWKC(,REG6)                                  0977 03676000
         L     @07,PTCITCUR(,@07)                                  0977 03677000
         L     @07,CITDITAB-1(,@07)                                0977 03678000
         LA    @07,0(,@07)                                         0977 03679000
         B     @DE00977                                            0977 03680000
@DL00977 DS    0H                                                  0978 03681000
*        /************************************************************/ 03682000
*        /*                                                          */ 03683000
*        /*     GET A CIN IN THE RECORD (DITABE)                     */ 03684000
*        /*                                                          */ 03685000
*        /************************************************************/ 03686000
*                                                                  0978 03687000
*                          CALL LOCDIT;                            0978 03688000
*                                                                  0978 03689000
         BAL   @14,LOCDIT                                          0978 03690000
*        /************************************************************/ 03691000
*        /*                                                          */ 03692000
*        /*     GET CORRESPONDING CITABLE ENTRY AND CHECK FOR        */ 03693000
*        /*     REASSIGNMENT OF THE CIN.                             */ 03694000
*        /*     NOTE * FOR ALIAS, IF CHAIN HAS BEEN REPAIRED, THEN   */ 03695000
*        /*     VERX ALTERED DITCITAB AND FORCED REASSIGN(DITFARAS)  */ 03696000
*        /*                                                          */ 03697000
*        /************************************************************/ 03698000
*                                                                  0979 03699000
*                          IF DITCITAB = 0 THEN                    0979 03700000
         L     @07,RSPTWKC(,REG6)                                  0979 03701000
         L     @04,PTLCDIT(,@07)                                   0979 03702000
         L     @04,DITCITAB-1(,@04)                                0979 03703000
         LA    @04,0(,@04)                                         0979 03704000
         LTR   @04,@04                                             0979 03705000
         BNZ   @RF00979                                            0979 03706000
*                                      /*ALLOW FOR 0 IN ALIAS CHAIN  */ 03707000
*                            PTCITWK = 0;                          0980 03708000
         SLR   @04,@04                                             0980 03709000
         ST    @04,PTCITWK(,@07)                                   0980 03710000
*                          ELSE                                    0981 03711000
*                            DO;                                   0981 03712000
         B     @RC00979                                            0981 03713000
@RF00979 DS    0H                                                  0982 03714000
*                              RSTANCHR = ADDR(RSGCITS);           0982 03715000
         LA    @07,RSGCITS(,REG6)                                  0982 03716000
         ST    @07,RSTANCHR(,REG6)                                 0982 03717000
*                              RSTENTIX = DITCITAB;                0983 03718000
         L     @07,RSPTWKC(,REG6)                                  0983 03719000
         L     @07,PTLCDIT(,@07)                                   0983 03720000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      0983 03721000
*                              /* CALL TO MODULE IDCRS03 FOR PROCEDURE  03722000
*ETNEXTE                                                             */ 03723000
*                              CALL GETNEXTE;                      0984 03724000
         L     @15,@CV03436                                        0984 03725000
         BALR  @14,@15                                             0984 03726000
*                              PTCITWK = RSTENTAD;                 0985 03727000
         L     @07,RSPTWKC(,REG6)                                  0985 03728000
         L     @04,RSTENTAD(,REG6)                                 0985 03729000
         ST    @04,PTCITWK(,@07)                                   0985 03730000
*                              IF PTCITWK->CITFARAS=ON THEN        0986 03731000
         TM    CITFARAS(@04),B'00100000'                           0986 03732000
         BNO   @RF00986                                            0986 03733000
*                                DITFARAS = ON;                    0987 03734000
         L     @07,PTLCDIT(,@07)                                   0987 03735000
         OI    DITFARAS(@07),B'00100000'                           0987 03736000
*                            END;                                  0988 03737000
*                                                                  0988 03738000
@RF00986 DS    0H                                                  0989 03739000
*        /************************************************************/ 03740000
*        /*                                                          */ 03741000
*        /*     IF THE CIN IN THE RECORD BEING SET IS AN ASSOCIATION */ 03742000
*        /*     AND THE ASSOCIATION WAS NOT CHECKED, THEN            */ 03743000
*        /*     FLAG THE GROUP OCCURRENCE FOR DELETION.              */ 03744000
*        /*                                                          */ 03745000
*        /************************************************************/ 03746000
*                                                                  0989 03747000
*                          IF DITFBAS1=ON | DITFBAS2=ON THEN       0989 03748000
@RC00979 L     @07,RSPTWKC(,REG6)                                  0989 03749000
         L     @04,PTLCDIT(,@07)                                   0989 03750000
         TM    DITFBAS1(@04),B'00110000'                           0989 03751000
         BZ    @RF00989                                            0989 03752000
*                            IF DITFAVER=OFF THEN                  0990 03753000
         TM    DITFAVER(@04),B'01000000'                           0990 03754000
         BNZ   @RF00990                                            0990 03755000
*                              DO;                                 0991 03756000
*                                DITFBDGO=ON;                      0992 03757000
         OI    DITFBDGO(@04),B'00000100'                           0992 03758000
*                                PTF1DELT=ON;                      0993 03759000
*                                                                  0993 03760000
         OI    PTF1DELT(@07),B'00010000'                           0993 03761000
*        /************************************************************/ 03762000
*        /*                                                          */ 03763000
*        /*       MARK THE BASE RECORD FOR DELETE OF GO              */ 03764000
*        /*                                                          */ 03765000
*        /************************************************************/ 03766000
*                                                                  0994 03767000
*                                IF CITEXTBA^=0 THEN               0994 03768000
         L     @07,PTCITCUR(,@07)                                  0994 03769000
         L     @04,CITEXTBA-1(,@07)                                0994 03770000
         LA    @04,0(,@04)                                         0994 03771000
         LTR   @04,@04                                             0994 03772000
         BZ    @RF00994                                            0994 03773000
*                                  DO; /*GET BASE FOR MARKING        */ 03774000
*                                    RSTANCHR=ADDR(RSGCITS);       0996 03775000
         LA    @04,RSGCITS(,REG6)                                  0996 03776000
         ST    @04,RSTANCHR(,REG6)                                 0996 03777000
*                                    RSTENTIX=CITEXTBA;            0997 03778000
         MVC   RSTENTIX(3,REG6),CITEXTBA(@07)                      0997 03779000
*                                    /* CALL TO MODULE IDCRS03 FOR PROC 03780000
*DURE GETNEXTE                                                       */ 03781000
*                                    CALL GETNEXTE;                0998 03782000
         L     @15,@CV03436                                        0998 03783000
         BALR  @14,@15                                             0998 03784000
*                                  END;                            0999 03785000
*                                ELSE  /*THIS IS BASE FOR MARKING    */ 03786000
*                                  RSTENTAD = PTCITCUR;            1000 03787000
*                                                                  1000 03788000
         B     @RC00994                                            1000 03789000
@RF00994 L     @07,RSPTWKC(,REG6)                                  1000 03790000
         L     @07,PTCITCUR(,@07)                                  1000 03791000
         ST    @07,RSTENTAD(,REG6)                                 1000 03792000
*                                RSTENTAD->CITFADGO=ON; /*FLG DELGO  */ 03793000
@RC00994 L     @07,RSTENTAD(,REG6)                                 1001 03794000
         OI    CITFADGO(@07),B'00000001'                           1001 03795000
*                              END;                                1002 03796000
*                            ELSE;                                 1003 03797000
*                                                                  1003 03798000
@RF00990 DS    0H                                                  1004 03799000
*        /************************************************************/ 03800000
*        /*                                                          */ 03801000
*        /*     IF THE CIN IN THE RECORD BEING RESET IS THE CIN OF   */ 03802000
*        /*     AN EXTENSION AND THE EXTENSION RECORD IS NOT VALID,  */ 03803000
*        /*     FLAG THE GOP FOR DELETION.                           */ 03804000
*        /*                                                          */ 03805000
*        /************************************************************/ 03806000
*                                                                  1004 03807000
*                          ELSE                                    1004 03808000
*                            IF PTCITWK->CITFAINV=ON THEN          1004 03809000
         B     @RC00989                                            1004 03810000
@RF00989 L     @07,RSPTWKC(,REG6)                                  1004 03811000
         L     @04,PTCITWK(,@07)                                   1004 03812000
         TM    CITFAINV(@04),B'00000010'                           1004 03813000
         BNO   @RF01004                                            1004 03814000
*                              DITFADEL=ON; /*DELETE GOP             */ 03815000
*                                                                  1005 03816000
         L     @07,PTLCDIT(,@07)                                   1005 03817000
         OI    DITFADEL(@07),B'00010000'                           1005 03818000
*        /************************************************************/ 03819000
*        /*                                                          */ 03820000
*        /*     DELETE GOPS AND UPDATE REASSIGNED CINS               */ 03821000
*        /*                                                          */ 03822000
*        /************************************************************/ 03823000
*                                                                  1006 03824000
*  SETMOD:                                                         1006 03825000
*                          IF DITFBDGO=OFF &                       1006 03826000
*                           (DITFADEL=ON | DITFARAS=ON) THEN       1006 03827000
@RF01004 DS    0H                                                  1006 03828000
@RC00989 DS    0H                                                  1006 03829000
SETMOD   L     @07,RSPTWKC(,REG6)                                  1006 03830000
         L     @04,PTLCDIT(,@07)                                   1006 03831000
         TM    DITFBDGO(@04),B'00000100'                           1006 03832000
         BNZ   @RF01006                                            1006 03833000
         TM    DITFADEL(@04),B'00110000'                           1006 03834000
         BZ    @RF01006                                            1006 03835000
*                            DO;                                   1007 03836000
*                              PTDITCUR=PTLCDIT; /*DITABE FOR ALTER  */ 03837000
         ST    @04,PTDITCUR(,@07)                                  1008 03838000
*                              CALL CINALTER;                      1009 03839000
         BAL   @14,CINALTER                                        1009 03840000
*                            END;                                  1010 03841000
*                        END SETDIT;                               1011 03842000
*                                                                  1011 03843000
@RF01006 L     @04,RSPTWKC(,REG6)                                  1011 03844000
         LA    @07,1                                               1011 03845000
         L     @04,PTDITNC-1(,@04)                                 1011 03846000
         LA    @04,0(,@04)                                         1011 03847000
         ALR   @07,@04                                             1011 03848000
@DE00977 L     @04,RSPTWKC(,REG6)                                  1011 03849000
         STCM  @07,7,PTDITNC(@04)                                  1011 03850000
         L     @04,RSPTWKC(,REG6)                                  1011 03851000
         L     @04,PTCITCUR(,@04)                                  1011 03852000
         L     @01,RSPTWKC(,REG6)                                  1011 03853000
         L     @01,PTCITCUR(,@01)                                  1011 03854000
         L     @04,CITDITAB-1(,@04)                                1011 03855000
         LA    @04,0(,@04)                                         1011 03856000
         SLR   @00,@00                                             1011 03857000
         IC    @00,CITDICNT(,@01)                                  1011 03858000
         ALR   @04,@00                                             1011 03859000
         BCTR  @04,0                                               1011 03860000
         CR    @07,@04                                             1011 03861000
         BNH   @DL00977                                            1011 03862000
*        /************************************************************/ 03863000
*        /*                                                          */ 03864000
*        /*     UPDATE THE RECORD                                    */ 03865000
*        /*                                                          */ 03866000
*        /************************************************************/ 03867000
*                                                                  1012 03868000
*                                                                  1012 03869000
*                      DO;                                         1012 03870000
@RF00976 DS    0H                                                  1013 03871000
*                        RSRTYPE = ''B;                            1013 03872000
         MVI   RSRTYPE(REG6),X'00'                                 1013 03873000
*                        RSRUPDT = ON;     /* UPDRCD  */           1014 03874000
         OI    RSRUPDT(REG6),B'00100000'                           1014 03875000
*                        RSRUPD = ON;      /* UPDATE  */           1015 03876000
         OI    RSRUPD(REG6),B'00001000'                            1015 03877000
*                        RSRDS = ''B;                              1016 03878000
         NI    RSRDS(REG6),B'00011111'                             1016 03879000
*                        RSRWF = ON;       /* WORKFILE  */         1017 03880000
*                        RSRDIR = ON;      /* DIRECT  */           1018 03881000
*                                                                  1018 03882000
         OI    RSRWF(REG6),B'10000100'                             1018 03883000
*                      /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  03884000
*                                                                    */ 03885000
*                      CALL RECMGMT;                               1019 03886000
         L     @15,@CV03458                                        1019 03887000
         BALR  @14,@15                                             1019 03888000
*                        RFY RTNREG RSTD;                          1020 03889000
*                        TESTRC = RTNREG;                          1021 03890000
         STH   RTNREG,TESTRC(,REG6)                                1021 03891000
*                        RFY RTNREG UNRSTD;                        1022 03892000
*                      END;                                        1023 03893000
*                                                                  1023 03894000
*        /************************************************************/ 03895000
*        /*                                                          */ 03896000
*        /*     UPDATE ALL LOWER TABLES DEPENDENT ON THIS RECORD'S   */ 03897000
*        /*     STATUS                                               */ 03898000
*        /*                                                          */ 03899000
*        /************************************************************/ 03900000
*                                                                  1024 03901000
*                      IF PTCITI = 1 THEN;                         1024 03902000
         L     @07,RSPTWKC(,REG6)                                  1024 03903000
         CLC   PTCITI(3,@07),@CF00212+1                            1024 03904000
         BE    @RT01024                                            1024 03905000
*                                      /*NO SCAN FOR FIRST TBL       */ 03906000
*                      ELSE                                        1026 03907000
*                        DO;                                       1026 03908000
*                          RSTANCHR = ADDR(RSGCITS);               1027 03909000
         LA    @07,RSGCITS(,REG6)                                  1027 03910000
         ST    @07,RSTANCHR(,REG6)                                 1027 03911000
*                          DO RSTENTIX=1 TO (PTCITI-1);            1028 03912000
         LA    @07,1                                               1028 03913000
         B     @DE01028                                            1028 03914000
@DL01028 DS    0H                                                  1029 03915000
*                            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GE 03916000
*NEXTE                                                               */ 03917000
*                            CALL GETNEXTE;                        1029 03918000
         L     @15,@CV03436                                        1029 03919000
         BALR  @14,@15                                             1029 03920000
*                            IF RSTENTAD->CITCIN=CITCIN THEN       1030 03921000
         L     @07,RSTENTAD(,REG6)                                 1030 03922000
         L     @04,RSPTWKC(,REG6)                                  1030 03923000
         L     @04,PTCITCUR(,@04)                                  1030 03924000
         CLC   CITCIN(3,@07),CITCIN(@04)                           1030 03925000
         BNE   @RF01030                                            1030 03926000
*                              /*ENTRY SAME AS OURS                  */ 03927000
*                              DO;                                 1031 03928000
*                                IF CITFAVER=ON THEN               1032 03929000
         TM    CITFAVER(@04),B'01000000'                           1032 03930000
         BNO   @RF01032                                            1032 03931000
*                                        /*XFER VERIFIED INDR        */ 03932000
*                                  RSTENTAD->CITFAVER=ON;          1033 03933000
         OI    CITFAVER(@07),B'01000000'                           1033 03934000
*                                IF CITFARAS=ON THEN               1034 03935000
@RF01032 L     @07,RSPTWKC(,REG6)                                  1034 03936000
         L     @07,PTCITCUR(,@07)                                  1034 03937000
         TM    CITFARAS(@07),B'00100000'                           1034 03938000
         BNO   @RF01034                                            1034 03939000
*                                        /*XFER REASSIGNED INDR      */ 03940000
*                                  RSTENTAD->CITFARAS=ON;          1035 03941000
         L     @07,RSTENTAD(,REG6)                                 1035 03942000
         OI    CITFARAS(@07),B'00100000'                           1035 03943000
*                                      /*XFER REASSIGN CIN           */ 03944000
*                                RSTENTAD->CITRCIN=CITRCIN;        1036 03945000
@RF01034 L     @07,RSTENTAD(,REG6)                                 1036 03946000
         L     @04,RSPTWKC(,REG6)                                  1036 03947000
         L     @04,PTCITCUR(,@04)                                  1036 03948000
         MVC   CITRCIN(3,@07),CITRCIN(@04)                         1036 03949000
*                              END;                                1037 03950000
*                          END;                                    1038 03951000
@RF01030 LA    @07,1                                               1038 03952000
         L     @04,RSTENTIX-1(,REG6)                               1038 03953000
         LA    @04,0(,@04)                                         1038 03954000
         ALR   @07,@04                                             1038 03955000
@DE01028 STCM  @07,7,RSTENTIX(REG6)                                1038 03956000
         L     @04,RSPTWKC(,REG6)                                  1038 03957000
         L     @04,PTCITI-1(,@04)                                  1038 03958000
         LA    @04,0(,@04)                                         1038 03959000
         BCTR  @04,0                                               1038 03960000
         CR    @07,@04                                             1038 03961000
         BNH   @DL01028                                            1038 03962000
*                        END;                                      1039 03963000
*                    END TOBEVER;                                  1040 03964000
*        /************************************************************/ 03965000
*        /*                                                          */ 03966000
*        /*  IF THIS RECORD IS NOT TO BE VERIFIED, FREE THE BUFFER   */ 03967000
*        /*                                                          */ 03968000
*        /************************************************************/ 03969000
*                                                                  1041 03970000
*                  ELSE                                            1041 03971000
*                    IF TASSREAD=ON & TASSIS=OFF THEN              1041 03972000
         B     @RC00946                                            1041 03973000
@RF00946 L     @07,RSPTWKC(,REG6)                                  1041 03974000
         L     @07,PTASSCUR(,@07)                                  1041 03975000
         TM    TASSREAD(@07),B'10000000'                           1041 03976000
         BNO   @RF01041                                            1041 03977000
         TM    TASSIS(@07),B'00010000'                             1041 03978000
         BNZ   @RF01041                                            1041 03979000
*                      DO;                                         1042 03980000
*                        GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR */ 03981000
*                                                                  1043 03982000
         L     @04,RSGRABCU(,REG6)                                 1043 03983000
         LH    @07,TASSRAB(,@07)                                   1043 03984000
         SLA   @07,2                                               1043 03985000
         L     @07,RABARRAY-4(@07,@04)                             1043 03986000
         ST    @07,GRABCURR(,@04)                                  1043 03987000
*                        DO;                                       1044 03988000
*                          RSRTYPE = ''B;                          1045 03989000
         MVI   RSRTYPE(REG6),X'00'                                 1045 03990000
*                          RSRFREE = ON;     /* FREERCD  */        1046 03991000
         OI    RSRFREE(REG6),B'00000001'                           1046 03992000
*                          RSRUPD = ON;      /* UPDATE  */         1047 03993000
         OI    RSRUPD(REG6),B'00001000'                            1047 03994000
*                          RSRDS = ''B;                            1048 03995000
         NI    RSRDS(REG6),B'00011111'                             1048 03996000
*                          RSRWF = ON;       /* WORKFILE  */       1049 03997000
*                          RSRDIR = ON;      /* DIRECT  */         1050 03998000
*                          RSRKEY = ON;      /* KEY  */            1051 03999000
*                                                                  1051 04000000
         OI    RSRWF(REG6),B'10010100'                             1051 04001000
*                        /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGM 04002000
*                                                                    */ 04003000
*                        CALL RECMGMT;                             1052 04004000
         L     @15,@CV03458                                        1052 04005000
         BALR  @14,@15                                             1052 04006000
*                          RFY RTNREG RSTD;                        1053 04007000
*                          TESTRC = RTNREG;                        1054 04008000
         STH   RTNREG,TESTRC(,REG6)                                1054 04009000
*                          RFY RTNREG UNRSTD;                      1055 04010000
*                        END;                                      1056 04011000
*                      END;                                        1057 04012000
*                END;                                              1058 04013000
@RF01041 DS    0H                                                  1058 04014000
@RC00946 DS    0H                                                  1059 04015000
*            END SETCIT;                                           1059 04016000
*                                                                  1059 04017000
@RT00939 L     @04,RSPTWKC(,REG6)                                  1059 04018000
         LA    @07,1                                               1059 04019000
         L     @04,PTCITNC-1(,@04)                                 1059 04020000
         LA    @04,0(,@04)                                         1059 04021000
         ALR   @07,@04                                             1059 04022000
@DE00934 L     @04,RSPTWKC(,REG6)                                  1059 04023000
         STCM  @07,7,PTCITNC(@04)                                  1059 04024000
         L     @04,RSPTWKC(,REG6)                                  1059 04025000
         L     @04,PTCITL-1(,@04)                                  1059 04026000
         LA    @04,0(,@04)                                         1059 04027000
         CR    @07,@04                                             1059 04028000
         BNH   @DL00934                                            1059 04029000
*        /************************************************************/ 04030000
*        /*                                                          */ 04031000
*        /*  DELETE ALL GROUP OCCURRENCES MARKED FOR DELETION        */ 04032000
*        /*                                                          */ 04033000
*        /************************************************************/ 04034000
*                                                                  1060 04035000
*            IF PTF1DELT = ON THEN                                 1060 04036000
         L     @07,RSPTWKC(,REG6)                                  1060 04037000
         TM    PTF1DELT(@07),B'00010000'                           1060 04038000
         BNO   @RF01060                                            1060 04039000
*  SETDELGO:                                                       1061 04040000
*              DO;                                                 1061 04041000
SETDELGO DS    0H                                                  1062 04042000
*                GRABCURR = RABARRAY(EXTRAB); /*EXTENSION RAB        */ 04043000
*                                                                  1062 04044000
         L     @07,RSGRABCU(,REG6)                                 1062 04045000
         L     @04,RABARRAY+12(,@07)                               1062 04046000
         ST    @04,GRABCURR(,@07)                                  1062 04047000
*                DO;                                               1063 04048000
*                  RSRTYPE = ''B;                                  1064 04049000
         MVI   RSRTYPE(REG6),X'00'                                 1064 04050000
*                  RSRFREE = ON;     /* FREERCD  */                1065 04051000
         OI    RSRFREE(REG6),B'00000001'                           1065 04052000
*                  RSRUPD = ON;      /* UPDATE  */                 1066 04053000
         OI    RSRUPD(REG6),B'00001000'                            1066 04054000
*                  RSRDS = ''B;                                    1067 04055000
         NI    RSRDS(REG6),B'00011111'                             1067 04056000
*                  RSRWF = ON;       /* WORKFILE  */               1068 04057000
*                  RSRDIR = ON;      /* DIRECT  */                 1069 04058000
*                  RSRKEY = ON;      /* KEY  */                    1070 04059000
*                                                                  1070 04060000
         OI    RSRWF(REG6),B'10010100'                             1070 04061000
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */ 04062000
*                CALL RECMGMT;                                     1071 04063000
         L     @15,@CV03458                                        1071 04064000
         BALR  @14,@15                                             1071 04065000
*                  RFY RTNREG RSTD;                                1072 04066000
*                  TESTRC = RTNREG;                                1073 04067000
         STH   RTNREG,TESTRC(,REG6)                                1073 04068000
*                  RFY RTNREG UNRSTD;                              1074 04069000
*                END;      /*FREE POSSIBLE EXTENSION     */        1075 04070000
*                                                                  1075 04071000
*        /************************************************************/ 04072000
*        /*                                                          */ 04073000
*        /*  PROCESS ALL RECORDS IN THIS SET                         */ 04074000
*        /*                                                          */ 04075000
*        /************************************************************/ 04076000
*                                                                  1076 04077000
*                DO PTCITNC = PTCITI TO PTCITL;                    1076 04078000
         L     @07,RSPTWKC(,REG6)                                  1076 04079000
         L     @07,PTCITI-1(,@07)                                  1076 04080000
         LA    @07,0(,@07)                                         1076 04081000
         B     @DE01076                                            1076 04082000
@DL01076 DS    0H                                                  1077 04083000
*                  RSTANCHR = ADDR(RSGCITS);                       1077 04084000
         LA    @07,RSGCITS(,REG6)                                  1077 04085000
         ST    @07,RSTANCHR(,REG6)                                 1077 04086000
*                  RSTENTIX = PTCITNC; /*GET NEXT RECORD DESCRIPTOR  */ 04087000
         L     @07,RSPTWKC(,REG6)                                  1078 04088000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1078 04089000
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */ 04090000
*                  CALL GETNEXTE;                                  1079 04091000
         L     @15,@CV03436                                        1079 04092000
         BALR  @14,@15                                             1079 04093000
*                  PTCITCUR = RSTENTAD; /*ADDR OF CITABE FOR RECORD  */ 04094000
*                                                                  1080 04095000
         L     @07,RSPTWKC(,REG6)                                  1080 04096000
         L     @04,RSTENTAD(,REG6)                                 1080 04097000
         ST    @04,PTCITCUR(,@07)                                  1080 04098000
*        /************************************************************/ 04099000
*        /*                                                          */ 04100000
*        /*     PROCESS ONLY BASE RECORDS MARKED FOR DELETE OF GO    */ 04101000
*        /*                                                          */ 04102000
*        /************************************************************/ 04103000
*                                                                  1081 04104000
*                  IF CITFADGO = ON THEN                           1081 04105000
         TM    CITFADGO(@04),B'00000001'                           1081 04106000
         BNO   @RF01081                                            1081 04107000
*  SETDEL1:                                                        1082 04108000
*                    DO;                                           1082 04109000
*                                                                  1082 04110000
SETDEL1  DS    0H                                                  1083 04111000
*        /************************************************************/ 04112000
*        /*                                                          */ 04113000
*        /*     LOCATE ASSOCIATION ENTRY AND READ IN THE BASE RECORD */ 04114000
*        /*                                                          */ 04115000
*        /************************************************************/ 04116000
*                                                                  1083 04117000
*                      PTASSCUR = ADDR(TASSEN(1));                 1083 04118000
         L     @07,RSPTWKC(,REG6)                                  1083 04119000
         L     @04,PTASSOC(,@07)                                   1083 04120000
         LA    @04,TASSEN(,@04)                                    1083 04121000
         ST    @04,PTASSCUR(,@07)                                  1083 04122000
*                      DO PTINDX3 = 1 TO TASSNENT                  1084 04123000
*                       WHILE(TASSTYPE^=CITTYPE);                  1084 04124000
         LA    @07,1                                               1084 04125000
         B     @DE01084                                            1084 04126000
@DL01084 L     @07,RSPTWKC(,REG6)                                  1084 04127000
         L     @04,PTASSCUR(,@07)                                  1084 04128000
         L     @01,PTCITCUR(,@07)                                  1084 04129000
         CLC   TASSTYPE(1,@04),CITTYPE(@01)                        1084 04130000
         BE    @DC01084                                            1084 04131000
*                        PTASSCUR = PTASSCUR + LENGTH(TASSENT);    1085 04132000
         AL    @04,@CF00038                                        1085 04133000
         ST    @04,PTASSCUR(,@07)                                  1085 04134000
*                      END;                                        1086 04135000
         L     @04,RSPTWKC(,REG6)                                  1086 04136000
         LA    @07,1                                               1086 04137000
         AH    @07,PTINDX3(,@04)                                   1086 04138000
@DE01084 L     @04,RSPTWKC(,REG6)                                  1086 04139000
         STH   @07,PTINDX3(,@04)                                   1086 04140000
         L     @04,RSPTWKC(,REG6)                                  1086 04141000
         L     @04,PTASSOC(,@04)                                   1086 04142000
         CH    @07,TASSNENT(,@04)                                  1086 04143000
         BNH   @DL01084                                            1086 04144000
@DC01084 DS    0H                                                  1087 04145000
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */ 04146000
*                                                                  1087 04147000
         L     @07,RSGRABCU(,REG6)                                 1087 04148000
         L     @04,RSPTWKC(,REG6)                                  1087 04149000
         L     @01,PTASSCUR(,@04)                                  1087 04150000
         LH    @15,TASSRAB(,@01)                                   1087 04151000
         SLA   @15,2                                               1087 04152000
         L     @15,RABARRAY-4(@15,@07)                             1087 04153000
         ST    @15,GRABCURR(,@07)                                  1087 04154000
*                      DO;                                         1088 04155000
*                        RSRTYPE = ''B;                            1089 04156000
         MVI   RSRTYPE(REG6),X'00'                                 1089 04157000
*                        RSRGET = ON;      /* GETRCD  */           1090 04158000
         OI    RSRGET(REG6),B'10000000'                            1090 04159000
*                        RSRUPD = ON;      /* UPDATE  */           1091 04160000
         OI    RSRUPD(REG6),B'00001000'                            1091 04161000
*                        RSRDS = ''B;                              1092 04162000
         NI    RSRDS(REG6),B'00011111'                             1092 04163000
*                        RSRWF = ON;       /* WORKFILE  */         1093 04164000
*                        RSRDIR = ON;      /* DIRECT  */           1094 04165000
*                        RSRKEY = ON;      /* KEY  */              1095 04166000
         OI    RSRWF(REG6),B'10010100'                             1095 04167000
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   1096 04168000
         OI    RSVIAFCR(REG6),B'10000000'                          1096 04169000
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       1097 04170000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@04)                       1097 04171000
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     1098 04172000
*                                                                  1098 04173000
         L     @07,PTCITCUR(,@04)                                  1098 04174000
         MVC   RSVIACIN(3,REG6),CITCIN(@07)                        1098 04175000
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/ 04176000
*                      CALL GETVIA;                                1099 04177000
         L     @15,@CV03442                                        1099 04178000
         BALR  @14,@15                                             1099 04179000
*                      END;                                        1100 04180000
*                                                                  1100 04181000
*        /************************************************************/ 04182000
*        /*                                                          */ 04183000
*        /*     EXTRACT ALL ASSOCIATIONS.                            */ 04184000
*        /*                                                          */ 04185000
*        /************************************************************/ 04186000
*                                                                  1101 04187000
*                                                                  1101 04188000
*                      DO;                                         1101 04189000
*                        GRABBB = GRABCURR;                        1102 04190000
         L     @07,RSGRABCU(,REG6)                                 1102 04191000
         L     @04,GRABCURR(,@07)                                  1102 04192000
         ST    @04,GRABBB(,@07)                                    1102 04193000
*                        RSWGCODE = ASGC;                          1103 04194000
         MVI   RSWGCODE(REG6),X'02'                                1103 04195000
*                                      /*SPECIFY GROUP CODE          */ 04196000
*                        RSWFONE = OFF;/*FIND ALL OCCURRENCES        */ 04197000
         NI    RSWFONE(REG6),B'01111111'                           1104 04198000
*                        /* CALL THE FIND SUBROUTINE */            1105 04199000
*                                                                  1105 04200000
*                      /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND  */ 04201000
*                      CALL FIND;                                  1105 04202000
         L     @15,@CV03441                                        1105 04203000
         BALR  @14,@15                                             1105 04204000
*                      END;                                        1106 04205000
*                                                                  1106 04206000
*        /************************************************************/ 04207000
*        /*                                                          */ 04208000
*        /*     FIND OR ASSOC ERROR IF NO ENTRIES FOUND              */ 04209000
*        /*                                                          */ 04210000
*        /************************************************************/ 04211000
*                                                                  1107 04212000
*                      IF RSFENTLN = 0 THEN                        1107 04213000
*                                                                  1107 04214000
         L     @07,RSWASNVT(,REG6)                                 1107 04215000
         CLI   RSFENTLN(@07),0                                     1107 04216000
         BNE   @RF01107                                            1107 04217000
*                        DO;                                       1108 04218000
*                        /*CALL CKERR*/                            1109 04219000
*                          RSCKERR = RSCKERR && RSCKERR;           1109 04220000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1109 04221000
*                          RSCKERN = RSE100;                       1110 04222000
         MVC   RSCKERN(2,REG6),@CH00143                            1110 04223000
*                          RSCKTERM = 'TERM';                      1111 04224000
*                                                                  1111 04225000
         MVC   RSCKTERM(4,REG6),@CC03762                           1111 04226000
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  04227000
*                                                                    */ 04228000
*                        CALL CKERR;                               1112 04229000
         L     @15,@CV03449                                        1112 04230000
         BALR  @14,@15                                             1112 04231000
*                        END;                                      1113 04232000
*                                                                  1113 04233000
*        /************************************************************/ 04234000
*        /*                                                          */ 04235000
*        /*     SCAN ALL CIN ENTRIES IN THE BASE AND ITS             */ 04236000
*        /*     EXTENSIONS                                           */ 04237000
*        /*                                                          */ 04238000
*        /************************************************************/ 04239000
*                                                                  1114 04240000
*                      PTLOC = PTLOC && PTLOC;                     1114 04241000
@RF01107 L     @07,RSPTWKC(,REG6)                                  1114 04242000
         XC    PTLOC(20,@07),PTLOC(@07)                            1114 04243000
*                      PTLBCITX = PTCITNC; /*BASE RECORD FOR SCAN    */ 04244000
         MVC   PTLBCITX(3,@07),PTCITNC(@07)                        1115 04245000
*                      PTLFBDGO = ON;  /*SCAN FOR DELETE GO ONLY     */ 04246000
         OI    PTLFBDGO(@07),B'00000100'                           1116 04247000
*                      DO UNTIL(PTLCDIT=0);                        1117 04248000
*                                                                  1117 04249000
@DL01117 DS    0H                                                  1118 04250000
*        /************************************************************/ 04251000
*        /*                                                          */ 04252000
*        /*     GET GO TO BE DELETED                                 */ 04253000
*        /*                                                          */ 04254000
*        /************************************************************/ 04255000
*                                                                  1118 04256000
*                        CALL LOCDIT;                              1118 04257000
*                                                                  1118 04258000
         BAL   @14,LOCDIT                                          1118 04259000
*        /************************************************************/ 04260000
*        /*                                                          */ 04261000
*        /*     LOCATE MATCHING FIND ENTRY BY GO SEQUENCE NUMBER.    */ 04262000
*        /*     IF FOUND, DELETE THE GO.                             */ 04263000
*        /*                                                          */ 04264000
*        /************************************************************/ 04265000
*                                                                  1119 04266000
*                        IF PTLCDIT ^= 0 THEN                      1119 04267000
         L     @07,RSPTWKC(,REG6)                                  1119 04268000
         L     @07,PTLCDIT(,@07)                                   1119 04269000
         LTR   @07,@07                                             1119 04270000
         BZ    @RF01119                                            1119 04271000
*                                      /*CHK IF ANY FOUND            */ 04272000
*                          DO;                                     1120 04273000
*                            RSFAENT = RSFCADR; /*FIRST ASSN         */ 04274000
         L     @07,RSWASNVT(,REG6)                                 1121 04275000
         L     @04,RSFCADR(,@07)                                   1121 04276000
         ST    @04,RSFAENT(,@07)                                   1121 04277000
*                            DO RSFCNDX = 1 TO RSFHNDX             1122 04278000
*                             WHILE(SNSN^=DITSN);                  1122 04279000
         LA    @07,1                                               1122 04280000
         B     @DE01122                                            1122 04281000
@DL01122 L     @07,RSWASNVT(,REG6)                                 1122 04282000
         L     @04,RSFAENT(,@07)                                   1122 04283000
         L     @01,RSPTWKC(,REG6)                                  1122 04284000
         L     @01,PTLCDIT(,@01)                                   1122 04285000
         SLR   @00,@00                                             1122 04286000
         ICM   @00,3,SNSN(@04)                                     1122 04287000
         CH    @00,DITSN(,@01)                                     1122 04288000
         BE    @DC01122                                            1122 04289000
*                              RSFAENT = RSFAENT + RSFENTLN;       1123 04290000
         SLR   @15,@15                                             1123 04291000
         IC    @15,RSFENTLN(,@07)                                  1123 04292000
         ALR   @04,@15                                             1123 04293000
         ST    @04,RSFAENT(,@07)                                   1123 04294000
*                            END;                                  1124 04295000
*                                                                  1124 04296000
         L     @04,RSWASNVT(,REG6)                                 1124 04297000
         LA    @07,1                                               1124 04298000
         AH    @07,RSFCNDX(,@04)                                   1124 04299000
@DE01122 L     @04,RSWASNVT(,REG6)                                 1124 04300000
         STH   @07,RSFCNDX(,@04)                                   1124 04301000
         L     @04,RSWASNVT(,REG6)                                 1124 04302000
         CH    @07,RSFHNDX(,@04)                                   1124 04303000
         BNH   @DL01122                                            1124 04304000
@DC01122 DS    0H                                                  1125 04305000
*                            IF RSFCNDX > RSFHNDX | SNFDEL=ON THEN;     04306000
         L     @07,RSWASNVT(,REG6)                                 1125 04307000
         LH    @04,RSFCNDX(,@07)                                   1125 04308000
         CH    @04,RSFHNDX(,@07)                                   1125 04309000
         BH    @RT01125                                            1125 04310000
         L     @07,RSFAENT(,@07)                                   1125 04311000
         TM    SNFDEL(@07),B'01000000'                             1125 04312000
         BO    @RT01125                                            1125 04313000
*                                      /*IGNORE ALREADY DELETED      */ 04314000
*                            ELSE                                  1127 04315000
*                              /* CALL TO MODULE IDCRS04 FOR PROCEDURE  04316000
*ELGO                                                                */ 04317000
*                              CALL DELGO;                         1127 04318000
         L     @15,@CV03440                                        1127 04319000
         BALR  @14,@15                                             1127 04320000
*                                      /*DELETE THE GO               */ 04321000
*                          END;                                    1128 04322000
@RT01125 DS    0H                                                  1129 04323000
*                      END;                                        1129 04324000
*                                                                  1129 04325000
@RF01119 DS    0H                                                  1129 04326000
@DE01117 L     @07,RSPTWKC(,REG6)                                  1129 04327000
         L     @04,PTLCDIT(,@07)                                   1129 04328000
         LTR   @04,@04                                             1129 04329000
         BNZ   @DL01117                                            1129 04330000
*        /************************************************************/ 04331000
*        /*                                                          */ 04332000
*        /*     FREE THE BASE RECORD                                 */ 04333000
*        /*                                                          */ 04334000
*        /************************************************************/ 04335000
*                                                                  1130 04336000
*                      GRABCURR = RABARRAY(TASSRAB); /*BASE BUFFER   */ 04337000
*                                                                  1130 04338000
         L     @04,RSGRABCU(,REG6)                                 1130 04339000
         L     @07,PTASSCUR(,@07)                                  1130 04340000
         LH    @07,TASSRAB(,@07)                                   1130 04341000
         SLA   @07,2                                               1130 04342000
         L     @07,RABARRAY-4(@07,@04)                             1130 04343000
         ST    @07,GRABCURR(,@04)                                  1130 04344000
*                      DO;                                         1131 04345000
*                        RSRTYPE = ''B;                            1132 04346000
         MVI   RSRTYPE(REG6),X'00'                                 1132 04347000
*                        RSRFREE = ON;     /* FREERCD  */          1133 04348000
         OI    RSRFREE(REG6),B'00000001'                           1133 04349000
*                        RSRUPD = ON;      /* UPDATE  */           1134 04350000
         OI    RSRUPD(REG6),B'00001000'                            1134 04351000
*                        RSRDS = ''B;                              1135 04352000
         NI    RSRDS(REG6),B'00011111'                             1135 04353000
*                        RSRWF = ON;       /* WORKFILE  */         1136 04354000
*                        RSRDIR = ON;      /* DIRECT  */           1137 04355000
*                        RSRKEY = ON;      /* KEY  */              1138 04356000
*                                                                  1138 04357000
         OI    RSRWF(REG6),B'10010100'                             1138 04358000
*                      /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  04359000
*                                                                    */ 04360000
*                      CALL RECMGMT;                               1139 04361000
         L     @15,@CV03458                                        1139 04362000
         BALR  @14,@15                                             1139 04363000
*                        RFY RTNREG RSTD;                          1140 04364000
*                        TESTRC = RTNREG;                          1141 04365000
         STH   RTNREG,TESTRC(,REG6)                                1141 04366000
*                        RFY RTNREG UNRSTD;                        1142 04367000
*                      END;                                        1143 04368000
*                                                                  1143 04369000
*        /************************************************************/ 04370000
*        /*                                                          */ 04371000
*        /*     FREE THE SN TABLE FOR REUSE BY FIND                  */ 04372000
*        /*                                                          */ 04373000
*        /************************************************************/ 04374000
*                                                                  1144 04375000
*                      RSFENTLN = 0;                               1144 04376000
*                                                                  1144 04377000
         L     @07,RSWASNVT(,REG6)                                 1144 04378000
         MVI   RSFENTLN(@07),X'00'                                 1144 04379000
*                    END SETDEL1;                                  1145 04380000
*                END;                                              1146 04381000
@RF01081 L     @04,RSPTWKC(,REG6)                                  1146 04382000
         LA    @07,1                                               1146 04383000
         L     @04,PTCITNC-1(,@04)                                 1146 04384000
         LA    @04,0(,@04)                                         1146 04385000
         ALR   @07,@04                                             1146 04386000
@DE01076 L     @04,RSPTWKC(,REG6)                                  1146 04387000
         STCM  @07,7,PTCITNC(@04)                                  1146 04388000
         L     @04,RSPTWKC(,REG6)                                  1146 04389000
         L     @04,PTCITL-1(,@04)                                  1146 04390000
         LA    @04,0(,@04)                                         1146 04391000
         CR    @07,@04                                             1146 04392000
         BNH   @DL01076                                            1146 04393000
*            END SETDELGO;                                         1147 04394000
*          END SETPROC;                                            1148 04395000
*        /************************************************************/ 04396000
*        /*                                                          */ 04397000
*        /* IF BASE NOT VERIFIED AND SHOULD HAVE BEEN, THEN ISSUE    */ 04398000
*        /* MESSAGE FOR ENTRY DELETED - IDC21026I                    */ 04399000
*        /*                                                          */ 04400000
*        /************************************************************/ 04401000
*                                                                  1149 04402000
*        ELSE                                                      1149 04403000
*  SETNVER:                                                        1149 04404000
*          DO;                                                     1149 04405000
         B     @RC00932                                            1149 04406000
@RF00932 DS    0H                                                  1149 04407000
SETNVER  DS    0H                                                  1150 04408000
*            GRABCURR = (RABARRAY(ADDR(PTASSOC->TASSEN(1))->TASSRAB));  04409000
         L     @07,RSGRABCU(,REG6)                                 1150 04410000
         L     @04,RSPTWKC(,REG6)                                  1150 04411000
         L     @04,PTASSOC(,@04)                                   1150 04412000
         LA    @04,TASSEN(,@04)                                    1150 04413000
         LH    @04,TASSRAB(,@04)                                   1150 04414000
         SLA   @04,2                                               1150 04415000
         L     @04,RABARRAY-4(@04,@07)                             1150 04416000
         ST    @04,GRABCURR(,@07)                                  1150 04417000
*                                      /*BASE BUFFER                 */ 04418000
*                                                                  1151 04419000
*            DO;                                                   1151 04420000
*            /*CALL CKERR*/                                        1152 04421000
*              RSCKERR = RSCKERR && RSCKERR;                       1152 04422000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1152 04423000
*              RSCKERN = RSE029;                                   1153 04424000
         MVC   RSCKERN(2,REG6),@CH00948                            1153 04425000
*              RSCKTERM = 'RETU';                                  1154 04426000
         MVC   RSCKTERM(4,REG6),@CC03787                           1154 04427000
*              RSCKMVAR(1) = ADDR(CNAME);                          1155 04428000
         AL    @04,@CF00175                                        1155 04429000
         LA    @07,CNAME(,@04)                                     1155 04430000
         ST    @07,RSCKMVAR(,REG6)                                 1155 04431000
*              RSCKMVAR(2) = ADDR(RCDID);                          1156 04432000
*                                                                  1156 04433000
         LA    @07,RCDID(,@04)                                     1156 04434000
         ST    @07,RSCKMVAR+4(,REG6)                               1156 04435000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 04436000
*            CALL CKERR;                                           1157 04437000
         L     @15,@CV03449                                        1157 04438000
         BALR  @14,@15                                             1157 04439000
*            END;                                                  1158 04440000
*                                                                  1158 04441000
*        /************************************************************/ 04442000
*        /*                                                          */ 04443000
*        /*   FREE ALL BUFFERS POSSIBLY USED                         */ 04444000
*        /*                                                          */ 04445000
*        /************************************************************/ 04446000
*                                                                  1159 04447000
*            PTASSCUR = ADDR(TASSEN(1)); /*FIRST ASSOC TBL ENTRY     */ 04448000
         L     @07,RSPTWKC(,REG6)                                  1159 04449000
         L     @04,PTASSOC(,@07)                                   1159 04450000
         LA    @04,TASSEN(,@04)                                    1159 04451000
         ST    @04,PTASSCUR(,@07)                                  1159 04452000
*            DO PTINDX3 = 1 TO TASSNENT;                           1160 04453000
         LA    @07,1                                               1160 04454000
         B     @DE01160                                            1160 04455000
@DL01160 DS    0H                                                  1161 04456000
*              IF TASSREAD=ON & TASSIS=OFF THEN                    1161 04457000
         L     @07,RSPTWKC(,REG6)                                  1161 04458000
         L     @07,PTASSCUR(,@07)                                  1161 04459000
         TM    TASSREAD(@07),B'10000000'                           1161 04460000
         BNO   @RF01161                                            1161 04461000
         TM    TASSIS(@07),B'00010000'                             1161 04462000
         BNZ   @RF01161                                            1161 04463000
*                DO;                                               1162 04464000
*                  GRABCURR = RABARRAY(TASSRAB);                   1163 04465000
*                                                                  1163 04466000
         L     @04,RSGRABCU(,REG6)                                 1163 04467000
         LH    @07,TASSRAB(,@07)                                   1163 04468000
         SLA   @07,2                                               1163 04469000
         L     @07,RABARRAY-4(@07,@04)                             1163 04470000
         ST    @07,GRABCURR(,@04)                                  1163 04471000
*                   DO;                                            1164 04472000
*                     RSRTYPE = ''B;                               1165 04473000
         MVI   RSRTYPE(REG6),X'00'                                 1165 04474000
*                     RSRFREE = ON;     /* FREERCD  */             1166 04475000
         OI    RSRFREE(REG6),B'00000001'                           1166 04476000
*                     RSRUPD = ON;      /* UPDATE  */              1167 04477000
         OI    RSRUPD(REG6),B'00001000'                            1167 04478000
*                     RSRDS = ''B;                                 1168 04479000
         NI    RSRDS(REG6),B'00011111'                             1168 04480000
*                     RSRWF = ON;       /* WORKFILE  */            1169 04481000
*                     RSRDIR = ON;      /* DIRECT  */              1170 04482000
*                     RSRKEY = ON;      /* KEY  */                 1171 04483000
*                                                                  1171 04484000
         OI    RSRWF(REG6),B'10010100'                             1171 04485000
*                   /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  */ 04486000
*                   CALL RECMGMT;                                  1172 04487000
         L     @15,@CV03458                                        1172 04488000
         BALR  @14,@15                                             1172 04489000
*                     RFY RTNREG RSTD;                             1173 04490000
*                     TESTRC = RTNREG;                             1174 04491000
         STH   RTNREG,TESTRC(,REG6)                                1174 04492000
*                     RFY RTNREG UNRSTD;                           1175 04493000
*                   END;                                           1176 04494000
*                END;                                              1177 04495000
*              PTASSCUR = PTASSCUR + LENGTH(TASSENT);              1178 04496000
@RF01161 L     @07,RSPTWKC(,REG6)                                  1178 04497000
         LA    @04,4                                               1178 04498000
         AL    @04,PTASSCUR(,@07)                                  1178 04499000
         ST    @04,PTASSCUR(,@07)                                  1178 04500000
*            END;                                                  1179 04501000
         L     @04,RSPTWKC(,REG6)                                  1179 04502000
         LA    @07,1                                               1179 04503000
         AH    @07,PTINDX3(,@04)                                   1179 04504000
@DE01160 L     @04,RSPTWKC(,REG6)                                  1179 04505000
         STH   @07,PTINDX3(,@04)                                   1179 04506000
         L     @04,RSPTWKC(,REG6)                                  1179 04507000
         L     @04,PTASSOC(,@04)                                   1179 04508000
         CH    @07,TASSNENT(,@04)                                  1179 04509000
         BNH   @DL01160                                            1179 04510000
*          END SETNVER;                                            1180 04511000
*                                                                  1180 04512000
*        /************************************************************/ 04513000
*        /*                                                          */ 04514000
*        /*                       THAT'S ALL FOLKS                   */ 04515000
*        /*                                                          */ 04516000
*        /************************************************************/ 04517000
*                                                                  1181 04518000
*        IF GDTDBG = NULLPTR                                       1181 04519000
*          THEN;                                                   1181 04520000
@RC00932 L     @07,GDTDBG(,REG5)                                   1181 04521000
         LTR   @07,@07                                             1181 04522000
         BZ    @RT01181                                            1181 04523000
*          ELSE                                                    1183 04524000
*            CALL IDCDB010(GDTTBL,'RSS2');                         1183 04525000
         ST    REG5,@AL00001                                       1183 04526000
         LA    @07,@CC03823                                        1183 04527000
         ST    @07,@AL00001+4                                      1183 04528000
         MVI   @AL00001+4,X'80'                                    1183 04529000
         L     @15,GDTDBG(,REG5)                                   1183 04530000
         LA    @01,@AL00001                                        1183 04531000
         BALR  @14,@15                                             1183 04532000
*        RFY TASSO;                    /*REVERT                      */ 04533000
@RT01181 DS    0H                                                  1185 04534000
*        RFY DITABE;                   /*REVERT                      */ 04535000
*                                                                  1185 04536000
* CALL EXIT;  /*TERMINATE*/                                        1186 04537000
         BAL   @14,EXIT                                            1186 04538000
* END SETCI; /*END OF PROCEDURE*/                                  1187 04539000
@EL00008 DS    0H                                                  1187 04540000
@EF00008 DS    0H                                                  1187 04541000
@ER00008 BR    @14                                                 1187 04542000
@PB00008 DS    0H                                                  1188 04543000
*/********************************************************************/ 04544000
*/*                                                                  */ 04545000
*/* PROCEDURE - VERA                                                 */ 04546000
*/*                                                                  */ 04547000
*/* FUNCTION -                                                       */ 04548000
*/*     VERIFY ANY ALIASES FOR ALIENS.                               */ 04549000
*/*     VERIFY GDG ASSOCIATIONS.                                     */ 04550000
*/*                                                                  */ 04551000
*/* INPUT -                                                          */ 04552000
*/*    CI TABLE AND DI TABLE FOR THE PATH                            */ 04553000
*/*     RSGDGLN - LENGTH OF THE BASE NAME.                           */ 04554000
*/*     RSGDGNM - GDG BASE NAME.                                     */ 04555000
*/*                                                                  */ 04556000
*/* OUTPUT -                                                         */ 04557000
*/*     CITFAVER - SET ON IN USERCATALOG RECORD TO                   */ 04558000
*/*                INDICATE THAT THE ENTRY IS GOOD.                  */ 04559000
*/*     DITFAVER - SET ON IN THE GDG BASE ASSOCIATION IF VERIFIED    */ 04560000
*/*                                                                  */ 04561000
*/********************************************************************/ 04562000
*      GENERATE;                                                   1188 04563000
         DS    0F                                                       04564000
NAME0112 DC    CL8'VERA'                                                04565000
*VERA: PROCEDURE                                                   1189 04566000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1189 04567000
*                                                                  1189 04568000
         B     @PB00009                                            1189 04569000
VERA     DS    0H                                                  1190 04570000
*      GENERATE REFS(RS02RG08, REG6);                              1190 04571000
*                                                                  1190 04572000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          04573000
         LR    @15,@13  OLD SAVE AREA                                   04574000
         LA    @13,72(@13)  NEW SAVE AREA                               04575000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     04576000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        04577000
         MVC   0(4,@15),NAME0112  PROCNAME TO REGSAVE                   04578000
*        OLDERID2 = NEWERID2;                                      1191 04579000
         L     @07,GDTTR2(,REG5)                                   1191 04580000
         MVC   @TS00001(95),NEWERID2(@07)                          1191 04581000
         MVC   OLDERID2(95,@07),@TS00001                           1191 04582000
*        NEWID2 = 'RSVA';                                          1192 04583000
*                                                                  1192 04584000
         MVC   NEWID2(4,@07),@CC03828                              1192 04585000
*        /************************************************************/ 04586000
*        /*                                                          */ 04587000
*        /*  INDICATE THE NON-VSAM RECORD AS VERIFIED                */ 04588000
*        /*                                                          */ 04589000
*        /************************************************************/ 04590000
*                                                                  1193 04591000
*        PTCITF->CITFAVER = ON;                                    1193 04592000
*                                                                  1193 04593000
         L     @07,RSPTWKC(,REG6)                                  1193 04594000
         L     @07,PTCITF(,@07)                                    1193 04595000
         OI    CITFAVER(@07),B'01000000'                           1193 04596000
*        /************************************************************/ 04597000
*        /*                                                          */ 04598000
*        /*  VERIFY ANY ALIASES OF THE ALIEN                         */ 04599000
*        /*                                                          */ 04600000
*        /************************************************************/ 04601000
*                                                                  1194 04602000
*        CALL VERX;                                                1194 04603000
*                                                                  1194 04604000
         BAL   @14,VERX                                            1194 04605000
*        /************************************************************/ 04606000
*        /*                                                          */ 04607000
*        /*   VERIFY GDG ASSOCIATIONS                                */ 04608000
*        /*                                                          */ 04609000
*        /************************************************************/ 04610000
*                                                                  1195 04611000
*        IF RSPTWKF->PTCITF->CITTYPE = GDGID THEN                  1195 04612000
         L     @07,RSPTWKF(,REG6)                                  1195 04613000
         L     @07,PTCITF(,@07)                                    1195 04614000
         CLI   CITTYPE(@07),C'B'                                   1195 04615000
         BNE   @RF01195                                            1195 04616000
*  VERAB:                                                          1196 04617000
*          DO;                                                     1196 04618000
*                                                                  1196 04619000
VERAB    DS    0H                                                  1197 04620000
*        /************************************************************/ 04621000
*        /*                                                          */ 04622000
*        /*     ENSURE ASSOCIATION TO THE GDG BASE (A->B)            */ 04623000
*        /*                                                          */ 04624000
*        /************************************************************/ 04625000
*                                                                  1197 04626000
*            PTF1OK = OFF;             /*ASSUME GUILTY               */ 04627000
         L     @07,RSPTWKC(,REG6)                                  1197 04628000
         NI    PTF1OK(@07),B'11011111'                             1197 04629000
*            PTLOC = PTLOC && PTLOC;                               1198 04630000
         XC    PTLOC(20,@07),PTLOC(@07)                            1198 04631000
*            PTLBCITX = PTCITI;        /*SCAN THE ALIEN              */ 04632000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1199 04633000
*            PTLFBAS1 = ON;            /*SCAN FOR ASSOCIATION        */ 04634000
         OI    PTLFBAS1(@07),B'00100000'                           1200 04635000
*            PTLDITID = GDGID;         /*TO THE GDG BASE             */ 04636000
         MVI   PTLDITID(@07),C'B'                                  1201 04637000
*            CALL LOCDIT;                                          1202 04638000
         BAL   @14,LOCDIT                                          1202 04639000
*                                      /*FIND A->B                   */ 04640000
*            IF PTLCDIT ^= 0 THEN      /*ENSURE BASE SAME AS OURS    */ 04641000
         L     @07,RSPTWKC(,REG6)                                  1203 04642000
         L     @07,PTLCDIT(,@07)                                   1203 04643000
         LTR   @07,@07                                             1203 04644000
         BZ    @RF01203                                            1203 04645000
*              DO;                                                 1204 04646000
*                RSTENTAD = ADDR(RSGCITS);                         1205 04647000
         LA    @04,RSGCITS(,REG6)                                  1205 04648000
         ST    @04,RSTENTAD(,REG6)                                 1205 04649000
*                RSTENTIX = PTLCDIT->DITCITAB;                     1206 04650000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1206 04651000
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE    */ 04652000
*                CALL GETNEXTE;                                    1207 04653000
         L     @15,@CV03436                                        1207 04654000
         BALR  @14,@15                                             1207 04655000
*                IF RSTENTAD->CITCIN ^= RSPTWKF->PTCITF->CITCIN THEN    04656000
         L     @07,RSTENTAD(,REG6)                                 1208 04657000
         L     @04,RSPTWKF(,REG6)                                  1208 04658000
         L     @04,PTCITF(,@04)                                    1208 04659000
         CLC   CITCIN(3,@07),CITCIN(@04)                           1208 04660000
         BE    @RF01208                                            1208 04661000
*                  PTLCDIT = 0;        /*INDICATE BASE INVALID       */ 04662000
         L     @07,RSPTWKC(,REG6)                                  1209 04663000
         SLR   @04,@04                                             1209 04664000
         ST    @04,PTLCDIT(,@07)                                   1209 04665000
*              END;                                                1210 04666000
@RF01208 DS    0H                                                  1211 04667000
*            IF PTLCDIT = 0 THEN;      /*BASE INVALID                */ 04668000
*                                                                  1211 04669000
@RF01203 L     @07,RSPTWKC(,REG6)                                  1211 04670000
         L     @07,PTLCDIT(,@07)                                   1211 04671000
         LTR   @07,@07                                             1211 04672000
         BZ    @RT01211                                            1211 04673000
*        /************************************************************/ 04674000
*        /*                                                          */ 04675000
*        /*     ENSURE THE GDG DATA SET NAME IS CORRECT              */ 04676000
*        /*                                                          */ 04677000
*        /************************************************************/ 04678000
*                                                                  1213 04679000
*            ELSE                                                  1213 04680000
*  VERAGDGN:                                                       1213 04681000
*              DO;                                                 1213 04682000
VERAGDGN DS    0H                                                  1214 04683000
*                PTASSDIT(1) = PTLCDIT; /*SAVE A->B                  */ 04684000
         L     @07,RSPTWKC(,REG6)                                  1214 04685000
         L     @04,PTLCDIT(,@07)                                   1214 04686000
         ST    @04,PTASSDIT(,@07)                                  1214 04687000
*                                      /* FORM EXPECTED NAME         */ 04688000
*                RSGDGNM(RSGDGLN+1:RSGDGLN+2) = '.G';              1215 04689000
         LH    @15,RSGDGLN(,REG6)                                  1215 04690000
         ALR   @15,REG6                                            1215 04691000
         MVC   RSGDGNM(2,@15),@CC03834                             1215 04692000
*                RSGDGNM(RSGDGLN+3:RSGDGLN+6) = PTLCDIT->DITDGML;  1216 04693000
         LH    @15,RSGDGLN(,REG6)                                  1216 04694000
         ALR   @15,REG6                                            1216 04695000
         MVC   RSGDGNM+2(4,@15),DITDGML(@04)                       1216 04696000
*                RSGDGNM(RSGDGLN+7:RSGDGLN+9) = 'V00';             1217 04697000
         LH    @04,RSGDGLN(,REG6)                                  1217 04698000
         ALR   @04,REG6                                            1217 04699000
         MVC   RSGDGNM+6(3,@04),@CC03835                           1217 04700000
*                GRABCURR=RABARRAY(ADDR(PTASSOC->TASSEN(1))->TASSRAB);  04701000
         L     @04,RSGRABCU(,REG6)                                 1218 04702000
         L     @07,PTASSOC(,@07)                                   1218 04703000
         LA    @07,TASSEN(,@07)                                    1218 04704000
         LH    @07,TASSRAB(,@07)                                   1218 04705000
         SLA   @07,2                                               1218 04706000
         L     @07,RABARRAY-4(@07,@04)                             1218 04707000
         ST    @07,GRABCURR(,@04)                                  1218 04708000
*                                      /*DEFAULT TO ALIEN BUFFER     */ 04709000
*                DO PTINDX3 = 1 TO RSGDGLN + LENGTH(G0000V00)      1219 04710000
*                 WHILE (RSGDGNM(PTINDX3:PTINDX3) =                1219 04711000
*                       CNAME(PTINDX3:PTINDX3));                   1219 04712000
         LA    @07,1                                               1219 04713000
         B     @DE01219                                            1219 04714000
@DL01219 L     @07,RSPTWKC(,REG6)                                  1219 04715000
         LH    @07,PTINDX3(,@07)                                   1219 04716000
         L     @04,RSGRABCU(,REG6)                                 1219 04717000
         L     @04,GRABCURR(,@04)                                  1219 04718000
         ST    @07,@TF00001                                        1219 04719000
         ALR   @07,REG6                                            1219 04720000
         AL    @04,@TF00001                                        1219 04721000
         CLC   RSGDGNM-1(1,@07),CNAME+7(@04)                       1219 04722000
         BNE   @DC01219                                            1219 04723000
*                END;                                              1220 04724000
         L     @04,RSPTWKC(,REG6)                                  1220 04725000
         LA    @07,1                                               1220 04726000
         AH    @07,PTINDX3(,@04)                                   1220 04727000
@DE01219 L     @04,RSPTWKC(,REG6)                                  1220 04728000
         STH   @07,PTINDX3(,@04)                                   1220 04729000
         LA    @04,9                                               1220 04730000
         AH    @04,RSGDGLN(,REG6)                                  1220 04731000
         CR    @07,@04                                             1220 04732000
         BNH   @DL01219                                            1220 04733000
@DC01219 DS    0H                                                  1221 04734000
*                IF PTINDX3 ^= RSGDGLN + LENGTH(G0000V00) + 1 THEN;     04735000
         L     @07,RSPTWKC(,REG6)                                  1221 04736000
         LA    @04,10                                              1221 04737000
         AH    @04,RSGDGLN(,REG6)                                  1221 04738000
         CH    @04,PTINDX3(,@07)                                   1221 04739000
         BNE   @RT01221                                            1221 04740000
*                                      /*ERROR WRONG NAME            */ 04741000
*                                                                  1223 04742000
*        /************************************************************/ 04743000
*        /*                                                          */ 04744000
*        /*     ENSURE THE ASSOCIATION FROM THE GDG BASE TO THE      */ 04745000
*        /*     ALIEN IS GOOD. (B->A)                                */ 04746000
*        /*                                                          */ 04747000
*        /************************************************************/ 04748000
*                                                                  1223 04749000
*                ELSE                                              1223 04750000
*                  DO;                                             1223 04751000
*                    PTLOC = PTLOC && PTLOC;                       1224 04752000
         L     @07,RSPTWKC(,REG6)                                  1224 04753000
         XC    PTLOC(20,@07),PTLOC(@07)                            1224 04754000
*                    PTLBCITX = RSPTWKF->PTCITI; /*SCAN GDG BASE     */ 04755000
         L     @04,RSPTWKF(,REG6)                                  1225 04756000
         MVC   PTLBCITX(3,@07),PTCITI(@04)                         1225 04757000
*                    PTLFBAS1 = ON;    /*ASSOCIATION SCAN            */ 04758000
         OI    PTLFBAS1(@07),B'00100000'                           1226 04759000
*                    PTLDITID = NVID;  /*FIND B->A                   */ 04760000
         MVI   PTLDITID(@07),C'A'                                  1227 04761000
*                    PTF1ENDA = OFF;   /* LOOP CONTROL               */ 04762000
*                                                                  1228 04763000
         NI    PTF1ENDA(@07),B'11111110'                           1228 04764000
*                    DO WHILE(PTF1ENDA=OFF);                       1229 04765000
         B     @DE01229                                            1229 04766000
@DL01229 DS    0H                                                  1230 04767000
*                      CALL LOCDIT;                                1230 04768000
         BAL   @14,LOCDIT                                          1230 04769000
*                                      /*FIND NEXT ALIEN ASSN ON GDG */ 04770000
*                      IF PTLCDIT = 0 THEN /*NO B->A                 */ 04771000
*                                                                  1231 04772000
         L     @07,RSPTWKC(,REG6)                                  1231 04773000
         L     @07,PTLCDIT(,@07)                                   1231 04774000
         LTR   @07,@07                                             1231 04775000
         BNZ   @RF01231                                            1231 04776000
*                        DO;                                       1232 04777000
*                        /*CALL CKERR*/                            1233 04778000
*                          RSCKERR = RSCKERR && RSCKERR;           1233 04779000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1233 04780000
*                          RSCKERN = RSE100;                       1234 04781000
         MVC   RSCKERN(2,REG6),@CH00143                            1234 04782000
*                          RSCKTERM = 'TERM';                      1235 04783000
*                                                                  1235 04784000
         MVC   RSCKTERM(4,REG6),@CC03762                           1235 04785000
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  04786000
*                                                                    */ 04787000
*                        CALL CKERR;                               1236 04788000
         L     @15,@CV03449                                        1236 04789000
         BALR  @14,@15                                             1236 04790000
*                        END; /*NEVER HAPPEN     */                1237 04791000
*                                                                  1237 04792000
*                      RSTANCHR = ADDR(RSGCITS);                   1238 04793000
@RF01231 LA    @07,RSGCITS(,REG6)                                  1238 04794000
         ST    @07,RSTANCHR(,REG6)                                 1238 04795000
*                      RSTENTIX = PTLCDIT->DITCITAB; /*ALIEN CITAB   */ 04796000
         L     @07,RSPTWKC(,REG6)                                  1239 04797000
         L     @07,PTLCDIT(,@07)                                   1239 04798000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1239 04799000
*                      /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE 04800000
*                                                                    */ 04801000
*                      CALL GETNEXTE; /*GET NON-VSAM CITABE       */    04802000
         L     @15,@CV03436                                        1240 04803000
         BALR  @14,@15                                             1240 04804000
*                      IF RSTENTAD->CITCIN = PTCITF->CITCIN THEN   1241 04805000
         L     @07,RSTENTAD(,REG6)                                 1241 04806000
         L     @04,RSPTWKC(,REG6)                                  1241 04807000
         L     @01,PTCITF(,@04)                                    1241 04808000
         CLC   CITCIN(3,@07),CITCIN(@01)                           1241 04809000
         BNE   @RF01241                                            1241 04810000
*                        DO;           /*B->OUR A                    */ 04811000
*                          PTF1ENDA = ON; /*FOUND B->A               */ 04812000
*                                                                  1243 04813000
         OI    PTF1ENDA(@04),B'00000001'                           1243 04814000
*        /************************************************************/ 04815000
*        /*                                                          */ 04816000
*        /*     VERIFY GEN LEVEL - MUST BE THE SAME AS THE           */ 04817000
*        /*     ONE VERIFIED IN THE ALIEN ASSOCIATION TO THE BASE    */ 04818000
*        /*                                                          */ 04819000
*        /************************************************************/ 04820000
*                                                                  1244 04821000
*                          IF PTLCDIT->DITDGML = PTASSDIT(1)->DITDGML   04822000
*                           THEN                                   1244 04823000
         L     @07,PTLCDIT(,@04)                                   1244 04824000
         L     @15,PTASSDIT(,@04)                                  1244 04825000
         CLC   DITDGML(4,@07),DITDGML(@15)                         1244 04826000
         BNE   @RF01244                                            1244 04827000
*                            DO;                                   1245 04828000
*                              PTLCDIT->DITFAVER=ON; /*B->A OK       */ 04829000
         OI    DITFAVER(@07),B'01000000'                           1246 04830000
*                              PTASSDIT(1)->DITFAVER=ON; /*A->B OK   */ 04831000
         OI    DITFAVER(@15),B'01000000'                           1247 04832000
*                              PTF1OK = ON; /*GDG OK                 */ 04833000
*                              PTF1ENDA = ON; /*GDG OK               */ 04834000
         OI    PTF1OK(@04),B'00100001'                             1249 04835000
*                            END;                                  1250 04836000
*                        END;                                      1251 04837000
@RF01244 DS    0H                                                  1252 04838000
*                    END;                                          1252 04839000
@RF01241 DS    0H                                                  1252 04840000
@DE01229 L     @07,RSPTWKC(,REG6)                                  1252 04841000
         TM    PTF1ENDA(@07),B'00000001'                           1252 04842000
         BZ    @DL01229                                            1252 04843000
*                  END;                                            1253 04844000
*              END VERAGDGN;                                       1254 04845000
*                                                                  1254 04846000
@RT01221 DS    0H                                                  1255 04847000
*        /************************************************************/ 04848000
*        /*                                                          */ 04849000
*        /*     IF GDG DATA SET FAILED ASSOCIATION CHECK, ISSUE      */ 04850000
*        /*     MESSAGE IDC21032I.                                   */ 04851000
*        /*                                                          */ 04852000
*        /************************************************************/ 04853000
*                                                                  1255 04854000
*            IF PTF1OK = OFF THEN      /*ERROR FOR THIS GDG          */ 04855000
*                                                                  1255 04856000
@RT01211 L     @07,RSPTWKC(,REG6)                                  1255 04857000
         TM    PTF1OK(@07),B'00100000'                             1255 04858000
         BNZ   @RF01255                                            1255 04859000
*              DO;                                                 1256 04860000
*              /*CALL CKERR*/                                      1257 04861000
*                RSCKERR = RSCKERR && RSCKERR;                     1257 04862000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1257 04863000
*                RSCKERN = RSE041;                                 1258 04864000
         MVC   RSCKERN(2,REG6),@CH00969                            1258 04865000
*                RSCKTERM = 'RETU';                                1259 04866000
         MVC   RSCKTERM(4,REG6),@CC03787                           1259 04867000
*                RSCKMVAR(1) = ADDR(PTBASE->CNAME);                1260 04868000
         L     @07,PTBASE(,@07)                                    1260 04869000
         LA    @07,CNAME(,@07)                                     1260 04870000
         ST    @07,RSCKMVAR(,REG6)                                 1260 04871000
*                RSCKMVAR(2) = ADDR(NVID);                         1261 04872000
         LA    @07,@CC00808                                        1261 04873000
         ST    @07,RSCKMVAR+4(,REG6)                               1261 04874000
*                RSCKMVAR(3) = ADDR(GDGID);                        1262 04875000
*                                                                  1262 04876000
         LA    @07,@CC00810                                        1262 04877000
         ST    @07,RSCKMVAR+8(,REG6)                               1262 04878000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */ 04879000
*              CALL CKERR;                                         1263 04880000
         L     @15,@CV03449                                        1263 04881000
         BALR  @14,@15                                             1263 04882000
*              END;                                                1264 04883000
*          END VERAB;                                              1265 04884000
*                                                                  1265 04885000
*        /************************************************************/ 04886000
*        /*                                                          */ 04887000
*        /*   FOR NON-GDG, VERIFY THAT NO GDG ASSOCIATION EXISTS     */ 04888000
*        /*                                                          */ 04889000
*        /************************************************************/ 04890000
*                                                                  1266 04891000
*        ELSE                                                      1266 04892000
*  VERANOB:                                                        1266 04893000
*          DO;                                                     1266 04894000
         B     @RC01195                                            1266 04895000
@RF01195 DS    0H                                                  1266 04896000
VERANOB  DS    0H                                                  1267 04897000
*            PTLOC = PTLOC && PTLOC;                               1267 04898000
         L     @07,RSPTWKC(,REG6)                                  1267 04899000
         XC    PTLOC(20,@07),PTLOC(@07)                            1267 04900000
*            PTLBCITX = PTCITI;        /*SCAN NON-VSAM               */ 04901000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1268 04902000
*            PTLFBAS1 = ON;            /*FOR AN ASSOCIATION          */ 04903000
         OI    PTLFBAS1(@07),B'00100000'                           1269 04904000
*            PTLDITID = GDGID;         /*TO A GDG BASE RECORD        */ 04905000
         MVI   PTLDITID(@07),C'B'                                  1270 04906000
*            CALL LOCDIT;                                          1271 04907000
         BAL   @14,LOCDIT                                          1271 04908000
*            IF PTLCDIT ^= 0 THEN      /*ERROR IF GDG ASSN           */ 04909000
*                                                                  1272 04910000
         L     @07,RSPTWKC(,REG6)                                  1272 04911000
         L     @04,PTLCDIT(,@07)                                   1272 04912000
         LTR   @04,@04                                             1272 04913000
         BZ    @RF01272                                            1272 04914000
*              DO;                                                 1273 04915000
*              /*CALL CKERR*/                                      1274 04916000
*                RSCKERR = RSCKERR && RSCKERR;                     1274 04917000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1274 04918000
*                RSCKERN = RSE041;                                 1275 04919000
         MVC   RSCKERN(2,REG6),@CH00969                            1275 04920000
*                RSCKTERM = 'RETU';                                1276 04921000
         MVC   RSCKTERM(4,REG6),@CC03787                           1276 04922000
*                RSCKMVAR(1) = ADDR(PTBASE->CNAME);                1277 04923000
         L     @07,PTBASE(,@07)                                    1277 04924000
         LA    @07,CNAME(,@07)                                     1277 04925000
         ST    @07,RSCKMVAR(,REG6)                                 1277 04926000
*                RSCKMVAR(2) = ADDR(NVID);                         1278 04927000
         LA    @07,@CC00808                                        1278 04928000
         ST    @07,RSCKMVAR+4(,REG6)                               1278 04929000
*                RSCKMVAR(3) = ADDR(GDGID);                        1279 04930000
*                                                                  1279 04931000
         LA    @07,@CC00810                                        1279 04932000
         ST    @07,RSCKMVAR+8(,REG6)                               1279 04933000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */ 04934000
*              CALL CKERR;                                         1280 04935000
         L     @15,@CV03449                                        1280 04936000
         BALR  @14,@15                                             1280 04937000
*              END;                                                1281 04938000
*          END;                                                    1282 04939000
*                                                                  1282 04940000
@RF01272 DS    0H                                                  1283 04941000
* CALL EXIT;  /*TERMINATE*/                                        1283 04942000
@RC01195 BAL   @14,EXIT                                            1283 04943000
* END VERA; /*END OF PROCEDURE*/                                   1284 04944000
@EL00009 DS    0H                                                  1284 04945000
@EF00009 DS    0H                                                  1284 04946000
@ER00009 BR    @14                                                 1284 04947000
@PB00009 DS    0H                                                  1285 04948000
*/********************************************************************/ 04949000
*/*                                                                  */ 04950000
*/* PROCEDURE - VERC                                                 */ 04951000
*/*                                                                  */ 04952000
*/* FUNCTION -                                                       */ 04953000
*/*    VERIFY CLUSTER BASE ASSOCIATIONS.                             */ 04954000
*/*    FOR AN ESDS OR RRDS                                           */ 04955000
*/*      CLUSTER<->DATA                                              */ 04956000
*/*    FOR A KSDS                                                    */ 04957000
*/*      CLUSTER<->DATA AND CLUSTER<->INDEX                          */ 04958000
*/*                                                                  */ 04959000
*/* INPUT -                                                          */ 04960000
*/*    CI TABLE AND DI TABLE FOR THE CLUSTER                         */ 04961000
*/*                                                                  */ 04962000
*/* OUTPUT -                                                         */ 04963000
*/*    CITFAVER - SET ON IN CLUSTER, DATA, AND INDEX FOR THE RECORD  */ 04964000
*/*               IF ASSOCIATION CHECKED                             */ 04965000
*/*    DITFAVER - SET ON IN CLUSTER, DATA, AND INDEX FOR THE ASSN    */ 04966000
*/*               IF ASSOCIATION CHECKED                             */ 04967000
*/*    PTF2KSDS - SET ON IF CLUSTER IS KSDS                          */ 04968000
*/*    GRABRAB5 - THE CLUSTER RECORD IS COPIED TO RAB5 FOR ALL       */ 04969000
*/*               LOWER LEVEL ASSOCIATION CHECKING                   */ 04970000
*/*                                                                  */ 04971000
*/* MESSAGES -                                                       */ 04972000
*/*    IDC11023I - INVALID ASSOCIATION.                              */ 04973000
*/*                                                                  */ 04974000
*/********************************************************************/ 04975000
*      GENERATE;                                                   1285 04976000
         DS    0F                                                       04977000
NAME0126 DC    CL8'VERC'                                                04978000
*VERC: PROCEDURE                                                   1286 04979000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1286 04980000
*                                                                  1286 04981000
         B     @PB00010                                            1286 04982000
VERC     DS    0H                                                  1287 04983000
*      GENERATE REFS(RS02RG08, REG6);                              1287 04984000
*                                                                  1287 04985000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          04986000
         LR    @15,@13  OLD SAVE AREA                                   04987000
         LA    @13,72(@13)  NEW SAVE AREA                               04988000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     04989000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        04990000
         MVC   0(4,@15),NAME0126  PROCNAME TO REGSAVE                   04991000
*        OLDERID2 = NEWERID2;                                      1288 04992000
         L     @07,GDTTR2(,REG5)                                   1288 04993000
         MVC   @TS00001(95),NEWERID2(@07)                          1288 04994000
         MVC   OLDERID2(95,@07),@TS00001                           1288 04995000
*        NEWID2 = 'RSVC';                                          1289 04996000
*                                                                  1289 04997000
         MVC   NEWID2(4,@07),@CC03842                              1289 04998000
*        RFY DITABE BASED(PTLCDIT);                                1290 04999000
*                                                                  1290 05000000
*        /************************************************************/ 05001000
*        /*                                                          */ 05002000
*        /* SAVE CLUSTER RECORD IN BUFFER 5 TO BE REFERENCED         */ 05003000
*        /* FOR MESSAGES                                             */ 05004000
*        /*                                                          */ 05005000
*        /************************************************************/ 05006000
*                                                                  1291 05007000
*        RSGRABCU = ADDR(GRABSWF);                                 1291 05008000
         L     @07,RSIOTBL(,REG6)                                  1291 05009000
         ST    @07,RSGRABCU(,REG6)                                 1291 05010000
*        RSWFBP1 = GRABRAB5;                                       1292 05011000
         L     @04,GRABRAB5(,@07)                                  1292 05012000
         ST    @04,RSWFBP1(,REG6)                                  1292 05013000
*        RSWFBP2 = GRABRAB1;                                       1293 05014000
         L     @07,GRABRAB1(,@07)                                  1293 05015000
         ST    @07,RSWFBP2(,REG6)                                  1293 05016000
*        WFBUF1(1:256) = WFBUF2(1:256);                            1294 05017000
         MVC   WFBUF1(256,@04),WFBUF2(@07)                         1294 05018000
*        WFBUF1(257:CELEN) = WFBUF2(257:CELEN);                    1295 05019000
*                                                                  1295 05020000
         MVC   WFBUF1+256(249,@04),WFBUF2+256(@07)                 1295 05021000
*        /************************************************************/ 05022000
*        /*                                                          */ 05023000
*        /* CLUSTER<->DATA                                           */ 05024000
*        /*     ENSURE TWO WAY ASSOCIATION BETWEEN CLUSTER AND DATA  */ 05025000
*        /*                                                          */ 05026000
*        /************************************************************/ 05027000
*                                                                  1296 05028000
*        PTASSOE1 = PTASSOE1 && PTASSOE1; /*CLEAR ERROR ASSN         */ 05029000
         L     @07,RSPTWKC(,REG6)                                  1296 05030000
         XC    PTASSOE1(40,@07),PTASSOE1(@07)                      1296 05031000
*        PTF1OK = ON;                  /*INNOCENT UNTIL PROVEN GUILTY*/ 05032000
*                                                                  1297 05033000
         OI    PTF1OK(@07),B'00100000'                             1297 05034000
*        /************************************************************/ 05035000
*        /*                                                          */ 05036000
*        /*     GET FIRST ASSOCIATION FROM CLUSTER                   */ 05037000
*        /*                                                          */ 05038000
*        /************************************************************/ 05039000
*                                                                  1298 05040000
*        PTLOC = PTLOC && PTLOC;                                   1298 05041000
         XC    PTLOC(20,@07),PTLOC(@07)                            1298 05042000
*        PTLBCITX = PTCITI;            /*CLUSTER INDEX               */ 05043000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1299 05044000
*        PTLFBAS1 = ON;                /*ASSOCIATION ONLY SCAN       */ 05045000
         OI    PTLFBAS1(@07),B'00100000'                           1300 05046000
*        PTLSN = 1;                    /*1ST ASSOCIATION             */ 05047000
         MVC   PTLSN(2,@07),@CH00212                               1301 05048000
*        CALL LOCDIT;                                              1302 05049000
*                                                                  1302 05050000
         BAL   @14,LOCDIT                                          1302 05051000
*        /************************************************************/ 05052000
*        /*                                                          */ 05053000
*        /*     IF NO DATA ASSOCIATION, ISSUE MESSAGE IDC11023I      */ 05054000
*        /*                                                          */ 05055000
*        /************************************************************/ 05056000
*                                                                  1303 05057000
*        IF PTLCDIT = 0 THEN                                       1303 05058000
         L     @07,RSPTWKC(,REG6)                                  1303 05059000
         L     @04,PTLCDIT(,@07)                                   1303 05060000
         LTR   @04,@04                                             1303 05061000
         BNZ   @RF01303                                            1303 05062000
*          DO;                                                     1304 05063000
*            PTF1OK = OFF;             /*BAD ASSOCIATION             */ 05064000
*                                                                  1305 05065000
         NI    PTF1OK(@07),B'11011111'                             1305 05066000
*            DO;                                                   1306 05067000
*            /*CALL CKERR*/                                        1307 05068000
*              RSCKERR = RSCKERR && RSCKERR;                       1307 05069000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1307 05070000
*              RSCKERN = RSE041;                                   1308 05071000
         MVC   RSCKERN(2,REG6),@CH00969                            1308 05072000
*              RSCKTERM = 'RETU';                                  1309 05073000
         MVC   RSCKTERM(4,REG6),@CC03787                           1309 05074000
*              RSCKMVAR(1) = ADDR(ADDR(GRABRAB5->RABBUF)->CNAME);  1310 05075000
         L     @07,RSGRABCU(,REG6)                                 1310 05076000
         L     @07,GRABRAB5(,@07)                                  1310 05077000
         LA    @07,CNAME+8(,@07)                                   1310 05078000
         ST    @07,RSCKMVAR(,REG6)                                 1310 05079000
*              RSCKMVAR(2) = ADDR(CLID);                           1311 05080000
         LA    @07,@CC00800                                        1311 05081000
         ST    @07,RSCKMVAR+4(,REG6)                               1311 05082000
*              RSCKMVAR(3) = ADDR(DATAID);                         1312 05083000
*                                                                  1312 05084000
         LA    @07,@CC00802                                        1312 05085000
         ST    @07,RSCKMVAR+8(,REG6)                               1312 05086000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 05087000
*            CALL CKERR;                                           1313 05088000
         L     @15,@CV03449                                        1313 05089000
         BALR  @14,@15                                             1313 05090000
*            END;                                                  1314 05091000
*          END;                                                    1315 05092000
*                                                                  1315 05093000
*        /************************************************************/ 05094000
*        /*                                                          */ 05095000
*        /*     GET DATA RECORD ENTRY                                */ 05096000
*        /*                                                          */ 05097000
*        /************************************************************/ 05098000
*                                                                  1316 05099000
*        ELSE                                                      1316 05100000
*  VERCDATA:                                                       1316 05101000
*          DO;                                                     1316 05102000
         B     @RC01303                                            1316 05103000
@RF01303 DS    0H                                                  1316 05104000
VERCDATA DS    0H                                                  1317 05105000
*            RSTANCHR = ADDR(RSGCITS);                             1317 05106000
         LA    @07,RSGCITS(,REG6)                                  1317 05107000
         ST    @07,RSTANCHR(,REG6)                                 1317 05108000
*            RSTENTIX = DITCITAB;      /*DATA RECORD                 */ 05109000
         L     @07,RSPTWKC(,REG6)                                  1318 05110000
         L     @07,PTLCDIT(,@07)                                   1318 05111000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1318 05112000
*            /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE        */ 05113000
*            CALL GETNEXTE;                                        1319 05114000
         L     @15,@CV03436                                        1319 05115000
         BALR  @14,@15                                             1319 05116000
*            PTCITCUR = RSTENTAD;                                  1320 05117000
*                                                                  1320 05118000
         L     @07,RSPTWKC(,REG6)                                  1320 05119000
         L     @04,RSTENTAD(,REG6)                                 1320 05120000
         ST    @04,PTCITCUR(,@07)                                  1320 05121000
*        /************************************************************/ 05122000
*        /*                                                          */ 05123000
*        /*     IF NOT DATA RECORD, ISSUE MESSAGE IDC11023I          */ 05124000
*        /*                                                          */ 05125000
*        /************************************************************/ 05126000
*                                                                  1321 05127000
*            IF CITTYPE ^= DATAID THEN                             1321 05128000
         CLI   CITTYPE(@04),C'D'                                   1321 05129000
         BE    @RF01321                                            1321 05130000
*              DO;                                                 1322 05131000
*                PTF1OK = OFF;         /*BAD ASSOCIATION             */ 05132000
*                                                                  1323 05133000
         NI    PTF1OK(@07),B'11011111'                             1323 05134000
*                DO;                                               1324 05135000
*                /*CALL CKERR*/                                    1325 05136000
*                  RSCKERR = RSCKERR && RSCKERR;                   1325 05137000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1325 05138000
*                  RSCKERN = RSE041;                               1326 05139000
         MVC   RSCKERN(2,REG6),@CH00969                            1326 05140000
*                  RSCKTERM = 'RETU';                              1327 05141000
         MVC   RSCKTERM(4,REG6),@CC03787                           1327 05142000
*                  RSCKMVAR(1) = ADDR(ADDR(GRABRAB5->RABBUF)->CNAME);   05143000
         L     @07,RSGRABCU(,REG6)                                 1328 05144000
         L     @07,GRABRAB5(,@07)                                  1328 05145000
         LA    @07,CNAME+8(,@07)                                   1328 05146000
         ST    @07,RSCKMVAR(,REG6)                                 1328 05147000
*                  RSCKMVAR(2) = ADDR(CLID);                       1329 05148000
         LA    @07,@CC00800                                        1329 05149000
         ST    @07,RSCKMVAR+4(,REG6)                               1329 05150000
*                  RSCKMVAR(3) = ADDR(DATAID);                     1330 05151000
*                                                                  1330 05152000
         LA    @07,@CC00802                                        1330 05153000
         ST    @07,RSCKMVAR+8(,REG6)                               1330 05154000
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */ 05155000
*                CALL CKERR;                                       1331 05156000
         L     @15,@CV03449                                        1331 05157000
         BALR  @14,@15                                             1331 05158000
*                END;                                              1332 05159000
*              END;                                                1333 05160000
*                                                                  1333 05161000
*        /************************************************************/ 05162000
*        /*                                                          */ 05163000
*        /*     IF DATA, ENSURE VALID RECORD                         */ 05164000
*        /*                                                          */ 05165000
*        /************************************************************/ 05166000
*                                                                  1334 05167000
*            ELSE                                                  1334 05168000
*              DO;                                                 1334 05169000
         B     @RC01321                                            1334 05170000
@RF01321 DS    0H                                                  1335 05171000
*                PTASSCIT(1) = PTCITCUR; /*SAVE DATA CI ENTRY        */ 05172000
         L     @07,RSPTWKC(,REG6)                                  1335 05173000
         L     @04,PTCITCUR(,@07)                                  1335 05174000
         ST    @04,PTASSCIT(,@07)                                  1335 05175000
*                IF CITFAINV = ON THEN                             1336 05176000
         TM    CITFAINV(@04),B'00000010'                           1336 05177000
         BNO   @RF01336                                            1336 05178000
*                  PTF1OK = OFF;                                   1337 05179000
*                                                                  1337 05180000
         NI    PTF1OK(@07),B'11011111'                             1337 05181000
*        /************************************************************/ 05182000
*        /*                                                          */ 05183000
*        /*     CLUSTER->DATA, MARK ASSOCIATION CHECKED              */ 05184000
*        /*                                                          */ 05185000
*        /************************************************************/ 05186000
*                                                                  1338 05187000
*                ELSE                                              1338 05188000
*                  DO;                                             1338 05189000
         B     @RC01336                                            1338 05190000
@RF01336 DS    0H                                                  1339 05191000
*                    DITFAVER = ON;                                1339 05192000
*                                                                  1339 05193000
         L     @07,RSPTWKC(,REG6)                                  1339 05194000
         L     @04,PTLCDIT(,@07)                                   1339 05195000
         OI    DITFAVER(@04),B'01000000'                           1339 05196000
*        /************************************************************/ 05197000
*        /*                                                          */ 05198000
*        /*     GET FIRST ASSOCIATION FROM DATA                      */ 05199000
*        /*                                                          */ 05200000
*        /************************************************************/ 05201000
*                                                                  1340 05202000
*                    PTCITWK = DITCITAB; /*SAVE INDEX DATA CIT       */ 05203000
         L     @04,DITCITAB-1(,@04)                                1340 05204000
         LA    @04,0(,@04)                                         1340 05205000
         ST    @04,PTCITWK(,@07)                                   1340 05206000
*                    PTLOC = PTLOC && PTLOC;                       1341 05207000
         XC    PTLOC(20,@07),PTLOC(@07)                            1341 05208000
*                    PTLBCITX = PTCITWK; /*DATA RECORD SCAN          */ 05209000
         STCM  @04,7,PTLBCITX(@07)                                 1342 05210000
*                    PTLFBAS1 = ON;    /*ASSOCIATION ONLY SCAN       */ 05211000
         OI    PTLFBAS1(@07),B'00100000'                           1343 05212000
*                    PTLSN = 1;        /*1ST ASSOCIATION             */ 05213000
         MVC   PTLSN(2,@07),@CH00212                               1344 05214000
*                    CALL LOCDIT;                                  1345 05215000
*                                                                  1345 05216000
         BAL   @14,LOCDIT                                          1345 05217000
*        /************************************************************/ 05218000
*        /*                                                          */ 05219000
*        /*     IF NO CLUSTER ASSOCIATION, MARK ERROR                */ 05220000
*        /*                                                          */ 05221000
*        /************************************************************/ 05222000
*                                                                  1346 05223000
*                    IF PTLCDIT = 0 THEN                           1346 05224000
         L     @07,RSPTWKC(,REG6)                                  1346 05225000
         L     @04,PTLCDIT(,@07)                                   1346 05226000
         LTR   @04,@04                                             1346 05227000
         BNZ   @RF01346                                            1346 05228000
*                      PTF1OK = OFF;                               1347 05229000
*                                                                  1347 05230000
         NI    PTF1OK(@07),B'11011111'                             1347 05231000
*        /************************************************************/ 05232000
*        /*                                                          */ 05233000
*        /*     INDEX->CLUSTER, MARK ASSOCIATION CHECKED             */ 05234000
*        /*                                                          */ 05235000
*        /************************************************************/ 05236000
*                                                                  1348 05237000
*                    ELSE                                          1348 05238000
*                      IF DITCITAB = PTCITI THEN                   1348 05239000
         B     @RC01346                                            1348 05240000
@RF01346 L     @07,RSPTWKC(,REG6)                                  1348 05241000
         L     @04,PTLCDIT(,@07)                                   1348 05242000
         CLC   DITCITAB(3,@04),PTCITI(@07)                         1348 05243000
         BNE   @RF01348                                            1348 05244000
*                        DO;                                       1349 05245000
*                          DITFAVER = ON;                          1350 05246000
         OI    DITFAVER(@04),B'01000000'                           1350 05247000
*                          CITFAVER = ON; /*DATA VERIFIED            */ 05248000
         L     @07,PTCITCUR(,@07)                                  1351 05249000
         OI    CITFAVER(@07),B'01000000'                           1351 05250000
*                        END;                                      1352 05251000
*                      ELSE                                        1353 05252000
*                        PTF1OK = OFF; /*DATA ^->CLUSTER             */ 05253000
         B     @RC01348                                            1353 05254000
@RF01348 L     @07,RSPTWKC(,REG6)                                  1353 05255000
         NI    PTF1OK(@07),B'11011111'                             1353 05256000
*                  END;                                            1354 05257000
@RC01348 DS    0H                                                  1354 05258000
@RC01346 DS    0H                                                  1355 05259000
*              END;                                                1355 05260000
@RC01336 DS    0H                                                  1356 05261000
*          END VERCDATA;                                           1356 05262000
*                                                                  1356 05263000
@RC01321 DS    0H                                                  1357 05264000
*        /************************************************************/ 05265000
*        /*                                                          */ 05266000
*        /* CLUSTER<->INDEX                                          */ 05267000
*        /*     IF CLUSTER<->DATA, CHECK FOR CLUSTER<->INDEX         */ 05268000
*        /*                                                          */ 05269000
*        /************************************************************/ 05270000
*                                                                  1357 05271000
*        IF PTF1OK = ON THEN                                       1357 05272000
@RC01303 L     @07,RSPTWKC(,REG6)                                  1357 05273000
         TM    PTF1OK(@07),B'00100000'                             1357 05274000
         BNO   @RF01357                                            1357 05275000
*  VERCINDX:                                                       1358 05276000
*          DO;                                                     1358 05277000
*                                                                  1358 05278000
VERCINDX DS    0H                                                  1359 05279000
*        /************************************************************/ 05280000
*        /*                                                          */ 05281000
*        /*     GET SECOND ASSOCIATION FROM CLUSTER                  */ 05282000
*        /*                                                          */ 05283000
*        /************************************************************/ 05284000
*                                                                  1359 05285000
*            PTASSCIT(1) = 0;          /*RESET ASSN FOUND FOR ERROR  */ 05286000
         L     @07,RSPTWKC(,REG6)                                  1359 05287000
         SLR   @04,@04                                             1359 05288000
         ST    @04,PTASSCIT(,@07)                                  1359 05289000
*            PTLOC = PTLOC && PTLOC;                               1360 05290000
         XC    PTLOC(20,@07),PTLOC(@07)                            1360 05291000
*            PTLBCITX = PTCITI;        /*CLUSTER INDEX               */ 05292000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1361 05293000
*            PTLFBAS1 = ON;            /*ASSOCIATION ONLY SCAN       */ 05294000
         OI    PTLFBAS1(@07),B'00100000'                           1362 05295000
*            PTLSN = 2;                /*SECOND ASSOCIATION ONLY     */ 05296000
         MVC   PTLSN(2,@07),@CH00149                               1363 05297000
*            CALL LOCDIT;                                          1364 05298000
         BAL   @14,LOCDIT                                          1364 05299000
*                                      /* GET 2ND ASSOCIATION        */ 05300000
*                                                                  1365 05301000
*        /************************************************************/ 05302000
*        /*                                                          */ 05303000
*        /*     IF NO ASSOCIATION, MUST BE ESDS OR RRDS              */ 05304000
*        /*                                                          */ 05305000
*        /************************************************************/ 05306000
*                                                                  1365 05307000
*            IF PTLCDIT = 0 THEN;                                  1365 05308000
*                                                                  1365 05309000
         L     @07,RSPTWKC(,REG6)                                  1365 05310000
         L     @07,PTLCDIT(,@07)                                   1365 05311000
         LTR   @07,@07                                             1365 05312000
         BZ    @RT01365                                            1365 05313000
*        /************************************************************/ 05314000
*        /*                                                          */ 05315000
*        /*     GET ASSOCIATION RECORD ENTRY                         */ 05316000
*        /*                                                          */ 05317000
*        /************************************************************/ 05318000
*                                                                  1367 05319000
*            ELSE                                                  1367 05320000
*              DO;                                                 1367 05321000
*                RSTANCHR = ADDR(RSGCITS);                         1368 05322000
         LA    @07,RSGCITS(,REG6)                                  1368 05323000
         ST    @07,RSTANCHR(,REG6)                                 1368 05324000
*                RSTENTIX = DITCITAB;                              1369 05325000
         L     @07,RSPTWKC(,REG6)                                  1369 05326000
         L     @07,PTLCDIT(,@07)                                   1369 05327000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1369 05328000
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE    */ 05329000
*                CALL GETNEXTE;                                    1370 05330000
         L     @15,@CV03436                                        1370 05331000
         BALR  @14,@15                                             1370 05332000
*                PTCITCUR = RSTENTAD;                              1371 05333000
*                                                                  1371 05334000
         L     @07,RSPTWKC(,REG6)                                  1371 05335000
         L     @04,RSTENTAD(,REG6)                                 1371 05336000
         ST    @04,PTCITCUR(,@07)                                  1371 05337000
*        /************************************************************/ 05338000
*        /*                                                          */ 05339000
*        /*     IF NOT INDEX, MUST BE ESDS OR RRDS                   */ 05340000
*        /*                                                          */ 05341000
*        /************************************************************/ 05342000
*                                                                  1372 05343000
*                IF CITTYPE ^= INDEXID THEN;                       1372 05344000
*                                                                  1372 05345000
         CLI   CITTYPE(@04),C'I'                                   1372 05346000
         BNE   @RT01372                                            1372 05347000
*        /************************************************************/ 05348000
*        /*                                                          */ 05349000
*        /*     KSDS - CHECK FOR VALID RECORD                        */ 05350000
*        /*                                                          */ 05351000
*        /************************************************************/ 05352000
*                                                                  1374 05353000
*                ELSE                                              1374 05354000
*                  DO;                                             1374 05355000
*                    PTASSCIT(1) = PTCITCUR; /*SAVE INDEX CI ENTRY   */ 05356000
         L     @07,RSPTWKC(,REG6)                                  1375 05357000
         L     @04,PTCITCUR(,@07)                                  1375 05358000
         ST    @04,PTASSCIT(,@07)                                  1375 05359000
*                    IF CITFAINV = ON THEN                         1376 05360000
         TM    CITFAINV(@04),B'00000010'                           1376 05361000
         BNO   @RF01376                                            1376 05362000
*                      PTF1OK = OFF;                               1377 05363000
*                                                                  1377 05364000
         NI    PTF1OK(@07),B'11011111'                             1377 05365000
*        /************************************************************/ 05366000
*        /*                                                          */ 05367000
*        /*     CLUSTER->INDEX, MARK ASSOCIATION CHECKED             */ 05368000
*        /*                                                          */ 05369000
*        /************************************************************/ 05370000
*                                                                  1378 05371000
*                    ELSE                                          1378 05372000
*                      DO;                                         1378 05373000
         B     @RC01376                                            1378 05374000
@RF01376 DS    0H                                                  1379 05375000
*                        DITFAVER = ON;                            1379 05376000
         L     @07,RSPTWKC(,REG6)                                  1379 05377000
         L     @04,PTLCDIT(,@07)                                   1379 05378000
         OI    DITFAVER(@04),B'01000000'                           1379 05379000
*                        PTF2KSDS = ON; /*NOTE THIS IS KSDS          */ 05380000
*                                                                  1380 05381000
         OI    PTF2KSDS(@07),B'10000000'                           1380 05382000
*        /************************************************************/ 05383000
*        /*                                                          */ 05384000
*        /*     GET FIRST ASSOCIATION FROM INDEX                     */ 05385000
*        /*                                                          */ 05386000
*        /************************************************************/ 05387000
*                                                                  1381 05388000
*                        PTCITWK = DITCITAB; /*SAVE INDEX INDEX CIT  */ 05389000
         L     @04,DITCITAB-1(,@04)                                1381 05390000
         LA    @04,0(,@04)                                         1381 05391000
         ST    @04,PTCITWK(,@07)                                   1381 05392000
*                        PTLOC = PTLOC && PTLOC;                   1382 05393000
         XC    PTLOC(20,@07),PTLOC(@07)                            1382 05394000
*                        PTLBCITX = PTCITWK; /*INDEX AS BASE FOR SCAN*/ 05395000
         STCM  @04,7,PTLBCITX(@07)                                 1383 05396000
*                        PTLFBAS1 = ON; /*ASSOCIATION ONLY           */ 05397000
         OI    PTLFBAS1(@07),B'00100000'                           1384 05398000
*                        PTLSN = 1;    /*1ST ASSOCIATION             */ 05399000
         MVC   PTLSN(2,@07),@CH00212                               1385 05400000
*                        CALL LOCDIT;                              1386 05401000
*                                                                  1386 05402000
         BAL   @14,LOCDIT                                          1386 05403000
*        /************************************************************/ 05404000
*        /*                                                          */ 05405000
*        /*     IF NO CLUSTER ASSOCIATION, MARK ERROR                */ 05406000
*        /*                                                          */ 05407000
*        /************************************************************/ 05408000
*                                                                  1387 05409000
*                        IF PTLCDIT = 0 THEN                       1387 05410000
         L     @07,RSPTWKC(,REG6)                                  1387 05411000
         L     @04,PTLCDIT(,@07)                                   1387 05412000
         LTR   @04,@04                                             1387 05413000
         BNZ   @RF01387                                            1387 05414000
*                          PTF1OK = OFF;                           1388 05415000
*                                                                  1388 05416000
         NI    PTF1OK(@07),B'11011111'                             1388 05417000
*        /************************************************************/ 05418000
*        /*                                                          */ 05419000
*        /*     INDEX->CLUSTER, MARK ASSOCIATION CHECKED             */ 05420000
*        /*                                                          */ 05421000
*        /************************************************************/ 05422000
*                                                                  1389 05423000
*                        ELSE                                      1389 05424000
*                          IF DITCITAB = PTCITI THEN               1389 05425000
         B     @RC01387                                            1389 05426000
@RF01387 L     @07,RSPTWKC(,REG6)                                  1389 05427000
         L     @04,PTLCDIT(,@07)                                   1389 05428000
         CLC   DITCITAB(3,@04),PTCITI(@07)                         1389 05429000
         BNE   @RF01389                                            1389 05430000
*                            DO;                                   1390 05431000
*                              DITFAVER = ON;                      1391 05432000
         OI    DITFAVER(@04),B'01000000'                           1391 05433000
*                              CITFAVER = ON; /*MARK VERIFIED        */ 05434000
         L     @07,PTCITCUR(,@07)                                  1392 05435000
         OI    CITFAVER(@07),B'01000000'                           1392 05436000
*                            END;                                  1393 05437000
*                          ELSE                                    1394 05438000
*                            PTF1OK = OFF; /*INDEX^->CLUSTER         */ 05439000
         B     @RC01389                                            1394 05440000
@RF01389 L     @07,RSPTWKC(,REG6)                                  1394 05441000
         NI    PTF1OK(@07),B'11011111'                             1394 05442000
*                      END;                                        1395 05443000
@RC01389 DS    0H                                                  1395 05444000
@RC01387 DS    0H                                                  1396 05445000
*                  END;                                            1396 05446000
@RC01376 DS    0H                                                  1397 05447000
*              END;                                                1397 05448000
@RT01372 DS    0H                                                  1398 05449000
*          END VERCINDX;                                           1398 05450000
*                                                                  1398 05451000
@RT01365 DS    0H                                                  1399 05452000
*        /************************************************************/ 05453000
*        /*                                                          */ 05454000
*        /* IF ERROR AND NO MESSAGE YET, ISSUE IDC11023I             */ 05455000
*        /*                                                          */ 05456000
*        /************************************************************/ 05457000
*                                                                  1399 05458000
*        IF PTF1OK=OFF & PTASSCIT(1)^=0 THEN                       1399 05459000
*                                                                  1399 05460000
@RF01357 L     @07,RSPTWKC(,REG6)                                  1399 05461000
         TM    PTF1OK(@07),B'00100000'                             1399 05462000
         BNZ   @RF01399                                            1399 05463000
         L     @07,PTASSCIT(,@07)                                  1399 05464000
         LTR   @07,@07                                             1399 05465000
         BZ    @RF01399                                            1399 05466000
*          DO;                                                     1400 05467000
*          /*CALL CKERR*/                                          1401 05468000
*            RSCKERR = RSCKERR && RSCKERR;                         1401 05469000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1401 05470000
*            RSCKERN = RSE026;                                     1402 05471000
         MVC   RSCKERN(2,REG6),@CH00942                            1402 05472000
*            RSCKTERM = 'RETU';                                    1403 05473000
         MVC   RSCKTERM(4,REG6),@CC03787                           1403 05474000
*            RSCKMVAR(1) = ADDR(ADDR(GRABRAB5->RABBUF)->CNAME);    1404 05475000
         L     @04,RSGRABCU(,REG6)                                 1404 05476000
         L     @04,GRABRAB5(,@04)                                  1404 05477000
         LA    @04,CNAME+8(,@04)                                   1404 05478000
         ST    @04,RSCKMVAR(,REG6)                                 1404 05479000
*            RSCKMVAR(2) = ADDR(CLID);                             1405 05480000
         LA    @04,@CC00800                                        1405 05481000
         ST    @04,RSCKMVAR+4(,REG6)                               1405 05482000
*            RSCKMVAR(3) = ADDR(PTASSCIT(1)->CITCIN);              1406 05483000
         LA    @04,CITCIN(,@07)                                    1406 05484000
         ST    @04,RSCKMVAR+8(,REG6)                               1406 05485000
*            RSCKMVAR(4) = ADDR(PTASSCIT(1)->CITTYPE);             1407 05486000
*                                                                  1407 05487000
         LA    @07,CITTYPE(,@07)                                   1407 05488000
         ST    @07,RSCKMVAR+12(,REG6)                              1407 05489000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */ 05490000
*          CALL CKERR;                                             1408 05491000
         L     @15,@CV03449                                        1408 05492000
         BALR  @14,@15                                             1408 05493000
*          END;                                                    1409 05494000
*                                                                  1409 05495000
*        /************************************************************/ 05496000
*        /*                                                          */ 05497000
*        /* IF NO ERROR, MARK THE CLUSTER VERIFIED                   */ 05498000
*        /*                                                          */ 05499000
*        /************************************************************/ 05500000
*                                                                  1410 05501000
*        IF PTF1OK = ON THEN                                       1410 05502000
@RF01399 L     @07,RSPTWKC(,REG6)                                  1410 05503000
         TM    PTF1OK(@07),B'00100000'                             1410 05504000
         BNO   @RF01410                                            1410 05505000
*          PTCITF->CITFAVER = ON;                                  1411 05506000
*                                                                  1411 05507000
         L     @07,PTCITF(,@07)                                    1411 05508000
         OI    CITFAVER(@07),B'01000000'                           1411 05509000
*        RFY DITABE;                   /*REVERT                      */ 05510000
@RF01410 DS    0H                                                  1413 05511000
* CALL EXIT;  /*TERMINATE*/                                        1413 05512000
         BAL   @14,EXIT                                            1413 05513000
* END VERC; /*END OF PROCEDURE*/                                   1414 05514000
@EL00010 DS    0H                                                  1414 05515000
@EF00010 DS    0H                                                  1414 05516000
@ER00010 BR    @14                                                 1414 05517000
@PB00010 DS    0H                                                  1415 05518000
*/********************************************************************/ 05519000
*/*                                                                  */ 05520000
*/* PROCEDURE - VERCI                                                */ 05521000
*/*                                                                  */ 05522000
*/* FUNCTION -                                                       */ 05523000
*/*     VERCI IS THE MAIN DRIVER FOR VERIFYING ASSOCIATIONS. THE     */ 05524000
*/*     BASE RECORDS ON WHICH ALL OTHER RECORDS DEPEND ON  ARE       */ 05525000
*/*     CLUSTER(C), GDG BASE(B), NON-VSAM(A), USERCATALOG(U), AND    */ 05526000
*/*     VOLUME(V). ASSOC LOCATED ONE OF THESE RECORDS AND PASSED     */ 05527000
*/*     CONTROL TO PROCTYPE ALONG WITH A TABLE INDICATING ALL        */ 05528000
*/*     OTHER VALID RECORD TYPES FOR THIS PARTICULAR BASE RECORD AND */ 05529000
*/*     WHAT PROCESSING WAS TO BE PERFORMED. PROCTYPE SCANNED ALL    */ 05530000
*/*     ASSOCIATED RECORDS FOR ASSOCIATIONS (AMONG OTHER THINGS) AND */ 05531000
*/*     EVENTUALLY GIVES CONTROL TO VERCI.                           */ 05532000
*/*                                                                  */ 05533000
*/*     FOR EACH PARTICULAR BASE RECORD, ASSOCIATIONS ARE            */ 05534000
*/*     CHECKED IN A MANNER TO AVOID THE LOSS OF AS LITTLE DATA      */ 05535000
*/*     AS POSSIBLE. THE BASE ASSOCIATIONS ARE VERIFIED (E.G.,       */ 05536000
*/*     CLUSTER<->DATA). AFTER A SOLID BASE IS DISCOVERED, ALL       */ 05537000
*/*     SECONDARY SETS OF RECORDS OFF THE BASE ARE VERIFIED          */ 05538000
*/*     (E.G., AIX'S, PATHS, UPGRADE SET). EACH SECONDARY SET IS     */ 05539000
*/*     VERIFIED INDEPENDENTLY OF THE OTHER SECONDARY SETS.          */ 05540000
*/*                                                                  */ 05541000
*/*     FOR EXAMPLE, THE BASE CLUSTER IS VERIFIED; I.E., THE         */ 05542000
*/*     CLUSTER TO DATA AND INDEX RELATIONSHIP ARE VERIFIED. IF      */ 05543000
*/*     THIS IS IN ERROR, THEN THE CLUSTER AND ALL THINGS DEPENDENT  */ 05544000
*/*     ON THE CLUSTER (E.G., AIX) WILL BE DELETED FROM THE CATALOG  */ 05545000
*/*     (BY UPDCAT) AND ANY SUBALLOCATED SPACE WILL BE RETURNED FOR  */ 05546000
*/*     SUBALLOCATION (BY PROCVOL). IF THE BASE IS FINE, THEN EACH   */ 05547000
*/*     PATH OVER THE CLUSTER IS VERIFIED. IF A PATH FAILS IN        */ 05548000
*/*     ASSOCIATION CHECKING, THEN THAT PATH WILL BE DELETED AND     */ 05549000
*/*     PROCESSING CONTINUED ON THE CLUSTER; HENCE, IF A PATH        */ 05550000
*/*     IS BAD, IT HAS NO EFFECT ON OTHER PATHS OR AIXS OR THE       */ 05551000
*/*     UPGRADE SET. THEN EACH AIX IS CHECKED INDEPENDENTLY, ETC.    */ 05552000
*/*     THIS IS TO ILLUSTRATE THAT AS MUCH AS POSSIBLE IS SAVED.     */ 05553000
*/*     ALSO, THAT NO INCOMPLETE OBJECT WILL BE RESTORED IN THE      */ 05554000
*/*     CATALOG.                                                   1415 05555000
*/*                                                                  */ 05556000
*/*     VERCI PROCESSES THE FOLLOWING TYPES. EACH TYPE HAS A COMMENT */ 05557000
*/*     TO INDICATE THE ORDER OF PROCESSING FOR THAT TYPE; SEE       */ 05558000
*/*     THE LABEL CORRESPONDING TO THE TYPE FOR THE COMMENT.         */ 05559000
*/*                                                                  */ 05560000
*/*          RECORD-TYPE                    LABEL                    */ 05561000
*/*                                                                  */ 05562000
*/*          CLUSTER                        VERCL                    */ 05563000
*/*          PATH                           VERPATH                  */ 05564000
*/*          UPGRADE                        VERUPG                   */ 05565000
*/*          AIX                            VERAIX                   */ 05566000
*/*          GDG BASE                       VERGDG                   */ 05567000
*/*          NON-VSAM                       VERNONV                  */ 05568000
*/*          USERCATALOG                    VERUCAT                  */ 05569000
*/*          VOLUME                         VERVOLR                  */ 05570000
*/*                                                                  */ 05571000
*/* INPUT -                                                          */ 05572000
*/*    CI TABLE AND DI TABLE FOR THE OBJECT                          */ 05573000
*/*    PTASSOC - ADDRESS OF THE ASSOCIATION TABLE FOR THE OBJECT     */ 05574000
*/*    RSPTWKC - ADDRESS OF PTWORK (MAIN WORK AREA FOR ASSOCIATIONS) */ 05575000
*/*                                                                  */ 05576000
*/* OUTPUT -                                                         */ 05577000
*/*    CITFAVER - SET ON FOR RECORD IF ASSOCIATION CHECKED           */ 05578000
*/*    DITFAVER - SET ON FOR ASSOCIATION IF ASSOCIATION CHECKED      */ 05579000
*/*                                                                  */ 05580000
*/* MESSAGES -                                                       */ 05581000
*/*    IDC21032I - ASSOCIATION TO RECORD WHICH DOESN'T EXIST         */ 05582000
*/*                                                                  */ 05583000
*/********************************************************************/ 05584000
*      GENERATE;                                                   1415 05585000
         DS    0F                                                       05586000
NAME0140 DC    CL8'VERCI'                                               05587000
*VERCI: PROCEDURE                                                  1416 05588000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1416 05589000
*                                                                  1416 05590000
         B     @PB00011                                            1416 05591000
VERCI    DS    0H                                                  1417 05592000
*      GENERATE REFS(RS02RG08, REG6);                              1417 05593000
*                                                                  1417 05594000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          05595000
         LR    @15,@13  OLD SAVE AREA                                   05596000
         LA    @13,72(@13)  NEW SAVE AREA                               05597000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     05598000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        05599000
         MVC   0(4,@15),NAME0140  PROCNAME TO REGSAVE                   05600000
*        OLDERID2 = NEWERID2;                                      1418 05601000
         L     @07,GDTTR2(,REG5)                                   1418 05602000
         MVC   @TS00001(95),NEWERID2(@07)                          1418 05603000
         MVC   OLDERID2(95,@07),@TS00001                           1418 05604000
*        NEWID2 = 'RSVE';                                          1419 05605000
         MVC   NEWID2(4,@07),@CC03852                              1419 05606000
*        RFY TASSO BASED(PTASSOC);     /*USE RECURSION TABLE         */ 05607000
*                                                                  1420 05608000
*        /*************************CLUSTER****************************/ 05609000
*        /* PROCESS A CLUSTER ENTRY                                  */ 05610000
*        /*     VERIFY THE CLUSTER BASE ASSOCIATIONS                 */ 05611000
*        /*     PROCESS ALL PATHS                                    */ 05612000
*        /*     PROCESS THE UPGRADE SET IF FOUND                     */ 05613000
*        /*     PROCESS ALL AIXS IF NO UPGRADE                       */ 05614000
*        /*                                                          */ 05615000
*        /************************************************************/ 05616000
*                                                                  1421 05617000
*  VERCL:                                                          1421 05618000
*        IF TASSID = CLID THEN                                     1421 05619000
VERCL    L     @07,RSPTWKC(,REG6)                                  1421 05620000
         L     @07,PTASSOC(,@07)                                   1421 05621000
         CLI   TASSID(@07),C'C'                                    1421 05622000
         BNE   @RF01421                                            1421 05623000
*          DO;                                                     1422 05624000
*            CALL VERC;             /*VERIFY CLUSTER ASSOCIATIONS */    05625000
         BAL   @14,VERC                                            1423 05626000
*            IF PTCITF->CITFAVER = ON THEN                         1424 05627000
         L     @07,RSPTWKC(,REG6)                                  1424 05628000
         L     @07,PTCITF(,@07)                                    1424 05629000
         TM    CITFAVER(@07),B'01000000'                           1424 05630000
         BNO   @RF01424                                            1424 05631000
*                                      /*CHECK SUBSETS IF CLUSTER OK */ 05632000
*              DO;                                                 1425 05633000
*                                                                  1425 05634000
*        /************************************************************/ 05635000
*        /*                                                          */ 05636000
*        /*     PROCESS ALL PATHS ON THE CLUSTER                     */ 05637000
*        /*                                                          */ 05638000
*        /************************************************************/ 05639000
*                                                                  1426 05640000
*  VERCPATH:                                                       1426 05641000
*                DO PTCITNC = PTCITI TO PTCITL;                    1426 05642000
VERCPATH L     @07,RSPTWKC(,REG6)                                  1426 05643000
         L     @07,PTCITI-1(,@07)                                  1426 05644000
         LA    @07,0(,@07)                                         1426 05645000
         B     @DE01426                                            1426 05646000
@DL01426 DS    0H                                                  1427 05647000
*                  RSTANCHR = ADDR(RSGCITS); /*SCAN CITABE FOR PATHS */ 05648000
         LA    @07,RSGCITS(,REG6)                                  1427 05649000
         ST    @07,RSTANCHR(,REG6)                                 1427 05650000
*                  RSTENTIX = PTCITNC;                             1428 05651000
         L     @07,RSPTWKC(,REG6)                                  1428 05652000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1428 05653000
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */ 05654000
*                  CALL GETNEXTE;                                  1429 05655000
         L     @15,@CV03436                                        1429 05656000
         BALR  @14,@15                                             1429 05657000
*                                      /*GET NEXT CITABE             */ 05658000
*                  PTCITCUR = RSTENTAD; /*SAVE CITABE ADDRESS        */ 05659000
*                                                                  1430 05660000
         L     @07,RSPTWKC(,REG6)                                  1430 05661000
         L     @04,RSTENTAD(,REG6)                                 1430 05662000
         ST    @04,PTCITCUR(,@07)                                  1430 05663000
*        /************************************************************/ 05664000
*        /*                                                          */ 05665000
*        /*       PATH FOUND - READ THE PATH RECORD                  */ 05666000
*        /*       IF RECORD INVALID, ISSUE MESSAGE IDC21032I         */ 05667000
*        /*                                                          */ 05668000
*        /************************************************************/ 05669000
*                                                                  1431 05670000
*                  IF CITTYPE = PATHID THEN                        1431 05671000
         CLI   CITTYPE(@04),C'R'                                   1431 05672000
         BNE   @RF01431                                            1431 05673000
*                    DO;                                           1432 05674000
*                      IF CITFAINV = OFF THEN                      1433 05675000
         TM    CITFAINV(@04),B'00000010'                           1433 05676000
         BNZ   @RF01433                                            1433 05677000
*                        DO;                                       1434 05678000
*                          RSASSTBL = ADDR(ASSOR); /*PATH ASSOC TBL  */ 05679000
         LA    @15,ASSOR                                           1435 05680000
         ST    @15,RSASSTBL(,REG6)                                 1435 05681000
*                          PTASSCUR=ADDR(RSASSTBL->TASSEN(1)); /*PATH*/ 05682000
         LA    @15,TASSEN(,@15)                                    1436 05683000
         ST    @15,PTASSCUR(,@07)                                  1436 05684000
*                          GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADR*/ 05685000
*                                                                  1437 05686000
         L     @14,RSGRABCU(,REG6)                                 1437 05687000
         LH    @15,TASSRAB(,@15)                                   1437 05688000
         SLA   @15,2                                               1437 05689000
         L     @15,RABARRAY-4(@15,@14)                             1437 05690000
         ST    @15,GRABCURR(,@14)                                  1437 05691000
*                          DO;                                     1438 05692000
*                            RSRTYPE = ''B;                        1439 05693000
         MVI   RSRTYPE(REG6),X'00'                                 1439 05694000
*                            RSRGET = ON;      /* GETRCD  */       1440 05695000
         OI    RSRGET(REG6),B'10000000'                            1440 05696000
*                            RSRUPD = ON;      /* UPDATE  */       1441 05697000
         OI    RSRUPD(REG6),B'00001000'                            1441 05698000
*                            RSRDS = ''B;                          1442 05699000
         NI    RSRDS(REG6),B'00011111'                             1442 05700000
*                            RSRWF = ON;       /* WORKFILE  */     1443 05701000
*                            RSRDIR = ON;      /* DIRECT  */       1444 05702000
*                            RSRKEY = ON;      /* KEY  */          1445 05703000
         OI    RSRWF(REG6),B'10010100'                             1445 05704000
*                            RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/    05705000
         OI    RSVIAFCR(REG6),B'10000000'                          1446 05706000
*                            RSVIACRA = PTCRAVL; /*SET VOLSER */   1447 05707000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1447 05708000
*                            RSVIACIN = CITCIN; /*SET CI NUMBER */ 1448 05709000
*                                                                  1448 05710000
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1448 05711000
*                          /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETV 05712000
*A                                                                   */ 05713000
*                          CALL GETVIA;                            1449 05714000
         L     @15,@CV03442                                        1449 05715000
         BALR  @14,@15                                             1449 05716000
*                          END;                                    1450 05717000
*                        END;                                      1451 05718000
*                      IF CITFAINV=ON | RABNRF=ON | CITTYPE^=RCDID 1452 05719000
*                       THEN                                       1452 05720000
@RF01433 L     @07,RSPTWKC(,REG6)                                  1452 05721000
         L     @07,PTCITCUR(,@07)                                  1452 05722000
         TM    CITFAINV(@07),B'00000010'                           1452 05723000
         BO    @RT01452                                            1452 05724000
         L     @04,RSGRABCU(,REG6)                                 1452 05725000
         L     @04,GRABCURR(,@04)                                  1452 05726000
         TM    RABNRF(@04),B'00000010'                             1452 05727000
         BO    @RT01452                                            1452 05728000
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1452 05729000
         BE    @RF01452                                            1452 05730000
@RT01452 DS    0H                                                  1453 05731000
*                                      /*NO RCD FOUND OR BAD TYPE    */ 05732000
*                        DO;                                       1453 05733000
*                          RABNRF = OFF; /*RESET NO RCD FOUND        */ 05734000
         L     @07,RSGRABCU(,REG6)                                 1454 05735000
         L     @04,GRABCURR(,@07)                                  1454 05736000
         NI    RABNRF(@04),B'11111101'                             1454 05737000
*                          CITFAINV = ON; /*MARK INVALID             */ 05738000
*                                                                  1455 05739000
         L     @04,RSPTWKC(,REG6)                                  1455 05740000
         L     @04,PTCITCUR(,@04)                                  1455 05741000
         OI    CITFAINV(@04),B'00000010'                           1455 05742000
*                          DO;                                     1456 05743000
*                          /*CALL CKERR*/                          1457 05744000
*                            RSCKERR = RSCKERR && RSCKERR;         1457 05745000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1457 05746000
*                            RSCKERN = RSE042;                     1458 05747000
         MVC   RSCKERN(2,REG6),@CH00971                            1458 05748000
*                            RSCKTERM = 'RETU';                    1459 05749000
         MVC   RSCKTERM(4,REG6),@CC03787                           1459 05750000
*                            RSCKMVAR(1) = ADDR(PATHID);           1460 05751000
         LA    @04,@CC00818                                        1460 05752000
         ST    @04,RSCKMVAR(,REG6)                                 1460 05753000
*                            RSCKMVAR(2) = ADDR(ADDR(GRABRAB5->RABBUF)- 05754000
*CNAME);                                                           1461 05755000
         L     @07,GRABRAB5(,@07)                                  1461 05756000
         LA    @07,CNAME+8(,@07)                                   1461 05757000
         ST    @07,RSCKMVAR+4(,REG6)                               1461 05758000
*                            RSCKMVAR(3) = ADDR(CLID);             1462 05759000
*                                                                  1462 05760000
         LA    @07,@CC00800                                        1462 05761000
         ST    @07,RSCKMVAR+8(,REG6)                               1462 05762000
*                          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKER 05763000
*                                                                    */ 05764000
*                          CALL CKERR;                             1463 05765000
         L     @15,@CV03449                                        1463 05766000
         BALR  @14,@15                                             1463 05767000
*                          END;                                    1464 05768000
*                        END;                                      1465 05769000
*                                                                  1465 05770000
*        /************************************************************/ 05771000
*        /*                                                          */ 05772000
*        /*       IF PATH WAS READ, PROCESS IT                       */ 05773000
*        /*                                                          */ 05774000
*        /************************************************************/ 05775000
*                                                                  1466 05776000
*                      ELSE                                        1466 05777000
*                        CALL PROCTYPE;                            1466 05778000
         B     @RC01452                                            1466 05779000
@RF01452 BAL   @14,PROCTYPE                                        1466 05780000
*                    END;                                          1467 05781000
@RC01452 DS    0H                                                  1468 05782000
*                END VERCPATH;                                     1468 05783000
@RF01431 L     @04,RSPTWKC(,REG6)                                  1468 05784000
         LA    @07,1                                               1468 05785000
         L     @04,PTCITNC-1(,@04)                                 1468 05786000
         LA    @04,0(,@04)                                         1468 05787000
         ALR   @07,@04                                             1468 05788000
@DE01426 L     @04,RSPTWKC(,REG6)                                  1468 05789000
         STCM  @07,7,PTCITNC(@04)                                  1468 05790000
         L     @04,RSPTWKC(,REG6)                                  1468 05791000
         L     @04,PTCITL-1(,@04)                                  1468 05792000
         LA    @04,0(,@04)                                         1468 05793000
         CR    @07,@04                                             1468 05794000
         BNH   @DL01426                                            1468 05795000
*        /************************************************************/ 05796000
*        /*                                                          */ 05797000
*        /*     PROCESS UPGRADE IF UPGRADE EXISTS                    */ 05798000
*        /*                                                          */ 05799000
*        /************************************************************/ 05800000
*                                                                  1469 05801000
*        /************************************************************/ 05802000
*        /*                                                          */ 05803000
*        /*         SCAN CLUSTER FOR DATA ASSOCIATION                */ 05804000
*        /*                                                          */ 05805000
*        /************************************************************/ 05806000
*                                                                  1469 05807000
*                PTF1HIT2 = OFF;       /*ASSUME NO UPGRADE           */ 05808000
         L     @07,RSPTWKC(,REG6)                                  1469 05809000
         NI    PTF1HIT2(@07),B'10111111'                           1469 05810000
*                PTLOC = PTLOC && PTLOC;                           1470 05811000
         XC    PTLOC(20,@07),PTLOC(@07)                            1470 05812000
*                PTLBCITX = PTCITI;    /*SCAN THE CLUSTER BASE       */ 05813000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1471 05814000
*                PTLFBAS1 = ON;        /*FOR THE ASSOCIATION TO DATA */ 05815000
         OI    PTLFBAS1(@07),B'00100000'                           1472 05816000
*                PTLSN = 1;                                        1473 05817000
         MVC   PTLSN(2,@07),@CH00212                               1473 05818000
*                CALL LOCDIT;                                      1474 05819000
         BAL   @14,LOCDIT                                          1474 05820000
*                PTCITCUR = PTLCDIT->DITCITAB; /*DATA CITABLE ENT    */ 05821000
*                                                                  1475 05822000
         L     @07,RSPTWKC(,REG6)                                  1475 05823000
         L     @04,PTLCDIT(,@07)                                   1475 05824000
         L     @04,DITCITAB-1(,@04)                                1475 05825000
         LA    @04,0(,@04)                                         1475 05826000
         ST    @04,PTCITCUR(,@07)                                  1475 05827000
*        /************************************************************/ 05828000
*        /*                                                          */ 05829000
*        /*         SCAN DATA FOR UPGRADE ASSOCIATION                */ 05830000
*        /*                                                          */ 05831000
*        /************************************************************/ 05832000
*                                                                  1476 05833000
*                PTLOC = PTLOC && PTLOC;                           1476 05834000
         XC    PTLOC(20,@07),PTLOC(@07)                            1476 05835000
*                PTLBCITX = PTCITCUR;  /*SCAN DATA RECORD            */ 05836000
         STCM  @04,7,PTLBCITX(@07)                                 1477 05837000
*                PTLFBAS1 = ON;        /*FOR ASSN TO UPGRADE         */ 05838000
         OI    PTLFBAS1(@07),B'00100000'                           1478 05839000
*                PTLSN = 0;                                        1479 05840000
         SLR   @04,@04                                             1479 05841000
         STH   @04,PTLSN(,@07)                                     1479 05842000
*                PTLDITID = UPGID;                                 1480 05843000
         MVI   PTLDITID(@07),C'Y'                                  1480 05844000
*                CALL LOCDIT;                                      1481 05845000
*                                                                  1481 05846000
         BAL   @14,LOCDIT                                          1481 05847000
*        /************************************************************/ 05848000
*        /*                                                          */ 05849000
*        /*       IF UPGRADE SET, READ IT                            */ 05850000
*        /*       IF INVALID, ISSUE MESSAGE IDC21032I                */ 05851000
*        /*                                                          */ 05852000
*        /************************************************************/ 05853000
*                                                                  1482 05854000
*                IF PTLCDIT ^= 0 THEN                              1482 05855000
         L     @07,RSPTWKC(,REG6)                                  1482 05856000
         L     @04,PTLCDIT(,@07)                                   1482 05857000
         LTR   @04,@04                                             1482 05858000
         BZ    @RF01482                                            1482 05859000
*                  DO;                                             1483 05860000
*                    PTF1HIT2 = ON;    /*FOUND UPGRADE               */ 05861000
         OI    PTF1HIT2(@07),B'01000000'                           1484 05862000
*                    RSTANCHR = ADDR(RSGCITS);                     1485 05863000
         LA    @07,RSGCITS(,REG6)                                  1485 05864000
         ST    @07,RSTANCHR(,REG6)                                 1485 05865000
*                    RSTENTIX = PTLCDIT->DITCITAB; /*GET CIT FOR UPG */ 05866000
         MVC   RSTENTIX(3,REG6),DITCITAB(@04)                      1486 05867000
*                    /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE*/ 05868000
*                    CALL GETNEXTE;                                1487 05869000
         L     @15,@CV03436                                        1487 05870000
         BALR  @14,@15                                             1487 05871000
*                    PTCITCUR = RSTENTAD;                          1488 05872000
         L     @07,RSPTWKC(,REG6)                                  1488 05873000
         L     @04,RSTENTAD(,REG6)                                 1488 05874000
         ST    @04,PTCITCUR(,@07)                                  1488 05875000
*                    IF CITFAINV = OFF THEN /*DON'T PROCESS INVALIDS */ 05876000
         TM    CITFAINV(@04),B'00000010'                           1489 05877000
         BNZ   @RF01489                                            1489 05878000
*                      DO;                                         1490 05879000
*                        RSASSTBL = ADDR(ASSOY); /*UPGRADE ASSOC TBL */ 05880000
         LA    @15,ASSOY                                           1491 05881000
         ST    @15,RSASSTBL(,REG6)                                 1491 05882000
*                        PTASSCUR = ADDR(RSASSTBL->TASSEN(1)); /*UPG */ 05883000
         LA    @15,TASSEN(,@15)                                    1492 05884000
         ST    @15,PTASSCUR(,@07)                                  1492 05885000
*                        GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR */ 05886000
*                                                                  1493 05887000
         L     @14,RSGRABCU(,REG6)                                 1493 05888000
         LH    @15,TASSRAB(,@15)                                   1493 05889000
         SLA   @15,2                                               1493 05890000
         L     @15,RABARRAY-4(@15,@14)                             1493 05891000
         ST    @15,GRABCURR(,@14)                                  1493 05892000
*                        DO;                                       1494 05893000
*                          RSRTYPE = ''B;                          1495 05894000
         MVI   RSRTYPE(REG6),X'00'                                 1495 05895000
*                          RSRGET = ON;      /* GETRCD  */         1496 05896000
         OI    RSRGET(REG6),B'10000000'                            1496 05897000
*                          RSRUPD = ON;      /* UPDATE  */         1497 05898000
         OI    RSRUPD(REG6),B'00001000'                            1497 05899000
*                          RSRDS = ''B;                            1498 05900000
         NI    RSRDS(REG6),B'00011111'                             1498 05901000
*                          RSRWF = ON;       /* WORKFILE  */       1499 05902000
*                          RSRDIR = ON;      /* DIRECT  */         1500 05903000
*                          RSRKEY = ON;      /* KEY  */            1501 05904000
         OI    RSRWF(REG6),B'10010100'                             1501 05905000
*                          RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/ 1502 05906000
         OI    RSVIAFCR(REG6),B'10000000'                          1502 05907000
*                          RSVIACRA = PTCRAVL; /*SET VOLSER */     1503 05908000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1503 05909000
*                          RSVIACIN = CITCIN; /*SET CI NUMBER */   1504 05910000
*                                                                  1504 05911000
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1504 05912000
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA 05913000
*                                                                    */ 05914000
*                        CALL GETVIA;                              1505 05915000
         L     @15,@CV03442                                        1505 05916000
         BALR  @14,@15                                             1505 05917000
*                        END;                                      1506 05918000
*                      END;                                        1507 05919000
*                    IF CITFAINV=ON | RABNRF=ON | CITTYPE^=RCDID   1508 05920000
*                     THEN                                         1508 05921000
@RF01489 L     @07,RSPTWKC(,REG6)                                  1508 05922000
         L     @07,PTCITCUR(,@07)                                  1508 05923000
         TM    CITFAINV(@07),B'00000010'                           1508 05924000
         BO    @RT01508                                            1508 05925000
         L     @04,RSGRABCU(,REG6)                                 1508 05926000
         L     @04,GRABCURR(,@04)                                  1508 05927000
         TM    RABNRF(@04),B'00000010'                             1508 05928000
         BO    @RT01508                                            1508 05929000
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1508 05930000
         BE    @RF01508                                            1508 05931000
@RT01508 DS    0H                                                  1509 05932000
*                                      /*NO RCD FOUND OR BAD TYPE    */ 05933000
*                      DO;                                         1509 05934000
*                        RABNRF = OFF; /*RESET NO RCD FOUND          */ 05935000
         L     @07,RSGRABCU(,REG6)                                 1510 05936000
         L     @04,GRABCURR(,@07)                                  1510 05937000
         NI    RABNRF(@04),B'11111101'                             1510 05938000
*                        CITFAINV = ON; /*MARK INVALID               */ 05939000
         L     @04,RSPTWKC(,REG6)                                  1511 05940000
         L     @01,PTCITCUR(,@04)                                  1511 05941000
         OI    CITFAINV(@01),B'00000010'                           1511 05942000
*                        PTF1HIT2 = OFF; /*FAKE NO UPGRADE           */ 05943000
*                                                                  1512 05944000
         NI    PTF1HIT2(@04),B'10111111'                           1512 05945000
*                        DO;                                       1513 05946000
*                        /*CALL CKERR*/                            1514 05947000
*                          RSCKERR = RSCKERR && RSCKERR;           1514 05948000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1514 05949000
*                          RSCKERN = RSE042;                       1515 05950000
         MVC   RSCKERN(2,REG6),@CH00971                            1515 05951000
*                          RSCKTERM = 'RETU';                      1516 05952000
         MVC   RSCKTERM(4,REG6),@CC03787                           1516 05953000
*                          RSCKMVAR(1) = ADDR(UPGID);              1517 05954000
         LA    @04,@CC00816                                        1517 05955000
         ST    @04,RSCKMVAR(,REG6)                                 1517 05956000
*                          RSCKMVAR(2) = ADDR(ADDR(GRABRAB5->RABBUF)->C 05957000
*AME);                                                             1518 05958000
         L     @07,GRABRAB5(,@07)                                  1518 05959000
         LA    @07,CNAME+8(,@07)                                   1518 05960000
         ST    @07,RSCKMVAR+4(,REG6)                               1518 05961000
*                          RSCKMVAR(3) = ADDR(CLID);               1519 05962000
*                                                                  1519 05963000
         LA    @07,@CC00800                                        1519 05964000
         ST    @07,RSCKMVAR+8(,REG6)                               1519 05965000
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  05966000
*                                                                    */ 05967000
*                        CALL CKERR;                               1520 05968000
         L     @15,@CV03449                                        1520 05969000
         BALR  @14,@15                                             1520 05970000
*                        END;                                      1521 05971000
*                      END;                                        1522 05972000
*                                                                  1522 05973000
*        /************************************************************/ 05974000
*        /*                                                          */ 05975000
*        /*       IF UPGRADE READ, PROCESS IT                        */ 05976000
*        /*                                                          */ 05977000
*        /************************************************************/ 05978000
*                                                                  1523 05979000
*                    ELSE                                          1523 05980000
*                      DO;                                         1523 05981000
         B     @RC01508                                            1523 05982000
@RF01508 DS    0H                                                  1524 05983000
*                        CALL PROCTYPE;                            1524 05984000
         BAL   @14,PROCTYPE                                        1524 05985000
*                        PTLCDIT->DITFAVER = ON; /*MARK D->Y OK      */ 05986000
         L     @07,RSPTWKC(,REG6)                                  1525 05987000
         L     @07,PTLCDIT(,@07)                                   1525 05988000
         OI    DITFAVER(@07),B'01000000'                           1525 05989000
*                      END;                                        1526 05990000
*                  END;                                            1527 05991000
@RC01508 DS    0H                                                  1528 05992000
*                                                                  1528 05993000
*        /************************************************************/ 05994000
*        /*                                                          */ 05995000
*        /*     PROCESS ALTERNATE INDEXES IF AIXS EXIST              */ 05996000
*        /*     BUT ONLY IF NO UPGRADE WAS PROCESSED. IF AN          */ 05997000
*        /*     UPGRADE WAS PROCESSED, THE AIXS WERE PROCESSED BY    */ 05998000
*        /*     THE UPGRADE.                                         */ 05999000
*        /*                                                          */ 06000000
*        /************************************************************/ 06001000
*                                                                  1528 06002000
*                IF PTF1HIT2 = OFF THEN                            1528 06003000
@RF01482 L     @07,RSPTWKC(,REG6)                                  1528 06004000
         TM    PTF1HIT2(@07),B'01000000'                           1528 06005000
         BNZ   @RF01528                                            1528 06006000
*                  DO;                                             1529 06007000
*  VERCAIX:                                                        1530 06008000
*                    DO PTCITNC = PTCITI TO PTCITL;                1530 06009000
VERCAIX  L     @07,RSPTWKC(,REG6)                                  1530 06010000
         L     @07,PTCITI-1(,@07)                                  1530 06011000
         LA    @07,0(,@07)                                         1530 06012000
         B     @DE01530                                            1530 06013000
@DL01530 DS    0H                                                  1531 06014000
*                      RSTANCHR = ADDR(RSGCITS);                   1531 06015000
         LA    @07,RSGCITS(,REG6)                                  1531 06016000
         ST    @07,RSTANCHR(,REG6)                                 1531 06017000
*                      RSTENTIX = PTCITNC; /*NEXT CITABE             */ 06018000
         L     @07,RSPTWKC(,REG6)                                  1532 06019000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1532 06020000
*                      /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE 06021000
*                                                                    */ 06022000
*                      CALL GETNEXTE;                              1533 06023000
         L     @15,@CV03436                                        1533 06024000
         BALR  @14,@15                                             1533 06025000
*                      PTCITCUR = RSTENTAD; /*CI TABLE ENTRY         */ 06026000
*                                                                  1534 06027000
         L     @07,RSPTWKC(,REG6)                                  1534 06028000
         L     @04,RSTENTAD(,REG6)                                 1534 06029000
         ST    @04,PTCITCUR(,@07)                                  1534 06030000
*        /************************************************************/ 06031000
*        /*                                                          */ 06032000
*        /*       IF AIX, READ IT                                    */ 06033000
*        /*       IF INVALID, ISSUE MESSAGE IDC21032I.               */ 06034000
*        /*                                                          */ 06035000
*        /************************************************************/ 06036000
*                                                                  1535 06037000
*                      IF CITTYPE = AIXID THEN                     1535 06038000
         CLI   CITTYPE(@04),C'G'                                   1535 06039000
         BNE   @RF01535                                            1535 06040000
*                        DO;                                       1536 06041000
*                          IF CITFAINV = OFF THEN /*PROCESS VALIDS   */ 06042000
         TM    CITFAINV(@04),B'00000010'                           1537 06043000
         BNZ   @RF01537                                            1537 06044000
*                            DO;                                   1538 06045000
*                              RSASSTBL = ADDR(ASSOG); /*AIX ASSOC TB*/ 06046000
         LA    @15,ASSOG                                           1539 06047000
         ST    @15,RSASSTBL(,REG6)                                 1539 06048000
*                              PTASSCUR = ADDR(RSASSTBL->TASSEN(1));    06049000
         LA    @15,TASSEN(,@15)                                    1540 06050000
         ST    @15,PTASSCUR(,@07)                                  1540 06051000
*                              GRABCURR = RABARRAY(TASSRAB); /*BFRADR*/ 06052000
*                                                                  1541 06053000
         L     @14,RSGRABCU(,REG6)                                 1541 06054000
         LH    @15,TASSRAB(,@15)                                   1541 06055000
         SLA   @15,2                                               1541 06056000
         L     @15,RABARRAY-4(@15,@14)                             1541 06057000
         ST    @15,GRABCURR(,@14)                                  1541 06058000
*                              DO;                                 1542 06059000
*                                RSRTYPE = ''B;                    1543 06060000
         MVI   RSRTYPE(REG6),X'00'                                 1543 06061000
*                                RSRGET = ON;      /* GETRCD  */   1544 06062000
         OI    RSRGET(REG6),B'10000000'                            1544 06063000
*                                RSRUPD = ON;      /* UPDATE  */   1545 06064000
         OI    RSRUPD(REG6),B'00001000'                            1545 06065000
*                                RSRDS = ''B;                      1546 06066000
         NI    RSRDS(REG6),B'00011111'                             1546 06067000
*                                RSRWF = ON;       /* WORKFILE  */ 1547 06068000
*                                RSRDIR = ON;      /* DIRECT  */   1548 06069000
*                                RSRKEY = ON;      /* KEY  */      1549 06070000
         OI    RSRWF(REG6),B'10010100'                             1549 06071000
*                                RSVIAFCR = ON;  /*INDICATE CRA SEARCH* 06072000
         OI    RSVIAFCR(REG6),B'10000000'                          1550 06073000
*                                RSVIACRA = PTCRAVL; /*SET VOLSER */    06074000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1551 06075000
*                                RSVIACIN = CITCIN; /*SET CI NUMBER */  06076000
*                                                                  1552 06077000
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1552 06078000
*                              /* CALL TO MODULE IDCRS05 FOR PROCEDURE  06079000
*ETVIA                                                               */ 06080000
*                              CALL GETVIA;                        1553 06081000
         L     @15,@CV03442                                        1553 06082000
         BALR  @14,@15                                             1553 06083000
*                              END;                                1554 06084000
*                                      /*TRY TO READ THE AIX         */ 06085000
*                            END;                                  1555 06086000
*                          IF CITFAINV=ON | RABNRF=ON | CITTYPE^=RCDID  06087000
*                           THEN                                   1556 06088000
@RF01537 L     @07,RSPTWKC(,REG6)                                  1556 06089000
         L     @07,PTCITCUR(,@07)                                  1556 06090000
         TM    CITFAINV(@07),B'00000010'                           1556 06091000
         BO    @RT01556                                            1556 06092000
         L     @04,RSGRABCU(,REG6)                                 1556 06093000
         L     @04,GRABCURR(,@04)                                  1556 06094000
         TM    RABNRF(@04),B'00000010'                             1556 06095000
         BO    @RT01556                                            1556 06096000
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1556 06097000
         BE    @RF01556                                            1556 06098000
@RT01556 DS    0H                                                  1557 06099000
*                                      /*NO RCD FOUND OR BAD TYPE    */ 06100000
*                            DO;                                   1557 06101000
*                              RABNRF = OFF; /*RESET NO RCD FND      */ 06102000
         L     @07,RSGRABCU(,REG6)                                 1558 06103000
         L     @04,GRABCURR(,@07)                                  1558 06104000
         NI    RABNRF(@04),B'11111101'                             1558 06105000
*                              CITFAINV = ON; /*MARK INVALID         */ 06106000
*                                                                  1559 06107000
         L     @04,RSPTWKC(,REG6)                                  1559 06108000
         L     @04,PTCITCUR(,@04)                                  1559 06109000
         OI    CITFAINV(@04),B'00000010'                           1559 06110000
*                              DO;                                 1560 06111000
*                              /*CALL CKERR*/                      1561 06112000
*                                RSCKERR = RSCKERR && RSCKERR;     1561 06113000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1561 06114000
*                                RSCKERN = RSE042;                 1562 06115000
         MVC   RSCKERN(2,REG6),@CH00971                            1562 06116000
*                                RSCKTERM = 'RETU';                1563 06117000
         MVC   RSCKTERM(4,REG6),@CC03787                           1563 06118000
*                                RSCKMVAR(1) = ADDR(AIXID);        1564 06119000
         LA    @04,@CC00806                                        1564 06120000
         ST    @04,RSCKMVAR(,REG6)                                 1564 06121000
*                                RSCKMVAR(2) = ADDR(ADDR(GRABRAB5->RABB 06122000
*F)->CNAME);                                                       1565 06123000
         L     @07,GRABRAB5(,@07)                                  1565 06124000
         LA    @07,CNAME+8(,@07)                                   1565 06125000
         ST    @07,RSCKMVAR+4(,REG6)                               1565 06126000
*                                RSCKMVAR(3) = ADDR(CLID);         1566 06127000
*                                                                  1566 06128000
         LA    @07,@CC00800                                        1566 06129000
         ST    @07,RSCKMVAR+8(,REG6)                               1566 06130000
*                              /* CALL TO MODULE IDCRS05 FOR PROCEDURE  06131000
*KERR                                                                */ 06132000
*                              CALL CKERR;                         1567 06133000
         L     @15,@CV03449                                        1567 06134000
         BALR  @14,@15                                             1567 06135000
*                              END;                                1568 06136000
*                            END;                                  1569 06137000
*                                                                  1569 06138000
*        /************************************************************/ 06139000
*        /*                                                          */ 06140000
*        /*       IF AIX READ, PROCESS IT                            */ 06141000
*        /*                                                          */ 06142000
*        /************************************************************/ 06143000
*                                                                  1570 06144000
*                          ELSE                                    1570 06145000
*                            CALL PROCTYPE;                        1570 06146000
         B     @RC01556                                            1570 06147000
@RF01556 BAL   @14,PROCTYPE                                        1570 06148000
*                        END;          /*END AIX RECORD              */ 06149000
@RC01556 DS    0H                                                  1572 06150000
*                    END VERCAIX;                                  1572 06151000
@RF01535 L     @04,RSPTWKC(,REG6)                                  1572 06152000
         LA    @07,1                                               1572 06153000
         L     @04,PTCITNC-1(,@04)                                 1572 06154000
         LA    @04,0(,@04)                                         1572 06155000
         ALR   @07,@04                                             1572 06156000
@DE01530 L     @04,RSPTWKC(,REG6)                                  1572 06157000
         STCM  @07,7,PTCITNC(@04)                                  1572 06158000
         L     @04,RSPTWKC(,REG6)                                  1572 06159000
         L     @04,PTCITL-1(,@04)                                  1572 06160000
         LA    @04,0(,@04)                                         1572 06161000
         CR    @07,@04                                             1572 06162000
         BNH   @DL01530                                            1572 06163000
*                  END;                /*END OF VERIFY AIX           */ 06164000
*              END;                    /*END OF VALID CLUSTER        */ 06165000
@RF01528 DS    0H                                                  1575 06166000
*          END;                        /*END OF ALL CLUSTER          */ 06167000
@RF01424 DS    0H                                                  1576 06168000
*        /***************************PATH*****************************/ 06169000
*        /*                                                          */ 06170000
*        /*     PROCESS A PATH                                       */ 06171000
*        /*       VERIFY THE PATH ASSOCIATIONS                       */ 06172000
*        /*                                                          */ 06173000
*        /************************************************************/ 06174000
*                                                                  1576 06175000
* VERPATH:                                                         1576 06176000
*        IF TASSID = PATHID THEN                                   1576 06177000
@RF01421 DS    0H                                                  1576 06178000
VERPATH  L     @07,RSPTWKC(,REG6)                                  1576 06179000
         L     @07,PTASSOC(,@07)                                   1576 06180000
         CLI   TASSID(@07),C'R'                                    1576 06181000
         BNE   @RF01576                                            1576 06182000
*          CALL VERR;                                              1577 06183000
         BAL   @14,VERR                                            1577 06184000
*        /************************UPGRADE*****************************/ 06185000
*        /*                                                          */ 06186000
*        /*     PROCESS AN UPGRADE SET                               */ 06187000
*        /*       BUILD CI TABLE FOR ALL ASSOCIATIONS (DONE ALREADY) */ 06188000
*        /*       PROCESS ALL AIXS WHICH INDICATE VALID DATA         */ 06189000
*        /*        AND INDEX IN THE UPGRADE TABLE                    */ 06190000
*        /*                                                          */ 06191000
*        /************************************************************/ 06192000
*                                                                  1578 06193000
*  VERUPG:                                                         1578 06194000
*        IF TASSID = UPGID THEN                                    1578 06195000
@RF01576 DS    0H                                                  1578 06196000
VERUPG   L     @07,RSPTWKC(,REG6)                                  1578 06197000
         L     @04,PTASSOC(,@07)                                   1578 06198000
         CLI   TASSID(@04),C'Y'                                    1578 06199000
         BNE   @RF01578                                            1578 06200000
*          DO;                                                     1579 06201000
*            PTCITF->CITFAVER = ON;    /*MARK UPGRADE VERIFIED       */ 06202000
*                                                                  1580 06203000
         L     @07,PTCITF(,@07)                                    1580 06204000
         OI    CITFAVER(@07),B'01000000'                           1580 06205000
*        /************************************************************/ 06206000
*        /*                                                          */ 06207000
*        /*     PROCESS ALL AIXS ON THE CLUSTER                      */ 06208000
*        /*                                                          */ 06209000
*        /************************************************************/ 06210000
*                                                                  1581 06211000
*  VERYAIX:                                                        1581 06212000
*            DO PTCITNC = RSPTWKF->PTCITI TO RSPTWKF->PTCITL;      1581 06213000
VERYAIX  L     @07,RSPTWKF(,REG6)                                  1581 06214000
         L     @07,PTCITI-1(,@07)                                  1581 06215000
         LA    @07,0(,@07)                                         1581 06216000
         B     @DE01581                                            1581 06217000
@DL01581 DS    0H                                                  1582 06218000
*                                      /*SCAN CLUSTER TABLE FOR AIXS */ 06219000
*              RSTANCHR = ADDR(RSGCITS);                           1582 06220000
         LA    @07,RSGCITS(,REG6)                                  1582 06221000
         ST    @07,RSTANCHR(,REG6)                                 1582 06222000
*              RSTENTIX = PTCITNC;     /*NEXT CITABE                 */ 06223000
         L     @07,RSPTWKC(,REG6)                                  1583 06224000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1583 06225000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 06226000
*              CALL GETNEXTE;                                      1584 06227000
         L     @15,@CV03436                                        1584 06228000
         BALR  @14,@15                                             1584 06229000
*              PTCITCUR = RSTENTAD;    /*CI TABLE ENTRY              */ 06230000
*                                                                  1585 06231000
         L     @07,RSPTWKC(,REG6)                                  1585 06232000
         L     @04,RSTENTAD(,REG6)                                 1585 06233000
         ST    @04,PTCITCUR(,@07)                                  1585 06234000
*        /************************************************************/ 06235000
*        /*                                                          */ 06236000
*        /*       IF AIX, READ IT                                    */ 06237000
*        /*       IF INVALID, ISSUE MESSAGE IDC21032I.               */ 06238000
*        /*                                                          */ 06239000
*        /************************************************************/ 06240000
*                                                                  1586 06241000
*              IF CITTYPE = AIXID THEN                             1586 06242000
         CLI   CITTYPE(@04),C'G'                                   1586 06243000
         BNE   @RF01586                                            1586 06244000
*                DO;                                               1587 06245000
*                  IF CITFAINV = OFF THEN /*PROCESS VALID RECORDS    */ 06246000
         TM    CITFAINV(@04),B'00000010'                           1588 06247000
         BNZ   @RF01588                                            1588 06248000
*                    DO;                                           1589 06249000
*                      RSASSTBL = ADDR(ASSOG); /*AIX ASSOC TABLE     */ 06250000
         LA    @15,ASSOG                                           1590 06251000
         ST    @15,RSASSTBL(,REG6)                                 1590 06252000
*                      PTASSCUR = ADDR(RSASSTBL->TASSEN(1)); /*AIX EN*/ 06253000
         LA    @15,TASSEN(,@15)                                    1591 06254000
         ST    @15,PTASSCUR(,@07)                                  1591 06255000
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */ 06256000
*                                                                  1592 06257000
         L     @14,RSGRABCU(,REG6)                                 1592 06258000
         LH    @15,TASSRAB(,@15)                                   1592 06259000
         SLA   @15,2                                               1592 06260000
         L     @15,RABARRAY-4(@15,@14)                             1592 06261000
         ST    @15,GRABCURR(,@14)                                  1592 06262000
*                      DO;                                         1593 06263000
*                        RSRTYPE = ''B;                            1594 06264000
         MVI   RSRTYPE(REG6),X'00'                                 1594 06265000
*                        RSRGET = ON;      /* GETRCD  */           1595 06266000
         OI    RSRGET(REG6),B'10000000'                            1595 06267000
*                        RSRUPD = ON;      /* UPDATE  */           1596 06268000
         OI    RSRUPD(REG6),B'00001000'                            1596 06269000
*                        RSRDS = ''B;                              1597 06270000
         NI    RSRDS(REG6),B'00011111'                             1597 06271000
*                        RSRWF = ON;       /* WORKFILE  */         1598 06272000
*                        RSRDIR = ON;      /* DIRECT  */           1599 06273000
*                        RSRKEY = ON;      /* KEY  */              1600 06274000
         OI    RSRWF(REG6),B'10010100'                             1600 06275000
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   1601 06276000
         OI    RSVIAFCR(REG6),B'10000000'                          1601 06277000
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       1602 06278000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1602 06279000
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     1603 06280000
*                                                                  1603 06281000
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1603 06282000
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/ 06283000
*                      CALL GETVIA;                                1604 06284000
         L     @15,@CV03442                                        1604 06285000
         BALR  @14,@15                                             1604 06286000
*                      END;                                        1605 06287000
*                    END;                                          1606 06288000
*                  IF CITFAINV=ON | RABNRF=ON | CITTYPE^=RCDID THEN     06289000
@RF01588 L     @07,RSPTWKC(,REG6)                                  1607 06290000
         L     @07,PTCITCUR(,@07)                                  1607 06291000
         TM    CITFAINV(@07),B'00000010'                           1607 06292000
         BO    @RT01607                                            1607 06293000
         L     @04,RSGRABCU(,REG6)                                 1607 06294000
         L     @04,GRABCURR(,@04)                                  1607 06295000
         TM    RABNRF(@04),B'00000010'                             1607 06296000
         BO    @RT01607                                            1607 06297000
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1607 06298000
         BE    @RF01607                                            1607 06299000
@RT01607 DS    0H                                                  1608 06300000
*                                      /*NO RCD FOUND OR BAD TYPE    */ 06301000
*                    DO;                                           1608 06302000
*                      RABNRF = OFF;   /*RESET NO RCD FND            */ 06303000
         L     @07,RSGRABCU(,REG6)                                 1609 06304000
         L     @04,GRABCURR(,@07)                                  1609 06305000
         NI    RABNRF(@04),B'11111101'                             1609 06306000
*                      CITFAINV = ON;  /*MARK INVALID                */ 06307000
*                                                                  1610 06308000
         L     @04,RSPTWKC(,REG6)                                  1610 06309000
         L     @04,PTCITCUR(,@04)                                  1610 06310000
         OI    CITFAINV(@04),B'00000010'                           1610 06311000
*                      DO;                                         1611 06312000
*                      /*CALL CKERR*/                              1612 06313000
*                        RSCKERR = RSCKERR && RSCKERR;             1612 06314000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1612 06315000
*                        RSCKERN = RSE042;                         1613 06316000
         MVC   RSCKERN(2,REG6),@CH00971                            1613 06317000
*                        RSCKTERM = 'RETU';                        1614 06318000
         MVC   RSCKTERM(4,REG6),@CC03787                           1614 06319000
*                        RSCKMVAR(1) = ADDR(AIXID);                1615 06320000
         LA    @04,@CC00806                                        1615 06321000
         ST    @04,RSCKMVAR(,REG6)                                 1615 06322000
*                        RSCKMVAR(2) = ADDR(ADDR(GRABRAB5->RABBUF)->CNA 06323000
*E);                                                               1616 06324000
         L     @07,GRABRAB5(,@07)                                  1616 06325000
         LA    @07,CNAME+8(,@07)                                   1616 06326000
         ST    @07,RSCKMVAR+4(,REG6)                               1616 06327000
*                        RSCKMVAR(3) = ADDR(CLID);                 1617 06328000
*                                                                  1617 06329000
         LA    @07,@CC00800                                        1617 06330000
         ST    @07,RSCKMVAR+8(,REG6)                               1617 06331000
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR */ 06332000
*                      CALL CKERR;                                 1618 06333000
         L     @15,@CV03449                                        1618 06334000
         BALR  @14,@15                                             1618 06335000
*                      END;                                        1619 06336000
*                    END;                                          1620 06337000
*                                                                  1620 06338000
*        /************************************************************/ 06339000
*        /*                                                          */ 06340000
*        /*       IF AIX READ, PROCESS IT                            */ 06341000
*        /*                                                          */ 06342000
*        /************************************************************/ 06343000
*                                                                  1621 06344000
*                  ELSE                                            1621 06345000
*                    CALL PROCTYPE;                                1621 06346000
         B     @RC01607                                            1621 06347000
@RF01607 BAL   @14,PROCTYPE                                        1621 06348000
*                END;                  /*END AIX RECORD              */ 06349000
@RC01607 DS    0H                                                  1623 06350000
*            END VERYAIX;                                          1623 06351000
*                                                                  1623 06352000
@RF01586 L     @04,RSPTWKC(,REG6)                                  1623 06353000
         LA    @07,1                                               1623 06354000
         L     @04,PTCITNC-1(,@04)                                 1623 06355000
         LA    @04,0(,@04)                                         1623 06356000
         ALR   @07,@04                                             1623 06357000
@DE01581 L     @04,RSPTWKC(,REG6)                                  1623 06358000
         STCM  @07,7,PTCITNC(@04)                                  1623 06359000
         L     @04,RSPTWKF(,REG6)                                  1623 06360000
         L     @04,PTCITL-1(,@04)                                  1623 06361000
         LA    @04,0(,@04)                                         1623 06362000
         CR    @07,@04                                             1623 06363000
         BNH   @DL01581                                            1623 06364000
*        /************************************************************/ 06365000
*        /*                                                          */ 06366000
*        /* MARK ALL VERIFIED DATA & INDEX PAIRS ASSOCIATION CHECKED */ 06367000
*        /*                                                          */ 06368000
*        /************************************************************/ 06369000
*                                                                  1624 06370000
*            PTLOC = PTLOC && PTLOC;                               1624 06371000
         L     @07,RSPTWKC(,REG6)                                  1624 06372000
         XC    PTLOC(20,@07),PTLOC(@07)                            1624 06373000
*            PTLBCITX = PTCITI;        /*SCAN ASSOCIATIONS FRM UPGRAD*/ 06374000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1625 06375000
*            PTLFBAS1 = ON;                                        1626 06376000
*            PTLFBAS2 = ON;                                        1627 06377000
         OI    PTLFBAS1(@07),B'00110000'                           1627 06378000
*            PTF1OK = OFF;                                         1628 06379000
*                                                                  1628 06380000
         NI    PTF1OK(@07),B'11011111'                             1628 06381000
*        /************************************************************/ 06382000
*        /*                                                          */ 06383000
*        /* SCAN FOR THE NEXT ASSOCIATION                            */ 06384000
*        /*                                                          */ 06385000
*        /************************************************************/ 06386000
*                                                                  1629 06387000
*            DO UNTIL(PTLCDIT=0);                                  1629 06388000
@DL01629 DS    0H                                                  1630 06389000
*              CALL LOCDIT;                                        1630 06390000
         BAL   @14,LOCDIT                                          1630 06391000
*              IF (PTLCDIT ^= 0) THEN                              1631 06392000
         L     @07,RSPTWKC(,REG6)                                  1631 06393000
         L     @07,PTLCDIT(,@07)                                   1631 06394000
         LTR   @07,@07                                             1631 06395000
         BZ    @RF01631                                            1631 06396000
*                DO;                                               1632 06397000
*                  RSTANCHR = ADDR(RSGCITS);                       1633 06398000
         LA    @04,RSGCITS(,REG6)                                  1633 06399000
         ST    @04,RSTANCHR(,REG6)                                 1633 06400000
*                  RSTENTIX = PTLCDIT->DITCITAB;                   1634 06401000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1634 06402000
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */ 06403000
*                  CALL GETNEXTE;                                  1635 06404000
         L     @15,@CV03436                                        1635 06405000
         BALR  @14,@15                                             1635 06406000
*                  IF RSTENTAD->CITFAVER = ON THEN                 1636 06407000
         L     @07,RSTENTAD(,REG6)                                 1636 06408000
         TM    CITFAVER(@07),B'01000000'                           1636 06409000
         BNO   @RF01636                                            1636 06410000
*                    PTLCDIT->DITFAVER = ON; /*D|I GOOD - ASSOC CHK  */ 06411000
         L     @07,RSPTWKC(,REG6)                                  1637 06412000
         L     @07,PTLCDIT(,@07)                                   1637 06413000
         OI    DITFAVER(@07),B'01000000'                           1637 06414000
*                END;                                              1638 06415000
@RF01636 DS    0H                                                  1639 06416000
*            END;                                                  1639 06417000
*                                                                  1639 06418000
@RF01631 DS    0H                                                  1639 06419000
@DE01629 L     @07,RSPTWKC(,REG6)                                  1639 06420000
         L     @07,PTLCDIT(,@07)                                   1639 06421000
         LTR   @07,@07                                             1639 06422000
         BNZ   @DL01629                                            1639 06423000
*          END;                        /*END OF VERIFY UPGRADE       */ 06424000
*        /********************ALTERNATEINDEX**************************/ 06425000
*        /*                                                          */ 06426000
*        /*     PROCESS AN ALTERNATEINDEX                            */ 06427000
*        /*       VERIFY THE AIX ASSOCIATIONS                        */ 06428000
*        /*       PROCESS ALL PATHS ON THE AIX                       */ 06429000
*        /*                                                          */ 06430000
*        /************************************************************/ 06431000
*                                                                  1641 06432000
*  VERAIX:                                                         1641 06433000
*        IF TASSID = AIXID THEN                                    1641 06434000
@RF01578 DS    0H                                                  1641 06435000
VERAIX   L     @07,RSPTWKC(,REG6)                                  1641 06436000
         L     @07,PTASSOC(,@07)                                   1641 06437000
         CLI   TASSID(@07),C'G'                                    1641 06438000
         BNE   @RF01641                                            1641 06439000
*          DO;                                                     1642 06440000
*            CALL VERG;             /*VERIFY AIX ASSOCIATIONS     */    06441000
         BAL   @14,VERG                                            1643 06442000
*            IF PTCITF->CITFAVER = ON THEN                         1644 06443000
         L     @07,RSPTWKC(,REG6)                                  1644 06444000
         L     @07,PTCITF(,@07)                                    1644 06445000
         TM    CITFAVER(@07),B'01000000'                           1644 06446000
         BNO   @RF01644                                            1644 06447000
*                                      /*CHECK SUBSETS IF AIX OK     */ 06448000
*                                                                  1645 06449000
*        /************************************************************/ 06450000
*        /*                                                          */ 06451000
*        /*       PROCESS ALL PATHS ON THE ALTERNATEINDEX            */ 06452000
*        /*                                                          */ 06453000
*        /************************************************************/ 06454000
*                                                                  1645 06455000
*  VERGPATH:                                                       1645 06456000
*              DO PTCITNC = PTCITI TO PTCITL;                      1645 06457000
VERGPATH L     @07,RSPTWKC(,REG6)                                  1645 06458000
         L     @07,PTCITI-1(,@07)                                  1645 06459000
         LA    @07,0(,@07)                                         1645 06460000
         B     @DE01645                                            1645 06461000
@DL01645 DS    0H                                                  1646 06462000
*                RSTANCHR = ADDR(RSGCITS); /*SCAN CITABE FOR PATHS   */ 06463000
         LA    @07,RSGCITS(,REG6)                                  1646 06464000
         ST    @07,RSTANCHR(,REG6)                                 1646 06465000
*                RSTENTIX = PTCITNC;                               1647 06466000
         L     @07,RSPTWKC(,REG6)                                  1647 06467000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1647 06468000
*                /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE    */ 06469000
*                CALL GETNEXTE;                                    1648 06470000
         L     @15,@CV03436                                        1648 06471000
         BALR  @14,@15                                             1648 06472000
*                                      /*GET NEXT CITABE             */ 06473000
*                PTCITCUR = RSTENTAD;  /*SAVE CITABE ADDRESS         */ 06474000
*                                                                  1649 06475000
         L     @07,RSPTWKC(,REG6)                                  1649 06476000
         L     @04,RSTENTAD(,REG6)                                 1649 06477000
         ST    @04,PTCITCUR(,@07)                                  1649 06478000
*        /************************************************************/ 06479000
*        /*                                                          */ 06480000
*        /*       PATH FOUND - READ THE PATH RECORD                  */ 06481000
*        /*       IF RECORD INVALID, ISSUE MESSAGE IDC21032I         */ 06482000
*        /*                                                          */ 06483000
*        /************************************************************/ 06484000
*                                                                  1650 06485000
*                IF CITTYPE = PATHID THEN                          1650 06486000
         CLI   CITTYPE(@04),C'R'                                   1650 06487000
         BNE   @RF01650                                            1650 06488000
*                  DO;                                             1651 06489000
*                    IF CITFAINV = OFF THEN                        1652 06490000
         TM    CITFAINV(@04),B'00000010'                           1652 06491000
         BNZ   @RF01652                                            1652 06492000
*                      DO;                                         1653 06493000
*                        RSASSTBL = ADDR(ASSOR); /*PATH ASSOC TABLE  */ 06494000
         LA    @15,ASSOR                                           1654 06495000
         ST    @15,RSASSTBL(,REG6)                                 1654 06496000
*                        PTASSCUR=ADDR(RSASSTBL->TASSEN(1)); /*PATH  */ 06497000
         LA    @15,TASSEN(,@15)                                    1655 06498000
         ST    @15,PTASSCUR(,@07)                                  1655 06499000
*                        GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR */ 06500000
*                                                                  1656 06501000
         L     @14,RSGRABCU(,REG6)                                 1656 06502000
         LH    @15,TASSRAB(,@15)                                   1656 06503000
         SLA   @15,2                                               1656 06504000
         L     @15,RABARRAY-4(@15,@14)                             1656 06505000
         ST    @15,GRABCURR(,@14)                                  1656 06506000
*                        DO;                                       1657 06507000
*                          RSRTYPE = ''B;                          1658 06508000
         MVI   RSRTYPE(REG6),X'00'                                 1658 06509000
*                          RSRGET = ON;      /* GETRCD  */         1659 06510000
         OI    RSRGET(REG6),B'10000000'                            1659 06511000
*                          RSRUPD = ON;      /* UPDATE  */         1660 06512000
         OI    RSRUPD(REG6),B'00001000'                            1660 06513000
*                          RSRDS = ''B;                            1661 06514000
         NI    RSRDS(REG6),B'00011111'                             1661 06515000
*                          RSRWF = ON;       /* WORKFILE  */       1662 06516000
*                          RSRDIR = ON;      /* DIRECT  */         1663 06517000
*                          RSRKEY = ON;      /* KEY  */            1664 06518000
         OI    RSRWF(REG6),B'10010100'                             1664 06519000
*                          RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/ 1665 06520000
         OI    RSVIAFCR(REG6),B'10000000'                          1665 06521000
*                          RSVIACRA = PTCRAVL; /*SET VOLSER */     1666 06522000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       1666 06523000
*                          RSVIACIN = CITCIN; /*SET CI NUMBER */   1667 06524000
*                                                                  1667 06525000
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        1667 06526000
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA 06527000
*                                                                    */ 06528000
*                        CALL GETVIA;                              1668 06529000
         L     @15,@CV03442                                        1668 06530000
         BALR  @14,@15                                             1668 06531000
*                        END;                                      1669 06532000
*                      END;                                        1670 06533000
*                    IF CITFAINV=ON | RABNRF=ON | CITTYPE^=RCDID THEN   06534000
@RF01652 L     @07,RSPTWKC(,REG6)                                  1671 06535000
         L     @07,PTCITCUR(,@07)                                  1671 06536000
         TM    CITFAINV(@07),B'00000010'                           1671 06537000
         BO    @RT01671                                            1671 06538000
         L     @04,RSGRABCU(,REG6)                                 1671 06539000
         L     @04,GRABCURR(,@04)                                  1671 06540000
         TM    RABNRF(@04),B'00000010'                             1671 06541000
         BO    @RT01671                                            1671 06542000
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         1671 06543000
         BE    @RF01671                                            1671 06544000
@RT01671 DS    0H                                                  1672 06545000
*                                      /*NO RCD FOUND OR BAD TYPE    */ 06546000
*                      DO;                                         1672 06547000
*                        RABNRF = OFF; /*RESET NO RCD FOUND          */ 06548000
         L     @07,RSGRABCU(,REG6)                                 1673 06549000
         L     @04,GRABCURR(,@07)                                  1673 06550000
         NI    RABNRF(@04),B'11111101'                             1673 06551000
*                        CITFAINV = ON; /*MARK INVALID               */ 06552000
*                                                                  1674 06553000
         L     @04,RSPTWKC(,REG6)                                  1674 06554000
         L     @04,PTCITCUR(,@04)                                  1674 06555000
         OI    CITFAINV(@04),B'00000010'                           1674 06556000
*                        DO;                                       1675 06557000
*                        /*CALL CKERR*/                            1676 06558000
*                          RSCKERR = RSCKERR && RSCKERR;           1676 06559000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1676 06560000
*                          RSCKERN = RSE042;                       1677 06561000
         MVC   RSCKERN(2,REG6),@CH00971                            1677 06562000
*                          RSCKTERM = 'RETU';                      1678 06563000
         MVC   RSCKTERM(4,REG6),@CC03787                           1678 06564000
*                          RSCKMVAR(1) = ADDR(PATHID);             1679 06565000
         LA    @04,@CC00818                                        1679 06566000
         ST    @04,RSCKMVAR(,REG6)                                 1679 06567000
*                          RSCKMVAR(2) = ADDR(ADDR(GRABRAB1->RABBUF)->C 06568000
*AME);                                                             1680 06569000
         L     @07,GRABRAB1(,@07)                                  1680 06570000
         LA    @07,CNAME+8(,@07)                                   1680 06571000
         ST    @07,RSCKMVAR+4(,REG6)                               1680 06572000
*                          RSCKMVAR(3) = ADDR(AIXID);              1681 06573000
*                                                                  1681 06574000
         LA    @07,@CC00806                                        1681 06575000
         ST    @07,RSCKMVAR+8(,REG6)                               1681 06576000
*                        /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR  06577000
*                                                                    */ 06578000
*                        CALL CKERR;                               1682 06579000
         L     @15,@CV03449                                        1682 06580000
         BALR  @14,@15                                             1682 06581000
*                        END;                                      1683 06582000
*                      END;                                        1684 06583000
*                                                                  1684 06584000
*        /************************************************************/ 06585000
*        /*                                                          */ 06586000
*        /*       IF PATH WAS READ, PROCESS IT                       */ 06587000
*        /*                                                          */ 06588000
*        /************************************************************/ 06589000
*                                                                  1685 06590000
*                    ELSE                                          1685 06591000
*                      CALL PROCTYPE;                              1685 06592000
         B     @RC01671                                            1685 06593000
@RF01671 BAL   @14,PROCTYPE                                        1685 06594000
*                  END;                                            1686 06595000
@RC01671 DS    0H                                                  1687 06596000
*              END VERGPATH;                                       1687 06597000
@RF01650 L     @04,RSPTWKC(,REG6)                                  1687 06598000
         LA    @07,1                                               1687 06599000
         L     @04,PTCITNC-1(,@04)                                 1687 06600000
         LA    @04,0(,@04)                                         1687 06601000
         ALR   @07,@04                                             1687 06602000
@DE01645 L     @04,RSPTWKC(,REG6)                                  1687 06603000
         STCM  @07,7,PTCITNC(@04)                                  1687 06604000
         L     @04,RSPTWKC(,REG6)                                  1687 06605000
         L     @04,PTCITL-1(,@04)                                  1687 06606000
         LA    @04,0(,@04)                                         1687 06607000
         CR    @07,@04                                             1687 06608000
         BNH   @DL01645                                            1687 06609000
*          END;                        /*END OF AIX PROCESSING       */ 06610000
@RF01644 DS    0H                                                  1689 06611000
*                                                                  1689 06612000
*        /**********************GDG BASE******************************/ 06613000
*        /*                                                          */ 06614000
*        /*     PROCESS THE GDG BASE                                 */ 06615000
*        /*       PROCESS ALL GDG DATA SETS                          */ 06616000
*        /*       RECONSTRUCT THE GDG GENLEVELS                      */ 06617000
*        /*                                                          */ 06618000
*        /************************************************************/ 06619000
*                                                                  1689 06620000
*  VERGDG:                                                         1689 06621000
*        IF TASSID = GDGID THEN                                    1689 06622000
@RF01641 DS    0H                                                  1689 06623000
VERGDG   L     @07,RSPTWKC(,REG6)                                  1689 06624000
         L     @07,PTASSOC(,@07)                                   1689 06625000
         CLI   TASSID(@07),C'B'                                    1689 06626000
         BNE   @RF01689                                            1689 06627000
*          /* CALL TO MODULE IDCRS03 FOR PROCEDURE VERB              */ 06628000
*          CALL VERB;                                              1690 06629000
         L     @15,@CV03438                                        1690 06630000
         BALR  @14,@15                                             1690 06631000
*                                      /*VERIFY GDG                  */ 06632000
*        /********************NON-VSAM********************************/ 06633000
*        /*                                                          */ 06634000
*        /*     PROCESS NON-VSAM ENTRIES                             */ 06635000
*        /*       VERIFY ASSOCIATIONS AND ALIASES                    */ 06636000
*        /*                                                          */ 06637000
*        /************************************************************/ 06638000
*                                                                  1691 06639000
*  VERNONV:                                                        1691 06640000
*        IF TASSID=NVID | TASSID=NV THEN                           1691 06641000
@RF01689 DS    0H                                                  1691 06642000
VERNONV  L     @07,RSPTWKC(,REG6)                                  1691 06643000
         L     @07,PTASSOC(,@07)                                   1691 06644000
         CLI   TASSID(@07),C'A'                                    1691 06645000
         BE    @RT01691                                            1691 06646000
         CLI   TASSID(@07),C'3'                                    1691 06647000
         BNE   @RF01691                                            1691 06648000
@RT01691 DS    0H                                                  1692 06649000
*          CALL VERA;               /*VERIFY NON-VSAM             */    06650000
         BAL   @14,VERA                                            1692 06651000
*        /********************USERCATALOG*****************************/ 06652000
*        /*                                                          */ 06653000
*        /*     PROCESS USERCATALOG ENTRIES                          */ 06654000
*        /*       VERIFY ALIASES                                     */ 06655000
*        /*                                                          */ 06656000
*        /************************************************************/ 06657000
*                                                                  1693 06658000
*  VERUCAT:                                                        1693 06659000
*        IF TASSID = UCATID THEN                                   1693 06660000
@RF01691 DS    0H                                                  1693 06661000
VERUCAT  L     @07,RSPTWKC(,REG6)                                  1693 06662000
         L     @07,PTASSOC(,@07)                                   1693 06663000
         CLI   TASSID(@07),C'U'                                    1693 06664000
         BNE   @RF01693                                            1693 06665000
*          CALL VERU;                                              1694 06666000
         BAL   @14,VERU                                            1694 06667000
*        /************************VOLUME******************************/ 06668000
*        /*                                                          */ 06669000
*        /*     PROCESS A VOLUME RECORD                              */ 06670000
*        /*       MARK BASE VERIFIED                                 */ 06671000
*        /*       THIS PROCESS ONLY VERIFIES V-W CONNECTIONS         */ 06672000
*        /*                                                          */ 06673000
*        /************************************************************/ 06674000
*                                                                  1695 06675000
*  VERVOLR:                                                        1695 06676000
*        IF TASSID = VOLID THEN                                    1695 06677000
@RF01693 DS    0H                                                  1695 06678000
VERVOLR  L     @07,RSPTWKC(,REG6)                                  1695 06679000
         L     @04,PTASSOC(,@07)                                   1695 06680000
         CLI   TASSID(@04),C'V'                                    1695 06681000
         BNE   @RF01695                                            1695 06682000
*          DO;                                                     1696 06683000
*                                                                  1696 06684000
*        /************************************************************/ 06685000
*        /*                                                          */ 06686000
*        /*       SCAN FOR ANY BAD EXTENSION RECORDS.                */ 06687000
*        /*       IF ANY INDICATE FAILURE.                           */ 06688000
*        /*                                                          */ 06689000
*        /************************************************************/ 06690000
*                                                                  1697 06691000
*            DO PTCITNC = PTCITI TO PTCITL WHILE (RESVLBAD=OFF);   1697 06692000
         L     @07,PTCITI-1(,@07)                                  1697 06693000
         LA    @07,0(,@07)                                         1697 06694000
         B     @DE01697                                            1697 06695000
@DL01697 L     @07,RSENTPT(,REG6)                                  1697 06696000
         TM    RESVLBAD(@07),B'00010000'                           1697 06697000
         BNZ   @DC01697                                            1697 06698000
*              RSTANCHR = ADDR(RSGCITS);                           1698 06699000
         LA    @07,RSGCITS(,REG6)                                  1698 06700000
         ST    @07,RSTANCHR(,REG6)                                 1698 06701000
*              RSTENTIX = PTCITNC;                                 1699 06702000
         L     @07,RSPTWKC(,REG6)                                  1699 06703000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       1699 06704000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 06705000
*              CALL GETNEXTE;                                      1700 06706000
         L     @15,@CV03436                                        1700 06707000
         BALR  @14,@15                                             1700 06708000
*              IF RSTENTAD->CITFAINV = ON THEN /*INVALID EXTENSION   */ 06709000
         L     @07,RSTENTAD(,REG6)                                 1701 06710000
         TM    CITFAINV(@07),B'00000010'                           1701 06711000
         BNO   @RF01701                                            1701 06712000
*                DO;                                               1702 06713000
*                  RESVLBAD = ON;      /*FLAG THIS VOL AS BAD        */ 06714000
         L     @07,RSENTPT(,REG6)                                  1703 06715000
         OI    RESVLBAD(@07),B'00010000'                           1703 06716000
*                  RSBADVOL = ON;      /*INDICATE A BAD VOL          */ 06717000
         OI    RSBADVOL(REG6),B'00000010'                          1704 06718000
*                END;                                              1705 06719000
*            END;                                                  1706 06720000
*                                                                  1706 06721000
@RF01701 L     @04,RSPTWKC(,REG6)                                  1706 06722000
         LA    @07,1                                               1706 06723000
         L     @04,PTCITNC-1(,@04)                                 1706 06724000
         LA    @04,0(,@04)                                         1706 06725000
         ALR   @07,@04                                             1706 06726000
@DE01697 L     @04,RSPTWKC(,REG6)                                  1706 06727000
         STCM  @07,7,PTCITNC(@04)                                  1706 06728000
         L     @04,RSPTWKC(,REG6)                                  1706 06729000
         L     @04,PTCITL-1(,@04)                                  1706 06730000
         LA    @04,0(,@04)                                         1706 06731000
         CR    @07,@04                                             1706 06732000
         BNH   @DL01697                                            1706 06733000
@DC01697 DS    0H                                                  1707 06734000
*        /************************************************************/ 06735000
*        /*                                                          */ 06736000
*        /*       MARK THE VOLUME RECORD AS VERIFIED TO RECOVER      */ 06737000
*        /*       AS MUCH AS POSSIBLE.                               */ 06738000
*        /*                                                          */ 06739000
*        /************************************************************/ 06740000
*                                                                  1707 06741000
*            PTCITF->CITFAVER = ON;    /*MARK VOL VERIFIED           */ 06742000
         L     @07,RSPTWKC(,REG6)                                  1707 06743000
         L     @07,PTCITF(,@07)                                    1707 06744000
         OI    CITFAVER(@07),B'01000000'                           1707 06745000
*          END;                                                    1708 06746000
*                                                                  1708 06747000
*                                                                  1708 06748000
*        IF GDTDBG = NULLPTR                                       1709 06749000
*          THEN;                                                   1709 06750000
@RF01695 L     @07,GDTDBG(,REG5)                                   1709 06751000
         LTR   @07,@07                                             1709 06752000
         BZ    @RT01709                                            1709 06753000
*          ELSE                                                    1711 06754000
*            CALL IDCDB010(GDTTBL,'RSV3');                         1711 06755000
*                                                                  1711 06756000
         ST    REG5,@AL00001                                       1711 06757000
         LA    @07,@CC03881                                        1711 06758000
         ST    @07,@AL00001+4                                      1711 06759000
         MVI   @AL00001+4,X'80'                                    1711 06760000
         L     @15,GDTDBG(,REG5)                                   1711 06761000
         LA    @01,@AL00001                                        1711 06762000
         BALR  @14,@15                                             1711 06763000
*        RFY TASSO;                    /*REVERT                      */ 06764000
@RT01709 DS    0H                                                  1713 06765000
* CALL EXIT;  /*TERMINATE*/                                        1713 06766000
         BAL   @14,EXIT                                            1713 06767000
* END VERCI; /*END OF PROCEDURE*/                                  1714 06768000
@EL00011 DS    0H                                                  1714 06769000
@EF00011 DS    0H                                                  1714 06770000
@ER00011 BR    @14                                                 1714 06771000
@PB00011 DS    0H                                                  1715 06772000
*/********************************************************************/ 06773000
*/*                                                                  */ 06774000
*/* PROCEDURE - VERDSDIR                                             */ 06775000
*/*                                                                  */ 06776000
*/* FUNCTION -                                                       */ 06777000
*/*     VERDSDIR VERIFIES DATA SET DIRECTORY ENTRIES(DSDIRS).        */ 06778000
*/*     FOR EACH RESET CLUSTER OR ALTERNATEINDEX, ALL VOLUMES ON     */ 06779000
*/*     WHICH THEY CLAIM SPACE ARE CHECKED FOR MATCHING DSDIRS.      */ 06780000
*/*                                                                  */ 06781000
*/*     FOR EACH NON-RESET CLUSTER AND ALTERNATEINDEX, ALL RESET     */ 06782000
*/*     VOLUMES ON WHICH THEY CLAIM SPACE ARE CHECKED FOR MATCHING   */ 06783000
*/*     DSDIRS.                                                      */ 06784000
*/*                                                                  */ 06785000
*/*     IF A DSDIR MATCH FAILS, THE VOLUME GROUP OCCURRENCE IS       */ 06786000
*/*     MARKED UNUSABLE AND THE BASE RECORD IS FLAGGED FOR NO        */ 06787000
*/*     UPDATE.                                                      */ 06788000
*/*                                                                  */ 06789000
*/* INPUT -                                                          */ 06790000
*/*    CI TABLE AND DI TABLE FOR THE CLUSTER OR AIX                  */ 06791000
*/*                                                                  */ 06792000
*/* OUTPUT -                                                         */ 06793000
*/*     WORKFILE RECORDS MARKED UNUSABLE PER THE FUNCTION.           */ 06794000
*/*     RSWDSDIR - FLAGGED ON IN EACH DATA OR INDEX PROCESSED.       */ 06795000
*/*                                                                  */ 06796000
*/* MESSAGES -                                                       */ 06797000
*/*     IDC21030I - INVALID SPACE DESCRIPTION                        */ 06798000
*/*                                                                  */ 06799000
*/********************************************************************/ 06800000
*      GENERATE;                                                   1715 06801000
         DS    0F                                                       06802000
NAME0183 DC    CL8'VERDSDIR'                                            06803000
*VERDSDIR: PROCEDURE                                               1716 06804000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1716 06805000
*                                                                  1716 06806000
         B     @PB00012                                            1716 06807000
VERDSDIR DS    0H                                                  1717 06808000
*      GENERATE REFS(RS02RG08, REG6);                              1717 06809000
*                                                                  1717 06810000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          06811000
         LR    @15,@13  OLD SAVE AREA                                   06812000
         LA    @13,72(@13)  NEW SAVE AREA                               06813000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     06814000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        06815000
         MVC   0(4,@15),NAME0183  PROCNAME TO REGSAVE                   06816000
*        OLDERID2 = NEWERID2;                                      1718 06817000
         L     @07,GDTTR2(,REG5)                                   1718 06818000
         MVC   @TS00001(95),NEWERID2(@07)                          1718 06819000
         MVC   OLDERID2(95,@07),@TS00001                           1718 06820000
*        NEWID2 = 'RSVE';                                          1719 06821000
*                                                                  1719 06822000
         MVC   NEWID2(4,@07),@CC03852                              1719 06823000
*        RFY TASSO BASED(PTASSOC);                                 1720 06824000
*                                                                  1720 06825000
*        /************************************************************/ 06826000
*        /*                                                          */ 06827000
*        /* ASSUME CATALOG CLUSTER IS FINE FOR THIS CHECK            */ 06828000
*        /*                                                          */ 06829000
*        /************************************************************/ 06830000
*                                                                  1721 06831000
*        IF PTCITF->CITCIN = CLUSCI THEN;                          1721 06832000
*                                                                  1721 06833000
         L     @07,RSPTWKC(,REG6)                                  1721 06834000
         L     @07,PTCITF(,@07)                                    1721 06835000
         CLC   CITCIN(3,@07),@CF00149+1                            1721 06836000
         BE    @RT01721                                            1721 06837000
*        /************************************************************/ 06838000
*        /*                                                          */ 06839000
*        /* FREE POSSIBLE EXTENSION RECORD FOR MODGO                 */ 06840000
*        /*                                                          */ 06841000
*        /************************************************************/ 06842000
*                                                                  1723 06843000
*        ELSE                                                      1723 06844000
*  VERDSD:                                                         1723 06845000
*          DO;                                                     1723 06846000
VERDSD   DS    0H                                                  1724 06847000
*            GRABCURR = RABARRAY(EXTRAB);                          1724 06848000
*                                                                  1724 06849000
         L     @07,RSGRABCU(,REG6)                                 1724 06850000
         L     @04,RABARRAY+12(,@07)                               1724 06851000
         ST    @04,GRABCURR(,@07)                                  1724 06852000
*            DO;                                                   1725 06853000
*              RSRTYPE = ''B;                                      1726 06854000
         MVI   RSRTYPE(REG6),X'00'                                 1726 06855000
*              RSRFREE = ON;     /* FREERCD  */                    1727 06856000
         OI    RSRFREE(REG6),B'00000001'                           1727 06857000
*              RSRUPD = ON;      /* UPDATE  */                     1728 06858000
         OI    RSRUPD(REG6),B'00001000'                            1728 06859000
*              RSRDS = ''B;                                        1729 06860000
         NI    RSRDS(REG6),B'00011111'                             1729 06861000
*              RSRWF = ON;       /* WORKFILE  */                   1730 06862000
*              RSRDIR = ON;      /* DIRECT  */                     1731 06863000
*              RSRKEY = ON;      /* KEY  */                        1732 06864000
*                                                                  1732 06865000
         OI    RSRWF(REG6),B'10010100'                             1732 06866000
*            /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT         */ 06867000
*            CALL RECMGMT;                                         1733 06868000
         L     @15,@CV03458                                        1733 06869000
         BALR  @14,@15                                             1733 06870000
*              RFY RTNREG RSTD;                                    1734 06871000
*              TESTRC = RTNREG;                                    1735 06872000
         STH   RTNREG,TESTRC(,REG6)                                1735 06873000
*              RFY RTNREG UNRSTD;                                  1736 06874000
*            END;                                                  1737 06875000
*                                                                  1737 06876000
*        /************************************************************/ 06877000
*        /*                                                          */ 06878000
*        /* FOR BOTH DATA AND INDEX (IF IT EXISTS), FIND ALL         */ 06879000
*        /* VOLUME GROUP OCCURRENCES.                                */ 06880000
*        /*                                                          */ 06881000
*        /************************************************************/ 06882000
*                                                                  1738 06883000
*            PTVALL = PTVALL && PTVALL; /*CLEAR D-I INFORMATION      */ 06884000
         L     @07,RSPTWKC(,REG6)                                  1738 06885000
         XC    PTVALL(24,@07),PTVALL(@07)                          1738 06886000
*            PTF1OK = ON;              /*ASSUME D-I OK               */ 06887000
         OI    PTF1OK(@07),B'00100000'                             1739 06888000
*            PTVCNT = 1;               /*ASSUME ESDS OR RRDS FORMAT  */ 06889000
         MVC   PTVCNT(2,@07),@CH00212                              1740 06890000
*  VERDSDSN:                                                       1741 06891000
*            DO PTINDX3 = 1 TO 2 WHILE(PTF1OK=ON);                 1741 06892000
*                                                                  1741 06893000
VERDSDSN LA    @07,1                                               1741 06894000
         L     @04,RSPTWKC(,REG6)                                  1741 06895000
         STH   @07,PTINDX3(,@04)                                   1741 06896000
@DL01741 L     @07,RSPTWKC(,REG6)                                  1741 06897000
         TM    PTF1OK(@07),B'00100000'                             1741 06898000
         BNO   @DC01741                                            1741 06899000
*        /************************************************************/ 06900000
*        /*                                                          */ 06901000
*        /*     LOCATE THE DATA OR INDEX ASSOCIATION ON THE          */ 06902000
*        /*     CLUSTER OR AIX.                                      */ 06903000
*        /*                                                          */ 06904000
*        /************************************************************/ 06905000
*                                                                  1742 06906000
*              PTLOC = PTLOC && PTLOC;                             1742 06907000
         XC    PTLOC(20,@07),PTLOC(@07)                            1742 06908000
*              PTLBCITX = PTCITI;                                  1743 06909000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1743 06910000
*              PTLSN = PTINDX3;        /*1ST OR 2ND ASSOCIATION      */ 06911000
         LH    @04,PTINDX3(,@07)                                   1744 06912000
         STH   @04,PTLSN(,@07)                                     1744 06913000
*              PTLFBAS1 = ON;          /*ASSOCIATION SCAN            */ 06914000
         OI    PTLFBAS1(@07),B'00100000'                           1745 06915000
*              CALL LOCDIT;                                        1746 06916000
*                                                                  1746 06917000
         BAL   @14,LOCDIT                                          1746 06918000
*        /************************************************************/ 06919000
*        /*                                                          */ 06920000
*        /*     NO VOLUME CHECKING IF NOT DATA OR INDEX              */ 06921000
*        /*                                                          */ 06922000
*        /************************************************************/ 06923000
*                                                                  1747 06924000
*              IF PTLCDIT = 0 THEN                                 1747 06925000
         L     @07,RSPTWKC(,REG6)                                  1747 06926000
         L     @04,PTLCDIT(,@07)                                   1747 06927000
         LTR   @04,@04                                             1747 06928000
         BNZ   @RF01747                                            1747 06929000
*                PTF1OK = OFF;                                     1748 06930000
*                                                                  1748 06931000
         NI    PTF1OK(@07),B'11011111'                             1748 06932000
*        /************************************************************/ 06933000
*        /*                                                          */ 06934000
*        /*     ENSURE ASSOCIATION FOR DATA OR INDEX                 */ 06935000
*        /*                                                          */ 06936000
*        /************************************************************/ 06937000
*                                                                  1749 06938000
*              ELSE                                                1749 06939000
*                DO;                                               1749 06940000
         B     @RC01747                                            1749 06941000
@RF01747 DS    0H                                                  1750 06942000
*                  RSTANCHR = ADDR(RSGCITS); /*SCAN OF CITABLE       */ 06943000
         LA    @07,RSGCITS(,REG6)                                  1750 06944000
         ST    @07,RSTANCHR(,REG6)                                 1750 06945000
*                  RSTENTIX = PTLCDIT->DITCITAB; /*FIND D-I CITABE   */ 06946000
         L     @07,RSPTWKC(,REG6)                                  1751 06947000
         L     @07,PTLCDIT(,@07)                                   1751 06948000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1751 06949000
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */ 06950000
*                  CALL GETNEXTE;                                  1752 06951000
         L     @15,@CV03436                                        1752 06952000
         BALR  @14,@15                                             1752 06953000
*                  PTCITCUR = RSTENTAD; /*CITABE ADDR FOR READ       */ 06954000
         L     @07,RSPTWKC(,REG6)                                  1753 06955000
         L     @04,RSTENTAD(,REG6)                                 1753 06956000
         ST    @04,PTCITCUR(,@07)                                  1753 06957000
*                  PTVDICIT(PTINDX3) = RSTENTAD; /*SAVE FOR VGO SCAN */ 06958000
*                                                                  1754 06959000
         LH    @15,PTINDX3(,@07)                                   1754 06960000
         LR    @14,@15                                             1754 06961000
         MH    @14,@CH00032                                        1754 06962000
         ST    @04,PTVDICIT-12(@14,@07)                            1754 06963000
*                  IF PTINDX3 = 1 THEN /*1ST ASSOC MUST BE DATA      */ 06964000
         C     @15,@CF00212                                        1755 06965000
         BNE   @RF01755                                            1755 06966000
*                    IF CITTYPE ^= DATAID THEN                     1756 06967000
         CLI   CITTYPE(@04),C'D'                                   1756 06968000
         BE    @RF01756                                            1756 06969000
*                      PTF1OK = OFF;   /*ERROR IF NOT DATA           */ 06970000
         NI    PTF1OK(@07),B'11011111'                             1757 06971000
*                    ELSE;                                         1758 06972000
@RF01756 DS    0H                                                  1759 06973000
*                  ELSE                                            1759 06974000
*                    IF CITTYPE ^= INDEXID THEN                    1759 06975000
         B     @RC01755                                            1759 06976000
@RF01755 L     @07,RSPTWKC(,REG6)                                  1759 06977000
         L     @04,PTCITCUR(,@07)                                  1759 06978000
         CLI   CITTYPE(@04),C'I'                                   1759 06979000
         BE    @RF01759                                            1759 06980000
*                      PTF1OK = OFF;   /*NOT KSDS                    */ 06981000
*                                                                  1760 06982000
         NI    PTF1OK(@07),B'11011111'                             1760 06983000
*        /************************************************************/ 06984000
*        /*                                                          */ 06985000
*        /*     PROCEED FOR DATA OR INDEX - GET BUFFER ADDRESS       */ 06986000
*        /*                                                          */ 06987000
*        /************************************************************/ 06988000
*                                                                  1761 06989000
*                  IF PTF1OK = OFF THEN;                           1761 06990000
@RF01759 DS    0H                                                  1761 06991000
@RC01755 L     @07,RSPTWKC(,REG6)                                  1761 06992000
         TM    PTF1OK(@07),B'00100000'                             1761 06993000
         BZ    @RT01761                                            1761 06994000
*                  ELSE                                            1763 06995000
*                    DO;                                           1763 06996000
*                      PTASSCUR = ADDR(TASSEN(1)); /*FIRST ASSOC ENT */ 06997000
         L     @07,RSPTWKC(,REG6)                                  1764 06998000
         L     @04,PTASSOC(,@07)                                   1764 06999000
         LA    @04,TASSEN(,@04)                                    1764 07000000
         ST    @04,PTASSCUR(,@07)                                  1764 07001000
*                      DO PTINDX4 = 1 TO TASSNENT                  1765 07002000
*                       WHILE(TASSTYPE^=CITTYPE);                  1765 07003000
         LA    @07,1                                               1765 07004000
         B     @DE01765                                            1765 07005000
@DL01765 L     @07,RSPTWKC(,REG6)                                  1765 07006000
         L     @04,PTASSCUR(,@07)                                  1765 07007000
         L     @01,PTCITCUR(,@07)                                  1765 07008000
         CLC   TASSTYPE(1,@04),CITTYPE(@01)                        1765 07009000
         BE    @DC01765                                            1765 07010000
*                        PTASSCUR = PTASSCUR + LENGTH(TASSEN);     1766 07011000
         AL    @04,@CF00038                                        1766 07012000
         ST    @04,PTASSCUR(,@07)                                  1766 07013000
*                                      /*ADDR OF NEXT ASSOC ENTRY    */ 07014000
*                      END;                                        1767 07015000
*                                                                  1767 07016000
         L     @04,RSPTWKC(,REG6)                                  1767 07017000
         LA    @07,1                                               1767 07018000
         AH    @07,PTINDX4(,@04)                                   1767 07019000
@DE01765 L     @04,RSPTWKC(,REG6)                                  1767 07020000
         STH   @07,PTINDX4(,@04)                                   1767 07021000
         L     @04,RSPTWKC(,REG6)                                  1767 07022000
         L     @04,PTASSOC(,@04)                                   1767 07023000
         CH    @07,TASSNENT(,@04)                                  1767 07024000
         BNH   @DL01765                                            1767 07025000
@DC01765 DS    0H                                                  1768 07026000
*        /************************************************************/ 07027000
*        /*                                                          */ 07028000
*        /*     GET DATA OR INDEX RECORD                             */ 07029000
*        /*                                                          */ 07030000
*        /************************************************************/ 07031000
*                                                                  1768 07032000
*                      GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR   */ 07033000
*                                                                  1768 07034000
         L     @07,RSGRABCU(,REG6)                                 1768 07035000
         L     @04,RSPTWKC(,REG6)                                  1768 07036000
         L     @01,PTASSCUR(,@04)                                  1768 07037000
         LH    @15,TASSRAB(,@01)                                   1768 07038000
         SLA   @15,2                                               1768 07039000
         L     @15,RABARRAY-4(@15,@07)                             1768 07040000
         ST    @15,GRABCURR(,@07)                                  1768 07041000
*                      DO;                                         1769 07042000
*                        RSRTYPE = ''B;                            1770 07043000
         MVI   RSRTYPE(REG6),X'00'                                 1770 07044000
*                        RSRGET = ON;      /* GETRCD  */           1771 07045000
         OI    RSRGET(REG6),B'10000000'                            1771 07046000
*                        RSRUPD = ON;      /* UPDATE  */           1772 07047000
         OI    RSRUPD(REG6),B'00001000'                            1772 07048000
*                        RSRDS = ''B;                              1773 07049000
         NI    RSRDS(REG6),B'00011111'                             1773 07050000
*                        RSRWF = ON;       /* WORKFILE  */         1774 07051000
*                        RSRDIR = ON;      /* DIRECT  */           1775 07052000
*                        RSRKEY = ON;      /* KEY  */              1776 07053000
         OI    RSRWF(REG6),B'10010100'                             1776 07054000
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   1777 07055000
         OI    RSVIAFCR(REG6),B'10000000'                          1777 07056000
*                        RSVIACRA = PTCRAVL; /*SET VOLSER */       1778 07057000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@04)                       1778 07058000
*                        RSVIACIN = CITCIN; /*SET CI NUMBER */     1779 07059000
*                                                                  1779 07060000
         L     @07,PTCITCUR(,@04)                                  1779 07061000
         MVC   RSVIACIN(3,REG6),CITCIN(@07)                        1779 07062000
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/ 07063000
*                      CALL GETVIA;                                1780 07064000
         L     @15,@CV03442                                        1780 07065000
         BALR  @14,@15                                             1780 07066000
*                      END;                                        1781 07067000
*                                                                  1781 07068000
*        /************************************************************/ 07069000
*        /*                                                          */ 07070000
*        /*     NO RECORD FOUND POSSIBLE FOR BAD NON-RESET           */ 07071000
*        /*     DATA OR INDEX                                        */ 07072000
*        /*                                                          */ 07073000
*        /************************************************************/ 07074000
*                                                                  1782 07075000
*                      IF RABNRF = ON THEN                         1782 07076000
         L     @07,RSGRABCU(,REG6)                                 1782 07077000
         L     @07,GRABCURR(,@07)                                  1782 07078000
         TM    RABNRF(@07),B'00000010'                             1782 07079000
         BNO   @RF01782                                            1782 07080000
*                        DO;                                       1783 07081000
*                          RABNRF = OFF; /*RESET NO RCD FOUND        */ 07082000
         NI    RABNRF(@07),B'11111101'                             1784 07083000
*                          PTF1OK = OFF; /*NO PROCESSING             */ 07084000
         L     @07,RSPTWKC(,REG6)                                  1785 07085000
         NI    PTF1OK(@07),B'11011111'                             1785 07086000
*                        END;                                      1786 07087000
*                                                                  1786 07088000
*        /************************************************************/ 07089000
*        /*                                                          */ 07090000
*        /*     FIND ALL VOLUME GROUP OCCURRENCES                    */ 07091000
*        /*                                                          */ 07092000
*        /************************************************************/ 07093000
*                                                                  1787 07094000
*                      ELSE                                        1787 07095000
*                        DO;                                       1787 07096000
         B     @RC01782                                            1787 07097000
@RF01782 DS    0H                                                  1788 07098000
*                          PTVDIASS(PTINDX3) = PTASSCUR; /* ASSOC ENT*/ 07099000
         L     @07,RSPTWKC(,REG6)                                  1788 07100000
         LH    @04,PTINDX3(,@07)                                   1788 07101000
         MH    @04,@CH00032                                        1788 07102000
         L     @15,PTASSCUR(,@07)                                  1788 07103000
         ST    @15,PTVDIASS-12(@04,@07)                            1788 07104000
*                                      /*THS ENT NON-ZERO FR RCD READ*/ 07105000
*                                                                  1789 07106000
*                          DO;                                     1789 07107000
*                            GRABBB = GRABCURR;                    1790 07108000
         L     @07,RSGRABCU(,REG6)                                 1790 07109000
         L     @04,GRABCURR(,@07)                                  1790 07110000
         ST    @04,GRABBB(,@07)                                    1790 07111000
*                            RSWGCODE = GCVOLGO;                   1791 07112000
         MVI   RSWGCODE(REG6),X'03'                                1791 07113000
*                                      /*SPECIFY GROUP CODE          */ 07114000
*                            RSWFONE = OFF;                        1792 07115000
         NI    RSWFONE(REG6),B'01111111'                           1792 07116000
*                                      /*FIND ALL OCCURRENCES        */ 07117000
*                            /* CALL THE FIND SUBROUTINE */        1793 07118000
*                                                                  1793 07119000
*                          /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND 07120000
*                                                                    */ 07121000
*                          CALL FIND;                              1793 07122000
         L     @15,@CV03441                                        1793 07123000
         BALR  @14,@15                                             1793 07124000
*                          END;                                    1794 07125000
*                          PTVDISNT(PTINDX3) = RSWASNVT;           1795 07126000
         L     @07,RSPTWKC(,REG6)                                  1795 07127000
         LH    @04,PTINDX3(,@07)                                   1795 07128000
         MH    @04,@CH00032                                        1795 07129000
         L     @15,RSWASNVT(,REG6)                                 1795 07130000
         ST    @15,PTVDISNT-12(@04,@07)                            1795 07131000
*                                      /*SAVE SN VECTOR TABLE        */ 07132000
*                          IF RSFENTLN = 0 THEN /*NO ENTRIES         */ 07133000
         CLI   RSFENTLN(@15),0                                     1796 07134000
         BNE   @RF01796                                            1796 07135000
*                            PTVDISNT(PTINDX3) = 0;                1797 07136000
         SLR   @15,@15                                             1797 07137000
         ST    @15,PTVDISNT-12(@04,@07)                            1797 07138000
*                        END;                                      1798 07139000
@RF01796 DS    0H                                                  1799 07140000
*                    END;                                          1799 07141000
@RC01782 DS    0H                                                  1800 07142000
*                END;                                              1800 07143000
@RT01761 DS    0H                                                  1801 07144000
*            END VERDSDSN;                                         1801 07145000
@RC01747 L     @04,RSPTWKC(,REG6)                                  1801 07146000
         LA    @07,1                                               1801 07147000
         AH    @07,PTINDX3(,@04)                                   1801 07148000
         L     @04,RSPTWKC(,REG6)                                  1801 07149000
         STH   @07,PTINDX3(,@04)                                   1801 07150000
         C     @07,@CF00149                                        1801 07151000
         BNH   @DL01741                                            1801 07152000
@DC01741 DS    0H                                                  1802 07153000
*        /************************************************************/ 07154000
*        /*                                                          */ 07155000
*        /* FOR EACH VOLUME IN DATA AND INDEX, ENSURE THAT           */ 07156000
*        /* A DATA SET DIRECTORY EXISTES FOR ALL CLAIMS ON A RESET   */ 07157000
*        /* VOLUME OR, ON ANY VOLUME BY A RESET DATA OR INDEX.       */ 07158000
*        /*                                                          */ 07159000
*        /************************************************************/ 07160000
*                                                                  1802 07161000
*            DO PTINDX3 = 1 TO 2;                                  1802 07162000
*                                                                  1802 07163000
         LA    @07,1                                               1802 07164000
         L     @04,RSPTWKC(,REG6)                                  1802 07165000
         STH   @07,PTINDX3(,@04)                                   1802 07166000
@DL01802 DS    0H                                                  1803 07167000
*        /************************************************************/ 07168000
*        /*                                                          */ 07169000
*        /*     NO SN TABLE - NO VOLUMES                             */ 07170000
*        /*                                                          */ 07171000
*        /************************************************************/ 07172000
*                                                                  1803 07173000
*             RSWASNVT = PTVDISNT(PTINDX3);  /*SET D-I VGO SNTABLE   */ 07174000
         L     @07,RSPTWKC(,REG6)                                  1803 07175000
         LH    @04,PTINDX3(,@07)                                   1803 07176000
         MH    @04,@CH00032                                        1803 07177000
         L     @07,PTVDISNT-12(@04,@07)                            1803 07178000
         ST    @07,RSWASNVT(,REG6)                                 1803 07179000
*             IF RSWASNVT=0 THEN;                                  1804 07180000
*                                                                  1804 07181000
         LTR   @07,@07                                             1804 07182000
         BZ    @RT01804                                            1804 07183000
*        /************************************************************/ 07184000
*        /*                                                          */ 07185000
*        /*     CHECK EACH VOLUME GROUP OCCURRENCE                   */ 07186000
*        /*                                                          */ 07187000
*        /************************************************************/ 07188000
*                                                                  1806 07189000
*             ELSE                                                 1806 07190000
* VERVOLGO:                                                        1806 07191000
*              DO;                                                 1806 07192000
VERVOLGO DS    0H                                                  1807 07193000
*                GRABCURR = RABARRAY(PTVDIASS(PTINDX3)->TASSRAB);  1807 07194000
         L     @07,RSGRABCU(,REG6)                                 1807 07195000
         L     @04,RSPTWKC(,REG6)                                  1807 07196000
         LH    @15,PTINDX3(,@04)                                   1807 07197000
         MH    @15,@CH00032                                        1807 07198000
         L     @04,PTVDIASS-12(@15,@04)                            1807 07199000
         LH    @04,TASSRAB(,@04)                                   1807 07200000
         SLA   @04,2                                               1807 07201000
         L     @04,RABARRAY-4(@04,@07)                             1807 07202000
         ST    @04,GRABCURR(,@07)                                  1807 07203000
*                                      /*CURR BFR ADDR FOR MARKUNUS  */ 07204000
*                DO RSFCNDX = 1 TO RSFHNDX;                        1808 07205000
         LA    @07,1                                               1808 07206000
         B     @DE01808                                            1808 07207000
@DL01808 DS    0H                                                  1809 07208000
*                  RSFAENT = RSFCADR + RSFENTLN * (RSFCNDX - 1);   1809 07209000
         L     @07,RSWASNVT(,REG6)                                 1809 07210000
         LH    @04,RSFCNDX(,@07)                                   1809 07211000
         BCTR  @04,0                                               1809 07212000
         LR    @01,@04                                             1809 07213000
         SLR   @04,@04                                             1809 07214000
         IC    @04,RSFENTLN(,@07)                                  1809 07215000
         MR    @00,@04                                             1809 07216000
         AL    @01,RSFCADR(,@07)                                   1809 07217000
         ST    @01,RSFAENT(,@07)                                   1809 07218000
*                                      /*GET VGO SNTAB               */ 07219000
*                                                                  1810 07220000
*        /************************************************************/ 07221000
*        /*                                                          */ 07222000
*        /*     IF ALREADY UNUSABLE OR ALREADY PROCESSED - IGNORE IT */ 07223000
*        /*                                                          */ 07224000
*        /************************************************************/ 07225000
*                                                                  1810 07226000
*                  IF SDSDIRSN = 0 | SNFPROC = ON THEN;            1810 07227000
*                                                                  1810 07228000
         ICM   @07,3,SDSDIRSN(@01)                                 1810 07229000
         BZ    @RT01810                                            1810 07230000
         TM    SNFPROC(@01),B'00010000'                            1810 07231000
         BO    @RT01810                                            1810 07232000
*        /************************************************************/ 07233000
*        /*                                                          */ 07234000
*        /*     LOCATE THE VOLUME RECORD FOR THIS VOLUME             */ 07235000
*        /*                                                          */ 07236000
*        /************************************************************/ 07237000
*                                                                  1812 07238000
*                  ELSE                                            1812 07239000
*                   DO;                                            1812 07240000
*                    PTF1CKVL = OFF;   /*ASSUME NO VOL CHECKING      */ 07241000
         L     @07,RSPTWKC(,REG6)                                  1813 07242000
         NI    PTF1CKVL(@07),B'11110111'                           1813 07243000
*                    RSASDSDI = OFF;   /*ASSUME NO DSDIR             */ 07244000
         NI    RSASDSDI(REG6),B'10111111'                          1814 07245000
*                    RSCRVL = ADDR(SNVOLSER);                      1815 07246000
         L     @07,RSWASNVT(,REG6)                                 1815 07247000
         L     @07,RSFAENT(,@07)                                   1815 07248000
         LA    @07,SNVOLSER(,@07)                                  1815 07249000
         ST    @07,RSCRVL(,REG6)                                   1815 07250000
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNVLST */ 07251000
*                    CALL IDCRS5SV(RSVTBENT,RSCRVL);               1816 07252000
         LA    @07,RSVTBENT(,REG6)                                 1816 07253000
         ST    @07,@AL00001                                        1816 07254000
         LA    @07,RSCRVL(,REG6)                                   1816 07255000
         ST    @07,@AL00001+4                                      1816 07256000
         L     @15,@CV03444                                        1816 07257000
         LA    @01,@AL00001                                        1816 07258000
         BALR  @14,@15                                             1816 07259000
*                    IF RSVTBENT = 0 THEN /*NO VOLUME RECORD         */ 07260000
         L     @07,RSVTBENT(,REG6)                                 1817 07261000
         LTR   @07,@07                                             1817 07262000
         BNZ   @RF01817                                            1817 07263000
*                      IF TASSID = CLID | TASSID = AIXID THEN      1818 07264000
         L     @07,RSPTWKC(,REG6)                                  1818 07265000
         L     @07,PTASSOC(,@07)                                   1818 07266000
         CLI   TASSID(@07),C'C'                                    1818 07267000
         BE    @RT01818                                            1818 07268000
         CLI   TASSID(@07),C'G'                                    1818 07269000
         BNE   @RF01818                                            1818 07270000
@RT01818 DS    0H                                                  1819 07271000
*                                      /*MARK RESET C OR G UNUSABLE  */ 07272000
*                        /* CALL TO MODULE IDCRS03 FOR PROCEDURE MARKUN 07273000
*S                                                                   */ 07274000
*                        CALL MARKUNUS;                            1819 07275000
         L     @15,@CV03431                                        1819 07276000
         BALR  @14,@15                                             1819 07277000
*                      ELSE;           /*IGNORE NON-RESET ERROR      */ 07278000
*                                                                  1820 07279000
@RF01818 DS    0H                                                  1821 07280000
*        /************************************************************/ 07281000
*        /*                                                          */ 07282000
*        /*     FOR NON-RESET CLUSTER OR AIX, CHECK ONLY RESET       */ 07283000
*        /*     VOLUMES FOR MATCHING DSDIRS                          */ 07284000
*        /*                                                          */ 07285000
*        /************************************************************/ 07286000
*                                                                  1821 07287000
*                    ELSE                                          1821 07288000
*                      IF TASSID = CLNR | TASSID = AIXNR THEN      1821 07289000
         B     @RC01817                                            1821 07290000
@RF01817 L     @07,RSPTWKC(,REG6)                                  1821 07291000
         L     @07,PTASSOC(,@07)                                   1821 07292000
         CLI   TASSID(@07),C'1'                                    1821 07293000
         BE    @RT01821                                            1821 07294000
         CLI   TASSID(@07),C'2'                                    1821 07295000
         BNE   @RF01821                                            1821 07296000
@RT01821 DS    0H                                                  1822 07297000
*                        DO;                                       1822 07298000
*                          /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNR 07299000
*ST                                                                  */ 07300000
*                          CALL IDCRS5SR('V','A',RSENTPT,RSCRVL);  1823 07301000
         LA    @07,@CC00828                                        1823 07302000
         ST    @07,@AL00001                                        1823 07303000
         LA    @07,@CC00808                                        1823 07304000
         ST    @07,@AL00001+4                                      1823 07305000
         LA    @07,RSENTPT(,REG6)                                  1823 07306000
         ST    @07,@AL00001+8                                      1823 07307000
         LA    @07,RSCRVL(,REG6)                                   1823 07308000
         ST    @07,@AL00001+12                                     1823 07309000
         L     @15,@CV03445                                        1823 07310000
         LA    @01,@AL00001                                        1823 07311000
         BALR  @14,@15                                             1823 07312000
*                          IF RSENTPT ^= 0 THEN                    1824 07313000
         L     @07,RSENTPT(,REG6)                                  1824 07314000
         LTR   @07,@07                                             1824 07315000
         BZ    @RF01824                                            1824 07316000
*                            PTF1CKVL=ON; /*CHECK VGO                */ 07317000
         L     @07,RSPTWKC(,REG6)                                  1825 07318000
         OI    PTF1CKVL(@07),B'00001000'                           1825 07319000
*                        END;                                      1826 07320000
*                                                                  1826 07321000
*        /************************************************************/ 07322000
*        /*                                                          */ 07323000
*        /*     FOR RESET CLUSTER OR AIX, CHECK ALL VOLUME GROUP     */ 07324000
*        /*     OCCURRENCES FOR MATCHING DSDIRS                      */ 07325000
*        /*                                                          */ 07326000
*        /************************************************************/ 07327000
*                                                                  1827 07328000
*                      ELSE                                        1827 07329000
*                        PTF1CKVL = ON; /*CHECK ALL RESET VGOS       */ 07330000
*                                                                  1827 07331000
         B     @RC01821                                            1827 07332000
@RF01821 L     @07,RSPTWKC(,REG6)                                  1827 07333000
         OI    PTF1CKVL(@07),B'00001000'                           1827 07334000
*        /************************************************************/ 07335000
*        /*                                                          */ 07336000
*        /*     FOR INDEX (SEQUENCE SET WITH DATA) SCAN THE DATA     */ 07337000
*        /*     SN TABLE FOR A MATCHING DSDIR, SINCE THE DSDIR       */ 07338000
*        /*     FOR THE IMBED ONLY POINTS TO THE DATA. MARK THE      */ 07339000
*        /*     INDEX SEQUENCE SET UNUSABLE, IF THE DATA DOES        */ 07340000
*        /*     NOT EXIST OR IS MARKED UNUSABLE.                     */ 07341000
*        /*                                                          */ 07342000
*        /************************************************************/ 07343000
*                                                                  1828 07344000
*                    IF PTF1CKVL = ON THEN                         1828 07345000
@RC01821 DS    0H                                                  1828 07346000
@RC01817 L     @07,RSPTWKC(,REG6)                                  1828 07347000
         TM    PTF1CKVL(@07),B'00001000'                           1828 07348000
         BNO   @RF01828                                            1828 07349000
*  VERDSDVG:                                                       1829 07350000
*                      DO;                                         1829 07351000
VERDSDVG DS    0H                                                  1830 07352000
*                        IF SNSSWD = ON THEN                       1830 07353000
         L     @07,RSWASNVT(,REG6)                                 1830 07354000
         L     @07,RSFAENT(,@07)                                   1830 07355000
         TM    SNSSWD(@07),B'10000000'                             1830 07356000
         BNO   @RF01830                                            1830 07357000
*                          DO;                                     1831 07358000
*        RFY RSFSNVT BASED(PTVDISNT(1));                           1832 07359000
*                              /*USE DATA'S VGO SNTABLE              */ 07360000
*                            IF PTVDISNT(1) ^= 0 THEN              1833 07361000
         L     @07,RSPTWKC(,REG6)                                  1833 07362000
         L     @07,PTVDISNT(,@07)                                  1833 07363000
         LTR   @07,@07                                             1833 07364000
         BZ    @RF01833                                            1833 07365000
*                              DO;                                 1834 07366000
*                                RSFAENT = RSFCADR; /*SCAN ALL VGOS  */ 07367000
         L     @04,RSFCADR(,@07)                                   1835 07368000
         ST    @04,RSFAENT(,@07)                                   1835 07369000
*                                DO RSFCNDX = 1 TO RSFHNDX         1836 07370000
*                                 WHILE((SDSDIRSN ^=               1836 07371000
*                                 RSWASNVT->RSFAENT->SDSDIRSN) |   1836 07372000
*                                 (SNVOLSER ^=                     1836 07373000
*                                 RSWASNVT->RSFAENT->SNVOLSER));   1836 07374000
         LA    @07,1                                               1836 07375000
         B     @DE01836                                            1836 07376000
@DL01836 L     @07,RSPTWKC(,REG6)                                  1836 07377000
         L     @07,PTVDISNT(,@07)                                  1836 07378000
         L     @07,RSFAENT(,@07)                                   1836 07379000
         L     @04,RSWASNVT(,REG6)                                 1836 07380000
         L     @04,RSFAENT(,@04)                                   1836 07381000
         CLC   SDSDIRSN(2,@07),SDSDIRSN(@04)                       1836 07382000
         BNE   @DB01836                                            1836 07383000
         CLC   SNVOLSER(6,@07),SNVOLSER(@04)                       1836 07384000
         BE    @DC01836                                            1836 07385000
@DB01836 DS    0H                                                  1837 07386000
*                                      /*SCAN FOR MATCHING VGO       */ 07387000
*                                  RSFAENT = RSFAENT + RSFENTLN;   1837 07388000
         L     @07,RSPTWKC(,REG6)                                  1837 07389000
         L     @07,PTVDISNT(,@07)                                  1837 07390000
         SLR   @04,@04                                             1837 07391000
         IC    @04,RSFENTLN(,@07)                                  1837 07392000
         AL    @04,RSFAENT(,@07)                                   1837 07393000
         ST    @04,RSFAENT(,@07)                                   1837 07394000
*                                      /*TRY THE NEXT VGO            */ 07395000
*                                END;                              1838 07396000
         L     @04,RSPTWKC(,REG6)                                  1838 07397000
         L     @04,PTVDISNT(,@04)                                  1838 07398000
         LA    @07,1                                               1838 07399000
         AH    @07,RSFCNDX(,@04)                                   1838 07400000
@DE01836 L     @04,RSPTWKC(,REG6)                                  1838 07401000
         L     @04,PTVDISNT(,@04)                                  1838 07402000
         STH   @07,RSFCNDX(,@04)                                   1838 07403000
         L     @04,RSPTWKC(,REG6)                                  1838 07404000
         L     @04,PTVDISNT(,@04)                                  1838 07405000
         CH    @07,RSFHNDX(,@04)                                   1838 07406000
         BNH   @DL01836                                            1838 07407000
@DC01836 DS    0H                                                  1839 07408000
*                              END;                                1839 07409000
*                                                                  1839 07410000
*                            IF (PTVDISNT(1)=0) | (RSFCNDX>RSFHNDX)     07411000
*                             THEN                                 1840 07412000
@RF01833 L     @07,RSPTWKC(,REG6)                                  1840 07413000
         L     @07,PTVDISNT(,@07)                                  1840 07414000
         LTR   @07,@07                                             1840 07415000
         BZ    @RT01840                                            1840 07416000
         LH    @04,RSFCNDX(,@07)                                   1840 07417000
         CH    @04,RSFHNDX(,@07)                                   1840 07418000
         BNH   @RF01840                                            1840 07419000
@RT01840 DS    0H                                                  1841 07420000
*                                      /*SSWDTA UNUSABLE IF DATA BAD */ 07421000
*                              /* CALL TO MODULE IDCRS03 FOR PROCEDURE  07422000
*ARKUNUS                                                             */ 07423000
*                              CALL MARKUNUS;                      1841 07424000
*                                                                  1841 07425000
         L     @15,@CV03431                                        1841 07426000
         BALR  @14,@15                                             1841 07427000
*        RFY RSFSNVT;                  /*REINSTATE INDEX VGO         */ 07428000
@RF01840 DS    0H                                                  1843 07429000
*                          END;                                    1843 07430000
*                                                                  1843 07431000
*        /************************************************************/ 07432000
*        /*                                                          */ 07433000
*        /*     GET THE VOLUME RECORD TO VERIFY THE DSDIR            */ 07434000
*        /*                                                          */ 07435000
*        /************************************************************/ 07436000
*                                                                  1844 07437000
*                        ELSE                                      1844 07438000
*                          DO;                                     1844 07439000
         B     @RC01830                                            1844 07440000
@RF01830 DS    0H                                                  1845 07441000
*                            GRABCURR = GRABRAB1; /*USE BUFFER 1     */ 07442000
*                                                                  1845 07443000
         L     @07,RSGRABCU(,REG6)                                 1845 07444000
         L     @04,GRABRAB1(,@07)                                  1845 07445000
         ST    @04,GRABCURR(,@07)                                  1845 07446000
*                              DO;                                 1846 07447000
*                                RSRTYPE = ''B;                    1847 07448000
         MVI   RSRTYPE(REG6),X'00'                                 1847 07449000
*                                RSRGET = ON;      /* GETRCD  */   1848 07450000
         OI    RSRGET(REG6),B'10000000'                            1848 07451000
*                                RSRUPD = OFF;     /* NO UPDATE  */     07452000
         NI    RSRUPD(REG6),B'11110111'                            1849 07453000
*                                RSRDS = ''B;                      1850 07454000
         NI    RSRDS(REG6),B'00011111'                             1850 07455000
*                                RSRWF = ON;       /* WORKFILE  */ 1851 07456000
*                                RSRDIR = ON;      /* DIRECT  */   1852 07457000
*                                RSRKEY = ON;      /* KEY  */      1853 07458000
         OI    RSRWF(REG6),B'10010100'                             1853 07459000
*                                RSVIAFCR = ON;  /*INDICATE CRA SEARCH* 07460000
         OI    RSVIAFCR(REG6),B'10000000'                          1854 07461000
*                                RSVIACRA = SNVOLSER; /*SET VOLSER */   07462000
         L     @07,RSWASNVT(,REG6)                                 1855 07463000
         L     @07,RSFAENT(,@07)                                   1855 07464000
         MVC   RSVIACRA(6,REG6),SNVOLSER(@07)                      1855 07465000
*                                RSVIACIN = VOLSRCI; /*SET CI NUMBER */ 07466000
*                                                                  1856 07467000
         L     @07,RSVTBENT(,REG6)                                 1856 07468000
         MVC   RSVIACIN(3,REG6),VOLSRCI+1(@07)                     1856 07469000
*                              /* CALL TO MODULE IDCRS05 FOR PROCEDURE  07470000
*ETVIA                                                               */ 07471000
*                              CALL GETVIA;                        1857 07472000
         L     @15,@CV03442                                        1857 07473000
         BALR  @14,@15                                             1857 07474000
*                              END;                                1858 07475000
*                                                                  1858 07476000
*        /************************************************************/ 07477000
*        /*                                                          */ 07478000
*        /*     ATTEMPT TO EXTRACT THE DSDIR                         */ 07479000
*        /*                                                          */ 07480000
*        /************************************************************/ 07481000
*                                                                  1859 07482000
*                                                                  1859 07483000
*                            DO;                                   1859 07484000
*                              GRABBB = GRABCURR;                  1860 07485000
         L     @07,RSGRABCU(,REG6)                                 1860 07486000
         L     @04,GRABCURR(,@07)                                  1860 07487000
         ST    @04,GRABBB(,@07)                                    1860 07488000
*                              RSWGCODE = GCDSDIR;                 1861 07489000
         MVI   RSWGCODE(REG6),X'08'                                1861 07490000
*                                      /*SPECIFY GROUP CODE          */ 07491000
*                              RSWFONE = ON;                       1862 07492000
*                                      /*FIND ONE OCCURRENCE         */ 07493000
*                              RSWFIRST = OFF;                     1863 07494000
         OI    RSWFONE(REG6),B'10000000'                           1863 07495000
         NI    RSWFIRST(REG6),B'10111111'                          1863 07496000
*                                      /*FIND A SPECIFIC OCCURRENCE  */ 07497000
*                              RSWSEQNR = SDSDIRSN;                1864 07498000
         L     @07,RSWASNVT(,REG6)                                 1864 07499000
         L     @07,RSFAENT(,@07)                                   1864 07500000
         MVC   RSWSEQNR(2,REG6),SDSDIRSN(@07)                      1864 07501000
*                                      /*SEQUENCE NUMBER OF GO       */ 07502000
*                              /* CALL THE FIND SUBROUTINE */      1865 07503000
*                                                                  1865 07504000
*                            /* CALL TO MODULE IDCRS04 FOR PROCEDURE FI 07505000
*D                                                                   */ 07506000
*                            CALL FIND;                            1865 07507000
         L     @15,@CV03441                                        1865 07508000
         BALR  @14,@15                                             1865 07509000
*                            END;                                  1866 07510000
*                            PTVDSSNT = RSWASNVT; /*SNTABLE FOR DSDIR*/ 07511000
         L     @07,RSPTWKC(,REG6)                                  1867 07512000
         L     @04,RSWASNVT(,REG6)                                 1867 07513000
         ST    @04,PTVDSSNT(,@07)                                  1867 07514000
*                            RSFAENT = RSFCADR; /*DSDIR SNTAB        */ 07515000
         L     @15,RSFCADR(,@04)                                   1868 07516000
         ST    @15,RSFAENT(,@04)                                   1868 07517000
*                            RSFCNDX = 1; /*CURR SNTAB ENTRY = 1ST   */ 07518000
*                                                                  1869 07519000
         MVC   RSFCNDX(2,@04),@CH00212                             1869 07520000
*        /************************************************************/ 07521000
*        /*                                                          */ 07522000
*        /*     RESTORE DATA OR INDEX SN ENVIRONMENT FOR MARKUNUS    */ 07523000
*        /*                                                          */ 07524000
*        /************************************************************/ 07525000
*                                                                  1870 07526000
*                            RSWASNVT = PTVDISNT(PTINDX3); /*D-I SNT */ 07527000
         LH    @15,PTINDX3(,@07)                                   1870 07528000
         MH    @15,@CH00032                                        1870 07529000
         L     @14,PTVDISNT-12(@15,@07)                            1870 07530000
         ST    @14,RSWASNVT(,REG6)                                 1870 07531000
*                            GRABCURR =                            1871 07532000
*                             RABARRAY(PTVDIASS(PTINDX3)->TASSRAB);     07533000
*                                                                  1871 07534000
         L     @14,RSGRABCU(,REG6)                                 1871 07535000
         L     @07,PTVDIASS-12(@15,@07)                            1871 07536000
         LH    @07,TASSRAB(,@07)                                   1871 07537000
         SLA   @07,2                                               1871 07538000
         L     @07,RABARRAY-4(@07,@14)                             1871 07539000
         ST    @07,GRABCURR(,@14)                                  1871 07540000
*        /************************************************************/ 07541000
*        /*                                                          */ 07542000
*        /*     MARK UNUSABLE IF NO DSDIR                            */ 07543000
*        /*                                                          */ 07544000
*        /************************************************************/ 07545000
*                                                                  1872 07546000
*                            IF PTVDSSNT->RSFENTLN = 0 THEN        1872 07547000
         CLI   RSFENTLN(@04),0                                     1872 07548000
         BNE   @RF01872                                            1872 07549000
*                              /* CALL TO MODULE IDCRS03 FOR PROCEDURE  07550000
*ARKUNUS                                                             */ 07551000
*                              CALL MARKUNUS;                      1873 07552000
*                                                                  1873 07553000
         L     @15,@CV03431                                        1873 07554000
         BALR  @14,@15                                             1873 07555000
*        /************************************************************/ 07556000
*        /*                                                          */ 07557000
*        /*     ENSURE DSDIR IS FOR THIS DATA OR INDEX AND           */ 07558000
*        /*     THAT THE SUM TT IS CORRECT.                          */ 07559000
*        /*                                                          */ 07560000
*        /************************************************************/ 07561000
*                                                                  1874 07562000
*                            ELSE                                  1874 07563000
*                              DO;                                 1874 07564000
         B     @RC01872                                            1874 07565000
@RF01872 DS    0H                                                  1875 07566000
*        RFY SNDSDIR BASED(PTVDSSNT->RSFCADR); /*DSDIR SN ENTRY      */ 07567000
*                                RSCDSNT8 = PTVDSSNT; /*DSDIR SNTAB  */ 07568000
         L     @07,RSPTWKC(,REG6)                                  1876 07569000
         L     @04,PTVDSSNT(,@07)                                  1876 07570000
         ST    @04,RSCDSNT8(,REG6)                                 1876 07571000
*                                RSCDSNT3 = PTVDISNT(PTINDX3); /*VGO */ 07572000
         LH    @04,PTINDX3(,@07)                                   1877 07573000
         MH    @04,@CH00032                                        1877 07574000
         L     @07,PTVDISNT-12(@04,@07)                            1877 07575000
         ST    @07,RSCDSNT3(,REG6)                                 1877 07576000
*                                RSCDVOLR = GRABRAB1; /*VOL RCD      */ 07577000
         L     @07,RSGRABCU(,REG6)                                 1878 07578000
         L     @04,GRABRAB1(,@07)                                  1878 07579000
         ST    @04,RSCDVOLR(,REG6)                                 1878 07580000
*                                RSCDDIR = GRABCURR; /*D-I RCD       */ 07581000
         L     @07,GRABCURR(,@07)                                  1879 07582000
         ST    @07,RSCDDIR(,REG6)                                  1879 07583000
*                                /* CALL TO MODULE IDCRS03 FOR PROCEDUR 07584000
* CHKDSDIR                                                           */ 07585000
*                                CALL CHKDSDIR;                    1880 07586000
*                                                                  1880 07587000
         L     @15,@CV03432                                        1880 07588000
         BALR  @14,@15                                             1880 07589000
*        RFY SNDSDIR;                  /*REVERT                      */ 07590000
*                                PTVDSSNT->RSFENTLN = 0;           1882 07591000
         L     @07,RSPTWKC(,REG6)                                  1882 07592000
         L     @07,PTVDSSNT(,@07)                                  1882 07593000
         MVI   RSFENTLN(@07),X'00'                                 1882 07594000
*                                      /*FREE DSDIR SN TABLE         */ 07595000
*                              END;                                1883 07596000
*                          END;                                    1884 07597000
@RC01872 DS    0H                                                  1885 07598000
*                      END VERDSDVG;   /*END VOL GO CHECKED          */ 07599000
@RC01830 DS    0H                                                  1886 07600000
*                   END;                                           1886 07601000
@RF01828 DS    0H                                                  1887 07602000
*                END;                                              1887 07603000
@RT01810 L     @04,RSWASNVT(,REG6)                                 1887 07604000
         LA    @07,1                                               1887 07605000
         AH    @07,RSFCNDX(,@04)                                   1887 07606000
@DE01808 L     @04,RSWASNVT(,REG6)                                 1887 07607000
         STH   @07,RSFCNDX(,@04)                                   1887 07608000
         L     @04,RSWASNVT(,REG6)                                 1887 07609000
         CH    @07,RSFHNDX(,@04)                                   1887 07610000
         BNH   @DL01808                                            1887 07611000
*              END VERVOLGO;                                       1888 07612000
*            END;                                                  1889 07613000
*                                                                  1889 07614000
@RT01804 L     @04,RSPTWKC(,REG6)                                  1889 07615000
         LA    @07,1                                               1889 07616000
         AH    @07,PTINDX3(,@04)                                   1889 07617000
         L     @04,RSPTWKC(,REG6)                                  1889 07618000
         STH   @07,PTINDX3(,@04)                                   1889 07619000
         C     @07,@CF00149                                        1889 07620000
         BNH   @DL01802                                            1889 07621000
*        /************************************************************/ 07622000
*        /*                                                          */ 07623000
*        /*  MARK ALL PROCESSED DATA AND INDEX AS CHECKED FOR        */ 07624000
*        /*  DSDIRS AND FREE THE SN TABLES                           */ 07625000
*        /*                                                          */ 07626000
*        /************************************************************/ 07627000
*                                                                  1890 07628000
*  VERCLNUP:                                                       1890 07629000
*            DO PTINDX3 = 1 TO 2;                                  1890 07630000
VERCLNUP LA    @07,1                                               1890 07631000
         L     @04,RSPTWKC(,REG6)                                  1890 07632000
         STH   @07,PTINDX3(,@04)                                   1890 07633000
@DL01890 DS    0H                                                  1891 07634000
*              IF PTVDIASS(PTINDX3) ^= 0 THEN                      1891 07635000
         L     @07,RSPTWKC(,REG6)                                  1891 07636000
         LH    @04,PTINDX3(,@07)                                   1891 07637000
         MH    @04,@CH00032                                        1891 07638000
         L     @07,PTVDIASS-12(@04,@07)                            1891 07639000
         LTR   @07,@07                                             1891 07640000
         BZ    @RF01891                                            1891 07641000
*                DO;                                               1892 07642000
*                  GRABCURR = RABARRAY(PTVDIASS(PTINDX3)->TASSRAB);     07643000
         L     @04,RSGRABCU(,REG6)                                 1893 07644000
         LH    @07,TASSRAB(,@07)                                   1893 07645000
         SLA   @07,2                                               1893 07646000
         L     @07,RABARRAY-4(@07,@04)                             1893 07647000
         ST    @07,GRABCURR(,@04)                                  1893 07648000
*                                      /*BUFFER ADDRESS FOR D OR I   */ 07649000
*                  RSWDSDIR = ON;      /*IND DSDIRS CHECKED          */ 07650000
*                                                                  1894 07651000
         OI    RSWDSDIR(@07),B'00001000'                           1894 07652000
*                  DO;                                             1895 07653000
*                    RSRTYPE = ''B;                                1896 07654000
         MVI   RSRTYPE(REG6),X'00'                                 1896 07655000
*                    RSRUPDT = ON;     /* UPDRCD  */               1897 07656000
         OI    RSRUPDT(REG6),B'00100000'                           1897 07657000
*                    RSRUPD = ON;      /* UPDATE  */               1898 07658000
         OI    RSRUPD(REG6),B'00001000'                            1898 07659000
*                    RSRDS = ''B;                                  1899 07660000
         NI    RSRDS(REG6),B'00011111'                             1899 07661000
*                    RSRWF = ON;       /* WORKFILE  */             1900 07662000
*                    RSRDIR = ON;      /* DIRECT  */               1901 07663000
*                                                                  1901 07664000
         OI    RSRWF(REG6),B'10000100'                             1901 07665000
*                  /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT   */ 07666000
*                  CALL RECMGMT;                                   1902 07667000
         L     @15,@CV03458                                        1902 07668000
         BALR  @14,@15                                             1902 07669000
*                    RFY RTNREG RSTD;                              1903 07670000
*                    TESTRC = RTNREG;                              1904 07671000
         STH   RTNREG,TESTRC(,REG6)                                1904 07672000
*                    RFY RTNREG UNRSTD;                            1905 07673000
*                  END;                                            1906 07674000
*                                      /*UPDATE THE WORKFILE RECORD  */ 07675000
*                  IF PTVDISNT(PTINDX3) ^= 0 THEN                  1907 07676000
         L     @07,RSPTWKC(,REG6)                                  1907 07677000
         LH    @04,PTINDX3(,@07)                                   1907 07678000
         MH    @04,@CH00032                                        1907 07679000
         L     @07,PTVDISNT-12(@04,@07)                            1907 07680000
         LTR   @07,@07                                             1907 07681000
         BZ    @RF01907                                            1907 07682000
*                    PTVDISNT(PTINDX3)->RSFENTLN = 0;              1908 07683000
         MVI   RSFENTLN(@07),X'00'                                 1908 07684000
*                                      /*FREE SNTAB FOR D-I VGO      */ 07685000
*                END;                                              1909 07686000
@RF01907 DS    0H                                                  1910 07687000
*            END VERCLNUP;                                         1910 07688000
*                                                                  1910 07689000
@RF01891 L     @04,RSPTWKC(,REG6)                                  1910 07690000
         LA    @07,1                                               1910 07691000
         AH    @07,PTINDX3(,@04)                                   1910 07692000
         L     @04,RSPTWKC(,REG6)                                  1910 07693000
         STH   @07,PTINDX3(,@04)                                   1910 07694000
         C     @07,@CF00149                                        1910 07695000
         BNH   @DL01890                                            1910 07696000
*        /************************************************************/ 07697000
*        /*                                                          */ 07698000
*        /*                  TERMINATE                               */ 07699000
*        /*                                                          */ 07700000
*        /************************************************************/ 07701000
*                                                                  1911 07702000
*          END VERDSD;                                             1911 07703000
*                                                                  1911 07704000
*        IF GDTDBG = NULLPTR                                       1912 07705000
*          THEN;                                                   1912 07706000
@RT01721 L     @07,GDTDBG(,REG5)                                   1912 07707000
         LTR   @07,@07                                             1912 07708000
         BZ    @RT01912                                            1912 07709000
*          ELSE                                                    1914 07710000
*            CALL IDCDB010(GDTTBL,'RSV2');                         1914 07711000
*                                                                  1914 07712000
         ST    REG5,@AL00001                                       1914 07713000
         LA    @07,@CC03900                                        1914 07714000
         ST    @07,@AL00001+4                                      1914 07715000
         MVI   @AL00001+4,X'80'                                    1914 07716000
         L     @15,GDTDBG(,REG5)                                   1914 07717000
         LA    @01,@AL00001                                        1914 07718000
         BALR  @14,@15                                             1914 07719000
*        RFY TASSO;                    /*REVERT                      */ 07720000
@RT01912 DS    0H                                                  1916 07721000
* CALL EXIT;  /*TERMINATE*/                                        1916 07722000
         BAL   @14,EXIT                                            1916 07723000
* END VERDSDIR; /*END OF PROCEDURE*/                               1917 07724000
@EL00012 DS    0H                                                  1917 07725000
@EF00012 DS    0H                                                  1917 07726000
@ER00012 BR    @14                                                 1917 07727000
@PB00012 DS    0H                                                  1918 07728000
*/********************************************************************/ 07729000
*/*                                                                  */ 07730000
*/* PROCEDURE - VERG                                                 */ 07731000
*/*                                                                  */ 07732000
*/* FUNCTION -                                                       */ 07733000
*/*    VERIFY ALTERNATEINDEX(AIX) BASE ASSOCIATIONS.                 */ 07734000
*/*      AIX<->DATA                                                  */ 07735000
*/*      AIX<->INDEX                                                 */ 07736000
*/*      AIX<->CLUSTER                                               */ 07737000
*/*                                                                  */ 07738000
*/* INPUT -                                                          */ 07739000
*/*    CI TABLE AND DI TABLE FOR THE AIX                             */ 07740000
*/*                                                                  */ 07741000
*/* OUTPUT -                                                         */ 07742000
*/*    CITFAVER - SET ON IN AIX CITABE IF ASSOCIATION CHECKED        */ 07743000
*/*    DITFAVER - SET ON IN ALL DITABE WHERE ASSOCIATION CHECKED.    */ 07744000
*/*               NOTE CLUSTER->AIX IS CHECKED LAST SO THAT A PARTIAL*/ 07745000
*/*               STRUCTURE IS NOT LEFT CONNECTED TO THE CLUSTER.    */ 07746000
*/*                                                                  */ 07747000
*/* MESSAGES -                                                       */ 07748000
*/*    IDC11023I - INVALID ASSOCIATION                               */ 07749000
*/*                                                                  */ 07750000
*/********************************************************************/ 07751000
*      GENERATE;                                                   1918 07752000
         DS    0F                                                       07753000
NAME0205 DC    CL8'VERG'                                                07754000
*VERG: PROCEDURE                                                   1919 07755000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1919 07756000
*                                                                  1919 07757000
         B     @PB00013                                            1919 07758000
VERG     DS    0H                                                  1920 07759000
*      GENERATE REFS(RS02RG08, REG6);                              1920 07760000
*                                                                  1920 07761000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          07762000
         LR    @15,@13  OLD SAVE AREA                                   07763000
         LA    @13,72(@13)  NEW SAVE AREA                               07764000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     07765000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        07766000
         MVC   0(4,@15),NAME0205  PROCNAME TO REGSAVE                   07767000
*        OLDERID2 = NEWERID2;                                      1921 07768000
         L     @07,GDTTR2(,REG5)                                   1921 07769000
         MVC   @TS00001(95),NEWERID2(@07)                          1921 07770000
         MVC   OLDERID2(95,@07),@TS00001                           1921 07771000
*        NEWID2 = 'RSRG';                                          1922 07772000
         MVC   NEWID2(4,@07),@CC03904                              1922 07773000
*        RFY CITABE BASED(RSTENTAD);                               1923 07774000
*        RFY DITABE BASED(PTLCDIT);                                1924 07775000
*                                                                  1924 07776000
*        /************************************************************/ 07777000
*        /*                                                          */ 07778000
*        /* EXPECTED ASSOCIATIONS TABLE                              */ 07779000
*        /*                                                          */ 07780000
*        /************************************************************/ 07781000
*                                                                  1925 07782000
*        DECLARE                                                   1925 07783000
*          AIXTBL CHAR(3) INIT('DIC'); /*AIX ASSOCIATIONS            */ 07784000
*                                                                  1925 07785000
*        /************************************************************/ 07786000
*        /*                                                          */ 07787000
*        /* CLEAR ERROR TABLE ARRAY FOR ALL ASSOCIATIONS             */ 07788000
*        /*                                                          */ 07789000
*        /************************************************************/ 07790000
*                                                                  1926 07791000
*        PTASSOE1 = PTASSOE1 && PTASSOE1;                          1926 07792000
*                                                                  1926 07793000
         L     @07,RSPTWKC(,REG6)                                  1926 07794000
         XC    PTASSOE1(40,@07),PTASSOE1(@07)                      1926 07795000
*        /************************************************************/ 07796000
*        /*                                                          */ 07797000
*        /* PROCESS ALL ASSOCIATIONS EXPECTED                        */ 07798000
*        /*                                                          */ 07799000
*        /************************************************************/ 07800000
*                                                                  1927 07801000
*        PTF1OK = ON;                  /*OK SO FAR                   */ 07802000
         OI    PTF1OK(@07),B'00100000'                             1927 07803000
*        DO PTINDXV = 1 TO LENGTH(AIXTBL) WHILE(PTF1OK=ON);        1928 07804000
*                                                                  1928 07805000
         LA    @07,1                                               1928 07806000
         L     @04,RSPTWKC(,REG6)                                  1928 07807000
         STH   @07,PTINDXV(,@04)                                   1928 07808000
@DL01928 L     @07,RSPTWKC(,REG6)                                  1928 07809000
         TM    PTF1OK(@07),B'00100000'                             1928 07810000
         BNO   @DC01928                                            1928 07811000
*        /************************************************************/ 07812000
*        /*                                                          */ 07813000
*        /*     LOCATE EXPECTED ASSOCIATION BY SEQUENCE NUMBER       */ 07814000
*        /*                                                          */ 07815000
*        /************************************************************/ 07816000
*                                                                  1929 07817000
*          PTLOC = PTLOC && PTLOC;                                 1929 07818000
         XC    PTLOC(20,@07),PTLOC(@07)                            1929 07819000
*          PTLBCITX = PTCITI;          /*AIX BASE FOR LOCATE         */ 07820000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         1930 07821000
*          PTLFBAS1 = ON;              /*SCAN ASSOCIATIONS ONLY      */ 07822000
         OI    PTLFBAS1(@07),B'00100000'                           1931 07823000
*          PTLSN = PTINDXV;            /*SEQUENCE # OF ASSN          */ 07824000
         LH    @04,PTINDXV(,@07)                                   1932 07825000
         STH   @04,PTLSN(,@07)                                     1932 07826000
*          CALL LOCDIT;                                            1933 07827000
*                                                                  1933 07828000
         BAL   @14,LOCDIT                                          1933 07829000
*        /************************************************************/ 07830000
*        /*                                                          */ 07831000
*        /*     IF NO ASSOCIATION, ERROR                             */ 07832000
*        /*                                                          */ 07833000
*        /************************************************************/ 07834000
*                                                                  1934 07835000
*          IF PTLCDIT = 0 THEN                                     1934 07836000
         L     @07,RSPTWKC(,REG6)                                  1934 07837000
         L     @04,PTLCDIT(,@07)                                   1934 07838000
         LTR   @04,@04                                             1934 07839000
         BNZ   @RF01934                                            1934 07840000
*            PTF1OK = OFF;                                         1935 07841000
*                                                                  1935 07842000
         NI    PTF1OK(@07),B'11011111'                             1935 07843000
*        /************************************************************/ 07844000
*        /*                                                          */ 07845000
*        /*     GET ASSOCIATION'S CI TABLE ENTRY                     */ 07846000
*        /*                                                          */ 07847000
*        /************************************************************/ 07848000
*                                                                  1936 07849000
*          ELSE                                                    1936 07850000
*  VERGASSO:                                                       1936 07851000
*            DO;                                                   1936 07852000
         B     @RC01934                                            1936 07853000
@RF01934 DS    0H                                                  1936 07854000
VERGASSO DS    0H                                                  1937 07855000
*              RSTANCHR = ADDR(RSGCITS);                           1937 07856000
         LA    @07,RSGCITS(,REG6)                                  1937 07857000
         ST    @07,RSTANCHR(,REG6)                                 1937 07858000
*              RSTENTIX = DITCITAB;    /*ASSOCIATION INDEX           */ 07859000
         L     @07,RSPTWKC(,REG6)                                  1938 07860000
         L     @07,PTLCDIT(,@07)                                   1938 07861000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1938 07862000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 07863000
*              CALL GETNEXTE;                                      1939 07864000
*                                                                  1939 07865000
         L     @15,@CV03436                                        1939 07866000
         BALR  @14,@15                                             1939 07867000
*        /************************************************************/ 07868000
*        /*                                                          */ 07869000
*        /*     CHECK IF RECORD VALID AND TYPE SAME AS EXPECTED      */ 07870000
*        /*                                                          */ 07871000
*        /************************************************************/ 07872000
*                                                                  1940 07873000
*              IF CITFAINV=ON | CITTYPE^=AIXTBL(PTINDXV:PTINDXV) THEN   07874000
         L     @07,RSTENTAD(,REG6)                                 1940 07875000
         TM    CITFAINV(@07),B'00000010'                           1940 07876000
         BO    @RT01940                                            1940 07877000
         L     @04,RSPTWKC(,REG6)                                  1940 07878000
         LH    @04,PTINDXV(,@04)                                   1940 07879000
         LA    @01,AIXTBL-1(@04)                                   1940 07880000
         CLC   CITTYPE(1,@07),0(@01)                               1940 07881000
         BE    @RF01940                                            1940 07882000
@RT01940 DS    0H                                                  1941 07883000
*                PTF1OK = OFF;                                     1941 07884000
*                                                                  1941 07885000
         L     @07,RSPTWKC(,REG6)                                  1941 07886000
         NI    PTF1OK(@07),B'11011111'                             1941 07887000
*        /************************************************************/ 07888000
*        /*                                                          */ 07889000
*        /*     AIX->ASSOCIATION IS VERIFIED - MARK DITABE           */ 07890000
*        /*                                                          */ 07891000
*        /************************************************************/ 07892000
*                                                                  1942 07893000
*              ELSE                                                1942 07894000
*                DO;                                               1942 07895000
         B     @RC01940                                            1942 07896000
@RF01940 DS    0H                                                  1943 07897000
*                  DITFAVER = ON;                                  1943 07898000
         L     @07,RSPTWKC(,REG6)                                  1943 07899000
         L     @04,PTLCDIT(,@07)                                   1943 07900000
         OI    DITFAVER(@04),B'01000000'                           1943 07901000
*                  PTASSDIT(PTINDXV) = PTLCDIT; /*SAVE IN CASE OF ERR*/ 07902000
         LH    @15,PTINDXV(,@07)                                   1944 07903000
         LR    @14,@15                                             1944 07904000
         SLA   @14,3                                               1944 07905000
         ST    @04,PTASSDIT-8(@14,@07)                             1944 07906000
*                  PTASSCIT(PTINDXV) = RSTENTAD; /*HAS CIN OF ASSN   */ 07907000
*                                                                  1945 07908000
         L     @04,RSTENTAD(,REG6)                                 1945 07909000
         ST    @04,PTASSCIT-8(@14,@07)                             1945 07910000
*        /************************************************************/ 07911000
*        /*                                                          */ 07912000
*        /*     FOR DATA AND INDEX ASSOCIATION, MARK THE DATA        */ 07913000
*        /*     AND INDEX AS VERIFIED.                               */ 07914000
*        /*                                                          */ 07915000
*        /************************************************************/ 07916000
*                                                                  1946 07917000
*                  IF AIXTBL(PTINDXV:PTINDXV) = DATAID |           1946 07918000
*                   AIXTBL(PTINDXV:PTINDXV) = INDEXID THEN         1946 07919000
         LA    @07,AIXTBL-1(@15)                                   1946 07920000
         CLI   0(@07),C'D'                                         1946 07921000
         BE    @RT01946                                            1946 07922000
         LA    @07,AIXTBL-1(@15)                                   1946 07923000
         CLI   0(@07),C'I'                                         1946 07924000
         BNE   @RF01946                                            1946 07925000
@RT01946 DS    0H                                                  1947 07926000
*                    CITFAVER = ON;                                1947 07927000
*                                                                  1947 07928000
         L     @07,RSTENTAD(,REG6)                                 1947 07929000
         OI    CITFAVER(@07),B'01000000'                           1947 07930000
*        /************************************************************/ 07931000
*        /*                                                          */ 07932000
*        /*     ALL ASSOCIATIONS ARE TWO WAY FOR BASE AIX. SCAN THE  */ 07933000
*        /*     ASSOCIATION RECORD TO FIND THE RECIPROCAL ASSOCIATION*/ 07934000
*        /*                                                          */ 07935000
*        /************************************************************/ 07936000
*                                                                  1948 07937000
*                  PTCITWK = DITCITAB; /*SAVE D OR I OR C            */ 07938000
@RF01946 L     @07,RSPTWKC(,REG6)                                  1948 07939000
         L     @04,PTLCDIT(,@07)                                   1948 07940000
         L     @04,DITCITAB-1(,@04)                                1948 07941000
         LA    @04,0(,@04)                                         1948 07942000
         ST    @04,PTCITWK(,@07)                                   1948 07943000
*                  PTLOC = PTLOC && PTLOC;                         1949 07944000
         XC    PTLOC(20,@07),PTLOC(@07)                            1949 07945000
*                  PTLBCITX = PTCITWK; /*D-I-C INDEX                 */ 07946000
         STCM  @04,7,PTLBCITX(@07)                                 1950 07947000
*                  PTLFBAS1 = ON;      /*ASSOCIATION ONLY SCAN       */ 07948000
         OI    PTLFBAS1(@07),B'00100000'                           1951 07949000
*                  IF AIXTBL(PTINDXV:PTINDXV) = CLID THEN          1952 07950000
         LH    @04,PTINDXV(,@07)                                   1952 07951000
         LA    @01,AIXTBL-1(@04)                                   1952 07952000
         CLI   0(@01),C'C'                                         1952 07953000
         BNE   @RF01952                                            1952 07954000
*                    PTLSN = 0;        /*ASSN FROM C NOT POSITIONAL  */ 07955000
         SLR   @04,@04                                             1953 07956000
         STH   @04,PTLSN(,@07)                                     1953 07957000
*                  ELSE                                            1954 07958000
*                    PTLSN = 1;        /*FIRST ASSOCIATION ORIENT    */ 07959000
         B     @RC01952                                            1954 07960000
@RF01952 L     @07,RSPTWKC(,REG6)                                  1954 07961000
         MVC   PTLSN(2,@07),@CH00212                               1954 07962000
*                  PTF1ENDG=OFF;       /*LOOP TERMINATOR             */ 07963000
*                                                                  1955 07964000
@RC01952 L     @07,RSPTWKC(,REG6)                                  1955 07965000
         NI    PTF1ENDG(@07),B'11111101'                           1955 07966000
*  VERGAIX:                                                        1956 07967000
*                  DO WHILE(PTF1OK=ON & PTF1ENDG=OFF);             1956 07968000
VERGAIX  B     @DE01956                                            1956 07969000
@DL01956 DS    0H                                                  1957 07970000
*                    CALL LOCDIT;                                  1957 07971000
*                                                                  1957 07972000
         BAL   @14,LOCDIT                                          1957 07973000
*        /************************************************************/ 07974000
*        /*                                                          */ 07975000
*        /*     NO ASSOCIATION FOUND                                 */ 07976000
*        /*                                                          */ 07977000
*        /************************************************************/ 07978000
*                                                                  1958 07979000
*                    IF PTLCDIT = 0 THEN                           1958 07980000
         L     @07,RSPTWKC(,REG6)                                  1958 07981000
         L     @04,PTLCDIT(,@07)                                   1958 07982000
         LTR   @04,@04                                             1958 07983000
         BNZ   @RF01958                                            1958 07984000
*                      PTF1OK = OFF;                               1959 07985000
*                                                                  1959 07986000
         NI    PTF1OK(@07),B'11011111'                             1959 07987000
*        /************************************************************/ 07988000
*        /*                                                          */ 07989000
*        /*     ASSOCIATION FOUND - GET CI TABLE ENTRY               */ 07990000
*        /*                                                          */ 07991000
*        /************************************************************/ 07992000
*                                                                  1960 07993000
*                    ELSE                                          1960 07994000
*                      DO;                                         1960 07995000
         B     @RC01958                                            1960 07996000
@RF01958 DS    0H                                                  1961 07997000
*                        RSTANCHR = ADDR(RSGCITS);                 1961 07998000
         LA    @07,RSGCITS(,REG6)                                  1961 07999000
         ST    @07,RSTANCHR(,REG6)                                 1961 08000000
*                        RSTENTIX = DITCITAB;                      1962 08001000
         L     @07,RSPTWKC(,REG6)                                  1962 08002000
         L     @07,PTLCDIT(,@07)                                   1962 08003000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      1962 08004000
*                        /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEX 08005000
*E                                                                   */ 08006000
*                        CALL GETNEXTE;                            1963 08007000
*                                                                  1963 08008000
         L     @15,@CV03436                                        1963 08009000
         BALR  @14,@15                                             1963 08010000
*        /************************************************************/ 08011000
*        /*                                                          */ 08012000
*        /*     ENSURE ASSOCIATION BACK TO AIX                       */ 08013000
*        /*                                                          */ 08014000
*        /************************************************************/ 08015000
*                                                                  1964 08016000
*                        IF CITTYPE=AIXID &                        1964 08017000
*                         CITCIN=PTCITF->CITCIN THEN               1964 08018000
         L     @07,RSTENTAD(,REG6)                                 1964 08019000
         CLI   CITTYPE(@07),C'G'                                   1964 08020000
         BNE   @RF01964                                            1964 08021000
         L     @04,RSPTWKC(,REG6)                                  1964 08022000
         L     @01,PTCITF(,@04)                                    1964 08023000
         CLC   CITCIN(3,@07),CITCIN(@01)                           1964 08024000
         BNE   @RF01964                                            1964 08025000
*                          DO;                                     1965 08026000
*                            DITFAVER = ON; /*ASSN VERIFIED          */ 08027000
         L     @07,PTLCDIT(,@04)                                   1966 08028000
         OI    DITFAVER(@07),B'01000000'                           1966 08029000
*                            PTF1ENDG = ON; /*KILL THIS LOOP         */ 08030000
         OI    PTF1ENDG(@04),B'00000010'                           1967 08031000
*                          END;                                    1968 08032000
*                                                                  1968 08033000
*        /************************************************************/ 08034000
*        /*                                                          */ 08035000
*        /*     IF BAD ASSOCIATION AND NOT CLUSTER SCAN, THEN        */ 08036000
*        /*     MARK AS ERROR.                                       */ 08037000
*        /*     IF CLUSTER SCAN, THE AIX ASSOCIATION IS NOT          */ 08038000
*        /*     POSITIONAL.                                          */ 08039000
*        /*                                                          */ 08040000
*        /************************************************************/ 08041000
*                                                                  1969 08042000
*                        ELSE                                      1969 08043000
*                          IF AIXTBL(PTINDXV:PTINDXV)^=CLID THEN   1969 08044000
         B     @RC01964                                            1969 08045000
@RF01964 L     @07,RSPTWKC(,REG6)                                  1969 08046000
         LH    @04,PTINDXV(,@07)                                   1969 08047000
         LA    @01,AIXTBL-1(@04)                                   1969 08048000
         CLI   0(@01),C'C'                                         1969 08049000
         BE    @RF01969                                            1969 08050000
*                            PTF1OK = OFF;                         1970 08051000
         NI    PTF1OK(@07),B'11011111'                             1970 08052000
*                      END;                                        1971 08053000
@RF01969 DS    0H                                                  1971 08054000
@RC01964 DS    0H                                                  1972 08055000
*                  END VERGAIX;                                    1972 08056000
@RC01958 DS    0H                                                  1972 08057000
@DE01956 L     @07,RSPTWKC(,REG6)                                  1972 08058000
         TM    PTF1OK(@07),B'00100000'                             1972 08059000
         BNO   @DC01956                                            1972 08060000
         TM    PTF1ENDG(@07),B'00000010'                           1972 08061000
         BZ    @DL01956                                            1972 08062000
@DC01956 DS    0H                                                  1973 08063000
*                END;                                              1973 08064000
*            END VERGASSO;                                         1974 08065000
@RC01940 DS    0H                                                  1975 08066000
*        END;                                                      1975 08067000
*                                                                  1975 08068000
@RC01934 L     @04,RSPTWKC(,REG6)                                  1975 08069000
         LA    @07,1                                               1975 08070000
         AH    @07,PTINDXV(,@04)                                   1975 08071000
         L     @04,RSPTWKC(,REG6)                                  1975 08072000
         STH   @07,PTINDXV(,@04)                                   1975 08073000
         C     @07,@CF00158                                        1975 08074000
         BNH   @DL01928                                            1975 08075000
@DC01928 DS    0H                                                  1976 08076000
*        /************************************************************/ 08077000
*        /*                                                          */ 08078000
*        /* IF INVALID ASSOCIATION, ISSUE MESSAGE IDC11023I          */ 08079000
*        /*                                                          */ 08080000
*        /************************************************************/ 08081000
*                                                                  1976 08082000
*        PTINDXV = PTINDXV - 1;        /*TRUE ENTRY NUMBER           */ 08083000
         L     @07,RSPTWKC(,REG6)                                  1976 08084000
         LH    @04,PTINDXV(,@07)                                   1976 08085000
         BCTR  @04,0                                               1976 08086000
         STH   @04,PTINDXV(,@07)                                   1976 08087000
*        IF PTF1OK = OFF THEN                                      1977 08088000
         TM    PTF1OK(@07),B'00100000'                             1977 08089000
         BNZ   @RF01977                                            1977 08090000
*          IF PTASSCIT(PTINDXV) = 0 THEN /*MISSING ASSOCIATION       */ 08091000
*                                                                  1978 08092000
         LR    @15,@04                                             1978 08093000
         SLA   @15,3                                               1978 08094000
         L     @15,PTASSCIT-8(@15,@07)                             1978 08095000
         LTR   @15,@15                                             1978 08096000
         BNZ   @RF01978                                            1978 08097000
*            DO;                                                   1979 08098000
*            /*CALL CKERR*/                                        1980 08099000
*              RSCKERR = RSCKERR && RSCKERR;                       1980 08100000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1980 08101000
*              RSCKERN = RSE041;                                   1981 08102000
         MVC   RSCKERN(2,REG6),@CH00969                            1981 08103000
*              RSCKTERM = 'RETU';                                  1982 08104000
         MVC   RSCKTERM(4,REG6),@CC03787                           1982 08105000
*              RSCKMVAR(1) = ADDR(PTBASE->CNAME);                  1983 08106000
         L     @07,PTBASE(,@07)                                    1983 08107000
         LA    @07,CNAME(,@07)                                     1983 08108000
         ST    @07,RSCKMVAR(,REG6)                                 1983 08109000
*              RSCKMVAR(2) = ADDR(AIXID);                          1984 08110000
         LA    @07,@CC00806                                        1984 08111000
         ST    @07,RSCKMVAR+4(,REG6)                               1984 08112000
*              RSCKMVAR(3) = ADDR(AIXTBL(PTINDXV:PTINDXV));        1985 08113000
*                                                                  1985 08114000
         LA    @07,AIXTBL-1(@04)                                   1985 08115000
         ST    @07,RSCKMVAR+8(,REG6)                               1985 08116000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 08117000
*            CALL CKERR;                                           1986 08118000
         L     @15,@CV03449                                        1986 08119000
         BALR  @14,@15                                             1986 08120000
*            END;                                                  1987 08121000
*          ELSE                                                    1988 08122000
*                                                                  1988 08123000
*            DO;                                                   1988 08124000
         B     @RC01978                                            1988 08125000
@RF01978 DS    0H                                                  1989 08126000
*            /*CALL CKERR*/                                        1989 08127000
*              RSCKERR = RSCKERR && RSCKERR;                       1989 08128000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1989 08129000
*              RSCKERN = RSE026;                                   1990 08130000
         MVC   RSCKERN(2,REG6),@CH00942                            1990 08131000
*              RSCKTERM = 'RETU';                                  1991 08132000
         MVC   RSCKTERM(4,REG6),@CC03787                           1991 08133000
*              RSCKMVAR(1) = ADDR(PTBASE->CNAME);                  1992 08134000
         L     @07,RSPTWKC(,REG6)                                  1992 08135000
         L     @04,PTBASE(,@07)                                    1992 08136000
         LA    @04,CNAME(,@04)                                     1992 08137000
         ST    @04,RSCKMVAR(,REG6)                                 1992 08138000
*              RSCKMVAR(2) = ADDR(AIXID);                          1993 08139000
         LA    @04,@CC00806                                        1993 08140000
         ST    @04,RSCKMVAR+4(,REG6)                               1993 08141000
*              RSCKMVAR(3) = ADDR(PTASSCIT(PTINDXV)->CITCIN);      1994 08142000
         LH    @04,PTINDXV(,@07)                                   1994 08143000
         SLA   @04,3                                               1994 08144000
         L     @07,PTASSCIT-8(@04,@07)                             1994 08145000
         LA    @04,CITCIN(,@07)                                    1994 08146000
         ST    @04,RSCKMVAR+8(,REG6)                               1994 08147000
*              RSCKMVAR(4) = ADDR(PTASSCIT(PTINDXV)->CITTYPE);     1995 08148000
*                                                                  1995 08149000
         LA    @07,CITTYPE(,@07)                                   1995 08150000
         ST    @07,RSCKMVAR+12(,REG6)                              1995 08151000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 08152000
*            CALL CKERR;                                           1996 08153000
         L     @15,@CV03449                                        1996 08154000
         BALR  @14,@15                                             1996 08155000
*            END;                                                  1997 08156000
*                                                                  1997 08157000
*        /************************************************************/ 08158000
*        /*                                                          */ 08159000
*        /*                AIX VERIFIED                              */ 08160000
*        /*                                                          */ 08161000
*        /************************************************************/ 08162000
*                                                                  1998 08163000
*        ELSE                                                      1998 08164000
*          PTCITF->CITFAVER = ON;                                  1998 08165000
*                                                                  1998 08166000
         B     @RC01977                                            1998 08167000
@RF01977 L     @07,RSPTWKC(,REG6)                                  1998 08168000
         L     @07,PTCITF(,@07)                                    1998 08169000
         OI    CITFAVER(@07),B'01000000'                           1998 08170000
*        RFY CITABE;                   /*REVERT                      */ 08171000
@RC01977 DS    0H                                                  2000 08172000
*        RFY DITABE;                   /*REVERT                      */ 08173000
*                                                                  2000 08174000
* CALL EXIT;  /*TERMINATE*/                                        2001 08175000
         BAL   @14,EXIT                                            2001 08176000
* END VERG; /*END OF PROCEDURE*/                                   2002 08177000
@EL00013 DS    0H                                                  2002 08178000
@EF00013 DS    0H                                                  2002 08179000
@ER00013 BR    @14                                                 2002 08180000
@PB00013 DS    0H                                                  2003 08181000
*/********************************************************************/ 08182000
*/*                                                                  */ 08183000
*/* PROCEDURE - VERR                                                 */ 08184000
*/*                                                                  */ 08185000
*/* FUNCTION -                                                       */ 08186000
*/*    VERIFY PATH ASSOCIATIONS FOR A PATH OVER A CLUSTER:           */ 08187000
*/*      PATH<->CLUSTER                                              */ 08188000
*/*      PATH->DATA                                                  */ 08189000
*/*      PATH->INDEX(IF KSDS)                                        */ 08190000
*/*    VERIFY PATH ASSOCIATIONS FOR A PATH OVER AN ALTERNATEINDEX    */ 08191000
*/*      PATH<->ALTERNATEINDEX                                       */ 08192000
*/*      PATH->DATA(AIX)                                             */ 08193000
*/*      PATH->INDEX(AIX)                                            */ 08194000
*/*      PATH->DATA(CLUSTER)                                         */ 08195000
*/*      PATH->INDEX(CLUSTER IF KSDS)                                */ 08196000
*/*                                                                  */ 08197000
*/* INPUT -                                                          */ 08198000
*/*    CI TABLE AND DI TABLE FOR THE PATH                            */ 08199000
*/*                                                                  */ 08200000
*/* OUTPUT -                                                         */ 08201000
*/*    CITFAVER - SET ON IN PATH CITABE IF ASSOCIATION CHECKED.      */ 08202000
*/*    DITFAVER - SET ON IN ALL DITABE WHERE THE ASSOCIATION CHECKED.*/ 08203000
*/*                                                                  */ 08204000
*/* MESSAGES -                                                       */ 08205000
*/*    IDC11023I - INVALID ASSOCIATION                               */ 08206000
*/*                                                                  */ 08207000
*/********************************************************************/ 08208000
*      GENERATE;                                                   2003 08209000
         DS    0F                                                       08210000
NAME0215 DC    CL8'VERR'                                                08211000
*VERR: PROCEDURE                                                   2004 08212000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2004 08213000
*                                                                  2004 08214000
         B     @PB00014                                            2004 08215000
VERR     DS    0H                                                  2005 08216000
*      GENERATE REFS(RS02RG08, REG6);                              2005 08217000
*                                                                  2005 08218000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          08219000
         LR    @15,@13  OLD SAVE AREA                                   08220000
         LA    @13,72(@13)  NEW SAVE AREA                               08221000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     08222000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        08223000
         MVC   0(4,@15),NAME0215  PROCNAME TO REGSAVE                   08224000
*        /************************************************************/ 08225000
*        /*                                                          */ 08226000
*        /* DATA TABLES DENOTING THE ORDER OF ASSOCIATIONS FOR       */ 08227000
*        /* PATH OVER CLUSTER AND PATH OVER ALTERNATEINDEX           */ 08228000
*        /*                                                          */ 08229000
*        /************************************************************/ 08230000
*                                                                  2006 08231000
*        DECLARE                                                   2006 08232000
*          PATHCTBL CHAR(3) INIT('CDI'); /*PATH OVER CLUSTER         */ 08233000
*        DECLARE                                                   2007 08234000
*          PATHGTBL CHAR(5) INIT('GDIDI'); /*PATH OVER AIX           */ 08235000
*                                                                  2007 08236000
*        OLDERID2 = NEWERID2;                                      2008 08237000
         L     @07,GDTTR2(,REG5)                                   2008 08238000
         MVC   @TS00001(95),NEWERID2(@07)                          2008 08239000
         MVC   OLDERID2(95,@07),@TS00001                           2008 08240000
*        NEWID2 = 'RSVR';                                          2009 08241000
*                                                                  2009 08242000
         MVC   NEWID2(4,@07),@CC03920                              2009 08243000
*        /************************************************************/ 08244000
*        /*                                                          */ 08245000
*        /* GET THE NUMBER OF ASSOCIATIONS EXPECTED AND THEIR TYPES. */ 08246000
*        /*                                                          */ 08247000
*        /************************************************************/ 08248000
*                                                                  2010 08249000
*        IF RSPTWKC->TABBACKW->PTCITF->CITTYPE=CLID THEN           2010 08250000
         L     @07,RSPTWKC(,REG6)                                  2010 08251000
         L     @04,TABBACKW(,@07)                                  2010 08252000
         L     @04,PTCITF(,@04)                                    2010 08253000
         CLI   CITTYPE(@04),C'C'                                   2010 08254000
         BNE   @RF02010                                            2010 08255000
*                                      /*PATH OVER A CLUSTER         */ 08256000
*          DO;                                                     2011 08257000
*            PTASSEXP = ADDR(PATHCTBL); /*EXPECTED ASSOCIATIONS      */ 08258000
         LA    @04,PATHCTBL                                        2012 08259000
         ST    @04,PTASSEXP(,@07)                                  2012 08260000
*            PTINDXV = LENGTH(PATHCTBL); /*NUMBER OF EXPECTED ASSNS  */ 08261000
         MVC   PTINDXV(2,@07),@CH00158                             2013 08262000
*          END;                                                    2014 08263000
*        ELSE                                                      2015 08264000
*          DO;                                                     2015 08265000
         B     @RC02010                                            2015 08266000
@RF02010 DS    0H                                                  2016 08267000
*            PTASSEXP = ADDR(PATHGTBL); /*EXPECTED ASSOCIATIONS      */ 08268000
         L     @07,RSPTWKC(,REG6)                                  2016 08269000
         LA    @04,PATHGTBL                                        2016 08270000
         ST    @04,PTASSEXP(,@07)                                  2016 08271000
*            PTINDXV = LENGTH(PATHGTBL); /*NUMBER OF EXPECTED ASSNS  */ 08272000
         MVC   PTINDXV(2,@07),@CH00280                             2017 08273000
*          END;                                                    2018 08274000
*                                                                  2018 08275000
*        /************************************************************/ 08276000
*        /*                                                          */ 08277000
*        /* IF BASE CLUSTER IS NOT A KSDS, NO ASSOCIATION TO INDEX   */ 08278000
*        /*                                                          */ 08279000
*        /************************************************************/ 08280000
*                                                                  2019 08281000
*        IF RSPTWKF->PTF2KSDS = OFF THEN                           2019 08282000
@RC02010 L     @07,RSPTWKF(,REG6)                                  2019 08283000
         TM    PTF2KSDS(@07),B'10000000'                           2019 08284000
         BNZ   @RF02019                                            2019 08285000
*          PTINDXV = PTINDXV - 1;                                  2020 08286000
*                                                                  2020 08287000
         L     @07,RSPTWKC(,REG6)                                  2020 08288000
         LH    @04,PTINDXV(,@07)                                   2020 08289000
         BCTR  @04,0                                               2020 08290000
         STH   @04,PTINDXV(,@07)                                   2020 08291000
*        /************************************************************/ 08292000
*        /*                                                          */ 08293000
*        /* GET ALL ASSOCIATION ENTRIES EXPECTED FROM PATH           */ 08294000
*        /*                                                          */ 08295000
*        /************************************************************/ 08296000
*                                                                  2021 08297000
*        PTASSOE1 = PTASSOE1 && PTASSOE1; /*CLEAR CIT-DIT TABLES     */ 08298000
@RF02019 L     @07,RSPTWKC(,REG6)                                  2021 08299000
         XC    PTASSOE1(40,@07),PTASSOE1(@07)                      2021 08300000
*        PTASSOEA = ADDR(PTASSOE1);    /*FIRST DITABE ENTRY POINTER  */ 08301000
         LA    @04,PTASSOE1(,@07)                                  2022 08302000
         ST    @04,PTASSOEA(,@07)                                  2022 08303000
*        PTF1OK = ON;                  /*LOOP UNTIL ERROR            */ 08304000
*                                                                  2023 08305000
         OI    PTF1OK(@07),B'00100000'                             2023 08306000
*        DO PTINDX4 = 1 TO PTINDXV WHILE(PTF1OK=ON);               2024 08307000
         LA    @07,1                                               2024 08308000
         B     @DE02024                                            2024 08309000
@DL02024 L     @07,RSPTWKC(,REG6)                                  2024 08310000
         TM    PTF1OK(@07),B'00100000'                             2024 08311000
         BNO   @DC02024                                            2024 08312000
*          PTLOC = PTLOC && PTLOC;                                 2025 08313000
         XC    PTLOC(20,@07),PTLOC(@07)                            2025 08314000
*          PTLBCITX = PTCITI;          /*SCAN PATH                   */ 08315000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         2026 08316000
*          PTLFBAS1 = ON;              /*SCAN ASSOCIATIONS ONLY      */ 08317000
         OI    PTLFBAS1(@07),B'00100000'                           2027 08318000
*          PTLSN = PTINDX4;            /*SEQ NO. OF ASSOCIATION      */ 08319000
         LH    @04,PTINDX4(,@07)                                   2028 08320000
         STH   @04,PTLSN(,@07)                                     2028 08321000
*          CALL LOCDIT;                                            2029 08322000
*                                                                  2029 08323000
         BAL   @14,LOCDIT                                          2029 08324000
*        /************************************************************/ 08325000
*        /*                                                          */ 08326000
*        /* IF NO ASSOCIATION - ERROR                                */ 08327000
*        /*                                                          */ 08328000
*        /************************************************************/ 08329000
*                                                                  2030 08330000
*          IF PTLCDIT = 0 THEN                                     2030 08331000
         L     @07,RSPTWKC(,REG6)                                  2030 08332000
         L     @04,PTLCDIT(,@07)                                   2030 08333000
         LTR   @04,@04                                             2030 08334000
         BNZ   @RF02030                                            2030 08335000
*            PTF1OK = OFF;             /*ERROR: EXPECTED ASSN NOT FND*/ 08336000
*                                                                  2031 08337000
         NI    PTF1OK(@07),B'11011111'                             2031 08338000
*        /************************************************************/ 08339000
*        /*                                                          */ 08340000
*        /* CHECK IF ASSOCIATION TO EXPECTED OBJECT                  */ 08341000
*        /*                                                          */ 08342000
*        /************************************************************/ 08343000
*                                                                  2032 08344000
*          ELSE                                                    2032 08345000
*            DO;                                                   2032 08346000
         B     @RC02030                                            2032 08347000
@RF02030 DS    0H                                                  2033 08348000
*              PTASDIT1 = PTLCDIT;     /*SAVE ASSOCIATION            */ 08349000
         L     @07,RSPTWKC(,REG6)                                  2033 08350000
         L     @04,PTASSOEA(,@07)                                  2033 08351000
         L     @07,PTLCDIT(,@07)                                   2033 08352000
         ST    @07,PTASDIT1(,@04)                                  2033 08353000
*              RSTANCHR = ADDR(RSGCITS);                           2034 08354000
         LA    @04,RSGCITS(,REG6)                                  2034 08355000
         ST    @04,RSTANCHR(,REG6)                                 2034 08356000
*              RSTENTIX = PTLCDIT->DITCITAB; /*GET ASSN CITABE INDX  */ 08357000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      2035 08358000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 08359000
*              CALL GETNEXTE;                                      2036 08360000
         L     @15,@CV03436                                        2036 08361000
         BALR  @14,@15                                             2036 08362000
*              IF RSTENTAD->CITFAVER=OFF |                         2037 08363000
*               RSTENTAD->CITTYPE^=PTASSEX(PTINDX4:PTINDX4) THEN   2037 08364000
         L     @07,RSTENTAD(,REG6)                                 2037 08365000
         TM    CITFAVER(@07),B'01000000'                           2037 08366000
         BZ    @RT02037                                            2037 08367000
         L     @04,RSPTWKC(,REG6)                                  2037 08368000
         LH    @01,PTINDX4(,@04)                                   2037 08369000
         L     @04,PTASSEXP(,@04)                                  2037 08370000
         ALR   @04,@01                                             2037 08371000
         BCTR  @04,0                                               2037 08372000
         CLC   CITTYPE(1,@07),PTASSEX(@04)                         2037 08373000
         BE    @RF02037                                            2037 08374000
@RT02037 DS    0H                                                  2038 08375000
*                PTF1OK=OFF;                                       2038 08376000
         L     @07,RSPTWKC(,REG6)                                  2038 08377000
         NI    PTF1OK(@07),B'11011111'                             2038 08378000
*              ELSE                                                2039 08379000
*                                      /* ASSOCIATION VERIFIED       */ 08380000
*                DO;                                               2039 08381000
         B     @RC02037                                            2039 08382000
@RF02037 DS    0H                                                  2040 08383000
*                  PTASDIT1->DITFAVER = ON; /*MARK ASSN VERIFIED     */ 08384000
         L     @07,RSPTWKC(,REG6)                                  2040 08385000
         L     @04,PTASSOEA(,@07)                                  2040 08386000
         L     @01,PTASDIT1(,@04)                                  2040 08387000
         OI    DITFAVER(@01),B'01000000'                           2040 08388000
*                  PTASSOEA = PTASSOEA + LENGTH(PTASOE); /*NEXT ENTRY*/ 08389000
         AL    @04,@CF00175                                        2041 08390000
         ST    @04,PTASSOEA(,@07)                                  2041 08391000
*                END;                                              2042 08392000
*            END;                                                  2043 08393000
@RC02037 DS    0H                                                  2044 08394000
*        END;                                                      2044 08395000
*                                                                  2044 08396000
@RC02030 L     @04,RSPTWKC(,REG6)                                  2044 08397000
         LA    @07,1                                               2044 08398000
         AH    @07,PTINDX4(,@04)                                   2044 08399000
@DE02024 L     @04,RSPTWKC(,REG6)                                  2044 08400000
         STH   @07,PTINDX4(,@04)                                   2044 08401000
         L     @04,RSPTWKC(,REG6)                                  2044 08402000
         CH    @07,PTINDXV(,@04)                                   2044 08403000
         BNH   @DL02024                                            2044 08404000
@DC02024 DS    0H                                                  2045 08405000
*        /************************************************************/ 08406000
*        /*                                                          */ 08407000
*        /* IF ERROR ISSUE MESSAGE IDC11023I                         */ 08408000
*        /*                                                          */ 08409000
*        /************************************************************/ 08410000
*                                                                  2045 08411000
*        PTINDX4 = PTINDX4 - 1;        /*LAST ENTRY PROCESSED        */ 08412000
         L     @07,RSPTWKC(,REG6)                                  2045 08413000
         LH    @04,PTINDX4(,@07)                                   2045 08414000
         BCTR  @04,0                                               2045 08415000
         STH   @04,PTINDX4(,@07)                                   2045 08416000
*        IF PTF1OK = OFF THEN                                      2046 08417000
         TM    PTF1OK(@07),B'00100000'                             2046 08418000
         BNZ   @RF02046                                            2046 08419000
*                                      /*ASSOCIATION MISSING         */ 08420000
*                                                                  2047 08421000
*          DO;                                                     2047 08422000
*          /*CALL CKERR*/                                          2048 08423000
*            RSCKERR = RSCKERR && RSCKERR;                         2048 08424000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2048 08425000
*            RSCKERN = RSE041;                                     2049 08426000
         MVC   RSCKERN(2,REG6),@CH00969                            2049 08427000
*            RSCKTERM = 'RETU';                                    2050 08428000
         MVC   RSCKTERM(4,REG6),@CC03787                           2050 08429000
*            RSCKMVAR(1) = ADDR(PTBASE->CNAME);                    2051 08430000
         L     @01,PTBASE(,@07)                                    2051 08431000
         LA    @15,CNAME(,@01)                                     2051 08432000
         ST    @15,RSCKMVAR(,REG6)                                 2051 08433000
*            RSCKMVAR(2) = ADDR(PATHID);                           2052 08434000
         LA    @15,@CC00818                                        2052 08435000
         ST    @15,RSCKMVAR+4(,REG6)                               2052 08436000
*            RSCKMVAR(3) = ADDR(PTASSEX(PTINDX4:PTINDX4));         2053 08437000
*                                                                  2053 08438000
         L     @07,PTASSEXP(,@07)                                  2053 08439000
         BCTR  @07,0                                               2053 08440000
         LA    @07,PTASSEX(@04,@07)                                2053 08441000
         ST    @07,RSCKMVAR+8(,REG6)                               2053 08442000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */ 08443000
*          CALL CKERR;                                             2054 08444000
         L     @15,@CV03449                                        2054 08445000
         BALR  @14,@15                                             2054 08446000
*          END;                                                    2055 08447000
*                                                                  2055 08448000
*        /************************************************************/ 08449000
*        /*                                                          */ 08450000
*        /* ASSOCIATION CHECKED - MARK PATH VERIFIED                 */ 08451000
*        /*                                                          */ 08452000
*        /************************************************************/ 08453000
*                                                                  2056 08454000
*        ELSE                                                      2056 08455000
*          DO;                                                     2056 08456000
         B     @RC02046                                            2056 08457000
@RF02046 DS    0H                                                  2057 08458000
*            PTCITF->CITFAVER = ON;                                2057 08459000
*                                                                  2057 08460000
         L     @07,RSPTWKC(,REG6)                                  2057 08461000
         L     @04,PTCITF(,@07)                                    2057 08462000
         OI    CITFAVER(@04),B'01000000'                           2057 08463000
*        /************************************************************/ 08464000
*        /*                                                          */ 08465000
*        /* SCAN BASE FOR ASSOCIATION TO PATH                        */ 08466000
*        /*                                                          */ 08467000
*        /************************************************************/ 08468000
*                                                                  2058 08469000
*            PTF1OK = OFF;                                         2058 08470000
         NI    PTF1OK(@07),B'11011111'                             2058 08471000
*            PTLOC = PTLOC && PTLOC;                               2059 08472000
         XC    PTLOC(20,@07),PTLOC(@07)                            2059 08473000
*            PTLBCITX = PTASSDIT(1)->DITCITAB; /*C OR G CITABE       */ 08474000
         L     @04,PTASSDIT(,@07)                                  2060 08475000
         MVC   PTLBCITX(3,@07),DITCITAB(@04)                       2060 08476000
*            PTLFBAS1 = ON;            /*ASSOCIATION ONLY SCAN       */ 08477000
         OI    PTLFBAS1(@07),B'00100000'                           2061 08478000
*            PTLDITID = PATHID;        /*SCAN FOR PATH ONLY          */ 08479000
         MVI   PTLDITID(@07),C'R'                                  2062 08480000
*            DO WHILE (PTF1OK = OFF);                              2063 08481000
         B     @DE02063                                            2063 08482000
@DL02063 DS    0H                                                  2064 08483000
*              CALL LOCDIT;                                        2064 08484000
         BAL   @14,LOCDIT                                          2064 08485000
*                                      /*GET NEXT BASE ASSN FOR PATH */ 08486000
*              IF PTLCDIT = 0 THEN     /*SHOULD FIND PATH ASSN       */ 08487000
*                                                                  2065 08488000
         L     @07,RSPTWKC(,REG6)                                  2065 08489000
         L     @07,PTLCDIT(,@07)                                   2065 08490000
         LTR   @07,@07                                             2065 08491000
         BNZ   @RF02065                                            2065 08492000
*                DO;                                               2066 08493000
*                /*CALL CKERR*/                                    2067 08494000
*                  RSCKERR = RSCKERR && RSCKERR;                   2067 08495000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2067 08496000
*                  RSCKERN = RSE100;                               2068 08497000
         MVC   RSCKERN(2,REG6),@CH00143                            2068 08498000
*                  RSCKTERM = 'TERM';                              2069 08499000
*                                                                  2069 08500000
         MVC   RSCKTERM(4,REG6),@CC03762                           2069 08501000
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */ 08502000
*                CALL CKERR;                                       2070 08503000
         L     @15,@CV03449                                        2070 08504000
         BALR  @14,@15                                             2070 08505000
*                END;                                              2071 08506000
*              RSTANCHR = ADDR(RSGCITS);                           2072 08507000
@RF02065 LA    @07,RSGCITS(,REG6)                                  2072 08508000
         ST    @07,RSTANCHR(,REG6)                                 2072 08509000
*              RSTENTIX = PTLCDIT->DITCITAB; /*A PATH CI TABLE ENTRY */ 08510000
         L     @07,RSPTWKC(,REG6)                                  2073 08511000
         L     @07,PTLCDIT(,@07)                                   2073 08512000
         MVC   RSTENTIX(3,REG6),DITCITAB(@07)                      2073 08513000
*              /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE      */ 08514000
*              CALL GETNEXTE;                                      2074 08515000
         L     @15,@CV03436                                        2074 08516000
         BALR  @14,@15                                             2074 08517000
*                                      /*GET PATH ENTRY              */ 08518000
*                                                                  2075 08519000
*        /************************************************************/ 08520000
*        /*                                                          */ 08521000
*        /* IF BASE->PATH FOUND, MARK AS VERIFIED                    */ 08522000
*        /*                                                          */ 08523000
*        /************************************************************/ 08524000
*                                                                  2075 08525000
*              IF RSTENTAD->CITCIN = PTCITF->CITCIN THEN           2075 08526000
         L     @07,RSTENTAD(,REG6)                                 2075 08527000
         L     @04,RSPTWKC(,REG6)                                  2075 08528000
         L     @01,PTCITF(,@04)                                    2075 08529000
         CLC   CITCIN(3,@07),CITCIN(@01)                           2075 08530000
         BNE   @RF02075                                            2075 08531000
*                DO;                                               2076 08532000
*                  PTLCDIT->DITFAVER = ON; /*MARK C OR G ->PATH VER  */ 08533000
         L     @07,PTLCDIT(,@04)                                   2077 08534000
         OI    DITFAVER(@07),B'01000000'                           2077 08535000
*                  PTF1OK = ON;                                    2078 08536000
         OI    PTF1OK(@04),B'00100000'                             2078 08537000
*                END;                                              2079 08538000
*            END;                                                  2080 08539000
@RF02075 DS    0H                                                  2080 08540000
@DE02063 L     @07,RSPTWKC(,REG6)                                  2080 08541000
         TM    PTF1OK(@07),B'00100000'                             2080 08542000
         BZ    @DL02063                                            2080 08543000
*          END;                                                    2081 08544000
*                                                                  2081 08545000
* CALL EXIT;  /*TERMINATE*/                                        2082 08546000
@RC02046 BAL   @14,EXIT                                            2082 08547000
* END VERR; /*END OF PROCEDURE*/                                   2083 08548000
@EL00014 DS    0H                                                  2083 08549000
@EF00014 DS    0H                                                  2083 08550000
@ER00014 BR    @14                                                 2083 08551000
@PB00014 DS    0H                                                  2084 08552000
*/********************************************************************/ 08553000
*/*                                                                  */ 08554000
*/* PROCEDURE - VERU                                                 */ 08555000
*/*                                                                  */ 08556000
*/* FUNCTION -                                                       */ 08557000
*/*     VERIFY ANY ALIASES FOR USERCATALOGS                          */ 08558000
*/*                                                                  */ 08559000
*/* INPUT -                                                          */ 08560000
*/*    CI TABLE AND DI TABLE FOR THE PATH                            */ 08561000
*/*                                                                  */ 08562000
*/* OUTPUT -                                                         */ 08563000
*/*     CITFAVER - SET ON IN USERCATALOG RECORD TO                   */ 08564000
*/*                INDICATE THAT THE ENTRY IS GOOD.                  */ 08565000
*/*                                                                  */ 08566000
*/********************************************************************/ 08567000
*      GENERATE;                                                   2084 08568000
         DS    0F                                                       08569000
NAME0225 DC    CL8'VERU'                                                08570000
*VERU: PROCEDURE                                                   2085 08571000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2085 08572000
*                                                                  2085 08573000
         B     @PB00015                                            2085 08574000
VERU     DS    0H                                                  2086 08575000
*      GENERATE REFS(RS02RG08, REG6);                              2086 08576000
*                                                                  2086 08577000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          08578000
         LR    @15,@13  OLD SAVE AREA                                   08579000
         LA    @13,72(@13)  NEW SAVE AREA                               08580000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     08581000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        08582000
         MVC   0(4,@15),NAME0225  PROCNAME TO REGSAVE                   08583000
*        OLDERID2 = NEWERID2;                                      2087 08584000
         L     @07,GDTTR2(,REG5)                                   2087 08585000
         MVC   @TS00001(95),NEWERID2(@07)                          2087 08586000
         MVC   OLDERID2(95,@07),@TS00001                           2087 08587000
*        NEWID2 = 'RSVU';                                          2088 08588000
*                                                                  2088 08589000
         MVC   NEWID2(4,@07),@CC03924                              2088 08590000
*        /************************************************************/ 08591000
*        /*                                                          */ 08592000
*        /*  INDICATE THE USERCATALOG RECORD AS VERIFIED             */ 08593000
*        /*                                                          */ 08594000
*        /************************************************************/ 08595000
*                                                                  2089 08596000
*        PTCITF->CITFAVER = ON;                                    2089 08597000
*                                                                  2089 08598000
         L     @07,RSPTWKC(,REG6)                                  2089 08599000
         L     @07,PTCITF(,@07)                                    2089 08600000
         OI    CITFAVER(@07),B'01000000'                           2089 08601000
*        /************************************************************/ 08602000
*        /*                                                          */ 08603000
*        /*  VERIFY ANY ALIASES OF THE USERCATALOG                   */ 08604000
*        /*                                                          */ 08605000
*        /************************************************************/ 08606000
*                                                                  2090 08607000
*        CALL VERX;                                                2090 08608000
         BAL   @14,VERX                                            2090 08609000
* CALL EXIT;  /*TERMINATE*/                                        2091 08610000
         BAL   @14,EXIT                                            2091 08611000
* END VERU; /*END OF PROCEDURE*/                                   2092 08612000
@EL00015 DS    0H                                                  2092 08613000
@EF00015 DS    0H                                                  2092 08614000
@ER00015 BR    @14                                                 2092 08615000
@PB00015 DS    0H                                                  2093 08616000
*/********************************************************************/ 08617000
*/*                                                                  */ 08618000
*/* PROCEDURE - VERX                                                 */ 08619000
*/*                                                                  */ 08620000
*/* FUNCTION -                                                       */ 08621000
*/*     VERIFY ALIAS CHAINS FOR NONVSAM AND USERCATALOG RECORDS.     */ 08622000
*/*     IF THERE IS AN ERROR, REPAIR THE ALIAS CHAIN.                */ 08623000
*/*                                                                  */ 08624000
*/* INPUT -                                                          */ 08625000
*/*    CI TABLE AND DI TABLE FOR THE BASE A OR U                     */ 08626000
*/*     PTBASE - ADDRESS OF THE BASE RECORD                          */ 08627000
*/*     PTCITI - CITABE INDEX FOR THE BASE A OR U                    */ 08628000
*/*                                                                  */ 08629000
*/* OUTPUT -                                                         */ 08630000
*/*     CITFAVER - SET ON IN ALL VERIFIED ALIASES                    */ 08631000
*/*     DITFAVER - SET ON IN ALL VERIFIED ASSOCIATIONS               */ 08632000
*/*                                                                  */ 08633000
*/* MESSAGES -                                                       */ 08634000
*/*     IDC21024I - BAD ALIAS CHAIN                                  */ 08635000
*/*                                                                  */ 08636000
*/********************************************************************/ 08637000
*      GENERATE;                                                   2093 08638000
         DS    0F                                                       08639000
NAME0228 DC    CL8'VERX'                                                08640000
*VERX: PROCEDURE                                                   2094 08641000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               2094 08642000
*                                                                  2094 08643000
         B     @PB00016                                            2094 08644000
VERX     DS    0H                                                  2095 08645000
*      GENERATE REFS(RS02RG08, REG6);                              2095 08646000
*                                                                  2095 08647000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          08648000
         LR    @15,@13  OLD SAVE AREA                                   08649000
         LA    @13,72(@13)  NEW SAVE AREA                               08650000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     08651000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        08652000
         MVC   0(4,@15),NAME0228  PROCNAME TO REGSAVE                   08653000
*        OLDERID2 = NEWERID2;                                      2096 08654000
         L     @07,GDTTR2(,REG5)                                   2096 08655000
         MVC   @TS00001(95),NEWERID2(@07)                          2096 08656000
         MVC   OLDERID2(95,@07),@TS00001                           2096 08657000
*        NEWID2 = 'RSVX';                                          2097 08658000
*                                                                  2097 08659000
         MVC   NEWID2(4,@07),@CC03928                              2097 08660000
*        /************************************************************/ 08661000
*        /*                                                          */ 08662000
*        /*  SCAN THE BASE NONVSAM OR USERCATALOG FOR AN             */ 08663000
*        /*  ASSOCIATION TO AN ALIAS.                                */ 08664000
*        /*                                                          */ 08665000
*        /************************************************************/ 08666000
*                                                                  2098 08667000
*        PTLOC = PTLOC && PTLOC;                                   2098 08668000
         L     @07,RSPTWKC(,REG6)                                  2098 08669000
         XC    PTLOC(20,@07),PTLOC(@07)                            2098 08670000
*        PTLBCITX = PTCITI;            /*SCAN A OR U                 */ 08671000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         2099 08672000
*        PTLFBAS1 = ON;                /*ASSOCIATION ONLY            */ 08673000
         OI    PTLFBAS1(@07),B'00100000'                           2100 08674000
*        PTLDITID = ALIASID;           /*TO AN ALIAS                 */ 08675000
         MVI   PTLDITID(@07),C'X'                                  2101 08676000
*        CALL LOCDIT;                                              2102 08677000
*                                                                  2102 08678000
         BAL   @14,LOCDIT                                          2102 08679000
*        /************************************************************/ 08680000
*        /*                                                          */ 08681000
*        /*  PERFORM ALIAS CHECKING                                  */ 08682000
*        /*                                                          */ 08683000
*        /************************************************************/ 08684000
*                                                                  2103 08685000
*        IF PTLCDIT ^= 0 THEN                                      2103 08686000
         SLR   @07,@07                                             2103 08687000
         L     @04,RSPTWKC(,REG6)                                  2103 08688000
         L     @15,PTLCDIT(,@04)                                   2103 08689000
         CR    @15,@07                                             2103 08690000
         BE    @RF02103                                            2103 08691000
*          DO;                                                     2104 08692000
*                                                                  2104 08693000
*        /************************************************************/ 08694000
*        /*                                                          */ 08695000
*        /*     SET UP THE INITIAL ALIAS                             */ 08696000
*        /*                                                          */ 08697000
*        /************************************************************/ 08698000
*                                                                  2105 08699000
*            PTXUX1D = PTLCDIT;        /*U OR A PTR 1ST ALIAS        */ 08700000
         ST    @15,PTXUX1D(,@04)                                   2105 08701000
*            PTXX1C = 0;               /*CURRENT ALIAS = NONE        */ 08702000
         STH   @07,PTXX1C(,@04)                                    2106 08703000
*            PTXX2C = PTXUX1D->DITCITAB; /*NEXT ALIAS RECORD         */ 08704000
*                                                                  2107 08705000
         L     @07,DITCITAB-1(,@15)                                2107 08706000
         LA    @07,0(,@07)                                         2107 08707000
         STH   @07,PTXX2C(,@04)                                    2107 08708000
*        /************************************************************/ 08709000
*        /*                                                          */ 08710000
*        /*     PROCESS ALL VALID ALIASES                            */ 08711000
*        /*                                                          */ 08712000
*        /************************************************************/ 08713000
*                                                                  2108 08714000
*  ALIASCHK:                                                       2108 08715000
*            DO UNTIL (PTXEND = ON);                               2108 08716000
ALIASCHK DS    0H                                                  2108 08717000
@DL02108 DS    0H                                                  2109 08718000
*              PTXEND = ON;            /*UNLESS VALID X - KILL IT    */ 08719000
*                                                                  2109 08720000
         L     @07,RSPTWKC(,REG6)                                  2109 08721000
         OI    PTXEND(@07),B'10000000'                             2109 08722000
*        /************************************************************/ 08723000
*        /*                                                          */ 08724000
*        /*     CHANGE CURRENT X TO PREVIOUS X                       */ 08725000
*        /*                                                          */ 08726000
*        /************************************************************/ 08727000
*                                                                  2110 08728000
*              PTXX0C = PTXX1C;                                    2110 08729000
         LH    @04,PTXX1C(,@07)                                    2110 08730000
         STH   @04,PTXX0C(,@07)                                    2110 08731000
*              PTXX0X1D = PTXX1X2D;    /*PREV FORWARD ASSOCIATION    */ 08732000
*                                                                  2111 08733000
         L     @15,PTXX1X2D(,@07)                                  2111 08734000
         ST    @15,PTXX0X1D(,@07)                                  2111 08735000
*        /************************************************************/ 08736000
*        /*                                                          */ 08737000
*        /*     CHANGE NEXT X TO CURRENT X                           */ 08738000
*        /*                                                          */ 08739000
*        /************************************************************/ 08740000
*                                                                  2112 08741000
*              PTXX1C = PTXX2C;                                    2112 08742000
*                                                                  2112 08743000
         LH    @15,PTXX2C(,@07)                                    2112 08744000
         STH   @15,PTXX1C(,@07)                                    2112 08745000
*        /************************************************************/ 08746000
*        /*                                                          */ 08747000
*        /*     CLEAR ASSOCIATIONS FOR CURRENT ALIAS                 */ 08748000
*        /*                                                          */ 08749000
*        /************************************************************/ 08750000
*                                                                  2113 08751000
*              PTXX1AUD = 0;                                       2113 08752000
         SLR   @14,@14                                             2113 08753000
         ST    @14,PTXX1AUD(,@07)                                  2113 08754000
*              PTXX1X2D = 0;                                       2114 08755000
         ST    @14,PTXX1X2D(,@07)                                  2114 08756000
*              PTXX1X0D = 0;                                       2115 08757000
*                                                                  2115 08758000
         ST    @14,PTXX1X0D(,@07)                                  2115 08759000
*        /************************************************************/ 08760000
*        /*                                                          */ 08761000
*        /*     GET THE CURRENT ALIAS RECORD CI TABLE ENTRY          */ 08762000
*        /*                                                          */ 08763000
*        /************************************************************/ 08764000
*                                                                  2116 08765000
*              IF PTXX0C = 0 & PTXX2C = 0 THEN;                    2116 08766000
         CR    @04,@14                                             2116 08767000
         BNE   @RF02116                                            2116 08768000
         CR    @15,@14                                             2116 08769000
         BE    @RT02116                                            2116 08770000
*                                      /*BAD BASE ASSOCIATION        */ 08771000
*              ELSE                                                2118 08772000
*                DO;                                               2118 08773000
@RF02116 DS    0H                                                  2119 08774000
*                  RSTANCHR = ADDR(RSGCITS);                       2119 08775000
         LA    @07,RSGCITS(,REG6)                                  2119 08776000
         ST    @07,RSTANCHR(,REG6)                                 2119 08777000
*                  RSTENTIX = PTXX1C;                              2120 08778000
         L     @07,RSPTWKC(,REG6)                                  2120 08779000
         LH    @07,PTXX1C(,@07)                                    2120 08780000
         STCM  @07,7,RSTENTIX(REG6)                                2120 08781000
*                  /* CALL TO MODULE IDCRS03 FOR PROCEDURE GETNEXTE  */ 08782000
*                  CALL GETNEXTE;                                  2121 08783000
         L     @15,@CV03436                                        2121 08784000
         BALR  @14,@15                                             2121 08785000
*                  PTXCITX1 = RSTENTAD;                            2122 08786000
*                                                                  2122 08787000
         L     @07,RSPTWKC(,REG6)                                  2122 08788000
         L     @04,RSTENTAD(,REG6)                                 2122 08789000
         ST    @04,PTXCITX1(,@07)                                  2122 08790000
*        /************************************************************/ 08791000
*        /*                                                          */ 08792000
*        /*     ENSURE VALID RECORD                                  */ 08793000
*        /*                                                          */ 08794000
*        /************************************************************/ 08795000
*                                                                  2123 08796000
*                  IF PTXCITX1->CITFAINV = ON THEN;                2123 08797000
*                                                                  2123 08798000
         TM    CITFAINV(@04),B'00000010'                           2123 08799000
         BO    @RT02123                                            2123 08800000
*        /************************************************************/ 08801000
*        /*                                                          */ 08802000
*        /*     VERIFY ALIAS ASSOCIATION TO THE BASE                 */ 08803000
*        /*                                                          */ 08804000
*        /************************************************************/ 08805000
*                                                                  2125 08806000
*                  ELSE                                            2125 08807000
*                    DO;                                           2125 08808000
*                      PTLOC = PTLOC && PTLOC;                     2126 08809000
         L     @07,RSPTWKC(,REG6)                                  2126 08810000
         XC    PTLOC(20,@07),PTLOC(@07)                            2126 08811000
*                      PTLBCITX = PTXX1C; /*SCAN ALIAS               */ 08812000
         LH    @04,PTXX1C(,@07)                                    2127 08813000
         STCM  @04,7,PTLBCITX(@07)                                 2127 08814000
*                      PTLFBAS1 = ON;  /*ASSOCIATION ONLY            */ 08815000
         OI    PTLFBAS1(@07),B'00100000'                           2128 08816000
*                      PTLDITID = PTCITF->CITTYPE; /*TO BASE         */ 08817000
         L     @04,PTCITF(,@07)                                    2129 08818000
         MVC   PTLDITID(1,@07),CITTYPE(@04)                        2129 08819000
*                      PTLSN = 1;                                  2130 08820000
         MVC   PTLSN(2,@07),@CH00212                               2130 08821000
*                      CALL LOCDIT;                                2131 08822000
         BAL   @14,LOCDIT                                          2131 08823000
*                      PTXX1AUD = PTLCDIT;                         2132 08824000
*                                                                  2132 08825000
         L     @07,RSPTWKC(,REG6)                                  2132 08826000
         L     @04,PTLCDIT(,@07)                                   2132 08827000
         ST    @04,PTXX1AUD(,@07)                                  2132 08828000
*        /************************************************************/ 08829000
*        /*                                                          */ 08830000
*        /*       ERROR ** NO ASSOCIATION TO THE BASE                */ 08831000
*        /*                                                          */ 08832000
*        /************************************************************/ 08833000
*                                                                  2133 08834000
*                      IF (PTLCDIT = 0) |                          2133 08835000
*                       (PTLCDIT->DITCITAB ^= PTCITI) THEN;        2133 08836000
*                                                                  2133 08837000
         LTR   @04,@04                                             2133 08838000
         BZ    @RT02133                                            2133 08839000
         CLC   DITCITAB(3,@04),PTCITI(@07)                         2133 08840000
         BNE   @RT02133                                            2133 08841000
*        /************************************************************/ 08842000
*        /*                                                          */ 08843000
*        /*     VERIFY ALIAS BACK CHAIN TO PREVIOUS ALIAS            */ 08844000
*        /*                                                          */ 08845000
*        /************************************************************/ 08846000
*                                                                  2135 08847000
*                      ELSE                                        2135 08848000
*                        DO;                                       2135 08849000
*                          PTLOC = PTLOC && PTLOC;                 2136 08850000
         L     @07,RSPTWKC(,REG6)                                  2136 08851000
         XC    PTLOC(20,@07),PTLOC(@07)                            2136 08852000
*                          PTLBCITX = PTXX1C; /*SCAN ALIAS           */ 08853000
         LH    @04,PTXX1C(,@07)                                    2137 08854000
         STCM  @04,7,PTLBCITX(@07)                                 2137 08855000
*                          PTLFBAS1 = ON; /*ASSOCIATION ONLY         */ 08856000
         OI    PTLFBAS1(@07),B'00100000'                           2138 08857000
*                          PTLDITID = ALIASID; /*TO AN ALIAS         */ 08858000
         MVI   PTLDITID(@07),C'X'                                  2139 08859000
*                          PTLSN = 3; /*THIRD ASSOCIATION            */ 08860000
         MVC   PTLSN(2,@07),@CH00158                               2140 08861000
*                          CALL LOCDIT;                            2141 08862000
         BAL   @14,LOCDIT                                          2141 08863000
*                          PTXX1X0D = PTLCDIT;                     2142 08864000
*                                                                  2142 08865000
         L     @07,RSPTWKC(,REG6)                                  2142 08866000
         L     @04,PTLCDIT(,@07)                                   2142 08867000
         ST    @04,PTXX1X0D(,@07)                                  2142 08868000
*        /************************************************************/ 08869000
*        /*                                                          */ 08870000
*        /*       ERROR ** NO ASSOCIATION BACK TO PREVIOUS ALIAS OR  */ 08871000
*        /*       ASSOCIATION DOES NOT POINT TO PREVIOUS ALIAS       */ 08872000
*        /*                                                          */ 08873000
*        /************************************************************/ 08874000
*                                                                  2143 08875000
*                          IF (PTXX1X0D = 0) |                     2143 08876000
*                           (PTXX1X0D->DITCITAB ^= PTXX0C) THEN;   2143 08877000
*                                                                  2143 08878000
         LTR   @04,@04                                             2143 08879000
         BZ    @RT02143                                            2143 08880000
         L     @04,DITCITAB-1(,@04)                                2143 08881000
         LA    @04,0(,@04)                                         2143 08882000
         CH    @04,PTXX0C(,@07)                                    2143 08883000
         BNE   @RT02143                                            2143 08884000
*        /************************************************************/ 08885000
*        /*                                                          */ 08886000
*        /*     VERIFY ALIAS FORWARD CHAIN EXISTS                    */ 08887000
*        /*                                                          */ 08888000
*        /************************************************************/ 08889000
*                                                                  2145 08890000
*                          ELSE                                    2145 08891000
*                            DO;                                   2145 08892000
*                              PTLOC = PTLOC && PTLOC;             2146 08893000
         L     @07,RSPTWKC(,REG6)                                  2146 08894000
         XC    PTLOC(20,@07),PTLOC(@07)                            2146 08895000
*                              PTLBCITX = PTXX1C; /*SCAN ALIAS       */ 08896000
         LH    @04,PTXX1C(,@07)                                    2147 08897000
         STCM  @04,7,PTLBCITX(@07)                                 2147 08898000
*                              PTLFBAS1 = ON; /*ASSOCIATION ONLY     */ 08899000
         OI    PTLFBAS1(@07),B'00100000'                           2148 08900000
*                              PTLDITID = ALIASID; /*TO AN ALIAS     */ 08901000
         MVI   PTLDITID(@07),C'X'                                  2149 08902000
*                              PTLSN = 2; /*2ND ASSOCIATION          */ 08903000
         MVC   PTLSN(2,@07),@CH00149                               2150 08904000
*                              CALL LOCDIT;                        2151 08905000
         BAL   @14,LOCDIT                                          2151 08906000
*                              PTXX1X2D = PTLCDIT; /*SAVE FORW ASSN  */ 08907000
*                                                                  2152 08908000
         L     @07,RSPTWKC(,REG6)                                  2152 08909000
         L     @04,PTLCDIT(,@07)                                   2152 08910000
         ST    @04,PTXX1X2D(,@07)                                  2152 08911000
*        /************************************************************/ 08912000
*        /*                                                          */ 08913000
*        /*       ERROR ** NO ASSOCIATION FORWARD                    */ 08914000
*        /*                                                          */ 08915000
*        /************************************************************/ 08916000
*                                                                  2153 08917000
*                              IF PTLCDIT = 0 THEN;                2153 08918000
*                                                                  2153 08919000
         LTR   @04,@04                                             2153 08920000
         BZ    @RT02153                                            2153 08921000
*        /************************************************************/ 08922000
*        /*                                                          */ 08923000
*        /*     GOOD ALIAS - MARK ALL ASSOCIATION CHECKED AND        */ 08924000
*        /*       THE ALIAS RECORD ITSELF AS VERIFIED.               */ 08925000
*        /*                                                          */ 08926000
*        /************************************************************/ 08927000
*                                                                  2155 08928000
*                              ELSE                                2155 08929000
*                                DO;                               2155 08930000
*                                  PTXX2C = PTLCDIT->DITCITAB; /*NXT */ 08931000
         L     @07,RSPTWKC(,REG6)                                  2156 08932000
         L     @04,PTLCDIT(,@07)                                   2156 08933000
         L     @04,DITCITAB-1(,@04)                                2156 08934000
         LA    @04,0(,@04)                                         2156 08935000
         STH   @04,PTXX2C(,@07)                                    2156 08936000
*                                  PTXCITX1->CITFAVER=ON; /*ALIAS OK */ 08937000
         L     @04,PTXCITX1(,@07)                                  2157 08938000
         OI    CITFAVER(@04),B'01000000'                           2157 08939000
*                                  PTXX1AUD->DITFAVER=ON; /*X->BASE  */ 08940000
         L     @04,PTXX1AUD(,@07)                                  2158 08941000
         OI    DITFAVER(@04),B'01000000'                           2158 08942000
*                                  PTXX1X0D->DITFAVER=ON; /*X BACK CH*/ 08943000
         L     @04,PTXX1X0D(,@07)                                  2159 08944000
         OI    DITFAVER(@04),B'01000000'                           2159 08945000
*                                  PTXX1X2D->DITFAVER=ON; /*X FORW CH*/ 08946000
*                                                                  2160 08947000
         L     @04,PTXX1X2D(,@07)                                  2160 08948000
         OI    DITFAVER(@04),B'01000000'                           2160 08949000
*        /************************************************************/ 08950000
*        /*                                                          */ 08951000
*        /*       MARK BASE ASSOCIATION TO 1ST ALIAS AS VERIFIED     */ 08952000
*        /*                                                          */ 08953000
*        /************************************************************/ 08954000
*                                                                  2161 08955000
*                                  IF PTXX0C = 0 THEN              2161 08956000
         LH    @04,PTXX0C(,@07)                                    2161 08957000
         LTR   @04,@04                                             2161 08958000
         BNZ   @RF02161                                            2161 08959000
*                                    PTXUX1D->DITFAVER = ON;       2162 08960000
*                                                                  2162 08961000
         L     @07,PTXUX1D(,@07)                                   2162 08962000
         OI    DITFAVER(@07),B'01000000'                           2162 08963000
*        /************************************************************/ 08964000
*        /*                                                          */ 08965000
*        /*     IF NOT LAST ENTRY - PROCESS THE NEXT ALIAS           */ 08966000
*        /*                                                          */ 08967000
*        /************************************************************/ 08968000
*                                                                  2163 08969000
*                                  IF PTXX2C ^= 0 THEN             2163 08970000
@RF02161 L     @07,RSPTWKC(,REG6)                                  2163 08971000
         LH    @04,PTXX2C(,@07)                                    2163 08972000
         LTR   @04,@04                                             2163 08973000
         BZ    @RF02163                                            2163 08974000
*                                    PTXEND = OFF;                 2164 08975000
         NI    PTXEND(@07),B'01111111'                             2164 08976000
*                                END;                              2165 08977000
@RF02163 DS    0H                                                  2166 08978000
*                            END;                                  2166 08979000
@RT02153 DS    0H                                                  2167 08980000
*                        END;                                      2167 08981000
@RT02143 DS    0H                                                  2168 08982000
*                    END;                                          2168 08983000
@RT02133 DS    0H                                                  2169 08984000
*                END;                                              2169 08985000
@RT02123 DS    0H                                                  2170 08986000
*            END ALIASCHK;                                         2170 08987000
*                                                                  2170 08988000
@RT02116 DS    0H                                                  2170 08989000
@DE02108 L     @07,RSPTWKC(,REG6)                                  2170 08990000
         TM    PTXEND(@07),B'10000000'                             2170 08991000
         BNO   @DL02108                                            2170 08992000
*        /************************************************************/ 08993000
*        /*                                                          */ 08994000
*        /*  REPAIR THE ALIAS CHAIN IF ERROR                         */ 08995000
*        /*                                                          */ 08996000
*        /************************************************************/ 08997000
*                                                                  2171 08998000
*            IF PTXX2C ^= 0 THEN       /*NEVER PROCESSED THE LAST    */ 08999000
         LH    @04,PTXX2C(,@07)                                    2171 09000000
         LTR   @04,@04                                             2171 09001000
         BZ    @RF02171                                            2171 09002000
*              DO;                                                 2172 09003000
*                                                                  2172 09004000
*        /************************************************************/ 09005000
*        /*                                                          */ 09006000
*        /*     ISSUE MESSAGE IDC21024I                              */ 09007000
*        /*                                                          */ 09008000
*        /************************************************************/ 09009000
*                                                                  2173 09010000
*                                                                  2173 09011000
*                DO;                                               2173 09012000
*                /*CALL CKERR*/                                    2174 09013000
*                  RSCKERR = RSCKERR && RSCKERR;                   2174 09014000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2174 09015000
*                  RSCKERN = RSE027;                               2175 09016000
         MVC   RSCKERN(2,REG6),@CH00944                            2175 09017000
*                  RSCKTERM = 'RETU';                              2176 09018000
         MVC   RSCKTERM(4,REG6),@CC03787                           2176 09019000
*                  RSCKMVAR(1) = ADDR(PTBASE->CNAME);              2177 09020000
         L     @07,PTBASE(,@07)                                    2177 09021000
         LA    @04,CNAME(,@07)                                     2177 09022000
         ST    @04,RSCKMVAR(,REG6)                                 2177 09023000
*                  RSCKMVAR(2) = ADDR(PTBASE->RCDID);              2178 09024000
*                                                                  2178 09025000
         LA    @07,RCDID(,@07)                                     2178 09026000
         ST    @07,RSCKMVAR+4(,REG6)                               2178 09027000
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */ 09028000
*                CALL CKERR;                                       2179 09029000
         L     @15,@CV03449                                        2179 09030000
         BALR  @14,@15                                             2179 09031000
*                END;                                              2180 09032000
*                                                                  2180 09033000
*        /************************************************************/ 09034000
*        /*                                                          */ 09035000
*        /*     REPAIR THE LAST GOOD ALIAS'S FORWARD CHAIN PTR.      */ 09036000
*        /*                                                          */ 09037000
*        /************************************************************/ 09038000
*                                                                  2181 09039000
*                IF PTXX0C ^= 0 THEN   /*AT LEAST 1 GOOD ALIAS EXISTS*/ 09040000
         SLR   @07,@07                                             2181 09041000
         L     @04,RSPTWKC(,REG6)                                  2181 09042000
         CH    @07,PTXX0C(,@04)                                    2181 09043000
         BE    @RF02181                                            2181 09044000
*                  DO;                                             2182 09045000
*                    PTXX0X1D->DITCITAB = 0;                       2183 09046000
         L     @04,PTXX0X1D(,@04)                                  2183 09047000
         STCM  @07,7,DITCITAB(@04)                                 2183 09048000
*                    PTXX0X1D->DITFARAS = ON; /*FORCE MODIFY         */ 09049000
         OI    DITFARAS(@04),B'00100000'                           2184 09050000
*                  END;                                            2185 09051000
*              END;                                                2186 09052000
@RF02181 DS    0H                                                  2187 09053000
*          END;                                                    2187 09054000
@RF02171 DS    0H                                                  2188 09055000
* CALL EXIT;  /*TERMINATE*/                                        2188 09056000
@RF02103 BAL   @14,EXIT                                            2188 09057000
* END VERX; /*END OF PROCEDURE*/                                   2189 09058000
*                                                                  2189 09059000
@EL00016 DS    0H                                                  2189 09060000
@EF00016 DS    0H                                                  2189 09061000
@ER00016 BR    @14                                                 2189 09062000
@PB00016 DS    0H                                                  2190 09063000
*      GENERATE;                                                   2190 09064000
         DS    0F                                                       09065000
         DC    CL8'EXIT'                                                09066000
*EXIT: PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                       2191 09067000
*                                                                  2191 09068000
         B     @PB00017                                            2191 09069000
EXIT     DS    0H                                                  2192 09070000
*        GEN(L     @13,4(,@13)); /*RESTORE CALLER'S REG SAVE*/     2192 09071000
         L     @13,4(,@13)                                              09072000
*        GEN(LM    @14,@12,12(@13));  /*RESTORE REGS*/             2193 09073000
         LM    @14,@12,12(@13)                                          09074000
*        GEN(MVI   12(@13),255);  /*MARK END OF SAVE LIST*/        2194 09075000
         MVI   12(@13),255                                              09076000
*        GEN(BR    14);  /*RETURN*/                                2195 09077000
         BR    14                                                       09078000
*END EXIT;  /*END OF PROC EXIT*/                                   2196 09079000
*                                                                  2196 09080000
@EL00017 DS    0H                                                  2196 09081000
@EF00017 DS    0H                                                  2196 09082000
@ER00017 BR    @14                                                 2196 09083000
*END IDCRS02   /*END OF MODULE*/                                   2197 09084000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 09085000
*/*%INCLUDE SYSLIB  (IDCDF64 )                                        * 09086000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 09087000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 09088000
*/*%INCLUDE SYSLIB  (IDCCSRS )                                        * 09089000
*/*%INCLUDE SYSLIB  (AMSDF05 )                                        * 09090000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 09091000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 09092000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 09093000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 09094000
*/*%INCLUDE SYSLIB  (AMCBS   )                                        * 09095000
*/*%INCLUDE SYSLIB  (IGGCAXWA)                                        * 09096000
*/*%INCLUDE SYSLIB  (IFGACB  )                                        * 09097000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 09098000
*;                                                                 2197 09099000
@EL00001 DS    0H                                                  2197 09100000
@EF00001 DS    0H                                                  2197 09101000
@ER00001 LM    @14,@12,12(@13)                                     2197 09102000
         BR    @14                                                 2197 09103000
@DATA    DS    0H                                                       09104000
@CH00280 DC    H'5'                                                     09105000
@CH00032 DC    H'12'                                                    09106000
@CH00471 DC    H'16'                                                    09107000
@CH00931 DC    H'20'                                                    09108000
@CH00940 DC    H'25'                                                    09109000
@CH00942 DC    H'26'                                                    09110000
@CH00944 DC    H'27'                                                    09111000
@CH00948 DC    H'29'                                                    09112000
@CH00969 DC    H'41'                                                    09113000
@CH00971 DC    H'42'                                                    09114000
@CH01010 DC    H'63'                                                    09115000
@CH00143 DC    H'100'                                                   09116000
         DS    0F                                                       09117000
@AL00342 DC    A(@CC03747)             LIST WITH   4 ARGUMENT(S)        09118000
         DC    A(@CC00808)                                              09119000
         DS    F                                                        09120000
         DC    A(@CF00111)                                              09121000
@DATD    DSECT                                                          09122000
         DS    0F                                                       09123000
@AL00001 DS    4A                                                       09124000
@TF00001 DS    F                                                        09125000
IDCRS02  CSECT                                                          09126000
         DS    0F                                                       09127000
@CF00111 DC    F'0'                                                     09128000
@CF00212 DC    F'1'                                                     09129000
@CH00212 EQU   @CF00212+2                                               09130000
@CF00149 DC    F'2'                                                     09131000
@CH00149 EQU   @CF00149+2                                               09132000
@CF00158 DC    F'3'                                                     09133000
@CH00158 EQU   @CF00158+2                                               09134000
@CF00038 DC    F'4'                                                     09135000
@CF00175 DC    F'8'                                                     09136000
@CF01845 DC    F'127'                                                   09137000
@CF03934 DC    F'224'                                                   09138000
@CF03188 DC    F'256'                                                   09139000
@CF03953 DC    F'-8'                                                    09140000
@CF03954 DC    F'-4'                                                    09141000
@DATD    DSECT                                                          09142000
         DS    0D                                                       09143000
@TS00001 DS    CL95                                                     09144000
         DS    CL1                                                      09145000
FDTTBL   DS    CL8                                                      09146000
         ORG   FDTTBL                                                   09147000
FDTVERB  DS    CL8                                                      09148000
FDTPTR   DS    0A                                                       09149000
         ORG   FDTTBL+8                                                 09150000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                09151000
@ENDDATD EQU   *                                                        09152000
IDCRS02  CSECT                                                          09153000
         DS    0F                                                       09154000
@SIZDATD DC    AL1(0)                                                   09155000
         DC    AL3(@ENDDATD-@DATD)                                      09156000
@CV03430 DC    V(CATRCDSU)                                              09157000
@CV03431 DC    V(MARKUNUS)                                              09158000
@CV03432 DC    V(CHKDSDIR)                                              09159000
@CV03434 DC    V(PROCVOL)                                               09160000
@CV03435 DC    V(GETFIT)                                                09161000
@CV03436 DC    V(GETNEXTE)                                              09162000
@CV03437 DC    V(GETTAB)                                                09163000
@CV03438 DC    V(VERB)                                                  09164000
@CV03440 DC    V(DELGO)                                                 09165000
@CV03441 DC    V(FIND)                                                  09166000
@CV03442 DC    V(GETVIA)                                                09167000
@CV03444 DC    V(IDCRS5SV)                                              09168000
@CV03445 DC    V(IDCRS5SR)                                              09169000
@CV03448 DC    V(ADDUPCR)                                               09170000
@CV03449 DC    V(CKERR)                                                 09171000
@CV03458 DC    V(RECMGMT)                                               09172000
@CV03450 DC    V(ADDTN)                                                 09173000
@CV03467 DC    V(CATEOV)                                                09174000
@CV03428 DC    V(CATINIT)                                               09175000
@CV03466 DC    V(CNVTCCHH)                                              09176000
@CV03462 DC    V(CRAEOV)                                                09177000
@CV03452 DC    V(CRAUPCHN)                                              09178000
@CV03451 DC    V(DELTN)                                                 09179000
@CV03461 DC    V(ENSURECI)                                              09180000
@CV03464 DC    V(FRCRCCR)                                               09181000
@CV03453 DC    V(GENNAME)                                               09182000
@CV03447 DC    V(IDCRS5BR)                                              09183000
@CV03446 DC    V(IDCRS5BV)                                              09184000
@CV03443 DC    V(IDCRS5EN)                                              09185000
@CV03460 DC    V(IDCRS6CD)                                              09186000
@CV03459 DC    V(IDCRS6CM)                                              09187000
@CV03457 DC    V(IDCRS6DC)                                              09188000
@CV03456 DC    V(IDCRS6DO)                                              09189000
@CV03468 DC    V(IDCRS7SP)                                              09190000
@CV03439 DC    V(MODGO)                                                 09191000
@CV03463 DC    V(RENAMEF)                                               09192000
@CV03469 DC    V(RENAMEP)                                               09193000
@CV03465 DC    V(UPDCCR)                                                09194000
@CV03433 DC    V(VOLCHK)                                                09195000
@CV03454 DC    V(WFDEF)                                                 09196000
@CV03455 DC    V(WFDEL)                                                 09197000
@CV03429 DC    V(WRAPUP)                                                09198000
         DS    0D                                                       09199000
MAXCINO  DC    XL4'3FFFFF'                                              09200000
@CC00901 DC    C'RS04'                                                  09201000
@CC00903 DC    C'RS10'                                                  09202000
@CC03741 DC    C'RSAS'                                                  09203000
@CC03754 DC    C'RSA1'                                                  09204000
@CC03760 DC    C'RSCA'                                                  09205000
@CC03762 DC    C'TERM'                                                  09206000
@CC03767 DC    C'RSLO'                                                  09207000
@CC03774 DC    C'RSPT'                                                  09208000
@CC03778 DC    C'RSP4'                                                  09209000
@CC03787 DC    C'RETU'                                                  09210000
@CC03794 DC    C'RSP3'                                                  09211000
@CC03798 DC    C'RSSC'                                                  09212000
@CC03804 DC    C'RSSE'                                                  09213000
@CC03823 DC    C'RSS2'                                                  09214000
@CC03828 DC    C'RSVA'                                                  09215000
@CC03842 DC    C'RSVC'                                                  09216000
@CC03852 DC    C'RSVE'                                                  09217000
@CC03881 DC    C'RSV3'                                                  09218000
@CC03900 DC    C'RSV2'                                                  09219000
@CC03904 DC    C'RSRG'                                                  09220000
@CC03920 DC    C'RSVR'                                                  09221000
@CC03924 DC    C'RSVU'                                                  09222000
@CC03928 DC    C'RSVX'                                                  09223000
@CC03835 DC    C'V00'                                                   09224000
@CC03834 DC    C'.G'                                                    09225000
@CC00800 DC    C'C'                                                     09226000
@CC00802 DC    C'D'                                                     09227000
@CC00806 DC    C'G'                                                     09228000
@CC00808 DC    C'A'                                                     09229000
@CC00810 DC    C'B'                                                     09230000
@CC00816 DC    C'Y'                                                     09231000
@CC00818 EQU   @CC00901                                                 09232000
@CC00828 EQU   @CC03835                                                 09233000
@CC03747 DC    C'N'                                                     09234000
ALL      DC    CL3'ALL'                                                 09235000
FORMAT   DC    CL4'FORM'                                                09236000
HSECOND  DC    CL4'HSEC'                                                09237000
CLOCK    DC    CL4'KLOK'                                                09238000
SETZERO  DC    CL4'ZERO'                                                09239000
SETBLANK DC    CL4'BLNK'                                                09240000
NOSET    DC    CL4'NSET'                                                09241000
OVERRIDE DC    CL4'OVRD'                                                09242000
ACQUIRE  DC    CL8'ACQUIRE '                                            09243000
RELINQ   DC    CL8'RELINQ  '                                            09244000
MOUNT    DC    CL8'MOUNT   '                                            09245000
DEMOUNT  DC    CL8'DEMOUNT '                                            09246000
DEFINE   DC    CL8'DEFINE  '                                            09247000
MOVE     DC    CL8'MOVE    '                                            09248000
TRACEQ   DC    CL8'TRACEQ  '                                            09249000
COPYTABL DC    CL8'COPYTABL'                                            09250000
COPYCRTG DC    CL8'COPYCRTG'                                            09251000
COPYVOL  DC    CL8'COPYVOL '                                            09252000
VVIC     DC    CL8'VVIC    '                                            09253000
TUNE     DC    CL8'TUNE    '                                            09254000
NAMES    DC    CL4'NAME'                                                09255000
UNIT     DC    CL4'UNIT'                                                09256000
SHR      DC    CL4'SHR '                                                09257000
EXCL     DC    CL4'EXCL'                                                09258000
NOWAIT   DC    CL4'NWAI'                                                09259000
WAIT     DC    CL4'WAIT'                                                09260000
TNTYPES  DC    CL11'CDIAXBVUMGR'                                        09261000
MAXEXPDT DC    X'99999F'                                                09262000
DUMMYNM  DC    X'FFFFFFFFFFFFFFFF'                                      09263000
RDFCIDF  DC    X'0001F901F90000'                                        09264000
PACKF    DC    X'0F'                                                    09265000
DSCB1ID  DC    X'F1'                                                    09266000
VOLUNUSE DC    X'0000'                                                  09267000
NULLDIG  DC    X'00'                                                    09268000
BADVOLSW DC    X'00'                                                    09269000
FMT3NULL DC    X'0000000000'                                            09270000
DS4DSNM  DS    CL44                                                     09271000
         ORG   DS4DSNM                                                  09272000
@NM00040 DC    44X'04'                                                  09273000
         ORG   DS4DSNM+44                                               09274000
         DS    CL1                                                      09275000
PATCH    DS    CL800                                                    09276000
         ORG   PATCH                                                    09277000
@NM00216 DC    CL36'PATCHAREA 800 BYTES LAST USED 000000'               09278000
@NM00217 DC    764X'00'                                                 09279000
         ORG   PATCH+800                                                09280000
ASSOCC   DS    CL32                                                     09281000
         ORG   ASSOCC                                                   09282000
@NM00218 DC    CL1'C'                                                   09283000
@NM00219 DS    CL1                                                      09284000
@NM00220 DC    H'7'                                                     09285000
ASSOCC1  DS    CL4                                                      09286000
         ORG   ASSOCC1                                                  09287000
@NM00221 DC    CL1'C'                                                   09288000
@NM00222 DC    X'E0'                                                    09289000
@NM00223 DC    H'1'                                                     09290000
         ORG   ASSOCC+8                                                 09291000
ASSOCC2  DS    CL4                                                      09292000
         ORG   ASSOCC2                                                  09293000
@NM00224 DC    CL1'D'                                                   09294000
@NM00225 DC    X'E0'                                                    09295000
@NM00226 DC    H'2'                                                     09296000
         ORG   ASSOCC+12                                                09297000
ASSOCC3  DS    CL4                                                      09298000
         ORG   ASSOCC3                                                  09299000
@NM00227 DC    CL1'I'                                                   09300000
@NM00228 DC    X'E0'                                                    09301000
@NM00229 DC    H'3'                                                     09302000
         ORG   ASSOCC+16                                                09303000
ASSOCC4  DS    CL4                                                      09304000
         ORG   ASSOCC4                                                  09305000
@NM00230 DC    CL1'E'                                                   09306000
@NM00231 DC    X'E0'                                                    09307000
@NM00232 DC    H'4'                                                     09308000
         ORG   ASSOCC+20                                                09309000
ASSOCC5  DS    CL4                                                      09310000
         ORG   ASSOCC5                                                  09311000
@NM00233 DC    CL1'R'                                                   09312000
@NM00234 DC    X'00'                                                    09313000
@NM00235 DS    FL2                                                      09314000
         ORG   ASSOCC+24                                                09315000
ASSOCC6  DS    CL4                                                      09316000
         ORG   ASSOCC6                                                  09317000
@NM00236 DC    CL1'G'                                                   09318000
@NM00237 DC    X'00'                                                    09319000
@NM00238 DS    FL2                                                      09320000
         ORG   ASSOCC+28                                                09321000
ASSOCC7  DS    CL4                                                      09322000
         ORG   ASSOCC7                                                  09323000
@NM00239 DC    CL1'Y'                                                   09324000
@NM00240 DC    X'00'                                                    09325000
@NM00241 DS    FL2                                                      09326000
         ORG   ASSOCC+32                                                09327000
ASSOG    DS    CL28                                                     09328000
         ORG   ASSOG                                                    09329000
@NM00242 DC    CL1'G'                                                   09330000
@NM00243 DS    CL1                                                      09331000
@NM00244 DC    H'6'                                                     09332000
ASSOG1   DS    CL4                                                      09333000
         ORG   ASSOG1                                                   09334000
@NM00245 DC    CL1'G'                                                   09335000
@NM00246 DC    X'E0'                                                    09336000
@NM00247 DC    H'1'                                                     09337000
         ORG   ASSOG+8                                                  09338000
ASSOG2   DS    CL4                                                      09339000
         ORG   ASSOG2                                                   09340000
@NM00248 DC    CL1'D'                                                   09341000
@NM00249 DC    X'E0'                                                    09342000
@NM00250 DC    H'2'                                                     09343000
         ORG   ASSOG+12                                                 09344000
ASSOG3   DS    CL4                                                      09345000
         ORG   ASSOG3                                                   09346000
@NM00251 DC    CL1'I'                                                   09347000
@NM00252 DC    X'E0'                                                    09348000
@NM00253 DC    H'3'                                                     09349000
         ORG   ASSOG+16                                                 09350000
ASSOG4   DS    CL4                                                      09351000
         ORG   ASSOG4                                                   09352000
@NM00254 DC    CL1'E'                                                   09353000
@NM00255 DC    X'E0'                                                    09354000
@NM00256 DC    H'4'                                                     09355000
         ORG   ASSOG+20                                                 09356000
ASSOG5   DS    CL4                                                      09357000
         ORG   ASSOG5                                                   09358000
@NM00257 DC    CL1'R'                                                   09359000
@NM00258 DC    X'00'                                                    09360000
@NM00259 DS    FL2                                                      09361000
         ORG   ASSOG+24                                                 09362000
ASSOG6   DS    CL4                                                      09363000
         ORG   ASSOG6                                                   09364000
@NM00260 DC    CL1'C'                                                   09365000
@NM00261 DC    X'90'                                                    09366000
@NM00262 DS    FL2                                                      09367000
         ORG   ASSOG+28                                                 09368000
ASSOR    DS    CL28                                                     09369000
         ORG   ASSOR                                                    09370000
@NM00263 DC    CL1'R'                                                   09371000
@NM00264 DS    CL1                                                      09372000
@NM00265 DC    H'6'                                                     09373000
ASSOR1   DS    CL4                                                      09374000
         ORG   ASSOR1                                                   09375000
@NM00266 DC    CL1'R'                                                   09376000
@NM00267 DC    X'E0'                                                    09377000
@NM00268 DC    H'3'                                                     09378000
         ORG   ASSOR+8                                                  09379000
ASSOR2   DS    CL4                                                      09380000
         ORG   ASSOR2                                                   09381000
@NM00269 DC    CL1'E'                                                   09382000
@NM00270 DC    X'E0'                                                    09383000
@NM00271 DC    H'4'                                                     09384000
         ORG   ASSOR+12                                                 09385000
ASSOR3   DS    CL4                                                      09386000
         ORG   ASSOR3                                                   09387000
@NM00272 DC    CL1'C'                                                   09388000
@NM00273 DC    X'90'                                                    09389000
@NM00274 DS    FL2                                                      09390000
         ORG   ASSOR+16                                                 09391000
ASSOR4   DS    CL4                                                      09392000
         ORG   ASSOR4                                                   09393000
@NM00275 DC    CL1'D'                                                   09394000
@NM00276 DC    X'90'                                                    09395000
@NM00277 DS    FL2                                                      09396000
         ORG   ASSOR+20                                                 09397000
ASSOR5   DS    CL4                                                      09398000
         ORG   ASSOR5                                                   09399000
@NM00278 DC    CL1'I'                                                   09400000
@NM00279 DC    X'90'                                                    09401000
@NM00280 DS    FL2                                                      09402000
         ORG   ASSOR+24                                                 09403000
ASSOR6   DS    CL4                                                      09404000
         ORG   ASSOR6                                                   09405000
@NM00281 DC    CL1'G'                                                   09406000
@NM00282 DC    X'90'                                                    09407000
@NM00283 DS    FL2                                                      09408000
         ORG   ASSOR+28                                                 09409000
ASSOY    DS    CL20                                                     09410000
         ORG   ASSOY                                                    09411000
@NM00284 DC    CL1'Y'                                                   09412000
@NM00285 DS    CL1                                                      09413000
@NM00286 DC    H'4'                                                     09414000
ASSOY1   DS    CL4                                                      09415000
         ORG   ASSOY1                                                   09416000
@NM00287 DC    CL1'Y'                                                   09417000
@NM00288 DC    X'E0'                                                    09418000
@NM00289 DC    H'4'                                                     09419000
         ORG   ASSOY+8                                                  09420000
ASSOY2   DS    CL4                                                      09421000
         ORG   ASSOY2                                                   09422000
@NM00290 DC    CL1'E'                                                   09423000
@NM00291 DC    X'E0'                                                    09424000
@NM00292 DC    H'4'                                                     09425000
         ORG   ASSOY+12                                                 09426000
ASSOY3   DS    CL4                                                      09427000
         ORG   ASSOY3                                                   09428000
@NM00293 DC    CL1'D'                                                   09429000
@NM00294 DC    X'00'                                                    09430000
@NM00295 DS    FL2                                                      09431000
         ORG   ASSOY+16                                                 09432000
ASSOY4   DS    CL4                                                      09433000
         ORG   ASSOY4                                                   09434000
@NM00296 DC    CL1'I'                                                   09435000
@NM00297 DC    X'00'                                                    09436000
@NM00298 DS    FL2                                                      09437000
         ORG   ASSOY+20                                                 09438000
ASSOA    DS    CL20                                                     09439000
         ORG   ASSOA                                                    09440000
@NM00299 DC    CL1'A'                                                   09441000
@NM00300 DS    CL1                                                      09442000
@NM00301 DC    H'4'                                                     09443000
ASSOA1   DS    CL4                                                      09444000
         ORG   ASSOA1                                                   09445000
@NM00302 DC    CL1'A'                                                   09446000
@NM00303 DC    X'E0'                                                    09447000
@NM00304 DC    H'1'                                                     09448000
         ORG   ASSOA+8                                                  09449000
ASSOA2   DS    CL4                                                      09450000
         ORG   ASSOA2                                                   09451000
@NM00305 DC    CL1'E'                                                   09452000
@NM00306 DC    X'E0'                                                    09453000
@NM00307 DC    H'4'                                                     09454000
         ORG   ASSOA+12                                                 09455000
ASSOA3   DS    CL4                                                      09456000
         ORG   ASSOA3                                                   09457000
@NM00308 DC    CL1'X'                                                   09458000
@NM00309 DC    X'E0'                                                    09459000
@NM00310 DC    H'2'                                                     09460000
         ORG   ASSOA+16                                                 09461000
ASSOA4   DS    CL4                                                      09462000
         ORG   ASSOA4                                                   09463000
@NM00311 DC    CL1'B'                                                   09464000
@NM00312 DC    X'00'                                                    09465000
@NM00313 DS    FL2                                                      09466000
         ORG   ASSOA+20                                                 09467000
ASSOB    DS    CL16                                                     09468000
         ORG   ASSOB                                                    09469000
@NM00314 DC    CL1'B'                                                   09470000
@NM00315 DS    CL1                                                      09471000
@NM00316 DC    H'3'                                                     09472000
ASSOB1   DS    CL4                                                      09473000
         ORG   ASSOB1                                                   09474000
@NM00317 DC    CL1'B'                                                   09475000
@NM00318 DC    X'E0'                                                    09476000
@NM00319 DC    H'1'                                                     09477000
         ORG   ASSOB+8                                                  09478000
ASSOB2   DS    CL4                                                      09479000
         ORG   ASSOB2                                                   09480000
@NM00320 DC    CL1'E'                                                   09481000
@NM00321 DC    X'E0'                                                    09482000
@NM00322 DC    H'4'                                                     09483000
         ORG   ASSOB+12                                                 09484000
ASSOB3   DS    CL4                                                      09485000
         ORG   ASSOB3                                                   09486000
@NM00323 DC    CL1'A'                                                   09487000
@NM00324 DC    X'00'                                                    09488000
@NM00325 DS    FL2                                                      09489000
         ORG   ASSOB+16                                                 09490000
ASSO3A   DS    CL20                                                     09491000
         ORG   ASSO3A                                                   09492000
@NM00326 DC    CL1'3'                                                   09493000
@NM00327 DS    CL1                                                      09494000
@NM00328 DC    H'4'                                                     09495000
ASSO3A1  DS    CL4                                                      09496000
         ORG   ASSO3A1                                                  09497000
@NM00329 DC    CL1'A'                                                   09498000
@NM00330 DC    X'E0'                                                    09499000
@NM00331 DC    H'2'                                                     09500000
         ORG   ASSO3A+8                                                 09501000
ASSO3A2  DS    CL4                                                      09502000
         ORG   ASSO3A2                                                  09503000
@NM00332 DC    CL1'E'                                                   09504000
@NM00333 DC    X'E0'                                                    09505000
@NM00334 DC    H'4'                                                     09506000
         ORG   ASSO3A+12                                                09507000
ASSO3A3  DS    CL4                                                      09508000
         ORG   ASSO3A3                                                  09509000
@NM00335 DC    CL1'X'                                                   09510000
@NM00336 DC    X'E0'                                                    09511000
@NM00337 DC    H'3'                                                     09512000
         ORG   ASSO3A+16                                                09513000
ASSO3A4  DS    CL4                                                      09514000
         ORG   ASSO3A4                                                  09515000
@NM00338 DC    CL1'B'                                                   09516000
@NM00339 DC    X'90'                                                    09517000
@NM00340 DS    FL2                                                      09518000
         ORG   ASSO3A+20                                                09519000
ASSOU    DS    CL16                                                     09520000
         ORG   ASSOU                                                    09521000
@NM00341 DC    CL1'A'                                                   09522000
@NM00342 DS    CL1                                                      09523000
@NM00343 DC    H'3'                                                     09524000
ASSOU1   DS    CL4                                                      09525000
         ORG   ASSOU1                                                   09526000
@NM00344 DC    CL1'U'                                                   09527000
@NM00345 DC    X'E0'                                                    09528000
@NM00346 DC    H'1'                                                     09529000
         ORG   ASSOU+8                                                  09530000
ASSOU2   DS    CL4                                                      09531000
         ORG   ASSOU2                                                   09532000
@NM00347 DC    CL1'E'                                                   09533000
@NM00348 DC    X'E0'                                                    09534000
@NM00349 DC    H'4'                                                     09535000
         ORG   ASSOU+12                                                 09536000
ASSOU3   DS    CL4                                                      09537000
         ORG   ASSOU3                                                   09538000
@NM00350 DC    CL1'X'                                                   09539000
@NM00351 DC    X'E0'                                                    09540000
@NM00352 DC    H'3'                                                     09541000
         ORG   ASSOU+16                                                 09542000
ASSOV    DS    CL12                                                     09543000
         ORG   ASSOV                                                    09544000
@NM00353 DC    CL1'V'                                                   09545000
@NM00354 DS    CL1                                                      09546000
@NM00355 DC    H'2'                                                     09547000
ASSOV1   DS    CL4                                                      09548000
         ORG   ASSOV1                                                   09549000
@NM00356 DC    CL1'V'                                                   09550000
@NM00357 DC    X'E0'                                                    09551000
@NM00358 DC    H'1'                                                     09552000
         ORG   ASSOV+8                                                  09553000
ASSOV2   DS    CL4                                                      09554000
         ORG   ASSOV2                                                   09555000
@NM00359 DC    CL1'W'                                                   09556000
@NM00360 DC    X'E0'                                                    09557000
@NM00361 DC    H'4'                                                     09558000
         ORG   ASSOV+12                                                 09559000
ASSO1C   DS    CL32                                                     09560000
         ORG   ASSO1C                                                   09561000
@NM00362 DC    CL1'1'                                                   09562000
@NM00363 DS    CL1                                                      09563000
@NM00364 DC    H'7'                                                     09564000
ASSO1C1  DS    CL4                                                      09565000
         ORG   ASSO1C1                                                  09566000
@NM00365 DC    CL1'C'                                                   09567000
@NM00366 DC    X'C0'                                                    09568000
@NM00367 DC    H'1'                                                     09569000
         ORG   ASSO1C+8                                                 09570000
ASSO1C2  DS    CL4                                                      09571000
         ORG   ASSO1C2                                                  09572000
@NM00368 DC    CL1'D'                                                   09573000
@NM00369 DC    X'C0'                                                    09574000
@NM00370 DC    H'2'                                                     09575000
         ORG   ASSO1C+12                                                09576000
ASSO1C3  DS    CL4                                                      09577000
         ORG   ASSO1C3                                                  09578000
@NM00371 DC    CL1'I'                                                   09579000
@NM00372 DC    X'C0'                                                    09580000
@NM00373 DC    H'3'                                                     09581000
         ORG   ASSO1C+16                                                09582000
ASSO1C4  DS    CL4                                                      09583000
         ORG   ASSO1C4                                                  09584000
@NM00374 DC    CL1'E'                                                   09585000
@NM00375 DC    X'C0'                                                    09586000
@NM00376 DC    H'4'                                                     09587000
         ORG   ASSO1C+20                                                09588000
ASSO1C5  DS    CL4                                                      09589000
         ORG   ASSO1C5                                                  09590000
@NM00377 DC    CL1'R'                                                   09591000
@NM00378 DC    X'00'                                                    09592000
@NM00379 DS    FL2                                                      09593000
         ORG   ASSO1C+24                                                09594000
ASSO1C6  DS    CL4                                                      09595000
         ORG   ASSO1C6                                                  09596000
@NM00380 DC    CL1'G'                                                   09597000
@NM00381 DC    X'00'                                                    09598000
@NM00382 DS    FL2                                                      09599000
         ORG   ASSO1C+28                                                09600000
ASSO1C7  DS    CL4                                                      09601000
         ORG   ASSO1C7                                                  09602000
@NM00383 DC    CL1'Y'                                                   09603000
@NM00384 DC    X'00'                                                    09604000
@NM00385 DS    FL2                                                      09605000
         ORG   ASSO1C+32                                                09606000
ASSO2G   DS    CL28                                                     09607000
         ORG   ASSO2G                                                   09608000
@NM00386 DC    CL1'2'                                                   09609000
@NM00387 DS    CL1                                                      09610000
@NM00388 DC    H'6'                                                     09611000
ASSO2G1  DS    CL4                                                      09612000
         ORG   ASSO2G1                                                  09613000
@NM00389 DC    CL1'G'                                                   09614000
@NM00390 DC    X'C0'                                                    09615000
@NM00391 DC    H'1'                                                     09616000
         ORG   ASSO2G+8                                                 09617000
ASSO2G2  DS    CL4                                                      09618000
         ORG   ASSO2G2                                                  09619000
@NM00392 DC    CL1'D'                                                   09620000
@NM00393 DC    X'C0'                                                    09621000
@NM00394 DC    H'2'                                                     09622000
         ORG   ASSO2G+12                                                09623000
ASSO2G3  DS    CL4                                                      09624000
         ORG   ASSO2G3                                                  09625000
@NM00395 DC    CL1'I'                                                   09626000
@NM00396 DC    X'C0'                                                    09627000
@NM00397 DC    H'3'                                                     09628000
         ORG   ASSO2G+16                                                09629000
ASSO2G4  DS    CL4                                                      09630000
         ORG   ASSO2G4                                                  09631000
@NM00398 DC    CL1'E'                                                   09632000
@NM00399 DC    X'C0'                                                    09633000
@NM00400 DC    H'4'                                                     09634000
         ORG   ASSO2G+20                                                09635000
ASSO2G5  DS    CL4                                                      09636000
         ORG   ASSO2G5                                                  09637000
@NM00401 DC    CL1'R'                                                   09638000
@NM00402 DC    X'00'                                                    09639000
@NM00403 DS    FL2                                                      09640000
         ORG   ASSO2G+24                                                09641000
ASSO2G6  DS    CL4                                                      09642000
         ORG   ASSO2G6                                                  09643000
@NM00404 DC    CL1'C'                                                   09644000
@NM00405 DC    X'00'                                                    09645000
@NM00406 DS    FL2                                                      09646000
         ORG   ASSO2G+28                                                09647000
AIXTBL   DC    CL3'DIC'                                                 09648000
PATHCTBL DC    CL3'CDI'                                                 09649000
PATHGTBL DC    CL5'GDIDI'                                               09650000
TRTBLE   DC    CL1'0'                                                   09651000
         DC    CL1'1'                                                   09652000
         DC    CL1'2'                                                   09653000
         DC    CL1'3'                                                   09654000
         DC    CL1'4'                                                   09655000
         DC    CL1'5'                                                   09656000
         DC    CL1'6'                                                   09657000
         DC    CL1'7'                                                   09658000
         DC    CL1'8'                                                   09659000
         DC    CL1'9'                                                   09660000
         DC    CL1'A'                                                   09661000
         DC    CL1'B'                                                   09662000
         DC    CL1'C'                                                   09663000
         DC    CL1'D'                                                   09664000
         DC    CL1'E'                                                   09665000
         DC    CL1'F'                                                   09666000
DEFNMTAB DC    CL8'DSETCRDT'                                            09667000
         DC    CL8'DSETEXDT'                                            09668000
         DC    CL8'PASSWALL'                                            09669000
         DC    CL8'AMDSBCAT'                                            09670000
         DC    CL8'DSATTR'                                              09671000
         DC    CL8'LRECL'                                               09672000
         DC    CL8'SPACPARM'                                            09673000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       09674000
@01      EQU   01                                                       09675000
@02      EQU   02                                                       09676000
@03      EQU   03                                                       09677000
@04      EQU   04                                                       09678000
@05      EQU   05                                                       09679000
@06      EQU   06                                                       09680000
@07      EQU   07                                                       09681000
@08      EQU   08                                                       09682000
@09      EQU   09                                                       09683000
@10      EQU   10                                                       09684000
@11      EQU   11                                                       09685000
@12      EQU   12                                                       09686000
@13      EQU   13                                                       09687000
@14      EQU   14                                                       09688000
@15      EQU   15                                                       09689000
RTNREG   EQU   @15                                                      09690000
REG5     EQU   @05                                                      09691000
REG6     EQU   @06                                                      09692000
REG8     EQU   @08                                                      09693000
REG13    EQU   @13                                                      09694000
REG15    EQU   @15                                                      09695000
REG0     EQU   @00                                                      09696000
REG1     EQU   @01                                                      09697000
REG10    EQU   @10                                                      09698000
REG11    EQU   @11                                                      09699000
REG12    EQU   @12                                                      09700000
REG14    EQU   @14                                                      09701000
REG2     EQU   @02                                                      09702000
REG3     EQU   @03                                                      09703000
REG4     EQU   @04                                                      09704000
REG7     EQU   @07                                                      09705000
REG9     EQU   @09                                                      09706000
         ENTRY ASSO3A                                                   09707000
CVTPTR   EQU   16                                                       09708000
GDTTBL   EQU   0                                                        09709000
GDTTR1   EQU   GDTTBL+8                                                 09710000
GDTTR2   EQU   GDTTBL+12                                                09711000
GDTIOH   EQU   GDTTBL+36                                                09712000
GDTDBG   EQU   GDTTBL+40                                                09713000
GDTSTC   EQU   GDTTBL+44                                                09714000
GDTPRT   EQU   GDTTBL+48                                                09715000
GDTESS   EQU   GDTTBL+52                                                09716000
GDTESA   EQU   GDTTBL+56                                                09717000
GDTRST   EQU   GDTTBL+60                                                09718000
GDTRES   EQU   GDTTBL+64                                                09719000
GDTCAL   EQU   GDTTBL+68                                                09720000
GDTGSP   EQU   GDTTBL+72                                                09721000
GDTFSP   EQU   GDTTBL+76                                                09722000
GDTGPL   EQU   GDTTBL+80                                                09723000
GDTFPL   EQU   GDTTBL+84                                                09724000
GDTLOD   EQU   GDTTBL+88                                                09725000
GDTDEL   EQU   GDTTBL+92                                                09726000
GDTPRL   EQU   GDTTBL+96                                                09727000
GDTEPL   EQU   GDTTBL+100                                               09728000
GDTTIM   EQU   GDTTBL+104                                               09729000
GDTIIO   EQU   GDTTBL+108                                               09730000
GDTTIO   EQU   GDTTBL+112                                               09731000
GDTOPN   EQU   GDTTBL+124                                               09732000
GDTCLS   EQU   GDTTBL+128                                               09733000
GDTGET   EQU   GDTTBL+132                                               09734000
GDTPUT   EQU   GDTTBL+136                                               09735000
GDTPOS   EQU   GDTTBL+140                                               09736000
GDTCPY   EQU   GDTTBL+144                                               09737000
GDTCAT   EQU   GDTTBL+148                                               09738000
GDTSNP   EQU   GDTTBL+164                                               09739000
GDTVFY   EQU   GDTTBL+172                                               09740000
GDTUID   EQU   GDTTBL+192                                               09741000
GDTPMT   EQU   GDTTBL+196                                               09742000
GDTCIR   EQU   GDTTBL+200                                               09743000
GDTLNK   EQU   GDTTBL+204                                               09744000
GDTALC   EQU   GDTTBL+208                                               09745000
GDTDLC   EQU   GDTTBL+212                                               09746000
GDTQAL   EQU   GDTTBL+216                                               09747000
GDTSTW   EQU   GDTTBL+220                                               09748000
GDTSSC   EQU   GDTTBL+224                                               09749000
GDTENQ   EQU   GDTTBL+228                                               09750000
GDTRSV   EQU   GDTTBL+232                                               09751000
GDTDEQ   EQU   GDTTBL+236                                               09752000
GDTSFO   EQU   GDTTBL+240                                               09753000
GDTWTO   EQU   GDTTBL+244                                               09754000
GDTSCR   EQU   GDTTBL+248                                               09755000
GDTUNT   EQU   GDTTBL+252                                               09756000
GDTRCT   EQU   GDTTBL+256                                               09757000
GDTIFO   EQU   GDTTBL+260                                               09758000
GDTEXP   EQU   GDTTBL+264                                               09759000
GDTSTA   EQU   GDTTBL+268                                               09760000
GDTERR   EQU   GDTTBL+272                                               09761000
GDTUNC   EQU   GDTTBL+276                                               09762000
GDTLOC   EQU   GDTTBL+280                                               09763000
IDCSAFP0 EQU   0                                                        09764000
TRACE1   EQU   0                                                        09765000
OLDERID1 EQU   TRACE1                                                   09766000
TRACE2   EQU   0                                                        09767000
OLDERID2 EQU   TRACE2                                                   09768000
NEWID2   EQU   TRACE2+95                                                09769000
NEWERID2 EQU   5                                                        09770000
CIRAGL   EQU   0                                                        09771000
CIRTYPE  EQU   CIRAGL                                                   09772000
ALLAGL   EQU   0                                                        09773000
ALLSTS   EQU   ALLAGL+24                                                09774000
ALLDSP   EQU   ALLAGL+25                                                09775000
ALLORG   EQU   ALLAGL+26                                                09776000
ALLOPT   EQU   ALLAGL+28                                                09777000
UNITABL  EQU   0                                                        09778000
UNITADR  EQU   UNITABL+4                                                09779000
@NM00010 EQU   UNITADR                                                  09780000
UNITSTAT EQU   UNITABL+6                                                09781000
IOCSTR   EQU   0                                                        09782000
IOCDSO   EQU   IOCSTR+16                                                09783000
IOCRFM   EQU   IOCSTR+17                                                09784000
IOCMAC   EQU   IOCSTR+18                                                09785000
IOCMAC2  EQU   IOCSTR+19                                                09786000
IOCCHP   EQU   IOCSTR+20                                                09787000
IOCMSG   EQU   IOCSTR+21                                                09788000
IOCRBA   EQU   IOCSTR+40                                                09789000
IOCTTR   EQU   IOCRBA                                                   09790000
IOCMEM   EQU   IOCSTR+44                                                09791000
IOCNWM   EQU   IOCSTR+48                                                09792000
IOCREL   EQU   IOCSTR+60                                                09793000
IOCEXT   EQU   IOCSTR+64                                                09794000
OPNAGL   EQU   0                                                        09795000
OPNOPT   EQU   OPNAGL                                                   09796000
OPNRFM   EQU   OPNAGL+1                                                 09797000
OPNTYP   EQU   OPNAGL+2                                                 09798000
OPNMOD   EQU   OPNAGL+3                                                 09799000
OPNDEV   EQU   OPNAGL+24                                                09800000
OPNDSO   EQU   OPNAGL+41                                                09801000
OPNOPT2  EQU   OPNAGL+42                                                09802000
IOINFOPT EQU   0                                                        09803000
UVOLLIST EQU   0                                                        09804000
UVOLENT  EQU   UVOLLIST+2                                               09805000
DARGLIST EQU   0                                                        09806000
DARGSTID EQU   DARGLIST+8                                               09807000
DARGARY  EQU   DARGLIST+20                                              09808000
DARGINS  EQU   DARGARY                                                  09809000
DARGINL  EQU   DARGARY+2                                                09810000
FMTLIST  EQU   0                                                        09811000
FMTFLGS  EQU   FMTLIST                                                  09812000
FMTSPF   EQU   FMTLIST+2                                                09813000
FMTRFNO  EQU   FMTSPF                                                   09814000
FMTILEN  EQU   FMTRFNO                                                  09815000
FMTIOFF  EQU   FMTLIST+4                                                09816000
FMTTRBC  EQU   FMTIOFF                                                  09817000
FMTSTO   EQU   FMTTRBC                                                  09818000
FMTOCOL  EQU   FMTLIST+6                                                09819000
FMTCNVF  EQU   FMTLIST+10                                               09820000
ERCNVTAB EQU   0                                                        09821000
ERTYPE   EQU   ERCNVTAB                                                 09822000
EROPER   EQU   ERCNVTAB+1                                               09823000
EROSOPER EQU   ERCNVTAB+2                                               09824000
ERCATRC  EQU   ERCNVTAB+16                                              09825000
ERCPLPT  EQU   ERCNVTAB+20                                              09826000
IDCDB010 EQU   0                                                        09827000
DMPITM   EQU   0                                                        09828000
DMPARY   EQU   0                                                        09829000
CATNM    EQU   0                                                        09830000
CATNMFLG EQU   CATNM+10                                                 09831000
CATDN    EQU   0                                                        09832000
MRPW     EQU   0                                                        09833000
WCAT     EQU   0                                                        09834000
WCATFLG  EQU   WCAT+10                                                  09835000
CRADN    EQU   0                                                        09836000
CRAVL    EQU   0                                                        09837000
CRADV    EQU   0                                                        09838000
WFILE    EQU   0                                                        09839000
IODATA   EQU   0                                                        09840000
IODSID   EQU   IODATA+16                                                09841000
IOCSEX   EQU   0                                                        09842000
IOCRPL   EQU   IOCSEX+4                                                 09843000
IOCXAD   EQU   IOCSEX+16                                                09844000
IOCXPM   EQU   IOCSEX+20                                                09845000
IOCFLG   EQU   IOCSEX+32                                                09846000
IOCDEV   EQU   IOCSEX+33                                                09847000
IOCINF   EQU   IOCSEX+34                                                09848000
IOCMOD   EQU   IOCSEX+35                                                09849000
IOCDLM   EQU   IOCSEX+36                                                09850000
IOCRCV   EQU   IOCSEX+44                                                09851000
CATIEXT  EQU   0                                                        09852000
VOLSERTB EQU   0                                                        09853000
VOLSRCI  EQU   VOLSERTB+4                                               09854000
VOLSRFLG EQU   VOLSERTB+8                                               09855000
VOLSRSER EQU   VOLSERTB+14                                              09856000
RESVOL   EQU   0                                                        09857000
RESVLFLG EQU   RESVOL+8                                                 09858000
RESVLBAD EQU   RESVLFLG                                                 09859000
RESVLSER EQU   RESVOL+14                                                09860000
RSF1RNTB EQU   0                                                        09861000
RSWORK   EQU   0                                                        09862000
RSCABHP1 EQU   RSWORK+12                                                09863000
RSCABLP1 EQU   RSWORK+16                                                09864000
RSCAFUCI EQU   RSWORK+28                                                09865000
RSCITDUM EQU   RSWORK+48                                                09866000
RSCPE1   EQU   RSWORK+68                                                09867000
RSCPE2   EQU   RSWORK+72                                                09868000
RSCPE3   EQU   RSWORK+76                                                09869000
RSCPE5   EQU   RSWORK+84                                                09870000
RSCPE6   EQU   RSWORK+88                                                09871000
RSCPE7   EQU   RSWORK+92                                                09872000
RSCRVL   EQU   RSWORK+104                                               09873000
RSGCITS  EQU   RSWORK+108                                               09874000
RSGCITC  EQU   RSGCITS+8                                                09875000
RSGCITLN EQU   RSGCITS+12                                               09876000
RSGCITEN EQU   RSGCITS+18                                               09877000
@NM00045 EQU   RSGCITS+20                                               09878000
RSGCITNU EQU   @NM00045+1                                               09879000
RSGCITUG EQU   RSGCITS+24                                               09880000
RSGDITS  EQU   RSWORK+136                                               09881000
RSGDITC  EQU   RSGDITS+8                                                09882000
RSGDITLN EQU   RSGDITS+12                                               09883000
RSGDITEN EQU   RSGDITS+18                                               09884000
@NM00048 EQU   RSGDITS+20                                               09885000
RSGDITNU EQU   @NM00048+1                                               09886000
RSGDITUG EQU   RSGDITS+24                                               09887000
RSPSTACK EQU   RSWORK+164                                               09888000
RSPTWKF  EQU   RSPSTACK                                                 09889000
RSPTWKC  EQU   RSPSTACK+8                                               09890000
RSPTWKLN EQU   RSPSTACK+12                                              09891000
RSPTWKUG EQU   RSPSTACK+24                                              09892000
RSTAB    EQU   RSWORK+192                                               09893000
RSTANCHR EQU   RSTAB                                                    09894000
RSTENTAD EQU   RSTAB+4                                                  09895000
@NM00053 EQU   RSTAB+8                                                  09896000
RSTENTIX EQU   @NM00053+1                                               09897000
@NM00055 EQU   RSTAB+12                                                 09898000
RSTWKIX  EQU   @NM00055+1                                               09899000
RSTABAD  EQU   RSTAB+16                                                 09900000
RSXXREGS EQU   RSWORK+212                                               09901000
RS01REGS EQU   RSXXREGS                                                 09902000
RS02REGS EQU   RSXXREGS+20                                              09903000
RS02RG08 EQU   RS02REGS                                                 09904000
RS02RG09 EQU   RS02REGS+4                                               09905000
RS03REGS EQU   RSXXREGS+40                                              09906000
RS04REGS EQU   RSXXREGS+60                                              09907000
RS05REGS EQU   RSXXREGS+80                                              09908000
RS06REGS EQU   RSXXREGS+100                                             09909000
RS07REGS EQU   RSXXREGS+120                                             09910000
RSCRBP1  EQU   RSWORK+372                                               09911000
RSIOTBL  EQU   RSWORK+412                                               09912000
RSRABWA  EQU   RSWORK+416                                               09913000
RSGRABCU EQU   RSWORK+428                                               09914000
RSRMBP   EQU   RSWORK+432                                               09915000
RSWFBP1  EQU   RSWORK+436                                               09916000
RSWFBP2  EQU   RSWORK+440                                               09917000
RSENTPT  EQU   RSWORK+484                                               09918000
RSVTBENT EQU   RSWORK+532                                               09919000
CAXWAPTR EQU   RSWORK+568                                               09920000
CBSPTR   EQU   RSWORK+572                                               09921000
CTGPLPTR EQU   RSWORK+576                                               09922000
CTGFLPTR EQU   RSWORK+580                                               09923000
RSCIXLTA EQU   RSWORK+600                                               09924000
RSUIRPT  EQU   RSWORK+612                                               09925000
RSF1RNCU EQU   RSWORK+656                                               09926000
RSORVLLS EQU   RSWORK+668                                               09927000
RSGOPLEN EQU   RSWORK+682                                               09928000
RSIDX    EQU   RSWORK+686                                               09929000
RSUIOPT  EQU   RSWORK+700                                               09930000
RSNEWCAT EQU   RSWORK+965                                               09931000
RSFLAGSN EQU   RSWORK+979                                               09932000
RSFLAGN1 EQU   RSFLAGSN                                                 09933000
RSFLAGN2 EQU   RSFLAGSN+1                                               09934000
RSFLAGSI EQU   RSWORK+981                                               09935000
RSFLAGI1 EQU   RSFLAGSI                                                 09936000
RSFLAGI2 EQU   RSFLAGSI+1                                               09937000
RSSRNSCN EQU   RSFLAGI2+1                                               09938000
RSBADVOL EQU   RSFLAGI2+1                                               09939000
RSRECREQ EQU   RSWORK+984                                               09940000
RSRTYPE  EQU   RSRECREQ                                                 09941000
RSRGET   EQU   RSRTYPE                                                  09942000
RSRUPDT  EQU   RSRTYPE                                                  09943000
RSRTERM  EQU   RSRTYPE                                                  09944000
RSRFREE  EQU   RSRTYPE                                                  09945000
RSROPT   EQU   RSRECREQ+1                                               09946000
RSRDS    EQU   RSROPT                                                   09947000
RSRWF    EQU   RSRDS                                                    09948000
RSRBY    EQU   RSROPT                                                   09949000
RSRKEY   EQU   RSRBY                                                    09950000
RSRFOR   EQU   RSROPT                                                   09951000
RSRUPD   EQU   RSRFOR                                                   09952000
RSRUSE   EQU   RSROPT                                                   09953000
RSRDIR   EQU   RSRUSE                                                   09954000
RSASSOC  EQU   RSWORK+988                                               09955000
RSASSTBL EQU   RSASSOC                                                  09956000
RSASSCIN EQU   RSASSOC+4                                                09957000
RSASSEND EQU   RSASSOC+8                                                09958000
RSASSEXT EQU   RSASSOC+12                                               09959000
RSASSPAS EQU   RSASSOC+14                                               09960000
RSASSFLG EQU   RSASSOC+16                                               09961000
RSASSFL1 EQU   RSASSFLG                                                 09962000
RSASSEPA EQU   RSASSFL1                                                 09963000
RSASDSDI EQU   RSASSFL1                                                 09964000
RSGDG    EQU   RSASSOC+20                                               09965000
RSGDGTB  EQU   RSGDG                                                    09966000
RSGDGLN  EQU   RSGDG+8                                                  09967000
RSGDGNM  EQU   RSGDG+10                                                 09968000
RSPROCVL EQU   RSWORK+1064                                              09969000
RSMAPS   EQU   RSPROCVL                                                 09970000
RSSBMAP  EQU   RSMAPS+8                                                 09971000
RSPCBMAP EQU   RSMAPS+12                                                09972000
RSMAPAD  EQU   RSPROCVL+20                                              09973000
RSPVSNT  EQU   RSPROCVL+48                                              09974000
RSPVTTNN EQU   RSPROCVL+68                                              09975000
@NM00062 EQU   RSPROCVL+84                                              09976000
RSPVSETB EQU   @NM00062                                                 09977000
RSPVFLG1 EQU   @NM00062+1                                               09978000
RSPVFLG2 EQU   @NM00062+2                                               09979000
RSEOVWA  EQU   RSWORK+1152                                              09980000
@NM00065 EQU   RSEOVWA+8                                                09981000
@NM00067 EQU   RSEOVWA+12                                               09982000
RSEOVFLG EQU   @NM00067+1                                               09983000
RSGETVIA EQU   RSWORK+1168                                              09984000
RSVIACRA EQU   RSGETVIA                                                 09985000
@NM00072 EQU   RSGETVIA+12                                              09986000
RSVIAFLG EQU   @NM00072                                                 09987000
RSVIAFCR EQU   RSVIAFLG                                                 09988000
RSVIACIN EQU   @NM00072+1                                               09989000
@NM00074 EQU   RSGETVIA+16                                              09990000
RSREASW  EQU   RSWORK+1188                                              09991000
RSCKERR  EQU   RSWORK+1192                                              09992000
RSCKERN  EQU   RSCKERR                                                  09993000
RSCKTERM EQU   RSCKERR+4                                                09994000
RSCKMVAR EQU   RSCKERR+8                                                09995000
RSCKERRW EQU   RSWORK+1240                                              09996000
RSLASTCC EQU   RSCKERRW                                                 09997000
RSCKTIME EQU   RSCKERRW+8                                               09998000
RSCKFLAG EQU   RSCKERRW+50                                              09999000
RSCIWA   EQU   RSWORK+1292                                              10000000
RSCIEXPT EQU   RSCIWA                                                   10001000
RSINWA   EQU   RSWORK+1340                                              10002000
RSINDVL  EQU   RSINWA+24                                                10003000
RSINATR1 EQU   RSINWA+53                                                10004000
RSINFLGS EQU   RSINWA+54                                                10005000
RSRNWA   EQU   RSWORK+1488                                              10006000
RSRNPLST EQU   RSRNWA                                                   10007000
RSRNFLGS EQU   RSRNWA+46                                                10008000
RSRNVL   EQU   RSRNWA+99                                                10009000
RSRNUL   EQU   RSRNWA+106                                               10010000
RSRWORK  EQU   RSWORK+1604                                              10011000
RSRFLGS  EQU   RSRWORK+64                                               10012000
RSWFWA   EQU   RSWORK+1672                                              10013000
RSADWA   EQU   RSWORK+1724                                              10014000
RSADVL   EQU   RSADWA+32                                                10015000
RSADUL   EQU   RSADWA+39                                                10016000
RSCRWA   EQU   RSWORK+1772                                              10017000
RSGENWRK EQU   RSWORK+1780                                              10018000
RSGENDTE EQU   RSGENWRK+12                                              10019000
RSVOLWA  EQU   RSWORK+1796                                              10020000
RSVF1TS  EQU   RSVOLWA+52                                               10021000
RSVF1EXT EQU   RSVOLWA+75                                               10022000
RSVFLAGS EQU   RSVOLWA+140                                              10023000
RSDF00W  EQU   RSWORK+1940                                              10024000
LISTSCAN EQU   RSDF00W+4                                                10025000
IOCSPTR  EQU   RSDF00W+8                                                10026000
OPNPTR   EQU   RSDF00W+12                                               10027000
DDSTRU   EQU   RSDF00W+16                                               10028000
FSADDR   EQU   RSDF00W+20                                               10029000
ERCNVADR EQU   RSDF00W+24                                               10030000
DMPINDEX EQU   RSDF00W+28                                               10031000
TESTRC   EQU   RSDF00W+34                                               10032000
RSCNVTCC EQU   RSWORK+1980                                              10033000
RSCCHHP  EQU   RSCNVTCC+4                                               10034000
RSTTNN   EQU   RSCNVTCC+8                                               10035000
RSCNVTCF EQU   RSCNVTCC+12                                              10036000
RSCNVTF1 EQU   RSCNVTCF                                                 10037000
RSWFNDWA EQU   RSWORK+1996                                              10038000
RSWAFINF EQU   RSWFNDWA                                                 10039000
RSWASNVT EQU   RSWFNDWA+4                                               10040000
RSWSNFLG EQU   RSWFNDWA+8                                               10041000
RSWFONE  EQU   RSWSNFLG                                                 10042000
RSWFIRST EQU   RSWSNFLG                                                 10043000
RSWGCODE EQU   RSWFNDWA+9                                               10044000
RSWSEQNR EQU   RSWFNDWA+10                                              10045000
RSGENMWA EQU   RSWORK+2052                                              10046000
RSGENAM  EQU   RSGENMWA+9                                               10047000
RSGDATE  EQU   RSGENAM+21                                               10048000
RSGTIME  EQU   RSGENAM+26                                               10049000
RSCDSDWA EQU   RSWORK+2108                                              10050000
RSCDSDIN EQU   RSCDSDWA                                                 10051000
RSCDSNT8 EQU   RSCDSDIN                                                 10052000
RSCDSNT3 EQU   RSCDSDIN+4                                               10053000
RSCDVOLR EQU   RSCDSDIN+8                                               10054000
RSCDDIR  EQU   RSCDSDIN+12                                              10055000
RSCDSDW  EQU   RSCDSDWA+16                                              10056000
RSMARKUN EQU   RSWORK+2144                                              10057000
RSCSWA   EQU   RSWORK+2152                                              10058000
GRAB     EQU   0                                                        10059000
GRABFLGS EQU   GRAB                                                     10060000
GRABAFLS EQU   GRABFLGS+1                                               10061000
GRABAFL1 EQU   GRABAFLS                                                 10062000
GRABAFL2 EQU   GRABAFLS+1                                               10063000
GRABBB   EQU   GRAB+4                                                   10064000
GRABCURR EQU   GRAB+12                                                  10065000
GRABRABS EQU   GRAB+16                                                  10066000
GRABRAB1 EQU   GRABRABS                                                 10067000
GRABRAB5 EQU   GRABRABS+16                                              10068000
RSRAB    EQU   0                                                        10069000
RABFLGS  EQU   RSRAB                                                    10070000
RABFLG1  EQU   RABFLGS                                                  10071000
RABNRF   EQU   RABFLG1                                                  10072000
RABRCDA  EQU   RSRAB+4                                                  10073000
RABBUF   EQU   RSRAB+8                                                  10074000
RABPROC  EQU   RSRAB+520                                                10075000
RMB      EQU   0                                                        10076000
RMBCTL   EQU   RMB                                                      10077000
RMBFLAGS EQU   RMBCTL+8                                                 10078000
RSXCIXLT EQU   0                                                        10079000
RSXCIENT EQU   RSXCIXLT+8                                               10080000
RSXCIBEG EQU   RSXCIENT                                                 10081000
RSXCILN  EQU   RSXCIENT+4                                               10082000
RSXCIFLG EQU   RSXCIENT+8                                               10083000
RSXCIFL1 EQU   RSXCIFLG                                                 10084000
RSXCIRNG EQU   RSXCIFL1                                                 10085000
UIODSN   EQU   0                                                        10086000
UIOVOL   EQU   0                                                        10087000
RECIOWA  EQU   0                                                        10088000
GRABSWF  EQU   RECIOWA                                                  10089000
ALLUL    EQU   RECIOWA+784                                              10090000
ALLVL    EQU   RECIOWA+796                                              10091000
RSCAMINN EQU   RECIOWA+816                                              10092000
UCATWA   EQU   RECIOWA+874                                              10093000
WFBUF1   EQU   0                                                        10094000
WFBUF2   EQU   0                                                        10095000
RSCNCCHH EQU   0                                                        10096000
TASSENT  EQU   0                                                        10097000
TASSTYPE EQU   TASSENT                                                  10098000
TASSFL1  EQU   TASSENT+1                                                10099000
TASSREAD EQU   TASSFL1                                                  10100000
TASSSCAN EQU   TASSFL1                                                  10101000
TASSVER  EQU   TASSFL1                                                  10102000
TASSIS   EQU   TASSFL1                                                  10103000
TASSSET  EQU   TASSFL1                                                  10104000
TASSRAB  EQU   TASSENT+2                                                10105000
TASSO    EQU   0                                                        10106000
TASSID   EQU   TASSO                                                    10107000
TASSNENT EQU   TASSO+2                                                  10108000
TASSEN   EQU   TASSO+4                                                  10109000
TABANCHR EQU   0                                                        10110000
TABC     EQU   TABANCHR+8                                               10111000
@NM00102 EQU   TABANCHR+20                                              10112000
TABHEAD  EQU   0                                                        10113000
THEAD    EQU   TABHEAD                                                  10114000
TABBACKW EQU   THEAD                                                    10115000
TABCURR  EQU   THEAD+10                                                 10116000
PTWORK   EQU   0                                                        10117000
PTYPEDTA EQU   PTWORK+12                                                10118000
PTGCIT   EQU   PTYPEDTA                                                 10119000
@NM00104 EQU   PTGCIT                                                   10120000
PTCITI   EQU   @NM00104+1                                               10121000
@NM00106 EQU   PTGCIT+4                                                 10122000
PTCITL   EQU   @NM00106+1                                               10123000
@NM00108 EQU   PTGCIT+8                                                 10124000
PTCITNC  EQU   @NM00108+1                                               10125000
PTCITCUR EQU   PTGCIT+12                                                10126000
PTCITF   EQU   PTGCIT+16                                                10127000
PTCITWK  EQU   PTGCIT+20                                                10128000
PTGDIT   EQU   PTYPEDTA+24                                              10129000
@NM00110 EQU   PTGDIT                                                   10130000
PTDITI   EQU   @NM00110+1                                               10131000
@NM00112 EQU   PTGDIT+4                                                 10132000
PTDITL   EQU   @NM00112+1                                               10133000
@NM00114 EQU   PTGDIT+8                                                 10134000
PTDITNC  EQU   @NM00114+1                                               10135000
PTDITCUR EQU   PTGDIT+12                                                10136000
PTDITF   EQU   PTGDIT+16                                                10137000
PTASSO   EQU   PTYPEDTA+48                                              10138000
PTASSOC  EQU   PTASSO                                                   10139000
PTASSCUR EQU   PTASSO+4                                                 10140000
PTASSOEA EQU   PTASSO+8                                                 10141000
PTASSOE1 EQU   PTASSO+12                                                10142000
PTASSOE  EQU   PTASSOE1                                                 10143000
PTASSDIT EQU   PTASSOE                                                  10144000
PTASSCIT EQU   PTASSOE+4                                                10145000
PTASSEXP EQU   PTASSO+52                                                10146000
PTINDX   EQU   PTYPEDTA+104                                             10147000
PTINDX1  EQU   PTINDX                                                   10148000
PTINDX3  EQU   PTINDX+4                                                 10149000
PTINDXV  EQU   PTINDX+6                                                 10150000
PTINDX4  EQU   PTINDX+8                                                 10151000
PTBASE   EQU   PTYPEDTA+116                                             10152000
PTVERDI  EQU   PTYPEDTA+120                                             10153000
PTVALL   EQU   PTVERDI                                                  10154000
PTVDI    EQU   PTVALL                                                   10155000
PTVDICIT EQU   PTVDI                                                    10156000
PTVDISNT EQU   PTVDI+4                                                  10157000
PTVDIASS EQU   PTVDI+8                                                  10158000
PTVCNT   EQU   PTVERDI+24                                               10159000
PTVDSSNT EQU   PTVERDI+28                                               10160000
PTXALIAS EQU   PTYPEDTA+152                                             10161000
PTXUX1D  EQU   PTXALIAS                                                 10162000
PTXX0X1D EQU   PTXALIAS+4                                               10163000
PTXX1AUD EQU   PTXALIAS+8                                               10164000
PTXX1X2D EQU   PTXALIAS+12                                              10165000
PTXX1X0D EQU   PTXALIAS+16                                              10166000
PTXCITX1 EQU   PTXALIAS+20                                              10167000
PTXX0C   EQU   PTXALIAS+24                                              10168000
PTXX1C   EQU   PTXALIAS+26                                              10169000
PTXX2C   EQU   PTXALIAS+28                                              10170000
PTXFLAGS EQU   PTXALIAS+30                                              10171000
PTXFLAG1 EQU   PTXFLAGS                                                 10172000
PTXEND   EQU   PTXFLAG1                                                 10173000
PTCRAVL  EQU   PTYPEDTA+184                                             10174000
PTFLAGS  EQU   PTYPEDTA+190                                             10175000
PTF1     EQU   PTFLAGS                                                  10176000
PTF1HIT  EQU   PTF1                                                     10177000
PTF1HIT2 EQU   PTF1                                                     10178000
PTF1OK   EQU   PTF1                                                     10179000
PTF1DELT EQU   PTF1                                                     10180000
PTF1CKVL EQU   PTF1                                                     10181000
PTF1ENDG EQU   PTF1                                                     10182000
PTF1ENDA EQU   PTF1                                                     10183000
PTF2     EQU   PTFLAGS+1                                                10184000
PTF2KSDS EQU   PTF2                                                     10185000
PTLOC    EQU   PTWORK+204                                               10186000
@NM00120 EQU   PTLOC                                                    10187000
PTLBCITX EQU   @NM00120+1                                               10188000
PTLCCIT  EQU   PTLOC+4                                                  10189000
PTLCDIT  EQU   PTLOC+8                                                  10190000
@NM00122 EQU   PTLOC+12                                                 10191000
PTLNDIT  EQU   @NM00122+1                                               10192000
PTLSN    EQU   PTLOC+16                                                 10193000
PTLDITFB EQU   PTLOC+18                                                 10194000
PTLFBAS1 EQU   PTLDITFB                                                 10195000
PTLFBAS2 EQU   PTLDITFB                                                 10196000
PTLFBDGO EQU   PTLDITFB                                                 10197000
PTLDITID EQU   PTLOC+19                                                 10198000
PTASOE   EQU   0                                                        10199000
PTASDIT1 EQU   PTASOE                                                   10200000
PTASSEX  EQU   0                                                        10201000
GCITS    EQU   0                                                        10202000
CITABE   EQU   0                                                        10203000
CITFLA   EQU   CITABE                                                   10204000
CITFAVER EQU   CITFLA                                                   10205000
CITFARAS EQU   CITFLA                                                   10206000
CITFAHEP EQU   CITFLA                                                   10207000
CITFAGOE EQU   CITFLA                                                   10208000
CITFASCA EQU   CITFLA                                                   10209000
CITFAINV EQU   CITFLA                                                   10210000
CITFADGO EQU   CITFLA                                                   10211000
CITCIN   EQU   CITABE+1                                                 10212000
@NM00127 EQU   CITABE+4                                                 10213000
CITTYPE  EQU   @NM00127                                                 10214000
CITRCIN  EQU   @NM00127+1                                               10215000
@NM00128 EQU   CITABE+8                                                 10216000
CITDICNT EQU   @NM00128                                                 10217000
CITDITAB EQU   @NM00128+1                                               10218000
@NM00129 EQU   CITABE+12                                                10219000
CITEXTCH EQU   @NM00129+1                                               10220000
@NM00131 EQU   CITABE+16                                                10221000
CITEXTBA EQU   @NM00131+1                                               10222000
GDITS    EQU   0                                                        10223000
DITABE   EQU   0                                                        10224000
DITFA    EQU   DITABE                                                   10225000
DITFAVER EQU   DITFA                                                    10226000
DITFARAS EQU   DITFA                                                    10227000
DITFADEL EQU   DITFA                                                    10228000
DITFLB   EQU   DITABE+1                                                 10229000
DITFBHEP EQU   DITFLB                                                   10230000
DITFBGOE EQU   DITFLB                                                   10231000
DITFBAS1 EQU   DITFLB                                                   10232000
DITFBAS2 EQU   DITFLB                                                   10233000
DITFBDGO EQU   DITFLB                                                   10234000
DITFB256 EQU   DITFLB                                                   10235000
DITOFS   EQU   DITABE+2                                                 10236000
@NM00140 EQU   DITABE+4                                                 10237000
DITSN    EQU   @NM00140                                                 10238000
DITVSN   EQU   DITSN                                                    10239000
DITOSN   EQU   DITVSN+1                                                 10240000
@NM00143 EQU   DITABE+8                                                 10241000
DITCITAB EQU   @NM00143+1                                               10242000
DITDGML  EQU   DITABE+12                                                10243000
GDGLDS   EQU   0                                                        10244000
GDGLHEAD EQU   GDGLDS                                                   10245000
GDGFLG   EQU   GDGLHEAD+30                                              10246000
GDGLENTS EQU   GDGLDS+32                                                10247000
GDGENT   EQU   GDGLENTS                                                 10248000
RSFSNVT  EQU   0                                                        10249000
RSFLAGS  EQU   RSFSNVT+1                                                10250000
RSFENTLN EQU   RSFSNVT+3                                                10251000
RSFHNDX  EQU   RSFSNVT+4                                                10252000
RSFCNDX  EQU   RSFSNVT+6                                                10253000
RSFAENT  EQU   RSFSNVT+8                                                10254000
RSFATTNN EQU   RSFSNVT+16                                               10255000
RSFCADR  EQU   RSFSNVT+24                                               10256000
SNTAB    EQU   0                                                        10257000
SNFIXED  EQU   SNTAB                                                    10258000
SNFLAG   EQU   SNFIXED                                                  10259000
SNFDEL   EQU   SNFLAG                                                   10260000
SNFPROC  EQU   SNFLAG                                                   10261000
SNSN     EQU   SNFIXED+1                                                10262000
SNENTRY  EQU   SNTAB+24                                                 10263000
SNVDATA  EQU   SNENTRY                                                  10264000
SSPHDFLG EQU   SNVDATA+8                                                10265000
SSPEXTNT EQU   SNVDATA+10                                               10266000
SNASSOC  EQU   0                                                        10267000
SNTYPE   EQU   SNASSOC+24                                               10268000
SNNAME   EQU   SNASSOC+25                                               10269000
SNGLEV   EQU   SNASSOC+28                                               10270000
SNVGO    EQU   0                                                        10271000
SNVOLSER EQU   SNVGO+28                                                 10272000
SITYPEXT EQU   SNVGO+34                                                 10273000
SNSSWD   EQU   SITYPEXT                                                 10274000
SDSDIRSN EQU   SNVGO+35                                                 10275000
SNEXTENT EQU   SNVGO+43                                                 10276000
SNVSBM   EQU   0                                                        10277000
SNDSDIR  EQU   0                                                        10278000
SDSIDFLG EQU   SNDSDIR+24                                               10279000
SNTTNN   EQU   0                                                        10280000
CATGOPT  EQU   0                                                        10281000
CATGOCI  EQU   CATGOPT                                                  10282000
CATGOFLG EQU   CATGOCI                                                  10283000
CATGODSP EQU   CATGOCI+1                                                10284000
CATGOGC1 EQU   CATGOPT+3                                                10285000
CATGOEXT EQU   CATGOGC1                                                 10286000
CATGODEL EQU   CATGOGC1                                                 10287000
CATGOSEQ EQU   CATGOPT+4                                                10288000
CATSN    EQU   0                                                        10289000
CATRCD   EQU   0                                                        10290000
RCDCINO  EQU   CATRCD+1                                                 10291000
RCDCRAVL EQU   CATRCD+5                                                 10292000
RCDID    EQU   CATRCD+44                                                10293000
REPCNTRL EQU   0                                                        10294000
EXTRCDPT EQU   REPCNTRL                                                 10295000
EXTGOCI  EQU   EXTRCDPT                                                 10296000
REPCNT   EQU   REPCNTRL+5                                               10297000
REPGOPT  EQU   REPCNTRL+6                                               10298000
VARFIELD EQU   0                                                        10299000
VARLEN   EQU   VARFIELD                                                 10300000
CNTRLINF EQU   0                                                        10301000
LENFIX   EQU   CNTRLINF+1                                               10302000
CTGRBASE EQU   0                                                        10303000
CNAME    EQU   CTGRBASE+49                                              10304000
CATTR    EQU   CTGRBASE+107                                             10305000
CATTR1   EQU   CATTR                                                    10306000
CATTR2   EQU   CATTR+1                                                  10307000
COPEN    EQU   CTGRBASE+109                                             10308000
CSPACPRM EQU   CTGRBASE+114                                             10309000
CCR      EQU   0                                                        10310000
ASGO     EQU   0                                                        10311000
ASG1     EQU   ASGO+2                                                   10312000
ASTYPE   EQU   ASG1                                                     10313000
ASCI     EQU   ASG1+1                                                   10314000
ASG2     EQU   ASGO+6                                                   10315000
ASTYPE2  EQU   ASG2                                                     10316000
ASCI2    EQU   ASG2+1                                                   10317000
ASGOGDG  EQU   0                                                        10318000
ASGDGLVL EQU   ASGOGDG+6                                                10319000
DSDIR    EQU   0                                                        10320000
SPACEPRM EQU   0                                                        10321000
SPCOPTNS EQU   SPACEPRM+6                                               10322000
RGATTRFL EQU   0                                                        10323000
RGATTR1  EQU   RGATTRFL                                                 10324000
RGATTSG1 EQU   RGATTRFL+1                                               10325000
VOLGO    EQU   0                                                        10326000
GDGRCD   EQU   0                                                        10327000
GENLVLS  EQU   0                                                        10328000
CTGPL    EQU   0                                                        10329000
CTGOPTN1 EQU   CTGPL                                                    10330000
CTGOPTN2 EQU   CTGPL+1                                                  10331000
CTGEXT   EQU   CTGOPTN2                                                 10332000
CTGERASE EQU   CTGOPTN2                                                 10333000
CTGSMF   EQU   CTGERASE                                                 10334000
CTGREL   EQU   CTGSMF                                                   10335000
CTGPURG  EQU   CTGOPTN2                                                 10336000
CTGVMNT  EQU   CTGPURG                                                  10337000
CTGRCATN EQU   CTGVMNT                                                  10338000
CTGGTNXT EQU   CTGOPTN2                                                 10339000
CTGOPTN3 EQU   CTGPL+2                                                  10340000
CTGOPTN4 EQU   CTGPL+3                                                  10341000
CTGENT   EQU   CTGPL+4                                                  10342000
CTGFVT   EQU   CTGENT                                                   10343000
CTGCAT   EQU   CTGPL+8                                                  10344000
CTGDSORG EQU   CTGPL+16                                                 10345000
CTGDDNM  EQU   CTGPL+20                                                 10346000
CTGNEWNM EQU   CTGDDNM                                                  10347000
CTGFBFLG EQU   CTGNEWNM+2                                               10348000
CTGJSCB  EQU   CTGPL+24                                                 10349000
CTGFL    EQU   0                                                        10350000
CTGFLDRE EQU   CTGFL+3                                                  10351000
CTGFLDAT EQU   CTGFL+16                                                 10352000
CTGFV    EQU   0                                                        10353000
CTGFVPRO EQU   CTGFV+1                                                  10354000
CTGFVSPC EQU   CTGFV+52                                                 10355000
CTGFVAMD EQU   CTGFV+56                                                 10356000
CTGFVLMT EQU   CTGFV+72                                                 10357000
CTGFVGAT EQU   CTGFV+76                                                 10358000
CVTMAP   EQU   0                                                        10359000
CVTDAR   EQU   CVTMAP+72                                                10360000
CVTFLGS1 EQU   CVTDAR                                                   10361000
CVTDCB   EQU   CVTMAP+116                                               10362000
CVTIERLC EQU   CVTMAP+144                                               10363000
CVTOPTA  EQU   CVTMAP+182                                               10364000
CVTOPTB  EQU   CVTMAP+183                                               10365000
CVTGTF   EQU   CVTMAP+236                                               10366000
CVTGTFST EQU   CVTGTF                                                   10367000
CVTGTFS  EQU   CVTGTFST                                                 10368000
CVTSTATE EQU   CVTGTFST                                                 10369000
CVTTMODE EQU   CVTGTFST                                                 10370000
CVTFORM  EQU   CVTGTFST                                                 10371000
CVTAQAVT EQU   CVTMAP+240                                               10372000
CVTTCMFG EQU   CVTAQAVT                                                 10373000
CVTVOLM2 EQU   CVTMAP+244                                               10374000
CVTTATA  EQU   CVTVOLM2                                                 10375000
CVTTSKS  EQU   CVTTATA                                                  10376000
CVTVOLF2 EQU   CVTTSKS                                                  10377000
CVTTAT   EQU   CVTTATA+1                                                10378000
CVTATER  EQU   CVTMAP+248                                               10379000
CVTEXT1  EQU   CVTMAP+252                                               10380000
CVTPURG  EQU   CVTMAP+260                                               10381000
CVTQMSG  EQU   CVTMAP+268                                               10382000
CVTDMSR  EQU   CVTMAP+272                                               10383000
CVTRSV37 EQU   CVTDMSR                                                  10384000
CVTDMSRF EQU   CVTRSV37                                                 10385000
CVTERPV  EQU   CVTMAP+316                                               10386000
CVTINTLA EQU   CVTMAP+320                                               10387000
CVTAPF   EQU   CVTMAP+324                                               10388000
CVTEXT2  EQU   CVTMAP+328                                               10389000
CVTHJES  EQU   CVTMAP+332                                               10390000
CVTPGSIA EQU   CVTMAP+348                                               10391000
CVTA1F1  EQU   CVTMAP+356                                               10392000
CVTSYSK  EQU   CVTMAP+357                                               10393000
CVTVOLM1 EQU   CVTMAP+380                                               10394000
CVTVOLF1 EQU   CVTVOLM1                                                 10395000
CVTATMCT EQU   CVTMAP+388                                               10396000
CVTXTNT1 EQU   0                                                        10397000
CVTXTNT2 EQU   0                                                        10398000
CVTDSSV  EQU   CVTXTNT2                                                 10399000
CVTFLGBT EQU   CVTXTNT2+5                                               10400000
CVTQID   EQU   CVTXTNT2+24                                              10401000
CVTRV400 EQU   CVTXTNT2+52                                              10402000
CVTRV409 EQU   CVTXTNT2+53                                              10403000
CVTATCVT EQU   CVTXTNT2+64                                              10404000
CVTRV429 EQU   CVTXTNT2+84                                              10405000
CVTRV438 EQU   CVTXTNT2+85                                              10406000
CVTRV457 EQU   CVTXTNT2+112                                             10407000
CVTRV466 EQU   CVTXTNT2+113                                             10408000
CVTFIX   EQU   0                                                        10409000
CVTRELNO EQU   CVTFIX+252                                               10410000
AMCBS    EQU   0                                                        10411000
CBSCMP   EQU   AMCBS+16                                                 10412000
CBSVSRT  EQU   AMCBS+32                                                 10413000
IGGCAXWA EQU   0                                                        10414000
CAXFLGS  EQU   IGGCAXWA+8                                               10415000
CAXFLG2  EQU   IGGCAXWA+9                                               10416000
CAXFLG3  EQU   IGGCAXWA+10                                              10417000
CAXCCR   EQU   IGGCAXWA+32                                              10418000
CAXCNAM  EQU   IGGCAXWA+52                                              10419000
CAXOPLST EQU   IGGCAXWA+96                                              10420000
COPTS    EQU   CAXOPLST                                                 10421000
IFGACB   EQU   0                                                        10422000
ACBCOMN  EQU   IFGACB                                                   10423000
ACBLENG  EQU   ACBCOMN+2                                                10424000
ACBLENG2 EQU   ACBLENG                                                  10425000
ACBAMBL  EQU   ACBCOMN+4                                                10426000
ACBJWA   EQU   ACBAMBL                                                  10427000
ACBMACRF EQU   ACBCOMN+12                                               10428000
ACBMACR1 EQU   ACBMACRF                                                 10429000
ACBADR   EQU   ACBMACR1                                                 10430000
ACBCNV   EQU   ACBMACR1                                                 10431000
ACBMACR2 EQU   ACBMACRF+1                                               10432000
ACBBUFPL EQU   ACBCOMN+20                                               10433000
ACBMACR3 EQU   ACBBUFPL                                                 10434000
ACBRECFM EQU   ACBCOMN+24                                               10435000
ACBCCTYP EQU   ACBCOMN+25                                               10436000
ACBOPT   EQU   ACBCOMN+26                                               10437000
ACBDSORG EQU   ACBOPT                                                   10438000
ACBCROPS EQU   ACBDSORG                                                 10439000
ACBDVIND EQU   ACBDSORG                                                 10440000
ACBEXLST EQU   ACBCOMN+36                                               10441000
ACBDDNM  EQU   ACBCOMN+40                                               10442000
ACBAMETH EQU   ACBDDNM+3                                                10443000
ACBOFLGS EQU   ACBCOMN+48                                               10444000
ACBEXFG  EQU   ACBOFLGS                                                 10445000
ACBIOSFG EQU   ACBOFLGS                                                 10446000
ACBINFLG EQU   ACBCOMN+50                                               10447000
ACBVVIC  EQU   ACBINFLG                                                 10448000
ACBUJFCB EQU   ACBCOMN+52                                               10449000
ACBBLKSZ EQU   ACBCOMN+60                                               10450000
IDAAMDSB EQU   0                                                        10451000
AMDATTR  EQU   IDAAMDSB+1                                               10452000
AMDNEST  EQU   IDAAMDSB+4                                               10453000
AMDHLRBA EQU   IDAAMDSB+28                                              10454000
AMDSSRBA EQU   IDAAMDSB+32                                              10455000
AMDATTR3 EQU   IDAAMDSB+40                                              10456000
AMDSTAT  EQU   IDAAMDSB+48                                              10457000
ALLP     EQU   0                                                        10458000
ALLPPTR  EQU   0                                                        10459000
AMSTP011 EQU   0                                                        10460000
AMSTP041 EQU   0                                                        10461000
AMSTP042 EQU   0                                                        10462000
AMSTP043 EQU   0                                                        10463000
AMSTP044 EQU   0                                                        10464000
BMAP     EQU   0                                                        10465000
CABUFH1  EQU   0                                                        10466000
CABUFL1  EQU   0                                                        10467000
CAT      EQU   0                                                        10468000
CFILE    EQU   0                                                        10469000
CFILECNT EQU   0                                                        10470000
CIN      EQU   0                                                        10471000
CRADNPTR EQU   0                                                        10472000
CRADVPTR EQU   0                                                        10473000
CRAVLPTR EQU   0                                                        10474000
CRBUF1   EQU   0                                                        10475000
CVOL     EQU   0                                                        10476000
CVOLCNT  EQU   0                                                        10477000
DMPTRM   EQU   0                                                        10478000
IDCIOCL0 EQU   0                                                        10479000
IDCIOCO0 EQU   0                                                        10480000
IDCIOGT0 EQU   0                                                        10481000
IDCIOIT0 EQU   0                                                        10482000
IDCIOOP0 EQU   0                                                        10483000
IDCIOPO0 EQU   0                                                        10484000
IDCIOPT0 EQU   0                                                        10485000
IDCIOSI0 EQU   0                                                        10486000
IDCIOST0 EQU   0                                                        10487000
IDCIOTM0 EQU   0                                                        10488000
IDCIOVY0 EQU   0                                                        10489000
IDCIO050 EQU   0                                                        10490000
IDCSAAL0 EQU   0                                                        10491000
IDCSACA0 EQU   0                                                        10492000
IDCSACL0 EQU   0                                                        10493000
IDCSACR0 EQU   0                                                        10494000
IDCSADE0 EQU   0                                                        10495000
IDCSADL0 EQU   0                                                        10496000
IDCSADQ0 EQU   0                                                        10497000
IDCSAEP0 EQU   0                                                        10498000
IDCSAFS0 EQU   0                                                        10499000
IDCSAGP0 EQU   0                                                        10500000
IDCSAGS0 EQU   0                                                        10501000
IDCSAID0 EQU   0                                                        10502000
IDCSALC0 EQU   0                                                        10503000
IDCSALD0 EQU   0                                                        10504000
IDCSALK0 EQU   0                                                        10505000
IDCSANQ0 EQU   0                                                        10506000
IDCSAPR0 EQU   0                                                        10507000
IDCSAPT0 EQU   0                                                        10508000
IDCSAQL0 EQU   0                                                        10509000
IDCSARC0 EQU   0                                                        10510000
IDCSARV0 EQU   0                                                        10511000
IDCSASC0 EQU   0                                                        10512000
IDCSASI0 EQU   0                                                        10513000
IDCSASN0 EQU   0                                                        10514000
IDCSASS0 EQU   0                                                        10515000
IDCSAST0 EQU   0                                                        10516000
IDCSATI0 EQU   0                                                        10517000
IDCSAUC0 EQU   0                                                        10518000
IDCSAWO0 EQU   0                                                        10519000
IDCSA060 EQU   0                                                        10520000
IDCST010 EQU   0                                                        10521000
IDCTPER0 EQU   0                                                        10522000
IGN      EQU   0                                                        10523000
LASTCC   EQU   0                                                        10524000
LISTTEST EQU   0                                                        10525000
NEWERID1 EQU   5                                                        10526000
NIGN     EQU   0                                                        10527000
NONE     EQU   0                                                        10528000
NONEPTR  EQU   0                                                        10529000
RABS     EQU   0                                                        10530000
WFDN     EQU   0                                                        10531000
RSWFLD   EQU   RABPROC                                                  10532000
RSWFKG1  EQU   RSWFLD+8                                                 10533000
RSWFCRA  EQU   RSWFKG1                                                  10534000
RSWDLCAT EQU   RSWFKG1                                                  10535000
RSWUPCAT EQU   RSWFKG1                                                  10536000
RSWRASCI EQU   RSWFKG1                                                  10537000
RSWASSCK EQU   RSWFKG1                                                  10538000
RSWFLG2  EQU   RSWFLD+9                                                 10539000
RSWINVCI EQU   RSWFLG2                                                  10540000
RSWDSDIR EQU   RSWFLG2                                                  10541000
RABARRAY EQU   GRABRABS                                                 10542000
@NM00165 EQU   CATTR1                                                   10543000
CCATTR   EQU   @NM00165                                                 10544000
@NM00166 EQU   CCATTR                                                   10545000
@NM00168 EQU   CATTR1                                                   10546000
CRGATTR  EQU   @NM00168                                                 10547000
CUPG     EQU   CRGATTR                                                  10548000
DEVCHARS EQU   RABBUF+101                                               10549000
@NM00177 EQU   DEVCHARS                                                 10550000
RTDEVUCB EQU   @NM00177                                                 10551000
RTBOKAB  EQU   @NM00177+14                                              10552000
RTDVFLGS EQU   @NM00177+17                                              10553000
@NM00191 EQU   CTGDDNM                                                  10554000
CTGPROB  EQU   @NM00191                                                 10555000
CTGREASN EQU   CTGPROB+2                                                10556000
CVTS01   EQU   CVTPGSIA                                                 10557000
CVTLPDIA EQU   CVTS01+12                                                10558000
CVTDIRST EQU   CVTLPDIA                                                 10559000
CVTSLIDA EQU   CVTS01+24                                                10560000
CVTCTLFG EQU   CVTS01+50                                                10561000
CVTRV210 EQU   CVTS01+424                                               10562000
CVTRV219 EQU   CVTS01+425                                               10563000
CVTRV228 EQU   CVTS01+426                                               10564000
CVTRV237 EQU   CVTS01+427                                               10565000
CVTMFRTR EQU   CVTS01+452                                               10566000
CVTRV262 EQU   CVTS01+468                                               10567000
CVTRV271 EQU   CVTS01+469                                               10568000
CVTRV280 EQU   CVTS01+470                                               10569000
CVTRV289 EQU   CVTS01+471                                               10570000
CVTGSDA  EQU   CVTS01+600                                               10571000
BMAPARRY EQU   RSMAPS                                                   10572000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    10573000
CVTRV628 EQU   CVTS01+728                                               10574000
CVTRV627 EQU   CVTS01+724                                               10575000
CVTRV626 EQU   CVTS01+720                                               10576000
CVTRV625 EQU   CVTS01+716                                               10577000
CVTRV624 EQU   CVTS01+712                                               10578000
CVTRV623 EQU   CVTS01+708                                               10579000
CVTRV622 EQU   CVTS01+704                                               10580000
CVTRV621 EQU   CVTS01+700                                               10581000
CVTIHASU EQU   CVTS01+696                                               10582000
CVTRV619 EQU   CVTS01+692                                               10583000
CVTRV618 EQU   CVTS01+688                                               10584000
CVTRV617 EQU   CVTS01+684                                               10585000
CVTRV616 EQU   CVTS01+680                                               10586000
CVTRV615 EQU   CVTS01+676                                               10587000
CVTRV614 EQU   CVTS01+672                                               10588000
CVTRV613 EQU   CVTS01+668                                               10589000
CVTTCASP EQU   CVTS01+664                                               10590000
CVT0PT03 EQU   CVTS01+660                                               10591000
CVT0PT0E EQU   CVTS01+656                                               10592000
CVTRV609 EQU   CVTS01+652                                               10593000
CVTCGK   EQU   CVTS01+648                                               10594000
CVTRAC   EQU   CVTS01+644                                               10595000
CVTRV606 EQU   CVTS01+640                                               10596000
CVTRV605 EQU   CVTS01+636                                               10597000
CVTRV604 EQU   CVTS01+632                                               10598000
CVTEFF02 EQU   CVTS01+628                                               10599000
CVTCBBR  EQU   CVTS01+624                                               10600000
CVTSSCR  EQU   CVTS01+620                                               10601000
CVTEVENT EQU   CVTS01+616                                               10602000
CVTCRCA  EQU   CVTS01+612                                               10603000
CVTTPIO  EQU   CVTS01+608                                               10604000
CVTADV   EQU   CVTS01+604                                               10605000
CVTGSDAB EQU   CVTGSDA                                                  10606000
CVTQV3   EQU   CVTS01+596                                               10607000
CVTQV2   EQU   CVTS01+592                                               10608000
CVTQV1   EQU   CVTS01+588                                               10609000
CVTRPT   EQU   CVTS01+584                                               10610000
CVTSSRB  EQU   CVTS01+580                                               10611000
CVTCSDRL EQU   CVTS01+576                                               10612000
CVTEXP1  EQU   CVTS01+572                                               10613000
CVTRMPMT EQU   CVTS01+568                                               10614000
CVTRMPTT EQU   CVTS01+564                                               10615000
CVTVPSA  EQU   CVTS01+560                                               10616000
CVTVSTOP EQU   CVTS01+556                                               10617000
CVTGTFR8 EQU   CVTS01+552                                               10618000
CVTQUIT  EQU   CVTS01+548                                               10619000
CVTVACR  EQU   CVTS01+544                                               10620000
CVTWTCB  EQU   CVTS01+540                                               10621000
CVTSTPRS EQU   CVTS01+536                                               10622000
CVT0PT02 EQU   CVTS01+532                                               10623000
CVTDARCM EQU   CVTS01+528                                               10624000
CVTIRECM EQU   CVTS01+524                                               10625000
CVTJRECM EQU   CVTS01+520                                               10626000
CVTVEMS0 EQU   CVTS01+516                                               10627000
CVTSPFRR EQU   CVTS01+512                                               10628000
CVTRLSTG EQU   CVTS01+508                                               10629000
CVT0TC0A EQU   CVTS01+504                                               10630000
CVTGMBR  EQU   CVTS01+500                                               10631000
CVTLFRM  EQU   CVTS01+496                                               10632000
CVTRMBR  EQU   CVTS01+492                                               10633000
CVTVIOP  EQU   CVTS01+488                                               10634000
CVTRV307 EQU   CVTS01+486                                               10635000
CVTRV306 EQU   CVTS01+484                                               10636000
CVTRV305 EQU   CVTS01+482                                               10637000
CVTRV304 EQU   CVTS01+480                                               10638000
CVTRV303 EQU   CVTS01+478                                               10639000
CVTRV302 EQU   CVTS01+476                                               10640000
CVTTRCA  EQU   CVTS01+472                                               10641000
CVTRV297 EQU   CVTRV289                                                 10642000
CVTRV296 EQU   CVTRV289                                                 10643000
CVTRV295 EQU   CVTRV289                                                 10644000
CVTRV294 EQU   CVTRV289                                                 10645000
CVTRV293 EQU   CVTRV289                                                 10646000
CVTRV292 EQU   CVTRV289                                                 10647000
CVTRV291 EQU   CVTRV289                                                 10648000
CVTRV290 EQU   CVTRV289                                                 10649000
CVTRV288 EQU   CVTRV280                                                 10650000
CVTRV287 EQU   CVTRV280                                                 10651000
CVTRV286 EQU   CVTRV280                                                 10652000
CVTRV285 EQU   CVTRV280                                                 10653000
CVTRV284 EQU   CVTRV280                                                 10654000
CVTRV283 EQU   CVTRV280                                                 10655000
CVTRV282 EQU   CVTRV280                                                 10656000
CVTRV281 EQU   CVTRV280                                                 10657000
CVTRV279 EQU   CVTRV271                                                 10658000
CVTRV278 EQU   CVTRV271                                                 10659000
CVTRV277 EQU   CVTRV271                                                 10660000
CVTRV276 EQU   CVTRV271                                                 10661000
CVTRV275 EQU   CVTRV271                                                 10662000
CVTRV274 EQU   CVTRV271                                                 10663000
CVTRV273 EQU   CVTRV271                                                 10664000
CVTRV272 EQU   CVTRV271                                                 10665000
CVTRV270 EQU   CVTRV262                                                 10666000
CVTRV269 EQU   CVTRV262                                                 10667000
CVTRV268 EQU   CVTRV262                                                 10668000
CVTRV267 EQU   CVTRV262                                                 10669000
CVTRV266 EQU   CVTRV262                                                 10670000
CVTRV265 EQU   CVTRV262                                                 10671000
CVTRV264 EQU   CVTRV262                                                 10672000
CVTRV263 EQU   CVTRV262                                                 10673000
CVTVFP   EQU   CVTS01+464                                               10674000
CVTVSI   EQU   CVTS01+460                                               10675000
CVTVPSIB EQU   CVTS01+456                                               10676000
CVTMFACT EQU   CVTMFRTR                                                 10677000
CVTMFCTL EQU   CVTS01+448                                               10678000
CVTPVBP  EQU   CVTS01+444                                               10679000
CVTPWI   EQU   CVTS01+440                                               10680000
CVTRV254 EQU   CVTS01+438                                               10681000
CVTRV253 EQU   CVTS01+436                                               10682000
CVTRV252 EQU   CVTS01+434                                               10683000
CVTRV251 EQU   CVTS01+433                                               10684000
CVTRV250 EQU   CVTS01+432                                               10685000
CVTRV249 EQU   CVTS01+431                                               10686000
CVTRV248 EQU   CVTS01+430                                               10687000
CVTRV247 EQU   CVTS01+429                                               10688000
CVTRV246 EQU   CVTS01+428                                               10689000
CVTRV245 EQU   CVTRV237                                                 10690000
CVTRV244 EQU   CVTRV237                                                 10691000
CVTRV243 EQU   CVTRV237                                                 10692000
CVTRV242 EQU   CVTRV237                                                 10693000
CVTRV241 EQU   CVTRV237                                                 10694000
CVTRV240 EQU   CVTRV237                                                 10695000
CVTRV239 EQU   CVTRV237                                                 10696000
CVTRV238 EQU   CVTRV237                                                 10697000
CVTRV236 EQU   CVTRV228                                                 10698000
CVTRV235 EQU   CVTRV228                                                 10699000
CVTRV234 EQU   CVTRV228                                                 10700000
CVTRV233 EQU   CVTRV228                                                 10701000
CVTRV232 EQU   CVTRV228                                                 10702000
CVTRV231 EQU   CVTRV228                                                 10703000
CVTRV230 EQU   CVTRV228                                                 10704000
CVTRV229 EQU   CVTRV228                                                 10705000
CVTRV227 EQU   CVTRV219                                                 10706000
CVTRV226 EQU   CVTRV219                                                 10707000
CVTRV225 EQU   CVTRV219                                                 10708000
CVTRV224 EQU   CVTRV219                                                 10709000
CVTRV223 EQU   CVTRV219                                                 10710000
CVTRV222 EQU   CVTRV219                                                 10711000
CVTRV221 EQU   CVTRV219                                                 10712000
CVTRV220 EQU   CVTRV219                                                 10713000
CVTRV218 EQU   CVTRV210                                                 10714000
CVTRV217 EQU   CVTRV210                                                 10715000
CVTRV216 EQU   CVTRV210                                                 10716000
CVTRV215 EQU   CVTRV210                                                 10717000
CVTRV214 EQU   CVTRV210                                                 10718000
CVTRV213 EQU   CVTRV210                                                 10719000
CVTRV212 EQU   CVTRV210                                                 10720000
CVTRV211 EQU   CVTRV210                                                 10721000
CVTLCCAT EQU   CVTS01+420                                               10722000
CVTPCCAT EQU   CVTS01+416                                               10723000
CVTIPCRP EQU   CVTS01+412                                               10724000
CVTIPCRI EQU   CVTS01+408                                               10725000
CVTIPCDS EQU   CVTS01+404                                               10726000
CVTAIDVT EQU   CVTS01+400                                               10727000
CVTSSAP  EQU   CVTS01+396                                               10728000
CVTEHCIR EQU   CVTS01+392                                               10729000
CVTEHDEF EQU   CVTS01+388                                               10730000
CVTDAIR  EQU   CVTS01+384                                               10731000
CVTPERFM EQU   CVTS01+380                                               10732000
CVT044R2 EQU   CVTS01+376                                               10733000
CVTFETCH EQU   CVTS01+372                                               10734000
CVTRSTWD EQU   CVTS01+368                                               10735000
CVTSPOST EQU   CVTS01+364                                               10736000
CVTIOBP  EQU   CVTS01+360                                               10737000
CVTASMVT EQU   CVTS01+356                                               10738000
CVTRECRQ EQU   CVTS01+352                                               10739000
CVTWSAC  EQU   CVTS01+348                                               10740000
CVTRV149 EQU   CVTS01+344                                               10741000
CVTWSAL  EQU   CVTS01+340                                               10742000
CVTSPSA  EQU   CVTS01+336                                               10743000
CVTGLMN  EQU   CVTS01+332                                               10744000
CVTVEAC0 EQU   CVTS01+328                                               10745000
CVT062R1 EQU   CVTS01+324                                               10746000
CVTRPOST EQU   CVTS01+320                                               10747000
CVTDQIQE EQU   CVTS01+316                                               10748000
CVTCSD   EQU   CVTS01+312                                               10749000
CVTLKRMA EQU   CVTS01+308                                               10750000
CVTRSPIE EQU   CVTS01+304                                               10751000
CVTRENQ  EQU   CVTS01+300                                               10752000
CVTLQCB  EQU   CVTS01+296                                               10753000
CVTFQCB  EQU   CVTS01+292                                               10754000
CVTQCS01 EQU   CVTS01+288                                               10755000
CVTAPFT  EQU   CVTS01+284                                               10756000
CVTPARRL EQU   CVTS01+280                                               10757000
CVTVWAIT EQU   CVTS01+276                                               10758000
CVTGSPL  EQU   CVTS01+272                                               10759000
CVTLSMQ  EQU   CVTS01+268                                               10760000
CVTGSMQ  EQU   CVTS01+264                                               10761000
CVTEXPRO EQU   CVTS01+260                                               10762000
CVTOPCTP EQU   CVTS01+256                                               10763000
CVTSIC   EQU   CVTS01+252                                               10764000
CVTTPIOS EQU   CVTS01+248                                               10765000
CVTRTMS  EQU   CVTS01+244                                               10766000
CVTSDBF  EQU   CVTS01+240                                               10767000
CVTSCBP  EQU   CVTS01+236                                               10768000
CVTSDMP  EQU   CVTS01+232                                               10769000
CVTSV60  EQU   CVTS01+228                                               10770000
CVTRTMCT EQU   CVTS01+224                                               10771000
CVTASCBL EQU   CVTS01+220                                               10772000
CVTASCBH EQU   CVTS01+216                                               10773000
CVTGDA   EQU   CVTS01+212                                               10774000
CVTASVT  EQU   CVTS01+208                                               10775000
CVTVVMDI EQU   CVTS01+204                                               10776000
CVTAQTOP EQU   CVTS01+200                                               10777000
CVTIOSCS EQU   CVTS01+196                                               10778000
CVTSDRM  EQU   CVTS01+192                                               10779000
CVTOPTE  EQU   CVTS01+188                                               10780000
CVTSTXU  EQU   CVTS01+184                                               10781000
CVTQUIS  EQU   CVTS01+180                                               10782000
CVTPARS  EQU   CVTS01+176                                               10783000
CVTS1EE  EQU   CVTS01+172                                               10784000
CVTFRAS  EQU   CVTS01+168                                               10785000
CVTQSAS  EQU   CVTS01+164                                               10786000
CVTCRAS  EQU   CVTS01+160                                               10787000
CVTCRMN  EQU   CVTS01+156                                               10788000
CVTDELCP EQU   CVTS01+152                                               10789000
CVTFRECL EQU   CVTS01+148                                               10790000
CVTGETCL EQU   CVTS01+144                                               10791000
CVTBLDCP EQU   CVTS01+140                                               10792000
CVTAUTHL EQU   CVTS01+136                                               10793000
CVTSCAN  EQU   CVTS01+132                                               10794000
CVTRV144 EQU   CVTS01+130                                               10795000
CVTMAXMP EQU   CVTS01+128                                               10796000
CVTSTCK  EQU   CVTS01+124                                               10797000
CVTRV139 EQU   CVTS01+123                                               10798000
CVTDSSAC EQU   CVTS01+122                                               10799000
CVTRV513 EQU   CVTS01+121                                               10800000
CVTIOSPL EQU   CVTS01+120                                               10801000
CVTPTGT  EQU   CVTS01+116                                               10802000
CVTCSPIE EQU   CVTS01+112                                               10803000
CVTSMFEX EQU   CVTS01+108                                               10804000
CVTOLT0A EQU   CVTS01+104                                               10805000
CVTSRBRT EQU   CVTS01+100                                               10806000
CVTPUTL  EQU   CVTS01+96                                                10807000
CVTASCRL EQU   CVTS01+92                                                10808000
CVTASCRF EQU   CVTS01+88                                                10809000
CVTRV326 EQU   CVTS01+84                                                10810000
CVTRV325 EQU   CVTS01+80                                                10811000
CVTRV324 EQU   CVTS01+76                                                10812000
CVT0VL01 EQU   CVTS01+72                                                10813000
CVTSHRVM EQU   CVTS01+68                                                10814000
CVTRV332 EQU   CVTS01+64                                                10815000
CVTTAS   EQU   CVTS01+60                                                10816000
CVTRSCN  EQU   CVTS01+56                                                10817000
CVTTRAC2 EQU   CVTS01+54                                                10818000
CVTTRACE EQU   CVTS01+52                                                10819000
CVTAPG   EQU   CVTS01+51                                                10820000
CVTSDTRC EQU   CVTCTLFG                                                 10821000
CVTGTRCE EQU   CVTCTLFG                                                 10822000
CVTNOMP  EQU   CVTCTLFG                                                 10823000
CVTRSV79 EQU   CVTCTLFG                                                 10824000
CVTDSTAT EQU   CVTCTLFG                                                 10825000
CVTRSV78 EQU   CVTCTLFG                                                 10826000
CVTRV333 EQU   CVTCTLFG                                                 10827000
CVTRV323 EQU   CVTCTLFG                                                 10828000
CVTSPVLK EQU   CVTS01+49                                                10829000
CVTRSV77 EQU   CVTS01+48                                                10830000
CVTRV331 EQU   CVTS01+44                                                10831000
CVTRV330 EQU   CVTS01+40                                                10832000
CVTRV329 EQU   CVTS01+36                                                10833000
CVTRV328 EQU   CVTS01+32                                                10834000
CVTRV322 EQU   CVTS01+28                                                10835000
CVTSLID  EQU   CVTSLIDA+1                                               10836000
CVTSYLK  EQU   CVTSLIDA                                                 10837000
CVTRV321 EQU   CVTS01+20                                                10838000
CVTRV320 EQU   CVTS01+16                                                10839000
CVTLPDIR EQU   CVTLPDIA+1                                               10840000
CVTRSV69 EQU   CVTDIRST                                                 10841000
CVTRSV68 EQU   CVTDIRST                                                 10842000
CVTRSV67 EQU   CVTDIRST                                                 10843000
CVTRSV66 EQU   CVTDIRST                                                 10844000
CVTRSV65 EQU   CVTDIRST                                                 10845000
CVTRSV64 EQU   CVTDIRST                                                 10846000
CVTRSV63 EQU   CVTDIRST                                                 10847000
CVTDICOM EQU   CVTDIRST                                                 10848000
CVTPVTP  EQU   CVTS01+8                                                 10849000
CVTLPDSR EQU   CVTS01+4                                                 10850000
CVTGETL  EQU   CVTS01                                                   10851000
CTGREAS2 EQU   CTGREASN+1                                               10852000
CTGREAS1 EQU   CTGREASN                                                 10853000
CTGMODID EQU   CTGPROB                                                  10854000
RTTOLFCT EQU   @NM00177+18                                              10855000
RTTOLFLG EQU   RTDVFLGS                                                 10856000
@NM00180 EQU   RTDVFLGS                                                 10857000
RTKABFLG EQU   RTDVFLGS                                                 10858000
@NM00179 EQU   RTDVFLGS                                                 10859000
RTBONK   EQU   @NM00177+16                                              10860000
RTBOKLB  EQU   RTBOKAB+1                                                10861000
RTBOKNLB EQU   RTBOKAB                                                  10862000
RTTRKSIZ EQU   @NM00177+12                                              10863000
RTNOTRKS EQU   @NM00177+10                                              10864000
RTNOCYLS EQU   @NM00177+8                                               10865000
RTMXDBLK EQU   @NM00177+4                                               10866000
RTCLSTYP EQU   RTDEVUCB+2                                               10867000
@NM00178 EQU   RTDEVUCB                                                 10868000
@NM00169 EQU   CRGATTR                                                  10869000
CUPD     EQU   CUPG                                                     10870000
CPGSP    EQU   @NM00166                                                 10871000
@NM00167 EQU   @NM00166                                                 10872000
@NM00094 EQU   RSWFLG2                                                  10873000
RSWCHRA  EQU   RSWFLG2                                                  10874000
RSWCHNRR EQU   RSWFLG2                                                  10875000
RSWUPCCH EQU   RSWFLG2                                                  10876000
RSWDICHK EQU   RSWFLG2                                                  10877000
RSWDUPRR EQU   RSWFLG2                                                  10878000
RSWDUPCI EQU   RSWFKG1                                                  10879000
@NM00093 EQU   RSWFKG1                                                  10880000
RSWUPCRA EQU   RSWFKG1                                                  10881000
RSWDUPTR EQU   RSWFLD+4                                                 10882000
RSWCHPTR EQU   RSWFLD                                                   10883000
AMDEXCP  EQU   AMDSTAT+44                                               10884000
AMDNCAS  EQU   AMDSTAT+40                                               10885000
AMDNCIS  EQU   AMDSTAT+36                                               10886000
AMDASPA  EQU   AMDSTAT+32                                               10887000
AMDRETR  EQU   AMDSTAT+28                                               10888000
AMDUPR   EQU   AMDSTAT+24                                               10889000
AMDIREC  EQU   AMDSTAT+20                                               10890000
AMDDELR  EQU   AMDSTAT+16                                               10891000
AMDNLR   EQU   AMDSTAT+12                                               10892000
AMDNEXT  EQU   AMDSTAT+10                                               10893000
AMDNIL   EQU   AMDSTAT+8                                                10894000
AMDSTSP  EQU   AMDSTAT                                                  10895000
@NM00215 EQU   IDAAMDSB+41                                              10896000
@NM00214 EQU   AMDATTR3                                                 10897000
AMDLM    EQU   AMDATTR3                                                 10898000
AMDWAIT  EQU   AMDATTR3                                                 10899000
AMDBIND  EQU   AMDATTR3                                                 10900000
AMDFAULT EQU   AMDATTR3                                                 10901000
AMDUNQ   EQU   AMDATTR3                                                 10902000
AMDPARDB EQU   IDAAMDSB+36                                              10903000
AMDMAXRR EQU   AMDSSRBA                                                 10904000
AMDNSLOT EQU   AMDHLRBA                                                 10905000
AMDLRECL EQU   IDAAMDSB+24                                              10906000
AMDCINV  EQU   IDAAMDSB+20                                              10907000
AMDFSCI  EQU   IDAAMDSB+16                                              10908000
AMDFSCA  EQU   IDAAMDSB+14                                              10909000
AMDCIPCA EQU   IDAAMDSB+12                                              10910000
AMDPCTCI EQU   IDAAMDSB+11                                              10911000
AMDPCTCA EQU   IDAAMDSB+10                                              10912000
AMDKEYLN EQU   IDAAMDSB+8                                               10913000
AMDRKP   EQU   IDAAMDSB+6                                               10914000
AMDAXRKP EQU   AMDNEST                                                  10915000
AMDLEN   EQU   IDAAMDSB+2                                               10916000
AMDSPAN  EQU   AMDATTR                                                  10917000
AMDRRDS  EQU   AMDATTR                                                  10918000
AMDRANGE EQU   AMDATTR                                                  10919000
AMDORDER EQU   AMDATTR                                                  10920000
AMDREPL  EQU   AMDATTR                                                  10921000
AMDSDT   EQU   AMDATTR                                                  10922000
AMDWCK   EQU   AMDATTR                                                  10923000
AMDDST   EQU   AMDATTR                                                  10924000
AMDSBID  EQU   IDAAMDSB                                                 10925000
ACBAPID  EQU   ACBCOMN+72                                               10926000
ACBCBMWA EQU   ACBCOMN+68                                               10927000
ACBUAPTR EQU   ACBCOMN+64                                               10928000
ACBLRECL EQU   ACBCOMN+62                                               10929000
ACBMSGLN EQU   ACBBLKSZ                                                 10930000
ACBBUFSP EQU   ACBCOMN+56                                               10931000
@NM00213 EQU   ACBUJFCB+1                                               10932000
ACBOPTN  EQU   ACBUJFCB                                                 10933000
@NM00212 EQU   ACBINFLG+1                                               10934000
ACBBYPSS EQU   ACBINFLG                                                 10935000
ACBSDS   EQU   ACBVVIC                                                  10936000
ACBUCRA  EQU   ACBINFLG                                                 10937000
ACBSCRA  EQU   ACBINFLG                                                 10938000
ACBCAT   EQU   ACBINFLG                                                 10939000
ACBIJRQE EQU   ACBINFLG                                                 10940000
ACBJEPS  EQU   ACBINFLG                                                 10941000
@NM00211 EQU   ACBINFLG                                                 10942000
ACBERFLG EQU   ACBCOMN+49                                               10943000
ACBBUSY  EQU   ACBIOSFG                                                 10944000
ACBLOCK  EQU   ACBEXFG                                                  10945000
@NM00210 EQU   ACBOFLGS                                                 10946000
ACBDSERR EQU   ACBOFLGS                                                 10947000
ACBOPEN  EQU   ACBOFLGS                                                 10948000
ACBEOV   EQU   ACBOFLGS                                                 10949000
@NM00209 EQU   ACBOFLGS                                                 10950000
ACBDEB   EQU   ACBDDNM+5                                                10951000
ACBERFL  EQU   ACBDDNM+4                                                10952000
ACBAM    EQU   ACBAMETH                                                 10953000
ACBINFL  EQU   ACBDDNM+2                                                10954000
ACBTIOT  EQU   ACBDDNM                                                  10955000
ACBUEL   EQU   ACBEXLST                                                 10956000
ACBPASSW EQU   ACBCOMN+32                                               10957000
ACBMSGAR EQU   ACBCOMN+28                                               10958000
@NM00208 EQU   ACBDSORG+1                                               10959000
ACBDORGA EQU   ACBDSORG+1                                               10960000
@NM00207 EQU   ACBDSORG                                                 10961000
ACBOPTJ  EQU   ACBDVIND                                                 10962000
ACBCRNRE EQU   ACBCROPS                                                 10963000
ACBCRNCK EQU   ACBCROPS                                                 10964000
ACBASA   EQU   ACBCCTYP                                                 10965000
@NM00206 EQU   ACBCCTYP                                                 10966000
ACBTRCID EQU   ACBCCTYP                                                 10967000
@NM00205 EQU   ACBRECFM                                                 10968000
ACBRECAF EQU   ACBRECFM                                                 10969000
ACBJBUF  EQU   ACBBUFPL+2                                               10970000
ACBMACR4 EQU   ACBBUFPL+1                                               10971000
@NM00204 EQU   ACBMACR3                                                 10972000
ACBNCFX  EQU   ACBMACR3                                                 10973000
ACBSIS   EQU   ACBMACR3                                                 10974000
ACBDFR   EQU   ACBMACR3                                                 10975000
ACBICI   EQU   ACBMACR3                                                 10976000
ACBGSR   EQU   ACBMACR3                                                 10977000
ACBLSR   EQU   ACBMACR3                                                 10978000
@NM00203 EQU   ACBMACR3                                                 10979000
ACBBUFNI EQU   ACBCOMN+18                                               10980000
ACBBUFND EQU   ACBCOMN+16                                               10981000
ACBSTRNO EQU   ACBCOMN+15                                               10982000
ACBBSTNO EQU   ACBCOMN+14                                               10983000
ACBAIX   EQU   ACBMACR2                                                 10984000
ACBDSN   EQU   ACBMACR2                                                 10985000
ACBRST   EQU   ACBMACR2                                                 10986000
ACBLOGON EQU   ACBMACR2                                                 10987000
ACBSKP   EQU   ACBMACR2                                                 10988000
@NM00202 EQU   ACBMACR2                                                 10989000
ACBUBF   EQU   ACBMACR1                                                 10990000
ACBOUT   EQU   ACBMACR1                                                 10991000
ACBIN    EQU   ACBMACR1                                                 10992000
ACBDIR   EQU   ACBMACR1                                                 10993000
ACBSEQ   EQU   ACBMACR1                                                 10994000
ACBBLK   EQU   ACBCNV                                                   10995000
ACBADD   EQU   ACBADR                                                   10996000
ACBKEY   EQU   ACBMACR1                                                 10997000
ACBINRTN EQU   ACBCOMN+8                                                10998000
ACBIBCT  EQU   ACBJWA                                                   10999000
ACBLEN2  EQU   ACBLENG2                                                 11000000
ACBSTYP  EQU   ACBCOMN+1                                                11001000
ACBID    EQU   ACBCOMN                                                  11002000
CAXCRACB EQU   IGGCAXWA+112                                             11003000
CAXJDE   EQU   IGGCAXWA+108                                             11004000
CAXCCA   EQU   IGGCAXWA+104                                             11005000
CAXOPEWA EQU   IGGCAXWA+100                                             11006000
COPACB   EQU   CAXOPLST+1                                               11007000
@NM00201 EQU   COPTS                                                    11008000
CENLST   EQU   COPTS                                                    11009000
@NM00200 EQU   CAXCNAM+22                                               11010000
CAXRADDN EQU   CAXCNAM+14                                               11011000
CAXRATEP EQU   CAXCNAM+10                                               11012000
CAXRACTS EQU   CAXCNAM+6                                                11013000
CAXVOLID EQU   CAXCNAM                                                  11014000
CAXRPL   EQU   IGGCAXWA+48                                              11015000
CAXRPLCT EQU   IGGCAXWA+46                                              11016000
CAXASID  EQU   IGGCAXWA+44                                              11017000
CAXFDCI  EQU   CAXCCR+9                                                 11018000
CAXCDCI  EQU   CAXCCR+6                                                 11019000
CAXNFCI  EQU   CAXCCR+3                                                 11020000
CAXHACI  EQU   CAXCCR                                                   11021000
CAXUCB   EQU   IGGCAXWA+28                                              11022000
CAXACB   EQU   IGGCAXWA+24                                              11023000
CAXDRWP  EQU   IGGCAXWA+20                                              11024000
CAXSCHWA EQU   IGGCAXWA+16                                              11025000
CAXATIOT EQU   IGGCAXWA+12                                              11026000
CAXACT   EQU   IGGCAXWA+11                                              11027000
@NM00199 EQU   CAXFLG3                                                  11028000
CAXF3B6  EQU   CAXFLG3                                                  11029000
CAXF3B5  EQU   CAXFLG3                                                  11030000
@NM00198 EQU   CAXFLG3                                                  11031000
CAXF3ANE EQU   CAXFLG3                                                  11032000
CAXF3AT  EQU   CAXFLG3                                                  11033000
CAXF2VTU EQU   CAXFLG2                                                  11034000
CAXF2REC EQU   CAXFLG2                                                  11035000
CAXF2CA  EQU   CAXFLG2                                                  11036000
CAXF2CLR EQU   CAXFLG2                                                  11037000
CAXF2IOE EQU   CAXFLG2                                                  11038000
CAXF2NCR EQU   CAXFLG2                                                  11039000
CAXF2NDD EQU   CAXFLG2                                                  11040000
CAXF2DT  EQU   CAXFLG2                                                  11041000
CAXSCR   EQU   CAXFLGS                                                  11042000
CAXCMR   EQU   CAXFLGS                                                  11043000
CAXMCT   EQU   CAXFLGS                                                  11044000
CAXCMP   EQU   CAXFLGS                                                  11045000
CAXEOV   EQU   CAXFLGS                                                  11046000
CAXCLS   EQU   CAXFLGS                                                  11047000
CAXOPN   EQU   CAXFLGS                                                  11048000
CAXBLD   EQU   CAXFLGS                                                  11049000
CAXCHN   EQU   IGGCAXWA+4                                               11050000
@NM00197 EQU   IGGCAXWA+1                                               11051000
CAXID    EQU   IGGCAXWA                                                 11052000
CBSVPTR  EQU   CBSVSRT+4                                                11053000
CBSVUSE  EQU   CBSVSRT                                                  11054000
CBSCRTCB EQU   AMCBS+28                                                 11055000
CBSCRACA EQU   AMCBS+24                                                 11056000
CBSCAXCN EQU   AMCBS+20                                                 11057000
CBSMCUCB EQU   CBSCMP                                                   11058000
CBSCBP   EQU   AMCBS+12                                                 11059000
CBSACB   EQU   AMCBS+8                                                  11060000
CBSMCSTA EQU   AMCBS+4                                                  11061000
CBSSIZ   EQU   AMCBS+2                                                  11062000
CBSID    EQU   AMCBS                                                    11063000
CVTLEVL  EQU   CVTRELNO+2                                               11064000
CVTNUMB  EQU   CVTRELNO                                                 11065000
CVTMDL   EQU   CVTFIX+250                                               11066000
@NM00196 EQU   CVTFIX+248                                               11067000
@NM00195 EQU   CVTFIX                                                   11068000
CVTRV482 EQU   CVTXTNT2+128                                             11069000
CVTRV481 EQU   CVTXTNT2+124                                             11070000
CVTRV480 EQU   CVTXTNT2+120                                             11071000
CVTRV479 EQU   CVTXTNT2+118                                             11072000
CVTRV478 EQU   CVTXTNT2+117                                             11073000
CVTRV477 EQU   CVTXTNT2+116                                             11074000
CVTRV476 EQU   CVTXTNT2+115                                             11075000
CVTRV475 EQU   CVTXTNT2+114                                             11076000
CVTRV474 EQU   CVTRV466                                                 11077000
CVTRV473 EQU   CVTRV466                                                 11078000
CVTRV472 EQU   CVTRV466                                                 11079000
CVTRV471 EQU   CVTRV466                                                 11080000
CVTRV470 EQU   CVTRV466                                                 11081000
CVTRV469 EQU   CVTRV466                                                 11082000
CVTRV468 EQU   CVTRV466                                                 11083000
CVTRV467 EQU   CVTRV466                                                 11084000
CVTRV465 EQU   CVTRV457                                                 11085000
CVTRV464 EQU   CVTRV457                                                 11086000
CVTRV463 EQU   CVTRV457                                                 11087000
CVTRV462 EQU   CVTRV457                                                 11088000
CVTRV461 EQU   CVTRV457                                                 11089000
CVTRV460 EQU   CVTRV457                                                 11090000
CVTRV459 EQU   CVTRV457                                                 11091000
CVTRV458 EQU   CVTRV457                                                 11092000
CVTRV456 EQU   CVTXTNT2+108                                             11093000
CVTRV455 EQU   CVTXTNT2+104                                             11094000
CVTRV454 EQU   CVTXTNT2+100                                             11095000
CVTRV453 EQU   CVTXTNT2+96                                              11096000
CVTRV452 EQU   CVTXTNT2+94                                              11097000
CVTRV451 EQU   CVTXTNT2+92                                              11098000
CVTRV450 EQU   CVTXTNT2+90                                              11099000
CVTRV449 EQU   CVTXTNT2+88                                              11100000
CVTRV448 EQU   CVTXTNT2+87                                              11101000
CVTRV447 EQU   CVTXTNT2+86                                              11102000
CVTRV446 EQU   CVTRV438                                                 11103000
CVTRV445 EQU   CVTRV438                                                 11104000
CVTRV444 EQU   CVTRV438                                                 11105000
CVTRV443 EQU   CVTRV438                                                 11106000
CVTRV442 EQU   CVTRV438                                                 11107000
CVTRV441 EQU   CVTRV438                                                 11108000
CVTRV440 EQU   CVTRV438                                                 11109000
CVTRV439 EQU   CVTRV438                                                 11110000
CVTRV437 EQU   CVTRV429                                                 11111000
CVTRV436 EQU   CVTRV429                                                 11112000
CVTRV435 EQU   CVTRV429                                                 11113000
CVTRV434 EQU   CVTRV429                                                 11114000
CVTRV433 EQU   CVTRV429                                                 11115000
CVTRV432 EQU   CVTRV429                                                 11116000
CVTRV431 EQU   CVTRV429                                                 11117000
CVTRV430 EQU   CVTRV429                                                 11118000
CVTRV428 EQU   CVTXTNT2+80                                              11119000
CVTRV427 EQU   CVTXTNT2+76                                              11120000
CVTRV426 EQU   CVTXTNT2+72                                              11121000
CVTRV425 EQU   CVTXTNT2+68                                              11122000
CVTATACT EQU   CVTATCVT                                                 11123000
CVTRV423 EQU   CVTXTNT2+62                                              11124000
CVTRV422 EQU   CVTXTNT2+60                                              11125000
CVTRV421 EQU   CVTXTNT2+58                                              11126000
CVTRV420 EQU   CVTXTNT2+56                                              11127000
CVTRV419 EQU   CVTXTNT2+55                                              11128000
CVTRV418 EQU   CVTXTNT2+54                                              11129000
CVTRV417 EQU   CVTRV409                                                 11130000
CVTRV416 EQU   CVTRV409                                                 11131000
CVTRV415 EQU   CVTRV409                                                 11132000
CVTRV414 EQU   CVTRV409                                                 11133000
CVTRV413 EQU   CVTRV409                                                 11134000
CVTRV412 EQU   CVTRV409                                                 11135000
CVTRV411 EQU   CVTRV409                                                 11136000
CVTRV410 EQU   CVTRV409                                                 11137000
CVTRV408 EQU   CVTRV400                                                 11138000
CVTRV407 EQU   CVTRV400                                                 11139000
CVTRV406 EQU   CVTRV400                                                 11140000
CVTRV405 EQU   CVTRV400                                                 11141000
CVTRV404 EQU   CVTRV400                                                 11142000
CVTRV403 EQU   CVTRV400                                                 11143000
CVTRV402 EQU   CVTRV400                                                 11144000
CVTRV401 EQU   CVTRV400                                                 11145000
CVTICB   EQU   CVTXTNT2+48                                              11146000
CVTSKTA  EQU   CVTXTNT2+44                                              11147000
CVTRSV99 EQU   CVTXTNT2+40                                              11148000
CVTRSV98 EQU   CVTXTNT2+36                                              11149000
CVTRSV97 EQU   CVTXTNT2+34                                              11150000
CVTRSV96 EQU   CVTXTNT2+32                                              11151000
CVTOLTEP EQU   CVTXTNT2+28                                              11152000
CVTQIDA  EQU   CVTQID+1                                                 11153000
CVTRSV95 EQU   CVTQID                                                   11154000
CVTRSV94 EQU   CVTXTNT2+20                                              11155000
CVTRSV93 EQU   CVTXTNT2+16                                              11156000
CVTRSV92 EQU   CVTXTNT2+12                                              11157000
CVTDEBVR EQU   CVTXTNT2+8                                               11158000
CVTRSV91 EQU   CVTXTNT2+6                                               11159000
CVTRSV9H EQU   CVTFLGBT                                                 11160000
CVTRSV9G EQU   CVTFLGBT                                                 11161000
CVTRSV9F EQU   CVTFLGBT                                                 11162000
CVTRSV9E EQU   CVTFLGBT                                                 11163000
CVTRSV9D EQU   CVTFLGBT                                                 11164000
CVTRSV9C EQU   CVTFLGBT                                                 11165000
CVTVME   EQU   CVTFLGBT                                                 11166000
CVTNPE   EQU   CVTFLGBT                                                 11167000
CVTNUCLS EQU   CVTXTNT2+4                                               11168000
CVTDSSVA EQU   CVTDSSV+1                                                11169000
CVTRSV89 EQU   CVTDSSV                                                  11170000
CVTRSV88 EQU   CVTXTNT1+8                                               11171000
CVTRSV87 EQU   CVTXTNT1+4                                               11172000
CVTFACHN EQU   CVTXTNT1                                                 11173000
CVTRV488 EQU   CVTMAP+412                                               11174000
CVTRV487 EQU   CVTMAP+408                                               11175000
CVTRV486 EQU   CVTMAP+404                                               11176000
CVTRV485 EQU   CVTMAP+400                                               11177000
CVTACTAP EQU   CVTMAP+396                                               11178000
CVTAUTH  EQU   CVTMAP+392                                               11179000
CVTATMCA EQU   CVTATMCT+1                                               11180000
CVTATMST EQU   CVTATMCT                                                 11181000
CVTRSV61 EQU   CVTMAP+384                                               11182000
CVTVOLT1 EQU   CVTVOLM1+1                                               11183000
CVTVOLI1 EQU   CVTVOLF1                                                 11184000
CVTSTOA  EQU   CVTMAP+376                                               11185000
CVTRSV58 EQU   CVTMAP+374                                               11186000
CVTRSV57 EQU   CVTMAP+372                                               11187000
CVTDDCE  EQU   CVTMAP+368                                               11188000
CVTPNWFR EQU   CVTMAP+364                                               11189000
CVTSMF   EQU   CVTMAP+360                                               11190000
CVTSULK  EQU   CVTMAP+358                                               11191000
CVTSLKO  EQU   CVTSYSK                                                  11192000
CVTSLKP  EQU   CVTSYSK                                                  11193000
CVTSLKQ  EQU   CVTSYSK                                                  11194000
CVTSLKR  EQU   CVTSYSK                                                  11195000
CVTRSV56 EQU   CVTSYSK                                                  11196000
CVTRSV55 EQU   CVTSYSK                                                  11197000
CVTRSV54 EQU   CVTSYSK                                                  11198000
CVTRSV53 EQU   CVTSYSK                                                  11199000
CVTRSV52 EQU   CVTA1F1                                                  11200000
CVTRSV51 EQU   CVTA1F1                                                  11201000
CVTRSV50 EQU   CVTA1F1                                                  11202000
CVTRSV49 EQU   CVTA1F1                                                  11203000
CVTRSV48 EQU   CVTA1F1                                                  11204000
CVTRSV47 EQU   CVTA1F1                                                  11205000
CVTSRSW  EQU   CVTA1F1                                                  11206000
CVTPFSW  EQU   CVTA1F1                                                  11207000
CVTPCVT  EQU   CVTMAP+352                                               11208000
CVTRSV46 EQU   CVTMAP+344                                               11209000
CVTRSV45 EQU   CVTMAP+340                                               11210000
CVTRSV44 EQU   CVTMAP+338                                               11211000
CVTRSV43 EQU   CVTMAP+336                                               11212000
CVTHJESA EQU   CVTHJES+1                                                11213000
CVTRSV42 EQU   CVTHJES                                                  11214000
CVTEXT2A EQU   CVTEXT2+1                                                11215000
CVTRSV41 EQU   CVTEXT2                                                  11216000
CVTAPFA  EQU   CVTAPF+1                                                 11217000
CVTRSV40 EQU   CVTAPF                                                   11218000
CVTRV518 EQU   CVTINTLA                                                 11219000
CVTRV517 EQU   CVTERPV                                                  11220000
CVTEORM  EQU   CVTMAP+312                                               11221000
CVTMCHPR EQU   CVTMAP+308                                               11222000
CVTTZ    EQU   CVTMAP+304                                               11223000
CVTJEPS  EQU   CVTMAP+300                                               11224000
CVTJESCT EQU   CVTMAP+296                                               11225000
CVTMODE  EQU   CVTMAP+292                                               11226000
CVTPTRV  EQU   CVTMAP+288                                               11227000
CVTREAL  EQU   CVTMAP+284                                               11228000
CVTRSV39 EQU   CVTMAP+280                                               11229000
CVTRSV38 EQU   CVTMAP+276                                               11230000
CVTDMSRA EQU   CVTDMSR+1                                                11231000
CVTRV634 EQU   CVTDMSRF                                                 11232000
CVTRV633 EQU   CVTDMSRF                                                 11233000
CVTRV632 EQU   CVTDMSRF                                                 11234000
CVTRV631 EQU   CVTDMSRF                                                 11235000
CVTRV630 EQU   CVTDMSRF                                                 11236000
CVTRV629 EQU   CVTDMSRF                                                 11237000
CVTUDUMP EQU   CVTDMSRF                                                 11238000
CVTSDUMP EQU   CVTDMSRF                                                 11239000
CVTQMSGA EQU   CVTQMSG+1                                                11240000
CVTRSV36 EQU   CVTQMSG                                                  11241000
CVTAMFF  EQU   CVTMAP+264                                               11242000
CVTPURGA EQU   CVTPURG+1                                                11243000
CVTRSV35 EQU   CVTPURG                                                  11244000
CVTCBSP  EQU   CVTMAP+256                                               11245000
CVTATERA EQU   CVTATER+1                                                11246000
CVTSYST  EQU   CVTATER                                                  11247000
CVTVOLT2 EQU   CVTTAT                                                   11248000
CVTVOLI2 EQU   CVTVOLF2                                                 11249000
CVTAQAVB EQU   CVTAQAVT+1                                               11250000
CVTRSV34 EQU   CVTTCMFG                                                 11251000
CVTRSV33 EQU   CVTTCMFG                                                 11252000
CVTRSV32 EQU   CVTTCMFG                                                 11253000
CVTRSV31 EQU   CVTTCMFG                                                 11254000
CVTRSV30 EQU   CVTTCMFG                                                 11255000
CVTRSV29 EQU   CVTTCMFG                                                 11256000
CVTRSV28 EQU   CVTTCMFG                                                 11257000
CVTTCRDY EQU   CVTTCMFG                                                 11258000
CVTGTFA  EQU   CVTGTF+1                                                 11259000
CVTRSV27 EQU   CVTGTFST                                                 11260000
CVTRNIO  EQU   CVTGTFST                                                 11261000
CVTUSR   EQU   CVTGTFST                                                 11262000
CVTRV318 EQU   CVTFORM                                                  11263000
CVTRV317 EQU   CVTTMODE                                                 11264000
CVTRV316 EQU   CVTSTATE                                                 11265000
CVTRV315 EQU   CVTGTFS                                                  11266000
CVTGTFAV EQU   CVTGTFS                                                  11267000
CVT0SCR1 EQU   CVTMAP+232                                               11268000
CVTRV515 EQU   CVTMAP+228                                               11269000
CVTRMS   EQU   CVTMAP+224                                               11270000
CVTPATCH EQU   CVTMAP+220                                               11271000
CVTTSCE  EQU   CVTMAP+216                                               11272000
CVTLNKSC EQU   CVTMAP+214                                               11273000
CVTQABST EQU   CVTMAP+212                                               11274000
CVTMDLDS EQU   CVTMAP+208                                               11275000
CVTUSER  EQU   CVTMAP+204                                               11276000
CVTABEND EQU   CVTMAP+200                                               11277000
CVTSMCA  EQU   CVTMAP+196                                               11278000
CVTRSV18 EQU   CVTMAP+192                                               11279000
CVTQLPAQ EQU   CVTMAP+188                                               11280000
CVTQCDSR EQU   CVTMAP+184                                               11281000
CVTRSV17 EQU   CVTOPTB                                                  11282000
CVTRSV16 EQU   CVTOPTB                                                  11283000
CVTFP    EQU   CVTOPTB                                                  11284000
CVTAPTHR EQU   CVTOPTB                                                  11285000
CVTNLOG  EQU   CVTOPTB                                                  11286000
CVTTOD   EQU   CVTOPTB                                                  11287000
CVTCTIMS EQU   CVTOPTB                                                  11288000
CVTPROT  EQU   CVTOPTB                                                  11289000
CVTXPFP  EQU   CVTOPTA                                                  11290000
CVTASCII EQU   CVTOPTA                                                  11291000
CVTRSV13 EQU   CVTOPTA                                                  11292000
CVTRSV12 EQU   CVTOPTA                                                  11293000
CVTNIP   EQU   CVTOPTA                                                  11294000
CVTDDR   EQU   CVTOPTA                                                  11295000
CVTAPR   EQU   CVTOPTA                                                  11296000
CVTCCH   EQU   CVTOPTA                                                  11297000
CVTSNCTR EQU   CVTMAP+180                                               11298000
CVTQMWR  EQU   CVTMAP+176                                               11299000
CVTQOCR  EQU   CVTMAP+172                                               11300000
CVT1EF00 EQU   CVTMAP+168                                               11301000
CVTMZ00  EQU   CVTMAP+164                                               11302000
CVTHEAD  EQU   CVTMAP+160                                               11303000
CVTRSV11 EQU   CVTMAP+156                                               11304000
CVT0PT01 EQU   CVTMAP+152                                               11305000
CVTMSER  EQU   CVTMAP+148                                               11306000
CVTRV516 EQU   CVTIERLC                                                 11307000
CVTILCH  EQU   CVTMAP+140                                               11308000
CVT0DS   EQU   CVTMAP+136                                               11309000
CVTFBOSV EQU   CVTMAP+132                                               11310000
CVTNUCB  EQU   CVTMAP+128                                               11311000
CVTIXAVL EQU   CVTMAP+124                                               11312000
CVTIOQET EQU   CVTMAP+120                                               11313000
CVTDCBA  EQU   CVTMAP+117                                               11314000
CVTMVS2  EQU   CVTDCB                                                   11315000
CVT6DAT  EQU   CVTDCB                                                   11316000
CVT4MPS  EQU   CVTDCB                                                   11317000
CVTRSV09 EQU   CVTDCB                                                   11318000
CVT4MS1  EQU   CVTDCB                                                   11319000
CVT2SPS  EQU   CVTDCB                                                   11320000
CVT1SSS  EQU   CVTDCB                                                   11321000
CVTRSV08 EQU   CVTDCB                                                   11322000
CVTSTB   EQU   CVTMAP+112                                               11323000
CVTQTD00 EQU   CVTMAP+108                                               11324000
CVTQTE00 EQU   CVTMAP+104                                               11325000
CVTCUCB  EQU   CVTMAP+100                                               11326000
CVTSJQ   EQU   CVTMAP+96                                                11327000
CVTPBLDL EQU   CVTMAP+92                                                11328000
CVTTPC   EQU   CVTMAP+88                                                11329000
CVTSVDCB EQU   CVTMAP+84                                                11330000
CVTBRET  EQU   CVTMAP+82                                                11331000
CVTEXIT  EQU   CVTMAP+80                                                11332000
CVT0FN00 EQU   CVTMAP+76                                                11333000
CVTDARA  EQU   CVTDAR+1                                                 11334000
CVTRSV07 EQU   CVTFLGS1                                                 11335000
CVTRSV06 EQU   CVTFLGS1                                                 11336000
CVTRSV05 EQU   CVTFLGS1                                                 11337000
CVTRSV04 EQU   CVTFLGS1                                                 11338000
CVTRSV03 EQU   CVTFLGS1                                                 11339000
CVTRSV02 EQU   CVTFLGS1                                                 11340000
CVTRSV01 EQU   CVTFLGS1                                                 11341000
CVTDMPLK EQU   CVTFLGS1                                                 11342000
CVTXITP  EQU   CVTMAP+68                                                11343000
CVTZDTAB EQU   CVTMAP+64                                                11344000
CVTMSLT  EQU   CVTMAP+60                                                11345000
CVTDATE  EQU   CVTMAP+56                                                11346000
CVTBTERM EQU   CVTMAP+52                                                11347000
CVTSYSAD EQU   CVTMAP+48                                                11348000
CVTXTLER EQU   CVTMAP+44                                                11349000
CVTILK2  EQU   CVTMAP+40                                                11350000
CVTILK1  EQU   CVTMAP+36                                                11351000
CVTPRLTV EQU   CVTMAP+32                                                11352000
CVTPCNVT EQU   CVTMAP+28                                                11353000
CVT0VL00 EQU   CVTMAP+24                                                11354000
CVTXAPG  EQU   CVTMAP+20                                                11355000
CVTBUF   EQU   CVTMAP+16                                                11356000
CVTJOB   EQU   CVTMAP+12                                                11357000
CVTLINK  EQU   CVTMAP+8                                                 11358000
CVT0EF00 EQU   CVTMAP+4                                                 11359000
CVTTCBP  EQU   CVTMAP                                                   11360000
CVT      EQU   CVTMAP                                                   11361000
CTGFVWKA EQU   CTGFV+88                                                 11362000
CTGFVPWD EQU   CTGFV+84                                                 11363000
CTGFVNAM EQU   CTGFV+80                                                 11364000
CTGFVUPG EQU   CTGFVGAT                                                 11365000
CTGFVEXT EQU   CTGFVLMT                                                 11366000
CTGFVLRS EQU   CTGFV+68                                                 11367000
CTGFVBUF EQU   CTGFV+64                                                 11368000
CTGFVATR EQU   CTGFV+60                                                 11369000
CTGFVFSN EQU   CTGFVAMD                                                 11370000
CTGFVTTR EQU   CTGFVSPC                                                 11371000
CTGFVDVT EQU   CTGFV+48                                                 11372000
CTGFVRNG EQU   CTGFV+44                                                 11373000
CTGFVVLT EQU   CTGFV+40                                                 11374000
CTGFVCRE EQU   CTGFV+36                                                 11375000
CTGFVEXP EQU   CTGFV+32                                                 11376000
CTGFVOWN EQU   CTGFV+28                                                 11377000
CTGFVSTY EQU   CTGFV+24                                                 11378000
CTGFVENT EQU   CTGFV+20                                                 11379000
CTGFVIND EQU   CTGFV+16                                                 11380000
CTGFVVCH EQU   CTGFV+12                                                 11381000
CTGFVICH EQU   CTGFV+8                                                  11382000
CTGFVDCH EQU   CTGFV+4                                                  11383000
@NM00194 EQU   CTGFV+3                                                  11384000
CTGFVELM EQU   CTGFV+2                                                  11385000
@NM00193 EQU   CTGFVPRO                                                 11386000
CTGFVDRC EQU   CTGFVPRO                                                 11387000
CTGFVNDC EQU   CTGFVPRO                                                 11388000
CTGFVRVL EQU   CTGFVPRO                                                 11389000
CTGFVAVL EQU   CTGFVPRO                                                 11390000
CTGFVTYP EQU   CTGFV                                                    11391000
CTGFLPT  EQU   CTGFLDAT+4                                               11392000
CTGFLNG  EQU   CTGFLDAT                                                 11393000
CTGFLCHN EQU   CTGFL+12                                                 11394000
CTGFLDNM EQU   CTGFL+8                                                  11395000
CTGFLDWA EQU   CTGFL+4                                                  11396000
CTGFLDTS EQU   CTGFLDRE                                                 11397000
@NM00192 EQU   CTGFLDRE                                                 11398000
CTGFLDGC EQU   CTGFL+2                                                  11399000
CTGFLDCD EQU   CTGFL+1                                                  11400000
CTGFLDNO EQU   CTGFL                                                    11401000
CTGFIELD EQU   CTGPL+28                                                 11402000
CTGPSWD  EQU   CTGJSCB                                                  11403000
@NM00190 EQU   CTGFBFLG                                                 11404000
CTGNGDSN EQU   CTGFBFLG                                                 11405000
CTGGDGB  EQU   CTGFBFLG                                                 11406000
CTGKEEP  EQU   CTGFBFLG                                                 11407000
CTGPAR   EQU   CTGFBFLG                                                 11408000
CTGFDBK  EQU   CTGNEWNM                                                 11409000
CTGNOFLD EQU   CTGPL+19                                                 11410000
CTGTYPE  EQU   CTGPL+18                                                 11411000
@NM00189 EQU   CTGDSORG                                                 11412000
CTGOPTNS EQU   CTGDSORG                                                 11413000
CTGWKA   EQU   CTGPL+12                                                 11414000
CTGCVOL  EQU   CTGCAT                                                   11415000
@NM00188 EQU   CTGOPTN4                                                 11416000
CTGBYPMT EQU   CTGOPTN4                                                 11417000
@NM00187 EQU   CTGOPTN4                                                 11418000
CTGNPROF EQU   CTGOPTN4                                                 11419000
CTGDOCAT EQU   CTGOPTN4                                                 11420000
CTGLBASE EQU   CTGOPTN4                                                 11421000
CTGAM0   EQU   CTGOPTN3                                                 11422000
CTGNUM   EQU   CTGOPTN3                                                 11423000
CTGSRH   EQU   CTGOPTN3                                                 11424000
CTGGDGL  EQU   CTGOPTN3                                                 11425000
CTGSUPLT EQU   CTGOPTN3                                                 11426000
CTGFUNC  EQU   CTGOPTN3                                                 11427000
@NM00186 EQU   CTGOPTN2                                                 11428000
CTGSCR   EQU   CTGOPTN2                                                 11429000
CTGOVRID EQU   CTGOPTN2                                                 11430000
CTGDISC  EQU   CTGOPTN2                                                 11431000
CTGUCRAX EQU   CTGGTNXT                                                 11432000
CTGSWAP  EQU   CTGRCATN                                                 11433000
CTGGTALL EQU   CTGREL                                                   11434000
CTGNSVS  EQU   CTGEXT                                                   11435000
CTGGENLD EQU   CTGOPTN1                                                 11436000
CTGCNAME EQU   CTGOPTN1                                                 11437000
CTGNAME  EQU   CTGOPTN1                                                 11438000
CTGREAD  EQU   CTGOPTN1                                                 11439000
CTGUPD   EQU   CTGOPTN1                                                 11440000
CTGCI    EQU   CTGOPTN1                                                 11441000
CTGMAST  EQU   CTGOPTN1                                                 11442000
CTGBYPSS EQU   CTGOPTN1                                                 11443000
GDGLVL   EQU   GENLVLS+2                                                11444000
@NM00185 EQU   GENLVLS                                                  11445000
@NM00184 EQU   GDGRCD+108                                               11446000
GDGLIMIT EQU   GDGRCD+107                                               11447000
@NM00183 EQU   GDGRCD                                                   11448000
@NM00182 EQU   VOLGO+34                                                 11449000
NOBLKTRK EQU   VOLGO+32                                                 11450000
@NM00181 EQU   VOLGO                                                    11451000
@NM00176 EQU   RGATTSG1                                                 11452000
RGATSUP1 EQU   RGATTSG1                                                 11453000
@NM00175 EQU   RGATTR1                                                  11454000
RGATTUPG EQU   RGATTR1                                                  11455000
SPCROUND EQU   SPCOPTNS                                                 11456000
SPCALXRQ EQU   SPCOPTNS                                                 11457000
SPCMXIGR EQU   SPCOPTNS                                                 11458000
SPCCNTIG EQU   SPCOPTNS                                                 11459000
@NM00174 EQU   SPCOPTNS                                                 11460000
SPCRQTYP EQU   SPCOPTNS                                                 11461000
SPCSECDQ EQU   SPACEPRM+3                                               11462000
SPCPRIMQ EQU   SPACEPRM                                                 11463000
DSSUMTT  EQU   DSDIR+9                                                  11464000
DSCRETS  EQU   DSDIR+5                                                  11465000
DSIDNO   EQU   DSDIR+2                                                  11466000
@NM00173 EQU   DSDIR                                                    11467000
@NM00172 EQU   ASGOGDG+2                                                11468000
@NM00171 EQU   ASGOGDG                                                  11469000
@NM00170 EQU   ASGO                                                     11470000
CCRRBAS  EQU   CCR+57                                                   11471000
CCRFDCI  EQU   CCR+54                                                   11472000
CCRCDCI  EQU   CCR+51                                                   11473000
CCRNFCI  EQU   CCR+48                                                   11474000
CCRHACI  EQU   CCR+45                                                   11475000
CCRID    EQU   CCR+44                                                   11476000
CCRKEY   EQU   CCR                                                      11477000
CEXT     EQU   CTGRBASE+135                                             11478000
CDOSUINF EQU   CTGRBASE+133                                             11479000
CLRECL   EQU   CTGRBASE+129                                             11480000
CHIA     EQU   CTGRBASE+125                                             11481000
CHIU     EQU   CTGRBASE+121                                             11482000
CSORT    EQU   CSPACPRM+6                                               11483000
CSEC     EQU   CSPACPRM+3                                               11484000
CPRIM    EQU   CSPACPRM                                                 11485000
CBUF     EQU   CTGRBASE+110                                             11486000
@NM00164 EQU   COPEN                                                    11487000
COPENDS  EQU   COPEN                                                    11488000
CNUS     EQU   CATTR2                                                   11489000
@NM00163 EQU   CATTR2                                                   11490000
CATTRSSH EQU   CATTR2                                                   11491000
CATTRISH EQU   CATTR2                                                   11492000
CTRKOV   EQU   CATTR1                                                   11493000
CTEMP    EQU   CATTR1                                                   11494000
CINHIB   EQU   CATTR1                                                   11495000
CRECOV   EQU   CATTR1                                                   11496000
CERASE   EQU   CATTR1                                                   11497000
CREUSE   EQU   CATTR1                                                   11498000
CUNIQ    EQU   CATTR1                                                   11499000
CSP      EQU   CATTR1                                                   11500000
CEXP     EQU   CTGRBASE+104                                             11501000
CCRE     EQU   CTGRBASE+101                                             11502000
COWNID   EQU   CTGRBASE+93                                              11503000
@NM00162 EQU   CTGRBASE                                                 11504000
CNTVAR   EQU   CNTRLINF                                                 11505000
VARINFO  EQU   VARFIELD+2                                               11506000
@NM00161 EQU   EXTRCDPT+3                                               11507000
NREPLF   EQU   CATRCD+48                                                11508000
NREPCV   EQU   CATRCD+47                                                11509000
RCDSIZ   EQU   CATRCD+45                                                11510000
@NM00160 EQU   CATRCD+26                                                11511000
RCDDICTS EQU   CATRCD+22                                                11512000
RCDRACTS EQU   CATRCD+18                                                11513000
RCDCRADT EQU   CATRCD+14                                                11514000
RCDCRACI EQU   CATRCD+11                                                11515000
RCDRELID EQU   CATRCD+4                                                 11516000
RCDKEYTY EQU   CATRCD                                                   11517000
CATGOGC  EQU   CATGOGC1                                                 11518000
@NM00159 EQU   CATGOFLG                                                 11519000
SNNN     EQU   SNTTNN+2                                                 11520000
SNTT     EQU   SNTTNN                                                   11521000
SDSSUMTT EQU   SNDSDIR+32                                               11522000
SDSCRETS EQU   SNDSDIR+28                                               11523000
SDSIDNO  EQU   SNDSDIR+25                                               11524000
@NM00158 EQU   SDSIDFLG                                                 11525000
SDSEXT   EQU   SDSIDFLG                                                 11526000
@NM00157 EQU   SNDSDIR                                                  11527000
SNLBM    EQU   SNVSBM+28                                                11528000
SNABM    EQU   SNVSBM+24                                                11529000
@NM00156 EQU   SNVSBM                                                   11530000
@NM00155 EQU   SNEXTENT+16                                              11531000
@NM00154 EQU   SNEXTENT+12                                              11532000
NTR      EQU   SNEXTENT+10                                              11533000
@NM00153 EQU   SNEXTENT+8                                               11534000
@NM00152 EQU   SNEXTENT+6                                               11535000
SHH      EQU   SNEXTENT+4                                               11536000
SCC      EQU   SNEXTENT+2                                               11537000
SS       EQU   SNEXTENT                                                 11538000
SNEXTI   EQU   SNVGO+42                                                 11539000
SNTTNNMC EQU   SNVGO+41                                                 11540000
SNTTNNC  EQU   SNVGO+40                                                 11541000
SNTTNNX  EQU   SNVGO+39                                                 11542000
SNVGOSS  EQU   SNVGO+37                                                 11543000
SNDEVTYP EQU   SNVGO+24                                                 11544000
@NM00151 EQU   SNVGO                                                    11545000
SNNAME2  EQU   SNGLEV+1                                                 11546000
SNTYPE2  EQU   SNGLEV                                                   11547000
@NM00150 EQU   SNASSOC                                                  11548000
SSPEXTNN EQU   SSPEXTNT                                                 11549000
SNODSPXT EQU   SNVDATA+9                                                11550000
SNVSPCAT EQU   SSPHDFLG                                                 11551000
@NM00149 EQU   SSPHDFLG                                                 11552000
SNVSPUNQ EQU   SSPHDFLG                                                 11553000
SDSCBTS  EQU   SNVDATA                                                  11554000
SNVGOEL  EQU   SNFIXED+20                                               11555000
SNEGOP   EQU   SNFIXED+16                                               11556000
SNECI    EQU   SNFIXED+13                                               11557000
SNAGOP   EQU   SNFIXED+11                                               11558000
SNACI    EQU   SNFIXED+8                                                11559000
SNGOP    EQU   SNFIXED+6                                                11560000
SNCI     EQU   SNFIXED+3                                                11561000
@NM00148 EQU   SNFLAG                                                   11562000
SNFINC   EQU   SNFLAG                                                   11563000
SNFMOD   EQU   SNFLAG                                                   11564000
SNFALT   EQU   SNFLAG                                                   11565000
SNFUSE   EQU   SNFLAG                                                   11566000
RSFCILST EQU   RSFSNVT+28                                               11567000
RSFABMAP EQU   RSFSNVT+20                                               11568000
RSFLENBM EQU   RSFSNVT+14                                               11569000
RSFCNTTN EQU   RSFSNVT+12                                               11570000
RSFGCODE EQU   RSFSNVT+2                                                11571000
@NM00147 EQU   RSFLAGS                                                  11572000
RSFINVTY EQU   RSFLAGS                                                  11573000
RSFNRF   EQU   RSFLAGS                                                  11574000
@NM00146 EQU   RSFSNVT                                                  11575000
GDGLVLT  EQU   GDGENT                                                   11576000
@NM00145 EQU   GDGFLG                                                   11577000
GDGWRAP  EQU   GDGFLG                                                   11578000
GDGPAK   EQU   GDGLHEAD+22                                              11579000
GDGMVL   EQU   GDGLHEAD+20                                              11580000
GDGFRE   EQU   GDGLHEAD+18                                              11581000
GDGFRS   EQU   GDGLHEAD+16                                              11582000
GDGTOE   EQU   GDGLHEAD+14                                              11583000
GDGTOS   EQU   GDGLHEAD+12                                              11584000
GDGPLEV  EQU   GDGLHEAD+10                                              11585000
GDGVALB  EQU   GDGLHEAD+8                                               11586000
GDGCNT   EQU   GDGLHEAD+6                                               11587000
GDGLMT   EQU   GDGLHEAD+4                                               11588000
GDGVAL   EQU   GDGLHEAD                                                 11589000
@NM00144 EQU   @NM00143                                                 11590000
@NM00142 EQU   @NM00140+2                                               11591000
@NM00141 EQU   DITVSN                                                   11592000
@NM00139 EQU   DITFLB                                                   11593000
@NM00138 EQU   DITFLB                                                   11594000
@NM00137 EQU   DITFA                                                    11595000
@NM00136 EQU   DITFA                                                    11596000
@NM00135 EQU   DITFA                                                    11597000
@NM00134 EQU   DITFA                                                    11598000
@NM00133 EQU   DITFA                                                    11599000
GDIENTRY EQU   GDITS+12                                                 11600000
GDITHEAD EQU   GDITS                                                    11601000
@NM00132 EQU   @NM00131                                                 11602000
@NM00130 EQU   @NM00129                                                 11603000
@NM00126 EQU   CITFLA                                                   11604000
CITABENT EQU   GCITS+12                                                 11605000
GCITHEAD EQU   GCITS                                                    11606000
PTASCIT1 EQU   PTASOE+4                                                 11607000
@NM00125 EQU   PTLDITFB                                                 11608000
@NM00124 EQU   PTLDITFB                                                 11609000
PTLFBGOE EQU   PTLDITFB                                                 11610000
PTLFBHEP EQU   PTLDITFB                                                 11611000
@NM00123 EQU   @NM00122                                                 11612000
@NM00121 EQU   @NM00120                                                 11613000
@NM00119 EQU   PTF2                                                     11614000
PTF1END  EQU   PTF1                                                     11615000
@NM00118 EQU   PTXFLAGS+1                                               11616000
@NM00117 EQU   PTXFLAG1                                                 11617000
PTXEXIST EQU   PTXFLAG1                                                 11618000
@NM00116 EQU   PTVERDI+26                                               11619000
PTINDX5  EQU   PTINDX+10                                                11620000
PTINDX2  EQU   PTINDX+2                                                 11621000
PTDITWK  EQU   PTGDIT+20                                                11622000
@NM00115 EQU   @NM00114                                                 11623000
@NM00113 EQU   @NM00112                                                 11624000
@NM00111 EQU   @NM00110                                                 11625000
@NM00109 EQU   @NM00108                                                 11626000
@NM00107 EQU   @NM00106                                                 11627000
@NM00105 EQU   @NM00104                                                 11628000
PTHEAD   EQU   PTWORK                                                   11629000
TENTRY   EQU   TABHEAD+12                                               11630000
TABMAXT  EQU   THEAD+8                                                  11631000
TABFORW  EQU   THEAD+4                                                  11632000
TABUG    EQU   TABANCHR+24                                              11633000
TABNU    EQU   @NM00102+1                                               11634000
@NM00103 EQU   @NM00102                                                 11635000
TABEN    EQU   TABANCHR+18                                              11636000
@NM00101 EQU   TABANCHR+16                                              11637000
TABSIZ   EQU   TABANCHR+12                                              11638000
TABL     EQU   TABANCHR+4                                               11639000
TABF     EQU   TABANCHR                                                 11640000
@NM00100 EQU   TASSO+1                                                  11641000
@NM00099 EQU   TASSFL1                                                  11642000
RSCNHH2  EQU   RSCNCCHH+6                                               11643000
RSCNCC2  EQU   RSCNCCHH+4                                               11644000
RSCNHH1  EQU   RSCNCCHH+2                                               11645000
RSCNCC1  EQU   RSCNCCHH                                                 11646000
RECPTRCD EQU   RECIOWA+978                                              11647000
UCATWRET EQU   UCATWA+4                                                 11648000
UCATWRLN EQU   UCATWA+2                                                 11649000
UCATWTLN EQU   UCATWA                                                   11650000
RSSCRLST EQU   RECIOWA+872                                              11651000
UCBAREA  EQU   RECIOWA+861                                              11652000
RSCAMIND EQU   RSCAMINN+1                                               11653000
RSCAMINL EQU   RSCAMINN                                                 11654000
RSCAMAJN EQU   RECIOWA+808                                              11655000
ALLVLSR  EQU   ALLVL+4                                                  11656000
ALLVLLN  EQU   ALLVL+2                                                  11657000
ALLVLC   EQU   ALLVL                                                    11658000
ALLULNM  EQU   ALLUL+4                                                  11659000
ALLULLN  EQU   ALLUL+2                                                  11660000
ALLULC   EQU   ALLUL                                                    11661000
RSVOLENT EQU   RECIOWA+692                                              11662000
RSVUENT  EQU   RECIOWA+664                                              11663000
RSALLAGL EQU   RECIOWA+632                                              11664000
RSOPNAGL EQU   RECIOWA+248                                              11665000
CATHRMB  EQU   RECIOWA+192                                              11666000
CATLRMB  EQU   RECIOWA+180                                              11667000
CRARMB   EQU   RECIOWA+168                                              11668000
WFSRMB   EQU   RECIOWA+156                                              11669000
WFDRMB   EQU   RECIOWA+120                                              11670000
GRABSCR  EQU   RECIOWA+80                                               11671000
GRABSCA  EQU   RECIOWA+40                                               11672000
UIOVLS   EQU   UIOVOL+4                                                 11673000
UIOVLN   EQU   UIOVOL+2                                                 11674000
UIOVID   EQU   UIOVOL                                                   11675000
UIODNM   EQU   UIODSN+4                                                 11676000
UIODLN   EQU   UIODSN+2                                                 11677000
UIODID   EQU   UIODSN                                                   11678000
RSXCIREL EQU   RSXCIENT+12                                              11679000
@NM00098 EQU   RSXCIFL1                                                 11680000
@NM00097 EQU   RSXCIXLT+4                                               11681000
RSXCIID  EQU   RSXCIXLT                                                 11682000
RMBKEYA  EQU   RMB+12                                                   11683000
@NM00096 EQU   RMBFLAGS                                                 11684000
RMBGETU  EQU   RMBFLAGS                                                 11685000
RMBKEQ   EQU   RMBFLAGS                                                 11686000
RMBKEY   EQU   RMBFLAGS                                                 11687000
RMBUPD   EQU   RMBFLAGS                                                 11688000
RMBDIR   EQU   RMBFLAGS                                                 11689000
RMBSEQ   EQU   RMBFLAGS                                                 11690000
RMBARG   EQU   RMBCTL+4                                                 11691000
RMBRPL   EQU   RMBCTL                                                   11692000
@NM00095 EQU   RSRAB+530                                                11693000
RABFLG4  EQU   RABFLGS+3                                                11694000
RABFLG3  EQU   RABFLGS+2                                                11695000
RABFLG2  EQU   RABFLGS+1                                                11696000
RABDUP   EQU   RABFLG1                                                  11697000
RABIOIGN EQU   RABFLG1                                                  11698000
RABKEY   EQU   RABFLG1                                                  11699000
RABRRN   EQU   RABFLG1                                                  11700000
RABADD   EQU   RABFLG1                                                  11701000
RABUPD   EQU   RABFLG1                                                  11702000
RABINUSE EQU   RABFLG1                                                  11703000
GRABRAB6 EQU   GRABRABS+20                                              11704000
GRABRAB4 EQU   GRABRABS+12                                              11705000
GRABRAB3 EQU   GRABRABS+8                                               11706000
GRABRAB2 EQU   GRABRABS+4                                               11707000
GRABRABE EQU   GRAB+8                                                   11708000
GRABSN   EQU   GRAB+3                                                   11709000
GRABSNRF EQU   GRABAFL2                                                 11710000
GRABSDUP EQU   GRABAFL1                                                 11711000
GRABSNRN EQU   GRABAFL1                                                 11712000
GRABSIOT EQU   GRABAFL1                                                 11713000
GRABSIOF EQU   GRABAFL1                                                 11714000
GRABSIOI EQU   GRABAFL1                                                 11715000
GRABSEFN EQU   GRABAFL1                                                 11716000
GRABSNRA EQU   GRABAFL1                                                 11717000
GRABSFXT EQU   GRABAFL1                                                 11718000
GRABFLG1 EQU   GRABFLGS                                                 11719000
@NM00092 EQU   RSCSWA+6                                                 11720000
RSCSFCN  EQU   RSCSWA+4                                                 11721000
RSCSFAE  EQU   RSCSWA                                                   11722000
@NM00091 EQU   RSMARKUN+6                                               11723000
RSMA3FCN EQU   RSMARKUN+4                                               11724000
RSMA3FAE EQU   RSMARKUN                                                 11725000
@NM00090 EQU   RSCDSDW+18                                               11726000
RSCDINDX EQU   RSCDSDW+16                                               11727000
RSCDSUMT EQU   RSCDSDW+12                                               11728000
RSCD8FCN EQU   RSCDSDW+10                                               11729000
RSCD3FCN EQU   RSCDSDW+8                                                11730000
RSCD8FAE EQU   RSCDSDW+4                                                11731000
RSCD3FAE EQU   RSCDSDW                                                  11732000
RSGTMEB  EQU   RSGTIME+11                                               11733000
RSGDELM2 EQU   RSGTIME+9                                                11734000
@NM00089 EQU   RSGTIME+2                                                11735000
RSGDELM1 EQU   RSGTIME                                                  11736000
RSGDAY   EQU   RSGDATE+2                                                11737000
RSGYEAR  EQU   RSGDATE                                                  11738000
RSGFIXID EQU   RSGENAM+8                                                11739000
RSGTMEA  EQU   RSGENAM+1                                                11740000
RSGDELM  EQU   RSGENAM                                                  11741000
RSGUNPK  EQU   RSGENMWA                                                 11742000
RSFCPE7  EQU   RSWFNDWA+52                                              11743000
RSFCPE6  EQU   RSWFNDWA+48                                              11744000
RSFCPE5  EQU   RSWFNDWA+44                                              11745000
RSFCPE4  EQU   RSWFNDWA+40                                              11746000
RSFCPE3  EQU   RSWFNDWA+36                                              11747000
RSFCPE2  EQU   RSWFNDWA+32                                              11748000
RSFCPE1  EQU   RSWFNDWA+28                                              11749000
@NM00088 EQU   RSWFNDWA+26                                              11750000
RSWFBMLN EQU   RSWFNDWA+24                                              11751000
RSWFBMAP EQU   RSWFNDWA+20                                              11752000
RSWFBUF  EQU   RSWFNDWA+16                                              11753000
RSWFCIN  EQU   RSWFNDWA+13                                              11754000
RSWFRCSN EQU   RSWFNDWA+12                                              11755000
@NM00087 EQU   RSWSNFLG                                                 11756000
@NM00086 EQU   RSCNVTCF+1                                               11757000
@NM00085 EQU   RSCNVTF1                                                 11758000
RSCFINN  EQU   RSCNVTF1                                                 11759000
RSNN     EQU   RSTTNN+2                                                 11760000
RSTT     EQU   RSTTNN                                                   11761000
RSCIOCS  EQU   RSCNVTCC                                                 11762000
LISTLN   EQU   RSDF00W+36                                               11763000
SETRC    EQU   RSDF00W+32                                               11764000
LISTPTR  EQU   RSDF00W                                                  11765000
RSVF4TT  EQU   RSVOLWA+142                                              11766000
@NM00084 EQU   RSVOLWA+141                                              11767000
@NM00083 EQU   RSVFLAGS                                                 11768000
RSVWFUPD EQU   RSVFLAGS                                                 11769000
RSVREPOS EQU   RSVFLAGS                                                 11770000
RSVGTEOF EQU   RSVFLAGS                                                 11771000
RSVEXTS  EQU   RSVOLWA+139                                              11772000
RSVF1TTN EQU   RSVF1EXT                                                 11773000
RSVF1CTS EQU   RSVOLWA+67                                               11774000
RSVF1PAD EQU   RSVF1TS+14                                               11775000
RSVF1TS2 EQU   RSVF1TS+7                                                11776000
RSVF1TS1 EQU   RSVF1TS                                                  11777000
RSVSVTTR EQU   RSVOLWA+48                                               11778000
RSVSCRNM EQU   RSVOLWA+4                                                11779000
RSVSCRPT EQU   RSVOLWA                                                  11780000
RSGENDT  EQU   RSGENDTE+1                                               11781000
@NM00082 EQU   RSGENDTE                                                 11782000
RSGENTME EQU   RSGENWRK+4                                               11783000
RSGENTPT EQU   RSGENWRK                                                 11784000
RSCRGRBP EQU   RSCRWA+4                                                 11785000
RSCRENTP EQU   RSCRWA                                                   11786000
@NM00081 EQU   RSADUL+10                                                11787000
RSADSTP  EQU   RSADUL+10                                                11788000
RSADFLGS EQU   RSADUL+9                                                 11789000
RSADULNM EQU   RSADUL+1                                                 11790000
RSADULC  EQU   RSADUL                                                   11791000
RSADVLSR EQU   RSADVL+1                                                 11792000
RSADVLC  EQU   RSADVL                                                   11793000
RSADDDNP EQU   RSADWA+28                                                11794000
RSADULP  EQU   RSADWA+24                                                11795000
RSADVLP  EQU   RSADWA+20                                                11796000
RSADENP  EQU   RSADWA+16                                                11797000
RSADVSRP EQU   RSADWA+12                                                11798000
RSADGRBP EQU   RSADWA+8                                                 11799000
RSADDDN  EQU   RSADWA                                                   11800000
RSWFAMDP EQU   RSWFWA+48                                                11801000
RSWFLR   EQU   RSWFWA+44                                                11802000
RSWFDFAR EQU   RSWFWA+40                                                11803000
RSWFFPLP EQU   RSWFWA+12                                                11804000
RSWFFVTP EQU   RSWFWA+4                                                 11805000
RSWFSVCP EQU   RSWFWA                                                   11806000
@NM00080 EQU   RSRWORK+65                                               11807000
RSRSKPSW EQU   RSRFLGS                                                  11808000
RSRXSW   EQU   RSRFLGS                                                  11809000
RSRXTRY  EQU   RSRFLGS                                                  11810000
RSROKSW  EQU   RSRFLGS                                                  11811000
RSRX     EQU   RSRWORK+63                                               11812000
RSRIXNO  EQU   RSRWORK+62                                               11813000
RSRU     EQU   RSRWORK+61                                               11814000
RSRI     EQU   RSRWORK+60                                               11815000
RSRLG    EQU   RSRWORK+59                                               11816000
RSRLU    EQU   RSRWORK+58                                               11817000
RSRSVFLG EQU   RSRWORK+48                                               11818000
RSMSGCI  EQU   RSRWORK+45                                               11819000
RSMSGRC  EQU   RSRWORK+42                                               11820000
RSRRLN   EQU   RSRWORK+40                                               11821000
RSRRCPY  EQU   RSRWORK+38                                               11822000
RSRWFRN  EQU   RSRWORK+36                                               11823000
RSRCATRN EQU   RSRWORK+34                                               11824000
RSRCRARN EQU   RSRWORK+32                                               11825000
RSRXLFND EQU   RSRWORK+28                                               11826000
RSRXLSV  EQU   RSRWORK+24                                               11827000
RSRRPL   EQU   RSRWORK+20                                               11828000
RSRSVARG EQU   RSRWORK+16                                               11829000
RSRFAD   EQU   RSRWORK+12                                               11830000
RSRDAD   EQU   RSRWORK+8                                                11831000
RSRRC    EQU   RSRWORK+4                                                11832000
RSRGRBPT EQU   RSRWORK                                                  11833000
RSRNULNM EQU   RSRNUL+1                                                 11834000
RSRNULC  EQU   RSRNUL                                                   11835000
RSRNVLSR EQU   RSRNVL+1                                                 11836000
RSRNVLC  EQU   RSRNVL                                                   11837000
RSRNDDNM EQU   RSRNWA+91                                                11838000
RSRNOLDN EQU   RSRNWA+47                                                11839000
RSRNNOF1 EQU   RSRNFLGS                                                 11840000
RSRNVDUP EQU   RSRNFLGS                                                 11841000
RSRNSTP  EQU   RSRNFLGS                                                 11842000
RSRNFAIL EQU   RSRNFLGS                                                 11843000
RSRNRCRS EQU   RSRNFLGS                                                 11844000
RSRNEVC  EQU   RSRNWA+44                                                11845000
RSRNEVP  EQU   RSRNWA+40                                                11846000
RSRNULP  EQU   RSRNWA+36                                                11847000
RSRNVLP  EQU   RSRNWA+32                                                11848000
RSRNVSPT EQU   RSRNWA+28                                                11849000
RSRNDDPT EQU   RSRNWA+24                                                11850000
RSRNVLPT EQU   RSRNWA+20                                                11851000
RSRNGRBP EQU   RSRNWA+16                                                11852000
RSRNPVLS EQU   RSRNPLST+12                                              11853000
RSRNPNDS EQU   RSRNPLST+8                                               11854000
RSRNPODS EQU   RSRNPLST+4                                               11855000
RSRNPFLG EQU   RSRNPLST                                                 11856000
RSSVENT  EQU   RSINWA+55                                                11857000
RSINALL  EQU   RSINFLGS                                                 11858000
@NM00079 EQU   RSINATR1                                                 11859000
RSINRCV  EQU   RSINATR1                                                 11860000
@NM00078 EQU   RSINATR1                                                 11861000
RSINTS   EQU   RSINWA+45                                                11862000
RSINVLSR EQU   RSINWA+39                                                11863000
RSINSVVL EQU   RSINWA+33                                                11864000
RSINDVLV EQU   RSINDVL+1                                                11865000
RSINDVLL EQU   RSINDVL                                                  11866000
RSINDDPT EQU   RSINWA+20                                                11867000
RSINDNPT EQU   RSINWA+16                                                11868000
RSINDVPT EQU   RSINWA+12                                                11869000
RSINCVPT EQU   RSINWA+8                                                 11870000
RSINWACB EQU   RSINWA+4                                                 11871000
RSINUAP  EQU   RSINWA                                                   11872000
RSCISVLK EQU   RSCIWA+44                                                11873000
RSCIEXT  EQU   RSCIWA+24                                                11874000
RSCIDFCI EQU   RSCIWA+20                                                11875000
RSCIRMEN EQU   RSCIWA+16                                                11876000
RSCILCI  EQU   RSCIWA+12                                                11877000
RSCINXCI EQU   RSCIWA+8                                                 11878000
RSCIEXCU EQU   RSCIWA+4                                                 11879000
@NM00077 EQU   RSCKFLAG                                                 11880000
RSCKTSW  EQU   RSCKFLAG                                                 11881000
RSCKIDX3 EQU   RSCKERRW+48                                              11882000
RSCKIDX2 EQU   RSCKERRW+46                                              11883000
RSCKIDX1 EQU   RSCKERRW+44                                              11884000
RSCATRC  EQU   RSCKERRW+42                                              11885000
RSOURCC  EQU   RSCKERRW+40                                              11886000
RSCKMDTB EQU   RSCKTIME+20                                              11887000
RSCKMDY  EQU   RSCKTIME+14                                              11888000
RSCKHMS  EQU   RSCKTIME+8                                               11889000
RSCKPDAY EQU   RSCKTIME+4                                               11890000
RSCKDAYS EQU   RSCKTIME                                                 11891000
RSCKTPTR EQU   RSCKERRW+4                                               11892000
RSCKERNO EQU   RSCKERR+2                                                11893000
@NM00076 EQU   RSREASW                                                  11894000
REASSW2  EQU   RSREASW                                                  11895000
REASSW1  EQU   RSREASW                                                  11896000
@NM00075 EQU   @NM00074+3                                               11897000
RSVIAGRB EQU   @NM00074                                                 11898000
@NM00073 EQU   RSVIAFLG                                                 11899000
RSVIARRN EQU   RSVIAFLG                                                 11900000
RSVIAUPD EQU   RSVIAFLG                                                 11901000
RSVIAIS  EQU   RSVIAFLG                                                 11902000
RSVIAFND EQU   RSVIAFLG                                                 11903000
RSVIADUP EQU   RSVIAFLG                                                 11904000
@NM00071 EQU   RSGETVIA+8                                               11905000
RSVIAIDX EQU   RSGETVIA+6                                               11906000
@NM00070 EQU   RSVIACRA+4                                               11907000
RSVIADSC EQU   RSVIACRA                                                 11908000
@NM00069 EQU   @NM00067+3                                               11909000
RSEOVERR EQU   @NM00067+2                                               11910000
@NM00068 EQU   RSEOVFLG                                                 11911000
RSEOVPHY EQU   RSEOVFLG                                                 11912000
RSEOVLOG EQU   RSEOVFLG                                                 11913000
RSEOVEND EQU   RSEOVFLG                                                 11914000
RSEOVFND EQU   RSEOVFLG                                                 11915000
RSEOVXIO EQU   @NM00067                                                 11916000
RSCATARG EQU   @NM00065+1                                               11917000
@NM00066 EQU   @NM00065                                                 11918000
RSCATRPL EQU   RSEOVWA+4                                                11919000
RSEOVRAB EQU   RSEOVWA                                                  11920000
RSPVFLG3 EQU   @NM00062+3                                               11921000
@NM00064 EQU   RSPVFLG2                                                 11922000
RSBDVOLS EQU   RSPVFLG2                                                 11923000
RSRETSPC EQU   RSPVFLG2                                                 11924000
RSSETERR EQU   RSPVFLG2                                                 11925000
RSSERROR EQU   RSPVFLG2                                                 11926000
RSPERROR EQU   RSPVFLG2                                                 11927000
RSVLCATE EQU   RSPVFLG2                                                 11928000
RSMUNUS  EQU   RSPVFLG2                                                 11929000
RSCK1TO1 EQU   RSPVFLG1                                                 11930000
RSCKBERR EQU   RSPVFLG1                                                 11931000
RSPVRSC  EQU   RSPVFLG1                                                 11932000
RSPVRPC  EQU   RSPVFLG1                                                 11933000
RSPVNRP  EQU   RSPVFLG1                                                 11934000
RSPVDELT EQU   RSPVFLG1                                                 11935000
RSPVRVOL EQU   RSPVFLG1                                                 11936000
RSCHKCON EQU   RSPVFLG1                                                 11937000
@NM00063 EQU   RSPVSETB                                                 11938000
RSST1TO1 EQU   RSPVSETB                                                 11939000
RSPVCLBM EQU   RSPVSETB                                                 11940000
RSSETMAP EQU   RSPVSETB                                                 11941000
RSSETCRA EQU   RSPVSETB                                                 11942000
@NM00061 EQU   RSPVTTNN+15                                              11943000
RSMASK   EQU   RSPVTTNN+14                                              11944000
RSPVKNEX EQU   RSPVTTNN+12                                              11945000
RSPVNN   EQU   RSPVTTNN+10                                              11946000
RSBITPOS EQU   RSPVTTNN+8                                               11947000
RSPVTNEX EQU   RSPVTTNN+6                                               11948000
RSPVNEXT EQU   RSPVTTNN+4                                               11949000
RSSETTT  EQU   RSPVTTNN                                                 11950000
RSPVSNT8 EQU   RSPVSNT+16                                               11951000
RSPVSNT6 EQU   RSPVSNT+12                                               11952000
RSPVSNT5 EQU   RSPVSNT+8                                                11953000
RSPVSNT3 EQU   RSPVSNT+4                                                11954000
RSPVSNTC EQU   RSPVSNT                                                  11955000
TMPSZ    EQU   RSPROCVL+44                                              11956000
RSMAPSIZ EQU   RSPROCVL+40                                              11957000
RSFROMAP EQU   RSMAPAD+16                                               11958000
RSTOMAP  EQU   RSMAPAD+12                                               11959000
RSSTBMAP EQU   RSMAPAD+8                                                11960000
RSCKBMAP EQU   RSMAPAD+4                                                11961000
RSTGBMAP EQU   RSMAPAD                                                  11962000
RSSCBMAP EQU   RSMAPS+16                                                11963000
RSCRBMAP EQU   RSPCBMAP                                                 11964000
RSCABMAP EQU   RSSBMAP                                                  11965000
RSPBMAP  EQU   RSMAPS+4                                                 11966000
RSWKBMAP EQU   RSMAPS                                                   11967000
RSGDGLL  EQU   RSGDG+4                                                  11968000
@NM00060 EQU   RSASSFLG+1                                               11969000
@NM00059 EQU   RSASSFL1                                                 11970000
RSRCHK   EQU   RSROPT                                                   11971000
RSREND   EQU   RSROPT                                                   11972000
RSRCRA   EQU   RSRDS                                                    11973000
RSRCAT   EQU   RSRDS                                                    11974000
RSRINIT  EQU   RSRTYPE                                                  11975000
RSRDEL   EQU   RSRTYPE                                                  11976000
RSRPOS   EQU   RSRTYPE                                                  11977000
RSRADD   EQU   RSRTYPE                                                  11978000
@NM00058 EQU   RSFLAGI2+1                                               11979000
RSUCDTN  EQU   RSFLAGI2+1                                               11980000
RSUCATN  EQU   RSFLAGI2+1                                               11981000
RSHAVECR EQU   RSFLAGI2+1                                               11982000
RSFDELET EQU   RSFLAGI2+1                                               11983000
RSOPDYN  EQU   RSFLAGI2+1                                               11984000
RSUCCCR  EQU   RSFLAGI2                                                 11985000
RSUCTWWF EQU   RSFLAGI2                                                 11986000
RSUCWFTN EQU   RSFLAGI2                                                 11987000
RSUCCATN EQU   RSFLAGI2                                                 11988000
RSMEBYV  EQU   RSFLAGI2                                                 11989000
RSMEOP   EQU   RSFLAGI2                                                 11990000
RSMETRM  EQU   RSFLAGI2                                                 11991000
RSCCVFND EQU   RSFLAGI2                                                 11992000
@NM00057 EQU   RSFLAGI1                                                 11993000
RSDUPNRR EQU   RSFLAGI1                                                 11994000
RSRENRR  EQU   RSFLAGI1                                                 11995000
RSREARR  EQU   RSFLAGI1                                                 11996000
RSCREXC  EQU   RSFLAGN2                                                 11997000
RSCREOV  EQU   RSFLAGN2                                                 11998000
RSTERM   EQU   RSFLAGN2                                                 11999000
RSALLC   EQU   RSFLAGN2                                                 12000000
RSCRAUA  EQU   RSFLAGN2                                                 12001000
RSWFCREA EQU   RSFLAGN2                                                 12002000
RSCAEOV  EQU   RSFLAGN2                                                 12003000
RSENUFCI EQU   RSFLAGN2                                                 12004000
RSIGNR   EQU   RSFLAGN1                                                 12005000
RSCARES  EQU   RSFLAGN1                                                 12006000
RSREASND EQU   RSFLAGN1                                                 12007000
RSVTOPN  EQU   RSFLAGN1                                                 12008000
RSCAOPN  EQU   RSFLAGN1                                                 12009000
RSCROPN  EQU   RSFLAGN1                                                 12010000
RSWFOPN  EQU   RSFLAGN1                                                 12011000
RSWFDEF  EQU   RSFLAGN1                                                 12012000
RSNCTS   EQU   RSNEWCAT+10                                              12013000
RSNCDEVT EQU   RSNEWCAT+6                                               12014000
RSNCVLSR EQU   RSNEWCAT                                                 12015000
RSWFPS   EQU   RSWORK+957                                               12016000
RSWCATPS EQU   RSWORK+949                                               12017000
RSWCATNM EQU   RSWORK+905                                               12018000
RSDFVLSR EQU   RSWORK+875                                               12019000
RSDFVLCT EQU   RSWORK+874                                               12020000
RSWFDSN  EQU   RSWORK+830                                               12021000
RSWFDDNM EQU   RSWORK+822                                               12022000
RSMRPS   EQU   RSWORK+814                                               12023000
RSCATVLS EQU   RSWORK+808                                               12024000
RSCATNCI EQU   RSWORK+805                                               12025000
RSCATTN  EQU   RSWORK+761                                               12026000
RSCATPS  EQU   RSWORK+753                                               12027000
RSCATDSN EQU   RSWORK+709                                               12028000
RSCATDDN EQU   RSWORK+701                                               12029000
RSUCCINO EQU   RSWORK+697                                               12030000
RSNOBLKT EQU   RSWORK+694                                               12031000
RSIDX3   EQU   RSWORK+692                                               12032000
RSIDX2   EQU   RSWORK+690                                               12033000
RSIDX1   EQU   RSWORK+688                                               12034000
RSCAFUCN EQU   RSWORK+684                                               12035000
RSORSTAT EQU   RSORVLLS+12                                              12036000
RSORNVOL EQU   RSORVLLS+6                                               12037000
RSORNDEV EQU   RSORVLLS+2                                               12038000
RSORVLCT EQU   RSORVLLS                                                 12039000
RSCRAVLN EQU   RSWORK+664                                               12040000
RSCHCRAN EQU   RSWORK+660                                               12041000
RSF1RNAM EQU   RSWORK+652                                               12042000
RSCIREMC EQU   RSWORK+648                                               12043000
RSCATSCN EQU   RSWORK+644                                               12044000
RSSUBSSZ EQU   RSWORK+640                                               12045000
RSSUBSTP EQU   RSWORK+636                                               12046000
RSSUBENP EQU   RSWORK+632                                               12047000
RSSUBGRP EQU   RSWORK+628                                               12048000
RSSUBRC  EQU   RSWORK+624                                               12049000
RSPROCRC EQU   RSWORK+620                                               12050000
RSUGLEN  EQU   RSWORK+616                                               12051000
RSCRADD  EQU   RSWORK+608                                               12052000
RSCIXLTB EQU   RSWORK+604                                               12053000
RSCATUCB EQU   RSWORK+596                                               12054000
RSCATACB EQU   RSWORK+592                                               12055000
RSCAPAS  EQU   RSWORK+588                                               12056000
CTGFVPTR EQU   RSWORK+584                                               12057000
RSUCNXT  EQU   RSWORK+564                                               12058000
RSTNNXT  EQU   RSWORK+560                                               12059000
RSDUPNXT EQU   RSWORK+556                                               12060000
RSRENEXT EQU   RSWORK+552                                               12061000
RSECPA   EQU   RSWORK+548                                               12062000
RSECBF1  EQU   RSWORK+544                                               12063000
RSWFIOCS EQU   RSWORK+540                                               12064000
RSVTIOCS EQU   RSWORK+536                                               12065000
RSWFDS   EQU   RSWORK+528                                               12066000
RSWFPAS  EQU   RSWORK+524                                               12067000
RSWFDD   EQU   RSWORK+520                                               12068000
RSWCPAS  EQU   RSWORK+516                                               12069000
RSWCDS   EQU   RSWORK+512                                               12070000
RSMRPAS  EQU   RSWORK+508                                               12071000
RSGDT    EQU   RSWORK+504                                               12072000
RSXRREND EQU   RSWORK+500                                               12073000
RSXCIEND EQU   RSWORK+496                                               12074000
RSENTNXT EQU   RSWORK+492                                               12075000
RSENTFBK EQU   RSWORK+488                                               12076000
RSENTST  EQU   RSWORK+480                                               12077000
RSTNCHN  EQU   RSWORK+476                                               12078000
RSREASS  EQU   RSWORK+472                                               12079000
RSREASSN EQU   RSWORK+468                                               12080000
RSVOLLUS EQU   RSWORK+464                                               12081000
RSVOLLST EQU   RSWORK+460                                               12082000
RSRESLUS EQU   RSWORK+456                                               12083000
RSVOLALL EQU   RSWORK+452                                               12084000
RSWFHURR EQU   RSWORK+448                                               12085000
RSWFNEXT EQU   RSWORK+444                                               12086000
RSWFSCND EQU   RSWORK+424                                               12087000
RSWFPRIM EQU   RSWORK+420                                               12088000
RSFPL    EQU   RSWORK+392                                               12089000
RSFDT    EQU   RSWORK+388                                               12090000
RSCURRN  EQU   RSWORK+384                                               12091000
RSCURCI  EQU   RSWORK+380                                               12092000
RSCREND  EQU   RSWORK+376                                               12093000
RSCANFCN EQU   RSWORK+368                                               12094000
RSCMRR   EQU   RSWORK+364                                               12095000
RSCACDE  EQU   RSWORK+360                                               12096000
RSAVNEXT EQU   RSWORK+356                                               12097000
RSAVAILN EQU   RSWORK+352                                               12098000
RS07RG12 EQU   RS07REGS+16                                              12099000
RS07RG11 EQU   RS07REGS+12                                              12100000
RS07RG10 EQU   RS07REGS+8                                               12101000
RS07RG09 EQU   RS07REGS+4                                               12102000
RS07RG08 EQU   RS07REGS                                                 12103000
RS06RG12 EQU   RS06REGS+16                                              12104000
RS06RG11 EQU   RS06REGS+12                                              12105000
RS06RG10 EQU   RS06REGS+8                                               12106000
RS06RG09 EQU   RS06REGS+4                                               12107000
RS06RG08 EQU   RS06REGS                                                 12108000
RS05RG12 EQU   RS05REGS+16                                              12109000
RS05RG11 EQU   RS05REGS+12                                              12110000
RS05RG10 EQU   RS05REGS+8                                               12111000
RS05RG09 EQU   RS05REGS+4                                               12112000
RS05RG08 EQU   RS05REGS                                                 12113000
RS04RG12 EQU   RS04REGS+16                                              12114000
RS04RG11 EQU   RS04REGS+12                                              12115000
RS04RG10 EQU   RS04REGS+8                                               12116000
RS04RG09 EQU   RS04REGS+4                                               12117000
RS04RG08 EQU   RS04REGS                                                 12118000
RS03RG12 EQU   RS03REGS+16                                              12119000
RS03RG11 EQU   RS03REGS+12                                              12120000
RS03RG10 EQU   RS03REGS+8                                               12121000
RS03RG09 EQU   RS03REGS+4                                               12122000
RS03RG08 EQU   RS03REGS                                                 12123000
RS02RG12 EQU   RS02REGS+16                                              12124000
RS02RG11 EQU   RS02REGS+12                                              12125000
RS02RG10 EQU   RS02REGS+8                                               12126000
RS01RG12 EQU   RS01REGS+16                                              12127000
RS01RG11 EQU   RS01REGS+12                                              12128000
RS01RG10 EQU   RS01REGS+8                                               12129000
RS01RG09 EQU   RS01REGS+4                                               12130000
RS01RG08 EQU   RS01REGS                                                 12131000
@NM00056 EQU   @NM00055                                                 12132000
@NM00054 EQU   @NM00053                                                 12133000
@NM00052 EQU   RSPSTACK+20                                              12134000
@NM00051 EQU   RSPSTACK+18                                              12135000
@NM00050 EQU   RSPSTACK+16                                              12136000
RSPTWKL  EQU   RSPSTACK+4                                               12137000
@NM00049 EQU   @NM00048                                                 12138000
@NM00047 EQU   RSGDITS+16                                               12139000
RSGDITL  EQU   RSGDITS+4                                                12140000
RSGDITF  EQU   RSGDITS                                                  12141000
@NM00046 EQU   @NM00045                                                 12142000
@NM00044 EQU   RSGCITS+16                                               12143000
RSGCITL  EQU   RSGCITS+4                                                12144000
RSGCITF  EQU   RSGCITS                                                  12145000
RSCRIOCS EQU   RSWORK+100                                               12146000
RSCPE8   EQU   RSWORK+96                                                12147000
RSCPE4   EQU   RSWORK+80                                                12148000
RSCANFCI EQU   RSWORK+44                                                12149000
RSCAIOCS EQU   RSWORK+40                                                12150000
RSCAHALC EQU   RSWORK+36                                                12151000
RSCAHACI EQU   RSWORK+32                                                12152000
RSCADS   EQU   RSWORK+24                                                12153000
RSCADD   EQU   RSWORK+20                                                12154000
RSAVAIL  EQU   RSWORK+8                                                 12155000
RSALLAGP EQU   RSWORK+4                                                 12156000
RSA      EQU   RSWORK                                                   12157000
RSF1RNNM EQU   RSF1RNTB+14                                              12158000
RSF1RNDV EQU   RSF1RNTB+10                                              12159000
RSF1RNVL EQU   RSF1RNTB+4                                               12160000
RSF1RNNX EQU   RSF1RNTB                                                 12161000
RESVLEXT EQU   RESVOL+28                                                12162000
RESVLDDN EQU   RESVOL+20                                                12163000
@NM00043 EQU   RESVOL+12                                                12164000
RESVLNEX EQU   RESVOL+10                                                12165000
@NM00042 EQU   RESVLFLG                                                 12166000
RESVLLAS EQU   RESVLFLG                                                 12167000
RESVLALE EQU   RESVLFLG                                                 12168000
RESVLMNT EQU   RESVLFLG                                                 12169000
RESVLUPD EQU   RESVOL+4                                                 12170000
RESVLNXT EQU   RESVOL                                                   12171000
VOLSRTS  EQU   VOLSERTB+20                                              12172000
VOLSRNTK EQU   VOLSERTB+12                                              12173000
VOLSRLAS EQU   VOLSRFLG                                                 12174000
VOLSRNXT EQU   VOLSERTB                                                 12175000
CATIHRBA EQU   CATIEXT+16                                               12176000
CATILRBA EQU   CATIEXT+12                                               12177000
@NM00041 EQU   CATIEXT                                                  12178000
@NM00039 EQU   IOCRCV                                                   12179000
IOCRCVRA EQU   IOCRCV                                                   12180000
IOCRCVXM EQU   IOCRCV                                                   12181000
IOCVLN   EQU   IOCSEX+42                                                12182000
IOCDNM   EQU   IOCSEX+40                                                12183000
IOCDDN   EQU   IOCDLM                                                   12184000
IOCMODEX EQU   IOCMOD                                                   12185000
IOCMODRP EQU   IOCMOD                                                   12186000
IOCMODXM EQU   IOCMOD                                                   12187000
IOCMODUB EQU   IOCMOD                                                   12188000
IOCMODRG EQU   IOCMOD                                                   12189000
IOCMODDY EQU   IOCMOD                                                   12190000
IOCMODRR EQU   IOCMOD                                                   12191000
IOCMODPD EQU   IOCMOD                                                   12192000
IOCINFR1 EQU   IOCINF                                                   12193000
IOCINFCT EQU   IOCINF                                                   12194000
IOCINFDO EQU   IOCINF                                                   12195000
IOCINFAC EQU   IOCINF                                                   12196000
IOCINFQX EQU   IOCINF                                                   12197000
IOCINFND EQU   IOCINF                                                   12198000
IOCINFAE EQU   IOCINF                                                   12199000
IOCINFPT EQU   IOCINF                                                   12200000
@NM00038 EQU   IOCDEV                                                   12201000
IOCDEVUR EQU   IOCDEV                                                   12202000
IOCDEVMT EQU   IOCDEV                                                   12203000
IOCDEVDA EQU   IOCDEV                                                   12204000
@NM00037 EQU   IOCFLG                                                   12205000
IOCFLGSP EQU   IOCFLG                                                   12206000
IOCFLGOE EQU   IOCFLG                                                   12207000
IOCFLGOP EQU   IOCFLG                                                   12208000
IOCFLGIO EQU   IOCFLG                                                   12209000
IOCFLGEF EQU   IOCFLG                                                   12210000
IOCFLGDF EQU   IOCFLG                                                   12211000
IOCFLGEX EQU   IOCFLG                                                   12212000
IOCSID   EQU   IOCSEX+28                                                12213000
IOCNIO   EQU   IOCSEX+24                                                12214000
@NM00036 EQU   IOCXPM+2                                                 12215000
IOCEXL   EQU   IOCXPM                                                   12216000
IOCEXA   EQU   IOCXAD                                                   12217000
IOCWKA   EQU   IOCSEX+12                                                12218000
IOCLRP   EQU   IOCSEX+10                                                12219000
IOCCBL   EQU   IOCSEX+8                                                 12220000
IOCDEC   EQU   IOCRPL                                                   12221000
IOCCBA   EQU   IOCSEX                                                   12222000
@NM00035 EQU   IODATA+64                                                12223000
IODAEI   EQU   IODATA+60                                                12224000
@NM00034 EQU   IODATA+56                                                12225000
IODIOX   EQU   IODATA+52                                                12226000
IODOCS   EQU   IODATA+48                                                12227000
IODICS   EQU   IODATA+44                                                12228000
IODOSO   EQU   IODATA+40                                                12229000
IODOSS   EQU   IODATA+36                                                12230000
IODEOD   EQU   IODATA+32                                                12231000
@NM00033 EQU   IODATA+30                                                12232000
@NM00032 EQU   IODATA+28                                                12233000
IODOEV   EQU   IODATA+24                                                12234000
IODIEV   EQU   IODATA+20                                                12235000
IODINC   EQU   IODSID+2                                                 12236000
IODMID   EQU   IODSID                                                   12237000
IODXTN   EQU   IODATA+12                                                12238000
IODADD   EQU   IODATA+8                                                 12239000
IODMSG   EQU   IODATA+4                                                 12240000
IODIOC   EQU   IODATA                                                   12241000
WFILEVAL EQU   WFILE+10                                                 12242000
WFILELEN EQU   WFILE+9                                                  12243000
WFILEPAS EQU   WFILE+1                                                  12244000
WFILEPLN EQU   WFILE                                                    12245000
CRADVVAL EQU   CRADV+1                                                  12246000
CRADVLEN EQU   CRADV                                                    12247000
CRAVLVAL EQU   CRAVL+1                                                  12248000
CRAVLLEN EQU   CRAVL                                                    12249000
CRADNVAL EQU   CRADN+1                                                  12250000
CRADNLEN EQU   CRADN                                                    12251000
WCATVAL  EQU   WCAT+21                                                  12252000
WCATLEN  EQU   WCAT+20                                                  12253000
WCATMEM  EQU   WCAT+12                                                  12254000
WCATMLN  EQU   WCAT+11                                                  12255000
WCATFUQ  EQU   WCATFLG                                                  12256000
WCATPOS  EQU   WCAT+9                                                   12257000
WCATPAS  EQU   WCAT+1                                                   12258000
WCATPLN  EQU   WCAT                                                     12259000
MRPWVAL  EQU   MRPW+1                                                   12260000
MRPWLEN  EQU   MRPW                                                     12261000
CATDNVAL EQU   CATDN+1                                                  12262000
CATDNLEN EQU   CATDN                                                    12263000
CATNMVAL EQU   CATNM+21                                                 12264000
CATNMLEN EQU   CATNM+20                                                 12265000
CATNMMEM EQU   CATNM+12                                                 12266000
CATNMMLN EQU   CATNM+11                                                 12267000
CATNMFUQ EQU   CATNMFLG                                                 12268000
CATNMPOS EQU   CATNM+9                                                  12269000
CATNMPAS EQU   CATNM+1                                                  12270000
CATNMPLN EQU   CATNM                                                    12271000
@NM00031 EQU   DMPARY+15                                                12272000
DMPARYTP EQU   DMPARY+14                                                12273000
DMPARYEX EQU   DMPARY+12                                                12274000
DMPARYIC EQU   DMPARY+10                                                12275000
DMPARYSZ EQU   DMPARY+8                                                 12276000
DMPARYNM EQU   DMPARY                                                   12277000
@NM00030 EQU   DMPITM+15                                                12278000
DMPITMTP EQU   DMPITM+14                                                12279000
DMPITMLN EQU   DMPITM+12                                                12280000
DMPITMPT EQU   DMPITM+8                                                 12281000
DMPITMNM EQU   DMPITM                                                   12282000
@NM00029 EQU   ERCNVTAB+24                                              12283000
ERDARBPT EQU   ERCPLPT                                                  12284000
ERDYNRC  EQU   ERCATRC                                                  12285000
ERDSNM   EQU   ERCNVTAB+12                                              12286000
@NM00028 EQU   ERCNVTAB+4                                               12287000
@NM00027 EQU   ERCNVTAB+3                                               12288000
@NM00026 EQU   EROSOPER                                                 12289000
EROSUCDX EQU   EROSOPER                                                 12290000
EROSCATL EQU   EROSOPER                                                 12291000
@NM00025 EQU   EROPER                                                   12292000
ERCATAL  EQU   EROPER                                                   12293000
ERCATDL  EQU   EROPER                                                   12294000
ERCATDE  EQU   EROPER                                                   12295000
ERCATLC  EQU   EROPER                                                   12296000
@NM00024 EQU   ERTYPE                                                   12297000
ERDYNAL  EQU   ERTYPE                                                   12298000
EROSCAT  EQU   ERTYPE                                                   12299000
ERCATLG  EQU   ERTYPE                                                   12300000
@NM00023 EQU   FMTCNVF+1                                                12301000
FMTAR    EQU   FMTCNVF+1                                                12302000
FMTBS    EQU   FMTCNVF+1                                                12303000
FMTSS    EQU   FMTCNVF+1                                                12304000
FMTAL    EQU   FMTCNVF+1                                                12305000
FMTZS    EQU   FMTCNVF+1                                                12306000
@NM00022 EQU   FMTCNVF                                                  12307000
FMTPU    EQU   FMTCNVF                                                  12308000
FMTBD    EQU   FMTCNVF                                                  12309000
FMTBHD   EQU   FMTCNVF                                                  12310000
FMTBHA   EQU   FMTCNVF                                                  12311000
FMTBH    EQU   FMTCNVF                                                  12312000
FMTOLEN  EQU   FMTLIST+8                                                12313000
FMTRIO   EQU   FMTOCOL                                                  12314000
FMTSPT   EQU   FMTSTO                                                   12315000
FMTSTL   EQU   FMTILEN                                                  12316000
@NM00021 EQU   FMTFLGS+1                                                12317000
FMTSMSG  EQU   FMTFLGS+1                                                12318000
FMTHDF   EQU   FMTFLGS                                                  12319000
FMTDFF   EQU   FMTFLGS                                                  12320000
FMTSTF   EQU   FMTFLGS                                                  12321000
FMTREPF  EQU   FMTFLGS                                                  12322000
FMTBDF   EQU   FMTFLGS                                                  12323000
FMTIDF   EQU   FMTFLGS                                                  12324000
FMTSCF   EQU   FMTFLGS                                                  12325000
FMTEOLF  EQU   FMTFLGS                                                  12326000
DARGDTM  EQU   DARGARY+4                                                12327000
DARGPCT  EQU   DARGINL                                                  12328000
DARGREP  EQU   DARGINS                                                  12329000
@NM00020 EQU   DARGLIST+19                                              12330000
DARGIND  EQU   DARGLIST+18                                              12331000
DARGRETL EQU   DARGLIST+16                                              12332000
DARGCNT  EQU   DARGLIST+14                                              12333000
DARGILP  EQU   DARGLIST+12                                              12334000
DARGSENT EQU   DARGSTID+3                                               12335000
DARGSMOD EQU   DARGSTID                                                 12336000
DARGRETP EQU   DARGLIST+4                                               12337000
DARGDBP  EQU   DARGLIST                                                 12338000
UVOLVOL  EQU   UVOLENT+4                                                12339000
UVOLDEV  EQU   UVOLENT                                                  12340000
UVOLCNT  EQU   UVOLLIST                                                 12341000
@NM00019 EQU   IOINFOPT                                                 12342000
IOINFLUB EQU   IOINFOPT                                                 12343000
IOINFTMS EQU   IOINFOPT                                                 12344000
IOINFSUP EQU   IOINFOPT                                                 12345000
IOINFDSN EQU   IOINFOPT                                                 12346000
IOINFVOL EQU   IOINFOPT                                                 12347000
IOINFDVT EQU   IOINFOPT                                                 12348000
OPNVOL   EQU   OPNAGL+44                                                12349000
OPNSTRNO EQU   OPNAGL+43                                                12350000
@NM00018 EQU   OPNOPT2                                                  12351000
OPNOPTJM EQU   OPNOPT2                                                  12352000
OPNOPTNM EQU   OPNOPT2                                                  12353000
OPNOPTAS EQU   OPNOPT2                                                  12354000
@NM00017 EQU   OPNDSO                                                   12355000
OPNDSOPO EQU   OPNDSO                                                   12356000
OPNDSOIS EQU   OPNDSO                                                   12357000
OPNDSOPS EQU   OPNDSO                                                   12358000
OPNDSOAM EQU   OPNDSO                                                   12359000
OPNKYL   EQU   OPNAGL+40                                                12360000
OPNBLK   EQU   OPNAGL+36                                                12361000
OPNREC   EQU   OPNAGL+32                                                12362000
OPNDEVIX EQU   OPNDEV+4                                                 12363000
OPNDEVDT EQU   OPNDEV                                                   12364000
OPNCBP   EQU   OPNAGL+20                                                12365000
OPNDSN   EQU   OPNAGL+16                                                12366000
OPNPWA   EQU   OPNAGL+12                                                12367000
OPNDDN   EQU   OPNAGL+8                                                 12368000
OPNIOC   EQU   OPNAGL+4                                                 12369000
OPNMODRP EQU   OPNMOD                                                   12370000
OPNMODUB EQU   OPNMOD                                                   12371000
OPNMODRS EQU   OPNMOD                                                   12372000
OPNMODAX EQU   OPNMOD                                                   12373000
OPNMODRR EQU   OPNMOD                                                   12374000
OPNMODRC EQU   OPNMOD                                                   12375000
OPNMODAC EQU   OPNMOD                                                   12376000
OPNMODPD EQU   OPNMOD                                                   12377000
OPNTYPSY EQU   OPNTYP                                                   12378000
OPNTYPRV EQU   OPNTYP                                                   12379000
OPNTYPEX EQU   OPNTYP                                                   12380000
OPNTYPRA EQU   OPNTYP                                                   12381000
OPNTYPXM EQU   OPNTYP                                                   12382000
OPNTYPCI EQU   OPNTYP                                                   12383000
OPNTYPSO EQU   OPNTYP                                                   12384000
OPNTYPSI EQU   OPNTYP                                                   12385000
@NM00016 EQU   OPNRFM                                                   12386000
OPNRFMBK EQU   OPNRFM                                                   12387000
OPNRFMSF EQU   OPNRFM                                                   12388000
OPNRFMUN EQU   OPNRFM                                                   12389000
OPNRFMVR EQU   OPNRFM                                                   12390000
OPNRFMFX EQU   OPNRFM                                                   12391000
OPNOPTSK EQU   OPNOPT                                                   12392000
OPNOPTDR EQU   OPNOPT                                                   12393000
OPNOPTCR EQU   OPNOPT                                                   12394000
OPNOPTKS EQU   OPNOPT                                                   12395000
OPNOPTBK EQU   OPNOPT                                                   12396000
OPNOPTUP EQU   OPNOPT                                                   12397000
OPNOPTOT EQU   OPNOPT                                                   12398000
OPNOPTIN EQU   OPNOPT                                                   12399000
IOCTSML  EQU   IOCREL+2                                                 12400000
IOCTPML  EQU   IOCREL                                                   12401000
IOCWORK  EQU   IOCSTR+56                                                12402000
IOCRRN   EQU   IOCSTR+52                                                12403000
IOCPNM   EQU   IOCNWM+2                                                 12404000
IOCPTL   EQU   IOCNWM                                                   12405000
IOCKYA   EQU   IOCMEM                                                   12406000
IOCVRC   EQU   IOCTTR                                                   12407000
IOCCBP   EQU   IOCSTR+36                                                12408000
IOCDSN   EQU   IOCSTR+32                                                12409000
IOCHURBA EQU   IOCSTR+28                                                12410000
IOCVOLSR EQU   IOCSTR+22                                                12411000
@NM00015 EQU   IOCMSG                                                   12412000
IOCMSGSM EQU   IOCMSG                                                   12413000
IOCMSGAE EQU   IOCMSG                                                   12414000
IOCMSGCE EQU   IOCMSG                                                   12415000
IOCMSGOE EQU   IOCMSG                                                   12416000
IOCMSGOP EQU   IOCMSG                                                   12417000
IOCCHPKG EQU   IOCMSG                                                   12418000
IOCCHPKE EQU   IOCMSG                                                   12419000
IOCCHPNU EQU   IOCCHP                                                   12420000
IOCCHPUP EQU   IOCCHP                                                   12421000
IOCCHPBK EQU   IOCCHP                                                   12422000
IOCCHPCR EQU   IOCCHP                                                   12423000
IOCCHPKS EQU   IOCCHP                                                   12424000
IOCCHPSK EQU   IOCCHP                                                   12425000
IOCCHPDR EQU   IOCCHP                                                   12426000
IOCCHPSQ EQU   IOCCHP                                                   12427000
IOCMACNT EQU   IOCMAC2                                                  12428000
IOCMACER EQU   IOCMAC2                                                  12429000
IOCMACPA EQU   IOCMAC2                                                  12430000
IOCMACEN EQU   IOCMAC2                                                  12431000
IOCMACCP EQU   IOCMAC2                                                  12432000
IOCMACRR EQU   IOCMAC2                                                  12433000
IOCMACAS EQU   IOCMAC2                                                  12434000
IOCMACSK EQU   IOCMAC2                                                  12435000
@NM00014 EQU   IOCMAC                                                   12436000
IOCMACCC EQU   IOCMAC                                                   12437000
IOCMACDR EQU   IOCMAC                                                   12438000
IOCMACBK EQU   IOCMAC                                                   12439000
IOCMACCR EQU   IOCMAC                                                   12440000
IOCMACUP EQU   IOCMAC                                                   12441000
IOCMACOT EQU   IOCMAC                                                   12442000
IOCMACIN EQU   IOCMAC                                                   12443000
@NM00013 EQU   IOCRFM                                                   12444000
IOCRFMBK EQU   IOCRFM                                                   12445000
IOCRFMSF EQU   IOCRFM                                                   12446000
IOCRFMUN EQU   IOCRFM                                                   12447000
IOCRFMVR EQU   IOCRFM                                                   12448000
IOCRFMFX EQU   IOCRFM                                                   12449000
@NM00012 EQU   IOCDSO                                                   12450000
IOCDSOPO EQU   IOCDSO                                                   12451000
IOCDSOIS EQU   IOCDSO                                                   12452000
IOCDSOPS EQU   IOCDSO                                                   12453000
IOCDSOAM EQU   IOCDSO                                                   12454000
IOCRKP   EQU   IOCSTR+13                                                12455000
IOCKYL   EQU   IOCSTR+12                                                12456000
IOCTRN   EQU   IOCSTR+8                                                 12457000
IOCDLN   EQU   IOCSTR+4                                                 12458000
IOCDAD   EQU   IOCSTR                                                   12459000
UNITVTOC EQU   UNITABL+7                                                12460000
@NM00011 EQU   UNITSTAT                                                 12461000
UNITUSHR EQU   UNITSTAT                                                 12462000
UNITXSHR EQU   UNITSTAT                                                 12463000
UNITISHR EQU   UNITSTAT                                                 12464000
UNITUA   EQU   @NM00010+1                                               12465000
UNITCHA  EQU   @NM00010                                                 12466000
UNITUCB  EQU   UNITABL                                                  12467000
ALLUNCNT EQU   ALLAGL+30                                                12468000
ALLVLCNT EQU   ALLAGL+29                                                12469000
@NM00009 EQU   ALLOPT                                                   12470000
ALLOPTUN EQU   ALLOPT                                                   12471000
ALLOPTPV EQU   ALLOPT                                                   12472000
ALLOPTDS EQU   ALLOPT                                                   12473000
ALLOPTVL EQU   ALLOPT                                                   12474000
@NM00008 EQU   ALLORG+1                                                 12475000
ALLORGVS EQU   ALLORG+1                                                 12476000
@NM00007 EQU   ALLORG+1                                                 12477000
ALLORGGS EQU   ALLORG+1                                                 12478000
ALLORGUN EQU   ALLORG                                                   12479000
ALLORGPO EQU   ALLORG                                                   12480000
ALLORGMQ EQU   ALLORG                                                   12481000
ALLORGCQ EQU   ALLORG                                                   12482000
ALLORGCX EQU   ALLORG                                                   12483000
ALLORGDA EQU   ALLORG                                                   12484000
ALLORGPS EQU   ALLORG                                                   12485000
ALLORGIS EQU   ALLORG                                                   12486000
ALLDSPUN EQU   ALLDSP                                                   12487000
ALLDSPCG EQU   ALLDSP                                                   12488000
ALLDSPDE EQU   ALLDSP                                                   12489000
ALLDSPKP EQU   ALLDSP                                                   12490000
@NM00006 EQU   ALLDSP                                                   12491000
ALLSTSOD EQU   ALLSTS                                                   12492000
ALLSTSMD EQU   ALLSTS                                                   12493000
ALLSTSNW EQU   ALLSTS                                                   12494000
ALLSTSSR EQU   ALLSTS                                                   12495000
@NM00005 EQU   ALLSTS                                                   12496000
ALLPWD   EQU   ALLAGL+20                                                12497000
ALLVLP   EQU   ALLAGL+16                                                12498000
ALLULP   EQU   ALLAGL+12                                                12499000
ALLDDN   EQU   ALLAGL+4                                                 12500000
ALLDSN   EQU   ALLAGL                                                   12501000
CIRPID   EQU   CIRAGL+28                                                12502000
CIRPWD   EQU   CIRAGL+24                                                12503000
CIRCAT   EQU   CIRAGL+20                                                12504000
CIRWKP   EQU   CIRAGL+16                                                12505000
CIRTLR   EQU   CIRAGL+12                                                12506000
CIRHDR   EQU   CIRAGL+8                                                 12507000
CIRTLN   EQU   CIRAGL+6                                                 12508000
CIRHLN   EQU   CIRAGL+4                                                 12509000
@NM00004 EQU   CIRAGL+1                                                 12510000
@NM00003 EQU   CIRTYPE                                                  12511000
CIRTYPAQ EQU   CIRTYPE                                                  12512000
CIRTYP1Q EQU   CIRTYPE                                                  12513000
NEWID1   EQU   TRACE1+95                                                12514000
CALLID   EQU   OLDERID1+90                                              12515000
@NM00002 EQU   OLDERID1                                                 12516000
GDTECT   EQU   GDTTBL+188                                               12517000
GDTPSB   EQU   GDTTBL+184                                               12518000
GDTUPT   EQU   GDTTBL+180                                               12519000
GDTCMB   EQU   GDTTBL+176                                               12520000
GDTSPR   EQU   GDTTBL+168                                               12521000
@NM00001 EQU   GDTTBL+160                                               12522000
GDTABH   EQU   GDTTBL+156                                               12523000
GDTABT   EQU   GDTTBL+152                                               12524000
GDTTOH   EQU   GDTTBL+120                                               12525000
GDTRIP   EQU   GDTTBL+116                                               12526000
GDTSAH   EQU   GDTTBL+32                                                12527000
GDTTPH   EQU   GDTTBL+28                                                12528000
GDTRIH   EQU   GDTTBL+24                                                12529000
GDTSTH   EQU   GDTTBL+20                                                12530000
GDTDBH   EQU   GDTTBL+16                                                12531000
GDTPRM   EQU   GDTTBL+4                                                 12532000
GDTHDR   EQU   GDTTBL                                                   12533000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      12534000
@RF00459 EQU   @RC00399                                                 12535000
@RC00543 EQU   @RC00540                                                 12536000
@RC00541 EQU   @RC00540                                                 12537000
@RC00561 EQU   @RC00560                                                 12538000
@RF00683 EQU   @RC00677                                                 12539000
@RC00784 EQU   @RC00768                                                 12540000
@RC00773 EQU   @RC00768                                                 12541000
@RF00772 EQU   @RC00768                                                 12542000
@RT01024 EQU   @RC00946                                                 12543000
@RF01060 EQU   @RC00932                                                 12544000
@RF01255 EQU   @RC01195                                                 12545000
@RF01824 EQU   @RC01821                                                 12546000
@RC01978 EQU   @RC01977                                                 12547000
@PB00017 EQU   @EL00001                                                 12548000
@ENDDATA EQU   *                                                        12549000
         END   IDCRS02,(C'PLS2315',0701,77115)                          12550000
