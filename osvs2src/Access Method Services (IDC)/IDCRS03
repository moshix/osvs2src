         TITLE '************** IDCRS03: IDCAMS RESETCAT ROUTINE ********00001000
               *********'                                               00002000
IDCRS03  CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IDCRS03   77.119'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         USING @PSTART,@12                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@10                                    0001 00017000
         USING @PSTART+12285,@09                                   0001 00018000
         USING @DATD,@08  DATA BASE REGISTER                            00019000
         L     @15,@SIZDATD  SIZE OF AUTOMATIC DATA                     00020000
         LA    @15,0(0,@15)  CLEAR SUBPOOL                              00021000
         STM   @09,@12,RS03RG09(REG6)  SAVE BASE REGISTERS              00022000
*        RETURN CODE(REG15);  /*REG 15 HAS LENGTH OF AUTO DATA*/   0291 00023000
         L     @14,12(,@13)                                        0291 00024000
         LM    @00,@12,20(@13)                                     0291 00025000
         BR    @14                                                 0291 00026000
*/********************************************************************/ 00027000
*/*                                                                  */ 00028000
*/*            RESETCAT LOCAL DECLARATIONS                           */ 00029000
*/*                                                                  */ 00030000
*/********************************************************************/ 00031000
*                                                                  0292 00032000
*DCL MODID CHAR(4) INIT('RS03');       /*MODID FOR UEPIL             */ 00033000
*                                                                  0292 00034000
*DCL                                                               0293 00035000
*   1 PATCH    CHAR(800)               /*PATCH AREA                  */ 00036000
*              LOCAL STATIC BDY(WORD), /* 5 PERCENT                  */ 00037000
*     2 *      CHAR(32)                /*PATCHAREA                   */ 00038000
*              INIT('PATCH 800 BYTES LAST USED 000000'),           0293 00039000
*                                      /*IDENTIFIER                  */ 00040000
*     2 *(768) CHAR(1)                 /*FORMAT UNUSED AREA          */ 00041000
*              INIT((768)'00'X);       /*WITH ZEROS                  */ 00042000
*                                                                  0293 00043000
*/********************************************************************/ 00044000
*/*                                                                  */ 00045000
*/* DATA FOR IDCRS03 -                                               */ 00046000
*/*     BIT MASKS FOR SETBITS                                        */ 00047000
*/*                                                                  */ 00048000
*/********************************************************************/ 00049000
*  DECLARE MASKVAL CHAR(8) INIT('FF7F3F1F0F070301'X);              0294 00050000
*                                      /*FIRST BIT POSITION MASK     */ 00051000
*  DECLARE MASKV1 CHAR(8) INIT('80C0E0F0F8FCFEFF'X);               0295 00052000
*                                      /*LAST BIT POSITION MASK      */ 00053000
*  DECLARE MASKALL CHAR(1) INIT('FF'X); /*FULL BYTE MASK             */ 00054000
*  DECLARE ASSO3A  CHAR(*) EXTERNAL NONLOCAL;                      0297 00055000
*                                      /*GDG DATA SET ASSOC TBL(RS02)*/ 00056000
*/********************************************************************/ 00057000
*/*                                                                  */ 00058000
*/* PROCEDURE NAME - CATRCDSU                                        */ 00059000
*/*                                                                  */ 00060000
*/* FUNCTION -                                                       */ 00061000
*/*      ESTABLISH BASE ADDRESSES FOR DISECTING CATALOG              */ 00062000
*/*      LOW KEY RANGE RECORDS.                                      */ 00063000
*/*                                                                  */ 00064000
*/* INPUT -                                                          */ 00065000
*/*      LOW KEY RANGE RECORD(RSGRABCU->GRABCURR->RECORD)            */ 00066000
*/*                                                                  */ 00067000
*/* OUTPUT -                                                         */ 00068000
*/*      RSCPE1 - ADDRESS OF START OF RECORD                         */ 00069000
*/*      RSCPE2 - ADDRESS OF START OF GOPS(GROUP OCCURRENCE POINTERS)*/ 00070000
*/*      RSCPE3 - ADDRESS OF START OF GOS(GROUP OCCURRENCES)         */ 00071000
*/*      RSCPE4 - ADDRESS OF END OF RECORD                           */ 00072000
*/*      RSGOPLEN - LENGTH OF GOPS FOR THIS RECORD                   */ 00073000
*/*                                                                  */ 00074000
*/* EXIT - RETURN TO CALLER                                          */ 00075000
*/*                                                                  */ 00076000
*/********************************************************************/ 00077000
*      GENERATE;                                                   0298 00078000
         DS    0F                                                       00079000
NAME0002 DC    CL8'CATRCDSU'                                            00080000
*CATRCDSU: PROCEDURE                                               0299 00081000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0299 00082000
*                                                                  0299 00083000
         B     @PB00002                                            0299 00084000
CATRCDSU DS    0H                                                  0300 00085000
*      GENERATE REFS(RS03RG08, REG6);                              0300 00086000
*                                                                  0300 00087000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          00088000
         LR    @15,@13  OLD SAVE AREA                                   00089000
         LA    @13,72(@13)  NEW SAVE AREA                               00090000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     00091000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        00092000
         ENTRY CATRCDSU  ENTRY POINT                                    00093000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         00094000
         MVC   0(4,@15),NAME0002  PROCNAME TO REGSAVE                   00095000
*        RSCPE1 = ADDR(CATRCD);    /* START OF RECORD*/            0301 00096000
         L     @07,RSGRABCU(,REG6)                                 0301 00097000
         LA    @04,8                                               0301 00098000
         AL    @04,GRABCURR(,@07)                                  0301 00099000
         ST    @04,RSCPE1(,REG6)                                   0301 00100000
*        RFY CATRCD BASED(RSCPE1);                                 0302 00101000
*        IF RCDID = LCCRID | RCDID = FREEID THEN;                  0303 00102000
         CLI   RCDID(@04),C'L'                                     0303 00103000
         BE    @RT00303                                            0303 00104000
         CLI   RCDID(@04),C'F'                                     0303 00105000
         BE    @RT00303                                            0303 00106000
*                                      /*NO GOP OR GO FOR FREE OR CCR*/ 00107000
*        ELSE                                                      0305 00108000
*          DO;                         /*GET ADDRESS OF GOP AND GO*/    00109000
*            RSCPE2 = RSCPE1 + NREPLF; /*START OF GOPS*/           0306 00110000
         L     @07,RSCPE1(,REG6)                                   0306 00111000
         SLR   @04,@04                                             0306 00112000
         IC    @04,NREPLF(,@07)                                    0306 00113000
         ALR   @04,@07                                             0306 00114000
         ST    @04,RSCPE2(,REG6)                                   0306 00115000
*            IF RCDID = GDGID THEN                                 0307 00116000
         CLI   RCDID(@07),C'B'                                     0307 00117000
         BNE   @RF00307                                            0307 00118000
*              DO;                     /*FOR GDG BASE - VARIABLE DATA*/ 00119000
*                RSCPE7 = RSCPE2;      /* ADDR OF DATA FOR GDG BASE*/   00120000
         ST    @04,RSCPE7(,REG6)                                   0309 00121000
*                RSCPE2 = RSCPE2 + VARLEN + LENGTH(VARLEN);        0310 00122000
         ICM   @07,12,VARLEN(@04)                                  0310 00123000
         SRA   @07,16                                              0310 00124000
         ALR   @07,@04                                             0310 00125000
         AL    @07,@CF00149                                        0310 00126000
         ST    @07,RSCPE2(,REG6)                                   0310 00127000
*                                      /*START OF GOPS - GDG BASE*/     00128000
*              END;                                                0311 00129000
*            RSGOPLEN = CATGOPLN;      /*CAT GOP LENGTH*/          0312 00130000
@RF00307 MVC   RSGOPLEN(2,REG6),@CH00280                           0312 00131000
*            IF RCDID = VOLID | RCDID = VOLEXTID THEN              0313 00132000
         L     @07,RSCPE1(,REG6)                                   0313 00133000
         CLI   RCDID(@07),C'V'                                     0313 00134000
         BE    @RT00313                                            0313 00135000
         CLI   RCDID(@07),C'W'                                     0313 00136000
         BNE   @RF00313                                            0313 00137000
@RT00313 DS    0H                                                  0314 00138000
*              RSGOPLEN = VOLGOPLN;    /*VOLUME GOP LENGTH*/       0314 00139000
         MVC   RSGOPLEN(2,REG6),@CH00152                           0314 00140000
*            RSCPE3 = ADDR(REPGOPT) + REPCNT*RSGOPLEN;             0315 00141000
@RF00313 L     @07,RSCPE2(,REG6)                                   0315 00142000
         LA    @04,REPGOPT(,@07)                                   0315 00143000
         SLR   @15,@15                                             0315 00144000
         IC    @15,REPCNT(,@07)                                    0315 00145000
         MH    @15,RSGOPLEN(,REG6)                                 0315 00146000
         ALR   @04,@15                                             0315 00147000
         ST    @04,RSCPE3(,REG6)                                   0315 00148000
*                                      /*START OF GOS*/            0316 00149000
*            RSCPE4 = RSCPE1 + RCDSIZ; /*END OF RECORD*/           0316 00150000
         L     @07,RSCPE1(,REG6)                                   0316 00151000
         ICM   @04,12,RCDSIZ(@07)                                  0316 00152000
         SRA   @04,16                                              0316 00153000
         ALR   @04,@07                                             0316 00154000
         ST    @04,RSCPE4(,REG6)                                   0316 00155000
*          END;                                                    0317 00156000
*                                                                  0317 00157000
*        RFY CATRCD;                   /*REVERT                      */ 00158000
@RT00303 DS    0H                                                  0319 00159000
*  CALL EXIT;  /*TERMINATE*/                                       0319 00160000
         BAL   @14,EXIT                                            0319 00161000
*  END CATRCDSU; /*END OF PROCEDURE*/                              0320 00162000
@EL00002 DS    0H                                                  0320 00163000
@EF00002 DS    0H                                                  0320 00164000
@ER00002 BR    @14                                                 0320 00165000
@PB00002 DS    0H                                                  0321 00166000
*/********************************************************************/ 00167000
*/* PROCEDURE NAME - CHKBITS                                         */ 00168000
*/*                                                                  */ 00169000
*/* FUNCTION -                                                       */ 00170000
*/*     CHECK BITS BETWEEN TWO BITMAPS. EITHER BITS ARE ALL ON OR    */ 00171000
*/*     ALL OFF.                                                     */ 00172000
*/*                                                                  */ 00173000
*/* INPUT -                                                          */ 00174000
*/*     RSTGBMAP - MAP WITH TRACKS TO BE CHECKED                     */ 00175000
*/*     RSCKBMAP - CHECK TRACKS IN RSTGBMAP AGAINST THIS MAP         */ 00176000
*/*     RSCK1TO1 - ON = A 1 IN TARGET MAP SHOULD HAVE A 1 IN COMP MAP*/ 00177000
*/*                OFF= A 1 IN TARGET MAP SHOULD HAVE A 0 IN COMP MAP*/ 00178000
*/*     RSMAPSIZ - SIZE OF THE MAP                                   */ 00179000
*/*                                                                  */ 00180000
*/* OUTPUT -                                                         */ 00181000
*/*     RSCKBERR - ON = MISMATCH.                                    */ 00182000
*/*                                                                  */ 00183000
*/********************************************************************/ 00184000
*      GENERATE;                                                   0321 00185000
         DS    0F                                                       00186000
NAME0004 DC    CL8'CHKBITS'                                             00187000
*CHKBITS: PROCEDURE                                                0322 00188000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0322 00189000
*                                                                  0322 00190000
         B     @PB00003                                            0322 00191000
CHKBITS  DS    0H                                                  0323 00192000
*      GENERATE REFS(RS03RG08, REG6);                              0323 00193000
*                                                                  0323 00194000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          00195000
         LR    @15,@13  OLD SAVE AREA                                   00196000
         LA    @13,72(@13)  NEW SAVE AREA                               00197000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     00198000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        00199000
         MVC   0(4,@15),NAME0004  PROCNAME TO REGSAVE                   00200000
*        RFY BMAP BASED(RSTOMAP);                                  0324 00201000
*                                                                  0324 00202000
*        /************************************************************/ 00203000
*        /*                                                          */ 00204000
*        /*                        INITIALIZE                        */ 00205000
*        /*                                                          */ 00206000
*        /************************************************************/ 00207000
*                                                                  0325 00208000
*        RSCKBERR = OFF;               /*RESET ERROR                 */ 00209000
         NI    RSCKBERR(REG6),B'11111101'                          0325 00210000
*        RSTOMAP = RSTGBMAP;           /*MAP 1                       */ 00211000
         L     @07,RSTGBMAP(,REG6)                                 0326 00212000
         ST    @07,RSTOMAP(,REG6)                                  0326 00213000
*        RSFROMAP = RSCKBMAP;          /* MAP 2                      */ 00214000
*                                                                  0327 00215000
         L     @07,RSCKBMAP(,REG6)                                 0327 00216000
         ST    @07,RSFROMAP(,REG6)                                 0327 00217000
*        /************************************************************/ 00218000
*        /*                                                          */ 00219000
*        /*     CHECK FOR A MATCH                                    */ 00220000
*        /*                                                          */ 00221000
*        /************************************************************/ 00222000
*                                                                  0328 00223000
*        DO TMPSZ = 1 TO RSMAPSIZ WHILE (RSCKBERR=OFF);            0328 00224000
*                                                                  0328 00225000
         LA    @07,1                                               0328 00226000
         B     @DE00328                                            0328 00227000
@DL00328 TM    RSCKBERR(REG6),B'00000010'                          0328 00228000
         BNZ   @DC00328                                            0328 00229000
*        /************************************************************/ 00230000
*        /*                                                          */ 00231000
*        /*                         BOTH 1S                          */ 00232000
*        /*                                                          */ 00233000
*        /************************************************************/ 00234000
*                                                                  0329 00235000
*          IF RSCK1TO1 = ON THEN                                   0329 00236000
         TM    RSCK1TO1(REG6),B'00000001'                          0329 00237000
         BNO   @RF00329                                            0329 00238000
*            IF BMAP(1:1) ^= (BMAP(1:1) & (RSFROMAP->BMAP(1:1))) THEN   00239000
         L     @07,RSTOMAP(,REG6)                                  0330 00240000
         L     @04,RSFROMAP(,REG6)                                 0330 00241000
         MVC   @TS00001(1),BMAP(@07)                               0330 00242000
         NC    @TS00001(1),BMAP(@04)                               0330 00243000
         CLC   BMAP(1,@07),@TS00001                                0330 00244000
         BE    @RF00330                                            0330 00245000
*              RSCKBERR = ON;                                      0331 00246000
         OI    RSCKBERR(REG6),B'00000010'                          0331 00247000
*            ELSE;                                                 0332 00248000
*                                                                  0332 00249000
@RF00330 DS    0H                                                  0333 00250000
*        /************************************************************/ 00251000
*        /*                                                          */ 00252000
*        /*                      MAP 1S TO 0S                        */ 00253000
*        /*                                                          */ 00254000
*        /************************************************************/ 00255000
*                                                                  0333 00256000
*          ELSE                                                    0333 00257000
*            IF (BMAP(1:1) & (RSFROMAP->BMAP(1:1))) ^= '00'X THEN  0333 00258000
         B     @RC00329                                            0333 00259000
@RF00329 L     @07,RSTOMAP(,REG6)                                  0333 00260000
         L     @04,RSFROMAP(,REG6)                                 0333 00261000
         MVC   @TS00001(1),BMAP(@07)                               0333 00262000
         NC    @TS00001(1),BMAP(@04)                               0333 00263000
         CLI   @TS00001,X'00'                                      0333 00264000
         BE    @RF00333                                            0333 00265000
*              RSCKBERR = ON;                                      0334 00266000
         OI    RSCKBERR(REG6),B'00000010'                          0334 00267000
*          RSTOMAP = RSTOMAP + 1;                                  0335 00268000
@RF00333 DS    0H                                                  0335 00269000
@RC00329 LA    @07,1                                               0335 00270000
         L     @04,RSTOMAP(,REG6)                                  0335 00271000
         ALR   @04,@07                                             0335 00272000
         ST    @04,RSTOMAP(,REG6)                                  0335 00273000
*          RSFROMAP = RSFROMAP + 1;                                0336 00274000
         AL    @07,RSFROMAP(,REG6)                                 0336 00275000
         ST    @07,RSFROMAP(,REG6)                                 0336 00276000
*        END;                                                      0337 00277000
         LA    @07,1                                               0337 00278000
         AL    @07,TMPSZ(,REG6)                                    0337 00279000
@DE00328 ST    @07,TMPSZ(,REG6)                                    0337 00280000
         C     @07,RSMAPSIZ(,REG6)                                 0337 00281000
         BNH   @DL00328                                            0337 00282000
@DC00328 DS    0H                                                  0338 00283000
*        RFY BMAP;                     /*REVERT                      */ 00284000
* CALL EXIT;  /*TERMINATE*/                                        0339 00285000
         BAL   @14,EXIT                                            0339 00286000
* END CHKBITS; /*END OF PROCEDURE*/                                0340 00287000
@EL00003 DS    0H                                                  0340 00288000
@EF00003 DS    0H                                                  0340 00289000
@ER00003 BR    @14                                                 0340 00290000
@PB00003 DS    0H                                                  0341 00291000
*/********************************************************************/ 00292000
*/* PROCEDURE NAME - CHKDSDIR                                        */ 00293000
*/*                                                                  */ 00294000
*/* FUNCTION -                                                       */ 00295000
*/*     ENSURE THAT THE DSDIR AND DATA OR INDEX HAVE                 */ 00296000
*/*     MATCHING CREATION TIME STAMPS AND SUM TT(S). UPDATE THE      */ 00297000
*/*     DSDIR CIN IF THE DATA OR INDEX HAS BEEN REASSIGNED.          */ 00298000
*/*     MARK THE VGO UNUSABLE IF THE DSDIR AND VGO DON'T MATCH.      */ 00299000
*/*                                                                  */ 00300000
*/* INPUT -                                                          */ 00301000
*/*     RSCDSNT8 - ADDRESS OF SN VECTOR TABLE FOR THE DSDIR          */ 00302000
*/*       RSFAENT - ADDRESS OF DSDIR ENTRY TO CHECK                  */ 00303000
*/*       RSFCNDX - INDEX OF THE DSDIR ENTRY                         */ 00304000
*/*     RSCDSNT3 - ADDRESS OF SN VECTOR TABLE FOR THE VGOS.          */ 00305000
*/*       RSFAENT - ADDRESS OF 1ST VGO FOR THIS DSDIR.               */ 00306000
*/*       RSFCNDX - INDEX OF THE VGO                                 */ 00307000
*/*     RSCDVOLR - ADDRESS OF RAB FOR THE VOLUME RECORD              */ 00308000
*/*     RSCDDIR - ADDRESS OF RAB FOR THE DATA OR INDEX RECORD        */ 00309000
*/*                                                                  */ 00310000
*/* OUTPUT -                                                         */ 00311000
*/*     SNFPROC - SET ON IN EACH VGO PROCESSED                       */ 00312000
*/*                                                                  */ 00313000
*/********************************************************************/ 00314000
*      GENERATE;                                                   0341 00315000
         DS    0F                                                       00316000
NAME0006 DC    CL8'CHKDSDIR'                                            00317000
*CHKDSDIR: PROCEDURE                                               0342 00318000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0342 00319000
*                                                                  0342 00320000
         B     @PB00004                                            0342 00321000
CHKDSDIR DS    0H                                                  0343 00322000
*      GENERATE REFS(RS03RG08, REG6);                              0343 00323000
*                                                                  0343 00324000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          00325000
         LR    @15,@13  OLD SAVE AREA                                   00326000
         LA    @13,72(@13)  NEW SAVE AREA                               00327000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     00328000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        00329000
         ENTRY CHKDSDIR  ENTRY POINT                                    00330000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         00331000
         MVC   0(4,@15),NAME0006  PROCNAME TO REGSAVE                   00332000
*        OLDERID2 = NEWERID2;                                      0344 00333000
         L     @07,GDTTR2(,REG5)                                   0344 00334000
         MVC   @TS00001(95),NEWERID2(@07)                          0344 00335000
         MVC   OLDERID2(95,@07),@TS00001                           0344 00336000
*        NEWID2 = 'RSCD';                                          0345 00337000
*                                                                  0345 00338000
         MVC   NEWID2(4,@07),@CC03496                              0345 00339000
*        /************************************************************/ 00340000
*        /*                                                          */ 00341000
*        /*  SAVE THE CALLER'S VGO AND DSDIR STATUS                  */ 00342000
*        /*                                                          */ 00343000
*        /************************************************************/ 00344000
*                                                                  0346 00345000
*        RSCD8FAE = RSCDSNT8->RSFAENT;                             0346 00346000
         L     @07,RSCDSNT8(,REG6)                                 0346 00347000
         L     @04,RSFAENT(,@07)                                   0346 00348000
         ST    @04,RSCD8FAE(,REG6)                                 0346 00349000
*        RSCD8FCN = RSCDSNT8->RSFCNDX;                             0347 00350000
         LH    @07,RSFCNDX(,@07)                                   0347 00351000
         STH   @07,RSCD8FCN(,REG6)                                 0347 00352000
*        RSCD3FAE = RSCDSNT3->RSFAENT;                             0348 00353000
         L     @07,RSCDSNT3(,REG6)                                 0348 00354000
         L     @15,RSFAENT(,@07)                                   0348 00355000
         ST    @15,RSCD3FAE(,REG6)                                 0348 00356000
*        RSCD3FCN = RSCDSNT3->RSFCNDX;                             0349 00357000
*                                                                  0349 00358000
         LH    @15,RSFCNDX(,@07)                                   0349 00359000
         STH   @15,RSCD3FCN(,REG6)                                 0349 00360000
*        /************************************************************/ 00361000
*        /*                                                          */ 00362000
*        /*  INITIALIZE FOR VGO SCAN                                 */ 00363000
*        /*                                                          */ 00364000
*        /************************************************************/ 00365000
*                                                                  0350 00366000
*        RFY SNDSDIR BASED(RSCDSNT8->RSFAENT); /*DSDIR SNTAB         */ 00367000
*        RSWASNVT = RSCDSNT3;          /*VGO SNTAB                   */ 00368000
         ST    @07,RSWASNVT(,REG6)                                 0351 00369000
*        GRABCURR = RSCDDIR;           /*DATA OR INDEX RECORD        */ 00370000
*                                                                  0352 00371000
         L     @07,RSGRABCU(,REG6)                                 0352 00372000
         L     @15,RSCDDIR(,REG6)                                  0352 00373000
         ST    @15,GRABCURR(,@07)                                  0352 00374000
*        /************************************************************/ 00375000
*        /*                                                          */ 00376000
*        /*     ENSURE MATCHING CINS BETWEEN THE DSDIR AND D OR I    */ 00377000
*        /*     IF NOT MATCHING, MARK THE VGO UNUSABLE.              */ 00378000
*        /*                                                          */ 00379000
*        /************************************************************/ 00380000
*                                                                  0353 00381000
*        RSASDSDI = OFF;               /*ASSUME NO DSDIR MATCH       */ 00382000
         NI    RSASDSDI(REG6),B'10111111'                          0353 00383000
*        IF SDSIDNO ^= RCDCINO THEN                                0354 00384000
         CLC   SDSIDNO(3,@04),RCDCINO+8(@15)                       0354 00385000
         BE    @RF00354                                            0354 00386000
*          CALL MARKUNUS;                                          0355 00387000
*                                                                  0355 00388000
         BAL   @14,MARKUNUS                                        0355 00389000
*        /************************************************************/ 00390000
*        /*                                                          */ 00391000
*        /*     CHECK FOR AN EXTENDED DSDIR. NOTE THAT DOS DID NOT   */ 00392000
*        /*     INCLUDE THE EXTENDED DSDIR IN THEIR SUPPORT.         */ 00393000
*        /*                                                          */ 00394000
*        /************************************************************/ 00395000
*                                                                  0356 00396000
*        ELSE                                                      0356 00397000
*          IF SDSEXT = OFF THEN                                    0356 00398000
         B     @RC00354                                            0356 00399000
@RF00354 L     @07,RSCDSNT8(,REG6)                                 0356 00400000
         L     @07,RSFAENT(,@07)                                   0356 00401000
         TM    SDSEXT(@07),B'10000000'                             0356 00402000
         BNZ   @RF00356                                            0356 00403000
*            RSASDSDI = ON;            /*GOOD DSDIR                  */ 00404000
*                                                                  0357 00405000
         OI    RSASDSDI(REG6),B'01000000'                          0357 00406000
*        /************************************************************/ 00407000
*        /*                                                          */ 00408000
*        /*     EXTENDED DSDIR CHECK - FIRST CHECK THE CREATION      */ 00409000
*        /*     TIME STAMP.                                          */ 00410000
*        /*                                                          */ 00411000
*        /************************************************************/ 00412000
*                                                                  0358 00413000
*          ELSE                                                    0358 00414000
*            DO;                                                   0358 00415000
         B     @RC00356                                            0358 00416000
@RF00356 DS    0H                                                  0359 00417000
*              IF SDSCRETS ^= RCDDICTS THEN                        0359 00418000
         L     @07,RSCDSNT8(,REG6)                                 0359 00419000
         L     @07,RSFAENT(,@07)                                   0359 00420000
         L     @04,RSGRABCU(,REG6)                                 0359 00421000
         L     @04,GRABCURR(,@04)                                  0359 00422000
         CLC   SDSCRETS(4,@07),RCDDICTS+8(@04)                     0359 00423000
         BE    @RF00359                                            0359 00424000
*                CALL MARKUNUS;                                    0360 00425000
*                                                                  0360 00426000
         BAL   @14,MARKUNUS                                        0360 00427000
*        /************************************************************/ 00428000
*        /*                                                          */ 00429000
*        /*     SECOND - ENSURE THAT THE SUM TT IS GOOD BY SUMMING   */ 00430000
*        /*     THE STARTING TRACKS ALLOCATED.                       */ 00431000
*        /*                                                          */ 00432000
*        /************************************************************/ 00433000
*                                                                  0361 00434000
*              ELSE                                                0361 00435000
*                DO;                                               0361 00436000
         B     @RC00359                                            0361 00437000
@RF00359 DS    0H                                                  0362 00438000
*                  RSASDSDI = ON;      /*DSDIR EXISTS                */ 00439000
         OI    RSASDSDI(REG6),B'01000000'                          0362 00440000
*                  RSCDSUMT = 0;                                   0363 00441000
         SLR   @07,@07                                             0363 00442000
         ST    @07,RSCDSUMT(,REG6)                                 0363 00443000
*                  DO RSFCNDX = RSFCNDX TO RSFHNDX;                0364 00444000
         L     @07,RSWASNVT(,REG6)                                 0364 00445000
         LH    @07,RSFCNDX(,@07)                                   0364 00446000
         B     @DE00364                                            0364 00447000
@DL00364 DS    0H                                                  0365 00448000
*                                      /*SCAN FROM 1ST MATCHING VGO  */ 00449000
*                                                                  0365 00450000
*        /************************************************************/ 00451000
*        /*                                                          */ 00452000
*        /*       SUM ALL MATCHING VOLSER-DSDIR SN COMBINATIONS      */ 00453000
*        /*                                                          */ 00454000
*        /************************************************************/ 00455000
*                                                                  0365 00456000
*                    IF (SNVOLSER = RSCD3FAE->SNVOLSER) &          0365 00457000
*                     (SDSDIRSN = RSCD3FAE->SDSDIRSN) THEN         0365 00458000
         L     @07,RSWASNVT(,REG6)                                 0365 00459000
         L     @07,RSFAENT(,@07)                                   0365 00460000
         L     @04,RSCD3FAE(,REG6)                                 0365 00461000
         CLC   SNVOLSER(6,@07),SNVOLSER(@04)                       0365 00462000
         BNE   @RF00365                                            0365 00463000
         CLC   SDSDIRSN(2,@07),SDSDIRSN(@04)                       0365 00464000
         BNE   @RF00365                                            0365 00465000
*                      DO;                                         0366 00466000
*                        SNFPROC = ON; /*VGO PROCESSED               */ 00467000
         OI    SNFPROC(@07),B'00010000'                            0367 00468000
*                        IF (SNTTNNC ^= 0) THEN                    0368 00469000
         CLI   SNTTNNC(@07),0                                      0368 00470000
         BE    @RF00368                                            0368 00471000
*                          DO RSCDINDX = 1 TO SNTTNNC; /*ALL EXTENTS */ 00472000
         LA    @07,1                                               0369 00473000
         B     @DE00369                                            0369 00474000
@DL00369 DS    0H                                                  0370 00475000
*                            RSCDSUMT = RSCDSUMT +                 0370 00476000
*                                       SNTT(SNTTNNX + RSCDINDX - 1);   00477000
         L     @07,RSWASNVT(,REG6)                                 0370 00478000
         L     @04,RSFAENT(,@07)                                   0370 00479000
         SLR   @15,@15                                             0370 00480000
         IC    @15,SNTTNNX(,@04)                                   0370 00481000
         AH    @15,RSCDINDX(,REG6)                                 0370 00482000
         SLA   @15,2                                               0370 00483000
         L     @07,RSFATTNN(,@07)                                  0370 00484000
         AL    @07,@CF03560                                        0370 00485000
         LH    @07,SNTT(@15,@07)                                   0370 00486000
         AL    @07,RSCDSUMT(,REG6)                                 0370 00487000
         ST    @07,RSCDSUMT(,REG6)                                 0370 00488000
*                          END;                                    0371 00489000
         LA    @07,1                                               0371 00490000
         AH    @07,RSCDINDX(,REG6)                                 0371 00491000
@DE00369 STH   @07,RSCDINDX(,REG6)                                 0371 00492000
         L     @04,RSWASNVT(,REG6)                                 0371 00493000
         L     @04,RSFAENT(,@04)                                   0371 00494000
         SLR   @15,@15                                             0371 00495000
         IC    @15,SNTTNNC(,@04)                                   0371 00496000
         CR    @07,@15                                             0371 00497000
         BNH   @DL00369                                            0371 00498000
*                      END;                                        0372 00499000
@RF00368 DS    0H                                                  0373 00500000
*                    RSFAENT = RSFAENT + RSFENTLN; /*NEXT VGO        */ 00501000
@RF00365 L     @07,RSWASNVT(,REG6)                                 0373 00502000
         SLR   @04,@04                                             0373 00503000
         IC    @04,RSFENTLN(,@07)                                  0373 00504000
         AL    @04,RSFAENT(,@07)                                   0373 00505000
         ST    @04,RSFAENT(,@07)                                   0373 00506000
*                  END;                                            0374 00507000
         L     @04,RSWASNVT(,REG6)                                 0374 00508000
         LA    @07,1                                               0374 00509000
         AH    @07,RSFCNDX(,@04)                                   0374 00510000
         L     @04,RSWASNVT(,REG6)                                 0374 00511000
         STH   @07,RSFCNDX(,@04)                                   0374 00512000
@DE00364 L     @04,RSWASNVT(,REG6)                                 0374 00513000
         CH    @07,RSFHNDX(,@04)                                   0374 00514000
         BNH   @DL00364                                            0374 00515000
*                  RSFAENT = RSCD3FAE; /*RESTORE INIT VGO ADDR       */ 00516000
         L     @07,RSWASNVT(,REG6)                                 0375 00517000
         L     @04,RSCD3FAE(,REG6)                                 0375 00518000
         ST    @04,RSFAENT(,@07)                                   0375 00519000
*                  RSFCNDX = RSCD3FCN; /*RESTORE INIT VGO INDEX      */ 00520000
*                                                                  0376 00521000
         LH    @15,RSCD3FCN(,REG6)                                 0376 00522000
         STH   @15,RSFCNDX(,@07)                                   0376 00523000
*        /************************************************************/ 00524000
*        /*                                                          */ 00525000
*        /*       SUMTT - IF ERROR ISSUE WARNING MESSAGE             */ 00526000
*        /*                                                          */ 00527000
*        /************************************************************/ 00528000
*                                                                  0377 00529000
*                  IF RSCDSUMT ^= SDSSUMTT THEN                    0377 00530000
*                                                                  0377 00531000
         L     @07,RSCDSNT8(,REG6)                                 0377 00532000
         L     @07,RSFAENT(,@07)                                   0377 00533000
         L     @15,RSCDSUMT(,REG6)                                 0377 00534000
         SLR   @14,@14                                             0377 00535000
         ICM   @14,7,SDSSUMTT(@07)                                 0377 00536000
         CR    @15,@14                                             0377 00537000
         BE    @RF00377                                            0377 00538000
*                    DO;                                           0378 00539000
*                    /*CALL CKERR*/                                0379 00540000
*                      RSCKERR = RSCKERR && RSCKERR;               0379 00541000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0379 00542000
*                      RSCKERN = RSE049;                           0380 00543000
         MVC   RSCKERN(2,REG6),@CH00983                            0380 00544000
*                      RSCKTERM = 'RETU';                          0381 00545000
         MVC   RSCKTERM(4,REG6),@CC03500                           0381 00546000
*                      RSCKMVAR(1) = ADDR(CNAME);                  0382 00547000
         L     @07,RSGRABCU(,REG6)                                 0382 00548000
         LA    @15,8                                               0382 00549000
         AL    @15,GRABCURR(,@07)                                  0382 00550000
         LA    @07,CNAME(,@15)                                     0382 00551000
         ST    @07,RSCKMVAR(,REG6)                                 0382 00552000
*                      RSCKMVAR(2) = ADDR(RCDID);                  0383 00553000
         LA    @07,RCDID(,@15)                                     0383 00554000
         ST    @07,RSCKMVAR+4(,REG6)                               0383 00555000
*                      RSCKMVAR(3) = ADDR(SNVOLSER);               0384 00556000
*                                                                  0384 00557000
         LA    @07,SNVOLSER(,@04)                                  0384 00558000
         ST    @07,RSCKMVAR+8(,REG6)                               0384 00559000
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR   */ 00560000
*                    CALL CKERR;                                   0385 00561000
         L     @15,@CV03443                                        0385 00562000
         BALR  @14,@15                                             0385 00563000
*                    END;                                          0386 00564000
*                END;                                              0387 00565000
@RF00377 DS    0H                                                  0388 00566000
*            END;                                                  0388 00567000
@RC00359 DS    0H                                                  0389 00568000
*        RFY SNDSDIR;        /*REVERT  */                          0389 00569000
*                                                                  0389 00570000
@RC00356 DS    0H                                                  0389 00571000
@RC00354 DS    0H                                                  0390 00572000
*        /************************************************************/ 00573000
*        /*                                                          */ 00574000
*        /*  UPDATE THE DSDIR FOR REASSIGNED CINS                    */ 00575000
*        /*                                                          */ 00576000
*        /************************************************************/ 00577000
*                                                                  0390 00578000
*        GRABCURR = RSCDDIR;           /*DATA OR INDEX               */ 00579000
         L     @07,RSGRABCU(,REG6)                                 0390 00580000
         L     @04,RSCDDIR(,REG6)                                  0390 00581000
         ST    @04,GRABCURR(,@07)                                  0390 00582000
*        IF RSASDSDI = ON THEN         /*DSDIR EXISTS                */ 00583000
         TM    RSASDSDI(REG6),B'01000000'                          0391 00584000
         BNO   @RF00391                                            0391 00585000
*          IF RSWRASCI = ON THEN                                   0392 00586000
         TM    RSWRASCI(@04),B'00000100'                           0392 00587000
         BNO   @RF00392                                            0392 00588000
*            DO;                                                   0393 00589000
*              RSWASNVT = RSCDSNT8;    /*DSDIR SNTAB                 */ 00590000
         L     @15,RSCDSNT8(,REG6)                                 0394 00591000
         ST    @15,RSWASNVT(,REG6)                                 0394 00592000
*              SDSIDNO = RABRCDA;      /*REASSIGNED CIN              */ 00593000
         L     @01,RSFAENT(,@15)                                   0395 00594000
         MVC   SDSIDNO(3,@01),RABRCDA+1(@04)                       0395 00595000
*              GRABBB = RSCDVOLR;      /*MODIFY VOLUME RECORD        */ 00596000
         L     @04,RSCDVOLR(,REG6)                                 0396 00597000
         ST    @04,GRABBB(,@07)                                    0396 00598000
*              /* CALL TO MODULE IDCRS04 FOR PROCEDURE MODGO         */ 00599000
*              CALL MODGO;                                         0397 00600000
         L     @15,@CV03433                                        0397 00601000
         BALR  @14,@15                                             0397 00602000
*            END;                                                  0398 00603000
*                                                                  0398 00604000
*        /************************************************************/ 00605000
*        /*                                                          */ 00606000
*        /*  RESTORE THE CALLER'S ENVIRONMENT                        */ 00607000
*        /*                                                          */ 00608000
*        /************************************************************/ 00609000
*                                                                  0399 00610000
*        RSCDSNT8->RSFAENT = RSCD8FAE;                             0399 00611000
@RF00392 DS    0H                                                  0399 00612000
@RF00391 L     @07,RSCDSNT8(,REG6)                                 0399 00613000
         L     @04,RSCD8FAE(,REG6)                                 0399 00614000
         ST    @04,RSFAENT(,@07)                                   0399 00615000
*        RSCDSNT8->RSFCNDX = RSCD8FCN;                             0400 00616000
         LH    @04,RSCD8FCN(,REG6)                                 0400 00617000
         STH   @04,RSFCNDX(,@07)                                   0400 00618000
*        RSCDSNT3->RSFAENT = RSCD3FAE;                             0401 00619000
         L     @07,RSCDSNT3(,REG6)                                 0401 00620000
         L     @04,RSCD3FAE(,REG6)                                 0401 00621000
         ST    @04,RSFAENT(,@07)                                   0401 00622000
*        RSCDSNT3->RSFCNDX = RSCD3FCN;                             0402 00623000
         LH    @04,RSCD3FCN(,REG6)                                 0402 00624000
         STH   @04,RSFCNDX(,@07)                                   0402 00625000
*        RSWASNVT = RSCDSNT3;          /*ACTIVE SN TABLE = VGOS      */ 00626000
*                                                                  0403 00627000
         ST    @07,RSWASNVT(,REG6)                                 0403 00628000
* CALL EXIT;  /*TERMINATE*/                                        0404 00629000
         BAL   @14,EXIT                                            0404 00630000
* END CHKDSDIR; /*END OF PROCEDURE*/                               0405 00631000
@EL00004 DS    0H                                                  0405 00632000
@EF00004 DS    0H                                                  0405 00633000
@ER00004 BR    @14                                                 0405 00634000
@PB00004 DS    0H                                                  0406 00635000
*/********************************************************************/ 00636000
*/*                                                                  */ 00637000
*/* PROCEDURE - CHKUNQ                                               */ 00638000
*/*                                                                  */ 00639000
*/* FUNCTION -                                                       */ 00640000
*/*     CHECK REQUESTS FOR UNIQUE DATA SPACES.                       */ 00641000
*/*                                                                  */ 00642000
*/* INPUT -                                                          */ 00643000
*/*     RSPVSNT3 - VGO SNTAB                                         */ 00644000
*/*       RSFAENT - VGO FOR THIS DATA SPACE.                         */ 00645000
*/*     RSPVSNT8 - DATA SPACE SNTAB                                  */ 00646000
*/*       RSFAENT - SPACE HEADER FOR THIS VGO                        */ 00647000
*/*     GRABRAB1->VOLUME RECORD BUFFER                               */ 00648000
*/*     GRABRAB2->DATA OR INDEX                                      */ 00649000
*/*     VOLSRSER - VOLUME SERIAL NUMBER                              */ 00650000
*/*                                                                  */ 00651000
*/* OUTPUT -                                                         */ 00652000
*/*     RSPVDELT - ON=DELETE THE DSDIR FOR THE VGO                   */ 00653000
*/*     RSMUNUS - ON=MARK THE VGO UNUSABLE                           */ 00654000
*/*                                                                  */ 00655000
*/* MESSAGES -                                                       */ 00656000
*/*     IDC11031I - UNIQUE DATA OR INDEX HAS FEWER EXTENTS THAN ITS  */ 00657000
*/*                 DATA SPACE.                                      */ 00658000
*/*     IDC11033I - UNIQUE DATA OR INDEX DOES NOT MATCH AND IS NOT   */ 00659000
*/*                 A SUBSET OF ITS DATA SPACE.                      */ 00660000
*/*                                                                  */ 00661000
*/********************************************************************/ 00662000
*      GENERATE;                                                   0406 00663000
         DS    0F                                                       00664000
NAME0013 DC    CL8'CHKUNQ'                                              00665000
*CHKUNQ: PROCEDURE                                                 0407 00666000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0407 00667000
*                                                                  0407 00668000
         B     @PB00005                                            0407 00669000
CHKUNQ   DS    0H                                                  0408 00670000
*      GENERATE REFS(RS03RG08, REG6);                              0408 00671000
*                                                                  0408 00672000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          00673000
         LR    @15,@13  OLD SAVE AREA                                   00674000
         LA    @13,72(@13)  NEW SAVE AREA                               00675000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     00676000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        00677000
         MVC   0(4,@15),NAME0013  PROCNAME TO REGSAVE                   00678000
*        RFY SNTTNN BASED(RSSETTT);    /*TTNN FOR VGO                */ 00679000
*        RFY SNTAB BASED(RSPVSNT6->RSFAENT); /*SNTAB FOR SPC HDR     */ 00680000
*        RFY SNVGO BASED(RSPVSNT3->RSFAENT); /*VGO SN TABLE ENTRY    */ 00681000
*        RFY RSFSNVT BASED(RSPVSNT3); /*USE VGO VECTOR TABLE         */ 00682000
*                                                                  0412 00683000
*        /************************************************************/ 00684000
*        /*                                                          */ 00685000
*        /*  CHECK VGO EXTENTS FOR THIS VOLSER-DSDIR AGAINST         */ 00686000
*        /*  THE DATA SPACE EXTENTS.                                 */ 00687000
*        /*                                                          */ 00688000
*        /************************************************************/ 00689000
*                                                                  0413 00690000
*        RSCSFCN = RSFCNDX;            /*SAVE 1ST VGO INDEX SNTAB    */ 00691000
         L     @07,RSPVSNT3(,REG6)                                 0413 00692000
         LH    @04,RSFCNDX(,@07)                                   0413 00693000
         STH   @04,RSCSFCN(,REG6)                                  0413 00694000
*        RSCSFAE = RSFAENT;            /*SAVE 1ST VGO SNTAB ADDR     */ 00695000
         L     @07,RSFAENT(,@07)                                   0414 00696000
         ST    @07,RSCSFAE(,REG6)                                  0414 00697000
*        RSPVKNEX = 1;                 /*START AT FIRST EXTENT       */ 00698000
*                                                                  0415 00699000
         MVC   RSPVKNEX(2,REG6),@CH00212                           0415 00700000
*        DO RSFCNDX = RSFCNDX TO RSFHNDX WHILE(RSPVDELT=OFF);      0416 00701000
         B     @DE00416                                            0416 00702000
@DL00416 TM    RSPVDELT(REG6),B'00100000'                          0416 00703000
         BNZ   @DC00416                                            0416 00704000
*          RSFAENT = RSFCADR + RSFENTLN*(RSFCNDX - 1);             0417 00705000
         L     @07,RSPVSNT3(,REG6)                                 0417 00706000
         LH    @04,RSFCNDX(,@07)                                   0417 00707000
         BCTR  @04,0                                               0417 00708000
         LR    @01,@04                                             0417 00709000
         SLR   @04,@04                                             0417 00710000
         IC    @04,RSFENTLN(,@07)                                  0417 00711000
         MR    @00,@04                                             0417 00712000
         AL    @01,RSFCADR(,@07)                                   0417 00713000
         ST    @01,RSFAENT(,@07)                                   0417 00714000
*          IF (SNVOLSER = RSCSFAE->SNVOLSER) &                     0418 00715000
*             (SDSDIRSN = RSCSFAE->SDSDIRSN) THEN                  0418 00716000
         L     @04,RSCSFAE(,REG6)                                  0418 00717000
         CLC   SNVOLSER(6,@01),SNVOLSER(@04)                       0418 00718000
         BNE   @RF00418                                            0418 00719000
         CLC   SDSDIRSN(2,@01),SDSDIRSN(@04)                       0418 00720000
         BNE   @RF00418                                            0418 00721000
*                                      /*MATCH VGO (VOLSER-DSDIR)    */ 00722000
*            DO;                                                   0419 00723000
*              RSSETTT = RSFATTNN + (SNTTNNX - 1)*LENGTH(SNTTNN);  0420 00724000
         SLR   @04,@04                                             0420 00725000
         IC    @04,SNTTNNX(,@01)                                   0420 00726000
         BCTR  @04,0                                               0420 00727000
         SLA   @04,2                                               0420 00728000
         AL    @04,RSFATTNN(,@07)                                  0420 00729000
         ST    @04,RSSETTT(,REG6)                                  0420 00730000
*                                      /*FIRST ESTENT FOR THIS VGO   */ 00731000
*              IF SNTTNNC = 0 THEN;    /*NO EXTENT FOR THIS VGO      */ 00732000
         CLI   SNTTNNC(@01),0                                      0421 00733000
         BE    @RT00421                                            0421 00734000
*              ELSE                                                0423 00735000
*                DO RSPVTNEX = 1 TO SNTTNNC WHILE(RSPVDELT=OFF);   0423 00736000
         LA    @07,1                                               0423 00737000
         B     @DE00423                                            0423 00738000
@DL00423 TM    RSPVDELT(REG6),B'00100000'                          0423 00739000
         BNZ   @DC00423                                            0423 00740000
*                  IF SNTTNN(RSPVTNEX) ^= SSPEXTNN(RSPVKNEX) THEN  0424 00741000
         LH    @07,RSPVTNEX(,REG6)                                 0424 00742000
         SLA   @07,2                                               0424 00743000
         L     @04,RSSETTT(,REG6)                                  0424 00744000
         LH    @15,RSPVKNEX(,REG6)                                 0424 00745000
         SLA   @15,2                                               0424 00746000
         L     @01,RSPVSNT6(,REG6)                                 0424 00747000
         L     @01,RSFAENT(,@01)                                   0424 00748000
         ALR   @04,@07                                             0424 00749000
         AL    @04,@CF03727                                        0424 00750000
         ALR   @01,@15                                             0424 00751000
         CLC   SNTTNN(4,@04),SSPEXTNN-4(@01)                       0424 00752000
         BE    @RF00424                                            0424 00753000
*                    DO;               /*VGO - SPC HDR MISMATCH      */ 00754000
*                      RSPVDELT = ON;  /*DELETE THE DSDIR            */ 00755000
         OI    RSPVDELT(REG6),B'00100000'                          0426 00756000
*                      RSMUNUS = ON;   /*MARK THE VGO UNUSABLE       */ 00757000
         OI    RSMUNUS(REG6),B'10000000'                           0427 00758000
*                    END;                                          0428 00759000
*                  RSPVKNEX = RSPVKNEX + 1; /*NEXT SPC HDR EXTNT     */ 00760000
@RF00424 LA    @07,1                                               0429 00761000
         AH    @07,RSPVKNEX(,REG6)                                 0429 00762000
         STH   @07,RSPVKNEX(,REG6)                                 0429 00763000
*                END;                                              0430 00764000
         LA    @07,1                                               0430 00765000
         AH    @07,RSPVTNEX(,REG6)                                 0430 00766000
@DE00423 STH   @07,RSPVTNEX(,REG6)                                 0430 00767000
         L     @04,RSPVSNT3(,REG6)                                 0430 00768000
         L     @04,RSFAENT(,@04)                                   0430 00769000
         SLR   @15,@15                                             0430 00770000
         IC    @15,SNTTNNC(,@04)                                   0430 00771000
         CR    @07,@15                                             0430 00772000
         BNH   @DL00423                                            0430 00773000
@DC00423 DS    0H                                                  0431 00774000
*            END;                                                  0431 00775000
@RT00421 DS    0H                                                  0432 00776000
*        END;                                                      0432 00777000
*                                                                  0432 00778000
@RF00418 L     @07,RSPVSNT3(,REG6)                                 0432 00779000
         LA    @04,1                                               0432 00780000
         AH    @04,RSFCNDX(,@07)                                   0432 00781000
         L     @07,RSPVSNT3(,REG6)                                 0432 00782000
         STH   @04,RSFCNDX(,@07)                                   0432 00783000
@DE00416 L     @07,RSPVSNT3(,REG6)                                 0432 00784000
         CH    @04,RSFHNDX(,@07)                                   0432 00785000
         BNH   @DL00416                                            0432 00786000
@DC00416 DS    0H                                                  0433 00787000
*        /************************************************************/ 00788000
*        /*                                                          */ 00789000
*        /*  UNIQUE DATA OR INDEX - VGO NOT A SUBSET OF DATA SPACE   */ 00790000
*        /*                                                          */ 00791000
*        /************************************************************/ 00792000
*                                                                  0433 00793000
*        IF RSPVDELT = ON THEN                                     0433 00794000
*                                                                  0433 00795000
         TM    RSPVDELT(REG6),B'00100000'                          0433 00796000
         BNO   @RF00433                                            0433 00797000
*          DO;                                                     0434 00798000
*          /*CALL CKERR*/                                          0435 00799000
*            RSCKERR = RSCKERR && RSCKERR;                         0435 00800000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0435 00801000
*            RSCKERN = RSE044;                                     0436 00802000
         MVC   RSCKERN(2,REG6),@CH00595                            0436 00803000
*            RSCKTERM = 'RETU';                                    0437 00804000
         MVC   RSCKTERM(4,REG6),@CC03500                           0437 00805000
*            RSCKMVAR(1) = ADDR(ADDR(GRABRAB2->RABBUF)->CNAME);    0438 00806000
         L     @07,RSGRABCU(,REG6)                                 0438 00807000
         L     @07,GRABRAB2(,@07)                                  0438 00808000
         LA    @07,CNAME+8(,@07)                                   0438 00809000
         ST    @07,RSCKMVAR(,REG6)                                 0438 00810000
*            RSCKMVAR(2) = ADDR(VOLSRSER);                         0439 00811000
*                                                                  0439 00812000
         L     @07,RSVTBENT(,REG6)                                 0439 00813000
         LA    @07,VOLSRSER(,@07)                                  0439 00814000
         ST    @07,RSCKMVAR+4(,REG6)                               0439 00815000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */ 00816000
*          CALL CKERR;                                             0440 00817000
         L     @15,@CV03443                                        0440 00818000
         BALR  @14,@15                                             0440 00819000
*          END;                                                    0441 00820000
*                                                                  0441 00821000
*        /************************************************************/ 00822000
*        /*                                                          */ 00823000
*        /*  CHECK FOR ADDITIONAL EXTENTS IN THE DATA SPACE          */ 00824000
*        /*                                                          */ 00825000
*        /************************************************************/ 00826000
*                                                                  0442 00827000
*        ELSE                                                      0442 00828000
*          IF RSPVKNEX =< SNODSPXT THEN                            0442 00829000
         B     @RC00433                                            0442 00830000
@RF00433 L     @07,RSPVSNT6(,REG6)                                 0442 00831000
         L     @07,RSFAENT(,@07)                                   0442 00832000
         LH    @04,RSPVKNEX(,REG6)                                 0442 00833000
         SLR   @15,@15                                             0442 00834000
         IC    @15,SNODSPXT(,@07)                                  0442 00835000
         CR    @04,@15                                             0442 00836000
         BH    @RF00442                                            0442 00837000
*                                      /*D-I SMALLER THAN SPC HDR    */ 00838000
*                                                                  0443 00839000
*            DO;                                                   0443 00840000
*            /*CALL CKERR*/                                        0444 00841000
*              RSCKERR = RSCKERR && RSCKERR;                       0444 00842000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0444 00843000
*              RSCKERN = RSE034;                                   0445 00844000
         MVC   RSCKERN(2,REG6),@CH00956                            0445 00845000
*              RSCKTERM = 'RETU';                                  0446 00846000
         MVC   RSCKTERM(4,REG6),@CC03500                           0446 00847000
*              RSCKMVAR(1) = ADDR(ADDR(GRABRAB2->RABBUF)->CNAME);  0447 00848000
*                                                                  0447 00849000
         L     @07,RSGRABCU(,REG6)                                 0447 00850000
         L     @07,GRABRAB2(,@07)                                  0447 00851000
         LA    @07,CNAME+8(,@07)                                   0447 00852000
         ST    @07,RSCKMVAR(,REG6)                                 0447 00853000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 00854000
*            CALL CKERR;                                           0448 00855000
         L     @15,@CV03443                                        0448 00856000
         BALR  @14,@15                                             0448 00857000
*            END;                                                  0449 00858000
*                                                                  0449 00859000
*        /************************************************************/ 00860000
*        /*                                                          */ 00861000
*        /*                       TERMINATE                          */ 00862000
*        /*                                                          */ 00863000
*        /************************************************************/ 00864000
*                                                                  0450 00865000
*        RSFAENT = RSCSFAE;            /*RESTORE 1ST VGO SNTAB       */ 00866000
@RF00442 DS    0H                                                  0450 00867000
@RC00433 L     @07,RSPVSNT3(,REG6)                                 0450 00868000
         L     @04,RSCSFAE(,REG6)                                  0450 00869000
         ST    @04,RSFAENT(,@07)                                   0450 00870000
*        RSFCNDX = RSCSFCN;                                        0451 00871000
         LH    @04,RSCSFCN(,REG6)                                  0451 00872000
         STH   @04,RSFCNDX(,@07)                                   0451 00873000
*        RFY SNTTNN;                   /*REVERT                      */ 00874000
*        RFY SNVGO;                    /*REVERT                      */ 00875000
*        RFY SNTAB;                    /*REVERT                      */ 00876000
*        RFY RSFSNVT;                  /*REVERT                      */ 00877000
*                                                                  0455 00878000
* CALL EXIT;  /*TERMINATE*/                                        0456 00879000
         BAL   @14,EXIT                                            0456 00880000
* END CHKUNQ; /*END OF PROCEDURE*/                                 0457 00881000
@EL00005 DS    0H                                                  0457 00882000
@EF00005 DS    0H                                                  0457 00883000
@ER00005 BR    @14                                                 0457 00884000
@PB00005 DS    0H                                                  0458 00885000
*/********************************************************************/ 00886000
*/*                                                                  */ 00887000
*/* PROCEDURE NAME - GETFIT                                          */ 00888000
*/*                                                                  */ 00889000
*/* FUNCTION -                                                       */ 00890000
*/*    GETFIT GETS THE NEXT FREE ENTRY IN A TABLE. IF NO FREE ENTRIES*/ 00891000
*/*    EXIST IN THE CURRENT TABLE OR NO TABLE EXISTS A NEW TABLE     */ 00892000
*/*    WILL BE GOTTEN.                                               */ 00893000
*/*                                                                  */ 00894000
*/*    EACH TABLE TYPE MUST HAVE A SET OF ANCHORS AS DESCRIBED BY    */ 00895000
*/*    BY TABANCHR; EACH TABLE MUST HAVE A HEAD DESCRIBED BY         */ 00896000
*/*    TABHEAD; EACH ENTRY MUST HAVE THE COMMON DATA DESCRIBED       */ 00897000
*/*    BY TABENT.                                                    */ 00898000
*/*                                                                  */ 00899000
*/* INPUT -                                                          */ 00900000
*/*    RSTAB - THIS STRUCTURE CONTAINS THE PRIMARY INTERFACE DATA.   */ 00901000
*/*      RSTANCHR - ADDRESS OF ANCHOR ADDRESSES MAPPED BY TABANCHR.  */ 00902000
*/*                 WITHIN TABANCHR, TABEN DESCRIBES THE LENGTH OF   */ 00903000
*/*                 EACH ENTRY IN THE TABLE. TABC DESCRIBES          */ 00904000
*/*                 THE LAST TABLE ALLOCATED FROM.                   */ 00905000
*/*                 ALL CONTROL BLOCKS GOTTEN MUST HAVE THIS COMMON  */ 00906000
*/*                 ANCHOR STRUCTURE.                                */ 00907000
*/*    TABHEAD - THIS DESCRIBES THE COMMON HEAD PORTION OF EACH      */ 00908000
*/*              TABLE.                                              */ 00909000
*/*                                                                  */ 00910000
*/* OUTPUT -                                                         */ 00911000
*/*    RSTENTAD - ADDRESS OF THE NEXT FREE ENTRY.                    */ 00912000
*/*    TABCURR - INDEX OF THE FREE ENTRY ALLOCATED                   */ 00913000
*/*                                                                  */ 00914000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 00915000
*/*                                                                  */ 00916000
*/********************************************************************/ 00917000
*      GENERATE;                                                   0458 00918000
         DS    0F                                                       00919000
NAME0019 DC    CL8'GETFIT'                                              00920000
*GETFIT: PROCEDURE                                                 0459 00921000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0459 00922000
*                                                                  0459 00923000
         B     @PB00006                                            0459 00924000
GETFIT   DS    0H                                                  0460 00925000
*      GENERATE REFS(RS03RG08, REG6);                              0460 00926000
*                                                                  0460 00927000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          00928000
         LR    @15,@13  OLD SAVE AREA                                   00929000
         LA    @13,72(@13)  NEW SAVE AREA                               00930000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     00931000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        00932000
         ENTRY GETFIT  ENTRY POINT                                      00933000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         00934000
         MVC   0(4,@15),NAME0019  PROCNAME TO REGSAVE                   00935000
*         OLDERID2 = NEWERID2;                                     0461 00936000
         L     @07,GDTTR2(,REG5)                                   0461 00937000
         MVC   @TS00001(95),NEWERID2(@07)                          0461 00938000
         MVC   OLDERID2(95,@07),@TS00001                           0461 00939000
*         NEWID2 = 'RSGF';                                         0462 00940000
*                                                                  0462 00941000
         MVC   NEWID2(4,@07),@CC03515                              0462 00942000
*        /************************************************************/ 00943000
*        /*                                                          */ 00944000
*        /* NO TABLE EXISTS OR NO MORE ENTRIES IN THE CURRENT TABLE. */ 00945000
*        /* GET A TABLE AND INITIALIZE IT                            */ 00946000
*        /*                                                          */ 00947000
*        /************************************************************/ 00948000
*                                                                  0463 00949000
*        IF TABC=0 | TABCURR=TABMAXT THEN                          0463 00950000
         L     @07,RSTANCHR(,REG6)                                 0463 00951000
         L     @07,TABC(,@07)                                      0463 00952000
         LTR   @07,@07                                             0463 00953000
         BZ    @RT00463                                            0463 00954000
         CLC   TABCURR(2,@07),TABMAXT(@07)                         0463 00955000
         BNE   @RF00463                                            0463 00956000
@RT00463 DS    0H                                                  0464 00957000
*          DO;                                                     0464 00958000
*                                                                  0464 00959000
*            /* GET A NEW TABLE */                                 0465 00960000
*            CALL GETTAB;                                          0465 00961000
*                                                                  0465 00962000
         BAL   @14,GETTAB                                          0465 00963000
*            TABCURR = 1;                                          0466 00964000
         L     @07,RSTANCHR(,REG6)                                 0466 00965000
         L     @04,TABC(,@07)                                      0466 00966000
         MVC   TABCURR(2,@04),@CH00212                             0466 00967000
*            TABMAXT = (TABSIZ-LENGTH(THEAD))/TABEN;               0467 00968000
         L     @15,TABSIZ(,@07)                                    0467 00969000
         SL    @15,@CF00032                                        0467 00970000
         LR    @00,@15                                             0467 00971000
         SRDA  @00,32                                              0467 00972000
         LH    @07,TABEN(,@07)                                     0467 00973000
         DR    @00,@07                                             0467 00974000
         STH   @01,TABMAXT(,@04)                                   0467 00975000
*          END;                                                    0468 00976000
*                                                                  0468 00977000
*        /************************************************************/ 00978000
*        /*                                                          */ 00979000
*        /* TABLE ALREADY EXISTS - GET THE NEXT ENTRY                */ 00980000
*        /*                                                          */ 00981000
*        /************************************************************/ 00982000
*                                                                  0469 00983000
*        ELSE                                                      0469 00984000
*          TABCURR = TABCURR + 1;      /*NEXT FREE ENTRY             */ 00985000
*                                                                  0469 00986000
         B     @RC00463                                            0469 00987000
@RF00463 L     @07,RSTANCHR(,REG6)                                 0469 00988000
         L     @07,TABC(,@07)                                      0469 00989000
         LA    @04,1                                               0469 00990000
         AH    @04,TABCURR(,@07)                                   0469 00991000
         STH   @04,TABCURR(,@07)                                   0469 00992000
*        /************************************************************/ 00993000
*        /*                                                          */ 00994000
*        /* AN ENTRY IS AVAILABLE SO SET UP THE ADDRESS AND TURN IT  */ 00995000
*        /* LOOSE.                                                   */ 00996000
*        /*                                                          */ 00997000
*        /************************************************************/ 00998000
*                                                                  0470 00999000
*        RSTENTAD = ADDR(TENTRY)+(TABCURR-1)*TABEN;                0470 01000000
@RC00463 L     @07,RSTANCHR(,REG6)                                 0470 01001000
         L     @04,TABC(,@07)                                      0470 01002000
         LA    @15,TENTRY(,@04)                                    0470 01003000
         LH    @01,TABCURR(,@04)                                   0470 01004000
         BCTR  @01,0                                               0470 01005000
         MH    @01,TABEN(,@07)                                     0470 01006000
         ALR   @15,@01                                             0470 01007000
         ST    @15,RSTENTAD(,REG6)                                 0470 01008000
*        TABNU = TABNU + 1;            /*TOTAL NUMBER OF ENTRIES USED*/ 01009000
*                                                                  0471 01010000
         LA    @04,1                                               0471 01011000
         L     @15,TABNU-1(,@07)                                   0471 01012000
         LA    @15,0(,@15)                                         0471 01013000
         ALR   @04,@15                                             0471 01014000
         STCM  @04,7,TABNU(@07)                                    0471 01015000
*  CALL EXIT;  /*TERMINATE*/                                       0472 01016000
         BAL   @14,EXIT                                            0472 01017000
*  END GETFIT; /*END OF PROCEDURE*/                                0473 01018000
@EL00006 DS    0H                                                  0473 01019000
@EF00006 DS    0H                                                  0473 01020000
@ER00006 BR    @14                                                 0473 01021000
@PB00006 DS    0H                                                  0474 01022000
*/********************************************************************/ 01023000
*/*                                                                  */ 01024000
*/* PROCEDURE NAME - GETNEXTE                                        */ 01025000
*/*                                                                  */ 01026000
*/* FUNCTION -                                                       */ 01027000
*/*    GETNEXTE GETS THE NEXT ENTRY IN A TABLE.                      */ 01028000
*/*    EACH TABLE TYPE MUST HAVE A SET OF ANCHORS AS DESCRIBED BY    */ 01029000
*/*    BY TABANCHR; EACH TABLE MUST HAVE A HEAD DESCRIBED BY         */ 01030000
*/*    TABHEAD.                                                      */ 01031000
*/*                                                                  */ 01032000
*/* INPUT -                                                          */ 01033000
*/*    RSTAB - THIS STRUCTURE CONTAINS THE PRIMARY INTERFACE DATA.   */ 01034000
*/*      RSTANCHR - ADDRESS OF ANCHOR ADDRESSES MAPPED BY TABANCHR.  */ 01035000
*/*                 WITHIN TABANCHR, TABEN DESCRIBES THE LENGTH OF   */ 01036000
*/*                 EACH ENTRY IN THE TABLE.                         */ 01037000
*/*                 ALL CONTROL BLOCKS GOTTEN MUST HAVE THIS COMMON  */ 01038000
*/*                 ANCHOR STRUCTURE.                                */ 01039000
*/*      RSTENTAD - ADDRESS OF THE CURRENT ENTRY                     */ 01040000
*/*      RSTENTIX - INDEX OF ENTRY IN ENTIRE TABLE(S)                */ 01041000
*/*                                                                  */ 01042000
*/* OUTPUT -                                                         */ 01043000
*/*    RSTENTAD - ADDRESS OF THE ENTRY RETURNED.                     */ 01044000
*/*    RSTABAD  - ADDRESS OF THE TABLE WITH ENTRY ALLOCATED          */ 01045000
*/*    RSTWKIX  - INDEX OF ENTRY IN TABLE ALLOCATED                  */ 01046000
*/*                                                                  */ 01047000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 01048000
*/*                                                                  */ 01049000
*/********************************************************************/ 01050000
*      GENERATE;                                                   0474 01051000
         DS    0F                                                       01052000
NAME0022 DC    CL8'GETNEXTE'                                            01053000
*GETNEXTE: PROCEDURE                                               0475 01054000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0475 01055000
*                                                                  0475 01056000
         B     @PB00007                                            0475 01057000
GETNEXTE DS    0H                                                  0476 01058000
*      GENERATE REFS(RS03RG08, REG6);                              0476 01059000
*                                                                  0476 01060000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          01061000
         LR    @15,@13  OLD SAVE AREA                                   01062000
         LA    @13,72(@13)  NEW SAVE AREA                               01063000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     01064000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        01065000
         ENTRY GETNEXTE  ENTRY POINT                                    01066000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         01067000
         MVC   0(4,@15),NAME0022  PROCNAME TO REGSAVE                   01068000
*         OLDERID2 = NEWERID2;                                     0477 01069000
         L     @07,GDTTR2(,REG5)                                   0477 01070000
         MVC   @TS00001(95),NEWERID2(@07)                          0477 01071000
         MVC   OLDERID2(95,@07),@TS00001                           0477 01072000
*         NEWID2 = 'RSGN';                                         0478 01073000
*                                                                  0478 01074000
         MVC   NEWID2(4,@07),@CC03521                              0478 01075000
*        /************************************************************/ 01076000
*        /*                                                          */ 01077000
*        /* DETERMINE WHICH TABLE THE ENTRY IS IN                    */ 01078000
*        /*                                                          */ 01079000
*        /************************************************************/ 01080000
*                                                                  0479 01081000
*        RFY TABHEAD BASED(RSTABAD);                               0479 01082000
*        RSTABAD = TABF;               /*ORIENT TO FIRST TABLE       */ 01083000
         L     @07,RSTANCHR(,REG6)                                 0480 01084000
         L     @07,TABF(,@07)                                      0480 01085000
         ST    @07,RSTABAD(,REG6)                                  0480 01086000
*        RSTWKIX = RSTENTIX;           /*CALLER'S ABSOLUTE ENTRY NUM */ 01087000
         MVC   RSTWKIX(3,REG6),RSTENTIX(REG6)                      0481 01088000
*        DO WHILE(RSTWKIX>TABMAXT);    /*SCAN FOR TABLE              */ 01089000
         B     @DE00482                                            0482 01090000
@DL00482 DS    0H                                                  0483 01091000
*          RSTWKIX = RSTWKIX - TABMAXT; /*ENTRY RELATIVE TO NEW TBL  */ 01092000
         L     @07,RSTABAD(,REG6)                                  0483 01093000
         L     @04,RSTWKIX-1(,REG6)                                0483 01094000
         LA    @04,0(,@04)                                         0483 01095000
         SH    @04,TABMAXT(,@07)                                   0483 01096000
         STCM  @04,7,RSTWKIX(REG6)                                 0483 01097000
*          RSTABAD = TABFORW;          /*GET NEXT TABLE              */ 01098000
         L     @07,TABFORW(,@07)                                   0484 01099000
         ST    @07,RSTABAD(,REG6)                                  0484 01100000
*        END;                                                      0485 01101000
*                                                                  0485 01102000
@DE00482 L     @07,RSTWKIX-1(,REG6)                                0485 01103000
         LA    @07,0(,@07)                                         0485 01104000
         L     @04,RSTABAD(,REG6)                                  0485 01105000
         CH    @07,TABMAXT(,@04)                                   0485 01106000
         BH    @DL00482                                            0485 01107000
*        /************************************************************/ 01108000
*        /*                                                          */ 01109000
*        /* DETERMINE ADDRESS OF ENTRY WITHIN THIS TABLE             */ 01110000
*        /*                                                          */ 01111000
*        /************************************************************/ 01112000
*                                                                  0486 01113000
*        IF RSTWKIX > 0 THEN           /*IF NOT A FREE LAST CALL     */ 01114000
         LTR   @07,@07                                             0486 01115000
         BNP   @RF00486                                            0486 01116000
*          RSTENTAD=RSTABAD+LENGTH(THEAD)+((RSTWKIX-1)*TABEN);     0487 01117000
         AL    @04,@CF00032                                        0487 01118000
         LR    @01,@07                                             0487 01119000
         BCTR  @01,0                                               0487 01120000
         L     @07,RSTANCHR(,REG6)                                 0487 01121000
         MH    @01,TABEN(,@07)                                     0487 01122000
         ALR   @04,@01                                             0487 01123000
         ST    @04,RSTENTAD(,REG6)                                 0487 01124000
*        RFY TABHEAD;                  /*REVERT                      */ 01125000
*                                                                  0488 01126000
@RF00486 DS    0H                                                  0489 01127000
*  CALL EXIT;  /*TERMINATE*/                                       0489 01128000
         BAL   @14,EXIT                                            0489 01129000
*  END GETNEXTE; /*END OF PROCEDURE*/                              0490 01130000
@EL00007 DS    0H                                                  0490 01131000
@EF00007 DS    0H                                                  0490 01132000
@ER00007 BR    @14                                                 0490 01133000
@PB00007 DS    0H                                                  0491 01134000
*/********************************************************************/ 01135000
*/*                                                                  */ 01136000
*/* PROCEDURE NAME - GETTAB                                          */ 01137000
*/*                                                                  */ 01138000
*/* FUNCTION -                                                       */ 01139000
*/*    GETTAB GETS A NEW TABLE AND CHAINS IT TO THE PREVIOUS.        */ 01140000
*/*    GETTAB EXPECTS ALL TABLES TO HAVE A COMMON SET OF ANCHORS AS  */ 01141000
*/*    MAPPED BY TABANCHR AND EACH TABLE TO HAVE A COMMON HEAD       */ 01142000
*/*    PORTION AS MAPPED BY TABHEAD. THE TABLES ARE FORWARD AND      */ 01143000
*/*    BACKWARD CHAINED.                                             */ 01144000
*/*                                                                  */ 01145000
*/* INPUT -                                                          */ 01146000
*/*    RSTAB - THIS STRUCTURE CONTAINS THE PRIMARY INTERFACE DATA.   */ 01147000
*/*      RSTANCHR - ADDRESS OF ANCHOR ADDRESSES MAPPED BY TABHEAD.   */ 01148000
*/*                 ALL CONTROL BLOCKS GOTTEN BY GETTAB MUST HAVE    */ 01149000
*/*                 THIS COMMON ANCHOR STRUCTURE.                    */ 01150000
*/*                                                                  */ 01151000
*/* OUTPUT -                                                         */ 01152000
*/*    TABC - THE CURRENT CONTROL BLOCK ADDRESS IS UPDATED TO        */ 01153000
*/*           ADDRESS THE NEXT AVAILABLE ONE.                        */ 01154000
*/*                                                                  */ 01155000
*/* EXIT, NORMAL - RETURN TO CALLER                                  */ 01156000
*/* EXIT, ERROR - EXIT VIA CKERR                                     */ 01157000
*/*               RSE00 - STORAGE UNAVAILABLE                        */ 01158000
*/********************************************************************/ 01159000
*                                                                  0491 01160000
*      GENERATE;                                                   0491 01161000
         DS    0F                                                       01162000
NAME0024 DC    CL8'GETTAB'                                              01163000
*GETTAB: PROCEDURE                                                 0492 01164000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0492 01165000
*                                                                  0492 01166000
         B     @PB00008                                            0492 01167000
GETTAB   DS    0H                                                  0493 01168000
*      GENERATE REFS(RS03RG08, REG6);                              0493 01169000
*                                                                  0493 01170000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          01171000
         LR    @15,@13  OLD SAVE AREA                                   01172000
         LA    @13,72(@13)  NEW SAVE AREA                               01173000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     01174000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        01175000
         ENTRY GETTAB  ENTRY POINT                                      01176000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         01177000
         MVC   0(4,@15),NAME0024  PROCNAME TO REGSAVE                   01178000
*        OLDERID2 = NEWERID2;                                      0494 01179000
         L     @07,GDTTR2(,REG5)                                   0494 01180000
         MVC   @TS00001(95),NEWERID2(@07)                          0494 01181000
         MVC   OLDERID2(95,@07),@TS00001                           0494 01182000
*        NEWID2 = 'RSGT';                                          0495 01183000
*                                                                  0495 01184000
         MVC   NEWID2(4,@07),@CC03526                              0495 01185000
*        /************************************************************/ 01186000
*        /*                                                          */ 01187000
*        /* DETERMINE IF A NEW CONTROL BLOCK MUST BE GOTTEN.         */ 01188000
*        /*     IF NO CONTROL BLOCK EXISTS OF THIS TYPE OR           */ 01189000
*        /*     THIS IS THE LAST CONTROL BLOCK OF THIS TYPE          */ 01190000
*        /*     THEN GET A NEW ONE.                                  */ 01191000
*        /*                                                          */ 01192000
*        /************************************************************/ 01193000
*                                                                  0496 01194000
*        IF TABF = 0 | TABC = TABL THEN                            0496 01195000
         L     @07,RSTANCHR(,REG6)                                 0496 01196000
         L     @04,TABF(,@07)                                      0496 01197000
         LTR   @04,@04                                             0496 01198000
         BZ    @RT00496                                            0496 01199000
         CLC   TABC(4,@07),TABL(@07)                               0496 01200000
         BNE   @RF00496                                            0496 01201000
@RT00496 DS    0H                                                  0497 01202000
*          DO;                                                     0497 01203000
*                                                                  0497 01204000
*            /* GET THE TABLE */                                   0498 01205000
*            CALL IDCSAGP0(GDTTBL,TABSIZ,TABC,TABUG,SETZERO);      0498 01206000
*                                                                  0498 01207000
         ST    REG5,@AL00001                                       0498 01208000
         L     @07,RSTANCHR(,REG6)                                 0498 01209000
         LA    @04,TABSIZ(,@07)                                    0498 01210000
         ST    @04,@AL00001+4                                      0498 01211000
         LA    @04,TABC(,@07)                                      0498 01212000
         ST    @04,@AL00001+8                                      0498 01213000
         LA    @07,TABUG(,@07)                                     0498 01214000
         ST    @07,@AL00001+12                                     0498 01215000
         LA    @07,SETZERO                                         0498 01216000
         ST    @07,@AL00001+16                                     0498 01217000
         MVI   @AL00001+16,X'80'                                   0498 01218000
         L     @15,GDTGPL(,REG5)                                   0498 01219000
         LA    @01,@AL00001                                        0498 01220000
         BALR  @14,@15                                             0498 01221000
*            RESPECIFY RTNREG RSTD;                                0499 01222000
*            TESTRC = RTNREG;                                      0500 01223000
         STH   RTNREG,TESTRC(,REG6)                                0500 01224000
*            RESPECIFY RTNREG UNRSTD;                              0501 01225000
*            IF TESTRC ^= 0 THEN                                   0502 01226000
*                                                                  0502 01227000
         LH    @07,TESTRC(,REG6)                                   0502 01228000
         LTR   @07,@07                                             0502 01229000
         BZ    @RF00502                                            0502 01230000
*              /* TERMINATE - NO STORAGE AVAILABLE */              0503 01231000
*                                                                  0503 01232000
*              DO;                                                 0503 01233000
*              /*CALL CKERR*/                                      0504 01234000
*                RSCKERR = RSCKERR && RSCKERR;                     0504 01235000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0504 01236000
*                RSCKERN = RSE099;                                 0505 01237000
         MVC   RSCKERN(2,REG6),@CH01078                            0505 01238000
*                RSCKTERM = 'TERM';                                0506 01239000
*                                                                  0506 01240000
         MVC   RSCKTERM(4,REG6),@CC03527                           0506 01241000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */ 01242000
*              CALL CKERR;                                         0507 01243000
         L     @15,@CV03443                                        0507 01244000
         BALR  @14,@15                                             0507 01245000
*              END;                                                0508 01246000
*                                                                  0508 01247000
*        /************************************************************/ 01248000
*        /*                                                          */ 01249000
*        /* FORWARD AND BACKWARD CHAIN THIS NEW CONTROL BLOCK        */ 01250000
*        /*                                                          */ 01251000
*        /************************************************************/ 01252000
*                                                                  0509 01253000
*            IF TABF = 0 THEN          /*ALLOW FOR FIRST CTL BLOCK   */ 01254000
@RF00502 L     @07,RSTANCHR(,REG6)                                 0509 01255000
         L     @04,TABF(,@07)                                      0509 01256000
         LTR   @04,@04                                             0509 01257000
         BNZ   @RF00509                                            0509 01258000
*              TABF = TABC;            /*FIRST CONTROL BLOCK IS THIS */ 01259000
         L     @04,TABC(,@07)                                      0510 01260000
         ST    @04,TABF(,@07)                                      0510 01261000
*            ELSE                                                  0511 01262000
*              DO;                                                 0511 01263000
         B     @RC00509                                            0511 01264000
@RF00509 DS    0H                                                  0512 01265000
*                TABC->TABBACKW = TABL; /*BACK CHAIN                 */ 01266000
         L     @07,RSTANCHR(,REG6)                                 0512 01267000
         L     @04,TABC(,@07)                                      0512 01268000
         L     @07,TABL(,@07)                                      0512 01269000
         ST    @07,TABBACKW(,@04)                                  0512 01270000
*                TABL->TABFORW = TABC; /*FORWARD CHAIN               */ 01271000
         ST    @04,TABFORW(,@07)                                   0513 01272000
*              END;                                                0514 01273000
*            TABL = TABC;              /*NEW LAST                    */ 01274000
@RC00509 L     @07,RSTANCHR(,REG6)                                 0515 01275000
         L     @04,TABC(,@07)                                      0515 01276000
         ST    @04,TABL(,@07)                                      0515 01277000
*          END;                                                    0516 01278000
*                                                                  0516 01279000
*        /************************************************************/ 01280000
*        /*                                                          */ 01281000
*        /* SET TABLE ADDRESS FOR CONTROL BLOCK WHICH ALREADY EXISTS.*/ 01282000
*        /*                                                          */ 01283000
*        /************************************************************/ 01284000
*                                                                  0517 01285000
*        ELSE                                                      0517 01286000
*          IF TABC = 0 THEN                                        0517 01287000
         B     @RC00496                                            0517 01288000
@RF00496 L     @07,RSTANCHR(,REG6)                                 0517 01289000
         L     @04,TABC(,@07)                                      0517 01290000
         LTR   @04,@04                                             0517 01291000
         BNZ   @RF00517                                            0517 01292000
*            TABC = TABF;              /*REUSE FIRST TABLE           */ 01293000
         L     @04,TABF(,@07)                                      0518 01294000
         ST    @04,TABC(,@07)                                      0518 01295000
*          ELSE                                                    0519 01296000
*            TABC = TABC->TABFORW;     /*USE NTH TABLE               */ 01297000
*                                                                  0519 01298000
         B     @RC00517                                            0519 01299000
@RF00517 L     @07,RSTANCHR(,REG6)                                 0519 01300000
         L     @04,TABC(,@07)                                      0519 01301000
         L     @04,TABFORW(,@04)                                   0519 01302000
         ST    @04,TABC(,@07)                                      0519 01303000
*  CALL EXIT;  /*TERMINATE*/                                       0520 01304000
@RC00517 DS    0H                                                  0520 01305000
@RC00496 BAL   @14,EXIT                                            0520 01306000
*  END GETTAB; /*END OF PROCEDURE*/                                0521 01307000
@EL00008 DS    0H                                                  0521 01308000
@EF00008 DS    0H                                                  0521 01309000
@ER00008 BR    @14                                                 0521 01310000
@PB00008 DS    0H                                                  0522 01311000
*/********************************************************************/ 01312000
*/*                                                                  */ 01313000
*/* PROCEDURE NAME - MARKUNUS                                        */ 01314000
*/*                                                                  */ 01315000
*/* FUNCTION -                                                       */ 01316000
*/*     MARK A VOLUME GROUP OCCURRENCE UNUSABLE                      */ 01317000
*/*                                                                  */ 01318000
*/* INPUT -                                                          */ 01319000
*/*     GRABCURR - BUFFER ADDRESS FOR DATA OR INDEX                  */ 01320000
*/*     RSWASNVT - ADDRESS SNTABLE FOR VOL GOS                       */ 01321000
*/*       RSFCNDX - INDEX FOR VOLGO TO MODIFY                        */ 01322000
*/*       RSFAENT - ADDRESS OF VOLGO TO MARK UNUSABLE                */ 01323000
*/*                                                                  */ 01324000
*/* OUTPUT -                                                         */ 01325000
*/*     VOLGO MARKED UNUSABLE                                        */ 01326000
*/*     DATA - INDEX MARKED NO UPDATE (CNUS)                         */ 01327000
*/*                                                                  */ 01328000
*/* MESSAGES -                                                       */ 01329000
*/*     IDC21009I - COMPONENT DOES NOT EXIST ON VOLUME               */ 01330000
*/*     IDC21030I - INVALID SPACE DESCRIPTION                        */ 01331000
*/*                                                                  */ 01332000
*/********************************************************************/ 01333000
*      GENERATE;                                                   0522 01334000
         DS    0F                                                       01335000
NAME0028 DC    CL8'MARKUNUS'                                            01336000
*MARKUNUS: PROCEDURE                                               0523 01337000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0523 01338000
*                                                                  0523 01339000
         B     @PB00009                                            0523 01340000
MARKUNUS DS    0H                                                  0524 01341000
*      GENERATE REFS(RS03RG08, REG6);                              0524 01342000
*                                                                  0524 01343000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          01344000
         LR    @15,@13  OLD SAVE AREA                                   01345000
         LA    @13,72(@13)  NEW SAVE AREA                               01346000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     01347000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        01348000
         ENTRY MARKUNUS  ENTRY POINT                                    01349000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         01350000
         MVC   0(4,@15),NAME0028  PROCNAME TO REGSAVE                   01351000
*        OLDERID2 = NEWERID2;                                      0525 01352000
         L     @07,GDTTR2(,REG5)                                   0525 01353000
         MVC   @TS00001(95),NEWERID2(@07)                          0525 01354000
         MVC   OLDERID2(95,@07),@TS00001                           0525 01355000
*        NEWID2 = 'RSMU';                                          0526 01356000
*                                                                  0526 01357000
         MVC   NEWID2(4,@07),@CC03531                              0526 01358000
*        /************************************************************/ 01359000
*        /*                                                          */ 01360000
*        /*  ISSUE ERROR MESSAGE                                     */ 01361000
*        /*     IDC21009I - NO DSDIR                                 */ 01362000
*        /*     IDC21030I - DSDIR EXISTS BUT SPACE CONFILCT          */ 01363000
*        /*                                                          */ 01364000
*        /************************************************************/ 01365000
*                                                                  0527 01366000
*        IF RSASDSDI = OFF THEN                                    0527 01367000
*                                                                  0527 01368000
         TM    RSASDSDI(REG6),B'01000000'                          0527 01369000
         BNZ   @RF00527                                            0527 01370000
*          DO;                                                     0528 01371000
*          /*CALL CKERR*/                                          0529 01372000
*            RSCKERR = RSCKERR && RSCKERR;                         0529 01373000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0529 01374000
*            RSCKERN = RSE023;                                     0530 01375000
         MVC   RSCKERN(2,REG6),@CH00937                            0530 01376000
*            RSCKTERM = 'RETU';                                    0531 01377000
         MVC   RSCKTERM(4,REG6),@CC03500                           0531 01378000
*            RSCKMVAR(1) = ADDR(CNAME);                            0532 01379000
         L     @07,RSGRABCU(,REG6)                                 0532 01380000
         LA    @04,8                                               0532 01381000
         AL    @04,GRABCURR(,@07)                                  0532 01382000
         LA    @07,CNAME(,@04)                                     0532 01383000
         ST    @07,RSCKMVAR(,REG6)                                 0532 01384000
*            RSCKMVAR(2) = ADDR(RCDID);                            0533 01385000
         LA    @07,RCDID(,@04)                                     0533 01386000
         ST    @07,RSCKMVAR+4(,REG6)                               0533 01387000
*            RSCKMVAR(3) = ADDR(SNVOLSER);                         0534 01388000
*                                                                  0534 01389000
         L     @07,RSWASNVT(,REG6)                                 0534 01390000
         L     @07,RSFAENT(,@07)                                   0534 01391000
         LA    @07,SNVOLSER(,@07)                                  0534 01392000
         ST    @07,RSCKMVAR+8(,REG6)                               0534 01393000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */ 01394000
*          CALL CKERR;                                             0535 01395000
         L     @15,@CV03443                                        0535 01396000
         BALR  @14,@15                                             0535 01397000
*          END;                                                    0536 01398000
*                                                                  0536 01399000
*        ELSE                                                      0537 01400000
*                                                                  0537 01401000
*          DO;                                                     0537 01402000
         B     @RC00527                                            0537 01403000
@RF00527 DS    0H                                                  0538 01404000
*          /*CALL CKERR*/                                          0538 01405000
*            RSCKERR = RSCKERR && RSCKERR;                         0538 01406000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0538 01407000
*            RSCKERN = RSE033;                                     0539 01408000
         MVC   RSCKERN(2,REG6),@CH00954                            0539 01409000
*            RSCKTERM = 'RETU';                                    0540 01410000
         MVC   RSCKTERM(4,REG6),@CC03500                           0540 01411000
*            RSCKMVAR(1) = ADDR(CNAME);                            0541 01412000
         L     @07,RSGRABCU(,REG6)                                 0541 01413000
         LA    @04,8                                               0541 01414000
         AL    @04,GRABCURR(,@07)                                  0541 01415000
         LA    @07,CNAME(,@04)                                     0541 01416000
         ST    @07,RSCKMVAR(,REG6)                                 0541 01417000
*            RSCKMVAR(2) = ADDR(RCDID);                            0542 01418000
         LA    @07,RCDID(,@04)                                     0542 01419000
         ST    @07,RSCKMVAR+4(,REG6)                               0542 01420000
*            RSCKMVAR(3) = ADDR(SNVOLSER);                         0543 01421000
*                                                                  0543 01422000
         L     @07,RSWASNVT(,REG6)                                 0543 01423000
         L     @07,RSFAENT(,@07)                                   0543 01424000
         LA    @07,SNVOLSER(,@07)                                  0543 01425000
         ST    @07,RSCKMVAR+8(,REG6)                               0543 01426000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */ 01427000
*          CALL CKERR;                                             0544 01428000
         L     @15,@CV03443                                        0544 01429000
         BALR  @14,@15                                             0544 01430000
*          END;                                                    0545 01431000
*                                                                  0545 01432000
*        /************************************************************/ 01433000
*        /*                                                          */ 01434000
*        /*  MARK VOLUME GROUP OCCURRENCE(S) UNUSABLE                */ 01435000
*        /*                                                          */ 01436000
*        /************************************************************/ 01437000
*                                                                  0546 01438000
*        RSMA3FAE = RSFAENT;           /*CURRENT VGO AS BASE         */ 01439000
@RC00527 L     @07,RSWASNVT(,REG6)                                 0546 01440000
         L     @04,RSFAENT(,@07)                                   0546 01441000
         ST    @04,RSMA3FAE(,REG6)                                 0546 01442000
*        RSMA3FCN = RSFCNDX;                                       0547 01443000
         LH    @04,RSFCNDX(,@07)                                   0547 01444000
         STH   @04,RSMA3FCN(,REG6)                                 0547 01445000
*        DO RSFCNDX = RSFHNDX BY -1 TO RSMA3FCN;                   0548 01446000
         LH    @07,RSFHNDX(,@07)                                   0548 01447000
         L     @04,RSWASNVT(,REG6)                                 0548 01448000
         STH   @07,RSFCNDX(,@04)                                   0548 01449000
         B     @DE00548                                            0548 01450000
@DL00548 DS    0H                                                  0549 01451000
*                                      /*SCAN ALL REMAINING VGOS     */ 01452000
*          RSFAENT = RSFCADR + RSFENTLN*(RSFCNDX-1); /* VGO          */ 01453000
         L     @07,RSWASNVT(,REG6)                                 0549 01454000
         LH    @04,RSFCNDX(,@07)                                   0549 01455000
         BCTR  @04,0                                               0549 01456000
         LR    @01,@04                                             0549 01457000
         SLR   @04,@04                                             0549 01458000
         IC    @04,RSFENTLN(,@07)                                  0549 01459000
         MR    @00,@04                                             0549 01460000
         AL    @01,RSFCADR(,@07)                                   0549 01461000
         ST    @01,RSFAENT(,@07)                                   0549 01462000
*          IF (SNVOLSER = RSMA3FAE->SNVOLSER) &                    0550 01463000
*             (SDSDIRSN = RSMA3FAE->SDSDIRSN) THEN                 0550 01464000
         L     @07,RSMA3FAE(,REG6)                                 0550 01465000
         CLC   SNVOLSER(6,@01),SNVOLSER(@07)                       0550 01466000
         BNE   @RF00550                                            0550 01467000
         CLC   SDSDIRSN(2,@01),SDSDIRSN(@07)                       0550 01468000
         BNE   @RF00550                                            0550 01469000
*                                      /*MATCHING VGO (VOLSER-DSDIR) */ 01470000
*            DO;                                                   0551 01471000
*                                                                  0551 01472000
*        /************************************************************/ 01473000
*        /*                                                          */ 01474000
*        /*     MODIFY THE VOLUME GROUP OCCURRENCE                   */ 01475000
*        /*                                                          */ 01476000
*        /************************************************************/ 01477000
*                                                                  0552 01478000
*              SDSDIRSN = 0;           /*MARK VGO UNUSABLE           */ 01479000
         SLR   @07,@07                                             0552 01480000
         STCM  @07,3,SDSDIRSN(@01)                                 0552 01481000
*              GRABBB = GRABCURR;      /*BASE FOR MODIFY             */ 01482000
         L     @07,RSGRABCU(,REG6)                                 0553 01483000
         L     @04,GRABCURR(,@07)                                  0553 01484000
         ST    @04,GRABBB(,@07)                                    0553 01485000
*              /* CALL TO MODULE IDCRS04 FOR PROCEDURE MODGO         */ 01486000
*              CALL MODGO;                                         0554 01487000
         L     @15,@CV03433                                        0554 01488000
         BALR  @14,@15                                             0554 01489000
*            END;                                                  0555 01490000
*        END;                                                      0556 01491000
*                                                                  0556 01492000
@RF00550 L     @04,RSWASNVT(,REG6)                                 0556 01493000
         SLR   @07,@07                                             0556 01494000
         BCTR  @07,0                                               0556 01495000
         AH    @07,RSFCNDX(,@04)                                   0556 01496000
         L     @04,RSWASNVT(,REG6)                                 0556 01497000
         STH   @07,RSFCNDX(,@04)                                   0556 01498000
@DE00548 CH    @07,RSMA3FCN(,REG6)                                 0556 01499000
         BNL   @DL00548                                            0556 01500000
*        /************************************************************/ 01501000
*        /*                                                          */ 01502000
*        /*     RESTORE THE CALLER'S ENVIRONMENT                     */ 01503000
*        /*                                                          */ 01504000
*        /************************************************************/ 01505000
*                                                                  0557 01506000
*        RSFAENT = RSMA3FAE;           /*1ST MATCHING VGO            */ 01507000
         L     @07,RSWASNVT(,REG6)                                 0557 01508000
         L     @04,RSMA3FAE(,REG6)                                 0557 01509000
         ST    @04,RSFAENT(,@07)                                   0557 01510000
*        RSFCNDX = RSMA3FCN;                                       0558 01511000
*                                                                  0558 01512000
         LH    @04,RSMA3FCN(,REG6)                                 0558 01513000
         STH   @04,RSFCNDX(,@07)                                   0558 01514000
*        /************************************************************/ 01515000
*        /*                                                          */ 01516000
*        /*  MARK DATA OR INDEX - INHIBIT UPDATE                     */ 01517000
*        /*                                                          */ 01518000
*        /************************************************************/ 01519000
*                                                                  0559 01520000
*        CNUS = ON;                                                0559 01521000
*                                                                  0559 01522000
         L     @07,RSGRABCU(,REG6)                                 0559 01523000
         L     @07,GRABCURR(,@07)                                  0559 01524000
         OI    CNUS+8(@07),B'00000001'                             0559 01525000
*        /************************************************************/ 01526000
*        /*                                                          */ 01527000
*        /*  INDICATE TO UPDATE THE CATALOG AND CRA                  */ 01528000
*        /*                                                          */ 01529000
*        /************************************************************/ 01530000
*                                                                  0560 01531000
*        RSWUPCAT = ON;                                            0560 01532000
         OI    RSWUPCAT(@07),B'00100000'                           0560 01533000
*        /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR             */ 01534000
*        CALL ADDUPCR;                                             0561 01535000
         L     @15,@CV03442                                        0561 01536000
         BALR  @14,@15                                             0561 01537000
*  CALL EXIT;  /*TERMINATE*/                                       0562 01538000
         BAL   @14,EXIT                                            0562 01539000
*  END MARKUNUS; /*END OF PROCEDURE*/                              0563 01540000
@EL00009 DS    0H                                                  0563 01541000
@EF00009 DS    0H                                                  0563 01542000
@ER00009 BR    @14                                                 0563 01543000
@PB00009 DS    0H                                                  0564 01544000
*/********************************************************************/ 01545000
*/*                                                                  */ 01546000
*/* PROCEDURE - PROCVOL                                              */ 01547000
*/*                                                                  */ 01548000
*/* FUNCTION -                                                       */ 01549000
*/*     PROCESS ALL VOLUME RECORDS. THE PRIMARY OBJECTIVE IS:        */ 01550000
*/*       . TO DELETE INVALID DATA SET DIRECTORY ENTRIES(DSDIRS)     */ 01551000
*/*         OR UPDATE REASSIGNED CINS IN THE DSDIRS.                 */ 01552000
*/*       . TO RETURN SUBALLOCATED SPACE WHICH IS NO LONGER          */ 01553000
*/*         SUBALLOCATED.                                            */ 01554000
*/*                                                                  */ 01555000
*/*     FOR VOLUMES BEING RESET, ALL SPACE REQUESTS WILL BE          */ 01556000
*/*     CHECKED TO ENSURE NO OVERLAP OF SPACE REQUESTS.              */ 01557000
*/*                                                                  */ 01558000
*/* INPUT -                                                          */ 01559000
*/*     RSWORK AND THE WORKFILE.                                     */ 01560000
*/*                                                                  */ 01561000
*/* OUTPUT -                                                         */ 01562000
*/*     ALL VOLUME RECORDS IN THE WORKFILE HAVE BEEN PROCESSED AND   */ 01563000
*/*     ADJUSTED PER THE FUNCTIONAL DESCRIPTION.                     */ 01564000
*/*                                                                  */ 01565000
*/* EXIT,NORMAL - RETURN TO CALLER                                   */ 01566000
*/********************************************************************/ 01567000
*      GENERATE;                                                   0564 01568000
         DS    0F                                                       01569000
NAME0036 DC    CL8'PROCVOL'                                             01570000
*PROCVOL: PROCEDURE                                                0565 01571000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0565 01572000
*                                                                  0565 01573000
         B     @PB00010                                            0565 01574000
PROCVOL  DS    0H                                                  0566 01575000
*      GENERATE REFS(RS03RG08, REG6);                              0566 01576000
*                                                                  0566 01577000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          01578000
         LR    @15,@13  OLD SAVE AREA                                   01579000
         LA    @13,72(@13)  NEW SAVE AREA                               01580000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     01581000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        01582000
         ENTRY PROCVOL  ENTRY POINT                                     01583000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         01584000
         MVC   0(4,@15),NAME0036  PROCNAME TO REGSAVE                   01585000
*        OLDERID2 = NEWERID2;                                      0567 01586000
         L     @07,GDTTR2(,REG5)                                   0567 01587000
         MVC   @TS00001(95),NEWERID2(@07)                          0567 01588000
         MVC   OLDERID2(95,@07),@TS00001                           0567 01589000
*        NEWID2 = 'RSPV';                                          0568 01590000
*                                                                  0568 01591000
         MVC   NEWID2(4,@07),@CC03537                              0568 01592000
*        /************************************************************/ 01593000
*        /*                                                          */ 01594000
*        /*  PROCESS ALL OF THE VOLUME RECORDS                       */ 01595000
*        /*                                                          */ 01596000
*        /************************************************************/ 01597000
*                                                                  0569 01598000
*        RSVTBENT = 0;                 /*INDICATE FIRST ENTRY        */ 01599000
*                                                                  0569 01600000
         SLR   @07,@07                                             0569 01601000
         ST    @07,RSVTBENT(,REG6)                                 0569 01602000
*        DO UNTIL(VOLSRLAS = ON);                                  0570 01603000
@DL00570 DS    0H                                                  0571 01604000
*          IF RSVTBENT = 0 THEN        /*FIRST VOLUME ENTRY          */ 01605000
         L     @07,RSVTBENT(,REG6)                                 0571 01606000
         LTR   @07,@07                                             0571 01607000
         BNZ   @RF00571                                            0571 01608000
*            RSVTBENT = RSVOLLST;                                  0572 01609000
         L     @07,RSVOLLST(,REG6)                                 0572 01610000
         ST    @07,RSVTBENT(,REG6)                                 0572 01611000
*          ELSE                        /*GET NEXT VOLUME ENTRY       */ 01612000
*            RSVTBENT = VOLSRNXT;                                  0573 01613000
*                                                                  0573 01614000
         B     @RC00571                                            0573 01615000
@RF00571 L     @07,RSVTBENT(,REG6)                                 0573 01616000
         L     @07,VOLSRNXT(,@07)                                  0573 01617000
         ST    @07,RSVTBENT(,REG6)                                 0573 01618000
*        /************************************************************/ 01619000
*        /*                                                          */ 01620000
*        /*  ALLOW FOR A BAD VOLUME RECORD. THIS OCCURS WHEN NO      */ 01621000
*        /*  VOLUME RECORD WAS FOUND ON A CRA BEING RESET.           */ 01622000
*        /*                                                          */ 01623000
*        /************************************************************/ 01624000
*                                                                  0574 01625000
*          IF VOLSRSER(1:1) = BADVOLSW THEN;                       0574 01626000
*                                                                  0574 01627000
@RC00571 L     @07,RSVTBENT(,REG6)                                 0574 01628000
         CLC   VOLSRSER(1,@07),BADVOLSW                            0574 01629000
         BE    @RT00574                                            0574 01630000
*        /************************************************************/ 01631000
*        /*                                                          */ 01632000
*        /*  DETERMINE WHETHER THIS IS A RESET VOLUME AND SAVE THE   */ 01633000
*        /*  INDICATION.                                             */ 01634000
*        /*                                                          */ 01635000
*        /************************************************************/ 01636000
*                                                                  0576 01637000
*          ELSE                                                    0576 01638000
*            DO;                                                   0576 01639000
*              RSCRVL = ADDR(VOLSRSER);                            0577 01640000
         L     @07,RSVTBENT(,REG6)                                 0577 01641000
         LA    @07,VOLSRSER(,@07)                                  0577 01642000
         ST    @07,RSCRVL(,REG6)                                   0577 01643000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE SCNRLST       */ 01644000
*              CALL IDCRS5SR('V','A',RSENTPT,RSCRVL);              0578 01645000
         LA    @07,@CC00828                                        0578 01646000
         ST    @07,@AL00001                                        0578 01647000
         LA    @07,@CC00808                                        0578 01648000
         ST    @07,@AL00001+4                                      0578 01649000
         LA    @07,RSENTPT(,REG6)                                  0578 01650000
         ST    @07,@AL00001+8                                      0578 01651000
         LA    @07,RSCRVL(,REG6)                                   0578 01652000
         ST    @07,@AL00001+12                                     0578 01653000
         L     @15,@CV03439                                        0578 01654000
         LA    @01,@AL00001                                        0578 01655000
         BALR  @14,@15                                             0578 01656000
*              RSPVRVOL = OFF;                                     0579 01657000
         NI    RSPVRVOL(REG6),B'10111111'                          0579 01658000
*              IF RSENTPT ^= 0 THEN    /*INDICATE RESET VOLUME       */ 01659000
         L     @07,RSENTPT(,REG6)                                  0580 01660000
         LTR   @07,@07                                             0580 01661000
         BZ    @RF00580                                            0580 01662000
*                RSPVRVOL = ON;                                    0581 01663000
*                                                                  0581 01664000
         OI    RSPVRVOL(REG6),B'01000000'                          0581 01665000
*        /************************************************************/ 01666000
*        /*                                                          */ 01667000
*        /*  GET THE VOLUME RECORD INTO BUFFER 1                     */ 01668000
*        /*                                                          */ 01669000
*        /************************************************************/ 01670000
*                                                                  0582 01671000
*              RSGRABCU = ADDR(GRABSWF); /*READ FROM WORK FILE     */   01672000
@RF00580 L     @07,RSIOTBL(,REG6)                                  0582 01673000
         ST    @07,RSGRABCU(,REG6)                                 0582 01674000
*              GRABCURR = GRABRAB1;                                0583 01675000
*                                                                  0583 01676000
         L     @04,GRABRAB1(,@07)                                  0583 01677000
         ST    @04,GRABCURR(,@07)                                  0583 01678000
*              DO;                                                 0584 01679000
*                RSRTYPE = ''B;                                    0585 01680000
         MVI   RSRTYPE(REG6),X'00'                                 0585 01681000
*                RSRGET = ON;      /* GETRCD  */                   0586 01682000
         OI    RSRGET(REG6),B'10000000'                            0586 01683000
*                RSRUPD = ON;      /* UPDATE  */                   0587 01684000
         OI    RSRUPD(REG6),B'00001000'                            0587 01685000
*                RSRDS = ''B;                                      0588 01686000
         NI    RSRDS(REG6),B'00011111'                             0588 01687000
*                RSRWF = ON;       /* WORKFILE  */                 0589 01688000
*                RSRDIR = ON;      /* DIRECT  */                   0590 01689000
*                RSRKEY = ON;      /* KEY  */                      0591 01690000
         OI    RSRWF(REG6),B'10010100'                             0591 01691000
*                RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/           0592 01692000
         OI    RSVIAFCR(REG6),B'10000000'                          0592 01693000
*                RSVIACRA = VOLSRSER; /*SET VOLSER */              0593 01694000
         L     @07,RSVTBENT(,REG6)                                 0593 01695000
         MVC   RSVIACRA(6,REG6),VOLSRSER(@07)                      0593 01696000
*                RSVIACIN = VOLSRCI; /*SET CI NUMBER */            0594 01697000
*                                                                  0594 01698000
         MVC   RSVIACIN(3,REG6),VOLSRCI+1(@07)                     0594 01699000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA        */ 01700000
*              CALL GETVIA;                                        0595 01701000
         L     @15,@CV03436                                        0595 01702000
         BALR  @14,@15                                             0595 01703000
*              END;                                                0596 01704000
*              IF RABNRF = ON THEN     /*NO RECORD FOUND             */ 01705000
*                                                                  0597 01706000
         L     @07,RSGRABCU(,REG6)                                 0597 01707000
         L     @07,GRABCURR(,@07)                                  0597 01708000
         TM    RABNRF(@07),B'00000010'                             0597 01709000
         BNO   @RF00597                                            0597 01710000
*                DO;                                               0598 01711000
*                /*CALL CKERR*/                                    0599 01712000
*                  RSCKERR = RSCKERR && RSCKERR;                   0599 01713000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0599 01714000
*                  RSCKERN = RSE100;                               0600 01715000
         MVC   RSCKERN(2,REG6),@CH00143                            0600 01716000
*                  RSCKTERM = 'TERM';                              0601 01717000
*                                                                  0601 01718000
         MVC   RSCKTERM(4,REG6),@CC03527                           0601 01719000
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */ 01720000
*                CALL CKERR;                                       0602 01721000
         L     @15,@CV03443                                        0602 01722000
         BALR  @14,@15                                             0602 01723000
*                END; /*THERE MUST BE A VOL RCD */                 0603 01724000
*                                                                  0603 01725000
*        /************************************************************/ 01726000
*        /*                                                          */ 01727000
*        /*  DETERMINE THE SIZE OF THE SPACE MAP. ONE BIT EXISTS     */ 01728000
*        /*  IN THE SPACE MAP FOR EACH TRACK ON THE VOLUME. THE      */ 01729000
*        /*  SPACE MAP SIZE IS DETERMINED IN BYTES, ROUNDING UP FOR  */ 01730000
*        /*  LEFT OVER BITS.                                         */ 01731000
*        /*                                                          */ 01732000
*        /************************************************************/ 01733000
*                                                                  0604 01734000
*              RSMAPSIZ = (RTNOCYLS*RTNOTRKS + 7)/8;               0604 01735000
*                                                                  0604 01736000
@RF00597 L     @07,RSGRABCU(,REG6)                                 0604 01737000
         L     @07,GRABCURR(,@07)                                  0604 01738000
         ICM   @01,12,RTNOTRKS(@07)                                0604 01739000
         SRA   @01,16                                              0604 01740000
         ICM   @07,12,RTNOCYLS(@07)                                0604 01741000
         SRA   @07,16                                              0604 01742000
         MR    @00,@07                                             0604 01743000
         LR    @02,@01                                             0604 01744000
         AL    @02,@CF00482                                        0604 01745000
         SRDA  @02,32                                              0604 01746000
         D     @02,@CF00175                                        0604 01747000
         ST    @03,RSMAPSIZ(,REG6)                                 0604 01748000
*        /************************************************************/ 01749000
*        /*                                                          */ 01750000
*        /*  GET THE BIT MAPS                                        */ 01751000
*        /*     . FOR NON-RESET VOLUMES A PRIMARY BITMAP             */ 01752000
*        /*       (SUBALLOCATED SPACE RETURNED), A WORK BITMAP       */ 01753000
*        /*       (FOR FIND), A CATALOG VGO BITMAP AND A             */ 01754000
*        /*       CRA VGO BITMAP ARE USED (SEE VLNRESET).            */ 01755000
*        /*     . FOR RESET VOLUMES 5 BITMAPS ARE USED (SEE VLRESET) */ 01756000
*        /*                                                          */ 01757000
*        /************************************************************/ 01758000
*                                                                  0605 01759000
*              IF RSPVRVOL = ON THEN                               0605 01760000
         TM    RSPVRVOL(REG6),B'01000000'                          0605 01761000
         BNO   @RF00605                                            0605 01762000
*                RSIDX1 = DIM(BMAPARRY);                           0606 01763000
         MVC   RSIDX1(2,REG6),@CH00280                             0606 01764000
*              ELSE                                                0607 01765000
*                RSIDX1 = 4;                                       0607 01766000
*                                                                  0607 01767000
         B     @RC00605                                            0607 01768000
@RF00605 MVC   RSIDX1(2,REG6),@CH00038                             0607 01769000
*              DO RSIDX = 1 TO RSIDX1; /*GET THE BITMAPS             */ 01770000
@RC00605 LA    @07,1                                               0608 01771000
         B     @DE00608                                            0608 01772000
@DL00608 DS    0H                                                  0609 01773000
*                CALL IDCSAGP0(GDTTBL,RSMAPSIZ,BMAPARRY(RSIDX),POOL11,  01774000
*                  SETZERO);                                       0609 01775000
         ST    REG5,@AL00001                                       0609 01776000
         LA    @07,RSMAPSIZ(,REG6)                                 0609 01777000
         ST    @07,@AL00001+4                                      0609 01778000
         LH    @07,RSIDX(,REG6)                                    0609 01779000
         SLA   @07,2                                               0609 01780000
         LA    @07,BMAPARRY-4(@07,REG6)                            0609 01781000
         ST    @07,@AL00001+8                                      0609 01782000
         LA    @07,@CC00905                                        0609 01783000
         ST    @07,@AL00001+12                                     0609 01784000
         LA    @07,SETZERO                                         0609 01785000
         ST    @07,@AL00001+16                                     0609 01786000
         MVI   @AL00001+16,X'80'                                   0609 01787000
         L     @15,GDTGPL(,REG5)                                   0609 01788000
         LA    @01,@AL00001                                        0609 01789000
         BALR  @14,@15                                             0609 01790000
*                RESPECIFY RTNREG RSTD;                            0610 01791000
*                TESTRC = RTNREG;                                  0611 01792000
         STH   RTNREG,TESTRC(,REG6)                                0611 01793000
*                RESPECIFY RTNREG UNRSTD;                          0612 01794000
*                IF TESTRC ^= 0 THEN    /*STORAGE NOT AVAILABLE      */ 01795000
*                                                                  0613 01796000
         LH    @07,TESTRC(,REG6)                                   0613 01797000
         LTR   @07,@07                                             0613 01798000
         BZ    @RF00613                                            0613 01799000
*                  DO;                                             0614 01800000
*                  /*CALL CKERR*/                                  0615 01801000
*                    RSCKERR = RSCKERR && RSCKERR;                 0615 01802000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0615 01803000
*                    RSCKERN = RSE099;                             0616 01804000
         MVC   RSCKERN(2,REG6),@CH01078                            0616 01805000
*                    RSCKTERM = 'TERM';                            0617 01806000
*                                                                  0617 01807000
         MVC   RSCKTERM(4,REG6),@CC03527                           0617 01808000
*                  /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR     */ 01809000
*                  CALL CKERR;                                     0618 01810000
         L     @15,@CV03443                                        0618 01811000
         BALR  @14,@15                                             0618 01812000
*                  END;                                            0619 01813000
*              END;                                                0620 01814000
*                                                                  0620 01815000
@RF00613 LA    @07,1                                               0620 01816000
         AH    @07,RSIDX(,REG6)                                    0620 01817000
@DE00608 STH   @07,RSIDX(,REG6)                                    0620 01818000
         CH    @07,RSIDX1(,REG6)                                   0620 01819000
         BNH   @DL00608                                            0620 01820000
*        /************************************************************/ 01821000
*        /*                                                          */ 01822000
*        /*  GET ALL OF THE SPACE HEADERS FOR THIS VOLUME            */ 01823000
*        /*                                                          */ 01824000
*        /************************************************************/ 01825000
*                                                                  0621 01826000
*                                                                  0621 01827000
*              DO;                                                 0621 01828000
*                GRABBB = GRABCURR;                                0622 01829000
         L     @07,RSGRABCU(,REG6)                                 0622 01830000
         L     @04,GRABCURR(,@07)                                  0622 01831000
         ST    @04,GRABBB(,@07)                                    0622 01832000
*                RSWGCODE = GCSPCHDR;  /*SPECIFY GROUP CODE          */ 01833000
         MVI   RSWGCODE(REG6),X'06'                                0623 01834000
*                RSWFONE = OFF;        /*FIND ALL OCCURRENCES        */ 01835000
         NI    RSWFONE(REG6),B'01111111'                           0624 01836000
*                /* CALL THE FIND SUBROUTINE */                    0625 01837000
*                                                                  0625 01838000
*              /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND          */ 01839000
*              CALL FIND;                                          0625 01840000
         L     @15,@CV03435                                        0625 01841000
         BALR  @14,@15                                             0625 01842000
*              END;                                                0626 01843000
*              RSPVSNT6 = RSWASNVT;    /*SAVE SPC HEADER SNTAB ADDR  */ 01844000
*                                                                  0627 01845000
         L     @07,RSWASNVT(,REG6)                                 0627 01846000
         ST    @07,RSPVSNT6(,REG6)                                 0627 01847000
*        /************************************************************/ 01848000
*        /*                                                          */ 01849000
*        /*  FOR RESET VOLUMES, INITIALIZE THE PRIMARY MAP WITH      */ 01850000
*        /*  ALL SUBALLOCATABLE TRACKS AS AVAILABLE.                 */ 01851000
*        /*                                                          */ 01852000
*        /************************************************************/ 01853000
*                                                                  0628 01854000
*              IF RSPVRVOL = ON THEN                               0628 01855000
         TM    RSPVRVOL(REG6),B'01000000'                          0628 01856000
         BNO   @RF00628                                            0628 01857000
*  INITBMAP:                                                       0629 01858000
*                DO;                                               0629 01859000
INITBMAP DS    0H                                                  0630 01860000
*                  RSFAENT = RSFCADR;  /*FIRST SPACE HEADER          */ 01861000
         L     @07,RSWASNVT(,REG6)                                 0630 01862000
         L     @04,RSFCADR(,@07)                                   0630 01863000
         ST    @04,RSFAENT(,@07)                                   0630 01864000
*                  IF RSFENTLN ^= 0 THEN /*CATERR MAY CAUSE NO SPCHDR*/ 01865000
         CLI   RSFENTLN(@07),0                                     0631 01866000
         BE    @RF00631                                            0631 01867000
*                    DO;                                           0632 01868000
*        RFY SNTTNN BASED(ADDR(SSPEXTNN));                         0633 01869000
*                                      /*MAP TTNNS ON THE SPACE HDR  */ 01870000
*                      RSTGBMAP = RSPBMAP; /*SETBITS IN PRIM BMAP    */ 01871000
         L     @07,RSPBMAP(,REG6)                                  0634 01872000
         ST    @07,RSTGBMAP(,REG6)                                 0634 01873000
*                      RSPVSETB = '';  /*CLEAR SETBITS OPTIONS       */ 01874000
*                                                                  0635 01875000
         MVI   RSPVSETB(REG6),X'00'                                0635 01876000
*                      DO RSFCNDX = 1 TO RSFHNDX;                  0636 01877000
         LA    @07,1                                               0636 01878000
         B     @DE00636                                            0636 01879000
@DL00636 DS    0H                                                  0637 01880000
*                                      /*PROCESS ALL SPACE HEADERS   */ 01881000
*                        IF SNVSPUNQ = OFF THEN /*IGNORE UNIQUES     */ 01882000
         L     @07,RSWASNVT(,REG6)                                 0637 01883000
         L     @07,RSFAENT(,@07)                                   0637 01884000
         TM    SNVSPUNQ(@07),B'10000000'                           0637 01885000
         BNZ   @RF00637                                            0637 01886000
*                          CALL SETBITS;                           0638 01887000
         BAL   @14,SETBITS                                         0638 01888000
*                        RSFAENT = RSFAENT + RSFENTLN; /*NEXT SPC HDR*/ 01889000
@RF00637 L     @07,RSWASNVT(,REG6)                                 0639 01890000
         SLR   @04,@04                                             0639 01891000
         IC    @04,RSFENTLN(,@07)                                  0639 01892000
         AL    @04,RSFAENT(,@07)                                   0639 01893000
         ST    @04,RSFAENT(,@07)                                   0639 01894000
*                      END;                                        0640 01895000
         L     @04,RSWASNVT(,REG6)                                 0640 01896000
         LA    @07,1                                               0640 01897000
         AH    @07,RSFCNDX(,@04)                                   0640 01898000
@DE00636 L     @04,RSWASNVT(,REG6)                                 0640 01899000
         STH   @07,RSFCNDX(,@04)                                   0640 01900000
         L     @04,RSWASNVT(,REG6)                                 0640 01901000
         CH    @07,RSFHNDX(,@04)                                   0640 01902000
         BNH   @DL00636                                            0640 01903000
*        RFY SNTTNN;                   /*REVERT                      */ 01904000
*                                                                  0641 01905000
*        /************************************************************/ 01906000
*        /*                                                          */ 01907000
*        /*     INITIALIZE THE SECONDARY MAP WITH ALL                */ 01908000
*        /*     SUBALLOCATABLE TRACKS AS AVAILABLE                   */ 01909000
*        /*                                                          */ 01910000
*        /************************************************************/ 01911000
*                                                                  0642 01912000
*                      RSTOMAP = RSSBMAP;                          0642 01913000
         L     @07,RSSBMAP(,REG6)                                  0642 01914000
         ST    @07,RSTOMAP(,REG6)                                  0642 01915000
*                      RSFROMAP = RSPBMAP;                         0643 01916000
         L     @07,RSPBMAP(,REG6)                                  0643 01917000
         ST    @07,RSFROMAP(,REG6)                                 0643 01918000
*                      DO TMPSZ = RSMAPSIZ BY -256 WHILE(TMPSZ>256);    01919000
         L     @07,RSMAPSIZ(,REG6)                                 0644 01920000
         ST    @07,TMPSZ(,REG6)                                    0644 01921000
         B     @DE00644                                            0644 01922000
@DL00644 DS    0H                                                  0645 01923000
*                                      /*INSERT ALL BUT LAST BIT     */ 01924000
*                        RSTOMAP->BMAP(1:256) = RSFROMAP->BMAP(1:256);  01925000
         L     @07,RSTOMAP(,REG6)                                  0645 01926000
         L     @04,RSFROMAP(,REG6)                                 0645 01927000
         MVC   BMAP(256,@07),BMAP(@04)                             0645 01928000
*                        RSTOMAP = RSTOMAP + 256;                  0646 01929000
         LA    @15,256                                             0646 01930000
         ALR   @07,@15                                             0646 01931000
         ST    @07,RSTOMAP(,REG6)                                  0646 01932000
*                        RSFROMAP = RSFROMAP + 256;                0647 01933000
         ALR   @04,@15                                             0647 01934000
         ST    @04,RSFROMAP(,REG6)                                 0647 01935000
*                      END;                                        0648 01936000
         L     @07,@CF03546                                        0648 01937000
         AL    @07,TMPSZ(,REG6)                                    0648 01938000
         ST    @07,TMPSZ(,REG6)                                    0648 01939000
@DE00644 L     @07,TMPSZ(,REG6)                                    0648 01940000
         C     @07,@CF03188                                        0648 01941000
         BH    @DL00644                                            0648 01942000
*                      RSTOMAP->BMAP(1:TMPSZ) =                    0649 01943000
*                          RSFROMAP->BMAP(1:TMPSZ);                0649 01944000
         L     @04,RSTOMAP(,REG6)                                  0649 01945000
         BCTR  @07,0                                               0649 01946000
         L     @01,RSFROMAP(,REG6)                                 0649 01947000
         EX    @07,@SM03734                                        0649 01948000
*                                      /*COPY LAST LITTLE BIT        */ 01949000
*                    END;                                          0650 01950000
*                  ELSE                                            0651 01951000
*                    RSPVSNT6 = 0;     /*NO SPACE HEADERS            */ 01952000
         B     @RC00631                                            0651 01953000
@RF00631 SLR   @07,@07                                             0651 01954000
         ST    @07,RSPVSNT6(,REG6)                                 0651 01955000
*                END INITBMAP;                                     0652 01956000
*                                                                  0652 01957000
@RC00631 DS    0H                                                  0653 01958000
*        /************************************************************/ 01959000
*        /*                                                          */ 01960000
*        /*  GET ALL OF THE DSDIRS FOR THIS VOLUME                   */ 01961000
*        /*                                                          */ 01962000
*        /************************************************************/ 01963000
*                                                                  0653 01964000
*                                                                  0653 01965000
*              DO;                                                 0653 01966000
@RF00628 DS    0H                                                  0654 01967000
*                GRABBB = GRABCURR;                                0654 01968000
         L     @07,RSGRABCU(,REG6)                                 0654 01969000
         L     @04,GRABCURR(,@07)                                  0654 01970000
         ST    @04,GRABBB(,@07)                                    0654 01971000
*                RSWGCODE = GCDSDIR;   /*SPECIFY GROUP CODE          */ 01972000
         MVI   RSWGCODE(REG6),X'08'                                0655 01973000
*                RSWFONE = OFF;        /*FIND ALL OCCURRENCES        */ 01974000
         NI    RSWFONE(REG6),B'01111111'                           0656 01975000
*                /* CALL THE FIND SUBROUTINE */                    0657 01976000
*                                                                  0657 01977000
*              /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND          */ 01978000
*              CALL FIND;                                          0657 01979000
         L     @15,@CV03435                                        0657 01980000
         BALR  @14,@15                                             0657 01981000
*              END;                                                0658 01982000
*              IF RSFENTLN ^= 0 THEN   /*DSDIRS EXIST                */ 01983000
         L     @07,RSWASNVT(,REG6)                                 0659 01984000
         CLI   RSFENTLN(@07),0                                     0659 01985000
         BE    @RF00659                                            0659 01986000
*                RSPVSNT8 = RSWASNVT;  /*SAVE ADDR DSDIR SNTAB       */ 01987000
         ST    @07,RSPVSNT8(,REG6)                                 0660 01988000
*              ELSE                                                0661 01989000
*                RSPVSNT8 = 0;         /*NO DSDIRS                   */ 01990000
*                                                                  0661 01991000
         B     @RC00659                                            0661 01992000
@RF00659 SLR   @07,@07                                             0661 01993000
         ST    @07,RSPVSNT8(,REG6)                                 0661 01994000
*        /************************************************************/ 01995000
*        /*                                                          */ 01996000
*        /*  FOR RESET VOLUMES -                                     */ 01997000
*        /*     VLRESET WILL VERIFY AND POSSIBLY UPDATE OR DELETE    */ 01998000
*        /*     EACH DSDIR. FURTHER, ALL CONFLICTS IN SPACE REQUESTS */ 01999000
*        /*     WILL BE METED OUT JUDICIOUSLY.                       */ 02000000
*        /*                                                          */ 02001000
*        /*  FOR NON-RESET VOLUMES -                                 */ 02002000
*        /*     VLNRESET WILL VERIFY AND POSSIBLY UPDATE OR DELETE   */ 02003000
*        /*     EACH DSDIR WHICH ASSOCIATES TO AN OBJECT WHICH       */ 02004000
*        /*     WAS OR IS ON ONE OF THE RESET VOLUMES. IF DELETED,   */ 02005000
*        /*     ALL SPACE PREVIOUSLY SUBALLOCATED TO IT IS           */ 02006000
*        /*     RETURNED FOR SUBALLOCATION.                          */ 02007000
*        /*                                                          */ 02008000
*        /*   IN BOTH CASES, THE VOLUME SET OF RECORDS IS AS         */ 02009000
*        /*   GOOD AS WE CAN GET IT.                                 */ 02010000
*        /*                                                          */ 02011000
*        /************************************************************/ 02012000
*                                                                  0662 02013000
*              IF RSPVRVOL = ON THEN                               0662 02014000
@RC00659 TM    RSPVRVOL(REG6),B'01000000'                          0662 02015000
         BNO   @RF00662                                            0662 02016000
*                CALL VLRESET;                                     0663 02017000
*                                                                  0663 02018000
         BAL   @14,VLRESET                                         0663 02019000
*              ELSE                                                0664 02020000
*                IF RSPVSNT8 ^= 0 THEN /*ONLY GO IF DSDIRS           */ 02021000
         B     @RC00662                                            0664 02022000
@RF00662 L     @07,RSPVSNT8(,REG6)                                 0664 02023000
         LTR   @07,@07                                             0664 02024000
         BZ    @RF00664                                            0664 02025000
*                  CALL VLNRESET;                                  0665 02026000
*                                                                  0665 02027000
         BAL   @14,VLNRESET                                        0665 02028000
*        /************************************************************/ 02029000
*        /*                                                          */ 02030000
*        /*       OPPORTUNITY TO DUMP (RSP2) - AFTER VOL PROCESSED   */ 02031000
*        /*                                                          */ 02032000
*        /************************************************************/ 02033000
*                                                                  0666 02034000
*              IF GDTDBG = NULLPTR                                 0666 02035000
*                THEN;                                             0666 02036000
@RF00664 DS    0H                                                  0666 02037000
@RC00662 L     @07,GDTDBG(,REG5)                                   0666 02038000
         LTR   @07,@07                                             0666 02039000
         BZ    @RT00666                                            0666 02040000
*                ELSE                                              0668 02041000
*                  CALL IDCDB010 (GDTTBL,'RSP2');                  0668 02042000
*                                                                  0668 02043000
         ST    REG5,@AL00001                                       0668 02044000
         LA    @07,@CC03549                                        0668 02045000
         ST    @07,@AL00001+4                                      0668 02046000
         MVI   @AL00001+4,X'80'                                    0668 02047000
         L     @15,GDTDBG(,REG5)                                   0668 02048000
         LA    @01,@AL00001                                        0668 02049000
         BALR  @14,@15                                             0668 02050000
*        /************************************************************/ 02051000
*        /*                                                          */ 02052000
*        /*   FREE UP ALL BITMAPS AND OTHER STORAGE REQUIRED         */ 02053000
*        /*                                                          */ 02054000
*        /************************************************************/ 02055000
*                                                                  0669 02056000
*              CALL IDCSAFP0 (GDTTBL,POOL11);                      0669 02057000
*                                                                  0669 02058000
@RT00666 ST    REG5,@AL00001                                       0669 02059000
         LA    @07,@CC00905                                        0669 02060000
         ST    @07,@AL00001+4                                      0669 02061000
         MVI   @AL00001+4,X'80'                                    0669 02062000
         L     @15,GDTFPL(,REG5)                                   0669 02063000
         LA    @01,@AL00001                                        0669 02064000
         BALR  @14,@15                                             0669 02065000
*        /************************************************************/ 02066000
*        /*                                                          */ 02067000
*        /*   FREE THE SPACE HEADER AND DSDIR SN TABLES FOR          */ 02068000
*        /*   REUSE BY FIND.                                         */ 02069000
*        /*                                                          */ 02070000
*        /************************************************************/ 02071000
*                                                                  0670 02072000
*              IF RSPVSNT6 ^= 0 THEN                               0670 02073000
         L     @07,RSPVSNT6(,REG6)                                 0670 02074000
         LTR   @07,@07                                             0670 02075000
         BZ    @RF00670                                            0670 02076000
*                RSPVSNT6->RSFENTLN = 0;                           0671 02077000
         MVI   RSFENTLN(@07),X'00'                                 0671 02078000
*              IF RSPVSNT8 ^= 0 THEN                               0672 02079000
@RF00670 L     @07,RSPVSNT8(,REG6)                                 0672 02080000
         LTR   @07,@07                                             0672 02081000
         BZ    @RF00672                                            0672 02082000
*                RSPVSNT8->RSFENTLN = 0;                           0673 02083000
*                                                                  0673 02084000
         MVI   RSFENTLN(@07),X'00'                                 0673 02085000
*        /************************************************************/ 02086000
*        /*                                                          */ 02087000
*        /*  FREE ALL POSSIBLY HELD RPLS                             */ 02088000
*        /*                                                          */ 02089000
*        /************************************************************/ 02090000
*                                                                  0674 02091000
*            RSGRABCU = ADDR(GRABSWF);                             0674 02092000
@RF00672 L     @07,RSIOTBL(,REG6)                                  0674 02093000
         ST    @07,RSGRABCU(,REG6)                                 0674 02094000
*            GRABCURR = GRABRAB1;                                  0675 02095000
*                                                                  0675 02096000
         L     @04,GRABRAB1(,@07)                                  0675 02097000
         ST    @04,GRABCURR(,@07)                                  0675 02098000
*            DO;                                                   0676 02099000
*              RSRECREQ = ''B;                                     0677 02100000
         XC    RSRECREQ(2,REG6),RSRECREQ(REG6)                     0677 02101000
*              RSRTERM = ON;     /* TERMRCD */                     0678 02102000
         OI    RSRTERM(REG6),B'00000010'                           0678 02103000
*              RSRWF = ON;       /* WORKFILE */                    0679 02104000
*                                                                  0679 02105000
         OI    RSRWF(REG6),B'10000000'                             0679 02106000
*            /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT         */ 02107000
*            CALL RECMGMT;                                         0680 02108000
         L     @15,@CV03452                                        0680 02109000
         BALR  @14,@15                                             0680 02110000
*              RFY RTNREG RSTD;                                    0681 02111000
*              TESTRC = RTNREG;                                    0682 02112000
         STH   RTNREG,TESTRC(,REG6)                                0682 02113000
*              RFY RTNREG UNRSTD;                                  0683 02114000
*            END;                                                  0684 02115000
*          END;                                                    0685 02116000
*                                                                  0685 02117000
*        END;                                                      0686 02118000
@RT00574 DS    0H                                                  0686 02119000
@DE00570 L     @07,RSVTBENT(,REG6)                                 0686 02120000
         TM    VOLSRLAS(@07),B'10000000'                           0686 02121000
         BNO   @DL00570                                            0686 02122000
* CALL EXIT;  /*TERMINATE*/                                        0687 02123000
         BAL   @14,EXIT                                            0687 02124000
* END PROCVOL; /*END OF PROCEDURE*/                                0688 02125000
@EL00010 DS    0H                                                  0688 02126000
@EF00010 DS    0H                                                  0688 02127000
@ER00010 BR    @14                                                 0688 02128000
@PB00010 DS    0H                                                  0689 02129000
*/********************************************************************/ 02130000
*/* PROCEDURE NAME - SETBITS                                         */ 02131000
*/*                                                                  */ 02132000
*/* FUNCTION -                                                       */ 02133000
*/*     TRANSLATES TTNNS INTO BITS IN THE FORM OF A SPACE MAP.       */ 02134000
*/*                                                                  */ 02135000
*/* INPUT -                                                          */ 02136000
*/*     VOLUME RECORD IN WORKFILE BUFFER 1                           */ 02137000
*/*     RSPVSETB - OPTION FLAGS                                      */ 02138000
*/*       RSSETCRA - USE TTNNS IN THE RESVOL ENTRY FOR THE CRA       */ 02139000
*/*       RSSETMAP - SET BITS FROM THE BITMAP (RSSTBMAP)             */ 02140000
*/*                  INTO ANOTHER MAP(RSTGBMAP).                     */ 02141000
*/*       RSST1TO1 - (ONLY FOR RSSETMAP OPTION)                      */ 02142000
*/*                  ON = SET BITS IN FROM MAP(RSSTBMAP) ON IN       */ 02143000
*/*                       TO MAP(RSTGBMAP)                           */ 02144000
*/*                  OFF = SET BITS IN FROM MAP(RSSTBMAP) OFF IN     */ 02145000
*/*                       TO MAP(RSTGBMAP)                           */ 02146000
*/*       RSPVCLBM - CLEAR THE TARGET BIT MAP PRIOR TO SETTING THE   */ 02147000
*/*                  BITS.                                           */ 02148000
*/*     RSTGBMAP - TARGET MAP TO SET THE BITS IN.                    */ 02149000
*/*     RSSTBMAP - ADDRESS OF FROM MAP FOR RSSETMAP OPTION           */ 02150000
*/*     RSMAPSIZ - SIZE OF THE MAP                                   */ 02151000
*/*     RSWASNVT - SN TAB FOR VOLGO OR SPACE HEADER (FOR TTNN(S)     */ 02152000
*/*                IF NOT A CRA TYPE OF SET.                         */ 02153000
*/*     RSENTPT - ADDRESS OF THE RESVOL ENTRY (TTNN(S)) IF A         */ 02154000
*/*               CRA TYPE OF SET.                                   */ 02155000
*/*                                                                  */ 02156000
*/* OUTPUT -                                                         */ 02157000
*/*     RSSETERR - ON IF TRACKS BEYOND VOLUMES PHYSICAL GEOMETRY     */ 02158000
*/*     BITS SET TO 1S IN THE TARGET MAP.                            */ 02159000
*/*                                                                  */ 02160000
*/********************************************************************/ 02161000
*      GENERATE;                                                   0689 02162000
         DS    0F                                                       02163000
NAME0054 DC    CL8'SETBITS'                                             02164000
*SETBITS: PROCEDURE                                                0690 02165000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0690 02166000
*                                                                  0690 02167000
         B     @PB00011                                            0690 02168000
SETBITS  DS    0H                                                  0691 02169000
*      GENERATE REFS(RS03RG08, REG6);                              0691 02170000
*                                                                  0691 02171000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          02172000
         LR    @15,@13  OLD SAVE AREA                                   02173000
         LA    @13,72(@13)  NEW SAVE AREA                               02174000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     02175000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        02176000
         MVC   0(4,@15),NAME0054  PROCNAME TO REGSAVE                   02177000
*        OLDERID2 = NEWERID2;                                      0692 02178000
         L     @07,GDTTR2(,REG5)                                   0692 02179000
         MVC   @TS00001(95),NEWERID2(@07)                          0692 02180000
         MVC   OLDERID2(95,@07),@TS00001                           0692 02181000
*        NEWID2 = 'RSST';                                          0693 02182000
*                                                                  0693 02183000
         MVC   NEWID2(4,@07),@CC03553                              0693 02184000
*        RFY BMAP BASED(RSTOMAP);      /*DEFAULT BIT MAP             */ 02185000
*        RFY SNTTNN BASED(RSSETTT);    /*TTNN MAP                    */ 02186000
*        RSSETERR = OFF;               /*RESET ERROR                 */ 02187000
*                                                                  0696 02188000
         NI    RSSETERR(REG6),B'11110111'                          0696 02189000
*        /************************************************************/ 02190000
*        /*                                                          */ 02191000
*        /*  CLEAR THE TARGET MAP                                    */ 02192000
*        /*                                                          */ 02193000
*        /************************************************************/ 02194000
*                                                                  0697 02195000
*        IF RSPVCLBM = ON THEN                                     0697 02196000
         TM    RSPVCLBM(REG6),B'00100000'                          0697 02197000
         BNO   @RF00697                                            0697 02198000
*          DO;                                                     0698 02199000
*            RSTOMAP = RSTGBMAP;       /*TARGET MAP ADDR             */ 02200000
         L     @07,RSTGBMAP(,REG6)                                 0699 02201000
         ST    @07,RSTOMAP(,REG6)                                  0699 02202000
*            DO TMPSZ = RSMAPSIZ BY -256 WHILE(TMPSZ>256);         0700 02203000
         L     @07,RSMAPSIZ(,REG6)                                 0700 02204000
         ST    @07,TMPSZ(,REG6)                                    0700 02205000
         B     @DE00700                                            0700 02206000
@DL00700 DS    0H                                                  0701 02207000
*                                      /*CLEAR MAX INSTRUCTION SIZE  */ 02208000
*              BMAP(1:256) = BMAP(1:256) && BMAP(1:256);           0701 02209000
         L     @07,RSTOMAP(,REG6)                                  0701 02210000
         XC    BMAP(256,@07),BMAP(@07)                             0701 02211000
*              RSTOMAP = RSTOMAP + 256; /*NEXT SEGMENT               */ 02212000
         AL    @07,@CF03188                                        0702 02213000
         ST    @07,RSTOMAP(,REG6)                                  0702 02214000
*            END;                                                  0703 02215000
         L     @07,@CF03546                                        0703 02216000
         AL    @07,TMPSZ(,REG6)                                    0703 02217000
         ST    @07,TMPSZ(,REG6)                                    0703 02218000
@DE00700 L     @07,TMPSZ(,REG6)                                    0703 02219000
         C     @07,@CF03188                                        0703 02220000
         BH    @DL00700                                            0703 02221000
*            BMAP(1:TMPSZ) = BMAP(1:TMPSZ) && BMAP(1:TMPSZ);       0704 02222000
         L     @04,RSTOMAP(,REG6)                                  0704 02223000
         BCTR  @07,0                                               0704 02224000
         EX    @07,@SX03737                                        0704 02225000
*                                      /*CLEAR LAST LITTLE BIT       */ 02226000
*          END;                                                    0705 02227000
*                                                                  0705 02228000
*        /************************************************************/ 02229000
*        /*                                                          */ 02230000
*        /*                 CRA INITIALIZATION                       */ 02231000
*        /*                                                          */ 02232000
*        /************************************************************/ 02233000
*                                                                  0706 02234000
*        IF RSSETCRA = ON THEN                                     0706 02235000
@RF00697 TM    RSSETCRA(REG6),B'10000000'                          0706 02236000
         BNO   @RF00706                                            0706 02237000
*          DO;                                                     0707 02238000
*            RSPVNEXT = RESVLNEX;      /*NUMBER OF EXTENTS           */ 02239000
         L     @07,RSENTPT(,REG6)                                  0708 02240000
         LH    @04,RESVLNEX(,@07)                                  0708 02241000
         STH   @04,RSPVNEXT(,REG6)                                 0708 02242000
*            RSSETTT = ADDR(RESVLEXT); /*1ST TTNN                    */ 02243000
         LA    @07,RESVLEXT(,@07)                                  0709 02244000
         ST    @07,RSSETTT(,REG6)                                  0709 02245000
*          END;                                                    0710 02246000
*                                                                  0710 02247000
*        /************************************************************/ 02248000
*        /*                                                          */ 02249000
*        /*                 MAP TO MAP INITIALIZATION                */ 02250000
*        /*                                                          */ 02251000
*        /************************************************************/ 02252000
*                                                                  0711 02253000
*        ELSE                                                      0711 02254000
*          IF RSSETMAP = ON THEN;                                  0711 02255000
*                                                                  0711 02256000
         B     @RC00706                                            0711 02257000
@RF00706 TM    RSSETMAP(REG6),B'01000000'                          0711 02258000
         BO    @RT00711                                            0711 02259000
*        /************************************************************/ 02260000
*        /*                                                          */ 02261000
*        /*                 VOLUME GROUP OCCURRENCE                  */ 02262000
*        /*                                                          */ 02263000
*        /************************************************************/ 02264000
*                                                                  0713 02265000
*          ELSE                                                    0713 02266000
*            IF RSFGCODE = GCVOLGO THEN                            0713 02267000
         L     @07,RSWASNVT(,REG6)                                 0713 02268000
         CLI   RSFGCODE(@07),3                                     0713 02269000
         BNE   @RF00713                                            0713 02270000
*              DO;                                                 0714 02271000
*                RSPVNEXT = SNTTNNC;   /*NUMBER OF EXTENTS           */ 02272000
         L     @04,RSFAENT(,@07)                                   0715 02273000
         SLR   @15,@15                                             0715 02274000
         IC    @15,SNTTNNC(,@04)                                   0715 02275000
         STH   @15,RSPVNEXT(,REG6)                                 0715 02276000
*                RSSETTT = RSFATTNN + (SNTTNNX-1)*LENGTH(SNTTNN);  0716 02277000
         SLR   @15,@15                                             0716 02278000
         IC    @15,SNTTNNX(,@04)                                   0716 02279000
         BCTR  @15,0                                               0716 02280000
         SLA   @15,2                                               0716 02281000
         AL    @15,RSFATTNN(,@07)                                  0716 02282000
         ST    @15,RSSETTT(,REG6)                                  0716 02283000
*                                      /*1ST TTNN                    */ 02284000
*              END;                                                0717 02285000
*                                                                  0717 02286000
*        /************************************************************/ 02287000
*        /*                                                          */ 02288000
*        /*                 SPACE HEADER                             */ 02289000
*        /*                                                          */ 02290000
*        /************************************************************/ 02291000
*                                                                  0718 02292000
*            ELSE                                                  0718 02293000
*              IF RSFGCODE = GCSPCHDR THEN                         0718 02294000
         B     @RC00713                                            0718 02295000
@RF00713 L     @07,RSWASNVT(,REG6)                                 0718 02296000
         CLI   RSFGCODE(@07),6                                     0718 02297000
         BNE   @RF00718                                            0718 02298000
*                DO;                                               0719 02299000
*                  RSPVNEXT = SNODSPXT; /*NUMBER OF EXTENTS          */ 02300000
         L     @07,RSFAENT(,@07)                                   0720 02301000
         SLR   @04,@04                                             0720 02302000
         IC    @04,SNODSPXT(,@07)                                  0720 02303000
         STH   @04,RSPVNEXT(,REG6)                                 0720 02304000
*                  RSSETTT = ADDR(SSPEXTNT); /* 1ST TTNN             */ 02305000
         LA    @07,SSPEXTNT(,@07)                                  0721 02306000
         ST    @07,RSSETTT(,REG6)                                  0721 02307000
*                END;                                              0722 02308000
*                                                                  0722 02309000
*        /************************************************************/ 02310000
*        /*                                                          */ 02311000
*        /*                    BAD INPUT                             */ 02312000
*        /*                                                          */ 02313000
*        /************************************************************/ 02314000
*                                                                  0723 02315000
*              ELSE                                                0723 02316000
*                                                                  0723 02317000
*                DO;                                               0723 02318000
         B     @RC00718                                            0723 02319000
@RF00718 DS    0H                                                  0724 02320000
*                /*CALL CKERR*/                                    0724 02321000
*                  RSCKERR = RSCKERR && RSCKERR;                   0724 02322000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0724 02323000
*                  RSCKERN = RSE100;                               0725 02324000
         MVC   RSCKERN(2,REG6),@CH00143                            0725 02325000
*                  RSCKTERM = 'TERM';                              0726 02326000
*                                                                  0726 02327000
         MVC   RSCKTERM(4,REG6),@CC03527                           0726 02328000
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */ 02329000
*                CALL CKERR;                                       0727 02330000
         L     @15,@CV03443                                        0727 02331000
         BALR  @14,@15                                             0727 02332000
*                END;                                              0728 02333000
*                                                                  0728 02334000
*        /************************************************************/ 02335000
*        /*                                                          */ 02336000
*        /*  SET A BITMAP FROM ANOTHER BITMAP                        */ 02337000
*        /*                                                          */ 02338000
*        /************************************************************/ 02339000
*                                                                  0729 02340000
*        IF RSSETMAP = ON THEN                                     0729 02341000
@RC00718 DS    0H                                                  0729 02342000
@RC00713 DS    0H                                                  0729 02343000
@RT00711 DS    0H                                                  0729 02344000
@RC00706 TM    RSSETMAP(REG6),B'01000000'                          0729 02345000
         BNO   @RF00729                                            0729 02346000
*  SETMAP:                                                         0730 02347000
*          DO;                                                     0730 02348000
SETMAP   DS    0H                                                  0731 02349000
*            RSTOMAP = RSTGBMAP;       /*TARGET MAP                  */ 02350000
         L     @07,RSTGBMAP(,REG6)                                 0731 02351000
         ST    @07,RSTOMAP(,REG6)                                  0731 02352000
*            RSFROMAP = RSSTBMAP;      /*FROM MAP                    */ 02353000
         L     @07,RSSTBMAP(,REG6)                                 0732 02354000
         ST    @07,RSFROMAP(,REG6)                                 0732 02355000
*            DO TMPSZ = RSMAPSIZ BY -256 WHILE(TMPSZ>256);         0733 02356000
         L     @07,RSMAPSIZ(,REG6)                                 0733 02357000
         ST    @07,TMPSZ(,REG6)                                    0733 02358000
         B     @DE00733                                            0733 02359000
@DL00733 DS    0H                                                  0734 02360000
*              IF RSST1TO1 = ON THEN   /*SET BITS ON                 */ 02361000
         TM    RSST1TO1(REG6),B'00010000'                          0734 02362000
         BNO   @RF00734                                            0734 02363000
*                BMAP(1:256) = BMAP(1:256) | RSFROMAP->BMAP(1:256);     02364000
         L     @07,RSTOMAP(,REG6)                                  0735 02365000
         L     @04,RSFROMAP(,REG6)                                 0735 02366000
         OC    BMAP(256,@07),BMAP(@04)                             0735 02367000
*              ELSE                    /*SET BITS OFF                */ 02368000
*                DO;                                               0736 02369000
         B     @RC00734                                            0736 02370000
@RF00734 DS    0H                                                  0737 02371000
*                  BMAP(1:256) = BMAP(1:256) | RSFROMAP->BMAP(1:256);   02372000
         L     @07,RSTOMAP(,REG6)                                  0737 02373000
         L     @04,RSFROMAP(,REG6)                                 0737 02374000
         OC    BMAP(256,@07),BMAP(@04)                             0737 02375000
*                                      /*ENSURE BITS TO BE SET OFF   */ 02376000
*                                      /*ARE ON IN TARGET            */ 02377000
*                  BMAP(1:256) = BMAP(1:256) && RSFROMAP->BMAP(1:256);  02378000
         XC    BMAP(256,@07),BMAP(@04)                             0738 02379000
*                                      /*NOW SET BITS OFF            */ 02380000
*                END;                                              0739 02381000
*              RSTOMAP = RSTOMAP + 256; /*NEXT PART OF MAP           */ 02382000
@RC00734 LA    @07,256                                             0740 02383000
         L     @04,RSTOMAP(,REG6)                                  0740 02384000
         ALR   @04,@07                                             0740 02385000
         ST    @04,RSTOMAP(,REG6)                                  0740 02386000
*              RSFROMAP = RSFROMAP + 256;                          0741 02387000
         AL    @07,RSFROMAP(,REG6)                                 0741 02388000
         ST    @07,RSFROMAP(,REG6)                                 0741 02389000
*            END;                                                  0742 02390000
*                                                                  0742 02391000
         L     @07,@CF03546                                        0742 02392000
         AL    @07,TMPSZ(,REG6)                                    0742 02393000
         ST    @07,TMPSZ(,REG6)                                    0742 02394000
@DE00733 L     @07,TMPSZ(,REG6)                                    0742 02395000
         C     @07,@CF03188                                        0742 02396000
         BH    @DL00733                                            0742 02397000
*        /************************************************************/ 02398000
*        /*                                                          */ 02399000
*        /*     SET LAST LITTLE BIT                                  */ 02400000
*        /*                                                          */ 02401000
*        /************************************************************/ 02402000
*                                                                  0743 02403000
*            IF RSST1TO1 = ON THEN     /*SET BITS ON                 */ 02404000
         TM    RSST1TO1(REG6),B'00010000'                          0743 02405000
         BNO   @RF00743                                            0743 02406000
*              BMAP(1:TMPSZ) = BMAP(1:TMPSZ) |                     0744 02407000
*               RSFROMAP->BMAP(1:256);                             0744 02408000
         L     @04,RSTOMAP(,REG6)                                  0744 02409000
         BCTR  @07,0                                               0744 02410000
         L     @01,RSFROMAP(,REG6)                                 0744 02411000
         EX    @07,@SO03739                                        0744 02412000
*            ELSE                      /*SET BITS OFF                */ 02413000
*              DO;                                                 0745 02414000
         B     @RC00743                                            0745 02415000
@RF00743 DS    0H                                                  0746 02416000
*                BMAP(1:TMPSZ) = BMAP(1:TMPSZ) |                   0746 02417000
*                 RSFROMAP->BMAP(1:TMPSZ);                         0746 02418000
         L     @07,RSTOMAP(,REG6)                                  0746 02419000
         L     @04,TMPSZ(,REG6)                                    0746 02420000
         BCTR  @04,0                                               0746 02421000
         L     @15,RSFROMAP(,REG6)                                 0746 02422000
         EX    @04,@SO03741                                        0746 02423000
*                                      /*ENSURE BITS TO BE SET OFF   */ 02424000
*                                      /*ARE ON IN TARGET            */ 02425000
*                BMAP(1:TMPSZ) = BMAP(1:TMPSZ) &&                  0747 02426000
*                 RSFROMAP->BMAP(1:TMPSZ);                         0747 02427000
         EX    @04,@SX03743                                        0747 02428000
*                                      /*NOW SET BITS OFF            */ 02429000
*              END;                                                0748 02430000
*          END SETMAP;                                             0749 02431000
*                                                                  0749 02432000
*        /************************************************************/ 02433000
*        /*                                                          */ 02434000
*        /*  FILTER OUT CANDIDATE REQUESTS - THEY HAVE NO EXTENTS    */ 02435000
*        /*                                                          */ 02436000
*        /************************************************************/ 02437000
*                                                                  0750 02438000
*        ELSE                                                      0750 02439000
*          IF RSPVNEXT = 0 THEN;                                   0750 02440000
*                                                                  0750 02441000
         B     @RC00729                                            0750 02442000
@RF00729 LH    @07,RSPVNEXT(,REG6)                                 0750 02443000
         LTR   @07,@07                                             0750 02444000
         BZ    @RT00750                                            0750 02445000
*        /************************************************************/ 02446000
*        /*                                                          */ 02447000
*        /*  CONVERT INPUT TTNN(S) TO BITS.                          */ 02448000
*        /*                                                          */ 02449000
*        /************************************************************/ 02450000
*                                                                  0752 02451000
*          ELSE                                                    0752 02452000
*  SETEXT:                                                         0752 02453000
*            DO RSPVTNEX = 1 TO RSPVNEXT;                          0752 02454000
SETEXT   LA    @07,1                                               0752 02455000
         B     @DE00752                                            0752 02456000
@DL00752 DS    0H                                                  0753 02457000
*              RSTOMAP = RSTGBMAP + (SNTT(RSPVTNEX)/8); /*START BYTE */ 02458000
         L     @07,RSTGBMAP(,REG6)                                 0753 02459000
         LH    @04,RSPVTNEX(,REG6)                                 0753 02460000
         SLA   @04,2                                               0753 02461000
         L     @15,RSSETTT(,REG6)                                  0753 02462000
         LA    @01,0(@04,@15)                                      0753 02463000
         AL    @01,@CF03727                                        0753 02464000
         LH    @14,SNTT(,@01)                                      0753 02465000
         LR    @00,@14                                             0753 02466000
         SRDA  @00,32                                              0753 02467000
         D     @00,@CF00175                                        0753 02468000
         ALR   @01,@07                                             0753 02469000
         ST    @01,RSTOMAP(,REG6)                                  0753 02470000
*              RSBITPOS = SNTT(RSPVTNEX)//8; /*FIRST BIT POSITION    */ 02471000
         SRDA  @14,32                                              0754 02472000
         D     @14,@CF00175                                        0754 02473000
         STH   @14,RSBITPOS(,REG6)                                 0754 02474000
*              RSPVNN = SNNN(RSPVTNEX); /*NO. OF TRACKS              */ 02475000
         L     @15,RSSETTT(,REG6)                                  0755 02476000
         BCTR  @15,0                                               0755 02477000
         BCTR  @15,0                                               0755 02478000
         LH    @04,SNNN-2(@04,@15)                                 0755 02479000
         STH   @04,RSPVNN(,REG6)                                   0755 02480000
*              IF RSTOMAP => (RSTGBMAP + RSMAPSIZ) THEN            0756 02481000
         AL    @07,RSMAPSIZ(,REG6)                                 0756 02482000
         CR    @01,@07                                             0756 02483000
         BL    @RF00756                                            0756 02484000
*                RSSETERR = ON;          /*TRACKS DON'T EXIST        */ 02485000
*                                                                  0757 02486000
         OI    RSSETERR(REG6),B'00001000'                          0757 02487000
*        /************************************************************/ 02488000
*        /*                                                          */ 02489000
*        /*     ALLOW FOR ONE BYTE OR LESS IN THE MAP                */ 02490000
*        /*                                                          */ 02491000
*        /************************************************************/ 02492000
*                                                                  0758 02493000
*              ELSE                                                0758 02494000
*                DO;                                               0758 02495000
         B     @RC00756                                            0758 02496000
@RF00756 DS    0H                                                  0759 02497000
*                  IF RSPVNN =< (8-RSBITPOS) THEN                  0759 02498000
         LH    @07,RSBITPOS(,REG6)                                 0759 02499000
         LA    @04,8                                               0759 02500000
         SLR   @04,@07                                             0759 02501000
         CH    @04,RSPVNN(,REG6)                                   0759 02502000
         BL    @RF00759                                            0759 02503000
*                    DO;                                           0760 02504000
*                      RSBITPOS = RSBITPOS + 1; /*START BIT          */ 02505000
         AL    @07,@CF00212                                        0761 02506000
         STH   @07,RSBITPOS(,REG6)                                 0761 02507000
*                      RSMASK = MASKVAL(RSBITPOS:RSBITPOS);        0762 02508000
         SLR   @04,@04                                             0762 02509000
         IC    @04,MASKVAL-1(@07)                                  0762 02510000
         STC   @04,RSMASK(,REG6)                                   0762 02511000
*                                      /*GET ELIGIBLE RIGHT BITS     */ 02512000
*                      RSBITPOS = RSBITPOS + SNNN(RSPVTNEX) - 1;   0763 02513000
         LH    @15,RSPVTNEX(,REG6)                                 0763 02514000
         SLA   @15,2                                               0763 02515000
         L     @01,RSSETTT(,REG6)                                  0763 02516000
         BCTR  @01,0                                               0763 02517000
         BCTR  @01,0                                               0763 02518000
         AH    @07,SNNN-2(@15,@01)                                 0763 02519000
         BCTR  @07,0                                               0763 02520000
         STH   @07,RSBITPOS(,REG6)                                 0763 02521000
*                                      /*LAST BIT POSITION           */ 02522000
*                      RSMASK = RSMASK & MASKV1(RSBITPOS:RSBITPOS);     02523000
         SLR   @15,@15                                             0764 02524000
         IC    @15,MASKV1-1(@07)                                   0764 02525000
         NR    @04,@15                                             0764 02526000
         STC   @04,RSMASK(,REG6)                                   0764 02527000
*                                      /*SET BITS ON IN THE MASK     */ 02528000
*                      BMAP(1:1) = BMAP(1:1) | RSMASK; /*SET BIT MAP */ 02529000
         L     @07,RSTOMAP(,REG6)                                  0765 02530000
         SLR   @15,@15                                             0765 02531000
         IC    @15,BMAP(,@07)                                      0765 02532000
         OR    @04,@15                                             0765 02533000
         STC   @04,BMAP(,@07)                                      0765 02534000
*                    END;                                          0766 02535000
*                                                                  0766 02536000
*        /************************************************************/ 02537000
*        /*                                                          */ 02538000
*        /*     MULTIPLE BYTE MAP - HANDLE FIRST BYTE                */ 02539000
*        /*                                                          */ 02540000
*        /************************************************************/ 02541000
*                                                                  0767 02542000
*                  ELSE                                            0767 02543000
*                    DO;                                           0767 02544000
         B     @RC00759                                            0767 02545000
@RF00759 DS    0H                                                  0768 02546000
*                      IF RSBITPOS ^= 0 THEN /*ALLOW FR SMALL 1ST BYT*/ 02547000
         LH    @07,RSBITPOS(,REG6)                                 0768 02548000
         LTR   @07,@07                                             0768 02549000
         BZ    @RF00768                                            0768 02550000
*                        DO;                                       0769 02551000
*                          RSPVNN = RSPVNN - (8 - RSBITPOS);       0770 02552000
         LA    @04,8                                               0770 02553000
         SLR   @04,@07                                             0770 02554000
         LCR   @04,@04                                             0770 02555000
         AH    @04,RSPVNN(,REG6)                                   0770 02556000
         STH   @04,RSPVNN(,REG6)                                   0770 02557000
*                                      /*FACTOR OUT NO. TRKS 1ST BYTE*/ 02558000
*                          RSBITPOS = RSBITPOS + 1; /*START BIT      */ 02559000
         LA    @04,1                                               0771 02560000
         ALR   @07,@04                                             0771 02561000
         STH   @07,RSBITPOS(,REG6)                                 0771 02562000
*                          BMAP(1:1) = BMAP(1:1) |                 0772 02563000
*                                    MASKVAL(RSBITPOS:RSBITPOS);   0772 02564000
         L     @15,RSTOMAP(,REG6)                                  0772 02565000
         LA    @14,MASKVAL-1(@07)                                  0772 02566000
         OC    BMAP(1,@15),0(@14)                                  0772 02567000
*                                      /*FIRST BYTE SET              */ 02568000
*                          RSTOMAP = RSTOMAP + 1; /*NEXT BYTE        */ 02569000
         ALR   @15,@04                                             0773 02570000
         ST    @15,RSTOMAP(,REG6)                                  0773 02571000
*                        END;                                      0774 02572000
*                                                                  0774 02573000
*        /************************************************************/ 02574000
*        /*                                                          */ 02575000
*        /*     HANDLE FULL BYTES                                    */ 02576000
*        /*                                                          */ 02577000
*        /************************************************************/ 02578000
*                                                                  0775 02579000
*                      DO RSPVNN = RSPVNN BY -8 WHILE(RSPVNN > 8); 0775 02580000
@RF00768 B     @DE00775                                            0775 02581000
@DL00775 DS    0H                                                  0776 02582000
*                        BMAP(1:1) = MASKALL; /*FULL BYTE            */ 02583000
         L     @07,RSTOMAP(,REG6)                                  0776 02584000
         MVC   BMAP(1,@07),MASKALL                                 0776 02585000
*                        RSTOMAP = RSTOMAP + 1; /*NEXT BYTE          */ 02586000
         AL    @07,@CF00212                                        0777 02587000
         ST    @07,RSTOMAP(,REG6)                                  0777 02588000
*                      END;                                        0778 02589000
*                                                                  0778 02590000
         L     @07,@CF03560                                        0778 02591000
         AH    @07,RSPVNN(,REG6)                                   0778 02592000
         STH   @07,RSPVNN(,REG6)                                   0778 02593000
@DE00775 LH    @07,RSPVNN(,REG6)                                   0778 02594000
         C     @07,@CF00175                                        0778 02595000
         BH    @DL00775                                            0778 02596000
*        /************************************************************/ 02597000
*        /*                                                          */ 02598000
*        /*     HANDLE LAST BYTE                                     */ 02599000
*        /*                                                          */ 02600000
*        /************************************************************/ 02601000
*                                                                  0779 02602000
*                      BMAP(1:1) = BMAP(1:1) | MASKV1(RSPVNN:RSPVNN);   02603000
         L     @04,RSTOMAP(,REG6)                                  0779 02604000
         LA    @01,MASKV1-1(@07)                                   0779 02605000
         OC    BMAP(1,@04),0(@01)                                  0779 02606000
*                    END;                                          0780 02607000
*                END;                                              0781 02608000
@RC00759 DS    0H                                                  0782 02609000
*            END SETEXT;               /*END OF AN EXTENT            */ 02610000
*                                                                  0782 02611000
@RC00756 LA    @07,1                                               0782 02612000
         AH    @07,RSPVTNEX(,REG6)                                 0782 02613000
@DE00752 STH   @07,RSPVTNEX(,REG6)                                 0782 02614000
         CH    @07,RSPVNEXT(,REG6)                                 0782 02615000
         BNH   @DL00752                                            0782 02616000
*        /************************************************************/ 02617000
*        /*                                                          */ 02618000
*        /*  TERMINATE - THE SET WAS DONE                            */ 02619000
*        /*                                                          */ 02620000
*        /************************************************************/ 02621000
*                                                                  0783 02622000
*        IF GDTDBG = NULLPTR                                       0783 02623000
*          THEN;                                                   0783 02624000
@RT00750 DS    0H                                                  0783 02625000
@RC00729 L     @07,GDTDBG(,REG5)                                   0783 02626000
         LTR   @07,@07                                             0783 02627000
         BZ    @RT00783                                            0783 02628000
*          ELSE                                                    0785 02629000
*            CALL IDCDB010 (GDTTBL,'RSS3');                        0785 02630000
*                                                                  0785 02631000
         ST    REG5,@AL00001                                       0785 02632000
         LA    @07,@CC03561                                        0785 02633000
         ST    @07,@AL00001+4                                      0785 02634000
         MVI   @AL00001+4,X'80'                                    0785 02635000
         L     @15,GDTDBG(,REG5)                                   0785 02636000
         LA    @01,@AL00001                                        0785 02637000
         BALR  @14,@15                                             0785 02638000
*        RFY BMAP;                     /*REVERT                      */ 02639000
@RT00783 DS    0H                                                  0787 02640000
*        RFY SNTTNN;                   /*REVERT                      */ 02641000
*                                                                  0787 02642000
* CALL EXIT;  /*TERMINATE*/                                        0788 02643000
         BAL   @14,EXIT                                            0788 02644000
* END SETBITS; /*END OF PROCEDURE*/                                0789 02645000
@EL00011 DS    0H                                                  0789 02646000
@EF00011 DS    0H                                                  0789 02647000
@ER00011 BR    @14                                                 0789 02648000
@PB00011 DS    0H                                                  0790 02649000
*/********************************************************************/ 02650000
*/* PROCEDURE NAME - SETBMAP                                         */ 02651000
*/*                                                                  */ 02652000
*/* FUNCTION -                                                       */ 02653000
*/*     SET THE BIT MAPS FOR A VOLUME GROUP OCCURRENCE.              */ 02654000
*/*                                                                  */ 02655000
*/*     IF THE VOLUME BEING PROCESSED IS THE SAME AS THE             */ 02656000
*/*     CRA FOR THE DATA OR INDEX, IT STANDS A BETTER CHANCE         */ 02657000
*/*     OF BEING CORRECT THAT A DATA OR INDEX ON ANOTHER CRA.        */ 02658000
*/*     SUBALLOCATE FROM THE PRIME BIT MAP. IF THIS IS IN            */ 02659000
*/*     CONFLICT WITH ANOTHER CLAIM IN THE PRIME MAP, MARK           */ 02660000
*/*     THE VGO UNUSABLE, DELETE THE DSDIR, AND SET THE PRIMARY      */ 02661000
*/*     AND SECONDARY CONFLICT MAPS.                                 */ 02662000
*/*                                                                  */ 02663000
*/*     IF THE VOLUME BEING PROCESSED IS NOT THE SAME AS THE CRA     */ 02664000
*/*     FOR THE DATA OR INDEX, ENSURE THAT THE VGO IS NOT IN         */ 02665000
*/*     CONFLICT WITH ITSELF (SECONDARY) OR PRIMARY REQUESTS.        */ 02666000
*/*     IF IT IS, SET THE SECONDARY CONFLICT MAP, DELETE THE         */ 02667000
*/*     DSDIR, AND MARK THE VGO UNUSABLE.                            */ 02668000
*/*                                                                  */ 02669000
*/*     NOTE - A SECOND PASS IS MADE BY VLRESET IF A                 */ 02670000
*/*     CONFLICT OCCURRED, SO AS TO DELETE THOSE DSDIRS              */ 02671000
*/*     PREVIOUSLY THOUGHT OF AS NOT IN CONFLICT. PRIMARY            */ 02672000
*/*     CONFLICTS CAUSE ALL CONFLICTING REQUESTS TO BE DELETED.      */ 02673000
*/*     SECONDARY CONFLICTS ONLY CAUSE CONFLICTING REQUESTS          */ 02674000
*/*     FROM ANOTHER CRA TO BE DELETED.                              */ 02675000
*/*                                                                  */ 02676000
*/* INPUT -                                                          */ 02677000
*/*     RSPVSNT3 - VGO SN TABLE                                      */ 02678000
*/*     VOLSRSER - CURRENT VOLUME SERIAL NUMBER                      */ 02679000
*/*     GRABRAB2->BUFFER FOR DATA OR INDEX                           */ 02680000
*/*                                                                  */ 02681000
*/* OUTPUT -                                                         */ 02682000
*/*     RSPVRPC - ON=PRIMARY CONFLICT                                */ 02683000
*/*     RSPVRSC - ON=SECONDARY CONFLICT                              */ 02684000
*/*                                                                  */ 02685000
*/********************************************************************/ 02686000
*      GENERATE;                                                   0790 02687000
         DS    0F                                                       02688000
NAME0058 DC    CL8'SETBMAP'                                             02689000
*SETBMAP: PROCEDURE                                                0791 02690000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0791 02691000
*                                                                  0791 02692000
         B     @PB00012                                            0791 02693000
SETBMAP  DS    0H                                                  0792 02694000
*      GENERATE REFS(RS03RG08, REG6);                              0792 02695000
*                                                                  0792 02696000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          02697000
         LR    @15,@13  OLD SAVE AREA                                   02698000
         LA    @13,72(@13)  NEW SAVE AREA                               02699000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     02700000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        02701000
         MVC   0(4,@15),NAME0058  PROCNAME TO REGSAVE                   02702000
*        OLDERID2 = NEWERID2;                                      0793 02703000
         L     @07,GDTTR2(,REG5)                                   0793 02704000
         MVC   @TS00001(95),NEWERID2(@07)                          0793 02705000
         MVC   OLDERID2(95,@07),@TS00001                           0793 02706000
*        NEWID2 = 'RSSB';                                          0794 02707000
*                                                                  0794 02708000
         MVC   NEWID2(4,@07),@CC03566                              0794 02709000
*        /************************************************************/ 02710000
*        /*                                                          */ 02711000
*        /*                       INITIALIZE                         */ 02712000
*        /*                                                          */ 02713000
*        /************************************************************/ 02714000
*                                                                  0795 02715000
*        RSPERROR = OFF;               /*RESET PRIMARY ERROR         */ 02716000
*        RSSERROR = OFF;               /*RESET SECONDARY ERROR       */ 02717000
*                                                                  0796 02718000
         NI    RSPERROR(REG6),B'11001111'                          0796 02719000
*        /************************************************************/ 02720000
*        /*                                                          */ 02721000
*        /*  MAP ALL OF THE VGOS FOR THE DSDIR BEING PROCESSED       */ 02722000
*        /*                                                          */ 02723000
*        /************************************************************/ 02724000
*                                                                  0797 02725000
*        RSWASNVT = RSPVSNT3;          /*USE VGO SNTABLE             */ 02726000
         L     @07,RSPVSNT3(,REG6)                                 0797 02727000
         ST    @07,RSWASNVT(,REG6)                                 0797 02728000
*        RSCSFAE = RSFAENT;            /*INITIAL MATCHING VGO SNTAB  */ 02729000
         L     @04,RSFAENT(,@07)                                   0798 02730000
         ST    @04,RSCSFAE(,REG6)                                  0798 02731000
*        RSCSFCN = RSFCNDX;                                        0799 02732000
         LH    @07,RSFCNDX(,@07)                                   0799 02733000
         STH   @07,RSCSFCN(,REG6)                                  0799 02734000
*  SETBALLV:                                                       0800 02735000
*        DO RSFCNDX = RSFCNDX TO RSFHNDX;                          0800 02736000
SETBALLV L     @07,RSWASNVT(,REG6)                                 0800 02737000
         LH    @07,RSFCNDX(,@07)                                   0800 02738000
         B     @DE00800                                            0800 02739000
@DL00800 DS    0H                                                  0801 02740000
*          RSFAENT = RSFCADR + RSFENTLN * (RSFCNDX - 1);           0801 02741000
         L     @07,RSWASNVT(,REG6)                                 0801 02742000
         LH    @04,RSFCNDX(,@07)                                   0801 02743000
         BCTR  @04,0                                               0801 02744000
         LR    @01,@04                                             0801 02745000
         SLR   @04,@04                                             0801 02746000
         IC    @04,RSFENTLN(,@07)                                  0801 02747000
         MR    @00,@04                                             0801 02748000
         AL    @01,RSFCADR(,@07)                                   0801 02749000
         ST    @01,RSFAENT(,@07)                                   0801 02750000
*                                      /*VGO SNTAB ADDR              */ 02751000
*          IF (SNVOLSER = RSCSFAE->SNVOLSER) &                     0802 02752000
*             (SDSDIRSN = RSCSFAE->SDSDIRSN) THEN                  0802 02753000
         L     @07,RSCSFAE(,REG6)                                  0802 02754000
         CLC   SNVOLSER(6,@01),SNVOLSER(@07)                       0802 02755000
         BNE   @RF00802                                            0802 02756000
         CLC   SDSDIRSN(2,@01),SDSDIRSN(@07)                       0802 02757000
         BNE   @RF00802                                            0802 02758000
*  SETBONEV:                                                       0803 02759000
*            DO;                                                   0803 02760000
*                                                                  0803 02761000
SETBONEV DS    0H                                                  0804 02762000
*        /************************************************************/ 02763000
*        /*                                                          */ 02764000
*        /*  TRANSLATE TRACK(S) REQUEST INTO SPACE MAP               */ 02765000
*        /*                                                          */ 02766000
*        /************************************************************/ 02767000
*                                                                  0804 02768000
*              RSTGBMAP = RSWKBMAP;    /*SET IN WORKING MAP          */ 02769000
         L     @07,RSWKBMAP(,REG6)                                 0804 02770000
         ST    @07,RSTGBMAP(,REG6)                                 0804 02771000
*              RSPVSETB = ''B;         /*CLEAR SETBITS OPTIONS       */ 02772000
         MVI   RSPVSETB(REG6),X'00'                                0805 02773000
*              IF RSFCNDX = RSCSFCN THEN /*1ST MATCHING VGO ONLY     */ 02774000
         L     @07,RSWASNVT(,REG6)                                 0806 02775000
         CLC   RSFCNDX(2,@07),RSCSFCN(REG6)                        0806 02776000
         BNE   @RF00806                                            0806 02777000
*                RSPVCLBM = ON;        /*CLEAR MAP BEFORE USING      */ 02778000
         OI    RSPVCLBM(REG6),B'00100000'                          0807 02779000
*              CALL SETBITS;                                       0808 02780000
*                                                                  0808 02781000
@RF00806 BAL   @14,SETBITS                                         0808 02782000
*        /************************************************************/ 02783000
*        /*                                                          */ 02784000
*        /*  HANDLE PRIMARY CRA REQUESTS                             */ 02785000
*        /*                                                          */ 02786000
*        /************************************************************/ 02787000
*                                                                  0809 02788000
*              IF VOLSRSER = ADDR(GRABRAB2->RABBUF)->RCDCRAVL THEN 0809 02789000
         L     @07,RSVTBENT(,REG6)                                 0809 02790000
         L     @04,RSGRABCU(,REG6)                                 0809 02791000
         L     @04,GRABRAB2(,@04)                                  0809 02792000
         CLC   VOLSRSER(6,@07),RCDCRAVL+8(@04)                     0809 02793000
         BNE   @RF00809                                            0809 02794000
*  SETBPRIM:                                                       0810 02795000
*                DO;                                               0810 02796000
*                                                                  0810 02797000
SETBPRIM DS    0H                                                  0811 02798000
*        /************************************************************/ 02799000
*        /*                                                          */ 02800000
*        /*     CHECK IF SPACE ALREADY ALLOCATED TO PRIMARY CRA      */ 02801000
*        /*                                                          */ 02802000
*        /************************************************************/ 02803000
*                                                                  0811 02804000
*                  RSCKBMAP = RSPBMAP;                             0811 02805000
         L     @07,RSPBMAP(,REG6)                                  0811 02806000
         ST    @07,RSCKBMAP(,REG6)                                 0811 02807000
*                  RSCK1TO1 = ON;      /*1 SHOULD FIND 1             */ 02808000
         OI    RSCK1TO1(REG6),B'00000001'                          0812 02809000
*                  CALL CHKBITS;                                   0813 02810000
         BAL   @14,CHKBITS                                         0813 02811000
*                  IF (RSCKBERR = ON) | (RSSETERR = ON) THEN       0814 02812000
         TM    RSCKBERR(REG6),B'00000010'                          0814 02813000
         BO    @RT00814                                            0814 02814000
         TM    RSSETERR(REG6),B'00001000'                          0814 02815000
         BNO   @RF00814                                            0814 02816000
@RT00814 DS    0H                                                  0815 02817000
*                    RSPERROR = ON;    /*PRIMARY ERROR               */ 02818000
*                                                                  0815 02819000
         OI    RSPERROR(REG6),B'00100000'                          0815 02820000
*        /************************************************************/ 02821000
*        /*                                                          */ 02822000
*        /*     CHECK IF SPACE ALREADY IN CONFLICT WITH PRIMARY      */ 02823000
*        /*                                                          */ 02824000
*        /************************************************************/ 02825000
*                                                                  0816 02826000
*                  ELSE                                            0816 02827000
*                    DO;                                           0816 02828000
         B     @RC00814                                            0816 02829000
@RF00814 DS    0H                                                  0817 02830000
*                      RSCKBMAP = RSPCBMAP;                        0817 02831000
         L     @07,RSPCBMAP(,REG6)                                 0817 02832000
         ST    @07,RSCKBMAP(,REG6)                                 0817 02833000
*                      RSCK1TO1 = OFF; /*1 SHOULD FIND 0             */ 02834000
         NI    RSCK1TO1(REG6),B'11111110'                          0818 02835000
*                      CALL CHKBITS;                               0819 02836000
         BAL   @14,CHKBITS                                         0819 02837000
*                      IF RSCKBERR = ON THEN                       0820 02838000
         TM    RSCKBERR(REG6),B'00000010'                          0820 02839000
         BNO   @RF00820                                            0820 02840000
*                        RSPERROR = ON; /*PRIMARY ERROR              */ 02841000
*                                                                  0821 02842000
         OI    RSPERROR(REG6),B'00100000'                          0821 02843000
*        /************************************************************/ 02844000
*        /*                                                          */ 02845000
*        /*     CHECK IF SPACE ALREADY ALLOCATED TO SECONDARY CRA    */ 02846000
*        /*                                                          */ 02847000
*        /************************************************************/ 02848000
*                                                                  0822 02849000
*                      ELSE                                        0822 02850000
*                        DO;                                       0822 02851000
         B     @RC00820                                            0822 02852000
@RF00820 DS    0H                                                  0823 02853000
*                          RSCKBMAP = RSSBMAP;                     0823 02854000
         L     @07,RSSBMAP(,REG6)                                  0823 02855000
         ST    @07,RSCKBMAP(,REG6)                                 0823 02856000
*                          RSCK1TO1 = ON; /*1 SHOULD FIND 1          */ 02857000
         OI    RSCK1TO1(REG6),B'00000001'                          0824 02858000
*                          CALL CHKBITS;                           0825 02859000
         BAL   @14,CHKBITS                                         0825 02860000
*                          IF RSCKBERR = ON THEN                   0826 02861000
         TM    RSCKBERR(REG6),B'00000010'                          0826 02862000
         BNO   @RF00826                                            0826 02863000
*                            RSSERROR = ON; /*SECONDARY ERROR        */ 02864000
         OI    RSSERROR(REG6),B'00010000'                          0827 02865000
*                        END;                                      0828 02866000
*                    END;                                          0829 02867000
*                END SETBPRIM;                                     0830 02868000
*        /************************************************************/ 02869000
*        /*                                                          */ 02870000
*        /*  HANDLE SECONDARY CRA REQUESTS                           */ 02871000
*        /*                                                          */ 02872000
*        /************************************************************/ 02873000
*                                                                  0831 02874000
*              ELSE                                                0831 02875000
*  SETBSEC:                                                        0831 02876000
*                DO;                                               0831 02877000
*                                                                  0831 02878000
         B     @RC00809                                            0831 02879000
@RF00809 DS    0H                                                  0831 02880000
SETBSEC  DS    0H                                                  0832 02881000
*        /************************************************************/ 02882000
*        /*                                                          */ 02883000
*        /*     CHECK IF SPACE ALREADY ALLOCATED TO PRIMARY CRA      */ 02884000
*        /*                                                          */ 02885000
*        /************************************************************/ 02886000
*                                                                  0832 02887000
*                  RSCKBMAP = RSPBMAP;                             0832 02888000
         L     @07,RSPBMAP(,REG6)                                  0832 02889000
         ST    @07,RSCKBMAP(,REG6)                                 0832 02890000
*                  RSCK1TO1 = ON;      /*1 SHOULD FIND 1             */ 02891000
         OI    RSCK1TO1(REG6),B'00000001'                          0833 02892000
*                  CALL CHKBITS;                                   0834 02893000
         BAL   @14,CHKBITS                                         0834 02894000
*                  IF (RSCKBERR = ON) | (RSSETERR = ON) THEN       0835 02895000
         TM    RSCKBERR(REG6),B'00000010'                          0835 02896000
         BO    @RT00835                                            0835 02897000
         TM    RSSETERR(REG6),B'00001000'                          0835 02898000
         BNO   @RF00835                                            0835 02899000
@RT00835 DS    0H                                                  0836 02900000
*                    RSSERROR = ON;    /*SECONDARY ERROR             */ 02901000
*                                                                  0836 02902000
         OI    RSSERROR(REG6),B'00010000'                          0836 02903000
*        /************************************************************/ 02904000
*        /*                                                          */ 02905000
*        /*     CHECK IF SPACE ALREADY ALLOCATED TO SECONDARY CRA    */ 02906000
*        /*                                                          */ 02907000
*        /************************************************************/ 02908000
*                                                                  0837 02909000
*                  ELSE                                            0837 02910000
*                    DO;                                           0837 02911000
         B     @RC00835                                            0837 02912000
@RF00835 DS    0H                                                  0838 02913000
*                      RSCKBMAP = RSSBMAP;                         0838 02914000
         L     @07,RSSBMAP(,REG6)                                  0838 02915000
         ST    @07,RSCKBMAP(,REG6)                                 0838 02916000
*                      RSCK1TO1 = ON;  /*1 SHOULD FIND 1             */ 02917000
         OI    RSCK1TO1(REG6),B'00000001'                          0839 02918000
*                      CALL CHKBITS;                               0840 02919000
         BAL   @14,CHKBITS                                         0840 02920000
*                      IF RSCKBERR = ON THEN                       0841 02921000
         TM    RSCKBERR(REG6),B'00000010'                          0841 02922000
         BNO   @RF00841                                            0841 02923000
*                        RSSERROR = ON; /*SECONDARY ERROR            */ 02924000
*                                                                  0842 02925000
         OI    RSSERROR(REG6),B'00010000'                          0842 02926000
*        /************************************************************/ 02927000
*        /*                                                          */ 02928000
*        /*     CHECK IF ALREADY IN CONFLICT WITH SECONDARY          */ 02929000
*        /*                                                          */ 02930000
*        /************************************************************/ 02931000
*                                                                  0843 02932000
*                      ELSE                                        0843 02933000
*                        DO;                                       0843 02934000
         B     @RC00841                                            0843 02935000
@RF00841 DS    0H                                                  0844 02936000
*                          RSCKBMAP = RSSCBMAP;                    0844 02937000
         L     @07,RSSCBMAP(,REG6)                                 0844 02938000
         ST    @07,RSCKBMAP(,REG6)                                 0844 02939000
*                          RSCK1TO1 = OFF; /*1 SHOULD FIND 0         */ 02940000
         NI    RSCK1TO1(REG6),B'11111110'                          0845 02941000
*                          CALL CHKBITS;                           0846 02942000
         BAL   @14,CHKBITS                                         0846 02943000
*                          IF RSCKBERR = ON THEN                   0847 02944000
         TM    RSCKBERR(REG6),B'00000010'                          0847 02945000
         BNO   @RF00847                                            0847 02946000
*                            RSSERROR = ON; /*SECONDARY ERROR        */ 02947000
*                                                                  0848 02948000
         OI    RSSERROR(REG6),B'00010000'                          0848 02949000
*                        END;                                      0849 02950000
@RF00847 DS    0H                                                  0850 02951000
*                    END;                                          0850 02952000
@RC00841 DS    0H                                                  0851 02953000
*                END SETBSEC;                                      0851 02954000
@RC00835 DS    0H                                                  0852 02955000
*            END SETBONEV;                                         0852 02956000
@RC00809 DS    0H                                                  0853 02957000
*        END SETBALLV;                                             0853 02958000
@RF00802 L     @04,RSWASNVT(,REG6)                                 0853 02959000
         LA    @07,1                                               0853 02960000
         AH    @07,RSFCNDX(,@04)                                   0853 02961000
         L     @04,RSWASNVT(,REG6)                                 0853 02962000
         STH   @07,RSFCNDX(,@04)                                   0853 02963000
@DE00800 L     @04,RSWASNVT(,REG6)                                 0853 02964000
         CH    @07,RSFHNDX(,@04)                                   0853 02965000
         BNH   @DL00800                                            0853 02966000
*        /************************************************************/ 02967000
*        /*                                                          */ 02968000
*        /*  RESTORE FIRST MATCHING VGO                              */ 02969000
*        /*                                                          */ 02970000
*        /************************************************************/ 02971000
*                                                                  0854 02972000
*        RSFAENT = RSCSFAE;                                        0854 02973000
         L     @07,RSWASNVT(,REG6)                                 0854 02974000
         L     @04,RSCSFAE(,REG6)                                  0854 02975000
         ST    @04,RSFAENT(,@07)                                   0854 02976000
*        RSFCNDX = RSCSFCN;                                        0855 02977000
         LH    @04,RSCSFCN(,REG6)                                  0855 02978000
         STH   @04,RSFCNDX(,@07)                                   0855 02979000
*        /************************************************************/ 02980000
*        /*                                                          */ 02981000
*        /*   SUBALLOCATE THE SPACE FOR ALL VGOS IN THE PRIMARY      */ 02982000
*        /*    CRA IF THERE WAS NO ERROR.                            */ 02983000
*        /*                                                          */ 02984000
*        /************************************************************/ 02985000
*                                                                  0856 02986000
*        IF VOLSRSER = ADDR(GRABRAB2->RABBUF)->RCDCRAVL THEN       0856 02987000
         L     @07,RSVTBENT(,REG6)                                 0856 02988000
         L     @04,RSGRABCU(,REG6)                                 0856 02989000
         L     @04,GRABRAB2(,@04)                                  0856 02990000
         CLC   VOLSRSER(6,@07),RCDCRAVL+8(@04)                     0856 02991000
         BNE   @RF00856                                            0856 02992000
*          IF RSPERROR = OFF THEN                                  0857 02993000
         TM    RSPERROR(REG6),B'00100000'                          0857 02994000
         BNZ   @RF00857                                            0857 02995000
*            DO;                                                   0858 02996000
*              RSPVSETB = ''B;         /*CLEAR SETBITS OPTIOSN       */ 02997000
         MVI   RSPVSETB(REG6),X'00'                                0859 02998000
*              RSSETMAP = ON;          /*SUBALLOCATE TRACKS          */ 02999000
*              RSST1TO1 = OFF;         /*BY SETTING BIT OFF IN MAP   */ 03000000
         OI    RSSETMAP(REG6),B'01000000'                          0861 03001000
         NI    RSST1TO1(REG6),B'11101111'                          0861 03002000
*              RSTGBMAP = RSPBMAP;     /*SUBALLOCATE PRIMARY         */ 03003000
         L     @07,RSPBMAP(,REG6)                                  0862 03004000
         ST    @07,RSTGBMAP(,REG6)                                 0862 03005000
*              RSSTBMAP = RSWKBMAP;    /*TRACKS TO BE ALLOCATED      */ 03006000
         L     @07,RSWKBMAP(,REG6)                                 0863 03007000
         ST    @07,RSSTBMAP(,REG6)                                 0863 03008000
*              CALL SETBITS;                                       0864 03009000
         BAL   @14,SETBITS                                         0864 03010000
*            END;                                                  0865 03011000
*          ELSE;                       /*ERROR NO SUBALLOCATION      */ 03012000
*                                                                  0866 03013000
@RF00857 DS    0H                                                  0867 03014000
*        /************************************************************/ 03015000
*        /*                                                          */ 03016000
*        /*   SUBALLOCATE THE SPACE FOR ALL VGOS IN THE SECONDARY    */ 03017000
*        /*    CRA IF THERE WAS NO ERROR.                            */ 03018000
*        /*                                                          */ 03019000
*        /************************************************************/ 03020000
*                                                                  0867 03021000
*        ELSE                                                      0867 03022000
*          IF (RSPERROR = OFF) & (RSSERROR = OFF) THEN             0867 03023000
         B     @RC00856                                            0867 03024000
@RF00856 TM    RSPERROR(REG6),B'00110000'                          0867 03025000
         BNZ   @RF00867                                            0867 03026000
*            DO;                                                   0868 03027000
*              RSPVSETB = ''B;         /*CLEAR SETBITS OPTIOSN       */ 03028000
         MVI   RSPVSETB(REG6),X'00'                                0869 03029000
*              RSSETMAP = ON;          /*SUBALLOCATE TRACKS          */ 03030000
*              RSST1TO1 = OFF;         /*BY SETTING BIT OFF IN MAP   */ 03031000
         OI    RSSETMAP(REG6),B'01000000'                          0871 03032000
         NI    RSST1TO1(REG6),B'11101111'                          0871 03033000
*              RSTGBMAP = RSSBMAP;     /*SUBALLOCATE SECONDARY      */  03034000
         L     @07,RSSBMAP(,REG6)                                  0872 03035000
         ST    @07,RSTGBMAP(,REG6)                                 0872 03036000
*              RSSTBMAP = RSWKBMAP;    /*TRACKS TO BE ALLOCATED      */ 03037000
         L     @07,RSWKBMAP(,REG6)                                 0873 03038000
         ST    @07,RSSTBMAP(,REG6)                                 0873 03039000
*              CALL SETBITS;                                       0874 03040000
         BAL   @14,SETBITS                                         0874 03041000
*            END;                                                  0875 03042000
*                                                                  0875 03043000
*        /************************************************************/ 03044000
*        /*                                                          */ 03045000
*        /*  PRIMARY ERROR - SET PRIMARY CONFLICT MAP                */ 03046000
*        /*                                                          */ 03047000
*        /************************************************************/ 03048000
*                                                                  0876 03049000
*        IF RSPERROR = ON THEN                                     0876 03050000
@RF00867 DS    0H                                                  0876 03051000
@RC00856 TM    RSPERROR(REG6),B'00100000'                          0876 03052000
         BNO   @RF00876                                            0876 03053000
*          DO;                                                     0877 03054000
*            RSTGBMAP = RSPCBMAP;                                  0878 03055000
         L     @07,RSPCBMAP(,REG6)                                 0878 03056000
         ST    @07,RSTGBMAP(,REG6)                                 0878 03057000
*            RSPVSETB = ''B;           /*CLEAR SETBITS OPTIONS       */ 03058000
         MVI   RSPVSETB(REG6),X'00'                                0879 03059000
*            CALL SETBITS;                                         0880 03060000
         BAL   @14,SETBITS                                         0880 03061000
*            RSPVRPC = ON;             /*PRIMARY CONFLICT            */ 03062000
         OI    RSPVRPC(REG6),B'00001000'                           0881 03063000
*          END;                                                    0882 03064000
*                                                                  0882 03065000
*        /************************************************************/ 03066000
*        /*                                                          */ 03067000
*        /*  PRIMARY OR SECONDARY ERROR                              */ 03068000
*        /*                                                          */ 03069000
*        /************************************************************/ 03070000
*                                                                  0883 03071000
*        IF RSPERROR = ON | RSSERROR = ON THEN                     0883 03072000
@RF00876 TM    RSPERROR(REG6),B'00110000'                          0883 03073000
         BZ    @RF00883                                            0883 03074000
*          DO;                                                     0884 03075000
*                                                                  0884 03076000
*        /************************************************************/ 03077000
*        /*                                                          */ 03078000
*        /*     SET SECONDARY CONFLICT                               */ 03079000
*        /*                                                          */ 03080000
*        /************************************************************/ 03081000
*                                                                  0885 03082000
*            RSTGBMAP = RSSCBMAP;                                  0885 03083000
         L     @07,RSSCBMAP(,REG6)                                 0885 03084000
         ST    @07,RSTGBMAP(,REG6)                                 0885 03085000
*            RSPVSETB = ''B;           /*CLEAR SETBITS OPTIONS       */ 03086000
         MVI   RSPVSETB(REG6),X'00'                                0886 03087000
*            CALL SETBITS;                                         0887 03088000
         BAL   @14,SETBITS                                         0887 03089000
*            RSPVRSC = ON;             /*SECONDARY CONFLICT          */ 03090000
*                                                                  0888 03091000
         OI    RSPVRSC(REG6),B'00000100'                           0888 03092000
*        /************************************************************/ 03093000
*        /*                                                          */ 03094000
*        /*     NO DELETE IF PRIMARY CRA AND SECONDARY CONFLICT      */ 03095000
*        /*                                                          */ 03096000
*        /************************************************************/ 03097000
*                                                                  0889 03098000
*            IF (VOLSRSER = ADDR(GRABRAB2->RABBUF)->RCDCRAVL) &    0889 03099000
*             (RSSERROR = ON) THEN;                                0889 03100000
*                                                                  0889 03101000
         L     @07,RSVTBENT(,REG6)                                 0889 03102000
         L     @04,RSGRABCU(,REG6)                                 0889 03103000
         L     @04,GRABRAB2(,@04)                                  0889 03104000
         CLC   VOLSRSER(6,@07),RCDCRAVL+8(@04)                     0889 03105000
         BNE   @RF00889                                            0889 03106000
         TM    RSSERROR(REG6),B'00010000'                          0889 03107000
         BO    @RT00889                                            0889 03108000
*        /************************************************************/ 03109000
*        /*                                                          */ 03110000
*        /*     INDICATE DELETE THE DSDIR                            */ 03111000
*        /*                                                          */ 03112000
*        /************************************************************/ 03113000
*                                                                  0891 03114000
*            ELSE                                                  0891 03115000
*              DO;                                                 0891 03116000
@RF00889 DS    0H                                                  0892 03117000
*                RSPVDELT = ON;                                    0892 03118000
*                                                                  0892 03119000
         OI    RSPVDELT(REG6),B'00100000'                          0892 03120000
*        /************************************************************/ 03121000
*        /*                                                          */ 03122000
*        /*     INDICATE MARK THE VGO UNUSABLE                       */ 03123000
*        /*                                                          */ 03124000
*        /************************************************************/ 03125000
*                                                                  0893 03126000
*                RSMUNUS = ON;                                     0893 03127000
         OI    RSMUNUS(REG6),B'10000000'                           0893 03128000
*              END;                                                0894 03129000
*                                                                  0894 03130000
*          END;                                                    0895 03131000
*                                                                  0895 03132000
*                                                                  0895 03133000
@RT00889 DS    0H                                                  0896 03134000
* CALL EXIT;  /*TERMINATE*/                                        0896 03135000
@RF00883 BAL   @14,EXIT                                            0896 03136000
* END SETBMAP; /*END OF PROCEDURE*/                                0897 03137000
@EL00012 DS    0H                                                  0897 03138000
@EF00012 DS    0H                                                  0897 03139000
@ER00012 BR    @14                                                 0897 03140000
@PB00012 DS    0H                                                  0898 03141000
*/********************************************************************/ 03142000
*/*                                                                  */ 03143000
*/* PROCEDURE - VERB                                                 */ 03144000
*/*                                                                  */ 03145000
*/* FUNCTION -                                                       */ 03146000
*/*     VERIFY GDG DATA SETS. RECONSTRUCT THE GDG LEVEL DIFFERENCE   */ 03147000
*/*     STRING.                                                      */ 03148000
*/*     NOTE *** THIS PROCEDURE IS AN EXTENSION OF THE               */ 03149000
*/*     VERIFY ROUTINES IN IDCRS02.                                  */ 03150000
*/*                                                                  */ 03151000
*/* INPUT -                                                          */ 03152000
*/*     CI TABLE AND DI TABLE FOR THE GDG BASE                       */ 03153000
*/*                                                                  */ 03154000
*/* OUTPUT -                                                         */ 03155000
*/*     GDG LEVEL DIFFERENCE STRING VERIFIED                         */ 03156000
*/*     DITFAVER - ALL ASSOCIATIONS VERIFIED                         */ 03157000
*/*                                                                  */ 03158000
*/* MESSAGES -                                                       */ 03159000
*/*     IDC21025I - SOME GDG ASSOCIATION OR LEVEL DIFFERENCE STRING  */ 03160000
*/*                 WAS ALTERED.                                     */ 03161000
*/*     IDC21032I - SOME GDG DATA SET COULD NOT BE FOUND             */ 03162000
*/*                                                                  */ 03163000
*/********************************************************************/ 03164000
*      GENERATE;                                                   0898 03165000
         DS    0F                                                       03166000
NAME0071 DC    CL8'VERB'                                                03167000
*VERB: PROCEDURE                                                   0899 03168000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               0899 03169000
*                                                                  0899 03170000
         B     @PB00013                                            0899 03171000
VERB     DS    0H                                                  0900 03172000
*      GENERATE REFS(RS03RG08, REG6);                              0900 03173000
*                                                                  0900 03174000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          03175000
         LR    @15,@13  OLD SAVE AREA                                   03176000
         LA    @13,72(@13)  NEW SAVE AREA                               03177000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     03178000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        03179000
         ENTRY VERB  ENTRY POINT                                        03180000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         03181000
         MVC   0(4,@15),NAME0071  PROCNAME TO REGSAVE                   03182000
*        OLDERID2 = NEWERID2;                                      0901 03183000
         L     @07,GDTTR2(,REG5)                                   0901 03184000
         MVC   @TS00001(95),NEWERID2(@07)                          0901 03185000
         MVC   OLDERID2(95,@07),@TS00001                           0901 03186000
*        NEWID2 = 'RSVB';                                          0902 03187000
*                                                                  0902 03188000
         MVC   NEWID2(4,@07),@CC03579                              0902 03189000
*        /************************************************************/ 03190000
*        /*                                                          */ 03191000
*        /* MARK THE GDG BASE AS VERIFIED                            */ 03192000
*        /*                                                          */ 03193000
*        /************************************************************/ 03194000
*                                                                  0903 03195000
*        PTCITF->CITFAVER = ON;        /*MARK VERIFIED               */ 03196000
*                                                                  0903 03197000
         L     @07,RSPTWKC(,REG6)                                  0903 03198000
         L     @04,PTCITF(,@07)                                    0903 03199000
         OI    CITFAVER(@04),B'01000000'                           0903 03200000
*        /************************************************************/ 03201000
*        /*                                                          */ 03202000
*        /*     SAVE THE BASE NAME AND LENGTH                        */ 03203000
*        /*                                                          */ 03204000
*        /************************************************************/ 03205000
*                                                                  0904 03206000
*        GRABCURR=RABARRAY(ADDR(PTASSOC->TASSEN(1))->TASSRAB);     0904 03207000
         L     @04,RSGRABCU(,REG6)                                 0904 03208000
         L     @07,PTASSOC(,@07)                                   0904 03209000
         LA    @07,TASSEN(,@07)                                    0904 03210000
         LH    @07,TASSRAB(,@07)                                   0904 03211000
         SLA   @07,2                                               0904 03212000
         L     @07,RABARRAY-4(@07,@04)                             0904 03213000
         ST    @07,GRABCURR(,@04)                                  0904 03214000
*                                      /*GDG BUFFER                  */ 03215000
*        RSGDGLN = 0;                                              0905 03216000
         SLR   @07,@07                                             0905 03217000
         STH   @07,RSGDGLN(,REG6)                                  0905 03218000
*        DO RSGDGLN = 1 TO (LENGTH(RSGDGNM) - LENGTH(G0000V00))    0906 03219000
*         WHILE(CNAME(RSGDGLN:RSGDGLN) ^= ' ');                    0906 03220000
         LA    @07,1                                               0906 03221000
         STH   @07,RSGDGLN(,REG6)                                  0906 03222000
@DL00906 LH    @07,RSGDGLN(,REG6)                                  0906 03223000
         L     @04,RSGRABCU(,REG6)                                 0906 03224000
         LA    @15,8                                               0906 03225000
         AL    @15,GRABCURR(,@04)                                  0906 03226000
         ALR   @07,@15                                             0906 03227000
         CLI   CNAME-1(@07),C' '                                   0906 03228000
         BE    @DC00906                                            0906 03229000
*          RSGDGNM(RSGDGLN:RSGDGLN) = CNAME(RSGDGLN:RSGDGLN);      0907 03230000
         LH    @07,RSGDGLN(,REG6)                                  0907 03231000
         ALR   @07,REG6                                            0907 03232000
         LH    @04,RSGDGLN(,REG6)                                  0907 03233000
         ALR   @15,@04                                             0907 03234000
         MVC   RSGDGNM-1(1,@07),CNAME-1(@15)                       0907 03235000
*        END;                                                      0908 03236000
         LA    @07,1                                               0908 03237000
         AH    @07,RSGDGLN(,REG6)                                  0908 03238000
         STH   @07,RSGDGLN(,REG6)                                  0908 03239000
         C     @07,@CF00848                                        0908 03240000
         BNH   @DL00906                                            0908 03241000
@DC00906 DS    0H                                                  0909 03242000
*        RSGDGLN = RSGDGLN - 1;        /*TRUE LENGTH OF BASE NAME    */ 03243000
*                                                                  0909 03244000
         LH    @07,RSGDGLN(,REG6)                                  0909 03245000
         BCTR  @07,0                                               0909 03246000
         STH   @07,RSGDGLN(,REG6)                                  0909 03247000
*        /************************************************************/ 03248000
*        /*                                                          */ 03249000
*        /*       PROCESS ALL GDG DATA SET ENTRIES                   */ 03250000
*        /*                                                          */ 03251000
*        /************************************************************/ 03252000
*                                                                  0910 03253000
*  VERBNONV:                                                       0910 03254000
*        DO PTCITNC = PTCITI TO PTCITL;                            0910 03255000
VERBNONV L     @07,RSPTWKC(,REG6)                                  0910 03256000
         L     @07,PTCITI-1(,@07)                                  0910 03257000
         LA    @07,0(,@07)                                         0910 03258000
         B     @DE00910                                            0910 03259000
@DL00910 DS    0H                                                  0911 03260000
*          RSTANCHR = ADDR(RSGCITS);     /*SCAN CITABE FOR GDG D.S.  */ 03261000
         LA    @07,RSGCITS(,REG6)                                  0911 03262000
         ST    @07,RSTANCHR(,REG6)                                 0911 03263000
*          RSTENTIX = PTCITNC;                                     0912 03264000
         L     @07,RSPTWKC(,REG6)                                  0912 03265000
         MVC   RSTENTIX(3,REG6),PTCITNC(@07)                       0912 03266000
*          CALL GETNEXTE;                                          0913 03267000
         BAL   @14,GETNEXTE                                        0913 03268000
*                                      /*GET NEXT CITABE             */ 03269000
*          PTCITCUR = RSTENTAD;             /*SAVE CITABE ADDRESS    */ 03270000
*                                                                  0914 03271000
         L     @07,RSPTWKC(,REG6)                                  0914 03272000
         L     @04,RSTENTAD(,REG6)                                 0914 03273000
         ST    @04,PTCITCUR(,@07)                                  0914 03274000
*        /************************************************************/ 03275000
*        /*                                                          */ 03276000
*        /*       GDG DATA SET FOUND - READ THE NON-VSAM RECORD      */ 03277000
*        /*       IF RECORD INVALID, ISSUE MESSAGE IDC21032I         */ 03278000
*        /*                                                          */ 03279000
*        /************************************************************/ 03280000
*                                                                  0915 03281000
*          IF CITTYPE = NVID THEN                                  0915 03282000
         CLI   CITTYPE(@04),C'A'                                   0915 03283000
         BNE   @RF00915                                            0915 03284000
*            DO;                                                   0916 03285000
*              IF CITFAINV = OFF THEN  /*PROCESS VALID RECORDS       */ 03286000
         TM    CITFAINV(@04),B'00000010'                           0917 03287000
         BNZ   @RF00917                                            0917 03288000
*                DO;                                               0918 03289000
*                  RSASSTBL = ADDR(ASSO3A);  /*GDG DATA SET ASSOC TBL*/ 03290000
         L     @15,@CA03480                                        0919 03291000
         ST    @15,RSASSTBL(,REG6)                                 0919 03292000
*                  PTASSCUR=ADDR(RSASSTBL->TASSEN(1)); /*GDG DATA SET*/ 03293000
         LA    @15,TASSEN(,@15)                                    0920 03294000
         ST    @15,PTASSCUR(,@07)                                  0920 03295000
*                  GRABCURR = RABARRAY(TASSRAB); /*BUFFER ADDR       */ 03296000
*                                                                  0921 03297000
         L     @14,RSGRABCU(,REG6)                                 0921 03298000
         LH    @15,TASSRAB(,@15)                                   0921 03299000
         SLA   @15,2                                               0921 03300000
         L     @15,RABARRAY-4(@15,@14)                             0921 03301000
         ST    @15,GRABCURR(,@14)                                  0921 03302000
*                  DO;                                             0922 03303000
*                    RSRTYPE = ''B;                                0923 03304000
         MVI   RSRTYPE(REG6),X'00'                                 0923 03305000
*                    RSRGET = ON;      /* GETRCD  */               0924 03306000
         OI    RSRGET(REG6),B'10000000'                            0924 03307000
*                    RSRUPD = ON;      /* UPDATE  */               0925 03308000
         OI    RSRUPD(REG6),B'00001000'                            0925 03309000
*                    RSRDS = ''B;                                  0926 03310000
         NI    RSRDS(REG6),B'00011111'                             0926 03311000
*                    RSRWF = ON;       /* WORKFILE  */             0927 03312000
*                    RSRDIR = ON;      /* DIRECT  */               0928 03313000
*                    RSRKEY = ON;      /* KEY  */                  0929 03314000
         OI    RSRWF(REG6),B'10010100'                             0929 03315000
*                    RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/       0930 03316000
         OI    RSVIAFCR(REG6),B'10000000'                          0930 03317000
*                    RSVIACRA = PTCRAVL; /*SET VOLSER */           0931 03318000
         MVC   RSVIACRA(6,REG6),PTCRAVL(@07)                       0931 03319000
*                    RSVIACIN = CITCIN; /*SET CI NUMBER */         0932 03320000
*                                                                  0932 03321000
         MVC   RSVIACIN(3,REG6),CITCIN(@04)                        0932 03322000
*                  /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA    */ 03323000
*                  CALL GETVIA;                                    0933 03324000
         L     @15,@CV03436                                        0933 03325000
         BALR  @14,@15                                             0933 03326000
*                  END;                                            0934 03327000
*                END;                                              0935 03328000
*              IF CITFAINV=ON | RABNRF=ON | CITTYPE^=RCDID THEN    0936 03329000
@RF00917 L     @07,RSPTWKC(,REG6)                                  0936 03330000
         L     @07,PTCITCUR(,@07)                                  0936 03331000
         TM    CITFAINV(@07),B'00000010'                           0936 03332000
         BO    @RT00936                                            0936 03333000
         L     @04,RSGRABCU(,REG6)                                 0936 03334000
         L     @04,GRABCURR(,@04)                                  0936 03335000
         TM    RABNRF(@04),B'00000010'                             0936 03336000
         BO    @RT00936                                            0936 03337000
         CLC   CITTYPE(1,@07),RCDID+8(@04)                         0936 03338000
         BE    @RF00936                                            0936 03339000
@RT00936 DS    0H                                                  0937 03340000
*                                      /*NO RCD FOUND OR BAD TYPE    */ 03341000
*                DO;                                               0937 03342000
*                  RABNRF = OFF;       /*RESET NO RCD FOUND          */ 03343000
         L     @07,RSGRABCU(,REG6)                                 0938 03344000
         L     @07,GRABCURR(,@07)                                  0938 03345000
         NI    RABNRF(@07),B'11111101'                             0938 03346000
*                  CITFAINV = ON;      /*MARK INVALID                */ 03347000
*                                                                  0939 03348000
         L     @07,RSPTWKC(,REG6)                                  0939 03349000
         L     @04,PTCITCUR(,@07)                                  0939 03350000
         OI    CITFAINV(@04),B'00000010'                           0939 03351000
*                  DO;                                             0940 03352000
*                  /*CALL CKERR*/                                  0941 03353000
*                    RSCKERR = RSCKERR && RSCKERR;                 0941 03354000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0941 03355000
*                    RSCKERN = RSE042;                             0942 03356000
         MVC   RSCKERN(2,REG6),@CH00971                            0942 03357000
*                    RSCKTERM = 'RETU';                            0943 03358000
         MVC   RSCKTERM(4,REG6),@CC03500                           0943 03359000
*                    RSCKMVAR(1) = ADDR(NVID);                     0944 03360000
         LA    @04,@CC00808                                        0944 03361000
         ST    @04,RSCKMVAR(,REG6)                                 0944 03362000
*                    RSCKMVAR(2) = ADDR(PTBASE->CNAME);            0945 03363000
         L     @07,PTBASE(,@07)                                    0945 03364000
         LA    @07,CNAME(,@07)                                     0945 03365000
         ST    @07,RSCKMVAR+4(,REG6)                               0945 03366000
*                    RSCKMVAR(3) = ADDR(GDGID);                    0946 03367000
*                                                                  0946 03368000
         LA    @07,@CC00810                                        0946 03369000
         ST    @07,RSCKMVAR+8(,REG6)                               0946 03370000
*                  /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR     */ 03371000
*                  CALL CKERR;                                     0947 03372000
         L     @15,@CV03443                                        0947 03373000
         BALR  @14,@15                                             0947 03374000
*                  END;                                            0948 03375000
*                END;                                              0949 03376000
*                                                                  0949 03377000
*        /************************************************************/ 03378000
*        /*                                                          */ 03379000
*        /*       IF NON-VSAM READ, PROCESS IT                       */ 03380000
*        /*       IF NON-VSAM ALREADY PROCESSED, DON'T               */ 03381000
*        /*         TRY IT AGAIN.                                    */ 03382000
*        /*                                                          */ 03383000
*        /************************************************************/ 03384000
*                                                                  0950 03385000
*              ELSE                                                0950 03386000
*                IF RSWASSCK = OFF THEN                            0950 03387000
         B     @RC00936                                            0950 03388000
@RF00936 L     @07,RSGRABCU(,REG6)                                 0950 03389000
         L     @07,GRABCURR(,@07)                                  0950 03390000
         TM    RSWASSCK(@07),B'00000010'                           0950 03391000
         BNZ   @RF00950                                            0950 03392000
*                  /* CALL TO MODULE IDCRS02 FOR PROCEDURE PROCTYPE  */ 03393000
*                  CALL PROCTYPE;                                  0951 03394000
         L     @15,@CV03431                                        0951 03395000
         BALR  @14,@15                                             0951 03396000
*            END;                                                  0952 03397000
@RF00950 DS    0H                                                  0952 03398000
@RC00936 DS    0H                                                  0953 03399000
*        END VERBNONV;                                             0953 03400000
@RF00915 L     @04,RSPTWKC(,REG6)                                  0953 03401000
         LA    @07,1                                               0953 03402000
         L     @04,PTCITNC-1(,@04)                                 0953 03403000
         LA    @04,0(,@04)                                         0953 03404000
         ALR   @07,@04                                             0953 03405000
@DE00910 L     @04,RSPTWKC(,REG6)                                  0953 03406000
         STCM  @07,7,PTCITNC(@04)                                  0953 03407000
         L     @04,RSPTWKC(,REG6)                                  0953 03408000
         L     @04,PTCITL-1(,@04)                                  0953 03409000
         LA    @04,0(,@04)                                         0953 03410000
         CR    @07,@04                                             0953 03411000
         BNH   @DL00910                                            0953 03412000
*        /************************************************************/ 03413000
*        /*                                                          */ 03414000
*        /*     RECONSTRUCT GDG GENLEVELS                            */ 03415000
*        /*                                                          */ 03416000
*        /************************************************************/ 03417000
*                                                                  0954 03418000
*        /************************************************************/ 03419000
*        /*                                                          */ 03420000
*        /*       GET WORK AREA FOR LEVEL DIFFERENCE STRING          */ 03421000
*        /*                                                          */ 03422000
*        /************************************************************/ 03423000
*                                                                  0954 03424000
*        GRABCURR = RABARRAY(ADDR(PTASSOC->TASSEN(1))->TASSRAB);   0954 03425000
         L     @07,RSGRABCU(,REG6)                                 0954 03426000
         L     @04,RSPTWKC(,REG6)                                  0954 03427000
         L     @04,PTASSOC(,@04)                                   0954 03428000
         LA    @04,TASSEN(,@04)                                    0954 03429000
         LH    @04,TASSRAB(,@04)                                   0954 03430000
         SLA   @04,2                                               0954 03431000
         L     @04,RABARRAY-4(@04,@07)                             0954 03432000
         ST    @04,GRABCURR(,@07)                                  0954 03433000
*                                      /*GDG BASE RECORD BUFFER      */ 03434000
*        CALL CATRCDSU;            /*SET UP COMMON RCD PTRS      */     03435000
         BAL   @14,CATRCDSU                                        0955 03436000
*        RSGDGLL = LENGTH(GDGLDS) + (GDGLIMIT+1)*LENGTH(GDGENT);   0956 03437000
         L     @07,RSCPE1(,REG6)                                   0956 03438000
         LA    @04,1                                               0956 03439000
         SLR   @15,@15                                             0956 03440000
         IC    @15,GDGLIMIT(,@07)                                  0956 03441000
         ALR   @04,@15                                             0956 03442000
         ALR   @04,@04                                             0956 03443000
         AL    @04,@CF00215                                        0956 03444000
         ST    @04,RSGDGLL(,REG6)                                  0956 03445000
*                                      /*LEVEL DIFFERENCE WORK AREA  */ 03446000
*        CALL IDCSAGP0(GDTTBL,RSGDGLL,RSGDGTB,POOL12,SETZERO);     0957 03447000
         ST    REG5,@AL00001                                       0957 03448000
         LA    @07,RSGDGLL(,REG6)                                  0957 03449000
         ST    @07,@AL00001+4                                      0957 03450000
         LA    @07,RSGDGTB(,REG6)                                  0957 03451000
         ST    @07,@AL00001+8                                      0957 03452000
         LA    @07,@CC00907                                        0957 03453000
         ST    @07,@AL00001+12                                     0957 03454000
         LA    @07,SETZERO                                         0957 03455000
         ST    @07,@AL00001+16                                     0957 03456000
         MVI   @AL00001+16,X'80'                                   0957 03457000
         L     @15,GDTGPL(,REG5)                                   0957 03458000
         LA    @01,@AL00001                                        0957 03459000
         BALR  @14,@15                                             0957 03460000
*        RESPECIFY RTNREG RSTD;                                    0958 03461000
*        TESTRC = RTNREG;                                          0959 03462000
         STH   RTNREG,TESTRC(,REG6)                                0959 03463000
*        RESPECIFY RTNREG UNRSTD;                                  0960 03464000
*        IF TESTRC ^= 0 THEN                                       0961 03465000
*                                                                  0961 03466000
         LH    @07,TESTRC(,REG6)                                   0961 03467000
         LTR   @07,@07                                             0961 03468000
         BZ    @RF00961                                            0961 03469000
*          DO;                                                     0962 03470000
*          /*CALL CKERR*/                                          0963 03471000
*            RSCKERR = RSCKERR && RSCKERR;                         0963 03472000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      0963 03473000
*            RSCKERN = RSE099;                                     0964 03474000
         MVC   RSCKERN(2,REG6),@CH01078                            0964 03475000
*            RSCKTERM = 'TERM';                                    0965 03476000
*                                                                  0965 03477000
         MVC   RSCKTERM(4,REG6),@CC03527                           0965 03478000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */ 03479000
*          CALL CKERR;                                             0966 03480000
         L     @15,@CV03443                                        0966 03481000
         BALR  @14,@15                                             0966 03482000
*          END;                                                    0967 03483000
*                                      /*INSUFFICIENT STORAGE        */ 03484000
*                                                                  0968 03485000
*        /************************************************************/ 03486000
*        /*                                                          */ 03487000
*        /*       INITIALIZE UPPER LIMIT ON NO. OF GEN LEVELS        */ 03488000
*        /*                                                          */ 03489000
*        /************************************************************/ 03490000
*                                                                  0968 03491000
*        GDGLMT = GDGLIMIT;                                        0968 03492000
*                                                                  0968 03493000
@RF00961 L     @07,RSGDGTB(,REG6)                                  0968 03494000
         L     @04,RSCPE1(,REG6)                                   0968 03495000
         SLR   @15,@15                                             0968 03496000
         IC    @15,GDGLIMIT(,@04)                                  0968 03497000
         STH   @15,GDGLMT(,@07)                                    0968 03498000
*        /************************************************************/ 03499000
*        /*                                                          */ 03500000
*        /*       DETERMINE IF WRAP AROUND FROM CURRENT STRING       */ 03501000
*        /*                                                          */ 03502000
*        /************************************************************/ 03503000
*                                                                  0969 03504000
*        DO PTINDX3 = 1 TO VARLEN WHILE(GDGLVL(PTINDX3) ^= GLEND); 0969 03505000
         LA    @07,1                                               0969 03506000
         B     @DE00969                                            0969 03507000
@DL00969 L     @07,RSPTWKC(,REG6)                                  0969 03508000
         LH    @07,PTINDX3(,@07)                                   0969 03509000
         L     @04,RSCPE7(,REG6)                                   0969 03510000
         SLR   @15,@15                                             0969 03511000
         IC    @15,GDGLVL-1(@07,@04)                               0969 03512000
         C     @15,@CF00619                                        0969 03513000
         BE    @DC00969                                            0969 03514000
*          IF GDGLVL(PTINDX3)>GLBLOCK THEN /*LARGE GAP               */ 03515000
         LA    @07,200                                             0970 03516000
         CR    @15,@07                                             0970 03517000
         BNH   @RF00970                                            0970 03518000
*            GDGVAL = GDGVAL + (GDGLVL(PTINDX3) - GLBLOCK)*GLBLOCK;     03519000
         L     @04,RSGDGTB(,REG6)                                  0971 03520000
         SLR   @15,@07                                             0971 03521000
         MR    @14,@07                                             0971 03522000
         AL    @15,GDGVAL(,@04)                                    0971 03523000
         ST    @15,GDGVAL(,@04)                                    0971 03524000
*          ELSE                                                    0972 03525000
*            GDGVAL = GDGVAL + GDGLVL(PTINDX3); /*GET TRUE LEVEL     */ 03526000
         B     @RC00970                                            0972 03527000
@RF00970 L     @07,RSGDGTB(,REG6)                                  0972 03528000
         L     @04,RSPTWKC(,REG6)                                  0972 03529000
         LH    @04,PTINDX3(,@04)                                   0972 03530000
         L     @01,RSCPE7(,REG6)                                   0972 03531000
         SLR   @00,@00                                             0972 03532000
         IC    @00,GDGLVL-1(@04,@01)                               0972 03533000
         AL    @00,GDGVAL(,@07)                                    0972 03534000
         ST    @00,GDGVAL(,@07)                                    0972 03535000
*          IF GDGVAL=>WRPLIMIT THEN /*CHK FOR POSSIBLE WRAP          */ 03536000
@RC00970 L     @07,RSGDGTB(,REG6)                                  0973 03537000
         L     @04,GDGVAL(,@07)                                    0973 03538000
         C     @04,@CF00757                                        0973 03539000
         BL    @RF00973                                            0973 03540000
*            GDGWRAP = ON; /*IND POSSIBLE WRAP                       */ 03541000
         OI    GDGWRAP(@07),B'10000000'                            0974 03542000
*        END;                                                      0975 03543000
*                                                                  0975 03544000
@RF00973 L     @04,RSPTWKC(,REG6)                                  0975 03545000
         LA    @07,1                                               0975 03546000
         AH    @07,PTINDX3(,@04)                                   0975 03547000
@DE00969 L     @04,RSPTWKC(,REG6)                                  0975 03548000
         STH   @07,PTINDX3(,@04)                                   0975 03549000
         L     @04,RSCPE7(,REG6)                                   0975 03550000
         ICM   @04,12,VARLEN(@04)                                  0975 03551000
         SRA   @04,16                                              0975 03552000
         CR    @07,@04                                             0975 03553000
         BNH   @DL00969                                            0975 03554000
@DC00969 DS    0H                                                  0976 03555000
*        /************************************************************/ 03556000
*        /*                                                          */ 03557000
*        /*       PROCESS ALL GDG DATA SETS                          */ 03558000
*        /*                                                          */ 03559000
*        /************************************************************/ 03560000
*                                                                  0976 03561000
*        PTF1END = OFF;                /*MORE ASSOCIATIONS           */ 03562000
*        PTF1OK = ON;                  /*ASSUME LEVELS OK            */ 03563000
         L     @07,RSPTWKC(,REG6)                                  0977 03564000
         OI    PTF1OK(@07),B'00100000'                             0977 03565000
         NI    PTF1END(@07),B'11111011'                            0977 03566000
*        PTLOC = PTLOC && PTLOC;                                   0978 03567000
         XC    PTLOC(20,@07),PTLOC(@07)                            0978 03568000
*        PTLBCITX = PTCITI;            /*SCAN GDG BASE               */ 03569000
         MVC   PTLBCITX(3,@07),PTCITI(@07)                         0979 03570000
*        PTLFBAS1 = ON;                /*FOR ASSOCIATIONS            */ 03571000
         OI    PTLFBAS1(@07),B'00100000'                           0980 03572000
*        PTLDITID = NVID;              /*TO ALIENS                   */ 03573000
         MVI   PTLDITID(@07),C'A'                                  0981 03574000
*  GDGINSLP:                                                       0982 03575000
*        DO UNTIL (PTF1END=ON);        /*SCAN ALL ASSOCIATIONS       */ 03576000
GDGINSLP DS    0H                                                  0982 03577000
@DL00982 DS    0H                                                  0983 03578000
*          /* CALL TO MODULE IDCRS02 FOR PROCEDURE LOCDIT            */ 03579000
*          CALL LOCDIT;                                            0983 03580000
         L     @15,@CV03432                                        0983 03581000
         BALR  @14,@15                                             0983 03582000
*          IF PTLCDIT = 0 THEN         /*NO MORE ASSOCIATIONS        */ 03583000
         L     @07,RSPTWKC(,REG6)                                  0984 03584000
         L     @04,PTLCDIT(,@07)                                   0984 03585000
         LTR   @04,@04                                             0984 03586000
         BNZ   @RF00984                                            0984 03587000
*            PTF1END = ON;                                         0985 03588000
*                                                                  0985 03589000
         OI    PTF1END(@07),B'00000100'                            0985 03590000
*        /************************************************************/ 03591000
*        /*                                                          */ 03592000
*        /*       NOTE BAD ASSOCIATION                               */ 03593000
*        /*                                                          */ 03594000
*        /************************************************************/ 03595000
*                                                                  0986 03596000
*          ELSE                                                    0986 03597000
*            IF PTLCDIT->DITFAVER = OFF THEN                       0986 03598000
         B     @RC00984                                            0986 03599000
@RF00984 L     @07,RSPTWKC(,REG6)                                  0986 03600000
         L     @04,PTLCDIT(,@07)                                   0986 03601000
         TM    DITFAVER(@04),B'01000000'                           0986 03602000
         BNZ   @RF00986                                            0986 03603000
*              PTF1OK = OFF;                                       0987 03604000
*                                                                  0987 03605000
         NI    PTF1OK(@07),B'11011111'                             0987 03606000
*        /************************************************************/ 03607000
*        /*                                                          */ 03608000
*        /*       INSERT LEVEL                                       */ 03609000
*        /*                                                          */ 03610000
*        /************************************************************/ 03611000
*                                                                  0988 03612000
*            ELSE                                                  0988 03613000
*              DO;                                                 0988 03614000
         B     @RC00986                                            0988 03615000
@RF00986 DS    0H                                                  0989 03616000
*                PACK(GDGPAK,PTLCDIT->DITDGML); /*CNVT LVL TO BINARY */ 03617000
         L     @07,RSGDGTB(,REG6)                                  0989 03618000
         L     @04,RSPTWKC(,REG6)                                  0989 03619000
         L     @04,PTLCDIT(,@04)                                   0989 03620000
         PACK  GDGPAK(8,@07),DITDGML(4,@04)                        0989 03621000
*                CVB(GDGVAL,GDGPAK);                               0990 03622000
         CVB   @15,GDGPAK(,@07)                                    0990 03623000
         ST    @15,GDGVAL(,@07)                                    0990 03624000
*                IF PTLCDIT->DITDGML(1:1) = DIG0 & GDGWRAP=ON THEN 0991 03625000
         CLI   DITDGML(@04),C'0'                                   0991 03626000
         BNE   @RF00991                                            0991 03627000
         TM    GDGWRAP(@07),B'10000000'                            0991 03628000
         BNO   @RF00991                                            0991 03629000
*                                      /*GEN LVL WRAP AROUND         */ 03630000
*                  GDGVAL = GDGVAL + WRAPVAL; /*WRAP LEVEL AROUND    */ 03631000
*                                                                  0992 03632000
         AL    @15,@CF00759                                        0992 03633000
         ST    @15,GDGVAL(,@07)                                    0992 03634000
*        /************************************************************/ 03635000
*        /*                                                          */ 03636000
*        /*       FIND POINT OF INSERTION                            */ 03637000
*        /*                                                          */ 03638000
*        /************************************************************/ 03639000
*                                                                  0993 03640000
*                IF GDGCNT = 0 THEN    /*1ST LEVEL                   */ 03641000
@RF00991 L     @07,RSGDGTB(,REG6)                                  0993 03642000
         LH    @04,GDGCNT(,@07)                                    0993 03643000
         LTR   @04,@04                                             0993 03644000
         BNZ   @RF00993                                            0993 03645000
*                  DO;                                             0994 03646000
*                    GDGLVLT(1) = GDGVAL; /* NEW LEVEL               */ 03647000
         L     @04,GDGVAL(,@07)                                    0995 03648000
         STH   @04,GDGLVLT(,@07)                                   0995 03649000
*                    GDGLVLT(2) = MAXGDGLV; /*FORCE INSERT FOR REST  */ 03650000
         MVC   GDGLVLT+2(2,@07),@CH00755                           0996 03651000
*                    GDGCNT = 1;       /* 1ST LEVEL                  */ 03652000
         MVC   GDGCNT(2,@07),@CH00212                              0997 03653000
*                  END;                                            0998 03654000
*                ELSE                  /*NTH LEVEL                   */ 03655000
*                  DO;                                             0999 03656000
         B     @RC00993                                            0999 03657000
@RF00993 DS    0H                                                  1000 03658000
*                    DO PTINDX3 = 1 TO GDGCNT                      1000 03659000
*                     WHILE(GDGLVLT(PTINDX3) < GDGVAL);            1000 03660000
         LA    @07,1                                               1000 03661000
         B     @DE01000                                            1000 03662000
@DL01000 L     @07,RSPTWKC(,REG6)                                  1000 03663000
         LH    @07,PTINDX3(,@07)                                   1000 03664000
         ALR   @07,@07                                             1000 03665000
         L     @04,RSGDGTB(,REG6)                                  1000 03666000
         LH    @07,GDGLVLT-2(@07,@04)                              1000 03667000
         C     @07,GDGVAL(,@04)                                    1000 03668000
         BNL   @DC01000                                            1000 03669000
*                                      /*FIND POINT OF INSERT        */ 03670000
*                    END;                                          1001 03671000
         L     @04,RSPTWKC(,REG6)                                  1001 03672000
         LA    @07,1                                               1001 03673000
         AH    @07,PTINDX3(,@04)                                   1001 03674000
@DE01000 L     @04,RSPTWKC(,REG6)                                  1001 03675000
         STH   @07,PTINDX3(,@04)                                   1001 03676000
         L     @04,RSGDGTB(,REG6)                                  1001 03677000
         CH    @07,GDGCNT(,@04)                                    1001 03678000
         BNH   @DL01000                                            1001 03679000
@DC01000 DS    0H                                                  1002 03680000
*                    IF GDGLVLT(PTINDX3) = GDGVAL THEN             1002 03681000
         L     @07,RSPTWKC(,REG6)                                  1002 03682000
         LH    @04,PTINDX3(,@07)                                   1002 03683000
         ALR   @04,@04                                             1002 03684000
         L     @15,RSGDGTB(,REG6)                                  1002 03685000
         LH    @04,GDGLVLT-2(@04,@15)                              1002 03686000
         C     @04,GDGVAL(,@15)                                    1002 03687000
         BNE   @RF01002                                            1002 03688000
*                                      /*CHK FOR DUPE GENERATION     */ 03689000
*                      DO;                                         1003 03690000
*                        PTF1OK = OFF; /*NOTE ERROR                  */ 03691000
         NI    PTF1OK(@07),B'11011111'                             1004 03692000
*                        PTLCDIT->DITFAVER = OFF; /*DELETE ASSN      */ 03693000
         L     @07,PTLCDIT(,@07)                                   1005 03694000
         NI    DITFAVER(@07),B'10111111'                           1005 03695000
*                      END;                                        1006 03696000
*                    ELSE                                          1007 03697000
*                      IF GDGCNT => GDGLMT THEN /*TOO MANY LEVELS    */ 03698000
         B     @RC01002                                            1007 03699000
@RF01002 L     @07,RSGDGTB(,REG6)                                  1007 03700000
         LH    @04,GDGCNT(,@07)                                    1007 03701000
         CH    @04,GDGLMT(,@07)                                    1007 03702000
         BL    @RF01007                                            1007 03703000
*                        DO;                                       1008 03704000
*                          PTF1OK = OFF; /*NOTE ERROR                */ 03705000
         L     @07,RSPTWKC(,REG6)                                  1009 03706000
         NI    PTF1OK(@07),B'11011111'                             1009 03707000
*                          PTLCDIT->DITFAVER = OFF; /*DELETE ASSN    */ 03708000
         L     @07,PTLCDIT(,@07)                                   1010 03709000
         NI    DITFAVER(@07),B'10111111'                           1010 03710000
*                        END;                                      1011 03711000
*                                                                  1011 03712000
*        /************************************************************/ 03713000
*        /*                                                          */ 03714000
*        /*         INSERT LEVEL                                     */ 03715000
*        /*                                                          */ 03716000
*        /************************************************************/ 03717000
*                                                                  1012 03718000
*                      ELSE                                        1012 03719000
*                        DO;                                       1012 03720000
         B     @RC01007                                            1012 03721000
@RF01007 DS    0H                                                  1013 03722000
*                          GDGFRS = (PTINDX3-1) * LENGTH(GDGENT) + 1;   03723000
         L     @07,RSGDGTB(,REG6)                                  1013 03724000
         LA    @04,1                                               1013 03725000
         L     @01,RSPTWKC(,REG6)                                  1013 03726000
         LH    @15,PTINDX3(,@01)                                   1013 03727000
         BCTR  @15,0                                               1013 03728000
         ALR   @15,@15                                             1013 03729000
         ALR   @15,@04                                             1013 03730000
         STH   @15,GDGFRS(,@07)                                    1013 03731000
*                                      /*START OF FROM               */ 03732000
*                          GDGFRE = (GDGCNT+1)*LENGTH(GDGENT);     1014 03733000
         LH    @14,GDGCNT(,@07)                                    1014 03734000
         ALR   @14,@04                                             1014 03735000
         ALR   @14,@14                                             1014 03736000
         STH   @14,GDGFRE(,@07)                                    1014 03737000
*                                      /*END OF FROM                 */ 03738000
*                          GDGTOS = GDGFRS + LENGTH(GDGENT);       1015 03739000
         LA    @03,2                                               1015 03740000
         ALR   @15,@03                                             1015 03741000
         STH   @15,GDGTOS(,@07)                                    1015 03742000
*                                      /*START OF TO                 */ 03743000
*                          GDGTOE = GDGFRE + LENGTH(GDGENT);       1016 03744000
         ALR   @14,@03                                             1016 03745000
         STH   @14,GDGTOE(,@07)                                    1016 03746000
*                                      /*END OF TO                   */ 03747000
*                          GDGMVL = GDGTOE - GDGTOS + 1;           1017 03748000
         SLR   @14,@15                                             1017 03749000
         ALR   @14,@04                                             1017 03750000
         STH   @14,GDGMVL(,@07)                                    1017 03751000
*                                      /*LENGTH OF DATA TO MOVE      */ 03752000
*                          DO WHILE (GDGMVL>256); /*MOVE LARGE SEGS  */ 03753000
         B     @DE01018                                            1018 03754000
@DL01018 DS    0H                                                  1019 03755000
*                            GDGLENTS(GDGTOE-255:GDGTOE) =         1019 03756000
*                             GDGLENTS(GDGFRE-255:GDGFRE);         1019 03757000
         L     @07,RSGDGTB(,REG6)                                  1019 03758000
         LH    @04,GDGTOE(,@07)                                    1019 03759000
         ST    @04,@TF00001                                        1019 03760000
         ALR   @04,@07                                             1019 03761000
         AL    @04,@CF03748                                        1019 03762000
         LH    @15,GDGFRE(,@07)                                    1019 03763000
         ST    @15,@TF00002                                        1019 03764000
         ALR   @15,@07                                             1019 03765000
         AL    @15,@CF03748                                        1019 03766000
         MVC   @TS00001(256),GDGLENTS-32(@15)                      1019 03767000
         MVC   GDGLENTS-32(256,@04),@TS00001                       1019 03768000
*                            GDGTOE = GDGTOE - 256;                1020 03769000
         LA    @04,256                                             1020 03770000
         L     @15,@TF00001                                        1020 03771000
         SLR   @15,@04                                             1020 03772000
         STH   @15,GDGTOE(,@07)                                    1020 03773000
*                            GDGFRE = GDGFRE - 256;                1021 03774000
         L     @15,@TF00002                                        1021 03775000
         SLR   @15,@04                                             1021 03776000
         STH   @15,GDGFRE(,@07)                                    1021 03777000
*                            GDGMVL = GDGMVL - 256;                1022 03778000
         LCR   @04,@04                                             1022 03779000
         AH    @04,GDGMVL(,@07)                                    1022 03780000
         STH   @04,GDGMVL(,@07)                                    1022 03781000
*                          END;                                    1023 03782000
@DE01018 L     @07,RSGDGTB(,REG6)                                  1023 03783000
         LH    @04,GDGMVL(,@07)                                    1023 03784000
         C     @04,@CF03188                                        1023 03785000
         BH    @DL01018                                            1023 03786000
*                          GDGLENTS(GDGTOS:GDGTOE) =               1024 03787000
*                           GDGLENTS(GDGFRS:GDGFRE);               1024 03788000
         LH    @04,GDGTOS(,@07)                                    1024 03789000
         ST    @04,@TF00001                                        1024 03790000
         ALR   @04,@07                                             1024 03791000
         LH    @15,GDGTOE(,@07)                                    1024 03792000
         SL    @15,@TF00001                                        1024 03793000
         LH    @01,GDGFRS(,@07)                                    1024 03794000
         ALR   @01,@07                                             1024 03795000
         MVC   @TS00001(256),GDGLENTS-1(@01)                       1024 03796000
         EX    @15,@SM03749                                        1024 03797000
*                                      /*MOVE LAST BIT               */ 03798000
*                          GDGENT(PTINDX3) =                       1025 03799000
*                           GDGENT(PTINDX3)&&GDGENT(PTINDX3);      1025 03800000
         L     @04,RSPTWKC(,REG6)                                  1025 03801000
         LH    @04,PTINDX3(,@04)                                   1025 03802000
         ALR   @04,@04                                             1025 03803000
         ST    @04,@TF00001                                        1025 03804000
         ALR   @04,@07                                             1025 03805000
         XC    GDGENT-2(2,@04),GDGENT-2(@04)                       1025 03806000
*                                      /*CLEAR ENTRY                 */ 03807000
*                          GDGLVLT(PTINDX3) = GDGVAL; /*INSERT       */ 03808000
         L     @04,GDGVAL(,@07)                                    1026 03809000
         L     @01,@TF00001                                        1026 03810000
         STH   @04,GDGLVLT-2(@01,@07)                              1026 03811000
*                          GDGCNT = GDGCNT + 1; /*INCR NO. OF LEVELS */ 03812000
         LA    @04,1                                               1027 03813000
         AH    @04,GDGCNT(,@07)                                    1027 03814000
         STH   @04,GDGCNT(,@07)                                    1027 03815000
*                        END;                                      1028 03816000
*                  END;                                            1029 03817000
@RC01007 DS    0H                                                  1029 03818000
@RC01002 DS    0H                                                  1030 03819000
*              END;                                                1030 03820000
@RC00993 DS    0H                                                  1031 03821000
*        END GDGINSLP;                                             1031 03822000
*                                                                  1031 03823000
@RC00986 DS    0H                                                  1031 03824000
@RC00984 DS    0H                                                  1031 03825000
@DE00982 L     @07,RSPTWKC(,REG6)                                  1031 03826000
         TM    PTF1END(@07),B'00000100'                            1031 03827000
         BNO   @DL00982                                            1031 03828000
*        /************************************************************/ 03829000
*        /*                                                          */ 03830000
*        /*       COMPRESS GEN LEVEL TABLE FROM TABLE TO STRING      */ 03831000
*        /*                                                          */ 03832000
*        /************************************************************/ 03833000
*                                                                  1032 03834000
*        GDGPLEV = 0;                  /*PREVIOUS LEVEL INIT         */ 03835000
         L     @04,RSGDGTB(,REG6)                                  1032 03836000
         SLR   @15,@15                                             1032 03837000
         STH   @15,GDGPLEV(,@04)                                   1032 03838000
*        PTINDXV = 1;                  /*FIRST LEVEL DIFFERENCE      */ 03839000
         LA    @04,1                                               1033 03840000
         STH   @04,PTINDXV(,@07)                                   1033 03841000
*        DO PTINDX3 = 1 TO GDGCNT;     /*STEP THRU LEVELS            */ 03842000
         B     @DE01034                                            1034 03843000
@DL01034 DS    0H                                                  1035 03844000
*          GDGVAL = GDGLVLT(PTINDX3) - GDGPLEV; /*DIFFERENCE         */ 03845000
         L     @07,RSGDGTB(,REG6)                                  1035 03846000
         L     @04,RSPTWKC(,REG6)                                  1035 03847000
         LH    @15,PTINDX3(,@04)                                   1035 03848000
         ALR   @15,@15                                             1035 03849000
         LH    @15,GDGLVLT-2(@15,@07)                              1035 03850000
         SH    @15,GDGPLEV(,@07)                                   1035 03851000
         ST    @15,GDGVAL(,@07)                                    1035 03852000
*          IF GDGVAL > GLBLOCK THEN    /*LARGE GAP                   */ 03853000
         LA    @14,200                                             1036 03854000
         CR    @15,@14                                             1036 03855000
         BNH   @RF01036                                            1036 03856000
*            DO;                                                   1037 03857000
*              GDGVALB = GDGVAL/GLBLOCK + GLBLOCK; /*DETERMINE GAP   */ 03858000
         LR    @00,@15                                             1038 03859000
         SRDA  @00,32                                              1038 03860000
         DR    @00,@14                                             1038 03861000
         ALR   @01,@14                                             1038 03862000
         STH   @01,GDGVALB(,@07)                                   1038 03863000
*              IF GDGVALB ^= GDGLVL(PTINDXV) THEN /*STRING CHANGED   */ 03864000
         LH    @07,PTINDXV(,@04)                                   1039 03865000
         L     @15,RSCPE7(,REG6)                                   1039 03866000
         SLR   @14,@14                                             1039 03867000
         IC    @14,GDGLVL-1(@07,@15)                               1039 03868000
         CR    @01,@14                                             1039 03869000
         BE    @RF01039                                            1039 03870000
*                DO;                                               1040 03871000
*                  PTF1OK = OFF;       /*NOTE ERROR                  */ 03872000
         NI    PTF1OK(@04),B'11011111'                             1041 03873000
*                  GDGLVL(PTINDXV) = GDGVALB; /*CHANGE STRING        */ 03874000
         STC   @01,GDGLVL-1(@07,@15)                               1042 03875000
*                END;                                              1043 03876000
*              PTINDXV = PTINDXV + 1; /*NEXT STRING INTEGER          */ 03877000
@RF01039 L     @07,RSPTWKC(,REG6)                                  1044 03878000
         LA    @04,1                                               1044 03879000
         AH    @04,PTINDXV(,@07)                                   1044 03880000
         STH   @04,PTINDXV(,@07)                                   1044 03881000
*              GDGVAL = GDGVAL//GLBLOCK; /*TRUE LEVEL                */ 03882000
         L     @07,RSGDGTB(,REG6)                                  1045 03883000
         L     @00,GDGVAL(,@07)                                    1045 03884000
         SRDA  @00,32                                              1045 03885000
         D     @00,@CF00790                                        1045 03886000
         ST    @00,GDGVAL(,@07)                                    1045 03887000
*            END;                                                  1046 03888000
*          IF GDGVAL ^= GDGLVL(PTINDXV) THEN /*STRING CHANGED        */ 03889000
@RF01036 L     @07,RSGDGTB(,REG6)                                  1047 03890000
         L     @07,GDGVAL(,@07)                                    1047 03891000
         L     @04,RSPTWKC(,REG6)                                  1047 03892000
         LH    @15,PTINDXV(,@04)                                   1047 03893000
         L     @14,RSCPE7(,REG6)                                   1047 03894000
         SLR   @03,@03                                             1047 03895000
         IC    @03,GDGLVL-1(@15,@14)                               1047 03896000
         CR    @07,@03                                             1047 03897000
         BE    @RF01047                                            1047 03898000
*            DO;                                                   1048 03899000
*              PTF1OK = OFF;           /*NOTE ERROR                  */ 03900000
         NI    PTF1OK(@04),B'11011111'                             1049 03901000
*              GDGLVL(PTINDXV) = GDGVAL; /*INSERT NEW DIFFERENCE     */ 03902000
         STC   @07,GDGLVL-1(@15,@14)                               1050 03903000
*            END;                                                  1051 03904000
*          PTINDXV = PTINDXV + 1;      /*NEXT DIFFERENCE             */ 03905000
@RF01047 L     @07,RSPTWKC(,REG6)                                  1052 03906000
         LA    @04,1                                               1052 03907000
         AH    @04,PTINDXV(,@07)                                   1052 03908000
         STH   @04,PTINDXV(,@07)                                   1052 03909000
*          GDGPLEV = GDGLVLT(PTINDX3); /*NEW PREVIOUS LEVEL          */ 03910000
         L     @04,RSGDGTB(,REG6)                                  1053 03911000
         LH    @07,PTINDX3(,@07)                                   1053 03912000
         ALR   @07,@07                                             1053 03913000
         LH    @07,GDGLVLT-2(@07,@04)                              1053 03914000
         STH   @07,GDGPLEV(,@04)                                   1053 03915000
*        END;                                                      1054 03916000
         L     @07,RSPTWKC(,REG6)                                  1054 03917000
         LA    @04,1                                               1054 03918000
         AH    @04,PTINDX3(,@07)                                   1054 03919000
@DE01034 L     @07,RSPTWKC(,REG6)                                  1054 03920000
         STH   @04,PTINDX3(,@07)                                   1054 03921000
         L     @07,RSGDGTB(,REG6)                                  1054 03922000
         CH    @04,GDGCNT(,@07)                                    1054 03923000
         BNH   @DL01034                                            1054 03924000
*        IF GDGLVL(PTINDXV) ^= GLEND THEN /*END OF STRING DIFFERENT  */ 03925000
         LA    @07,255                                             1055 03926000
         L     @04,RSPTWKC(,REG6)                                  1055 03927000
         LH    @15,PTINDXV(,@04)                                   1055 03928000
         L     @14,RSCPE7(,REG6)                                   1055 03929000
         SLR   @03,@03                                             1055 03930000
         IC    @03,GDGLVL-1(@15,@14)                               1055 03931000
         CR    @07,@03                                             1055 03932000
         BE    @RF01055                                            1055 03933000
*          DO;                                                     1056 03934000
*            PTF1OK = OFF; /*NOTE ERROR                              */ 03935000
         NI    PTF1OK(@04),B'11011111'                             1057 03936000
*            GDGLVL(PTINDXV) = GLEND;  /*NEW END OF DIFFERENCE STR   */ 03937000
         STC   @07,GDGLVL-1(@15,@14)                               1058 03938000
*          END;                                                    1059 03939000
*                                                                  1059 03940000
*        /************************************************************/ 03941000
*        /*                                                          */ 03942000
*        /*  WRITE NEW STRING IF DIFFERENT THAN OLD                  */ 03943000
*        /*                                                          */ 03944000
*        /************************************************************/ 03945000
*                                                                  1060 03946000
*        IF PTF1OK = OFF THEN                                      1060 03947000
@RF01055 L     @07,RSPTWKC(,REG6)                                  1060 03948000
         TM    PTF1OK(@07),B'00100000'                             1060 03949000
         BNZ   @RF01060                                            1060 03950000
*          DO;                                                     1061 03951000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR         */ 03952000
*            CALL ADDUPCR;         /*UPDATE CRA                  */     03953000
*                                                                  1062 03954000
*                                                                  1062 03955000
         L     @15,@CV03442                                        1062 03956000
         BALR  @14,@15                                             1062 03957000
*            DO;                                                   1063 03958000
*            /*CALL CKERR*/                                        1064 03959000
*              RSCKERR = RSCKERR && RSCKERR;                       1064 03960000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1064 03961000
*              RSCKERN = RSE028;                                   1065 03962000
         MVC   RSCKERN(2,REG6),@CH00946                            1065 03963000
*              RSCKTERM = 'RETU';                                  1066 03964000
         MVC   RSCKTERM(4,REG6),@CC03500                           1066 03965000
*              RSCKMVAR(1) = ADDR(CNAME);                          1067 03966000
         L     @07,RSGRABCU(,REG6)                                 1067 03967000
         LA    @04,8                                               1067 03968000
         AL    @04,GRABCURR(,@07)                                  1067 03969000
         LA    @07,CNAME(,@04)                                     1067 03970000
         ST    @07,RSCKMVAR(,REG6)                                 1067 03971000
*              RSCKMVAR(2) = ADDR(RCDID);                          1068 03972000
*                                                                  1068 03973000
         LA    @07,RCDID(,@04)                                     1068 03974000
         ST    @07,RSCKMVAR+4(,REG6)                               1068 03975000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 03976000
*            CALL CKERR;                                           1069 03977000
         L     @15,@CV03443                                        1069 03978000
         BALR  @14,@15                                             1069 03979000
*            END; /*IDC21025I        */                            1070 03980000
*                                                                  1070 03981000
*                                                                  1070 03982000
*            DO;                                                   1071 03983000
*              RSRTYPE = ''B;                                      1072 03984000
         MVI   RSRTYPE(REG6),X'00'                                 1072 03985000
*              RSRUPDT = ON;     /* UPDRCD  */                     1073 03986000
         OI    RSRUPDT(REG6),B'00100000'                           1073 03987000
*              RSRUPD = ON;      /* UPDATE  */                     1074 03988000
         OI    RSRUPD(REG6),B'00001000'                            1074 03989000
*              RSRDS = ''B;                                        1075 03990000
         NI    RSRDS(REG6),B'00011111'                             1075 03991000
*              RSRWF = ON;       /* WORKFILE  */                   1076 03992000
*              RSRDIR = ON;      /* DIRECT  */                     1077 03993000
*                                                                  1077 03994000
         OI    RSRWF(REG6),B'10000100'                             1077 03995000
*            /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT         */ 03996000
*            CALL RECMGMT;                                         1078 03997000
         L     @15,@CV03452                                        1078 03998000
         BALR  @14,@15                                             1078 03999000
*              RFY RTNREG RSTD;                                    1079 04000000
*              TESTRC = RTNREG;                                    1080 04001000
         STH   RTNREG,TESTRC(,REG6)                                1080 04002000
*              RFY RTNREG UNRSTD;                                  1081 04003000
*            END;                                                  1082 04004000
*                                                                  1082 04005000
*          END;                                                    1083 04006000
*                                                                  1083 04007000
*        /************************************************************/ 04008000
*        /*                                                          */ 04009000
*        /*     DUMP WHILE STORAGE STILL AVAILABLE                   */ 04010000
*        /*                                                          */ 04011000
*        /************************************************************/ 04012000
*                                                                  1084 04013000
*        IF GDTDBG = NULLPTR                                       1084 04014000
*          THEN;                                                   1084 04015000
@RF01060 L     @07,GDTDBG(,REG5)                                   1084 04016000
         LTR   @07,@07                                             1084 04017000
         BZ    @RT01084                                            1084 04018000
*          ELSE                                                    1086 04019000
*            CALL IDCDB010 (GDTTBL,'RSV4');                        1086 04020000
*                                                                  1086 04021000
         ST    REG5,@AL00001                                       1086 04022000
         LA    @07,@CC03587                                        1086 04023000
         ST    @07,@AL00001+4                                      1086 04024000
         MVI   @AL00001+4,X'80'                                    1086 04025000
         L     @15,GDTDBG(,REG5)                                   1086 04026000
         LA    @01,@AL00001                                        1086 04027000
         BALR  @14,@15                                             1086 04028000
*        /************************************************************/ 04029000
*        /*                                                          */ 04030000
*        /*  FREE ALL OF THE GDG STORAGE                             */ 04031000
*        /*                                                          */ 04032000
*        /************************************************************/ 04033000
*                                                                  1087 04034000
*        CALL IDCSAFP0 (GDTTBL,POOL12);                            1087 04035000
@RT01084 ST    REG5,@AL00001                                       1087 04036000
         LA    @07,@CC00907                                        1087 04037000
         ST    @07,@AL00001+4                                      1087 04038000
         MVI   @AL00001+4,X'80'                                    1087 04039000
         L     @15,GDTFPL(,REG5)                                   1087 04040000
         LA    @01,@AL00001                                        1087 04041000
         BALR  @14,@15                                             1087 04042000
* CALL EXIT;  /*TERMINATE*/                                        1088 04043000
         BAL   @14,EXIT                                            1088 04044000
* END VERB; /*END OF PROCEDURE*/                                   1089 04045000
@EL00013 DS    0H                                                  1089 04046000
@EF00013 DS    0H                                                  1089 04047000
@ER00013 BR    @14                                                 1089 04048000
@PB00013 DS    0H                                                  1090 04049000
*/********************************************************************/ 04050000
*/* PROCEDURE NAME - VLNCOMPR                                        */ 04051000
*/*                                                                  */ 04052000
*/* FUNCTION -                                                       */ 04053000
*/*     A VOLUME NOT CHOSEN FOR RESET IS BEING CHECKED FOR           */ 04054000
*/*     SPACE CLAIMS BY OBJECTS WITH A DESCRIPTION ON A RESET        */ 04055000
*/*     VOLUME. IF AN OBJECT EXISTS ON A NON-RESET VOLUME, BUT IS    */ 04056000
*/*     NO LONGER DESCRIBED ON THAT VOLUME, THEN THE SPACE           */ 04057000
*/*     WILL BE RETURNED FOR SUBALLOCATION.  THIS ROUTINE            */ 04058000
*/*     BELIEVES THAT THE DATA OR INDEX IN THE CATALOG CORRECTLY     */ 04059000
*/*     DESCRIBES THE SPACE ON THE NON-RESET VOLUME, SINCE THAT      */ 04060000
*/*     VOLUME IS NOT BEING RESET. AGAINST THIS TEMPLATE OF          */ 04061000
*/*     VIRTUE AND PULCHRITUDE IS PLACED THE OBJECT OF RESET.        */ 04062000
*/*     IF IT CLAIMS SPACE ON THIS VOLUME FOR THIS DSDIR THEN IT     */ 04063000
*/*     MUST BE AT LEAST A SUBSET OF THE TEMPLATE.                   */ 04064000
*/*                                                                  */ 04065000
*/* INPUT -                                                          */ 04066000
*/*     RSPVSNTC - CATALOG VGOS                                      */ 04067000
*/*     WORKFILE GRABRAB2 - DATA OR INDEX RECORD                     */ 04068000
*/*     RSWASNVT - RSPVSNTC (CATALOG VGOS)                           */ 04069000
*/*                                                                  */ 04070000
*/* OUTPUT -                                                         */ 04071000
*/*     RSPVDELT - DELETE THE DSDIR                                  */ 04072000
*/*     RSMUNUS - MARK THE VGOS IN THE WORKFILE UNUSABLE FOR THIS    */ 04073000
*/*               VOLUME AND DSDIR SEQUENCE NUMBER                   */ 04074000
*/*     RSRETSPC - RETURN ADDITIONAL SPACE TO THE CATALOG.           */ 04075000
*/*     RSPVSNT3 - WORKFILE VGOS                                     */ 04076000
*/*                                                                  */ 04077000
*/********************************************************************/ 04078000
*      GENERATE;                                                   1090 04079000
         DS    0F                                                       04080000
NAME0088 DC    CL8'VLNCOMPR'                                            04081000
*VLNCOMPR: PROCEDURE                                               1091 04082000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1091 04083000
*                                                                  1091 04084000
         B     @PB00014                                            1091 04085000
VLNCOMPR DS    0H                                                  1092 04086000
*      GENERATE REFS(RS03RG08, REG6);                              1092 04087000
*                                                                  1092 04088000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          04089000
         LR    @15,@13  OLD SAVE AREA                                   04090000
         LA    @13,72(@13)  NEW SAVE AREA                               04091000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     04092000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        04093000
         MVC   0(4,@15),NAME0088  PROCNAME TO REGSAVE                   04094000
*        RFY SNDSDIR BASED(RSPVSNT8->RSFAENT);                     1093 04095000
*                                                                  1093 04096000
*        /************************************************************/ 04097000
*        /*                                                          */ 04098000
*        /*   ESTABLISH THE SPACE CURRENTLY ALLOCATED TO THIS OBJECT */ 04099000
*        /*                                                          */ 04100000
*        /************************************************************/ 04101000
*                                                                  1094 04102000
*        RSCSFAE = RSFAENT;            /*INITIAL MATCHING VGO SNTAB  */ 04103000
         L     @07,RSWASNVT(,REG6)                                 1094 04104000
         L     @04,RSFAENT(,@07)                                   1094 04105000
         ST    @04,RSCSFAE(,REG6)                                  1094 04106000
*        RSCSFCN = RSFCNDX;                                        1095 04107000
         LH    @07,RSFCNDX(,@07)                                   1095 04108000
         STH   @07,RSCSFCN(,REG6)                                  1095 04109000
*        RSTGBMAP = RSCABMAP;          /*SET CATALOG VGO MAP         */ 04110000
         L     @04,RSCABMAP(,REG6)                                 1096 04111000
         ST    @04,RSTGBMAP(,REG6)                                 1096 04112000
*        RSPVSETB = ''B;               /*CLEAR OPTIONS               */ 04113000
         MVI   RSPVSETB(REG6),X'00'                                1097 04114000
*        RSPVCLBM = ON;                /*CLEAR MAP INITIALLY         */ 04115000
         OI    RSPVCLBM(REG6),B'00100000'                          1098 04116000
*        DO RSFCNDX = RSFCNDX TO RSFHNDX;                          1099 04117000
         B     @DE01099                                            1099 04118000
@DL01099 DS    0H                                                  1100 04119000
*          RSFAENT = RSFCADR + RSFENTLN*(RSFCNDX-1);               1100 04120000
         L     @07,RSWASNVT(,REG6)                                 1100 04121000
         LH    @04,RSFCNDX(,@07)                                   1100 04122000
         BCTR  @04,0                                               1100 04123000
         LR    @01,@04                                             1100 04124000
         SLR   @04,@04                                             1100 04125000
         IC    @04,RSFENTLN(,@07)                                  1100 04126000
         MR    @00,@04                                             1100 04127000
         AL    @01,RSFCADR(,@07)                                   1100 04128000
         ST    @01,RSFAENT(,@07)                                   1100 04129000
*          IF (SNVOLSER = RSCSFAE->SNVOLSER) &                     1101 04130000
*             (SDSDIRSN = RSCSFAE->SDSDIRSN) THEN                  1101 04131000
         L     @07,RSCSFAE(,REG6)                                  1101 04132000
         CLC   SNVOLSER(6,@01),SNVOLSER(@07)                       1101 04133000
         BNE   @RF01101                                            1101 04134000
         CLC   SDSDIRSN(2,@01),SDSDIRSN(@07)                       1101 04135000
         BNE   @RF01101                                            1101 04136000
*            DO;                                                   1102 04137000
*              CALL SETBITS;                                       1103 04138000
         BAL   @14,SETBITS                                         1103 04139000
*              RSPVCLBM = OFF;         /*DON'T CLEAR MAP AGAIN       */ 04140000
         NI    RSPVCLBM(REG6),B'11011111'                          1104 04141000
*            END;                                                  1105 04142000
*        END;                                                      1106 04143000
@RF01101 L     @04,RSWASNVT(,REG6)                                 1106 04144000
         LA    @07,1                                               1106 04145000
         AH    @07,RSFCNDX(,@04)                                   1106 04146000
         L     @04,RSWASNVT(,REG6)                                 1106 04147000
         STH   @07,RSFCNDX(,@04)                                   1106 04148000
@DE01099 L     @04,RSWASNVT(,REG6)                                 1106 04149000
         CH    @07,RSFHNDX(,@04)                                   1106 04150000
         BNH   @DL01099                                            1106 04151000
*        RSFAENT = RSCSFAE;            /*RESTORE INIT MATCHING VGO   */ 04152000
         L     @07,RSWASNVT(,REG6)                                 1107 04153000
         L     @04,RSCSFAE(,REG6)                                  1107 04154000
         ST    @04,RSFAENT(,@07)                                   1107 04155000
*        RSFCNDX = RSCSFCN;                                        1108 04156000
*                                                                  1108 04157000
         LH    @04,RSCSFCN(,REG6)                                  1108 04158000
         STH   @04,RSFCNDX(,@07)                                   1108 04159000
*        /************************************************************/ 04160000
*        /*                                                          */ 04161000
*        /*   IF OBJECT DOES NOT EXIST AT RESET OR IS AN             */ 04162000
*        /*   INCOMPLETE OBJECT (HENCE, WILL BE DELETED), THEN       */ 04163000
*        /*   DELETE THE DSDIR AND RETURN THE SUBALLOCATED SPACE     */ 04164000
*        /*                                                          */ 04165000
*        /************************************************************/ 04166000
*                                                                  1109 04167000
*        RSGRABCU = ADDR(GRABSWF);                                 1109 04168000
         L     @07,RSIOTBL(,REG6)                                  1109 04169000
         ST    @07,RSGRABCU(,REG6)                                 1109 04170000
*        GRABCURR = GRABRAB2;                                      1110 04171000
         L     @04,GRABRAB2(,@07)                                  1110 04172000
         ST    @04,GRABCURR(,@07)                                  1110 04173000
*        RSRDS = ''B;                  /*CLEAR FILE OPTIONS          */ 04174000
         NI    RSRDS(REG6),B'00011111'                             1111 04175000
*        RSRWF = ON;                   /*DEFAULT GET/PUT TO WF       */ 04176000
         OI    RSRWF(REG6),B'10000000'                             1112 04177000
*        IF (RSWDLCAT = ON) | (RSWDSDIR = OFF) THEN                1113 04178000
         TM    RSWDLCAT(@04),B'01000000'                           1113 04179000
         BO    @RT01113                                            1113 04180000
         TM    RSWDSDIR(@04),B'00001000'                           1113 04181000
         BNZ   @RF01113                                            1113 04182000
@RT01113 DS    0H                                                  1114 04183000
*          DO;                                                     1114 04184000
*            RSPVDELT = ON;                                        1115 04185000
         OI    RSPVDELT(REG6),B'00100000'                          1115 04186000
*            RSRETSPC = ON;                                        1116 04187000
         OI    RSRETSPC(REG6),B'00000100'                          1116 04188000
*          END;                                                    1117 04189000
*                                                                  1117 04190000
*        /************************************************************/ 04191000
*        /*                                                          */ 04192000
*        /*   THE OBJECT MAY EXIST ON THE NON-RESET VOLUME.          */ 04193000
*        /*   FIND ALL OF THE VGOS FOR THE RESET OBJECT.             */ 04194000
*        /*                                                          */ 04195000
*        /************************************************************/ 04196000
*                                                                  1118 04197000
*        ELSE                                                      1118 04198000
*  VLNCFNDV:                                                       1118 04199000
*          DO;                                                     1118 04200000
*                                                                  1118 04201000
         B     @RC01113                                            1118 04202000
@RF01113 DS    0H                                                  1118 04203000
VLNCFNDV DS    0H                                                  1119 04204000
*            DO;                                                   1119 04205000
*              GRABBB = GRABCURR;                                  1120 04206000
         L     @07,RSGRABCU(,REG6)                                 1120 04207000
         L     @04,GRABCURR(,@07)                                  1120 04208000
         ST    @04,GRABBB(,@07)                                    1120 04209000
*              RSWGCODE = GCVOLGO;     /*SPECIFY GROUP CODE          */ 04210000
         MVI   RSWGCODE(REG6),X'03'                                1121 04211000
*              RSWFONE = OFF;          /*FIND ALL OCCURRENCES        */ 04212000
         NI    RSWFONE(REG6),B'01111111'                           1122 04213000
*              /* CALL THE FIND SUBROUTINE */                      1123 04214000
*                                                                  1123 04215000
*            /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND            */ 04216000
*            CALL FIND;                                            1123 04217000
         L     @15,@CV03435                                        1123 04218000
         BALR  @14,@15                                             1123 04219000
*            END;                                                  1124 04220000
*                                                                  1124 04221000
*        /************************************************************/ 04222000
*        /*                                                          */ 04223000
*        /*   ATTEMPT TO LOCATE THE FIRST VGO FOR THE VOLUME-DSDIR   */ 04224000
*        /*   BEING ANALYZED. IF NOT FOUND, THEN THE OBJECT IS BEING */ 04225000
*        /*   RESET WITHOUT THE PREVIOUS REQUEST FOR SPACE ON THE    */ 04226000
*        /*   VOLUME BEING ANALYZED. HENCE, DELETE THE DSDIR AND     */ 04227000
*        /*   RETURN SUBALLOCATED SPACE.                             */ 04228000
*        /*                                                          */ 04229000
*        /************************************************************/ 04230000
*                                                                  1125 04231000
*            IF RSFENTLN = 0 THEN      /*NO VGOS                     */ 04232000
         L     @07,RSWASNVT(,REG6)                                 1125 04233000
         CLI   RSFENTLN(@07),0                                     1125 04234000
         BNE   @RF01125                                            1125 04235000
*              DO;                                                 1126 04236000
*                RSPVDELT = ON;                                    1127 04237000
         OI    RSPVDELT(REG6),B'00100000'                          1127 04238000
*                RSRETSPC = ON;                                    1128 04239000
         OI    RSRETSPC(REG6),B'00000100'                          1128 04240000
*              END;                                                1129 04241000
*            ELSE                                                  1130 04242000
*              DO;                                                 1130 04243000
         B     @RC01125                                            1130 04244000
@RF01125 DS    0H                                                  1131 04245000
*                RSPVSNT3 = RSWASNVT;  /*SAVE THE CRA VGOS SNTAB     */ 04246000
         L     @07,RSWASNVT(,REG6)                                 1131 04247000
         ST    @07,RSPVSNT3(,REG6)                                 1131 04248000
*                RSFAENT = RSFCADR;                                1132 04249000
         L     @04,RSFCADR(,@07)                                   1132 04250000
         ST    @04,RSFAENT(,@07)                                   1132 04251000
*                DO RSFCNDX = 1 TO RSFHNDX                         1133 04252000
*                 WHILE((SNVOLSER^=VOLSRSER) |                     1133 04253000
*                       (SDSDIRSN^=RSPVSNT8->RSFAENT->SNSN));      1133 04254000
         LA    @07,1                                               1133 04255000
         B     @DE01133                                            1133 04256000
@DL01133 L     @07,RSWASNVT(,REG6)                                 1133 04257000
         L     @07,RSFAENT(,@07)                                   1133 04258000
         L     @04,RSVTBENT(,REG6)                                 1133 04259000
         CLC   SNVOLSER(6,@07),VOLSRSER(@04)                       1133 04260000
         BNE   @DB01133                                            1133 04261000
         L     @04,RSPVSNT8(,REG6)                                 1133 04262000
         L     @04,RSFAENT(,@04)                                   1133 04263000
         CLC   SDSDIRSN(2,@07),SNSN(@04)                           1133 04264000
         BE    @DC01133                                            1133 04265000
@DB01133 DS    0H                                                  1134 04266000
*                  RSFAENT = RSFAENT + RSFENTLN;                   1134 04267000
         L     @07,RSWASNVT(,REG6)                                 1134 04268000
         SLR   @04,@04                                             1134 04269000
         IC    @04,RSFENTLN(,@07)                                  1134 04270000
         AL    @04,RSFAENT(,@07)                                   1134 04271000
         ST    @04,RSFAENT(,@07)                                   1134 04272000
*                END;                                              1135 04273000
         L     @04,RSWASNVT(,REG6)                                 1135 04274000
         LA    @07,1                                               1135 04275000
         AH    @07,RSFCNDX(,@04)                                   1135 04276000
@DE01133 L     @04,RSWASNVT(,REG6)                                 1135 04277000
         STH   @07,RSFCNDX(,@04)                                   1135 04278000
         L     @04,RSWASNVT(,REG6)                                 1135 04279000
         CH    @07,RSFHNDX(,@04)                                   1135 04280000
         BNH   @DL01133                                            1135 04281000
@DC01133 DS    0H                                                  1136 04282000
*                IF RSFCNDX > RSFHNDX THEN /*NO MATCHING VGO         */ 04283000
         L     @07,RSWASNVT(,REG6)                                 1136 04284000
         LH    @04,RSFCNDX(,@07)                                   1136 04285000
         CH    @04,RSFHNDX(,@07)                                   1136 04286000
         BNH   @RF01136                                            1136 04287000
*                  DO;                                             1137 04288000
*                    RSPVDELT = ON;                                1138 04289000
         OI    RSPVDELT(REG6),B'00100000'                          1138 04290000
*                    RSRETSPC = ON;                                1139 04291000
         OI    RSRETSPC(REG6),B'00000100'                          1139 04292000
*                  END;                                            1140 04293000
*                                                                  1140 04294000
*        /************************************************************/ 04295000
*        /*                                                          */ 04296000
*        /*   THE OBJECT BEING RESET CLAIMS SPACE FOR THIS           */ 04297000
*        /*   VOLUME-DSDIR. ENSURE THAT THE SPACE CLAIMED IS AT      */ 04298000
*        /*   LEAST A SUBSET OF THE SPACE PREVIOUSLY CLAIMED ON      */ 04299000
*        /*   THAT VOLUME. NOTE THAT THE SUMTT IN THE DSDIR MAY      */ 04300000
*        /*   BE WRONG AND WILL NOT BE CORRECTED.                    */ 04301000
*        /*                                                          */ 04302000
*        /************************************************************/ 04303000
*                                                                  1141 04304000
*        /************************************************************/ 04305000
*        /*                                                          */ 04306000
*        /*     MAP RESET EXTENTS INTO BITMAP                        */ 04307000
*        /*                                                          */ 04308000
*        /************************************************************/ 04309000
*                                                                  1141 04310000
*                ELSE                                              1141 04311000
*  VLNCSPCL:                                                       1141 04312000
*                  DO;                                             1141 04313000
         B     @RC01136                                            1141 04314000
@RF01136 DS    0H                                                  1141 04315000
VLNCSPCL DS    0H                                                  1142 04316000
*                    RSTGBMAP = RSCRBMAP; /*SET CRA VGO MAP          */ 04317000
         L     @07,RSCRBMAP(,REG6)                                 1142 04318000
         ST    @07,RSTGBMAP(,REG6)                                 1142 04319000
*                    RSPVSETB = ''B;                               1143 04320000
         MVI   RSPVSETB(REG6),X'00'                                1143 04321000
*                    RSPVCLBM = ON; /*CLEAR VGO MAP INITIALLY        */ 04322000
         OI    RSPVCLBM(REG6),B'00100000'                          1144 04323000
*                    RSCSFAE = RSFAENT; /*1ST MATCHING VGO           */ 04324000
         L     @07,RSWASNVT(,REG6)                                 1145 04325000
         L     @04,RSFAENT(,@07)                                   1145 04326000
         ST    @04,RSCSFAE(,REG6)                                  1145 04327000
*                    RSCSFCN = RSFCNDX;                            1146 04328000
         LH    @07,RSFCNDX(,@07)                                   1146 04329000
         STH   @07,RSCSFCN(,REG6)                                  1146 04330000
*                    DO RSFCNDX = RSFCNDX TO RSFHNDX;              1147 04331000
         B     @DE01147                                            1147 04332000
@DL01147 DS    0H                                                  1148 04333000
*                      RSFAENT = RSFCADR + RSFENTLN*(RSFCNDX-1);   1148 04334000
         L     @07,RSWASNVT(,REG6)                                 1148 04335000
         LH    @04,RSFCNDX(,@07)                                   1148 04336000
         BCTR  @04,0                                               1148 04337000
         LR    @01,@04                                             1148 04338000
         SLR   @04,@04                                             1148 04339000
         IC    @04,RSFENTLN(,@07)                                  1148 04340000
         MR    @00,@04                                             1148 04341000
         AL    @01,RSFCADR(,@07)                                   1148 04342000
         ST    @01,RSFAENT(,@07)                                   1148 04343000
*                      IF (SNVOLSER=RSCSFAE->SNVOLSER) &           1149 04344000
*                         (SDSDIRSN = RSCSFAE->SDSDIRSN) THEN      1149 04345000
         L     @07,RSCSFAE(,REG6)                                  1149 04346000
         CLC   SNVOLSER(6,@01),SNVOLSER(@07)                       1149 04347000
         BNE   @RF01149                                            1149 04348000
         CLC   SDSDIRSN(2,@01),SDSDIRSN(@07)                       1149 04349000
         BNE   @RF01149                                            1149 04350000
*                        DO;                                       1150 04351000
*                          CALL SETBITS;                           1151 04352000
         BAL   @14,SETBITS                                         1151 04353000
*                          RSPVCLBM = OFF;                         1152 04354000
         NI    RSPVCLBM(REG6),B'11011111'                          1152 04355000
*                        END;                                      1153 04356000
*                    END;                                          1154 04357000
*                                                                  1154 04358000
@RF01149 L     @04,RSWASNVT(,REG6)                                 1154 04359000
         LA    @07,1                                               1154 04360000
         AH    @07,RSFCNDX(,@04)                                   1154 04361000
         L     @04,RSWASNVT(,REG6)                                 1154 04362000
         STH   @07,RSFCNDX(,@04)                                   1154 04363000
@DE01147 L     @04,RSWASNVT(,REG6)                                 1154 04364000
         CH    @07,RSFHNDX(,@04)                                   1154 04365000
         BNH   @DL01147                                            1154 04366000
*                    RSFAENT = RSCSFAE; /*1ST MATCHING VGO           */ 04367000
         L     @07,RSWASNVT(,REG6)                                 1155 04368000
         L     @04,RSCSFAE(,REG6)                                  1155 04369000
         ST    @04,RSFAENT(,@07)                                   1155 04370000
*                    RSFCNDX = RSCSFCN;                            1156 04371000
*                                                                  1156 04372000
         LH    @04,RSCSFCN(,REG6)                                  1156 04373000
         STH   @04,RSFCNDX(,@07)                                   1156 04374000
*        /************************************************************/ 04375000
*        /*                                                          */ 04376000
*        /*     CHECK THE RESET OBJECT FOR A SUBSET OF               */ 04377000
*        /*     PREVIOUSLY OWNED SPACE.                              */ 04378000
*        /*                                                          */ 04379000
*        /************************************************************/ 04380000
*                                                                  1157 04381000
*                    RSTGBMAP = RSCRBMAP; /*CHECK RESET OBJECT       */ 04382000
         L     @07,RSCRBMAP(,REG6)                                 1157 04383000
         ST    @07,RSTGBMAP(,REG6)                                 1157 04384000
*                    RSCKBMAP = RSCABMAP; /*AGAINST CATALOG OBJECT   */ 04385000
         L     @07,RSCABMAP(,REG6)                                 1158 04386000
         ST    @07,RSCKBMAP(,REG6)                                 1158 04387000
*                    RSCK1TO1 = ON;                                1159 04388000
         OI    RSCK1TO1(REG6),B'00000001'                          1159 04389000
*                    CALL CHKBITS;                                 1160 04390000
*                                                                  1160 04391000
         BAL   @14,CHKBITS                                         1160 04392000
*        /************************************************************/ 04393000
*        /*                                                          */ 04394000
*        /*     RESET OBJECT NOT VALID FOR THIS VOLUME, I.E.         */ 04395000
*        /*     NOT A SUBSET. - DELETE THE DSDIR, MARK THE           */ 04396000
*        /*     RESET VGOS UNUSABLE, AND RETURN ANY                  */ 04397000
*        /*     SUBALLOCATED SPACE.                                  */ 04398000
*        /*                                                          */ 04399000
*        /************************************************************/ 04400000
*                                                                  1161 04401000
*                    IF RSCKBERR = ON THEN /*CONFLICT IN TRACKS      */ 04402000
         TM    RSCKBERR(REG6),B'00000010'                          1161 04403000
         BNO   @RF01161                                            1161 04404000
*                      DO;                                         1162 04405000
*                        RSPVDELT = ON;                            1163 04406000
         OI    RSPVDELT(REG6),B'00100000'                          1163 04407000
*                        RSMUNUS = ON;                             1164 04408000
*                        RSRETSPC = ON;                            1165 04409000
         OI    RSMUNUS(REG6),B'10000100'                           1165 04410000
*                      END;                                        1166 04411000
*                                                                  1166 04412000
*        /************************************************************/ 04413000
*        /*                                                          */ 04414000
*        /*     RESET OBJECT IS VALID, SUBALLOCATE THE VALID         */ 04415000
*        /*     OBJECT FROM THE TRACKS ALLOCATED TO THE CATALOG      */ 04416000
*        /*     OBJECT. THERE MAY BE TRACKS NO LONGER CLAIMED        */ 04417000
*        /*     BY THE RESET OBJECT. RETURN UNUSED SPACE WILL        */ 04418000
*        /*     BE FLAGGED, TO INDICATE THAT UNUSED SPACE MAY        */ 04419000
*        /*     EXIST (THE UNUSED TRACKS ARE MAPPED IN THE           */ 04420000
*        /*     CATALOG VGO MAP) - SEE VLNRESET.                     */ 04421000
*        /*                                                          */ 04422000
*        /************************************************************/ 04423000
*                                                                  1167 04424000
*                    ELSE                                          1167 04425000
*                      DO;                                         1167 04426000
         B     @RC01161                                            1167 04427000
@RF01161 DS    0H                                                  1168 04428000
*                        RSRETSPC = ON; /*POSSIBLE SPACE TO RETURN   */ 04429000
         OI    RSRETSPC(REG6),B'00000100'                          1168 04430000
*                        RSPVSETB = ''B; /*CLEAR SET OPTIONS         */ 04431000
         MVI   RSPVSETB(REG6),X'00'                                1169 04432000
*                        RSSETMAP = ON; /*SUBALLOCATE SPACE          */ 04433000
*                        RSST1TO1 = OFF;                           1171 04434000
         OI    RSSETMAP(REG6),B'01000000'                          1171 04435000
         NI    RSST1TO1(REG6),B'11101111'                          1171 04436000
*                        RSTGBMAP = RSCABMAP; /*FROM CATALOG VGO MAP */ 04437000
         L     @07,RSCABMAP(,REG6)                                 1172 04438000
         ST    @07,RSTGBMAP(,REG6)                                 1172 04439000
*                        RSSTBMAP = RSCRBMAP; /*CRA VGO MAP HAS EXTS */ 04440000
         L     @07,RSCRBMAP(,REG6)                                 1173 04441000
         ST    @07,RSSTBMAP(,REG6)                                 1173 04442000
*                        CALL SETBITS;                             1174 04443000
         BAL   @14,SETBITS                                         1174 04444000
*                      END;                                        1175 04445000
*                  END VLNCSPCL;                                   1176 04446000
@RC01161 DS    0H                                                  1177 04447000
*              END;                                                1177 04448000
@RC01136 DS    0H                                                  1178 04449000
*          END VLNCFNDV;                                           1178 04450000
*                                                                  1178 04451000
@RC01125 DS    0H                                                  1179 04452000
*        RFY SNDSDIR;                  /*REVERT                      */ 04453000
@RC01113 DS    0H                                                  1180 04454000
* CALL EXIT;  /*TERMINATE*/                                        1180 04455000
         BAL   @14,EXIT                                            1180 04456000
* END VLNCOMPR; /*END OF PROCEDURE*/                               1181 04457000
@EL00014 DS    0H                                                  1181 04458000
@EF00014 DS    0H                                                  1181 04459000
@ER00014 BR    @14                                                 1181 04460000
@PB00014 DS    0H                                                  1182 04461000
*/********************************************************************/ 04462000
*/* PROCEDURE NAME - VLNRESET                                        */ 04463000
*/*                                                                  */ 04464000
*/* FUNCTION -                                                       */ 04465000
*/*     PROCESS A NON-RESET VOLUME. USING THE DATA SET               */ 04466000
*/*     DIRECTORY ENTRIES (DSDIRS), LOCATE ALL DATA AND INDEX        */ 04467000
*/*     FROM A VOLUME THAT WAS RESET, WHICH CLAIM SPACE ON           */ 04468000
*/*     A VOLUME THAT WAS NOT RESET. IF THE COMPONENT NO             */ 04469000
*/*     LONGER EXISTS OR NO LONGER CLAIMS SPACE ON THE               */ 04470000
*/*     NON-RESET VOLUME, DELETE THE DSDIR AND RETURN ANY            */ 04471000
*/*     SUBALLOCATED SPACE.                                          */ 04472000
*/*                                                                  */ 04473000
*/*     ALL OBJECTS CLAIMING SPACE HAVE ALREADY BEEN                 */ 04474000
*/*     PROCESSED BY VERDSDIR, WHICH UPDATED THE CONTROL INTERVAL    */ 04475000
*/*     NUMBER IN THE DSDIR(DATA SET DIRECTORY) IF THE DATA OR       */ 04476000
*/*     INDEX WAS REASSIGNED TO A NEW LKR CIN. VERDSDIR PROCESSED    */ 04477000
*/*     ALL VALID DATA AND INDEX. FOR RESET OBJECTS VERDSDIR ENSURED */ 04478000
*/*     THAT THE DSDIR EXISTED ON ALL VOLUMES INDICATED BY THE VGOS. */ 04479000
*/*     FOR NON-RESET OBJECTS, VERDSDIR ENSURED THAT THE DSDIR       */ 04480000
*/*     EXISTED ON ALL RESET VOLUMES INDICATED BY THE VGOS.          */ 04481000
*/*                                                                  */ 04482000
*/*     VLNRESET WILL READ THE LOW KEY RANGE(LKR) FROM THE WORKFILE  */ 04483000
*/*     AS INDICATED BY THE DSDIR. USING THE PRE-REASSIGNED CIN,     */ 04484000
*/*     THE CATALOG RECORD IS READ IF AN OBJECT ON A RESET VOLUME    */ 04485000
*/*     CLAIMED SPACE ON A NON-RESET VOLUME PRIOR TO RESET. THE      */ 04486000
*/*     VGOS FOR THIS VOLUME-DSDIR ARE THEN LOCATED IN THE CATALOG.  */ 04487000
*/*                                                                  */ 04488000
*/*     SINCE THE VOLUME IS NOT BEING RESET WE MUST ASSUME           */ 04489000
*/*     THAT THE CATALOG AND CRA FOR THAT VOLUME ARE IN SYNC.        */ 04490000
*/*     FURTHER, WE WILL ALLOW FOR THE FOLLOWING POSSIBILITIES:      */ 04491000
*/*        (1) THE OBJECT BEING RESET NO LONGER CLAIMS               */ 04492000
*/*            SPACE ON THE NON-RESET VOLUME. SUBALLOCATED SPACE IS  */ 04493000
*/*            RETURNED TO THE SPACE MAP. A MESSAGE(IDC11033I) IS    */ 04494000
*/*            ISSUED FOR THE UNIQUES NOT SCRATCHED.                 */ 04495000
*/*        (2) THE OBJECT BEING RESET CLAIMS A SUBSET (OR EQUAL SET) */ 04496000
*/*            OF THE SPACE INDICATED IN THE CATALOG. THE UNUSED     */ 04497000
*/*            SUBALLOCATED SPACE IS RETURNED TO THE SPACE MAP.      */ 04498000
*/*                                                                  */ 04499000
*/*     IF THE OBJECT BEING RESET                                    */ 04500000
*/*        (1) CLAIMS SPACE ON A NON-RESET VOLUME AND                */ 04501000
*/*            THAT VOLUME INDICATES THAT THAT OBJECT DOES NOT OWN   */ 04502000
*/*            ANY SPACE ON THAT VOLUME (DSDIR MISCOMPARE), THEN     */ 04503000
*/*            VERDSDIR WILL MARK THE VGOS UNUSABLE.                 */ 04504000
*/*        (2) CLAIMS SPACE ON A NON-RESET VOLUME AND THE FORMER     */ 04505000
*/*            DATA OR INDEX COMPONENT DOES NOT CLAIM AT LEAST       */ 04506000
*/*            THOSE SAME EXTENTS, THEN VLNRESET WILL MARK THE       */ 04507000
*/*            RESET OBJECT UNUSABLE AND RETURN SPACE FOR FUTURE     */ 04508000
*/*            SUBALLOCATION.                                        */ 04509000
*/*                                                                  */ 04510000
*/*     NOTE THAT HEAVY RELIANCE IS PLACED ON THE CATALOG'S          */ 04511000
*/*     REPRESENTATION OF THE OBJECT BEING RESET. THAT IS,           */ 04512000
*/*     SPACE CLAIMED BY THAT OBJECT IS VIEWED AS VALID FOR          */ 04513000
*/*     THE NON-RESET VOLUME. HENCE, IF THE CATALOG OBJECT           */ 04514000
*/*     IS IN ERROR THEN THE OUTCOME WILL ALSO BE IN ERROR.          */ 04515000
*/*     IF ANY ERROR IS ENCOUNTERED IN THE CATAOLG FOR THIS          */ 04516000
*/*     VOLUME RECORD OR OBJECT, THEN THE NON-RESET VOLUME           */ 04517000
*/*     WILL BE TREATED AS IN ERROR AND ONLY "IGNORE" WILL           */ 04518000
*/*     PERMIT THE RESET TO OCCUR.                                   */ 04519000
*/*                                                                  */ 04520000
*/*     ALSO NOTE THAT IF RESETCAT FINDS AN ERROR IN A NON-RESET     */ 04521000
*/*     VOLUME (LOGICAL ERROR - RECORD MISSING FROM SET OF           */ 04522000
*/*     RECORDS, DATA OR INDEX IN CATALOG HAS LOGICAL ERRORS, ETC.)  */ 04523000
*/*     THAT VOLUME IS FAGGED AS BAD, PER ABOVE. IN THIS CASE,       */ 04524000
*/*     GIVEN THAT A RESET DATA OR INDEX HAS A CORRESPONDING VGO     */ 04525000
*/*     FOR THAT VOLUME-DSDIR BEING PROCESSED, THE EXTENTS           */ 04526000
*/*     DESCRIBED FOR THAT VGO WILL BE REGARDED AS GOOD. IN          */ 04527000
*/*     ORDER TO DETERMINE WHETHER THE EXTENTS ARE TRULY VALID       */ 04528000
*/*     RESETCAT MAY BE ISSUED FOR THIS BAD VOLUME.                  */ 04529000
*/*                                                                  */ 04530000
*/* INPUT -                                                          */ 04531000
*/*     VOLUME RECORD IN WORKFILE BUFFER 1                           */ 04532000
*/*     RSWKBMAP - ADDRESS OF SPACE MAP FOR FIND                     */ 04533000
*/*     RSPBMAP - ADDRESS OF SPACE MAP FOR SUBALLOCATED SPACE        */ 04534000
*/*     RSCABMAP - ADDRESS OF THE SPACE MAP FOR THE CATALOG          */ 04535000
*/*                VGOS BEING PROCESSED.                             */ 04536000
*/*     RSCRBMAP - ADDRESS OF THE SPACE MAP FOR THE CRA              */ 04537000
*/*                VGOS BEING PROCESSED.                             */ 04538000
*/*     RSMAPSIZ - SIZE OF THE SPACE MAP                             */ 04539000
*/*     RSPVSNT6 - ADDRESS OF SN TABLE FOR THE SPACE HEADERS         */ 04540000
*/*                ON THIS VOLUME                                    */ 04541000
*/*     RSPVSNT8 - ADDRESS OF SN TABLE FOR THE DSDIRS ON THIS        */ 04542000
*/*                VOLUME                                            */ 04543000
*/*                                                                  */ 04544000
*/* OUTPUT -                                                         */ 04545000
*/*     CORRECT VOLUME SET OF RECORDS PER THE FUNCTIONAL             */ 04546000
*/*     DESCRIPTION.                                                 */ 04547000
*/*                                                                  */ 04548000
*/* MESSAGES -                                                       */ 04549000
*/*     IDC11033I - UNIQUE DSNAME NOT DELETED                        */ 04550000
*/*     IDC11034I - SPACE MAP ERROR (INCORRECT LENGTH)               */ 04551000
*/*     IDC11029I - SPACE MAP MODIFIED                               */ 04552000
*/*                                                                  */ 04553000
*/********************************************************************/ 04554000
*      GENERATE;                                                   1182 04555000
         DS    0F                                                       04556000
NAME0096 DC    CL8'VLNRESET'                                            04557000
*VLNRESET: PROCEDURE                                               1183 04558000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1183 04559000
*                                                                  1183 04560000
         B     @PB00015                                            1183 04561000
VLNRESET DS    0H                                                  1184 04562000
*      GENERATE REFS(RS03RG08, REG6);                              1184 04563000
*                                                                  1184 04564000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          04565000
         LR    @15,@13  OLD SAVE AREA                                   04566000
         LA    @13,72(@13)  NEW SAVE AREA                               04567000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     04568000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        04569000
         MVC   0(4,@15),NAME0096  PROCNAME TO REGSAVE                   04570000
*        OLDERID2 = NEWERID2;                                      1185 04571000
         L     @07,GDTTR2(,REG5)                                   1185 04572000
         MVC   @TS00001(95),NEWERID2(@07)                          1185 04573000
         MVC   OLDERID2(95,@07),@TS00001                           1185 04574000
*        NEWID2 = 'RSVN';                                          1186 04575000
*                                                                  1186 04576000
         MVC   NEWID2(4,@07),@CC03601                              1186 04577000
*        /************************************************************/ 04578000
*        /*                                                          */ 04579000
*        /*  PROCESS ALL OF THE DSDIRS                               */ 04580000
*        /*                                                          */ 04581000
*        /************************************************************/ 04582000
*                                                                  1187 04583000
*        RSWASNVT = RSPVSNT8;          /*ACTIVATE SN TABLE FOR DSDIRS*/ 04584000
         L     @07,RSPVSNT8(,REG6)                                 1187 04585000
         ST    @07,RSWASNVT(,REG6)                                 1187 04586000
*        RSPVNRP = OFF;                /*RESET SPACE MAP UPDATE INDR */ 04587000
         NI    RSPVNRP(REG6),B'11101111'                           1188 04588000
*        RSBDVOLS = OFF;               /*RESET BAD VOL RECORDS INDR  */ 04589000
         NI    RSBDVOLS(REG6),B'11111101'                          1189 04590000
*  VLNRDSDI:                                                       1190 04591000
*        DO RSFCNDX = 1 TO RSFHNDX;                                1190 04592000
VLNRDSDI LA    @07,1                                               1190 04593000
         B     @DE01190                                            1190 04594000
@DL01190 DS    0H                                                  1191 04595000
*          RSFAENT = RSFCADR + RSFENTLN*(RSFCNDX - 1);             1191 04596000
*                                                                  1191 04597000
         L     @07,RSWASNVT(,REG6)                                 1191 04598000
         LH    @04,RSFCNDX(,@07)                                   1191 04599000
         BCTR  @04,0                                               1191 04600000
         LR    @01,@04                                             1191 04601000
         SLR   @04,@04                                             1191 04602000
         IC    @04,RSFENTLN(,@07)                                  1191 04603000
         MR    @00,@04                                             1191 04604000
         AL    @01,RSFCADR(,@07)                                   1191 04605000
         ST    @01,RSFAENT(,@07)                                   1191 04606000
*        /************************************************************/ 04607000
*        /*                                                          */ 04608000
*        /*   RESET ACTION TO BE TAKEN INDICATORS                    */ 04609000
*        /*                                                          */ 04610000
*        /************************************************************/ 04611000
*                                                                  1192 04612000
*          RSPVDELT = OFF;             /*RESET DSDIR DELETE          */ 04613000
         NI    RSPVDELT(REG6),B'11011111'                          1192 04614000
*          RSMUNUS = OFF;              /*RESET MARK VGO UNUSABLE     */ 04615000
*          RSRETSPC = OFF;             /*RESET RETURN SPACE          */ 04616000
         NI    RSMUNUS(REG6),B'01111011'                           1194 04617000
*          RSPVSNT3 = 0;               /*CLEAR CRA VGO SNTAB         */ 04618000
         SLR   @07,@07                                             1195 04619000
         ST    @07,RSPVSNT3(,REG6)                                 1195 04620000
*          RSPVSNTC = 0;               /*CLEAR CATALOG VGO SNTAB     */ 04621000
*                                                                  1196 04622000
         ST    @07,RSPVSNTC(,REG6)                                 1196 04623000
*        /************************************************************/ 04624000
*        /*                                                          */ 04625000
*        /*   THIS IS A BAD VOLUME SET OF RECORDS IF A DSDIR         */ 04626000
*        /*   GOP EXISTS WITH NO CORRESPONDING GO.                   */ 04627000
*        /*                                                          */ 04628000
*        /************************************************************/ 04629000
*                                                                  1197 04630000
*          IF SNFUSE = OFF THEN                                    1197 04631000
         TM    SNFUSE(@01),B'10000000'                             1197 04632000
         BNZ   @RF01197                                            1197 04633000
*            RSBDVOLS = ON;                                        1198 04634000
*                                                                  1198 04635000
         OI    RSBDVOLS(REG6),B'00000010'                          1198 04636000
*        /************************************************************/ 04637000
*        /*                                                          */ 04638000
*        /*   ON A NON-RESET VOLUME IGNORE THE CATALOG CLUSTER       */ 04639000
*        /*   RECORD, SINCE IT EXISTS WHOLLY ON THIS VOLUME          */ 04640000
*        /*                                                          */ 04641000
*        /************************************************************/ 04642000
*                                                                  1199 04643000
*          ELSE                                                    1199 04644000
*            IF SDSIDNO = CLUSCI THEN;                             1199 04645000
*                                                                  1199 04646000
         B     @RC01197                                            1199 04647000
@RF01197 L     @07,RSWASNVT(,REG6)                                 1199 04648000
         L     @07,RSFAENT(,@07)                                   1199 04649000
         CLC   SDSIDNO(3,@07),@CF00149+1                           1199 04650000
         BE    @RT01199                                            1199 04651000
*        /************************************************************/ 04652000
*        /*                                                          */ 04653000
*        /*   GET THE DATA OR INDEX RECORD INTO BUFFER 2.            */ 04654000
*        /*   ALLOW FOR NO RECORD FOUND, IN CASE NON-RESET VOLUME    */ 04655000
*        /*   HAS AN ERROR.                                          */ 04656000
*        /*                                                          */ 04657000
*        /************************************************************/ 04658000
*                                                                  1201 04659000
*            ELSE                                                  1201 04660000
*              DO;                                                 1201 04661000
*                RSGRABCU = ADDR(GRABSWF);                         1202 04662000
         L     @07,RSIOTBL(,REG6)                                  1202 04663000
         ST    @07,RSGRABCU(,REG6)                                 1202 04664000
*                GRABCURR = GRABRAB2;                              1203 04665000
         L     @04,GRABRAB2(,@07)                                  1203 04666000
         ST    @04,GRABCURR(,@07)                                  1203 04667000
*                GRABAFL1 = ''B;       /*CLEAR FILE OPTIONS          */ 04668000
         MVI   GRABAFL1(@07),X'00'                                 1204 04669000
*                GRABAFL2 = ''B;       /*CLEAR FILE OPTIONS          */ 04670000
         MVI   GRABAFL2(@07),X'00'                                 1205 04671000
*                GRABSFXT = ON;        /*ALLOW XLATE CIN ERROR       */ 04672000
*                GRABSNRN = ON;        /*TREAT XLATE ERR AS NO RCDFND*/ 04673000
         OI    GRABSFXT(@07),B'10000010'                           1207 04674000
*                RABRCDA = SDSIDNO;    /*CIN OF DATA OR INDEX        */ 04675000
*                                                                  1208 04676000
*                                                                  1208 04677000
         L     @07,RSWASNVT(,REG6)                                 1208 04678000
         L     @07,RSFAENT(,@07)                                   1208 04679000
         SLR   @15,@15                                             1208 04680000
         ICM   @15,7,SDSIDNO(@07)                                  1208 04681000
         ST    @15,RABRCDA(,@04)                                   1208 04682000
*                DO;                                               1209 04683000
*                  RSRTYPE = ''B;                                  1210 04684000
         MVI   RSRTYPE(REG6),X'00'                                 1210 04685000
*                  RSRGET = ON;      /* GETRCD  */                 1211 04686000
         OI    RSRGET(REG6),B'10000000'                            1211 04687000
*                  RSRUPD = OFF;     /* NO UPDATE  */              1212 04688000
         NI    RSRUPD(REG6),B'11110111'                            1212 04689000
*                  RSRDS = ''B;                                    1213 04690000
         NI    RSRDS(REG6),B'00011111'                             1213 04691000
*                  RSRWF = ON;       /* WORKFILE  */               1214 04692000
*                  RSRDIR = ON;      /* DIRECT  */                 1215 04693000
*                  RSRKEY = ON;      /* KEY  */                    1216 04694000
*                                                                  1216 04695000
         OI    RSRWF(REG6),B'10010100'                             1216 04696000
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */ 04697000
*                CALL RECMGMT;                                     1217 04698000
         L     @15,@CV03452                                        1217 04699000
         BALR  @14,@15                                             1217 04700000
*                  RFY RTNREG RSTD;                                1218 04701000
*                  TESTRC = RTNREG;                                1219 04702000
         STH   RTNREG,TESTRC(,REG6)                                1219 04703000
*                  RFY RTNREG UNRSTD;                              1220 04704000
*                END;                                              1221 04705000
*                                                                  1221 04706000
*                GRABSFXT = OFF;       /*RESET XLATE OPT             */ 04707000
*                GRABSNRN = OFF;       /*RESET NRF OPT               */ 04708000
*                                                                  1223 04709000
         L     @07,RSGRABCU(,REG6)                                 1223 04710000
         NI    GRABSFXT(@07),B'01111101'                           1223 04711000
*        /************************************************************/ 04712000
*        /*                                                          */ 04713000
*        /*   RECORD NOT FOUND - FOR NON-RESET VOLUME THE            */ 04714000
*        /*   RECORD SHOULD HAVE BEEN FOUND. THIS MEANS THAT THERE   */ 04715000
*        /*   IS AN ERROR IN THE DSDIRS FOR THE NON-RESET VOLUME     */ 04716000
*        /*   BEING PROCESSED. TREAT IT AS A BAD VOLUME RECORD       */ 04717000
*        /*   AND DISALLOW RESET UNLESS IGNORE WAS SPECIFIED.        */ 04718000
*        /*                                                          */ 04719000
*        /************************************************************/ 04720000
*                                                                  1224 04721000
*                IF RABNRF = ON THEN                               1224 04722000
         L     @07,GRABCURR(,@07)                                  1224 04723000
         TM    RABNRF(@07),B'00000010'                             1224 04724000
         BNO   @RF01224                                            1224 04725000
*                  DO;                                             1225 04726000
*                    RABNRF = OFF;                                 1226 04727000
         NI    RABNRF(@07),B'11111101'                             1226 04728000
*                    RSBDVOLS = ON;                                1227 04729000
         OI    RSBDVOLS(REG6),B'00000010'                          1227 04730000
*                  END;                                            1228 04731000
*                                                                  1228 04732000
*        /************************************************************/ 04733000
*        /*                                                          */ 04734000
*        /*   FOR NON-RESET VOLUME, ONLY CARE ABOUT REQUESTS FOR     */ 04735000
*        /*   SPACE BY DATA OR INDEX ON A RESET VOLUME.              */ 04736000
*        /*                                                          */ 04737000
*        /************************************************************/ 04738000
*                                                                  1229 04739000
*                ELSE                                              1229 04740000
*                  IF RSWFCRA=OFF & RSWDLCAT=OFF THEN;             1229 04741000
*                                                                  1229 04742000
         B     @RC01224                                            1229 04743000
@RF01224 L     @07,RSGRABCU(,REG6)                                 1229 04744000
         L     @07,GRABCURR(,@07)                                  1229 04745000
         TM    RSWFCRA(@07),B'11000000'                            1229 04746000
         BZ    @RT01229                                            1229 04747000
*        /************************************************************/ 04748000
*        /*                                                          */ 04749000
*        /*   WE NOW KNOW THAT AN OBJECT ON A RESET VOLUME CLAIMED   */ 04750000
*        /*   SPACE ON A NON-RESET VOLUME PRIOR TO RESET. SINCE THE  */ 04751000
*        /*   NON-RESET VOLUME IS NOT BEING RESET, WE ASSUME THAT    */ 04752000
*        /*   THE CATALOG MUST CORRESPOND TO THE CRA FOR THAT        */ 04753000
*        /*   VOLUME.                                                */ 04754000
*        /*                                                          */ 04755000
*        /*   WE WILL READ THE CATALOG RECORD (DATA OR INDEX)        */ 04756000
*        /*   CORRESPONDING TO THE DSDIR BEING PROCESSED. WE WILL    */ 04757000
*        /*   ASSUME THAT THE EXTENTS ALLOCATED TO THAT OBJECT FOR   */ 04758000
*        /*   THIS DSDIR-VOLUME AS REFLECTED BY THE VGOS IN THE      */ 04759000
*        /*   CATALOG DO INDEED REPRESENT THE SPACE ALLOCATED        */ 04760000
*        /*   TO THIS OBJECT ON THIS VOLUME. FROM THIS VANTAGE POINT */ 04761000
*        /*   WE WILL ENSURE THE VALIDITY OF THE OBJECT BEING        */ 04762000
*        /*   RESTORED (SEE THE PROCEDURE PROLOGUE).                 */ 04763000
*        /*                                                          */ 04764000
*        /************************************************************/ 04765000
*                                                                  1231 04766000
*                  ELSE                                            1231 04767000
*  VLNR0010:                                                       1231 04768000
*                    DO;                                           1231 04769000
@RF01229 DS    0H                                                  1231 04770000
VLNR0010 DS    0H                                                  1232 04771000
*                      RSGRABCU = ADDR(GRABSCA);                   1232 04772000
         L     @07,RSIOTBL(,REG6)                                  1232 04773000
         LA    @04,GRABSCA(,@07)                                   1232 04774000
         ST    @04,RSGRABCU(,REG6)                                 1232 04775000
*                      GRABCURR = GRABRAB1;                        1233 04776000
*                                                                  1233 04777000
         L     @15,GRABRAB1(,@04)                                  1233 04778000
         ST    @15,GRABCURR(,@04)                                  1233 04779000
*                      DO;                                         1234 04780000
*                        RSRTYPE = ''B;                            1235 04781000
         MVI   RSRTYPE(REG6),X'00'                                 1235 04782000
*                        RSRGET = ON;      /* GETRCD  */           1236 04783000
         OI    RSRGET(REG6),B'10000000'                            1236 04784000
*                        RSRUPD = OFF;     /* NO UPDATE  */        1237 04785000
         NI    RSRUPD(REG6),B'11110111'                            1237 04786000
*                        RSRDS = ''B;                              1238 04787000
         NI    RSRDS(REG6),B'00011111'                             1238 04788000
*                        RSRCAT = ON;      /* CATALOG  */          1239 04789000
*                        RSRDIR = ON;      /* DIRECT  */           1240 04790000
*                        RSRKEY = OFF;     /* CNV  */              1241 04791000
         OI    RSRCAT(REG6),B'01000100'                            1241 04792000
         NI    RSRKEY(REG6),B'11101111'                            1241 04793000
*                        RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/   1242 04794000
         OI    RSVIAFCR(REG6),B'10000000'                          1242 04795000
*                        RSVIACRA = NULLCRA; /*SET VOLSER */       1243 04796000
         MVC   RSVIACRA(6,REG6),@CC00780                           1243 04797000
*                        RSVIACIN = ADDR(ADDR(GRABSWF)->GRABRAB2->RABBU 04798000
*)->RCDCINO; /*SET CI NUMBER */                                    1244 04799000
*                                                                  1244 04800000
         L     @07,GRABRAB2(,@07)                                  1244 04801000
         MVC   RSVIACIN(3,REG6),RCDCINO+8(@07)                     1244 04802000
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA*/ 04803000
*                      CALL GETVIA;                                1245 04804000
         L     @15,@CV03436                                        1245 04805000
         BALR  @14,@15                                             1245 04806000
*                      END;                                        1246 04807000
*                                                                  1246 04808000
*        /************************************************************/ 04809000
*        /*                                                          */ 04810000
*        /*   BAD VOLUME SET OF RECORDS IF DATA OR INDEX CANNOT      */ 04811000
*        /*   BE LOCATED                                             */ 04812000
*        /*                                                          */ 04813000
*        /************************************************************/ 04814000
*                                                                  1247 04815000
*                      IF RABNRF = ON THEN                         1247 04816000
         L     @07,RSGRABCU(,REG6)                                 1247 04817000
         L     @07,GRABCURR(,@07)                                  1247 04818000
         TM    RABNRF(@07),B'00000010'                             1247 04819000
         BNO   @RF01247                                            1247 04820000
*                        DO;                                       1248 04821000
*                          RABNRF = OFF;                           1249 04822000
         NI    RABNRF(@07),B'11111101'                             1249 04823000
*                          RSBDVOLS = ON;                          1250 04824000
         OI    RSBDVOLS(REG6),B'00000010'                          1250 04825000
*                        END;                                      1251 04826000
*                                                                  1251 04827000
*        /************************************************************/ 04828000
*        /*                                                          */ 04829000
*        /*  BAD DSDIR IF NOT ASSOCIATED WITH DATA OR INDEX          */ 04830000
*        /*                                                          */ 04831000
*        /************************************************************/ 04832000
*                                                                  1252 04833000
*                      ELSE                                        1252 04834000
*                        IF (RCDID^=DATAID) & (RCDID^=INDEXID) THEN     04835000
         B     @RC01247                                            1252 04836000
@RF01247 L     @07,RSGRABCU(,REG6)                                 1252 04837000
         LA    @04,8                                               1252 04838000
         AL    @04,GRABCURR(,@07)                                  1252 04839000
         CLI   RCDID(@04),C'D'                                     1252 04840000
         BE    @RF01252                                            1252 04841000
         CLI   RCDID(@04),C'I'                                     1252 04842000
         BE    @RF01252                                            1252 04843000
*                          RSBDVOLS = ON;                          1253 04844000
*                                                                  1253 04845000
         OI    RSBDVOLS(REG6),B'00000010'                          1253 04846000
*        /************************************************************/ 04847000
*        /*                                                          */ 04848000
*        /*  FIND ALL OF THE VGOS FOR THE CATALOG OBJECT             */ 04849000
*        /*       BAD DSDIR IF NO VGOS FOR THIS VOLUME-DSDIR         */ 04850000
*        /*                                                          */ 04851000
*        /************************************************************/ 04852000
*                                                                  1254 04853000
*                        ELSE                                      1254 04854000
*  VLNRVGO:                                                        1254 04855000
*                          DO;                                     1254 04856000
         B     @RC01252                                            1254 04857000
@RF01252 DS    0H                                                  1254 04858000
VLNRVGO  DS    0H                                                  1255 04859000
*        RFY SNDSDIR BASED(RSPVSNT8->RSFAENT); /*DSDIR ADDR          */ 04860000
*                                                                  1255 04861000
*                            DO;                                   1256 04862000
*                              GRABBB = GRABCURR;                  1257 04863000
         L     @07,RSGRABCU(,REG6)                                 1257 04864000
         L     @04,GRABCURR(,@07)                                  1257 04865000
         ST    @04,GRABBB(,@07)                                    1257 04866000
*                              RSWGCODE = GCVOLGO;                 1258 04867000
         MVI   RSWGCODE(REG6),X'03'                                1258 04868000
*                                      /*SPECIFY GROUP CODE          */ 04869000
*                              RSWFONE = OFF;                      1259 04870000
         NI    RSWFONE(REG6),B'01111111'                           1259 04871000
*                                      /*FIND ALL OCCURRENCES        */ 04872000
*                              /* CALL THE FIND SUBROUTINE */      1260 04873000
*                                                                  1260 04874000
*                            /* CALL TO MODULE IDCRS04 FOR PROCEDURE FI 04875000
*D                                                                   */ 04876000
*                            CALL FIND;                            1260 04877000
         L     @15,@CV03435                                        1260 04878000
         BALR  @14,@15                                             1260 04879000
*                            END;                                  1261 04880000
*                            IF RSFENTLN ^= 0 THEN                 1262 04881000
         L     @07,RSWASNVT(,REG6)                                 1262 04882000
         CLI   RSFENTLN(@07),0                                     1262 04883000
         BE    @RF01262                                            1262 04884000
*                              RSPVSNTC = RSWASNVT; /*CAT VGO TBL ADR*/ 04885000
         ST    @07,RSPVSNTC(,REG6)                                 1263 04886000
*                            IF (RSFENTLN = 0) | (RSFNRF = ON) THEN     04887000
@RF01262 L     @07,RSWASNVT(,REG6)                                 1264 04888000
         CLI   RSFENTLN(@07),0                                     1264 04889000
         BE    @RT01264                                            1264 04890000
         TM    RSFNRF(@07),B'10000000'                             1264 04891000
         BNO   @RF01264                                            1264 04892000
@RT01264 DS    0H                                                  1265 04893000
*                                      /*NO VGOS OR I/O ERROR        */ 04894000
*                              RSBDVOLS = ON;                      1265 04895000
*                                                                  1265 04896000
         OI    RSBDVOLS(REG6),B'00000010'                          1265 04897000
*        /************************************************************/ 04898000
*        /*                                                          */ 04899000
*        /*  TRY TO FIND THE VGO FIRST FOR THIS DSDIR BY MATCHING    */ 04900000
*        /*  THE VOLUME SERIAL NUMBER AND DSDIR SEQUENCE NUMBER. IF  */ 04901000
*        /*  NOT FOUND, DELETE THE DSDIR.                            */ 04902000
*        /*                                                          */ 04903000
*        /************************************************************/ 04904000
*                                                                  1266 04905000
*                            ELSE                                  1266 04906000
*                              DO;                                 1266 04907000
         B     @RC01264                                            1266 04908000
@RF01264 DS    0H                                                  1267 04909000
*                                RSFAENT = RSFCADR;                1267 04910000
         L     @07,RSWASNVT(,REG6)                                 1267 04911000
         L     @04,RSFCADR(,@07)                                   1267 04912000
         ST    @04,RSFAENT(,@07)                                   1267 04913000
*                                DO RSFCNDX = 1 TO RSFHNDX         1268 04914000
*                                 WHILE ((SNVOLSER^=VOLSRSER) |    1268 04915000
*                                 (SDSDIRSN^=RSPVSNT8->RSFAENT->SNSN)); 04916000
         LA    @07,1                                               1268 04917000
         B     @DE01268                                            1268 04918000
@DL01268 L     @07,RSWASNVT(,REG6)                                 1268 04919000
         L     @07,RSFAENT(,@07)                                   1268 04920000
         L     @04,RSVTBENT(,REG6)                                 1268 04921000
         CLC   SNVOLSER(6,@07),VOLSRSER(@04)                       1268 04922000
         BNE   @DB01268                                            1268 04923000
         L     @04,RSPVSNT8(,REG6)                                 1268 04924000
         L     @04,RSFAENT(,@04)                                   1268 04925000
         CLC   SDSDIRSN(2,@07),SNSN(@04)                           1268 04926000
         BE    @DC01268                                            1268 04927000
@DB01268 DS    0H                                                  1269 04928000
*                                  RSFAENT = RSFAENT + RSFENTLN;   1269 04929000
         L     @07,RSWASNVT(,REG6)                                 1269 04930000
         SLR   @04,@04                                             1269 04931000
         IC    @04,RSFENTLN(,@07)                                  1269 04932000
         AL    @04,RSFAENT(,@07)                                   1269 04933000
         ST    @04,RSFAENT(,@07)                                   1269 04934000
*                                END;                              1270 04935000
         L     @04,RSWASNVT(,REG6)                                 1270 04936000
         LA    @07,1                                               1270 04937000
         AH    @07,RSFCNDX(,@04)                                   1270 04938000
@DE01268 L     @04,RSWASNVT(,REG6)                                 1270 04939000
         STH   @07,RSFCNDX(,@04)                                   1270 04940000
         L     @04,RSWASNVT(,REG6)                                 1270 04941000
         CH    @07,RSFHNDX(,@04)                                   1270 04942000
         BNH   @DL01268                                            1270 04943000
@DC01268 DS    0H                                                  1271 04944000
*                                IF RSFCNDX > RSFHNDX THEN         1271 04945000
         L     @07,RSWASNVT(,REG6)                                 1271 04946000
         LH    @04,RSFCNDX(,@07)                                   1271 04947000
         CH    @04,RSFHNDX(,@07)                                   1271 04948000
         BNH   @RF01271                                            1271 04949000
*                                  RSBDVOLS = ON;                  1272 04950000
*                                                                  1272 04951000
         OI    RSBDVOLS(REG6),B'00000010'                          1272 04952000
*        /************************************************************/ 04953000
*        /*                                                          */ 04954000
*        /*  VGO IN CATALOG MUST BE COMPARED AGAINST RESET OBJECT    */ 04955000
*        /*                                                          */ 04956000
*        /************************************************************/ 04957000
*                                                                  1273 04958000
*                                ELSE                              1273 04959000
*                                  CALL VLNCOMPR;                  1273 04960000
         B     @RC01271                                            1273 04961000
@RF01271 BAL   @14,VLNCOMPR                                        1273 04962000
*                              END;                                1274 04963000
@RC01271 DS    0H                                                  1275 04964000
*        RFY SNDSDIR;                  /*REVERT                      */ 04965000
@RC01264 DS    0H                                                  1276 04966000
*                          END VLNRVGO;                            1276 04967000
*                    END VLNR0010;                                 1277 04968000
@RC01252 DS    0H                                                  1277 04969000
@RC01247 DS    0H                                                  1278 04970000
*              END;                                                1278 04971000
@RT01229 DS    0H                                                  1278 04972000
@RC01224 DS    0H                                                  1279 04973000
*        /************************************************************/ 04974000
*        /*                                                          */ 04975000
*        /*   REORIENT TO THE WORKFILE AND DSDIRS                    */ 04976000
*        /*                                                          */ 04977000
*        /************************************************************/ 04978000
*                                                                  1279 04979000
*          RSGRABCU = ADDR(GRABSWF);                               1279 04980000
@RT01199 DS    0H                                                  1279 04981000
@RC01197 L     @07,RSIOTBL(,REG6)                                  1279 04982000
         ST    @07,RSGRABCU(,REG6)                                 1279 04983000
*          GRABCURR = GRABRAB1;                                    1280 04984000
         L     @04,GRABRAB1(,@07)                                  1280 04985000
         ST    @04,GRABCURR(,@07)                                  1280 04986000
*          RSWASNVT = RSPVSNT8;                                    1281 04987000
         L     @07,RSPVSNT8(,REG6)                                 1281 04988000
         ST    @07,RSWASNVT(,REG6)                                 1281 04989000
*          RSRDS = ''B;                /* CLEAR FILE OPTIONS         */ 04990000
         NI    RSRDS(REG6),B'00011111'                             1282 04991000
*          RSRWF = ON;                 /*DEFAULT GET/PUT TO WF       */ 04992000
*                                                                  1283 04993000
         OI    RSRWF(REG6),B'10000000'                             1283 04994000
*        /************************************************************/ 04995000
*        /*                                                          */ 04996000
*        /*  DELETE THE DSDIR - VGO IS A NOGO                        */ 04997000
*        /*                                                          */ 04998000
*        /*  THE DSDIR IS BEING DELETED FOR A NON-RESET VOLUME       */ 04999000
*        /*  BECAUSE, PRIOR TO THE RESET, AN OBJECT, WHICH WAS       */ 05000000
*        /*  RESET, DESCRIBED SPACE ON THAT VOLUME, BUT THE RESET    */ 05001000
*        /*  OBJECT EITHER DOES NOT EXIST OR DOES NOT DESCRIBE       */ 05002000
*        /*  THE SPACE.                                              */ 05003000
*        /*                                                          */ 05004000
*        /************************************************************/ 05005000
*                                                                  1284 05006000
*          IF RSPVDELT = ON THEN                                   1284 05007000
         TM    RSPVDELT(REG6),B'00100000'                          1284 05008000
         BNO   @RF01284                                            1284 05009000
*  VLNRDELT:                                                       1285 05010000
*            DO;                                                   1285 05011000
VLNRDELT DS    0H                                                  1286 05012000
*              GRABBB = GRABCURR;      /*BASE FOR DELETE             */ 05013000
         L     @07,RSGRABCU(,REG6)                                 1286 05014000
         L     @04,GRABCURR(,@07)                                  1286 05015000
         ST    @04,GRABBB(,@07)                                    1286 05016000
*              /* CALL TO MODULE IDCRS04 FOR PROCEDURE DELGO         */ 05017000
*              CALL DELGO;                                         1287 05018000
         L     @15,@CV03434                                        1287 05019000
         BALR  @14,@15                                             1287 05020000
*            END VLNRDELT;                                         1288 05021000
*                                                                  1288 05022000
*        /************************************************************/ 05023000
*        /*                                                          */ 05024000
*        /* MARK THE VGOS UNUSABLE                                   */ 05025000
*        /*                                                          */ 05026000
*        /*   MARK THE OBJECT UNUSABLE IF THE EXTENTS FOR THIS       */ 05027000
*        /*   VOLUME-DSDIR ARE NOT COMPATIBLE WITH THE SPACE         */ 05028000
*        /*   DESCRIBED FOR THIS SAME OBJECT IN THE CATALOG.         */ 05029000
*        /*                                                          */ 05030000
*        /************************************************************/ 05031000
*                                                                  1289 05032000
*          IF RSMUNUS = ON THEN                                    1289 05033000
@RF01284 TM    RSMUNUS(REG6),B'10000000'                           1289 05034000
         BNO   @RF01289                                            1289 05035000
*  VLNRMUN:                                                        1290 05036000
*            DO;                                                   1290 05037000
VLNRMUN  DS    0H                                                  1291 05038000
*              RSWASNVT = RSPVSNT3;                                1291 05039000
         L     @07,RSPVSNT3(,REG6)                                 1291 05040000
         ST    @07,RSWASNVT(,REG6)                                 1291 05041000
*              RSASDSDI = ON;          /*SPACE CONFLICT              */ 05042000
         OI    RSASDSDI(REG6),B'01000000'                          1292 05043000
*              GRABCURR = GRABRAB2;                                1293 05044000
         L     @07,RSGRABCU(,REG6)                                 1293 05045000
         L     @04,GRABRAB2(,@07)                                  1293 05046000
         ST    @04,GRABCURR(,@07)                                  1293 05047000
*              CALL MARKUNUS;                                      1294 05048000
*                                                                  1294 05049000
*                                                                  1294 05050000
         BAL   @14,MARKUNUS                                        1294 05051000
*              DO;                                                 1295 05052000
*                RSRTYPE = ''B;                                    1296 05053000
         MVI   RSRTYPE(REG6),X'00'                                 1296 05054000
*                RSRUPDT = ON;     /* UPDRCD  */                   1297 05055000
         OI    RSRUPDT(REG6),B'00100000'                           1297 05056000
*                RSRUPD = ON;      /* UPDATE  */                   1298 05057000
         OI    RSRUPD(REG6),B'00001000'                            1298 05058000
*                RSRDS = ''B;                                      1299 05059000
         NI    RSRDS(REG6),B'00011111'                             1299 05060000
*                RSRWF = ON;       /* WORKFILE  */                 1300 05061000
*                RSRDIR = ON;      /* DIRECT  */                   1301 05062000
*                RSRKEY = ON;      /* KEY  */                      1302 05063000
*                                                                  1302 05064000
         OI    RSRWF(REG6),B'10010100'                             1302 05065000
*              /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT       */ 05066000
*              CALL RECMGMT;                                       1303 05067000
         L     @15,@CV03452                                        1303 05068000
         BALR  @14,@15                                             1303 05069000
*                RFY RTNREG RSTD;                                  1304 05070000
*                TESTRC = RTNREG;                                  1305 05071000
         STH   RTNREG,TESTRC(,REG6)                                1305 05072000
*                RFY RTNREG UNRSTD;                                1306 05073000
*              END;                                                1307 05074000
*            END VLNRMUN;                                          1308 05075000
*                                                                  1308 05076000
*        /************************************************************/ 05077000
*        /*                                                          */ 05078000
*        /* RETURN SPACE NO LONGER USED                              */ 05079000
*        /*                                                          */ 05080000
*        /*   IF THE RESET OBJECT NO LONGER CLAIMS SPACE OR          */ 05081000
*        /*   CLAIMS LESS SPACE FOR THIS VOLUME THEN RETURN          */ 05082000
*        /*   SUBALLOCATED SPACE TO THE SPACE MAP. IF UNIQUES        */ 05083000
*        /*   ARE NO LONGER USED, ISSUE AN INFORMATIONAL             */ 05084000
*        /*   MESSAGE(IDC11033I).                                    */ 05085000
*        /*                                                          */ 05086000
*        /************************************************************/ 05087000
*                                                                  1309 05088000
*          IF RSRETSPC = ON THEN                                   1309 05089000
@RF01289 TM    RSRETSPC(REG6),B'00000100'                          1309 05090000
         BNO   @RF01309                                            1309 05091000
*  VLNRSPC:                                                        1310 05092000
*            DO;                                                   1310 05093000
*                                                                  1310 05094000
VLNRSPC  DS    0H                                                  1311 05095000
*        /************************************************************/ 05096000
*        /*                                                          */ 05097000
*        /*   RE-GET THE DATA OR INDEX FROM THE CATALOG              */ 05098000
*        /*   WHICH MAY BE OVERLAID BY AN EXTENSION RECORD.          */ 05099000
*        /*                                                          */ 05100000
*        /************************************************************/ 05101000
*                                                                  1311 05102000
*              RSGRABCU = ADDR(GRABSCA);                           1311 05103000
         L     @07,RSIOTBL(,REG6)                                  1311 05104000
         LA    @04,GRABSCA(,@07)                                   1311 05105000
         ST    @04,RSGRABCU(,REG6)                                 1311 05106000
*              GRABCURR = GRABRAB1;                                1312 05107000
*                                                                  1312 05108000
         L     @15,GRABRAB1(,@04)                                  1312 05109000
         ST    @15,GRABCURR(,@04)                                  1312 05110000
*              DO;                                                 1313 05111000
*                RSRTYPE = ''B;                                    1314 05112000
         MVI   RSRTYPE(REG6),X'00'                                 1314 05113000
*                RSRGET = ON;      /* GETRCD  */                   1315 05114000
         OI    RSRGET(REG6),B'10000000'                            1315 05115000
*                RSRUPD = OFF;     /* NO UPDATE  */                1316 05116000
         NI    RSRUPD(REG6),B'11110111'                            1316 05117000
*                RSRDS = ''B;                                      1317 05118000
         NI    RSRDS(REG6),B'00011111'                             1317 05119000
*                RSRCAT = ON;      /* CATALOG  */                  1318 05120000
*                RSRDIR = ON;      /* DIRECT  */                   1319 05121000
*                RSRKEY = OFF;     /* CNV  */                      1320 05122000
         OI    RSRCAT(REG6),B'01000100'                            1320 05123000
         NI    RSRKEY(REG6),B'11101111'                            1320 05124000
*                RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/           1321 05125000
         OI    RSVIAFCR(REG6),B'10000000'                          1321 05126000
*                RSVIACRA = NULLCRA; /*SET VOLSER */               1322 05127000
         MVC   RSVIACRA(6,REG6),@CC00780                           1322 05128000
*                RSVIACIN = ADDR(ADDR(GRABSWF)->GRABRAB2->RABBUF)->RCDC 05129000
*NO; /*SET CI NUMBER */                                            1323 05130000
*                                                                  1323 05131000
         L     @07,GRABRAB2(,@07)                                  1323 05132000
         MVC   RSVIACIN(3,REG6),RCDCINO+8(@07)                     1323 05133000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA        */ 05134000
*              CALL GETVIA;                                        1324 05135000
         L     @15,@CV03436                                        1324 05136000
         BALR  @14,@15                                             1324 05137000
*              END;                                                1325 05138000
*              RSRDS = ''B;            /*CLEAR FILE OPTIONS          */ 05139000
         NI    RSRDS(REG6),B'00011111'                             1326 05140000
*              RSRWF = ON;             /*DEFAULT GET/PUT TO WF       */ 05141000
*                                                                  1327 05142000
         OI    RSRWF(REG6),B'10000000'                             1327 05143000
*        /************************************************************/ 05144000
*        /*                                                          */ 05145000
*        /*   IF IT IS FOR UNIQUE SPACE, ISSUE A MESSAGE(IDC11033I)  */ 05146000
*        /*   TO TELL THE USER THAT THE UNIQUE EXISTS ON THE PACK    */ 05147000
*        /*   WITH NO CORRESPONDING CATALOG ENTRY                    */ 05148000
*        /*                                                          */ 05149000
*        /************************************************************/ 05150000
*                                                                  1328 05151000
*              IF CUNIQ = ON THEN                                  1328 05152000
         L     @07,RSGRABCU(,REG6)                                 1328 05153000
         LA    @04,8                                               1328 05154000
         AL    @04,GRABCURR(,@07)                                  1328 05155000
         TM    CUNIQ(@04),B'01000000'                              1328 05156000
         BNO   @RF01328                                            1328 05157000
*                DO;                                               1329 05158000
*                  IF RSPVDELT = ON THEN /*NO SPACE MATCH            */ 05159000
*                                                                  1330 05160000
         TM    RSPVDELT(REG6),B'00100000'                          1330 05161000
         BNO   @RF01330                                            1330 05162000
*                    DO;                                           1331 05163000
*                    /*CALL CKERR*/                                1332 05164000
*                      RSCKERR = RSCKERR && RSCKERR;               1332 05165000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1332 05166000
*                      RSCKERN = RSE044;                           1333 05167000
         MVC   RSCKERN(2,REG6),@CH00595                            1333 05168000
*                      RSCKTERM = 'RETU';                          1334 05169000
         MVC   RSCKTERM(4,REG6),@CC03500                           1334 05170000
*                      RSCKMVAR(1) = ADDR(CNAME);                  1335 05171000
         LA    @07,CNAME(,@04)                                     1335 05172000
         ST    @07,RSCKMVAR(,REG6)                                 1335 05173000
*                      RSCKMVAR(2) = ADDR(VOLSRSER);               1336 05174000
*                                                                  1336 05175000
         L     @07,RSVTBENT(,REG6)                                 1336 05176000
         LA    @07,VOLSRSER(,@07)                                  1336 05177000
         ST    @07,RSCKMVAR+4(,REG6)                               1336 05178000
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR   */ 05179000
*                    CALL CKERR;                                   1337 05180000
         L     @15,@CV03443                                        1337 05181000
         BALR  @14,@15                                             1337 05182000
*                    END;                                          1338 05183000
*                END;                                              1339 05184000
*                                                                  1339 05185000
*        /************************************************************/ 05186000
*        /*                                                          */ 05187000
*        /*   IF THE OBJECT WAS SUBALLOCATED, THEN RETURN ANY        */ 05188000
*        /*   UNUSED OR UNMATCHED EXTENTS FOR FUTURE SUBALLOCATION.  */ 05189000
*        /*                                                          */ 05190000
*        /************************************************************/ 05191000
*                                                                  1340 05192000
*              ELSE                                                1340 05193000
*  VLNRSUBS:     DO;                                               1340 05194000
*                                                                  1340 05195000
         B     @RC01328                                            1340 05196000
@RF01328 DS    0H                                                  1340 05197000
VLNRSUBS DS    0H                                                  1341 05198000
*        /************************************************************/ 05199000
*        /*                                                          */ 05200000
*        /*  CHECK FOR ANY TRACKS STILL AVAILABLE                    */ 05201000
*        /*                                                          */ 05202000
*        /************************************************************/ 05203000
*                                                                  1341 05204000
*                  RSRETSPC = OFF;     /*RESET NO SPACE AVAILABLE    */ 05205000
         NI    RSRETSPC(REG6),B'11111011'                          1341 05206000
*                  DO TMPSZ = 1 TO RSMAPSIZ;                       1342 05207000
         LA    @07,1                                               1342 05208000
         B     @DE01342                                            1342 05209000
@DL01342 DS    0H                                                  1343 05210000
*                    IF RSCABMAP->BMAP(TMPSZ:TMPSZ) ^= '00'X THEN  1343 05211000
         L     @07,TMPSZ(,REG6)                                    1343 05212000
         L     @04,RSCABMAP(,REG6)                                 1343 05213000
         ALR   @04,@07                                             1343 05214000
         BCTR  @04,0                                               1343 05215000
         CLI   BMAP(@04),X'00'                                     1343 05216000
         BE    @RF01343                                            1343 05217000
*                      RSRETSPC = ON; /*DEFINITELY SPACE TO RETURN   */ 05218000
         OI    RSRETSPC(REG6),B'00000100'                          1344 05219000
*                  END;                                            1345 05220000
*                                                                  1345 05221000
@RF01343 LA    @07,1                                               1345 05222000
         AL    @07,TMPSZ(,REG6)                                    1345 05223000
@DE01342 ST    @07,TMPSZ(,REG6)                                    1345 05224000
         C     @07,RSMAPSIZ(,REG6)                                 1345 05225000
         BNH   @DL01342                                            1345 05226000
*        /************************************************************/ 05227000
*        /*                                                          */ 05228000
*        /*   MAP UNUSED TRACKS(IN CATALOG VGO MAP) INTO THE         */ 05229000
*        /*   PRIMARY MAP                                            */ 05230000
*        /*   DUMP POINT RSUA - SPACE BEING RETURNED TO THE MAP      */ 05231000
*        /*                                                          */ 05232000
*        /************************************************************/ 05233000
*                                                                  1346 05234000
*                  IF RSRETSPC = ON THEN                           1346 05235000
         TM    RSRETSPC(REG6),B'00000100'                          1346 05236000
         BNO   @RF01346                                            1346 05237000
*                    DO;                                           1347 05238000
*                                                                  1347 05239000
*                      IF GDTDBG = NULLPTR                         1348 05240000
*                        THEN;                                     1348 05241000
         L     @07,GDTDBG(,REG5)                                   1348 05242000
         LTR   @07,@07                                             1348 05243000
         BZ    @RT01348                                            1348 05244000
*                        ELSE                                      1350 05245000
*                          CALL IDCDB010(GDTTBL,'RSUA');           1350 05246000
*                                                                  1350 05247000
         ST    REG5,@AL00001                                       1350 05248000
         LA    @07,@CC03618                                        1350 05249000
         ST    @07,@AL00001+4                                      1350 05250000
         MVI   @AL00001+4,X'80'                                    1350 05251000
         L     @15,GDTDBG(,REG5)                                   1350 05252000
         LA    @01,@AL00001                                        1350 05253000
         BALR  @14,@15                                             1350 05254000
*                      RSPVSETB = ''B; /*CLEAR SETBITS OPTIONS       */ 05255000
@RT01348 MVI   RSPVSETB(REG6),X'00'                                1351 05256000
*                      RSSETMAP = ON;                              1352 05257000
*                      RSST1TO1 = ON; /*SET AVAILABLE TRACKS         */ 05258000
         OI    RSSETMAP(REG6),B'01010000'                          1353 05259000
*                      RSTGBMAP = RSPBMAP; /*COLLECT IN PRIM MAP     */ 05260000
         L     @07,RSPBMAP(,REG6)                                  1354 05261000
         ST    @07,RSTGBMAP(,REG6)                                 1354 05262000
*                      RSSTBMAP = RSCABMAP; /*UNUSED TRKS IN CAT MAP */ 05263000
         L     @07,RSCABMAP(,REG6)                                 1355 05264000
         ST    @07,RSSTBMAP(,REG6)                                 1355 05265000
*                      CALL SETBITS;                               1356 05266000
         BAL   @14,SETBITS                                         1356 05267000
*                      RSPVNRP = ON; /*SPACE MAP TO BE UPDATED       */ 05268000
         OI    RSPVNRP(REG6),B'00010000'                           1357 05269000
*                    END;                                          1358 05270000
*                                                                  1358 05271000
*                END VLNRSUBS;                                     1359 05272000
@RF01346 DS    0H                                                  1360 05273000
*            END VLNRSPC;                                          1360 05274000
*                                                                  1360 05275000
@RC01328 DS    0H                                                  1361 05276000
*        /************************************************************/ 05277000
*        /*                                                          */ 05278000
*        /*   FREE THE VGO SNTABS FOR REUSE                          */ 05279000
*        /*                                                          */ 05280000
*        /************************************************************/ 05281000
*                                                                  1361 05282000
*          IF RSPVSNT3 ^= 0 THEN                                   1361 05283000
@RF01309 L     @07,RSPVSNT3(,REG6)                                 1361 05284000
         LTR   @07,@07                                             1361 05285000
         BZ    @RF01361                                            1361 05286000
*            RSPVSNT3->RSFENTLN = 0;                               1362 05287000
         MVI   RSFENTLN(@07),X'00'                                 1362 05288000
*          IF RSPVSNTC ^= 0 THEN                                   1363 05289000
@RF01361 L     @07,RSPVSNTC(,REG6)                                 1363 05290000
         LTR   @07,@07                                             1363 05291000
         BZ    @RF01363                                            1363 05292000
*            RSPVSNTC->RSFENTLN = 0;                               1364 05293000
*                                                                  1364 05294000
         MVI   RSFENTLN(@07),X'00'                                 1364 05295000
*        /************************************************************/ 05296000
*        /*                                                          */ 05297000
*        /*  REACTIVATE THE DSDIR SN TABLE                           */ 05298000
*        /*                                                          */ 05299000
*        /************************************************************/ 05300000
*                                                                  1365 05301000
*          RSWASNVT = RSPVSNT8;                                    1365 05302000
@RF01363 L     @07,RSPVSNT8(,REG6)                                 1365 05303000
         ST    @07,RSWASNVT(,REG6)                                 1365 05304000
*          RSGRABCU = ADDR(GRABSWF); /*DEFAULT WORKFILE              */ 05305000
         L     @07,RSIOTBL(,REG6)                                  1366 05306000
         ST    @07,RSGRABCU(,REG6)                                 1366 05307000
*        END VLNRDSDI;                                             1367 05308000
         L     @04,RSWASNVT(,REG6)                                 1367 05309000
         LA    @07,1                                               1367 05310000
         AH    @07,RSFCNDX(,@04)                                   1367 05311000
@DE01190 L     @04,RSWASNVT(,REG6)                                 1367 05312000
         STH   @07,RSFCNDX(,@04)                                   1367 05313000
         L     @04,RSWASNVT(,REG6)                                 1367 05314000
         CH    @07,RSFHNDX(,@04)                                   1367 05315000
         BNH   @DL01190                                            1367 05316000
*        /************************************************************/ 05317000
*        /*                                                          */ 05318000
*        /*  IF ANY SPACE WAS RETURNED FOR SUBALLOCATION, THEN       */ 05319000
*        /*  UPDATE THE SPACE MAP FOR THE VOLUME.                    */ 05320000
*        /*                                                          */ 05321000
*        /************************************************************/ 05322000
*                                                                  1368 05323000
*        IF RSPVNRP = ON THEN                                      1368 05324000
         TM    RSPVNRP(REG6),B'00010000'                           1368 05325000
         BNO   @RF01368                                            1368 05326000
*  VLNRUPSM:                                                       1369 05327000
*          DO;                                                     1369 05328000
VLNRUPSM DS    0H                                                  1370 05329000
*            RSWFBMAP = RSWKBMAP;      /*SPACE MAP STG FOR FIND      */ 05330000
         L     @07,RSWKBMAP(,REG6)                                 1370 05331000
         ST    @07,RSWFBMAP(,REG6)                                 1370 05332000
*            RSWFBMLN = RSMAPSIZ;      /*SIZE OF MAP                 */ 05333000
         L     @07,RSMAPSIZ(,REG6)                                 1371 05334000
         STH   @07,RSWFBMLN(,REG6)                                 1371 05335000
*            GRABCURR = GRABRAB1;      /*VOLUME RECORD AS BASE       */ 05336000
*                                                                  1372 05337000
         L     @07,RSGRABCU(,REG6)                                 1372 05338000
         L     @04,GRABRAB1(,@07)                                  1372 05339000
         ST    @04,GRABCURR(,@07)                                  1372 05340000
*            DO;                                                   1373 05341000
*              GRABBB = GRABCURR;                                  1374 05342000
         ST    @04,GRABBB(,@07)                                    1374 05343000
*              RSWGCODE = GCSPCMAP;    /*SPECIFY GROUP CODE          */ 05344000
         MVI   RSWGCODE(REG6),X'05'                                1375 05345000
*              RSWFONE = OFF;          /*FIND ALL OCCURRENCES        */ 05346000
         NI    RSWFONE(REG6),B'01111111'                           1376 05347000
*              /* CALL THE FIND SUBROUTINE */                      1377 05348000
*                                                                  1377 05349000
*            /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND            */ 05350000
*            CALL FIND;                                            1377 05351000
         L     @15,@CV03435                                        1377 05352000
         BALR  @14,@15                                             1377 05353000
*            END;                                                  1378 05354000
*                                                                  1378 05355000
*        /************************************************************/ 05356000
*        /*                                                          */ 05357000
*        /*  IF THERE IS NO SPACE MAP OR IT WAS THE WRONG LENGTH,    */ 05358000
*        /*  ISSUE MESSAGE IDC11034I.                                */ 05359000
*        /*                                                          */ 05360000
*        /************************************************************/ 05361000
*                                                                  1379 05362000
*            IF (RSFENTLN=0) | (RSFLENBM^=RSMAPSIZ) THEN           1379 05363000
*                                                                  1379 05364000
         L     @07,RSWASNVT(,REG6)                                 1379 05365000
         CLI   RSFENTLN(@07),0                                     1379 05366000
         BE    @RT01379                                            1379 05367000
         LH    @07,RSFLENBM(,@07)                                  1379 05368000
         C     @07,RSMAPSIZ(,REG6)                                 1379 05369000
         BE    @RF01379                                            1379 05370000
@RT01379 DS    0H                                                  1380 05371000
*              DO;                                                 1380 05372000
*              /*CALL CKERR*/                                      1381 05373000
*                RSCKERR = RSCKERR && RSCKERR;                     1381 05374000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1381 05375000
*                RSCKERN = RSE045;                                 1382 05376000
         MVC   RSCKERN(2,REG6),@CH00976                            1382 05377000
*                RSCKTERM = 'RETU';                                1383 05378000
         MVC   RSCKTERM(4,REG6),@CC03500                           1383 05379000
*                RSCKMVAR(1) = ADDR(VOLSRSER);                     1384 05380000
*                                                                  1384 05381000
         L     @07,RSVTBENT(,REG6)                                 1384 05382000
         LA    @07,VOLSRSER(,@07)                                  1384 05383000
         ST    @07,RSCKMVAR(,REG6)                                 1384 05384000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */ 05385000
*              CALL CKERR;                                         1385 05386000
         L     @15,@CV03443                                        1385 05387000
         BALR  @14,@15                                             1385 05388000
*              END;                                                1386 05389000
*                                                                  1386 05390000
*        /************************************************************/ 05391000
*        /*                                                          */ 05392000
*        /*  RETURN SUBALLOCATED SPACE                               */ 05393000
*        /*                                                          */ 05394000
*        /************************************************************/ 05395000
*                                                                  1387 05396000
*            ELSE                                                  1387 05397000
*              DO;                                                 1387 05398000
         B     @RC01379                                            1387 05399000
@RF01379 DS    0H                                                  1388 05400000
*                RSPVSETB = ''B;       /*CLEAR SETBITS OPTIONS       */ 05401000
         MVI   RSPVSETB(REG6),X'00'                                1388 05402000
*                RSSETMAP = ON;        /*MAP TO MAP                  */ 05403000
*                RSST1TO1 = ON;        /*MAKE TRACKS AVAILABLE       */ 05404000
         OI    RSSETMAP(REG6),B'01010000'                          1390 05405000
*                RSTGBMAP = RSFABMAP;  /*SET SPACE MAP               */ 05406000
         L     @07,RSWASNVT(,REG6)                                 1391 05407000
         L     @07,RSFABMAP(,@07)                                  1391 05408000
         ST    @07,RSTGBMAP(,REG6)                                 1391 05409000
*                RSSTBMAP = RSPBMAP;   /*TRACKS AVAILABLE IN PRIMARY */ 05410000
         L     @07,RSPBMAP(,REG6)                                  1392 05411000
         ST    @07,RSSTBMAP(,REG6)                                 1392 05412000
*                CALL SETBITS;                                     1393 05413000
*                                                                  1393 05414000
         BAL   @14,SETBITS                                         1393 05415000
*        /************************************************************/ 05416000
*        /*                                                          */ 05417000
*        /*               MOFIFY THE SPACE MAP                       */ 05418000
*        /*                                                          */ 05419000
*        /************************************************************/ 05420000
*                                                                  1394 05421000
*                /* CALL TO MODULE IDCRS04 FOR PROCEDURE MODGO       */ 05422000
*                CALL MODGO;                                       1394 05423000
*                                                                  1394 05424000
         L     @15,@CV03433                                        1394 05425000
         BALR  @14,@15                                             1394 05426000
*        /************************************************************/ 05427000
*        /*                                                          */ 05428000
*        /*  INFORM THE USER THAT THE SPACE MAP WAS MODIFIED         */ 05429000
*        /*  MESSAGE - IDC11029I.                                    */ 05430000
*        /*                                                          */ 05431000
*        /************************************************************/ 05432000
*                                                                  1395 05433000
*                                                                  1395 05434000
*                DO;                                               1395 05435000
*                /*CALL CKERR*/                                    1396 05436000
*                  RSCKERR = RSCKERR && RSCKERR;                   1396 05437000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1396 05438000
*                  RSCKERN = RSE032;                               1397 05439000
         MVC   RSCKERN(2,REG6),@CH00215                            1397 05440000
*                  RSCKTERM = 'RETU';                              1398 05441000
         MVC   RSCKTERM(4,REG6),@CC03500                           1398 05442000
*                  RSCKMVAR(1) = ADDR(VOLSRSER);                   1399 05443000
*                                                                  1399 05444000
         L     @07,RSVTBENT(,REG6)                                 1399 05445000
         LA    @07,VOLSRSER(,@07)                                  1399 05446000
         ST    @07,RSCKMVAR(,REG6)                                 1399 05447000
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */ 05448000
*                CALL CKERR;                                       1400 05449000
         L     @15,@CV03443                                        1400 05450000
         BALR  @14,@15                                             1400 05451000
*                END;                                              1401 05452000
*              END;                                                1402 05453000
*            RSFENTLN = 0;             /*FREE SPACE MAP SNTAB        */ 05454000
@RC01379 L     @07,RSWASNVT(,REG6)                                 1403 05455000
         MVI   RSFENTLN(@07),X'00'                                 1403 05456000
*          END VLNRUPSM;                                           1404 05457000
*                                                                  1404 05458000
*        /************************************************************/ 05459000
*        /*                                                          */ 05460000
*        /*   IF ANY LOGICAL OR PHYSICAL I/O ERRORS OCCURRED IN      */ 05461000
*        /*   PROCESSING THE NON-RESET VOLUME, FORCE AN IGNORE-ONLY  */ 05462000
*        /*   RESET. ISSUE MESSAGE FOR THIS BAD VOLUME (IDC31035I).  */ 05463000
*        /*                                                          */ 05464000
*        /************************************************************/ 05465000
*                                                                  1405 05466000
*        IF RSBDVOLS = ON THEN                                     1405 05467000
@RF01368 TM    RSBDVOLS(REG6),B'00000010'                          1405 05468000
         BNO   @RF01405                                            1405 05469000
*          DO;                                                     1406 05470000
*            RSBADVOL = ON;            /*BAD VOLUME EXISTS           */ 05471000
*                                                                  1407 05472000
         OI    RSBADVOL(REG6),B'00000010'                          1407 05473000
*            DO;                                                   1408 05474000
*            /*CALL CKERR*/                                        1409 05475000
*              RSCKERR = RSCKERR && RSCKERR;                       1409 05476000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1409 05477000
*              RSCKERN = RSE047;                                   1410 05478000
         MVC   RSCKERN(2,REG6),@CH00747                            1410 05479000
*              RSCKTERM = 'RETU';                                  1411 05480000
         MVC   RSCKTERM(4,REG6),@CC03500                           1411 05481000
*              RSCKMVAR(1) = ADDR(VOLSRSER);                       1412 05482000
*                                                                  1412 05483000
         L     @07,RSVTBENT(,REG6)                                 1412 05484000
         LA    @07,VOLSRSER(,@07)                                  1412 05485000
         ST    @07,RSCKMVAR(,REG6)                                 1412 05486000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 05487000
*            CALL CKERR;                                           1413 05488000
         L     @15,@CV03443                                        1413 05489000
         BALR  @14,@15                                             1413 05490000
*            END;                                                  1414 05491000
*          END;                                                    1415 05492000
*                                                                  1415 05493000
*  CALL EXIT;  /*TERMINATE*/                                       1416 05494000
@RF01405 BAL   @14,EXIT                                            1416 05495000
*  END VLNRESET; /*END OF PROCEDURE*/                              1417 05496000
@EL00015 DS    0H                                                  1417 05497000
@EF00015 DS    0H                                                  1417 05498000
@ER00015 BR    @14                                                 1417 05499000
@PB00015 DS    0H                                                  1418 05500000
*/********************************************************************/ 05501000
*/* PROCEDURE NAME - VLRESET                                         */ 05502000
*/*                                                                  */ 05503000
*/* FUNCTION -                                                       */ 05504000
*/*     PROCESS A RESET VOLUME. USING THE DATA SET                   */ 05505000
*/*     DIRECTORY ENTRIES (DSDIRS), FIND EVERY OBJECT THAT           */ 05506000
*/*     CLAIMS SPACE ON THE VOLUME. PERFORM THE FOLLOWING:           */ 05507000
*/*       . DELETE THE DSDIR IF THE OBJECT CANNOT BE FOUND           */ 05508000
*/*         OR A SPACE CONFLICT EXISTS.                              */ 05509000
*/*       . UPDATE THD DSDIR IF THE OBJECT WAS REASSIGNED.           */ 05510000
*/*       . MARK A VOLUME GROUP OCCURRENCE UNUSABLE, IF THERE        */ 05511000
*/*         IS A SPACE CONFLICT.                                     */ 05512000
*/*       . UPDATE THE SPACE MAP ON THE VOLUME TO REFLECT ANY        */ 05513000
*/*         RETURNED SUBALLOCATED SPACE.                             */ 05514000
*/*                                                                  */ 05515000
*/* INPUT -                                                          */ 05516000
*/*     VOLUME RECORD IN WORKFILE BUFFER 1                           */ 05517000
*/*     RSWKBMAP - ADDRESS OF SPACE MAP FOR FIND                     */ 05518000
*/*     RSPBMAP - ADDRESS OF SPACE MAP FOR SUBALLOCATED SPACE        */ 05519000
*/*     RSMAPSIZ - SIZE OF THE SPACE MAP                             */ 05520000
*/*     RSPVSNT6 - ADDRESS OF SN TABLE FOR THE SPACE HEADERS         */ 05521000
*/*                ON THIS VOLUME                                    */ 05522000
*/*     RSPVSNT8 - ADDRESS OF SN TABLE FOR THE DSDIRS ON THIS        */ 05523000
*/*                VOLUME                                            */ 05524000
*/*     RSENTPT - ADDRESS OF RESVOL ENTRY FOR THIS VOLUME            */ 05525000
*/*                                                                  */ 05526000
*/* OUTPUT -                                                         */ 05527000
*/*     CORRECT VOLUME SET OF RECORDS PER THE FUNCTIONAL             */ 05528000
*/*     DESCRIPTION.                                                 */ 05529000
*/*                                                                  */ 05530000
*/* MESSAGES -                                                       */ 05531000
*/*     IDC11033I - UNIQUE DSNAME NOT DELETED                        */ 05532000
*/*     IDC11034I - SPACE MAP ERROR (INCORRECT LENGTH)               */ 05533000
*/*     IDC11029I - SPACE MAP MODIFIED                               */ 05534000
*/*     IDC21027I - CRA OR CAT SPACE NOT OWNED BY CATALOG.           */ 05535000
*/*     IDC11031I - UNIQUE DATA OR INDEX HAS FEWER EXTENTS           */ 05536000
*/*                 THAN THE DATA SPACE.                             */ 05537000
*/*                                                                  */ 05538000
*/********************************************************************/ 05539000
*      GENERATE;                                                   1418 05540000
         DS    0F                                                       05541000
NAME0124 DC    CL8'VLRESET'                                             05542000
*VLRESET: PROCEDURE                                                1419 05543000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1419 05544000
*                                                                  1419 05545000
         B     @PB00016                                            1419 05546000
VLRESET  DS    0H                                                  1420 05547000
*      GENERATE REFS(RS03RG08, REG6);                              1420 05548000
*                                                                  1420 05549000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          05550000
         LR    @15,@13  OLD SAVE AREA                                   05551000
         LA    @13,72(@13)  NEW SAVE AREA                               05552000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     05553000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        05554000
         MVC   0(4,@15),NAME0124  PROCNAME TO REGSAVE                   05555000
*        OLDERID2 = NEWERID2;                                      1421 05556000
         L     @07,GDTTR2(,REG5)                                   1421 05557000
         MVC   @TS00001(95),NEWERID2(@07)                          1421 05558000
         MVC   OLDERID2(95,@07),@TS00001                           1421 05559000
*        NEWID2 = 'RSVS';                                          1422 05560000
*                                                                  1422 05561000
         MVC   NEWID2(4,@07),@CC03624                              1422 05562000
*        /************************************************************/ 05563000
*        /*                                                          */ 05564000
*        /*  RESET FLAGS, ETC.                                       */ 05565000
*        /*                                                          */ 05566000
*        /************************************************************/ 05567000
*                                                                  1423 05568000
*        RSPVRPC = OFF;                /*RESET PRIMARY CONFLICT      */ 05569000
*        RSPVRSC = OFF;                /*RESET SECONDARY CONFLICT    */ 05570000
*                                                                  1424 05571000
         NI    RSPVRPC(REG6),B'11110011'                           1424 05572000
*        /************************************************************/ 05573000
*        /*                                                          */ 05574000
*        /*  CRA - CHECK SUBALLOCATION CONFLICT                      */ 05575000
*        /*     USING THE VGOS FOR THE CRA, BUILD A SPACE MAP WITH A */ 05576000
*        /*     BIT ON FOR EACH TRACK OF THE CRA. CHECK IF ALL       */ 05577000
*        /*     TRACKS ARE AVAILABLE FOR SUBALLOCATION. IF NOT       */ 05578000
*        /*     SPACE IS IN CONFLICT - ISSUE MESSAGE IDC21027I. IF   */ 05579000
*        /*     AVAILABLE, SUBALLOCATE IT.                           */ 05580000
*        /*                                                          */ 05581000
*        /************************************************************/ 05582000
*                                                                  1425 05583000
*        RSPVSETB = ''B;               /*CLEAR SETBITS OPTIONS       */ 05584000
         MVI   RSPVSETB(REG6),X'00'                                1425 05585000
*        RSSETCRA = ON;                /*CRA TYPE SET                */ 05586000
*        RSPVCLBM = ON;                /*CLEAR WORK MAP BEFORE USING */ 05587000
         OI    RSSETCRA(REG6),B'10100000'                          1427 05588000
*        RSTGBMAP = RSWKBMAP;          /*SET IN WORK MAP             */ 05589000
         L     @07,RSWKBMAP(,REG6)                                 1428 05590000
         ST    @07,RSTGBMAP(,REG6)                                 1428 05591000
*        CALL SETBITS;                                             1429 05592000
*                                                                  1429 05593000
         BAL   @14,SETBITS                                         1429 05594000
*        RSCKBMAP = RSPBMAP;           /*CHECK FOR AVAILABLE TRACKS  */ 05595000
         L     @07,RSPBMAP(,REG6)                                  1430 05596000
         ST    @07,RSCKBMAP(,REG6)                                 1430 05597000
*        RSCK1TO1 = ON;                /*ON MEANS AVAILABLE          */ 05598000
         OI    RSCK1TO1(REG6),B'00000001'                          1431 05599000
*        CALL CHKBITS;                                             1432 05600000
*                                                                  1432 05601000
         BAL   @14,CHKBITS                                         1432 05602000
*        IF (RSCKBERR = ON) | (RSSETERR = ON) THEN /*CRA SPC NOT OWN */ 05603000
*                                                                  1433 05604000
         TM    RSCKBERR(REG6),B'00000010'                          1433 05605000
         BO    @RT01433                                            1433 05606000
         TM    RSSETERR(REG6),B'00001000'                          1433 05607000
         BNO   @RF01433                                            1433 05608000
@RT01433 DS    0H                                                  1434 05609000
*          DO;                                                     1434 05610000
*          /*CALL CKERR*/                                          1435 05611000
*            RSCKERR = RSCKERR && RSCKERR;                         1435 05612000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1435 05613000
*            RSCKERN = RSE030;                                     1436 05614000
         MVC   RSCKERN(2,REG6),@CH00950                            1436 05615000
*            RSCKTERM = 'RETU';                                    1437 05616000
         MVC   RSCKTERM(4,REG6),@CC03500                           1437 05617000
*            RSCKMVAR(1) = ADDR(VOLSRSER);                         1438 05618000
*                                                                  1438 05619000
         L     @07,RSVTBENT(,REG6)                                 1438 05620000
         LA    @07,VOLSRSER(,@07)                                  1438 05621000
         ST    @07,RSCKMVAR(,REG6)                                 1438 05622000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */ 05623000
*          CALL CKERR;                                             1439 05624000
         L     @15,@CV03443                                        1439 05625000
         BALR  @14,@15                                             1439 05626000
*          END;                                                    1440 05627000
*        ELSE                                                      1441 05628000
*          DO;                                                     1441 05629000
         B     @RC01433                                            1441 05630000
@RF01433 DS    0H                                                  1442 05631000
*            RSPVSETB = ''B;           /*CLEAR SETBITS OPTIOSN       */ 05632000
         MVI   RSPVSETB(REG6),X'00'                                1442 05633000
*            RSSETMAP = ON;            /*SUBALLOCATE TRACKS          */ 05634000
*            RSST1TO1 = OFF;           /*BY SETTING BIT OFF IN MAP   */ 05635000
         OI    RSSETMAP(REG6),B'01000000'                          1444 05636000
         NI    RSST1TO1(REG6),B'11101111'                          1444 05637000
*            RSTGBMAP = RSPBMAP;       /*TOTAL MAP                   */ 05638000
         L     @07,RSPBMAP(,REG6)                                  1445 05639000
         ST    @07,RSTGBMAP(,REG6)                                 1445 05640000
*            RSSTBMAP = RSWKBMAP;      /*TRACKS TO BE ALLOCATED      */ 05641000
         L     @07,RSWKBMAP(,REG6)                                 1446 05642000
         ST    @07,RSSTBMAP(,REG6)                                 1446 05643000
*            CALL SETBITS;                                         1447 05644000
         BAL   @14,SETBITS                                         1447 05645000
*          END;                                                    1448 05646000
*        /************************************************************/ 05647000
*        /*                                                          */ 05648000
*        /*  ALLOW FOR NO OBJECTS DEFINED ON THE RESET VOLUME        */ 05649000
*        /*                                                          */ 05650000
*        /************************************************************/ 05651000
*                                                                  1449 05652000
*        RSWASNVT = RSPVSNT8;          /*DSDIR SN TABLE              */ 05653000
@RC01433 L     @07,RSPVSNT8(,REG6)                                 1449 05654000
         ST    @07,RSWASNVT(,REG6)                                 1449 05655000
*        IF RSPVSNT8 = 0 THEN;                                     1450 05656000
*                                                                  1450 05657000
         LTR   @07,@07                                             1450 05658000
         BZ    @RT01450                                            1450 05659000
*        /************************************************************/ 05660000
*        /*                                                          */ 05661000
*        /*  PROCESS EACH DSDIR                                      */ 05662000
*        /*                                                          */ 05663000
*        /************************************************************/ 05664000
*                                                                  1452 05665000
*        ELSE                                                      1452 05666000
*  VLRDSDIR:                                                       1452 05667000
*          DO RSFCNDX = 1 TO RSFHNDX;                              1452 05668000
VLRDSDIR LA    @07,1                                               1452 05669000
         B     @DE01452                                            1452 05670000
@DL01452 DS    0H                                                  1453 05671000
*            RSFAENT = RSFCADR + (RSFENTLN*(RSFCNDX-1));           1453 05672000
         L     @07,RSWASNVT(,REG6)                                 1453 05673000
         LH    @04,RSFCNDX(,@07)                                   1453 05674000
         BCTR  @04,0                                               1453 05675000
         LR    @01,@04                                             1453 05676000
         SLR   @04,@04                                             1453 05677000
         IC    @04,RSFENTLN(,@07)                                  1453 05678000
         MR    @00,@04                                             1453 05679000
         AL    @01,RSFCADR(,@07)                                   1453 05680000
         ST    @01,RSFAENT(,@07)                                   1453 05681000
*                                      /*NEXT DSDIR                  */ 05682000
*            RSPVDELT = OFF;           /*RESET DELETE DSDIR          */ 05683000
         NI    RSPVDELT(REG6),B'11011111'                          1454 05684000
*            RSMUNUS = OFF;            /*RESET MARK UNUSABLE         */ 05685000
         NI    RSMUNUS(REG6),B'01111111'                           1455 05686000
*            RSPVSNT3 = 0;             /*NO VGO                      */ 05687000
*                                                                  1456 05688000
         SLR   @07,@07                                             1456 05689000
         ST    @07,RSPVSNT3(,REG6)                                 1456 05690000
*        /************************************************************/ 05691000
*        /*                                                          */ 05692000
*        /*     CATALOG ALLOCATED ON THIS VOLUME                     */ 05693000
*        /*                                                          */ 05694000
*        /************************************************************/ 05695000
*                                                                  1457 05696000
*            IF SDSIDNO = CLUSCI THEN                              1457 05697000
         CLC   SDSIDNO(3,@01),@CF00149+1                           1457 05698000
         BNE   @RF01457                                            1457 05699000
*  VLRCATLG:                                                       1458 05700000
*              DO;                                                 1458 05701000
VLRCATLG DS    0H                                                  1459 05702000
*                RSVLCATE = OFF;       /*RESET CATALOG CONFLICT      */ 05703000
*                                                                  1459 05704000
         NI    RSVLCATE(REG6),B'10111111'                          1459 05705000
*        /************************************************************/ 05706000
*        /*                                                          */ 05707000
*        /*     CATALOG IS NOT THE CATALOG BEING RESET. MUST         */ 05708000
*        /*     HAVE DEFINED A NEW CATALOG AND ISSUED A RESET FOR    */ 05709000
*        /*     THE OLD CATALOG VOLUME. DELETE THE OLD CATALOG       */ 05710000
*        /*     DSDIR.                                               */ 05711000
*        /*                                                          */ 05712000
*        /************************************************************/ 05713000
*                                                                  1460 05714000
*                IF VOLSRSER ^= RSINVLSR THEN                      1460 05715000
         L     @07,RSVTBENT(,REG6)                                 1460 05716000
         CLC   VOLSRSER(6,@07),RSINVLSR(REG6)                      1460 05717000
         BE    @RF01460                                            1460 05718000
*                  RSPVDELT = ON;                                  1461 05719000
*                                                                  1461 05720000
         OI    RSPVDELT(REG6),B'00100000'                          1461 05721000
*        /************************************************************/ 05722000
*        /*                                                          */ 05723000
*        /*     CATALOG IS THE CATALOG BEING RESET. PROCESS          */ 05724000
*        /*     THE DATA AND INDEX FOR SPACE.                        */ 05725000
*        /*                                                          */ 05726000
*        /************************************************************/ 05727000
*                                                                  1462 05728000
*                ELSE                                              1462 05729000
*                  DO;                                             1462 05730000
         B     @RC01460                                            1462 05731000
@RF01460 DS    0H                                                  1463 05732000
*                    GRABCURR = GRABRAB2; /*USE BUFFER 2             */ 05733000
         L     @07,RSGRABCU(,REG6)                                 1463 05734000
         L     @04,GRABRAB2(,@07)                                  1463 05735000
         ST    @04,GRABCURR(,@07)                                  1463 05736000
*                    RABRCDA = DATACI; /*PROCESS DATA FIRST          */ 05737000
         SLR   @07,@07                                             1464 05738000
         ST    @07,RABRCDA(,@04)                                   1464 05739000
*                    DO RSIDX = 1 TO 2;                            1465 05740000
*                                                                  1465 05741000
         LA    @07,1                                               1465 05742000
         STH   @07,RSIDX(,REG6)                                    1465 05743000
@DL01465 DS    0H                                                  1466 05744000
*                      DO;                                         1466 05745000
*                        RSRTYPE = ''B;                            1467 05746000
         MVI   RSRTYPE(REG6),X'00'                                 1467 05747000
*                        RSRGET = ON;      /* GETRCD  */           1468 05748000
         OI    RSRGET(REG6),B'10000000'                            1468 05749000
*                        RSRUPD = OFF;     /* NO UPDATE  */        1469 05750000
         NI    RSRUPD(REG6),B'11110111'                            1469 05751000
*                        RSRDS = ''B;                              1470 05752000
         NI    RSRDS(REG6),B'00011111'                             1470 05753000
*                        RSRWF = ON;       /* WORKFILE  */         1471 05754000
*                        RSRDIR = ON;      /* DIRECT  */           1472 05755000
*                        RSRKEY = ON;      /* KEY  */              1473 05756000
*                                                                  1473 05757000
         OI    RSRWF(REG6),B'10010100'                             1473 05758000
*                      /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT  05759000
*                                                                    */ 05760000
*                      CALL RECMGMT;                               1474 05761000
         L     @15,@CV03452                                        1474 05762000
         BALR  @14,@15                                             1474 05763000
*                        RFY RTNREG RSTD;                          1475 05764000
*                        TESTRC = RTNREG;                          1476 05765000
         STH   RTNREG,TESTRC(,REG6)                                1476 05766000
*                        RFY RTNREG UNRSTD;                        1477 05767000
*                      END;                                        1478 05768000
*                                                                  1478 05769000
*        /************************************************************/ 05770000
*        /*                                                          */ 05771000
*        /*     FIND ALL OF THE VGOS.                                */ 05772000
*        /*                                                          */ 05773000
*        /************************************************************/ 05774000
*                                                                  1479 05775000
*                                                                  1479 05776000
*                      DO;                                         1479 05777000
*                        GRABBB = GRABCURR;                        1480 05778000
         L     @07,RSGRABCU(,REG6)                                 1480 05779000
         L     @04,GRABCURR(,@07)                                  1480 05780000
         ST    @04,GRABBB(,@07)                                    1480 05781000
*                        RSWGCODE = GCVOLGO;                       1481 05782000
         MVI   RSWGCODE(REG6),X'03'                                1481 05783000
*                                      /*SPECIFY GROUP CODE          */ 05784000
*                        RSWFONE = OFF;/*FIND ALL OCCURRENCES        */ 05785000
         NI    RSWFONE(REG6),B'01111111'                           1482 05786000
*                        /* CALL THE FIND SUBROUTINE */            1483 05787000
*                                                                  1483 05788000
*                      /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND  */ 05789000
*                      CALL FIND;                                  1483 05790000
         L     @15,@CV03435                                        1483 05791000
         BALR  @14,@15                                             1483 05792000
*                      END;                                        1484 05793000
*                      RSFAENT = RSFCADR; /*FIRST VGO                */ 05794000
*                                                                  1485 05795000
         L     @07,RSWASNVT(,REG6)                                 1485 05796000
         L     @04,RSFCADR(,@07)                                   1485 05797000
         ST    @04,RSFAENT(,@07)                                   1485 05798000
*        /************************************************************/ 05799000
*        /*                                                          */ 05800000
*        /*     PROCESS ALL VGOS. IF SPACE NOT OWNED BY THE          */ 05801000
*        /*     CATALOG, INDICATE AN ERROR. IF THE SPACE IS          */ 05802000
*        /*     OWNED, SHOW IT AS SUBALLOCATED.                      */ 05803000
*        /*                                                          */ 05804000
*        /************************************************************/ 05805000
*                                                                  1486 05806000
*                      IF RSFENTLN = 0 THEN                        1486 05807000
         CLI   RSFENTLN(@07),0                                     1486 05808000
         BNE   @RF01486                                            1486 05809000
*                        RSVLCATE = ON; /* ERROR - NO VGOS           */ 05810000
         OI    RSVLCATE(REG6),B'01000000'                          1487 05811000
*                      ELSE                                        1488 05812000
*                        DO RSFCNDX = 1 TO RSFHNDX;                1488 05813000
         B     @RC01486                                            1488 05814000
@RF01486 LA    @07,1                                               1488 05815000
         B     @DE01488                                            1488 05816000
@DL01488 DS    0H                                                  1489 05817000
*                          IF SNSSWD = ON THEN; /*BYPASS IMBEDDED INX*/ 05818000
         L     @07,RSWASNVT(,REG6)                                 1489 05819000
         L     @07,RSFAENT(,@07)                                   1489 05820000
         TM    SNSSWD(@07),B'10000000'                             1489 05821000
         BO    @RT01489                                            1489 05822000
*                          ELSE                                    1491 05823000
*                            DO;                                   1491 05824000
*                              RSTGBMAP = RSWKBMAP;                1492 05825000
         L     @07,RSWKBMAP(,REG6)                                 1492 05826000
         ST    @07,RSTGBMAP(,REG6)                                 1492 05827000
*                              RSPVSETB = ''B; /*CLEAR OPTIONS       */ 05828000
         MVI   RSPVSETB(REG6),X'00'                                1493 05829000
*                              RSPVCLBM = ON; /*CLR BIT MAP BEFOR SET*/ 05830000
         OI    RSPVCLBM(REG6),B'00100000'                          1494 05831000
*                              CALL SETBITS;                       1495 05832000
*                                                                  1495 05833000
         BAL   @14,SETBITS                                         1495 05834000
*                              RSCKBMAP = RSPBMAP; /*CHK FR SPC AVAIL*/ 05835000
         L     @07,RSPBMAP(,REG6)                                  1496 05836000
         ST    @07,RSCKBMAP(,REG6)                                 1496 05837000
*                              RSCK1TO1 = ON; /*ON IS AVAIL          */ 05838000
         OI    RSCK1TO1(REG6),B'00000001'                          1497 05839000
*                              CALL CHKBITS;                       1498 05840000
*                                                                  1498 05841000
         BAL   @14,CHKBITS                                         1498 05842000
*        /************************************************************/ 05843000
*        /*                                                          */ 05844000
*        /*     SPACE CONFLICT                                       */ 05845000
*        /*                                                          */ 05846000
*        /************************************************************/ 05847000
*                                                                  1499 05848000
*                              IF RSCKBERR = ON | RSSETERR = ON THEN    05849000
         TM    RSCKBERR(REG6),B'00000010'                          1499 05850000
         BO    @RT01499                                            1499 05851000
         TM    RSSETERR(REG6),B'00001000'                          1499 05852000
         BNO   @RF01499                                            1499 05853000
@RT01499 DS    0H                                                  1500 05854000
*                                RSVLCATE = ON;                    1500 05855000
*                                                                  1500 05856000
         OI    RSVLCATE(REG6),B'01000000'                          1500 05857000
*        /************************************************************/ 05858000
*        /*                                                          */ 05859000
*        /*     SUBALLOCATE SPACE                                    */ 05860000
*        /*                                                          */ 05861000
*        /************************************************************/ 05862000
*                                                                  1501 05863000
*                              ELSE                                1501 05864000
*                                DO;                               1501 05865000
         B     @RC01499                                            1501 05866000
@RF01499 DS    0H                                                  1502 05867000
*                                  RSPVSETB = ''B;                 1502 05868000
         MVI   RSPVSETB(REG6),X'00'                                1502 05869000
*                                  RSSETMAP = ON; /*SUBALLOCATE TRKS */ 05870000
*                                  RSST1TO1 = OFF; /*SET BITS OFF    */ 05871000
         OI    RSSETMAP(REG6),B'01000000'                          1504 05872000
         NI    RSST1TO1(REG6),B'11101111'                          1504 05873000
*                                  RSTGBMAP = RSPBMAP; /*TOTAL MAP   */ 05874000
         L     @07,RSPBMAP(,REG6)                                  1505 05875000
         ST    @07,RSTGBMAP(,REG6)                                 1505 05876000
*                                  RSSTBMAP = RSWKBMAP; /*TRKS       */ 05877000
         L     @07,RSWKBMAP(,REG6)                                 1506 05878000
         ST    @07,RSSTBMAP(,REG6)                                 1506 05879000
*                                  CALL SETBITS;                   1507 05880000
         BAL   @14,SETBITS                                         1507 05881000
*                                END;                              1508 05882000
*                            END;                                  1509 05883000
@RC01499 DS    0H                                                  1510 05884000
*                          RSFAENT = RSFAENT + RSFENTLN;           1510 05885000
@RT01489 L     @07,RSWASNVT(,REG6)                                 1510 05886000
         SLR   @04,@04                                             1510 05887000
         IC    @04,RSFENTLN(,@07)                                  1510 05888000
         AL    @04,RSFAENT(,@07)                                   1510 05889000
         ST    @04,RSFAENT(,@07)                                   1510 05890000
*                        END;                                      1511 05891000
*                                                                  1511 05892000
         L     @04,RSWASNVT(,REG6)                                 1511 05893000
         LA    @07,1                                               1511 05894000
         AH    @07,RSFCNDX(,@04)                                   1511 05895000
@DE01488 L     @04,RSWASNVT(,REG6)                                 1511 05896000
         STH   @07,RSFCNDX(,@04)                                   1511 05897000
         L     @04,RSWASNVT(,REG6)                                 1511 05898000
         CH    @07,RSFHNDX(,@04)                                   1511 05899000
         BNH   @DL01488                                            1511 05900000
*        /************************************************************/ 05901000
*        /*                                                          */ 05902000
*        /*     PREPARE TO PROCESS THE INDEX VOL GOS                 */ 05903000
*        /*                                                          */ 05904000
*        /************************************************************/ 05905000
*                                                                  1512 05906000
*                      RABRCDA = INDEXCI; /*2ND TIME, PROCESS INDEX  */ 05907000
@RC01486 L     @07,RSGRABCU(,REG6)                                 1512 05908000
         L     @07,GRABCURR(,@07)                                  1512 05909000
         MVC   RABRCDA(4,@07),@CF00212                             1512 05910000
*                      RSFENTLN = 0; /*FREE THE VGO SNTAB            */ 05911000
         L     @07,RSWASNVT(,REG6)                                 1513 05912000
         MVI   RSFENTLN(@07),X'00'                                 1513 05913000
*                    END;                                          1514 05914000
*                                                                  1514 05915000
         LA    @07,1                                               1514 05916000
         AH    @07,RSIDX(,REG6)                                    1514 05917000
         STH   @07,RSIDX(,REG6)                                    1514 05918000
         C     @07,@CF00149                                        1514 05919000
         BNH   @DL01465                                            1514 05920000
*        /************************************************************/ 05921000
*        /*                                                          */ 05922000
*        /*     IF SUBALLOCATION CONFLICT, ISSUE MESSAGE IDC21027I   */ 05923000
*        /*                                                          */ 05924000
*        /************************************************************/ 05925000
*                                                                  1515 05926000
*                    IF RSVLCATE = ON THEN                         1515 05927000
*                                                                  1515 05928000
         TM    RSVLCATE(REG6),B'01000000'                          1515 05929000
         BNO   @RF01515                                            1515 05930000
*                      DO;                                         1516 05931000
*                      /*CALL CKERR*/                              1517 05932000
*                        RSCKERR = RSCKERR && RSCKERR;             1517 05933000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1517 05934000
*                        RSCKERN = RSE043;                         1518 05935000
         MVC   RSCKERN(2,REG6),@CH00973                            1518 05936000
*                        RSCKTERM = 'RETU';                        1519 05937000
         MVC   RSCKTERM(4,REG6),@CC03500                           1519 05938000
*                        RSCKMVAR(1) = ADDR(VOLSRSER);             1520 05939000
*                                                                  1520 05940000
         L     @07,RSVTBENT(,REG6)                                 1520 05941000
         LA    @07,VOLSRSER(,@07)                                  1520 05942000
         ST    @07,RSCKMVAR(,REG6)                                 1520 05943000
*                      /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR */ 05944000
*                      CALL CKERR;                                 1521 05945000
         L     @15,@CV03443                                        1521 05946000
         BALR  @14,@15                                             1521 05947000
*                      END;                                        1522 05948000
*                  END;                                            1523 05949000
*              END VLRCATLG;                                       1524 05950000
*        /************************************************************/ 05951000
*        /*                                                          */ 05952000
*        /*  PROCESS NON-CATALOG CLUSTER ENTRIES                     */ 05953000
*        /*     GET THE RECORD INDICATED BY THE DSDIR                */ 05954000
*        /*                                                          */ 05955000
*        /************************************************************/ 05956000
*                                                                  1525 05957000
*            ELSE                                                  1525 05958000
*  VLRNCAT:                                                        1525 05959000
*              DO;                                                 1525 05960000
         B     @RC01457                                            1525 05961000
@RF01457 DS    0H                                                  1525 05962000
VLRNCAT  DS    0H                                                  1526 05963000
*                GRABCURR = GRABRAB2;  /*BUFFER 2                    */ 05964000
         L     @07,RSGRABCU(,REG6)                                 1526 05965000
         L     @04,GRABRAB2(,@07)                                  1526 05966000
         ST    @04,GRABCURR(,@07)                                  1526 05967000
*                IF SNFUSE=OFF THEN    /*VERTICAL GOP WITH NO GO     */ 05968000
         L     @07,RSWASNVT(,REG6)                                 1527 05969000
         L     @07,RSFAENT(,@07)                                   1527 05970000
         TM    SNFUSE(@07),B'10000000'                             1527 05971000
         BNZ   @RF01527                                            1527 05972000
*                  RABNRF = ON;        /*TREAT AS NO RECORD FND      */ 05973000
         OI    RABNRF(@04),B'00000010'                             1528 05974000
*                ELSE                                              1529 05975000
*                  DO;                                             1529 05976000
         B     @RC01527                                            1529 05977000
@RF01527 DS    0H                                                  1530 05978000
*                    RABRCDA = SDSIDNO; /*DATA OR INDEX              */ 05979000
         L     @07,RSGRABCU(,REG6)                                 1530 05980000
         L     @04,GRABCURR(,@07)                                  1530 05981000
         L     @01,RSWASNVT(,REG6)                                 1530 05982000
         L     @01,RSFAENT(,@01)                                   1530 05983000
         SLR   @00,@00                                             1530 05984000
         ICM   @00,7,SDSIDNO(@01)                                  1530 05985000
         ST    @00,RABRCDA(,@04)                                   1530 05986000
*                    GRABAFL1 = ''B;   /*CLEAR GRAB OPTIONS          */ 05987000
         MVI   GRABAFL1(@07),X'00'                                 1531 05988000
*                    GRABAFL2 = ''B;                               1532 05989000
         MVI   GRABAFL2(@07),X'00'                                 1532 05990000
*                    GRABSFXT = ON;    /*ALLOW XLATE ERROR ON CIN    */ 05991000
*                    GRABSNRN = ON;    /*TREAT XLAT ERR AS NO RCD FND*/ 05992000
*                                                                  1534 05993000
*                                                                  1534 05994000
         OI    GRABSFXT(@07),B'10000010'                           1534 05995000
*                    DO;                                           1535 05996000
*                      RSRTYPE = ''B;                              1536 05997000
         MVI   RSRTYPE(REG6),X'00'                                 1536 05998000
*                      RSRGET = ON;      /* GETRCD  */             1537 05999000
         OI    RSRGET(REG6),B'10000000'                            1537 06000000
*                      RSRUPD = ON;      /* UPDATE  */             1538 06001000
         OI    RSRUPD(REG6),B'00001000'                            1538 06002000
*                      RSRDS = ''B;                                1539 06003000
         NI    RSRDS(REG6),B'00011111'                             1539 06004000
*                      RSRWF = ON;       /* WORKFILE  */           1540 06005000
*                      RSRDIR = ON;      /* DIRECT  */             1541 06006000
*                      RSRKEY = ON;      /* KEY  */                1542 06007000
*                                                                  1542 06008000
         OI    RSRWF(REG6),B'10010100'                             1542 06009000
*                    /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT */ 06010000
*                    CALL RECMGMT;                                 1543 06011000
         L     @15,@CV03452                                        1543 06012000
         BALR  @14,@15                                             1543 06013000
*                      RFY RTNREG RSTD;                            1544 06014000
*                      TESTRC = RTNREG;                            1545 06015000
         STH   RTNREG,TESTRC(,REG6)                                1545 06016000
*                      RFY RTNREG UNRSTD;                          1546 06017000
*                    END;                                          1547 06018000
*                                                                  1547 06019000
*                    GRABAFL1 = ''B;                               1548 06020000
         L     @07,RSGRABCU(,REG6)                                 1548 06021000
         MVI   GRABAFL1(@07),X'00'                                 1548 06022000
*                    GRABAFL2 = ''B;                               1549 06023000
         MVI   GRABAFL2(@07),X'00'                                 1549 06024000
*                  END;                                            1550 06025000
*                                                                  1550 06026000
*        /************************************************************/ 06027000
*        /*                                                          */ 06028000
*        /*     DELETE THE DSDIR IF NO RECORD WAS FOUND OR           */ 06029000
*        /*     THE DSDIRS FAILED TO BE CHECKED PREVIOUSLY BY        */ 06030000
*        /*     VERDSDIR (BAD SET OF RECORDS).                       */ 06031000
*        /*                                                          */ 06032000
*        /************************************************************/ 06033000
*                                                                  1551 06034000
*                IF RABNRF=ON | RSWDSDIR=OFF THEN                  1551 06035000
@RC01527 L     @07,RSGRABCU(,REG6)                                 1551 06036000
         L     @07,GRABCURR(,@07)                                  1551 06037000
         TM    RABNRF(@07),B'00000010'                             1551 06038000
         BO    @RT01551                                            1551 06039000
         TM    RSWDSDIR(@07),B'00001000'                           1551 06040000
         BNZ   @RF01551                                            1551 06041000
@RT01551 DS    0H                                                  1552 06042000
*                  DO;                                             1552 06043000
*                    RABNRF = OFF;     /*RESET NO RECORD FOUND       */ 06044000
         L     @07,RSGRABCU(,REG6)                                 1553 06045000
         L     @07,GRABCURR(,@07)                                  1553 06046000
         NI    RABNRF(@07),B'11111101'                             1553 06047000
*                    RSPVDELT = ON;    /*DELETE THE DSDIR            */ 06048000
         OI    RSPVDELT(REG6),B'00100000'                          1554 06049000
*                  END;                                            1555 06050000
*                                                                  1555 06051000
*        /************************************************************/ 06052000
*        /*                                                          */ 06053000
*        /*     FIND THE FIRST VGO FOR THIS DSDIR                    */ 06054000
*        /*                                                          */ 06055000
*        /************************************************************/ 06056000
*                                                                  1556 06057000
*                ELSE                                              1556 06058000
*                  DO;                                             1556 06059000
*                                                                  1556 06060000
         B     @RC01551                                            1556 06061000
@RF01551 DS    0H                                                  1557 06062000
*                    DO;                                           1557 06063000
*                      GRABBB = GRABCURR;                          1558 06064000
         L     @07,RSGRABCU(,REG6)                                 1558 06065000
         L     @04,GRABCURR(,@07)                                  1558 06066000
         ST    @04,GRABBB(,@07)                                    1558 06067000
*                      RSWGCODE = GCVOLGO;                         1559 06068000
         MVI   RSWGCODE(REG6),X'03'                                1559 06069000
*                                      /*SPECIFY GROUP CODE          */ 06070000
*                      RSWFONE = OFF;  /*FIND ALL OCCURRENCES        */ 06071000
         NI    RSWFONE(REG6),B'01111111'                           1560 06072000
*                      /* CALL THE FIND SUBROUTINE */              1561 06073000
*                                                                  1561 06074000
*                    /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND    */ 06075000
*                    CALL FIND;                                    1561 06076000
         L     @15,@CV03435                                        1561 06077000
         BALR  @14,@15                                             1561 06078000
*                    END;                                          1562 06079000
*                    RSPVSNT3 = RSWASNVT; /*SAVE THE VGO SNTAB ADDR  */ 06080000
         L     @07,RSWASNVT(,REG6)                                 1563 06081000
         ST    @07,RSPVSNT3(,REG6)                                 1563 06082000
*                    RSFAENT = RSFCADR; /*FIRST VGO                  */ 06083000
         L     @04,RSFCADR(,@07)                                   1564 06084000
         ST    @04,RSFAENT(,@07)                                   1564 06085000
*                    IF RSFENTLN = 0 THEN; /*NO VGO DELETE THE DSDIR */ 06086000
         CLI   RSFENTLN(@07),0                                     1565 06087000
         BE    @RT01565                                            1565 06088000
*                    ELSE                                          1567 06089000
*                      DO RSFCNDX = 1 TO RSFHNDX                   1567 06090000
*                       WHILE ((SNVOLSER ^= VOLSRSER) |            1567 06091000
*                       (SDSDIRSN ^= RSPVSNT8->RSFAENT->SNSN));    1567 06092000
         LA    @07,1                                               1567 06093000
         B     @DE01567                                            1567 06094000
@DL01567 L     @07,RSWASNVT(,REG6)                                 1567 06095000
         L     @07,RSFAENT(,@07)                                   1567 06096000
         L     @04,RSVTBENT(,REG6)                                 1567 06097000
         CLC   SNVOLSER(6,@07),VOLSRSER(@04)                       1567 06098000
         BNE   @DB01567                                            1567 06099000
         L     @04,RSPVSNT8(,REG6)                                 1567 06100000
         L     @04,RSFAENT(,@04)                                   1567 06101000
         CLC   SDSDIRSN(2,@07),SNSN(@04)                           1567 06102000
         BE    @DC01567                                            1567 06103000
@DB01567 DS    0H                                                  1568 06104000
*                        RSFAENT = RSFAENT + RSFENTLN;             1568 06105000
         L     @07,RSWASNVT(,REG6)                                 1568 06106000
         SLR   @04,@04                                             1568 06107000
         IC    @04,RSFENTLN(,@07)                                  1568 06108000
         AL    @04,RSFAENT(,@07)                                   1568 06109000
         ST    @04,RSFAENT(,@07)                                   1568 06110000
*                      END;                                        1569 06111000
*                                                                  1569 06112000
         L     @04,RSWASNVT(,REG6)                                 1569 06113000
         LA    @07,1                                               1569 06114000
         AH    @07,RSFCNDX(,@04)                                   1569 06115000
@DE01567 L     @04,RSWASNVT(,REG6)                                 1569 06116000
         STH   @07,RSFCNDX(,@04)                                   1569 06117000
         L     @04,RSWASNVT(,REG6)                                 1569 06118000
         CH    @07,RSFHNDX(,@04)                                   1569 06119000
         BNH   @DL01567                                            1569 06120000
@DC01567 DS    0H                                                  1570 06121000
*        /************************************************************/ 06122000
*        /*                                                          */ 06123000
*        /*       DELETE THE DSDIR - THERE IS NO VGO                 */ 06124000
*        /*                                                          */ 06125000
*        /************************************************************/ 06126000
*                                                                  1570 06127000
*                    IF ((RSFENTLN = 0) | (RSFCNDX > RSFHNDX)) THEN     06128000
@RT01565 L     @07,RSWASNVT(,REG6)                                 1570 06129000
         CLI   RSFENTLN(@07),0                                     1570 06130000
         BE    @RT01570                                            1570 06131000
         LH    @04,RSFCNDX(,@07)                                   1570 06132000
         CH    @04,RSFHNDX(,@07)                                   1570 06133000
         BNH   @RF01570                                            1570 06134000
@RT01570 DS    0H                                                  1571 06135000
*                      RSPVDELT = ON;                              1571 06136000
*                                                                  1571 06137000
         OI    RSPVDELT(REG6),B'00100000'                          1571 06138000
*        /************************************************************/ 06139000
*        /*                                                          */ 06140000
*        /*     VGO IS FOR A SUBALLOCATED CANDIDATE VOLUME - NO      */ 06141000
*        /*     EXTENTS OR POSSIBLE SPACE CONFLICT.                  */ 06142000
*        /*                                                          */ 06143000
*        /************************************************************/ 06144000
*                                                                  1572 06145000
*                    ELSE                                          1572 06146000
*                      IF SNVGOSS = 0 & SNTTNNC = 0 THEN;          1572 06147000
*                                                                  1572 06148000
         B     @RC01570                                            1572 06149000
@RF01570 L     @07,RSWASNVT(,REG6)                                 1572 06150000
         L     @07,RSFAENT(,@07)                                   1572 06151000
         ICM   @04,3,SNVGOSS(@07)                                  1572 06152000
         BNZ   @RF01572                                            1572 06153000
         CLI   SNTTNNC(@07),0                                      1572 06154000
         BE    @RT01572                                            1572 06155000
*        /************************************************************/ 06156000
*        /*                                                          */ 06157000
*        /*     FIRST VGO FOUND - LOCATE THE SPACE HEADER FOR IT.    */ 06158000
*        /*                                                          */ 06159000
*        /************************************************************/ 06160000
*                                                                  1574 06161000
*                      ELSE                                        1574 06162000
*                        DO;                                       1574 06163000
@RF01572 DS    0H                                                  1575 06164000
*                          RSWASNVT = RSPVSNT6; /*SPACE HEADER SNTAB */ 06165000
         L     @07,RSPVSNT6(,REG6)                                 1575 06166000
         ST    @07,RSWASNVT(,REG6)                                 1575 06167000
*                          IF RSPVSNT6 = 0 THEN; /*NO SPACE HEADERS  */ 06168000
         LTR   @07,@07                                             1576 06169000
         BZ    @RT01576                                            1576 06170000
*                          ELSE                                    1578 06171000
*                            DO;                                   1578 06172000
*                              RSFAENT = RSFCADR;                  1579 06173000
         L     @07,RSWASNVT(,REG6)                                 1579 06174000
         L     @04,RSFCADR(,@07)                                   1579 06175000
         ST    @04,RSFAENT(,@07)                                   1579 06176000
*                              DO RSFCNDX = 1 TO RSFHNDX WHILE     1580 06177000
*                               (SNSN^=RSPVSNT3->RSFAENT->SNVGOSS);     06178000
         LA    @07,1                                               1580 06179000
         B     @DE01580                                            1580 06180000
@DL01580 L     @07,RSWASNVT(,REG6)                                 1580 06181000
         L     @04,RSFAENT(,@07)                                   1580 06182000
         L     @01,RSPVSNT3(,REG6)                                 1580 06183000
         L     @01,RSFAENT(,@01)                                   1580 06184000
         CLC   SNSN(2,@04),SNVGOSS(@01)                            1580 06185000
         BE    @DC01580                                            1580 06186000
*                                RSFAENT = RSFAENT + RSFENTLN;     1581 06187000
         SLR   @15,@15                                             1581 06188000
         IC    @15,RSFENTLN(,@07)                                  1581 06189000
         ALR   @04,@15                                             1581 06190000
         ST    @04,RSFAENT(,@07)                                   1581 06191000
*                              END;                                1582 06192000
         L     @04,RSWASNVT(,REG6)                                 1582 06193000
         LA    @07,1                                               1582 06194000
         AH    @07,RSFCNDX(,@04)                                   1582 06195000
@DE01580 L     @04,RSWASNVT(,REG6)                                 1582 06196000
         STH   @07,RSFCNDX(,@04)                                   1582 06197000
         L     @04,RSWASNVT(,REG6)                                 1582 06198000
         CH    @07,RSFHNDX(,@04)                                   1582 06199000
         BNH   @DL01580                                            1582 06200000
@DC01580 DS    0H                                                  1583 06201000
*                            END;                                  1583 06202000
*                                                                  1583 06203000
*        /************************************************************/ 06204000
*        /*                                                          */ 06205000
*        /*     SPACE HEADER NOT FOUND - DELETE DSDIR AND MARK THE   */ 06206000
*        /*     VGO AS UNUSABLE.                                     */ 06207000
*        /*                                                          */ 06208000
*        /************************************************************/ 06209000
*                                                                  1584 06210000
*                          IF (RSPVSNT6 = 0) | (RSFCNDX > RSFHNDX) 1584 06211000
*                           THEN                                   1584 06212000
@RT01576 L     @07,RSPVSNT6(,REG6)                                 1584 06213000
         LTR   @07,@07                                             1584 06214000
         BZ    @RT01584                                            1584 06215000
         L     @07,RSWASNVT(,REG6)                                 1584 06216000
         LH    @04,RSFCNDX(,@07)                                   1584 06217000
         CH    @04,RSFHNDX(,@07)                                   1584 06218000
         BNH   @RF01584                                            1584 06219000
@RT01584 DS    0H                                                  1585 06220000
*                            DO;                                   1585 06221000
*                              RSPVDELT = ON;                      1586 06222000
         OI    RSPVDELT(REG6),B'00100000'                          1586 06223000
*                              RSMUNUS = ON;                       1587 06224000
         OI    RSMUNUS(REG6),B'10000000'                           1587 06225000
*                            END;                                  1588 06226000
*                                                                  1588 06227000
*        /************************************************************/ 06228000
*        /*                                                          */ 06229000
*        /*     UNIQUE DATA SPACE - ENSURE EXTENTS MATCH OR SUBSET   */ 06230000
*        /*                                                          */ 06231000
*        /************************************************************/ 06232000
*                                                                  1589 06233000
*                          ELSE                                    1589 06234000
*                            IF SNVSPUNQ = ON THEN                 1589 06235000
         B     @RC01584                                            1589 06236000
@RF01584 L     @07,RSWASNVT(,REG6)                                 1589 06237000
         L     @07,RSFAENT(,@07)                                   1589 06238000
         TM    SNVSPUNQ(@07),B'10000000'                           1589 06239000
         BNO   @RF01589                                            1589 06240000
*                              CALL CHKUNQ;                        1590 06241000
*                                                                  1590 06242000
         BAL   @14,CHKUNQ                                          1590 06243000
*        /************************************************************/ 06244000
*        /*                                                          */ 06245000
*        /*     SUBALLOCATED DATA SPACE - ENSURE NO SPACE CONFLICT   */ 06246000
*        /*                                                          */ 06247000
*        /************************************************************/ 06248000
*                                                                  1591 06249000
*                            ELSE                                  1591 06250000
*                              CALL SETBMAP;                       1591 06251000
         B     @RC01589                                            1591 06252000
@RF01589 BAL   @14,SETBMAP                                         1591 06253000
*                        END;                                      1592 06254000
@RC01589 DS    0H                                                  1592 06255000
@RC01584 DS    0H                                                  1593 06256000
*                  END;                                            1593 06257000
@RT01572 DS    0H                                                  1593 06258000
@RC01570 DS    0H                                                  1594 06259000
*              END VLRNCAT;                                        1594 06260000
@RC01551 DS    0H                                                  1595 06261000
*        /************************************************************/ 06262000
*        /*                                                          */ 06263000
*        /*  DELETE THE DSDIR                                        */ 06264000
*        /*                                                          */ 06265000
*        /************************************************************/ 06266000
*                                                                  1595 06267000
*            IF RSPVDELT = ON THEN                                 1595 06268000
@RC01457 TM    RSPVDELT(REG6),B'00100000'                          1595 06269000
         BNO   @RF01595                                            1595 06270000
*              DO;                                                 1596 06271000
*                RSWASNVT = RSPVSNT8;  /*DSDIR SNTAB                 */ 06272000
         L     @07,RSPVSNT8(,REG6)                                 1597 06273000
         ST    @07,RSWASNVT(,REG6)                                 1597 06274000
*                GRABCURR = GRABRAB1;  /*VOL RCD AS BASE FOR DSDIRS  */ 06275000
         L     @07,RSGRABCU(,REG6)                                 1598 06276000
         L     @04,GRABRAB1(,@07)                                  1598 06277000
         ST    @04,GRABCURR(,@07)                                  1598 06278000
*                GRABBB = GRABCURR;    /*BASE FOR DELETE             */ 06279000
         ST    @04,GRABBB(,@07)                                    1599 06280000
*                /* CALL TO MODULE IDCRS04 FOR PROCEDURE DELGO       */ 06281000
*                CALL DELGO;                                       1600 06282000
         L     @15,@CV03434                                        1600 06283000
         BALR  @14,@15                                             1600 06284000
*              END;                                                1601 06285000
*                                                                  1601 06286000
*        /************************************************************/ 06287000
*        /*                                                          */ 06288000
*        /*  MARK VGO UNUSABLE AND BASE INHIBIT UPDATE               */ 06289000
*        /*                                                          */ 06290000
*        /************************************************************/ 06291000
*                                                                  1602 06292000
*            IF RSMUNUS = ON THEN                                  1602 06293000
@RF01595 TM    RSMUNUS(REG6),B'10000000'                           1602 06294000
         BNO   @RF01602                                            1602 06295000
*              DO;                                                 1603 06296000
*                RSWASNVT = RSPVSNT3;  /*VGO SNTAB                   */ 06297000
         L     @07,RSPVSNT3(,REG6)                                 1604 06298000
         ST    @07,RSWASNVT(,REG6)                                 1604 06299000
*                GRABCURR = GRABRAB2;  /*DATA OR INDEX AS BASE       */ 06300000
         L     @07,RSGRABCU(,REG6)                                 1605 06301000
         L     @04,GRABRAB2(,@07)                                  1605 06302000
         ST    @04,GRABCURR(,@07)                                  1605 06303000
*                RSASDSDI = ON;        /*SPACE CONFLICT              */ 06304000
         OI    RSASDSDI(REG6),B'01000000'                          1606 06305000
*                CALL MARKUNUS;                                    1607 06306000
*                                                                  1607 06307000
*                                                                  1607 06308000
         BAL   @14,MARKUNUS                                        1607 06309000
*                DO;                                               1608 06310000
*                  RSRTYPE = ''B;                                  1609 06311000
         MVI   RSRTYPE(REG6),X'00'                                 1609 06312000
*                  RSRUPDT = ON;     /* UPDRCD  */                 1610 06313000
         OI    RSRUPDT(REG6),B'00100000'                           1610 06314000
*                  RSRUPD = ON;      /* UPDATE  */                 1611 06315000
         OI    RSRUPD(REG6),B'00001000'                            1611 06316000
*                  RSRDS = ''B;                                    1612 06317000
         NI    RSRDS(REG6),B'00011111'                             1612 06318000
*                  RSRWF = ON;       /* WORKFILE  */               1613 06319000
*                  RSRDIR = ON;      /* DIRECT  */                 1614 06320000
*                  RSRKEY = ON;      /* KEY  */                    1615 06321000
*                                                                  1615 06322000
         OI    RSRWF(REG6),B'10010100'                             1615 06323000
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */ 06324000
*                CALL RECMGMT;                                     1616 06325000
         L     @15,@CV03452                                        1616 06326000
         BALR  @14,@15                                             1616 06327000
*                  RFY RTNREG RSTD;                                1617 06328000
*                  TESTRC = RTNREG;                                1618 06329000
         STH   RTNREG,TESTRC(,REG6)                                1618 06330000
*                  RFY RTNREG UNRSTD;                              1619 06331000
*                END;                                              1620 06332000
*                                      /*UPDATE THE DATA OR INDEX RCD*/ 06333000
*              END;                                                1621 06334000
*                                                                  1621 06335000
*        /************************************************************/ 06336000
*        /*                                                          */ 06337000
*        /*  FREE THE BASE INDEX OR DATA RECORD                      */ 06338000
*        /*                                                          */ 06339000
*        /************************************************************/ 06340000
*                                                                  1622 06341000
*            ELSE                                                  1622 06342000
*              DO;                                                 1622 06343000
         B     @RC01602                                            1622 06344000
@RF01602 DS    0H                                                  1623 06345000
*                GRABCURR = GRABRAB2;  /*DATA OR INDEX               */ 06346000
*                                                                  1623 06347000
         L     @07,RSGRABCU(,REG6)                                 1623 06348000
         L     @04,GRABRAB2(,@07)                                  1623 06349000
         ST    @04,GRABCURR(,@07)                                  1623 06350000
*                DO;                                               1624 06351000
*                  RSRTYPE = ''B;                                  1625 06352000
         MVI   RSRTYPE(REG6),X'00'                                 1625 06353000
*                  RSRFREE = ON;     /* FREERCD  */                1626 06354000
         OI    RSRFREE(REG6),B'00000001'                           1626 06355000
*                  RSRUPD = ON;      /* UPDATE  */                 1627 06356000
         OI    RSRUPD(REG6),B'00001000'                            1627 06357000
*                  RSRDS = ''B;                                    1628 06358000
         NI    RSRDS(REG6),B'00011111'                             1628 06359000
*                  RSRWF = ON;       /* WORKFILE  */               1629 06360000
*                  RSRDIR = ON;      /* DIRECT  */                 1630 06361000
*                  RSRKEY = ON;      /* KEY  */                    1631 06362000
*                                                                  1631 06363000
         OI    RSRWF(REG6),B'10010100'                             1631 06364000
*                /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT     */ 06365000
*                CALL RECMGMT;                                     1632 06366000
         L     @15,@CV03452                                        1632 06367000
         BALR  @14,@15                                             1632 06368000
*                  RFY RTNREG RSTD;                                1633 06369000
*                  TESTRC = RTNREG;                                1634 06370000
         STH   RTNREG,TESTRC(,REG6)                                1634 06371000
*                  RFY RTNREG UNRSTD;                              1635 06372000
*                END;                                              1636 06373000
*              END;                                                1637 06374000
*                                                                  1637 06375000
*        /************************************************************/ 06376000
*        /*                                                          */ 06377000
*        /*  FREE THE VGO SNTAB FOR REUSE                            */ 06378000
*        /*                                                          */ 06379000
*        /************************************************************/ 06380000
*                                                                  1638 06381000
*            IF RSPVSNT3 ^= 0 THEN                                 1638 06382000
@RC01602 L     @07,RSPVSNT3(,REG6)                                 1638 06383000
         LTR   @07,@07                                             1638 06384000
         BZ    @RF01638                                            1638 06385000
*              RSPVSNT3->RSFENTLN = 0;                             1639 06386000
*                                                                  1639 06387000
         MVI   RSFENTLN(@07),X'00'                                 1639 06388000
*        /************************************************************/ 06389000
*        /*                                                          */ 06390000
*        /*  REESTABLISH THE DSDIR SN TABLE                          */ 06391000
*        /*                                                          */ 06392000
*        /************************************************************/ 06393000
*                                                                  1640 06394000
*            RSWASNVT = RSPVSNT8;                                  1640 06395000
@RF01638 L     @07,RSPVSNT8(,REG6)                                 1640 06396000
         ST    @07,RSWASNVT(,REG6)                                 1640 06397000
*          END VLRDSDIR;               /*END 1ST PASS DSDIR HANDLING */ 06398000
         L     @04,RSWASNVT(,REG6)                                 1641 06399000
         LA    @07,1                                               1641 06400000
         AH    @07,RSFCNDX(,@04)                                   1641 06401000
@DE01452 L     @04,RSWASNVT(,REG6)                                 1641 06402000
         STH   @07,RSFCNDX(,@04)                                   1641 06403000
         L     @04,RSWASNVT(,REG6)                                 1641 06404000
         CH    @07,RSFHNDX(,@04)                                   1641 06405000
         BNH   @DL01452                                            1641 06406000
*        /************************************************************/ 06407000
*        /*                                                          */ 06408000
*        /*              RESOLVE CONFLICTS                           */ 06409000
*        /*                                                          */ 06410000
*        /************************************************************/ 06411000
*                                                                  1642 06412000
*        IF (RSPVRPC = ON) | (RSPVRSC = ON) THEN                   1642 06413000
@RT01450 TM    RSPVRPC(REG6),B'00001100'                           1642 06414000
         BZ    @RF01642                                            1642 06415000
*  CONFLICT:                                                       1643 06416000
*          DO;                                                     1643 06417000
*                                                                  1643 06418000
CONFLICT DS    0H                                                  1644 06419000
*        /************************************************************/ 06420000
*        /*                                                          */ 06421000
*        /*     SCAN ALL OF THE DSDIRS FOR CONFLICTS                 */ 06422000
*        /*                                                          */ 06423000
*        /************************************************************/ 06424000
*                                                                  1644 06425000
*            RSWASNVT = RSPVSNT8;                                  1644 06426000
         L     @07,RSPVSNT8(,REG6)                                 1644 06427000
         ST    @07,RSWASNVT(,REG6)                                 1644 06428000
*            DO RSFCNDX = 1 TO RSFHNDX;                            1645 06429000
         LA    @07,1                                               1645 06430000
         B     @DE01645                                            1645 06431000
@DL01645 DS    0H                                                  1646 06432000
*              RSFAENT = RSFCADR + RSFENTLN*(RSFCNDX - 1);         1646 06433000
*                                                                  1646 06434000
         L     @07,RSWASNVT(,REG6)                                 1646 06435000
         LH    @04,RSFCNDX(,@07)                                   1646 06436000
         BCTR  @04,0                                               1646 06437000
         LR    @01,@04                                             1646 06438000
         SLR   @04,@04                                             1646 06439000
         IC    @04,RSFENTLN(,@07)                                  1646 06440000
         MR    @00,@04                                             1646 06441000
         AL    @01,RSFCADR(,@07)                                   1646 06442000
         ST    @01,RSFAENT(,@07)                                   1646 06443000
*        /************************************************************/ 06444000
*        /*                                                          */ 06445000
*        /*     IGNORE DELETED DSDIRS.                               */ 06446000
*        /*     IGNORE DSDIR FOR THE CATALOG CLUSTER.                */ 06447000
*        /*                                                          */ 06448000
*        /************************************************************/ 06449000
*                                                                  1647 06450000
*              IF (SNFDEL=ON) | (SDSIDNO = CLUSCI) THEN;           1647 06451000
*                                                                  1647 06452000
         TM    SNFDEL(@01),B'01000000'                             1647 06453000
         BO    @RT01647                                            1647 06454000
         CLC   SDSIDNO(3,@01),@CF00149+1                           1647 06455000
         BE    @RT01647                                            1647 06456000
*        /************************************************************/ 06457000
*        /*                                                          */ 06458000
*        /*     GET THE BASE DATA OR INDEX                           */ 06459000
*        /*                                                          */ 06460000
*        /************************************************************/ 06461000
*                                                                  1649 06462000
*              ELSE                                                1649 06463000
*                DO;                                               1649 06464000
*                  GRABCURR = GRABRAB2; /*BUFFER 2                   */ 06465000
         L     @07,RSGRABCU(,REG6)                                 1650 06466000
         L     @04,GRABRAB2(,@07)                                  1650 06467000
         ST    @04,GRABCURR(,@07)                                  1650 06468000
*                  RABRCDA = SDSIDNO; /*DATA OR INDEX CIN            */ 06469000
*                                                                  1651 06470000
         L     @07,RSWASNVT(,REG6)                                 1651 06471000
         L     @07,RSFAENT(,@07)                                   1651 06472000
         SLR   @15,@15                                             1651 06473000
         ICM   @15,7,SDSIDNO(@07)                                  1651 06474000
         ST    @15,RABRCDA(,@04)                                   1651 06475000
*                  DO;                                             1652 06476000
*                    RSRTYPE = ''B;                                1653 06477000
         MVI   RSRTYPE(REG6),X'00'                                 1653 06478000
*                    RSRGET = ON;      /* GETRCD  */               1654 06479000
         OI    RSRGET(REG6),B'10000000'                            1654 06480000
*                    RSRUPD = ON;      /* UPDATE  */               1655 06481000
         OI    RSRUPD(REG6),B'00001000'                            1655 06482000
*                    RSRDS = ''B;                                  1656 06483000
         NI    RSRDS(REG6),B'00011111'                             1656 06484000
*                    RSRWF = ON;       /* WORKFILE  */             1657 06485000
*                    RSRDIR = ON;      /* DIRECT  */               1658 06486000
*                    RSRKEY = ON;      /* KEY  */                  1659 06487000
*                                                                  1659 06488000
         OI    RSRWF(REG6),B'10010100'                             1659 06489000
*                  /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT   */ 06490000
*                  CALL RECMGMT;                                   1660 06491000
         L     @15,@CV03452                                        1660 06492000
         BALR  @14,@15                                             1660 06493000
*                    RFY RTNREG RSTD;                              1661 06494000
*                    TESTRC = RTNREG;                              1662 06495000
         STH   RTNREG,TESTRC(,REG6)                                1662 06496000
*                    RFY RTNREG UNRSTD;                            1663 06497000
*                  END;                                            1664 06498000
*                                                                  1664 06499000
*        /************************************************************/ 06500000
*        /*                                                          */ 06501000
*        /*     RESOLVE CONFLICTS                                    */ 06502000
*        /*                                                          */ 06503000
*        /************************************************************/ 06504000
*                                                                  1665 06505000
*                  IF ((VOLSRSER = RCDCRAVL) & (RSPVRPC = ON)) |   1665 06506000
*                   ((VOLSRSER ^= RCDCRAVL) & (RSPVRSC = ON)) THEN 1665 06507000
         L     @07,RSVTBENT(,REG6)                                 1665 06508000
         L     @04,RSGRABCU(,REG6)                                 1665 06509000
         L     @04,GRABCURR(,@04)                                  1665 06510000
         CLC   VOLSRSER(6,@07),RCDCRAVL+8(@04)                     1665 06511000
         BNE   @GL00031                                            1665 06512000
         TM    RSPVRPC(REG6),B'00001000'                           1665 06513000
         BO    @RT01665                                            1665 06514000
@GL00031 L     @07,RSVTBENT(,REG6)                                 1665 06515000
         L     @04,RSGRABCU(,REG6)                                 1665 06516000
         L     @04,GRABCURR(,@04)                                  1665 06517000
         CLC   VOLSRSER(6,@07),RCDCRAVL+8(@04)                     1665 06518000
         BE    @RF01665                                            1665 06519000
         TM    RSPVRSC(REG6),B'00000100'                           1665 06520000
         BNO   @RF01665                                            1665 06521000
@RT01665 DS    0H                                                  1666 06522000
*                    DO;                                           1666 06523000
*                                                                  1666 06524000
*        /************************************************************/ 06525000
*        /*                                                          */ 06526000
*        /*       FIND THE VGO MATCHING THIS DSDIR                   */ 06527000
*        /*                                                          */ 06528000
*        /************************************************************/ 06529000
*                                                                  1667 06530000
*                                                                  1667 06531000
*                      DO;                                         1667 06532000
*                        GRABBB = GRABCURR;                        1668 06533000
         L     @07,RSGRABCU(,REG6)                                 1668 06534000
         L     @04,GRABCURR(,@07)                                  1668 06535000
         ST    @04,GRABBB(,@07)                                    1668 06536000
*                        RSWGCODE = GCVOLGO;                       1669 06537000
         MVI   RSWGCODE(REG6),X'03'                                1669 06538000
*                                      /*SPECIFY GROUP CODE          */ 06539000
*                        RSWFONE = OFF;/*FIND ALL OCCURRENCES        */ 06540000
         NI    RSWFONE(REG6),B'01111111'                           1670 06541000
*                        /* CALL THE FIND SUBROUTINE */            1671 06542000
*                                                                  1671 06543000
*                      /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND  */ 06544000
*                      CALL FIND;                                  1671 06545000
         L     @15,@CV03435                                        1671 06546000
         BALR  @14,@15                                             1671 06547000
*                      END;                                        1672 06548000
*                      RSPVSNT3 = RSWASNVT; /*SAVE THE VGO SNTAB     */ 06549000
         L     @07,RSWASNVT(,REG6)                                 1673 06550000
         ST    @07,RSPVSNT3(,REG6)                                 1673 06551000
*                      RSFAENT = RSFCADR; /*FIRST VGO                */ 06552000
         L     @04,RSFCADR(,@07)                                   1674 06553000
         ST    @04,RSFAENT(,@07)                                   1674 06554000
*                      DO RSFCNDX = 1 TO RSFHNDX                   1675 06555000
*                       WHILE ((VOLSRSER ^= SNVOLSER) |            1675 06556000
*                       (SDSDIRSN ^= RSPVSNT8->RSFAENT->SNSN));    1675 06557000
         LA    @07,1                                               1675 06558000
         B     @DE01675                                            1675 06559000
@DL01675 L     @07,RSVTBENT(,REG6)                                 1675 06560000
         L     @04,RSWASNVT(,REG6)                                 1675 06561000
         L     @04,RSFAENT(,@04)                                   1675 06562000
         CLC   VOLSRSER(6,@07),SNVOLSER(@04)                       1675 06563000
         BNE   @DB01675                                            1675 06564000
         L     @07,RSPVSNT8(,REG6)                                 1675 06565000
         L     @07,RSFAENT(,@07)                                   1675 06566000
         CLC   SDSDIRSN(2,@04),SNSN(@07)                           1675 06567000
         BE    @DC01675                                            1675 06568000
@DB01675 DS    0H                                                  1676 06569000
*                        RSFAENT = RSFAENT + RSFENTLN;             1676 06570000
         L     @07,RSWASNVT(,REG6)                                 1676 06571000
         SLR   @04,@04                                             1676 06572000
         IC    @04,RSFENTLN(,@07)                                  1676 06573000
         AL    @04,RSFAENT(,@07)                                   1676 06574000
         ST    @04,RSFAENT(,@07)                                   1676 06575000
*                      END;                                        1677 06576000
*                                                                  1677 06577000
         L     @04,RSWASNVT(,REG6)                                 1677 06578000
         LA    @07,1                                               1677 06579000
         AH    @07,RSFCNDX(,@04)                                   1677 06580000
@DE01675 L     @04,RSWASNVT(,REG6)                                 1677 06581000
         STH   @07,RSFCNDX(,@04)                                   1677 06582000
         L     @04,RSWASNVT(,REG6)                                 1677 06583000
         CH    @07,RSFHNDX(,@04)                                   1677 06584000
         BNH   @DL01675                                            1677 06585000
@DC01675 DS    0H                                                  1678 06586000
*        /************************************************************/ 06587000
*        /*                                                          */ 06588000
*        /*       IF VGO MATCHES CHECK FOR CONFLICT WITH SPACE IN    */ 06589000
*        /*       APPROPRIATE CONFLICT MAP.                          */ 06590000
*        /*                                                          */ 06591000
*        /************************************************************/ 06592000
*                                                                  1678 06593000
*                      IF RSFCNDX > RSFHNDX THEN;                  1678 06594000
         L     @07,RSWASNVT(,REG6)                                 1678 06595000
         LH    @04,RSFCNDX(,@07)                                   1678 06596000
         CH    @04,RSFHNDX(,@07)                                   1678 06597000
         BH    @RT01678                                            1678 06598000
*                      ELSE                                        1680 06599000
*                        DO;                                       1680 06600000
*                                                                  1680 06601000
*        /************************************************************/ 06602000
*        /*                                                          */ 06603000
*        /*       MAP ALL OF THE VGOS FOR THIS DSDIR                 */ 06604000
*        /*                                                          */ 06605000
*        /************************************************************/ 06606000
*                                                                  1681 06607000
*                          RSCSFAE = RSFAENT; /*1ST MATCHING VGO     */ 06608000
         L     @07,RSWASNVT(,REG6)                                 1681 06609000
         L     @04,RSFAENT(,@07)                                   1681 06610000
         ST    @04,RSCSFAE(,REG6)                                  1681 06611000
*                          RSCSFCN = RSFCNDX;                      1682 06612000
         LH    @07,RSFCNDX(,@07)                                   1682 06613000
         STH   @07,RSCSFCN(,REG6)                                  1682 06614000
*                          DO RSFCNDX = RSFCNDX TO RSFHNDX;        1683 06615000
         B     @DE01683                                            1683 06616000
@DL01683 DS    0H                                                  1684 06617000
*                            RSFAENT = RSFCADR + RSFENTLN*(RSFCNDX-1);  06618000
         L     @07,RSWASNVT(,REG6)                                 1684 06619000
         LH    @04,RSFCNDX(,@07)                                   1684 06620000
         LR    @15,@04                                             1684 06621000
         BCTR  @15,0                                               1684 06622000
         SLR   @03,@03                                             1684 06623000
         IC    @03,RSFENTLN(,@07)                                  1684 06624000
         MR    @14,@03                                             1684 06625000
         AL    @15,RSFCADR(,@07)                                   1684 06626000
         ST    @15,RSFAENT(,@07)                                   1684 06627000
*                            IF (SNVOLSER = RSCSFAE->SNVOLSER) &   1685 06628000
*                               (SDSDIRSN = RSCSFAE->SDSDIRSN)     1685 06629000
*                             THEN                                 1685 06630000
         L     @07,RSCSFAE(,REG6)                                  1685 06631000
         CLC   SNVOLSER(6,@15),SNVOLSER(@07)                       1685 06632000
         BNE   @RF01685                                            1685 06633000
         CLC   SDSDIRSN(2,@15),SDSDIRSN(@07)                       1685 06634000
         BNE   @RF01685                                            1685 06635000
*                              DO;                                 1686 06636000
*                                RSTGBMAP = RSWKBMAP;              1687 06637000
         L     @07,RSWKBMAP(,REG6)                                 1687 06638000
         ST    @07,RSTGBMAP(,REG6)                                 1687 06639000
*                                RSPVSETB = ''B; /*CLR SETBITS OPTNS */ 06640000
         MVI   RSPVSETB(REG6),X'00'                                1688 06641000
*                                IF RSFCNDX = RSCSFCN THEN         1689 06642000
         CH    @04,RSCSFCN(,REG6)                                  1689 06643000
         BNE   @RF01689                                            1689 06644000
*                                      /*CLEAR MAP 1ST TIME          */ 06645000
*                                  RSPVCLBM = ON;                  1690 06646000
         OI    RSPVCLBM(REG6),B'00100000'                          1690 06647000
*                                CALL SETBITS;                     1691 06648000
@RF01689 BAL   @14,SETBITS                                         1691 06649000
*                              END;                                1692 06650000
*                          END;                                    1693 06651000
@RF01685 L     @04,RSWASNVT(,REG6)                                 1693 06652000
         LA    @07,1                                               1693 06653000
         AH    @07,RSFCNDX(,@04)                                   1693 06654000
         L     @04,RSWASNVT(,REG6)                                 1693 06655000
         STH   @07,RSFCNDX(,@04)                                   1693 06656000
@DE01683 L     @04,RSWASNVT(,REG6)                                 1693 06657000
         CH    @07,RSFHNDX(,@04)                                   1693 06658000
         BNH   @DL01683                                            1693 06659000
*                          RSFCNDX = RSCSFCN;                      1694 06660000
         L     @07,RSWASNVT(,REG6)                                 1694 06661000
         LH    @04,RSCSFCN(,REG6)                                  1694 06662000
         STH   @04,RSFCNDX(,@07)                                   1694 06663000
*                          RSFAENT = RSCSFAE; /*RESTORE 1ST VGO      */ 06664000
*                                                                  1695 06665000
         L     @04,RSCSFAE(,REG6)                                  1695 06666000
         ST    @04,RSFAENT(,@07)                                   1695 06667000
*        /************************************************************/ 06668000
*        /*                                                          */ 06669000
*        /*       CHECK FOR A CONFLICT                               */ 06670000
*        /*                                                          */ 06671000
*        /************************************************************/ 06672000
*                                                                  1696 06673000
*                          RSCK1TO1 = OFF; /*NO MATCH IS GOOD        */ 06674000
         NI    RSCK1TO1(REG6),B'11111110'                          1696 06675000
*                          IF VOLSRSER = RCDCRAVL THEN             1697 06676000
         L     @07,RSVTBENT(,REG6)                                 1697 06677000
         L     @04,RSGRABCU(,REG6)                                 1697 06678000
         L     @04,GRABCURR(,@04)                                  1697 06679000
         CLC   VOLSRSER(6,@07),RCDCRAVL+8(@04)                     1697 06680000
         BNE   @RF01697                                            1697 06681000
*                            RSCKBMAP = RSPCBMAP; /*CHK PRIM CONF MAP*/ 06682000
         L     @07,RSPCBMAP(,REG6)                                 1698 06683000
         ST    @07,RSCKBMAP(,REG6)                                 1698 06684000
*                          ELSE                                    1699 06685000
*                            RSCKBMAP = RSSCBMAP; /*CHK SEC CONF MAP */ 06686000
         B     @RC01697                                            1699 06687000
@RF01697 L     @07,RSSCBMAP(,REG6)                                 1699 06688000
         ST    @07,RSCKBMAP(,REG6)                                 1699 06689000
*                          CALL CHKBITS; /*CHECK FOR CONFLICT    */     06690000
*                                                                  1700 06691000
@RC01697 BAL   @14,CHKBITS                                         1700 06692000
*        /************************************************************/ 06693000
*        /*                                                          */ 06694000
*        /*       CONFLICT - RETURN SUBALLOCATED SPACE               */ 06695000
*        /*                                                          */ 06696000
*        /************************************************************/ 06697000
*                                                                  1701 06698000
*                          IF RSCKBERR = ON | RSSETERR = ON THEN   1701 06699000
         TM    RSCKBERR(REG6),B'00000010'                          1701 06700000
         BO    @RT01701                                            1701 06701000
         TM    RSSETERR(REG6),B'00001000'                          1701 06702000
         BNO   @RF01701                                            1701 06703000
@RT01701 DS    0H                                                  1702 06704000
*                            DO;                                   1702 06705000
*                              IF VOLSRSER=RCDCRAVL THEN           1703 06706000
         L     @07,RSVTBENT(,REG6)                                 1703 06707000
         L     @04,RSGRABCU(,REG6)                                 1703 06708000
         L     @04,GRABCURR(,@04)                                  1703 06709000
         CLC   VOLSRSER(6,@07),RCDCRAVL+8(@04)                     1703 06710000
         BNE   @RF01703                                            1703 06711000
*                                      /*PRIMARY CONFLICT            */ 06712000
*                                RSTOMAP = RSPBMAP; /*UNALLOC P MAP  */ 06713000
         L     @07,RSPBMAP(,REG6)                                  1704 06714000
         ST    @07,RSTOMAP(,REG6)                                  1704 06715000
*                              ELSE                                1705 06716000
*                                RSTOMAP=RSSBMAP; /*UNALLOC S MAP    */ 06717000
*                                                                  1705 06718000
         B     @RC01703                                            1705 06719000
@RF01703 L     @07,RSSBMAP(,REG6)                                  1705 06720000
         ST    @07,RSTOMAP(,REG6)                                  1705 06721000
*                              RSFROMAP = RSWKBMAP;                1706 06722000
@RC01703 L     @07,RSWKBMAP(,REG6)                                 1706 06723000
         ST    @07,RSFROMAP(,REG6)                                 1706 06724000
*                              DO TMPSZ = RSMAPSIZ BY -256         1707 06725000
*                               WHILE(TMPSZ>256);                  1707 06726000
         L     @07,RSMAPSIZ(,REG6)                                 1707 06727000
         ST    @07,TMPSZ(,REG6)                                    1707 06728000
         B     @DE01707                                            1707 06729000
@DL01707 DS    0H                                                  1708 06730000
*                                RSTOMAP->BMAP(1:256) =            1708 06731000
*                                      RSTOMAP->BMAP(1:256) |      1708 06732000
*                                      RSFROMAP->BMAP(1:256);      1708 06733000
         L     @07,RSTOMAP(,REG6)                                  1708 06734000
         L     @04,RSFROMAP(,REG6)                                 1708 06735000
         OC    BMAP(256,@07),BMAP(@04)                             1708 06736000
*                                RSTOMAP = RSTOMAP + 256;          1709 06737000
         LA    @15,256                                             1709 06738000
         ALR   @07,@15                                             1709 06739000
         ST    @07,RSTOMAP(,REG6)                                  1709 06740000
*                                RSFROMAP = RSFROMAP + 256;        1710 06741000
         ALR   @04,@15                                             1710 06742000
         ST    @04,RSFROMAP(,REG6)                                 1710 06743000
*                              END;                                1711 06744000
         L     @07,@CF03546                                        1711 06745000
         AL    @07,TMPSZ(,REG6)                                    1711 06746000
         ST    @07,TMPSZ(,REG6)                                    1711 06747000
@DE01707 L     @07,TMPSZ(,REG6)                                    1711 06748000
         C     @07,@CF03188                                        1711 06749000
         BH    @DL01707                                            1711 06750000
*                              RSTOMAP->BMAP(1:TMPSZ) =            1712 06751000
*                                      RSTOMAP->BMAP(1:TMPSZ) |    1712 06752000
*                                      RSFROMAP->BMAP(1:TMPSZ);    1712 06753000
*                                                                  1712 06754000
         L     @04,RSTOMAP(,REG6)                                  1712 06755000
         BCTR  @07,0                                               1712 06756000
         L     @01,RSFROMAP(,REG6)                                 1712 06757000
         EX    @07,@SO03739                                        1712 06758000
*        /************************************************************/ 06759000
*        /*                                                          */ 06760000
*        /*       DELETE THE DSDIR                                   */ 06761000
*        /*                                                          */ 06762000
*        /************************************************************/ 06763000
*                                                                  1713 06764000
*                              GRABCURR = GRABRAB1; /*VOL RECORD     */ 06765000
         L     @07,RSGRABCU(,REG6)                                 1713 06766000
         L     @04,GRABRAB1(,@07)                                  1713 06767000
         ST    @04,GRABCURR(,@07)                                  1713 06768000
*                              GRABBB = GRABCURR; /*BASE FOR DELETE  */ 06769000
         ST    @04,GRABBB(,@07)                                    1714 06770000
*                              RSWASNVT = RSPVSNT8; /*DSDIR SNTAB    */ 06771000
         L     @07,RSPVSNT8(,REG6)                                 1715 06772000
         ST    @07,RSWASNVT(,REG6)                                 1715 06773000
*                              /* CALL TO MODULE IDCRS04 FOR PROCEDURE  06774000
*ELGO                                                                */ 06775000
*                              CALL DELGO;                         1716 06776000
*                                                                  1716 06777000
         L     @15,@CV03434                                        1716 06778000
         BALR  @14,@15                                             1716 06779000
*        /************************************************************/ 06780000
*        /*                                                          */ 06781000
*        /*       MARK THE VGO UNUSABLE                              */ 06782000
*        /*                                                          */ 06783000
*        /************************************************************/ 06784000
*                                                                  1717 06785000
*                              RSWASNVT = RSPVSNT3; /*VGO SNTAB      */ 06786000
         L     @07,RSPVSNT3(,REG6)                                 1717 06787000
         ST    @07,RSWASNVT(,REG6)                                 1717 06788000
*                              RSASDSDI = ON; /*SPACE CONFLICT       */ 06789000
         OI    RSASDSDI(REG6),B'01000000'                          1718 06790000
*                              GRABCURR = GRABRAB2; /*DATA OR INDEX  */ 06791000
         L     @07,RSGRABCU(,REG6)                                 1719 06792000
         L     @04,GRABRAB2(,@07)                                  1719 06793000
         ST    @04,GRABCURR(,@07)                                  1719 06794000
*                              CALL MARKUNUS;                      1720 06795000
*                                                                  1720 06796000
*                                                                  1720 06797000
         BAL   @14,MARKUNUS                                        1720 06798000
*                              DO;                                 1721 06799000
*                                RSRTYPE = ''B;                    1722 06800000
         MVI   RSRTYPE(REG6),X'00'                                 1722 06801000
*                                RSRUPDT = ON;     /* UPDRCD  */   1723 06802000
         OI    RSRUPDT(REG6),B'00100000'                           1723 06803000
*                                RSRUPD = ON;      /* UPDATE  */   1724 06804000
         OI    RSRUPD(REG6),B'00001000'                            1724 06805000
*                                RSRDS = ''B;                      1725 06806000
         NI    RSRDS(REG6),B'00011111'                             1725 06807000
*                                RSRWF = ON;       /* WORKFILE  */ 1726 06808000
*                                RSRDIR = ON;      /* DIRECT  */   1727 06809000
*                                RSRKEY = ON;      /* KEY  */      1728 06810000
*                                                                  1728 06811000
         OI    RSRWF(REG6),B'10010100'                             1728 06812000
*                              /* CALL TO MODULE IDCRS06 FOR PROCEDURE  06813000
*ECMGMT                                                              */ 06814000
*                              CALL RECMGMT;                       1729 06815000
         L     @15,@CV03452                                        1729 06816000
         BALR  @14,@15                                             1729 06817000
*                                RFY RTNREG RSTD;                  1730 06818000
*                                TESTRC = RTNREG;                  1731 06819000
         STH   RTNREG,TESTRC(,REG6)                                1731 06820000
*                                RFY RTNREG UNRSTD;                1732 06821000
*                              END;                                1733 06822000
*                                      /*MARK D OR I UNUSABLE        */ 06823000
*                            END;                                  1734 06824000
*                        END;                                      1735 06825000
*                                                                  1735 06826000
@RF01701 DS    0H                                                  1736 06827000
*        /************************************************************/ 06828000
*        /*                                                          */ 06829000
*        /*  FREE THE VGO SN TABLE FOR REUSE BY FIND                 */ 06830000
*        /*                                                          */ 06831000
*        /************************************************************/ 06832000
*                                                                  1736 06833000
*                      RSPVSNT3->RSFENTLN = 0;                     1736 06834000
@RT01678 L     @07,RSPVSNT3(,REG6)                                 1736 06835000
         MVI   RSFENTLN(@07),X'00'                                 1736 06836000
*                      RSPVSNT3 = 0;                               1737 06837000
         SLR   @07,@07                                             1737 06838000
         ST    @07,RSPVSNT3(,REG6)                                 1737 06839000
*                    END;                                          1738 06840000
*                  GRABCURR = GRABRAB2; /*FREE THE DATA OR INDEX RCD */ 06841000
*                                                                  1739 06842000
@RF01665 L     @07,RSGRABCU(,REG6)                                 1739 06843000
         L     @04,GRABRAB2(,@07)                                  1739 06844000
         ST    @04,GRABCURR(,@07)                                  1739 06845000
*                  DO;                                             1740 06846000
*                    RSRTYPE = ''B;                                1741 06847000
         MVI   RSRTYPE(REG6),X'00'                                 1741 06848000
*                    RSRFREE = ON;     /* FREERCD  */              1742 06849000
         OI    RSRFREE(REG6),B'00000001'                           1742 06850000
*                    RSRUPD = ON;      /* UPDATE  */               1743 06851000
         OI    RSRUPD(REG6),B'00001000'                            1743 06852000
*                    RSRDS = ''B;                                  1744 06853000
         NI    RSRDS(REG6),B'00011111'                             1744 06854000
*                    RSRWF = ON;       /* WORKFILE  */             1745 06855000
*                    RSRDIR = ON;      /* DIRECT  */               1746 06856000
*                    RSRKEY = ON;      /* KEY  */                  1747 06857000
*                                                                  1747 06858000
         OI    RSRWF(REG6),B'10010100'                             1747 06859000
*                  /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT   */ 06860000
*                  CALL RECMGMT;                                   1748 06861000
         L     @15,@CV03452                                        1748 06862000
         BALR  @14,@15                                             1748 06863000
*                    RFY RTNREG RSTD;                              1749 06864000
*                    TESTRC = RTNREG;                              1750 06865000
         STH   RTNREG,TESTRC(,REG6)                                1750 06866000
*                    RFY RTNREG UNRSTD;                            1751 06867000
*                  END;                                            1752 06868000
*                END;                                              1753 06869000
*              RSWASNVT = RSPVSNT8;    /*RESTORE GC8 SNTAB           */ 06870000
@RT01647 L     @07,RSPVSNT8(,REG6)                                 1754 06871000
         ST    @07,RSWASNVT(,REG6)                                 1754 06872000
*            END;                                                  1755 06873000
         L     @04,RSWASNVT(,REG6)                                 1755 06874000
         LA    @07,1                                               1755 06875000
         AH    @07,RSFCNDX(,@04)                                   1755 06876000
@DE01645 L     @04,RSWASNVT(,REG6)                                 1755 06877000
         STH   @07,RSFCNDX(,@04)                                   1755 06878000
         L     @04,RSWASNVT(,REG6)                                 1755 06879000
         CH    @07,RSFHNDX(,@04)                                   1755 06880000
         BNH   @DL01645                                            1755 06881000
*          END CONFLICT;                                           1756 06882000
*        /************************************************************/ 06883000
*        /*                                                          */ 06884000
*        /*  PRIMARY PLUS SECONDARY MAP REPRESENTS SUBALLOCATED SPACE*/ 06885000
*        /*                                                          */ 06886000
*        /************************************************************/ 06887000
*                                                                  1757 06888000
*        RFY BMAP BASED(RSTOMAP);                                  1757 06889000
@RF01642 DS    0H                                                  1758 06890000
*        RSTOMAP = RSPBMAP;            /*TARGET MAP                  */ 06891000
         L     @07,RSPBMAP(,REG6)                                  1758 06892000
         ST    @07,RSTOMAP(,REG6)                                  1758 06893000
*        RSFROMAP = RSSBMAP;           /*0 BIT MEANS TRACK ALLOCATED */ 06894000
         L     @07,RSSBMAP(,REG6)                                  1759 06895000
         ST    @07,RSFROMAP(,REG6)                                 1759 06896000
*        DO TMPSZ = RSMAPSIZ BY -256 WHILE(TMPSZ>256);             1760 06897000
         L     @07,RSMAPSIZ(,REG6)                                 1760 06898000
         ST    @07,TMPSZ(,REG6)                                    1760 06899000
         B     @DE01760                                            1760 06900000
@DL01760 DS    0H                                                  1761 06901000
*          BMAP(1:256) = BMAP(1:256) & RSFROMAP->BMAP(1:256);      1761 06902000
         L     @07,RSTOMAP(,REG6)                                  1761 06903000
         L     @04,RSFROMAP(,REG6)                                 1761 06904000
         NC    BMAP(256,@07),BMAP(@04)                             1761 06905000
*                                      /*1 IN BOTH MEANS AVAILABLE   */ 06906000
*          RSTOMAP = RSTOMAP + 256;                                1762 06907000
         LA    @15,256                                             1762 06908000
         ALR   @07,@15                                             1762 06909000
         ST    @07,RSTOMAP(,REG6)                                  1762 06910000
*          RSFROMAP = RSFROMAP + 256;                              1763 06911000
         ALR   @04,@15                                             1763 06912000
         ST    @04,RSFROMAP(,REG6)                                 1763 06913000
*        END;                                                      1764 06914000
         L     @07,@CF03546                                        1764 06915000
         AL    @07,TMPSZ(,REG6)                                    1764 06916000
         ST    @07,TMPSZ(,REG6)                                    1764 06917000
@DE01760 L     @07,TMPSZ(,REG6)                                    1764 06918000
         C     @07,@CF03188                                        1764 06919000
         BH    @DL01760                                            1764 06920000
*        BMAP(1:TMPSZ) = BMAP(1:TMPSZ) & RSFROMAP->BMAP(1:TMPSZ);  1765 06921000
         L     @04,RSTOMAP(,REG6)                                  1765 06922000
         BCTR  @07,0                                               1765 06923000
         L     @01,RSFROMAP(,REG6)                                 1765 06924000
         EX    @07,@SN03753                                        1765 06925000
*                                      /*PUT IN LAST LITTLE BIT      */ 06926000
*        RFY BMAP;                     /*REVERT                      */ 06927000
*                                                                  1766 06928000
*        /************************************************************/ 06929000
*        /*                                                          */ 06930000
*        /*  UPDATE THE SPACE MAP IF NECESSARY                       */ 06931000
*        /*                                                          */ 06932000
*        /************************************************************/ 06933000
*                                                                  1767 06934000
*  VLRUPSM:                                                        1767 06935000
*        RSWFBMAP = RSWKBMAP;          /*SPACE MAP STG FOR FIND      */ 06936000
VLRUPSM  L     @07,RSWKBMAP(,REG6)                                 1767 06937000
         ST    @07,RSWFBMAP(,REG6)                                 1767 06938000
*        RSWFBMLN = RSMAPSIZ;          /*SIZE OF MAP                 */ 06939000
         L     @07,RSMAPSIZ(,REG6)                                 1768 06940000
         STH   @07,RSWFBMLN(,REG6)                                 1768 06941000
*        GRABCURR = GRABRAB1;          /*VOLUME RECORD AS BASE       */ 06942000
*                                                                  1769 06943000
         L     @07,RSGRABCU(,REG6)                                 1769 06944000
         L     @04,GRABRAB1(,@07)                                  1769 06945000
         ST    @04,GRABCURR(,@07)                                  1769 06946000
*        DO;                                                       1770 06947000
*          GRABBB = GRABCURR;                                      1771 06948000
         ST    @04,GRABBB(,@07)                                    1771 06949000
*          RSWGCODE = GCSPCMAP;        /*SPECIFY GROUP CODE          */ 06950000
         MVI   RSWGCODE(REG6),X'05'                                1772 06951000
*          RSWFONE = OFF;              /*FIND ALL OCCURRENCES        */ 06952000
         NI    RSWFONE(REG6),B'01111111'                           1773 06953000
*          /* CALL THE FIND SUBROUTINE */                          1774 06954000
*                                                                  1774 06955000
*        /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND                */ 06956000
*        CALL FIND;                                                1774 06957000
         L     @15,@CV03435                                        1774 06958000
         BALR  @14,@15                                             1774 06959000
*        END;                                                      1775 06960000
*                                                                  1775 06961000
*        /************************************************************/ 06962000
*        /*                                                          */ 06963000
*        /*  IF THERE IS NO SPACE MAP OR IT WAS THE WRONG LENGTH,    */ 06964000
*        /*  ISSUE MESSAGE IDC11034I.                                */ 06965000
*        /*                                                          */ 06966000
*        /************************************************************/ 06967000
*                                                                  1776 06968000
*        IF (RSFENTLN=0) | (RSFLENBM^=RSMAPSIZ) THEN               1776 06969000
*                                                                  1776 06970000
         L     @07,RSWASNVT(,REG6)                                 1776 06971000
         CLI   RSFENTLN(@07),0                                     1776 06972000
         BE    @RT01776                                            1776 06973000
         LH    @07,RSFLENBM(,@07)                                  1776 06974000
         C     @07,RSMAPSIZ(,REG6)                                 1776 06975000
         BE    @RF01776                                            1776 06976000
@RT01776 DS    0H                                                  1777 06977000
*          DO;                                                     1777 06978000
*          /*CALL CKERR*/                                          1778 06979000
*            RSCKERR = RSCKERR && RSCKERR;                         1778 06980000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1778 06981000
*            RSCKERN = RSE045;                                     1779 06982000
         MVC   RSCKERN(2,REG6),@CH00976                            1779 06983000
*            RSCKTERM = 'RETU';                                    1780 06984000
         MVC   RSCKTERM(4,REG6),@CC03500                           1780 06985000
*            RSCKMVAR(1) = ADDR(VOLSRSER);                         1781 06986000
*                                                                  1781 06987000
         L     @07,RSVTBENT(,REG6)                                 1781 06988000
         LA    @07,VOLSRSER(,@07)                                  1781 06989000
         ST    @07,RSCKMVAR(,REG6)                                 1781 06990000
*          /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR             */ 06991000
*          CALL CKERR;                                             1782 06992000
         L     @15,@CV03443                                        1782 06993000
         BALR  @14,@15                                             1782 06994000
*          END;                                                    1783 06995000
*                                                                  1783 06996000
*        /************************************************************/ 06997000
*        /*                                                          */ 06998000
*        /*  CHECK IF SPACE MAP CHANGED - IF SO, PROCEED TO UPDATE IT*/ 06999000
*        /*                                                          */ 07000000
*        /************************************************************/ 07001000
*                                                                  1784 07002000
*        ELSE                                                      1784 07003000
*          DO;                                                     1784 07004000
         B     @RC01776                                            1784 07005000
@RF01776 DS    0H                                                  1785 07006000
*            RSTOMAP = RSPBMAP;        /*OUR SPACE MAP               */ 07007000
         L     @07,RSPBMAP(,REG6)                                  1785 07008000
         ST    @07,RSTOMAP(,REG6)                                  1785 07009000
*            RSFROMAP = RSFABMAP;      /*THEIR SPACE MAP             */ 07010000
         L     @07,RSWASNVT(,REG6)                                 1786 07011000
         L     @07,RSFABMAP(,@07)                                  1786 07012000
         ST    @07,RSFROMAP(,REG6)                                 1786 07013000
*            RSPVNRP = OFF;            /*IND NO SPACE MAP CHANGE     */ 07014000
         NI    RSPVNRP(REG6),B'11101111'                           1787 07015000
*            DO TMPSZ = 1 TO RSMAPSIZ;                             1788 07016000
         LA    @07,1                                               1788 07017000
         B     @DE01788                                            1788 07018000
@DL01788 DS    0H                                                  1789 07019000
*              IF RSTOMAP->BMAP(1:1) ^= RSFROMAP->BMAP(1:1) THEN   1789 07020000
         L     @07,RSTOMAP(,REG6)                                  1789 07021000
         L     @04,RSFROMAP(,REG6)                                 1789 07022000
         CLC   BMAP(1,@07),BMAP(@04)                               1789 07023000
         BE    @RF01789                                            1789 07024000
*                RSPVNRP = ON;         /*IND SPC MAP DIFFERENT       */ 07025000
         OI    RSPVNRP(REG6),B'00010000'                           1790 07026000
*              RSTOMAP = RSTOMAP + 1;                              1791 07027000
@RF01789 LA    @07,1                                               1791 07028000
         L     @04,RSTOMAP(,REG6)                                  1791 07029000
         ALR   @04,@07                                             1791 07030000
         ST    @04,RSTOMAP(,REG6)                                  1791 07031000
*              RSFROMAP = RSFROMAP + 1;                            1792 07032000
         AL    @07,RSFROMAP(,REG6)                                 1792 07033000
         ST    @07,RSFROMAP(,REG6)                                 1792 07034000
*            END;                                                  1793 07035000
*                                                                  1793 07036000
         LA    @07,1                                               1793 07037000
         AL    @07,TMPSZ(,REG6)                                    1793 07038000
@DE01788 ST    @07,TMPSZ(,REG6)                                    1793 07039000
         C     @07,RSMAPSIZ(,REG6)                                 1793 07040000
         BNH   @DL01788                                            1793 07041000
*        /************************************************************/ 07042000
*        /*                                                          */ 07043000
*        /*  RETURN SUBALLOCATED SPACE                               */ 07044000
*        /*                                                          */ 07045000
*        /************************************************************/ 07046000
*                                                                  1794 07047000
*            IF RSPVNRP = ON THEN                                  1794 07048000
         TM    RSPVNRP(REG6),B'00010000'                           1794 07049000
         BNO   @RF01794                                            1794 07050000
*              DO;                                                 1795 07051000
*                RSTOMAP = RSFABMAP;   /*TO MAP                      */ 07052000
         L     @07,RSWASNVT(,REG6)                                 1796 07053000
         L     @07,RSFABMAP(,@07)                                  1796 07054000
         ST    @07,RSTOMAP(,REG6)                                  1796 07055000
*                RSFROMAP = RSPBMAP;    /*FROM MAP                   */ 07056000
         L     @07,RSPBMAP(,REG6)                                  1797 07057000
         ST    @07,RSFROMAP(,REG6)                                 1797 07058000
*                DO TMPSZ = RSMAPSIZ BY -256                       1798 07059000
*                 WHILE(TMPSZ > 256);                              1798 07060000
         L     @07,RSMAPSIZ(,REG6)                                 1798 07061000
         ST    @07,TMPSZ(,REG6)                                    1798 07062000
         B     @DE01798                                            1798 07063000
@DL01798 DS    0H                                                  1799 07064000
*                                      /*INSERT ALL BUT LAST SEGMENT */ 07065000
*                  RSTOMAP->BMAP(1:256) = RSFROMAP->BMAP(1:256);   1799 07066000
         L     @07,RSTOMAP(,REG6)                                  1799 07067000
         L     @04,RSFROMAP(,REG6)                                 1799 07068000
         MVC   BMAP(256,@07),BMAP(@04)                             1799 07069000
*                                      /*REPLACE AVAIL SUBALLOCATED  */ 07070000
*                  RSTOMAP = RSTOMAP + 256; /*NEXT SEGMENT           */ 07071000
         LA    @15,256                                             1800 07072000
         ALR   @07,@15                                             1800 07073000
         ST    @07,RSTOMAP(,REG6)                                  1800 07074000
*                  RSFROMAP = RSFROMAP + 256;                      1801 07075000
         ALR   @04,@15                                             1801 07076000
         ST    @04,RSFROMAP(,REG6)                                 1801 07077000
*                END;                                              1802 07078000
         L     @07,@CF03546                                        1802 07079000
         AL    @07,TMPSZ(,REG6)                                    1802 07080000
         ST    @07,TMPSZ(,REG6)                                    1802 07081000
@DE01798 L     @07,TMPSZ(,REG6)                                    1802 07082000
         C     @07,@CF03188                                        1802 07083000
         BH    @DL01798                                            1802 07084000
*                RSTOMAP->BMAP(1:TMPSZ) = RSFROMAP->BMAP(1:TMPSZ); 1803 07085000
         L     @04,RSTOMAP(,REG6)                                  1803 07086000
         BCTR  @07,0                                               1803 07087000
         L     @01,RSFROMAP(,REG6)                                 1803 07088000
         EX    @07,@SM03734                                        1803 07089000
*                                      /*REPLACE LAST LITTLE BIT     */ 07090000
*                                                                  1804 07091000
*        /************************************************************/ 07092000
*        /*                                                          */ 07093000
*        /*               MODIFY THE SPACE MAP                       */ 07094000
*        /*                                                          */ 07095000
*        /************************************************************/ 07096000
*                                                                  1804 07097000
*                /* CALL TO MODULE IDCRS04 FOR PROCEDURE MODGO       */ 07098000
*                CALL MODGO;                                       1804 07099000
*                                                                  1804 07100000
         L     @15,@CV03433                                        1804 07101000
         BALR  @14,@15                                             1804 07102000
*        /************************************************************/ 07103000
*        /*                                                          */ 07104000
*        /*  INFORM THE USER THAT THE SPACE MAP WAS MODIFIED         */ 07105000
*        /*  MESSAGE - IDC11029I.                                    */ 07106000
*        /*                                                          */ 07107000
*        /************************************************************/ 07108000
*                                                                  1805 07109000
*                                                                  1805 07110000
*                DO;                                               1805 07111000
*                /*CALL CKERR*/                                    1806 07112000
*                  RSCKERR = RSCKERR && RSCKERR;                   1806 07113000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1806 07114000
*                  RSCKERN = RSE032;                               1807 07115000
         MVC   RSCKERN(2,REG6),@CH00215                            1807 07116000
*                  RSCKTERM = 'RETU';                              1808 07117000
         MVC   RSCKTERM(4,REG6),@CC03500                           1808 07118000
*                  RSCKMVAR(1) = ADDR(VOLSRSER);                   1809 07119000
*                                                                  1809 07120000
         L     @07,RSVTBENT(,REG6)                                 1809 07121000
         LA    @07,VOLSRSER(,@07)                                  1809 07122000
         ST    @07,RSCKMVAR(,REG6)                                 1809 07123000
*                /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR       */ 07124000
*                CALL CKERR;                                       1810 07125000
         L     @15,@CV03443                                        1810 07126000
         BALR  @14,@15                                             1810 07127000
*                END;                                              1811 07128000
*              END;                                                1812 07129000
*            RSFENTLN = 0;             /*FREE SPACE MAP SNTAB        */ 07130000
@RF01794 L     @07,RSWASNVT(,REG6)                                 1813 07131000
         MVI   RSFENTLN(@07),X'00'                                 1813 07132000
*          END;                                                    1814 07133000
* CALL EXIT;  /*TERMINATE*/                                        1815 07134000
@RC01776 BAL   @14,EXIT                                            1815 07135000
* END VLRESET; /*END OF PROCEDURE*/                                1816 07136000
@EL00016 DS    0H                                                  1816 07137000
@EF00016 DS    0H                                                  1816 07138000
@ER00016 BR    @14                                                 1816 07139000
@PB00016 DS    0H                                                  1817 07140000
*/********************************************************************/ 07141000
*/* PROCEDURE NAME - VOLCHK                                          */ 07142000
*/*                                                                  */ 07143000
*/* FUNCTION - THIS SEGMENT IS CALLED BY MERGECRA. IT INSURES THAT   */ 07144000
*/*            THERE IS A ONE-TO-ONE CORRESPONDENCE BETWEEN EACH     */ 07145000
*/*            VSAM DATA SPACE ON A VOLUME (FORMAT 1 DSCB IN THE     */ 07146000
*/*            VTOC) AND EACH SPACE HEADER IN THE VOLUME RECORD FOR  */ 07147000
*/*            THAT VOLUME. IF A VSAM FORMAT 1 DSCB DOES NOT HAVE A  */ 07148000
*/*            CORRESPONDING SPACE HEADER, THE FORMAT 1 DSCB IS      */ 07149000
*/*            SCRATCHED. IF A SPACE HEADER REFERS TO A NON-         */ 07150000
*/*            EXISTANT FORMAT 1 DSCB, THEN THE SPACE HEADER IS      */ 07151000
*/*            DELETED. IF THE EXTENTS IN A SPACE HEADER ARE NOT     */ 07152000
*/*            IDENTICAL TO THE EXTENTS IN THE CORRESPONDING FORMAT  */ 07153000
*/*            1 DSCB, THE EXTENTS IN THE SPACE HEADER ARE CORRECTED */ 07154000
*/*                                                                  */ 07155000
*/* INPUT - MAIN WORK AREA (RSVTBENT MUST POINT TO CURRENT VOLSERTB  */ 07156000
*/*            ENTRY AND RSENTPT MUST POINT TO CURRENT RESVOL ENTRY) */ 07157000
*/*         RECORD MANAGEMENT CONTROL BLOCKS                         */ 07158000
*/*                                                                  */ 07159000
*/* OUTPUT - VTOC MAY BE UPDATED                                     */ 07160000
*/*                                                                  */ 07161000
*/* EXIT,NORMAL - RETURN TO CALLER                                   */ 07162000
*/********************************************************************/ 07163000
*      GENERATE;                                                   1817 07164000
         DS    0F                                                       07165000
NAME0171 DC    CL8'VOLCHK'                                              07166000
*VOLCHK: PROCEDURE                                                 1818 07167000
*        OPTIONS(NOSAVE,NOSAVEAREA);                               1818 07168000
*                                                                  1818 07169000
         B     @PB00017                                            1818 07170000
VOLCHK   DS    0H                                                  1819 07171000
*      GENERATE REFS(RS03RG08, REG6);                              1819 07172000
         STM   @14,@12,12(@13)  SAVE REGISTERS                          07173000
         LR    @15,@13  OLD SAVE AREA                                   07174000
         LA    @13,72(@13)  NEW SAVE AREA                               07175000
         ST    @13,8(@15)  FORWARD CHAIN OLD TO NEW                     07176000
         ST    @15,4(@13)  BACK CHAIN NEW TO OLD                        07177000
         ENTRY VOLCHK  ENTRY POINT                                      07178000
         LM    @08,@12,RS03RG08(REG6)  PRIME BASE AND DATA REGS         07179000
         MVC   0(4,@15),NAME0171  PROCNAME TO REGSAVE                   07180000
*        /************************************************************/ 07181000
*        /*                                                          */ 07182000
*        /*  STRUCTURE FOR FORMAT 1 DSCB                             */ 07183000
*        /*                                                          */ 07184000
*        /************************************************************/ 07185000
*        DCL 1 FMT1DSCB BASED(IOCDAD),                             1820 07186000
*              2 FMT1NAME CHAR(44),    /*DSNAME           */       1820 07187000
*              2 FMT1ID  CHAR(1),      /*FORMAT IDENTIFIER*/       1820 07188000
*              2 *       CHAR(14),     /*UNREFERENCED*/            1820 07189000
*              2 FMT1NEXT BIN(8),      /*NUMBER EXTENTS*/          1820 07190000
*              2 *       CHAR(23),     /*UNREFERENCED*/            1820 07191000
*              2 FMT1ORG BIT(8),       /*DSORG*/                   1820 07192000
*                3 *        BIT(4),    /*UNREFERENCED*/            1820 07193000
*                3 FMT1VSAM BIT(1),    /*VSAM ORGANIZATION*/       1820 07194000
*                3 *        BIT(3),    /*UNREFERENCED*/            1820 07195000
*              2 *       CHAR(21),     /*UNREFERENCED*/            1820 07196000
*              2 FMT1EXTS(3) CHAR(10), /*UP TO 3 EXTENT DESCRIPTIONS*/  07197000
*                3 FMT1EXTY CHAR(1),   /*TYPE INDICATOR*/          1820 07198000
*                3 FMT1SEQ  BIN(8),    /*SEQUENCE NUMBER*/         1820 07199000
*                3 FMT1CCHH  CHAR(8),   /*STARTING & ENDING CCHH*/ 1820 07200000
*              2 FMT1PTR  CHAR(5);     /*CCHHR OF F3 DSCB*/        1820 07201000
*        DCL 1 F1TSCNVT(14) CHAR(1) DEF(RSVF1TS),                  1821 07202000
*                                      /*F1 NAME TS CONVERSION WA */    07203000
*              2 F1TSFIX  FIXED(8),    /*DECIMAL DIGIT       */    1821 07204000
*                3 F1TSZNE BIT(4),     /*ZONE                */    1821 07205000
*                3 F1TSDIG BIT(4);     /*DGIT                */    1821 07206000
*        DCL F1TS1 CHAR(7) DEF(RSVSCRNM) POS(20);                  1822 07207000
*                                      /*1ST 7 DIGITS OF F1 NAME TS */  07208000
*        DCL F1TS2 CHAR(7) DEF(RSVSCRNM) POS(29);                  1823 07209000
*                                      /*LAST 7 DIGITS OF F1 NAME TS*/  07210000
*        /************************************************************/ 07211000
*        /*                                                          */ 07212000
*        /*  STRUCTURE FOR FORMAT 3 DSCB                             */ 07213000
*        /*                                                          */ 07214000
*        /************************************************************/ 07215000
*        DCL 1 FMT3DSCB BASED(IOCDAD),                             1824 07216000
*              2 *     CHAR(4),         /*UNREFERENCED*/           1824 07217000
*              2 FMT3EXTA(4) CHAR(10), /*UP TO 4 EXTENT DESCRIPTIONS*/  07218000
*                3 *   CHAR(2),        /*UNREFERENCED*/            1824 07219000
*                3 FMT3CCHA CHAR(8),   /*START & END CCHH*/        1824 07220000
*              2 *     CHAR(1),        /*UNREFERENCED*/            1824 07221000
*              2 FMT3EXTB(9) CHAR(10), /*UP TO 9 EXTENT DESCRIPTIONS*/  07222000
*                3 *   CHAR(2),        /*UNREFERENCED*/            1824 07223000
*                3 FMT3CCHB CHAR(8),   /*START & END CCHH*/        1824 07224000
*              2 *     CHAR(5);        /*UNREFERENCED*/            1824 07225000
*        DCL                                                       1825 07226000
*          DS4TIMS BASED(IOCDAD) POS(88) /*VSAM VOL/CAT MATCH*/    1825 07227000
*            CHAR(8),                  /*TIMESTAMP IN F4 DSCB*/    1825 07228000
*          DS4CCHH BASED(IOCDAD) POS(108) CHAR(4);                 1825 07229000
*                                        /*STARTING CCHH OF VTOC */     07230000
*        DCL 1 TTRZ CHAR(4) DEF(IOCTTR) BDY(WORD),                 1826 07231000
*                                      /* TTRZ                       */ 07232000
*              2 TT       FIXED(15),   /* TT                         */ 07233000
*              2 R        CHAR(1),     /* R                          */ 07234000
*              2 Z        CHAR(1);     /* Z                          */ 07235000
*        DCL 1 DRTS DEF(RSVF1TS),      /* DERIVED TIMESTAMP DIGITS   */ 07236000
*              2 DRTS1 CHAR(7),        /* FIRST 7 DIGITS             */ 07237000
*              2 DRTS2 CHAR(7);        /* LAST 7 DIGITS              */ 07238000
*        RFY RESVOL BASED(RSENTPT);                                1828 07239000
*        RFY VOLSERTB BASED(RSVTBENT);                             1829 07240000
*        OLDERID2 = NEWERID2;                                      1830 07241000
         L     @07,GDTTR2(,REG5)                                   1830 07242000
         MVC   @TS00001(95),NEWERID2(@07)                          1830 07243000
         MVC   OLDERID2(95,@07),@TS00001                           1830 07244000
*        NEWID2 = 'RSVO';                                          1831 07245000
         MVC   NEWID2(4,@07),@CC03684                              1831 07246000
*        /************************************************************/ 07247000
*        /*                                                          */ 07248000
*        /*   SET CURRENT GRABS AND RAB POINTER                      */ 07249000
*        /*                                                          */ 07250000
*        /************************************************************/ 07251000
*        RSVWFUPD = OFF;                                           1832 07252000
         NI    RSVWFUPD(REG6),B'11011111'                          1832 07253000
*        RSGRABCU = ADDR(GRABSWF);                                 1833 07254000
         L     @07,RSIOTBL(,REG6)                                  1833 07255000
         ST    @07,RSGRABCU(,REG6)                                 1833 07256000
*        GRABCURR = GRABRAB4;                                      1834 07257000
         L     @04,GRABRAB4(,@07)                                  1834 07258000
         ST    @04,GRABCURR(,@07)                                  1834 07259000
*        /************************************************************/ 07260000
*        /*                                                          */ 07261000
*        /*  ISSUE GETVIA TO LOCATE THE WORKFILE RECORD FOR THIS     */ 07262000
*        /*  VOLUME.                                                 */ 07263000
*        /*                                                          */ 07264000
*        /************************************************************/ 07265000
*                                                                  1835 07266000
*        DO;                                                       1835 07267000
*          RSRTYPE = ''B;                                          1836 07268000
         MVI   RSRTYPE(REG6),X'00'                                 1836 07269000
*          RSRGET = ON;      /* GETRCD  */                         1837 07270000
         OI    RSRGET(REG6),B'10000000'                            1837 07271000
*          RSRUPD = ON;      /* UPDATE  */                         1838 07272000
         OI    RSRUPD(REG6),B'00001000'                            1838 07273000
*          RSRDS = ''B;                                            1839 07274000
         NI    RSRDS(REG6),B'00011111'                             1839 07275000
*          RSRWF = ON;       /* WORKFILE  */                       1840 07276000
*          RSRDIR = ON;      /* DIRECT  */                         1841 07277000
*          RSRKEY = ON;      /* KEY  */                            1842 07278000
         OI    RSRWF(REG6),B'10010100'                             1842 07279000
*          RSVIAFCR = ON;  /*INDICATE CRA SEARCH*/                 1843 07280000
         OI    RSVIAFCR(REG6),B'10000000'                          1843 07281000
*          RSVIACRA = VOLSRSER; /*SET VOLSER */                    1844 07282000
         L     @07,RSVTBENT(,REG6)                                 1844 07283000
         MVC   RSVIACRA(6,REG6),VOLSRSER(@07)                      1844 07284000
*          RSVIACIN = VOLSRCI; /*SET CI NUMBER */                  1845 07285000
*                                                                  1845 07286000
         MVC   RSVIACIN(3,REG6),VOLSRCI+1(@07)                     1845 07287000
*        /* CALL TO MODULE IDCRS05 FOR PROCEDURE GETVIA              */ 07288000
*        CALL GETVIA;                                              1846 07289000
         L     @15,@CV03436                                        1846 07290000
         BALR  @14,@15                                             1846 07291000
*        END;                                                      1847 07292000
*        /************************************************************/ 07293000
*        /*                                                          */ 07294000
*        /*  IF VOLUME RECORD WAS NOT FOUND, CALL CKERR TO TERMINATE.*/ 07295000
*        /*                                                          */ 07296000
*        /************************************************************/ 07297000
*        IF RABNRF = ON                                            1848 07298000
*          THEN                                                    1848 07299000
*                                                                  1848 07300000
         L     @07,RSGRABCU(,REG6)                                 1848 07301000
         L     @07,GRABCURR(,@07)                                  1848 07302000
         TM    RABNRF(@07),B'00000010'                             1848 07303000
         BNO   @RF01848                                            1848 07304000
*            DO;                                                   1849 07305000
*            /*CALL CKERR*/                                        1850 07306000
*              RSCKERR = RSCKERR && RSCKERR;                       1850 07307000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1850 07308000
*              RSCKERN = RSE100;                                   1851 07309000
         MVC   RSCKERN(2,REG6),@CH00143                            1851 07310000
*              RSCKTERM = 'TERM';                                  1852 07311000
*                                                                  1852 07312000
         MVC   RSCKTERM(4,REG6),@CC03527                           1852 07313000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 07314000
*            CALL CKERR;                                           1853 07315000
         L     @15,@CV03443                                        1853 07316000
         BALR  @14,@15                                             1853 07317000
*            END;                                                  1854 07318000
*        /************************************************************/ 07319000
*        /*                                                          */ 07320000
*        /*  BUILD THE OPNAGL FOR UOPEN REQUEST TO OPEN VTOC         */ 07321000
*        /*                                                          */ 07322000
*        /************************************************************/ 07323000
*        OPNPTR = ADDR(RSOPNAGL);                                  1855 07324000
@RF01848 L     @07,RSIOTBL(,REG6)                                  1855 07325000
         LA    @07,RSOPNAGL(,@07)                                  1855 07326000
         ST    @07,OPNPTR(,REG6)                                   1855 07327000
*        OPNAGL = OPNAGL && OPNAGL;                                1856 07328000
         XC    OPNAGL(48,@07),OPNAGL(@07)                          1856 07329000
*        /************************************************************/ 07330000
*        /*                                                          */ 07331000
*        /*    SET OPEN OPTIONS - INPUT,BLOCK,NON-VSAM,MODIFY JFCB   */ 07332000
*        /*                                                          */ 07333000
*        /************************************************************/ 07334000
*        OPNOPTIN = ON;                                            1857 07335000
*        OPNOPTBK = ON;                                            1858 07336000
         OI    OPNOPTIN(@07),B'10010000'                           1858 07337000
*        OPNDSOPS = ON;                                            1859 07338000
         OI    OPNDSOPS(@07),B'01000000'                           1859 07339000
*        OPNOPTJM = ON;                                            1860 07340000
         OI    OPNOPTJM(@07),B'00100000'                           1860 07341000
*        OPNIOC = ADDR(RSVTIOCS);                                  1861 07342000
         LA    @04,RSVTIOCS(,REG6)                                 1861 07343000
         ST    @04,OPNIOC(,@07)                                    1861 07344000
*        OPNDDN = ADDR(RESVLDDN);                                  1862 07345000
         L     @04,RSENTPT(,REG6)                                  1862 07346000
         LA    @15,RESVLDDN(,@04)                                  1862 07347000
         ST    @15,OPNDDN(,@07)                                    1862 07348000
*        OPNDSN = ADDR(DS4DSNM);                                   1863 07349000
         LA    @15,DS4DSNM                                         1863 07350000
         ST    @15,OPNDSN(,@07)                                    1863 07351000
*        OPNBLK = VTCBLKSZ;                                        1864 07352000
         MVC   OPNBLK(4,@07),@CF00753                              1864 07353000
*        OPNKYL = LENGTH(DS4DSNM);                                 1865 07354000
         MVI   OPNKYL(@07),X'2C'                                   1865 07355000
*        OPNVOL = ADDR(RSRNVL);                                    1866 07356000
         LA    @15,RSRNVL(,REG6)                                   1866 07357000
         ST    @15,OPNVOL(,@07)                                    1866 07358000
*        RSRNVLC = 1;                                              1867 07359000
         MVI   RSRNVLC(REG6),X'01'                                 1867 07360000
*        RSRNVLSR = RESVLSER;                                      1868 07361000
         MVC   RSRNVLSR(6,REG6),RESVLSER(@04)                      1868 07362000
*        /************************************************************/ 07363000
*        /*                                                          */ 07364000
*        /*    ISSUE UOPEN TO OPEN VTOC                              */ 07365000
*        /*                                                          */ 07366000
*        /************************************************************/ 07367000
*        CALL IDCIOOP0 (GDTTBL,OPNAGL);                            1869 07368000
         ST    REG5,@AL00001                                       1869 07369000
         ST    @07,@AL00001+4                                      1869 07370000
         MVI   @AL00001+4,X'80'                                    1869 07371000
         L     @15,GDTOPN(,REG5)                                   1869 07372000
         LA    @01,@AL00001                                        1869 07373000
         BALR  @14,@15                                             1869 07374000
*        RESPECIFY RTNREG RSTD;                                    1870 07375000
*        TESTRC = RTNREG;                                          1871 07376000
         STH   RTNREG,TESTRC(,REG6)                                1871 07377000
*        RESPECIFY RTNREG UNRSTD;                                  1872 07378000
*        IF TESTRC ^= 0                                            1873 07379000
*          THEN                                                    1873 07380000
*                                                                  1873 07381000
         LH    @07,TESTRC(,REG6)                                   1873 07382000
         LTR   @07,@07                                             1873 07383000
         BZ    @RF01873                                            1873 07384000
*            DO;                                                   1874 07385000
*            /*CALL CKERR*/                                        1875 07386000
*              RSCKERR = RSCKERR && RSCKERR;                       1875 07387000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1875 07388000
*              RSCKERN = RSE050;                                   1876 07389000
         MVC   RSCKERN(2,REG6),@CH00985                            1876 07390000
*              RSCKTERM = 'TERM';                                  1877 07391000
*                                                                  1877 07392000
         MVC   RSCKTERM(4,REG6),@CC03527                           1877 07393000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 07394000
*            CALL CKERR;                                           1878 07395000
         L     @15,@CV03443                                        1878 07396000
         BALR  @14,@15                                             1878 07397000
*            END;                                                  1879 07398000
*        /************************************************************/ 07399000
*        /*                                                          */ 07400000
*        /*  SET VTOC OPENED AUDIT FLAG ON                           */ 07401000
*        /*                                                          */ 07402000
*        /************************************************************/ 07403000
*        RSVTOPN = ON;                                             1880 07404000
@RF01873 OI    RSVTOPN(REG6),B'00001000'                           1880 07405000
*        /************************************************************/ 07406000
*        /*                                                          */ 07407000
*        /*  ISSUE UGET FOR FORMAT 4 DSCB                            */ 07408000
*        /*                                                          */ 07409000
*        /************************************************************/ 07410000
*        IOCSPTR = RSVTIOCS;                                       1881 07411000
         L     @07,RSVTIOCS(,REG6)                                 1881 07412000
         ST    @07,IOCSPTR(,REG6)                                  1881 07413000
*        CALL IDCIOGT0 (GDTTBL,IOCSPTR);                           1882 07414000
         ST    REG5,@AL00001                                       1882 07415000
         LA    @07,IOCSPTR(,REG6)                                  1882 07416000
         ST    @07,@AL00001+4                                      1882 07417000
         MVI   @AL00001+4,X'80'                                    1882 07418000
         L     @15,GDTGET(,REG5)                                   1882 07419000
         LA    @01,@AL00001                                        1882 07420000
         BALR  @14,@15                                             1882 07421000
*        RESPECIFY RTNREG RSTD;                                    1883 07422000
*        TESTRC = RTNREG;                                          1884 07423000
         STH   RTNREG,TESTRC(,REG6)                                1884 07424000
*        RESPECIFY RTNREG UNRSTD;                                  1885 07425000
*        IF TESTRC ^= 0                                            1886 07426000
*          THEN                                                    1886 07427000
*                                                                  1886 07428000
         LH    @07,TESTRC(,REG6)                                   1886 07429000
         LTR   @07,@07                                             1886 07430000
         BZ    @RF01886                                            1886 07431000
*            DO;                                                   1887 07432000
*            /*CALL CKERR*/                                        1888 07433000
*              RSCKERR = RSCKERR && RSCKERR;                       1888 07434000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1888 07435000
*              RSCKERN = RSE051;                                   1889 07436000
         MVC   RSCKERN(2,REG6),@CH00987                            1889 07437000
*              RSCKTERM = 'TERM';                                  1890 07438000
*                                                                  1890 07439000
         MVC   RSCKTERM(4,REG6),@CC03527                           1890 07440000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 07441000
*            CALL CKERR;                                           1891 07442000
         L     @15,@CV03443                                        1891 07443000
         BALR  @14,@15                                             1891 07444000
*            END;                                                  1892 07445000
*        /************************************************************/ 07446000
*        /*                                                          */ 07447000
*        /*  CONVERT STARTING CYLINDER, TRACK OF VTOC TO RELATIVE    */ 07448000
*        /*  TRACK FROM BEGINNING OF PACK. WILL HAVE TO SUBTRACT     */ 07449000
*        /*  THIS FROM RELATIVE TRACK OF F3DSCB FROM BEGINNING OF    */ 07450000
*        /*  PACK TO DETERMINE RELATIVE TRACK OF F3DSCB FROM         */ 07451000
*        /*  BEGINNING OF DATA SET.                                  */ 07452000
*        /*                                                          */ 07453000
*        /************************************************************/ 07454000
*        RSCCHHP = ADDR(DS4CCHH);                                  1893 07455000
@RF01886 L     @07,IOCSPTR(,REG6)                                  1893 07456000
         L     @07,IOCDAD(,@07)                                    1893 07457000
         LA    @07,DS4CCHH(,@07)                                   1893 07458000
         ST    @07,RSCCHHP(,REG6)                                  1893 07459000
*        RSCFINN = OFF;                                            1894 07460000
         NI    RSCFINN(REG6),B'01111111'                           1894 07461000
*        /* CALL TO MODULE IDCRS07 FOR PROCEDURE CNVTCCHH            */ 07462000
*        CALL CNVTCCHH;                                            1895 07463000
         L     @15,@CV03460                                        1895 07464000
         BALR  @14,@15                                             1895 07465000
*        RSVF4TT = RSTT;                                           1896 07466000
         LH    @07,RSTT(,REG6)                                     1896 07467000
         STH   @07,RSVF4TT(,REG6)                                  1896 07468000
*        /************************************************************/ 07469000
*        /*                                                          */ 07470000
*        /*  VOLUME RECORD TIMESTAMP DOES NOT MATCH F4DSCB TIMESTAMP */ 07471000
*        /*                                                          */ 07472000
*        /************************************************************/ 07473000
*        IF COWNID ^= DS4TIMS                                      1897 07474000
*          THEN                                                    1897 07475000
         L     @07,RSGRABCU(,REG6)                                 1897 07476000
         LA    @04,8                                               1897 07477000
         AL    @04,GRABCURR(,@07)                                  1897 07478000
         L     @07,IOCSPTR(,REG6)                                  1897 07479000
         L     @07,IOCDAD(,@07)                                    1897 07480000
         CLC   COWNID(8,@04),DS4TIMS(@07)                          1897 07481000
         BE    @RF01897                                            1897 07482000
*            DO;                                                   1898 07483000
*        /************************************************************/ 07484000
*        /*                                                          */ 07485000
*        /*  UPDATE WORKFILE RECORD WITH TIMESTAMP FROM F4DSCB       */ 07486000
*        /*                                                          */ 07487000
*        /************************************************************/ 07488000
*              COWNID = DS4TIMS;                                   1899 07489000
         MVC   COWNID(8,@04),DS4TIMS(@07)                          1899 07490000
*              RSVWFUPD = ON;                                      1900 07491000
         OI    RSVWFUPD(REG6),B'00100000'                          1900 07492000
*        /************************************************************/ 07493000
*        /*                                                          */ 07494000
*        /*  PREPARE TO UPDATE THE CRA RECORD VIA ADDUPCR            */ 07495000
*        /*                                                          */ 07496000
*        /************************************************************/ 07497000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE ADDUPCR       */ 07498000
*              CALL ADDUPCR;                                       1901 07499000
         L     @15,@CV03442                                        1901 07500000
         BALR  @14,@15                                             1901 07501000
*        /************************************************************/ 07502000
*        /*                                                          */ 07503000
*        /*  CALL CKERR TO PRINT AN INFORMATIONAL MESSAGE            */ 07504000
*        /*                                                          */ 07505000
*        /************************************************************/ 07506000
*                                                                  1902 07507000
*              DO;                                                 1902 07508000
*              /*CALL CKERR*/                                      1903 07509000
*                RSCKERR = RSCKERR && RSCKERR;                     1903 07510000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1903 07511000
*                RSCKERN = RSE060;                                 1904 07512000
         MVC   RSCKERN(2,REG6),@CH01004                            1904 07513000
*                RSCKTERM = 'RETU';                                1905 07514000
         MVC   RSCKTERM(4,REG6),@CC03500                           1905 07515000
*                RSCKMVAR(1) = ADDR(RESVLSER);                     1906 07516000
*                                                                  1906 07517000
         L     @07,RSENTPT(,REG6)                                  1906 07518000
         LA    @07,RESVLSER(,@07)                                  1906 07519000
         ST    @07,RSCKMVAR(,REG6)                                 1906 07520000
*              /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR         */ 07521000
*              CALL CKERR;                                         1907 07522000
         L     @15,@CV03443                                        1907 07523000
         BALR  @14,@15                                             1907 07524000
*              END;                                                1908 07525000
*            END;                                                  1909 07526000
*        /************************************************************/ 07527000
*        /*                                                          */ 07528000
*        /*  CALL RSMFIND TO EXTRACT ALL SPACE HDRS FOR VOL RECORD   */ 07529000
*        /*                                                          */ 07530000
*        /************************************************************/ 07531000
*                                                                  1910 07532000
*        DO;                                                       1910 07533000
@RF01897 DS    0H                                                  1911 07534000
*          GRABBB = GRABCURR;                                      1911 07535000
         L     @07,RSGRABCU(,REG6)                                 1911 07536000
         L     @04,GRABCURR(,@07)                                  1911 07537000
         ST    @04,GRABBB(,@07)                                    1911 07538000
*          RSWGCODE = 6;               /*SPECIFY GROUP CODE          */ 07539000
         MVI   RSWGCODE(REG6),X'06'                                1912 07540000
*          RSWFONE = OFF;              /*FIND ALL OCCURRENCES        */ 07541000
         NI    RSWFONE(REG6),B'01111111'                           1913 07542000
*          /* CALL THE FIND SUBROUTINE */                          1914 07543000
*                                                                  1914 07544000
*        /* CALL TO MODULE IDCRS04 FOR PROCEDURE FIND                */ 07545000
*        CALL FIND;                                                1914 07546000
         L     @15,@CV03435                                        1914 07547000
         BALR  @14,@15                                             1914 07548000
*        END;      /*EXTRACT ALL SPC HDRS*/                        1915 07549000
*        /************************************************************/ 07550000
*        /*                                                          */ 07551000
*        /*  INITIALIZE END OF FILE AND REPOSITIONING FLAGS.         */ 07552000
*        /*                                                          */ 07553000
*        /************************************************************/ 07554000
*        RSVGTEOF = OFF;                                           1916 07555000
*        RSVREPOS = OFF;                                           1917 07556000
         NI    RSVGTEOF(REG6),B'00111111'                          1917 07557000
*        /************************************************************/ 07558000
*        /*                                                          */ 07559000
*        /*  IF NO RECORD FOUND INDICATOR RETURNED FROM FIND, SET    */ 07560000
*        /*  INVALID VOLUME RECORD FLAG  AND DO NOT PROCESS VOLUME.  */ 07561000
*        /*                                                          */ 07562000
*        /************************************************************/ 07563000
*        IF RSFNRF = ON | RSFENTLN = 0                             1918 07564000
*          THEN                                                    1918 07565000
         L     @07,RSWASNVT(,REG6)                                 1918 07566000
         TM    RSFNRF(@07),B'10000000'                             1918 07567000
         BO    @RT01918                                            1918 07568000
         CLI   RSFENTLN(@07),0                                     1918 07569000
         BNE   @RF01918                                            1918 07570000
@RT01918 DS    0H                                                  1919 07571000
*            DO;                                                   1919 07572000
*              RSBADVOL = ON;                                      1920 07573000
         OI    RSBADVOL(REG6),B'00000010'                          1920 07574000
*              RSVGTEOF = ON;                                      1921 07575000
         OI    RSVGTEOF(REG6),B'10000000'                          1921 07576000
*            END;                                                  1922 07577000
*        /************************************************************/ 07578000
*        /*                                                          */ 07579000
*        /*  PROCESS ALL VSAM OWNED FORMAT 1 DSCBS                   */ 07580000
*        /*                                                          */ 07581000
*        /************************************************************/ 07582000
*VOLCLP1:                                                          1923 07583000
*        DO WHILE (RSVGTEOF = OFF);                                1923 07584000
@RF01918 DS    0H                                                  1923 07585000
VOLCLP1  B     @DE01923                                            1923 07586000
@DL01923 DS    0H                                                  1924 07587000
*          IOCSPTR = RSVTIOCS;                                     1924 07588000
         L     @07,RSVTIOCS(,REG6)                                 1924 07589000
         ST    @07,IOCSPTR(,REG6)                                  1924 07590000
*        /************************************************************/ 07591000
*        /*                                                          */ 07592000
*        /*    SETUP IOCTTR AND ISSUE UPOSIT IF POSITIONING TO NEXT  */ 07593000
*        /*      DSCB IS NECESSARY                                   */ 07594000
*        /*                                                          */ 07595000
*        /************************************************************/ 07596000
*          IF RSVREPOS = ON                                        1925 07597000
*            THEN                                                  1925 07598000
         TM    RSVREPOS(REG6),B'01000000'                          1925 07599000
         BNO   @RF01925                                            1925 07600000
*              DO;                                                 1926 07601000
*                IOCTTR = RSVSVTTR;                                1927 07602000
         MVC   IOCTTR(4,@07),RSVSVTTR(REG6)                        1927 07603000
*                Z = 1;                                            1928 07604000
         MVI   Z(@07),X'01'                                        1928 07605000
*                CALL IDCIOPO0 (GDTTBL,IOCSPTR);                   1929 07606000
         ST    REG5,@AL00001                                       1929 07607000
         LA    @07,IOCSPTR(,REG6)                                  1929 07608000
         ST    @07,@AL00001+4                                      1929 07609000
         MVI   @AL00001+4,X'80'                                    1929 07610000
         L     @15,GDTPOS(,REG5)                                   1929 07611000
         LA    @01,@AL00001                                        1929 07612000
         BALR  @14,@15                                             1929 07613000
*                RESPECIFY RTNREG RSTD;                            1930 07614000
*                TESTRC = RTNREG;                                  1931 07615000
         STH   RTNREG,TESTRC(,REG6)                                1931 07616000
*                RESPECIFY RTNREG UNRSTD;                          1932 07617000
*                IF TESTRC ^= 0                                    1933 07618000
*                  THEN                                            1933 07619000
*                                                                  1933 07620000
         LH    @07,TESTRC(,REG6)                                   1933 07621000
         LTR   @07,@07                                             1933 07622000
         BZ    @RF01933                                            1933 07623000
*                    DO;                                           1934 07624000
*                    /*CALL CKERR*/                                1935 07625000
*                      RSCKERR = RSCKERR && RSCKERR;               1935 07626000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1935 07627000
*                      RSCKERN = RSE052;                           1936 07628000
         MVC   RSCKERN(2,REG6),@CH00989                            1936 07629000
*                      RSCKTERM = 'TERM';                          1937 07630000
*                                                                  1937 07631000
         MVC   RSCKTERM(4,REG6),@CC03527                           1937 07632000
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR   */ 07633000
*                    CALL CKERR;                                   1938 07634000
         L     @15,@CV03443                                        1938 07635000
         BALR  @14,@15                                             1938 07636000
*                    END;                                          1939 07637000
*              END;                                                1940 07638000
@RF01933 DS    0H                                                  1941 07639000
*        /************************************************************/ 07640000
*        /*                                                          */ 07641000
*        /*    SET NOTE BIT ON IN IOCSTR TO RETURN TTRZ OF RECORD    */ 07642000
*        /*      READ IN IOCTTR AND ISSUE UGET TO GET NEXT DSCB      */ 07643000
*        /*                                                          */ 07644000
*        /************************************************************/ 07645000
*          IOCMACNT = ON;                                          1941 07646000
@RF01925 L     @07,IOCSPTR(,REG6)                                  1941 07647000
         OI    IOCMACNT(@07),B'00000001'                           1941 07648000
*          CALL IDCIOGT0 (GDTTBL,IOCSPTR);                         1942 07649000
         ST    REG5,@AL00001                                       1942 07650000
         LA    @07,IOCSPTR(,REG6)                                  1942 07651000
         ST    @07,@AL00001+4                                      1942 07652000
         MVI   @AL00001+4,X'80'                                    1942 07653000
         L     @15,GDTGET(,REG5)                                   1942 07654000
         LA    @01,@AL00001                                        1942 07655000
         BALR  @14,@15                                             1942 07656000
*          RESPECIFY RTNREG RSTD;                                  1943 07657000
*          TESTRC = RTNREG;                                        1944 07658000
         STH   RTNREG,TESTRC(,REG6)                                1944 07659000
*          RESPECIFY RTNREG UNRSTD;                                1945 07660000
*        /************************************************************/ 07661000
*        /*                                                          */ 07662000
*        /*    IF END OF FILE ON VTOC, SET EOF BIT ON                */ 07663000
*        /*                                                          */ 07664000
*        /************************************************************/ 07665000
*          IF TESTRC = 16                                          1946 07666000
*            THEN                                                  1946 07667000
         LH    @07,TESTRC(,REG6)                                   1946 07668000
         C     @07,@CF00471                                        1946 07669000
         BNE   @RF01946                                            1946 07670000
*              RSVGTEOF = ON;                                      1947 07671000
         OI    RSVGTEOF(REG6),B'10000000'                          1947 07672000
*            ELSE                                                  1948 07673000
*        /************************************************************/ 07674000
*        /*                                                          */ 07675000
*        /*    CALL CKERR TO TERMINATE IF ERROR ON UGET OTHERWISE    */ 07676000
*        /*      SAVE TTRZ OF RECORD READ  AND SET NO REPOSITIONING  */ 07677000
*        /*                                                          */ 07678000
*        /************************************************************/ 07679000
*VOLCNEOF:                                                         1948 07680000
*              DO;                                                 1948 07681000
         B     @RC01946                                            1948 07682000
@RF01946 DS    0H                                                  1948 07683000
VOLCNEOF DS    0H                                                  1949 07684000
*                IF TESTRC ^= 0                                    1949 07685000
*                  THEN                                            1949 07686000
*                                                                  1949 07687000
         LH    @07,TESTRC(,REG6)                                   1949 07688000
         LTR   @07,@07                                             1949 07689000
         BZ    @RF01949                                            1949 07690000
*                    DO;                                           1950 07691000
*                    /*CALL CKERR*/                                1951 07692000
*                      RSCKERR = RSCKERR && RSCKERR;               1951 07693000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1951 07694000
*                      RSCKERN = RSE053;                           1952 07695000
         MVC   RSCKERN(2,REG6),@CH00991                            1952 07696000
*                      RSCKTERM = 'TERM';                          1953 07697000
*                                                                  1953 07698000
         MVC   RSCKTERM(4,REG6),@CC03527                           1953 07699000
*                    /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR   */ 07700000
*                    CALL CKERR;                                   1954 07701000
         L     @15,@CV03443                                        1954 07702000
         BALR  @14,@15                                             1954 07703000
*                    END;                                          1955 07704000
*                RSVSVTTR = IOCTTR;                                1956 07705000
@RF01949 L     @07,IOCSPTR(,REG6)                                  1956 07706000
         MVC   RSVSVTTR(4,REG6),IOCTTR(@07)                        1956 07707000
*                RSVREPOS = OFF;                                   1957 07708000
         NI    RSVREPOS(REG6),B'10111111'                          1957 07709000
*        /************************************************************/ 07710000
*        /*                                                          */ 07711000
*        /*    FOR VSAM OWNED FORMAT 1 DSCB'S, SAVE DSN  & VOL INFO  */ 07712000
*        /*      DO NOT PROCESS ANY UNIQUE DATA SETS                 */ 07713000
*        /*                                                          */ 07714000
*        /************************************************************/ 07715000
*                IF FMT1ID = DSCB1ID & FMT1VSAM = ON THEN          1958 07716000
         L     @07,IOCDAD(,@07)                                    1958 07717000
         CLC   FMT1ID(1,@07),DSCB1ID                               1958 07718000
         BNE   @RF01958                                            1958 07719000
         TM    FMT1VSAM(@07),B'00001000'                           1958 07720000
         BNO   @RF01958                                            1958 07721000
*                  IF FMT1NAME(1:7) = NOUNIQ THEN                  1959 07722000
         CLC   FMT1NAME(7,@07),@CC00846                            1959 07723000
         BNE   @RF01959                                            1959 07724000
*VOLCNUNQ:                                                         1960 07725000
*                    DO;                                           1960 07726000
VOLCNUNQ DS    0H                                                  1961 07727000
*                      RSVF1EXT = ''B;                             1961 07728000
         XC    RSVF1EXT(64,REG6),RSVF1EXT(REG6)                    1961 07729000
*                      RSVSCRPT = ADDR(RSSCRLST);                  1962 07730000
         L     @07,RSIOTBL(,REG6)                                  1962 07731000
         LA    @07,RSSCRLST(,@07)                                  1962 07732000
         ST    @07,RSVSCRPT(,REG6)                                 1962 07733000
*                      RFY UVOLLIST BASED(RSVSCRPT);               1963 07734000
*                      RSVEXTS = FMT1NEXT;  /*SAVE NUM EXTS*/      1964 07735000
         L     @04,IOCSPTR(,REG6)                                  1964 07736000
         L     @15,IOCDAD(,@04)                                    1964 07737000
         SLR   @14,@14                                             1964 07738000
         IC    @14,FMT1NEXT(,@15)                                  1964 07739000
         STC   @14,RSVEXTS(,REG6)                                  1964 07740000
*                      RSVSCRNM = FMT1NAME;                        1965 07741000
         MVC   RSVSCRNM(44,REG6),FMT1NAME(@15)                     1965 07742000
*                      UVOLCNT = 1;                                1966 07743000
         MVC   UVOLCNT(2,@07),@CH00212                             1966 07744000
*                      UVOLDEV(1) = RTDEVUCB;                      1967 07745000
         L     @01,RSGRABCU(,REG6)                                 1967 07746000
         L     @01,GRABCURR(,@01)                                  1967 07747000
         MVC   UVOLDEV(4,@07),RTDEVUCB(@01)                        1967 07748000
*                      UVOLVOL(1) = RESVLSER;                      1968 07749000
         L     @01,RSENTPT(,REG6)                                  1968 07750000
         MVC   UVOLVOL(6,@07),RESVLSER(@01)                        1968 07751000
*        /************************************************************/ 07752000
*        /*                                                          */ 07753000
*        /*    CALL CONVERSION RTN TO CONVERT EXTENTS IN FORMAT 1    */ 07754000
*        /*      DSCB TO TTNN'S                                      */ 07755000
*        /*                                                          */ 07756000
*        /************************************************************/ 07757000
*                      RSCIOCS = IOCSPTR;  /*PTR TO IOCSTR*/       1969 07758000
         ST    @04,RSCIOCS(,REG6)                                  1969 07759000
*                      IF RSVEXTS < 3                              1970 07760000
*                        THEN                                      1970 07761000
         CLI   RSVEXTS(REG6),3                                     1970 07762000
         BNL   @RF01970                                            1970 07763000
*                          RSIDX1 = RSVEXTS; /*SET LIMIT TO NO. OF   */ 07764000
         STH   @14,RSIDX1(,REG6)                                   1971 07765000
*                                      /* EXTENTS RETURNED           */ 07766000
*                        ELSE                                      1972 07767000
*                          RSIDX1 = DIM(FMT1EXTS); /*SET LIMIT TO    */ 07768000
         B     @RC01970                                            1972 07769000
@RF01970 MVC   RSIDX1(2,REG6),@CH00158                             1972 07770000
*                                      /* NO. OF EXTENTS IN F1DSCB   */ 07771000
*                      DO RSIDX =1 TO RSIDX1;                      1973 07772000
@RC01970 LA    @07,1                                               1973 07773000
         B     @DE01973                                            1973 07774000
@DL01973 DS    0H                                                  1974 07775000
*                        RSCCHHP = ADDR(FMT1CCHH(RSIDX));          1974 07776000
         LH    @07,RSIDX(,REG6)                                    1974 07777000
         MH    @07,@CH00034                                        1974 07778000
         L     @04,IOCSPTR(,REG6)                                  1974 07779000
         L     @04,IOCDAD(,@04)                                    1974 07780000
         LA    @07,FMT1CCHH-10(@07,@04)                            1974 07781000
         ST    @07,RSCCHHP(,REG6)                                  1974 07782000
*                        RSCFINN = ON;   /*RETURN NN*/             1975 07783000
         OI    RSCFINN(REG6),B'10000000'                           1975 07784000
*                        /* CALL TO MODULE IDCRS07 FOR PROCEDURE CNVTCC 07785000
*H                                                                   */ 07786000
*                        CALL CNVTCCHH;                            1976 07787000
         L     @15,@CV03460                                        1976 07788000
         BALR  @14,@15                                             1976 07789000
*                        RSVF1TTN(RSIDX) = RSTTNN;                 1977 07790000
         LH    @07,RSIDX(,REG6)                                    1977 07791000
         SLA   @07,2                                               1977 07792000
         ALR   @07,REG6                                            1977 07793000
         MVC   RSVF1TTN-4(4,@07),RSTTNN(REG6)                      1977 07794000
*                        RSCFINN = OFF;                            1978 07795000
         NI    RSCFINN(REG6),B'01111111'                           1978 07796000
*                      END;                                        1979 07797000
         LA    @07,1                                               1979 07798000
         AH    @07,RSIDX(,REG6)                                    1979 07799000
@DE01973 STH   @07,RSIDX(,REG6)                                    1979 07800000
         CH    @07,RSIDX1(,REG6)                                   1979 07801000
         BNH   @DL01973                                            1979 07802000
*        /************************************************************/ 07803000
*        /*                                                          */ 07804000
*        /*    ISSUE UPOSIT AND UGET FOR FORMAT 3 DSCB IF ONE.       */ 07805000
*        /*      CALL CKERR TO TERMINATE IF ANY ERRORS               */ 07806000
*        /*                                                          */ 07807000
*        /************************************************************/ 07808000
*                      IF FMT1PTR ^= FMT3NULL                      1980 07809000
*                        THEN                                      1980 07810000
         L     @07,IOCSPTR(,REG6)                                  1980 07811000
         L     @07,IOCDAD(,@07)                                    1980 07812000
         CLC   FMT1PTR(5,@07),FMT3NULL                             1980 07813000
         BE    @RF01980                                            1980 07814000
*                          DO;                                     1981 07815000
*        /************************************************************/ 07816000
*        /*                                                          */ 07817000
*        /*    CALL CONVERSION RTN TO CONVERT F3 DSCB PTR TO TT.     */ 07818000
*        /*    SET UP TTR0 IN IOCTTR.                                */ 07819000
*        /*                                                          */ 07820000
*        /************************************************************/ 07821000
*                            RSCCHHP = ADDR(FMT1PTR);              1982 07822000
         LA    @07,FMT1PTR(,@07)                                   1982 07823000
         ST    @07,RSCCHHP(,REG6)                                  1982 07824000
*                            /* CALL TO MODULE IDCRS07 FOR PROCEDURE CN 07825000
*TCCHH                                                               */ 07826000
*                            CALL CNVTCCHH;                        1983 07827000
         L     @15,@CV03460                                        1983 07828000
         BALR  @14,@15                                             1983 07829000
*                            TT = RSTT - RSVF4TT;                  1984 07830000
         L     @07,IOCSPTR(,REG6)                                  1984 07831000
         LH    @04,RSTT(,REG6)                                     1984 07832000
         SH    @04,RSVF4TT(,REG6)                                  1984 07833000
         STH   @04,TT(,@07)                                        1984 07834000
*                            R = FMT1PTR(5:5);                     1985 07835000
         L     @04,IOCDAD(,@07)                                    1985 07836000
         MVC   R(1,@07),FMT1PTR+4(@04)                             1985 07837000
*                            Z = 0;                                1986 07838000
         MVI   Z(@07),X'00'                                        1986 07839000
*                            RSVREPOS = ON;                        1987 07840000
         OI    RSVREPOS(REG6),B'01000000'                          1987 07841000
*                            CALL IDCIOPO0 (GDTTBL,IOCSPTR);       1988 07842000
         ST    REG5,@AL00001                                       1988 07843000
         LA    @07,IOCSPTR(,REG6)                                  1988 07844000
         ST    @07,@AL00001+4                                      1988 07845000
         MVI   @AL00001+4,X'80'                                    1988 07846000
         L     @15,GDTPOS(,REG5)                                   1988 07847000
         LA    @01,@AL00001                                        1988 07848000
         BALR  @14,@15                                             1988 07849000
*                            RESPECIFY RTNREG RSTD;                1989 07850000
*                            TESTRC = RTNREG;                      1990 07851000
         STH   RTNREG,TESTRC(,REG6)                                1990 07852000
*                            RESPECIFY RTNREG UNRSTD;              1991 07853000
*                            IF TESTRC ^= 0                        1992 07854000
*                              THEN                                1992 07855000
*                                                                  1992 07856000
         LH    @07,TESTRC(,REG6)                                   1992 07857000
         LTR   @07,@07                                             1992 07858000
         BZ    @RF01992                                            1992 07859000
*                                DO;                               1993 07860000
*                                /*CALL CKERR*/                    1994 07861000
*                                  RSCKERR = RSCKERR && RSCKERR;   1994 07862000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      1994 07863000
*                                  RSCKERN = RSE052;               1995 07864000
         MVC   RSCKERN(2,REG6),@CH00989                            1995 07865000
*                                  RSCKTERM = 'TERM';              1996 07866000
*                                                                  1996 07867000
         MVC   RSCKTERM(4,REG6),@CC03527                           1996 07868000
*                                /* CALL TO MODULE IDCRS05 FOR PROCEDUR 07869000
* CKERR                                                              */ 07870000
*                                CALL CKERR;                       1997 07871000
         L     @15,@CV03443                                        1997 07872000
         BALR  @14,@15                                             1997 07873000
*                                END;                              1998 07874000
*                            IOCMACNT = OFF;                       1999 07875000
@RF01992 L     @07,IOCSPTR(,REG6)                                  1999 07876000
         NI    IOCMACNT(@07),B'11111110'                           1999 07877000
*                            CALL IDCIOGT0 (GDTTBL,IOCSPTR);       2000 07878000
         ST    REG5,@AL00001                                       2000 07879000
         LA    @07,IOCSPTR(,REG6)                                  2000 07880000
         ST    @07,@AL00001+4                                      2000 07881000
         MVI   @AL00001+4,X'80'                                    2000 07882000
         L     @15,GDTGET(,REG5)                                   2000 07883000
         LA    @01,@AL00001                                        2000 07884000
         BALR  @14,@15                                             2000 07885000
*                            RESPECIFY RTNREG RSTD;                2001 07886000
*                            TESTRC = RTNREG;                      2002 07887000
         STH   RTNREG,TESTRC(,REG6)                                2002 07888000
*                            RESPECIFY RTNREG UNRSTD;              2003 07889000
*                            IF TESTRC ^= 0                        2004 07890000
*                              THEN                                2004 07891000
*                                                                  2004 07892000
         LH    @07,TESTRC(,REG6)                                   2004 07893000
         LTR   @07,@07                                             2004 07894000
         BZ    @RF02004                                            2004 07895000
*                                DO;                               2005 07896000
*                                /*CALL CKERR*/                    2006 07897000
*                                  RSCKERR = RSCKERR && RSCKERR;   2006 07898000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2006 07899000
*                                  RSCKERN = RSE053;               2007 07900000
         MVC   RSCKERN(2,REG6),@CH00991                            2007 07901000
*                                  RSCKTERM = 'TERM';              2008 07902000
*                                                                  2008 07903000
         MVC   RSCKTERM(4,REG6),@CC03527                           2008 07904000
*                                /* CALL TO MODULE IDCRS05 FOR PROCEDUR 07905000
* CKERR                                                              */ 07906000
*                                CALL CKERR;                       2009 07907000
         L     @15,@CV03443                                        2009 07908000
         BALR  @14,@15                                             2009 07909000
*                                END;                              2010 07910000
*        /************************************************************/ 07911000
*        /*                                                          */ 07912000
*        /*    CALL CONVERSION RTN TO CONVERT F3 EXTENTS TO TTNN'S   */ 07913000
*        /*                                                          */ 07914000
*        /************************************************************/ 07915000
*                            RSCIOCS = IOCSPTR;                    2011 07916000
@RF02004 L     @07,IOCSPTR(,REG6)                                  2011 07917000
         ST    @07,RSCIOCS(,REG6)                                  2011 07918000
*                            IF RSVEXTS < 7                        2012 07919000
*                              THEN                                2012 07920000
         CLI   RSVEXTS(REG6),7                                     2012 07921000
         BNL   @RF02012                                            2012 07922000
*                                RSIDX1 = RSVEXTS - 3; /*SET LIMIT TO*/ 07923000
         SLR   @07,@07                                             2013 07924000
         IC    @07,RSVEXTS(,REG6)                                  2013 07925000
         SL    @07,@CF00158                                        2013 07926000
         STH   @07,RSIDX1(,REG6)                                   2013 07927000
*                                      /* NO. OF EXTENTS RETURNED    */ 07928000
*                              ELSE                                2014 07929000
*                                RSIDX1 = DIM(FMT3EXTA); /*SET LIMIT */ 07930000
         B     @RC02012                                            2014 07931000
@RF02012 MVC   RSIDX1(2,REG6),@CH00038                             2014 07932000
*                                      /* TO NO. OF EXTENTS IN FIRST */ 07933000
*                                      /* PART OF F3DSCB             */ 07934000
*                            DO RSIDX = 1 TO RSIDX1;               2015 07935000
@RC02012 LA    @07,1                                               2015 07936000
         B     @DE02015                                            2015 07937000
@DL02015 DS    0H                                                  2016 07938000
*                              RSCCHHP = ADDR(FMT3CCHA(RSIDX));    2016 07939000
         LH    @07,RSIDX(,REG6)                                    2016 07940000
         MH    @07,@CH00034                                        2016 07941000
         L     @04,IOCSPTR(,REG6)                                  2016 07942000
         L     @04,IOCDAD(,@04)                                    2016 07943000
         AL    @04,@CF03727                                        2016 07944000
         LA    @07,FMT3CCHA-6(@07,@04)                             2016 07945000
         ST    @07,RSCCHHP(,REG6)                                  2016 07946000
*                              RSCFINN = ON;   /*RETURN NN*/       2017 07947000
         OI    RSCFINN(REG6),B'10000000'                           2017 07948000
*                              /* CALL TO MODULE IDCRS07 FOR PROCEDURE  07949000
*NVTCCHH                                                             */ 07950000
*                              CALL CNVTCCHH;                      2018 07951000
         L     @15,@CV03460                                        2018 07952000
         BALR  @14,@15                                             2018 07953000
*                              RSVF1TTN(RSIDX + 3) = RSTTNN;       2019 07954000
         LH    @07,RSIDX(,REG6)                                    2019 07955000
         SLA   @07,2                                               2019 07956000
         ALR   @07,REG6                                            2019 07957000
         MVC   RSVF1TTN+8(4,@07),RSTTNN(REG6)                      2019 07958000
*                              RSCFINN = OFF;                      2020 07959000
         NI    RSCFINN(REG6),B'01111111'                           2020 07960000
*                            END;                                  2021 07961000
         LA    @07,1                                               2021 07962000
         AH    @07,RSIDX(,REG6)                                    2021 07963000
@DE02015 STH   @07,RSIDX(,REG6)                                    2021 07964000
         CH    @07,RSIDX1(,REG6)                                   2021 07965000
         BNH   @DL02015                                            2021 07966000
*                            IF RSVEXTS > 7                        2022 07967000
*                              THEN                                2022 07968000
         CLI   RSVEXTS(REG6),7                                     2022 07969000
         BNH   @RF02022                                            2022 07970000
*                                DO RSIDX = 1 TO RSVEXTS - 7;      2023 07971000
         LA    @07,1                                               2023 07972000
         B     @DE02023                                            2023 07973000
@DL02023 DS    0H                                                  2024 07974000
*                                  RSCCHHP = ADDR(FMT3CCHB(RSIDX));     07975000
         LH    @07,RSIDX(,REG6)                                    2024 07976000
         MH    @07,@CH00034                                        2024 07977000
         L     @04,IOCSPTR(,REG6)                                  2024 07978000
         L     @04,IOCDAD(,@04)                                    2024 07979000
         LA    @07,FMT3CCHB-10(@07,@04)                            2024 07980000
         ST    @07,RSCCHHP(,REG6)                                  2024 07981000
*                                  RSCFINN = ON;  /*RETURN NN*/    2025 07982000
         OI    RSCFINN(REG6),B'10000000'                           2025 07983000
*                                  /* CALL TO MODULE IDCRS07 FOR PROCED 07984000
*RE CNVTCCHH                                                         */ 07985000
*                                  CALL CNVTCCHH;                  2026 07986000
         L     @15,@CV03460                                        2026 07987000
         BALR  @14,@15                                             2026 07988000
*                                  RSVF1TTN(RSIDX + 7) = RSTTNN;   2027 07989000
         LH    @07,RSIDX(,REG6)                                    2027 07990000
         SLA   @07,2                                               2027 07991000
         ALR   @07,REG6                                            2027 07992000
         MVC   RSVF1TTN+24(4,@07),RSTTNN(REG6)                     2027 07993000
*                                  RSCFINN = OFF;                  2028 07994000
         NI    RSCFINN(REG6),B'01111111'                           2028 07995000
*                                END;                              2029 07996000
         LA    @07,1                                               2029 07997000
         AH    @07,RSIDX(,REG6)                                    2029 07998000
@DE02023 STH   @07,RSIDX(,REG6)                                    2029 07999000
         SLR   @04,@04                                             2029 08000000
         IC    @04,RSVEXTS(,REG6)                                  2029 08001000
         SL    @04,@CF00482                                        2029 08002000
         CR    @07,@04                                             2029 08003000
         BNH   @DL02023                                            2029 08004000
*                          END;                                    2030 08005000
@RF02022 DS    0H                                                  2031 08006000
*        /************************************************************/ 08007000
*        /*                                                          */ 08008000
*        /*    SCAN SNTABS TO LOCATE SPACE HEADER FOR THIS F1DSCB.   */ 08009000
*        /*    COMPARE THE TIMESTAMP FROM THE F1DSCB NAME TO THE     */ 08010000
*        /*    TIMESTAMP IN EACH SNTAB.                              */ 08011000
*        /*                                                          */ 08012000
*        /************************************************************/ 08013000
*                      RSFAENT = RSFCADR;                          2031 08014000
@RF01980 L     @07,RSWASNVT(,REG6)                                 2031 08015000
         L     @04,RSFCADR(,@07)                                   2031 08016000
         ST    @04,RSFAENT(,@07)                                   2031 08017000
*        /************************************************************/ 08018000
*        /*                                                          */ 08019000
*        /*  EXTRACT THE 14 TIMESTAMP EBCDIC DIGITS FROM THE F1DSCB  */ 08020000
*        /*  NAME AND PAD AT END WITH AN EBCDIC 0.                   */ 08021000
*        /*                                                          */ 08022000
*        /************************************************************/ 08023000
*                      RSVF1TS1 = F1TS1;                           2032 08024000
         MVC   RSVF1TS1(7,REG6),F1TS1(REG6)                        2032 08025000
*                      RSVF1TS2 = F1TS2;                           2033 08026000
         MVC   RSVF1TS2(7,REG6),F1TS2(REG6)                        2033 08027000
*                      RSVF1PAD = DIG0;                            2034 08028000
         MVI   RSVF1PAD(REG6),C'0'                                 2034 08029000
*        /************************************************************/ 08030000
*        /*                                                          */ 08031000
*        /*  CHANGE C1-C6 (A-F) TO CA-CF FOR CONVERSION PURPOSES     */ 08032000
*        /*                                                          */ 08033000
*        /************************************************************/ 08034000
*VOLCLP2:                                                          2035 08035000
*                      DO RSIDX1 = 1 TO DIM(F1TSCNVT);             2035 08036000
VOLCLP2  LA    @07,1                                               2035 08037000
         STH   @07,RSIDX1(,REG6)                                   2035 08038000
@DL02035 DS    0H                                                  2036 08039000
*                        IF F1TSZNE(RSIDX1) = CZONE                2036 08040000
*                          THEN                                    2036 08041000
         LH    @07,RSIDX1(,REG6)                                   2036 08042000
         ALR   @07,REG6                                            2036 08043000
         TM    F1TSZNE-1(@07),B'11000000'                          2036 08044000
         BNO   @RF02036                                            2036 08045000
         TM    F1TSZNE-1(@07),B'00110000'                          2036 08046000
         BNZ   @RF02036                                            2036 08047000
*                            F1TSFIX(RSIDX1) = F1TSFIX(RSIDX1)     2037 08048000
*                                + EBCCNV;                         2037 08049000
         LH    @07,RSIDX1(,REG6)                                   2037 08050000
         LA    @04,9                                               2037 08051000
         SLR   @15,@15                                             2037 08052000
         IC    @15,F1TSFIX-1(@07,REG6)                             2037 08053000
         ALR   @04,@15                                             2037 08054000
         STC   @04,F1TSFIX-1(@07,REG6)                             2037 08055000
*                      END VOLCLP2;                                2038 08056000
@RF02036 LA    @07,1                                               2038 08057000
         AH    @07,RSIDX1(,REG6)                                   2038 08058000
         STH   @07,RSIDX1(,REG6)                                   2038 08059000
         C     @07,@CF00631                                        2038 08060000
         BNH   @DL02035                                            2038 08061000
*        /************************************************************/ 08062000
*        /*                                                          */ 08063000
*        /*  CONVERT EBCDIC STRING TO PACKED HEX                     */ 08064000
*        /*                                                          */ 08065000
*        /************************************************************/ 08066000
*                      PACK (RSVF1CTS,RSVF1TS);                    2039 08067000
         PACK  RSVF1CTS(8,REG6),RSVF1TS(15,REG6)                   2039 08068000
*                      RSVF1CTS(8:8) = NULLDIG;                    2040 08069000
         MVC   RSVF1CTS+7(1,REG6),NULLDIG                          2040 08070000
*        /************************************************************/ 08071000
*        /*                                                          */ 08072000
*        /*  SCAN THE SNTABS FOR THIS TIMESTAMP                      */ 08073000
*        /*                                                          */ 08074000
*        /************************************************************/ 08075000
*VOLCLP3:              DO RSFCNDX = 1 TO RSFHNDX                   2041 08076000
*                        WHILE(RSVF1CTS ^= SDSCBTS);               2041 08077000
VOLCLP3  LA    @07,1                                               2041 08078000
         B     @DE02041                                            2041 08079000
@DL02041 L     @07,RSWASNVT(,REG6)                                 2041 08080000
         L     @04,RSFAENT(,@07)                                   2041 08081000
         CLC   RSVF1CTS(8,REG6),SDSCBTS(@04)                       2041 08082000
         BE    @DC02041                                            2041 08083000
*                        RSFAENT = RSFAENT + RSFENTLN;             2042 08084000
         SLR   @15,@15                                             2042 08085000
         IC    @15,RSFENTLN(,@07)                                  2042 08086000
         ALR   @04,@15                                             2042 08087000
         ST    @04,RSFAENT(,@07)                                   2042 08088000
*                      END VOLCLP3;                                2043 08089000
         L     @04,RSWASNVT(,REG6)                                 2043 08090000
         LA    @07,1                                               2043 08091000
         AH    @07,RSFCNDX(,@04)                                   2043 08092000
@DE02041 L     @04,RSWASNVT(,REG6)                                 2043 08093000
         STH   @07,RSFCNDX(,@04)                                   2043 08094000
         L     @04,RSWASNVT(,REG6)                                 2043 08095000
         CH    @07,RSFHNDX(,@04)                                   2043 08096000
         BNH   @DL02041                                            2043 08097000
@DC02041 DS    0H                                                  2044 08098000
*        /************************************************************/ 08099000
*        /*                                                          */ 08100000
*        /*    CALL SCRATCHP TO SCRATCH DSCB IF NO SPACE HEADER      */ 08101000
*        /*      EXISTS FOR IT                                       */ 08102000
*        /*                                                          */ 08103000
*        /************************************************************/ 08104000
*                      IF RSVF1CTS ^= SDSCBTS                      2044 08105000
*                        THEN                                      2044 08106000
         L     @07,RSWASNVT(,REG6)                                 2044 08107000
         L     @07,RSFAENT(,@07)                                   2044 08108000
         CLC   RSVF1CTS(8,REG6),SDSCBTS(@07)                       2044 08109000
         BE    @RF02044                                            2044 08110000
*                          DO;                                     2045 08111000
*                                                                  2045 08112000
*                            DO;                                   2046 08113000
*                            /*CALL CKERR*/                        2047 08114000
*                              RSCKERR = RSCKERR && RSCKERR;       2047 08115000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2047 08116000
*                              RSCKERN = RSE054;                   2048 08117000
         MVC   RSCKERN(2,REG6),@CH00993                            2048 08118000
*                              RSCKTERM = 'RETU';                  2049 08119000
         MVC   RSCKTERM(4,REG6),@CC03500                           2049 08120000
*                              RSCKMVAR(1) = ADDR(RSVSCRNM);       2050 08121000
*                                                                  2050 08122000
         LA    @07,RSVSCRNM(,REG6)                                 2050 08123000
         ST    @07,RSCKMVAR(,REG6)                                 2050 08124000
*                            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CK 08125000
*RR                                                                  */ 08126000
*                            CALL CKERR;                           2051 08127000
         L     @15,@CV03443                                        2051 08128000
         BALR  @14,@15                                             2051 08129000
*                            END;                                  2052 08130000
*                            /* CALL TO MODULE IDCRS07 FOR PROCEDURE SC 08131000
*ATCHP                                                               */ 08132000
*                            CALL IDCRS7SP(RSVSCRNM,RSVSCRPT);     2053 08133000
         LA    @07,RSVSCRNM(,REG6)                                 2053 08134000
         ST    @07,@AL00001                                        2053 08135000
         LA    @07,RSVSCRPT(,REG6)                                 2053 08136000
         ST    @07,@AL00001+4                                      2053 08137000
         L     @15,@CV03462                                        2053 08138000
         LA    @01,@AL00001                                        2053 08139000
         BALR  @14,@15                                             2053 08140000
*                            RESPECIFY RTNREG RSTD;                2054 08141000
*                            TESTRC = RTNREG;                      2055 08142000
         STH   RTNREG,TESTRC(,REG6)                                2055 08143000
*                            RESPECIFY RTNREG UNRSTD;              2056 08144000
*                            IF TESTRC ^= 0                        2057 08145000
*                              THEN                                2057 08146000
*                                                                  2057 08147000
         LH    @07,TESTRC(,REG6)                                   2057 08148000
         LTR   @07,@07                                             2057 08149000
         BZ    @RF02057                                            2057 08150000
*                               DO;                                2058 08151000
*                               /*CALL CKERR*/                     2059 08152000
*                                 RSCKERR = RSCKERR && RSCKERR;    2059 08153000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2059 08154000
*                                 RSCKERN = RSE059;                2060 08155000
         MVC   RSCKERN(2,REG6),@CH01002                            2060 08156000
*                                 RSCKTERM = 'RETU';               2061 08157000
         MVC   RSCKTERM(4,REG6),@CC03500                           2061 08158000
*                                 RSCKMVAR(1) = ADDR(RSVSCRNM);    2062 08159000
*                                                                  2062 08160000
         LA    @07,RSVSCRNM(,REG6)                                 2062 08161000
         ST    @07,RSCKMVAR(,REG6)                                 2062 08162000
*                               /* CALL TO MODULE IDCRS05 FOR PROCEDURE 08163000
*CKERR                                                               */ 08164000
*                               CALL CKERR;                        2063 08165000
         L     @15,@CV03443                                        2063 08166000
         BALR  @14,@15                                             2063 08167000
*                               END;                               2064 08168000
*                          END;                                    2065 08169000
*                        ELSE                                      2066 08170000
*                          DO;                             /*@ZA18274*/ 08171000
         B     @RC02044                                            2066 08172000
@RF02044 DS    0H                                                  2067 08173000
*        /************************************************************/ 08174000
*        /*                                                /*@ZA18274*/ 08175000
*        /*    IF THIS IS A DATA SPACE CONTAINING AN OLD CATALOG,    */ 08176000
*        /*      CLEAR THE CATALOG INDICATOR IN THE SPACE HEADER     */ 08177000
*        /*      AND SAVE THE F1DSCB INFORMATION FOR LATER RENAMING  */ 08178000
*        /*                                                /*@ZA18274*/ 08179000
*        /************************************************************/ 08180000
*                            IF UVOLVOL(1) ^= RSINVLSR &           2067 08181000
*                               SNVSPCAT = ON THEN DO;     /*@ZA18274*/ 08182000
         L     @07,RSVSCRPT(,REG6)                                 2067 08183000
         CLC   UVOLVOL(6,@07),RSINVLSR(REG6)                       2067 08184000
         BE    @RF02067                                            2067 08185000
         L     @07,RSWASNVT(,REG6)                                 2067 08186000
         L     @07,RSFAENT(,@07)                                   2067 08187000
         TM    SNVSPCAT(@07),B'00001000'                           2067 08188000
         BNO   @RF02067                                            2067 08189000
*                              SNVSPCAT = OFF;             /*@ZA18274*/ 08190000
         NI    SNVSPCAT(@07),B'11110111'                           2069 08191000
*                              /* CALL TO MODULE IDCRS04 FOR PROCEDURE  08192000
*ODGO                                                                */ 08193000
*                              CALL MODGO;              /*@ZA18274*/    08194000
         L     @15,@CV03433                                        2070 08195000
         BALR  @14,@15                                             2070 08196000
*                              RSVWFUPD = ON;              /*@ZA18274*/ 08197000
         OI    RSVWFUPD(REG6),B'00100000'                          2071 08198000
*                              IF (RSVSCRNM(1:7) = NOUNIQ) &       2072 08199000
*                               (RSVSCRNM(8) = '4' | RSVSCRNM(8) = '6') 08200000
*                               THEN DO;                   /*@ZA18274*/ 08201000
         CLC   RSVSCRNM(7,REG6),@CC00846                           2072 08202000
         BNE   @RF02072                                            2072 08203000
         CLI   RSVSCRNM+7(REG6),C'4'                               2072 08204000
         BE    @RT02072                                            2072 08205000
         CLI   RSVSCRNM+7(REG6),C'6'                               2072 08206000
         BNE   @RF02072                                            2072 08207000
@RT02072 DS    0H                                                  2073 08208000
*                                CALL IDCSAGP0(GDTTBL,LENGTH(RSF1RNTB), 08209000
*  RSF1RNCU,POOL2,SETZERO);                                /*@ZA18274*/ 08210000
         MVC   @AL00001+4(16),@AL02074                             2074 08211000
         ST    REG5,@AL00001                                       2074 08212000
         LA    @07,RSF1RNCU(,REG6)                                 2074 08213000
         ST    @07,@AL00001+8                                      2074 08214000
         L     @15,GDTGPL(,REG5)                                   2074 08215000
         LA    @01,@AL00001                                        2074 08216000
         BALR  @14,@15                                             2074 08217000
*                                RESPECIFY RTNREG RSTD;            2075 08218000
*                                TESTRC = RTNREG;                  2076 08219000
         STH   RTNREG,TESTRC(,REG6)                                2076 08220000
*                                RESPECIFY RTNREG UNRSTD;  /*@ZA18274*/ 08221000
*                                IF TESTRC ^= 0 THEN               2078 08222000
*                                                                  2078 08223000
         LH    @07,TESTRC(,REG6)                                   2078 08224000
         LTR   @07,@07                                             2078 08225000
         BZ    @RF02078                                            2078 08226000
*                                  DO;                             2079 08227000
*                                  /*CALL CKERR*/                  2080 08228000
*                                    RSCKERR = RSCKERR && RSCKERR; 2080 08229000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2080 08230000
*                                    RSCKERN = RSE099;             2081 08231000
         MVC   RSCKERN(2,REG6),@CH01078                            2081 08232000
*                                    RSCKTERM = 'TERM';            2082 08233000
*                                                                  2082 08234000
         MVC   RSCKTERM(4,REG6),@CC03527                           2082 08235000
*                                  /* CALL TO MODULE IDCRS05 FOR PROCED 08236000
*RE CKERR                                                            */ 08237000
*                                  CALL CKERR;                     2083 08238000
         L     @15,@CV03443                                        2083 08239000
         BALR  @14,@15                                             2083 08240000
*                                  END;/*@ZA18274*/                2084 08241000
*                                RSF1RNNX = RSF1RNAM;      /*@ZA18274*/ 08242000
@RF02078 L     @07,RSF1RNCU(,REG6)                                 2085 08243000
         L     @04,RSF1RNAM(,REG6)                                 2085 08244000
         ST    @04,RSF1RNNX(,@07)                                  2085 08245000
*                                RSF1RNAM = RSF1RNCU;      /*@ZA18274*/ 08246000
         ST    @07,RSF1RNAM(,REG6)                                 2086 08247000
*                                RSF1RNVL = UVOLVOL(1);    /*@ZA18274*/ 08248000
         L     @04,RSVSCRPT(,REG6)                                 2087 08249000
         MVC   RSF1RNVL(6,@07),UVOLVOL(@04)                        2087 08250000
*                                RSF1RNDV = UVOLDEV(1);    /*@ZA18274*/ 08251000
         MVC   RSF1RNDV(4,@07),UVOLDEV(@04)                        2088 08252000
*                                RSF1RNNM = RSVSCRNM;      /*@ZA18274*/ 08253000
         MVC   RSF1RNNM(44,@07),RSVSCRNM(REG6)                     2089 08254000
*                              END;                        /*@ZA18274*/ 08255000
*                            END;                          /*@ZA18274*/ 08256000
*                                                                  2091 08257000
@RF02072 DS    0H                                                  2092 08258000
*        /************************************************************/ 08259000
*        /*                                                          */ 08260000
*        /*    IF EXTENTS IN SPACE HEADER NOT EQUAL TO EXTENTS IN    */ 08261000
*        /*      DSCB, THEN CORRECT SPC HDR WITH EXTENTS FROM DSCB   */ 08262000
*        /*                                                          */ 08263000
*        /************************************************************/ 08264000
*                            IF SSPEXTNT ^= RSVF1EXT               2092 08265000
*                              THEN                                2092 08266000
@RF02067 L     @07,RSWASNVT(,REG6)                                 2092 08267000
         L     @07,RSFAENT(,@07)                                   2092 08268000
         CLC   SSPEXTNT(64,@07),RSVF1EXT(REG6)                     2092 08269000
         BE    @RF02092                                            2092 08270000
*                                DO;                               2093 08271000
*                                  SNODSPXT = RSVEXTS;             2094 08272000
         IC    @04,RSVEXTS(,REG6)                                  2094 08273000
         STC   @04,SNODSPXT(,@07)                                  2094 08274000
*                                  SSPEXTNT = RSVF1EXT;            2095 08275000
         MVC   SSPEXTNT(64,@07),RSVF1EXT(REG6)                     2095 08276000
*                                  /* CALL TO MODULE IDCRS04 FOR PROCED 08277000
*RE MODGO                                                            */ 08278000
*                                  CALL MODGO;                     2096 08279000
         L     @15,@CV03433                                        2096 08280000
         BALR  @14,@15                                             2096 08281000
*                                  RSVWFUPD = ON;                  2097 08282000
         OI    RSVWFUPD(REG6),B'00100000'                          2097 08283000
*                                             /*UPDATE WF VOL RECORD*/  08284000
*                                                                  2098 08285000
*                                  DO;                             2098 08286000
*                                  /*CALL CKERR*/                  2099 08287000
*                                    RSCKERR = RSCKERR && RSCKERR; 2099 08288000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2099 08289000
*                                    RSCKERN = RSE055;             2100 08290000
         MVC   RSCKERN(2,REG6),@CH00995                            2100 08291000
*                                    RSCKTERM = 'RETU';            2101 08292000
         MVC   RSCKTERM(4,REG6),@CC03500                           2101 08293000
*                                    RSCKMVAR(1) = ADDR(RSVSCRNM); 2102 08294000
*                                                                  2102 08295000
         LA    @07,RSVSCRNM(,REG6)                                 2102 08296000
         ST    @07,RSCKMVAR(,REG6)                                 2102 08297000
*                                  /* CALL TO MODULE IDCRS05 FOR PROCED 08298000
*RE CKERR                                                            */ 08299000
*                                  CALL CKERR;                     2103 08300000
         L     @15,@CV03443                                        2103 08301000
         BALR  @14,@15                                             2103 08302000
*                                  END;                            2104 08303000
*                                END;                              2105 08304000
*                            SNFPROC = ON; /*SPC HDR PROCESSED*/   2106 08305000
@RF02092 L     @07,RSWASNVT(,REG6)                                 2106 08306000
         L     @07,RSFAENT(,@07)                                   2106 08307000
         OI    SNFPROC(@07),B'00010000'                            2106 08308000
*                          END;                                    2107 08309000
*                    END VOLCNUNQ;                                 2108 08310000
@RC02044 DS    0H                                                  2109 08311000
*              END VOLCNEOF;                                       2109 08312000
@RF01959 DS    0H                                                  2109 08313000
@RF01958 DS    0H                                                  2110 08314000
*        END VOLCLP1;                                              2110 08315000
@RC01946 DS    0H                                                  2110 08316000
@DE01923 TM    RSVGTEOF(REG6),B'10000000'                          2110 08317000
         BZ    @DL01923                                            2110 08318000
*        /************************************************************/ 08319000
*        /*                                                          */ 08320000
*        /*  SCAN SNTAB FOR SPACE HEADERS THAT WERE NOT PROCESSED    */ 08321000
*        /*    AND DELETE THEM - IGNORE ANY UNIQUES                  */ 08322000
*        /*                                                          */ 08323000
*        /************************************************************/ 08324000
*        IF RSFNRF = OFF & RSFENTLN ^= 0                           2111 08325000
*          THEN                                                    2111 08326000
         L     @07,RSWASNVT(,REG6)                                 2111 08327000
         TM    RSFNRF(@07),B'10000000'                             2111 08328000
         BNZ   @RF02111                                            2111 08329000
         CLI   RSFENTLN(@07),0                                     2111 08330000
         BE    @RF02111                                            2111 08331000
*            DO;                                                   2112 08332000
*              RSFAENT = RSFCADR;      /*GET FIRST SPC HDR*/       2113 08333000
         L     @04,RSFCADR(,@07)                                   2113 08334000
         ST    @04,RSFAENT(,@07)                                   2113 08335000
*              DO RSFCNDX = 1 TO RSFHNDX;                          2114 08336000
         LA    @07,1                                               2114 08337000
         B     @DE02114                                            2114 08338000
@DL02114 DS    0H                                                  2115 08339000
*                IF SNFPROC ^= ON & SNVSPUNQ ^= ON                 2115 08340000
*                  THEN                                            2115 08341000
         L     @07,RSWASNVT(,REG6)                                 2115 08342000
         L     @07,RSFAENT(,@07)                                   2115 08343000
         TM    SNFPROC(@07),B'00010000'                            2115 08344000
         BO    @RF02115                                            2115 08345000
         TM    SNVSPUNQ(@07),B'10000000'                           2115 08346000
         BO    @RF02115                                            2115 08347000
*                    DO;                                           2116 08348000
*                      /* CALL TO MODULE IDCRS04 FOR PROCEDURE DELGO */ 08349000
*                      CALL DELGO;                                 2117 08350000
         L     @15,@CV03434                                        2117 08351000
         BALR  @14,@15                                             2117 08352000
*        /************************************************************/ 08353000
*        /*                                                          */ 08354000
*        /*  IF THE GROUP OCCURRENCE EXISTS, CALL CKERR TO PRINT     */ 08355000
*        /*  INFORMATIONAL MESSAGE. MUST DERIVE ENTRY NAME FROM      */ 08356000
*        /*  TIMESTAMP.                                              */ 08357000
*        /*                                                          */ 08358000
*        /************************************************************/ 08359000
*                      IF SNFUSE = ON                              2118 08360000
*                        THEN                                      2118 08361000
         L     @07,RSWASNVT(,REG6)                                 2118 08362000
         L     @07,RSFAENT(,@07)                                   2118 08363000
         TM    SNFUSE(@07),B'10000000'                             2118 08364000
         BNO   @RF02118                                            2118 08365000
*                          DO;                                     2119 08366000
*        /************************************************************/ 08367000
*        /*                                                          */ 08368000
*        /*  MOVE THE MODEL DERIVED NAME TO THE DERIVED NAME AREA    */ 08369000
*        /*                                                          */ 08370000
*        /************************************************************/ 08371000
*                            RSVSCRNM = DERVNM;                    2120 08372000
         MVI   RSVSCRNM+35(REG6),C' '                              2120 08373000
         MVC   RSVSCRNM+36(8,REG6),RSVSCRNM+35(REG6)               2120 08374000
         MVC   RSVSCRNM(35,REG6),@CC00849                          2120 08375000
*        /************************************************************/ 08376000
*        /*                                                          */ 08377000
*        /*  CONVERT THE TIMESTAMP DIGITS IN THE SPACE HEADER TO     */ 08378000
*        /*  PRINTABLE CHARACTERS                                    */ 08379000
*        /*                                                          */ 08380000
*        /************************************************************/ 08381000
*                            SDSCBTS(8:8) = PACKF;                 2121 08382000
         MVC   SDSCBTS+7(1,@07),PACKF                              2121 08383000
*                            UNPK (RSVF1TS,SDSCBTS);               2122 08384000
         UNPK  RSVF1TS(15,REG6),SDSCBTS(8,@07)                     2122 08385000
*VOLCLP4:                    DO RSIDX1 = 1 TO DIM(F1TSCNVT);       2123 08386000
VOLCLP4  LA    @07,1                                               2123 08387000
         STH   @07,RSIDX1(,REG6)                                   2123 08388000
@DL02123 DS    0H                                                  2124 08389000
*                              IF F1TSFIX(RSIDX1) > FALPHA         2124 08390000
*                                THEN                              2124 08391000
         LH    @07,RSIDX1(,REG6)                                   2124 08392000
         SLR   @04,@04                                             2124 08393000
         IC    @04,F1TSFIX-1(@07,REG6)                             2124 08394000
         C     @04,@CF00835                                        2124 08395000
         BNH   @RF02124                                            2124 08396000
*                                  F1TSFIX(RSIDX1) = F1TSFIX(RSIDX1)    08397000
*                                        - HEXCNV;                 2125 08398000
         SL    @04,@CF00837                                        2125 08399000
         STC   @04,F1TSFIX-1(@07,REG6)                             2125 08400000
*                            END VOLCLP4;                          2126 08401000
@RF02124 LA    @07,1                                               2126 08402000
         AH    @07,RSIDX1(,REG6)                                   2126 08403000
         STH   @07,RSIDX1(,REG6)                                   2126 08404000
         C     @07,@CF00631                                        2126 08405000
         BNH   @DL02123                                            2126 08406000
*        /************************************************************/ 08407000
*        /*                                                          */ 08408000
*        /*  PLACE THE TIMESTAMP DIGITS IN THE DERIVED NAME AREA     */ 08409000
*        /*                                                          */ 08410000
*        /************************************************************/ 08411000
*                            F1TS1 = DRTS1;                        2127 08412000
         MVC   F1TS1(7,REG6),DRTS1(REG6)                           2127 08413000
*                            F1TS2 = DRTS2;                        2128 08414000
         MVC   F1TS2(7,REG6),DRTS2(REG6)                           2128 08415000
*        /************************************************************/ 08416000
*        /*                                                          */ 08417000
*        /*  CALL CKERR TO PRINT INFORMATIONAL MESSAGE GIVING        */ 08418000
*        /*  DERIVED NAME                                            */ 08419000
*        /*                                                          */ 08420000
*        /************************************************************/ 08421000
*                                                                  2129 08422000
*                            DO;                                   2129 08423000
*                            /*CALL CKERR*/                        2130 08424000
*                              RSCKERR = RSCKERR && RSCKERR;       2130 08425000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2130 08426000
*                              RSCKERN = RSE056;                   2131 08427000
         MVC   RSCKERN(2,REG6),@CH00997                            2131 08428000
*                              RSCKTERM = 'RETU';                  2132 08429000
         MVC   RSCKTERM(4,REG6),@CC03500                           2132 08430000
*                              RSCKMVAR(1) = ADDR(RSVSCRNM);       2133 08431000
*                                                                  2133 08432000
         LA    @07,RSVSCRNM(,REG6)                                 2133 08433000
         ST    @07,RSCKMVAR(,REG6)                                 2133 08434000
*                            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CK 08435000
*RR                                                                  */ 08436000
*                            CALL CKERR;                           2134 08437000
         L     @15,@CV03443                                        2134 08438000
         BALR  @14,@15                                             2134 08439000
*                            END;                                  2135 08440000
*                          END;                                    2136 08441000
*                    END;                                          2137 08442000
@RF02118 DS    0H                                                  2138 08443000
*                RSFAENT = RSFAENT + RSFENTLN;                     2138 08444000
@RF02115 L     @07,RSWASNVT(,REG6)                                 2138 08445000
         SLR   @04,@04                                             2138 08446000
         IC    @04,RSFENTLN(,@07)                                  2138 08447000
         AL    @04,RSFAENT(,@07)                                   2138 08448000
         ST    @04,RSFAENT(,@07)                                   2138 08449000
*              END;                                                2139 08450000
         L     @04,RSWASNVT(,REG6)                                 2139 08451000
         LA    @07,1                                               2139 08452000
         AH    @07,RSFCNDX(,@04)                                   2139 08453000
@DE02114 L     @04,RSWASNVT(,REG6)                                 2139 08454000
         STH   @07,RSFCNDX(,@04)                                   2139 08455000
         L     @04,RSWASNVT(,REG6)                                 2139 08456000
         CH    @07,RSFHNDX(,@04)                                   2139 08457000
         BNH   @DL02114                                            2139 08458000
*            END;                                                  2140 08459000
*        /************************************************************/ 08460000
*        /*                                                          */ 08461000
*        /*  FREE SNTAB                                              */ 08462000
*        /*                                                          */ 08463000
*        /************************************************************/ 08464000
*        RSFENTLN = 0;                                             2141 08465000
@RF02111 L     @07,RSWASNVT(,REG6)                                 2141 08466000
         MVI   RSFENTLN(@07),X'00'                                 2141 08467000
*        /************************************************************/ 08468000
*        /*                                                          */ 08469000
*        /*  ISSUE UCLOSE TO CLOSE VTOC AND SET VTOC OPEN AUDIT FLAG */ 08470000
*        /*    OFF                                                   */ 08471000
*        /*                                                          */ 08472000
*        /************************************************************/ 08473000
*        IOCSPTR = RSVTIOCS;                                       2142 08474000
         L     @07,RSVTIOCS(,REG6)                                 2142 08475000
         ST    @07,IOCSPTR(,REG6)                                  2142 08476000
*        CALL IDCIOCL0 (GDTTBL,IOCSPTR);                           2143 08477000
         ST    REG5,@AL00001                                       2143 08478000
         LA    @07,IOCSPTR(,REG6)                                  2143 08479000
         ST    @07,@AL00001+4                                      2143 08480000
         MVI   @AL00001+4,X'80'                                    2143 08481000
         L     @15,GDTCLS(,REG5)                                   2143 08482000
         LA    @01,@AL00001                                        2143 08483000
         BALR  @14,@15                                             2143 08484000
*        RESPECIFY RTNREG RSTD;                                    2144 08485000
*        TESTRC = RTNREG;                                          2145 08486000
         STH   RTNREG,TESTRC(,REG6)                                2145 08487000
*        RESPECIFY RTNREG UNRSTD;                                  2146 08488000
*        IF TESTRC ^= 0                                            2147 08489000
*          THEN                                                    2147 08490000
*                                                                  2147 08491000
         LH    @07,TESTRC(,REG6)                                   2147 08492000
         LTR   @07,@07                                             2147 08493000
         BZ    @RF02147                                            2147 08494000
*            DO;                                                   2148 08495000
*            /*CALL CKERR*/                                        2149 08496000
*              RSCKERR = RSCKERR && RSCKERR;                       2149 08497000
         XC    RSCKERR(48,REG6),RSCKERR(REG6)                      2149 08498000
*              RSCKERN = RSE057;                                   2150 08499000
         MVC   RSCKERN(2,REG6),@CH00837                            2150 08500000
*              RSCKTERM = 'RETU';                                  2151 08501000
*                                                                  2151 08502000
         MVC   RSCKTERM(4,REG6),@CC03500                           2151 08503000
*            /* CALL TO MODULE IDCRS05 FOR PROCEDURE CKERR           */ 08504000
*            CALL CKERR;                                           2152 08505000
         L     @15,@CV03443                                        2152 08506000
         BALR  @14,@15                                             2152 08507000
*            END;                                                  2153 08508000
*        RSVTOPN = OFF;                                            2154 08509000
@RF02147 NI    RSVTOPN(REG6),B'11110111'                           2154 08510000
*        /************************************************************/ 08511000
*        /*                                                          */ 08512000
*        /*  UPDATE WORKFILE VOLUME RECORD IF NEEDED,                */ 08513000
*        /*  OTHERWISE FREE IT.                                      */ 08514000
*        /*                                                          */ 08515000
*        /************************************************************/ 08516000
*        IF RSVWFUPD = ON                                          2155 08517000
*          THEN                                                    2155 08518000
*                                                                  2155 08519000
         TM    RSVWFUPD(REG6),B'00100000'                          2155 08520000
         BNO   @RF02155                                            2155 08521000
*            DO;                                                   2156 08522000
*              RSRTYPE = ''B;                                      2157 08523000
         MVI   RSRTYPE(REG6),X'00'                                 2157 08524000
*              RSRUPDT = ON;     /* UPDRCD  */                     2158 08525000
         OI    RSRUPDT(REG6),B'00100000'                           2158 08526000
*              RSRUPD = ON;      /* UPDATE  */                     2159 08527000
         OI    RSRUPD(REG6),B'00001000'                            2159 08528000
*              RSRDS = ''B;                                        2160 08529000
         NI    RSRDS(REG6),B'00011111'                             2160 08530000
*              RSRWF = ON;       /* WORKFILE  */                   2161 08531000
*              RSRDIR = ON;      /* DIRECT  */                     2162 08532000
*              RSRKEY = ON;      /* KEY  */                        2163 08533000
*                                                                  2163 08534000
         OI    RSRWF(REG6),B'10010100'                             2163 08535000
*            /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT         */ 08536000
*            CALL RECMGMT;                                         2164 08537000
         L     @15,@CV03452                                        2164 08538000
         BALR  @14,@15                                             2164 08539000
*              RFY RTNREG RSTD;                                    2165 08540000
*              TESTRC = RTNREG;                                    2166 08541000
         STH   RTNREG,TESTRC(,REG6)                                2166 08542000
*              RFY RTNREG UNRSTD;                                  2167 08543000
*            END;                                                  2168 08544000
*          ELSE                                                    2169 08545000
*                                                                  2169 08546000
*            DO;                                                   2169 08547000
         B     @RC02155                                            2169 08548000
@RF02155 DS    0H                                                  2170 08549000
*              RSRTYPE = ''B;                                      2170 08550000
         MVI   RSRTYPE(REG6),X'00'                                 2170 08551000
*              RSRFREE = ON;     /* FREERCD  */                    2171 08552000
         OI    RSRFREE(REG6),B'00000001'                           2171 08553000
*              RSRUPD = ON;      /* UPDATE  */                     2172 08554000
         OI    RSRUPD(REG6),B'00001000'                            2172 08555000
*              RSRDS = ''B;                                        2173 08556000
         NI    RSRDS(REG6),B'00011111'                             2173 08557000
*              RSRWF = ON;       /* WORKFILE  */                   2174 08558000
*              RSRDIR = ON;      /* DIRECT  */                     2175 08559000
*              RSRKEY = ON;      /* KEY  */                        2176 08560000
*                                                                  2176 08561000
         OI    RSRWF(REG6),B'10010100'                             2176 08562000
*            /* CALL TO MODULE IDCRS06 FOR PROCEDURE RECMGMT         */ 08563000
*            CALL RECMGMT;                                         2177 08564000
         L     @15,@CV03452                                        2177 08565000
         BALR  @14,@15                                             2177 08566000
*              RFY RTNREG RSTD;                                    2178 08567000
*              TESTRC = RTNREG;                                    2179 08568000
         STH   RTNREG,TESTRC(,REG6)                                2179 08569000
*              RFY RTNREG UNRSTD;                                  2180 08570000
*            END;                                                  2181 08571000
*        RABRRN = OFF;                                             2182 08572000
*                                                                  2182 08573000
@RC02155 L     @07,RSGRABCU(,REG6)                                 2182 08574000
         L     @07,GRABCURR(,@07)                                  2182 08575000
         NI    RABRRN(@07),B'11101111'                             2182 08576000
*        IF GDTDBG = NULLPTR                                       2183 08577000
*          THEN;                                                   2183 08578000
         L     @07,GDTDBG(,REG5)                                   2183 08579000
         LTR   @07,@07                                             2183 08580000
         BZ    @RT02183                                            2183 08581000
*          ELSE                                                    2185 08582000
*            CALL IDCDB010 (GDTTBL,'RSV1');                        2185 08583000
*                                                                  2185 08584000
         ST    REG5,@AL00001                                       2185 08585000
         LA    @07,@CC03699                                        2185 08586000
         ST    @07,@AL00001+4                                      2185 08587000
         MVI   @AL00001+4,X'80'                                    2185 08588000
         L     @15,GDTDBG(,REG5)                                   2185 08589000
         LA    @01,@AL00001                                        2185 08590000
         BALR  @14,@15                                             2185 08591000
*        RFY UVOLLIST;                                     /*@ZA18274*/ 08592000
@RT02183 DS    0H                                                  2187 08593000
*  CALL EXIT;  /*TERMINATE*/                                       2187 08594000
         BAL   @14,EXIT                                            2187 08595000
*  END VOLCHK; /*END OF PROCEDURE*/                                2188 08596000
@EL00017 DS    0H                                                  2188 08597000
@EF00017 DS    0H                                                  2188 08598000
@ER00017 BR    @14                                                 2188 08599000
@PB00017 DS    0H                                                  2189 08600000
*      GENERATE;                                                   2189 08601000
         DS    0F                                                       08602000
         DC    CL8'EXIT'                                                08603000
*EXIT: PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);                       2190 08604000
*                                                                  2190 08605000
         B     @PB00018                                            2190 08606000
EXIT     DS    0H                                                  2191 08607000
*        GEN(L     @13,4(,@13)); /*RESTORE CALLER'S REG SAVE*/     2191 08608000
         L     @13,4(,@13)                                              08609000
*        GEN(LM    @14,@12,12(@13));  /*RESTORE REGS*/             2192 08610000
         LM    @14,@12,12(@13)                                          08611000
*        GEN(MVI   12(@13),255);  /*MARK END OF SAVE LIST*/        2193 08612000
         MVI   12(@13),255                                              08613000
*        GEN(BR    14);  /*RETURN*/                                2194 08614000
         BR    14                                                       08615000
*END EXIT;  /*END OF PROC EXIT*/                                   2195 08616000
*                                                                  2195 08617000
@EL00018 DS    0H                                                  2195 08618000
@EF00018 DS    0H                                                  2195 08619000
@ER00018 BR    @14                                                 2195 08620000
*END IDCRS03   /*END OF MODULE*/                                   2196 08621000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 08622000
*/*%INCLUDE SYSLIB  (IDCDF64 )                                        * 08623000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 08624000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 08625000
*/*%INCLUDE SYSLIB  (IDCCSRS )                                        * 08626000
*/*%INCLUDE SYSLIB  (AMSDF05 )                                        * 08627000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 08628000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 08629000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 08630000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 08631000
*/*%INCLUDE SYSLIB  (AMCBS   )                                        * 08632000
*/*%INCLUDE SYSLIB  (IGGCAXWA)                                        * 08633000
*/*%INCLUDE SYSLIB  (IFGACB  )                                        * 08634000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 08635000
*;                                                                 2196 08636000
@EL00001 DS    0H                                                  2196 08637000
@EF00001 DS    0H                                                  2196 08638000
@ER00001 LM    @14,@12,12(@13)                                     2196 08639000
         BR    @14                                                 2196 08640000
@DATA    DS    0H                                                       08641000
@CH00038 DC    H'4'                                                     08642000
@CH00280 DC    H'5'                                                     08643000
@CH00152 DC    H'6'                                                     08644000
@CH00034 DC    H'10'                                                    08645000
@CH00937 DC    H'23'                                                    08646000
@CH00946 DC    H'28'                                                    08647000
@CH00950 DC    H'30'                                                    08648000
@CH00954 DC    H'33'                                                    08649000
@CH00956 DC    H'34'                                                    08650000
@CH00971 DC    H'42'                                                    08651000
@CH00973 DC    H'43'                                                    08652000
@CH00595 DC    H'44'                                                    08653000
@CH00976 DC    H'45'                                                    08654000
@CH00747 DC    H'47'                                                    08655000
@CH00983 DC    H'49'                                                    08656000
@CH00985 DC    H'50'                                                    08657000
@CH00987 DC    H'51'                                                    08658000
@CH00989 DC    H'52'                                                    08659000
@CH00991 DC    H'53'                                                    08660000
@CH00993 DC    H'54'                                                    08661000
@CH00995 DC    H'55'                                                    08662000
@CH00997 DC    H'56'                                                    08663000
@CH01002 DC    H'59'                                                    08664000
@CH01004 DC    H'60'                                                    08665000
@CH01078 DC    H'99'                                                    08666000
@CH00143 DC    H'100'                                                   08667000
@CH00755 DC    H'32767'                                                 08668000
@SM03734 MVC   BMAP(0,@04),BMAP(@01)                                    08669000
@SX03737 XC    BMAP(0,@04),BMAP(@04)                                    08670000
@SO03739 OC    BMAP(0,@04),BMAP(@01)                                    08671000
@SO03741 OC    BMAP(0,@07),BMAP(@15)                                    08672000
@SX03743 XC    BMAP(0,@07),BMAP(@15)                                    08673000
@SM03749 MVC   GDGLENTS-1(0,@04),@TS00001                               08674000
@SN03753 NC    BMAP(0,@04),BMAP(@01)                                    08675000
         DS    0F                                                       08676000
@AL02074 DC    A(@CF01000)             LIST WITH   4 ARGUMENT(S)        08677000
         DS    F                                                        08678000
         DC    A(@CC00897)                                              08679000
         DC    AL1(X'80')                                               08680000
         DC    AL3(SETZERO)                                             08681000
@DATD    DSECT                                                          08682000
         DS    0F                                                       08683000
@AL00001 DS    5A                                                       08684000
@TF00001 DS    F                                                        08685000
@TF00002 DS    F                                                        08686000
IDCRS03  CSECT                                                          08687000
         DS    0F                                                       08688000
@CF00212 DC    F'1'                                                     08689000
@CH00212 EQU   @CF00212+2                                               08690000
@CF00149 DC    F'2'                                                     08691000
@CF00158 DC    F'3'                                                     08692000
@CH00158 EQU   @CF00158+2                                               08693000
@CF00482 DC    F'7'                                                     08694000
@CF00175 DC    F'8'                                                     08695000
@CF00032 DC    F'12'                                                    08696000
@CF00631 DC    F'14'                                                    08697000
@CF00471 DC    F'16'                                                    08698000
@CF00215 DC    F'32'                                                    08699000
@CH00215 EQU   @CF00215+2                                               08700000
@CF00848 DC    F'35'                                                    08701000
@CF00837 DC    F'57'                                                    08702000
@CH00837 EQU   @CF00837+2                                               08703000
@CF01000 DC    F'58'                                                    08704000
@CF00753 DC    F'96'                                                    08705000
@CF00790 DC    F'200'                                                   08706000
@CF00835 DC    F'249'                                                   08707000
@CF00619 DC    F'255'                                                   08708000
@CF03188 DC    F'256'                                                   08709000
@CF00757 DC    F'9000'                                                  08710000
@CF00759 DC    F'10000'                                                 08711000
@CF03546 DC    F'-256'                                                  08712000
@CF03748 DC    F'-224'                                                  08713000
@CF03560 DC    F'-8'                                                    08714000
@CF03727 DC    F'-4'                                                    08715000
@DATD    DSECT                                                          08716000
         DS    0D                                                       08717000
@TS00001 DS    CL256                                                    08718000
FDTTBL   DS    CL8                                                      08719000
         ORG   FDTTBL                                                   08720000
FDTVERB  DS    CL8                                                      08721000
FDTPTR   DS    0A                                                       08722000
         ORG   FDTTBL+8                                                 08723000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                08724000
@ENDDATD EQU   *                                                        08725000
IDCRS03  CSECT                                                          08726000
         DS    0F                                                       08727000
@SIZDATD DC    AL1(0)                                                   08728000
         DC    AL3(@ENDDATD-@DATD)                                      08729000
@CV03431 DC    V(PROCTYPE)                                              08730000
@CV03432 DC    V(LOCDIT)                                                08731000
@CV03433 DC    V(MODGO)                                                 08732000
@CV03434 DC    V(DELGO)                                                 08733000
@CV03435 DC    V(FIND)                                                  08734000
@CV03436 DC    V(GETVIA)                                                08735000
@CV03439 DC    V(IDCRS5SR)                                              08736000
@CV03442 DC    V(ADDUPCR)                                               08737000
@CV03443 DC    V(CKERR)                                                 08738000
@CV03452 DC    V(RECMGMT)                                               08739000
@CV03460 DC    V(CNVTCCHH)                                              08740000
@CV03462 DC    V(IDCRS7SP)                                              08741000
@CA03480 DC    A(ASSO3A)                                                08742000
@CV03444 DC    V(ADDTN)                                                 08743000
@CV03430 DC    V(ASSOC)                                                 08744000
@CV03461 DC    V(CATEOV)                                                08745000
@CV03428 DC    V(CATINIT)                                               08746000
@CV03456 DC    V(CRAEOV)                                                08747000
@CV03446 DC    V(CRAUPCHN)                                              08748000
@CV03445 DC    V(DELTN)                                                 08749000
@CV03455 DC    V(ENSURECI)                                              08750000
@CV03458 DC    V(FRCRCCR)                                               08751000
@CV03447 DC    V(GENNAME)                                               08752000
@CV03441 DC    V(IDCRS5BR)                                              08753000
@CV03440 DC    V(IDCRS5BV)                                              08754000
@CV03437 DC    V(IDCRS5EN)                                              08755000
@CV03438 DC    V(IDCRS5SV)                                              08756000
@CV03454 DC    V(IDCRS6CD)                                              08757000
@CV03453 DC    V(IDCRS6CM)                                              08758000
@CV03451 DC    V(IDCRS6DC)                                              08759000
@CV03450 DC    V(IDCRS6DO)                                              08760000
@CV03457 DC    V(RENAMEF)                                               08761000
@CV03463 DC    V(RENAMEP)                                               08762000
@CV03459 DC    V(UPDCCR)                                                08763000
@CV03448 DC    V(WFDEF)                                                 08764000
@CV03449 DC    V(WFDEL)                                                 08765000
@CV03429 DC    V(WRAPUP)                                                08766000
         DS    0D                                                       08767000
MAXCINO  DC    XL4'3FFFFF'                                              08768000
@CC00849 DC    C'Z9999992.VSAMDSPC.TXXXXXXX.TXXXXXXX'                   08769000
@CC00846 EQU   @CC00849                                                 08770000
@CC00780 DC    C'      '                                                08771000
@CC00897 DC    C'RS02'                                                  08772000
@CC00905 DC    C'RS11'                                                  08773000
@CC00907 DC    C'RS12'                                                  08774000
@CC03496 DC    C'RSCD'                                                  08775000
@CC03500 DC    C'RETU'                                                  08776000
@CC03515 DC    C'RSGF'                                                  08777000
@CC03521 DC    C'RSGN'                                                  08778000
@CC03526 DC    C'RSGT'                                                  08779000
@CC03527 DC    C'TERM'                                                  08780000
@CC03531 DC    C'RSMU'                                                  08781000
@CC03537 DC    C'RSPV'                                                  08782000
@CC03549 DC    C'RSP2'                                                  08783000
@CC03553 DC    C'RSST'                                                  08784000
@CC03561 DC    C'RSS3'                                                  08785000
@CC03566 DC    C'RSSB'                                                  08786000
@CC03579 DC    C'RSVB'                                                  08787000
@CC03587 DC    C'RSV4'                                                  08788000
@CC03601 DC    C'RSVN'                                                  08789000
@CC03618 DC    C'RSUA'                                                  08790000
@CC03624 DC    C'RSVS'                                                  08791000
@CC03684 DC    C'RSVO'                                                  08792000
@CC03699 DC    C'RSV1'                                                  08793000
@CC00808 DC    C'A'                                                     08794000
@CC00810 DC    C'B'                                                     08795000
@CC00828 DC    C'V'                                                     08796000
ALL      DC    CL3'ALL'                                                 08797000
FORMAT   DC    CL4'FORM'                                                08798000
HSECOND  DC    CL4'HSEC'                                                08799000
CLOCK    DC    CL4'KLOK'                                                08800000
SETZERO  DC    CL4'ZERO'                                                08801000
SETBLANK DC    CL4'BLNK'                                                08802000
NOSET    DC    CL4'NSET'                                                08803000
OVERRIDE DC    CL4'OVRD'                                                08804000
ACQUIRE  DC    CL8'ACQUIRE '                                            08805000
RELINQ   DC    CL8'RELINQ  '                                            08806000
MOUNT    DC    CL8'MOUNT   '                                            08807000
DEMOUNT  DC    CL8'DEMOUNT '                                            08808000
DEFINE   DC    CL8'DEFINE  '                                            08809000
MOVE     DC    CL8'MOVE    '                                            08810000
TRACEQ   DC    CL8'TRACEQ  '                                            08811000
COPYTABL DC    CL8'COPYTABL'                                            08812000
COPYCRTG DC    CL8'COPYCRTG'                                            08813000
COPYVOL  DC    CL8'COPYVOL '                                            08814000
VVIC     DC    CL8'VVIC    '                                            08815000
TUNE     DC    CL8'TUNE    '                                            08816000
NAMES    DC    CL4'NAME'                                                08817000
UNIT     DC    CL4'UNIT'                                                08818000
SHR      DC    CL4'SHR '                                                08819000
EXCL     DC    CL4'EXCL'                                                08820000
NOWAIT   DC    CL4'NWAI'                                                08821000
WAIT     DC    CL4'WAIT'                                                08822000
TNTYPES  DC    CL11'CDIAXBVUMGR'                                        08823000
MAXEXPDT DC    X'99999F'                                                08824000
DUMMYNM  DC    X'FFFFFFFFFFFFFFFF'                                      08825000
RDFCIDF  DC    X'0001F901F90000'                                        08826000
PACKF    DC    X'0F'                                                    08827000
DSCB1ID  DC    X'F1'                                                    08828000
VOLUNUSE DC    X'0000'                                                  08829000
NULLDIG  DC    X'00'                                                    08830000
BADVOLSW DC    X'00'                                                    08831000
FMT3NULL DC    X'0000000000'                                            08832000
DS4DSNM  DS    CL44                                                     08833000
         ORG   DS4DSNM                                                  08834000
@NM00040 DC    44X'04'                                                  08835000
         ORG   DS4DSNM+44                                               08836000
MODID    DC    CL4'RS03'                                                08837000
         DS    CL1                                                      08838000
PATCH    DS    CL800                                                    08839000
         ORG   PATCH                                                    08840000
@NM00216 DC    CL32'PATCH 800 BYTES LAST USED 000000'                   08841000
@NM00217 DC    768X'00'                                                 08842000
         ORG   PATCH+800                                                08843000
MASKVAL  DC    X'FF7F3F1F0F070301'                                      08844000
MASKV1   DC    X'80C0E0F0F8FCFEFF'                                      08845000
MASKALL  DC    X'FF'                                                    08846000
TRTBLE   DC    CL1'0'                                                   08847000
         DC    CL1'1'                                                   08848000
         DC    CL1'2'                                                   08849000
         DC    CL1'3'                                                   08850000
         DC    CL1'4'                                                   08851000
         DC    CL1'5'                                                   08852000
         DC    CL1'6'                                                   08853000
         DC    CL1'7'                                                   08854000
         DC    CL1'8'                                                   08855000
         DC    CL1'9'                                                   08856000
         DC    CL1'A'                                                   08857000
         DC    CL1'B'                                                   08858000
         DC    CL1'C'                                                   08859000
         DC    CL1'D'                                                   08860000
         DC    CL1'E'                                                   08861000
         DC    CL1'F'                                                   08862000
DEFNMTAB DC    CL8'DSETCRDT'                                            08863000
         DC    CL8'DSETEXDT'                                            08864000
         DC    CL8'PASSWALL'                                            08865000
         DC    CL8'AMDSBCAT'                                            08866000
         DC    CL8'DSATTR'                                              08867000
         DC    CL8'LRECL'                                               08868000
         DC    CL8'SPACPARM'                                            08869000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       08870000
@01      EQU   01                                                       08871000
@02      EQU   02                                                       08872000
@03      EQU   03                                                       08873000
@04      EQU   04                                                       08874000
@05      EQU   05                                                       08875000
@06      EQU   06                                                       08876000
@07      EQU   07                                                       08877000
@08      EQU   08                                                       08878000
@09      EQU   09                                                       08879000
@10      EQU   10                                                       08880000
@11      EQU   11                                                       08881000
@12      EQU   12                                                       08882000
@13      EQU   13                                                       08883000
@14      EQU   14                                                       08884000
@15      EQU   15                                                       08885000
RTNREG   EQU   @15                                                      08886000
REG5     EQU   @05                                                      08887000
REG6     EQU   @06                                                      08888000
REG8     EQU   @08                                                      08889000
REG13    EQU   @13                                                      08890000
REG15    EQU   @15                                                      08891000
REG0     EQU   @00                                                      08892000
REG1     EQU   @01                                                      08893000
REG10    EQU   @10                                                      08894000
REG11    EQU   @11                                                      08895000
REG12    EQU   @12                                                      08896000
REG14    EQU   @14                                                      08897000
REG2     EQU   @02                                                      08898000
REG3     EQU   @03                                                      08899000
REG4     EQU   @04                                                      08900000
REG7     EQU   @07                                                      08901000
REG9     EQU   @09                                                      08902000
         EXTRN ASSO3A                                                   08903000
CVTPTR   EQU   16                                                       08904000
GDTTBL   EQU   0                                                        08905000
GDTTR1   EQU   GDTTBL+8                                                 08906000
GDTTR2   EQU   GDTTBL+12                                                08907000
GDTIOH   EQU   GDTTBL+36                                                08908000
GDTDBG   EQU   GDTTBL+40                                                08909000
GDTSTC   EQU   GDTTBL+44                                                08910000
GDTPRT   EQU   GDTTBL+48                                                08911000
GDTESS   EQU   GDTTBL+52                                                08912000
GDTESA   EQU   GDTTBL+56                                                08913000
GDTRST   EQU   GDTTBL+60                                                08914000
GDTRES   EQU   GDTTBL+64                                                08915000
GDTCAL   EQU   GDTTBL+68                                                08916000
GDTGSP   EQU   GDTTBL+72                                                08917000
GDTFSP   EQU   GDTTBL+76                                                08918000
GDTGPL   EQU   GDTTBL+80                                                08919000
GDTFPL   EQU   GDTTBL+84                                                08920000
GDTLOD   EQU   GDTTBL+88                                                08921000
GDTDEL   EQU   GDTTBL+92                                                08922000
GDTPRL   EQU   GDTTBL+96                                                08923000
GDTEPL   EQU   GDTTBL+100                                               08924000
GDTTIM   EQU   GDTTBL+104                                               08925000
GDTIIO   EQU   GDTTBL+108                                               08926000
GDTTIO   EQU   GDTTBL+112                                               08927000
GDTOPN   EQU   GDTTBL+124                                               08928000
GDTCLS   EQU   GDTTBL+128                                               08929000
GDTGET   EQU   GDTTBL+132                                               08930000
GDTPUT   EQU   GDTTBL+136                                               08931000
GDTPOS   EQU   GDTTBL+140                                               08932000
GDTCPY   EQU   GDTTBL+144                                               08933000
GDTCAT   EQU   GDTTBL+148                                               08934000
GDTSNP   EQU   GDTTBL+164                                               08935000
GDTVFY   EQU   GDTTBL+172                                               08936000
GDTUID   EQU   GDTTBL+192                                               08937000
GDTPMT   EQU   GDTTBL+196                                               08938000
GDTCIR   EQU   GDTTBL+200                                               08939000
GDTLNK   EQU   GDTTBL+204                                               08940000
GDTALC   EQU   GDTTBL+208                                               08941000
GDTDLC   EQU   GDTTBL+212                                               08942000
GDTQAL   EQU   GDTTBL+216                                               08943000
GDTSTW   EQU   GDTTBL+220                                               08944000
GDTSSC   EQU   GDTTBL+224                                               08945000
GDTENQ   EQU   GDTTBL+228                                               08946000
GDTRSV   EQU   GDTTBL+232                                               08947000
GDTDEQ   EQU   GDTTBL+236                                               08948000
GDTSFO   EQU   GDTTBL+240                                               08949000
GDTWTO   EQU   GDTTBL+244                                               08950000
GDTSCR   EQU   GDTTBL+248                                               08951000
GDTUNT   EQU   GDTTBL+252                                               08952000
GDTRCT   EQU   GDTTBL+256                                               08953000
GDTIFO   EQU   GDTTBL+260                                               08954000
GDTEXP   EQU   GDTTBL+264                                               08955000
GDTSTA   EQU   GDTTBL+268                                               08956000
GDTERR   EQU   GDTTBL+272                                               08957000
GDTUNC   EQU   GDTTBL+276                                               08958000
GDTLOC   EQU   GDTTBL+280                                               08959000
IDCSAGP0 EQU   0                                                        08960000
IDCSAFP0 EQU   0                                                        08961000
TRACE1   EQU   0                                                        08962000
OLDERID1 EQU   TRACE1                                                   08963000
TRACE2   EQU   0                                                        08964000
OLDERID2 EQU   TRACE2                                                   08965000
NEWID2   EQU   TRACE2+95                                                08966000
NEWERID2 EQU   5                                                        08967000
CIRAGL   EQU   0                                                        08968000
CIRTYPE  EQU   CIRAGL                                                   08969000
ALLAGL   EQU   0                                                        08970000
ALLSTS   EQU   ALLAGL+24                                                08971000
ALLDSP   EQU   ALLAGL+25                                                08972000
ALLORG   EQU   ALLAGL+26                                                08973000
ALLOPT   EQU   ALLAGL+28                                                08974000
UNITABL  EQU   0                                                        08975000
UNITADR  EQU   UNITABL+4                                                08976000
@NM00010 EQU   UNITADR                                                  08977000
UNITSTAT EQU   UNITABL+6                                                08978000
IDCIOOP0 EQU   0                                                        08979000
IDCIOCL0 EQU   0                                                        08980000
IDCIOPO0 EQU   0                                                        08981000
IDCIOGT0 EQU   0                                                        08982000
IOCSTR   EQU   0                                                        08983000
IOCDAD   EQU   IOCSTR                                                   08984000
IOCDSO   EQU   IOCSTR+16                                                08985000
IOCRFM   EQU   IOCSTR+17                                                08986000
IOCMAC   EQU   IOCSTR+18                                                08987000
IOCMAC2  EQU   IOCSTR+19                                                08988000
IOCMACNT EQU   IOCMAC2                                                  08989000
IOCCHP   EQU   IOCSTR+20                                                08990000
IOCMSG   EQU   IOCSTR+21                                                08991000
IOCRBA   EQU   IOCSTR+40                                                08992000
IOCTTR   EQU   IOCRBA                                                   08993000
IOCMEM   EQU   IOCSTR+44                                                08994000
IOCNWM   EQU   IOCSTR+48                                                08995000
IOCREL   EQU   IOCSTR+60                                                08996000
IOCEXT   EQU   IOCSTR+64                                                08997000
OPNAGL   EQU   0                                                        08998000
OPNOPT   EQU   OPNAGL                                                   08999000
OPNOPTIN EQU   OPNOPT                                                   09000000
OPNOPTBK EQU   OPNOPT                                                   09001000
OPNRFM   EQU   OPNAGL+1                                                 09002000
OPNTYP   EQU   OPNAGL+2                                                 09003000
OPNMOD   EQU   OPNAGL+3                                                 09004000
OPNIOC   EQU   OPNAGL+4                                                 09005000
OPNDDN   EQU   OPNAGL+8                                                 09006000
OPNDSN   EQU   OPNAGL+16                                                09007000
OPNDEV   EQU   OPNAGL+24                                                09008000
OPNBLK   EQU   OPNAGL+36                                                09009000
OPNKYL   EQU   OPNAGL+40                                                09010000
OPNDSO   EQU   OPNAGL+41                                                09011000
OPNDSOPS EQU   OPNDSO                                                   09012000
OPNOPT2  EQU   OPNAGL+42                                                09013000
OPNOPTJM EQU   OPNOPT2                                                  09014000
OPNVOL   EQU   OPNAGL+44                                                09015000
IOINFOPT EQU   0                                                        09016000
UVOLLIST EQU   0                                                        09017000
UVOLCNT  EQU   UVOLLIST                                                 09018000
UVOLENT  EQU   UVOLLIST+2                                               09019000
UVOLDEV  EQU   UVOLENT                                                  09020000
UVOLVOL  EQU   UVOLENT+4                                                09021000
DARGLIST EQU   0                                                        09022000
DARGSTID EQU   DARGLIST+8                                               09023000
DARGARY  EQU   DARGLIST+20                                              09024000
DARGINS  EQU   DARGARY                                                  09025000
DARGINL  EQU   DARGARY+2                                                09026000
FMTLIST  EQU   0                                                        09027000
FMTFLGS  EQU   FMTLIST                                                  09028000
FMTSPF   EQU   FMTLIST+2                                                09029000
FMTRFNO  EQU   FMTSPF                                                   09030000
FMTILEN  EQU   FMTRFNO                                                  09031000
FMTIOFF  EQU   FMTLIST+4                                                09032000
FMTTRBC  EQU   FMTIOFF                                                  09033000
FMTSTO   EQU   FMTTRBC                                                  09034000
FMTOCOL  EQU   FMTLIST+6                                                09035000
FMTCNVF  EQU   FMTLIST+10                                               09036000
ERCNVTAB EQU   0                                                        09037000
ERTYPE   EQU   ERCNVTAB                                                 09038000
EROPER   EQU   ERCNVTAB+1                                               09039000
EROSOPER EQU   ERCNVTAB+2                                               09040000
ERCATRC  EQU   ERCNVTAB+16                                              09041000
ERCPLPT  EQU   ERCNVTAB+20                                              09042000
IDCDB010 EQU   0                                                        09043000
DMPITM   EQU   0                                                        09044000
DMPARY   EQU   0                                                        09045000
CATNM    EQU   0                                                        09046000
CATNMFLG EQU   CATNM+10                                                 09047000
CATDN    EQU   0                                                        09048000
MRPW     EQU   0                                                        09049000
WCAT     EQU   0                                                        09050000
WCATFLG  EQU   WCAT+10                                                  09051000
CRADN    EQU   0                                                        09052000
CRAVL    EQU   0                                                        09053000
CRADV    EQU   0                                                        09054000
WFILE    EQU   0                                                        09055000
IODATA   EQU   0                                                        09056000
IODSID   EQU   IODATA+16                                                09057000
IOCSEX   EQU   0                                                        09058000
IOCRPL   EQU   IOCSEX+4                                                 09059000
IOCXAD   EQU   IOCSEX+16                                                09060000
IOCXPM   EQU   IOCSEX+20                                                09061000
IOCFLG   EQU   IOCSEX+32                                                09062000
IOCDEV   EQU   IOCSEX+33                                                09063000
IOCINF   EQU   IOCSEX+34                                                09064000
IOCMOD   EQU   IOCSEX+35                                                09065000
IOCDLM   EQU   IOCSEX+36                                                09066000
IOCRCV   EQU   IOCSEX+44                                                09067000
CATIEXT  EQU   0                                                        09068000
VOLSERTB EQU   0                                                        09069000
VOLSRNXT EQU   VOLSERTB                                                 09070000
VOLSRCI  EQU   VOLSERTB+4                                               09071000
VOLSRFLG EQU   VOLSERTB+8                                               09072000
VOLSRLAS EQU   VOLSRFLG                                                 09073000
VOLSRSER EQU   VOLSERTB+14                                              09074000
RESVOL   EQU   0                                                        09075000
RESVLFLG EQU   RESVOL+8                                                 09076000
RESVLNEX EQU   RESVOL+10                                                09077000
RESVLSER EQU   RESVOL+14                                                09078000
RESVLDDN EQU   RESVOL+20                                                09079000
RESVLEXT EQU   RESVOL+28                                                09080000
RSF1RNTB EQU   0                                                        09081000
RSF1RNNX EQU   RSF1RNTB                                                 09082000
RSF1RNVL EQU   RSF1RNTB+4                                               09083000
RSF1RNDV EQU   RSF1RNTB+10                                              09084000
RSF1RNNM EQU   RSF1RNTB+14                                              09085000
RSWORK   EQU   0                                                        09086000
RSCABHP1 EQU   RSWORK+12                                                09087000
RSCABLP1 EQU   RSWORK+16                                                09088000
RSCPE1   EQU   RSWORK+68                                                09089000
RSCPE2   EQU   RSWORK+72                                                09090000
RSCPE3   EQU   RSWORK+76                                                09091000
RSCPE4   EQU   RSWORK+80                                                09092000
RSCPE5   EQU   RSWORK+84                                                09093000
RSCPE6   EQU   RSWORK+88                                                09094000
RSCPE7   EQU   RSWORK+92                                                09095000
RSCRVL   EQU   RSWORK+104                                               09096000
RSGCITS  EQU   RSWORK+108                                               09097000
RSGCITC  EQU   RSGCITS+8                                                09098000
@NM00045 EQU   RSGCITS+20                                               09099000
RSGDITS  EQU   RSWORK+136                                               09100000
RSGDITC  EQU   RSGDITS+8                                                09101000
@NM00048 EQU   RSGDITS+20                                               09102000
RSPSTACK EQU   RSWORK+164                                               09103000
RSPTWKC  EQU   RSPSTACK+8                                               09104000
RSTAB    EQU   RSWORK+192                                               09105000
RSTANCHR EQU   RSTAB                                                    09106000
RSTENTAD EQU   RSTAB+4                                                  09107000
@NM00053 EQU   RSTAB+8                                                  09108000
RSTENTIX EQU   @NM00053+1                                               09109000
@NM00055 EQU   RSTAB+12                                                 09110000
RSTWKIX  EQU   @NM00055+1                                               09111000
RSTABAD  EQU   RSTAB+16                                                 09112000
RSXXREGS EQU   RSWORK+212                                               09113000
RS01REGS EQU   RSXXREGS                                                 09114000
RS02REGS EQU   RSXXREGS+20                                              09115000
RS03REGS EQU   RSXXREGS+40                                              09116000
RS03RG08 EQU   RS03REGS                                                 09117000
RS03RG09 EQU   RS03REGS+4                                               09118000
RS04REGS EQU   RSXXREGS+60                                              09119000
RS05REGS EQU   RSXXREGS+80                                              09120000
RS06REGS EQU   RSXXREGS+100                                             09121000
RS07REGS EQU   RSXXREGS+120                                             09122000
RSCRBP1  EQU   RSWORK+372                                               09123000
RSIOTBL  EQU   RSWORK+412                                               09124000
RSRABWA  EQU   RSWORK+416                                               09125000
RSGRABCU EQU   RSWORK+428                                               09126000
RSRMBP   EQU   RSWORK+432                                               09127000
RSWFBP1  EQU   RSWORK+436                                               09128000
RSWFBP2  EQU   RSWORK+440                                               09129000
RSVOLLST EQU   RSWORK+460                                               09130000
RSENTPT  EQU   RSWORK+484                                               09131000
RSVTBENT EQU   RSWORK+532                                               09132000
RSVTIOCS EQU   RSWORK+536                                               09133000
CAXWAPTR EQU   RSWORK+568                                               09134000
CBSPTR   EQU   RSWORK+572                                               09135000
CTGPLPTR EQU   RSWORK+576                                               09136000
CTGFLPTR EQU   RSWORK+580                                               09137000
RSCIXLTA EQU   RSWORK+600                                               09138000
RSUIRPT  EQU   RSWORK+612                                               09139000
RSF1RNAM EQU   RSWORK+652                                               09140000
RSF1RNCU EQU   RSWORK+656                                               09141000
RSORVLLS EQU   RSWORK+668                                               09142000
RSGOPLEN EQU   RSWORK+682                                               09143000
RSIDX    EQU   RSWORK+686                                               09144000
RSIDX1   EQU   RSWORK+688                                               09145000
RSUIOPT  EQU   RSWORK+700                                               09146000
RSNEWCAT EQU   RSWORK+965                                               09147000
RSFLAGSN EQU   RSWORK+979                                               09148000
RSFLAGN1 EQU   RSFLAGSN                                                 09149000
RSVTOPN  EQU   RSFLAGN1                                                 09150000
RSFLAGN2 EQU   RSFLAGSN+1                                               09151000
RSFLAGSI EQU   RSWORK+981                                               09152000
RSFLAGI1 EQU   RSFLAGSI                                                 09153000
RSFLAGI2 EQU   RSFLAGSI+1                                               09154000
RSBADVOL EQU   RSFLAGI2+1                                               09155000
RSRECREQ EQU   RSWORK+984                                               09156000
RSRTYPE  EQU   RSRECREQ                                                 09157000
RSRGET   EQU   RSRTYPE                                                  09158000
RSRUPDT  EQU   RSRTYPE                                                  09159000
RSRTERM  EQU   RSRTYPE                                                  09160000
RSRFREE  EQU   RSRTYPE                                                  09161000
RSROPT   EQU   RSRECREQ+1                                               09162000
RSRDS    EQU   RSROPT                                                   09163000
RSRWF    EQU   RSRDS                                                    09164000
RSRCAT   EQU   RSRDS                                                    09165000
RSRBY    EQU   RSROPT                                                   09166000
RSRKEY   EQU   RSRBY                                                    09167000
RSRFOR   EQU   RSROPT                                                   09168000
RSRUPD   EQU   RSRFOR                                                   09169000
RSRUSE   EQU   RSROPT                                                   09170000
RSRDIR   EQU   RSRUSE                                                   09171000
RSASSOC  EQU   RSWORK+988                                               09172000
RSASSTBL EQU   RSASSOC                                                  09173000
RSASSFLG EQU   RSASSOC+16                                               09174000
RSASSFL1 EQU   RSASSFLG                                                 09175000
RSASDSDI EQU   RSASSFL1                                                 09176000
RSGDG    EQU   RSASSOC+20                                               09177000
RSGDGTB  EQU   RSGDG                                                    09178000
RSGDGLL  EQU   RSGDG+4                                                  09179000
RSGDGLN  EQU   RSGDG+8                                                  09180000
RSGDGNM  EQU   RSGDG+10                                                 09181000
RSPROCVL EQU   RSWORK+1064                                              09182000
RSMAPS   EQU   RSPROCVL                                                 09183000
RSWKBMAP EQU   RSMAPS                                                   09184000
RSPBMAP  EQU   RSMAPS+4                                                 09185000
RSSBMAP  EQU   RSMAPS+8                                                 09186000
RSCABMAP EQU   RSSBMAP                                                  09187000
RSPCBMAP EQU   RSMAPS+12                                                09188000
RSCRBMAP EQU   RSPCBMAP                                                 09189000
RSSCBMAP EQU   RSMAPS+16                                                09190000
RSMAPAD  EQU   RSPROCVL+20                                              09191000
RSTGBMAP EQU   RSMAPAD                                                  09192000
RSCKBMAP EQU   RSMAPAD+4                                                09193000
RSSTBMAP EQU   RSMAPAD+8                                                09194000
RSTOMAP  EQU   RSMAPAD+12                                               09195000
RSFROMAP EQU   RSMAPAD+16                                               09196000
RSMAPSIZ EQU   RSPROCVL+40                                              09197000
TMPSZ    EQU   RSPROCVL+44                                              09198000
RSPVSNT  EQU   RSPROCVL+48                                              09199000
RSPVSNTC EQU   RSPVSNT                                                  09200000
RSPVSNT3 EQU   RSPVSNT+4                                                09201000
RSPVSNT6 EQU   RSPVSNT+12                                               09202000
RSPVSNT8 EQU   RSPVSNT+16                                               09203000
RSPVTTNN EQU   RSPROCVL+68                                              09204000
RSSETTT  EQU   RSPVTTNN                                                 09205000
RSPVNEXT EQU   RSPVTTNN+4                                               09206000
RSPVTNEX EQU   RSPVTTNN+6                                               09207000
RSBITPOS EQU   RSPVTTNN+8                                               09208000
RSPVNN   EQU   RSPVTTNN+10                                              09209000
RSPVKNEX EQU   RSPVTTNN+12                                              09210000
RSMASK   EQU   RSPVTTNN+14                                              09211000
@NM00062 EQU   RSPROCVL+84                                              09212000
RSPVSETB EQU   @NM00062                                                 09213000
RSSETCRA EQU   RSPVSETB                                                 09214000
RSSETMAP EQU   RSPVSETB                                                 09215000
RSPVCLBM EQU   RSPVSETB                                                 09216000
RSST1TO1 EQU   RSPVSETB                                                 09217000
RSPVFLG1 EQU   @NM00062+1                                               09218000
RSPVRVOL EQU   RSPVFLG1                                                 09219000
RSPVDELT EQU   RSPVFLG1                                                 09220000
RSPVNRP  EQU   RSPVFLG1                                                 09221000
RSPVRPC  EQU   RSPVFLG1                                                 09222000
RSPVRSC  EQU   RSPVFLG1                                                 09223000
RSCKBERR EQU   RSPVFLG1                                                 09224000
RSCK1TO1 EQU   RSPVFLG1                                                 09225000
RSPVFLG2 EQU   @NM00062+2                                               09226000
RSMUNUS  EQU   RSPVFLG2                                                 09227000
RSVLCATE EQU   RSPVFLG2                                                 09228000
RSPERROR EQU   RSPVFLG2                                                 09229000
RSSERROR EQU   RSPVFLG2                                                 09230000
RSSETERR EQU   RSPVFLG2                                                 09231000
RSRETSPC EQU   RSPVFLG2                                                 09232000
RSBDVOLS EQU   RSPVFLG2                                                 09233000
RSEOVWA  EQU   RSWORK+1152                                              09234000
@NM00065 EQU   RSEOVWA+8                                                09235000
@NM00067 EQU   RSEOVWA+12                                               09236000
RSEOVFLG EQU   @NM00067+1                                               09237000
RSGETVIA EQU   RSWORK+1168                                              09238000
RSVIACRA EQU   RSGETVIA                                                 09239000
@NM00072 EQU   RSGETVIA+12                                              09240000
RSVIAFLG EQU   @NM00072                                                 09241000
RSVIAFCR EQU   RSVIAFLG                                                 09242000
RSVIACIN EQU   @NM00072+1                                               09243000
@NM00074 EQU   RSGETVIA+16                                              09244000
RSREASW  EQU   RSWORK+1188                                              09245000
RSCKERR  EQU   RSWORK+1192                                              09246000
RSCKERN  EQU   RSCKERR                                                  09247000
RSCKTERM EQU   RSCKERR+4                                                09248000
RSCKMVAR EQU   RSCKERR+8                                                09249000
RSCKERRW EQU   RSWORK+1240                                              09250000
RSLASTCC EQU   RSCKERRW                                                 09251000
RSCKTIME EQU   RSCKERRW+8                                               09252000
RSCKFLAG EQU   RSCKERRW+50                                              09253000
RSCIWA   EQU   RSWORK+1292                                              09254000
RSCIEXPT EQU   RSCIWA                                                   09255000
RSINWA   EQU   RSWORK+1340                                              09256000
RSINDVL  EQU   RSINWA+24                                                09257000
RSINVLSR EQU   RSINWA+39                                                09258000
RSINATR1 EQU   RSINWA+53                                                09259000
RSINFLGS EQU   RSINWA+54                                                09260000
RSRNWA   EQU   RSWORK+1488                                              09261000
RSRNPLST EQU   RSRNWA                                                   09262000
RSRNFLGS EQU   RSRNWA+46                                                09263000
RSRNVL   EQU   RSRNWA+99                                                09264000
RSRNVLC  EQU   RSRNVL                                                   09265000
RSRNVLSR EQU   RSRNVL+1                                                 09266000
RSRNUL   EQU   RSRNWA+106                                               09267000
RSRWORK  EQU   RSWORK+1604                                              09268000
RSRFLGS  EQU   RSRWORK+64                                               09269000
RSWFWA   EQU   RSWORK+1672                                              09270000
RSADWA   EQU   RSWORK+1724                                              09271000
RSADVL   EQU   RSADWA+32                                                09272000
RSADUL   EQU   RSADWA+39                                                09273000
RSCRWA   EQU   RSWORK+1772                                              09274000
RSGENWRK EQU   RSWORK+1780                                              09275000
RSGENDTE EQU   RSGENWRK+12                                              09276000
RSVOLWA  EQU   RSWORK+1796                                              09277000
RSVSCRPT EQU   RSVOLWA                                                  09278000
RSVSCRNM EQU   RSVOLWA+4                                                09279000
RSVSVTTR EQU   RSVOLWA+48                                               09280000
RSVF1TS  EQU   RSVOLWA+52                                               09281000
RSVF1TS1 EQU   RSVF1TS                                                  09282000
RSVF1TS2 EQU   RSVF1TS+7                                                09283000
RSVF1PAD EQU   RSVF1TS+14                                               09284000
RSVF1CTS EQU   RSVOLWA+67                                               09285000
RSVF1EXT EQU   RSVOLWA+75                                               09286000
RSVF1TTN EQU   RSVF1EXT                                                 09287000
RSVEXTS  EQU   RSVOLWA+139                                              09288000
RSVFLAGS EQU   RSVOLWA+140                                              09289000
RSVGTEOF EQU   RSVFLAGS                                                 09290000
RSVREPOS EQU   RSVFLAGS                                                 09291000
RSVWFUPD EQU   RSVFLAGS                                                 09292000
RSVF4TT  EQU   RSVOLWA+142                                              09293000
RSDF00W  EQU   RSWORK+1940                                              09294000
LISTSCAN EQU   RSDF00W+4                                                09295000
IOCSPTR  EQU   RSDF00W+8                                                09296000
OPNPTR   EQU   RSDF00W+12                                               09297000
DDSTRU   EQU   RSDF00W+16                                               09298000
FSADDR   EQU   RSDF00W+20                                               09299000
ERCNVADR EQU   RSDF00W+24                                               09300000
DMPINDEX EQU   RSDF00W+28                                               09301000
TESTRC   EQU   RSDF00W+34                                               09302000
RSCNVTCC EQU   RSWORK+1980                                              09303000
RSCIOCS  EQU   RSCNVTCC                                                 09304000
RSCCHHP  EQU   RSCNVTCC+4                                               09305000
RSTTNN   EQU   RSCNVTCC+8                                               09306000
RSTT     EQU   RSTTNN                                                   09307000
RSCNVTCF EQU   RSCNVTCC+12                                              09308000
RSCNVTF1 EQU   RSCNVTCF                                                 09309000
RSCFINN  EQU   RSCNVTF1                                                 09310000
RSWFNDWA EQU   RSWORK+1996                                              09311000
RSWASNVT EQU   RSWFNDWA+4                                               09312000
RSWSNFLG EQU   RSWFNDWA+8                                               09313000
RSWFONE  EQU   RSWSNFLG                                                 09314000
RSWGCODE EQU   RSWFNDWA+9                                               09315000
RSWFBMAP EQU   RSWFNDWA+20                                              09316000
RSWFBMLN EQU   RSWFNDWA+24                                              09317000
RSGENMWA EQU   RSWORK+2052                                              09318000
RSGENAM  EQU   RSGENMWA+9                                               09319000
RSGDATE  EQU   RSGENAM+21                                               09320000
RSGTIME  EQU   RSGENAM+26                                               09321000
RSCDSDWA EQU   RSWORK+2108                                              09322000
RSCDSDIN EQU   RSCDSDWA                                                 09323000
RSCDSNT8 EQU   RSCDSDIN                                                 09324000
RSCDSNT3 EQU   RSCDSDIN+4                                               09325000
RSCDVOLR EQU   RSCDSDIN+8                                               09326000
RSCDDIR  EQU   RSCDSDIN+12                                              09327000
RSCDSDW  EQU   RSCDSDWA+16                                              09328000
RSCD3FAE EQU   RSCDSDW                                                  09329000
RSCD8FAE EQU   RSCDSDW+4                                                09330000
RSCD3FCN EQU   RSCDSDW+8                                                09331000
RSCD8FCN EQU   RSCDSDW+10                                               09332000
RSCDSUMT EQU   RSCDSDW+12                                               09333000
RSCDINDX EQU   RSCDSDW+16                                               09334000
RSMARKUN EQU   RSWORK+2144                                              09335000
RSMA3FAE EQU   RSMARKUN                                                 09336000
RSMA3FCN EQU   RSMARKUN+4                                               09337000
RSCSWA   EQU   RSWORK+2152                                              09338000
RSCSFAE  EQU   RSCSWA                                                   09339000
RSCSFCN  EQU   RSCSWA+4                                                 09340000
GRAB     EQU   0                                                        09341000
GRABFLGS EQU   GRAB                                                     09342000
GRABAFLS EQU   GRABFLGS+1                                               09343000
GRABAFL1 EQU   GRABAFLS                                                 09344000
GRABSFXT EQU   GRABAFL1                                                 09345000
GRABSNRN EQU   GRABAFL1                                                 09346000
GRABAFL2 EQU   GRABAFLS+1                                               09347000
GRABBB   EQU   GRAB+4                                                   09348000
GRABCURR EQU   GRAB+12                                                  09349000
GRABRABS EQU   GRAB+16                                                  09350000
GRABRAB1 EQU   GRABRABS                                                 09351000
GRABRAB2 EQU   GRABRABS+4                                               09352000
GRABRAB4 EQU   GRABRABS+12                                              09353000
RSRAB    EQU   0                                                        09354000
RABFLGS  EQU   RSRAB                                                    09355000
RABFLG1  EQU   RABFLGS                                                  09356000
RABRRN   EQU   RABFLG1                                                  09357000
RABNRF   EQU   RABFLG1                                                  09358000
RABRCDA  EQU   RSRAB+4                                                  09359000
RABBUF   EQU   RSRAB+8                                                  09360000
RABPROC  EQU   RSRAB+520                                                09361000
RMB      EQU   0                                                        09362000
RMBCTL   EQU   RMB                                                      09363000
RMBFLAGS EQU   RMBCTL+8                                                 09364000
RSXCIXLT EQU   0                                                        09365000
RSXCIENT EQU   RSXCIXLT+8                                               09366000
RSXCIFLG EQU   RSXCIENT+8                                               09367000
RSXCIFL1 EQU   RSXCIFLG                                                 09368000
UIODSN   EQU   0                                                        09369000
UIOVOL   EQU   0                                                        09370000
RECIOWA  EQU   0                                                        09371000
GRABSWF  EQU   RECIOWA                                                  09372000
GRABSCA  EQU   RECIOWA+40                                               09373000
RSOPNAGL EQU   RECIOWA+248                                              09374000
ALLUL    EQU   RECIOWA+784                                              09375000
ALLVL    EQU   RECIOWA+796                                              09376000
RSCAMINN EQU   RECIOWA+816                                              09377000
RSSCRLST EQU   RECIOWA+872                                              09378000
UCATWA   EQU   RECIOWA+874                                              09379000
RSCNCCHH EQU   0                                                        09380000
TASSENT  EQU   0                                                        09381000
TASSFL1  EQU   TASSENT+1                                                09382000
TASSRAB  EQU   TASSENT+2                                                09383000
TASSO    EQU   0                                                        09384000
TASSEN   EQU   TASSO+4                                                  09385000
TABANCHR EQU   0                                                        09386000
TABF     EQU   TABANCHR                                                 09387000
TABL     EQU   TABANCHR+4                                               09388000
TABC     EQU   TABANCHR+8                                               09389000
TABSIZ   EQU   TABANCHR+12                                              09390000
TABEN    EQU   TABANCHR+18                                              09391000
@NM00102 EQU   TABANCHR+20                                              09392000
TABNU    EQU   @NM00102+1                                               09393000
TABUG    EQU   TABANCHR+24                                              09394000
TABHEAD  EQU   0                                                        09395000
THEAD    EQU   TABHEAD                                                  09396000
TABBACKW EQU   THEAD                                                    09397000
TABFORW  EQU   THEAD+4                                                  09398000
TABMAXT  EQU   THEAD+8                                                  09399000
TABCURR  EQU   THEAD+10                                                 09400000
TENTRY   EQU   TABHEAD+12                                               09401000
PTWORK   EQU   0                                                        09402000
PTYPEDTA EQU   PTWORK+12                                                09403000
PTGCIT   EQU   PTYPEDTA                                                 09404000
@NM00104 EQU   PTGCIT                                                   09405000
PTCITI   EQU   @NM00104+1                                               09406000
@NM00106 EQU   PTGCIT+4                                                 09407000
PTCITL   EQU   @NM00106+1                                               09408000
@NM00108 EQU   PTGCIT+8                                                 09409000
PTCITNC  EQU   @NM00108+1                                               09410000
PTCITCUR EQU   PTGCIT+12                                                09411000
PTCITF   EQU   PTGCIT+16                                                09412000
PTGDIT   EQU   PTYPEDTA+24                                              09413000
@NM00110 EQU   PTGDIT                                                   09414000
@NM00112 EQU   PTGDIT+4                                                 09415000
@NM00114 EQU   PTGDIT+8                                                 09416000
PTDITCUR EQU   PTGDIT+12                                                09417000
PTASSO   EQU   PTYPEDTA+48                                              09418000
PTASSOC  EQU   PTASSO                                                   09419000
PTASSCUR EQU   PTASSO+4                                                 09420000
PTASSOEA EQU   PTASSO+8                                                 09421000
PTASSOE1 EQU   PTASSO+12                                                09422000
PTASSOE  EQU   PTASSOE1                                                 09423000
PTASSEXP EQU   PTASSO+52                                                09424000
PTINDX   EQU   PTYPEDTA+104                                             09425000
PTINDX3  EQU   PTINDX+4                                                 09426000
PTINDXV  EQU   PTINDX+6                                                 09427000
PTBASE   EQU   PTYPEDTA+116                                             09428000
PTVERDI  EQU   PTYPEDTA+120                                             09429000
PTVALL   EQU   PTVERDI                                                  09430000
PTVDI    EQU   PTVALL                                                   09431000
PTXALIAS EQU   PTYPEDTA+152                                             09432000
PTXFLAGS EQU   PTXALIAS+30                                              09433000
PTXFLAG1 EQU   PTXFLAGS                                                 09434000
PTCRAVL  EQU   PTYPEDTA+184                                             09435000
PTFLAGS  EQU   PTYPEDTA+190                                             09436000
PTF1     EQU   PTFLAGS                                                  09437000
PTF1OK   EQU   PTF1                                                     09438000
PTF1END  EQU   PTF1                                                     09439000
PTF2     EQU   PTFLAGS+1                                                09440000
PTLOC    EQU   PTWORK+204                                               09441000
@NM00120 EQU   PTLOC                                                    09442000
PTLBCITX EQU   @NM00120+1                                               09443000
PTLCDIT  EQU   PTLOC+8                                                  09444000
@NM00122 EQU   PTLOC+12                                                 09445000
PTLDITFB EQU   PTLOC+18                                                 09446000
PTLFBAS1 EQU   PTLDITFB                                                 09447000
PTLDITID EQU   PTLOC+19                                                 09448000
PTASOE   EQU   0                                                        09449000
GCITS    EQU   0                                                        09450000
CITABE   EQU   0                                                        09451000
CITFLA   EQU   CITABE                                                   09452000
CITFAVER EQU   CITFLA                                                   09453000
CITFAINV EQU   CITFLA                                                   09454000
CITCIN   EQU   CITABE+1                                                 09455000
@NM00127 EQU   CITABE+4                                                 09456000
CITTYPE  EQU   @NM00127                                                 09457000
@NM00128 EQU   CITABE+8                                                 09458000
@NM00129 EQU   CITABE+12                                                09459000
@NM00131 EQU   CITABE+16                                                09460000
GDITS    EQU   0                                                        09461000
DITABE   EQU   0                                                        09462000
DITFA    EQU   DITABE                                                   09463000
DITFAVER EQU   DITFA                                                    09464000
DITFLB   EQU   DITABE+1                                                 09465000
@NM00140 EQU   DITABE+4                                                 09466000
DITSN    EQU   @NM00140                                                 09467000
DITVSN   EQU   DITSN                                                    09468000
@NM00143 EQU   DITABE+8                                                 09469000
DITDGML  EQU   DITABE+12                                                09470000
GDGLDS   EQU   0                                                        09471000
GDGLHEAD EQU   GDGLDS                                                   09472000
GDGVAL   EQU   GDGLHEAD                                                 09473000
GDGLMT   EQU   GDGLHEAD+4                                               09474000
GDGCNT   EQU   GDGLHEAD+6                                               09475000
GDGVALB  EQU   GDGLHEAD+8                                               09476000
GDGPLEV  EQU   GDGLHEAD+10                                              09477000
GDGTOS   EQU   GDGLHEAD+12                                              09478000
GDGTOE   EQU   GDGLHEAD+14                                              09479000
GDGFRS   EQU   GDGLHEAD+16                                              09480000
GDGFRE   EQU   GDGLHEAD+18                                              09481000
GDGMVL   EQU   GDGLHEAD+20                                              09482000
GDGPAK   EQU   GDGLHEAD+22                                              09483000
GDGFLG   EQU   GDGLHEAD+30                                              09484000
GDGWRAP  EQU   GDGFLG                                                   09485000
GDGLENTS EQU   GDGLDS+32                                                09486000
GDGENT   EQU   GDGLENTS                                                 09487000
GDGLVLT  EQU   GDGENT                                                   09488000
BMAP     EQU   0                                                        09489000
RSFSNVT  EQU   0                                                        09490000
RSFLAGS  EQU   RSFSNVT+1                                                09491000
RSFNRF   EQU   RSFLAGS                                                  09492000
RSFGCODE EQU   RSFSNVT+2                                                09493000
RSFENTLN EQU   RSFSNVT+3                                                09494000
RSFHNDX  EQU   RSFSNVT+4                                                09495000
RSFCNDX  EQU   RSFSNVT+6                                                09496000
RSFAENT  EQU   RSFSNVT+8                                                09497000
RSFLENBM EQU   RSFSNVT+14                                               09498000
RSFATTNN EQU   RSFSNVT+16                                               09499000
RSFABMAP EQU   RSFSNVT+20                                               09500000
RSFCADR  EQU   RSFSNVT+24                                               09501000
SNTAB    EQU   0                                                        09502000
SNFIXED  EQU   SNTAB                                                    09503000
SNFLAG   EQU   SNFIXED                                                  09504000
SNFUSE   EQU   SNFLAG                                                   09505000
SNFDEL   EQU   SNFLAG                                                   09506000
SNFPROC  EQU   SNFLAG                                                   09507000
SNSN     EQU   SNFIXED+1                                                09508000
SNENTRY  EQU   SNTAB+24                                                 09509000
SNVDATA  EQU   SNENTRY                                                  09510000
SDSCBTS  EQU   SNVDATA                                                  09511000
SSPHDFLG EQU   SNVDATA+8                                                09512000
SNVSPUNQ EQU   SSPHDFLG                                                 09513000
SNVSPCAT EQU   SSPHDFLG                                                 09514000
SNODSPXT EQU   SNVDATA+9                                                09515000
SSPEXTNT EQU   SNVDATA+10                                               09516000
SSPEXTNN EQU   SSPEXTNT                                                 09517000
SNASSOC  EQU   0                                                        09518000
SNGLEV   EQU   SNASSOC+28                                               09519000
SNVGO    EQU   0                                                        09520000
SNVOLSER EQU   SNVGO+28                                                 09521000
SITYPEXT EQU   SNVGO+34                                                 09522000
SNSSWD   EQU   SITYPEXT                                                 09523000
SDSDIRSN EQU   SNVGO+35                                                 09524000
SNVGOSS  EQU   SNVGO+37                                                 09525000
SNTTNNX  EQU   SNVGO+39                                                 09526000
SNTTNNC  EQU   SNVGO+40                                                 09527000
SNEXTENT EQU   SNVGO+43                                                 09528000
SNVSBM   EQU   0                                                        09529000
SNDSDIR  EQU   0                                                        09530000
SDSIDFLG EQU   SNDSDIR+24                                               09531000
SDSEXT   EQU   SDSIDFLG                                                 09532000
SDSIDNO  EQU   SNDSDIR+25                                               09533000
SDSCRETS EQU   SNDSDIR+28                                               09534000
SDSSUMTT EQU   SNDSDIR+32                                               09535000
SNTTNN   EQU   0                                                        09536000
SNTT     EQU   SNTTNN                                                   09537000
SNNN     EQU   SNTTNN+2                                                 09538000
CATGOPT  EQU   0                                                        09539000
CATGOCI  EQU   CATGOPT                                                  09540000
CATGOFLG EQU   CATGOCI                                                  09541000
CATGOGC1 EQU   CATGOPT+3                                                09542000
CATGOSEQ EQU   CATGOPT+4                                                09543000
CATRCD   EQU   0                                                        09544000
RCDCINO  EQU   CATRCD+1                                                 09545000
RCDCRAVL EQU   CATRCD+5                                                 09546000
RCDDICTS EQU   CATRCD+22                                                09547000
RCDID    EQU   CATRCD+44                                                09548000
RCDSIZ   EQU   CATRCD+45                                                09549000
NREPLF   EQU   CATRCD+48                                                09550000
REPCNTRL EQU   0                                                        09551000
EXTRCDPT EQU   REPCNTRL                                                 09552000
REPCNT   EQU   REPCNTRL+5                                               09553000
REPGOPT  EQU   REPCNTRL+6                                               09554000
VARFIELD EQU   0                                                        09555000
VARLEN   EQU   VARFIELD                                                 09556000
CNTRLINF EQU   0                                                        09557000
CTGRBASE EQU   0                                                        09558000
CNAME    EQU   CTGRBASE+49                                              09559000
COWNID   EQU   CTGRBASE+93                                              09560000
CATTR    EQU   CTGRBASE+107                                             09561000
CATTR1   EQU   CATTR                                                    09562000
CUNIQ    EQU   CATTR1                                                   09563000
CATTR2   EQU   CATTR+1                                                  09564000
CNUS     EQU   CATTR2                                                   09565000
COPEN    EQU   CTGRBASE+109                                             09566000
CSPACPRM EQU   CTGRBASE+114                                             09567000
CCR      EQU   0                                                        09568000
ASGO     EQU   0                                                        09569000
ASG1     EQU   ASGO+2                                                   09570000
ASG2     EQU   ASGO+6                                                   09571000
ASGOGDG  EQU   0                                                        09572000
DSDIR    EQU   0                                                        09573000
SPACEPRM EQU   0                                                        09574000
SPCOPTNS EQU   SPACEPRM+6                                               09575000
RGATTRFL EQU   0                                                        09576000
RGATTR1  EQU   RGATTRFL                                                 09577000
RGATTSG1 EQU   RGATTRFL+1                                               09578000
VOLGO    EQU   0                                                        09579000
GDGRCD   EQU   0                                                        09580000
GDGLIMIT EQU   GDGRCD+107                                               09581000
GENLVLS  EQU   0                                                        09582000
GDGLVL   EQU   GENLVLS+2                                                09583000
CTGPL    EQU   0                                                        09584000
CTGOPTN1 EQU   CTGPL                                                    09585000
CTGOPTN2 EQU   CTGPL+1                                                  09586000
CTGEXT   EQU   CTGOPTN2                                                 09587000
CTGERASE EQU   CTGOPTN2                                                 09588000
CTGSMF   EQU   CTGERASE                                                 09589000
CTGREL   EQU   CTGSMF                                                   09590000
CTGPURG  EQU   CTGOPTN2                                                 09591000
CTGVMNT  EQU   CTGPURG                                                  09592000
CTGRCATN EQU   CTGVMNT                                                  09593000
CTGGTNXT EQU   CTGOPTN2                                                 09594000
CTGOPTN3 EQU   CTGPL+2                                                  09595000
CTGOPTN4 EQU   CTGPL+3                                                  09596000
CTGENT   EQU   CTGPL+4                                                  09597000
CTGFVT   EQU   CTGENT                                                   09598000
CTGCAT   EQU   CTGPL+8                                                  09599000
CTGDSORG EQU   CTGPL+16                                                 09600000
CTGDDNM  EQU   CTGPL+20                                                 09601000
CTGNEWNM EQU   CTGDDNM                                                  09602000
CTGFBFLG EQU   CTGNEWNM+2                                               09603000
CTGJSCB  EQU   CTGPL+24                                                 09604000
CTGFL    EQU   0                                                        09605000
CTGFLDRE EQU   CTGFL+3                                                  09606000
CTGFLDAT EQU   CTGFL+16                                                 09607000
CTGFV    EQU   0                                                        09608000
CTGFVPRO EQU   CTGFV+1                                                  09609000
CTGFVSPC EQU   CTGFV+52                                                 09610000
CTGFVAMD EQU   CTGFV+56                                                 09611000
CTGFVLMT EQU   CTGFV+72                                                 09612000
CTGFVGAT EQU   CTGFV+76                                                 09613000
CVTMAP   EQU   0                                                        09614000
CVTDAR   EQU   CVTMAP+72                                                09615000
CVTFLGS1 EQU   CVTDAR                                                   09616000
CVTDCB   EQU   CVTMAP+116                                               09617000
CVTIERLC EQU   CVTMAP+144                                               09618000
CVTOPTA  EQU   CVTMAP+182                                               09619000
CVTOPTB  EQU   CVTMAP+183                                               09620000
CVTGTF   EQU   CVTMAP+236                                               09621000
CVTGTFST EQU   CVTGTF                                                   09622000
CVTGTFS  EQU   CVTGTFST                                                 09623000
CVTSTATE EQU   CVTGTFST                                                 09624000
CVTTMODE EQU   CVTGTFST                                                 09625000
CVTFORM  EQU   CVTGTFST                                                 09626000
CVTAQAVT EQU   CVTMAP+240                                               09627000
CVTTCMFG EQU   CVTAQAVT                                                 09628000
CVTVOLM2 EQU   CVTMAP+244                                               09629000
CVTTATA  EQU   CVTVOLM2                                                 09630000
CVTTSKS  EQU   CVTTATA                                                  09631000
CVTVOLF2 EQU   CVTTSKS                                                  09632000
CVTTAT   EQU   CVTTATA+1                                                09633000
CVTATER  EQU   CVTMAP+248                                               09634000
CVTEXT1  EQU   CVTMAP+252                                               09635000
CVTPURG  EQU   CVTMAP+260                                               09636000
CVTQMSG  EQU   CVTMAP+268                                               09637000
CVTDMSR  EQU   CVTMAP+272                                               09638000
CVTRSV37 EQU   CVTDMSR                                                  09639000
CVTDMSRF EQU   CVTRSV37                                                 09640000
CVTERPV  EQU   CVTMAP+316                                               09641000
CVTINTLA EQU   CVTMAP+320                                               09642000
CVTAPF   EQU   CVTMAP+324                                               09643000
CVTEXT2  EQU   CVTMAP+328                                               09644000
CVTHJES  EQU   CVTMAP+332                                               09645000
CVTPGSIA EQU   CVTMAP+348                                               09646000
CVTA1F1  EQU   CVTMAP+356                                               09647000
CVTSYSK  EQU   CVTMAP+357                                               09648000
CVTVOLM1 EQU   CVTMAP+380                                               09649000
CVTVOLF1 EQU   CVTVOLM1                                                 09650000
CVTATMCT EQU   CVTMAP+388                                               09651000
CVTXTNT1 EQU   0                                                        09652000
CVTXTNT2 EQU   0                                                        09653000
CVTDSSV  EQU   CVTXTNT2                                                 09654000
CVTFLGBT EQU   CVTXTNT2+5                                               09655000
CVTQID   EQU   CVTXTNT2+24                                              09656000
CVTRV400 EQU   CVTXTNT2+52                                              09657000
CVTRV409 EQU   CVTXTNT2+53                                              09658000
CVTATCVT EQU   CVTXTNT2+64                                              09659000
CVTRV429 EQU   CVTXTNT2+84                                              09660000
CVTRV438 EQU   CVTXTNT2+85                                              09661000
CVTRV457 EQU   CVTXTNT2+112                                             09662000
CVTRV466 EQU   CVTXTNT2+113                                             09663000
CVTFIX   EQU   0                                                        09664000
CVTRELNO EQU   CVTFIX+252                                               09665000
AMCBS    EQU   0                                                        09666000
CBSCMP   EQU   AMCBS+16                                                 09667000
CBSVSRT  EQU   AMCBS+32                                                 09668000
IGGCAXWA EQU   0                                                        09669000
CAXFLGS  EQU   IGGCAXWA+8                                               09670000
CAXFLG2  EQU   IGGCAXWA+9                                               09671000
CAXFLG3  EQU   IGGCAXWA+10                                              09672000
CAXCCR   EQU   IGGCAXWA+32                                              09673000
CAXCNAM  EQU   IGGCAXWA+52                                              09674000
CAXOPLST EQU   IGGCAXWA+96                                              09675000
COPTS    EQU   CAXOPLST                                                 09676000
IFGACB   EQU   0                                                        09677000
ACBCOMN  EQU   IFGACB                                                   09678000
ACBLENG  EQU   ACBCOMN+2                                                09679000
ACBLENG2 EQU   ACBLENG                                                  09680000
ACBAMBL  EQU   ACBCOMN+4                                                09681000
ACBJWA   EQU   ACBAMBL                                                  09682000
ACBMACRF EQU   ACBCOMN+12                                               09683000
ACBMACR1 EQU   ACBMACRF                                                 09684000
ACBADR   EQU   ACBMACR1                                                 09685000
ACBCNV   EQU   ACBMACR1                                                 09686000
ACBMACR2 EQU   ACBMACRF+1                                               09687000
ACBBUFPL EQU   ACBCOMN+20                                               09688000
ACBMACR3 EQU   ACBBUFPL                                                 09689000
ACBRECFM EQU   ACBCOMN+24                                               09690000
ACBCCTYP EQU   ACBCOMN+25                                               09691000
ACBOPT   EQU   ACBCOMN+26                                               09692000
ACBDSORG EQU   ACBOPT                                                   09693000
ACBCROPS EQU   ACBDSORG                                                 09694000
ACBDVIND EQU   ACBDSORG                                                 09695000
ACBEXLST EQU   ACBCOMN+36                                               09696000
ACBDDNM  EQU   ACBCOMN+40                                               09697000
ACBAMETH EQU   ACBDDNM+3                                                09698000
ACBOFLGS EQU   ACBCOMN+48                                               09699000
ACBEXFG  EQU   ACBOFLGS                                                 09700000
ACBIOSFG EQU   ACBOFLGS                                                 09701000
ACBINFLG EQU   ACBCOMN+50                                               09702000
ACBVVIC  EQU   ACBINFLG                                                 09703000
ACBUJFCB EQU   ACBCOMN+52                                               09704000
ACBBLKSZ EQU   ACBCOMN+60                                               09705000
IDAAMDSB EQU   0                                                        09706000
AMDATTR  EQU   IDAAMDSB+1                                               09707000
AMDNEST  EQU   IDAAMDSB+4                                               09708000
AMDHLRBA EQU   IDAAMDSB+28                                              09709000
AMDSSRBA EQU   IDAAMDSB+32                                              09710000
AMDATTR3 EQU   IDAAMDSB+40                                              09711000
AMDSTAT  EQU   IDAAMDSB+48                                              09712000
FMT1DSCB EQU   0                                                        09713000
FMT1NAME EQU   FMT1DSCB                                                 09714000
FMT1ID   EQU   FMT1DSCB+44                                              09715000
FMT1NEXT EQU   FMT1DSCB+59                                              09716000
FMT1ORG  EQU   FMT1DSCB+83                                              09717000
FMT1VSAM EQU   FMT1ORG                                                  09718000
FMT1EXTS EQU   FMT1DSCB+105                                             09719000
FMT1CCHH EQU   FMT1EXTS+2                                               09720000
FMT1PTR  EQU   FMT1DSCB+135                                             09721000
FMT3DSCB EQU   0                                                        09722000
FMT3EXTA EQU   FMT3DSCB+4                                               09723000
FMT3CCHA EQU   FMT3EXTA+2                                               09724000
FMT3EXTB EQU   FMT3DSCB+45                                              09725000
FMT3CCHB EQU   FMT3EXTB+2                                               09726000
DS4TIMS  EQU   87                                                       09727000
DS4CCHH  EQU   107                                                      09728000
ALLP     EQU   0                                                        09729000
ALLPPTR  EQU   0                                                        09730000
AMSTP011 EQU   0                                                        09731000
AMSTP041 EQU   0                                                        09732000
AMSTP042 EQU   0                                                        09733000
AMSTP043 EQU   0                                                        09734000
AMSTP044 EQU   0                                                        09735000
CABUFH1  EQU   0                                                        09736000
CABUFL1  EQU   0                                                        09737000
CAT      EQU   0                                                        09738000
CATSN    EQU   0                                                        09739000
CFILE    EQU   0                                                        09740000
CFILECNT EQU   0                                                        09741000
CIN      EQU   0                                                        09742000
CRADNPTR EQU   0                                                        09743000
CRADVPTR EQU   0                                                        09744000
CRAVLPTR EQU   0                                                        09745000
CRBUF1   EQU   0                                                        09746000
CVOL     EQU   0                                                        09747000
CVOLCNT  EQU   0                                                        09748000
DMPTRM   EQU   0                                                        09749000
IDCIOCO0 EQU   0                                                        09750000
IDCIOIT0 EQU   0                                                        09751000
IDCIOPT0 EQU   0                                                        09752000
IDCIOSI0 EQU   0                                                        09753000
IDCIOST0 EQU   0                                                        09754000
IDCIOTM0 EQU   0                                                        09755000
IDCIOVY0 EQU   0                                                        09756000
IDCIO050 EQU   0                                                        09757000
IDCSAAL0 EQU   0                                                        09758000
IDCSACA0 EQU   0                                                        09759000
IDCSACL0 EQU   0                                                        09760000
IDCSACR0 EQU   0                                                        09761000
IDCSADE0 EQU   0                                                        09762000
IDCSADL0 EQU   0                                                        09763000
IDCSADQ0 EQU   0                                                        09764000
IDCSAEP0 EQU   0                                                        09765000
IDCSAFS0 EQU   0                                                        09766000
IDCSAGS0 EQU   0                                                        09767000
IDCSAID0 EQU   0                                                        09768000
IDCSALC0 EQU   0                                                        09769000
IDCSALD0 EQU   0                                                        09770000
IDCSALK0 EQU   0                                                        09771000
IDCSANQ0 EQU   0                                                        09772000
IDCSAPR0 EQU   0                                                        09773000
IDCSAPT0 EQU   0                                                        09774000
IDCSAQL0 EQU   0                                                        09775000
IDCSARC0 EQU   0                                                        09776000
IDCSARV0 EQU   0                                                        09777000
IDCSASC0 EQU   0                                                        09778000
IDCSASI0 EQU   0                                                        09779000
IDCSASN0 EQU   0                                                        09780000
IDCSASS0 EQU   0                                                        09781000
IDCSAST0 EQU   0                                                        09782000
IDCSATI0 EQU   0                                                        09783000
IDCSAUC0 EQU   0                                                        09784000
IDCSAWO0 EQU   0                                                        09785000
IDCSA060 EQU   0                                                        09786000
IDCST010 EQU   0                                                        09787000
IDCTPER0 EQU   0                                                        09788000
IGN      EQU   0                                                        09789000
LASTCC   EQU   0                                                        09790000
LISTTEST EQU   0                                                        09791000
NEWERID1 EQU   5                                                        09792000
NIGN     EQU   0                                                        09793000
NONE     EQU   0                                                        09794000
NONEPTR  EQU   0                                                        09795000
PTASSEX  EQU   0                                                        09796000
RABS     EQU   0                                                        09797000
WFBUF1   EQU   0                                                        09798000
WFBUF2   EQU   0                                                        09799000
WFDN     EQU   0                                                        09800000
RSWFLD   EQU   RABPROC                                                  09801000
RSWFKG1  EQU   RSWFLD+8                                                 09802000
RSWFCRA  EQU   RSWFKG1                                                  09803000
RSWDLCAT EQU   RSWFKG1                                                  09804000
RSWUPCAT EQU   RSWFKG1                                                  09805000
RSWRASCI EQU   RSWFKG1                                                  09806000
RSWASSCK EQU   RSWFKG1                                                  09807000
RSWFLG2  EQU   RSWFLD+9                                                 09808000
RSWDSDIR EQU   RSWFLG2                                                  09809000
RABARRAY EQU   GRABRABS                                                 09810000
BMAPARRY EQU   RSMAPS                                                   09811000
@NM00165 EQU   CATTR1                                                   09812000
CCATTR   EQU   @NM00165                                                 09813000
@NM00166 EQU   CCATTR                                                   09814000
@NM00168 EQU   CATTR1                                                   09815000
CRGATTR  EQU   @NM00168                                                 09816000
CUPG     EQU   CRGATTR                                                  09817000
DEVCHARS EQU   RABBUF+101                                               09818000
@NM00177 EQU   DEVCHARS                                                 09819000
RTDEVUCB EQU   @NM00177                                                 09820000
RTNOCYLS EQU   @NM00177+8                                               09821000
RTNOTRKS EQU   @NM00177+10                                              09822000
RTBOKAB  EQU   @NM00177+14                                              09823000
RTDVFLGS EQU   @NM00177+17                                              09824000
@NM00191 EQU   CTGDDNM                                                  09825000
CTGPROB  EQU   @NM00191                                                 09826000
CTGREASN EQU   CTGPROB+2                                                09827000
CVTS01   EQU   CVTPGSIA                                                 09828000
CVTLPDIA EQU   CVTS01+12                                                09829000
CVTDIRST EQU   CVTLPDIA                                                 09830000
CVTSLIDA EQU   CVTS01+24                                                09831000
CVTCTLFG EQU   CVTS01+50                                                09832000
CVTRV210 EQU   CVTS01+424                                               09833000
CVTRV219 EQU   CVTS01+425                                               09834000
CVTRV228 EQU   CVTS01+426                                               09835000
CVTRV237 EQU   CVTS01+427                                               09836000
CVTMFRTR EQU   CVTS01+452                                               09837000
CVTRV262 EQU   CVTS01+468                                               09838000
CVTRV271 EQU   CVTS01+469                                               09839000
CVTRV280 EQU   CVTS01+470                                               09840000
CVTRV289 EQU   CVTS01+471                                               09841000
CVTGSDA  EQU   CVTS01+600                                               09842000
F1TSCNVT EQU   RSVF1TS                                                  09843000
F1TSFIX  EQU   F1TSCNVT                                                 09844000
F1TSZNE  EQU   F1TSFIX                                                  09845000
F1TS1    EQU   RSVSCRNM+19                                              09846000
F1TS2    EQU   RSVSCRNM+28                                              09847000
TTRZ     EQU   IOCTTR                                                   09848000
TT       EQU   TTRZ                                                     09849000
R        EQU   TTRZ+2                                                   09850000
Z        EQU   TTRZ+3                                                   09851000
DRTS     EQU   RSVF1TS                                                  09852000
DRTS1    EQU   DRTS                                                     09853000
DRTS2    EQU   DRTS+7                                                   09854000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    09855000
F1TSDIG  EQU   F1TSFIX                                                  09856000
CVTRV628 EQU   CVTS01+728                                               09857000
CVTRV627 EQU   CVTS01+724                                               09858000
CVTRV626 EQU   CVTS01+720                                               09859000
CVTRV625 EQU   CVTS01+716                                               09860000
CVTRV624 EQU   CVTS01+712                                               09861000
CVTRV623 EQU   CVTS01+708                                               09862000
CVTRV622 EQU   CVTS01+704                                               09863000
CVTRV621 EQU   CVTS01+700                                               09864000
CVTIHASU EQU   CVTS01+696                                               09865000
CVTRV619 EQU   CVTS01+692                                               09866000
CVTRV618 EQU   CVTS01+688                                               09867000
CVTRV617 EQU   CVTS01+684                                               09868000
CVTRV616 EQU   CVTS01+680                                               09869000
CVTRV615 EQU   CVTS01+676                                               09870000
CVTRV614 EQU   CVTS01+672                                               09871000
CVTRV613 EQU   CVTS01+668                                               09872000
CVTTCASP EQU   CVTS01+664                                               09873000
CVT0PT03 EQU   CVTS01+660                                               09874000
CVT0PT0E EQU   CVTS01+656                                               09875000
CVTRV609 EQU   CVTS01+652                                               09876000
CVTCGK   EQU   CVTS01+648                                               09877000
CVTRAC   EQU   CVTS01+644                                               09878000
CVTRV606 EQU   CVTS01+640                                               09879000
CVTRV605 EQU   CVTS01+636                                               09880000
CVTRV604 EQU   CVTS01+632                                               09881000
CVTEFF02 EQU   CVTS01+628                                               09882000
CVTCBBR  EQU   CVTS01+624                                               09883000
CVTSSCR  EQU   CVTS01+620                                               09884000
CVTEVENT EQU   CVTS01+616                                               09885000
CVTCRCA  EQU   CVTS01+612                                               09886000
CVTTPIO  EQU   CVTS01+608                                               09887000
CVTADV   EQU   CVTS01+604                                               09888000
CVTGSDAB EQU   CVTGSDA                                                  09889000
CVTQV3   EQU   CVTS01+596                                               09890000
CVTQV2   EQU   CVTS01+592                                               09891000
CVTQV1   EQU   CVTS01+588                                               09892000
CVTRPT   EQU   CVTS01+584                                               09893000
CVTSSRB  EQU   CVTS01+580                                               09894000
CVTCSDRL EQU   CVTS01+576                                               09895000
CVTEXP1  EQU   CVTS01+572                                               09896000
CVTRMPMT EQU   CVTS01+568                                               09897000
CVTRMPTT EQU   CVTS01+564                                               09898000
CVTVPSA  EQU   CVTS01+560                                               09899000
CVTVSTOP EQU   CVTS01+556                                               09900000
CVTGTFR8 EQU   CVTS01+552                                               09901000
CVTQUIT  EQU   CVTS01+548                                               09902000
CVTVACR  EQU   CVTS01+544                                               09903000
CVTWTCB  EQU   CVTS01+540                                               09904000
CVTSTPRS EQU   CVTS01+536                                               09905000
CVT0PT02 EQU   CVTS01+532                                               09906000
CVTDARCM EQU   CVTS01+528                                               09907000
CVTIRECM EQU   CVTS01+524                                               09908000
CVTJRECM EQU   CVTS01+520                                               09909000
CVTVEMS0 EQU   CVTS01+516                                               09910000
CVTSPFRR EQU   CVTS01+512                                               09911000
CVTRLSTG EQU   CVTS01+508                                               09912000
CVT0TC0A EQU   CVTS01+504                                               09913000
CVTGMBR  EQU   CVTS01+500                                               09914000
CVTLFRM  EQU   CVTS01+496                                               09915000
CVTRMBR  EQU   CVTS01+492                                               09916000
CVTVIOP  EQU   CVTS01+488                                               09917000
CVTRV307 EQU   CVTS01+486                                               09918000
CVTRV306 EQU   CVTS01+484                                               09919000
CVTRV305 EQU   CVTS01+482                                               09920000
CVTRV304 EQU   CVTS01+480                                               09921000
CVTRV303 EQU   CVTS01+478                                               09922000
CVTRV302 EQU   CVTS01+476                                               09923000
CVTTRCA  EQU   CVTS01+472                                               09924000
CVTRV297 EQU   CVTRV289                                                 09925000
CVTRV296 EQU   CVTRV289                                                 09926000
CVTRV295 EQU   CVTRV289                                                 09927000
CVTRV294 EQU   CVTRV289                                                 09928000
CVTRV293 EQU   CVTRV289                                                 09929000
CVTRV292 EQU   CVTRV289                                                 09930000
CVTRV291 EQU   CVTRV289                                                 09931000
CVTRV290 EQU   CVTRV289                                                 09932000
CVTRV288 EQU   CVTRV280                                                 09933000
CVTRV287 EQU   CVTRV280                                                 09934000
CVTRV286 EQU   CVTRV280                                                 09935000
CVTRV285 EQU   CVTRV280                                                 09936000
CVTRV284 EQU   CVTRV280                                                 09937000
CVTRV283 EQU   CVTRV280                                                 09938000
CVTRV282 EQU   CVTRV280                                                 09939000
CVTRV281 EQU   CVTRV280                                                 09940000
CVTRV279 EQU   CVTRV271                                                 09941000
CVTRV278 EQU   CVTRV271                                                 09942000
CVTRV277 EQU   CVTRV271                                                 09943000
CVTRV276 EQU   CVTRV271                                                 09944000
CVTRV275 EQU   CVTRV271                                                 09945000
CVTRV274 EQU   CVTRV271                                                 09946000
CVTRV273 EQU   CVTRV271                                                 09947000
CVTRV272 EQU   CVTRV271                                                 09948000
CVTRV270 EQU   CVTRV262                                                 09949000
CVTRV269 EQU   CVTRV262                                                 09950000
CVTRV268 EQU   CVTRV262                                                 09951000
CVTRV267 EQU   CVTRV262                                                 09952000
CVTRV266 EQU   CVTRV262                                                 09953000
CVTRV265 EQU   CVTRV262                                                 09954000
CVTRV264 EQU   CVTRV262                                                 09955000
CVTRV263 EQU   CVTRV262                                                 09956000
CVTVFP   EQU   CVTS01+464                                               09957000
CVTVSI   EQU   CVTS01+460                                               09958000
CVTVPSIB EQU   CVTS01+456                                               09959000
CVTMFACT EQU   CVTMFRTR                                                 09960000
CVTMFCTL EQU   CVTS01+448                                               09961000
CVTPVBP  EQU   CVTS01+444                                               09962000
CVTPWI   EQU   CVTS01+440                                               09963000
CVTRV254 EQU   CVTS01+438                                               09964000
CVTRV253 EQU   CVTS01+436                                               09965000
CVTRV252 EQU   CVTS01+434                                               09966000
CVTRV251 EQU   CVTS01+433                                               09967000
CVTRV250 EQU   CVTS01+432                                               09968000
CVTRV249 EQU   CVTS01+431                                               09969000
CVTRV248 EQU   CVTS01+430                                               09970000
CVTRV247 EQU   CVTS01+429                                               09971000
CVTRV246 EQU   CVTS01+428                                               09972000
CVTRV245 EQU   CVTRV237                                                 09973000
CVTRV244 EQU   CVTRV237                                                 09974000
CVTRV243 EQU   CVTRV237                                                 09975000
CVTRV242 EQU   CVTRV237                                                 09976000
CVTRV241 EQU   CVTRV237                                                 09977000
CVTRV240 EQU   CVTRV237                                                 09978000
CVTRV239 EQU   CVTRV237                                                 09979000
CVTRV238 EQU   CVTRV237                                                 09980000
CVTRV236 EQU   CVTRV228                                                 09981000
CVTRV235 EQU   CVTRV228                                                 09982000
CVTRV234 EQU   CVTRV228                                                 09983000
CVTRV233 EQU   CVTRV228                                                 09984000
CVTRV232 EQU   CVTRV228                                                 09985000
CVTRV231 EQU   CVTRV228                                                 09986000
CVTRV230 EQU   CVTRV228                                                 09987000
CVTRV229 EQU   CVTRV228                                                 09988000
CVTRV227 EQU   CVTRV219                                                 09989000
CVTRV226 EQU   CVTRV219                                                 09990000
CVTRV225 EQU   CVTRV219                                                 09991000
CVTRV224 EQU   CVTRV219                                                 09992000
CVTRV223 EQU   CVTRV219                                                 09993000
CVTRV222 EQU   CVTRV219                                                 09994000
CVTRV221 EQU   CVTRV219                                                 09995000
CVTRV220 EQU   CVTRV219                                                 09996000
CVTRV218 EQU   CVTRV210                                                 09997000
CVTRV217 EQU   CVTRV210                                                 09998000
CVTRV216 EQU   CVTRV210                                                 09999000
CVTRV215 EQU   CVTRV210                                                 10000000
CVTRV214 EQU   CVTRV210                                                 10001000
CVTRV213 EQU   CVTRV210                                                 10002000
CVTRV212 EQU   CVTRV210                                                 10003000
CVTRV211 EQU   CVTRV210                                                 10004000
CVTLCCAT EQU   CVTS01+420                                               10005000
CVTPCCAT EQU   CVTS01+416                                               10006000
CVTIPCRP EQU   CVTS01+412                                               10007000
CVTIPCRI EQU   CVTS01+408                                               10008000
CVTIPCDS EQU   CVTS01+404                                               10009000
CVTAIDVT EQU   CVTS01+400                                               10010000
CVTSSAP  EQU   CVTS01+396                                               10011000
CVTEHCIR EQU   CVTS01+392                                               10012000
CVTEHDEF EQU   CVTS01+388                                               10013000
CVTDAIR  EQU   CVTS01+384                                               10014000
CVTPERFM EQU   CVTS01+380                                               10015000
CVT044R2 EQU   CVTS01+376                                               10016000
CVTFETCH EQU   CVTS01+372                                               10017000
CVTRSTWD EQU   CVTS01+368                                               10018000
CVTSPOST EQU   CVTS01+364                                               10019000
CVTIOBP  EQU   CVTS01+360                                               10020000
CVTASMVT EQU   CVTS01+356                                               10021000
CVTRECRQ EQU   CVTS01+352                                               10022000
CVTWSAC  EQU   CVTS01+348                                               10023000
CVTRV149 EQU   CVTS01+344                                               10024000
CVTWSAL  EQU   CVTS01+340                                               10025000
CVTSPSA  EQU   CVTS01+336                                               10026000
CVTGLMN  EQU   CVTS01+332                                               10027000
CVTVEAC0 EQU   CVTS01+328                                               10028000
CVT062R1 EQU   CVTS01+324                                               10029000
CVTRPOST EQU   CVTS01+320                                               10030000
CVTDQIQE EQU   CVTS01+316                                               10031000
CVTCSD   EQU   CVTS01+312                                               10032000
CVTLKRMA EQU   CVTS01+308                                               10033000
CVTRSPIE EQU   CVTS01+304                                               10034000
CVTRENQ  EQU   CVTS01+300                                               10035000
CVTLQCB  EQU   CVTS01+296                                               10036000
CVTFQCB  EQU   CVTS01+292                                               10037000
CVTQCS01 EQU   CVTS01+288                                               10038000
CVTAPFT  EQU   CVTS01+284                                               10039000
CVTPARRL EQU   CVTS01+280                                               10040000
CVTVWAIT EQU   CVTS01+276                                               10041000
CVTGSPL  EQU   CVTS01+272                                               10042000
CVTLSMQ  EQU   CVTS01+268                                               10043000
CVTGSMQ  EQU   CVTS01+264                                               10044000
CVTEXPRO EQU   CVTS01+260                                               10045000
CVTOPCTP EQU   CVTS01+256                                               10046000
CVTSIC   EQU   CVTS01+252                                               10047000
CVTTPIOS EQU   CVTS01+248                                               10048000
CVTRTMS  EQU   CVTS01+244                                               10049000
CVTSDBF  EQU   CVTS01+240                                               10050000
CVTSCBP  EQU   CVTS01+236                                               10051000
CVTSDMP  EQU   CVTS01+232                                               10052000
CVTSV60  EQU   CVTS01+228                                               10053000
CVTRTMCT EQU   CVTS01+224                                               10054000
CVTASCBL EQU   CVTS01+220                                               10055000
CVTASCBH EQU   CVTS01+216                                               10056000
CVTGDA   EQU   CVTS01+212                                               10057000
CVTASVT  EQU   CVTS01+208                                               10058000
CVTVVMDI EQU   CVTS01+204                                               10059000
CVTAQTOP EQU   CVTS01+200                                               10060000
CVTIOSCS EQU   CVTS01+196                                               10061000
CVTSDRM  EQU   CVTS01+192                                               10062000
CVTOPTE  EQU   CVTS01+188                                               10063000
CVTSTXU  EQU   CVTS01+184                                               10064000
CVTQUIS  EQU   CVTS01+180                                               10065000
CVTPARS  EQU   CVTS01+176                                               10066000
CVTS1EE  EQU   CVTS01+172                                               10067000
CVTFRAS  EQU   CVTS01+168                                               10068000
CVTQSAS  EQU   CVTS01+164                                               10069000
CVTCRAS  EQU   CVTS01+160                                               10070000
CVTCRMN  EQU   CVTS01+156                                               10071000
CVTDELCP EQU   CVTS01+152                                               10072000
CVTFRECL EQU   CVTS01+148                                               10073000
CVTGETCL EQU   CVTS01+144                                               10074000
CVTBLDCP EQU   CVTS01+140                                               10075000
CVTAUTHL EQU   CVTS01+136                                               10076000
CVTSCAN  EQU   CVTS01+132                                               10077000
CVTRV144 EQU   CVTS01+130                                               10078000
CVTMAXMP EQU   CVTS01+128                                               10079000
CVTSTCK  EQU   CVTS01+124                                               10080000
CVTRV139 EQU   CVTS01+123                                               10081000
CVTDSSAC EQU   CVTS01+122                                               10082000
CVTRV513 EQU   CVTS01+121                                               10083000
CVTIOSPL EQU   CVTS01+120                                               10084000
CVTPTGT  EQU   CVTS01+116                                               10085000
CVTCSPIE EQU   CVTS01+112                                               10086000
CVTSMFEX EQU   CVTS01+108                                               10087000
CVTOLT0A EQU   CVTS01+104                                               10088000
CVTSRBRT EQU   CVTS01+100                                               10089000
CVTPUTL  EQU   CVTS01+96                                                10090000
CVTASCRL EQU   CVTS01+92                                                10091000
CVTASCRF EQU   CVTS01+88                                                10092000
CVTRV326 EQU   CVTS01+84                                                10093000
CVTRV325 EQU   CVTS01+80                                                10094000
CVTRV324 EQU   CVTS01+76                                                10095000
CVT0VL01 EQU   CVTS01+72                                                10096000
CVTSHRVM EQU   CVTS01+68                                                10097000
CVTRV332 EQU   CVTS01+64                                                10098000
CVTTAS   EQU   CVTS01+60                                                10099000
CVTRSCN  EQU   CVTS01+56                                                10100000
CVTTRAC2 EQU   CVTS01+54                                                10101000
CVTTRACE EQU   CVTS01+52                                                10102000
CVTAPG   EQU   CVTS01+51                                                10103000
CVTSDTRC EQU   CVTCTLFG                                                 10104000
CVTGTRCE EQU   CVTCTLFG                                                 10105000
CVTNOMP  EQU   CVTCTLFG                                                 10106000
CVTRSV79 EQU   CVTCTLFG                                                 10107000
CVTDSTAT EQU   CVTCTLFG                                                 10108000
CVTRSV78 EQU   CVTCTLFG                                                 10109000
CVTRV333 EQU   CVTCTLFG                                                 10110000
CVTRV323 EQU   CVTCTLFG                                                 10111000
CVTSPVLK EQU   CVTS01+49                                                10112000
CVTRSV77 EQU   CVTS01+48                                                10113000
CVTRV331 EQU   CVTS01+44                                                10114000
CVTRV330 EQU   CVTS01+40                                                10115000
CVTRV329 EQU   CVTS01+36                                                10116000
CVTRV328 EQU   CVTS01+32                                                10117000
CVTRV322 EQU   CVTS01+28                                                10118000
CVTSLID  EQU   CVTSLIDA+1                                               10119000
CVTSYLK  EQU   CVTSLIDA                                                 10120000
CVTRV321 EQU   CVTS01+20                                                10121000
CVTRV320 EQU   CVTS01+16                                                10122000
CVTLPDIR EQU   CVTLPDIA+1                                               10123000
CVTRSV69 EQU   CVTDIRST                                                 10124000
CVTRSV68 EQU   CVTDIRST                                                 10125000
CVTRSV67 EQU   CVTDIRST                                                 10126000
CVTRSV66 EQU   CVTDIRST                                                 10127000
CVTRSV65 EQU   CVTDIRST                                                 10128000
CVTRSV64 EQU   CVTDIRST                                                 10129000
CVTRSV63 EQU   CVTDIRST                                                 10130000
CVTDICOM EQU   CVTDIRST                                                 10131000
CVTPVTP  EQU   CVTS01+8                                                 10132000
CVTLPDSR EQU   CVTS01+4                                                 10133000
CVTGETL  EQU   CVTS01                                                   10134000
CTGREAS2 EQU   CTGREASN+1                                               10135000
CTGREAS1 EQU   CTGREASN                                                 10136000
CTGMODID EQU   CTGPROB                                                  10137000
RTTOLFCT EQU   @NM00177+18                                              10138000
RTTOLFLG EQU   RTDVFLGS                                                 10139000
@NM00180 EQU   RTDVFLGS                                                 10140000
RTKABFLG EQU   RTDVFLGS                                                 10141000
@NM00179 EQU   RTDVFLGS                                                 10142000
RTBONK   EQU   @NM00177+16                                              10143000
RTBOKLB  EQU   RTBOKAB+1                                                10144000
RTBOKNLB EQU   RTBOKAB                                                  10145000
RTTRKSIZ EQU   @NM00177+12                                              10146000
RTMXDBLK EQU   @NM00177+4                                               10147000
RTCLSTYP EQU   RTDEVUCB+2                                               10148000
@NM00178 EQU   RTDEVUCB                                                 10149000
@NM00169 EQU   CRGATTR                                                  10150000
CUPD     EQU   CUPG                                                     10151000
CPGSP    EQU   @NM00166                                                 10152000
@NM00167 EQU   @NM00166                                                 10153000
@NM00094 EQU   RSWFLG2                                                  10154000
RSWCHRA  EQU   RSWFLG2                                                  10155000
RSWCHNRR EQU   RSWFLG2                                                  10156000
RSWUPCCH EQU   RSWFLG2                                                  10157000
RSWDICHK EQU   RSWFLG2                                                  10158000
RSWDUPRR EQU   RSWFLG2                                                  10159000
RSWINVCI EQU   RSWFLG2                                                  10160000
RSWDUPCI EQU   RSWFKG1                                                  10161000
@NM00093 EQU   RSWFKG1                                                  10162000
RSWUPCRA EQU   RSWFKG1                                                  10163000
RSWDUPTR EQU   RSWFLD+4                                                 10164000
RSWCHPTR EQU   RSWFLD                                                   10165000
@NM00227 EQU   FMT3DSCB+135                                             10166000
@NM00226 EQU   FMT3EXTB                                                 10167000
@NM00225 EQU   FMT3DSCB+44                                              10168000
@NM00224 EQU   FMT3EXTA                                                 10169000
@NM00223 EQU   FMT3DSCB                                                 10170000
FMT1SEQ  EQU   FMT1EXTS+1                                               10171000
FMT1EXTY EQU   FMT1EXTS                                                 10172000
@NM00222 EQU   FMT1DSCB+84                                              10173000
@NM00221 EQU   FMT1ORG                                                  10174000
@NM00220 EQU   FMT1ORG                                                  10175000
@NM00219 EQU   FMT1DSCB+60                                              10176000
@NM00218 EQU   FMT1DSCB+45                                              10177000
AMDEXCP  EQU   AMDSTAT+44                                               10178000
AMDNCAS  EQU   AMDSTAT+40                                               10179000
AMDNCIS  EQU   AMDSTAT+36                                               10180000
AMDASPA  EQU   AMDSTAT+32                                               10181000
AMDRETR  EQU   AMDSTAT+28                                               10182000
AMDUPR   EQU   AMDSTAT+24                                               10183000
AMDIREC  EQU   AMDSTAT+20                                               10184000
AMDDELR  EQU   AMDSTAT+16                                               10185000
AMDNLR   EQU   AMDSTAT+12                                               10186000
AMDNEXT  EQU   AMDSTAT+10                                               10187000
AMDNIL   EQU   AMDSTAT+8                                                10188000
AMDSTSP  EQU   AMDSTAT                                                  10189000
@NM00215 EQU   IDAAMDSB+41                                              10190000
@NM00214 EQU   AMDATTR3                                                 10191000
AMDLM    EQU   AMDATTR3                                                 10192000
AMDWAIT  EQU   AMDATTR3                                                 10193000
AMDBIND  EQU   AMDATTR3                                                 10194000
AMDFAULT EQU   AMDATTR3                                                 10195000
AMDUNQ   EQU   AMDATTR3                                                 10196000
AMDPARDB EQU   IDAAMDSB+36                                              10197000
AMDMAXRR EQU   AMDSSRBA                                                 10198000
AMDNSLOT EQU   AMDHLRBA                                                 10199000
AMDLRECL EQU   IDAAMDSB+24                                              10200000
AMDCINV  EQU   IDAAMDSB+20                                              10201000
AMDFSCI  EQU   IDAAMDSB+16                                              10202000
AMDFSCA  EQU   IDAAMDSB+14                                              10203000
AMDCIPCA EQU   IDAAMDSB+12                                              10204000
AMDPCTCI EQU   IDAAMDSB+11                                              10205000
AMDPCTCA EQU   IDAAMDSB+10                                              10206000
AMDKEYLN EQU   IDAAMDSB+8                                               10207000
AMDRKP   EQU   IDAAMDSB+6                                               10208000
AMDAXRKP EQU   AMDNEST                                                  10209000
AMDLEN   EQU   IDAAMDSB+2                                               10210000
AMDSPAN  EQU   AMDATTR                                                  10211000
AMDRRDS  EQU   AMDATTR                                                  10212000
AMDRANGE EQU   AMDATTR                                                  10213000
AMDORDER EQU   AMDATTR                                                  10214000
AMDREPL  EQU   AMDATTR                                                  10215000
AMDSDT   EQU   AMDATTR                                                  10216000
AMDWCK   EQU   AMDATTR                                                  10217000
AMDDST   EQU   AMDATTR                                                  10218000
AMDSBID  EQU   IDAAMDSB                                                 10219000
ACBAPID  EQU   ACBCOMN+72                                               10220000
ACBCBMWA EQU   ACBCOMN+68                                               10221000
ACBUAPTR EQU   ACBCOMN+64                                               10222000
ACBLRECL EQU   ACBCOMN+62                                               10223000
ACBMSGLN EQU   ACBBLKSZ                                                 10224000
ACBBUFSP EQU   ACBCOMN+56                                               10225000
@NM00213 EQU   ACBUJFCB+1                                               10226000
ACBOPTN  EQU   ACBUJFCB                                                 10227000
@NM00212 EQU   ACBINFLG+1                                               10228000
ACBBYPSS EQU   ACBINFLG                                                 10229000
ACBSDS   EQU   ACBVVIC                                                  10230000
ACBUCRA  EQU   ACBINFLG                                                 10231000
ACBSCRA  EQU   ACBINFLG                                                 10232000
ACBCAT   EQU   ACBINFLG                                                 10233000
ACBIJRQE EQU   ACBINFLG                                                 10234000
ACBJEPS  EQU   ACBINFLG                                                 10235000
@NM00211 EQU   ACBINFLG                                                 10236000
ACBERFLG EQU   ACBCOMN+49                                               10237000
ACBBUSY  EQU   ACBIOSFG                                                 10238000
ACBLOCK  EQU   ACBEXFG                                                  10239000
@NM00210 EQU   ACBOFLGS                                                 10240000
ACBDSERR EQU   ACBOFLGS                                                 10241000
ACBOPEN  EQU   ACBOFLGS                                                 10242000
ACBEOV   EQU   ACBOFLGS                                                 10243000
@NM00209 EQU   ACBOFLGS                                                 10244000
ACBDEB   EQU   ACBDDNM+5                                                10245000
ACBERFL  EQU   ACBDDNM+4                                                10246000
ACBAM    EQU   ACBAMETH                                                 10247000
ACBINFL  EQU   ACBDDNM+2                                                10248000
ACBTIOT  EQU   ACBDDNM                                                  10249000
ACBUEL   EQU   ACBEXLST                                                 10250000
ACBPASSW EQU   ACBCOMN+32                                               10251000
ACBMSGAR EQU   ACBCOMN+28                                               10252000
@NM00208 EQU   ACBDSORG+1                                               10253000
ACBDORGA EQU   ACBDSORG+1                                               10254000
@NM00207 EQU   ACBDSORG                                                 10255000
ACBOPTJ  EQU   ACBDVIND                                                 10256000
ACBCRNRE EQU   ACBCROPS                                                 10257000
ACBCRNCK EQU   ACBCROPS                                                 10258000
ACBASA   EQU   ACBCCTYP                                                 10259000
@NM00206 EQU   ACBCCTYP                                                 10260000
ACBTRCID EQU   ACBCCTYP                                                 10261000
@NM00205 EQU   ACBRECFM                                                 10262000
ACBRECAF EQU   ACBRECFM                                                 10263000
ACBJBUF  EQU   ACBBUFPL+2                                               10264000
ACBMACR4 EQU   ACBBUFPL+1                                               10265000
@NM00204 EQU   ACBMACR3                                                 10266000
ACBNCFX  EQU   ACBMACR3                                                 10267000
ACBSIS   EQU   ACBMACR3                                                 10268000
ACBDFR   EQU   ACBMACR3                                                 10269000
ACBICI   EQU   ACBMACR3                                                 10270000
ACBGSR   EQU   ACBMACR3                                                 10271000
ACBLSR   EQU   ACBMACR3                                                 10272000
@NM00203 EQU   ACBMACR3                                                 10273000
ACBBUFNI EQU   ACBCOMN+18                                               10274000
ACBBUFND EQU   ACBCOMN+16                                               10275000
ACBSTRNO EQU   ACBCOMN+15                                               10276000
ACBBSTNO EQU   ACBCOMN+14                                               10277000
ACBAIX   EQU   ACBMACR2                                                 10278000
ACBDSN   EQU   ACBMACR2                                                 10279000
ACBRST   EQU   ACBMACR2                                                 10280000
ACBLOGON EQU   ACBMACR2                                                 10281000
ACBSKP   EQU   ACBMACR2                                                 10282000
@NM00202 EQU   ACBMACR2                                                 10283000
ACBUBF   EQU   ACBMACR1                                                 10284000
ACBOUT   EQU   ACBMACR1                                                 10285000
ACBIN    EQU   ACBMACR1                                                 10286000
ACBDIR   EQU   ACBMACR1                                                 10287000
ACBSEQ   EQU   ACBMACR1                                                 10288000
ACBBLK   EQU   ACBCNV                                                   10289000
ACBADD   EQU   ACBADR                                                   10290000
ACBKEY   EQU   ACBMACR1                                                 10291000
ACBINRTN EQU   ACBCOMN+8                                                10292000
ACBIBCT  EQU   ACBJWA                                                   10293000
ACBLEN2  EQU   ACBLENG2                                                 10294000
ACBSTYP  EQU   ACBCOMN+1                                                10295000
ACBID    EQU   ACBCOMN                                                  10296000
CAXCRACB EQU   IGGCAXWA+112                                             10297000
CAXJDE   EQU   IGGCAXWA+108                                             10298000
CAXCCA   EQU   IGGCAXWA+104                                             10299000
CAXOPEWA EQU   IGGCAXWA+100                                             10300000
COPACB   EQU   CAXOPLST+1                                               10301000
@NM00201 EQU   COPTS                                                    10302000
CENLST   EQU   COPTS                                                    10303000
@NM00200 EQU   CAXCNAM+22                                               10304000
CAXRADDN EQU   CAXCNAM+14                                               10305000
CAXRATEP EQU   CAXCNAM+10                                               10306000
CAXRACTS EQU   CAXCNAM+6                                                10307000
CAXVOLID EQU   CAXCNAM                                                  10308000
CAXRPL   EQU   IGGCAXWA+48                                              10309000
CAXRPLCT EQU   IGGCAXWA+46                                              10310000
CAXASID  EQU   IGGCAXWA+44                                              10311000
CAXFDCI  EQU   CAXCCR+9                                                 10312000
CAXCDCI  EQU   CAXCCR+6                                                 10313000
CAXNFCI  EQU   CAXCCR+3                                                 10314000
CAXHACI  EQU   CAXCCR                                                   10315000
CAXUCB   EQU   IGGCAXWA+28                                              10316000
CAXACB   EQU   IGGCAXWA+24                                              10317000
CAXDRWP  EQU   IGGCAXWA+20                                              10318000
CAXSCHWA EQU   IGGCAXWA+16                                              10319000
CAXATIOT EQU   IGGCAXWA+12                                              10320000
CAXACT   EQU   IGGCAXWA+11                                              10321000
@NM00199 EQU   CAXFLG3                                                  10322000
CAXF3B6  EQU   CAXFLG3                                                  10323000
CAXF3B5  EQU   CAXFLG3                                                  10324000
@NM00198 EQU   CAXFLG3                                                  10325000
CAXF3ANE EQU   CAXFLG3                                                  10326000
CAXF3AT  EQU   CAXFLG3                                                  10327000
CAXF2VTU EQU   CAXFLG2                                                  10328000
CAXF2REC EQU   CAXFLG2                                                  10329000
CAXF2CA  EQU   CAXFLG2                                                  10330000
CAXF2CLR EQU   CAXFLG2                                                  10331000
CAXF2IOE EQU   CAXFLG2                                                  10332000
CAXF2NCR EQU   CAXFLG2                                                  10333000
CAXF2NDD EQU   CAXFLG2                                                  10334000
CAXF2DT  EQU   CAXFLG2                                                  10335000
CAXSCR   EQU   CAXFLGS                                                  10336000
CAXCMR   EQU   CAXFLGS                                                  10337000
CAXMCT   EQU   CAXFLGS                                                  10338000
CAXCMP   EQU   CAXFLGS                                                  10339000
CAXEOV   EQU   CAXFLGS                                                  10340000
CAXCLS   EQU   CAXFLGS                                                  10341000
CAXOPN   EQU   CAXFLGS                                                  10342000
CAXBLD   EQU   CAXFLGS                                                  10343000
CAXCHN   EQU   IGGCAXWA+4                                               10344000
@NM00197 EQU   IGGCAXWA+1                                               10345000
CAXID    EQU   IGGCAXWA                                                 10346000
CBSVPTR  EQU   CBSVSRT+4                                                10347000
CBSVUSE  EQU   CBSVSRT                                                  10348000
CBSCRTCB EQU   AMCBS+28                                                 10349000
CBSCRACA EQU   AMCBS+24                                                 10350000
CBSCAXCN EQU   AMCBS+20                                                 10351000
CBSMCUCB EQU   CBSCMP                                                   10352000
CBSCBP   EQU   AMCBS+12                                                 10353000
CBSACB   EQU   AMCBS+8                                                  10354000
CBSMCSTA EQU   AMCBS+4                                                  10355000
CBSSIZ   EQU   AMCBS+2                                                  10356000
CBSID    EQU   AMCBS                                                    10357000
CVTLEVL  EQU   CVTRELNO+2                                               10358000
CVTNUMB  EQU   CVTRELNO                                                 10359000
CVTMDL   EQU   CVTFIX+250                                               10360000
@NM00196 EQU   CVTFIX+248                                               10361000
@NM00195 EQU   CVTFIX                                                   10362000
CVTRV482 EQU   CVTXTNT2+128                                             10363000
CVTRV481 EQU   CVTXTNT2+124                                             10364000
CVTRV480 EQU   CVTXTNT2+120                                             10365000
CVTRV479 EQU   CVTXTNT2+118                                             10366000
CVTRV478 EQU   CVTXTNT2+117                                             10367000
CVTRV477 EQU   CVTXTNT2+116                                             10368000
CVTRV476 EQU   CVTXTNT2+115                                             10369000
CVTRV475 EQU   CVTXTNT2+114                                             10370000
CVTRV474 EQU   CVTRV466                                                 10371000
CVTRV473 EQU   CVTRV466                                                 10372000
CVTRV472 EQU   CVTRV466                                                 10373000
CVTRV471 EQU   CVTRV466                                                 10374000
CVTRV470 EQU   CVTRV466                                                 10375000
CVTRV469 EQU   CVTRV466                                                 10376000
CVTRV468 EQU   CVTRV466                                                 10377000
CVTRV467 EQU   CVTRV466                                                 10378000
CVTRV465 EQU   CVTRV457                                                 10379000
CVTRV464 EQU   CVTRV457                                                 10380000
CVTRV463 EQU   CVTRV457                                                 10381000
CVTRV462 EQU   CVTRV457                                                 10382000
CVTRV461 EQU   CVTRV457                                                 10383000
CVTRV460 EQU   CVTRV457                                                 10384000
CVTRV459 EQU   CVTRV457                                                 10385000
CVTRV458 EQU   CVTRV457                                                 10386000
CVTRV456 EQU   CVTXTNT2+108                                             10387000
CVTRV455 EQU   CVTXTNT2+104                                             10388000
CVTRV454 EQU   CVTXTNT2+100                                             10389000
CVTRV453 EQU   CVTXTNT2+96                                              10390000
CVTRV452 EQU   CVTXTNT2+94                                              10391000
CVTRV451 EQU   CVTXTNT2+92                                              10392000
CVTRV450 EQU   CVTXTNT2+90                                              10393000
CVTRV449 EQU   CVTXTNT2+88                                              10394000
CVTRV448 EQU   CVTXTNT2+87                                              10395000
CVTRV447 EQU   CVTXTNT2+86                                              10396000
CVTRV446 EQU   CVTRV438                                                 10397000
CVTRV445 EQU   CVTRV438                                                 10398000
CVTRV444 EQU   CVTRV438                                                 10399000
CVTRV443 EQU   CVTRV438                                                 10400000
CVTRV442 EQU   CVTRV438                                                 10401000
CVTRV441 EQU   CVTRV438                                                 10402000
CVTRV440 EQU   CVTRV438                                                 10403000
CVTRV439 EQU   CVTRV438                                                 10404000
CVTRV437 EQU   CVTRV429                                                 10405000
CVTRV436 EQU   CVTRV429                                                 10406000
CVTRV435 EQU   CVTRV429                                                 10407000
CVTRV434 EQU   CVTRV429                                                 10408000
CVTRV433 EQU   CVTRV429                                                 10409000
CVTRV432 EQU   CVTRV429                                                 10410000
CVTRV431 EQU   CVTRV429                                                 10411000
CVTRV430 EQU   CVTRV429                                                 10412000
CVTRV428 EQU   CVTXTNT2+80                                              10413000
CVTRV427 EQU   CVTXTNT2+76                                              10414000
CVTRV426 EQU   CVTXTNT2+72                                              10415000
CVTRV425 EQU   CVTXTNT2+68                                              10416000
CVTATACT EQU   CVTATCVT                                                 10417000
CVTRV423 EQU   CVTXTNT2+62                                              10418000
CVTRV422 EQU   CVTXTNT2+60                                              10419000
CVTRV421 EQU   CVTXTNT2+58                                              10420000
CVTRV420 EQU   CVTXTNT2+56                                              10421000
CVTRV419 EQU   CVTXTNT2+55                                              10422000
CVTRV418 EQU   CVTXTNT2+54                                              10423000
CVTRV417 EQU   CVTRV409                                                 10424000
CVTRV416 EQU   CVTRV409                                                 10425000
CVTRV415 EQU   CVTRV409                                                 10426000
CVTRV414 EQU   CVTRV409                                                 10427000
CVTRV413 EQU   CVTRV409                                                 10428000
CVTRV412 EQU   CVTRV409                                                 10429000
CVTRV411 EQU   CVTRV409                                                 10430000
CVTRV410 EQU   CVTRV409                                                 10431000
CVTRV408 EQU   CVTRV400                                                 10432000
CVTRV407 EQU   CVTRV400                                                 10433000
CVTRV406 EQU   CVTRV400                                                 10434000
CVTRV405 EQU   CVTRV400                                                 10435000
CVTRV404 EQU   CVTRV400                                                 10436000
CVTRV403 EQU   CVTRV400                                                 10437000
CVTRV402 EQU   CVTRV400                                                 10438000
CVTRV401 EQU   CVTRV400                                                 10439000
CVTICB   EQU   CVTXTNT2+48                                              10440000
CVTSKTA  EQU   CVTXTNT2+44                                              10441000
CVTRSV99 EQU   CVTXTNT2+40                                              10442000
CVTRSV98 EQU   CVTXTNT2+36                                              10443000
CVTRSV97 EQU   CVTXTNT2+34                                              10444000
CVTRSV96 EQU   CVTXTNT2+32                                              10445000
CVTOLTEP EQU   CVTXTNT2+28                                              10446000
CVTQIDA  EQU   CVTQID+1                                                 10447000
CVTRSV95 EQU   CVTQID                                                   10448000
CVTRSV94 EQU   CVTXTNT2+20                                              10449000
CVTRSV93 EQU   CVTXTNT2+16                                              10450000
CVTRSV92 EQU   CVTXTNT2+12                                              10451000
CVTDEBVR EQU   CVTXTNT2+8                                               10452000
CVTRSV91 EQU   CVTXTNT2+6                                               10453000
CVTRSV9H EQU   CVTFLGBT                                                 10454000
CVTRSV9G EQU   CVTFLGBT                                                 10455000
CVTRSV9F EQU   CVTFLGBT                                                 10456000
CVTRSV9E EQU   CVTFLGBT                                                 10457000
CVTRSV9D EQU   CVTFLGBT                                                 10458000
CVTRSV9C EQU   CVTFLGBT                                                 10459000
CVTVME   EQU   CVTFLGBT                                                 10460000
CVTNPE   EQU   CVTFLGBT                                                 10461000
CVTNUCLS EQU   CVTXTNT2+4                                               10462000
CVTDSSVA EQU   CVTDSSV+1                                                10463000
CVTRSV89 EQU   CVTDSSV                                                  10464000
CVTRSV88 EQU   CVTXTNT1+8                                               10465000
CVTRSV87 EQU   CVTXTNT1+4                                               10466000
CVTFACHN EQU   CVTXTNT1                                                 10467000
CVTRV488 EQU   CVTMAP+412                                               10468000
CVTRV487 EQU   CVTMAP+408                                               10469000
CVTRV486 EQU   CVTMAP+404                                               10470000
CVTRV485 EQU   CVTMAP+400                                               10471000
CVTACTAP EQU   CVTMAP+396                                               10472000
CVTAUTH  EQU   CVTMAP+392                                               10473000
CVTATMCA EQU   CVTATMCT+1                                               10474000
CVTATMST EQU   CVTATMCT                                                 10475000
CVTRSV61 EQU   CVTMAP+384                                               10476000
CVTVOLT1 EQU   CVTVOLM1+1                                               10477000
CVTVOLI1 EQU   CVTVOLF1                                                 10478000
CVTSTOA  EQU   CVTMAP+376                                               10479000
CVTRSV58 EQU   CVTMAP+374                                               10480000
CVTRSV57 EQU   CVTMAP+372                                               10481000
CVTDDCE  EQU   CVTMAP+368                                               10482000
CVTPNWFR EQU   CVTMAP+364                                               10483000
CVTSMF   EQU   CVTMAP+360                                               10484000
CVTSULK  EQU   CVTMAP+358                                               10485000
CVTSLKO  EQU   CVTSYSK                                                  10486000
CVTSLKP  EQU   CVTSYSK                                                  10487000
CVTSLKQ  EQU   CVTSYSK                                                  10488000
CVTSLKR  EQU   CVTSYSK                                                  10489000
CVTRSV56 EQU   CVTSYSK                                                  10490000
CVTRSV55 EQU   CVTSYSK                                                  10491000
CVTRSV54 EQU   CVTSYSK                                                  10492000
CVTRSV53 EQU   CVTSYSK                                                  10493000
CVTRSV52 EQU   CVTA1F1                                                  10494000
CVTRSV51 EQU   CVTA1F1                                                  10495000
CVTRSV50 EQU   CVTA1F1                                                  10496000
CVTRSV49 EQU   CVTA1F1                                                  10497000
CVTRSV48 EQU   CVTA1F1                                                  10498000
CVTRSV47 EQU   CVTA1F1                                                  10499000
CVTSRSW  EQU   CVTA1F1                                                  10500000
CVTPFSW  EQU   CVTA1F1                                                  10501000
CVTPCVT  EQU   CVTMAP+352                                               10502000
CVTRSV46 EQU   CVTMAP+344                                               10503000
CVTRSV45 EQU   CVTMAP+340                                               10504000
CVTRSV44 EQU   CVTMAP+338                                               10505000
CVTRSV43 EQU   CVTMAP+336                                               10506000
CVTHJESA EQU   CVTHJES+1                                                10507000
CVTRSV42 EQU   CVTHJES                                                  10508000
CVTEXT2A EQU   CVTEXT2+1                                                10509000
CVTRSV41 EQU   CVTEXT2                                                  10510000
CVTAPFA  EQU   CVTAPF+1                                                 10511000
CVTRSV40 EQU   CVTAPF                                                   10512000
CVTRV518 EQU   CVTINTLA                                                 10513000
CVTRV517 EQU   CVTERPV                                                  10514000
CVTEORM  EQU   CVTMAP+312                                               10515000
CVTMCHPR EQU   CVTMAP+308                                               10516000
CVTTZ    EQU   CVTMAP+304                                               10517000
CVTJEPS  EQU   CVTMAP+300                                               10518000
CVTJESCT EQU   CVTMAP+296                                               10519000
CVTMODE  EQU   CVTMAP+292                                               10520000
CVTPTRV  EQU   CVTMAP+288                                               10521000
CVTREAL  EQU   CVTMAP+284                                               10522000
CVTRSV39 EQU   CVTMAP+280                                               10523000
CVTRSV38 EQU   CVTMAP+276                                               10524000
CVTDMSRA EQU   CVTDMSR+1                                                10525000
CVTRV634 EQU   CVTDMSRF                                                 10526000
CVTRV633 EQU   CVTDMSRF                                                 10527000
CVTRV632 EQU   CVTDMSRF                                                 10528000
CVTRV631 EQU   CVTDMSRF                                                 10529000
CVTRV630 EQU   CVTDMSRF                                                 10530000
CVTRV629 EQU   CVTDMSRF                                                 10531000
CVTUDUMP EQU   CVTDMSRF                                                 10532000
CVTSDUMP EQU   CVTDMSRF                                                 10533000
CVTQMSGA EQU   CVTQMSG+1                                                10534000
CVTRSV36 EQU   CVTQMSG                                                  10535000
CVTAMFF  EQU   CVTMAP+264                                               10536000
CVTPURGA EQU   CVTPURG+1                                                10537000
CVTRSV35 EQU   CVTPURG                                                  10538000
CVTCBSP  EQU   CVTMAP+256                                               10539000
CVTATERA EQU   CVTATER+1                                                10540000
CVTSYST  EQU   CVTATER                                                  10541000
CVTVOLT2 EQU   CVTTAT                                                   10542000
CVTVOLI2 EQU   CVTVOLF2                                                 10543000
CVTAQAVB EQU   CVTAQAVT+1                                               10544000
CVTRSV34 EQU   CVTTCMFG                                                 10545000
CVTRSV33 EQU   CVTTCMFG                                                 10546000
CVTRSV32 EQU   CVTTCMFG                                                 10547000
CVTRSV31 EQU   CVTTCMFG                                                 10548000
CVTRSV30 EQU   CVTTCMFG                                                 10549000
CVTRSV29 EQU   CVTTCMFG                                                 10550000
CVTRSV28 EQU   CVTTCMFG                                                 10551000
CVTTCRDY EQU   CVTTCMFG                                                 10552000
CVTGTFA  EQU   CVTGTF+1                                                 10553000
CVTRSV27 EQU   CVTGTFST                                                 10554000
CVTRNIO  EQU   CVTGTFST                                                 10555000
CVTUSR   EQU   CVTGTFST                                                 10556000
CVTRV318 EQU   CVTFORM                                                  10557000
CVTRV317 EQU   CVTTMODE                                                 10558000
CVTRV316 EQU   CVTSTATE                                                 10559000
CVTRV315 EQU   CVTGTFS                                                  10560000
CVTGTFAV EQU   CVTGTFS                                                  10561000
CVT0SCR1 EQU   CVTMAP+232                                               10562000
CVTRV515 EQU   CVTMAP+228                                               10563000
CVTRMS   EQU   CVTMAP+224                                               10564000
CVTPATCH EQU   CVTMAP+220                                               10565000
CVTTSCE  EQU   CVTMAP+216                                               10566000
CVTLNKSC EQU   CVTMAP+214                                               10567000
CVTQABST EQU   CVTMAP+212                                               10568000
CVTMDLDS EQU   CVTMAP+208                                               10569000
CVTUSER  EQU   CVTMAP+204                                               10570000
CVTABEND EQU   CVTMAP+200                                               10571000
CVTSMCA  EQU   CVTMAP+196                                               10572000
CVTRSV18 EQU   CVTMAP+192                                               10573000
CVTQLPAQ EQU   CVTMAP+188                                               10574000
CVTQCDSR EQU   CVTMAP+184                                               10575000
CVTRSV17 EQU   CVTOPTB                                                  10576000
CVTRSV16 EQU   CVTOPTB                                                  10577000
CVTFP    EQU   CVTOPTB                                                  10578000
CVTAPTHR EQU   CVTOPTB                                                  10579000
CVTNLOG  EQU   CVTOPTB                                                  10580000
CVTTOD   EQU   CVTOPTB                                                  10581000
CVTCTIMS EQU   CVTOPTB                                                  10582000
CVTPROT  EQU   CVTOPTB                                                  10583000
CVTXPFP  EQU   CVTOPTA                                                  10584000
CVTASCII EQU   CVTOPTA                                                  10585000
CVTRSV13 EQU   CVTOPTA                                                  10586000
CVTRSV12 EQU   CVTOPTA                                                  10587000
CVTNIP   EQU   CVTOPTA                                                  10588000
CVTDDR   EQU   CVTOPTA                                                  10589000
CVTAPR   EQU   CVTOPTA                                                  10590000
CVTCCH   EQU   CVTOPTA                                                  10591000
CVTSNCTR EQU   CVTMAP+180                                               10592000
CVTQMWR  EQU   CVTMAP+176                                               10593000
CVTQOCR  EQU   CVTMAP+172                                               10594000
CVT1EF00 EQU   CVTMAP+168                                               10595000
CVTMZ00  EQU   CVTMAP+164                                               10596000
CVTHEAD  EQU   CVTMAP+160                                               10597000
CVTRSV11 EQU   CVTMAP+156                                               10598000
CVT0PT01 EQU   CVTMAP+152                                               10599000
CVTMSER  EQU   CVTMAP+148                                               10600000
CVTRV516 EQU   CVTIERLC                                                 10601000
CVTILCH  EQU   CVTMAP+140                                               10602000
CVT0DS   EQU   CVTMAP+136                                               10603000
CVTFBOSV EQU   CVTMAP+132                                               10604000
CVTNUCB  EQU   CVTMAP+128                                               10605000
CVTIXAVL EQU   CVTMAP+124                                               10606000
CVTIOQET EQU   CVTMAP+120                                               10607000
CVTDCBA  EQU   CVTMAP+117                                               10608000
CVTMVS2  EQU   CVTDCB                                                   10609000
CVT6DAT  EQU   CVTDCB                                                   10610000
CVT4MPS  EQU   CVTDCB                                                   10611000
CVTRSV09 EQU   CVTDCB                                                   10612000
CVT4MS1  EQU   CVTDCB                                                   10613000
CVT2SPS  EQU   CVTDCB                                                   10614000
CVT1SSS  EQU   CVTDCB                                                   10615000
CVTRSV08 EQU   CVTDCB                                                   10616000
CVTSTB   EQU   CVTMAP+112                                               10617000
CVTQTD00 EQU   CVTMAP+108                                               10618000
CVTQTE00 EQU   CVTMAP+104                                               10619000
CVTCUCB  EQU   CVTMAP+100                                               10620000
CVTSJQ   EQU   CVTMAP+96                                                10621000
CVTPBLDL EQU   CVTMAP+92                                                10622000
CVTTPC   EQU   CVTMAP+88                                                10623000
CVTSVDCB EQU   CVTMAP+84                                                10624000
CVTBRET  EQU   CVTMAP+82                                                10625000
CVTEXIT  EQU   CVTMAP+80                                                10626000
CVT0FN00 EQU   CVTMAP+76                                                10627000
CVTDARA  EQU   CVTDAR+1                                                 10628000
CVTRSV07 EQU   CVTFLGS1                                                 10629000
CVTRSV06 EQU   CVTFLGS1                                                 10630000
CVTRSV05 EQU   CVTFLGS1                                                 10631000
CVTRSV04 EQU   CVTFLGS1                                                 10632000
CVTRSV03 EQU   CVTFLGS1                                                 10633000
CVTRSV02 EQU   CVTFLGS1                                                 10634000
CVTRSV01 EQU   CVTFLGS1                                                 10635000
CVTDMPLK EQU   CVTFLGS1                                                 10636000
CVTXITP  EQU   CVTMAP+68                                                10637000
CVTZDTAB EQU   CVTMAP+64                                                10638000
CVTMSLT  EQU   CVTMAP+60                                                10639000
CVTDATE  EQU   CVTMAP+56                                                10640000
CVTBTERM EQU   CVTMAP+52                                                10641000
CVTSYSAD EQU   CVTMAP+48                                                10642000
CVTXTLER EQU   CVTMAP+44                                                10643000
CVTILK2  EQU   CVTMAP+40                                                10644000
CVTILK1  EQU   CVTMAP+36                                                10645000
CVTPRLTV EQU   CVTMAP+32                                                10646000
CVTPCNVT EQU   CVTMAP+28                                                10647000
CVT0VL00 EQU   CVTMAP+24                                                10648000
CVTXAPG  EQU   CVTMAP+20                                                10649000
CVTBUF   EQU   CVTMAP+16                                                10650000
CVTJOB   EQU   CVTMAP+12                                                10651000
CVTLINK  EQU   CVTMAP+8                                                 10652000
CVT0EF00 EQU   CVTMAP+4                                                 10653000
CVTTCBP  EQU   CVTMAP                                                   10654000
CVT      EQU   CVTMAP                                                   10655000
CTGFVWKA EQU   CTGFV+88                                                 10656000
CTGFVPWD EQU   CTGFV+84                                                 10657000
CTGFVNAM EQU   CTGFV+80                                                 10658000
CTGFVUPG EQU   CTGFVGAT                                                 10659000
CTGFVEXT EQU   CTGFVLMT                                                 10660000
CTGFVLRS EQU   CTGFV+68                                                 10661000
CTGFVBUF EQU   CTGFV+64                                                 10662000
CTGFVATR EQU   CTGFV+60                                                 10663000
CTGFVFSN EQU   CTGFVAMD                                                 10664000
CTGFVTTR EQU   CTGFVSPC                                                 10665000
CTGFVDVT EQU   CTGFV+48                                                 10666000
CTGFVRNG EQU   CTGFV+44                                                 10667000
CTGFVVLT EQU   CTGFV+40                                                 10668000
CTGFVCRE EQU   CTGFV+36                                                 10669000
CTGFVEXP EQU   CTGFV+32                                                 10670000
CTGFVOWN EQU   CTGFV+28                                                 10671000
CTGFVSTY EQU   CTGFV+24                                                 10672000
CTGFVENT EQU   CTGFV+20                                                 10673000
CTGFVIND EQU   CTGFV+16                                                 10674000
CTGFVVCH EQU   CTGFV+12                                                 10675000
CTGFVICH EQU   CTGFV+8                                                  10676000
CTGFVDCH EQU   CTGFV+4                                                  10677000
@NM00194 EQU   CTGFV+3                                                  10678000
CTGFVELM EQU   CTGFV+2                                                  10679000
@NM00193 EQU   CTGFVPRO                                                 10680000
CTGFVDRC EQU   CTGFVPRO                                                 10681000
CTGFVNDC EQU   CTGFVPRO                                                 10682000
CTGFVRVL EQU   CTGFVPRO                                                 10683000
CTGFVAVL EQU   CTGFVPRO                                                 10684000
CTGFVTYP EQU   CTGFV                                                    10685000
CTGFLPT  EQU   CTGFLDAT+4                                               10686000
CTGFLNG  EQU   CTGFLDAT                                                 10687000
CTGFLCHN EQU   CTGFL+12                                                 10688000
CTGFLDNM EQU   CTGFL+8                                                  10689000
CTGFLDWA EQU   CTGFL+4                                                  10690000
CTGFLDTS EQU   CTGFLDRE                                                 10691000
@NM00192 EQU   CTGFLDRE                                                 10692000
CTGFLDGC EQU   CTGFL+2                                                  10693000
CTGFLDCD EQU   CTGFL+1                                                  10694000
CTGFLDNO EQU   CTGFL                                                    10695000
CTGFIELD EQU   CTGPL+28                                                 10696000
CTGPSWD  EQU   CTGJSCB                                                  10697000
@NM00190 EQU   CTGFBFLG                                                 10698000
CTGNGDSN EQU   CTGFBFLG                                                 10699000
CTGGDGB  EQU   CTGFBFLG                                                 10700000
CTGKEEP  EQU   CTGFBFLG                                                 10701000
CTGPAR   EQU   CTGFBFLG                                                 10702000
CTGFDBK  EQU   CTGNEWNM                                                 10703000
CTGNOFLD EQU   CTGPL+19                                                 10704000
CTGTYPE  EQU   CTGPL+18                                                 10705000
@NM00189 EQU   CTGDSORG                                                 10706000
CTGOPTNS EQU   CTGDSORG                                                 10707000
CTGWKA   EQU   CTGPL+12                                                 10708000
CTGCVOL  EQU   CTGCAT                                                   10709000
@NM00188 EQU   CTGOPTN4                                                 10710000
CTGBYPMT EQU   CTGOPTN4                                                 10711000
@NM00187 EQU   CTGOPTN4                                                 10712000
CTGNPROF EQU   CTGOPTN4                                                 10713000
CTGDOCAT EQU   CTGOPTN4                                                 10714000
CTGLBASE EQU   CTGOPTN4                                                 10715000
CTGAM0   EQU   CTGOPTN3                                                 10716000
CTGNUM   EQU   CTGOPTN3                                                 10717000
CTGSRH   EQU   CTGOPTN3                                                 10718000
CTGGDGL  EQU   CTGOPTN3                                                 10719000
CTGSUPLT EQU   CTGOPTN3                                                 10720000
CTGFUNC  EQU   CTGOPTN3                                                 10721000
@NM00186 EQU   CTGOPTN2                                                 10722000
CTGSCR   EQU   CTGOPTN2                                                 10723000
CTGOVRID EQU   CTGOPTN2                                                 10724000
CTGDISC  EQU   CTGOPTN2                                                 10725000
CTGUCRAX EQU   CTGGTNXT                                                 10726000
CTGSWAP  EQU   CTGRCATN                                                 10727000
CTGGTALL EQU   CTGREL                                                   10728000
CTGNSVS  EQU   CTGEXT                                                   10729000
CTGGENLD EQU   CTGOPTN1                                                 10730000
CTGCNAME EQU   CTGOPTN1                                                 10731000
CTGNAME  EQU   CTGOPTN1                                                 10732000
CTGREAD  EQU   CTGOPTN1                                                 10733000
CTGUPD   EQU   CTGOPTN1                                                 10734000
CTGCI    EQU   CTGOPTN1                                                 10735000
CTGMAST  EQU   CTGOPTN1                                                 10736000
CTGBYPSS EQU   CTGOPTN1                                                 10737000
@NM00185 EQU   GENLVLS                                                  10738000
@NM00184 EQU   GDGRCD+108                                               10739000
@NM00183 EQU   GDGRCD                                                   10740000
@NM00182 EQU   VOLGO+34                                                 10741000
NOBLKTRK EQU   VOLGO+32                                                 10742000
@NM00181 EQU   VOLGO                                                    10743000
@NM00176 EQU   RGATTSG1                                                 10744000
RGATSUP1 EQU   RGATTSG1                                                 10745000
@NM00175 EQU   RGATTR1                                                  10746000
RGATTUPG EQU   RGATTR1                                                  10747000
SPCROUND EQU   SPCOPTNS                                                 10748000
SPCALXRQ EQU   SPCOPTNS                                                 10749000
SPCMXIGR EQU   SPCOPTNS                                                 10750000
SPCCNTIG EQU   SPCOPTNS                                                 10751000
@NM00174 EQU   SPCOPTNS                                                 10752000
SPCRQTYP EQU   SPCOPTNS                                                 10753000
SPCSECDQ EQU   SPACEPRM+3                                               10754000
SPCPRIMQ EQU   SPACEPRM                                                 10755000
DSSUMTT  EQU   DSDIR+9                                                  10756000
DSCRETS  EQU   DSDIR+5                                                  10757000
DSIDNO   EQU   DSDIR+2                                                  10758000
@NM00173 EQU   DSDIR                                                    10759000
ASGDGLVL EQU   ASGOGDG+6                                                10760000
@NM00172 EQU   ASGOGDG+2                                                10761000
@NM00171 EQU   ASGOGDG                                                  10762000
ASCI2    EQU   ASG2+1                                                   10763000
ASTYPE2  EQU   ASG2                                                     10764000
ASCI     EQU   ASG1+1                                                   10765000
ASTYPE   EQU   ASG1                                                     10766000
@NM00170 EQU   ASGO                                                     10767000
CCRRBAS  EQU   CCR+57                                                   10768000
CCRFDCI  EQU   CCR+54                                                   10769000
CCRCDCI  EQU   CCR+51                                                   10770000
CCRNFCI  EQU   CCR+48                                                   10771000
CCRHACI  EQU   CCR+45                                                   10772000
CCRID    EQU   CCR+44                                                   10773000
CCRKEY   EQU   CCR                                                      10774000
CEXT     EQU   CTGRBASE+135                                             10775000
CDOSUINF EQU   CTGRBASE+133                                             10776000
CLRECL   EQU   CTGRBASE+129                                             10777000
CHIA     EQU   CTGRBASE+125                                             10778000
CHIU     EQU   CTGRBASE+121                                             10779000
CSORT    EQU   CSPACPRM+6                                               10780000
CSEC     EQU   CSPACPRM+3                                               10781000
CPRIM    EQU   CSPACPRM                                                 10782000
CBUF     EQU   CTGRBASE+110                                             10783000
@NM00164 EQU   COPEN                                                    10784000
COPENDS  EQU   COPEN                                                    10785000
@NM00163 EQU   CATTR2                                                   10786000
CATTRSSH EQU   CATTR2                                                   10787000
CATTRISH EQU   CATTR2                                                   10788000
CTRKOV   EQU   CATTR1                                                   10789000
CTEMP    EQU   CATTR1                                                   10790000
CINHIB   EQU   CATTR1                                                   10791000
CRECOV   EQU   CATTR1                                                   10792000
CERASE   EQU   CATTR1                                                   10793000
CREUSE   EQU   CATTR1                                                   10794000
CSP      EQU   CATTR1                                                   10795000
CEXP     EQU   CTGRBASE+104                                             10796000
CCRE     EQU   CTGRBASE+101                                             10797000
@NM00162 EQU   CTGRBASE                                                 10798000
LENFIX   EQU   CNTRLINF+1                                               10799000
CNTVAR   EQU   CNTRLINF                                                 10800000
VARINFO  EQU   VARFIELD+2                                               10801000
@NM00161 EQU   EXTRCDPT+3                                               10802000
EXTGOCI  EQU   EXTRCDPT                                                 10803000
NREPCV   EQU   CATRCD+47                                                10804000
@NM00160 EQU   CATRCD+26                                                10805000
RCDRACTS EQU   CATRCD+18                                                10806000
RCDCRADT EQU   CATRCD+14                                                10807000
RCDCRACI EQU   CATRCD+11                                                10808000
RCDRELID EQU   CATRCD+4                                                 10809000
RCDKEYTY EQU   CATRCD                                                   10810000
CATGOGC  EQU   CATGOGC1                                                 10811000
CATGODEL EQU   CATGOGC1                                                 10812000
CATGOEXT EQU   CATGOGC1                                                 10813000
CATGODSP EQU   CATGOCI+1                                                10814000
@NM00159 EQU   CATGOFLG                                                 10815000
@NM00158 EQU   SDSIDFLG                                                 10816000
@NM00157 EQU   SNDSDIR                                                  10817000
SNLBM    EQU   SNVSBM+28                                                10818000
SNABM    EQU   SNVSBM+24                                                10819000
@NM00156 EQU   SNVSBM                                                   10820000
@NM00155 EQU   SNEXTENT+16                                              10821000
@NM00154 EQU   SNEXTENT+12                                              10822000
NTR      EQU   SNEXTENT+10                                              10823000
@NM00153 EQU   SNEXTENT+8                                               10824000
@NM00152 EQU   SNEXTENT+6                                               10825000
SHH      EQU   SNEXTENT+4                                               10826000
SCC      EQU   SNEXTENT+2                                               10827000
SS       EQU   SNEXTENT                                                 10828000
SNEXTI   EQU   SNVGO+42                                                 10829000
SNTTNNMC EQU   SNVGO+41                                                 10830000
SNDEVTYP EQU   SNVGO+24                                                 10831000
@NM00151 EQU   SNVGO                                                    10832000
SNNAME2  EQU   SNGLEV+1                                                 10833000
SNTYPE2  EQU   SNGLEV                                                   10834000
SNNAME   EQU   SNASSOC+25                                               10835000
SNTYPE   EQU   SNASSOC+24                                               10836000
@NM00150 EQU   SNASSOC                                                  10837000
@NM00149 EQU   SSPHDFLG                                                 10838000
SNVGOEL  EQU   SNFIXED+20                                               10839000
SNEGOP   EQU   SNFIXED+16                                               10840000
SNECI    EQU   SNFIXED+13                                               10841000
SNAGOP   EQU   SNFIXED+11                                               10842000
SNACI    EQU   SNFIXED+8                                                10843000
SNGOP    EQU   SNFIXED+6                                                10844000
SNCI     EQU   SNFIXED+3                                                10845000
@NM00148 EQU   SNFLAG                                                   10846000
SNFINC   EQU   SNFLAG                                                   10847000
SNFMOD   EQU   SNFLAG                                                   10848000
SNFALT   EQU   SNFLAG                                                   10849000
RSFCILST EQU   RSFSNVT+28                                               10850000
RSFCNTTN EQU   RSFSNVT+12                                               10851000
@NM00147 EQU   RSFLAGS                                                  10852000
RSFINVTY EQU   RSFLAGS                                                  10853000
@NM00146 EQU   RSFSNVT                                                  10854000
@NM00145 EQU   GDGFLG                                                   10855000
DITCITAB EQU   @NM00143+1                                               10856000
@NM00144 EQU   @NM00143                                                 10857000
@NM00142 EQU   @NM00140+2                                               10858000
DITOSN   EQU   DITVSN+1                                                 10859000
@NM00141 EQU   DITVSN                                                   10860000
DITOFS   EQU   DITABE+2                                                 10861000
DITFB256 EQU   DITFLB                                                   10862000
@NM00139 EQU   DITFLB                                                   10863000
DITFBDGO EQU   DITFLB                                                   10864000
@NM00138 EQU   DITFLB                                                   10865000
DITFBAS2 EQU   DITFLB                                                   10866000
DITFBAS1 EQU   DITFLB                                                   10867000
DITFBGOE EQU   DITFLB                                                   10868000
DITFBHEP EQU   DITFLB                                                   10869000
@NM00137 EQU   DITFA                                                    10870000
@NM00136 EQU   DITFA                                                    10871000
@NM00135 EQU   DITFA                                                    10872000
@NM00134 EQU   DITFA                                                    10873000
DITFADEL EQU   DITFA                                                    10874000
DITFARAS EQU   DITFA                                                    10875000
@NM00133 EQU   DITFA                                                    10876000
GDIENTRY EQU   GDITS+12                                                 10877000
GDITHEAD EQU   GDITS                                                    10878000
CITEXTBA EQU   @NM00131+1                                               10879000
@NM00132 EQU   @NM00131                                                 10880000
CITEXTCH EQU   @NM00129+1                                               10881000
@NM00130 EQU   @NM00129                                                 10882000
CITDITAB EQU   @NM00128+1                                               10883000
CITDICNT EQU   @NM00128                                                 10884000
CITRCIN  EQU   @NM00127+1                                               10885000
CITFADGO EQU   CITFLA                                                   10886000
CITFASCA EQU   CITFLA                                                   10887000
CITFAGOE EQU   CITFLA                                                   10888000
CITFAHEP EQU   CITFLA                                                   10889000
CITFARAS EQU   CITFLA                                                   10890000
@NM00126 EQU   CITFLA                                                   10891000
CITABENT EQU   GCITS+12                                                 10892000
GCITHEAD EQU   GCITS                                                    10893000
PTASCIT1 EQU   PTASOE+4                                                 10894000
PTASDIT1 EQU   PTASOE                                                   10895000
@NM00125 EQU   PTLDITFB                                                 10896000
PTLFBDGO EQU   PTLDITFB                                                 10897000
@NM00124 EQU   PTLDITFB                                                 10898000
PTLFBAS2 EQU   PTLDITFB                                                 10899000
PTLFBGOE EQU   PTLDITFB                                                 10900000
PTLFBHEP EQU   PTLDITFB                                                 10901000
PTLSN    EQU   PTLOC+16                                                 10902000
PTLNDIT  EQU   @NM00122+1                                               10903000
@NM00123 EQU   @NM00122                                                 10904000
PTLCCIT  EQU   PTLOC+4                                                  10905000
@NM00121 EQU   @NM00120                                                 10906000
@NM00119 EQU   PTF2                                                     10907000
PTF2KSDS EQU   PTF2                                                     10908000
PTF1ENDA EQU   PTF1                                                     10909000
PTF1ENDG EQU   PTF1                                                     10910000
PTF1CKVL EQU   PTF1                                                     10911000
PTF1DELT EQU   PTF1                                                     10912000
PTF1HIT2 EQU   PTF1                                                     10913000
PTF1HIT  EQU   PTF1                                                     10914000
@NM00118 EQU   PTXFLAGS+1                                               10915000
@NM00117 EQU   PTXFLAG1                                                 10916000
PTXEXIST EQU   PTXFLAG1                                                 10917000
PTXEND   EQU   PTXFLAG1                                                 10918000
PTXX2C   EQU   PTXALIAS+28                                              10919000
PTXX1C   EQU   PTXALIAS+26                                              10920000
PTXX0C   EQU   PTXALIAS+24                                              10921000
PTXCITX1 EQU   PTXALIAS+20                                              10922000
PTXX1X0D EQU   PTXALIAS+16                                              10923000
PTXX1X2D EQU   PTXALIAS+12                                              10924000
PTXX1AUD EQU   PTXALIAS+8                                               10925000
PTXX0X1D EQU   PTXALIAS+4                                               10926000
PTXUX1D  EQU   PTXALIAS                                                 10927000
PTVDSSNT EQU   PTVERDI+28                                               10928000
@NM00116 EQU   PTVERDI+26                                               10929000
PTVCNT   EQU   PTVERDI+24                                               10930000
PTVDIASS EQU   PTVDI+8                                                  10931000
PTVDISNT EQU   PTVDI+4                                                  10932000
PTVDICIT EQU   PTVDI                                                    10933000
PTINDX5  EQU   PTINDX+10                                                10934000
PTINDX4  EQU   PTINDX+8                                                 10935000
PTINDX2  EQU   PTINDX+2                                                 10936000
PTINDX1  EQU   PTINDX                                                   10937000
PTASSCIT EQU   PTASSOE+4                                                10938000
PTASSDIT EQU   PTASSOE                                                  10939000
PTDITWK  EQU   PTGDIT+20                                                10940000
PTDITF   EQU   PTGDIT+16                                                10941000
PTDITNC  EQU   @NM00114+1                                               10942000
@NM00115 EQU   @NM00114                                                 10943000
PTDITL   EQU   @NM00112+1                                               10944000
@NM00113 EQU   @NM00112                                                 10945000
PTDITI   EQU   @NM00110+1                                               10946000
@NM00111 EQU   @NM00110                                                 10947000
PTCITWK  EQU   PTGCIT+20                                                10948000
@NM00109 EQU   @NM00108                                                 10949000
@NM00107 EQU   @NM00106                                                 10950000
@NM00105 EQU   @NM00104                                                 10951000
PTHEAD   EQU   PTWORK                                                   10952000
@NM00103 EQU   @NM00102                                                 10953000
@NM00101 EQU   TABANCHR+16                                              10954000
TASSNENT EQU   TASSO+2                                                  10955000
@NM00100 EQU   TASSO+1                                                  10956000
TASSID   EQU   TASSO                                                    10957000
@NM00099 EQU   TASSFL1                                                  10958000
TASSSET  EQU   TASSFL1                                                  10959000
TASSIS   EQU   TASSFL1                                                  10960000
TASSVER  EQU   TASSFL1                                                  10961000
TASSSCAN EQU   TASSFL1                                                  10962000
TASSREAD EQU   TASSFL1                                                  10963000
TASSTYPE EQU   TASSENT                                                  10964000
RSCNHH2  EQU   RSCNCCHH+6                                               10965000
RSCNCC2  EQU   RSCNCCHH+4                                               10966000
RSCNHH1  EQU   RSCNCCHH+2                                               10967000
RSCNCC1  EQU   RSCNCCHH                                                 10968000
RECPTRCD EQU   RECIOWA+978                                              10969000
UCATWRET EQU   UCATWA+4                                                 10970000
UCATWRLN EQU   UCATWA+2                                                 10971000
UCATWTLN EQU   UCATWA                                                   10972000
UCBAREA  EQU   RECIOWA+861                                              10973000
RSCAMIND EQU   RSCAMINN+1                                               10974000
RSCAMINL EQU   RSCAMINN                                                 10975000
RSCAMAJN EQU   RECIOWA+808                                              10976000
ALLVLSR  EQU   ALLVL+4                                                  10977000
ALLVLLN  EQU   ALLVL+2                                                  10978000
ALLVLC   EQU   ALLVL                                                    10979000
ALLULNM  EQU   ALLUL+4                                                  10980000
ALLULLN  EQU   ALLUL+2                                                  10981000
ALLULC   EQU   ALLUL                                                    10982000
RSVOLENT EQU   RECIOWA+692                                              10983000
RSVUENT  EQU   RECIOWA+664                                              10984000
RSALLAGL EQU   RECIOWA+632                                              10985000
CATHRMB  EQU   RECIOWA+192                                              10986000
CATLRMB  EQU   RECIOWA+180                                              10987000
CRARMB   EQU   RECIOWA+168                                              10988000
WFSRMB   EQU   RECIOWA+156                                              10989000
WFDRMB   EQU   RECIOWA+120                                              10990000
GRABSCR  EQU   RECIOWA+80                                               10991000
UIOVLS   EQU   UIOVOL+4                                                 10992000
UIOVLN   EQU   UIOVOL+2                                                 10993000
UIOVID   EQU   UIOVOL                                                   10994000
UIODNM   EQU   UIODSN+4                                                 10995000
UIODLN   EQU   UIODSN+2                                                 10996000
UIODID   EQU   UIODSN                                                   10997000
RSXCIREL EQU   RSXCIENT+12                                              10998000
@NM00098 EQU   RSXCIFL1                                                 10999000
RSXCIRNG EQU   RSXCIFL1                                                 11000000
RSXCILN  EQU   RSXCIENT+4                                               11001000
RSXCIBEG EQU   RSXCIENT                                                 11002000
@NM00097 EQU   RSXCIXLT+4                                               11003000
RSXCIID  EQU   RSXCIXLT                                                 11004000
RMBKEYA  EQU   RMB+12                                                   11005000
@NM00096 EQU   RMBFLAGS                                                 11006000
RMBGETU  EQU   RMBFLAGS                                                 11007000
RMBKEQ   EQU   RMBFLAGS                                                 11008000
RMBKEY   EQU   RMBFLAGS                                                 11009000
RMBUPD   EQU   RMBFLAGS                                                 11010000
RMBDIR   EQU   RMBFLAGS                                                 11011000
RMBSEQ   EQU   RMBFLAGS                                                 11012000
RMBARG   EQU   RMBCTL+4                                                 11013000
RMBRPL   EQU   RMBCTL                                                   11014000
@NM00095 EQU   RSRAB+530                                                11015000
RABFLG4  EQU   RABFLGS+3                                                11016000
RABFLG3  EQU   RABFLGS+2                                                11017000
RABFLG2  EQU   RABFLGS+1                                                11018000
RABDUP   EQU   RABFLG1                                                  11019000
RABIOIGN EQU   RABFLG1                                                  11020000
RABKEY   EQU   RABFLG1                                                  11021000
RABADD   EQU   RABFLG1                                                  11022000
RABUPD   EQU   RABFLG1                                                  11023000
RABINUSE EQU   RABFLG1                                                  11024000
GRABRAB6 EQU   GRABRABS+20                                              11025000
GRABRAB5 EQU   GRABRABS+16                                              11026000
GRABRAB3 EQU   GRABRABS+8                                               11027000
GRABRABE EQU   GRAB+8                                                   11028000
GRABSN   EQU   GRAB+3                                                   11029000
GRABSNRF EQU   GRABAFL2                                                 11030000
GRABSDUP EQU   GRABAFL1                                                 11031000
GRABSIOT EQU   GRABAFL1                                                 11032000
GRABSIOF EQU   GRABAFL1                                                 11033000
GRABSIOI EQU   GRABAFL1                                                 11034000
GRABSEFN EQU   GRABAFL1                                                 11035000
GRABSNRA EQU   GRABAFL1                                                 11036000
GRABFLG1 EQU   GRABFLGS                                                 11037000
@NM00092 EQU   RSCSWA+6                                                 11038000
@NM00091 EQU   RSMARKUN+6                                               11039000
@NM00090 EQU   RSCDSDW+18                                               11040000
RSGTMEB  EQU   RSGTIME+11                                               11041000
RSGDELM2 EQU   RSGTIME+9                                                11042000
@NM00089 EQU   RSGTIME+2                                                11043000
RSGDELM1 EQU   RSGTIME                                                  11044000
RSGDAY   EQU   RSGDATE+2                                                11045000
RSGYEAR  EQU   RSGDATE                                                  11046000
RSGFIXID EQU   RSGENAM+8                                                11047000
RSGTMEA  EQU   RSGENAM+1                                                11048000
RSGDELM  EQU   RSGENAM                                                  11049000
RSGUNPK  EQU   RSGENMWA                                                 11050000
RSFCPE7  EQU   RSWFNDWA+52                                              11051000
RSFCPE6  EQU   RSWFNDWA+48                                              11052000
RSFCPE5  EQU   RSWFNDWA+44                                              11053000
RSFCPE4  EQU   RSWFNDWA+40                                              11054000
RSFCPE3  EQU   RSWFNDWA+36                                              11055000
RSFCPE2  EQU   RSWFNDWA+32                                              11056000
RSFCPE1  EQU   RSWFNDWA+28                                              11057000
@NM00088 EQU   RSWFNDWA+26                                              11058000
RSWFBUF  EQU   RSWFNDWA+16                                              11059000
RSWFCIN  EQU   RSWFNDWA+13                                              11060000
RSWFRCSN EQU   RSWFNDWA+12                                              11061000
RSWSEQNR EQU   RSWFNDWA+10                                              11062000
@NM00087 EQU   RSWSNFLG                                                 11063000
RSWFIRST EQU   RSWSNFLG                                                 11064000
RSWAFINF EQU   RSWFNDWA                                                 11065000
@NM00086 EQU   RSCNVTCF+1                                               11066000
@NM00085 EQU   RSCNVTF1                                                 11067000
RSNN     EQU   RSTTNN+2                                                 11068000
LISTLN   EQU   RSDF00W+36                                               11069000
SETRC    EQU   RSDF00W+32                                               11070000
LISTPTR  EQU   RSDF00W                                                  11071000
@NM00084 EQU   RSVOLWA+141                                              11072000
@NM00083 EQU   RSVFLAGS                                                 11073000
RSGENDT  EQU   RSGENDTE+1                                               11074000
@NM00082 EQU   RSGENDTE                                                 11075000
RSGENTME EQU   RSGENWRK+4                                               11076000
RSGENTPT EQU   RSGENWRK                                                 11077000
RSCRGRBP EQU   RSCRWA+4                                                 11078000
RSCRENTP EQU   RSCRWA                                                   11079000
@NM00081 EQU   RSADUL+10                                                11080000
RSADSTP  EQU   RSADUL+10                                                11081000
RSADFLGS EQU   RSADUL+9                                                 11082000
RSADULNM EQU   RSADUL+1                                                 11083000
RSADULC  EQU   RSADUL                                                   11084000
RSADVLSR EQU   RSADVL+1                                                 11085000
RSADVLC  EQU   RSADVL                                                   11086000
RSADDDNP EQU   RSADWA+28                                                11087000
RSADULP  EQU   RSADWA+24                                                11088000
RSADVLP  EQU   RSADWA+20                                                11089000
RSADENP  EQU   RSADWA+16                                                11090000
RSADVSRP EQU   RSADWA+12                                                11091000
RSADGRBP EQU   RSADWA+8                                                 11092000
RSADDDN  EQU   RSADWA                                                   11093000
RSWFAMDP EQU   RSWFWA+48                                                11094000
RSWFLR   EQU   RSWFWA+44                                                11095000
RSWFDFAR EQU   RSWFWA+40                                                11096000
RSWFFPLP EQU   RSWFWA+12                                                11097000
RSWFFVTP EQU   RSWFWA+4                                                 11098000
RSWFSVCP EQU   RSWFWA                                                   11099000
@NM00080 EQU   RSRWORK+65                                               11100000
RSRSKPSW EQU   RSRFLGS                                                  11101000
RSRXSW   EQU   RSRFLGS                                                  11102000
RSRXTRY  EQU   RSRFLGS                                                  11103000
RSROKSW  EQU   RSRFLGS                                                  11104000
RSRX     EQU   RSRWORK+63                                               11105000
RSRIXNO  EQU   RSRWORK+62                                               11106000
RSRU     EQU   RSRWORK+61                                               11107000
RSRI     EQU   RSRWORK+60                                               11108000
RSRLG    EQU   RSRWORK+59                                               11109000
RSRLU    EQU   RSRWORK+58                                               11110000
RSRSVFLG EQU   RSRWORK+48                                               11111000
RSMSGCI  EQU   RSRWORK+45                                               11112000
RSMSGRC  EQU   RSRWORK+42                                               11113000
RSRRLN   EQU   RSRWORK+40                                               11114000
RSRRCPY  EQU   RSRWORK+38                                               11115000
RSRWFRN  EQU   RSRWORK+36                                               11116000
RSRCATRN EQU   RSRWORK+34                                               11117000
RSRCRARN EQU   RSRWORK+32                                               11118000
RSRXLFND EQU   RSRWORK+28                                               11119000
RSRXLSV  EQU   RSRWORK+24                                               11120000
RSRRPL   EQU   RSRWORK+20                                               11121000
RSRSVARG EQU   RSRWORK+16                                               11122000
RSRFAD   EQU   RSRWORK+12                                               11123000
RSRDAD   EQU   RSRWORK+8                                                11124000
RSRRC    EQU   RSRWORK+4                                                11125000
RSRGRBPT EQU   RSRWORK                                                  11126000
RSRNULNM EQU   RSRNUL+1                                                 11127000
RSRNULC  EQU   RSRNUL                                                   11128000
RSRNDDNM EQU   RSRNWA+91                                                11129000
RSRNOLDN EQU   RSRNWA+47                                                11130000
RSRNNOF1 EQU   RSRNFLGS                                                 11131000
RSRNVDUP EQU   RSRNFLGS                                                 11132000
RSRNSTP  EQU   RSRNFLGS                                                 11133000
RSRNFAIL EQU   RSRNFLGS                                                 11134000
RSRNRCRS EQU   RSRNFLGS                                                 11135000
RSRNEVC  EQU   RSRNWA+44                                                11136000
RSRNEVP  EQU   RSRNWA+40                                                11137000
RSRNULP  EQU   RSRNWA+36                                                11138000
RSRNVLP  EQU   RSRNWA+32                                                11139000
RSRNVSPT EQU   RSRNWA+28                                                11140000
RSRNDDPT EQU   RSRNWA+24                                                11141000
RSRNVLPT EQU   RSRNWA+20                                                11142000
RSRNGRBP EQU   RSRNWA+16                                                11143000
RSRNPVLS EQU   RSRNPLST+12                                              11144000
RSRNPNDS EQU   RSRNPLST+8                                               11145000
RSRNPODS EQU   RSRNPLST+4                                               11146000
RSRNPFLG EQU   RSRNPLST                                                 11147000
RSSVENT  EQU   RSINWA+55                                                11148000
RSINALL  EQU   RSINFLGS                                                 11149000
@NM00079 EQU   RSINATR1                                                 11150000
RSINRCV  EQU   RSINATR1                                                 11151000
@NM00078 EQU   RSINATR1                                                 11152000
RSINTS   EQU   RSINWA+45                                                11153000
RSINSVVL EQU   RSINWA+33                                                11154000
RSINDVLV EQU   RSINDVL+1                                                11155000
RSINDVLL EQU   RSINDVL                                                  11156000
RSINDDPT EQU   RSINWA+20                                                11157000
RSINDNPT EQU   RSINWA+16                                                11158000
RSINDVPT EQU   RSINWA+12                                                11159000
RSINCVPT EQU   RSINWA+8                                                 11160000
RSINWACB EQU   RSINWA+4                                                 11161000
RSINUAP  EQU   RSINWA                                                   11162000
RSCISVLK EQU   RSCIWA+44                                                11163000
RSCIEXT  EQU   RSCIWA+24                                                11164000
RSCIDFCI EQU   RSCIWA+20                                                11165000
RSCIRMEN EQU   RSCIWA+16                                                11166000
RSCILCI  EQU   RSCIWA+12                                                11167000
RSCINXCI EQU   RSCIWA+8                                                 11168000
RSCIEXCU EQU   RSCIWA+4                                                 11169000
@NM00077 EQU   RSCKFLAG                                                 11170000
RSCKTSW  EQU   RSCKFLAG                                                 11171000
RSCKIDX3 EQU   RSCKERRW+48                                              11172000
RSCKIDX2 EQU   RSCKERRW+46                                              11173000
RSCKIDX1 EQU   RSCKERRW+44                                              11174000
RSCATRC  EQU   RSCKERRW+42                                              11175000
RSOURCC  EQU   RSCKERRW+40                                              11176000
RSCKMDTB EQU   RSCKTIME+20                                              11177000
RSCKMDY  EQU   RSCKTIME+14                                              11178000
RSCKHMS  EQU   RSCKTIME+8                                               11179000
RSCKPDAY EQU   RSCKTIME+4                                               11180000
RSCKDAYS EQU   RSCKTIME                                                 11181000
RSCKTPTR EQU   RSCKERRW+4                                               11182000
RSCKERNO EQU   RSCKERR+2                                                11183000
@NM00076 EQU   RSREASW                                                  11184000
REASSW2  EQU   RSREASW                                                  11185000
REASSW1  EQU   RSREASW                                                  11186000
@NM00075 EQU   @NM00074+3                                               11187000
RSVIAGRB EQU   @NM00074                                                 11188000
@NM00073 EQU   RSVIAFLG                                                 11189000
RSVIARRN EQU   RSVIAFLG                                                 11190000
RSVIAUPD EQU   RSVIAFLG                                                 11191000
RSVIAIS  EQU   RSVIAFLG                                                 11192000
RSVIAFND EQU   RSVIAFLG                                                 11193000
RSVIADUP EQU   RSVIAFLG                                                 11194000
@NM00071 EQU   RSGETVIA+8                                               11195000
RSVIAIDX EQU   RSGETVIA+6                                               11196000
@NM00070 EQU   RSVIACRA+4                                               11197000
RSVIADSC EQU   RSVIACRA                                                 11198000
@NM00069 EQU   @NM00067+3                                               11199000
RSEOVERR EQU   @NM00067+2                                               11200000
@NM00068 EQU   RSEOVFLG                                                 11201000
RSEOVPHY EQU   RSEOVFLG                                                 11202000
RSEOVLOG EQU   RSEOVFLG                                                 11203000
RSEOVEND EQU   RSEOVFLG                                                 11204000
RSEOVFND EQU   RSEOVFLG                                                 11205000
RSEOVXIO EQU   @NM00067                                                 11206000
RSCATARG EQU   @NM00065+1                                               11207000
@NM00066 EQU   @NM00065                                                 11208000
RSCATRPL EQU   RSEOVWA+4                                                11209000
RSEOVRAB EQU   RSEOVWA                                                  11210000
RSPVFLG3 EQU   @NM00062+3                                               11211000
@NM00064 EQU   RSPVFLG2                                                 11212000
RSCHKCON EQU   RSPVFLG1                                                 11213000
@NM00063 EQU   RSPVSETB                                                 11214000
@NM00061 EQU   RSPVTTNN+15                                              11215000
RSPVSNT5 EQU   RSPVSNT+8                                                11216000
@NM00060 EQU   RSASSFLG+1                                               11217000
@NM00059 EQU   RSASSFL1                                                 11218000
RSASSEPA EQU   RSASSFL1                                                 11219000
RSASSPAS EQU   RSASSOC+14                                               11220000
RSASSEXT EQU   RSASSOC+12                                               11221000
RSASSEND EQU   RSASSOC+8                                                11222000
RSASSCIN EQU   RSASSOC+4                                                11223000
RSRCHK   EQU   RSROPT                                                   11224000
RSREND   EQU   RSROPT                                                   11225000
RSRCRA   EQU   RSRDS                                                    11226000
RSRINIT  EQU   RSRTYPE                                                  11227000
RSRDEL   EQU   RSRTYPE                                                  11228000
RSRPOS   EQU   RSRTYPE                                                  11229000
RSRADD   EQU   RSRTYPE                                                  11230000
@NM00058 EQU   RSFLAGI2+1                                               11231000
RSUCDTN  EQU   RSFLAGI2+1                                               11232000
RSUCATN  EQU   RSFLAGI2+1                                               11233000
RSHAVECR EQU   RSFLAGI2+1                                               11234000
RSFDELET EQU   RSFLAGI2+1                                               11235000
RSSRNSCN EQU   RSFLAGI2+1                                               11236000
RSOPDYN  EQU   RSFLAGI2+1                                               11237000
RSUCCCR  EQU   RSFLAGI2                                                 11238000
RSUCTWWF EQU   RSFLAGI2                                                 11239000
RSUCWFTN EQU   RSFLAGI2                                                 11240000
RSUCCATN EQU   RSFLAGI2                                                 11241000
RSMEBYV  EQU   RSFLAGI2                                                 11242000
RSMEOP   EQU   RSFLAGI2                                                 11243000
RSMETRM  EQU   RSFLAGI2                                                 11244000
RSCCVFND EQU   RSFLAGI2                                                 11245000
@NM00057 EQU   RSFLAGI1                                                 11246000
RSDUPNRR EQU   RSFLAGI1                                                 11247000
RSRENRR  EQU   RSFLAGI1                                                 11248000
RSREARR  EQU   RSFLAGI1                                                 11249000
RSCREXC  EQU   RSFLAGN2                                                 11250000
RSCREOV  EQU   RSFLAGN2                                                 11251000
RSTERM   EQU   RSFLAGN2                                                 11252000
RSALLC   EQU   RSFLAGN2                                                 11253000
RSCRAUA  EQU   RSFLAGN2                                                 11254000
RSWFCREA EQU   RSFLAGN2                                                 11255000
RSCAEOV  EQU   RSFLAGN2                                                 11256000
RSENUFCI EQU   RSFLAGN2                                                 11257000
RSIGNR   EQU   RSFLAGN1                                                 11258000
RSCARES  EQU   RSFLAGN1                                                 11259000
RSREASND EQU   RSFLAGN1                                                 11260000
RSCAOPN  EQU   RSFLAGN1                                                 11261000
RSCROPN  EQU   RSFLAGN1                                                 11262000
RSWFOPN  EQU   RSFLAGN1                                                 11263000
RSWFDEF  EQU   RSFLAGN1                                                 11264000
RSNCTS   EQU   RSNEWCAT+10                                              11265000
RSNCDEVT EQU   RSNEWCAT+6                                               11266000
RSNCVLSR EQU   RSNEWCAT                                                 11267000
RSWFPS   EQU   RSWORK+957                                               11268000
RSWCATPS EQU   RSWORK+949                                               11269000
RSWCATNM EQU   RSWORK+905                                               11270000
RSDFVLSR EQU   RSWORK+875                                               11271000
RSDFVLCT EQU   RSWORK+874                                               11272000
RSWFDSN  EQU   RSWORK+830                                               11273000
RSWFDDNM EQU   RSWORK+822                                               11274000
RSMRPS   EQU   RSWORK+814                                               11275000
RSCATVLS EQU   RSWORK+808                                               11276000
RSCATNCI EQU   RSWORK+805                                               11277000
RSCATTN  EQU   RSWORK+761                                               11278000
RSCATPS  EQU   RSWORK+753                                               11279000
RSCATDSN EQU   RSWORK+709                                               11280000
RSCATDDN EQU   RSWORK+701                                               11281000
RSUCCINO EQU   RSWORK+697                                               11282000
RSNOBLKT EQU   RSWORK+694                                               11283000
RSIDX3   EQU   RSWORK+692                                               11284000
RSIDX2   EQU   RSWORK+690                                               11285000
RSCAFUCN EQU   RSWORK+684                                               11286000
RSORSTAT EQU   RSORVLLS+12                                              11287000
RSORNVOL EQU   RSORVLLS+6                                               11288000
RSORNDEV EQU   RSORVLLS+2                                               11289000
RSORVLCT EQU   RSORVLLS                                                 11290000
RSCRAVLN EQU   RSWORK+664                                               11291000
RSCHCRAN EQU   RSWORK+660                                               11292000
RSCIREMC EQU   RSWORK+648                                               11293000
RSCATSCN EQU   RSWORK+644                                               11294000
RSSUBSSZ EQU   RSWORK+640                                               11295000
RSSUBSTP EQU   RSWORK+636                                               11296000
RSSUBENP EQU   RSWORK+632                                               11297000
RSSUBGRP EQU   RSWORK+628                                               11298000
RSSUBRC  EQU   RSWORK+624                                               11299000
RSPROCRC EQU   RSWORK+620                                               11300000
RSUGLEN  EQU   RSWORK+616                                               11301000
RSCRADD  EQU   RSWORK+608                                               11302000
RSCIXLTB EQU   RSWORK+604                                               11303000
RSCATUCB EQU   RSWORK+596                                               11304000
RSCATACB EQU   RSWORK+592                                               11305000
RSCAPAS  EQU   RSWORK+588                                               11306000
CTGFVPTR EQU   RSWORK+584                                               11307000
RSUCNXT  EQU   RSWORK+564                                               11308000
RSTNNXT  EQU   RSWORK+560                                               11309000
RSDUPNXT EQU   RSWORK+556                                               11310000
RSRENEXT EQU   RSWORK+552                                               11311000
RSECPA   EQU   RSWORK+548                                               11312000
RSECBF1  EQU   RSWORK+544                                               11313000
RSWFIOCS EQU   RSWORK+540                                               11314000
RSWFDS   EQU   RSWORK+528                                               11315000
RSWFPAS  EQU   RSWORK+524                                               11316000
RSWFDD   EQU   RSWORK+520                                               11317000
RSWCPAS  EQU   RSWORK+516                                               11318000
RSWCDS   EQU   RSWORK+512                                               11319000
RSMRPAS  EQU   RSWORK+508                                               11320000
RSGDT    EQU   RSWORK+504                                               11321000
RSXRREND EQU   RSWORK+500                                               11322000
RSXCIEND EQU   RSWORK+496                                               11323000
RSENTNXT EQU   RSWORK+492                                               11324000
RSENTFBK EQU   RSWORK+488                                               11325000
RSENTST  EQU   RSWORK+480                                               11326000
RSTNCHN  EQU   RSWORK+476                                               11327000
RSREASS  EQU   RSWORK+472                                               11328000
RSREASSN EQU   RSWORK+468                                               11329000
RSVOLLUS EQU   RSWORK+464                                               11330000
RSRESLUS EQU   RSWORK+456                                               11331000
RSVOLALL EQU   RSWORK+452                                               11332000
RSWFHURR EQU   RSWORK+448                                               11333000
RSWFNEXT EQU   RSWORK+444                                               11334000
RSWFSCND EQU   RSWORK+424                                               11335000
RSWFPRIM EQU   RSWORK+420                                               11336000
RSFPL    EQU   RSWORK+392                                               11337000
RSFDT    EQU   RSWORK+388                                               11338000
RSCURRN  EQU   RSWORK+384                                               11339000
RSCURCI  EQU   RSWORK+380                                               11340000
RSCREND  EQU   RSWORK+376                                               11341000
RSCANFCN EQU   RSWORK+368                                               11342000
RSCMRR   EQU   RSWORK+364                                               11343000
RSCACDE  EQU   RSWORK+360                                               11344000
RSAVNEXT EQU   RSWORK+356                                               11345000
RSAVAILN EQU   RSWORK+352                                               11346000
RS07RG12 EQU   RS07REGS+16                                              11347000
RS07RG11 EQU   RS07REGS+12                                              11348000
RS07RG10 EQU   RS07REGS+8                                               11349000
RS07RG09 EQU   RS07REGS+4                                               11350000
RS07RG08 EQU   RS07REGS                                                 11351000
RS06RG12 EQU   RS06REGS+16                                              11352000
RS06RG11 EQU   RS06REGS+12                                              11353000
RS06RG10 EQU   RS06REGS+8                                               11354000
RS06RG09 EQU   RS06REGS+4                                               11355000
RS06RG08 EQU   RS06REGS                                                 11356000
RS05RG12 EQU   RS05REGS+16                                              11357000
RS05RG11 EQU   RS05REGS+12                                              11358000
RS05RG10 EQU   RS05REGS+8                                               11359000
RS05RG09 EQU   RS05REGS+4                                               11360000
RS05RG08 EQU   RS05REGS                                                 11361000
RS04RG12 EQU   RS04REGS+16                                              11362000
RS04RG11 EQU   RS04REGS+12                                              11363000
RS04RG10 EQU   RS04REGS+8                                               11364000
RS04RG09 EQU   RS04REGS+4                                               11365000
RS04RG08 EQU   RS04REGS                                                 11366000
RS03RG12 EQU   RS03REGS+16                                              11367000
RS03RG11 EQU   RS03REGS+12                                              11368000
RS03RG10 EQU   RS03REGS+8                                               11369000
RS02RG12 EQU   RS02REGS+16                                              11370000
RS02RG11 EQU   RS02REGS+12                                              11371000
RS02RG10 EQU   RS02REGS+8                                               11372000
RS02RG09 EQU   RS02REGS+4                                               11373000
RS02RG08 EQU   RS02REGS                                                 11374000
RS01RG12 EQU   RS01REGS+16                                              11375000
RS01RG11 EQU   RS01REGS+12                                              11376000
RS01RG10 EQU   RS01REGS+8                                               11377000
RS01RG09 EQU   RS01REGS+4                                               11378000
RS01RG08 EQU   RS01REGS                                                 11379000
@NM00056 EQU   @NM00055                                                 11380000
@NM00054 EQU   @NM00053                                                 11381000
RSPTWKUG EQU   RSPSTACK+24                                              11382000
@NM00052 EQU   RSPSTACK+20                                              11383000
@NM00051 EQU   RSPSTACK+18                                              11384000
@NM00050 EQU   RSPSTACK+16                                              11385000
RSPTWKLN EQU   RSPSTACK+12                                              11386000
RSPTWKL  EQU   RSPSTACK+4                                               11387000
RSPTWKF  EQU   RSPSTACK                                                 11388000
RSGDITUG EQU   RSGDITS+24                                               11389000
RSGDITNU EQU   @NM00048+1                                               11390000
@NM00049 EQU   @NM00048                                                 11391000
RSGDITEN EQU   RSGDITS+18                                               11392000
@NM00047 EQU   RSGDITS+16                                               11393000
RSGDITLN EQU   RSGDITS+12                                               11394000
RSGDITL  EQU   RSGDITS+4                                                11395000
RSGDITF  EQU   RSGDITS                                                  11396000
RSGCITUG EQU   RSGCITS+24                                               11397000
RSGCITNU EQU   @NM00045+1                                               11398000
@NM00046 EQU   @NM00045                                                 11399000
RSGCITEN EQU   RSGCITS+18                                               11400000
@NM00044 EQU   RSGCITS+16                                               11401000
RSGCITLN EQU   RSGCITS+12                                               11402000
RSGCITL  EQU   RSGCITS+4                                                11403000
RSGCITF  EQU   RSGCITS                                                  11404000
RSCRIOCS EQU   RSWORK+100                                               11405000
RSCPE8   EQU   RSWORK+96                                                11406000
RSCITDUM EQU   RSWORK+48                                                11407000
RSCANFCI EQU   RSWORK+44                                                11408000
RSCAIOCS EQU   RSWORK+40                                                11409000
RSCAHALC EQU   RSWORK+36                                                11410000
RSCAHACI EQU   RSWORK+32                                                11411000
RSCAFUCI EQU   RSWORK+28                                                11412000
RSCADS   EQU   RSWORK+24                                                11413000
RSCADD   EQU   RSWORK+20                                                11414000
RSAVAIL  EQU   RSWORK+8                                                 11415000
RSALLAGP EQU   RSWORK+4                                                 11416000
RSA      EQU   RSWORK                                                   11417000
@NM00043 EQU   RESVOL+12                                                11418000
@NM00042 EQU   RESVLFLG                                                 11419000
RESVLBAD EQU   RESVLFLG                                                 11420000
RESVLLAS EQU   RESVLFLG                                                 11421000
RESVLALE EQU   RESVLFLG                                                 11422000
RESVLMNT EQU   RESVLFLG                                                 11423000
RESVLUPD EQU   RESVOL+4                                                 11424000
RESVLNXT EQU   RESVOL                                                   11425000
VOLSRTS  EQU   VOLSERTB+20                                              11426000
VOLSRNTK EQU   VOLSERTB+12                                              11427000
CATIHRBA EQU   CATIEXT+16                                               11428000
CATILRBA EQU   CATIEXT+12                                               11429000
@NM00041 EQU   CATIEXT                                                  11430000
@NM00039 EQU   IOCRCV                                                   11431000
IOCRCVRA EQU   IOCRCV                                                   11432000
IOCRCVXM EQU   IOCRCV                                                   11433000
IOCVLN   EQU   IOCSEX+42                                                11434000
IOCDNM   EQU   IOCSEX+40                                                11435000
IOCDDN   EQU   IOCDLM                                                   11436000
IOCMODEX EQU   IOCMOD                                                   11437000
IOCMODRP EQU   IOCMOD                                                   11438000
IOCMODXM EQU   IOCMOD                                                   11439000
IOCMODUB EQU   IOCMOD                                                   11440000
IOCMODRG EQU   IOCMOD                                                   11441000
IOCMODDY EQU   IOCMOD                                                   11442000
IOCMODRR EQU   IOCMOD                                                   11443000
IOCMODPD EQU   IOCMOD                                                   11444000
IOCINFR1 EQU   IOCINF                                                   11445000
IOCINFCT EQU   IOCINF                                                   11446000
IOCINFDO EQU   IOCINF                                                   11447000
IOCINFAC EQU   IOCINF                                                   11448000
IOCINFQX EQU   IOCINF                                                   11449000
IOCINFND EQU   IOCINF                                                   11450000
IOCINFAE EQU   IOCINF                                                   11451000
IOCINFPT EQU   IOCINF                                                   11452000
@NM00038 EQU   IOCDEV                                                   11453000
IOCDEVUR EQU   IOCDEV                                                   11454000
IOCDEVMT EQU   IOCDEV                                                   11455000
IOCDEVDA EQU   IOCDEV                                                   11456000
@NM00037 EQU   IOCFLG                                                   11457000
IOCFLGSP EQU   IOCFLG                                                   11458000
IOCFLGOE EQU   IOCFLG                                                   11459000
IOCFLGOP EQU   IOCFLG                                                   11460000
IOCFLGIO EQU   IOCFLG                                                   11461000
IOCFLGEF EQU   IOCFLG                                                   11462000
IOCFLGDF EQU   IOCFLG                                                   11463000
IOCFLGEX EQU   IOCFLG                                                   11464000
IOCSID   EQU   IOCSEX+28                                                11465000
IOCNIO   EQU   IOCSEX+24                                                11466000
@NM00036 EQU   IOCXPM+2                                                 11467000
IOCEXL   EQU   IOCXPM                                                   11468000
IOCEXA   EQU   IOCXAD                                                   11469000
IOCWKA   EQU   IOCSEX+12                                                11470000
IOCLRP   EQU   IOCSEX+10                                                11471000
IOCCBL   EQU   IOCSEX+8                                                 11472000
IOCDEC   EQU   IOCRPL                                                   11473000
IOCCBA   EQU   IOCSEX                                                   11474000
@NM00035 EQU   IODATA+64                                                11475000
IODAEI   EQU   IODATA+60                                                11476000
@NM00034 EQU   IODATA+56                                                11477000
IODIOX   EQU   IODATA+52                                                11478000
IODOCS   EQU   IODATA+48                                                11479000
IODICS   EQU   IODATA+44                                                11480000
IODOSO   EQU   IODATA+40                                                11481000
IODOSS   EQU   IODATA+36                                                11482000
IODEOD   EQU   IODATA+32                                                11483000
@NM00033 EQU   IODATA+30                                                11484000
@NM00032 EQU   IODATA+28                                                11485000
IODOEV   EQU   IODATA+24                                                11486000
IODIEV   EQU   IODATA+20                                                11487000
IODINC   EQU   IODSID+2                                                 11488000
IODMID   EQU   IODSID                                                   11489000
IODXTN   EQU   IODATA+12                                                11490000
IODADD   EQU   IODATA+8                                                 11491000
IODMSG   EQU   IODATA+4                                                 11492000
IODIOC   EQU   IODATA                                                   11493000
WFILEVAL EQU   WFILE+10                                                 11494000
WFILELEN EQU   WFILE+9                                                  11495000
WFILEPAS EQU   WFILE+1                                                  11496000
WFILEPLN EQU   WFILE                                                    11497000
CRADVVAL EQU   CRADV+1                                                  11498000
CRADVLEN EQU   CRADV                                                    11499000
CRAVLVAL EQU   CRAVL+1                                                  11500000
CRAVLLEN EQU   CRAVL                                                    11501000
CRADNVAL EQU   CRADN+1                                                  11502000
CRADNLEN EQU   CRADN                                                    11503000
WCATVAL  EQU   WCAT+21                                                  11504000
WCATLEN  EQU   WCAT+20                                                  11505000
WCATMEM  EQU   WCAT+12                                                  11506000
WCATMLN  EQU   WCAT+11                                                  11507000
WCATFUQ  EQU   WCATFLG                                                  11508000
WCATPOS  EQU   WCAT+9                                                   11509000
WCATPAS  EQU   WCAT+1                                                   11510000
WCATPLN  EQU   WCAT                                                     11511000
MRPWVAL  EQU   MRPW+1                                                   11512000
MRPWLEN  EQU   MRPW                                                     11513000
CATDNVAL EQU   CATDN+1                                                  11514000
CATDNLEN EQU   CATDN                                                    11515000
CATNMVAL EQU   CATNM+21                                                 11516000
CATNMLEN EQU   CATNM+20                                                 11517000
CATNMMEM EQU   CATNM+12                                                 11518000
CATNMMLN EQU   CATNM+11                                                 11519000
CATNMFUQ EQU   CATNMFLG                                                 11520000
CATNMPOS EQU   CATNM+9                                                  11521000
CATNMPAS EQU   CATNM+1                                                  11522000
CATNMPLN EQU   CATNM                                                    11523000
@NM00031 EQU   DMPARY+15                                                11524000
DMPARYTP EQU   DMPARY+14                                                11525000
DMPARYEX EQU   DMPARY+12                                                11526000
DMPARYIC EQU   DMPARY+10                                                11527000
DMPARYSZ EQU   DMPARY+8                                                 11528000
DMPARYNM EQU   DMPARY                                                   11529000
@NM00030 EQU   DMPITM+15                                                11530000
DMPITMTP EQU   DMPITM+14                                                11531000
DMPITMLN EQU   DMPITM+12                                                11532000
DMPITMPT EQU   DMPITM+8                                                 11533000
DMPITMNM EQU   DMPITM                                                   11534000
@NM00029 EQU   ERCNVTAB+24                                              11535000
ERDARBPT EQU   ERCPLPT                                                  11536000
ERDYNRC  EQU   ERCATRC                                                  11537000
ERDSNM   EQU   ERCNVTAB+12                                              11538000
@NM00028 EQU   ERCNVTAB+4                                               11539000
@NM00027 EQU   ERCNVTAB+3                                               11540000
@NM00026 EQU   EROSOPER                                                 11541000
EROSUCDX EQU   EROSOPER                                                 11542000
EROSCATL EQU   EROSOPER                                                 11543000
@NM00025 EQU   EROPER                                                   11544000
ERCATAL  EQU   EROPER                                                   11545000
ERCATDL  EQU   EROPER                                                   11546000
ERCATDE  EQU   EROPER                                                   11547000
ERCATLC  EQU   EROPER                                                   11548000
@NM00024 EQU   ERTYPE                                                   11549000
ERDYNAL  EQU   ERTYPE                                                   11550000
EROSCAT  EQU   ERTYPE                                                   11551000
ERCATLG  EQU   ERTYPE                                                   11552000
@NM00023 EQU   FMTCNVF+1                                                11553000
FMTAR    EQU   FMTCNVF+1                                                11554000
FMTBS    EQU   FMTCNVF+1                                                11555000
FMTSS    EQU   FMTCNVF+1                                                11556000
FMTAL    EQU   FMTCNVF+1                                                11557000
FMTZS    EQU   FMTCNVF+1                                                11558000
@NM00022 EQU   FMTCNVF                                                  11559000
FMTPU    EQU   FMTCNVF                                                  11560000
FMTBD    EQU   FMTCNVF                                                  11561000
FMTBHD   EQU   FMTCNVF                                                  11562000
FMTBHA   EQU   FMTCNVF                                                  11563000
FMTBH    EQU   FMTCNVF                                                  11564000
FMTOLEN  EQU   FMTLIST+8                                                11565000
FMTRIO   EQU   FMTOCOL                                                  11566000
FMTSPT   EQU   FMTSTO                                                   11567000
FMTSTL   EQU   FMTILEN                                                  11568000
@NM00021 EQU   FMTFLGS+1                                                11569000
FMTSMSG  EQU   FMTFLGS+1                                                11570000
FMTHDF   EQU   FMTFLGS                                                  11571000
FMTDFF   EQU   FMTFLGS                                                  11572000
FMTSTF   EQU   FMTFLGS                                                  11573000
FMTREPF  EQU   FMTFLGS                                                  11574000
FMTBDF   EQU   FMTFLGS                                                  11575000
FMTIDF   EQU   FMTFLGS                                                  11576000
FMTSCF   EQU   FMTFLGS                                                  11577000
FMTEOLF  EQU   FMTFLGS                                                  11578000
DARGDTM  EQU   DARGARY+4                                                11579000
DARGPCT  EQU   DARGINL                                                  11580000
DARGREP  EQU   DARGINS                                                  11581000
@NM00020 EQU   DARGLIST+19                                              11582000
DARGIND  EQU   DARGLIST+18                                              11583000
DARGRETL EQU   DARGLIST+16                                              11584000
DARGCNT  EQU   DARGLIST+14                                              11585000
DARGILP  EQU   DARGLIST+12                                              11586000
DARGSENT EQU   DARGSTID+3                                               11587000
DARGSMOD EQU   DARGSTID                                                 11588000
DARGRETP EQU   DARGLIST+4                                               11589000
DARGDBP  EQU   DARGLIST                                                 11590000
@NM00019 EQU   IOINFOPT                                                 11591000
IOINFLUB EQU   IOINFOPT                                                 11592000
IOINFTMS EQU   IOINFOPT                                                 11593000
IOINFSUP EQU   IOINFOPT                                                 11594000
IOINFDSN EQU   IOINFOPT                                                 11595000
IOINFVOL EQU   IOINFOPT                                                 11596000
IOINFDVT EQU   IOINFOPT                                                 11597000
OPNSTRNO EQU   OPNAGL+43                                                11598000
@NM00018 EQU   OPNOPT2                                                  11599000
OPNOPTNM EQU   OPNOPT2                                                  11600000
OPNOPTAS EQU   OPNOPT2                                                  11601000
@NM00017 EQU   OPNDSO                                                   11602000
OPNDSOPO EQU   OPNDSO                                                   11603000
OPNDSOIS EQU   OPNDSO                                                   11604000
OPNDSOAM EQU   OPNDSO                                                   11605000
OPNREC   EQU   OPNAGL+32                                                11606000
OPNDEVIX EQU   OPNDEV+4                                                 11607000
OPNDEVDT EQU   OPNDEV                                                   11608000
OPNCBP   EQU   OPNAGL+20                                                11609000
OPNPWA   EQU   OPNAGL+12                                                11610000
OPNMODRP EQU   OPNMOD                                                   11611000
OPNMODUB EQU   OPNMOD                                                   11612000
OPNMODRS EQU   OPNMOD                                                   11613000
OPNMODAX EQU   OPNMOD                                                   11614000
OPNMODRR EQU   OPNMOD                                                   11615000
OPNMODRC EQU   OPNMOD                                                   11616000
OPNMODAC EQU   OPNMOD                                                   11617000
OPNMODPD EQU   OPNMOD                                                   11618000
OPNTYPSY EQU   OPNTYP                                                   11619000
OPNTYPRV EQU   OPNTYP                                                   11620000
OPNTYPEX EQU   OPNTYP                                                   11621000
OPNTYPRA EQU   OPNTYP                                                   11622000
OPNTYPXM EQU   OPNTYP                                                   11623000
OPNTYPCI EQU   OPNTYP                                                   11624000
OPNTYPSO EQU   OPNTYP                                                   11625000
OPNTYPSI EQU   OPNTYP                                                   11626000
@NM00016 EQU   OPNRFM                                                   11627000
OPNRFMBK EQU   OPNRFM                                                   11628000
OPNRFMSF EQU   OPNRFM                                                   11629000
OPNRFMUN EQU   OPNRFM                                                   11630000
OPNRFMVR EQU   OPNRFM                                                   11631000
OPNRFMFX EQU   OPNRFM                                                   11632000
OPNOPTSK EQU   OPNOPT                                                   11633000
OPNOPTDR EQU   OPNOPT                                                   11634000
OPNOPTCR EQU   OPNOPT                                                   11635000
OPNOPTKS EQU   OPNOPT                                                   11636000
OPNOPTUP EQU   OPNOPT                                                   11637000
OPNOPTOT EQU   OPNOPT                                                   11638000
IOCTSML  EQU   IOCREL+2                                                 11639000
IOCTPML  EQU   IOCREL                                                   11640000
IOCWORK  EQU   IOCSTR+56                                                11641000
IOCRRN   EQU   IOCSTR+52                                                11642000
IOCPNM   EQU   IOCNWM+2                                                 11643000
IOCPTL   EQU   IOCNWM                                                   11644000
IOCKYA   EQU   IOCMEM                                                   11645000
IOCVRC   EQU   IOCTTR                                                   11646000
IOCCBP   EQU   IOCSTR+36                                                11647000
IOCDSN   EQU   IOCSTR+32                                                11648000
IOCHURBA EQU   IOCSTR+28                                                11649000
IOCVOLSR EQU   IOCSTR+22                                                11650000
@NM00015 EQU   IOCMSG                                                   11651000
IOCMSGSM EQU   IOCMSG                                                   11652000
IOCMSGAE EQU   IOCMSG                                                   11653000
IOCMSGCE EQU   IOCMSG                                                   11654000
IOCMSGOE EQU   IOCMSG                                                   11655000
IOCMSGOP EQU   IOCMSG                                                   11656000
IOCCHPKG EQU   IOCMSG                                                   11657000
IOCCHPKE EQU   IOCMSG                                                   11658000
IOCCHPNU EQU   IOCCHP                                                   11659000
IOCCHPUP EQU   IOCCHP                                                   11660000
IOCCHPBK EQU   IOCCHP                                                   11661000
IOCCHPCR EQU   IOCCHP                                                   11662000
IOCCHPKS EQU   IOCCHP                                                   11663000
IOCCHPSK EQU   IOCCHP                                                   11664000
IOCCHPDR EQU   IOCCHP                                                   11665000
IOCCHPSQ EQU   IOCCHP                                                   11666000
IOCMACER EQU   IOCMAC2                                                  11667000
IOCMACPA EQU   IOCMAC2                                                  11668000
IOCMACEN EQU   IOCMAC2                                                  11669000
IOCMACCP EQU   IOCMAC2                                                  11670000
IOCMACRR EQU   IOCMAC2                                                  11671000
IOCMACAS EQU   IOCMAC2                                                  11672000
IOCMACSK EQU   IOCMAC2                                                  11673000
@NM00014 EQU   IOCMAC                                                   11674000
IOCMACCC EQU   IOCMAC                                                   11675000
IOCMACDR EQU   IOCMAC                                                   11676000
IOCMACBK EQU   IOCMAC                                                   11677000
IOCMACCR EQU   IOCMAC                                                   11678000
IOCMACUP EQU   IOCMAC                                                   11679000
IOCMACOT EQU   IOCMAC                                                   11680000
IOCMACIN EQU   IOCMAC                                                   11681000
@NM00013 EQU   IOCRFM                                                   11682000
IOCRFMBK EQU   IOCRFM                                                   11683000
IOCRFMSF EQU   IOCRFM                                                   11684000
IOCRFMUN EQU   IOCRFM                                                   11685000
IOCRFMVR EQU   IOCRFM                                                   11686000
IOCRFMFX EQU   IOCRFM                                                   11687000
@NM00012 EQU   IOCDSO                                                   11688000
IOCDSOPO EQU   IOCDSO                                                   11689000
IOCDSOIS EQU   IOCDSO                                                   11690000
IOCDSOPS EQU   IOCDSO                                                   11691000
IOCDSOAM EQU   IOCDSO                                                   11692000
IOCRKP   EQU   IOCSTR+13                                                11693000
IOCKYL   EQU   IOCSTR+12                                                11694000
IOCTRN   EQU   IOCSTR+8                                                 11695000
IOCDLN   EQU   IOCSTR+4                                                 11696000
UNITVTOC EQU   UNITABL+7                                                11697000
@NM00011 EQU   UNITSTAT                                                 11698000
UNITUSHR EQU   UNITSTAT                                                 11699000
UNITXSHR EQU   UNITSTAT                                                 11700000
UNITISHR EQU   UNITSTAT                                                 11701000
UNITUA   EQU   @NM00010+1                                               11702000
UNITCHA  EQU   @NM00010                                                 11703000
UNITUCB  EQU   UNITABL                                                  11704000
ALLUNCNT EQU   ALLAGL+30                                                11705000
ALLVLCNT EQU   ALLAGL+29                                                11706000
@NM00009 EQU   ALLOPT                                                   11707000
ALLOPTUN EQU   ALLOPT                                                   11708000
ALLOPTPV EQU   ALLOPT                                                   11709000
ALLOPTDS EQU   ALLOPT                                                   11710000
ALLOPTVL EQU   ALLOPT                                                   11711000
@NM00008 EQU   ALLORG+1                                                 11712000
ALLORGVS EQU   ALLORG+1                                                 11713000
@NM00007 EQU   ALLORG+1                                                 11714000
ALLORGGS EQU   ALLORG+1                                                 11715000
ALLORGUN EQU   ALLORG                                                   11716000
ALLORGPO EQU   ALLORG                                                   11717000
ALLORGMQ EQU   ALLORG                                                   11718000
ALLORGCQ EQU   ALLORG                                                   11719000
ALLORGCX EQU   ALLORG                                                   11720000
ALLORGDA EQU   ALLORG                                                   11721000
ALLORGPS EQU   ALLORG                                                   11722000
ALLORGIS EQU   ALLORG                                                   11723000
ALLDSPUN EQU   ALLDSP                                                   11724000
ALLDSPCG EQU   ALLDSP                                                   11725000
ALLDSPDE EQU   ALLDSP                                                   11726000
ALLDSPKP EQU   ALLDSP                                                   11727000
@NM00006 EQU   ALLDSP                                                   11728000
ALLSTSOD EQU   ALLSTS                                                   11729000
ALLSTSMD EQU   ALLSTS                                                   11730000
ALLSTSNW EQU   ALLSTS                                                   11731000
ALLSTSSR EQU   ALLSTS                                                   11732000
@NM00005 EQU   ALLSTS                                                   11733000
ALLPWD   EQU   ALLAGL+20                                                11734000
ALLVLP   EQU   ALLAGL+16                                                11735000
ALLULP   EQU   ALLAGL+12                                                11736000
ALLDDN   EQU   ALLAGL+4                                                 11737000
ALLDSN   EQU   ALLAGL                                                   11738000
CIRPID   EQU   CIRAGL+28                                                11739000
CIRPWD   EQU   CIRAGL+24                                                11740000
CIRCAT   EQU   CIRAGL+20                                                11741000
CIRWKP   EQU   CIRAGL+16                                                11742000
CIRTLR   EQU   CIRAGL+12                                                11743000
CIRHDR   EQU   CIRAGL+8                                                 11744000
CIRTLN   EQU   CIRAGL+6                                                 11745000
CIRHLN   EQU   CIRAGL+4                                                 11746000
@NM00004 EQU   CIRAGL+1                                                 11747000
@NM00003 EQU   CIRTYPE                                                  11748000
CIRTYPAQ EQU   CIRTYPE                                                  11749000
CIRTYP1Q EQU   CIRTYPE                                                  11750000
NEWID1   EQU   TRACE1+95                                                11751000
CALLID   EQU   OLDERID1+90                                              11752000
@NM00002 EQU   OLDERID1                                                 11753000
GDTECT   EQU   GDTTBL+188                                               11754000
GDTPSB   EQU   GDTTBL+184                                               11755000
GDTUPT   EQU   GDTTBL+180                                               11756000
GDTCMB   EQU   GDTTBL+176                                               11757000
GDTSPR   EQU   GDTTBL+168                                               11758000
@NM00001 EQU   GDTTBL+160                                               11759000
GDTABH   EQU   GDTTBL+156                                               11760000
GDTABT   EQU   GDTTBL+152                                               11761000
GDTTOH   EQU   GDTTBL+120                                               11762000
GDTRIP   EQU   GDTTBL+116                                               11763000
GDTSAH   EQU   GDTTBL+32                                                11764000
GDTTPH   EQU   GDTTBL+28                                                11765000
GDTRIH   EQU   GDTTBL+24                                                11766000
GDTSTH   EQU   GDTTBL+20                                                11767000
GDTDBH   EQU   GDTTBL+16                                                11768000
GDTPRM   EQU   GDTTBL+4                                                 11769000
GDTHDR   EQU   GDTTBL                                                   11770000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      11771000
@RC00743 EQU   @RC00729                                                 11772000
@RC00814 EQU   @RC00809                                                 11773000
@RC00820 EQU   @RC00809                                                 11774000
@RF00826 EQU   @RC00809                                                 11775000
@RF01330 EQU   @RC01328                                                 11776000
@RC01460 EQU   @RC01457                                                 11777000
@RF01515 EQU   @RC01457                                                 11778000
@RF02057 EQU   @RC02044                                                 11779000
@PB00018 EQU   @EL00001                                                 11780000
@ENDDATA EQU   *                                                        11781000
         END   IDCRS03,(C'PLS0731',0701,77119)                          11782000
