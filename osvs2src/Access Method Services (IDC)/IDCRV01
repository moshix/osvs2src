         TITLE '*********** IDCRV01:  RECOVERV FUNCTION SUPPORT ROUTINE*00001000
               E *******'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCRV01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCRV01   76.340'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @10,0                                               0002 00021000
@PSTART  LA    @12,4095(,@10)                                      0002 00022000
         USING @PSTART,@10                                         0002 00023000
         USING @PSTART+4095,@12                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @11,@01                                             0002 00027000
         USING @DATD,@11                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @11,8(,@13)                                         0002 00031000
         LR    @13,@11                                             0002 00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*                                      /* INCOMPLETE COPY    @Y30LB39*/ 00034000
*                                      /* FLAG COULD NOT BE  @Y30LB39*/ 00035000
*                                      /* CLEARED.           @Y30LB39*/ 00036000
*        /************************************************************/ 00037000
*        /*                                                  @Y30LB39*/ 00038000
*        /*  THIS IS CENTRAL SECTION OF THE RECOVERV ROUTINE.@Y30LB39*/ 00039000
*        /*  IT PERFORMS INITIALIZATION AND TERMINATION      @Y30LB39*/ 00040000
*        /*  FUNCTIONS AND ROUTES CONTROL TO SUB-PROCEDURES. @Y30LB39*/ 00041000
*        /*  THE EXIT FROM IDCRV01 OCCURS FROM HERE.         @Y30LB39*/ 00042000
*        /*                                                  @Y30LB39*/ 00043000
*        /************************************************************/ 00044000
*                                                          /*@Y30LB39*/ 00045000
*                                                          /*@Y30LB39*/ 00046000
*        /************************************************************/ 00047000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 00048000
*        /*  ON CONTROL WITHIN THIS RECOVERV ROUTINE         @Y30LB39*/ 00049000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 00050000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 00051000
*        /*                                                  @Y30LB39*/ 00052000
*        /************************************************************/ 00053000
*                                                          /*@Y30LB39*/ 00054000
*        OLDERID2 = NEWERID2;                                      0257 00055000
         L     @15,@PC00001                                        0257 00056000
         L     @14,GDTTR2(,@15)                                    0257 00057000
         MVC   @TS00001(95),NEWERID2(@14)                          0257 00058000
         MVC   OLDERID2(95,@14),@TS00001                           0257 00059000
*        NEWID2 = 'RVST';                                  /*@Y30LB39*/ 00060000
         MVC   NEWID2(4,@14),@CC01505                              0258 00061000
*                                                          /*@Y30LB39*/ 00062000
*                                                          /*@Y30LB39*/ 00063000
*        /************************************************************/ 00064000
*        /*                                                  @Y30LB39*/ 00065000
*        /*  DUMP ACCESS METHOD SERVICES GLOBAL DATA AREA    @Y30LB39*/ 00066000
*        /*  PRIOR TO SERVICING RECOVERV UTILITY REQUEST     @Y30LB39*/ 00067000
*        /*                                                  @Y30LB39*/ 00068000
*        /************************************************************/ 00069000
*                                                          /*@Y30LB39*/ 00070000
*        IF GDTDBG = NULLPTR                                       0259 00071000
*          THEN;                                                   0259 00072000
         L     @15,GDTDBG(,@15)                                    0259 00073000
         LTR   @15,@15                                             0259 00074000
         BZ    @RT00259                                            0259 00075000
*          ELSE                                                    0261 00076000
*            CALL IDCDB010 (GDTTBL,'RVBG');                        0261 00077000
         L     @15,@PC00001                                        0261 00078000
         ST    @15,@AL00001                                        0261 00079000
         LA    @14,@CC01506                                        0261 00080000
         ST    @14,@AL00001+4                                      0261 00081000
         MVI   @AL00001+4,X'80'                                    0261 00082000
         L     @15,GDTDBG(,@15)                                    0261 00083000
         LA    @01,@AL00001                                        0261 00084000
         BALR  @14,@15                                             0261 00085000
*                                                          /*@Y30LB39*/ 00086000
*                                                          /*@Y30LB39*/ 00087000
*        /************************************************************/ 00088000
*        /*                                                  @Y30LB39*/ 00089000
*        /*      INITIALIZE THE PRINT ARGUMENT LIST          @Y30LB39*/ 00090000
*        /*                                                  @Y30LB39*/ 00091000
*        /************************************************************/ 00092000
*                                                          /*@Y30LB39*/ 00093000
*        DDSTRU = ADDR(PRINTTAB);                          /*@Y30LB39*/ 00094000
@RT00259 LA    @07,PRINTTAB                                        0262 00095000
         ST    @07,DDSTRU                                          0262 00096000
*        PRINTTAB = ''B;                                   /*@Y30LB39*/ 00097000
         XC    PRINTTAB(44),PRINTTAB                               0263 00098000
*                                                          /*@Y30LB39*/ 00099000
*        /************************************************************/ 00100000
*        /*                                                  @Y30LB39*/ 00101000
*        /* THE NEXT SECTION OF CODE ESTABLISHES ADDRESS-    @Y30LB39*/ 00102000
*        /* ABILITY TO THE VARIOUS ARGUMENT AND PARAMETER    @Y30LB39*/ 00103000
*        /* LISTS WHICH ARE USED BY IDCRV01 IN SERVICING     @Y30LB39*/ 00104000
*        /* THE RECOVERV FSR REQUEST.                        @Y30LB39*/ 00105000
*        /*                                                  @Y30LB39*/ 00106000
*        /************************************************************/ 00107000
*                                                          /*@Y30LB39*/ 00108000
*        RFY ALLAGL BASED(ADDR(ALLAGLBF));                 /*@Y30LB39*/ 00109000
*        RFY CKAGL BASED(ADDR(CKAGLBUF));                  /*@Y30LB39*/ 00110000
*        RFY VS1AGL BASED(ADDR(VS1AGLBF));                 /*@Y30LB39*/ 00111000
*        RFY VS2AGL BASED(ADDR(VS2AGLBF));                 /*@Y30LB39*/ 00112000
*        RFY EXCLAGL BASED(ADDR(EXCLAGLB));                /*@ZD00175*/ 00113000
*        RFY MDAGL BASED(ADDR(MDAGLBUF));                  /*@Y30LB39*/ 00114000
*        COVCEPTR = ADDR(COVCEBUF);                        /*@Y30LB39*/ 00115000
         LA    @07,COVCEBUF                                        0270 00116000
         ST    @07,COVCEPTR                                        0270 00117000
*        MVRPTR = ADDR(MVRBUFR);                           /*@Y30LB39*/ 00118000
         LA    @07,MVRBUFR                                         0271 00119000
         ST    @07,MVRPTR                                          0271 00120000
*        RVVIPTR = ADDR(RVVIBUFR);                         /*@Y30LB39*/ 00121000
         LA    @07,RVVIBUFR                                        0272 00122000
         ST    @07,RVVIPTR                                         0272 00123000
*        COVCPTR = ADDR(COVLISTB);                         /*@Y30LB39*/ 00124000
         LA    @07,COVLISTB                                        0273 00125000
         ST    @07,COVCPTR                                         0273 00126000
*        BASEVPTR = ADDR(BASVOLBD);                        /*@Y30LB39*/ 00127000
         LA    BASEVPTR,BASVOLBD                                   0274 00128000
*        COPYVPTR = ADDR(COPVOLBD);                        /*@Y30LB39*/ 00129000
         LA    COPYVPTR,COPVOLBD                                   0275 00130000
*                                                          /*@Y30LB39*/ 00131000
*        /************************************************************/ 00132000
*        /*                                                  @Y30LB39*/ 00133000
*        /* SET THE INTERNAL TABLE USED BY THIS MODULE       @Y30LB39*/ 00134000
*        /* TO ZEROES.  ALL FLAGS ARE THEREBY INITIALIZED    @Y30LB39*/ 00135000
*        /* TO OFF.                                          @Y30LB39*/ 00136000
*        /*                                                  @Y30LB39*/ 00137000
*        /************************************************************/ 00138000
*                                                          /*@Y30LB39*/ 00139000
*        RECVTBL = ''B;                                    /*@Y30LB39*/ 00140000
         XC    RECVTBL(25),RECVTBL                                 0276 00141000
*        RECVTBC = 'RECVTBL ';                             /*@Y30LB39*/ 00142000
         MVC   RECVTBC(8),@CC01520                                 0277 00143000
*                                                          /*@Y30LB39*/ 00144000
*        /************************************************************/ 00145000
*        /*                                                  @Y30LB39*/ 00146000
*        /*  SET THE MOUNT-DEMOUNT ARGUMENT LIST TO ZEROES   @Y30LB39*/ 00147000
*        /*  SINCE THE LOGIC IN VPREPRTN SUBROUTINE          @Y30LB39*/ 00148000
*        /*  DEPENDS ON THIS INITIALIZATION.                 @Y30LB39*/ 00149000
*        /*                                                  @Y30LB39*/ 00150000
*        /************************************************************/ 00151000
*                                                          /*@Y30LB39*/ 00152000
*        MDAGL = ''B;                                      /*@Y30LB39*/ 00153000
         LA    @07,MDAGLBUF                                        0278 00154000
         XC    MDAGL(37,@07),MDAGL(@07)                            0278 00155000
*                                                          /*@Y30LB39*/ 00156000
*        /************************************************************/ 00157000
*        /*                                                  @Y30LB39*/ 00158000
*        /*  SET UP KEYWORD PARAMETERS FOR UENQ MACRO        @Y30LB39*/ 00159000
*        /*  TO ENQUEUE ON THE VOLUME SERIAL NUMBER          @Y30LB39*/ 00160000
*        /*                                                  @Y30LB39*/ 00161000
*        /************************************************************/ 00162000
*                                                          /*@Y30LB39*/ 00163000
*        RNAMLNTH = LENGTH(RNAMCHAR);                      /*@Y30LB39*/ 00164000
         MVI   RNAMLNTH,X'16'                                      0279 00165000
*        RNAMCHAR(1:6) = TVOLVAL;                          /*@Y30LB39*/ 00166000
         L     @07,@PC00001+4                                      0280 00167000
         L     @07,FDTPTR+4(,@07)                                  0280 00168000
         MVC   RNAMCHAR(6),TVOLVAL(@07)                            0280 00169000
*        RNAMCHAR(7:22) = '.VIRTUAL.ENQUEUE';              /*@Y30LB39*/ 00170000
         MVC   RNAMCHAR+6(16),@CC01521                             0281 00171000
*                                                          /*@Y30LB39*/ 00172000
*        /************************************************************/ 00173000
*        /*                                                  @Y30LB39*/ 00174000
*        /* ISSUE UENQ MACRO TO ENQUEUE ON THE VOLUME SERIAL @Y30LB39*/ 00175000
*        /* NUMBER TO INSURE THAT THE VOLUME RECORD IS NOT   @Y30LB39*/ 00176000
*        /* UPDATED DURING RECOVERV PROCESSING.              @Y30LB39*/ 00177000
*        /*                                                  @Y30LB39*/ 00178000
*        /************************************************************/ 00179000
*                                                          /*@Y30LB39*/ 00180000
*        CALL IDCSANQ0 (GDTTBL,EXCL,WAIT,'SYSZAMS ',MINORNAM);/*   0282 00181000
*                                                            @Y30LB39*/ 00182000
         MVC   @AL00001+4(12),@AL00282                             0282 00183000
         L     @07,@PC00001                                        0282 00184000
         ST    @07,@AL00001                                        0282 00185000
         LA    @04,MINORNAM                                        0282 00186000
         ST    @04,@AL00001+16                                     0282 00187000
         MVI   @AL00001+16,X'80'                                   0282 00188000
         L     @15,GDTENQ(,@07)                                    0282 00189000
         LA    @01,@AL00001                                        0282 00190000
         BALR  @14,@15                                             0282 00191000
*                                                          /*@Y30LB39*/ 00192000
*        /************************************************************/ 00193000
*        /*                                                  @Y30LB39*/ 00194000
*        /*  CALL SETUPRTN FOR THE CHECK OUT THAT IS         @Y30LB39*/ 00195000
*        /*  REQUIRED BEFORE THE COPY IS PERFORMED.          @Y30LB39*/ 00196000
*        /*  THIS INVOLVES CHECKING OUT THE SOURCE AND       @Y30LB39*/ 00197000
*        /*  TARGET VOLUMES AND THE ALLOCATED UNIT.          @Y30LB39*/ 00198000
*        /*                                                  @Y30LB39*/ 00199000
*        /************************************************************/ 00200000
*                                                          /*@Y30LB39*/ 00201000
*        CALL SETUPRTN;                                    /*@Y30LB39*/ 00202000
         BAL   @14,SETUPRTN                                        0283 00203000
*        RESPECIFY RTNREG RSTD;                                    0284 00204000
*        TESTRC = RTNREG;                                          0285 00205000
         LR    TESTRC,RTNREG                                       0285 00206000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 00207000
*        LASTCOND = TESTRC;                                /*@Y30LB39*/ 00208000
         L     @07,@PC00001+8                                      0287 00209000
         STH   TESTRC,LASTCOND(,@07)                               0287 00210000
*        IF LASTCOND = 0 THEN                                      0288 00211000
         L     @07,@PC00001+8                                      0288 00212000
         LH    @07,LASTCOND(,@07)                                  0288 00213000
         LTR   @07,@07                                             0288 00214000
         BNZ   @RF00288                                            0288 00215000
*          DO;                                             /*@Y30LB39*/ 00216000
*                                                          /*@Y30LB39*/ 00217000
*            /********************************************************/ 00218000
*            /*                                              @Y30LB39*/ 00219000
*            /*  CALL COPYRTN TO DIRECT THE COPY VOLUME      @Y30LB39*/ 00220000
*            /*  OPERATION WHICH INVOLVES DEMOUNTING THE     @Y30LB39*/ 00221000
*            /*  TARGET, PERFORMING THE COPY, AND CLEARING   @Y30LB39*/ 00222000
*            /*  THE INCOMPLETE-COPY FLAG IF THE TARGET      @Y30LB39*/ 00223000
*            /*  VOLUME SERIAL NUMBER REQUIRES NO UPDATING.  @Y30LB39*/ 00224000
*            /*                                              @Y30LB39*/ 00225000
*            /********************************************************/ 00226000
*                                                          /*@Y30LB39*/ 00227000
*            CALL COPYRTN;                                 /*@Y30LB39*/ 00228000
         BAL   @14,COPYRTN                                         0290 00229000
*            RESPECIFY RTNREG RSTD;                                0291 00230000
*            TESTRC = RTNREG;                                      0292 00231000
         LR    TESTRC,RTNREG                                       0292 00232000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/ 00233000
*            IF TESTRC ^= 0 THEN                                   0294 00234000
         LTR   TESTRC,TESTRC                                       0294 00235000
         BZ    @RF00294                                            0294 00236000
*              LASTCOND = LASTCC12;                        /*@Y30LB39*/ 00237000
         L     @15,@PC00001+8                                      0295 00238000
         MVC   LASTCOND(2,@15),@CH00567                            0295 00239000
*            ELSE                                                  0296 00240000
*              IF BASOWNER ^= COPOWNER | TVOLVAL ^= FVOLVAL THEN   0296 00241000
         B     @RC00294                                            0296 00242000
@RF00294 CLC   BASOWNER(10,BASEVPTR),COPOWNER(COPYVPTR)            0296 00243000
         BNE   @RT00296                                            0296 00244000
         L     @04,@PC00001+4                                      0296 00245000
         L     @01,FDTPTR+4(,@04)                                  0296 00246000
         L     @04,FDTPTR(,@04)                                    0296 00247000
         CLC   TVOLVAL(6,@01),FVOLVAL(@04)                         0296 00248000
         BE    @RF00296                                            0296 00249000
@RT00296 DS    0H                                                  0297 00250000
*                DO;                                       /*@Y30LB39*/ 00251000
*                                                          /*@Y30LB39*/ 00252000
*                  /**************************************************/ 00253000
*                  /*                                        @Y30LB39*/ 00254000
*                  /*  CALL LABELRTN TO DIRECT THE VOLUME    @Y30LB39*/ 00255000
*                  /*  LABEL UPDATE OPERATION.  THIS OPERA-  @Y30LB39*/ 00256000
*                  /*  TION INVOLVES MOUNTING THE TARGET,    @Y30LB39*/ 00257000
*                  /*  PERFORMING THE SOFTWARE LABEL UPDATE  @ZD00175*/ 00258000
*                  /*  AND CLEARING THE INCOMPLETE-COPY      @ZD00175*/ 00259000
*                  /*  FLAG IF THE TARGET VOLUME SERIAL      @Y30LB39*/ 00260000
*                  /*  NUMBER WAS UPDATED.                   @ZD00175*/ 00261000
*                  /*                                        @Y30LB39*/ 00262000
*                  /**************************************************/ 00263000
*                                                          /*@Y30LB39*/ 00264000
*                  CALL LABELRTN;                          /*@Y30LB39*/ 00265000
         BAL   @14,LABELRTN                                        0298 00266000
*                  RESPECIFY RTNREG RSTD;                          0299 00267000
*                  TESTRC = RTNREG;                                0300 00268000
         LR    TESTRC,RTNREG                                       0300 00269000
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30LB39*/ 00270000
*                  IF TESTRC ^= 0 THEN                             0302 00271000
         LTR   TESTRC,TESTRC                                       0302 00272000
         BZ    @RF00302                                            0302 00273000
*                    IF FVOLVAL = TVOLVAL THEN                     0303 00274000
         L     @15,@PC00001+4                                      0303 00275000
         L     @01,FDTPTR(,@15)                                    0303 00276000
         L     @15,FDTPTR+4(,@15)                                  0303 00277000
         CLC   FVOLVAL(6,@01),TVOLVAL(@15)                         0303 00278000
         BNE   @RF00303                                            0303 00279000
*                                                          /*@Y30LB39*/ 00280000
*                      /**********************************************/ 00281000
*                      /*                                    @Y30LB39*/ 00282000
*                      /*  NO SERIAL NUMBER UPDATE WAS       @Y30LB39*/ 00283000
*                      /*  REQUIRED.  IN THIS CASE, ONLY     @Y30LB39*/ 00284000
*                      /*  THE OWNER DATE COULD NOT BE       @Y30LB39*/ 00285000
*                      /*  RESTORED.                         @Y30LB39*/ 00286000
*                      /*                                    @Y30LB39*/ 00287000
*                      /**********************************************/ 00288000
*                                                          /*@Y30LB39*/ 00289000
*                      LASTCOND = MAX(LASTCOND,LASTCC08);  /*@Y30LB39*/ 00290000
         L     @15,@PC00001+8                                      0304 00291000
         LH    @14,LASTCOND(,@15)                                  0304 00292000
         LA    @09,8                                               0304 00293000
         CR    @14,@09                                             0304 00294000
         BNL   *+6                                                      00295000
         LR    @14,@09                                             0304 00296000
         STH   @14,LASTCOND(,@15)                                  0304 00297000
*                    ELSE                                          0305 00298000
*                                                          /*@Y30LB39*/ 00299000
*                      /**********************************************/ 00300000
*                      /*                                    @Y30LB39*/ 00301000
*                      /*  EITHER THE VOLUME SERIAL NUMBER   @Y30LB39*/ 00302000
*                      /*  UPDATE FAILED OR THE INCOMPLETE   @Y30LB39*/ 00303000
*                      /*  COPY FLAG COULD NOT BE CLEARED.   @Y30LB39*/ 00304000
*                      /*                                    @Y30LB39*/ 00305000
*                      /**********************************************/ 00306000
*                                                          /*@Y30LB39*/ 00307000
*                      LASTCOND = MAX(LASTCOND,LASTCC12);  /*@Y30LB39*/ 00308000
         B     @RC00303                                            0305 00309000
@RF00303 L     @15,@PC00001+8                                      0305 00310000
         LH    @14,LASTCOND(,@15)                                  0305 00311000
         LA    @09,12                                              0305 00312000
         CR    @14,@09                                             0305 00313000
         BNL   *+6                                                      00314000
         LR    @14,@09                                             0305 00315000
         STH   @14,LASTCOND(,@15)                                  0305 00316000
*                END;                                      /*@Y30LB39*/ 00317000
*                                                                  0306 00318000
*               /*****************************************************/ 00319000
*               /*                                           @ZD00175*/ 00320000
*               /* IF THE VOLUME HAS BEEN DEMOUNTED, REMOUNT THE     */ 00321000
*               /* TARGET VOLUME.  THE SECURITY CHECK PERFORMED BY   */ 00322000
*               /* IDCVS01 MAY HAVE RESULTED IN DYNAMIC ALLOCATION   */ 00323000
*               /* OF THE CATALOG AND THE CATALOG IS STILL OPEN.     */ 00324000
*               /*                                           @ZD00175*/ 00325000
*               /*****************************************************/ 00326000
*                                                                  0307 00327000
*               ELSE                                               0307 00328000
*                 IF DEMNTFLG=ON THEN                              0307 00329000
         B     @RC00296                                            0307 00330000
@RF00296 TM    DEMNTFLG,B'00000100'                                0307 00331000
         BNO   @RF00307                                            0307 00332000
*                   DO;                                    /*@ZD00175*/ 00333000
*                     MOUNTFLG=ON;                         /*@ZD00175*/ 00334000
*                     WAITFLG=OFF;                         /*@ZD00175*/ 00335000
         OI    MOUNTFLG,B'00100000'                                0310 00336000
         NI    WAITFLG,B'11101111'                                 0310 00337000
*                     CALL VPREPRTN;                       /*@ZD00175*/ 00338000
         BAL   @14,VPREPRTN                                        0311 00339000
*                     RESPECIFY RTNREG RSTD;                       0312 00340000
*                     TESTRC = RTNREG;                             0313 00341000
         LR    TESTRC,RTNREG                                       0313 00342000
*                     RESPECIFY RTNREG UNRSTD;             /*@ZD00175*/ 00343000
*                                                                  0314 00344000
*                     /***********************************************/ 00345000
*                     /*                                     @ZD00175*/ 00346000
*                     /* IF THE TARGET VOLUME COULD NOT BE REMOUNTED, * 00347000
*                     /* UPDATE THE FINAL CONDITION CODE.    @ZD00175*/ 00348000
*                     /*                                     @ZD00175*/ 00349000
*                     /***********************************************/ 00350000
*                                                                  0315 00351000
*                     IF TESTRC^=0 THEN                            0315 00352000
         LTR   TESTRC,TESTRC                                       0315 00353000
         BZ    @RF00315                                            0315 00354000
*                       LASTCOND=MAX(LASTCOND,LASTCC04);   /*@ZD00175*/ 00355000
         L     @15,@PC00001+8                                      0316 00356000
         LH    @14,LASTCOND(,@15)                                  0316 00357000
         LA    @09,4                                               0316 00358000
         CR    @14,@09                                             0316 00359000
         BNL   *+6                                                      00360000
         LR    @14,@09                                             0316 00361000
         STH   @14,LASTCOND(,@15)                                  0316 00362000
*                   END;                                   /*@ZD00175*/ 00363000
@RF00315 DS    0H                                                  0318 00364000
*          END;                                            /*#Y30LB39*/ 00365000
@RF00307 DS    0H                                                  0318 00366000
@RC00296 DS    0H                                                  0318 00367000
@RC00294 DS    0H                                                  0319 00368000
*                                                          /*@Y30LB39*/ 00369000
*        /************************************************************/ 00370000
*        /*                                                  @Y30LB39*/ 00371000
*        /*  CHECK TO SEE IF A MINOR ERROR OCCURED           @Y30LB39*/ 00372000
*        /*  DURING THE PROCESSING OF THE RECOVERV REQUEST.  @Y30LB39*/ 00373000
*        /*                                                  @Y30LB39*/ 00374000
*        /************************************************************/ 00375000
*                                                          /*@Y30LB39*/ 00376000
*        IF LASTCOND < LASTCC04 & CC04FLG = ON THEN                0319 00377000
@RF00288 LA    @15,4                                               0319 00378000
         L     @14,@PC00001+8                                      0319 00379000
         CH    @15,LASTCOND(,@14)                                  0319 00380000
         BNH   @RF00319                                            0319 00381000
         TM    CC04FLG,B'01000000'                                 0319 00382000
         BNO   @RF00319                                            0319 00383000
*          LASTCOND = LASTCC04;                            /*@Y30LB39*/ 00384000
         STH   @15,LASTCOND(,@14)                                  0320 00385000
*                                                          /*@Y30LB39*/ 00386000
*        /************************************************************/ 00387000
*        /*                                                  @Y30LB39*/ 00388000
*        /*  ISSUE DEQUEUE MACRO TO RELEASE ENQUEUE SET AT   @Y30LB39*/ 00389000
*        /*  BEGINNING OF PROGRAM.                           @Y30LB39*/ 00390000
*        /*                                                  @Y30LB39*/ 00391000
*        /************************************************************/ 00392000
*                                                          /*@Y30LB39*/ 00393000
*        RNAMCHAR(1:6) = TVOLVAL;                          /*@Y30LB39*/ 00394000
@RF00319 L     @15,@PC00001+4                                      0321 00395000
         L     @01,FDTPTR+4(,@15)                                  0321 00396000
         MVC   RNAMCHAR(6),TVOLVAL(@01)                            0321 00397000
*        RNAMCHAR(7:22) = '.VIRTUAL.ENQUEUE';              /*@ZA05138*/ 00398000
         MVC   RNAMCHAR+6(16),@CC01521                             0322 00399000
*        CALL IDCSADQ0 (GDTTBL,'SYSZAMS ',MINORNAM);       /*@Y30LB39*/ 00400000
         L     @15,@PC00001                                        0323 00401000
         ST    @15,@AL00001                                        0323 00402000
         LA    @14,@CC01523                                        0323 00403000
         ST    @14,@AL00001+4                                      0323 00404000
         LA    @14,MINORNAM                                        0323 00405000
         ST    @14,@AL00001+8                                      0323 00406000
         MVI   @AL00001+8,X'80'                                    0323 00407000
         L     @15,GDTDEQ(,@15)                                    0323 00408000
         LA    @01,@AL00001                                        0323 00409000
         BALR  @14,@15                                             0323 00410000
*                                                          /*@Y30LB39*/ 00411000
*                                                          /*@Y30LB39*/ 00412000
*        /************************************************************/ 00413000
*        /*                                                  @Y30LB39*/ 00414000
*        /*  ISSUE UPRINT TO PRINT THE APPROPRIATE           @Y30LB39*/ 00415000
*        /*  COMPLETION MESSAGE.                             @Y30LB39*/ 00416000
*        /*  MESSAGE IDC3003I IF CONDITION CODE GREATER      @Y30LB39*/ 00417000
*        /*  THAN EIGHT                                      @Y30LB39*/ 00418000
*        /*  MESSAGE IDC0001I IF CONDITION CODE LESS THAN    @Y30LB39*/ 00419000
*        /*  OR EQUAL TO EIGHT.                              @Y30LB39*/ 00420000
*        /*                                                  @Y30LB39*/ 00421000
*        /************************************************************/ 00422000
*                                                          /*@Y30LB39*/ 00423000
*        DARGLIST = ''B;                                   /*@Y30LB39*/ 00424000
         L     @15,DDSTRU                                          0324 00425000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0324 00426000
*        IF LASTCOND > LASTCC08 THEN                               0325 00427000
         L     @14,@PC00001+8                                      0325 00428000
         LH    @14,LASTCOND(,@14)                                  0325 00429000
         C     @14,@CF00178                                        0325 00430000
         BNH   @RF00325                                            0325 00431000
*          DARGSENT = MSG3003I;                            /*@Y30LB39*/ 00432000
         MVI   DARGSENT(@15),X'03'                                 0326 00433000
*        ELSE                                                      0327 00434000
*          DARGSENT = MSG0001I;                            /*@Y30LB39*/ 00435000
         B     @RC00325                                            0327 00436000
@RF00325 L     @01,DDSTRU                                          0327 00437000
         MVI   DARGSENT(@01),X'01'                                 0327 00438000
*        DARGSMOD = UNIVMSG;                               /*@Y30LB39*/ 00439000
@RC00325 L     @15,DDSTRU                                          0328 00440000
         MVC   DARGSMOD(3,@15),@CC01462                            0328 00441000
*        DARGDBP = ADDR(LASTCOND);                         /*@Y30LB39*/ 00442000
         L     @14,@PC00001+8                                      0329 00443000
         ST    @14,DARGDBP(,@15)                                   0329 00444000
*        DARGILP = LENGTH (LASTCOND);                      /*@Y30LB39*/ 00445000
         MVC   DARGILP(2,@15),@CH00152                             0330 00446000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);            /*@Y30LB39*/ 00447000
         L     @15,@PC00001                                        0331 00448000
         ST    @15,@AL00001                                        0331 00449000
         LA    @14,@CF00114                                        0331 00450000
         ST    @14,@AL00001+4                                      0331 00451000
         LA    @14,DDSTRU                                          0331 00452000
         ST    @14,@AL00001+8                                      0331 00453000
         MVI   @AL00001+8,X'80'                                    0331 00454000
         L     @15,GDTPRT(,@15)                                    0331 00455000
         LA    @01,@AL00001                                        0331 00456000
         BALR  @14,@15                                             0331 00457000
*                                                          /*@Y30LB39*/ 00458000
*        /************************************************************/ 00459000
*        /*                                                  @Y30LB39*/ 00460000
*        /*  DUMP ACCESS METHOD SERVICES GLOBAL DATA AREA    @Y30LB39*/ 00461000
*        /*  PRIOR TO RETURNING TO EXECUTIVE ROUTINE.        @Y30LB39*/ 00462000
*        /*                                                  @Y30LB39*/ 00463000
*        /************************************************************/ 00464000
*                                                          /*@Y30LB39*/ 00465000
*        IF GDTDBG = NULLPTR                                       0332 00466000
*          THEN;                                                   0332 00467000
         L     @15,@PC00001                                        0332 00468000
         L     @15,GDTDBG(,@15)                                    0332 00469000
         LTR   @15,@15                                             0332 00470000
         BZ    @RT00332                                            0332 00471000
*          ELSE                                                    0334 00472000
*            CALL IDCDB010 (GDTTBL,'RVND');                        0334 00473000
         L     @15,@PC00001                                        0334 00474000
         ST    @15,@AL00001                                        0334 00475000
         LA    @14,@CC01528                                        0334 00476000
         ST    @14,@AL00001+4                                      0334 00477000
         MVI   @AL00001+4,X'80'                                    0334 00478000
         L     @15,GDTDBG(,@15)                                    0334 00479000
         LA    @01,@AL00001                                        0334 00480000
         BALR  @14,@15                                             0334 00481000
*                                                          /*@Y30LB39*/ 00482000
*          CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                   0335 00483000
@RT00332 L     @15,@PC00001                                        0335 00484000
         ST    @15,@AL00001                                        0335 00485000
         LA    @14,MODID                                           0335 00486000
         ST    @14,@AL00001+4                                      0335 00487000
         L     @14,@PC00001+8                                      0335 00488000
         ST    @14,@AL00001+8                                      0335 00489000
         MVI   @AL00001+8,X'80'                                    0335 00490000
         L     @15,GDTEPL(,@15)                                    0335 00491000
         LA    @01,@AL00001                                        0335 00492000
         BALR  @14,@15                                             0335 00493000
*       /*@Y30LB39*/                                               0336 00494000
*        /************************************************************/ 00495000
*        /*                                                  @Y30LB39*/ 00496000
*        /*  PROCEDURE NAME - SETUPRTN                       @Y30LB39*/ 00497000
*        /*                                                  @Y30LB39*/ 00498000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 00499000
*        /*  DIRECT THE CHECKING OUT OF SOURCE AND TARGET    @Y30LB39*/ 00500000
*        /*  VOLUMES.  IT DOES THIS BY CALLING SUBROUTINES   @Y30LB39*/ 00501000
*        /*  TO READ THE INVENTORY RECORDS, ALLOCATE UNIT    @Y30LB39*/ 00502000
*        /*  AND MAKE SECURITY CHECK OF THE VOLUMES.  IF, AT @Y30LB39*/ 00503000
*        /*  ANY TIME, IT RECEIVES A NON-ZERO RETURN CODE    @Y30LB39*/ 00504000
*        /*  BACK FROM A PROCEDURE WHICH IT CALLS, IT WILL   @Y30LB39*/ 00505000
*        /*  RETURN TO THE MAINLINE ROUTINE WHICH CALLED IT. @Y30LB39*/ 00506000
*        /*                                                  @Y30LB39*/ 00507000
*        /*  INPUT - BUFFER FOR BASE VOLUME RECORD           @Y30LB39*/ 00508000
*        /*                                                  @Y30LB39*/ 00509000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 00510000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 00511000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 00512000
*        /*     12 - IF CHECK OF SOURCE AND TARGET VOLUMES   @Y30LB39*/ 00513000
*        /*          NOT OKAY OR                             @Y30LB39*/ 00514000
*        /*          IF VTOC CHECK NOT OKAY OR               @Y30LB39*/ 00515000
*        /*          IF UNABLE TO DYNAMICALLY ALLOCAT A UNIT @Y30LB39*/ 00516000
*        /*                                                  @Y30LB39*/ 00517000
*        /************************************************************/ 00518000
*                                                                  0336 00519000
*SETUPRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/ 00520000
*                                                                  0336 00521000
@EL00001 L     @13,4(,@13)                                         0336 00522000
@EF00001 L     @00,@SIZDATD                                        0336 00523000
         LR    @01,@11                                             0336 00524000
         FREEMAIN R,LV=(0),A=(1)                                        00525000
@ER00001 LM    @14,@12,12(@13)                                     0336 00526000
         BR    @14                                                 0336 00527000
SETUPRTN DS    0H                                                  0337 00528000
*        /************************************************************/ 00529000
*        /*                                                  @Y30LB39*/ 00530000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 00531000
*        /*                                                  @Y30LB39*/ 00532000
*        /************************************************************/ 00533000
*                                                          /*@Y30LB39*/ 00534000
*        DCL SETUPRC FIXED(8);         /* RETURN CODE        @Y30LB39*/ 00535000
*                                                          /*@Y30LB39*/ 00536000
*        /************************************************************/ 00537000
*        /*                                                  @Y30LB39*/ 00538000
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/ 00539000
*        /*                                                  @Y30LB39*/ 00540000
*        /************************************************************/ 00541000
*                                                          /*@Y30LB39*/ 00542000
*        RETADDR1 = REG14;                                 /*@Y30LB39*/ 00543000
         ST    REG14,RETADDR1                                      0338 00544000
*                                                          /*@Y30LB39*/ 00545000
*        /************************************************************/ 00546000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 00547000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 00548000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 00549000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 00550000
*        /*                                                  @Y30LB39*/ 00551000
*        /************************************************************/ 00552000
*                                                          /*@Y30LB39*/ 00553000
*        OLDERID2 = NEWERID2;                                      0339 00554000
         L     @07,@PC00001                                        0339 00555000
         L     @07,GDTTR2(,@07)                                    0339 00556000
         MVC   @TS00001(95),NEWERID2(@07)                          0339 00557000
         MVC   OLDERID2(95,@07),@TS00001                           0339 00558000
*        NEWID2 = 'RVSU';                                  /*@Y30LB39*/ 00559000
         MVC   NEWID2(4,@07),@CC01533                              0340 00560000
*                                                          /*@Y30LB39*/ 00561000
*        /************************************************************/ 00562000
*        /*                                                  @Y30LB39*/ 00563000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 00564000
*        /*                                                  @Y30LB39*/ 00565000
*        /************************************************************/ 00566000
*                                                          /*@Y30LB39*/ 00567000
*        SETUPRC = LASTCC00;                               /*@Y30LB39*/ 00568000
         MVI   SETUPRC,X'00'                                       0341 00569000
*                                                          /*@Y30LB39*/ 00570000
*        /************************************************************/ 00571000
*        /*                                                  @Y30LB39*/ 00572000
*        /*  CALL VOLCKRTN TO CHECK OUT THE SOURCE AND       @Y30LB39*/ 00573000
*        /*  TARGET VOLUMES.                                 @Y30LB39*/ 00574000
*        /*  IF THE RETURN CODE IS NOT ZERO, THEN EXIT       @Y30LB39*/ 00575000
*        /*  VIA THE LAST STEP IN THIS SUBROUTINE.           @Y30LB39*/ 00576000
*        /*                                                  @Y30LB39*/ 00577000
*        /************************************************************/ 00578000
*                                                          /*@Y30LB39*/ 00579000
*        CALL VOLCKRTN;                                    /*@Y30LB39*/ 00580000
         BAL   @14,VOLCKRTN                                        0342 00581000
*        RESPECIFY RTNREG RSTD;                                    0343 00582000
*        TESTRC = RTNREG;                                          0344 00583000
         LR    TESTRC,RTNREG                                       0344 00584000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 00585000
*        IF TESTRC ^= 0 THEN                                       0346 00586000
         LTR   TESTRC,TESTRC                                       0346 00587000
         BZ    @RF00346                                            0346 00588000
*          SETUPRC = LASTCC12;                             /*@Y30LB39*/ 00589000
         MVI   SETUPRC,X'0C'                                       0347 00590000
*        ELSE                                                      0348 00591000
*          DO;                                             /*@Y30LB39*/ 00592000
         B     @RC00346                                            0348 00593000
@RF00346 DS    0H                                                  0349 00594000
*                                                          /*@Y30LB39*/ 00595000
*            /********************************************************/ 00596000
*            /*                                              @Y30LB39*/ 00597000
*            /*  CALL ALLOCRTN TO DYNAMICALLY ALLOCATE A     @Y30LB39*/ 00598000
*            /*  UNIT AND TO CHECK OUT THE UNIT OBTAINED     @Y30LB39*/ 00599000
*            /*  EITHER DYNAMICALLY OR VIA THE FILE          @Y30LB39*/ 00600000
*            /*  PARAMETER.  IF THE RETURN CODE IS NOT ZERO, @Y30LB39*/ 00601000
*            /*  EXIT VIA THE LAST STEP IN THIS SUBROUTINE.  @Y30LB39*/ 00602000
*            /*                                              @Y30LB39*/ 00603000
*            /********************************************************/ 00604000
*                                                          /*@Y30LB39*/ 00605000
*            CALL ALLOCRTN;                                /*@Y30LB39*/ 00606000
         BAL   @14,ALLOCRTN                                        0349 00607000
*            RESPECIFY RTNREG RSTD;                                0350 00608000
*            TESTRC = RTNREG;                                      0351 00609000
         LR    TESTRC,RTNREG                                       0351 00610000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/ 00611000
*            IF TESTRC ^= 0 THEN                                   0353 00612000
         LTR   TESTRC,TESTRC                                       0353 00613000
         BZ    @RF00353                                            0353 00614000
*              SETUPRC = LASTCC12;                         /*@Y30LB39*/ 00615000
         MVI   SETUPRC,X'0C'                                       0354 00616000
*            ELSE                                                  0355 00617000
*              IF (BASIVCRE=OFF & BASIVCPY=OFF & BASVSMIS=OFF) THEN     00618000
         B     @RC00353                                            0355 00619000
@RF00353 TM    BASIVCRE(BASEVPTR),B'11100000'                      0355 00620000
         BNZ   @RF00355                                            0355 00621000
*                DO;                                       /*@Y30LB39*/ 00622000
*                                                          /*@Y30LB39*/ 00623000
*                  /**************************************************/ 00624000
*                  /*                                        @Y30LB39*/ 00625000
*                  /*  CALL VTOCKRTN IN ORDER TO MAKE THE    @Y30LB39*/ 00626000
*                  /*  APPROPRIATE VTOC CHECK.               @Y30LB39*/ 00627000
*                  /*                                        @Y30LB39*/ 00628000
*                  /**************************************************/ 00629000
*                                                          /*@Y30LB39*/ 00630000
*                  CALL VTOCKRTN;                          /*@Y30LB39*/ 00631000
         BAL   @14,VTOCKRTN                                        0357 00632000
*                  RESPECIFY RTNREG RSTD;                          0358 00633000
*                  TESTRC = RTNREG;                                0359 00634000
         LR    TESTRC,RTNREG                                       0359 00635000
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30LB39*/ 00636000
*                  IF TESTRC ^= 0 THEN                             0361 00637000
         LTR   TESTRC,TESTRC                                       0361 00638000
         BZ    @RF00361                                            0361 00639000
*                    SETUPRC = LASTCC12;                   /*@Y30LB39*/ 00640000
         MVI   SETUPRC,X'0C'                                       0362 00641000
*                END;                                      /*@Y30LB39*/ 00642000
@RF00361 DS    0H                                                  0364 00643000
*          END;                                            /*@Y30LB39*/ 00644000
@RF00355 DS    0H                                                  0364 00645000
@RC00353 DS    0H                                                  0365 00646000
*                                                          /*@Y30LB39*/ 00647000
*        /************************************************************/ 00648000
*        /*                                                  @Y30LB39*/ 00649000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 00650000
*        /*                                                  @Y30LB39*/ 00651000
*        /************************************************************/ 00652000
*                                                          /*@Y30LB39*/ 00653000
*        REG14 = RETADDR1;                                 /*@Y30LB39*/ 00654000
@RC00346 L     REG14,RETADDR1                                      0365 00655000
*                                                          /*@Y30LB39*/ 00656000
*        /************************************************************/ 00657000
*        /*                                                  @Y30LB39*/ 00658000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 00659000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 00660000
*        /*                                                  @Y30LB39*/ 00661000
*        /************************************************************/ 00662000
*                                                          /*@Y30LB39*/ 00663000
*        RETURN CODE(SETUPRC);                             /*@Y30LB39*/ 00664000
         SLR   @15,@15                                             0366 00665000
         IC    @15,SETUPRC                                         0366 00666000
@EL00002 DS    0H                                                  0366 00667000
@EF00002 DS    0H                                                  0366 00668000
@ER00002 BR    @14                                                 0366 00669000
*END SETUPRTN;                                             /*@Y30LB39*/ 00670000
*        /************************************************************/ 00671000
*        /*                                                  @Y30LB39*/ 00672000
*        /*  PROCEDURE NAME - VOLCKRTN                       @Y30LB39*/ 00673000
*        /*                                                  @Y30LB39*/ 00674000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 00675000
*        /*  DIRECT THE RETRIEVAL OF THE INVENTORY RECORDS   @Y30LB39*/ 00676000
*        /*  AND THE VOLUME CHECKOUT.  IT FIRST SPECIFIES    @Y30LB39*/ 00677000
*        /*  THAT THE BASE VOLUME RECORD                     @Y30LB39*/ 00678000
*        /*  IS TO BE RETRIEVED AND FOLLOWING THAT, IT       @Y30LB39*/ 00679000
*        /*  RETRIEVES A COPY VOLUME RECORD.                 @Y30LB39*/ 00680000
*        /*  THEN THE APPROPRIATE SUBROUTINE IS CALLED TO    @Y30LB39*/ 00681000
*        /*  CHECK OUT THE STATUS OF THE SOURCE OR TARGET    @Y30LB39*/ 00682000
*        /*  VOLUMES.                                        @Y30LB39*/ 00683000
*        /*                                                  @Y30LB39*/ 00684000
*        /*  INPUT - RECVTBL                                 @Y30LB39*/ 00685000
*        /*                                                  @Y30LB39*/ 00686000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 00687000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 00688000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 00689000
*        /*      4 - IF RETURN CODE OF A CALLED SUBPROCEDURE @Y30LB39*/ 00690000
*        /*          IS NOT ZERO.                            @Y30LB39*/ 00691000
*        /*                                                  @Y30LB39*/ 00692000
*        /************************************************************/ 00693000
*                                                                  0368 00694000
*VOLCKRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/ 00695000
*                                                                  0368 00696000
VOLCKRTN DS    0H                                                  0369 00697000
*        /************************************************************/ 00698000
*        /*                                                  @Y30LB39*/ 00699000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 00700000
*        /*                                                  @Y30LB39*/ 00701000
*        /************************************************************/ 00702000
*                                                          /*@Y30LB39*/ 00703000
*        DCL VOLCHKRC FIXED(8);        /* RETURN CODE        @Y30LB39*/ 00704000
*                                                          /*@Y30LB39*/ 00705000
*        /************************************************************/ 00706000
*        /*                                                  @Y30LB39*/ 00707000
*        /*  SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE   @Y30LB39*/ 00708000
*        /*                                                  @Y30LB39*/ 00709000
*        /************************************************************/ 00710000
*                                                          /*@Y30LB39*/ 00711000
*        RETADDR2 = REG14;                                 /*@Y30LB39*/ 00712000
         LR    RETADDR2,REG14                                      0370 00713000
*                                                          /*@Y30LB39*/ 00714000
*        /************************************************************/ 00715000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 00716000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 00717000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 00718000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 00719000
*        /*                                                  @Y30LB39*/ 00720000
*        /************************************************************/ 00721000
*                                                          /*@Y30LB39*/ 00722000
*        OLDERID2 = NEWERID2;                                      0371 00723000
         L     @08,@PC00001                                        0371 00724000
         L     @08,GDTTR2(,@08)                                    0371 00725000
         MVC   @TS00001(95),NEWERID2(@08)                          0371 00726000
         MVC   OLDERID2(95,@08),@TS00001                           0371 00727000
*        NEWID2 = 'RVVO';                                  /*@Y30LB39*/ 00728000
         MVC   NEWID2(4,@08),@CC01541                              0372 00729000
*                                                          /*@Y30LB39*/ 00730000
*        /************************************************************/ 00731000
*        /*                                                  @Y30LB39*/ 00732000
*        /*      SET CONDITION CODE AND RETURN CODES TO ZERO @Y30LB39*/ 00733000
*        /*                                                  @Y30LB39*/ 00734000
*        /************************************************************/ 00735000
*                                                          /*@Y30LB39*/ 00736000
*        VOLCHKRC = LASTCC00;                              /*@Y30LB39*/ 00737000
         SLR   VOLCHKRC,VOLCHKRC                                   0373 00738000
*                                                          /*@Y30LB39*/ 00739000
*        /************************************************************/ 00740000
*        /*                                                  @Y30LB39*/ 00741000
*        /*  CALL RVVIRTN TO RETRIEVE THE APPROPRIATE        @Y30LB39*/ 00742000
*        /*  COPY VOLUME RECORD FOR THE SOURCE VOLUME.       @Y30LB39*/ 00743000
*        /*                                                  @Y30LB39*/ 00744000
*        /************************************************************/ 00745000
*                                                          /*@Y30LB39*/ 00746000
*        RECTYPE = COPYCHAR;                               /*@Y30LB39*/ 00747000
         MVC   RECTYPE(4),COPYCHAR                                 0374 00748000
*        CALL RVVIRTN;                                     /*@Y30LB39*/ 00749000
         BAL   @14,RVVIRTN                                         0375 00750000
*        RESPECIFY RTNREG RSTD;                                    0376 00751000
*        TESTRC = RTNREG;                                          0377 00752000
         LR    TESTRC,RTNREG                                       0377 00753000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 00754000
*        IF TESTRC ^= 0 THEN                                       0379 00755000
         LTR   TESTRC,TESTRC                                       0379 00756000
         BZ    @RF00379                                            0379 00757000
*          VOLCHKRC = LASTCC04;                            /*@Y30LB39*/ 00758000
         LA    VOLCHKRC,4                                          0380 00759000
*        ELSE                                                      0381 00760000
*          DO;                                             /*@Y30LB39*/ 00761000
         B     @RC00379                                            0381 00762000
@RF00379 DS    0H                                                  0382 00763000
*                                                          /*@Y30LB39*/ 00764000
*            /********************************************************/ 00765000
*            /*                                              @Y30LB39*/ 00766000
*            /*  CALL FVOLRTN TO VERIFY THAT THE SOURCE      @Y30LB39*/ 00767000
*            /*  VOLUME IS USABLE.                           @Y30LB39*/ 00768000
*            /*                                              @Y30LB39*/ 00769000
*            /********************************************************/ 00770000
*                                                          /*@Y30LB39*/ 00771000
*            CALL FVOLRTN;                                 /*@Y30LB39*/ 00772000
         BAL   @14,FVOLRTN                                         0382 00773000
*            RESPECIFY RTNREG RSTD;                                0383 00774000
*            TESTRC = RTNREG;                                      0384 00775000
         LR    TESTRC,RTNREG                                       0384 00776000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/ 00777000
*            IF TESTRC ^= 0 THEN                                   0386 00778000
         LTR   TESTRC,TESTRC                                       0386 00779000
         BZ    @RF00386                                            0386 00780000
*              VOLCHKRC = LASTCC04;                        /*@Y30LB39*/ 00781000
         LA    VOLCHKRC,4                                          0387 00782000
*          END;                                            /*@Y30LB39*/ 00783000
@RF00386 DS    0H                                                  0389 00784000
*                                                          /*@Y30LB39*/ 00785000
*        /************************************************************/ 00786000
*        /*                                                  @Y30LB39*/ 00787000
*        /*  CALL RVVIRTN TO RETRIEVE THE BASE VOLUME        @Y30LB39*/ 00788000
*        /*  RECORD FOR THE TARGET VOLUME                    @Y30LB39*/ 00789000
*        /*                                                  @Y30LB39*/ 00790000
*        /************************************************************/ 00791000
*                                                          /*@Y30LB39*/ 00792000
*        RECTYPE = BASECHAR;                               /*@Y30LB39*/ 00793000
@RC00379 MVC   RECTYPE(4),BASECHAR                                 0389 00794000
*        CALL RVVIRTN;                                     /*@Y30LB39*/ 00795000
         BAL   @14,RVVIRTN                                         0390 00796000
*        RESPECIFY RTNREG RSTD;                                    0391 00797000
*        TESTRC = RTNREG;                                          0392 00798000
         LR    TESTRC,RTNREG                                       0392 00799000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 00800000
*        IF TESTRC ^= 0 THEN                                       0394 00801000
         LTR   TESTRC,TESTRC                                       0394 00802000
         BZ    @RF00394                                            0394 00803000
*          VOLCHKRC = LASTCC04;                            /*@Y30LB39*/ 00804000
         LA    VOLCHKRC,4                                          0395 00805000
*        ELSE                                                      0396 00806000
*          DO;                                             /*@Y30LB39*/ 00807000
         B     @RC00394                                            0396 00808000
@RF00394 DS    0H                                                  0397 00809000
*                                                          /*@Y30LB39*/ 00810000
*            /********************************************************/ 00811000
*            /*                                              @Y30LB39*/ 00812000
*            /*  CALL TVOLRTN TO VERIFY THAT THE TARGET      @Y30LB39*/ 00813000
*            /*  VOLUME IS USABLE.                           @Y30LB39*/ 00814000
*            /*                                              @Y30LB39*/ 00815000
*            /********************************************************/ 00816000
*                                                          /*@Y30LB39*/ 00817000
*            CALL TVOLRTN;                                 /*@Y30LB39*/ 00818000
         BAL   @14,TVOLRTN                                         0397 00819000
*            RESPECIFY RTNREG RSTD;                                0398 00820000
*            TESTRC = RTNREG;                                      0399 00821000
         LR    TESTRC,RTNREG                                       0399 00822000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/ 00823000
*            IF TESTRC ^= 0 THEN                                   0401 00824000
         LTR   TESTRC,TESTRC                                       0401 00825000
         BZ    @RF00401                                            0401 00826000
*              VOLCHKRC = LASTCC04;                        /*@Y30LB39*/ 00827000
         LA    VOLCHKRC,4                                          0402 00828000
*          END;                                            /*@Y30LB39*/ 00829000
@RF00401 DS    0H                                                  0404 00830000
*                                                          /*@Y30LB39*/ 00831000
*        /************************************************************/ 00832000
*        /*                                                  @Y30LB39*/ 00833000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 00834000
*        /*                                                  @Y30LB39*/ 00835000
*        /************************************************************/ 00836000
*                                                          /*@Y30LB39*/ 00837000
*        REG14 = RETADDR2;                                 /*@Y30LB39*/ 00838000
@RC00394 LR    REG14,RETADDR2                                      0404 00839000
*                                                          /*@Y30LB39*/ 00840000
*        /************************************************************/ 00841000
*        /*                                                  @Y30LB39*/ 00842000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 00843000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 00844000
*        /*                                                  @Y30LB39*/ 00845000
*        /************************************************************/ 00846000
*                                                          /*@Y30LB39*/ 00847000
*        RETURN CODE(VOLCHKRC);                            /*@Y30LB39*/ 00848000
         LR    @15,VOLCHKRC                                        0405 00849000
@EL00003 DS    0H                                                  0405 00850000
@EF00003 DS    0H                                                  0405 00851000
@ER00003 BR    @14                                                 0405 00852000
*END VOLCKRTN;                                             /*@Y30LB39*/ 00853000
*        /************************************************************/ 00854000
*        /*                                                  @Y30LB39*/ 00855000
*        /*  PROCEDURE NAME - RVVIRTN                        @Y30LB39*/ 00856000
*        /*                                                  @Y30LB39*/ 00857000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 00858000
*        /*  RETRIEVE THE TYPE OF RECORD REQUESTED BY THE    @Y30LB39*/ 00859000
*        /*  CALLER.                                         @Y30LB39*/ 00860000
*        /*  ONCE THIS DETERMINATION HAS BEEN MADE BY        @Y30LB39*/ 00861000
*        /*  EXAMINING THE CHARACTER TYPE SET IN THE RECOVERV@Y30LB39*/ 00862000
*        /*  INTERNAL TABLE, THEN THE PARAMETER LIST IS      @Y30LB39*/ 00863000
*        /*  SET UP AND MSVC IS INVOKED TO RETRIEVE THE      @Y30LB39*/ 00864000
*        /*  RECORD.  IF THE RECORD COULD NOT BE RETRIEVED,  @Y30LB39*/ 00865000
*        /*  THEN ONE OF THE FOLLOWING MESSAGES IS ISSUED.   @Y30LB39*/ 00866000
*        /*  MESSAGE IDC2080I IF BASE RECORD IS NOT READ.    @Y30LB39*/ 00867000
*        /*  MESSAGE IDC3081I IF COPY RECORD IS NOT READ.    @Y30LB39*/ 00868000
*        /*  MESSAGE IDC3710I IF NO BACKUP COPY RECORD IS    @Y30LB39*/ 00869000
*        /*  FOUND.                                          @Y30LB39*/ 00870000
*        /*  MESSAGE IDC3712I IF LATEST BACKUP COPY NOT      @Y30LB39*/ 00871000
*        /*  READ.                                           @Y30LB39*/ 00872000
*        /*                                                  @Y30LB39*/ 00873000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 00874000
*        /*          RECOVERV TABLE                          @Y30LB39*/ 00875000
*        /*          DYNAMIC ARGUMENT LIST                   @Y30LB39*/ 00876000
*        /*          BASE VOLUME RECORD BUFFER               @Y30LB39*/ 00877000
*        /*          COPY VOLUME RECORD BUFFER               @Y30LB39*/ 00878000
*        /*                                                  @Y30LB39*/ 00879000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 00880000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 00881000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 00882000
*        /*          AND BUFFER CONTAINS RECORD.             @Y30LB39*/ 00883000
*        /*      4 - IF MSVC COULD NOT RETRIEVE RECORD.      @Y30LB39*/ 00884000
*        /*                                                  @Y30LB39*/ 00885000
*        /************************************************************/ 00886000
*                                                                  0407 00887000
*RVVIRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                 /*@Y30LB39*/ 00888000
*                                                                  0407 00889000
RVVIRTN  DS    0H                                                  0408 00890000
*        /************************************************************/ 00891000
*        /*                                                  @Y30LB39*/ 00892000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 00893000
*        /*                                                  @Y30LB39*/ 00894000
*        /************************************************************/ 00895000
*                                                          /*@Y30LB39*/ 00896000
*        DCL RVVIRC FIXED(8);          /* RETURN CODE        @Y30LB39*/ 00897000
*        DCL DATECHAR CHAR(4);         /* REQUIRED WHEN      @Y30LB39*/ 00898000
*                                      /* CONVERTING DATE    @Y30LB39*/ 00899000
*                                      /* VALUE.             @Y30LB39*/ 00900000
*        DCL NOTFOUND FIXED(31) STATIC INIT(520);          /*@Y30LB39*/ 00901000
*                                      /* RECORD NOT FOUND   @Y30LB39*/ 00902000
*                                      /* CODE FROM USSC     @Y30LB39*/ 00903000
*        DCL SEQ#DFLT FIXED(31) STATIC INIT(1);  /* SEQUENCE @Y30LB39*/ 00904000
*                                      /* NUMBER DEFAULT     @Y30LB39*/ 00905000
*                                      /* VALUE              @Y30LB39*/ 00906000
*        DCL SEQ#XVAL FIXED(31);       /* FOR STORING THE    @Y30LB39*/ 00907000
*                                      /* SEQUENCE NUMBER AS @Y30LB39*/ 00908000
*                                      /* SPECIFIED OR THE   @Y30LB39*/ 00909000
*                                      /* DEFAULT OF ONE.    @Y30LB39*/ 00910000
*                                                          /*@Y30LB39*/ 00911000
*        /************************************************************/ 00912000
*        /*                                                  @Y30LB39*/ 00913000
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/ 00914000
*        /*                                                  @Y30LB39*/ 00915000
*        /************************************************************/ 00916000
*                                                          /*@Y30LB39*/ 00917000
*        RETADDR3 = REG14;                                 /*@Y30LB39*/ 00918000
         LR    RETADDR3,REG14                                      0413 00919000
*                                                          /*@Y30LB39*/ 00920000
*        /************************************************************/ 00921000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 00922000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 00923000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 00924000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 00925000
*        /*                                                  @Y30LB39*/ 00926000
*        /************************************************************/ 00927000
*                                                          /*@Y30LB39*/ 00928000
*        OLDERID2 = NEWERID2;                                      0414 00929000
         L     @15,@PC00001                                        0414 00930000
         L     @15,GDTTR2(,@15)                                    0414 00931000
         MVC   @TS00001(95),NEWERID2(@15)                          0414 00932000
         MVC   OLDERID2(95,@15),@TS00001                           0414 00933000
*        NEWID2 = 'RVRV';                                  /*@Y30LB39*/ 00934000
         MVC   NEWID2(4,@15),@CC01554                              0415 00935000
*                                                          /*@Y30LB39*/ 00936000
*        /************************************************************/ 00937000
*        /*                                                  @Y30LB39*/ 00938000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 00939000
*        /*                                                  @Y30LB39*/ 00940000
*        /************************************************************/ 00941000
*                                                          /*@Y30LB39*/ 00942000
*        RVVIRC = LASTCC00;                                /*@Y30LB39*/ 00943000
         SLR   RVVIRC,RVVIRC                                       0416 00944000
*                                                          /*@Y30LB39*/ 00945000
*        /************************************************************/ 00946000
*        /*                                                  @Y30LB39*/ 00947000
*        /*  INITIALIZE THE RVVI PARAMETER LIST FOR THE      @Y30LB39*/ 00948000
*        /*  TYPE OF RECORD TO BE RETRIEVED.                 @Y30LB39*/ 00949000
*        /*                                                  @Y30LB39*/ 00950000
*        /************************************************************/ 00951000
*                                                          /*@Y30LB39*/ 00952000
*        RVVI = ''B;                                       /*@Y30LB39*/ 00953000
         L     @15,RVVIPTR                                         0417 00954000
         XC    RVVI(68,@15),RVVI(@15)                              0417 00955000
*        RVVLNGTH = RVVLEN;                                /*@Y30LB39*/ 00956000
         LH    @14,RVVLEN                                          0418 00957000
         ST    @14,RVVLNGTH(,@15)                                  0418 00958000
*        RVVCODE = RVVOP;                                  /*@Y30LB39*/ 00959000
         MVI   RVVCODE(@15),X'87'                                  0419 00960000
*        RVVSVOL = ON;                                     /*@Y30LB39*/ 00961000
         OI    RVVSVOL(@15),B'00000001'                            0420 00962000
*        RVVRDR = ON;                                      /*@Y30LB39*/ 00963000
         OI    RVVRDR(@15),B'10000000'                             0421 00964000
*        IF RECTYPE = BASECHAR THEN                                0422 00965000
         CLC   RECTYPE(4),BASECHAR                                 0422 00966000
         BNE   @RF00422                                            0422 00967000
*          DO;                                             /*@Y30LB39*/ 00968000
*            RVVOLUME = TVOLVAL;                           /*@Y30LB39*/ 00969000
         L     @14,@PC00001+4                                      0424 00970000
         L     @01,FDTPTR+4(,@14)                                  0424 00971000
         MVC   RVVOLUME(6,@15),TVOLVAL(@01)                        0424 00972000
*            RVVRTBUF = BASEVPTR;                          /*@Y30LB39*/ 00973000
         ST    BASEVPTR,RVVRTBUF(,@15)                             0425 00974000
*            RVVBUFLN = LENGTH (BASEV);                    /*@Y30LB39*/ 00975000
         MVC   RVVBUFLN(2,@15),@CH01648                            0426 00976000
*            RVVBVRCD = ON;                                /*@Y30LB39*/ 00977000
         OI    RVVBVRCD(@15),B'10000000'                           0427 00978000
*          END;                                            /*@Y30LB39*/ 00979000
*        ELSE                                                      0429 00980000
*          DO;                                             /*@Y30LB39*/ 00981000
         B     @RC00422                                            0429 00982000
@RF00422 DS    0H                                                  0430 00983000
*            RVVOLUME = FVOLVAL;                           /*@Y30LB39*/ 00984000
         L     @15,RVVIPTR                                         0430 00985000
         L     @14,@PC00001+4                                      0430 00986000
         L     @01,FDTPTR(,@14)                                    0430 00987000
         MVC   RVVOLUME(6,@15),FVOLVAL(@01)                        0430 00988000
*            RVVRTBUF = COPYVPTR;                          /*@Y30LB39*/ 00989000
         ST    COPYVPTR,RVVRTBUF(,@15)                             0431 00990000
*            RVVBUFLN = LENGTH (COPYV);                    /*@Y30LB39*/ 00991000
         MVC   RVVBUFLN(2,@15),@CH01649                            0432 00992000
*            RVVCPYRC = ON;                                /*@Y30LB39*/ 00993000
         OI    RVVCPYRC(@15),B'00100000'                           0433 00994000
*            IF ADDR (LBKUP) ^= NULLPTR THEN                       0434 00995000
         L     @14,FDTPTR+20(,@14)                                 0434 00996000
         LTR   @14,@14                                             0434 00997000
         BZ    @RF00434                                            0434 00998000
*              RVVLBKUP = ON;                              /*@Y30LB39*/ 00999000
         OI    RVVLBKUP(@15),B'10000000'                           0435 01000000
*            ELSE                                                  0436 01001000
*              DO;                                         /*@Y30LB39*/ 01002000
         B     @RC00434                                            0436 01003000
@RF00434 DS    0H                                                  0437 01004000
*                CVD (DATEVAL,DATECHAR);                   /*@Y30LB39*/ 01005000
         L     @15,@PC00001+4                                      0437 01006000
         L     @01,FDTPTR+12(,@15)                                 0437 01007000
         L     @14,DATEVAL(,@01)                                   0437 01008000
         CVD   @14,@TS00001                                        0437 01009000
         MVC   DATECHAR(4),@TS00001+4                              0437 01010000
*                RVVCDATE = DATECHAR;                      /*@Y30LB39*/ 01011000
         L     @14,RVVIPTR                                         0438 01012000
         MVC   RVVCDATE(4,@14),DATECHAR                            0438 01013000
*                RVVSDTE = ON;                             /*@Y30LB39*/ 01014000
         OI    RVVSDTE(@14),B'00100000'                            0439 01015000
*                IF ADDR(SEQ#VAL) = NULLPTR THEN           /*@Y30LB39*/ 01016000
         L     @15,FDTPTR+16(,@15)                                 0440 01017000
         LTR   @15,@15                                             0440 01018000
         BNZ   @RF00440                                            0440 01019000
*                  RVVRDSEQ = SEQ#DFLT;                    /*@Y30LB39*/ 01020000
         MVC   RVVRDSEQ(1,@14),SEQ#DFLT+3                          0441 01021000
*                ELSE                                      /*@Y30LB39*/ 01022000
*                  RVVRDSEQ = SEQ#VAL;                     /*@Y30LB39*/ 01023000
         B     @RC00440                                            0442 01024000
@RF00440 L     @15,@PC00001+4                                      0442 01025000
         L     @01,FDTPTR+16(,@15)                                 0442 01026000
         L     @15,RVVIPTR                                         0442 01027000
         MVC   RVVRDSEQ(1,@15),SEQ#VAL+3(@01)                      0442 01028000
*                RVVSSEQ = ON;                             /*@Y30LB39*/ 01029000
@RC00440 L     @15,RVVIPTR                                         0443 01030000
         OI    RVVSSEQ(@15),B'00010000'                            0443 01031000
*                SEQ#XVAL = RVVRDSEQ;                      /*@Y30LB39*/ 01032000
         SLR   @14,@14                                             0444 01033000
         IC    @14,RVVRDSEQ(,@15)                                  0444 01034000
         ST    @14,SEQ#XVAL                                        0444 01035000
*            END;                                          /*@Y30LB39*/ 01036000
*          END;                                            /*@Y30LB39*/ 01037000
@RC00434 DS    0H                                                  0447 01038000
*                                                          /*@Y30LB39*/ 01039000
*        /************************************************************/ 01040000
*        /*                                                  @Y30LB39*/ 01041000
*        /*  ISSUE USSC TO READ THE SPECIFIED INVENTORY      @Y30LB39*/ 01042000
*        /*  RECORD AFTER DUMPING RVVI PARAMETER LIST        @Y30LB39*/ 01043000
*        /*                                                  @Y30LB39*/ 01044000
*        /************************************************************/ 01045000
*                                                          /*@Y30LB39*/ 01046000
*                                                                  0447 01047000
*          IF GDTDBG = NULLPTR                                     0447 01048000
*            THEN;                                                 0447 01049000
@RC00422 L     @15,@PC00001                                        0447 01050000
         L     @15,GDTDBG(,@15)                                    0447 01051000
         LTR   @15,@15                                             0447 01052000
         BZ    @RT00447                                            0447 01053000
*            ELSE                                                  0449 01054000
*              DO;                                                 0449 01055000
*                DMPINDEX = ADDR(DUMPLIST);                        /*@Y 01056000
*0LB39*/                                                           0450 01057000
*                                                                  0450 01058000
         LA    DMPINDEX,DUMPLIST                                   0450 01059000
*                DMPITMNM = 'RVVI';                                0451 01060000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0451 01061000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0451 01062000
         MVC   DMPITMNM(4,DMPINDEX),@CC01556                       0451 01063000
*                DMPITMPT = ADDR(RVVI);                            0452 01064000
         L     @03,RVVIPTR                                         0452 01065000
         ST    @03,DMPITMPT(,DMPINDEX)                             0452 01066000
*                DMPITMLN = RVVLEN;                                0453 01067000
         LH    @03,RVVLEN                                          0453 01068000
         STH   @03,DMPITMLN(,DMPINDEX)                             0453 01069000
*                DMPITMTP = 'H';                                   0454 01070000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0454 01071000
*                DMPINDEX = DMPINDEX + DMPELEMT;      /*@Y30LB39*/ 0455 01072000
*                                                                  0455 01073000
         AL    DMPINDEX,@CF00473                                   0455 01074000
*                DMPTRM = DMPTRMVL;                                0456 01075000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0456 01076000
*              END;                                         /*@Y30LB39* 01077000
*                                                          /*@Y30LB39*/ 01078000
*        IF GDTDBG = NULLPTR                                       0458 01079000
*          THEN;                                                   0458 01080000
@RT00447 L     @15,@PC00001                                        0458 01081000
         L     @15,GDTDBG(,@15)                                    0458 01082000
         LTR   @15,@15                                             0458 01083000
         BZ    @RT00458                                            0458 01084000
*          ELSE                                                    0460 01085000
*            CALL IDCDB010 (GDTTBL,'RVRR',ADDR(DUMPLIST));         0460 01086000
         L     @15,@PC00001                                        0460 01087000
         ST    @15,@AL00001                                        0460 01088000
         LA    @14,@CC01558                                        0460 01089000
         ST    @14,@AL00001+4                                      0460 01090000
         LA    @14,DUMPLIST                                        0460 01091000
         ST    @14,@AFTEMPS                                        0460 01092000
         LA    @14,@AFTEMPS                                        0460 01093000
         ST    @14,@AL00001+8                                      0460 01094000
         MVI   @AL00001+8,X'80'                                    0460 01095000
         L     @15,GDTDBG(,@15)                                    0460 01096000
         LA    @01,@AL00001                                        0460 01097000
         BALR  @14,@15                                             0460 01098000
*                                                          /*@Y30LB39*/ 01099000
*                                                          /*@Y30LB39*/ 01100000
*        CALL IDCSASS0 (GDTTBL,VVIC,RVVIPTR,REASON);       /*@Y30LB39*/ 01101000
*                                                                  0461 01102000
@RT00458 L     @02,@PC00001                                        0461 01103000
         ST    @02,@AL00001                                        0461 01104000
         LA    @15,VVIC                                            0461 01105000
         ST    @15,@AL00001+4                                      0461 01106000
         LA    @15,RVVIPTR                                         0461 01107000
         ST    @15,@AL00001+8                                      0461 01108000
         LA    @15,REASON                                          0461 01109000
         ST    @15,@AL00001+12                                     0461 01110000
         MVI   @AL00001+12,X'80'                                   0461 01111000
         L     @15,GDTSSC(,@02)                                    0461 01112000
         LA    @01,@AL00001                                        0461 01113000
         BALR  @14,@15                                             0461 01114000
*        RESPECIFY RTNREG RSTD;                                    0462 01115000
*        TESTRC = RTNREG;                                          0463 01116000
         LR    TESTRC,RTNREG                                       0463 01117000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 01118000
*                                                          /*@Y30LB39*/ 01119000
*        /************************************************************/ 01120000
*        /*                                                  @Y30LB39*/ 01121000
*        /*  IF THE READ RETURN CODE IS ZERO, THEN EXIT      @Y30LB39*/ 01122000
*        /*  VIA THE LAST STEP IN THIS SUBROUTINE.           @Y30LB39*/ 01123000
*        /*                                                  @Y30LB39*/ 01124000
*        /************************************************************/ 01125000
*                                                          /*@Y30LB39*/ 01126000
*        IF TESTRC ^= 0 THEN                                       0465 01127000
         LTR   TESTRC,TESTRC                                       0465 01128000
         BZ    @RF00465                                            0465 01129000
*          DO;                                             /*@Y30LB39*/ 01130000
*                                                          /*@Y30LB39*/ 01131000
*            /********************************************************/ 01132000
*            /*                                              @Y30LB39*/ 01133000
*            /*  SET CONDITION CODE TO FOUR AND CALL         @Y30LB39*/ 01134000
*            /*  SSCMSG TO ISSUE THE APPROPRIATE REASON      @Y30LB39*/ 01135000
*            /*  CODE.                                       @Y30LB39*/ 01136000
*            /*                                              @Y30LB39*/ 01137000
*            /********************************************************/ 01138000
*                                                          /*@Y30LB39*/ 01139000
*            RVVIRC = LASTCC04;                            /*@Y30LB39*/ 01140000
         LA    RVVIRC,4                                            0467 01141000
*            CALL SSCMSG(REASON);                          /*@Y30LB39*/ 01142000
         LA    @15,REASON                                          0468 01143000
         ST    @15,@AL00001                                        0468 01144000
         LA    @01,@AL00001                                        0468 01145000
         BAL   @14,SSCMSG                                          0468 01146000
*                                                          /*@Y30LB39*/ 01147000
*            /********************************************************/ 01148000
*            /*                                              @Y30LB39*/ 01149000
*            /*  ISSUE APPROPRIATE SECONDARY MESSAGE.        @Y30LB39*/ 01150000
*            /*                                              @Y30LB39*/ 01151000
*            /********************************************************/ 01152000
*                                                          /*@Y30LB39*/ 01153000
*            DARGLIST = ''B;                               /*@Y30LB39*/ 01154000
         L     @15,DDSTRU                                          0469 01155000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0469 01156000
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/ 01157000
         MVC   DARGSMOD(3,@15),@CC01460                            0470 01158000
*            IF RECTYPE = BASECHAR THEN                            0471 01159000
         CLC   RECTYPE(4),BASECHAR                                 0471 01160000
         BNE   @RF00471                                            0471 01161000
*              DO;                                         /*@Y30LB39*/ 01162000
*                DARGSENT = MSG2080I;                      /*@Y30LB39*/ 01163000
         MVI   DARGSENT(@15),X'1A'                                 0473 01164000
*                DARGDBP = ADDR (TVOLVAL);                 /*@Y30LB39*/ 01165000
         L     @14,@PC00001+4                                      0474 01166000
         L     @14,FDTPTR+4(,@14)                                  0474 01167000
         LA    @03,TVOLVAL(,@14)                                   0474 01168000
         ST    @03,DARGDBP(,@15)                                   0474 01169000
*                DARGILP = TVOLLEN;                        /*@Y30LB39*/ 01170000
         SLR   @03,@03                                             0475 01171000
         IC    @03,TVOLLEN(,@14)                                   0475 01172000
         STH   @03,DARGILP(,@15)                                   0475 01173000
*              END;                                        /*@Y30LB39*/ 01174000
*            ELSE                                                  0477 01175000
*              IF ADDR(LBKUP) = NULLPTR THEN                       0477 01176000
         B     @RC00471                                            0477 01177000
@RF00471 L     @15,@PC00001+4                                      0477 01178000
         L     @15,FDTPTR+20(,@15)                                 0477 01179000
         LTR   @15,@15                                             0477 01180000
         BNZ   @RF00477                                            0477 01181000
*                DO;                                       /*@Y30LB39*/ 01182000
*                  DARGSENT = MSG3081I;                    /*@Y30LB39*/ 01183000
         L     @15,DDSTRU                                          0479 01184000
         MVI   DARGSENT(@15),X'19'                                 0479 01185000
*                  DARGDBP = ADDR(DATECHAR);               /*@Y30LB39*/ 01186000
         LA    @14,DATECHAR                                        0480 01187000
         ST    @14,DARGDBP(,@15)                                   0480 01188000
*                  DARGILP = LENGTH(DATECHAR);             /*@Y30LB39*/ 01189000
         LA    @14,4                                               0481 01190000
         STH   @14,DARGILP(,@15)                                   0481 01191000
*                  DARGCNT = 1;                            /*@Y30LB39*/ 01192000
         LA    @03,1                                               0482 01193000
         STH   @03,DARGCNT(,@15)                                   0482 01194000
*                  DARGINS(1) = 1;                         /*@Y30LB39*/ 01195000
         STH   @03,DARGINS(,@15)                                   0483 01196000
*                  DARGINL(1) = LENGTH(SEQ#XVAL);          /*@Y30LB39*/ 01197000
         STH   @14,DARGINL(,@15)                                   0484 01198000
*                  DARGDTM(1) = ADDR(SEQ#XVAL);            /*@Y30LB39*/ 01199000
         LA    @14,SEQ#XVAL                                        0485 01200000
         ST    @14,DARGDTM(,@15)                                   0485 01201000
*                END;                                      /*@Y30LB39*/ 01202000
*              ELSE                                                0487 01203000
*                DO;                                       /*@Y30LB39*/ 01204000
         B     @RC00477                                            0487 01205000
@RF00477 DS    0H                                                  0488 01206000
*                  DARGSMOD = RECVMSG;                     /*@Y30LB39*/ 01207000
         L     @15,DDSTRU                                          0488 01208000
         MVC   DARGSMOD(3,@15),@CC01458                            0488 01209000
*                  IF REASON = NOTFOUND THEN                       0489 01210000
         CLC   REASON(4),NOTFOUND                                  0489 01211000
         BNE   @RF00489                                            0489 01212000
*                    DO;                                   /*@Y30LB39*/ 01213000
*                      DARGSENT = MSG3710I;                /*@Y30LB39*/ 01214000
         MVI   DARGSENT(@15),X'01'                                 0491 01215000
*                      DARGDBP = ADDR(FVOLVAL);            /*@Y30LB39*/ 01216000
         L     @14,@PC00001+4                                      0492 01217000
         L     @14,FDTPTR(,@14)                                    0492 01218000
         LA    @03,FVOLVAL(,@14)                                   0492 01219000
         ST    @03,DARGDBP(,@15)                                   0492 01220000
*                      DARGILP = FVOLLEN;                  /*@Y30LB39*/ 01221000
         SLR   @03,@03                                             0493 01222000
         IC    @03,FVOLLEN(,@14)                                   0493 01223000
         STH   @03,DARGILP(,@15)                                   0493 01224000
*                    END;                                  /*@Y30LB39*/ 01225000
*                  ELSE                                            0495 01226000
*                    DARGSENT = MSG3712I;                  /*@Y30LB39*/ 01227000
         B     @RC00489                                            0495 01228000
@RF00489 L     @01,DDSTRU                                          0495 01229000
         MVI   DARGSENT(@01),X'03'                                 0495 01230000
*                END;                                      /*@Y30LB39*/ 01231000
@RC00489 DS    0H                                                  0497 01232000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/ 01233000
@RC00477 DS    0H                                                  0497 01234000
@RC00471 L     @15,@PC00001                                        0497 01235000
         ST    @15,@AL00001                                        0497 01236000
         LA    @14,@CF00114                                        0497 01237000
         ST    @14,@AL00001+4                                      0497 01238000
         LA    @14,DDSTRU                                          0497 01239000
         ST    @14,@AL00001+8                                      0497 01240000
         MVI   @AL00001+8,X'80'                                    0497 01241000
         L     @15,GDTPRT(,@15)                                    0497 01242000
         LA    @01,@AL00001                                        0497 01243000
         BALR  @14,@15                                             0497 01244000
*          END;                                            /*@Y30LB39*/ 01245000
*                                                          /*@Y30LB39*/ 01246000
*        /************************************************************/ 01247000
*        /*                                                  @Y30LB39*/ 01248000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 01249000
*        /*                                                  @Y30LB39*/ 01250000
*        /************************************************************/ 01251000
*                                                          /*@Y30LB39*/ 01252000
*        REG14 = RETADDR3;                                 /*@Y30LB39*/ 01253000
@RF00465 LR    REG14,RETADDR3                                      0499 01254000
*                                                          /*@Y30LB39*/ 01255000
*        /************************************************************/ 01256000
*        /*                                                  @Y30LB39*/ 01257000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 01258000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 01259000
*        /*                                                  @Y30LB39*/ 01260000
*        /************************************************************/ 01261000
*                                                          /*@Y30LB39*/ 01262000
*        RETURN CODE(RVVIRC);                              /*@Y30LB39*/ 01263000
         LR    @15,RVVIRC                                          0500 01264000
@EL00004 DS    0H                                                  0500 01265000
@EF00004 DS    0H                                                  0500 01266000
@ER00004 BR    @14                                                 0500 01267000
*END RVVIRTN;                                              /*@Y30LB39*/ 01268000
*        /************************************************************/ 01269000
*        /*                                                  @Y30LB39*/ 01270000
*        /*  PROCEDURE NAME - FVOLRTN                        @Y30LB39*/ 01271000
*        /*                                                  @Y30LB39*/ 01272000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 01273000
*        /*  VERIFY THAT THE COPY VOLUME IS USABLE AND       @Y30LB39*/ 01274000
*        /*  THAT BOTH OF THE CARTRIDGES ARE RESIDENT IN     @Y30LB39*/ 01275000
*        /*  THE MASS STORAGE FACILITY.                      @Y30LB39*/ 01276000
*        /*  IF ANY ERROR CONDITION IS FOUND THEN            @Y30LB39*/ 01277000
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGES TO BE @Y30LB39*/ 01278000
*        /*  ISSUED:                                         @Y30LB39*/ 01279000
*        /*    IDC3096I IF VOLUME IS UNUSABLE                @Y30LB39*/ 01280000
*        /*    IDC3067I IF VOLSERS DIFFER AND COPY VOLUME    @Y30LB39*/ 01281000
*        /*    IS VSAM                                       @Y30LB39*/ 01282000
*        /*    IDC2076I IF EITHER CARTRIDGE OUT OF MSF       @Y30LB39*/ 01283000
*        /*    IDC0098I IF LOC OF MISSING CART IS KNOWN      @Y30LB39*/ 01284000
*        /*                                                  @Y30LB39*/ 01285000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 01286000
*        /*          RECOVERV TABLE                          @Y30LB39*/ 01287000
*        /*          COPY VOLUME RECORD (COPYV)              @Y30LB39*/ 01288000
*        /*          DARGLIST                                @Y30LB39*/ 01289000
*        /*                                                  @Y30LB39*/ 01290000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 01291000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 01292000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 01293000
*        /*      4 - IF VOLUME FLAGGED INCOMPLETE, VOLUME    @Y30LB39*/ 01294000
*        /*          SERIAL NUMBERS DIFFERENT & COPY IS VSAM,@Y30LB39*/ 01295000
*        /*          OR CART IS OUT OF THE MSF.              @Y30LB39*/ 01296000
*        /*                                                  @Y30LB39*/ 01297000
*        /************************************************************/ 01298000
*                                                                  0502 01299000
*FVOLRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                 /*@Y30LB39*/ 01300000
*                                                                  0502 01301000
FVOLRTN  DS    0H                                                  0503 01302000
*        /************************************************************/ 01303000
*        /*                                                  @Y30LB39*/ 01304000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 01305000
*        /*                                                  @Y30LB39*/ 01306000
*        /************************************************************/ 01307000
*                                                          /*@Y30LB39*/ 01308000
*        DCL FVOLRC FIXED(8);          /* RETURN CODE        @Y30LB39*/ 01309000
*                                                          /*@Y30LB39*/ 01310000
*        /************************************************************/ 01311000
*        /*                                                  @Y30LB39*/ 01312000
*        /*  SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE   @Y30LB39*/ 01313000
*        /*                                                  @Y30LB39*/ 01314000
*        /************************************************************/ 01315000
*                                                          /*@Y30LB39*/ 01316000
*        RETADDR3 = REG14;                                 /*@Y30LB39*/ 01317000
         LR    RETADDR3,REG14                                      0504 01318000
*                                                          /*@Y30LB39*/ 01319000
*        /************************************************************/ 01320000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 01321000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 01322000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 01323000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 01324000
*        /*                                                  @Y30LB39*/ 01325000
*        /************************************************************/ 01326000
*                                                          /*@Y30LB39*/ 01327000
*        OLDERID2 = NEWERID2;                                      0505 01328000
         L     @08,@PC00001                                        0505 01329000
         L     @02,GDTTR2(,@08)                                    0505 01330000
         MVC   @TS00001(95),NEWERID2(@02)                          0505 01331000
         MVC   OLDERID2(95,@02),@TS00001                           0505 01332000
*        NEWID2 = 'RVFV';                                  /*@Y30LB39*/ 01333000
         MVC   NEWID2(4,@02),@CC01564                              0506 01334000
*                                                          /*@Y30LB39*/ 01335000
*        /************************************************************/ 01336000
*        /*                                                  @Y30LB39*/ 01337000
*        /*      SET CONDITION CODE AND RETURN CODES TO ZERO @Y30LB39*/ 01338000
*        /*                                                  @Y30LB39*/ 01339000
*        /************************************************************/ 01340000
*                                                          /*@Y30LB39*/ 01341000
*        FVOLRC = LASTCC00;                                /*@Y30LB39*/ 01342000
         SLR   FVOLRC,FVOLRC                                       0507 01343000
*                                                          /*@Y30LB39*/ 01344000
*        /************************************************************/ 01345000
*        /*                                                  @Y30LB39*/ 01346000
*        /*  CHECK TO SEE IF THE VOLUME IS UNUSABLE          @Y30LB39*/ 01347000
*        /*                                                  @Y30LB39*/ 01348000
*        /************************************************************/ 01349000
*                                                          /*@Y30LB39*/ 01350000
*        IF COPSATIA ^= TWOZERO THEN                               0508 01351000
         LH    @02,COPSATIA(,COPYVPTR)                             0508 01352000
         N     @02,@CF01669                                        0508 01353000
         LTR   @02,@02                                             0508 01354000
         BZ    @RF00508                                            0508 01355000
*          DO;                                             /*@Y30LB39*/ 01356000
*                                                          /*@Y30LB39*/ 01357000
*            /********************************************************/ 01358000
*            /*                                              @Y30LB39*/ 01359000
*            /*  SET THE CONDTION CODE TO FOUR AND ISSUE     @Y30LB39*/ 01360000
*            /*  MESSAGE IDC3096I                            @Y30LB39*/ 01361000
*            /*                                              @Y30LB39*/ 01362000
*            /********************************************************/ 01363000
*                                                          /*@Y30LB39*/ 01364000
*            FVOLRC = LASTCC04;                            /*@Y30LB39*/ 01365000
         LA    FVOLRC,4                                            0510 01366000
*            DARGLIST = ''B;                               /*@Y30LB39*/ 01367000
         L     @02,DDSTRU                                          0511 01368000
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0511 01369000
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/ 01370000
         MVC   DARGSMOD(3,@02),@CC01460                            0512 01371000
*            DARGDBP = ADDR(FVOLVAL);                      /*@Y30LB39*/ 01372000
         L     @15,@PC00001+4                                      0513 01373000
         L     @15,FDTPTR(,@15)                                    0513 01374000
         LA    @14,FVOLVAL(,@15)                                   0513 01375000
         ST    @14,DARGDBP(,@02)                                   0513 01376000
*            DARGILP = FVOLLEN;                            /*@Y30LB39*/ 01377000
         SLR   @14,@14                                             0514 01378000
         IC    @14,FVOLLEN(,@15)                                   0514 01379000
         STH   @14,DARGILP(,@02)                                   0514 01380000
*            DARGSENT = MSG3096I;                          /*@Y30LB39*/ 01381000
         MVI   DARGSENT(@02),X'08'                                 0515 01382000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/ 01383000
         ST    @08,@AL00001                                        0516 01384000
         LA    @02,@CF00114                                        0516 01385000
         ST    @02,@AL00001+4                                      0516 01386000
         LA    @02,DDSTRU                                          0516 01387000
         ST    @02,@AL00001+8                                      0516 01388000
         MVI   @AL00001+8,X'80'                                    0516 01389000
         L     @15,GDTPRT(,@08)                                    0516 01390000
         LA    @01,@AL00001                                        0516 01391000
         BALR  @14,@15                                             0516 01392000
*          END;                                            /*@Y30LB39*/ 01393000
*                                                          /*@Y30LB39*/ 01394000
*        /************************************************************/ 01395000
*        /*                                                  @Y30LB39*/ 01396000
*        /*  CHECK TO SEE IF THE VOLUME IS A VSAM VOLUME AND @Y30LB39*/ 01397000
*        /*  WHETHER OR NOT THE TARGET VOLUME SERIAL NUMBER  @Y30LB39*/ 01398000
*        /*  IS DIFFERENT.                                   @Y30LB39*/ 01399000
*        /*                                                  @Y30LB39*/ 01400000
*        /************************************************************/ 01401000
*                                                          /*@Y30LB39*/ 01402000
*        IF COPVSAM = ON & FVOLVAL ^= TVOLVAL THEN                 0518 01403000
@RF00508 TM    COPVSAM(COPYVPTR),B'01000000'                       0518 01404000
         BNO   @RF00518                                            0518 01405000
         L     @08,@PC00001+4                                      0518 01406000
         L     @02,FDTPTR(,@08)                                    0518 01407000
         L     @08,FDTPTR+4(,@08)                                  0518 01408000
         CLC   FVOLVAL(6,@02),TVOLVAL(@08)                         0518 01409000
         BE    @RF00518                                            0518 01410000
*          DO;                                             /*@Y30LB39*/ 01411000
*            FVOLRC = LASTCC04;                            /*@Y30LB39*/ 01412000
         LA    FVOLRC,4                                            0520 01413000
*            DARGLIST = ''B;                               /*@Y30LB39*/ 01414000
         L     @08,DDSTRU                                          0521 01415000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0521 01416000
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/ 01417000
         MVC   DARGSMOD(3,@08),@CC01460                            0522 01418000
*            DARGSENT = MSG3067I;                          /*@Y30LB39*/ 01419000
         MVI   DARGSENT(@08),X'2B'                                 0523 01420000
*            DARGDBP = ADDR(FVOLVAL);                      /*@Y30LB39*/ 01421000
         LA    @15,FVOLVAL(,@02)                                   0524 01422000
         ST    @15,DARGDBP(,@08)                                   0524 01423000
*            DARGILP = FVOLLEN;                            /*@Y30LB39*/ 01424000
         SLR   @15,@15                                             0525 01425000
         IC    @15,FVOLLEN(,@02)                                   0525 01426000
         STH   @15,DARGILP(,@08)                                   0525 01427000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/ 01428000
         L     @08,@PC00001                                        0526 01429000
         ST    @08,@AL00001                                        0526 01430000
         LA    @02,@CF00114                                        0526 01431000
         ST    @02,@AL00001+4                                      0526 01432000
         LA    @02,DDSTRU                                          0526 01433000
         ST    @02,@AL00001+8                                      0526 01434000
         MVI   @AL00001+8,X'80'                                    0526 01435000
         L     @15,GDTPRT(,@08)                                    0526 01436000
         LA    @01,@AL00001                                        0526 01437000
         BALR  @14,@15                                             0526 01438000
*          END;                                            /*@Y30LB39*/ 01439000
*                                                          /*@Y30LB39*/ 01440000
*        /************************************************************/ 01441000
*        /*                                                  @Y30LB39*/ 01442000
*        /*  CHECK TO SEE IF ONE OR BOTH OF THE CARTRIDGES   @Y30LB39*/ 01443000
*        /*  ARE OUT OF THE MASS STORAGE FACILITY.  IF       @Y30LB39*/ 01444000
*        /*  EITHER OR BOTH OF THE CARTRIDGES ARE, IN FACT,  @Y30LB39*/ 01445000
*        /*  OUT OF THE MSF, THEN ISSUE THE SECONDARY        @Y30LB39*/ 01446000
*        /*  MESSAGE WITH THE INSERTION OF ONE OR BOTH OF    @Y30LB39*/ 01447000
*        /*  THE CSNS FOR THE MISSING CARTRIDGE(S).          @Y30LB39*/ 01448000
*        /*  IF THE LOCATION OF THE MISSING CARTRIDGE IS     @Y30LB39*/ 01449000
*        /*  KNOWN, THEN ISSUE MESSAGE IDC0098I TO GIVE      @Y30LB39*/ 01450000
*        /*  THE LOCATION DATA.                              @Y30LB39*/ 01451000
*        /*                                                  @Y30LB39*/ 01452000
*        /************************************************************/ 01453000
*                                                          /*@Y30LB39*/ 01454000
*        IF COPLIB1 = HEXFF | COPLIB2 = HEXFF THEN         /*@Y30LB39*/ 01455000
@RF00518 CLC   COPLIB1(1,COPYVPTR),HEXFF                           0528 01456000
         BE    @RT00528                                            0528 01457000
         CLC   COPLIB2(1,COPYVPTR),HEXFF                           0528 01458000
         BNE   @RF00528                                            0528 01459000
@RT00528 DS    0H                                                  0529 01460000
*          DO;                                             /*@Y30LB39*/ 01461000
*            FVOLRC = LASTCC04;                            /*@Y30LB39*/ 01462000
         LA    FVOLRC,4                                            0530 01463000
*                                                          /*@Y30LB39*/ 01464000
*            /********************************************************/ 01465000
*            /*                                              @Y30LB39*/ 01466000
*            /*  ISSUE UPRINT FOR SECONDARY MESSAGE          @Y30LB39*/ 01467000
*            /*  IDC2076I.  INSERT FROM THE COPY             @Y30LB39*/ 01468000
*            /*  RECORD ONE OR BOTH CSNS AND THE             @Y30LB39*/ 01469000
*            /*  COPY DATE.                                  @Y30LB39*/ 01470000
*            /*                                              @Y30LB39*/ 01471000
*            /********************************************************/ 01472000
*                                                          /*@Y30LB39*/ 01473000
*            DARGLIST = ''B;                               /*@Y30LB39*/ 01474000
         L     @08,DDSTRU                                          0531 01475000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0531 01476000
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/ 01477000
         MVC   DARGSMOD(3,@08),@CC01460                            0532 01478000
*            DARGSENT = MSG2076I;                          /*@Y30LB39*/ 01479000
         MVI   DARGSENT(@08),X'1E'                                 0533 01480000
*            IF COPLIB1 = HEXFF & COPLIB2 = HEXFF THEN     /*@Y30LB39*/ 01481000
         CLC   COPLIB1(1,COPYVPTR),HEXFF                           0534 01482000
         BNE   @RF00534                                            0534 01483000
         CLC   COPLIB2(1,COPYVPTR),HEXFF                           0534 01484000
         BNE   @RF00534                                            0534 01485000
*              DARGCNT = BOTHCSNS;                         /*@Y30LB39*/ 01486000
         MVC   DARGCNT(2,@08),@CH00152                             0535 01487000
*            ELSE                                          /*@Y30LB39*/ 01488000
*              DARGCNT = ONECSN;                           /*@Y30LB39*/ 01489000
         B     @RC00534                                            0536 01490000
@RF00534 L     @08,DDSTRU                                          0536 01491000
         MVC   DARGCNT(2,@08),@CH00218                             0536 01492000
*            IF DARGCNT = BOTHCSNS THEN                    /*@Y30LB39*/ 01493000
@RC00534 L     @08,DDSTRU                                          0537 01494000
         CLC   DARGCNT(2,@08),@CH00152                             0537 01495000
         BNE   @RF00537                                            0537 01496000
*              DO;                                         /*@Y30LB39*/ 01497000
*                DARGILP = LENGTH(COPCSN1);                /*@Y30LB39*/ 01498000
         LA    @02,12                                              0539 01499000
         STH   @02,DARGILP(,@08)                                   0539 01500000
*                DARGDBP = ADDR(COPCSN1);                  /*@Y30LB39*/ 01501000
         LA    @15,COPCSN1(,COPYVPTR)                              0540 01502000
         ST    @15,DARGDBP(,@08)                                   0540 01503000
*                DARGINS(1) = 1;                           /*@Y30LB39*/ 01504000
         MVC   DARGINS(2,@08),@CH00218                             0541 01505000
*                DARGINL(1) = LENGTH(COPCSN2);             /*@Y30LB39*/ 01506000
         STH   @02,DARGINL(,@08)                                   0542 01507000
*                DARGDTM(1) = ADDR(COPCSN2);               /*@Y30LB39*/ 01508000
         LA    @02,COPCSN2(,COPYVPTR)                              0543 01509000
         ST    @02,DARGDTM(,@08)                                   0543 01510000
*              END;                                        /*@Y30LB39*/ 01511000
*            ELSE                                          /*@Y30LB39*/ 01512000
*              IF COPLIB1 = HEXFF THEN                     /*@Y30LB39*/ 01513000
         B     @RC00537                                            0545 01514000
@RF00537 CLC   COPLIB1(1,COPYVPTR),HEXFF                           0545 01515000
         BNE   @RF00545                                            0545 01516000
*                DO;                                       /*@Y30LB39*/ 01517000
*                  DARGILP = LENGTH(COPCSN1);              /*@Y30LB39*/ 01518000
         L     @08,DDSTRU                                          0547 01519000
         MVC   DARGILP(2,@08),@CH00567                             0547 01520000
*                  DARGDBP = ADDR(COPCSN1);                /*@Y30LB39*/ 01521000
         LA    @02,COPCSN1(,COPYVPTR)                              0548 01522000
         ST    @02,DARGDBP(,@08)                                   0548 01523000
*                END;                                      /*@Y30LB39*/ 01524000
*              ELSE                                        /*@Y30LB39*/ 01525000
*                DO;                                       /*@Y30LB39*/ 01526000
         B     @RC00545                                            0550 01527000
@RF00545 DS    0H                                                  0551 01528000
*                  DARGILP = LENGTH(COPCSN2);              /*@Y30LB39*/ 01529000
         L     @08,DDSTRU                                          0551 01530000
         MVC   DARGILP(2,@08),@CH00567                             0551 01531000
*                  DARGDBP = ADDR(COPCSN2);                /*@Y30LB39*/ 01532000
         LA    @02,COPCSN2(,COPYVPTR)                              0552 01533000
         ST    @02,DARGDBP(,@08)                                   0552 01534000
*                END;                                      /*@Y30LB39*/ 01535000
*            DARGINS(DARGCNT) = 2;                         /*@Y30LB39*/ 01536000
@RC00545 DS    0H                                                  0554 01537000
@RC00537 L     @08,DDSTRU                                          0554 01538000
         LH    @02,DARGCNT(,@08)                                   0554 01539000
         SLA   @02,3                                               0554 01540000
         LA    @15,2                                               0554 01541000
         STH   @15,DARGINS-8(@02,@08)                              0554 01542000
*            DARGINL(DARGCNT) = LENGTH(COPDATE);           /*@Y30LB39*/ 01543000
         LA    @15,4                                               0555 01544000
         STH   @15,DARGINL-8(@02,@08)                              0555 01545000
*            DARGDTM(DARGCNT) = ADDR(COPDATE);             /*@Y30LB39*/ 01546000
         LA    @15,COPDATE(,COPYVPTR)                              0556 01547000
         ST    @15,DARGDTM-8(@02,@08)                              0556 01548000
*                                                          /*@Y30LB39*/ 01549000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/ 01550000
         L     @08,@PC00001                                        0557 01551000
         ST    @08,@AL00001                                        0557 01552000
         LA    @02,@CF00114                                        0557 01553000
         ST    @02,@AL00001+4                                      0557 01554000
         LA    @02,DDSTRU                                          0557 01555000
         ST    @02,@AL00001+8                                      0557 01556000
         MVI   @AL00001+8,X'80'                                    0557 01557000
         L     @15,GDTPRT(,@08)                                    0557 01558000
         LA    @01,@AL00001                                        0557 01559000
         BALR  @14,@15                                             0557 01560000
*                                                          /*@Y30LB39*/ 01561000
*            /********************************************************/ 01562000
*            /*                                              @Y30LB39*/ 01563000
*            /*  IF COPDEST IS NOT BLANK, ISSUE UPRINT       @Y30LB39*/ 01564000
*            /*  FOR SECONDARY MESSAGE IDC0098I    INSERT    @Y30LB39*/ 01565000
*            /*  THE LOCATION DATA FROM THE COPY RECORD.     @Y30LB39*/ 01566000
*            /*                                              @Y30LB39*/ 01567000
*            /********************************************************/ 01568000
*                                                          /*@Y30LB39*/ 01569000
*            IF COPDEST ^= THIRTYBK THEN                   /*@Y30LB39*/ 01570000
         CLC   COPDEST(30,COPYVPTR),THIRTYBK                       0558 01571000
         BE    @RF00558                                            0558 01572000
*              DO;                                         /*@Y30LB39*/ 01573000
*                DARGLIST = ''B;                           /*@Y30LB39*/ 01574000
         L     @08,DDSTRU                                          0560 01575000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0560 01576000
*                DARGSMOD = COMNMSG;                       /*@Y30LB39*/ 01577000
         MVC   DARGSMOD(3,@08),@CC01460                            0561 01578000
*                DARGSENT = MSG0098I;                      /*@Y30LB39*/ 01579000
         MVI   DARGSENT(@08),X'02'                                 0562 01580000
*                DARGDBP = ADDR(COPDEST);                  /*@Y30LB39*/ 01581000
         LA    @02,COPDEST(,COPYVPTR)                              0563 01582000
         ST    @02,DARGDBP(,@08)                                   0563 01583000
*                DARGILP = LENGTH(COPDEST);                /*@Y30LB39*/ 01584000
         MVC   DARGILP(2,@08),@CH01209                             0564 01585000
*                                                          /*@Y30LB39*/ 01586000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/ 01587000
         L     @08,@PC00001                                        0565 01588000
         ST    @08,@AL00001                                        0565 01589000
         LA    @02,@CF00114                                        0565 01590000
         ST    @02,@AL00001+4                                      0565 01591000
         LA    @02,DDSTRU                                          0565 01592000
         ST    @02,@AL00001+8                                      0565 01593000
         MVI   @AL00001+8,X'80'                                    0565 01594000
         L     @15,GDTPRT(,@08)                                    0565 01595000
         LA    @01,@AL00001                                        0565 01596000
         BALR  @14,@15                                             0565 01597000
*                                                          /*@Y30LB39*/ 01598000
*              END;                                        /*@Y30LB39*/ 01599000
*          END;                                            /*@Y30LB39*/ 01600000
@RF00558 DS    0H                                                  0568 01601000
*                                                          /*@Y30LB39*/ 01602000
*        /************************************************************/ 01603000
*        /*                                                  @Y30LB39*/ 01604000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 01605000
*        /*                                                  @Y30LB39*/ 01606000
*        /************************************************************/ 01607000
*                                                          /*@Y30LB39*/ 01608000
*        REG14 = RETADDR3;                                 /*@Y30LB39*/ 01609000
@RF00528 LR    REG14,RETADDR3                                      0568 01610000
*                                                          /*@Y30LB39*/ 01611000
*        /************************************************************/ 01612000
*        /*                                                  @Y30LB39*/ 01613000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 01614000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 01615000
*        /*                                                  @Y30LB39*/ 01616000
*        /************************************************************/ 01617000
*                                                          /*@Y30LB39*/ 01618000
*        RETURN CODE(FVOLRC);                              /*@Y30LB39*/ 01619000
         LR    @15,FVOLRC                                          0569 01620000
@EL00005 DS    0H                                                  0569 01621000
@EF00005 DS    0H                                                  0569 01622000
@ER00005 BR    @14                                                 0569 01623000
*END FVOLRTN;                                              /*@Y30LB39*/ 01624000
*        /************************************************************/ 01625000
*        /*                                                  @Y30LB39*/ 01626000
*        /*  PROCEDURE NAME - TVOLRTN                        @Y30LB39*/ 01627000
*        /*                                                  @Y30LB39*/ 01628000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 01629000
*        /*  VERIFY THAT THE TARGET VOLUME IS ACTIVE         @Y30LB39*/ 01630000
*        /*  AND THAT IT IS, IN FACT, USABLE.  IF NOT, THEN  @Y30LB39*/ 01631000
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGES TO BE @Y30LB39*/ 01632000
*        /*  ISSUED:                                         @Y30LB39*/ 01633000
*        /*    IDC3074I IF VOLUME IS INACTIVE                @Y30LB39*/ 01634000
*        /*    IDC3097I IF VOLUME IS UNUSABLE - INCOMPLETE   @Y30LB39*/ 01635000
*        /*             CREATE                               @Y30LB39*/ 01636000
*        /*    IDC3095I IF VOLUME IS UNUSABLE - VOLSER       @Y30LB39*/ 01637000
*        /*             MISMATCH                             @Y30LB39*/ 01638000
*        /*                                                  @Y30LB39*/ 01639000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 01640000
*        /*          BUFFER FOR PRINT ARGUMENT LIST          @Y30LB39*/ 01641000
*        /*          BASE VOLUME RECORD (BASEV)              @Y30LB39*/ 01642000
*        /*                                                  @Y30LB39*/ 01643000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 01644000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 01645000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 01646000
*        /*      4 - IF BASE VOLUME INACTIVE OR INCOMPLETE   @Y30LB39*/ 01647000
*        /*                                                  @Y30LB39*/ 01648000
*        /************************************************************/ 01649000
*                                                                  0571 01650000
*TVOLRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                 /*@Y30LB39*/ 01651000
*                                                                  0571 01652000
TVOLRTN  DS    0H                                                  0572 01653000
*        /************************************************************/ 01654000
*        /*                                                  @Y30LB39*/ 01655000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 01656000
*        /*                                                  @Y30LB39*/ 01657000
*        /************************************************************/ 01658000
*                                                          /*@Y30LB39*/ 01659000
*        DCL TVOLRC FIXED(8);          /* RETURN CODE        @Y30LB39*/ 01660000
*                                                          /*@Y30LB39*/ 01661000
*        /************************************************************/ 01662000
*        /*                                                  @Y30LB39*/ 01663000
*        /*  SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE   @Y30LB39*/ 01664000
*        /*                                                  @Y30LB39*/ 01665000
*        /************************************************************/ 01666000
*                                                          /*@Y30LB39*/ 01667000
*        RETADDR3 = REG14;                                 /*@Y30LB39*/ 01668000
         LR    RETADDR3,REG14                                      0573 01669000
*                                                          /*@Y30LB39*/ 01670000
*        /************************************************************/ 01671000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 01672000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 01673000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 01674000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 01675000
*        /*                                                  @Y30LB39*/ 01676000
*        /************************************************************/ 01677000
*                                                          /*@Y30LB39*/ 01678000
*        OLDERID2 = NEWERID2;                                      0574 01679000
         L     @08,@PC00001                                        0574 01680000
         L     @02,GDTTR2(,@08)                                    0574 01681000
         MVC   @TS00001(95),NEWERID2(@02)                          0574 01682000
         MVC   OLDERID2(95,@02),@TS00001                           0574 01683000
*        NEWID2 = 'RVTV';                                  /*@Y30LB39*/ 01684000
         MVC   NEWID2(4,@02),@CC01569                              0575 01685000
*                                                          /*@Y30LB39*/ 01686000
*        /************************************************************/ 01687000
*        /*                                                  @Y30LB39*/ 01688000
*        /*      SET CONDITION CODE TO ZERO                  @Y30LB39*/ 01689000
*        /*                                                  @Y30LB39*/ 01690000
*        /************************************************************/ 01691000
*                                                          /*@Y30LB39*/ 01692000
*        TVOLRC = LASTCC00;                                /*@Y30LB39*/ 01693000
         SLR   TVOLRC,TVOLRC                                       0576 01694000
*                                                          /*@Y30LB39*/ 01695000
*        /************************************************************/ 01696000
*        /*                                                  @Y30LB39*/ 01697000
*        /* CHECK TO SEE IF VOLUME IS FLAGGED AS INACTIVE.   @Y30LB39*/ 01698000
*        /*                                                  @Y30LB39*/ 01699000
*        /************************************************************/ 01700000
*                                                          /*@Y30LB39*/ 01701000
*        IF BASINAC = ON THEN                                      0577 01702000
         TM    BASINAC(BASEVPTR),B'00000100'                       0577 01703000
         BNO   @RF00577                                            0577 01704000
*          DO;                                             /*@Y30LB39*/ 01705000
*            TVOLRC = LASTCC04;                            /*@Y30LB39*/ 01706000
         LA    TVOLRC,4                                            0579 01707000
*            DARGLIST = ''B;                               /*@Y30LB39*/ 01708000
         L     @02,DDSTRU                                          0580 01709000
         XC    DARGLIST(20,@02),DARGLIST(@02)                      0580 01710000
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/ 01711000
         MVC   DARGSMOD(3,@02),@CC01460                            0581 01712000
*            DARGSENT = MSG3074I;                          /*@Y30LB39*/ 01713000
         MVI   DARGSENT(@02),X'20'                                 0582 01714000
*            DARGDBP = ADDR(TVOLVAL);                      /*@Y30LB39*/ 01715000
         L     @15,@PC00001+4                                      0583 01716000
         L     @15,FDTPTR+4(,@15)                                  0583 01717000
         LA    @14,TVOLVAL(,@15)                                   0583 01718000
         ST    @14,DARGDBP(,@02)                                   0583 01719000
*            DARGILP = TVOLLEN;                            /*@Y30LB39*/ 01720000
         SLR   @14,@14                                             0584 01721000
         IC    @14,TVOLLEN(,@15)                                   0584 01722000
         STH   @14,DARGILP(,@02)                                   0584 01723000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/ 01724000
         ST    @08,@AL00001                                        0585 01725000
         LA    @02,@CF00114                                        0585 01726000
         ST    @02,@AL00001+4                                      0585 01727000
         LA    @02,DDSTRU                                          0585 01728000
         ST    @02,@AL00001+8                                      0585 01729000
         MVI   @AL00001+8,X'80'                                    0585 01730000
         L     @15,GDTPRT(,@08)                                    0585 01731000
         LA    @01,@AL00001                                        0585 01732000
         BALR  @14,@15                                             0585 01733000
*          END;                                            /*@Y30LB39*/ 01734000
*                                                          /*@Y30LB39*/ 01735000
*        /************************************************************/ 01736000
*        /*                                                  @Y30LB39*/ 01737000
*        /*  TEST IF VOLUME IS UNUSABLE. AN ACCEPTABLE TARGET@Y30LB39*/ 01738000
*        /*  VOLUME FOR THE RECOVER OPERATION MUST NOT BE    @Y30LB39*/ 01739000
*        /*  FLAGGED AS INCOMPLETE UNLESS IT IS MARKED AS AN @Y30LB39*/ 01740000
*        /*  INCOMPLETE COPY DUE TO A PREVIOUS COPY FAILURE. @Y30LB39*/ 01741000
*        /*                                                  @Y30LB39*/ 01742000
*        /************************************************************/ 01743000
*                                                          /*@Y30LB39*/ 01744000
*        IF BASIVCRE=ON | BASVSMIS=ON THEN                 /*@ZM30737*/ 01745000
@RF00577 TM    BASIVCRE(BASEVPTR),B'10100000'                      0587 01746000
         BZ    @RF00587                                            0587 01747000
*          DO;                                             /*@Y30LB39*/ 01748000
*            TVOLRC = LASTCC04;                            /*@Y30LB39*/ 01749000
         LA    TVOLRC,4                                            0589 01750000
*            DARGLIST = ''B;                               /*@Y30LB39*/ 01751000
         L     @08,DDSTRU                                          0590 01752000
         XC    DARGLIST(20,@08),DARGLIST(@08)                      0590 01753000
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/ 01754000
         MVC   DARGSMOD(3,@08),@CC01460                            0591 01755000
*            DARGDBP = ADDR(TVOLVAL);                      /*@Y30LB39*/ 01756000
         L     @02,@PC00001+4                                      0592 01757000
         L     @02,FDTPTR+4(,@02)                                  0592 01758000
         LA    @15,TVOLVAL(,@02)                                   0592 01759000
         ST    @15,DARGDBP(,@08)                                   0592 01760000
*            DARGILP = TVOLLEN;                            /*@Y30LB39*/ 01761000
         SLR   @15,@15                                             0593 01762000
         IC    @15,TVOLLEN(,@02)                                   0593 01763000
         STH   @15,DARGILP(,@08)                                   0593 01764000
*            IF BASIVCRE = ON THEN                                 0594 01765000
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0594 01766000
         BNO   @RF00594                                            0594 01767000
*              DARGSENT = MSG3097I;                        /*@Y30LB39*/ 01768000
         MVI   DARGSENT(@08),X'04'                                 0595 01769000
*            ELSE                                                  0596 01770000
*                DARGSENT = MSG3095I;                      /*@Y30LB39*/ 01771000
         B     @RC00594                                            0596 01772000
@RF00594 L     @08,DDSTRU                                          0596 01773000
         MVI   DARGSENT(@08),X'0A'                                 0596 01774000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/ 01775000
@RC00594 L     @08,@PC00001                                        0597 01776000
         ST    @08,@AL00001                                        0597 01777000
         LA    @02,@CF00114                                        0597 01778000
         ST    @02,@AL00001+4                                      0597 01779000
         LA    @02,DDSTRU                                          0597 01780000
         ST    @02,@AL00001+8                                      0597 01781000
         MVI   @AL00001+8,X'80'                                    0597 01782000
         L     @15,GDTPRT(,@08)                                    0597 01783000
         LA    @01,@AL00001                                        0597 01784000
         BALR  @14,@15                                             0597 01785000
*          END;                                            /*@Y30LB39*/ 01786000
*                                                          /*@Y30LB39*/ 01787000
*        /************************************************************/ 01788000
*        /*                                                  @Y30LB39*/ 01789000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 01790000
*        /*                                                  @Y30LB39*/ 01791000
*        /************************************************************/ 01792000
*                                                          /*@Y30LB39*/ 01793000
*        REG14 = RETADDR3;                                 /*@Y30LB39*/ 01794000
@RF00587 LR    REG14,RETADDR3                                      0599 01795000
*                                                          /*@Y30LB39*/ 01796000
*        /************************************************************/ 01797000
*        /*                                                  @Y30LB39*/ 01798000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 01799000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 01800000
*        /*                                                  @Y30LB39*/ 01801000
*        /************************************************************/ 01802000
*                                                          /*@Y30LB39*/ 01803000
*        RETURN CODE(TVOLRC);                              /*@Y30LB39*/ 01804000
         LR    @15,TVOLRC                                          0600 01805000
@EL00006 DS    0H                                                  0600 01806000
@EF00006 DS    0H                                                  0600 01807000
@ER00006 BR    @14                                                 0600 01808000
*END TVOLRTN;                                              /*@Y30LB39*/ 01809000
*        /************************************************************/ 01810000
*        /*                                                  @Y30LB39*/ 01811000
*        /*  PROCEDURE NAME - ALLOCRTN                       @Y30LB39*/ 01812000
*        /*                                                  @Y30LB39*/ 01813000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 01814000
*        /*  EITHER SELECT A UNIT FOR REUSE OR DYNAMICALLY   @ZD00175*/ 01815000
*        /*  ALLOCATE A UNIT IF FILE IS NOT SPECIFIED. THEN  @ZD00175*/ 01816000
*        /*  VERIFY THAT THE UNIT ALLOCATED VIA THE FILE     @ZD00175*/ 01817000
*        /*  PARAMETER IS VIRTUAL.                           @ZD00175*/ 01818000
*        /*  IF AT ANY TIME, THIS SUBROUTINE RECEIVES A      @Y30LB39*/ 01819000
*        /*  NON-ZERO RETURN CODE FROM A MACRO, THEN         @Y30LB39*/ 01820000
*        /*  CONTROL WILL RETURN IMMEDIATELY TO CALLER.      @Y30LB39*/ 01821000
*        /*  IT IS POSSIBLE FOR MESSAGE IDC3092I TO BE       @Y30LB39*/ 01822000
*        /*  ISSUED IF A UNIT IS REQUIRED VIA THE FILE PARM. @Y30LB39*/ 01823000
*        /*                                                  @Y30LB39*/ 01824000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 01825000
*        /*          RECOVERV TABLE                          @Y30LB39*/ 01826000
*        /*          BASE VOLUME RECORD (BASEV)              @Y30LB39*/ 01827000
*        /*          BUFFER FOR PRINT ARGUMENT LIST          @Y30LB39*/ 01828000
*        /*          BUFFER FOR ALLOC ARGUMENT LIST          @Y30LB39*/ 01829000
*        /*          BUFFER FOR EXCLUSIVE ARGUMENT LIST      @ZD00175*/ 01830000
*        /*                                                  @Y30LB39*/ 01831000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 01832000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 01833000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 01834000
*        /*      4 - IF PROCESSING DID NOT COMPLETE          @Y30LB39*/ 01835000
*        /*          NORMALLY                                @Y30LB39*/ 01836000
*        /*            . IF UNIT REQUIRED BUT NOT ALLOCATED  @Y30LB39*/ 01837000
*        /*              BECAUSE DEFERRED MOUNT IS NECESSARY @Y30LB39*/ 01838000
*        /*            . IF RETURN CODE NOT ZERO FROM SELECT,@ZD00175*/ 01839000
*        /*              DYNAMIC ALLOCATING OR CHECK ROUTINE @ZD00175*/ 01840000
*        /*                                                  @Y30LB39*/ 01841000
*        /************************************************************/ 01842000
*                                                                  0602 01843000
*ALLOCRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/ 01844000
*                                                                  0602 01845000
ALLOCRTN DS    0H                                                  0603 01846000
*        /************************************************************/ 01847000
*        /*                                                  @Y30LB39*/ 01848000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 01849000
*        /*                                                  @Y30LB39*/ 01850000
*        /************************************************************/ 01851000
*                                                          /*@Y30LB39*/ 01852000
*        DCL ALLOCRC FIXED(8);         /* RETURN CODE        @Y30LB39*/ 01853000
*                                                          /*@Y30LB39*/ 01854000
*                                                          /*@Y30LB39*/ 01855000
*        /************************************************************/ 01856000
*        /*                                                  @Y30LB39*/ 01857000
*        /*  SAVE THE ADDRESS OF THE CALLING SUB-PROCEDURE   @Y30LB39*/ 01858000
*        /*                                                  @Y30LB39*/ 01859000
*        /************************************************************/ 01860000
*                                                          /*@Y30LB39*/ 01861000
*        RETADDR2 = REG14;                                 /*@Y30LB39*/ 01862000
         LR    RETADDR2,REG14                                      0604 01863000
*                                                          /*@Y30LB39*/ 01864000
*        /************************************************************/ 01865000
*        /*                                                  @ZD00175*/ 01866000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 01867000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 01868000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 01869000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 01870000
*        /*                                                  @Y30LB39*/ 01871000
*        /************************************************************/ 01872000
*                                                          /*@Y30LB39*/ 01873000
*        OLDERID2 = NEWERID2;                                      0605 01874000
         L     @15,@PC00001                                        0605 01875000
         L     @14,GDTTR2(,@15)                                    0605 01876000
         MVC   @TS00001(95),NEWERID2(@14)                          0605 01877000
         MVC   OLDERID2(95,@14),@TS00001                           0605 01878000
*        NEWID2 = 'RVAL';                                  /*@Y30LB39*/ 01879000
         MVC   NEWID2(4,@14),@CC01574                              0606 01880000
*                                                          /*@Y30LB39*/ 01881000
*        /************************************************************/ 01882000
*        /*                                                  @Y30LB39*/ 01883000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 01884000
*        /*                                                  @Y30LB39*/ 01885000
*        /************************************************************/ 01886000
*                                                          /*@Y30LB39*/ 01887000
*        ALLOCRC = LASTCC00;                               /*@Y30LB39*/ 01888000
         SLR   @14,@14                                             0607 01889000
         LR    ALLOCRC,@14                                         0607 01890000
*                                                          /*@Y30LB39*/ 01891000
*        /************************************************************/ 01892000
*        /*                                                  @Y30LB39*/ 01893000
*        /*  IF FILE NAME IS NOT SPECIFIED AND THE VOLUME    @Y30LB39*/ 01894000
*        /*  SERIAL NUMBER MUST BE UPDATED AFTER THE COPY    @Y30LB39*/ 01895000
*        /*  OPERATION AND THE TARGET VOLUME IS ALREADY      @Y30LB39*/ 01896000
*        /*  MARKED INCOMPLETE, THEN A UNIT IS REQUIRED BUT  @Y30LB39*/ 01897000
*        /*  CANNOT BE DYNAMICALLY ALLOCATED BECAUSE         @Y30LB39*/ 01898000
*        /*  DEFERRED MOUNT IS NECESSARY.                    @Y30LB39*/ 01899000
*        /*                                                  @Y30LB39*/ 01900000
*        /************************************************************/ 01901000
*                                                          /*@Y30LB39*/ 01902000
*        IF ADDR(FILE) = NULLPTR & FVOLVAL ^= TVOLVAL &            0608 01903000
*          (BASIVCRE=ON | BASIVCPY=ON | BASVSMIS=ON) THEN          0608 01904000
         L     @03,@PC00001+4                                      0608 01905000
         C     @14,FDTPTR+36(,@03)                                 0608 01906000
         BNE   @RF00608                                            0608 01907000
         L     @01,FDTPTR(,@03)                                    0608 01908000
         L     @14,FDTPTR+4(,@03)                                  0608 01909000
         CLC   FVOLVAL(6,@01),TVOLVAL(@14)                         0608 01910000
         BE    @RF00608                                            0608 01911000
         TM    BASIVCRE(BASEVPTR),B'11100000'                      0608 01912000
         BZ    @RF00608                                            0608 01913000
*          DO;                                             /*@Y30LB39*/ 01914000
*            ALLOCRC = LASTCC04;                           /*@Y30LB39*/ 01915000
         LA    ALLOCRC,4                                           0610 01916000
*            DARGLIST = ''B;                               /*@Y30LB39*/ 01917000
         L     @14,DDSTRU                                          0611 01918000
         XC    DARGLIST(20,@14),DARGLIST(@14)                      0611 01919000
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/ 01920000
         MVC   DARGSMOD(3,@14),@CC01460                            0612 01921000
*            DARGSENT = MSG3092I;                          /*@Y30LB39*/ 01922000
         MVI   DARGSENT(@14),X'0E'                                 0613 01923000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/ 01924000
         ST    @15,@AL00001                                        0614 01925000
         LA    @14,@CF00114                                        0614 01926000
         ST    @14,@AL00001+4                                      0614 01927000
         LA    @14,DDSTRU                                          0614 01928000
         ST    @14,@AL00001+8                                      0614 01929000
         MVI   @AL00001+8,X'80'                                    0614 01930000
         L     @15,GDTPRT(,@15)                                    0614 01931000
         LA    @01,@AL00001                                        0614 01932000
         BALR  @14,@15                                             0614 01933000
*          END;                                            /*@Y30LB39*/ 01934000
*        IF ALLOCRC = LASTCC00 THEN                                0616 01935000
@RF00608 SLR   @15,@15                                             0616 01936000
         CR    ALLOCRC,@15                                         0616 01937000
         BNE   @RF00616                                            0616 01938000
*          DO;                                             /*@Y30LB39*/ 01939000
*                                                                  0617 01940000
*            /********************************************************/ 01941000
*            /*                                              @ZD00175*/ 01942000
*            /* IF EITHER ALLOCATION IS BEING DONE AFTER THE COPY OR */ 01943000
*            /* IF FILE WAS NOT SPECIFIED AND THE TARGET VOLUME IS   */ 01944000
*            /* NOT INCOMPLETE, CONTINUE WITH ALLOCATION OF A UNIT.  */ 01945000
*            /*                                              @ZD00175*/ 01946000
*            /********************************************************/ 01947000
*                                                                  0618 01948000
*            IF GETDDFLG=ON |                                      0618 01949000
*              (ADDR(FILE) = NULLPTR &                             0618 01950000
*              (BASIVCRE=OFF & BASIVCPY=OFF & BASVSMIS=OFF)) THEN  0618 01951000
         TM    GETDDFLG,B'00001000'                                0618 01952000
         BO    @RT00618                                            0618 01953000
         L     @14,@PC00001+4                                      0618 01954000
         C     @15,FDTPTR+36(,@14)                                 0618 01955000
         BNE   @RF00618                                            0618 01956000
         TM    BASIVCRE(BASEVPTR),B'11100000'                      0618 01957000
         BNZ   @RF00618                                            0618 01958000
@RT00618 DS    0H                                                  0619 01959000
*              DO;                                         /*@Y30LB39*/ 01960000
*                /****************************************************/ 01961000
*                /*                                          @ZD00175*/ 01962000
*                /* DETERMINE IF THE TARGET VOLUME IS ALREADY        */ 01963000
*                /* ALLOCATED EXCLUSIVELY TO THE JOB STEP AND        */ 01964000
*                /* IF A UNIT IS AVAILABLE FOR REUSE.        @ZD00175*/ 01965000
*                /*                                          @ZD00175*/ 01966000
*                /****************************************************/ 01967000
*                                                                  0620 01968000
*                EXCLAGL=''B;                              /*@ZD00175*/ 01969000
         LA    @02,EXCLAGLB                                        0620 01970000
         XC    EXCLAGL(23,@02),EXCLAGL(@02)                        0620 01971000
*                EXCLUCBP=ADDR(RUNITUCB);                  /*@ZD00175*/ 01972000
         LA    @15,RUNITUCB                                        0621 01973000
         ST    @15,EXCLUCBP(,@02)                                  0621 01974000
*                EXCLDDP=ADDR(RUNITDDN);                   /*@ZD00175*/ 01975000
         LA    @15,RUNITDDN                                        0622 01976000
         ST    @15,EXCLDDP(,@02)                                   0622 01977000
*                EXCLVOL=TVOLVAL;                          /*@ZD00175*/ 01978000
*                                                                  0623 01979000
         L     @15,@PC00001+4                                      0623 01980000
         L     @01,FDTPTR+4(,@15)                                  0623 01981000
         MVC   EXCLVOL(6,@02),TVOLVAL(@01)                         0623 01982000
*                /****************************************************/ 01983000
*                /*                                          @ZD00175*/ 01984000
*                /* INVOKE THE SYSTEM ADAPTER, IDCSA06, TO SELECT    */ 01985000
*                /* A UNIT ALREADY EXCLUSIVELY ALLOCATED TO THE      */ 01986000
*                /* VOLUME AND JOB STEP.                     @ZD00175*/ 01987000
*                /*                                          @ZD00175*/ 01988000
*                /****************************************************/ 01989000
*                                                                  0624 01990000
*                CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);    /*@ZD00175*/ 01991000
*                                                                  0624 01992000
         L     @15,@PC00001                                        0624 01993000
         ST    @15,@AL00001                                        0624 01994000
         LA    @14,SELECTX                                         0624 01995000
         ST    @14,@AL00001+4                                      0624 01996000
         ST    @02,@AL00001+8                                      0624 01997000
         MVI   @AL00001+8,X'80'                                    0624 01998000
         L     @15,GDTUNT(,@15)                                    0624 01999000
         LA    @01,@AL00001                                        0624 02000000
         BALR  @14,@15                                             0624 02001000
*                RESPECIFY RTNREG RSTD;                            0625 02002000
*                TESTRC = RTNREG;                                  0626 02003000
         LR    TESTRC,RTNREG                                       0626 02004000
*                RESPECIFY RTNREG UNRSTD;                  /*@ZD00175*/ 02005000
*                                                                  0627 02006000
*                /****************************************************/ 02007000
*                /*                                          @ZD00175*/ 02008000
*                /* IF NO DDNAME AND UCB ADDRESS ARE RETURNED BY     */ 02009000
*                /* IDCSA06, A UNIT IS NOT AVAILABLE.  DYNAMICALLY   */ 02010000
*                /* ALLOCATE ONE FOR SHARED USE.             @ZD00175*/ 02011000
*                /*                                          @ZD00175*/ 02012000
*                /****************************************************/ 02013000
*                                                                  0628 02014000
*                IF TESTRC=0 THEN                                  0628 02015000
         SLR   @02,@02                                             0628 02016000
         CR    TESTRC,@02                                          0628 02017000
         BNE   @RF00628                                            0628 02018000
*                  IF RUNITUCB=NULLPTR THEN                        0629 02019000
         C     @02,RUNITUCB                                        0629 02020000
         BNE   @RF00629                                            0629 02021000
*                    DO;                                   /*@ZD00175*/ 02022000
*                                                          /*#Y30LB39*/ 02023000
*                    /************************************************/ 02024000
*                    /*                                      @ZD00175*/ 02025000
*                    /*  INITIALIZE THE ARGUMENT LIST TO DYNAMICALLY    02026000
*                    /*  ALLOCATE A VIRTUAL UNIT, 3330V, AND TO MOUNT   02027000
*                    /*  THE TARGET VOLUME.                  @ZD00175*/ 02028000
*                    /*                                      @ZD00175*/ 02029000
*                    /************************************************/ 02030000
*                                                          /*@ZD00175*/ 02031000
*                    ALLAGL = ''B;                         /*@ZD00175*/ 02032000
         LA    @03,ALLAGLBF                                        0631 02033000
         XC    ALLAGL(31,@03),ALLAGL(@03)                          0631 02034000
*                    ALLOPTVL = ON;                        /*@ZD00175*/ 02035000
         OI    ALLOPTVL(@03),B'10000000'                           0632 02036000
*                    RVULNUM = 1;                          /*@ZD00175*/ 02037000
         LA    @15,1                                               0633 02038000
         STH   @15,RVULNUM                                         0633 02039000
*                    RVULLNTH = LENGTH('3330V');           /*@ZD00175*/ 02040000
         MVC   RVULLNTH(2),@CH00285                                0634 02041000
*                    RVULTYPE = '3330V';                   /*@ZD00175*/ 02042000
         MVC   RVULTYPE(5),@CC01575                                0635 02043000
*                    ALLULP = ADDR(RVULLIST);              /*@ZD00175*/ 02044000
         LA    @14,RVULLIST                                        0636 02045000
         ST    @14,ALLULP(,@03)                                    0636 02046000
*                    VOLNUMBR = 1;                         /*@ZD00175*/ 02047000
         STH   @15,VOLNUMBR                                        0637 02048000
*                    VOLLENTH = TVOLLEN;                   /*@ZD00175*/ 02049000
         L     @15,@PC00001+4                                      0638 02050000
         L     @15,FDTPTR+4(,@15)                                  0638 02051000
         SLR   @14,@14                                             0638 02052000
         IC    @14,TVOLLEN(,@15)                                   0638 02053000
         STH   @14,VOLLENTH                                        0638 02054000
*                    VOLSERNM = TVOLVAL;                   /*@ZD00175*/ 02055000
         MVC   VOLSERNM(6),TVOLVAL(@15)                            0639 02056000
*                    ALLVLP = ADDR(VOLSERLT);              /*@ZD00175*/ 02057000
         LA    @15,VOLSERLT                                        0640 02058000
         ST    @15,ALLVLP(,@03)                                    0640 02059000
*                    ALLVLCNT = VOLUMCNT;                  /*@ZD00175*/ 02060000
         MVI   ALLVLCNT(@03),X'01'                                 0641 02061000
*                    ALLUNCNT = 1;                         /*@ZD00175*/ 02062000
         MVI   ALLUNCNT(@03),X'01'                                 0642 02063000
*                    ALLOPTPV = ON;                        /*@ZD00175*/ 02064000
         OI    ALLOPTPV(@03),B'00100000'                           0643 02065000
*                                                          /*@ZD00175*/ 02066000
*                    /************************************************/ 02067000
*                    /*                                      @ZD00175*/ 02068000
*                    /*  DUMP ALLOCATION ARGUMENT LIST PRIOR TO      */ 02069000
*                    /*  INVOKING DYNAMIC ALLOCATION ROUTINE.        */ 02070000
*                    /*                                      @ZD00175*/ 02071000
*                    /************************************************/ 02072000
*                                                          /*@ZD00175*/ 02073000
*                                                                  0644 02074000
*                      IF GDTDBG = NULLPTR                         0644 02075000
*                        THEN;                                     0644 02076000
         L     @03,@PC00001                                        0644 02077000
         C     @02,GDTDBG(,@03)                                    0644 02078000
         BE    @RT00644                                            0644 02079000
*                        ELSE                                      0646 02080000
*                          DO;                                     0646 02081000
*                            DMPINDEX = ADDR(DUMPLIST);            /*@Z 02082000
*00175*/                                                           0647 02083000
*                                                                  0647 02084000
         LA    DMPINDEX,DUMPLIST                                   0647 02085000
*                            DMPITMNM = 'ALLAGLBF';                0648 02086000
         MVC   DMPITMNM(8,DMPINDEX),@CC01576                       0648 02087000
*                            DMPITMPT = ADDR(ALLAGLBF);            0649 02088000
         LA    @03,ALLAGLBF                                        0649 02089000
         ST    @03,DMPITMPT(,DMPINDEX)                             0649 02090000
*                            DMPITMLN = LENGTH(ALLAGLBF);          0650 02091000
         MVC   DMPITMLN(2,DMPINDEX),@CH00043                       0650 02092000
*                            DMPITMTP = 'H';                       0651 02093000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0651 02094000
*                            DMPINDEX = DMPINDEX + DMPELEMT;       0652 02095000
         AL    DMPINDEX,@CF00473                                   0652 02096000
*                /*@ZD00175*/                                      0653 02097000
*                                                                  0653 02098000
*                            DMPTRM = DMPTRMVL;                    0653 02099000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0653 02100000
*                          END;                             /*@ZD00175* 02101000
*                                                          /*@ZD00175*/ 02102000
*                    IF GDTDBG = NULLPTR                           0655 02103000
*                      THEN;                                       0655 02104000
@RT00644 L     @15,@PC00001                                        0655 02105000
         L     @15,GDTDBG(,@15)                                    0655 02106000
         LTR   @15,@15                                             0655 02107000
         BZ    @RT00655                                            0655 02108000
*                      ELSE                                        0657 02109000
*                        CALL IDCDB010 (GDTTBL,'RVAA',ADDR(DUMPLIST));  02110000
         L     @15,@PC00001                                        0657 02111000
         ST    @15,@AL00001                                        0657 02112000
         LA    @14,@CC01577                                        0657 02113000
         ST    @14,@AL00001+4                                      0657 02114000
         LA    @14,DUMPLIST                                        0657 02115000
         ST    @14,@AFTEMPS+4                                      0657 02116000
         LA    @14,@AFTEMPS+4                                      0657 02117000
         ST    @14,@AL00001+8                                      0657 02118000
         MVI   @AL00001+8,X'80'                                    0657 02119000
         L     @15,GDTDBG(,@15)                                    0657 02120000
         LA    @01,@AL00001                                        0657 02121000
         BALR  @14,@15                                             0657 02122000
*                                                          /*@ZD00175*/ 02123000
*                                                          /*@ZD00175*/ 02124000
*                    CALL IDCSAAL0 (GDTTBL,ALLAGL);        /*@ZD00175*/ 02125000
@RT00655 L     @02,@PC00001                                        0658 02126000
         ST    @02,@AL00001                                        0658 02127000
         LA    @15,ALLAGLBF                                        0658 02128000
         ST    @15,@AL00001+4                                      0658 02129000
         MVI   @AL00001+4,X'80'                                    0658 02130000
         L     @15,GDTALC(,@02)                                    0658 02131000
         LA    @01,@AL00001                                        0658 02132000
         BALR  @14,@15                                             0658 02133000
*                                                          /*@ZD00175*/ 02134000
*                    RESPECIFY RTNREG RSTD;                        0659 02135000
*                    TESTRC = RTNREG;                              0660 02136000
         LR    TESTRC,RTNREG                                       0660 02137000
*                    RESPECIFY RTNREG UNRSTD;              /*@ZD00175*/ 02138000
*                                                          /*@ZD00175*/ 02139000
*                    /************************************************/ 02140000
*                    /*                                      @ZD00175*/ 02141000
*                    /*  IF UALLOC RETURN CODE NOT ZERO, DYNAMIC     */ 02142000
*                    /*  ALLOCATION FAILED. THE UALLOC FUNCTION      */ 02143000
*                    /*  ISSUED THE APPROPRIATE MESSAGE.     @ZD00175*/ 02144000
*                    /*  SET THE CONDITION CODE TO 4 PRIOR   @ZD00175*/ 02145000
*                    /*  TO RETURNING TO CALLER.             @ZD00175*/ 02146000
*                    /*                                      @ZD00175*/ 02147000
*                    /************************************************/ 02148000
*                                                                  0662 02149000
*                    IF TESTRC ^= 0 THEN                   /*@ZD00175*/ 02150000
         LTR   TESTRC,TESTRC                                       0662 02151000
         BZ    @RF00662                                            0662 02152000
*                      ALLOCRC = LASTCC04;                 /*@ZD00175*/ 02153000
         LA    ALLOCRC,4                                           0663 02154000
*                                                          /*@ZD00175*/ 02155000
*                    /************************************************/ 02156000
*                    /*                                      @ZD00175*/ 02157000
*                    /* SET FLAG ON INDICATING THAT UNIT WAS @ZD00175*/ 02158000
*                    /* DYNAMICALLY ALLOCATED.               @ZD00175*/ 02159000
*                    /*                                      @ZD00175*/ 02160000
*                    /************************************************/ 02161000
*                                                          /*@ZD00175*/ 02162000
*                    ELSE                                  /*@ZD00175*/ 02163000
*                      DO;                                 /*@ZD00175*/ 02164000
         B     @RC00662                                            0664 02165000
@RF00662 DS    0H                                                  0665 02166000
*                        ALLOCFLG = ON;                    /*@ZD00175*/ 02167000
         OI    ALLOCFLG,B'10000000'                                0665 02168000
*                        RUNITDDN = ALLDDN;                /*@ZD00175*/ 02169000
         LA    @15,ALLAGLBF                                        0666 02170000
         MVC   RUNITDDN(8),ALLDDN(@15)                             0666 02171000
*                      END;                                /*@ZD00175*/ 02172000
*                    END;                                  /*@ZD00175*/ 02173000
*                                                                  0668 02174000
*                /****************************************************/ 02175000
*                /*                                          @ZD00175*/ 02176000
*                /* USE THE DDNAME AND UCB ADDRESS RETURNED BY       */ 02177000
*                /* IDCSA06 SINCE THE VOLUME IS ALREADY ALLOCATED    */ 02178000
*                /* EXCLUSIVELY TO THIS TASK.                @ZD00175*/ 02179000
*                /*                                          @ZD00175*/ 02180000
*                /****************************************************/ 02181000
*                                                                  0669 02182000
*                ELSE;                                     /*@ZD00175*/ 02183000
*                                                                  0669 02184000
@RF00629 DS    0H                                                  0670 02185000
*              /******************************************************/ 02186000
*              /*                                            @ZD00175*/ 02187000
*              /* IF NO UNIT IS AVAILABLE AND THE VOLUME IS  @ZD00175*/ 02188000
*              /* IS ALREADY ALLOCATED FOR EXCLUSIVE USE, IDCSA06    */ 02189000
*              /* ISSUED THE APPROPRIATE ERROR MESSAGE.  SET THE     */ 02190000
*              /* CONDITION CODE TO 12 PRIOR TO RETURNING TO THE     */ 02191000
*              /* CALLER.                                    @ZD00175*/ 02192000
*              /*                                            @ZD00175*/ 02193000
*              /******************************************************/ 02194000
*                                                                  0670 02195000
*              ELSE                                                0670 02196000
*                                                                  0670 02197000
*                ALLOCRC=LASTCC04;                         /*@ZD00175*/ 02198000
*                                                                  0670 02199000
         B     @RC00628                                            0670 02200000
@RF00628 LA    ALLOCRC,4                                           0670 02201000
*            END;                                          /*@ZD00175*/ 02202000
@RC00628 DS    0H                                                  0672 02203000
*          END;                                            /*#Y30LB39*/ 02204000
@RF00618 DS    0H                                                  0673 02205000
*        IF ALLOCRC = 0 THEN                                       0673 02206000
@RF00616 SLR   @15,@15                                             0673 02207000
         CR    ALLOCRC,@15                                         0673 02208000
         BNE   @RF00673                                            0673 02209000
*          DO;                                             /*#Y30LB39*/ 02210000
*                                                          /*#Y30LB39*/ 02211000
*            /********************************************************/ 02212000
*            /*                                              @Y30LB39*/ 02213000
*            /*  IF FILE IS SPECIFED THEN SAVE THE FILE      @Y30LB39*/ 02214000
*            /*  NAME IN THE RECOVERV INTERNAL TABLE AND     @ZD00175*/ 02215000
*            /*  CHECK THE UNIT.                             @ZD00175*/ 02216000
*            /*                                              @Y30LB39*/ 02217000
*            /********************************************************/ 02218000
*                                                          /*@Y30LB39*/ 02219000
*            IF ADDR(FILE) ^= NULLPTR THEN                         0675 02220000
         L     @14,@PC00001+4                                      0675 02221000
         L     @03,FDTPTR+36(,@14)                                 0675 02222000
         CR    @03,@15                                             0675 02223000
         BE    @RF00675                                            0675 02224000
*              DO;                                         /*@ZD00175*/ 02225000
*                RUNITDDN = FILEVAL;                       /*@ZD00175*/ 02226000
         MVC   RUNITDDN(8),FILEVAL(@03)                            0677 02227000
*                                                          /*@Y30LB39*/ 02228000
*                                                          /*@Y30LB39*/ 02229000
*                /****************************************************/ 02230000
*                /*                                          @Y30LB39*/ 02231000
*                /*  INITIALIZE CKAGL - ISSUE UMSSUNIT MACRO @Y30LB39*/ 02232000
*                /*  TO VERIFY THAT THE DEVICE ALLOCATED IS  @Y30LB39*/ 02233000
*                /*  VIRTUAL.                                @ZD00175*/ 02234000
*                /*                                          @Y30LB39*/ 02235000
*                /****************************************************/ 02236000
*                                                          /*@Y30LB39*/ 02237000
*                CKAGL = ''B;                              /*@Y30LB39*/ 02238000
         LA    @03,CKAGLBUF                                        0678 02239000
         XC    CKAGL(29,@03),CKAGL(@03)                            0678 02240000
*                CKUCBPTR = ADDR(RUNITUCB);                /*@Y30LB39*/ 02241000
         LA    @02,RUNITUCB                                        0679 02242000
         ST    @02,CKUCBPTR(,@03)                                  0679 02243000
*                CKDDNAME = RUNITDDN;                      /*@Y30LB39*/ 02244000
         MVC   CKDDNAME(8,@03),RUNITDDN                            0680 02245000
*                CKTESTVT = ON;                            /*@Y30LB39*/ 02246000
         OI    CKTESTVT(@03),B'10000000'                           0681 02247000
*                CKLABELP = ADDR(TVOLVAL);                 /*@ZD00175*/ 02248000
         L     @01,FDTPTR+4(,@14)                                  0682 02249000
         LA    @02,TVOLVAL(,@01)                                   0682 02250000
         ST    @02,CKLABELP(,@03)                                  0682 02251000
*                                                          /*@Y30LB39*/ 02252000
*                /****************************************************/ 02253000
*                /*                                          @Y30LB39*/ 02254000
*                /*  DUMP CHECK ARGUMENT LIST PRIOR TO       @Y30LB39*/ 02255000
*                /*  INVOKING CHECK ALLOCATION ROUTINE.      @Y30LB39*/ 02256000
*                /*                                          @Y30LB39*/ 02257000
*                /****************************************************/ 02258000
*                                                          /*@Y30LB39*/ 02259000
*                                                                  0683 02260000
*                  IF GDTDBG = NULLPTR                             0683 02261000
*                    THEN;                                         0683 02262000
         L     @14,@PC00001                                        0683 02263000
         C     @15,GDTDBG(,@14)                                    0683 02264000
         BE    @RT00683                                            0683 02265000
*                    ELSE                                          0685 02266000
*                      DO;                                         0685 02267000
*                        DMPINDEX = ADDR(DUMPLIST);                /*@Y 02268000
*0LB39*/                                                           0686 02269000
*                                                                  0686 02270000
         LA    DMPINDEX,DUMPLIST                                   0686 02271000
*                        DMPITMNM = 'CKAGLBUF';                    0687 02272000
         MVC   DMPITMNM(8,DMPINDEX),@CC01578                       0687 02273000
*                        DMPITMPT = ADDR(CKAGLBUF);                0688 02274000
         LA    @03,CKAGLBUF                                        0688 02275000
         ST    @03,DMPITMPT(,DMPINDEX)                             0688 02276000
*                        DMPITMLN = LENGTH(CKAGLBUF);              0689 02277000
         MVC   DMPITMLN(2,DMPINDEX),@CH00847                       0689 02278000
*                        DMPITMTP = 'H';                           0690 02279000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0690 02280000
*                        DMPINDEX = DMPINDEX + DMPELEMT;           0691 02281000
         AL    DMPINDEX,@CF00473                                   0691 02282000
*                /*@Y30LB39*/                                      0692 02283000
*                                                                  0692 02284000
*                        DMPTRM = DMPTRMVL;                        0692 02285000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0692 02286000
*                      END;                                 /*@Y30LB39* 02287000
*                                                          /*@Y30LB39*/ 02288000
*                IF GDTDBG = NULLPTR                               0694 02289000
*                  THEN;                                           0694 02290000
@RT00683 L     @15,@PC00001                                        0694 02291000
         L     @15,GDTDBG(,@15)                                    0694 02292000
         LTR   @15,@15                                             0694 02293000
         BZ    @RT00694                                            0694 02294000
*                  ELSE                                            0696 02295000
*                    CALL IDCDB010 (GDTTBL,'RVBB',ADDR(DUMPLIST)); 0696 02296000
         L     @15,@PC00001                                        0696 02297000
         ST    @15,@AL00001                                        0696 02298000
         LA    @14,@CC01579                                        0696 02299000
         ST    @14,@AL00001+4                                      0696 02300000
         LA    @14,DUMPLIST                                        0696 02301000
         ST    @14,@AFTEMPS+4                                      0696 02302000
         LA    @14,@AFTEMPS+4                                      0696 02303000
         ST    @14,@AL00001+8                                      0696 02304000
         MVI   @AL00001+8,X'80'                                    0696 02305000
         L     @15,GDTDBG(,@15)                                    0696 02306000
         LA    @01,@AL00001                                        0696 02307000
         BALR  @14,@15                                             0696 02308000
*                                                          /*@Y30LB39*/ 02309000
*                                                          /*@Y30LB39*/ 02310000
*                CALL IDCSA060 (GDTTBL,CHECK,CKAGL);       /*@Y30LB39*/ 02311000
@RT00694 L     @02,@PC00001                                        0697 02312000
         ST    @02,@AL00001                                        0697 02313000
         LA    @15,CHECK                                           0697 02314000
         ST    @15,@AL00001+4                                      0697 02315000
         LA    @15,CKAGLBUF                                        0697 02316000
         ST    @15,@AL00001+8                                      0697 02317000
         MVI   @AL00001+8,X'80'                                    0697 02318000
         L     @15,GDTUNT(,@02)                                    0697 02319000
         LA    @01,@AL00001                                        0697 02320000
         BALR  @14,@15                                             0697 02321000
*                                                          /*@Y30LB39*/ 02322000
*                RESPECIFY RTNREG RSTD;                            0698 02323000
*                TESTRC = RTNREG;                                  0699 02324000
         LR    TESTRC,RTNREG                                       0699 02325000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LB39*/ 02326000
*                                                          /*@Y30LB39*/ 02327000
*                /****************************************************/ 02328000
*                /*                                          @Y30LB39*/ 02329000
*                /*  IF UMSSUNIT RETURN CODE IS NOT ZERO, AN @Y30LB39*/ 02330000
*                /*  APPROPRIATE MESSAGE WAS ISSUED BY THE   @Y30LB39*/ 02331000
*                /*  CHECK FUNCTION.  MERELY SET CONDITION   @Y30LB39*/ 02332000
*                /*  CODE TO FOUR BEFORE RETURNING           @Y30LB39*/ 02333000
*                /*                                          @Y30LB39*/ 02334000
*                /****************************************************/ 02335000
*                                                          /*@Y30LB39*/ 02336000
*                IF TESTRC ^= 0 THEN                       /*@Y30LB39*/ 02337000
         LTR   TESTRC,TESTRC                                       0701 02338000
         BZ    @RF00701                                            0701 02339000
*                  ALLOCRC = LASTCC04;                     /*@Y30LB39*/ 02340000
         LA    ALLOCRC,4                                           0702 02341000
*              END;                                        /*@Y30LB39*/ 02342000
@RF00701 DS    0H                                                  0704 02343000
*          END;                                            /*@Y30LB39*/ 02344000
@RF00675 DS    0H                                                  0705 02345000
*                                                          /*@Y30LB39*/ 02346000
*        /************************************************************/ 02347000
*        /*                                                  @Y30LB39*/ 02348000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 02349000
*        /*                                                  @Y30LB39*/ 02350000
*        /************************************************************/ 02351000
*                                                          /*@Y30LB39*/ 02352000
*        REG14 = RETADDR2;                                 /*@Y30LB39*/ 02353000
@RF00673 LR    REG14,RETADDR2                                      0705 02354000
*                                                          /*@Y30LB39*/ 02355000
*        /************************************************************/ 02356000
*        /*                                                  @Y30LB39*/ 02357000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 02358000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 02359000
*        /*                                                  @Y30LB39*/ 02360000
*        /************************************************************/ 02361000
*                                                          /*@Y30LB39*/ 02362000
*        RETURN CODE(ALLOCRC);                             /*@Y30LB39*/ 02363000
         LR    @15,ALLOCRC                                         0706 02364000
@EL00007 DS    0H                                                  0706 02365000
@EF00007 DS    0H                                                  0706 02366000
@ER00007 BR    @14                                                 0706 02367000
*END ALLOCRTN;                                             /*@Y30LB39*/ 02368000
*        /************************************************************/ 02369000
*        /*                                                  @Y30LB39*/ 02370000
*        /*  PROCEDURE NAME - VTOCKRTN                       @Y30LB39*/ 02371000
*        /*                                                  @Y30LB39*/ 02372000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 02373000
*        /*  MAKE A SECURITY CHECK OF PASSWORD PROTECTED     @Y30LB39*/ 02374000
*        /*  DATA SETS AND UNEXPIRED DATA SETS OR TO         @Y30LB39*/ 02375000
*        /*  CHECK THAT THE VOLUME IS IN FACT EMPTY AND      @Y30LB39*/ 02376000
*        /*  NON-VSAM.                                       @Y30LB39*/ 02377000
*        /*  AN EXTERNAL CALL IS MADE TO IDCVS01 TO          @Y30LB39*/ 02378000
*        /*  DO THE ACTUAL CHECKING OF PASSWORD PROTECTED    @Y30LB39*/ 02379000
*        /*  AND UNEXPIRED DATA SETS AND TO CHECK FOR        @Y30LB39*/ 02380000
*        /*  EMPTY VTOC WHICH, OF COURSE, WOULD INSURE THAT  @Y30LB39*/ 02381000
*        /*  THE VOLUME IS EMPTY.                            @Y30LB39*/ 02382000
*        /*                                                  @Y30LB39*/ 02383000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 02384000
*        /*          RECOVERV TABLE                          @Y30LB39*/ 02385000
*        /*                                                  @Y30LB39*/ 02386000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 02387000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 02388000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 02389000
*        /*      4 - IF RETURN CODE FROM IDCVS01 IS NOT ZERO @Y30LB39*/ 02390000
*        /*                                                  @Y30LB39*/ 02391000
*        /************************************************************/ 02392000
*                                                                  0708 02393000
*VTOCKRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/ 02394000
*                                                                  0708 02395000
VTOCKRTN DS    0H                                                  0709 02396000
*        /************************************************************/ 02397000
*        /*                                                  @Y30LB39*/ 02398000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 02399000
*        /*                                                  @Y30LB39*/ 02400000
*        /************************************************************/ 02401000
*                                                          /*@Y30LB39*/ 02402000
*        DCL VTOCKRC FIXED(8);         /* RETURN CODE        @Y30LB39*/ 02403000
*        DCL VOLSERV CHAR(8) CONSTANT('IDCVS01 ');         /*@Y30LB39*/ 02404000
*                                      /* CHARACTER STRING   @Y30LB39*/ 02405000
*                                      /* USED TO IDENTIFY   @Y30LB39*/ 02406000
*                                      /* EXTERNAL ROUTINE.  @Y30LB39*/ 02407000
*                                                          /*@Y30LB39*/ 02408000
*                                                          /*@Y30LB39*/ 02409000
*        /************************************************************/ 02410000
*        /*                                                  @Y30LB39*/ 02411000
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/ 02412000
*        /*                                                  @Y30LB39*/ 02413000
*        /************************************************************/ 02414000
*                                                          /*@Y30LB39*/ 02415000
*        RETADDR2 = REG14;                                 /*@Y30LB39*/ 02416000
         LR    RETADDR2,REG14                                      0711 02417000
*                                                          /*@Y30LB39*/ 02418000
*        /************************************************************/ 02419000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 02420000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 02421000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 02422000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 02423000
*        /*                                                  @Y30LB39*/ 02424000
*        /************************************************************/ 02425000
*                                                          /*@Y30LB39*/ 02426000
*        OLDERID2 = NEWERID2;                                      0712 02427000
         L     @08,@PC00001                                        0712 02428000
         L     @08,GDTTR2(,@08)                                    0712 02429000
         MVC   @TS00001(95),NEWERID2(@08)                          0712 02430000
         MVC   OLDERID2(95,@08),@TS00001                           0712 02431000
*        NEWID2 = 'RVVS';                                  /*@Y30LB39*/ 02432000
         MVC   NEWID2(4,@08),@CC01586                              0713 02433000
*                                                          /*@Y30LB39*/ 02434000
*        /************************************************************/ 02435000
*        /*                                                  @Y30LB39*/ 02436000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 02437000
*        /*                                                  @Y30LB39*/ 02438000
*        /************************************************************/ 02439000
*                                                          /*@Y30LB39*/ 02440000
*        VTOCKRC = LASTCC00;                               /*@Y30LB39*/ 02441000
         SLR   @08,@08                                             0714 02442000
         LR    VTOCKRC,@08                                         0714 02443000
*                                                          /*@Y30LB39*/ 02444000
*        /************************************************************/ 02445000
*        /*                                                  @Y30LB39*/ 02446000
*        /*  INITIALIZE VS1AGL FOR THE APPROPRIATE TYPE      @Y30LB39*/ 02447000
*        /*  OF VTOC SECURITY CHECKED REQUIRED ON THE        @Y30LB39*/ 02448000
*        /*  TARGET VOLUME.                                  @Y30LB39*/ 02449000
*        /*                                                  @Y30LB39*/ 02450000
*        /************************************************************/ 02451000
*                                                          /*@Y30LB39*/ 02452000
*        VS1AGL = ''B;                                     /*@Y30LB39*/ 02453000
         LA    @07,VS1AGLBF                                        0715 02454000
         XC    VS1AGL(74,@07),VS1AGL(@07)                          0715 02455000
*        VSRES = ON;                                       /*@Y30LB39*/ 02456000
         OI    VSRES(@07),B'10000000'                              0716 02457000
*        VSUCBP = ADDR(RUNITUCB);                          /*@Y30LB39*/ 02458000
         LA    @15,RUNITUCB                                        0717 02459000
         ST    @15,VSUCBP(,@07)                                    0717 02460000
*        VSVOLP = ADDR(TVOLVAL);                           /*@Y30LB39*/ 02461000
         L     @15,@PC00001+4                                      0718 02462000
         L     @14,FDTPTR+4(,@15)                                  0718 02463000
         LA    @03,TVOLVAL(,@14)                                   0718 02464000
         ST    @03,VSVOLP(,@07)                                    0718 02465000
*        VSFILEP = ADDR(RUNITDDN);                         /*@Y30LB39*/ 02466000
         LA    @03,RUNITDDN                                        0719 02467000
         ST    @03,VSFILEP(,@07)                                   0719 02468000
*        VSTOV = ON;                                       /*@Y30LB39*/ 02469000
         OI    VSTOV(@07),B'01000000'                              0720 02470000
*                                                          /*@Y30LB39*/ 02471000
*        /************************************************************/ 02472000
*        /*                                                  @Y30LB39*/ 02473000
*        /*  IF THE SOURCE AND TARGET VOLUMES HAVE THE SAME  @Y30LB39*/ 02474000
*        /*  VOLUME SERIAL NUMBERS, A CHECK IS MADE FOR      @Y30LB39*/ 02475000
*        /*  WRITE-LEVEL PASSWORD PROTECTED DATASETS AND     @Y30LB39*/ 02476000
*        /*  UNEXPIRED DATA SETS.                            @Y30LB39*/ 02477000
*        /*                                                  @Y30LB39*/ 02478000
*        /************************************************************/ 02479000
*                                                          /*@Y30LB39*/ 02480000
*        IF TVOLVAL = FVOLVAL THEN                                 0721 02481000
         L     @01,FDTPTR(,@15)                                    0721 02482000
         CLC   TVOLVAL(6,@14),FVOLVAL(@01)                         0721 02483000
         BNE   @RF00721                                            0721 02484000
*          DO;                                             /*@Y30LB39*/ 02485000
*            VSMASTER = ON;                                /*@Y30LB39*/ 02486000
*            VSWRITE = ON;                                 /*@Y30LB39*/ 02487000
         OI    VSMASTER(@07),B'01001000'                           0724 02488000
*            IF ADDR(CAT) ^= NULLPTR THEN                          0725 02489000
         C     @08,FDTPTR+24(,@15)                                 0725 02490000
         BE    @RF00725                                            0725 02491000
*              DO;                                         /*@Y30LB39*/ 02492000
*                VSCATP = ADDR(CATNMVAL);                  /*@Y30LB39*/ 02493000
         L     @01,FDTPTR+28(,@15)                                 0727 02494000
         LA    @14,CATNMVAL(,@01)                                  0727 02495000
         ST    @14,VSCATP(,@07)                                    0727 02496000
*                IF ADDR (CATDN) ^= NULLPTR THEN                   0728 02497000
         L     @15,FDTPTR+32(,@15)                                 0728 02498000
         CR    @15,@08                                             0728 02499000
         BE    @RF00728                                            0728 02500000
*                  VSCATDDP = ADDR (CATDNVAL);             /*@Y30LB39*/ 02501000
         LA    @08,CATDNVAL(,@15)                                  0729 02502000
         ST    @08,VSCATDDP(,@07)                                  0729 02503000
*                IF CATNMPLN ^= 0 THEN                             0730 02504000
@RF00728 L     @08,@PC00001+4                                      0730 02505000
         L     @08,FDTPTR+28(,@08)                                 0730 02506000
         CLI   CATNMPLN(@08),0                                     0730 02507000
         BE    @RF00730                                            0730 02508000
*                  VSPSWDP = ADDR (CATNMPAS);              /*@Y30LB39*/ 02509000
         LA    @07,VS1AGLBF                                        0731 02510000
         LA    @08,CATNMPAS(,@08)                                  0731 02511000
         ST    @08,VSPSWDP(,@07)                                   0731 02512000
*              END;                                        /*@Y30LB39*/ 02513000
@RF00730 DS    0H                                                  0733 02514000
*            VSPFILEP = ADDR(PFILE);                       /*@Y30LB39*/ 02515000
@RF00725 LA    @08,VS1AGLBF                                        0733 02516000
         L     @07,@PC00001+4                                      0733 02517000
         L     @07,FDTPTR+40(,@07)                                 0733 02518000
         ST    @07,VSPFILEP(,@08)                                  0733 02519000
*          END;                                            /*@Y30LB39*/ 02520000
*                                                          /*@Y30LB39*/ 02521000
*        /************************************************************/ 02522000
*        /*                                                  @Y30LB39*/ 02523000
*        /*  IF THE SOURCE AND TARGET VOLUMES HAVE DIFFERENT @Y30LB39*/ 02524000
*        /*  VOLUME SERIAL NUMBERS, A CHECK IS MADE TO       @Y30LB39*/ 02525000
*        /*  VERIFY THAT THE VOLUME CONTAINS NO DATA SETS    @Y30LB39*/ 02526000
*        /*  AND THAT IT IS NOT A VSAM CANDIDATE VOLUME.     @Y30LB39*/ 02527000
*        /*                                                  @Y30LB39*/ 02528000
*        /************************************************************/ 02529000
*                                                          /*@Y30LB39*/ 02530000
*        ELSE                                                      0735 02531000
*          DO;                                             /*@Y30LB39*/ 02532000
         B     @RC00721                                            0735 02533000
@RF00721 DS    0H                                                  0736 02534000
*            VSNONONV = ON;                                /*@Y30LB39*/ 02535000
*            VSNOVSAM = ON;                                /*@Y30LB39*/ 02536000
         LA    @08,VS1AGLBF                                        0737 02537000
         OI    VSNONONV(@08),B'10100000'                           0737 02538000
*          END;                                            /*@Y30LB39*/ 02539000
*                                                          /*@Y30LB39*/ 02540000
*        /************************************************************/ 02541000
*        /*                                                  @Y30LB39*/ 02542000
*        /*  ISSUE UDUMP MACRO PRIOR TO EXTERNAL CALL        @Y30LB39*/ 02543000
*        /*  TO PROVIDE A FULL REGION DUMP.                  @Y30LB39*/ 02544000
*        /*                                                  @Y30LB39*/ 02545000
*        /************************************************************/ 02546000
*                                                          /*@Y30LB39*/ 02547000
*        IF GDTDBG = NULLPTR                                       0739 02548000
*          THEN;                                                   0739 02549000
@RC00721 L     @08,@PC00001                                        0739 02550000
         L     @08,GDTDBG(,@08)                                    0739 02551000
         LTR   @08,@08                                             0739 02552000
         BZ    @RT00739                                            0739 02553000
*          ELSE                                                    0741 02554000
*            CALL IDCDB010 (GDTTBL,'RVCH');                        0741 02555000
         L     @08,@PC00001                                        0741 02556000
         ST    @08,@AL00001                                        0741 02557000
         LA    @07,@CC01587                                        0741 02558000
         ST    @07,@AL00001+4                                      0741 02559000
         MVI   @AL00001+4,X'80'                                    0741 02560000
         L     @15,GDTDBG(,@08)                                    0741 02561000
         LA    @01,@AL00001                                        0741 02562000
         BALR  @14,@15                                             0741 02563000
*                                                          /*@Y30LB39*/ 02564000
*                                                          /*@Y30LB39*/ 02565000
*        CALL IDCSACL0 (GDTTBL,VOLSERV,SECCHECK,VS1AGL);   /*@Y30LB39*/ 02566000
@RT00739 L     @08,@PC00001                                        0742 02567000
         ST    @08,@AL00001                                        0742 02568000
         LA    @07,@CC01585                                        0742 02569000
         ST    @07,@AL00001+4                                      0742 02570000
         LA    @07,SECCHECK                                        0742 02571000
         ST    @07,@AL00001+8                                      0742 02572000
         LA    @07,VS1AGLBF                                        0742 02573000
         ST    @07,@AL00001+12                                     0742 02574000
         MVI   @AL00001+12,X'80'                                   0742 02575000
         L     @15,GDTCAL(,@08)                                    0742 02576000
         LA    @01,@AL00001                                        0742 02577000
         BALR  @14,@15                                             0742 02578000
*                                                          /*@Y30LB39*/ 02579000
*        RESPECIFY RTNREG RSTD;                                    0743 02580000
*        TESTRC = RTNREG;                                          0744 02581000
         LR    TESTRC,RTNREG                                       0744 02582000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 02583000
*        IF TESTRC ^= 0 THEN                                       0746 02584000
         LTR   TESTRC,TESTRC                                       0746 02585000
         BZ    @RF00746                                            0746 02586000
*          IF TESTRC = 8 THEN                                      0747 02587000
         C     TESTRC,@CF00178                                     0747 02588000
         BNE   @RF00747                                            0747 02589000
*                                                          /*@Y30LB39*/ 02590000
*            /********************************************************/ 02591000
*            /*                                              @Y30LB39*/ 02592000
*            /*  A PASSWORD PROTECTED DATA SET COULD NOT     @Y30LB39*/ 02593000
*            /*  BE CLOSED.                                  @Y30LB39*/ 02594000
*            /*                                              @Y30LB39*/ 02595000
*            /********************************************************/ 02596000
*                                                          /*@Y30LB39*/ 02597000
*            CC04FLG = ON;                                 /*@Y30LB39*/ 02598000
         OI    CC04FLG,B'01000000'                                 0748 02599000
*          ELSE                                                    0749 02600000
*            IF TESTRC = LASTCC04 THEN                             0749 02601000
         B     @RC00747                                            0749 02602000
@RF00747 LA    @08,4                                               0749 02603000
         CR    TESTRC,@08                                          0749 02604000
         BNE   @RF00749                                            0749 02605000
*                                                          /*@Y30LB39*/ 02606000
*              /******************************************************/ 02607000
*              /*                                            @Y30LB39*/ 02608000
*              /*  SECURITY CHECK FAILED                     @Y30LB39*/ 02609000
*              /*                                            @Y30LB39*/ 02610000
*              /******************************************************/ 02611000
*                                                          /*@Y30LB39*/ 02612000
*              VTOCKRC = LASTCC04;                         /*@Y30LB39*/ 02613000
         LR    VTOCKRC,@08                                         0750 02614000
*                                                          /*@Y30LB39*/ 02615000
*        /************************************************************/ 02616000
*        /*                                                  @Y30LB39*/ 02617000
*        /*  ISSUE UCLOSE FOR VTOC IF VSIOP IS NOT ZERO.     @Y30LB39*/ 02618000
*        /*                                                  @Y30LB39*/ 02619000
*        /************************************************************/ 02620000
*                                                          /*@Y30LB39*/ 02621000
*        IF VSIOP ^= NULLPTR THEN                          /*@Y30LB39*/ 02622000
@RF00749 DS    0H                                                  0751 02623000
@RC00747 DS    0H                                                  0751 02624000
@RF00746 LA    @08,VS1AGLBF                                        0751 02625000
         L     @07,VSIOP(,@08)                                     0751 02626000
         LTR   @07,@07                                             0751 02627000
         BZ    @RF00751                                            0751 02628000
*          DO;                                             /*@Y30LB39*/ 02629000
*                                                          /*@Y30LB39*/ 02630000
*            CALL IDCIOCL0 (GDTTBL,VSIOP);                 /*@Y30LB39*/ 02631000
         L     @07,@PC00001                                        0753 02632000
         ST    @07,@AL00001                                        0753 02633000
         LA    @08,VSIOP(,@08)                                     0753 02634000
         ST    @08,@AL00001+4                                      0753 02635000
         MVI   @AL00001+4,X'80'                                    0753 02636000
         L     @15,GDTCLS(,@07)                                    0753 02637000
         LA    @01,@AL00001                                        0753 02638000
         BALR  @14,@15                                             0753 02639000
*                                                          /*@Y30LB39*/ 02640000
*            RESPECIFY RTNREG RSTD;                                0754 02641000
*            TESTRC = RTNREG;                                      0755 02642000
         LR    TESTRC,RTNREG                                       0755 02643000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/ 02644000
*            IF TESTRC ^= 0 THEN                                   0757 02645000
         LTR   TESTRC,TESTRC                                       0757 02646000
         BZ    @RF00757                                            0757 02647000
*              CC04FLG = ON;                               /*@Y30LB39*/ 02648000
         OI    CC04FLG,B'01000000'                                 0758 02649000
*          END;                                            /*@Y30LB39*/ 02650000
@RF00757 DS    0H                                                  0760 02651000
*        IF VTOCKRC ^= 0 THEN                                      0760 02652000
@RF00751 C     VTOCKRC,@CF00114                                    0760 02653000
         BE    @RF00760                                            0760 02654000
*          DO;                                             /*@Y30LB39*/ 02655000
*                                                          /*@Y30LB39*/ 02656000
*          /**********************************************************/ 02657000
*          /*                                                @Y30LB39*/ 02658000
*          /*  IF THE CONDITION CODE IS NOT ZERO,            @Y30LB39*/ 02659000
*          /*  THEN THE COPY OPERATION CANNOT BE PERFORMED.  @Y30LB39*/ 02660000
*          /*  ISSUE UDEQ TO RELEASE THE RESERVE SET BY      @Y30LB39*/ 02661000
*          /*  IDCVS01.                                      @Y30LB39*/ 02662000
*          /*                                                @Y30LB39*/ 02663000
*          /**********************************************************/ 02664000
*                                                          /*@Y30LB39*/ 02665000
*            RNAMCHAR(1:6) = TVOLVAL;                      /*@Y30LB39*/ 02666000
         L     @08,@PC00001+4                                      0762 02667000
         L     @08,FDTPTR+4(,@08)                                  0762 02668000
         MVC   RNAMCHAR(6),TVOLVAL(@08)                            0762 02669000
*            RNAMCHAR(7:22) = '.VIRTUAL.RESERVE';          /*@ZA05138*/ 02670000
         MVC   RNAMCHAR+6(16),@CC01588                             0763 02671000
*            CALL IDCSADQ0 (GDTTBL,'SYSZAMS ',MINORNAM);   /*@Y30LB39*/ 02672000
         L     @08,@PC00001                                        0764 02673000
         ST    @08,@AL00001                                        0764 02674000
         LA    @07,@CC01523                                        0764 02675000
         ST    @07,@AL00001+4                                      0764 02676000
         LA    @07,MINORNAM                                        0764 02677000
         ST    @07,@AL00001+8                                      0764 02678000
         MVI   @AL00001+8,X'80'                                    0764 02679000
         L     @15,GDTDEQ(,@08)                                    0764 02680000
         LA    @01,@AL00001                                        0764 02681000
         BALR  @14,@15                                             0764 02682000
*          END;                                            /*@Y30LB39*/ 02683000
*                                                          /*@Y30LB39*/ 02684000
*        /************************************************************/ 02685000
*        /*                                                  @Y30LB39*/ 02686000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 02687000
*        /*                                                  @Y30LB39*/ 02688000
*        /************************************************************/ 02689000
*                                                          /*@Y30LB39*/ 02690000
*        REG14 = RETADDR2;                                 /*@Y30LB39*/ 02691000
@RF00760 LR    REG14,RETADDR2                                      0766 02692000
*                                                          /*@Y30LB39*/ 02693000
*        /************************************************************/ 02694000
*        /*                                                  @Y30LB39*/ 02695000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 02696000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 02697000
*        /*                                                  @Y30LB39*/ 02698000
*        /************************************************************/ 02699000
*                                                          /*@Y30LB39*/ 02700000
*        RETURN CODE(VTOCKRC);                             /*@Y30LB39*/ 02701000
         LR    @15,VTOCKRC                                         0767 02702000
@EL00008 DS    0H                                                  0767 02703000
@EF00008 DS    0H                                                  0767 02704000
@ER00008 BR    @14                                                 0767 02705000
*END VTOCKRTN;                                             /*@Y30LB39*/ 02706000
*        /************************************************************/ 02707000
*        /*                                                  @Y30LB39*/ 02708000
*        /*  PROCEDURE NAME - COPYRTN                        @Y30LB39*/ 02709000
*        /*                                                  @Y30LB39*/ 02710000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 02711000
*        /*  COPY THE TARGET VOLUME FROM THE SOURCE VOLUME.  @ZD00175*/ 02712000
*        /*  IT OBTAINS EXCLUSIVE CONTROL OF THE UNIT IF     @ZD00175*/ 02713000
*        /*  ALLOCATED.  IT CALLS SUBROUTINE VPREPRTN TO     @ZD00175*/ 02714000
*        /*  DEMOUNT THE TARGET VOLUME AND IF THE RETURN     @ZD00175*/ 02715000
*        /*  CODE IS OKAY, THEN THE COPY PARAMETER LISTS     @ZD00175*/ 02716000
*        /*  ARE FILLED OUT AND THE COPY PERFORMED.          @ZD00175*/ 02717000
*        /*  PROVIDING THAT EVERYTHING GOES OKAY, THEN A     @Y30LB39*/ 02718000
*        /*  MESSAGE IS PRINTED AND SUBROUTINE MVRRTN IS     @Y30LB39*/ 02719000
*        /*  CALLED TO CLEAR THE INCOMPLETE COPY FLAG IN     @Y30LB39*/ 02720000
*        /*  THE INVENTORY.                                  @Y30LB39*/ 02721000
*        /*  IF, AT ANY TIME, A NON-ZERO RETURN CODE IS      @Y30LB39*/ 02722000
*        /*  ENCOUNTERED, THEN CONTROL RETURNS IMMEDIATELY   @Y30LB39*/ 02723000
*        /*  TO THE CALLER OF THIS SUBPROCEDURE.             @Y30LB39*/ 02724000
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGES TO BE @Y30LB39*/ 02725000
*        /*  ISSUED:                                         @Y30LB39*/ 02726000
*        /*    IDC3082I IF UNABLE TO DEMOUNT TARGET VOLUME   @Y30LB39*/ 02727000
*        /*    WHICH IS REQUIRED TO PERFORM COPY.            @Y30LB39*/ 02728000
*        /*    IDC0711I IF COPY WAS SUCCESSFUL               @Y30LB39*/ 02729000
*        /*    IDC3071I IF COPY WAS INCOMPLETE               @Y30LB39*/ 02730000
*        /*    IDC3082I IF COPY NOT STARTED                  @Y30LB39*/ 02731000
*        /*                                                  @Y30LB39*/ 02732000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 02733000
*        /*          RECOVERV TABLE                          @Y30LB39*/ 02734000
*        /*          COPY VOLUME RECORD (COPYV)              @Y30LB39*/ 02735000
*        /*          BUFFER FOR A PRINT ARGUMENT LIST        @Y30LB39*/ 02736000
*        /*          BUFFER FOR COPY PARAMETER LISTS         @Y30LB39*/ 02737000
*        /*          (COPLIST AND COVCE)                     @Y30LB39*/ 02738000
*        /*          BUFFER FOR EXCLUSIVE ARGUMENT LIST      @ZD00175*/ 02739000
*        /*                                                  @Y30LB39*/ 02740000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 02741000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 02742000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 02743000
*        /*      4 - COPY WAS UNSUCCESSFUL.                  @Y30LB39*/ 02744000
*        /*                                                  @Y30LB39*/ 02745000
*        /************************************************************/ 02746000
*                                                                  0769 02747000
*COPYRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                 /*@Y30LB39*/ 02748000
*                                                                  0769 02749000
COPYRTN  DS    0H                                                  0770 02750000
*        /************************************************************/ 02751000
*        /*                                                  @Y30LB39*/ 02752000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 02753000
*        /*                                                  @Y30LB39*/ 02754000
*        /************************************************************/ 02755000
*                                                          /*@Y30LB39*/ 02756000
*        DCL COPYRC FIXED(8);                              /*@Y30LB39*/ 02757000
*                                                          /*@Y30LB39*/ 02758000
*        /************************************************************/ 02759000
*        /*                                                  @Y30LB39*/ 02760000
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/ 02761000
*        /*                                                  @Y30LB39*/ 02762000
*        /************************************************************/ 02763000
*                                                          /*@Y30LB39*/ 02764000
*        RETADDR1 = REG14;                                 /*@Y30LB39*/ 02765000
         ST    REG14,RETADDR1                                      0771 02766000
*                                                          /*@Y30LB39*/ 02767000
*        /************************************************************/ 02768000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 02769000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 02770000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 02771000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 02772000
*        /*                                                  @Y30LB39*/ 02773000
*        /************************************************************/ 02774000
*                                                          /*@Y30LB39*/ 02775000
*        OLDERID2 = NEWERID2;                                      0772 02776000
         L     @04,@PC00001                                        0772 02777000
         L     @04,GDTTR2(,@04)                                    0772 02778000
         MVC   @TS00001(95),NEWERID2(@04)                          0772 02779000
         MVC   OLDERID2(95,@04),@TS00001                           0772 02780000
*        NEWID2 = 'RVCP';                                  /*@Y30LB39*/ 02781000
         MVC   NEWID2(4,@04),@CC01594                              0773 02782000
*                                                          /*@Y30LB39*/ 02783000
*        /************************************************************/ 02784000
*        /*                                                  @Y30LB39*/ 02785000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 02786000
*        /*                                                  @Y30LB39*/ 02787000
*        /************************************************************/ 02788000
*                                                          /*@Y30LB39*/ 02789000
*        COPYRC = LASTCC00;                                /*@Y30LB39*/ 02790000
         SLR   COPYRC,COPYRC                                       0774 02791000
*                                                          /*@Y30LB39*/ 02792000
*        /************************************************************/ 02793000
*        /*                                                  @ZD00175*/ 02794000
*        /* OBTAIN EXCLUSIVE USE OF THE UNIT AND VOLUME MOUNTED      */ 02795000
*        /* ON IT IF A UNIT HAS BEEN ALLOCATED.  IF THE VOLUME LABEL */ 02796000
*        /* NEED NOT BE UPDATED AFTER THE COPY OPERATION, DO NOT GET */ 02797000
*        /* EXCLUSIVE CONTROL IF THE TARGET VOLUME IS NOT ALREADY    */ 02798000
*        /* MOUNTED.                                         @ZD00175*/ 02799000
*        /*                                                  @ZD00175*/ 02800000
*        /************************************************************/ 02801000
*                                                                  0775 02802000
*        IF RUNITDDN^=EIGHTZRO THEN                                0775 02803000
         CLC   RUNITDDN(8),EIGHTZRO                                0775 02804000
         BE    @RF00775                                            0775 02805000
*          DO;                                             /*@ZD00175*/ 02806000
*            EXCLAGL=''B;                                  /*@ZD00175*/ 02807000
         LA    @04,EXCLAGLB                                        0777 02808000
         XC    EXCLAGL(23,@04),EXCLAGL(@04)                        0777 02809000
*            EXCLUCBP=ADDR(RUNITUCB);                      /*@ZD00175*/ 02810000
         LA    @15,RUNITUCB                                        0778 02811000
         ST    @15,EXCLUCBP(,@04)                                  0778 02812000
*            EXCLDDP=ADDR(RUNITDDN);                       /*@ZD00175*/ 02813000
         LA    @15,RUNITDDN                                        0779 02814000
         ST    @15,EXCLDDP(,@04)                                   0779 02815000
*            EXCLVOL=TVOLVAL;                              /*@ZD00175*/ 02816000
*                                                                  0780 02817000
         L     @15,@PC00001+4                                      0780 02818000
         L     @14,FDTPTR+4(,@15)                                  0780 02819000
         MVC   EXCLVOL(6,@04),TVOLVAL(@14)                         0780 02820000
*            IF COPOWNER^=BASOWNER|TVOLVAL^=FVOLVAL THEN           0781 02821000
         CLC   COPOWNER(10,COPYVPTR),BASOWNER(BASEVPTR)            0781 02822000
         BNE   @RT00781                                            0781 02823000
         L     @04,FDTPTR(,@15)                                    0781 02824000
         CLC   TVOLVAL(6,@14),FVOLVAL(@04)                         0781 02825000
         BE    @RF00781                                            0781 02826000
@RT00781 DS    0H                                                  0782 02827000
*              EXCLMNT=OFF;                                /*@ZD00175*/ 02828000
         LA    @04,EXCLAGLB                                        0782 02829000
         NI    EXCLMNT(@04),B'01111111'                            0782 02830000
*            ELSE                                                  0783 02831000
*              EXCLMNT=ON;                                 /*@ZD00175*/ 02832000
*                                                                  0783 02833000
         B     @RC00781                                            0783 02834000
@RF00781 LA    @04,EXCLAGLB                                        0783 02835000
         OI    EXCLMNT(@04),B'10000000'                            0783 02836000
*            /********************************************************/ 02837000
*            /*                                              @ZD00175*/ 02838000
*            /* TAKE A FULL REGION DUMP PRIOR TO THE EXTERNAL CALL   */ 02839000
*            /* TO IDCSA06.                                  @ZD00175*/ 02840000
*            /*                                              @ZD00175*/ 02841000
*            /********************************************************/ 02842000
*                                                                  0784 02843000
*            IF GDTDBG = NULLPTR                                   0784 02844000
*              THEN;                                               0784 02845000
@RC00781 L     @04,@PC00001                                        0784 02846000
         L     @04,GDTDBG(,@04)                                    0784 02847000
         LTR   @04,@04                                             0784 02848000
         BZ    @RT00784                                            0784 02849000
*              ELSE                                                0786 02850000
*                CALL IDCDB010(GDTTBL,'RVHH');                     0786 02851000
         L     @04,@PC00001                                        0786 02852000
         ST    @04,@AL00001                                        0786 02853000
         LA    @15,@CC01595                                        0786 02854000
         ST    @15,@AL00001+4                                      0786 02855000
         MVI   @AL00001+4,X'80'                                    0786 02856000
         L     @15,GDTDBG(,@04)                                    0786 02857000
         LA    @01,@AL00001                                        0786 02858000
         BALR  @14,@15                                             0786 02859000
*                                                          /*@ZD00175*/ 02860000
*                                                                  0787 02861000
*            CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);        /*@ZD00175*/ 02862000
@RT00784 L     @04,@PC00001                                        0787 02863000
         ST    @04,@AL00001                                        0787 02864000
         LA    @02,CHANGEX                                         0787 02865000
         ST    @02,@AL00001+4                                      0787 02866000
         LA    @02,EXCLAGLB                                        0787 02867000
         ST    @02,@AL00001+8                                      0787 02868000
         MVI   @AL00001+8,X'80'                                    0787 02869000
         L     @15,GDTUNT(,@04)                                    0787 02870000
         LA    @01,@AL00001                                        0787 02871000
         BALR  @14,@15                                             0787 02872000
*            RESPECIFY RTNREG RSTD;                                0788 02873000
*            TESTRC = RTNREG;                                      0789 02874000
         LR    TESTRC,RTNREG                                       0789 02875000
*            RESPECIFY RTNREG UNRSTD;                      /*@ZD00175*/ 02876000
*                                                                  0790 02877000
*            /********************************************************/ 02878000
*            /*                                              @ZD00175*/ 02879000
*            /* IF THE REQUEST TO CHANGE VOLUME ALLOCATION FROM      */ 02880000
*            /* SHARED TO EXCLUSIVE FAILED, RETURN TO THE CALLER AND */ 02881000
*            /* DO NOT PERFORM THE COPY.                     @ZD00175*/ 02882000
*            /*                                              @ZD00175*/ 02883000
*            /********************************************************/ 02884000
*                                                                  0791 02885000
*            IF TESTRC^=0 THEN                                     0791 02886000
         LTR   TESTRC,TESTRC                                       0791 02887000
         BZ    @RF00791                                            0791 02888000
*              COPYRC=LASTCC04;                            /*@ZD00175*/ 02889000
*                                                                  0792 02890000
         LA    COPYRC,4                                            0792 02891000
*            /********************************************************/ 02892000
*            /*                                              @ZD00175*/ 02893000
*            /*  THE TARGET VOLUME MAY BE MOUNTED ON THE     @ZD00175*/ 02894000
*            /*  UNIT.  CALL VPREPRTN TO DEMOUNT THE TARGET  @ZD00175*/ 02895000
*            /*  VOLUME AND CLEAR THE RESERVE SET BY IDCVS01 @ZD00175*/ 02896000
*            /*  BEFORE THE COPY OPERATION IS STARTED.       @ZD00175*/ 02897000
*            /*                                              @ZD00175*/ 02898000
*            /********************************************************/ 02899000
*                                                          /*@Y30LB39*/ 02900000
*            ELSE                                                  0793 02901000
*              DO;                                         /*@ZD00175*/ 02902000
         B     @RC00791                                            0793 02903000
@RF00791 DS    0H                                                  0794 02904000
*                MOUNTFLG = OFF;                           /*@ZD00175*/ 02905000
*                WAITFLG = ON;                             /*@ZD00175*/ 02906000
*                DEMNTFLG = ON;                            /*@ZD00175*/ 02907000
         OI    WAITFLG,B'00010100'                                 0796 02908000
         NI    MOUNTFLG,B'11011111'                                0796 02909000
*                CALL VPREPRTN;                            /*@ZD00175*/ 02910000
         BAL   @14,VPREPRTN                                        0797 02911000
*                RESPECIFY RTNREG RSTD;                            0798 02912000
*                TESTRC = RTNREG;                                  0799 02913000
         LR    TESTRC,RTNREG                                       0799 02914000
*                RESPECIFY RTNREG UNRSTD;                  /*@ZD00175*/ 02915000
*                                                          /*@Y30LB39*/ 02916000
*                /****************************************************/ 02917000
*                /*                                          @ZD00175*/ 02918000
*                /*  IF THE RETURN CODE FROM VPREPRTN IS     @ZD00175*/ 02919000
*                /*  NOT ZERO, THEN SET THE CONDITION CODE   @ZD00175*/ 02920000
*                /*  TO FOUR.                                @ZD00175*/ 02921000
*                /*                                          @ZD00175*/ 02922000
*                /****************************************************/ 02923000
*                                                          /*@Y30LB39*/ 02924000
*                IF TESTRC ^= 0 THEN                               0801 02925000
         LTR   TESTRC,TESTRC                                       0801 02926000
         BZ    @RF00801                                            0801 02927000
*                  COPYRC = LASTCC04;                      /*@ZD00175*/ 02928000
*                                                                  0802 02929000
         LA    COPYRC,4                                            0802 02930000
*                END;                                      /*@ZD00175*/ 02931000
*                                                                  0803 02932000
@RF00801 DS    0H                                                  0804 02933000
*            /********************************************************/ 02934000
*            /*                                              @ZD00175*/ 02935000
*            /* RETURN TO THE CALLER IF ALLOCATION OR DEMOUNT ERROR. */ 02936000
*            /* ISSUE MSG IDC3082I AND EXIT VIA THE LAST STEP IN     */ 02937000
*            /* THIS SUBROUTINE.                             @ZD00175*/ 02938000
*            /*                                              @ZD00175*/ 02939000
*            /********************************************************/ 02940000
*                                                                  0804 02941000
*            IF COPYRC^=0 THEN                                     0804 02942000
@RC00791 C     COPYRC,@CF00114                                     0804 02943000
         BE    @RF00804                                            0804 02944000
*              DO;                                         /*@ZD00175*/ 02945000
*                DARGLIST = ''B;                           /*@Y30LB39*/ 02946000
         L     @04,DDSTRU                                          0806 02947000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0806 02948000
*                DARGSMOD = COMNMSG;                       /*@Y30LB39*/ 02949000
         MVC   DARGSMOD(3,@04),@CC01460                            0807 02950000
*                DARGSENT = MSG3082I;                      /*@Y30LB39*/ 02951000
         MVI   DARGSENT(@04),X'18'                                 0808 02952000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/ 02953000
         L     @04,@PC00001                                        0809 02954000
         ST    @04,@AL00001                                        0809 02955000
         LA    @15,@CF00114                                        0809 02956000
         ST    @15,@AL00001+4                                      0809 02957000
         LA    @15,DDSTRU                                          0809 02958000
         ST    @15,@AL00001+8                                      0809 02959000
         MVI   @AL00001+8,X'80'                                    0809 02960000
         L     @15,GDTPRT(,@04)                                    0809 02961000
         LA    @01,@AL00001                                        0809 02962000
         BALR  @14,@15                                             0809 02963000
*              END;                                        /*@Y30LB39*/ 02964000
*        END;                                              /*@ZD00175*/ 02965000
@RF00804 DS    0H                                                  0812 02966000
*        IF COPYRC = 0 THEN                                        0812 02967000
@RF00775 SLR   @04,@04                                             0812 02968000
         CR    COPYRC,@04                                          0812 02969000
         BNE   @RF00812                                            0812 02970000
*          DO;                                             /*@Y30LB39*/ 02971000
*                                                          /*@Y30LB39*/ 02972000
*            /********************************************************/ 02973000
*            /*                                              @Y30LB39*/ 02974000
*            /*  INITIALIZE THE MSVC COVCE PARAMETER LIST    @Y30LB39*/ 02975000
*            /*  TAKING SPECIAL CARE TO INSURE THAT THE      @Y30LB39*/ 02976000
*            /*  CORRECT RECOVER FLAGS ARE SET ON.           @Y30LB39*/ 02977000
*            /*                                              @Y30LB39*/ 02978000
*            /********************************************************/ 02979000
*                                                          /*@Y30LB39*/ 02980000
*            COVCE = ''B;                                  /*@Y30LB39*/ 02981000
         L     @15,COVCEPTR                                        0814 02982000
         XC    COVCE(43,@15),COVCE(@15)                            0814 02983000
*            COVLNGTH = COVLEN;                            /*@Y30LB39*/ 02984000
         LH    @14,COVLEN                                          0815 02985000
         ST    @14,COVLNGTH(,@15)                                  0815 02986000
*            COVSRCVY = ON;                                /*@Y30LB39*/ 02987000
         OI    COVSRCVY(@15),B'10000000'                           0816 02988000
*            COVICOPY = ON;                                /*@Y30LB39*/ 02989000
         OI    COVICOPY(@15),B'10000000'                           0817 02990000
*                                                          /*@Y30LB39*/ 02991000
*            /********************************************************/ 02992000
*            /*                                              @Y30LB39*/ 02993000
*            /*  INITIALIZE THE MSSC COVLIST PARAMETER LIST  @Y30LB39*/ 02994000
*            /*                                              @Y30LB39*/ 02995000
*            /********************************************************/ 02996000
*                                                          /*@Y30LB39*/ 02997000
*            COVLIST = ''B;                                /*@Y30LB39*/ 02998000
         L     @14,COVCPTR                                         0818 02999000
         XC    COVLIST(40,@14),COVLIST(@14)                        0818 03000000
*            CVOCRCRV = ON;                                /*@Y30LB39*/ 03001000
         OI    CVOCRCRV(@14),B'00010000'                           0819 03002000
*            CVOLID = TVOLVAL;                             /*@Y30LB39*/ 03003000
         L     @09,@PC00001+4                                      0820 03004000
         L     @01,FDTPTR+4(,@09)                                  0820 03005000
         MVC   CVOLID(6,@14),TVOLVAL(@01)                          0820 03006000
*            CVOLCSN = COPCSN1;                            /*@Y30LB39*/ 03007000
         MVC   CVOLCSN(12,@14),COPCSN1(COPYVPTR)                   0821 03008000
*            CVOLVEXT = COVCEPTR;                          /*@Y30LB39*/ 03009000
         ST    @15,CVOLVEXT(,@14)                                  0822 03010000
*                                                          /*@Y30LB39*/ 03011000
*            /********************************************************/ 03012000
*            /*                                              @Y30LB39*/ 03013000
*            /*  ISSUE USSC MACRO TO COPY THE SOURCE VOLUME  @Y30LB39*/ 03014000
*            /*  TO AN ACTIVE COPY VOLUME AFTER DUMPING      @Y30LB39*/ 03015000
*            /*  PARAMETER LISTS.                            @Y30LB39*/ 03016000
*            /*                                              @Y30LB39*/ 03017000
*            /********************************************************/ 03018000
*                                                          /*@Y30LB39*/ 03019000
*                                                                  0823 03020000
*              IF GDTDBG = NULLPTR                                 0823 03021000
*                THEN;                                             0823 03022000
         L     @15,@PC00001                                        0823 03023000
         C     @04,GDTDBG(,@15)                                    0823 03024000
         BE    @RT00823                                            0823 03025000
*                ELSE                                              0825 03026000
*                  DO;                                             0825 03027000
*                    DMPINDEX = ADDR(DUMPLIST);                    /*@Y 03028000
*0LB39*/                                                           0826 03029000
*                                                                  0826 03030000
         LA    DMPINDEX,DUMPLIST                                   0826 03031000
*                    DMPITMNM = 'COVLISTB';                        0827 03032000
         MVC   DMPITMNM(8,DMPINDEX),@CC01596                       0827 03033000
*                    DMPITMPT = ADDR(COVLISTB);                    0828 03034000
         LA    @04,COVLISTB                                        0828 03035000
         ST    @04,DMPITMPT(,DMPINDEX)                             0828 03036000
*                    DMPITMLN = LENGTH(COVLISTB);                  0829 03037000
         MVC   DMPITMLN(2,DMPINDEX),@CH01652                       0829 03038000
*                    DMPITMTP = 'H';                               0830 03039000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0830 03040000
*                    DMPINDEX = DMPINDEX + DMPELEMT;               0831 03041000
*                                                                  0831 03042000
         LA    @04,16                                              0831 03043000
         ALR   DMPINDEX,@04                                        0831 03044000
*                    DMPITMNM = 'COVCEBUF';                        0832 03045000
         MVC   DMPITMNM(8,DMPINDEX),@CC01597                       0832 03046000
*                    DMPITMPT = ADDR(COVCEBUF);                    0833 03047000
         LA    @03,COVCEBUF                                        0833 03048000
         ST    @03,DMPITMPT(,DMPINDEX)                             0833 03049000
*                    DMPITMLN = LENGTH(COVCEBUF);                  0834 03050000
         MVC   DMPITMLN(2,DMPINDEX),@CH01503                       0834 03051000
*                    DMPITMTP = 'H';                               0835 03052000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0835 03053000
*                    DMPINDEX = DMPINDEX + DMPELEMT;               0836 03054000
*                                                                  0836 03055000
         ALR   DMPINDEX,@04                                        0836 03056000
*                    DMPTRM = DMPTRMVL;                            0837 03057000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0837 03058000
*                  END;                                     /*@Y30LB39* 03059000
*                                                          /*@Y30LB39*/ 03060000
*            IF GDTDBG = NULLPTR                                   0839 03061000
*              THEN;                                               0839 03062000
@RT00823 L     @04,@PC00001                                        0839 03063000
         L     @04,GDTDBG(,@04)                                    0839 03064000
         LTR   @04,@04                                             0839 03065000
         BZ    @RT00839                                            0839 03066000
*              ELSE                                                0841 03067000
*                CALL IDCDB010 (GDTTBL,'RVEE',ADDR(DUMPLIST));     0841 03068000
         L     @04,@PC00001                                        0841 03069000
         ST    @04,@AL00001                                        0841 03070000
         LA    @15,@CC01598                                        0841 03071000
         ST    @15,@AL00001+4                                      0841 03072000
         LA    @15,DUMPLIST                                        0841 03073000
         ST    @15,@AFTEMPS+8                                      0841 03074000
         LA    @15,@AFTEMPS+8                                      0841 03075000
         ST    @15,@AL00001+8                                      0841 03076000
         MVI   @AL00001+8,X'80'                                    0841 03077000
         L     @15,GDTDBG(,@04)                                    0841 03078000
         LA    @01,@AL00001                                        0841 03079000
         BALR  @14,@15                                             0841 03080000
*                                                          /*@Y30LB39*/ 03081000
*                                                          /*@Y30LB39*/ 03082000
*            CALL IDCSASS0 (GDTTBL,COPYVOL,COVCPTR,REASON,ECBBYTE);/*   03083000
*                                                            @Y30LB39*/ 03084000
@RT00839 L     @04,@PC00001                                        0842 03085000
         ST    @04,@AL00001                                        0842 03086000
         LA    @02,COPYVOL                                         0842 03087000
         ST    @02,@AL00001+4                                      0842 03088000
         LA    @02,COVCPTR                                         0842 03089000
         ST    @02,@AL00001+8                                      0842 03090000
         LA    @02,REASON                                          0842 03091000
         ST    @02,@AL00001+12                                     0842 03092000
         LA    @02,ECBBYTE                                         0842 03093000
         ST    @02,@AL00001+16                                     0842 03094000
         MVI   @AL00001+16,X'80'                                   0842 03095000
         L     @15,GDTSSC(,@04)                                    0842 03096000
         LA    @01,@AL00001                                        0842 03097000
         BALR  @14,@15                                             0842 03098000
*                                                          /*@Y30LB39*/ 03099000
*            RESPECIFY RTNREG RSTD;                                0843 03100000
*            TESTRC = RTNREG;                                      0844 03101000
         LR    TESTRC,RTNREG                                       0844 03102000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/ 03103000
*                                                          /*@Y30LB39*/ 03104000
*            /********************************************************/ 03105000
*            /*                                              @Y30LB39*/ 03106000
*            /*  IF MSVC RETURNS A RETURN CODE OF TWELVE,    @Y30LB39*/ 03107000
*            /*  IT MEANS THE FUNCTION WAS COMPLETED BUT AN  @Y30LB39*/ 03108000
*            /*  I-O ERROR PREVENTED THE UPDATING OF THE     @Y30LB39*/ 03109000
*            /*  MSV INVENTORY.  THIS RETURN CODE SHOULD BE  @Y30LB39*/ 03110000
*            /*  TREATED AS A RETURN CODE OF ZERO, EXCEPT    @Y30LB39*/ 03111000
*            /*  THAT THE FINAL CODE TO THE EXECUTIVE        @Y30LB39*/ 03112000
*            /*  SHOULD BE AT LEAST FOUR.  THAT IS THE       @Y30LB39*/ 03113000
*            /*  REASON FOR SETTING CC04FLG ON.              @Y30LB39*/ 03114000
*            /*                                              @Y30LB39*/ 03115000
*            /********************************************************/ 03116000
*                                                          /*@Y30LB39*/ 03117000
*            IF TESTRC = 12 THEN                           /*@Y30LB39*/ 03118000
         C     TESTRC,@CF00567                                     0846 03119000
         BNE   @RF00846                                            0846 03120000
*              DO;                                         /*@Y30LB39*/ 03121000
*                TESTRC = LASTCC00;                        /*@Y30LB39*/ 03122000
         SLR   TESTRC,TESTRC                                       0848 03123000
*                CC04FLG = ON;                             /*@Y30LB39*/ 03124000
         OI    CC04FLG,B'01000000'                                 0849 03125000
*              END;                                        /*@Y30LB39*/ 03126000
*                                                          /*@Y30LB39*/ 03127000
*            /********************************************************/ 03128000
*            /*                                              @Y30LB39*/ 03129000
*            /*  IF RETURN CODE IS ZERO, ISSUE MESSAGE       @Y30LB39*/ 03130000
*            /*  IDC0711I TO ADVISE OF SUCCESSFUL COPY.      @Y30LB39*/ 03131000
*            /*  INSERT IN THE MESSAGE BOTH THE SOURCE       @Y30LB39*/ 03132000
*            /*  AND TARGET VOLSERS AND THE COPY DATE        @Y30LB39*/ 03133000
*            /*  FROM THE COPY RECORD.                       @Y30LB39*/ 03134000
*            /*                                              @Y30LB39*/ 03135000
*            /********************************************************/ 03136000
*                                                          /*@Y30LB39*/ 03137000
*            IF TESTRC = 0 THEN                                    0851 03138000
@RF00846 LTR   TESTRC,TESTRC                                       0851 03139000
         BNZ   @RF00851                                            0851 03140000
*              DO;                                         /*@Y30LB39*/ 03141000
*                DARGLIST = ''B;                           /*@Y30LB39*/ 03142000
         L     @04,DDSTRU                                          0853 03143000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0853 03144000
*                DARGSMOD = RECVMSG;                       /*@Y30LB39*/ 03145000
         MVC   DARGSMOD(3,@04),@CC01458                            0854 03146000
*                DARGSENT = MSG0711I;                      /*@Y30LB39*/ 03147000
         MVI   DARGSENT(@04),X'02'                                 0855 03148000
*                DARGDBP = ADDR(TVOLVAL);                  /*@Y30LB39*/ 03149000
         L     @15,@PC00001+4                                      0856 03150000
         L     @14,FDTPTR+4(,@15)                                  0856 03151000
         LA    @09,TVOLVAL(,@14)                                   0856 03152000
         ST    @09,DARGDBP(,@04)                                   0856 03153000
*                DARGILP = TVOLLEN;                        /*@Y30LB39*/ 03154000
         SLR   @09,@09                                             0857 03155000
         IC    @09,TVOLLEN(,@14)                                   0857 03156000
         STH   @09,DARGILP(,@04)                                   0857 03157000
*                DARGCNT = 2;                              /*@Y30LB39*/ 03158000
         LA    @14,2                                               0858 03159000
         STH   @14,DARGCNT(,@04)                                   0858 03160000
*                DARGINS(1) = 1;                           /*@Y30LB39*/ 03161000
         MVC   DARGINS(2,@04),@CH00218                             0859 03162000
*                DARGINL(1) = FVOLLEN;                     /*@Y30LB39*/ 03163000
         L     @15,FDTPTR(,@15)                                    0860 03164000
         SLR   @09,@09                                             0860 03165000
         IC    @09,FVOLLEN(,@15)                                   0860 03166000
         STH   @09,DARGINL(,@04)                                   0860 03167000
*                DARGDTM(1) = ADDR(FVOLVAL);               /*@Y30LB39*/ 03168000
         LA    @15,FVOLVAL(,@15)                                   0861 03169000
         ST    @15,DARGDTM(,@04)                                   0861 03170000
*                DARGINS(2) = 2;                           /*@Y30LB39*/ 03171000
         STH   @14,DARGINS+8(,@04)                                 0862 03172000
*                DARGINL(2) = LENGTH(COPDATE);             /*@Y30LB39*/ 03173000
         MVC   DARGINL+8(2,@04),@CH00041                           0863 03174000
*                DARGDTM(2) = ADDR(COPDATE);               /*@Y30LB39*/ 03175000
         LA    @15,COPDATE(,COPYVPTR)                              0864 03176000
         ST    @15,DARGDTM+8(,@04)                                 0864 03177000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/ 03178000
         L     @04,@PC00001                                        0865 03179000
         ST    @04,@AL00001                                        0865 03180000
         LA    @15,@CF00114                                        0865 03181000
         ST    @15,@AL00001+4                                      0865 03182000
         LA    @15,DDSTRU                                          0865 03183000
         ST    @15,@AL00001+8                                      0865 03184000
         MVI   @AL00001+8,X'80'                                    0865 03185000
         L     @15,GDTPRT(,@04)                                    0865 03186000
         LA    @01,@AL00001                                        0865 03187000
         BALR  @14,@15                                             0865 03188000
*              END;                                        /*@Y30LB39*/ 03189000
*                                                          /*@Y30LB39*/ 03190000
*            /********************************************************/ 03191000
*            /*                                              @Y30LB39*/ 03192000
*            /*  RETURN CODE FROM USSC WAS NOT ZERO          @Y30LB39*/ 03193000
*            /*                                              @Y30LB39*/ 03194000
*            /********************************************************/ 03195000
*                                                          /*@Y30LB39*/ 03196000
*            ELSE                                          /*@Y30LB39*/ 03197000
*              DO;                                         /*@Y30LB39*/ 03198000
         B     @RC00851                                            0867 03199000
@RF00851 DS    0H                                                  0868 03200000
*                                                          /*@Y30LB39*/ 03201000
*                /****************************************************/ 03202000
*                /*                                          @Y30LB39*/ 03203000
*                /*  SET THE CONDITION CODE TO FOUR.         @Y30LB39*/ 03204000
*                /*                                          @Y30LB39*/ 03205000
*                /****************************************************/ 03206000
*                                                          /*@Y30LB39*/ 03207000
*                COPYRC = LASTCC04;                        /*@Y30LB39*/ 03208000
         LA    @04,4                                               0868 03209000
         LR    COPYRC,@04                                          0868 03210000
*                                                          /*@Y30LB39*/ 03211000
*                /****************************************************/ 03212000
*                /*                                          @Y30LB39*/ 03213000
*                /*  CALL SSCMSG TO OUTPUT APPROPRIATE REASON@Y30LB39*/ 03214000
*                /*  CODE MESSAGE IF USSC CODE IS FOUR,      @Y30LB39*/ 03215000
*                /*  WHICH INDICATES MSC COPY ORDER FAILED.  @Y30LB39*/ 03216000
*                /*                                          @Y30LB39*/ 03217000
*                /****************************************************/ 03218000
*                                                          /*@Y30LB39*/ 03219000
*                IF TESTRC = LASTCC04 THEN                 /*@Y30LB39*/ 03220000
         CR    TESTRC,@04                                          0869 03221000
         BNE   @RF00869                                            0869 03222000
*                  CALL SSCMSG (REASON,ECBBYTE);           /*@Y30LB39*/ 03223000
         LA    @04,REASON                                          0870 03224000
         ST    @04,@AL00001                                        0870 03225000
         LA    @04,ECBBYTE                                         0870 03226000
         ST    @04,@AL00001+4                                      0870 03227000
         LA    @01,@AL00001                                        0870 03228000
         BAL   @14,SSCMSG                                          0870 03229000
*                DARGLIST = ''B;                           /*@Y30LB39*/ 03230000
@RF00869 L     @04,DDSTRU                                          0871 03231000
         XC    DARGLIST(20,@04),DARGLIST(@04)                      0871 03232000
*                DARGSMOD = COMNMSG;                       /*@Y30LB39*/ 03233000
         MVC   DARGSMOD(3,@04),@CC01460                            0872 03234000
*                IF ECBBYTE = ONEZERO THEN                         0873 03235000
         CLC   ECBBYTE(1),ONEZERO                                  0873 03236000
         BNE   @RF00873                                            0873 03237000
*                  DARGSENT = MSG3082I;                    /*@Y30LB39*/ 03238000
         MVI   DARGSENT(@04),X'18'                                 0874 03239000
*                ELSE                                              0875 03240000
*                  DARGSENT = MSG3071I;                    /*@Y30LB39*/ 03241000
         B     @RC00873                                            0875 03242000
@RF00873 L     @04,DDSTRU                                          0875 03243000
         MVI   DARGSENT(@04),X'23'                                 0875 03244000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/ 03245000
@RC00873 L     @04,@PC00001                                        0876 03246000
         ST    @04,@AL00001                                        0876 03247000
         LA    @15,@CF00114                                        0876 03248000
         ST    @15,@AL00001+4                                      0876 03249000
         LA    @15,DDSTRU                                          0876 03250000
         ST    @15,@AL00001+8                                      0876 03251000
         MVI   @AL00001+8,X'80'                                    0876 03252000
         L     @15,GDTPRT(,@04)                                    0876 03253000
         LA    @01,@AL00001                                        0876 03254000
         BALR  @14,@15                                             0876 03255000
*              END;                                        /*@Y30LB39*/ 03256000
*            IF COPYRC = 0 THEN                            /*@Y30LB39*/ 03257000
@RC00851 C     COPYRC,@CF00114                                     0878 03258000
         BNE   @RF00878                                            0878 03259000
*                                                          /*@Y30LB39*/ 03260000
*              /******************************************************/ 03261000
*              /*                                            @Y30LB39*/ 03262000
*              /*  IF SOURCE AND TARGET VOLUME SERIAL        @Y30LB39*/ 03263000
*              /*  NUMBERS ARE THE SAME, CALL MVRRTN         @Y30LB39*/ 03264000
*              /*  TO CLEAR THE INCOMPLETE-COPY FLAG FROM    @Y30LB39*/ 03265000
*              /*  THE INVENTORY.                            @Y30LB39*/ 03266000
*              /*                                            @Y30LB39*/ 03267000
*              /******************************************************/ 03268000
*                                                          /*@Y30LB39*/ 03269000
*              IF TVOLVAL = FVOLVAL THEN                   /*@Y30LB39*/ 03270000
         L     @04,@PC00001+4                                      0879 03271000
         L     @01,FDTPTR+4(,@04)                                  0879 03272000
         L     @04,FDTPTR(,@04)                                    0879 03273000
         CLC   TVOLVAL(6,@01),FVOLVAL(@04)                         0879 03274000
         BNE   @RF00879                                            0879 03275000
*                DO;                                       /*@Y30LB39*/ 03276000
*                  CALL MVRRTN;                            /*@Y30LB39*/ 03277000
         BAL   @14,MVRRTN                                          0881 03278000
*                  RESPECIFY RTNREG RSTD;                          0882 03279000
*                  TESTRC = RTNREG;                                0883 03280000
         LR    TESTRC,RTNREG                                       0883 03281000
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30LB39*/ 03282000
*                  IF TESTRC ^= 0 THEN                             0885 03283000
         LTR   TESTRC,TESTRC                                       0885 03284000
         BZ    @RF00885                                            0885 03285000
*                    COPYRC = LASTCC04;                    /*@Y30LB39*/ 03286000
         LA    COPYRC,4                                            0886 03287000
*                END;                                      /*@Y30LB39*/ 03288000
@RF00885 DS    0H                                                  0888 03289000
*          END;                                            /*@Y30LB39*/ 03290000
@RF00879 DS    0H                                                  0888 03291000
@RF00878 DS    0H                                                  0889 03292000
*                                                          /*@Y30LB39*/ 03293000
*        /************************************************************/ 03294000
*        /*                                                  @Y30LB39*/ 03295000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 03296000
*        /*                                                  @Y30LB39*/ 03297000
*        /************************************************************/ 03298000
*                                                          /*@Y30LB39*/ 03299000
*        REG14 = RETADDR1;                                 /*@Y30LB39*/ 03300000
@RF00812 L     REG14,RETADDR1                                      0889 03301000
*                                                          /*@Y30LB39*/ 03302000
*        /************************************************************/ 03303000
*        /*                                                  @Y30LB39*/ 03304000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 03305000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 03306000
*        /*                                                  @Y30LB39*/ 03307000
*        /************************************************************/ 03308000
*                                                          /*@Y30LB39*/ 03309000
*        RETURN CODE(COPYRC);                              /*@Y30LB39*/ 03310000
         LR    @15,COPYRC                                          0890 03311000
@EL00009 DS    0H                                                  0890 03312000
@EF00009 DS    0H                                                  0890 03313000
@ER00009 BR    @14                                                 0890 03314000
*END COPYRTN;                                              /*@Y30LB39*/ 03315000
*        /************************************************************/ 03316000
*        /*                                                  @Y30LB39*/ 03317000
*        /*  PROCEDURE NAME - VPREPRTN                       @Y30LB39*/ 03318000
*        /*                                                  @Y30LB39*/ 03319000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 03320000
*        /*  MOUNT OR DEMOUNT THE TARGET VOLUME.             @Y30LB39*/ 03321000
*        /*  THE DETERMINATION AS TO WHICH OF THESE IS       @Y30LB39*/ 03322000
*        /*  TO BE DONE HAS BEEN MADE BEFORE THIS SUB-       @Y30LB39*/ 03323000
*        /*  ROUTINE IS CALLED.  THIS ROUTINE MERELY         @Y30LB39*/ 03324000
*        /*  EXAMINES AN INTERNAL FLAG AND PROCEEDS TO       @Y30LB39*/ 03325000
*        /*  FILL OUT THE PARAMETER LIST AND ISSUE THE       @Y30LB39*/ 03326000
*        /*  REQUEST ACCORDING TO THE SETTING OF THAT        @Y30LB39*/ 03327000
*        /*  INTERNAL FLAG.                                  @Y30LB39*/ 03328000
*        /*                                                  @Y30LB39*/ 03329000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 03330000
*        /*          RECOVERV TABLE                          @Y30LB39*/ 03331000
*        /*          BUFFER FOR MOUNT OR DEMOUNT PARM LIST   @Y30LB39*/ 03332000
*        /*                                                  @Y30LB39*/ 03333000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 03334000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 03335000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 03336000
*        /*      4 - IF UMSSUNIT MACRO RETURNS A NON-ZERO    @Y30LB39*/ 03337000
*        /*          RETURN CODE.                            @Y30LB39*/ 03338000
*        /*                                                  @Y30LB39*/ 03339000
*        /************************************************************/ 03340000
*                                                                  0892 03341000
*VPREPRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/ 03342000
*                                                                  0892 03343000
VPREPRTN DS    0H                                                  0893 03344000
*        /************************************************************/ 03345000
*        /*                                                  @Y30LB39*/ 03346000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 03347000
*        /*                                                  @Y30LB39*/ 03348000
*        /************************************************************/ 03349000
*                                                          /*@Y30LB39*/ 03350000
*        DCL VPREPRC FIXED(8);         /* RETURN CODE        @Y30LB39*/ 03351000
*                                                          /*@Y30LB39*/ 03352000
*        /************************************************************/ 03353000
*        /*                                                  @Y30LB39*/ 03354000
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/ 03355000
*        /*                                                  @Y30LB39*/ 03356000
*        /************************************************************/ 03357000
*                                                          /*@Y30LB39*/ 03358000
*        RETADDR2 = REG14;                                 /*@Y30LB39*/ 03359000
         LR    RETADDR2,REG14                                      0894 03360000
*                                                          /*@Y30LB39*/ 03361000
*        /************************************************************/ 03362000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 03363000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 03364000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 03365000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 03366000
*        /*                                                  @Y30LB39*/ 03367000
*        /************************************************************/ 03368000
*                                                          /*@Y30LB39*/ 03369000
*        OLDERID2 = NEWERID2;                                      0895 03370000
         L     @15,@PC00001                                        0895 03371000
         L     @14,GDTTR2(,@15)                                    0895 03372000
         MVC   @TS00001(95),NEWERID2(@14)                          0895 03373000
         MVC   OLDERID2(95,@14),@TS00001                           0895 03374000
*        NEWID2 = 'RVVP';                                  /*@Y30LB39*/ 03375000
         MVC   NEWID2(4,@14),@CC01604                              0896 03376000
*                                                          /*@Y30LB39*/ 03377000
*        /************************************************************/ 03378000
*        /*                                                  @Y30LB39*/ 03379000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 03380000
*        /*                                                  @Y30LB39*/ 03381000
*        /************************************************************/ 03382000
*                                                          /*@Y30LB39*/ 03383000
*        VPREPRC = LASTCC00;                               /*@Y30LB39*/ 03384000
         SLR   VPREPRC,VPREPRC                                     0897 03385000
*                                                          /*@ZA05125*/ 03386000
*        /************************************************************/ 03387000
*        /*                                                  @ZA05125*/ 03388000
*        /*  IF MOUNTFLG IS OFF, A VOLUME DEMOUNT WAS        @ZA05125*/ 03389000
*        /*  REQUESTED, SO ISSUE DEQUEUE TO RELEASE THE      @ZA05125*/ 03390000
*        /*  RESERVE SET BY IDCVS01 FOR THE VTOC CHECK.      @ZA05125*/ 03391000
*        /*                                                  @ZA05125*/ 03392000
*        /************************************************************/ 03393000
*                                                          /*@ZA05125*/ 03394000
*        IF MOUNTFLG = OFF THEN                            /*@ZA05125*/ 03395000
         TM    MOUNTFLG,B'00100000'                                0898 03396000
         BNZ   @RF00898                                            0898 03397000
*          DO;                                             /*@ZA05125*/ 03398000
*            RNAMCHAR(1:6) = TVOLVAL;                      /*@ZA05125*/ 03399000
         L     @14,@PC00001+4                                      0900 03400000
         L     @01,FDTPTR+4(,@14)                                  0900 03401000
         MVC   RNAMCHAR(6),TVOLVAL(@01)                            0900 03402000
*            RNAMCHAR(7:22) = '.VIRTUAL.RESERVE';          /*@ZA05138*/ 03403000
         MVC   RNAMCHAR+6(16),@CC01588                             0901 03404000
*            CALL IDCSADQ0 (GDTTBL,'SYSZAMS ',MINORNAM);   /*@ZA05125*/ 03405000
         ST    @15,@AL00001                                        0902 03406000
         LA    @14,@CC01523                                        0902 03407000
         ST    @14,@AL00001+4                                      0902 03408000
         LA    @14,MINORNAM                                        0902 03409000
         ST    @14,@AL00001+8                                      0902 03410000
         MVI   @AL00001+8,X'80'                                    0902 03411000
         L     @15,GDTDEQ(,@15)                                    0902 03412000
         LA    @01,@AL00001                                        0902 03413000
         BALR  @14,@15                                             0902 03414000
*          END;                                            /*@ZA05125*/ 03415000
*                                                          /*#Y30LB39*/ 03416000
*        /************************************************************/ 03417000
*        /*                                                  @Y30LB39*/ 03418000
*        /*  INITIALIZE THE MDAGL PARM LIST IF IT HAS        @Y30LB39*/ 03419000
*        /*  NOT BEEN INITIALIZED ALREADY.                   @Y30LB39*/ 03420000
*        /*                                                  @Y30LB39*/ 03421000
*        /************************************************************/ 03422000
*                                                          /*@Y30LB39*/ 03423000
*        IF MDAGL = ZEROS31 THEN                           /*@Y30LB39*/ 03424000
@RF00898 LA    @15,MDAGLBUF                                        0904 03425000
         CLC   MDAGL(31,@15),ZEROS31                               0904 03426000
         BNE   @RF00904                                            0904 03427000
*          DO;                                             /*@Y30LB39*/ 03428000
*            MDDDNAME = RUNITDDN;                          /*@Y30LB39*/ 03429000
         MVC   MDDDNAME(8,@15),RUNITDDN                            0906 03430000
*            MDUCBPTR = ADDR(RUNITUCB);                    /*@Y30LB39*/ 03431000
         LA    @14,RUNITUCB                                        0907 03432000
         ST    @14,MDUCBPTR(,@15)                                  0907 03433000
*            MDLABEL = TVOLVAL;                            /*@Y30LB39*/ 03434000
         L     @14,@PC00001+4                                      0908 03435000
         L     @01,FDTPTR+4(,@14)                                  0908 03436000
         MVC   MDLABEL(6,@15),TVOLVAL(@01)                         0908 03437000
*          END;                                            /*@Y30LB39*/ 03438000
*                                                          /*@Y30LB39*/ 03439000
*        /************************************************************/ 03440000
*        /*                                                  @Y30LB39*/ 03441000
*        /*  IF THE MOUNT FLAG IS ON, A VOLUME MOUNT IS      @Y30LB39*/ 03442000
*        /*  DESIRED BEFORE THE LABEL UPDATE.  OTHERWISE,    @Y30LB39*/ 03443000
*        /*  A VOLUME DEMOUNT IS DESIRED BEFORE THE COPY     @Y30LB39*/ 03444000
*        /*  OPERATION.  IF THE WAIT FLAG IS ON, THE WAIT    @Y30LB39*/ 03445000
*        /*  OPTION IS DESIRED WITH THE DEMOUNT REQUEST.     @Y30LB39*/ 03446000
*        /*                                                  @Y30LB39*/ 03447000
*        /************************************************************/ 03448000
*                                                          /*@Y30LB39*/ 03449000
*        IF WAITFLG = ON THEN                              /*@Y30LB39*/ 03450000
@RF00904 TM    WAITFLG,B'00010000'                                 0910 03451000
         BNO   @RF00910                                            0910 03452000
*          MDWAIT = ON;                                    /*@Y30LB39*/ 03453000
         LA    @15,MDAGLBUF                                        0911 03454000
         OI    MDWAIT(@15),B'00010000'                             0911 03455000
*        ELSE                                              /*@Y30LB39*/ 03456000
*          MDWAIT = OFF;                                   /*@Y30LB39*/ 03457000
         B     @RC00910                                            0912 03458000
@RF00910 LA    @15,MDAGLBUF                                        0912 03459000
         NI    MDWAIT(@15),B'11101111'                             0912 03460000
*                                                          /*@Y30LB39*/ 03461000
*        /************************************************************/ 03462000
*        /*                                                  @Y30LB39*/ 03463000
*        /*  ISSUE UMSSUNIT MACRO TO EXECUTE THE             @Y30LB39*/ 03464000
*        /*  APPROPRIATE REQUEST - DEMOUNT OR MOUNT.         @Y30LB39*/ 03465000
*        /*                                                  @Y30LB39*/ 03466000
*        /************************************************************/ 03467000
*                                                          /*@Y30LB39*/ 03468000
*        IF MOUNTFLG = ON THEN                             /*@Y30LB39*/ 03469000
@RC00910 TM    MOUNTFLG,B'00100000'                                0913 03470000
         BNO   @RF00913                                            0913 03471000
*          CALL IDCSA060 (GDTTBL,MOUNT,MDAGL);             /*@Y30LB39*/ 03472000
         L     @15,@PC00001                                        0914 03473000
         ST    @15,@AL00001                                        0914 03474000
         LA    @14,MOUNT                                           0914 03475000
         ST    @14,@AL00001+4                                      0914 03476000
         LA    @14,MDAGLBUF                                        0914 03477000
         ST    @14,@AL00001+8                                      0914 03478000
         MVI   @AL00001+8,X'80'                                    0914 03479000
         L     @15,GDTUNT(,@15)                                    0914 03480000
         LA    @01,@AL00001                                        0914 03481000
         BALR  @14,@15                                             0914 03482000
*        ELSE                                              /*@Y30LB39*/ 03483000
*          CALL IDCSA060 (GDTTBL,DEMOUNT,MDAGL);           /*@Y30LB39*/ 03484000
         B     @RC00913                                            0915 03485000
@RF00913 L     @15,@PC00001                                        0915 03486000
         ST    @15,@AL00001                                        0915 03487000
         LA    @14,DEMOUNT                                         0915 03488000
         ST    @14,@AL00001+4                                      0915 03489000
         LA    @14,MDAGLBUF                                        0915 03490000
         ST    @14,@AL00001+8                                      0915 03491000
         MVI   @AL00001+8,X'80'                                    0915 03492000
         L     @15,GDTUNT(,@15)                                    0915 03493000
         LA    @01,@AL00001                                        0915 03494000
         BALR  @14,@15                                             0915 03495000
*        RESPECIFY RTNREG RSTD;                                    0916 03496000
@RC00913 DS    0H                                                  0917 03497000
*        TESTRC = RTNREG;                                          0917 03498000
         LR    TESTRC,RTNREG                                       0917 03499000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 03500000
*                                                          /*@Y30LB39*/ 03501000
*        /************************************************************/ 03502000
*        /*                                                  @Y30LB39*/ 03503000
*        /*  IF THE RETURN CODE IS NOT ZERO, SET THE         @Y30LB39*/ 03504000
*        /*  CONDITION CODE TO FOUR.                         @Y30LB39*/ 03505000
*        /*                                                  @Y30LB39*/ 03506000
*        /************************************************************/ 03507000
*                                                          /*@Y30LB39*/ 03508000
*        IF TESTRC ^= 0 THEN                               /*@Y30LB39*/ 03509000
         LTR   TESTRC,TESTRC                                       0919 03510000
         BZ    @RF00919                                            0919 03511000
*          VPREPRC = LASTCC04;                             /*@Y30LB39*/ 03512000
         LA    VPREPRC,4                                           0920 03513000
*                                                          /*@Y30LB39*/ 03514000
*        /************************************************************/ 03515000
*        /*                                                  @Y30LB39*/ 03516000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 03517000
*        /*                                                  @Y30LB39*/ 03518000
*        /************************************************************/ 03519000
*                                                          /*@Y30LB39*/ 03520000
*        REG14 = RETADDR2;                                 /*@Y30LB39*/ 03521000
@RF00919 LR    REG14,RETADDR2                                      0921 03522000
*                                                          /*@Y30LB39*/ 03523000
*        /************************************************************/ 03524000
*        /*                                                  @Y30LB39*/ 03525000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 03526000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 03527000
*        /*                                                  @Y30LB39*/ 03528000
*        /************************************************************/ 03529000
*                                                          /*@Y30LB39*/ 03530000
*        RETURN CODE(VPREPRC);                             /*@Y30LB39*/ 03531000
         LR    @15,VPREPRC                                         0922 03532000
@EL00010 DS    0H                                                  0922 03533000
@EF00010 DS    0H                                                  0922 03534000
@ER00010 BR    @14                                                 0922 03535000
*END VPREPRTN;                                             /*@Y30LB39*/ 03536000
*        /************************************************************/ 03537000
*        /*                                                  @Y30LB39*/ 03538000
*        /*  PROCEDURE NAME - MVRRTN                         @Y30LB39*/ 03539000
*        /*                                                  @Y30LB39*/ 03540000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 03541000
*        /*  CLEAR THE INCOMPLETE COPY FLAG FROM THE         @Y30LB39*/ 03542000
*        /*  INVENTORY.                                      @Y30LB39*/ 03543000
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGES TO BE @Y30LB39*/ 03544000
*        /*  ISSUED:                                         @Y30LB39*/ 03545000
*        /*    IDC3066I IF USSC RETURN CODE IS NON-ZERO      @Y30LB39*/ 03546000
*        /*                                                  @Y30LB39*/ 03547000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 03548000
*        /*          BUFFER FOR PRINT ARGUMENT LIST          @Y30LB39*/ 03549000
*        /*          BUFFER FOR MVR PARAMETER LIST           @Y30LB39*/ 03550000
*        /*                                                  @Y30LB39*/ 03551000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 03552000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 03553000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 03554000
*        /*      4 - IF USSC RETURN CODE NON-ZERO            @Y30LB39*/ 03555000
*        /*                                                  @Y30LB39*/ 03556000
*        /************************************************************/ 03557000
*                                                                  0924 03558000
*MVRRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                  /*@Y30LB39*/ 03559000
*                                                                  0924 03560000
MVRRTN   DS    0H                                                  0925 03561000
*        /************************************************************/ 03562000
*        /*                                                  @Y30LB39*/ 03563000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 03564000
*        /*                                                  @Y30LB39*/ 03565000
*        /************************************************************/ 03566000
*                                                          /*@Y30LB39*/ 03567000
*        DCL MVRRC FIXED(8);           /* RETURN CODE        @Y30LB39*/ 03568000
*                                                          /*@Y30LB39*/ 03569000
*        /************************************************************/ 03570000
*        /*                                                  @Y30LB39*/ 03571000
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/ 03572000
*        /*                                                  @Y30LB39*/ 03573000
*        /************************************************************/ 03574000
*                                                          /*@Y30LB39*/ 03575000
*        RETADDR2 = REG14;                                 /*@Y30LB39*/ 03576000
         LR    RETADDR2,REG14                                      0926 03577000
*                                                          /*@Y30LB39*/ 03578000
*        /************************************************************/ 03579000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 03580000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 03581000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 03582000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 03583000
*        /*                                                  @Y30LB39*/ 03584000
*        /************************************************************/ 03585000
*                                                          /*@Y30LB39*/ 03586000
*        OLDERID2 = NEWERID2;                                      0927 03587000
         L     @15,@PC00001                                        0927 03588000
         L     @14,GDTTR2(,@15)                                    0927 03589000
         MVC   @TS00001(95),NEWERID2(@14)                          0927 03590000
         MVC   OLDERID2(95,@14),@TS00001                           0927 03591000
*        NEWID2 = 'RVMV';                                  /*@Y30LB39*/ 03592000
         MVC   NEWID2(4,@14),@CC01609                              0928 03593000
*                                                          /*@Y30LB39*/ 03594000
*        /************************************************************/ 03595000
*        /*                                                  @Y30LB39*/ 03596000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 03597000
*        /*  INITIALIZE THE LOCAL VARIABLE WHICH WILL HAVE   @Y30LB39*/ 03598000
*        /*  THE EXCESS NUMBER OF BACKUP COPIES VALUE.       @Y30LB39*/ 03599000
*        /*                                                  @Y30LB39*/ 03600000
*        /************************************************************/ 03601000
*                                                          /*@Y30LB39*/ 03602000
*        MVRRC = LASTCC00;                                 /*@Y30LB39*/ 03603000
         SLR   @14,@14                                             0929 03604000
         LR    MVRRC,@14                                           0929 03605000
*                                                          /*@Y30LB39*/ 03606000
*        /***********************************************************/  03607000
*        /*                                                  @Y30LB39*/ 03608000
*        /*  INITIALIZE MVR TO CLEAR THE INCOMPLETE          @Y30LB39*/ 03609000
*        /*  FLAG FROM THE INVENTORY.                        @Y30LB39*/ 03610000
*        /*                                                  @Y30LB39*/ 03611000
*        /***********************************************************/  03612000
*                                                          /*@Y30LB39*/ 03613000
*        MVR = ''B;                                        /*@Y30LB39*/ 03614000
         L     @03,MVRPTR                                          0930 03615000
         XC    MVR(88,@03),MVR(@03)                                0930 03616000
*        MVRLNGTH = MVRLEN;                                /*@Y30LB39*/ 03617000
         LH    @02,MVRLEN                                          0931 03618000
         ST    @02,MVRLNGTH(,@03)                                  0931 03619000
*        MVRCODE = MVROP;                                  /*@Y30LB39*/ 03620000
         XC    MVRCODE+1(3,@03),MVRCODE+1(@03)                     0932 03621000
         MVI   MVRCODE(@03),X'85'                                  0932 03622000
*        MVRCICPY = ON;                                    /*@Y30LB39*/ 03623000
         OI    MVRCICPY(@03),B'01000000'                           0933 03624000
*        MVRBVOL = TVOLVAL;                                /*@Y30LB39*/ 03625000
         L     @02,@PC00001+4                                      0934 03626000
         L     @01,FDTPTR+4(,@02)                                  0934 03627000
         MVC   MVRBVOL(6,@03),TVOLVAL(@01)                         0934 03628000
*                                                          /*@Y30LB39*/ 03629000
*        /***********************************************************/  03630000
*        /*                                                  @Y30LB39*/ 03631000
*        /*  ISSUE USSC TO INVOKE MSVC AFTER DUMPING MVR     @Y30LB39*/ 03632000
*        /*  PARAMETER LIST.                                 @Y30LB39*/ 03633000
*        /*                                                  @Y30LB39*/ 03634000
*        /************************************************************/ 03635000
*                                                          /*@Y30LB39*/ 03636000
*                                                                  0935 03637000
*          IF GDTDBG = NULLPTR                                     0935 03638000
*            THEN;                                                 0935 03639000
         C     @14,GDTDBG(,@15)                                    0935 03640000
         BE    @RT00935                                            0935 03641000
*            ELSE                                                  0937 03642000
*              DO;                                                 0937 03643000
*                DMPINDEX = ADDR(DUMPLIST);                        /*@Y 03644000
*0LB39*/                                                           0938 03645000
*                                                                  0938 03646000
         LA    DMPINDEX,DUMPLIST                                   0938 03647000
*                DMPITMNM = 'MVRBUFR';                             0939 03648000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0939 03649000
         MVC   DMPITMNM(7,DMPINDEX),@CC01610                       0939 03650000
*                DMPITMPT = ADDR(MVRBUFR);                         0940 03651000
         LA    @03,MVRBUFR                                         0940 03652000
         ST    @03,DMPITMPT(,DMPINDEX)                             0940 03653000
*                DMPITMLN = LENGTH(MVRBUFR);                       0941 03654000
         MVC   DMPITMLN(2,DMPINDEX),@CH01653                       0941 03655000
*                DMPITMTP = 'H';                                   0942 03656000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0942 03657000
*                DMPINDEX = DMPINDEX + DMPELEMT;                   0943 03658000
*                                                                  0943 03659000
         AL    DMPINDEX,@CF00473                                   0943 03660000
*                DMPTRM = DMPTRMVL;                                0944 03661000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0944 03662000
*              END;                                         /*@Y30LB39* 03663000
*                                                          /*@Y30LB39*/ 03664000
*        IF GDTDBG = NULLPTR                                       0946 03665000
*          THEN;                                                   0946 03666000
@RT00935 L     @15,@PC00001                                        0946 03667000
         L     @15,GDTDBG(,@15)                                    0946 03668000
         LTR   @15,@15                                             0946 03669000
         BZ    @RT00946                                            0946 03670000
*          ELSE                                                    0948 03671000
*            CALL IDCDB010 (GDTTBL,'RVFF',ADDR(DUMPLIST));         0948 03672000
         L     @15,@PC00001                                        0948 03673000
         ST    @15,@AL00001                                        0948 03674000
         LA    @14,@CC01611                                        0948 03675000
         ST    @14,@AL00001+4                                      0948 03676000
         LA    @14,DUMPLIST                                        0948 03677000
         ST    @14,@AFTEMPS+12                                     0948 03678000
         LA    @14,@AFTEMPS+12                                     0948 03679000
         ST    @14,@AL00001+8                                      0948 03680000
         MVI   @AL00001+8,X'80'                                    0948 03681000
         L     @15,GDTDBG(,@15)                                    0948 03682000
         LA    @01,@AL00001                                        0948 03683000
         BALR  @14,@15                                             0948 03684000
*                                                          /*@Y30LB39*/ 03685000
*                                                          /*@Y30LB39*/ 03686000
*        CALL IDCSASS0 (GDTTBL,VVIC,MVRPTR,REASON);        /*@Y30LB39*/ 03687000
@RT00946 L     @02,@PC00001                                        0949 03688000
         ST    @02,@AL00001                                        0949 03689000
         LA    @15,VVIC                                            0949 03690000
         ST    @15,@AL00001+4                                      0949 03691000
         LA    @15,MVRPTR                                          0949 03692000
         ST    @15,@AL00001+8                                      0949 03693000
         LA    @15,REASON                                          0949 03694000
         ST    @15,@AL00001+12                                     0949 03695000
         MVI   @AL00001+12,X'80'                                   0949 03696000
         L     @15,GDTSSC(,@02)                                    0949 03697000
         LA    @01,@AL00001                                        0949 03698000
         BALR  @14,@15                                             0949 03699000
*                                                          /*@Y30LB39*/ 03700000
*        RESPECIFY RTNREG RSTD;                                    0950 03701000
*        TESTRC = RTNREG;                                          0951 03702000
         LR    TESTRC,RTNREG                                       0951 03703000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 03704000
*                                                          /*@Y30LB39*/ 03705000
*        /***********************************************************/  03706000
*        /*                                                  @Y30LB39*/ 03707000
*        /*  IF MSVC RETURNS A RETURN CODE OF TWELVE,        @Y30LB39*/ 03708000
*        /*  IT MEANS THE FUNCTION WAS COMPLETED BUT AN      @Y30LB39*/ 03709000
*        /*  I-O ERROR PREVENTED THE UPDATING OF THE         @Y30LB39*/ 03710000
*        /*  MSV INVENTORY.  THIS RETURN CODE SHOULD BE      @Y30LB39*/ 03711000
*        /*  TREATED AS A RETURN CODE OF ZERO, EXCEPT        @Y30LB39*/ 03712000
*        /*  THAT THE FINAL CODE TO THE EXECUTIVE            @Y30LB39*/ 03713000
*        /*  SHOULD BE AT LEAST FOUR.  THAT IS THE           @Y30LB39*/ 03714000
*        /*  REASON FOR SETTING CC04FLG ON.                  @Y30LB39*/ 03715000
*        /*                                                  @Y30LB39*/ 03716000
*        /***********************************************************/  03717000
*                                                          /*@Y30LB39*/ 03718000
*        IF TESTRC = 12 THEN                               /*@Y30LB39*/ 03719000
         C     TESTRC,@CF00567                                     0953 03720000
         BNE   @RF00953                                            0953 03721000
*          DO;                                             /*@Y30LB39*/ 03722000
*            TESTRC = LASTCC00;                            /*@Y30LB39*/ 03723000
         SLR   TESTRC,TESTRC                                       0955 03724000
*            CC04FLG = ON;                                 /*@Y30LB39*/ 03725000
         OI    CC04FLG,B'01000000'                                 0956 03726000
*          END;                                            /*@Y30LB39*/ 03727000
*                                                          /*@Y30LB39*/ 03728000
*        /********************************************************/     03729000
*        /*                                                  @Y30LB39*/ 03730000
*        /*  CHECK IF THE INCOMPLETE COPY FLAG WAS           @Y30LB39*/ 03731000
*        /*  SUCCESSFULLY CLEARED FROM THE MSVI              @Y30LB39*/ 03732000
*        /*                                                  @Y30LB39*/ 03733000
*        /************************************************************/ 03734000
*                                                          /*@Y30LB39*/ 03735000
*        IF TESTRC ^= 0 THEN                               /*@Y30LB39*/ 03736000
@RF00953 LTR   TESTRC,TESTRC                                       0958 03737000
         BZ    @RF00958                                            0958 03738000
*          DO;                                             /*@Y30LB39*/ 03739000
*                                                          /*@Y30LB39*/ 03740000
*            /********************************************************/ 03741000
*            /*                                              @Y30LB39*/ 03742000
*            /*  SET THE CONDITION CODE TO FOUR,             @Y30LB39*/ 03743000
*            /*  IF MSVI NOT UPDATED                         @Y30LB39*/ 03744000
*            /*                                              @Y30LB39*/ 03745000
*            /********************************************************/ 03746000
*                                                          /*@Y30LB39*/ 03747000
*            COPYRC = LASTCC04;                            /*@Y30LB39*/ 03748000
         LA    @02,4                                               0960 03749000
         LR    COPYRC,@02                                          0960 03750000
*                                                          /*@Y30LB39*/ 03751000
*            /********************************************************/ 03752000
*            /*                                              @Y30LB39*/ 03753000
*            /*  CALL SSCMSG TO OUTPUT APPROPRIATE           @Y30LB39*/ 03754000
*            /*  REASON CODE IF RETURN CODE IS FOUR.         @Y30LB39*/ 03755000
*            /*                                              @Y30LB39*/ 03756000
*            /********************************************************/ 03757000
*                                                          /*@Y30LB39*/ 03758000
*            IF TESTRC = LASTCC04 THEN                     /*@Y30LB39*/ 03759000
         CR    TESTRC,@02                                          0961 03760000
         BNE   @RF00961                                            0961 03761000
*                                                          /*@Y30LB39*/ 03762000
*              CALL SSCMSG (REASON);                       /*@Y30LB39*/ 03763000
         LA    @15,REASON                                          0962 03764000
         ST    @15,@AL00001                                        0962 03765000
         LA    @01,@AL00001                                        0962 03766000
         BAL   @14,SSCMSG                                          0962 03767000
*                                                          /*@Y30LB39*/ 03768000
*            /********************************************************/ 03769000
*            /*                                              @Y30LB39*/ 03770000
*            /*  ISSUE UPRINT FOR SECONDARY MESSAGE          @Y30LB39*/ 03771000
*            /*  IDC3066I.                                   @Y30LB39*/ 03772000
*            /*                                              @Y30LB39*/ 03773000
*            /********************************************************/ 03774000
*                                                          /*@Y30LB39*/ 03775000
*            DARGLIST = ''B;                               /*@Y30LB39*/ 03776000
@RF00961 L     @15,DDSTRU                                          0963 03777000
         XC    DARGLIST(20,@15),DARGLIST(@15)                      0963 03778000
*            DARGSMOD = COMNMSG;                           /*@Y30LB39*/ 03779000
         MVC   DARGSMOD(3,@15),@CC01460                            0964 03780000
*            DARGSENT = MSG3066I;                          /*@Y30LB39*/ 03781000
         MVI   DARGSENT(@15),X'2C'                                 0965 03782000
*                                                          /*@Y30LB39*/ 03783000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);        /*@Y30LB39*/ 03784000
         L     @15,@PC00001                                        0966 03785000
         ST    @15,@AL00001                                        0966 03786000
         LA    @14,@CF00114                                        0966 03787000
         ST    @14,@AL00001+4                                      0966 03788000
         LA    @14,DDSTRU                                          0966 03789000
         ST    @14,@AL00001+8                                      0966 03790000
         MVI   @AL00001+8,X'80'                                    0966 03791000
         L     @15,GDTPRT(,@15)                                    0966 03792000
         LA    @01,@AL00001                                        0966 03793000
         BALR  @14,@15                                             0966 03794000
*                                                          /*@Y30LB39*/ 03795000
*          END;                                            /*@Y30LB39*/ 03796000
*                                                          /*@Y30LB39*/ 03797000
*        /************************************************************/ 03798000
*        /*                                                  @Y30LB39*/ 03799000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 03800000
*        /*                                                  @Y30LB39*/ 03801000
*        /************************************************************/ 03802000
*                                                          /*@Y30LB39*/ 03803000
*        REG14 = RETADDR2;                                 /*@Y30LB39*/ 03804000
@RF00958 LR    REG14,RETADDR2                                      0968 03805000
*                                                          /*@Y30LB39*/ 03806000
*        /************************************************************/ 03807000
*        /*                                                  @Y30LB39*/ 03808000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 03809000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 03810000
*        /*                                                  @Y30LB39*/ 03811000
*        /************************************************************/ 03812000
*                                                          /*@Y30LB39*/ 03813000
*        RETURN CODE(MVRRC);                               /*@Y30LB39*/ 03814000
         LR    @15,MVRRC                                           0969 03815000
@EL00011 DS    0H                                                  0969 03816000
@EF00011 DS    0H                                                  0969 03817000
@ER00011 BR    @14                                                 0969 03818000
*END MVRRTN;                                               /*@Y30LB39*/ 03819000
*        /************************************************************/ 03820000
*        /*                                                  @Y30LB39*/ 03821000
*        /*  PROCEDURE NAME - LABELRTN                       @Y30LB39*/ 03822000
*        /*                                                  @Y30LB39*/ 03823000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 03824000
*        /*  DIRECT THE VOLUME LABEL UPDATE                  @Y30LB39*/ 03825000
*        /*  FOLLOWING THE COPY OPERATION IF THE OWNER       @Y30LB39*/ 03826000
*        /*  OR SERIAL NUMBER MUST BE RESTORED.              @Y30LB39*/ 03827000
*        /*  IT IS POSSIBLE FOR THE FOLLOWING MESSAGE TO     @Y30LB39*/ 03828000
*        /*  BE ISSUED:                                      @Y30LB39*/ 03829000
*        /*    IDC3070I IF LABEL UPDATE IS NOT SUCCESSFUL    @Y30LB39*/ 03830000
*        /*             AND SOURCE AND TARGET OWNERS ARE     @Y30LB39*/ 03831000
*        /*             DIFFERENT.                           @Y30LB39*/ 03832000
*        /*    IDC3070I IF LABEL UPDATE IS NOT SUCCESSFUL    @Y30LB39*/ 03833000
*        /*             AND SOURCE AND TARGET VOLSERS ARE    @Y30LB39*/ 03834000
*        /*             DIFFERENT.                           @Y30LB39*/ 03835000
*        /*    IDC3070I IF LABEL UPDATE IS NOT SUCCESSFUL    @Y30LB39*/ 03836000
*        /*             AND SOURCE AND TARGET OWNERS ARE     @Y30LB39*/ 03837000
*        /*             DIFFERENT AND SOURCE AND TARGET      @Y30LB39*/ 03838000
*        /*             VOLUME SERIAL NUMBERS ARE DIFFERENT. @Y30LB39*/ 03839000
*        /*                                                  @Y30LB39*/ 03840000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 03841000
*        /*          RECOVERV TABLE                          @Y30LB39*/ 03842000
*        /*          BASE VOLUME RECORD  (BASEV)             @Y30LB39*/ 03843000
*        /*          COPY VOLUME RECORD  (COPYV)             @Y30LB39*/ 03844000
*        /*          BUFFER FOR PRINT ARGUMENT LIST          @Y30LB39*/ 03845000
*        /*          BUFFER FOR EXCLUSIVE ARGUMENT LIST      @ZD00175*/ 03846000
*        /*                                                  @Y30LB39*/ 03847000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 03848000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 03849000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 03850000
*        /*      4 - IF DYNAMIC ALLOCATION FAILED OR         @Y30LB39*/ 03851000
*        /*          PROCESSING DID NOT COMPLETE NORMALLY    @Y30LB39*/ 03852000
*        /*                                                  @Y30LB39*/ 03853000
*        /************************************************************/ 03854000
*                                                                  0971 03855000
*LABELRTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                /*@Y30LB39*/ 03856000
*                                                                  0971 03857000
LABELRTN DS    0H                                                  0972 03858000
*        /************************************************************/ 03859000
*        /*                                                  @Y30LB39*/ 03860000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 03861000
*        /*                                                  @Y30LB39*/ 03862000
*        /************************************************************/ 03863000
*                                                          /*@Y30LB39*/ 03864000
*        DCL LABELRC FIXED(8);         /* RETURN CODE        @Y30LB39*/ 03865000
*                                                          /*@Y30LB39*/ 03866000
*        /************************************************************/ 03867000
*        /*                                                  @Y30LB39*/ 03868000
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/ 03869000
*        /*                                                  @Y30LB39*/ 03870000
*        /************************************************************/ 03871000
*                                                          /*@Y30LB39*/ 03872000
*        RETADDR1 = REG14;                                 /*@Y30LB39*/ 03873000
         ST    REG14,RETADDR1                                      0973 03874000
*                                                          /*@Y30LB39*/ 03875000
*        /************************************************************/ 03876000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 03877000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 03878000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 03879000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 03880000
*        /*                                                  @Y30LB39*/ 03881000
*        /************************************************************/ 03882000
*                                                          /*@Y30LB39*/ 03883000
*        OLDERID2 = NEWERID2;                                      0974 03884000
         L     @09,@PC00001                                        0974 03885000
         L     @09,GDTTR2(,@09)                                    0974 03886000
         MVC   @TS00001(95),NEWERID2(@09)                          0974 03887000
         MVC   OLDERID2(95,@09),@TS00001                           0974 03888000
*        NEWID2 = 'RVLB';                                  /*@Y30LB39*/ 03889000
         MVC   NEWID2(4,@09),@CC01616                              0975 03890000
*                                                          /*@Y30LB39*/ 03891000
*        /************************************************************/ 03892000
*        /*                                                  @Y30LB39*/ 03893000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 03894000
*        /*                                                  @Y30LB39*/ 03895000
*        /************************************************************/ 03896000
*                                                          /*@Y30LB39*/ 03897000
*        LABELRC = LASTCC00;                               /*@Y30LB39*/ 03898000
         SLR   LABELRC,LABELRC                                     0976 03899000
*                                                          /*@Y30LB39*/ 03900000
*        /************************************************************/ 03901000
*        /*                                                  @ZD00175*/ 03902000
*        /* IF A UNIT HAS NOT BEEN ALLOCATED, EITHER SELECT A UNIT   */ 03903000
*        /* FOR REUSE OR DYNAMICALLY ALLOCATE A UNIT AND MOUNT THE   */ 03904000
*        /* VOLUME.                                          @ZD00175*/ 03905000
*        /*                                                  @ZD00175*/ 03906000
*        /************************************************************/ 03907000
*                                                                  0977 03908000
*        IF RUNITDDN=EIGHTZRO THEN                                 0977 03909000
         CLC   RUNITDDN(8),EIGHTZRO                                0977 03910000
         BNE   @RF00977                                            0977 03911000
*          DO;                                             /*@ZD00175*/ 03912000
*            GETDDFLG=ON;                                  /*@ZD00175*/ 03913000
         OI    GETDDFLG,B'00001000'                                0979 03914000
*            CALL ALLOCRTN;                                /*@ZD00175*/ 03915000
         BAL   @14,ALLOCRTN                                        0980 03916000
*            RESPECIFY RTNREG RSTD;                                0981 03917000
*            TESTRC = RTNREG;                                      0982 03918000
         LR    TESTRC,RTNREG                                       0982 03919000
*            RESPECIFY RTNREG UNRSTD;                      /*@ZD00175*/ 03920000
*            IF TESTRC^=0 THEN                                     0984 03921000
         LTR   TESTRC,TESTRC                                       0984 03922000
         BZ    @RF00984                                            0984 03923000
*              LABELRC=LASTCC04;                           /*@ZD00175*/ 03924000
*                                                                  0985 03925000
         LA    LABELRC,4                                           0985 03926000
*            /********************************************************/ 03927000
*            /*                                              @ZD00175*/ 03928000
*            /* INSURE THAT THE UNIT, IF DYNAMICALLY ALLOCATED, AND  */ 03929000
*            /* THE TARGET VOLUME MOUNTED ON IT ARE ALLOCATED FOR    */ 03930000
*            /* EXCLUSIVE USE.  EXCLAGL WAS INITIALIZED IN THE       */ 03931000
*            /* ALLOCRTN PROCEDURE.                          @ZD00175*/ 03932000
*            /*                                              @ZD00175*/ 03933000
*            /********************************************************/ 03934000
*                                                                  0986 03935000
*            ELSE                                                  0986 03936000
*              IF ALLOCFLG=ON THEN                                 0986 03937000
         B     @RC00984                                            0986 03938000
@RF00984 TM    ALLOCFLG,B'10000000'                                0986 03939000
         BNO   @RF00986                                            0986 03940000
*                DO;                                       /*@ZD00175*/ 03941000
*                                                                  0987 03942000
*                  /**************************************************/ 03943000
*                  /*                                        @ZD00175*/ 03944000
*                  /* TAKE A FULL REGION DUMP BEFORE THE EXTERNAL    */ 03945000
*                  /* CALL TO IDCSA06.                       @ZD00175*/ 03946000
*                  /*                                        @ZD00175*/ 03947000
*                  /**************************************************/ 03948000
*                                                                  0988 03949000
*                  IF GDTDBG = NULLPTR                             0988 03950000
*                    THEN;                                         0988 03951000
         L     @09,@PC00001                                        0988 03952000
         L     @09,GDTDBG(,@09)                                    0988 03953000
         LTR   @09,@09                                             0988 03954000
         BZ    @RT00988                                            0988 03955000
*                    ELSE                                          0990 03956000
*                      CALL IDCDB010(GDTTBL,'RVII');               0990 03957000
         L     @09,@PC00001                                        0990 03958000
         ST    @09,@AL00001                                        0990 03959000
         LA    @04,@CC01617                                        0990 03960000
         ST    @04,@AL00001+4                                      0990 03961000
         MVI   @AL00001+4,X'80'                                    0990 03962000
         L     @15,GDTDBG(,@09)                                    0990 03963000
         LA    @01,@AL00001                                        0990 03964000
         BALR  @14,@15                                             0990 03965000
*                                                          /*@ZD00175*/ 03966000
*                                                                  0991 03967000
*                  CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);  /*@ZD00175*/ 03968000
@RT00988 L     @09,@PC00001                                        0991 03969000
         ST    @09,@AL00001                                        0991 03970000
         LA    @04,CHANGEX                                         0991 03971000
         ST    @04,@AL00001+4                                      0991 03972000
         LA    @04,EXCLAGLB                                        0991 03973000
         ST    @04,@AL00001+8                                      0991 03974000
         MVI   @AL00001+8,X'80'                                    0991 03975000
         L     @15,GDTUNT(,@09)                                    0991 03976000
         LA    @01,@AL00001                                        0991 03977000
         BALR  @14,@15                                             0991 03978000
*                  RESPECIFY RTNREG RSTD;                          0992 03979000
*                  TESTRC = RTNREG;                                0993 03980000
         LR    TESTRC,RTNREG                                       0993 03981000
*                  RESPECIFY RTNREG UNRSTD;                /*@ZD00175*/ 03982000
*                                                                  0994 03983000
*                  IF TESTRC^=0 THEN                               0995 03984000
         LTR   TESTRC,TESTRC                                       0995 03985000
         BZ    @RF00995                                            0995 03986000
*                    LABELRC=LASTCC04;                     /*@ZD00175*/ 03987000
         LA    LABELRC,4                                           0996 03988000
*                END;                                      /*@ZD00175*/ 03989000
*              ELSE;                                       /*@ZD00175*/ 03990000
@RF00986 DS    0H                                                  0999 03991000
*          END;                                            /*@ZD00175*/ 03992000
*                                                                  0999 03993000
*        /************************************************************/ 03994000
*        /*                                                  #Y30LB39*/ 03995000
*        /*  A UNIT IS ALREADY ALLOCATED.  CALL VPREPRTN     #Y30LB39*/ 03996000
*        /*  TO MOUNT THE TARGET VOLUME AFTER SETTING        #Y30LB39*/ 03997000
*        /*  THE APPROPRIATE FLAGS IN THE PARM LIST.         #Y30LB39*/ 03998000
*        /*                                                  @Y30LB39*/ 03999000
*        /************************************************************/ 04000000
*                                                          /*@Y30LB39*/ 04001000
*        ELSE                                              /*@Y30LB39*/ 04002000
*          DO;                                             /*@Y30LB39*/ 04003000
         B     @RC00977                                            1000 04004000
@RF00977 DS    0H                                                  1001 04005000
*            MOUNTFLG = ON;                                /*@Y30LB39*/ 04006000
*            WAITFLG = OFF;                                /*@Y30LB39*/ 04007000
         OI    MOUNTFLG,B'00100000'                                1002 04008000
         NI    WAITFLG,B'11101111'                                 1002 04009000
*            CALL VPREPRTN;                                /*@Y30LB39*/ 04010000
         BAL   @14,VPREPRTN                                        1003 04011000
*            RESPECIFY RTNREG RSTD;                                1004 04012000
*            TESTRC = RTNREG;                                      1005 04013000
         LR    TESTRC,RTNREG                                       1005 04014000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/ 04015000
*            IF TESTRC ^= 0 THEN                           /*@Y30LB39*/ 04016000
         LTR   TESTRC,TESTRC                                       1007 04017000
         BZ    @RF01007                                            1007 04018000
*              LABELRC = LASTCC04;                         /*@Y30LB39*/ 04019000
         LA    LABELRC,4                                           1008 04020000
*          END;                                            /*@Y30LB39*/ 04021000
@RF01007 DS    0H                                                  1010 04022000
*                                                          /*@Y30LB39*/ 04023000
*        /************************************************************/ 04024000
*        /*                                                  @Y30LB39*/ 04025000
*        /*  IF THE CONDITION CODE IS NOT ZERO, THE LABEL    @Y30LB39*/ 04026000
*        /*  UPDATE IS NOT ATTEMPTED.  ISSUE THE APPROPRI-   @Y30LB39*/ 04027000
*        /*  ATE MESSAGES.                                   @Y30LB39*/ 04028000
*        /*                                                  @Y30LB39*/ 04029000
*        /************************************************************/ 04030000
*                                                          /*@Y30LB39*/ 04031000
*        IF LABELRC ^= 0 THEN                              /*@Y30LB39*/ 04032000
@RC00977 C     LABELRC,@CF00114                                    1010 04033000
         BE    @RF01010                                            1010 04034000
*          DO;                                             /*@Y30LB39*/ 04035000
*            IF BASOWNER ^= COPOWNER & FVOLVAL ^= TVOLVAL THEN     1012 04036000
         CLC   BASOWNER(10,BASEVPTR),COPOWNER(COPYVPTR)            1012 04037000
         BE    @RF01012                                            1012 04038000
         L     @09,@PC00001+4                                      1012 04039000
         L     @07,FDTPTR(,@09)                                    1012 04040000
         L     @09,FDTPTR+4(,@09)                                  1012 04041000
         CLC   FVOLVAL(6,@07),TVOLVAL(@09)                         1012 04042000
         BE    @RF01012                                            1012 04043000
*              DO;                                         /*@Y30LB39*/ 04044000
*                DARGLIST = ''B;                           /*@Y30LB39*/ 04045000
         L     @09,DDSTRU                                          1014 04046000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1014 04047000
*                DARGSMOD = COMNMSG;                       /*@Y30LB39*/ 04048000
         MVC   DARGSMOD(3,@09),@CC01460                            1015 04049000
*                DARGSENT = MSG3070C;                      /*@Y30LB39*/ 04050000
         MVI   DARGSENT(@09),X'35'                                 1016 04051000
*                                                          /*@Y30LB39*/ 04052000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30LB39*/ 04053000
         L     @09,@PC00001                                        1017 04054000
         ST    @09,@AL00001                                        1017 04055000
         LA    @15,@CF00114                                        1017 04056000
         ST    @15,@AL00001+4                                      1017 04057000
         LA    @15,DDSTRU                                          1017 04058000
         ST    @15,@AL00001+8                                      1017 04059000
         MVI   @AL00001+8,X'80'                                    1017 04060000
         L     @15,GDTPRT(,@09)                                    1017 04061000
         LA    @01,@AL00001                                        1017 04062000
         BALR  @14,@15                                             1017 04063000
*                                                          /*@Y30LB39*/ 04064000
*              END;                                        /*@Y30LB39*/ 04065000
*            ELSE                                          /*@Y30LB39*/ 04066000
*              DO;                                         /*@Y30LB39*/ 04067000
         B     @RC01012                                            1019 04068000
@RF01012 DS    0H                                                  1020 04069000
*                IF BASOWNER ^= COPOWNER THEN              /*@Y30LB39*/ 04070000
         CLC   BASOWNER(10,BASEVPTR),COPOWNER(COPYVPTR)            1020 04071000
         BE    @RF01020                                            1020 04072000
*                  DO;                                     /*@Y30LB39*/ 04073000
*                    DARGLIST = ''B;                       /*@Y30LB39*/ 04074000
         L     @09,DDSTRU                                          1022 04075000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1022 04076000
*                    DARGSMOD = COMNMSG;                   /*@Y30LB39*/ 04077000
         MVC   DARGSMOD(3,@09),@CC01460                            1023 04078000
*                    DARGSENT = MSG3070B;                  /*@Y30LB39*/ 04079000
         MVI   DARGSENT(@09),X'27'                                 1024 04080000
*                                                          /*@Y30LB39*/ 04081000
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@Y30LB39*/ 04082000
         L     @09,@PC00001                                        1025 04083000
         ST    @09,@AL00001                                        1025 04084000
         LA    @15,@CF00114                                        1025 04085000
         ST    @15,@AL00001+4                                      1025 04086000
         LA    @15,DDSTRU                                          1025 04087000
         ST    @15,@AL00001+8                                      1025 04088000
         MVI   @AL00001+8,X'80'                                    1025 04089000
         L     @15,GDTPRT(,@09)                                    1025 04090000
         LA    @01,@AL00001                                        1025 04091000
         BALR  @14,@15                                             1025 04092000
*                                                          /*@Y30LB39*/ 04093000
*                  END;                                    /*@Y30LB39*/ 04094000
*                IF FVOLVAL ^= TVOLVAL THEN                /*@Y30LB39*/ 04095000
@RF01020 L     @09,@PC00001+4                                      1027 04096000
         L     @01,FDTPTR(,@09)                                    1027 04097000
         L     @09,FDTPTR+4(,@09)                                  1027 04098000
         CLC   FVOLVAL(6,@01),TVOLVAL(@09)                         1027 04099000
         BE    @RF01027                                            1027 04100000
*                  DO;                                     /*@Y30LB39*/ 04101000
*                    DARGLIST = ''B;                       /*@Y30LB39*/ 04102000
         L     @09,DDSTRU                                          1029 04103000
         XC    DARGLIST(20,@09),DARGLIST(@09)                      1029 04104000
*                    DARGSMOD = COMNMSG;                   /*@Y30LB39*/ 04105000
         MVC   DARGSMOD(3,@09),@CC01460                            1030 04106000
*                    DARGSENT = MSG3070A;                  /*@Y30LB39*/ 04107000
         MVI   DARGSENT(@09),X'25'                                 1031 04108000
*                                                          /*@Y30LB39*/ 04109000
*                    CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);/*@Y30LB39*/ 04110000
         L     @09,@PC00001                                        1032 04111000
         ST    @09,@AL00001                                        1032 04112000
         LA    @15,@CF00114                                        1032 04113000
         ST    @15,@AL00001+4                                      1032 04114000
         LA    @15,DDSTRU                                          1032 04115000
         ST    @15,@AL00001+8                                      1032 04116000
         MVI   @AL00001+8,X'80'                                    1032 04117000
         L     @15,GDTPRT(,@09)                                    1032 04118000
         LA    @01,@AL00001                                        1032 04119000
         BALR  @14,@15                                             1032 04120000
*                                                          /*@Y30LB39*/ 04121000
*                  END;                                    /*@Y30LB39*/ 04122000
*              END;                                        /*@Y30LB39*/ 04123000
*          END;                                            /*@Y30LB39*/ 04124000
*        ELSE                                              /*@Y30LB39*/ 04125000
*          DO;                                             /*@Y30LB39*/ 04126000
         B     @RC01010                                            1036 04127000
@RF01010 DS    0H                                                  1037 04128000
*                                                          /*@Y30LB39*/ 04129000
*            /********************************************************/ 04130000
*            /*                                              @Y30LB39*/ 04131000
*            /*  CALL VS2RTN FOR THE ACTUAL LABEL UPDATE.    @Y30LB39*/ 04132000
*            /*                                              @Y30LB39*/ 04133000
*            /********************************************************/ 04134000
*                                                          /*@Y30LB39*/ 04135000
*            CALL VS2RTN;                                  /*@Y30LB39*/ 04136000
         BAL   @14,VS2RTN                                          1037 04137000
*            RESPECIFY RTNREG RSTD;                                1038 04138000
*            TESTRC = RTNREG;                                      1039 04139000
         LR    TESTRC,RTNREG                                       1039 04140000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30LB39*/ 04141000
*            IF TESTRC ^= 0 THEN                           /*@Y30LB39*/ 04142000
         LTR   TESTRC,TESTRC                                       1041 04143000
         BZ    @RF01041                                            1041 04144000
*              LABELRC = LASTCC04;                         /*@Y30LB39*/ 04145000
         LA    LABELRC,4                                           1042 04146000
*                                                          /*@Y30LB39*/ 04147000
*            /********************************************************/ 04148000
*            /*                                              @Y30LB39*/ 04149000
*            /*  ISSUE UDEQ TO RELEASE THE RESERVE SET BY    @Y30LB39*/ 04150000
*            /*  IDCVS02 FOR THE LABEL UPDATE.  PLEASE NOTE  @Y30LB39*/ 04151000
*            /*  THAT THE VOLUME IS NOT DEMOUNTED VIA        @Y30LB39*/ 04152000
*            /*  IDCSA06 SINCE THE VOLUME WAS MOUNTED        @Y30LB39*/ 04153000
*            /*  ORIGINALLY VIA UALLOC OR THRU OPEN OR       @Y30LB39*/ 04154000
*            /*  BY ALLOCATION AT THE START OF THE JOB AND,  @Y30LB39*/ 04155000
*            /*  THEREFORE, WILL BE DEMOUNTED BY SYSTEM      @ZD00175*/ 04156000
*            /*  STEP TERMINATION.                           @ZD00175*/ 04157000
*            /*                                              @Y30LB39*/ 04158000
*            /********************************************************/ 04159000
*                                                          /*@Y30LB39*/ 04160000
*            RNAMCHAR(1:6) = TVOLVAL;                      /*@Y30LB39*/ 04161000
@RF01041 L     @09,@PC00001+4                                      1043 04162000
         L     @09,FDTPTR+4(,@09)                                  1043 04163000
         MVC   RNAMCHAR(6),TVOLVAL(@09)                            1043 04164000
*            RNAMCHAR(7:22) = '.VIRTUAL.RESERVE';          /*@ZA05138*/ 04165000
         MVC   RNAMCHAR+6(16),@CC01588                             1044 04166000
*            CALL IDCSADQ0 (GDTTBL,'SYSZAMS ',MINORNAM);   /*@Y30LB39*/ 04167000
         L     @09,@PC00001                                        1045 04168000
         ST    @09,@AL00001                                        1045 04169000
         LA    @06,@CC01523                                        1045 04170000
         ST    @06,@AL00001+4                                      1045 04171000
         LA    @06,MINORNAM                                        1045 04172000
         ST    @06,@AL00001+8                                      1045 04173000
         MVI   @AL00001+8,X'80'                                    1045 04174000
         L     @15,GDTDEQ(,@09)                                    1045 04175000
         LA    @01,@AL00001                                        1045 04176000
         BALR  @14,@15                                             1045 04177000
*                                                          /*@Y30LB39*/ 04178000
*            /********************************************************/ 04179000
*            /*                                              @Y30LB39*/ 04180000
*            /*  IF THE CONDITION CODE IS ZERO AND THE       @Y30LB39*/ 04181000
*            /*  TARGET VOLUME SERIAL NUMBER WAS UPDATED     @Y30LB39*/ 04182000
*            /*  THEN CALL MVRRTN TO CLEAR THE INCOMPLETE    @Y30LB39*/ 04183000
*            /*  COPY FLAG FROM THE INVENTORY.  IF THE       @Y30LB39*/ 04184000
*            /*  RETURN CODE IS NOT ZERO, SET CONDITION CODE @Y30LB39*/ 04185000
*            /*  TO FOUR PRIOR TO EXITING THIS SUBROUTINE.   @Y30LB39*/ 04186000
*            /*                                              @Y30LB39*/ 04187000
*            /********************************************************/ 04188000
*                                                          /*@Y30LB39*/ 04189000
*            IF LABELRC = 0 & FVOLVAL ^= TVOLVAL THEN      /*@Y30LB39*/ 04190000
         C     LABELRC,@CF00114                                    1046 04191000
         BNE   @RF01046                                            1046 04192000
         L     @09,@PC00001+4                                      1046 04193000
         L     @06,FDTPTR(,@09)                                    1046 04194000
         L     @09,FDTPTR+4(,@09)                                  1046 04195000
         CLC   FVOLVAL(6,@06),TVOLVAL(@09)                         1046 04196000
         BE    @RF01046                                            1046 04197000
*              DO;                                         /*@Y30LB39*/ 04198000
*                CALL MVRRTN;                              /*@Y30LB39*/ 04199000
         BAL   @14,MVRRTN                                          1048 04200000
*                RESPECIFY RTNREG RSTD;                            1049 04201000
*                TESTRC = RTNREG;                                  1050 04202000
         LR    TESTRC,RTNREG                                       1050 04203000
*                RESPECIFY RTNREG UNRSTD;                  /*@Y30LB39*/ 04204000
*                IF TESTRC ^= 0 THEN                       /*@Y30LB39*/ 04205000
         LTR   TESTRC,TESTRC                                       1052 04206000
         BZ    @RF01052                                            1052 04207000
*                  LABELRC = LASTCC04;                     /*@Y30LB39*/ 04208000
         LA    LABELRC,4                                           1053 04209000
*              END;                                        /*@Y30LB39*/ 04210000
@RF01052 DS    0H                                                  1055 04211000
*          END;                                            /*@Y30LB39*/ 04212000
@RF01046 DS    0H                                                  1056 04213000
*                                                          /*@Y30LB39*/ 04214000
*        /************************************************************/ 04215000
*        /*                                                  @Y30LB39*/ 04216000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 04217000
*        /*                                                  @Y30LB39*/ 04218000
*        /************************************************************/ 04219000
*                                                          /*@Y30LB39*/ 04220000
*        REG14 = RETADDR1;                                 /*@Y30LB39*/ 04221000
@RC01010 L     REG14,RETADDR1                                      1056 04222000
*                                                          /*@Y30LB39*/ 04223000
*        /************************************************************/ 04224000
*        /*                                                  @Y30LB39*/ 04225000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 04226000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 04227000
*        /*                                                  @Y30LB39*/ 04228000
*        /************************************************************/ 04229000
*                                                          /*@Y30LB39*/ 04230000
*        RETURN CODE(LABELRC);                             /*@Y30LB39*/ 04231000
         LR    @15,LABELRC                                         1057 04232000
@EL00012 DS    0H                                                  1057 04233000
@EF00012 DS    0H                                                  1057 04234000
@ER00012 BR    @14                                                 1057 04235000
*END LABELRTN;                                             /*@Y30LB39*/ 04236000
*        /************************************************************/ 04237000
*        /*                                                  @Y30LB39*/ 04238000
*        /*  PROCEDURE NAME - VS2RTN                         @Y30LB39*/ 04239000
*        /*                                                  @Y30LB39*/ 04240000
*        /*  FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO   @Y30LB39*/ 04241000
*        /*  UPDATE THE VOLUME LABEL FOLLOWING THE           @Y30LB39*/ 04242000
*        /*  COPY OPERATION.  AN EXTERNAL CALL TO IDCVS02    @Y30LB39*/ 04243000
*        /*  IS MADE TO DO THE ACTUAL UPDATE.                @Y30LB39*/ 04244000
*        /*                                                  @Y30LB39*/ 04245000
*        /*  INPUT - FUNCTION DEFINITION TABLE               @Y30LB39*/ 04246000
*        /*          COPY VOLUME RECORD (COPYV)              @Y30LB39*/ 04247000
*        /*          BASE VOLUME RECORD (BASEV)              @Y30LB39*/ 04248000
*        /*          RECOVERV TABLE                          @Y30LB39*/ 04249000
*        /*                                                  @Y30LB39*/ 04250000
*        /*  OUTPUT - REGISTER 15 WILL CONTAIN ONE OF THE    @Y30LB39*/ 04251000
*        /*  FOLLOWING RETURN CODES UPON RETURNING TO CALLER @Y30LB39*/ 04252000
*        /*      0 - PROCESSING COMPLETED NORMALLY           @Y30LB39*/ 04253000
*        /*      4 - IF IDCVS02 RETURN CODE IS NOT ZERO      @Y30LB39*/ 04254000
*        /*                                                  @Y30LB39*/ 04255000
*        /************************************************************/ 04256000
*                                                                  1059 04257000
*VS2RTN: PROC OPTIONS(NOSAVE,NOSAVEAREA);                  /*@Y30LB39*/ 04258000
*                                                                  1059 04259000
VS2RTN   DS    0H                                                  1060 04260000
*        /************************************************************/ 04261000
*        /*                                                  @Y30LB39*/ 04262000
*        /*  LOCAL DECLARATIONS                              @Y30LB39*/ 04263000
*        /*                                                  @Y30LB39*/ 04264000
*        /************************************************************/ 04265000
*                                                          /*@Y30LB39*/ 04266000
*        DCL VS2RTRC FIXED(8);         /* RETURN CODE        @Y30LB39*/ 04267000
*        DCL VOLVS02 CHAR(8) CONSTANT('IDCVS02 ');         /*@Y30LB39*/ 04268000
*                                      /* CHARACTER STRING   @Y30LB39*/ 04269000
*                                      /* USED TO IDENTIFY   @Y30LB39*/ 04270000
*                                      /* EXTERNAL ROUTINE.  @Y30LB39*/ 04271000
*                                                          /*@Y30LB39*/ 04272000
*                                                          /*@Y30LB39*/ 04273000
*        /************************************************************/ 04274000
*        /*                                                  @Y30LB39*/ 04275000
*        /*  SAVE THE ADDRESS OF THE CALLING PROCEDURE       @Y30LB39*/ 04276000
*        /*                                                  @Y30LB39*/ 04277000
*        /************************************************************/ 04278000
*                                                          /*@Y30LB39*/ 04279000
*        RETADDR2 = REG14;                                 /*@Y30LB39*/ 04280000
         LR    RETADDR2,REG14                                      1062 04281000
*                                                          /*@Y30LB39*/ 04282000
*        /************************************************************/ 04283000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 04284000
*        /*  ON CONTROL WITHIN THIS RECOVERV SUBROUTINE.     @Y30LB39*/ 04285000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 04286000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 04287000
*        /*                                                  @Y30LB39*/ 04288000
*        /************************************************************/ 04289000
*                                                          /*@Y30LB39*/ 04290000
*        OLDERID2 = NEWERID2;                                      1063 04291000
         L     @15,@PC00001                                        1063 04292000
         L     @15,GDTTR2(,@15)                                    1063 04293000
         MVC   @TS00001(95),NEWERID2(@15)                          1063 04294000
         MVC   OLDERID2(95,@15),@TS00001                           1063 04295000
*        NEWID2 = 'RVSV';                                  /*@Y30LB39*/ 04296000
         MVC   NEWID2(4,@15),@CC01625                              1064 04297000
*                                                          /*@Y30LB39*/ 04298000
*        /************************************************************/ 04299000
*        /*                                                  @Y30LB39*/ 04300000
*        /*  SET THE CONDITION CODE TO ZERO.                 @Y30LB39*/ 04301000
*        /*                                                  @Y30LB39*/ 04302000
*        /************************************************************/ 04303000
*                                                          /*@Y30LB39*/ 04304000
*        VS2RTRC = LASTCC00;                               /*@Y30LB39*/ 04305000
         SLR   VS2RTRC,VS2RTRC                                     1065 04306000
*                                                          /*@Y30LB39*/ 04307000
*        /************************************************************/ 04308000
*        /*                                                  @Y30LB39*/ 04309000
*        /*        INITIALIZE THE VS2AGL PARAMETER LIST      @Y30LB39*/ 04310000
*        /*                                                  @Y30LB39*/ 04311000
*        /************************************************************/ 04312000
*                                                          /*@Y30LB39*/ 04313000
*        VS2AGL = ''B;                                     /*@Y30LB39*/ 04314000
         LA    @15,VS2AGLBF                                        1066 04315000
         XC    VS2AGL(52,@15),VS2AGL(@15)                          1066 04316000
*        VS2RES = ON;                                      /*@Y30LB39*/ 04317000
         OI    VS2RES(@15),B'10000000'                             1067 04318000
*        VSUCBPTR = ADDR(RUNITUCB);                        /*@Y30LB39*/ 04319000
         LA    @14,RUNITUCB                                        1068 04320000
         ST    @14,VSUCBPTR(,@15)                                  1068 04321000
*        VSDDNAME = RUNITDDN;                              /*@Y30LB39*/ 04322000
         MVC   VSDDNAME(8,@15),RUNITDDN                            1069 04323000
*        VSVOLUME = TVOLVAL;                               /*@Y30LB39*/ 04324000
         L     @14,@PC00001+4                                      1070 04325000
         L     @01,FDTPTR+4(,@14)                                  1070 04326000
         MVC   VSVOLUME(6,@15),TVOLVAL(@01)                        1070 04327000
*        VS2TOV = ON;                                      /*@Y30LB39*/ 04328000
         OI    VS2TOV(@15),B'10000000'                             1071 04329000
*        IF COPOWNER ^= BASOWNER THEN                      /*@Y30LB39*/ 04330000
         CLC   COPOWNER(10,COPYVPTR),BASOWNER(BASEVPTR)            1072 04331000
         BE    @RF01072                                            1072 04332000
*          DO;                                             /*@Y30LB39*/ 04333000
*            VSOWNPTR = ADDR(BASOWNER);                    /*@Y30LB39*/ 04334000
         LA    @05,BASOWNER(,BASEVPTR)                             1074 04335000
         ST    @05,VSOWNPTR(,@15)                                  1074 04336000
*            VSOWNER = ON;                                 /*@Y30LB39*/ 04337000
         OI    VSOWNER(@15),B'10000000'                            1075 04338000
*          END;                                            /*@Y30LB39*/ 04339000
*        IF FVOLVAL ^= TVOLVAL THEN                        /*@Y30LB39*/ 04340000
@RF01072 L     @06,@PC00001+4                                      1077 04341000
         L     @05,FDTPTR(,@06)                                    1077 04342000
         L     @06,FDTPTR+4(,@06)                                  1077 04343000
         CLC   FVOLVAL(6,@05),TVOLVAL(@06)                         1077 04344000
         BE    @RF01077                                            1077 04345000
*          DO;                                             /*@Y30LB39*/ 04346000
*            VSVOLPTR = ADDR(TVOLVAL);                     /*@Y30LB39*/ 04347000
         LA    @05,VS2AGLBF                                        1079 04348000
         LA    @06,TVOLVAL(,@06)                                   1079 04349000
         ST    @06,VSVOLPTR(,@05)                                  1079 04350000
*            VSVOLSER = ON;                                /*@Y30LB39*/ 04351000
         OI    VSVOLSER(@05),B'01000000'                           1080 04352000
*          END;                                            /*@Y30LB39*/ 04353000
*                                                          /*@Y30LB39*/ 04354000
*        /************************************************************/ 04355000
*        /*                                                  @Y30LB39*/ 04356000
*        /*  ISSUE UDUMP MACRO PRIOR TO EXTERNAL CALL        @Y30LB39*/ 04357000
*        /*  TO PROVIDE A FULL REGION DUMP.                  @Y30LB39*/ 04358000
*        /*                                                  @Y30LB39*/ 04359000
*        /************************************************************/ 04360000
*                                                          /*@Y30LB39*/ 04361000
*        IF GDTDBG = NULLPTR                                       1082 04362000
*          THEN;                                                   1082 04363000
@RF01077 L     @06,@PC00001                                        1082 04364000
         L     @06,GDTDBG(,@06)                                    1082 04365000
         LTR   @06,@06                                             1082 04366000
         BZ    @RT01082                                            1082 04367000
*          ELSE                                                    1084 04368000
*            CALL IDCDB010 (GDTTBL,'RVSS');                        1084 04369000
         L     @06,@PC00001                                        1084 04370000
         ST    @06,@AL00001                                        1084 04371000
         LA    @05,@CC01626                                        1084 04372000
         ST    @05,@AL00001+4                                      1084 04373000
         MVI   @AL00001+4,X'80'                                    1084 04374000
         L     @15,GDTDBG(,@06)                                    1084 04375000
         LA    @01,@AL00001                                        1084 04376000
         BALR  @14,@15                                             1084 04377000
*                                                          /*@Y30LB39*/ 04378000
*                                                          /*@Y30LB39*/ 04379000
*                                                          /*@Y30LB39*/ 04380000
*        /************************************************************/ 04381000
*        /*                                                  @Y30LB39*/ 04382000
*        /*  CALL IDCVS02 TO UPDATE THE VOLUME LABEL.        @Y30LB39*/ 04383000
*        /*                                                  @Y30LB39*/ 04384000
*        /************************************************************/ 04385000
*                                                          /*@Y30LB39*/ 04386000
*        CALL IDCSACL0 (GDTTBL,VOLVS02,PUTLABEL,VS2AGL);   /*@Y30LB39*/ 04387000
@RT01082 L     @06,@PC00001                                        1085 04388000
         ST    @06,@AL00001                                        1085 04389000
         LA    @05,@CC01624                                        1085 04390000
         ST    @05,@AL00001+4                                      1085 04391000
         LA    @05,PUTLABEL                                        1085 04392000
         ST    @05,@AL00001+8                                      1085 04393000
         LA    @05,VS2AGLBF                                        1085 04394000
         ST    @05,@AL00001+12                                     1085 04395000
         MVI   @AL00001+12,X'80'                                   1085 04396000
         L     @15,GDTCAL(,@06)                                    1085 04397000
         LA    @01,@AL00001                                        1085 04398000
         BALR  @14,@15                                             1085 04399000
*                                                          /*@Y30LB39*/ 04400000
*        RESPECIFY RTNREG RSTD;                                    1086 04401000
*        TESTRC = RTNREG;                                          1087 04402000
         LR    TESTRC,RTNREG                                       1087 04403000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LB39*/ 04404000
*                                                          /*@Y30LB39*/ 04405000
*        /************************************************************/ 04406000
*        /*                                                  @Y30LB39*/ 04407000
*        /*  IF THE RETURN CODE FROM IDCVS02 IS NOT ZERO,    @Y30LB39*/ 04408000
*        /*  THEN SET CONDITION CODE TO FOUR IF THE RETURN   @Y30LB39*/ 04409000
*        /*  CODE IS FOUR OR SET CC04FLG ON IF RETURN        @Y30LB39*/ 04410000
*        /*  CODE IS EIGHT.                                  @Y30LB39*/ 04411000
*        /*                                                  @Y30LB39*/ 04412000
*        /************************************************************/ 04413000
*                                                          /*@Y30LB39*/ 04414000
*        IF TESTRC ^= 0 THEN                                       1089 04415000
         LTR   TESTRC,TESTRC                                       1089 04416000
         BZ    @RF01089                                            1089 04417000
*          IF TESTRC = 8 THEN                                      1090 04418000
         C     TESTRC,@CF00178                                     1090 04419000
         BNE   @RF01090                                            1090 04420000
*            CC04FLG = ON;                                 /*@Y30LB39*/ 04421000
         OI    CC04FLG,B'01000000'                                 1091 04422000
*          ELSE                                                    1092 04423000
*            IF TESTRC = LASTCC04 THEN                             1092 04424000
         B     @RC01090                                            1092 04425000
@RF01090 LA    @06,4                                               1092 04426000
         CR    TESTRC,@06                                          1092 04427000
         BNE   @RF01092                                            1092 04428000
*              VS2RTRC = LASTCC04;                         /*@Y30LB39*/ 04429000
         LR    VS2RTRC,@06                                         1093 04430000
*                                                          /*@Y30LB39*/ 04431000
*        /************************************************************/ 04432000
*        /*                                                  @Y30LB39*/ 04433000
*        /*  RESTORE THE ADDRESS OF THE CALLING PROCEDURE    @Y30LB39*/ 04434000
*        /*                                                  @Y30LB39*/ 04435000
*        /************************************************************/ 04436000
*                                                          /*@Y30LB39*/ 04437000
*        REG14 = RETADDR2;                                 /*@Y30LB39*/ 04438000
@RF01092 DS    0H                                                  1094 04439000
@RC01090 DS    0H                                                  1094 04440000
@RF01089 LR    REG14,RETADDR2                                      1094 04441000
*                                                          /*@Y30LB39*/ 04442000
*        /************************************************************/ 04443000
*        /*                                                  @Y30LB39*/ 04444000
*        /*  RETURN TO CALLER WITH REGISTER 15               @Y30LB39*/ 04445000
*        /*  CONTAINING THE RETURN CODE.                     @Y30LB39*/ 04446000
*        /*                                                  @Y30LB39*/ 04447000
*        /************************************************************/ 04448000
*                                                          /*@Y30LB39*/ 04449000
*        RETURN CODE(VS2RTRC);                             /*@Y30LB39*/ 04450000
         LR    @15,VS2RTRC                                         1095 04451000
@EL00013 DS    0H                                                  1095 04452000
@EF00013 DS    0H                                                  1095 04453000
@ER00013 BR    @14                                                 1095 04454000
*END VS2RTN;                                               /*@Y30LB39*/ 04455000
*        /************************************************************/ 04456000
*        /*                                                  @Y30LB39*/ 04457000
*        /*  THE NEXT ROUTINE IS INCLUDED IN IDCCO01 TO      @Y30LB39*/ 04458000
*        /*  OUTPUT SSC MESSAGES.                            @Y30LB39*/ 04459000
*        /*                                                  @Y30LB39*/ 04460000
*        /************************************************************/ 04461000
*                                                          /*@Y30LB39*/ 04462000
*/***********************************************************@Y30LB39*/ 04463000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 04464000
*/*                                                          @Y30LB39*/ 04465000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 04466000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 04467000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 04468000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 04469000
*/*                                                          @Y30LB39*/ 04470000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 04471000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 04472000
*/*   IN SSECBCD.                                            @Y30LB39*/ 04473000
*/*                                                          @Y30LB39*/ 04474000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 04475000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 04476000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 04477000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 04478000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 04479000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 04480000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 04481000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 04482000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 04483000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 04484000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 04485000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 04486000
*/*                                                          @Y30LB39*/ 04487000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 04488000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 04489000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 04490000
*/*                                                          @Y30LB39*/ 04491000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 04492000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 04493000
*/*                                                          @Y30LB39*/ 04494000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 04495000
*/*                                                          @Y30LB39*/ 04496000
*/***********************************************************@Y30LB39*/ 04497000
*                                                          /*@Y30LB39*/ 04498000
*SSCMSG: PROCEDURE(SSRCODE,            /* SSC RETURN CODE    @Y30LB39*/ 04499000
*                  SSECBCD);           /* ECB POST CODE      @Y30LB39*/ 04500000
SSCMSG   STM   @14,@12,@SA00014                                    1097 04501000
         MVC   @PC00014(8),0(@01)                                  1097 04502000
*                                                          /*@Y30LB39*/ 04503000
*                                                          /*@Y30LB39*/ 04504000
*        /************************************************************/ 04505000
*        /*                                                  @Y30LB39*/ 04506000
*        /*  DECLARATIONS FOR THE SSCMSG PROCEDURE           @Y30LB39*/ 04507000
*        /*                                                  @Y30LB39*/ 04508000
*        /************************************************************/ 04509000
*                                                          /*@Y30LB39*/ 04510000
*                                                          /*@Y30LB39*/ 04511000
*        /************************************************************/ 04512000
*        /*                                                  @Y30LB39*/ 04513000
*        /*  THE NEXT TWO DECLARES ARE FOR THE TWO INPUT     @Y30LB39*/ 04514000
*        /*  ARGUMENTS. 1ST - MSSC REASON CODE OR            @Y30LB39*/ 04515000
*        /*  2ND - MSSC POST CODE                            @Y30LB39*/ 04516000
*        /*                                                  @Y30LB39*/ 04517000
*        /************************************************************/ 04518000
*                                                          /*@Y30LB39*/ 04519000
*        DCL 1 SSRCODE FIXED(31),                          /*@Y30LB39*/ 04520000
*              3 * FIXED(15),                              /*@Y30LB39*/ 04521000
*              3 SSRHALF FIXED(15);    /*1ST ARG REASON CODE @Y30LB39*/ 04522000
*        DCL SSECBCD PTR(8);           /*2ND ARG POST CODE   @Y30LB39*/ 04523000
*                                                          /*@Y30LB39*/ 04524000
*                                                          /*@Y30LB39*/ 04525000
*        /************************************************************/ 04526000
*        /*                                                  @Y30LB39*/ 04527000
*        /*  DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND @Y30LB39*/ 04528000
*        /*  CONTAIN THE "LOCAL" PRINT ARGUMENT LIST         @Y30LB39*/ 04529000
*        /*                                                  @Y30LB39*/ 04530000
*        /************************************************************/ 04531000
*                                                          /*@Y30LB39*/ 04532000
*        DCL SSDLPTR PTR(31);                              /*@Y30LB39*/ 04533000
*        DCL SSDRGLT CHAR(LENGTH(DARGLIST));               /*@Y30LB39*/ 04534000
*                                                          /*@Y30LB39*/ 04535000
*        /************************************************************/ 04536000
*        /*                                                  @Y30LB39*/ 04537000
*        /*  THE NEXT DECLARE IS FOR THE INDEX WHICH IS      @Y30LB39*/ 04538000
*        /*  INCREMENTED WHILE SEARCHING THE ARRAY OF        @Y30LB39*/ 04539000
*        /*  REASON CODES AND, UPON FINDING THE CORRECT      @Y30LB39*/ 04540000
*        /*  REASON CODE, IS PASSED TO PRINT MODULE AS THE   @Y30LB39*/ 04541000
*        /*  INDEX OF THE MESSAGE NUMBER TO BE PRINTED.      @Y30LB39*/ 04542000
*        /*                                                  @Y30LB39*/ 04543000
*        /************************************************************/ 04544000
*                                                          /*@Y30LB39*/ 04545000
*        DECLARE ENTRYNUM FIXED(8) UNSIGNED;               /*@Y30LB39*/ 04546000
*                                                          /*@Y30LB39*/ 04547000
*        /************************************************************/ 04548000
*        /*                                                  @Y30LB39*/ 04549000
*        /*  THE NEXT DECLARE IS FOR THE COMMON MESSAGE      @Y30LB39*/ 04550000
*        /*  NUMBER TO IDENTIFY THE ECB POST CODE            @Y30LB39*/ 04551000
*        /*  MESSAGE CONTAINED IN STATIC TEXT MODULE         @Y30LB39*/ 04552000
*        /*  IDCTSCM0.                                       @Y30LB39*/ 04553000
*        /*                                                  @Y30LB39*/ 04554000
*        /************************************************************/ 04555000
*                                                          /*@Y30LB39*/ 04556000
*        DECLARE SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);  /*@Y30LB39*/ 04557000
*                                                          /*@Y30LB39*/ 04558000
*        /************************************************************/ 04559000
*        /*                                                  @Y30LB39*/ 04560000
*        /*  THE NEXT DECLARE IS FOR THE ARRAY WHICH IS      @Y30LB39*/ 04561000
*        /*  SEARCHED FOR THE REASON CODE CORRESPONDING      @Y30LB39*/ 04562000
*        /*  TO THE MESSAGE INDEX AND ULTIMATELY, THE        @Y30LB39*/ 04563000
*        /*  MESSAGE TEXT TO BE PRINTED TO THE USER TELLING  @Y30LB39*/ 04564000
*        /*  HIM OF THE EXACT REASON FOR THE MSSC FAILURE.   @Y30LB39*/ 04565000
*        /*                                                  @Y30LB39*/ 04566000
*        /************************************************************/ 04567000
*                                                          /*@Y30LB39*/ 04568000
*        DECLARE 1 SSINXLST BDY(WORD),                     /*@Y30LB39*/ 04569000
*                  3 SSARRAY (60) FIXED(15);               /*@Y30LB39*/ 04570000
*                                                          /*@Y30LB39*/ 04571000
*        /************************************************************/ 04572000
*        /*                                                  @Y30LB39*/ 04573000
*        /*  THE NEXT DECLARATION IS FOR THE MESSAGE ID      @Y30LB39*/ 04574000
*        /*  USED BY THE STATIC TEXT MODULE - IDCTSSS0.      @Y30LB39*/ 04575000
*        /*                                                  @Y30LB39*/ 04576000
*        /************************************************************/ 04577000
*                                                          /*@Y30LB39*/ 04578000
*        DECLARE SSMODSS0 CHAR(3) STATIC INIT('SS0');      /*@Y30LB39*/ 04579000
*                                                          /*@Y30LB39*/ 04580000
*        /************************************************************/ 04581000
*        /*                                                  @Y30LB39*/ 04582000
*        /*  THE NEXT DECLARATION IS FOR THE MESSAGE ID      @Y30LB39*/ 04583000
*        /*  USED BY THE STATIC TEXT MODULE - IDCTSCMO.      @Y30LB39*/ 04584000
*        /*                                                  @Y30LB39*/ 04585000
*        /************************************************************/ 04586000
*                                                          /*@Y30LB39*/ 04587000
*        DECLARE SSMODCM0 CHAR(3) STATIC INIT('CM0');      /*@Y30LB39*/ 04588000
*                                                          /*@Y30LB39*/ 04589000
*                                                          /*@Y30LB39*/ 04590000
*        /************************************************************/ 04591000
*        /*  ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW   @Y30LB39*/ 04592000
*        /*  ON CONTROL WITHIN THE SSMSG MODULE.             @Y30LB39*/ 04593000
*        /*  THIS WILL PLACE THE IDENTIFIER SPECIFIED IN     @Y30LB39*/ 04594000
*        /*  A SEPARATE INTRA-MODULE TRACE TABLE.            @Y30LB39*/ 04595000
*        /*                                                  @Y30LB39*/ 04596000
*        /************************************************************/ 04597000
*                                                          /*@Y30LB39*/ 04598000
*        OLDERID2 = NEWERID2;                                      1107 04599000
         L     @15,@PC00001                                        1107 04600000
         L     @14,GDTTR2(,@15)                                    1107 04601000
         MVC   @TS00001(95),NEWERID2(@14)                          1107 04602000
         MVC   OLDERID2(95,@14),@TS00001                           1107 04603000
*        NEWID2 = 'SSAA';                                  /*@Y30LB39*/ 04604000
         MVC   NEWID2(4,@14),@CC01647                              1108 04605000
*                                                          /*@Y30LB39*/ 04606000
*        /************************************************************/ 04607000
*        /*                                                  @Y30LB39*/ 04608000
*        /*  ESTABLISH ADDRESSABILITY TO THE DYNAMIC         @Y30LB39*/ 04609000
*        /*  ARGUMENT LIST.                                  @Y30LB39*/ 04610000
*        /*                                                  @Y30LB39*/ 04611000
*        /************************************************************/ 04612000
*                                                          /*@Y30LB39*/ 04613000
*        SSDLPTR = ADDR(SSDRGLT);                          /*@Y30LB39*/ 04614000
         LA    @14,SSDRGLT                                         1109 04615000
         ST    @14,SSDLPTR                                         1109 04616000
*                                                          /*@Y30LB39*/ 04617000
*        /************************************************************/ 04618000
*        /*                                                  @Y30LB39*/ 04619000
*        /*  IF THE REASON CODE IS NOT ZERO, READ IN THE     @Y30LB39*/ 04620000
*        /*  ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.   @Y30LB39*/ 04621000
*        /*                                                  @Y30LB39*/ 04622000
*        /************************************************************/ 04623000
*                                                          /*@Y30LB39*/ 04624000
*        IF SSRCODE > 0 THEN                                       1110 04625000
         L     @09,@PC00014                                        1110 04626000
         L     @09,SSRCODE(,@09)                                   1110 04627000
         LTR   @09,@09                                             1110 04628000
         BNP   @RF01110                                            1110 04629000
*          DO;                                             /*@Y30LB39*/ 04630000
*                                                          /*@Y30LB39*/ 04631000
*            /********************************************************/ 04632000
*            /*                                              @Y30LB39*/ 04633000
*            /*  CLEAR THE DYNAMIC ARGUMENT LIST AND         @Y30LB39*/ 04634000
*            /*  INITIALIZE THE PRINT ARGUMENT LIST TO READ  @Y30LB39*/ 04635000
*            /*  IN THE ARRAY WHICH CONTAINS THE MSSC REASON @Y30LB39*/ 04636000
*            /*  CODES.                                      @Y30LB39*/ 04637000
*            /*                                              @Y30LB39*/ 04638000
*            /********************************************************/ 04639000
*                                                          /*@Y30LB39*/ 04640000
*            SSDRGLT = ''B;                                /*@Y30LB39*/ 04641000
         XC    SSDRGLT(20),SSDRGLT                                 1112 04642000
*            SSDLPTR -> DARGRETP = ADDR(SSINXLST);         /*@Y30LB39*/ 04643000
         LA    @03,SSINXLST                                        1113 04644000
         ST    @03,DARGRETP(,@14)                                  1113 04645000
*            SSDLPTR -> DARGSMOD = SSMODSS0;               /*@Y30LB39*/ 04646000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1114 04647000
*            SSDLPTR -> DARGSENT = 1;                      /*@Y30LB39*/ 04648000
         MVI   DARGSENT(@14),X'01'                                 1115 04649000
*            SSDLPTR -> DARGRETL = LENGTH(SSINXLST);       /*@Y30LB39*/ 04650000
         MVC   DARGRETL(2,@14),@CH01654                            1116 04651000
*                                                          /*@Y30LB39*/ 04652000
*            /********************************************************/ 04653000
*            /*                                              @Y30LB39*/ 04654000
*            /*  ISSUE UPRINT MACRO TO READ IN THE SEARCH    @Y30LB39*/ 04655000
*            /*  ARRAY.                                      @Y30LB39*/ 04656000
*            /*                                              @Y30LB39*/ 04657000
*            /********************************************************/ 04658000
*                                                          /*@Y30LB39*/ 04659000
*            CALL AMSTP011 (GDTTBL,PRTFILE,SSDLPTR);       /*@Y30LB39*/ 04660000
         ST    @15,@AL00001                                        1117 04661000
         LA    @03,@CF00114                                        1117 04662000
         ST    @03,@AL00001+4                                      1117 04663000
         LA    @03,SSDLPTR                                         1117 04664000
         ST    @03,@AL00001+8                                      1117 04665000
         MVI   @AL00001+8,X'80'                                    1117 04666000
         L     @15,GDTPRT(,@15)                                    1117 04667000
         LA    @01,@AL00001                                        1117 04668000
         BALR  @14,@15                                             1117 04669000
*                                                          /*@Y30LB39*/ 04670000
*            /********************************************************/ 04671000
*            /*                                              @Y30LB39*/ 04672000
*            /*  BEGIN DO LOOP TO SEARCH FOR THE MESSAGE     @Y30LB39*/ 04673000
*            /*  INDEX CORRESPONDING TO THE REASON CODE      @Y30LB39*/ 04674000
*            /*  PASSED AS THE FIRST ARGUMENT.               @Y30LB39*/ 04675000
*            /*  THE DO LOOP BEGINS WITH THE SECOND ARRAY    @Y30LB39*/ 04676000
*            /*  ENTRY SINCE THE FIRST IS REQUIRED BY THE    @Y30LB39*/ 04677000
*            /*  SEARCH ARRAY ITSELF.                        @Y30LB39*/ 04678000
*            /*  THE SEARCH CONTINUES UNTIL THE REASON CODE  @Y30LB39*/ 04679000
*            /*  IS FOUND, AT WHICH TIME THE SEARCH INDEX    @Y30LB39*/ 04680000
*            /*  IS PASSED TO THE PRINT MODULE TO PRINT      @Y30LB39*/ 04681000
*            /*  THE MESSAGE ASSOCIATED WITH THAT PARTICULAR @Y30LB39*/ 04682000
*            /*  REASON CODE.                                @Y30LB39*/ 04683000
*            /*  IF THERE IS NO MATCH FOUND IN THE ARRAY,    @Y30LB39*/ 04684000
*            /*  THEN THE INDEX WILL BE THE LAST POSITION IN @Y30LB39*/ 04685000
*            /*  ARRAY.  THIS WILL BE THE INDICATION THAT    @Y30LB39*/ 04686000
*            /*  THE REASON CODE ITSELF SHOULD BE PRINTED.   @Y30LB39*/ 04687000
*            /*                                              @Y30LB39*/ 04688000
*            /********************************************************/ 04689000
*                                                          /*@Y30LB39*/ 04690000
*            ENTRYNUM = 1;                                 /*@Y30LB39*/ 04691000
         LA    ENTRYNUM,1                                          1118 04692000
*            DO UNTIL (SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);  04693000
@DL01119 DS    0H                                                  1120 04694000
*              ENTRYNUM = ENTRYNUM + 1;                    /*@Y30LB39*/ 04695000
         AL    ENTRYNUM,@CF00218                                   1120 04696000
*            END;                                          /*@Y30LB39*/ 04697000
@DE01119 L     @03,@PC00014                                        1121 04698000
         LR    @15,ENTRYNUM                                        1121 04699000
         ALR   @15,@15                                             1121 04700000
         LH    @15,SSARRAY-2(@15)                                  1121 04701000
         CH    @15,SSRHALF(,@03)                                   1121 04702000
         BE    @DC01119                                            1121 04703000
         SLR   @14,@14                                             1121 04704000
         CR    @15,@14                                             1121 04705000
         BNE   @DL01119                                            1121 04706000
@DC01119 DS    0H                                                  1122 04707000
*                                                          /*@Y30LB39*/ 04708000
*            /********************************************************/ 04709000
*            /*                                              @Y30LB39*/ 04710000
*            /*  THE CORRECT INDEX HAS BEEN FOUND            @Y30LB39*/ 04711000
*            /*                                              @Y30LB39*/ 04712000
*            /*  CLEAR THE DYNAMIC ARGUMENT LIST AND FILL    @Y30LB39*/ 04713000
*            /*  OUT THE PRINT ARGUMENT FIELDS WITH EITHER:  @Y30LB39*/ 04714000
*            /*    1) THE INDEX CORRESPONDING TO THE REASON  @Y30LB39*/ 04715000
*            /*       CODE OR                                @Y30LB39*/ 04716000
*            /*    2) THE LAST INDEX AND THE REASON CODE     @Y30LB39*/ 04717000
*            /*       ITSELF AS A STATIC TEXT INSERT.        @Y30LB39*/ 04718000
*            /*                                              @Y30LB39*/ 04719000
*            /********************************************************/ 04720000
*                                                          /*@Y30LB39*/ 04721000
*            SSDRGLT = ''B;                                /*@Y30LB39*/ 04722000
         XC    SSDRGLT(20),SSDRGLT                                 1122 04723000
*            SSDLPTR -> DARGSMOD = SSMODSS0;               /*@Y30LB39*/ 04724000
         L     @09,SSDLPTR                                         1123 04725000
         MVC   DARGSMOD(3,@09),SSMODSS0                            1123 04726000
*            SSDLPTR -> DARGSENT = ENTRYNUM;               /*@Y30LB39*/ 04727000
         STC   ENTRYNUM,DARGSENT(,@09)                             1124 04728000
*            IF SSARRAY(ENTRYNUM) = 0 THEN                 /*@Y30LB39*/ 04729000
         CR    @15,@14                                             1125 04730000
         BNE   @RF01125                                            1125 04731000
*              DO;                                         /*@Y30LB39*/ 04732000
*                SSDLPTR -> DARGDBP = ADDR(SSRCODE);       /*@Y30LB39*/ 04733000
         ST    @03,DARGDBP(,@09)                                   1127 04734000
*                SSDLPTR -> DARGILP = LENGTH(SSRCODE);     /*@Y30LB39*/ 04735000
         MVC   DARGILP(2,@09),@CH00041                             1128 04736000
*              END;                                        /*@Y30LB39*/ 04737000
*          END;                                            /*@Y30LB39*/ 04738000
*                                                          /*@Y30LB39*/ 04739000
*        /************************************************************/ 04740000
*        /*                                                  @Y30LB39*/ 04741000
*        /*  THE FIRST ARGUMENT WAS ZERO, INDICATING THAT    @Y30LB39*/ 04742000
*        /*  THIS ROUTINE IS TO PRINT OUT THE ECB POST       @Y30LB39*/ 04743000
*        /*  CODE.  THEREFORE, CLEAR THE DYNAMIC ARGUMENT    @Y30LB39*/ 04744000
*        /*  LIST AND FILL OUT THE PRINT ARGUMENT FIELDS     @Y30LB39*/ 04745000
*        /*  SO THE STATIC TEXT MODULE, IDCTSCM0, WILL       @Y30LB39*/ 04746000
*        /*  PRINT OUT THE MESSAGE ASSOCIATED WITH THE       @Y30LB39*/ 04747000
*        /*  POST CODE.                                      @Y30LB39*/ 04748000
*        /*                                                  @Y30LB39*/ 04749000
*        /************************************************************/ 04750000
*                                                          /*@Y30LB39*/ 04751000
*        ELSE                                              /*@Y30LB39*/ 04752000
*          DO;                                             /*@Y30LB39*/ 04753000
         B     @RC01110                                            1131 04754000
@RF01110 DS    0H                                                  1132 04755000
*            SSDRGLT = ''B;                                /*@Y30LB39*/ 04756000
         XC    SSDRGLT(20),SSDRGLT                                 1132 04757000
*            SSDLPTR -> DARGSMOD = SSMODCM0;               /*@Y30LB39*/ 04758000
         L     @15,SSDLPTR                                         1133 04759000
         MVC   DARGSMOD(3,@15),SSMODCM0                            1133 04760000
*            SSDLPTR -> DARGSENT = SSMSGNUM;               /*@Y30LB39*/ 04761000
         MVC   DARGSENT(1,@15),SSMSGNUM                            1134 04762000
*            SSDLPTR -> DARGDBP = ADDR(SSECBCD);           /*@Y30LB39*/ 04763000
         L     @14,@PC00014+4                                      1135 04764000
         ST    @14,DARGDBP(,@15)                                   1135 04765000
*            SSDLPTR -> DARGILP = LENGTH(SSECBCD);         /*@Y30LB39*/ 04766000
         MVC   DARGILP(2,@15),@CH00218                             1136 04767000
*          END;                                            /*@Y30LB39*/ 04768000
*                                                          /*@Y30LB39*/ 04769000
*        /************************************************************/ 04770000
*        /*                                                  @Y30LB39*/ 04771000
*        /*  ISSUE UPRINT MACRO TO PRINT THE REASON          @Y30LB39*/ 04772000
*        /*  CODE MESSAGE OR THE ECB POST CODE MESSAGE.      @Y30LB39*/ 04773000
*        /*                                                  @Y30LB39*/ 04774000
*        /************************************************************/ 04775000
*                                                          /*@Y30LB39*/ 04776000
*        CALL AMSTP011 (GDTTBL,PRTFILE,SSDLPTR);           /*@Y30LB39*/ 04777000
@RC01110 L     @15,@PC00001                                        1138 04778000
         ST    @15,@AL00001                                        1138 04779000
         LA    @14,@CF00114                                        1138 04780000
         ST    @14,@AL00001+4                                      1138 04781000
         LA    @14,SSDLPTR                                         1138 04782000
         ST    @14,@AL00001+8                                      1138 04783000
         MVI   @AL00001+8,X'80'                                    1138 04784000
         L     @15,GDTPRT(,@15)                                    1138 04785000
         LA    @01,@AL00001                                        1138 04786000
         BALR  @14,@15                                             1138 04787000
*                                                          /*@Y30LB39*/ 04788000
*        /************************************************************/ 04789000
*        /*                                                  @Y30LB39*/ 04790000
*        /*  RETURN TO CALLER WITH A RETURN CODE OF ZERO     @Y30LB39*/ 04791000
*        /*                                                  @Y30LB39*/ 04792000
*        /************************************************************/ 04793000
*                                                          /*@Y30LB39*/ 04794000
*                                                          /*@Y30LB39*/ 04795000
*        RETURN CODE(0);                                   /*@Y30LB39*/ 04796000
         SLR   @15,@15                                             1139 04797000
         L     @14,@SA00014                                        1139 04798000
         LM    @00,@12,@SA00014+8                                  1139 04799000
         BR    @14                                                 1139 04800000
*                                                          /*@Y30LB39*/ 04801000
*        END SSCMSG;                                       /*@Y30LB39*/ 04802000
*END IDCRV01                                               /*@Y30LB39*/ 04803000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 04804000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 04805000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 04806000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 04807000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                        * 04808000
*/*%INCLUDE SYSLIB  (IDCCSRV )                                        * 04809000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                        * 04810000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                        * 04811000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                        * 04812000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                        * 04813000
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                        * 04814000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                        * 04815000
*;                                                                 1141 04816000
@DATA    DS    0H                                                       04817000
@CH00152 DC    H'2'                                                     04818000
@CH00041 DC    H'4'                                                     04819000
@CH00285 DC    H'5'                                                     04820000
@CH00847 DC    H'29'                                                    04821000
@CH01209 DC    H'30'                                                    04822000
@CH00043 DC    H'31'                                                    04823000
@CH01652 DC    H'40'                                                    04824000
@CH01503 DC    H'43'                                                    04825000
@CH01653 DC    H'88'                                                    04826000
@CH01654 DC    H'120'                                                   04827000
@CH01649 DC    H'164'                                                   04828000
@CH01648 DC    H'224'                                                   04829000
         DS    0F                                                       04830000
@AL00282 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)        04831000
         DC    A(WAIT)                                                  04832000
         DC    A(@CC01523)                                              04833000
@DATD    DSECT                                                          04834000
         DS    0F                                                       04835000
@SA00001 DS    18F                                                      04836000
@PC00001 DS    3F                                                       04837000
@SA00014 DS    15F                                                      04838000
@PC00014 DS    2F                                                       04839000
@AL00001 DS    5A                                                       04840000
@AFTEMPS DS    4F                                                       04841000
IDCRV01  CSECT                                                          04842000
         DS    0F                                                       04843000
@CF00114 DC    F'0'                                                     04844000
@CF00218 DC    F'1'                                                     04845000
@CH00218 EQU   @CF00218+2                                               04846000
@CF00178 DC    F'8'                                                     04847000
@CF00567 DC    F'12'                                                    04848000
@CH00567 EQU   @CF00567+2                                               04849000
@CF00473 DC    F'16'                                                    04850000
@CF01669 DC    XL4'0000FFFF'                                            04851000
@DATD    DSECT                                                          04852000
         DS    0D                                                       04853000
LISTSCAN DS    A                                                        04854000
IOCSPTR  DS    A                                                        04855000
OPNPTR   DS    A                                                        04856000
DDSTRU   DS    A                                                        04857000
FSADDR   DS    A                                                        04858000
ERCNVADR DS    A                                                        04859000
CCMSGPTR DS    A                                                        04860000
CMMSGPTR DS    A                                                        04861000
CTMSGPTR DS    A                                                        04862000
ELEMENT  DS    F                                                        04863000
RVVIPTR  DS    A                                                        04864000
MVRPTR   DS    A                                                        04865000
COVCPTR  DS    A                                                        04866000
COVCEPTR DS    A                                                        04867000
REASON   DS    F                                                        04868000
RETADDR1 DS    A                                                        04869000
SEQ#XVAL DS    F                                                        04870000
SSDLPTR  DS    A                                                        04871000
LISTPTR  DS    A                                                        04872000
SETRC    DS    H                                                        04873000
ECBBYTE  DS    FL1                                                      04874000
SETUPRC  DS    FL1                                                      04875000
LISTLN   DS    FL1                                                      04876000
         DS    0D                                                       04877000
@TS00001 DS    CL95                                                     04878000
         DS    CL1                                                      04879000
PRINTTAB DS    CL44                                                     04880000
ALLAGLBF DS    CL31                                                     04881000
         DS    CL1                                                      04882000
CKAGLBUF DS    CL29                                                     04883000
         DS    CL3                                                      04884000
VS1AGLBF DS    CL74                                                     04885000
         DS    CL2                                                      04886000
VS2AGLBF DS    CL52                                                     04887000
MDAGLBUF DS    CL37                                                     04888000
         DS    CL3                                                      04889000
COVCEBUF DS    CL43                                                     04890000
         DS    CL1                                                      04891000
MVRBUFR  DS    CL88                                                     04892000
RVVIBUFR DS    CL68                                                     04893000
COVLISTB DS    CL40                                                     04894000
EXCLAGLB DS    CL23                                                     04895000
         DS    CL1                                                      04896000
BASVOLBD DS    CL224                                                    04897000
COPVOLBD DS    CL164                                                    04898000
RECVTBL  DS    CL25                                                     04899000
         ORG   RECVTBL                                                  04900000
RECVTBC  DS    CL8                                                      04901000
RUNITUCB DS    AL4                                                      04902000
RUNITDDN DS    CL8                                                      04903000
RECTYPE  DS    CL4                                                      04904000
RECVFLGS DS    BL1                                                      04905000
         ORG   RECVFLGS                                                 04906000
ALLOCFLG DS    BL1                                                      04907000
CC04FLG  EQU   RECVFLGS+0                                               04908000
MOUNTFLG EQU   RECVFLGS+0                                               04909000
WAITFLG  EQU   RECVFLGS+0                                               04910000
GETDDFLG EQU   RECVFLGS+0                                               04911000
DEMNTFLG EQU   RECVFLGS+0                                               04912000
@NM00115 EQU   RECVFLGS+0                                               04913000
         ORG   RECVTBL+25                                               04914000
MINORNAM DS    CL23                                                     04915000
         ORG   MINORNAM                                                 04916000
RNAMLNTH DS    FL1                                                      04917000
RNAMCHAR DS    CL22                                                     04918000
         ORG   MINORNAM+23                                              04919000
RVULLIST DS    CL9                                                      04920000
         ORG   RVULLIST                                                 04921000
RVULNUM  DS    FL2                                                      04922000
RVULARAY DS    CL7                                                      04923000
         ORG   RVULARAY                                                 04924000
RVULLNTH DS    FL2                                                      04925000
RVULTYPE DS    CL5                                                      04926000
         ORG   RVULLIST+9                                               04927000
         DS    CL3                                                      04928000
VOLSERLT DS    CL10                                                     04929000
         ORG   VOLSERLT                                                 04930000
VOLNUMBR DS    FL2                                                      04931000
VOLARRAY DS    CL8                                                      04932000
         ORG   VOLARRAY                                                 04933000
VOLLENTH DS    FL2                                                      04934000
VOLSERNM DS    CL6                                                      04935000
         ORG   VOLSERLT+10                                              04936000
         DS    CL2                                                      04937000
DUMPLIST DS    CL33                                                     04938000
DATECHAR DS    CL4                                                      04939000
SSDRGLT  DS    CL20                                                     04940000
         DS    CL3                                                      04941000
SSINXLST DS    CL120                                                    04942000
         ORG   SSINXLST                                                 04943000
SSARRAY  DS    60H                                                      04944000
         ORG   SSINXLST+120                                             04945000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04946000
@ENDDATD EQU   *                                                        04947000
IDCRV01  CSECT                                                          04948000
         DS    0F                                                       04949000
@SIZDATD DC    AL1(0)                                                   04950000
         DC    AL3(@ENDDATD-@DATD)                                      04951000
         DS    0D                                                       04952000
NOTFOUND DC    F'520'                                                   04953000
SEQ#DFLT DC    F'1'                                                     04954000
RVVLEN   DC    AL2(68)                                                  04955000
MVRLEN   DC    AL2(88)                                                  04956000
COVLEN   DC    AL2(43)                                                  04957000
ONEZERO  DC    AL1(0)                                                   04958000
SSMSGNUM DC    AL1(56)                                                  04959000
@CC01521 DC    C'.VIRTUAL.ENQUEUE'                                      04960000
@CC01588 DC    C'.VIRTUAL.RESERVE'                                      04961000
@CC01520 DC    C'RECVTBL '                                              04962000
@CC01523 DC    C'SYSZAMS '                                              04963000
@CC01576 DC    C'ALLAGLBF'                                              04964000
@CC01578 DC    C'CKAGLBUF'                                              04965000
@CC01585 DC    C'IDCVS01 '                                              04966000
@CC01596 DC    C'COVLISTB'                                              04967000
@CC01597 DC    C'COVCEBUF'                                              04968000
@CC01624 DC    C'IDCVS02 '                                              04969000
@CC01610 DC    C'MVRBUFR'                                               04970000
@CC01575 DC    C'3330V'                                                 04971000
@CC01505 DC    C'RVST'                                                  04972000
@CC01506 DC    C'RVBG'                                                  04973000
@CC01528 DC    C'RVND'                                                  04974000
@CC01533 DC    C'RVSU'                                                  04975000
@CC01541 DC    C'RVVO'                                                  04976000
@CC01554 DC    C'RVRV'                                                  04977000
@CC01556 DC    C'RVVI'                                                  04978000
@CC01558 DC    C'RVRR'                                                  04979000
@CC01564 DC    C'RVFV'                                                  04980000
@CC01569 DC    C'RVTV'                                                  04981000
@CC01574 DC    C'RVAL'                                                  04982000
@CC01577 DC    C'RVAA'                                                  04983000
@CC01579 DC    C'RVBB'                                                  04984000
@CC01586 DC    C'RVVS'                                                  04985000
@CC01587 DC    C'RVCH'                                                  04986000
@CC01594 DC    C'RVCP'                                                  04987000
@CC01595 DC    C'RVHH'                                                  04988000
@CC01598 DC    C'RVEE'                                                  04989000
@CC01604 DC    C'RVVP'                                                  04990000
@CC01609 DC    C'RVMV'                                                  04991000
@CC01611 DC    C'RVFF'                                                  04992000
@CC01616 DC    C'RVLB'                                                  04993000
@CC01617 DC    C'RVII'                                                  04994000
@CC01625 DC    C'RVSV'                                                  04995000
@CC01626 DC    C'RVSS'                                                  04996000
@CC01647 DC    C'SSAA'                                                  04997000
@CC01458 DC    C'RV0'                                                   04998000
@CC01460 DC    C'CM0'                                                   04999000
@CC01462 DC    C'UV0'                                                   05000000
ALL      DC    CL3'ALL'                                                 05001000
FORMAT   DC    CL4'FORM'                                                05002000
HSECOND  DC    CL4'HSEC'                                                05003000
CLOCK    DC    CL4'KLOK'                                                05004000
SETZERO  DC    CL4'ZERO'                                                05005000
SETBLANK DC    CL4'BLNK'                                                05006000
NOSET    DC    CL4'NSET'                                                05007000
OVERRIDE DC    CL4'OVRD'                                                05008000
ACQUIRE  DC    CL8'ACQUIRE '                                            05009000
RELINQ   DC    CL8'RELINQ  '                                            05010000
MOUNT    DC    CL8'MOUNT   '                                            05011000
DEMOUNT  DC    CL8'DEMOUNT '                                            05012000
DEFINE   DC    CL8'DEFINE  '                                            05013000
MOVE     DC    CL8'MOVE    '                                            05014000
TRACEQ   DC    CL8'TRACEQ  '                                            05015000
COPYTABL DC    CL8'COPYTABL'                                            05016000
COPYCRTG DC    CL8'COPYCRTG'                                            05017000
COPYVOL  DC    CL8'COPYVOL '                                            05018000
VVIC     DC    CL8'VVIC    '                                            05019000
TUNE     DC    CL8'TUNE    '                                            05020000
NAMES    DC    CL4'NAME'                                                05021000
UNIT     DC    CL4'UNIT'                                                05022000
SHR      DC    CL4'SHR '                                                05023000
EXCL     DC    CL4'EXCL'                                                05024000
NOWAIT   DC    CL4'NWAI'                                                05025000
WAIT     DC    CL4'WAIT'                                                05026000
SECCHECK DC    CL8'SECCHECK'                                            05027000
SCRVTOC  DC    CL8'SCRVTOC '                                            05028000
GETVTOC  DC    CL8'GETVTOC '                                            05029000
PUTVTOC  DC    CL8'PUTVTOC '                                            05030000
RECATLG  DC    CL8'RECATLG '                                            05031000
INITVOL  DC    CL8'INITVOL '                                            05032000
CHECK    DC    CL8'CHECK   '                                            05033000
POSTUCB  DC    CL8'POSTUCB '                                            05034000
GET      DC    CL8'GET     '                                            05035000
PUT      DC    CL8'PUT     '                                            05036000
CLOSE    DC    CL8'CLOSE   '                                            05037000
OPEN     DC    CL8'OPEN    '                                            05038000
RVOPENR  DC    CL8'OPENR   '                                            05039000
RVRDCNT  DC    CL8'READCNT '                                            05040000
RVREADKD DC    CL8'READKD  '                                            05041000
RVSPACCR DC    CL8'SPACCR  '                                            05042000
RVFWRITE DC    CL8'FWRITE  '                                            05043000
RVWRITER DC    CL8'WRITEREC'                                            05044000
PUTLABEL DC    CL8'PUTLABEL'                                            05045000
GETLABEL DC    CL8'GETLABEL'                                            05046000
CANCEL   DC    CL8'CANCEL  '                                            05047000
SET      DC    CL8'SET     '                                            05048000
SELECTX  DC    CL8'SELECTX '                                            05049000
CHANGEX  DC    CL8'CHANGEX '                                            05050000
SELECTDD DC    CL8'SELECTDD'                                            05051000
SELECTDS DC    CL8'SELECTDS'                                            05052000
TBLREST  DC    CL8'TBLREST '                                            05053000
NULLIFYC DC    CL8'NULLIFYC'                                            05054000
RDMSC    DC    CL8'RDMSC   '                                            05055000
RDMSCTBL DC    CL8'RDMSCTBL'                                            05056000
RDCARTLB DC    CL8'RDCARTLB'                                            05057000
AUDITCEL DC    CL8'AUDITCEL'                                            05058000
RDSTGAD  DC    CL8'RDSTGAD '                                            05059000
MODID    DC    CL4'RV01'                                                05060000
FIXAREA  DS    CL512                                                    05061000
         ORG   FIXAREA                                                  05062000
@NM00116 DC    256X'00'                                                 05063000
@NM00117 DC    256X'00'                                                 05064000
         ORG   FIXAREA+512                                              05065000
BASECHAR DC    CL4'BASE'                                                05066000
COPYCHAR DC    CL4'COPY'                                                05067000
HEXFF    DC    X'FF'                                                    05068000
BLNKAREA DC    CL1' '                                                   05069000
THIRTYBK DS    CL30                                                     05070000
         ORG   THIRTYBK                                                 05071000
@NM00118 DC    30CL1' '                                                 05072000
         ORG   THIRTYBK+30                                              05073000
EIGHTZRO DS    CL8                                                      05074000
         ORG   EIGHTZRO                                                 05075000
@NM00119 DC    8X'00'                                                   05076000
         ORG   EIGHTZRO+8                                               05077000
ZEROS31  DS    CL31                                                     05078000
         ORG   ZEROS31                                                  05079000
@NM00120 DC    31X'00'                                                  05080000
         ORG   ZEROS31+31                                               05081000
SSMODSS0 DC    CL3'SS0'                                                 05082000
SSMODCM0 DC    CL3'CM0'                                                 05083000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05084000
@01      EQU   01                                                       05085000
@02      EQU   02                                                       05086000
@03      EQU   03                                                       05087000
@04      EQU   04                                                       05088000
@05      EQU   05                                                       05089000
@06      EQU   06                                                       05090000
@07      EQU   07                                                       05091000
@08      EQU   08                                                       05092000
@09      EQU   09                                                       05093000
@10      EQU   10                                                       05094000
@11      EQU   11                                                       05095000
@12      EQU   12                                                       05096000
@13      EQU   13                                                       05097000
@14      EQU   14                                                       05098000
@15      EQU   15                                                       05099000
ENTRYNUM EQU   @02                                                      05100000
VS2RTRC  EQU   @04                                                      05101000
LABELRC  EQU   @08                                                      05102000
MVRRC    EQU   @04                                                      05103000
VPREPRC  EQU   @04                                                      05104000
COPYRC   EQU   @07                                                      05105000
VTOCKRC  EQU   @04                                                      05106000
ALLOCRC  EQU   @04                                                      05107000
TVOLRC   EQU   @03                                                      05108000
FVOLRC   EQU   @03                                                      05109000
RVVIRC   EQU   @08                                                      05110000
VOLCHKRC EQU   @07                                                      05111000
RETADDR3 EQU   @04                                                      05112000
RETADDR2 EQU   @09                                                      05113000
COPYVPTR EQU   @05                                                      05114000
BASEVPTR EQU   @06                                                      05115000
DMPINDEX EQU   @02                                                      05116000
TESTRC   EQU   @03                                                      05117000
REG10    EQU   @10                                                      05118000
REG12    EQU   @12                                                      05119000
RTNREG   EQU   @15                                                      05120000
REG14    EQU   @14                                                      05121000
CVOLR1   EQU   @01                                                      05122000
REG0     EQU   @00                                                      05123000
REG1     EQU   @01                                                      05124000
REG11    EQU   @11                                                      05125000
REG13    EQU   @13                                                      05126000
REG15    EQU   @15                                                      05127000
REG2     EQU   @02                                                      05128000
REG3     EQU   @03                                                      05129000
REG4     EQU   @04                                                      05130000
REG5     EQU   @05                                                      05131000
REG6     EQU   @06                                                      05132000
REG7     EQU   @07                                                      05133000
REG8     EQU   @08                                                      05134000
REG9     EQU   @09                                                      05135000
IDCSACL0 EQU   0                                                        05136000
IDCSAEP0 EQU   0                                                        05137000
IDCSAAL0 EQU   0                                                        05138000
IDCSASS0 EQU   0                                                        05139000
IDCSANQ0 EQU   0                                                        05140000
IDCSADQ0 EQU   0                                                        05141000
IDCSA060 EQU   0                                                        05142000
TRACE1   EQU   0                                                        05143000
OLDERID1 EQU   TRACE1                                                   05144000
TRACE2   EQU   0                                                        05145000
OLDERID2 EQU   TRACE2                                                   05146000
NEWID2   EQU   TRACE2+95                                                05147000
NEWERID2 EQU   5                                                        05148000
CIRAGL   EQU   0                                                        05149000
CIRTYPE  EQU   CIRAGL                                                   05150000
ALLAGL   EQU   0                                                        05151000
ALLDDN   EQU   ALLAGL+4                                                 05152000
ALLULP   EQU   ALLAGL+12                                                05153000
ALLVLP   EQU   ALLAGL+16                                                05154000
ALLSTS   EQU   ALLAGL+24                                                05155000
ALLDSP   EQU   ALLAGL+25                                                05156000
ALLORG   EQU   ALLAGL+26                                                05157000
ALLOPT   EQU   ALLAGL+28                                                05158000
ALLOPTVL EQU   ALLOPT                                                   05159000
ALLOPTPV EQU   ALLOPT                                                   05160000
ALLVLCNT EQU   ALLAGL+29                                                05161000
ALLUNCNT EQU   ALLAGL+30                                                05162000
UNITABL  EQU   0                                                        05163000
UNITADR  EQU   UNITABL+4                                                05164000
@NM00010 EQU   UNITADR                                                  05165000
UNITSTAT EQU   UNITABL+6                                                05166000
IDCIOCL0 EQU   0                                                        05167000
IOCSTR   EQU   0                                                        05168000
IOCDSO   EQU   IOCSTR+16                                                05169000
IOCRFM   EQU   IOCSTR+17                                                05170000
IOCMAC   EQU   IOCSTR+18                                                05171000
IOCMAC2  EQU   IOCSTR+19                                                05172000
IOCCHP   EQU   IOCSTR+20                                                05173000
IOCMSG   EQU   IOCSTR+21                                                05174000
IOCRBA   EQU   IOCSTR+40                                                05175000
IOCTTR   EQU   IOCRBA                                                   05176000
IOCMEM   EQU   IOCSTR+44                                                05177000
IOCNWM   EQU   IOCSTR+48                                                05178000
OPNAGL   EQU   0                                                        05179000
OPNOPT   EQU   OPNAGL                                                   05180000
OPNRFM   EQU   OPNAGL+1                                                 05181000
OPNTYP   EQU   OPNAGL+2                                                 05182000
OPNMOD   EQU   OPNAGL+3                                                 05183000
OPNDEV   EQU   OPNAGL+24                                                05184000
OPNDSO   EQU   OPNAGL+41                                                05185000
OPNOPT2  EQU   OPNAGL+42                                                05186000
IOINFOPT EQU   0                                                        05187000
UVOLLIST EQU   0                                                        05188000
UVOLENT  EQU   UVOLLIST+2                                               05189000
AMSTP011 EQU   0                                                        05190000
DARGLIST EQU   0                                                        05191000
DARGDBP  EQU   DARGLIST                                                 05192000
DARGRETP EQU   DARGLIST+4                                               05193000
DARGSTID EQU   DARGLIST+8                                               05194000
DARGSMOD EQU   DARGSTID                                                 05195000
DARGSENT EQU   DARGSTID+3                                               05196000
DARGILP  EQU   DARGLIST+12                                              05197000
DARGCNT  EQU   DARGLIST+14                                              05198000
DARGRETL EQU   DARGLIST+16                                              05199000
DARGARY  EQU   DARGLIST+20                                              05200000
DARGINS  EQU   DARGARY                                                  05201000
DARGINL  EQU   DARGARY+2                                                05202000
DARGDTM  EQU   DARGARY+4                                                05203000
FMTLIST  EQU   0                                                        05204000
FMTFLGS  EQU   FMTLIST                                                  05205000
FMTSPF   EQU   FMTLIST+2                                                05206000
FMTRFNO  EQU   FMTSPF                                                   05207000
FMTILEN  EQU   FMTRFNO                                                  05208000
FMTIOFF  EQU   FMTLIST+4                                                05209000
FMTTRBC  EQU   FMTIOFF                                                  05210000
FMTSTO   EQU   FMTTRBC                                                  05211000
FMTOCOL  EQU   FMTLIST+6                                                05212000
FMTCNVF  EQU   FMTLIST+10                                               05213000
ERCNVTAB EQU   0                                                        05214000
ERTYPE   EQU   ERCNVTAB                                                 05215000
EROPER   EQU   ERCNVTAB+1                                               05216000
EROSOPER EQU   ERCNVTAB+2                                               05217000
IDCDB010 EQU   0                                                        05218000
DMPITM   EQU   0                                                        05219000
DMPITMNM EQU   DMPITM                                                   05220000
DMPITMPT EQU   DMPITM+8                                                 05221000
DMPITMLN EQU   DMPITM+12                                                05222000
DMPITMTP EQU   DMPITM+14                                                05223000
DMPARY   EQU   0                                                        05224000
DMPTRM   EQU   0                                                        05225000
CCMSG    EQU   0                                                        05226000
CMMSG    EQU   0                                                        05227000
CMVOLFLG EQU   CMMSG+6                                                  05228000
CTMSG    EQU   0                                                        05229000
CTARRAY  EQU   CTMSG+4                                                  05230000
MDAGL    EQU   0                                                        05231000
MDUCBPTR EQU   MDAGL+8                                                  05232000
MDDDNAME EQU   MDAGL+12                                                 05233000
MDLABEL  EQU   MDAGL+24                                                 05234000
MDFLAGS  EQU   MDAGL+30                                                 05235000
MDWAIT   EQU   MDFLAGS                                                  05236000
MDVTOC   EQU   MDAGL+32                                                 05237000
PUAGL    EQU   0                                                        05238000
CKAGL    EQU   0                                                        05239000
CKUCBPTR EQU   CKAGL+8                                                  05240000
CKDDNAME EQU   CKAGL+12                                                 05241000
CKLABELP EQU   CKAGL+24                                                 05242000
CKFLAGS  EQU   CKAGL+28                                                 05243000
CKTESTVT EQU   CKFLAGS                                                  05244000
EXCLAGL  EQU   0                                                        05245000
EXCLUCBP EQU   EXCLAGL+8                                                05246000
EXCLDDP  EQU   EXCLAGL+12                                               05247000
EXCLVOL  EQU   EXCLAGL+16                                               05248000
EXCLFLAG EQU   EXCLAGL+22                                               05249000
EXCLMNT  EQU   EXCLFLAG                                                 05250000
EXOARG   EQU   0                                                        05251000
EXOPT    EQU   EXOARG+32                                                05252000
EXFLG    EQU   EXOARG+33                                                05253000
EXGARG   EQU   0                                                        05254000
EXWRARG  EQU   0                                                        05255000
EXRWCHR  EQU   EXWRARG+26                                               05256000
EXSPACE  EQU   EXWRARG+36                                               05257000
EXPARG   EQU   0                                                        05258000
EXPDATA  EQU   EXPARG+12                                                05259000
EXPDATAB EQU   0                                                        05260000
EXPARRAY EQU   EXPDATAB+4                                               05261000
VS2AGL   EQU   0                                                        05262000
VSUCBPTR EQU   VS2AGL+8                                                 05263000
VSOWNPTR EQU   VS2AGL+16                                                05264000
VSVOLPTR EQU   VS2AGL+20                                                05265000
VSLABOPT EQU   VS2AGL+28                                                05266000
VSOWNER  EQU   VSLABOPT                                                 05267000
VSVOLSER EQU   VSLABOPT                                                 05268000
VSVOLUME EQU   VS2AGL+29                                                05269000
VS2MSG   EQU   VS2AGL+35                                                05270000
VS2TOV   EQU   VS2MSG                                                   05271000
VS2RESOP EQU   VS2AGL+36                                                05272000
VS2RES   EQU   VS2RESOP                                                 05273000
VSDDNAME EQU   VS2AGL+37                                                05274000
VS1AGL   EQU   0                                                        05275000
VSUCBP   EQU   VS1AGL+8                                                 05276000
VSVOLP   EQU   VS1AGL+12                                                05277000
VSFILEP  EQU   VS1AGL+16                                                05278000
VSIOP    EQU   VS1AGL+20                                                05279000
VSCATP   EQU   VS1AGL+32                                                05280000
VSCATDDP EQU   VS1AGL+40                                                05281000
VSPSWDP  EQU   VS1AGL+44                                                05282000
VSPFILEP EQU   VS1AGL+48                                                05283000
VSSECOPT EQU   VS1AGL+68                                                05284000
VSNOVSAM EQU   VSSECOPT                                                 05285000
VSMASTER EQU   VSSECOPT                                                 05286000
VSNONONV EQU   VSSECOPT                                                 05287000
VSWRITE  EQU   VSSECOPT                                                 05288000
VSVTOPT  EQU   VS1AGL+69                                                05289000
VSCATOPT EQU   VS1AGL+70                                                05290000
VSRETURN EQU   VS1AGL+71                                                05291000
VSMSG    EQU   VS1AGL+72                                                05292000
VSTOV    EQU   VSMSG                                                    05293000
VSRESOPT EQU   VS1AGL+73                                                05294000
VSRES    EQU   VSRESOPT                                                 05295000
RCTAGL   EQU   0                                                        05296000
RCTOPT   EQU   RCTAGL+8                                                 05297000
STAEPARM EQU   0                                                        05298000
STARCVY  EQU   STAEPARM+52                                              05299000
STARETRY EQU   STAEPARM+53                                              05300000
VOLLABEL EQU   0                                                        05301000
SV82LIST EQU   0                                                        05302000
@NM00072 EQU   SV82LIST+4                                               05303000
SV82DCBP EQU   @NM00072                                                 05304000
@NM00073 EQU   SV82LIST+12                                              05305000
SV82WRKP EQU   @NM00073                                                 05306000
SRTAGL   EQU   0                                                        05307000
LCTINFO  EQU   0                                                        05308000
LCTFLAGS EQU   LCTINFO+32                                               05309000
UCTAGL   EQU   0                                                        05310000
UCTFLAGS EQU   UCTAGL+68                                                05311000
SELAGL   EQU   0                                                        05312000
SELFLAGS EQU   SELAGL+22                                                05313000
DATESAGL EQU   0                                                        05314000
DATESOPT EQU   DATESAGL+20                                              05315000
VS3AGL   EQU   0                                                        05316000
VS3FLAGS EQU   VS3AGL+58                                                05317000
VSDVTOC  EQU   0                                                        05318000
VSDSTAT  EQU   0                                                        05319000
VSDSFLG1 EQU   VSDSTAT+16                                               05320000
VSDFLG2  EQU   VSDSTAT+17                                               05321000
VSDSCR   EQU   0                                                        05322000
VSDSCRFL EQU   VSDSCR+4                                                 05323000
VSDUSAGE EQU   0                                                        05324000
VSDDORG  EQU   VSDUSAGE+9                                               05325000
VSDALLOC EQU   VSDUSAGE+10                                              05326000
VSDUSEF  EQU   VSDUSAGE+11                                              05327000
VSDDSORG EQU   VSDUSAGE+16                                              05328000
VSDBLOCK EQU   0                                                        05329000
VSDSPACE EQU   VSDBLOCK+12                                              05330000
VSDARRAY EQU   VSDBLOCK+16                                              05331000
VSDVARY  EQU   VSDARRAY+48                                              05332000
FVOL     EQU   0                                                        05333000
FVOLLEN  EQU   FVOL                                                     05334000
FVOLVAL  EQU   FVOL+1                                                   05335000
TVOL     EQU   0                                                        05336000
TVOLLEN  EQU   TVOL                                                     05337000
TVOLVAL  EQU   TVOL+1                                                   05338000
DATE     EQU   0                                                        05339000
DATEVAL  EQU   DATE                                                     05340000
SEQ#     EQU   0                                                        05341000
SEQ#VAL  EQU   SEQ#                                                     05342000
LBKUP    EQU   0                                                        05343000
CAT      EQU   0                                                        05344000
CATNM    EQU   0                                                        05345000
CATNMPLN EQU   CATNM                                                    05346000
CATNMPAS EQU   CATNM+1                                                  05347000
CATNMFLG EQU   CATNM+10                                                 05348000
CATNMVAL EQU   CATNM+21                                                 05349000
CATDN    EQU   0                                                        05350000
CATDNVAL EQU   CATDN+1                                                  05351000
FILE     EQU   0                                                        05352000
FILEVAL  EQU   FILE+1                                                   05353000
PFILE    EQU   0                                                        05354000
@NM00091 EQU   PFILE+2                                                  05355000
RVVI     EQU   0                                                        05356000
RVVLNGTH EQU   RVVI                                                     05357000
RVVOPCOD EQU   RVVI+4                                                   05358000
RVVCODE  EQU   RVVOPCOD                                                 05359000
RVVOLUME EQU   RVVI+8                                                   05360000
RVVBUFLN EQU   RVVI+30                                                  05361000
RVVRTBUF EQU   RVVI+32                                                  05362000
RVVCDATE EQU   RVVI+38                                                  05363000
RVVRDSEQ EQU   RVVI+43                                                  05364000
RVVFLAGA EQU   RVVI+58                                                  05365000
RVVRMODE EQU   RVVFLAGA                                                 05366000
RVVRDR   EQU   RVVRMODE                                                 05367000
RVVCHAIN EQU   RVVFLAGA+1                                               05368000
RVVRDRCD EQU   RVVFLAGA+2                                               05369000
RVVBVRCD EQU   RVVRDRCD                                                 05370000
RVVCPYRC EQU   RVVRDRCD                                                 05371000
RVVRTEST EQU   RVVFLAGA+3                                               05372000
RVVCPYTP EQU   RVVFLAGA+4                                               05373000
RVVLBKUP EQU   RVVCPYTP                                                 05374000
RVVSPEC  EQU   RVVFLAGA+5                                               05375000
RVVSDTE  EQU   RVVSPEC                                                  05376000
RVVSSEQ  EQU   RVVSPEC                                                  05377000
RVVSVOL  EQU   RVVSPEC                                                  05378000
MVR      EQU   0                                                        05379000
MVRLNGTH EQU   MVR                                                      05380000
MVRCODE  EQU   MVR+4                                                    05381000
MVRFLAGA EQU   MVR+8                                                    05382000
MVRCICPY EQU   MVRFLAGA+2                                               05383000
MVRBVOL  EQU   MVR+12                                                   05384000
BASEV    EQU   0                                                        05385000
BASNAME  EQU   BASEV                                                    05386000
BASID    EQU   BASNAME+11                                               05387000
BASFLAGA EQU   BASEV+14                                                 05388000
BASTYPE  EQU   BASFLAGA                                                 05389000
BASINAC  EQU   BASFLAGA+2                                               05390000
BASRCVYF EQU   BASEV+20                                                 05391000
BASSATIA EQU   BASRCVYF                                                 05392000
BASIVCRE EQU   BASSATIA                                                 05393000
BASIVCPY EQU   BASSATIA                                                 05394000
BASVSMIS EQU   BASSATIA                                                 05395000
BASMISCF EQU   BASRCVYF+2                                               05396000
BASLIB1  EQU   BASEV+36                                                 05397000
BASLID1  EQU   BASLIB1                                                  05398000
BASLIB2  EQU   BASEV+49                                                 05399000
BASLID2  EQU   BASLIB2                                                  05400000
BASKLCPY EQU   BASEV+76                                                 05401000
BASCOPID EQU   BASKLCPY+11                                              05402000
BASOWNER EQU   BASEV+134                                                05403000
COPYV    EQU   0                                                        05404000
COPNAME  EQU   COPYV                                                    05405000
COPID    EQU   COPNAME+11                                               05406000
COPFLAGA EQU   COPYV+14                                                 05407000
COPTYPE  EQU   COPFLAGA                                                 05408000
COPVSAM  EQU   COPFLAGA+2                                               05409000
COPRCVYF EQU   COPYV+20                                                 05410000
COPSATIA EQU   COPRCVYF                                                 05411000
COPMISCF EQU   COPRCVYF+2                                               05412000
COPCSN1  EQU   COPYV+24                                                 05413000
COPLIB1  EQU   COPYV+36                                                 05414000
COPLID1  EQU   COPLIB1                                                  05415000
COPCSN2  EQU   COPYV+37                                                 05416000
COPLIB2  EQU   COPYV+49                                                 05417000
COPLID2  EQU   COPLIB2                                                  05418000
COPDATE  EQU   COPYV+50                                                 05419000
COPDEST  EQU   COPYV+88                                                 05420000
COPOWNER EQU   COPYV+118                                                05421000
COVLIST  EQU   0                                                        05422000
CVOLFLG  EQU   COVLIST+6                                                05423000
CVOCRCRV EQU   CVOLFLG                                                  05424000
CVOLID   EQU   COVLIST+8                                                05425000
CVOLCSN  EQU   COVLIST+20                                               05426000
CVOLVEXT EQU   COVLIST+36                                               05427000
COVCE    EQU   0                                                        05428000
COVLNGTH EQU   COVCE                                                    05429000
COVFLAGA EQU   COVCE+34                                                 05430000
COVFLAGB EQU   COVCE+35                                                 05431000
COVSETFL EQU   COVFLAGB                                                 05432000
COVSRCVY EQU   COVSETFL                                                 05433000
COVRECFL EQU   COVFLAGB+1                                               05434000
COVICOPY EQU   COVRECFL                                                 05435000
COVTYPE  EQU   COVFLAGB+2                                               05436000
AMSTP041 EQU   0                                                        05437000
AMSTP042 EQU   0                                                        05438000
AMSTP043 EQU   0                                                        05439000
AMSTP044 EQU   0                                                        05440000
CDATE    EQU   0                                                        05441000
IDCIOCO0 EQU   0                                                        05442000
IDCIOGT0 EQU   0                                                        05443000
IDCIOIT0 EQU   0                                                        05444000
IDCIOOP0 EQU   0                                                        05445000
IDCIOPO0 EQU   0                                                        05446000
IDCIOPT0 EQU   0                                                        05447000
IDCIOSI0 EQU   0                                                        05448000
IDCIOST0 EQU   0                                                        05449000
IDCIOTM0 EQU   0                                                        05450000
IDCIOVY0 EQU   0                                                        05451000
IDCIO050 EQU   0                                                        05452000
IDCSACA0 EQU   0                                                        05453000
IDCSACR0 EQU   0                                                        05454000
IDCSADE0 EQU   0                                                        05455000
IDCSADL0 EQU   0                                                        05456000
IDCSAFP0 EQU   0                                                        05457000
IDCSAFS0 EQU   0                                                        05458000
IDCSAGP0 EQU   0                                                        05459000
IDCSAGS0 EQU   0                                                        05460000
IDCSAID0 EQU   0                                                        05461000
IDCSALC0 EQU   0                                                        05462000
IDCSALD0 EQU   0                                                        05463000
IDCSALK0 EQU   0                                                        05464000
IDCSAPR0 EQU   0                                                        05465000
IDCSAPT0 EQU   0                                                        05466000
IDCSAQL0 EQU   0                                                        05467000
IDCSARC0 EQU   0                                                        05468000
IDCSARV0 EQU   0                                                        05469000
IDCSASC0 EQU   0                                                        05470000
IDCSASI0 EQU   0                                                        05471000
IDCSASN0 EQU   0                                                        05472000
IDCSAST0 EQU   0                                                        05473000
IDCSATI0 EQU   0                                                        05474000
IDCSAUC0 EQU   0                                                        05475000
IDCSAWO0 EQU   0                                                        05476000
IDCST010 EQU   0                                                        05477000
IDCTPER0 EQU   0                                                        05478000
LISTTEST EQU   0                                                        05479000
NEWERID1 EQU   5                                                        05480000
GDTTBL   EQU   0                                                        05481000
GDTTR1   EQU   GDTTBL+8                                                 05482000
GDTTR2   EQU   GDTTBL+12                                                05483000
GDTDBG   EQU   GDTTBL+40                                                05484000
GDTSTC   EQU   GDTTBL+44                                                05485000
GDTPRT   EQU   GDTTBL+48                                                05486000
GDTESS   EQU   GDTTBL+52                                                05487000
GDTESA   EQU   GDTTBL+56                                                05488000
GDTRST   EQU   GDTTBL+60                                                05489000
GDTRES   EQU   GDTTBL+64                                                05490000
GDTCAL   EQU   GDTTBL+68                                                05491000
GDTGSP   EQU   GDTTBL+72                                                05492000
GDTFSP   EQU   GDTTBL+76                                                05493000
GDTGPL   EQU   GDTTBL+80                                                05494000
GDTFPL   EQU   GDTTBL+84                                                05495000
GDTLOD   EQU   GDTTBL+88                                                05496000
GDTDEL   EQU   GDTTBL+92                                                05497000
GDTPRL   EQU   GDTTBL+96                                                05498000
GDTEPL   EQU   GDTTBL+100                                               05499000
GDTTIM   EQU   GDTTBL+104                                               05500000
GDTIIO   EQU   GDTTBL+108                                               05501000
GDTTIO   EQU   GDTTBL+112                                               05502000
GDTOPN   EQU   GDTTBL+124                                               05503000
GDTCLS   EQU   GDTTBL+128                                               05504000
GDTGET   EQU   GDTTBL+132                                               05505000
GDTPUT   EQU   GDTTBL+136                                               05506000
GDTPOS   EQU   GDTTBL+140                                               05507000
GDTCPY   EQU   GDTTBL+144                                               05508000
GDTCAT   EQU   GDTTBL+148                                               05509000
GDTSNP   EQU   GDTTBL+164                                               05510000
GDTVFY   EQU   GDTTBL+172                                               05511000
GDTUID   EQU   GDTTBL+192                                               05512000
GDTPMT   EQU   GDTTBL+196                                               05513000
GDTCIR   EQU   GDTTBL+200                                               05514000
GDTLNK   EQU   GDTTBL+204                                               05515000
GDTALC   EQU   GDTTBL+208                                               05516000
GDTDLC   EQU   GDTTBL+212                                               05517000
GDTQAL   EQU   GDTTBL+216                                               05518000
GDTSTW   EQU   GDTTBL+220                                               05519000
GDTSSC   EQU   GDTTBL+224                                               05520000
GDTENQ   EQU   GDTTBL+228                                               05521000
GDTRSV   EQU   GDTTBL+232                                               05522000
GDTDEQ   EQU   GDTTBL+236                                               05523000
GDTSFO   EQU   GDTTBL+240                                               05524000
GDTWTO   EQU   GDTTBL+244                                               05525000
GDTSCR   EQU   GDTTBL+248                                               05526000
GDTUNT   EQU   GDTTBL+252                                               05527000
GDTRCT   EQU   GDTTBL+256                                               05528000
GDTIFO   EQU   GDTTBL+260                                               05529000
GDTEXP   EQU   GDTTBL+264                                               05530000
GDTSTA   EQU   GDTTBL+268                                               05531000
GDTERR   EQU   GDTTBL+272                                               05532000
GDTUNC   EQU   GDTTBL+276                                               05533000
GDTLOC   EQU   GDTTBL+280                                               05534000
FDTTBL   EQU   0                                                        05535000
FDTPTR   EQU   FDTTBL+8                                                 05536000
LASTCOND EQU   0                                                        05537000
SSRCODE  EQU   0                                                        05538000
SSRHALF  EQU   SSRCODE+2                                                05539000
SSECBCD  EQU   0                                                        05540000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05541000
@NM00121 EQU   SSRCODE                                                  05542000
FDTVERB  EQU   FDTTBL                                                   05543000
GDTECT   EQU   GDTTBL+188                                               05544000
GDTPSB   EQU   GDTTBL+184                                               05545000
GDTUPT   EQU   GDTTBL+180                                               05546000
GDTCMB   EQU   GDTTBL+176                                               05547000
GDTSPR   EQU   GDTTBL+168                                               05548000
@NM00001 EQU   GDTTBL+160                                               05549000
GDTABH   EQU   GDTTBL+156                                               05550000
GDTABT   EQU   GDTTBL+152                                               05551000
GDTTOH   EQU   GDTTBL+120                                               05552000
GDTRIP   EQU   GDTTBL+116                                               05553000
GDTIOH   EQU   GDTTBL+36                                                05554000
GDTSAH   EQU   GDTTBL+32                                                05555000
GDTTPH   EQU   GDTTBL+28                                                05556000
GDTRIH   EQU   GDTTBL+24                                                05557000
GDTSTH   EQU   GDTTBL+20                                                05558000
GDTDBH   EQU   GDTTBL+16                                                05559000
GDTPRM   EQU   GDTTBL+4                                                 05560000
GDTHDR   EQU   GDTTBL                                                   05561000
@NM00114 EQU   COVCE+39                                                 05562000
@NM00113 EQU   COVFLAGB+3                                               05563000
@NM00112 EQU   COVTYPE                                                  05564000
COVREUSE EQU   COVTYPE                                                  05565000
COVSAM   EQU   COVTYPE                                                  05566000
@NM00111 EQU   COVRECFL                                                 05567000
COVLAMIS EQU   COVRECFL                                                 05568000
COVCREAT EQU   COVRECFL                                                 05569000
@NM00110 EQU   COVSETFL                                                 05570000
COVCRCVY EQU   COVSETFL                                                 05571000
@NM00109 EQU   COVFLAGA                                                 05572000
COVSPDES EQU   COVFLAGA                                                 05573000
COVDESCR EQU   COVCE+4                                                  05574000
CVOLRES2 EQU   COVLIST+34                                               05575000
CVOLRUA  EQU   COVLIST+32                                               05576000
CVOLECB  EQU   COVLIST+16                                               05577000
CVOLASID EQU   COVLIST+14                                               05578000
@NM00108 EQU   CVOLFLG                                                  05579000
CVOCRCR  EQU   CVOLFLG                                                  05580000
CVOCRDAS EQU   CVOLFLG                                                  05581000
CVODASCR EQU   CVOLFLG                                                  05582000
CVOLRES1 EQU   COVLIST+5                                                05583000
CVOLOPCD EQU   COVLIST+4                                                05584000
CVOLLEN  EQU   COVLIST                                                  05585000
@NM00107 EQU   COPYV+136                                                05586000
COPFREXT EQU   COPYV+132                                                05587000
COPLEXT  EQU   COPYV+130                                                05588000
COPFRESP EQU   COPYV+128                                                05589000
COPDESCR EQU   COPYV+58                                                 05590000
COPDTREM EQU   COPYV+54                                                 05591000
COP2BIT2 EQU   COPLID2                                                  05592000
COP2BIT1 EQU   COPLID2                                                  05593000
COPRES5  EQU   COPLIB2                                                  05594000
COP1BIT2 EQU   COPLID1                                                  05595000
COP1BIT1 EQU   COPLID1                                                  05596000
COPRES4  EQU   COPLIB1                                                  05597000
@NM00106 EQU   COPMISCF                                                 05598000
COPHOLD  EQU   COPMISCF                                                 05599000
COPRES3  EQU   COPSATIA                                                 05600000
COPVSMIS EQU   COPSATIA                                                 05601000
COPIVCPY EQU   COPSATIA                                                 05602000
COPIVCRE EQU   COPSATIA                                                 05603000
@NM00105 EQU   COPYV+18                                                 05604000
@NM00104 EQU   COPFLAGA+3                                               05605000
COPDLSPF EQU   COPFLAGA+3                                               05606000
COPRONLY EQU   COPFLAGA+3                                               05607000
COPDAERA EQU   COPFLAGA+2                                               05608000
COPEXCL  EQU   COPFLAGA+2                                               05609000
COPBIND  EQU   COPFLAGA+2                                               05610000
COPBKUP  EQU   COPFLAGA+2                                               05611000
COPRSTD  EQU   COPFLAGA+2                                               05612000
COPGENUS EQU   COPFLAGA+2                                               05613000
COPGROUP EQU   COPFLAGA+2                                               05614000
COPRES2  EQU   COPTYPE                                                  05615000
COPCOPYV EQU   COPTYPE                                                  05616000
COPRES1  EQU   COPTYPE                                                  05617000
COPRES6  EQU   COPYV+13                                                 05618000
COPNO    EQU   COPID+1                                                  05619000
COPBLANK EQU   COPID                                                    05620000
COPSERNO EQU   COPNAME+5                                                05621000
COPV     EQU   COPNAME                                                  05622000
@NM00103 EQU   BASEV+192                                                05623000
BASXPDT2 EQU   BASEV+188                                                05624000
BASGROUP EQU   BASEV+180                                                05625000
BASRECOV EQU   BASEV+174                                                05626000
BASDEST  EQU   BASEV+144                                                05627000
BASDESCR EQU   BASEV+104                                                05628000
BASDTREM EQU   BASEV+100                                                05629000
BASEXPDT EQU   BASEV+96                                                 05630000
BASDLMTD EQU   BASEV+92                                                 05631000
BASRES6  EQU   BASEV+89                                                 05632000
BASCOPNO EQU   BASCOPID+1                                               05633000
BASCOPBK EQU   BASCOPID                                                 05634000
BASCOPSN EQU   BASKLCPY+5                                               05635000
BASCOPV  EQU   BASKLCPY                                                 05636000
BASFREXT EQU   BASEV+72                                                 05637000
BASLEXT  EQU   BASEV+70                                                 05638000
BASFRESP EQU   BASEV+68                                                 05639000
@NM00102 EQU   BASEV+65                                                 05640000
BASBKLMT EQU   BASEV+64                                                 05641000
BASNBKUP EQU   BASEV+63                                                 05642000
BASNCOPY EQU   BASEV+62                                                 05643000
BASNEXTV EQU   BASEV+56                                                 05644000
BASPREV  EQU   BASEV+50                                                 05645000
BAS2BIT2 EQU   BASLID2                                                  05646000
BAS2BIT1 EQU   BASLID2                                                  05647000
BASRES5  EQU   BASLIB2                                                  05648000
BASCSN2  EQU   BASEV+37                                                 05649000
BAS1BIT2 EQU   BASLID1                                                  05650000
BAS1BIT1 EQU   BASLID1                                                  05651000
BASRES4  EQU   BASLIB1                                                  05652000
BASCSN1  EQU   BASEV+24                                                 05653000
BASRES3  EQU   BASMISCF                                                 05654000
BASHOLD  EQU   BASMISCF                                                 05655000
BASRES8  EQU   BASSATIA                                                 05656000
BASCPUID EQU   BASEV+18                                                 05657000
@NM00101 EQU   BASFLAGA+3                                               05658000
BASLAST  EQU   BASFLAGA+3                                               05659000
BASFIRST EQU   BASFLAGA+3                                               05660000
BASREASS EQU   BASFLAGA+3                                               05661000
BASRONLY EQU   BASFLAGA+3                                               05662000
BASDAERA EQU   BASFLAGA+3                                               05663000
BASEXCL  EQU   BASFLAGA+2                                               05664000
BASBIND  EQU   BASFLAGA+2                                               05665000
BASRSTD  EQU   BASFLAGA+2                                               05666000
BASGENUS EQU   BASFLAGA+2                                               05667000
BASGRPV  EQU   BASFLAGA+2                                               05668000
BASNOCPY EQU   BASFLAGA+2                                               05669000
BASDLSF  EQU   BASFLAGA+2                                               05670000
BASRES2  EQU   BASTYPE                                                  05671000
BASBASVR EQU   BASTYPE                                                  05672000
BASRES1  EQU   BASTYPE                                                  05673000
BASRES7  EQU   BASEV+13                                                 05674000
BASZERO  EQU   BASID+1                                                  05675000
BASBLANK EQU   BASID                                                    05676000
BASSERNO EQU   BASNAME+5                                                05677000
BASEVKEY EQU   BASNAME                                                  05678000
@NM00100 EQU   MVR+82                                                   05679000
MVRLABEL EQU   MVR+76                                                   05680000
MVRBLNK1 EQU   MVR+75                                                   05681000
MVRBKUPN EQU   MVR+74                                                   05682000
MVRCSN   EQU   MVR+62                                                   05683000
MVRTO    EQU   MVR+58                                                   05684000
MVRDES   EQU   MVR+28                                                   05685000
MVRGROUP EQU   MVR+20                                                   05686000
MVRFOR   EQU   MVR+18                                                   05687000
@NM00099 EQU   MVRFLAGA+2                                               05688000
MVRCIVCF EQU   MVRFLAGA+2                                               05689000
MVRCLMIS EQU   MVRFLAGA+1                                               05690000
MVRSLMIS EQU   MVRFLAGA+1                                               05691000
MVRNEXPD EQU   MVRFLAGA+1                                               05692000
MVRNDESC EQU   MVRFLAGA+1                                               05693000
MVRBKUP  EQU   MVRFLAGA+1                                               05694000
MVRNGRP  EQU   MVRFLAGA+1                                               05695000
MVRRSTD  EQU   MVRFLAGA+1                                               05696000
MVRGEN   EQU   MVRFLAGA+1                                               05697000
MVRFLLAB EQU   MVRFLAGA                                                 05698000
MVRFLBK  EQU   MVRFLAGA                                                 05699000
MVRFLCSN EQU   MVRFLAGA                                                 05700000
MVRFLTO  EQU   MVRFLAGA                                                 05701000
MVRFLDES EQU   MVRFLAGA                                                 05702000
MVRFLBAS EQU   MVRFLAGA                                                 05703000
MVRFLGRO EQU   MVRFLAGA                                                 05704000
MVRFLFOR EQU   MVRFLAGA                                                 05705000
@NM00098 EQU   MVRCODE+1                                                05706000
MVROPCD  EQU   MVRCODE                                                  05707000
@NM00097 EQU   RVVI+64                                                  05708000
RVVSDUP  EQU   RVVSPEC                                                  05709000
RVVSCPY  EQU   RVVSPEC                                                  05710000
RVVSCSN  EQU   RVVSPEC                                                  05711000
RVVSEXP  EQU   RVVSPEC                                                  05712000
RVVSGRP  EQU   RVVSPEC                                                  05713000
@NM00096 EQU   RVVCPYTP                                                 05714000
RVVCPLHD EQU   RVVCPYTP                                                 05715000
RVVLCOPY EQU   RVVCPYTP                                                 05716000
RVVOBKUP EQU   RVVCPYTP                                                 05717000
RVVBPLHD EQU   RVVRTEST                                                 05718000
RVVDVOL  EQU   RVVRTEST                                                 05719000
RVVACTV  EQU   RVVRTEST                                                 05720000
RVVINACT EQU   RVVRTEST                                                 05721000
RVVRSTD  EQU   RVVRTEST                                                 05722000
RVVGSVOL EQU   RVVRTEST                                                 05723000
RVVTHOLD EQU   RVVRTEST                                                 05724000
RVVEXPDT EQU   RVVRTEST                                                 05725000
RVVALL   EQU   RVVRDRCD                                                 05726000
RVVCPURC EQU   RVVRDRCD                                                 05727000
RVVCIRCD EQU   RVVRDRCD                                                 05728000
RVVRUNKN EQU   RVVRDRCD                                                 05729000
RVVDUPRC EQU   RVVRDRCD                                                 05730000
RVVGRPRC EQU   RVVRDRCD                                                 05731000
@NM00095 EQU   RVVCHAIN                                                 05732000
RVVNGVOL EQU   RVVCHAIN                                                 05733000
RVVGPVOL EQU   RVVCHAIN                                                 05734000
@NM00094 EQU   RVVRMODE                                                 05735000
RVVRDCH  EQU   RVVRMODE                                                 05736000
RVVRDNR  EQU   RVVRMODE                                                 05737000
RVVDUPID EQU   RVVI+57                                                  05738000
RVVCPYID EQU   RVVI+56                                                  05739000
RVVRDCSN EQU   RVVI+44                                                  05740000
RVVBLNK1 EQU   RVVI+42                                                  05741000
RVVEXPIR EQU   RVVI+36                                                  05742000
@NM00093 EQU   RVVI+28                                                  05743000
RVVAREA  EQU   RVVI+24                                                  05744000
RVVARLN  EQU   RVVI+22                                                  05745000
RVVGROUP EQU   RVVI+14                                                  05746000
@NM00092 EQU   RVVOPCOD+1                                               05747000
PFILEVAL EQU   @NM00091+1                                               05748000
PFILELEN EQU   @NM00091                                                 05749000
PFILECNT EQU   PFILE                                                    05750000
FILELEN  EQU   FILE                                                     05751000
CATDNLEN EQU   CATDN                                                    05752000
CATNMLEN EQU   CATNM+20                                                 05753000
CATNMMEM EQU   CATNM+12                                                 05754000
CATNMMLN EQU   CATNM+11                                                 05755000
CATNMFUQ EQU   CATNMFLG                                                 05756000
CATNMPOS EQU   CATNM+9                                                  05757000
VSDDSN   EQU   VSDARRAY+4                                               05758000
VSDVOLCT EQU   VSDARRAY                                                 05759000
VSDFMT0  EQU   VSDBLOCK+8                                               05760000
VSDVTOCS EQU   VSDBLOCK+4                                               05761000
VSDELEM  EQU   VSDBLOCK                                                 05762000
VSDFREE  EQU   VSDUSAGE+24                                              05763000
VSDALLC  EQU   VSDUSAGE+19                                              05764000
VSDDSOR3 EQU   VSDDSORG+2                                               05765000
@NM00090 EQU   VSDDSORG                                                 05766000
VSDSCAL  EQU   VSDUSAGE+12                                              05767000
@NM00089 EQU   VSDUSEF                                                  05768000
VSDCALFR EQU   VSDUSEF                                                  05769000
@NM00088 EQU   VSDALLOC                                                 05770000
VSDABSTR EQU   VSDALLOC                                                 05771000
VSDABLK  EQU   VSDALLOC                                                 05772000
VSDATRK  EQU   VSDALLOC                                                 05773000
VSDACYL  EQU   VSDALLOC                                                 05774000
@NM00087 EQU   VSDDORG                                                  05775000
VSDOU    EQU   VSDDORG                                                  05776000
VSDOIS   EQU   VSDDORG                                                  05777000
VSDODA   EQU   VSDDORG                                                  05778000
VSDOUN   EQU   VSDDORG                                                  05779000
VSDOPS   EQU   VSDDORG                                                  05780000
VSDOPO   EQU   VSDDORG                                                  05781000
VSDEXTS  EQU   VSDUSAGE+8                                               05782000
VSDSECAL EQU   VSDUSAGE+4                                               05783000
VSDFTRK  EQU   VSDUSAGE+2                                               05784000
VSDTRKS  EQU   VSDUSAGE                                                 05785000
@NM00086 EQU   VSDSCR+5                                                 05786000
@NM00085 EQU   VSDSCRFL                                                 05787000
VSDVSAM  EQU   VSDSCRFL                                                 05788000
VSDCATLC EQU   VSDSCRFL                                                 05789000
VSDACBPT EQU   VSDSCR                                                   05790000
VSDPRTC  EQU   VSDSTAT+25                                               05791000
VSDCAT   EQU   VSDSTAT+22                                               05792000
VSDEXP   EQU   VSDSTAT+20                                               05793000
VSDCRE   EQU   VSDSTAT+18                                               05794000
@NM00084 EQU   VSDFLG2                                                  05795000
VSDERROR EQU   VSDFLG2                                                  05796000
VSDPROT  EQU   VSDFLG2                                                  05797000
VSDPWW   EQU   VSDFLG2                                                  05798000
VSDPWR   EQU   VSDFLG2                                                  05799000
@NM00083 EQU   VSDSFLG1                                                 05800000
VSDCVSAM EQU   VSDSFLG1                                                 05801000
VSDCATLG EQU   VSDSFLG1                                                 05802000
VSDVSAME EQU   VSDSFLG1                                                 05803000
VSDVSAMC EQU   VSDSFLG1                                                 05804000
VSDVTOCE EQU   VSDSFLG1                                                 05805000
VSDVTOCC EQU   VSDSFLG1                                                 05806000
VSDOWNER EQU   VSDSTAT+8                                                05807000
VSDEXPIR EQU   VSDSTAT+4                                                05808000
VSDCREAT EQU   VSDSTAT                                                  05809000
VSDFRCCL EQU   VSDVTOC+21                                               05810000
@NM00082 EQU   VSDVTOC+20                                               05811000
VSDFREXT EQU   VSDVTOC+16                                               05812000
@NM00081 EQU   VSDVTOC+15                                               05813000
VSDFRTRK EQU   VSDVTOC+11                                               05814000
@NM00080 EQU   VSDVTOC+10                                               05815000
VSDFRCYL EQU   VSDVTOC+6                                                05816000
@NM00079 EQU   VSDVTOC                                                  05817000
@NM00078 EQU   VS3FLAGS                                                 05818000
VS3SYSNM EQU   VS3FLAGS                                                 05819000
VS3UNCAT EQU   VS3FLAGS                                                 05820000
VS3SCR   EQU   VS3FLAGS                                                 05821000
VS3USAGE EQU   VS3FLAGS                                                 05822000
VS3STAT  EQU   VS3FLAGS                                                 05823000
VS3DD    EQU   VS3AGL+50                                                05824000
VS3VOL   EQU   VS3AGL+44                                                05825000
VS3POOL  EQU   VS3AGL+40                                                05826000
VS3DEV   EQU   VS3AGL+36                                                05827000
VS3UCBP  EQU   VS3AGL+32                                                05828000
VS3CREAT EQU   VS3AGL+28                                                05829000
VS3EXPIR EQU   VS3AGL+24                                                05830000
VS3AST   EQU   VS3AGL+22                                                05831000
VS3LEVLN EQU   VS3AGL+20                                                05832000
VS3LEVP  EQU   VS3AGL+16                                                05833000
VS3EXDSP EQU   VS3AGL+12                                                05834000
VS3LISTP EQU   VS3AGL+8                                                 05835000
VS3HEAD  EQU   VS3AGL                                                   05836000
@NM00077 EQU   DATESOPT                                                 05837000
DATDAYOP EQU   DATESOPT                                                 05838000
DATDTEOP EQU   DATESOPT                                                 05839000
DATSUB   EQU   DATESOPT                                                 05840000
DATADD   EQU   DATESOPT                                                 05841000
DATRETRN EQU   DATESAGL+16                                              05842000
DATDAYS  EQU   DATESAGL+12                                              05843000
DATDATE  EQU   DATESAGL+8                                               05844000
DATHEAD  EQU   DATESAGL                                                 05845000
@NM00076 EQU   SELFLAGS                                                 05846000
SELVOL   EQU   SELAGL+16                                                05847000
SELDDNP  EQU   SELAGL+12                                                05848000
SELUCBP  EQU   SELAGL+8                                                 05849000
SELHEAD  EQU   SELAGL                                                   05850000
@NM00075 EQU   UCTFLAGS                                                 05851000
UCTVSCAT EQU   UCTFLAGS                                                 05852000
UCTDD    EQU   UCTAGL+60                                                05853000
UCTVOLP  EQU   UCTAGL+56                                                05854000
UCTACBP  EQU   UCTAGL+52                                                05855000
UCTDSN   EQU   UCTAGL+8                                                 05856000
UCTHEAD  EQU   UCTAGL                                                   05857000
@NM00074 EQU   LCTFLAGS                                                 05858000
LCTVSCAT EQU   LCTFLAGS                                                 05859000
LCTOWNER EQU   LCTINFO+24                                               05860000
LCTEXPIR EQU   LCTINFO+20                                               05861000
LCTCREAT EQU   LCTINFO+16                                               05862000
LCTACBP  EQU   LCTINFO+12                                               05863000
LCTMULVC EQU   LCTINFO+8                                                05864000
LCTHEAD  EQU   LCTINFO                                                  05865000
SRTWORKP EQU   SRTAGL+28                                                05866000
SRTFLDLN EQU   SRTAGL+24                                                05867000
SRTPOSIT EQU   SRTAGL+20                                                05868000
SRTLEN   EQU   SRTAGL+16                                                05869000
SRTNUM   EQU   SRTAGL+12                                                05870000
SRTADDR  EQU   SRTAGL+8                                                 05871000
SRTHEAD  EQU   SRTAGL                                                   05872000
SV82DEBP EQU   SV82WRKP                                                 05873000
SV82TTRP EQU   SV82LIST+8                                               05874000
SV82VOLP EQU   SV82DCBP                                                 05875000
SV82UCBP EQU   SV82LIST+1                                               05876000
SV82CODE EQU   SV82LIST                                                 05877000
VOLRESV3 EQU   VOLLABEL+55                                              05878000
VOLOWNER EQU   VOLLABEL+45                                              05879000
VOLRESV1 EQU   VOLLABEL+20                                              05880000
VOLVTOC  EQU   VOLLABEL+15                                              05881000
VOLSECTY EQU   VOLLABEL+14                                              05882000
VOLSERNO EQU   VOLLABEL+8                                               05883000
VOLNO    EQU   VOLLABEL+7                                               05884000
VOLLABI  EQU   VOLLABEL+4                                               05885000
VOLKEY   EQU   VOLLABEL                                                 05886000
STAVTTR  EQU   STAEPARM+54                                              05887000
@NM00071 EQU   STARETRY                                                 05888000
STAVTOC  EQU   STARETRY                                                 05889000
STAOFF   EQU   STARETRY                                                 05890000
STAIO05  EQU   STARETRY                                                 05891000
@NM00070 EQU   STARCVY                                                  05892000
STACLEAR EQU   STARCVY                                                  05893000
STAVPOST EQU   STARCVY                                                  05894000
STAVENQ  EQU   STARCVY                                                  05895000
STAVDMNT EQU   STARCVY                                                  05896000
STAVMNT  EQU   STARCVY                                                  05897000
STATCB   EQU   STAEPARM+48                                              05898000
STARTADD EQU   STAEPARM+44                                              05899000
STAEXSAV EQU   STAEPARM+40                                              05900000
STARTSAV EQU   STAEPARM+36                                              05901000
STARTTR  EQU   STAEPARM+32                                              05902000
@NM00069 EQU   STAEPARM+30                                              05903000
STARVOL  EQU   STAEPARM+24                                              05904000
STARUCB  EQU   STAEPARM+20                                              05905000
@NM00068 EQU   STAEPARM+18                                              05906000
STAVVOL  EQU   STAEPARM+12                                              05907000
STAVUCB  EQU   STAEPARM+8                                               05908000
STAHEAD  EQU   STAEPARM                                                 05909000
RCTDSET  EQU   RCTAGL+32                                                05910000
RCTNVOL  EQU   RCTAGL+26                                                05911000
RCTOVOL  EQU   RCTAGL+20                                                05912000
RCTNDEV  EQU   RCTAGL+16                                                05913000
RCTODEV  EQU   RCTAGL+12                                                05914000
@NM00067 EQU   RCTAGL+10                                                05915000
@NM00066 EQU   RCTOPT                                                   05916000
RCTVOL   EQU   RCTOPT                                                   05917000
RCTDEV   EQU   RCTOPT                                                   05918000
RCTHEAD  EQU   RCTAGL                                                   05919000
@NM00065 EQU   VSRESOPT                                                 05920000
VSREAL   EQU   VSRESOPT                                                 05921000
@NM00064 EQU   VSMSG                                                    05922000
VSFROMV  EQU   VSMSG                                                    05923000
@NM00063 EQU   VSRETURN                                                 05924000
VSUCAT   EQU   VSRETURN                                                 05925000
VSVSAM   EQU   VSRETURN                                                 05926000
@NM00062 EQU   VSCATOPT                                                 05927000
VSLIST   EQU   VSCATOPT                                                 05928000
VSSERIAL EQU   VSCATOPT                                                 05929000
VSDEVICE EQU   VSCATOPT                                                 05930000
@NM00061 EQU   VSVTOPT                                                  05931000
VSVSFLAG EQU   VSVTOPT                                                  05932000
VSALTTRK EQU   VSVTOPT                                                  05933000
VSTIME   EQU   VSVTOPT                                                  05934000
VSUCMAST EQU   VSSECOPT                                                 05935000
VSOPCAT  EQU   VSSECOPT                                                 05936000
VSUCTEST EQU   VSSECOPT                                                 05937000
VSREAD   EQU   VSSECOPT                                                 05938000
VSODEVP  EQU   VS1AGL+64                                                05939000
VSOSERP  EQU   VS1AGL+60                                                05940000
VSDEVP   EQU   VS1AGL+56                                                05941000
VSSERP   EQU   VS1AGL+52                                                05942000
VSACBP   EQU   VS1AGL+36                                                05943000
VSNXTATP EQU   VS1AGL+28                                                05944000
VSNUMATP EQU   VS1AGL+24                                                05945000
VSHEAD   EQU   VS1AGL                                                   05946000
VSVTOCPT EQU   VS2AGL+48                                                05947000
@NM00060 EQU   VS2AGL+45                                                05948000
@NM00059 EQU   VS2RESOP                                                 05949000
VS2REAL  EQU   VS2RESOP                                                 05950000
@NM00058 EQU   VS2MSG                                                   05951000
@NM00057 EQU   VSLABOPT                                                 05952000
VSNOVTOC EQU   VSLABOPT                                                 05953000
VSIOBKPT EQU   VS2AGL+24                                                05954000
VSVTOCSZ EQU   VS2AGL+12                                                05955000
VS2HEAD  EQU   VS2AGL                                                   05956000
EXPDATAL EQU   EXPARRAY+6                                               05957000
@NM00056 EQU   EXPARRAY+5                                               05958000
EXPKEYLN EQU   EXPARRAY+4                                               05959000
EXPDATAP EQU   EXPARRAY                                                 05960000
EXPRECNO EQU   EXPDATAB                                                 05961000
EXPCCHHR EQU   EXPARG+16                                                05962000
EXPCTLBK EQU   EXPARG+8                                                 05963000
EXPHEAD  EQU   EXPARG                                                   05964000
EXRWFUN  EQU   EXWRARG+46                                               05965000
@NM00055 EQU   EXSPACE+8                                                05966000
@NM00054 EQU   EXSPACE+6                                                05967000
@NM00053 EQU   EXSPACE+4                                                05968000
@NM00052 EQU   EXSPACE+1                                                05969000
@NM00051 EQU   EXSPACE                                                  05970000
EXRWKDLN EQU   EXWRARG+32                                               05971000
@NM00050 EQU   EXWRARG+31                                               05972000
EXRECNUM EQU   EXRWCHR+4                                                05973000
EXHH     EQU   EXRWCHR+2                                                05974000
EXCC     EQU   EXRWCHR                                                  05975000
EXCCWCNT EQU   EXWRARG+24                                               05976000
EXLOCPTR EQU   EXWRARG+20                                               05977000
EXRWDARE EQU   EXWRARG+16                                               05978000
EXRWIOAR EQU   EXWRARG+12                                               05979000
EXRWCTBL EQU   EXWRARG+8                                                05980000
EXRWRES  EQU   EXWRARG                                                  05981000
EXGDATAL EQU   EXGARG+30                                                05982000
@NM00049 EQU   EXGARG+29                                                05983000
EXGKEYLN EQU   EXGARG+28                                                05984000
EXGDATAP EQU   EXGARG+24                                                05985000
EXGRECNO EQU   EXGARG+20                                                05986000
EXGCCHH2 EQU   EXGARG+16                                                05987000
EXGCCHH1 EQU   EXGARG+12                                                05988000
EXGCTLBK EQU   EXGARG+8                                                 05989000
EXGHEAD  EQU   EXGARG                                                   05990000
EXOVTH   EQU   EXFLG                                                    05991000
EXORVT   EQU   EXFLG                                                    05992000
EXORDS   EQU   EXFLG                                                    05993000
EXOSPK   EQU   EXFLG                                                    05994000
EXORVS   EQU   EXFLG                                                    05995000
@NM00048 EQU   EXFLG                                                    05996000
EXOREAD  EQU   EXFLG                                                    05997000
@NM00047 EQU   EXOPT                                                    05998000
EXOREP   EQU   EXOPT                                                    05999000
EXOVTOC  EQU   EXOPT                                                    06000000
EXONEW   EQU   EXOPT                                                    06001000
EXOPASS  EQU   EXOPT                                                    06002000
EXOLAB   EQU   EXOPT                                                    06003000
EXOTAB   EQU   EXOPT                                                    06004000
EXOCTLBK EQU   EXOARG+28                                                06005000
EXOEXT   EQU   EXOARG+24                                                06006000
EXOUCB   EQU   EXOARG+20                                                06007000
EXOVSN   EQU   EXOARG+16                                                06008000
EXODSN   EQU   EXOARG+12                                                06009000
EXODDN   EQU   EXOARG+8                                                 06010000
EXOHEAD  EQU   EXOARG                                                   06011000
@NM00046 EQU   EXCLFLAG                                                 06012000
EXCLHEAD EQU   EXCLAGL                                                  06013000
@NM00045 EQU   CKFLAGS                                                  06014000
CKDMTABL EQU   CKFLAGS                                                  06015000
CKRETTYP EQU   CKFLAGS                                                  06016000
CKDATYPE EQU   CKAGL+20                                                 06017000
CKHEAD   EQU   CKAGL                                                    06018000
PULABELP EQU   PUAGL+16                                                 06019000
PUTTRPTR EQU   PUAGL+12                                                 06020000
PUUCBPTR EQU   PUAGL+8                                                  06021000
PUHEAD   EQU   PUAGL                                                    06022000
MDR      EQU   MDVTOC+4                                                 06023000
MDHH     EQU   MDVTOC+2                                                 06024000
MDCC     EQU   MDVTOC                                                   06025000
@NM00044 EQU   MDAGL+31                                                 06026000
MDVTOCTR EQU   MDFLAGS                                                  06027000
MDFORCE  EQU   MDFLAGS                                                  06028000
MDDEQ    EQU   MDFLAGS                                                  06029000
MDENQ    EQU   MDFLAGS                                                  06030000
MDPOST   EQU   MDFLAGS                                                  06031000
MDCLEAR  EQU   MDFLAGS                                                  06032000
MDNEWVOL EQU   MDFLAGS                                                  06033000
MDPUAGL  EQU   MDAGL+20                                                 06034000
MDHEAD   EQU   MDAGL                                                    06035000
CTTBLRR  EQU   CTARRAY+3                                                06036000
CTTBLHH  EQU   CTARRAY+2                                                06037000
CTTBLCC  EQU   CTARRAY+1                                                06038000
CTTBLID  EQU   CTARRAY                                                  06039000
CTREALH  EQU   CTMSG+3                                                  06040000
CTREALCC EQU   CTMSG+1                                                  06041000
@NM00043 EQU   CTMSG                                                    06042000
CMCSN2   EQU   CMMSG+28                                                 06043000
CMCSN1   EQU   CMMSG+16                                                 06044000
CMNUMCRT EQU   CMMSG+15                                                 06045000
@NM00042 EQU   CMMSG+14                                                 06046000
CMNEWVOL EQU   CMMSG+8                                                  06047000
@NM00041 EQU   CMMSG+7                                                  06048000
@NM00040 EQU   CMVOLFLG                                                 06049000
CMRONLY  EQU   CMVOLFLG                                                 06050000
CMBIND   EQU   CMVOLFLG                                                 06051000
CMSCRCRT EQU   CMVOLFLG                                                 06052000
CMEXCL   EQU   CMVOLFLG                                                 06053000
CMDERAS  EQU   CMVOLFLG                                                 06054000
CMSCRVOL EQU   CMVOLFLG                                                 06055000
CMCECART EQU   CMVOLFLG                                                 06056000
CMOLDVOL EQU   CMMSG                                                    06057000
CCOLDCSN EQU   CCMSG+24                                                 06058000
CCNEWCSN EQU   CCMSG+12                                                 06059000
@NM00039 EQU   CCMSG+10                                                 06060000
CCVOL    EQU   CCMSG+4                                                  06061000
@NM00038 EQU   CCMSG+2                                                  06062000
CCEJCODE EQU   CCMSG+1                                                  06063000
CCPSTCDE EQU   CCMSG                                                    06064000
@NM00037 EQU   DMPARY+15                                                06065000
DMPARYTP EQU   DMPARY+14                                                06066000
DMPARYEX EQU   DMPARY+12                                                06067000
DMPARYIC EQU   DMPARY+10                                                06068000
DMPARYSZ EQU   DMPARY+8                                                 06069000
DMPARYNM EQU   DMPARY                                                   06070000
@NM00036 EQU   DMPITM+15                                                06071000
@NM00035 EQU   ERCNVTAB+24                                              06072000
ERCPLPT  EQU   ERCNVTAB+20                                              06073000
ERCATRC  EQU   ERCNVTAB+16                                              06074000
ERDSNM   EQU   ERCNVTAB+12                                              06075000
@NM00034 EQU   ERCNVTAB+4                                               06076000
@NM00033 EQU   ERCNVTAB+3                                               06077000
@NM00032 EQU   EROSOPER                                                 06078000
EROSUCDX EQU   EROSOPER                                                 06079000
EROSCATL EQU   EROSOPER                                                 06080000
@NM00031 EQU   EROPER                                                   06081000
ERCATAL  EQU   EROPER                                                   06082000
ERCATDL  EQU   EROPER                                                   06083000
ERCATDE  EQU   EROPER                                                   06084000
ERCATLC  EQU   EROPER                                                   06085000
@NM00030 EQU   ERTYPE                                                   06086000
EROSCAT  EQU   ERTYPE                                                   06087000
ERCATLG  EQU   ERTYPE                                                   06088000
@NM00029 EQU   FMTCNVF+1                                                06089000
FMTAR    EQU   FMTCNVF+1                                                06090000
FMTBS    EQU   FMTCNVF+1                                                06091000
FMTSS    EQU   FMTCNVF+1                                                06092000
FMTAL    EQU   FMTCNVF+1                                                06093000
FMTZS    EQU   FMTCNVF+1                                                06094000
@NM00028 EQU   FMTCNVF                                                  06095000
FMTPU    EQU   FMTCNVF                                                  06096000
FMTBD    EQU   FMTCNVF                                                  06097000
FMTBHD   EQU   FMTCNVF                                                  06098000
FMTBHA   EQU   FMTCNVF                                                  06099000
FMTBH    EQU   FMTCNVF                                                  06100000
FMTOLEN  EQU   FMTLIST+8                                                06101000
FMTRIO   EQU   FMTOCOL                                                  06102000
FMTSPT   EQU   FMTSTO                                                   06103000
FMTSTL   EQU   FMTILEN                                                  06104000
@NM00027 EQU   FMTFLGS+1                                                06105000
FMTHDF   EQU   FMTFLGS                                                  06106000
FMTDFF   EQU   FMTFLGS                                                  06107000
FMTSTF   EQU   FMTFLGS                                                  06108000
FMTREPF  EQU   FMTFLGS                                                  06109000
FMTBDF   EQU   FMTFLGS                                                  06110000
FMTIDF   EQU   FMTFLGS                                                  06111000
FMTSCF   EQU   FMTFLGS                                                  06112000
FMTEOLF  EQU   FMTFLGS                                                  06113000
DARGPCT  EQU   DARGINL                                                  06114000
DARGREP  EQU   DARGINS                                                  06115000
@NM00026 EQU   DARGLIST+19                                              06116000
DARGIND  EQU   DARGLIST+18                                              06117000
UVOLVOL  EQU   UVOLENT+4                                                06118000
UVOLDEV  EQU   UVOLENT                                                  06119000
UVOLCNT  EQU   UVOLLIST                                                 06120000
@NM00025 EQU   IOINFOPT                                                 06121000
IOINFTMS EQU   IOINFOPT                                                 06122000
IOINFSUP EQU   IOINFOPT                                                 06123000
IOINFDSN EQU   IOINFOPT                                                 06124000
IOINFVOL EQU   IOINFOPT                                                 06125000
IOINFDVT EQU   IOINFOPT                                                 06126000
OPNVOL   EQU   OPNAGL+44                                                06127000
@NM00024 EQU   OPNAGL+43                                                06128000
@NM00023 EQU   OPNOPT2                                                  06129000
OPNOPTJM EQU   OPNOPT2                                                  06130000
@NM00022 EQU   OPNOPT2                                                  06131000
OPNOPTAS EQU   OPNOPT2                                                  06132000
@NM00021 EQU   OPNDSO                                                   06133000
OPNDSOPO EQU   OPNDSO                                                   06134000
OPNDSOIS EQU   OPNDSO                                                   06135000
OPNDSOPS EQU   OPNDSO                                                   06136000
OPNDSOAM EQU   OPNDSO                                                   06137000
OPNKYL   EQU   OPNAGL+40                                                06138000
OPNBLK   EQU   OPNAGL+36                                                06139000
OPNREC   EQU   OPNAGL+32                                                06140000
OPNDEVIX EQU   OPNDEV+4                                                 06141000
OPNDEVDT EQU   OPNDEV                                                   06142000
OPNCBP   EQU   OPNAGL+20                                                06143000
OPNDSN   EQU   OPNAGL+16                                                06144000
OPNPWA   EQU   OPNAGL+12                                                06145000
OPNDDN   EQU   OPNAGL+8                                                 06146000
OPNIOC   EQU   OPNAGL+4                                                 06147000
OPNMODRP EQU   OPNMOD                                                   06148000
OPNMODUB EQU   OPNMOD                                                   06149000
OPNMODRS EQU   OPNMOD                                                   06150000
OPNMODAX EQU   OPNMOD                                                   06151000
OPNMODRR EQU   OPNMOD                                                   06152000
OPNMODRC EQU   OPNMOD                                                   06153000
OPNMODAC EQU   OPNMOD                                                   06154000
OPNMODPD EQU   OPNMOD                                                   06155000
@NM00020 EQU   OPNTYP                                                   06156000
OPNTYPRV EQU   OPNTYP                                                   06157000
OPNTYPEX EQU   OPNTYP                                                   06158000
OPNTYPRA EQU   OPNTYP                                                   06159000
OPNTYPXM EQU   OPNTYP                                                   06160000
OPNTYPCI EQU   OPNTYP                                                   06161000
OPNTYPSO EQU   OPNTYP                                                   06162000
OPNTYPSI EQU   OPNTYP                                                   06163000
@NM00019 EQU   OPNRFM                                                   06164000
OPNRFMBK EQU   OPNRFM                                                   06165000
OPNRFMSF EQU   OPNRFM                                                   06166000
OPNRFMUN EQU   OPNRFM                                                   06167000
OPNRFMVR EQU   OPNRFM                                                   06168000
OPNRFMFX EQU   OPNRFM                                                   06169000
OPNOPTSK EQU   OPNOPT                                                   06170000
OPNOPTDR EQU   OPNOPT                                                   06171000
OPNOPTCR EQU   OPNOPT                                                   06172000
OPNOPTKS EQU   OPNOPT                                                   06173000
OPNOPTBK EQU   OPNOPT                                                   06174000
OPNOPTUP EQU   OPNOPT                                                   06175000
OPNOPTOT EQU   OPNOPT                                                   06176000
OPNOPTIN EQU   OPNOPT                                                   06177000
IOCEXT   EQU   IOCSTR+64                                                06178000
IOCREL   EQU   IOCSTR+60                                                06179000
IOCWORK  EQU   IOCSTR+56                                                06180000
IOCRRN   EQU   IOCSTR+52                                                06181000
IOCPNM   EQU   IOCNWM+2                                                 06182000
IOCPTL   EQU   IOCNWM                                                   06183000
IOCKYA   EQU   IOCMEM                                                   06184000
IOCVRC   EQU   IOCTTR                                                   06185000
IOCCBP   EQU   IOCSTR+36                                                06186000
IOCDSN   EQU   IOCSTR+32                                                06187000
IOCHURBA EQU   IOCSTR+28                                                06188000
IOCVOLSR EQU   IOCSTR+22                                                06189000
@NM00018 EQU   IOCMSG                                                   06190000
IOCMSGAE EQU   IOCMSG                                                   06191000
IOCMSGCE EQU   IOCMSG                                                   06192000
IOCMSGOE EQU   IOCMSG                                                   06193000
IOCMSGOP EQU   IOCMSG                                                   06194000
@NM00017 EQU   IOCMSG                                                   06195000
IOCCHPSY EQU   IOCCHP                                                   06196000
IOCCHPAS EQU   IOCCHP                                                   06197000
IOCCHPBK EQU   IOCCHP                                                   06198000
IOCCHPCR EQU   IOCCHP                                                   06199000
IOCCHPKS EQU   IOCCHP                                                   06200000
IOCCHPSK EQU   IOCCHP                                                   06201000
IOCCHPDR EQU   IOCCHP                                                   06202000
IOCCHPSQ EQU   IOCCHP                                                   06203000
@NM00016 EQU   IOCMAC2                                                  06204000
IOCMACPA EQU   IOCMAC2                                                  06205000
@NM00015 EQU   IOCMAC2                                                  06206000
IOCMACCP EQU   IOCMAC2                                                  06207000
IOCMACRR EQU   IOCMAC2                                                  06208000
IOCMACAS EQU   IOCMAC2                                                  06209000
IOCMACSK EQU   IOCMAC2                                                  06210000
@NM00014 EQU   IOCMAC                                                   06211000
IOCMACCC EQU   IOCMAC                                                   06212000
IOCMACDR EQU   IOCMAC                                                   06213000
IOCMACBK EQU   IOCMAC                                                   06214000
IOCMACCR EQU   IOCMAC                                                   06215000
IOCMACUP EQU   IOCMAC                                                   06216000
IOCMACOT EQU   IOCMAC                                                   06217000
IOCMACIN EQU   IOCMAC                                                   06218000
@NM00013 EQU   IOCRFM                                                   06219000
IOCRFMBK EQU   IOCRFM                                                   06220000
IOCRFMSF EQU   IOCRFM                                                   06221000
IOCRFMUN EQU   IOCRFM                                                   06222000
IOCRFMVR EQU   IOCRFM                                                   06223000
IOCRFMFX EQU   IOCRFM                                                   06224000
@NM00012 EQU   IOCDSO                                                   06225000
IOCDSOPO EQU   IOCDSO                                                   06226000
IOCDSOIS EQU   IOCDSO                                                   06227000
IOCDSOPS EQU   IOCDSO                                                   06228000
IOCDSOAM EQU   IOCDSO                                                   06229000
IOCRKP   EQU   IOCSTR+13                                                06230000
IOCKYL   EQU   IOCSTR+12                                                06231000
IOCTRN   EQU   IOCSTR+8                                                 06232000
IOCDLN   EQU   IOCSTR+4                                                 06233000
IOCDAD   EQU   IOCSTR                                                   06234000
UNITVTOC EQU   UNITABL+7                                                06235000
@NM00011 EQU   UNITSTAT                                                 06236000
UNITUSHR EQU   UNITSTAT                                                 06237000
UNITXSHR EQU   UNITSTAT                                                 06238000
UNITISHR EQU   UNITSTAT                                                 06239000
UNITUA   EQU   @NM00010+1                                               06240000
UNITCHA  EQU   @NM00010                                                 06241000
UNITUCB  EQU   UNITABL                                                  06242000
@NM00009 EQU   ALLOPT                                                   06243000
ALLOPTUN EQU   ALLOPT                                                   06244000
ALLOPTDS EQU   ALLOPT                                                   06245000
@NM00008 EQU   ALLORG+1                                                 06246000
ALLORGVS EQU   ALLORG+1                                                 06247000
@NM00007 EQU   ALLORG+1                                                 06248000
ALLORGGS EQU   ALLORG+1                                                 06249000
ALLORGUN EQU   ALLORG                                                   06250000
ALLORGPO EQU   ALLORG                                                   06251000
ALLORGMQ EQU   ALLORG                                                   06252000
ALLORGCQ EQU   ALLORG                                                   06253000
ALLORGCX EQU   ALLORG                                                   06254000
ALLORGDA EQU   ALLORG                                                   06255000
ALLORGPS EQU   ALLORG                                                   06256000
ALLORGIS EQU   ALLORG                                                   06257000
ALLDSPUN EQU   ALLDSP                                                   06258000
ALLDSPCG EQU   ALLDSP                                                   06259000
ALLDSPDE EQU   ALLDSP                                                   06260000
ALLDSPKP EQU   ALLDSP                                                   06261000
@NM00006 EQU   ALLDSP                                                   06262000
ALLSTSOD EQU   ALLSTS                                                   06263000
ALLSTSMD EQU   ALLSTS                                                   06264000
ALLSTSNW EQU   ALLSTS                                                   06265000
ALLSTSSR EQU   ALLSTS                                                   06266000
@NM00005 EQU   ALLSTS                                                   06267000
ALLPWD   EQU   ALLAGL+20                                                06268000
ALLDSN   EQU   ALLAGL                                                   06269000
CIRPID   EQU   CIRAGL+28                                                06270000
CIRPWD   EQU   CIRAGL+24                                                06271000
CIRCAT   EQU   CIRAGL+20                                                06272000
CIRWKP   EQU   CIRAGL+16                                                06273000
CIRTLR   EQU   CIRAGL+12                                                06274000
CIRHDR   EQU   CIRAGL+8                                                 06275000
CIRTLN   EQU   CIRAGL+6                                                 06276000
CIRHLN   EQU   CIRAGL+4                                                 06277000
@NM00004 EQU   CIRAGL+1                                                 06278000
@NM00003 EQU   CIRTYPE                                                  06279000
CIRTYPAQ EQU   CIRTYPE                                                  06280000
CIRTYP1Q EQU   CIRTYPE                                                  06281000
NEWID1   EQU   TRACE1+95                                                06282000
CALLID   EQU   OLDERID1+90                                              06283000
@NM00002 EQU   OLDERID1                                                 06284000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      06285000
@RC00303 EQU   @RC00296                                                 06286000
@RF00302 EQU   @RC00296                                                 06287000
@RC00629 EQU   @RC00628                                                 06288000
@RC00986 EQU   @RC00977                                                 06289000
@RC00984 EQU   @RC00977                                                 06290000
@RC01012 EQU   @RC01010                                                 06291000
@RF01027 EQU   @RC01010                                                 06292000
@RF01125 EQU   @RC01110                                                 06293000
@PB00014 EQU   @EL00001                                                 06294000
@RC00662 EQU   @RC00629                                                 06295000
@RF00995 EQU   @RC00986                                                 06296000
@PB00013 EQU   @PB00014                                                 06297000
@PB00012 EQU   @PB00013                                                 06298000
@PB00011 EQU   @PB00012                                                 06299000
@PB00010 EQU   @PB00011                                                 06300000
@PB00009 EQU   @PB00010                                                 06301000
@PB00008 EQU   @PB00009                                                 06302000
@PB00007 EQU   @PB00008                                                 06303000
@PB00006 EQU   @PB00007                                                 06304000
@PB00005 EQU   @PB00006                                                 06305000
@PB00004 EQU   @PB00005                                                 06306000
@PB00003 EQU   @PB00004                                                 06307000
@PB00002 EQU   @PB00003                                                 06308000
@ENDDATA EQU   *                                                        06309000
         END   IDCRV01,(C'PLS2303',0603,76340)                          06310000
