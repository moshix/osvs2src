         TITLE '**********  IDCSA02  SYSTEM ADAPTER SERVICE MODULE  ****00001000
               ******** '                                               00002000
IDCSA02 CSECT                                                           00003000
MAINENT DS    0H                                                        00004000
        USING *,REG15                                                   00005000
        B     PROLOG                                                    00006000
        DC    AL2(BEGIN-MAINENT)                                        00007000
        DC    C'IDCSA02 '                                               00008000
IDCSACL DS    0H                                                        00009000
        USING *,REG15                                                   00010000
        B     PROLOG                                                    00011000
        DC    AL2(AMSSACL1-IDCSACL)                                     00012000
        ENTRY IDCSACL                                                   00013000
IDCSALD DS    0H                                                        00014000
        USING *,REG15                                                   00015000
        B     PROLOG                                                    00016000
        DC    AL2(AMSSALD1-IDCSALD)                                     00017000
        ENTRY IDCSALD                                                   00018000
IDCSADE DS    0H                                                        00019000
        USING *,REG15                                                   00020000
        B     PROLOG                                                    00021000
        DC    AL2(AMSSADE1-IDCSADE)                                     00022000
        ENTRY IDCSADE                                                   00023000
IDCSAGS DS    0H                                                        00024000
        USING *,REG15                                                   00025000
        B     PROLOG                                                    00026000
        DC    AL2(AMSSAGS1-IDCSAGS)                                     00027000
        ENTRY IDCSAGS                                                   00028000
IDCSAFS DS    0H                                                        00029000
        USING *,REG15                                                   00030000
        B     PROLOG                                                    00031000
        DC    AL2(AMSSAFS1-IDCSAFS)                                     00032000
        ENTRY IDCSAFS                                                   00033000
IDCSAGP DS    0H                                                        00034000
        USING *,REG15                                                   00035000
        B     PROLOG                                                    00036000
        DC    AL2(AMSSAGP1-IDCSAGP)                                     00037000
        ENTRY IDCSAGP                                                   00038000
IDCSAFP DS    0H                                                        00039000
        USING *,REG15                                                   00040000
        B     PROLOG                                                    00041000
        DC    AL2(AMSSAFP1-IDCSAFP)                                     00042000
        ENTRY IDCSAFP                                                   00043000
IDCSATI DS    0H                                                        00044000
        USING *,REG15                                                   00045000
        B     PROLOG                                                    00046000
        DC    AL2(AMSSATI1-IDCSATI)                                     00047000
        ENTRY IDCSATI                                                   00048000
IDCSACA DS    0H                                                        00049000
        USING *,REG15                                                   00050000
        B     PROLOG                                                    00051000
        DC    AL2(AMSSACA1-IDCSACA)                                     00052000
        ENTRY IDCSACA                                                   00053000
IDCSASN DS    0H                                                        00054000
        USING *,REG15                                                   00055000
        B     PROLOG                                                    00056000
        DC    AL2(AMSSASN1-IDCSASN)                                     00057000
        ENTRY IDCSASN                                                   00058000
IDCSAPT DS    0H                                                        00059000
        USING *,REG15                                                   00060000
        B     PROLOG                                                    00061000
        DC    AL2(AMSSAPT1-IDCSAPT)                                     00062000
        ENTRY IDCSAPT                                                   00063000
IDCSAID DS    0H                                                        00064000
        USING *,REG15                                                   00065000
        B     PROLOG                                                    00066000
        DC    AL2(AMSSAID1-IDCSAID)                                     00067000
        ENTRY IDCSAID                                                   00068000
IDCSAQL DS    0H                                                        00069000
        USING *,REG15                                                   00070000
        B     PROLOG                                                    00071000
        DC    AL2(AMSSAQL1-IDCSAQL)                                     00072000
        ENTRY IDCSAQL                                                   00073000
IDCSAAL DS    0H                                                        00074000
        USING *,REG15                                                   00075000
        B     PROLOG                                                    00076000
        DC    AL2(AMSSAAL1-IDCSAAL)                                     00077000
        ENTRY IDCSAAL                                                   00078000
IDCSADL DS    0H                                                        00079000
        USING *,REG15                                                   00080000
        B     PROLOG                                                    00081000
        DC    AL2(AMSSADL1-IDCSADL)                                     00082000
        ENTRY IDCSADL                                                   00083000
IDCSACR DS    0H                                                        00084000
        USING *,REG15                                                   00085000
        B     PROLOG                                                    00086000
        DC    AL2(AMSSACR1-IDCSACR)                                     00087000
        ENTRY IDCSACR                                                   00088000
IDCSALK DS    0H                                                        00089000
        USING *,REG15                                                   00090000
        B     PROLOG                                                    00091000
        DC    AL2(AMSSALK1-IDCSALK)                                     00092000
        ENTRY IDCSALK                                                   00093000
        DROP  REG15                                                     00094000
PROLOG  STM   REG14,REG12,12(REG13)                                     00095000
        BALR  REG9,0                                                    00096000
PSTART  LA    REG10,4095(REG9)                                          00097000
        LA    REG12,4095(REG10)                                         00098000
        USING PSTART,REG9                                               00099000
        USING PSTART+4095,REG10                                         00100000
        USING PSTART+8190,REG12                                         00101000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00102000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00103000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00104000
        LA    REG14,*+14              RETURN ADDRESS                    00105000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00106000
        DC    A(MODID)                MODULE ID ADDRESS                 00107000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00108000
        LR    REG11,REG1                                                00109000
        USING @DATD,REG11                                               00110000
        LM    REG15,REG1,16(REG13)                                      00111000
        ST    REG13,@SA00001+4                                          00112000
        ST    REG11,8(REG13)                                            00113000
        LR    REG13,REG11                                               00114000
        AH    REG15,4(REG15)                                            00115000
        BR    REG15                                                     00116000
BEGIN   DS    0H                                                        00117000
*        /************************************************************/ 00118000
*        /************************************************************/ 00119000
*        /*                                                  @YL026UK*/ 00120000
*        /* UCALL ENTRY POINT                                @YL026UK*/ 00121000
*        /*                                                  @YL026UK*/ 00122000
*        /************************************************************/ 00123000
*        /************************************************************/ 00124000
*                                                                  0221 00125000
*AMSSACL:  ENTRY(GDTTBLX,CLNAMEX);                         /*@YL026UK*/ 00126000
*                                                                  0221 00127000
@EC00221 DS    0H                                                  0222 00128000
*AMSSACL1:                                                         0222 00129000
*                                                                  0222 00130000
*        DCL CLNAME CHAR(8) BASED;     /* ENTRY POINT NAME FOR UCALL */ 00131000
*                                                                  0222 00132000
AMSSACL1 DS    0H                                                  0223 00133000
*        RESPECIFY CLNAME BASED(PARMPTR2);                 /*@YL026UK*/ 00134000
*                                      /* BASE CLNAME        @YL026UK*/ 00135000
*        DCL CLENTPT PTR(31);          /* ENTRY POINT CALLED RTN     */ 00136000
*                                                          /*@Z40GSBF*/ 00137000
*                                                                  0225 00138000
*        /************************************************************/ 00139000
*        /*                                                  @YL026UK*/ 00140000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 00141000
*        /*                                                  @YL026UK*/ 00142000
*        /************************************************************/ 00143000
*                                                                  0225 00144000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 00145000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 00146000
         L     GDTPR,ADDR1(,REG1PTR)                               0226 00147000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 00148000
         L     @00,ADDR2+4(,REG1PTR)                               0227 00149000
         ST    @00,PARMPTR2                                        0227 00150000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 00151000
*                                                                  0228 00152000
*        OLDERID2 = NEWERID2;                                      0229 00153000
         L     @01,GDTTR2(,GDTPR)                                  0229 00154000
         MVC   @TS00001(95),NEWERID2(@01)                          0229 00155000
         MVC   OLDERID2(95,@01),@TS00001                           0229 00156000
*        NEWID2 = 'SACL';                                  /*@YL026UK*/ 00157000
*                                                                  0230 00158000
         MVC   NEWID2(4,@01),@CC01667                              0230 00159000
*        /************************************************************/ 00160000
*        /*                                                  @Z40GSBF*/ 00161000
*        /* ISSUE CALL TO FINDNAME RTN TO GET ENTRY POINT    @Z40GSBF*/ 00162000
*        /*                                                  @Z40GSBF*/ 00163000
*        /************************************************************/ 00164000
*                                                                  0231 00165000
*        TEMPEPN = CLNAME;                                 /*@YL026UK*/ 00166000
         LR    @01,@00                                             0231 00167000
         MVC   TEMPEPN(8),CLNAME(@01)                              0231 00168000
*        RESPECIFY (REG0) RSTD;                            /*@YL026UK*/ 00169000
*        CALL FINDNAME(TEMPEPN,CLENTPT);                   /*@Z40GSBF*/ 00170000
         LA    @01,TEMPEPN                                         0233 00171000
         ST    @01,@AL00001                                        0233 00172000
         LA    @01,CLENTPT                                         0233 00173000
         ST    @01,@AL00001+4                                      0233 00174000
         LA    @01,@AL00001                                        0233 00175000
         BAL   @14,FINDNAME                                        0233 00176000
*        REG0 = CLENTPT;                                   /*@Z40GSBF*/ 00177000
*                                                                  0234 00178000
         L     REG0,CLENTPT                                        0234 00179000
*        /************************************************************/ 00180000
*        /*                                                  @YL026UK*/ 00181000
*        /* TEMPORARILY STORE THE ADDRESS OF THE ENTRY POINT TO BE   */ 00182000
*        /* BRANCHED TO (CONTAINED IN REGISTER 0) INTO REGISTER 2,   */ 00183000
*        /* STORE THE OLD SAVEAREA POINTER INTO REGISTER 7, AND CHECK*/ 00184000
*        /* WHETHER OR NOT THIS MODULE'S AUTOMATIC STORAGE AREA IS TO*/ 00185000
*        /* BE FREED--NOTE DEPENDENCY ON SA01 INITIALIZING TABLE     */ 00186000
*        /* AUTOTBL WITH SA02 AS THE SECOND ENTRY            @YL026UK*/ 00187000
*        /*                                                  @YL026UK*/ 00188000
*        /************************************************************/ 00189000
*                                                                  0235 00190000
*        RESPECIFY (REG2,REG7,REG13) RSTD;                 /*@YL026UK*/ 00191000
*        REG2 = REG0;                                      /*@YL026UK*/ 00192000
         LR    REG2,REG0                                           0236 00193000
*        GEN(L     REG7,4(REG13));                         /*@YL026UK*/ 00194000
         L     REG7,4(REG13)                                            00195000
*        STATUS(2) = STATUS(2) - 1;                        /*@YL026UK*/ 00196000
*                                                                  0238 00197000
         L     @01,GDTSAH(,GDTPR)                                  0238 00198000
         L     @06,AUTOPTR(,@01)                                   0238 00199000
         ICM   @03,12,STATUS+12(@06)                               0238 00200000
         SRA   @03,16                                              0238 00201000
         BCTR  @03,0                                               0238 00202000
         STCM  @03,3,STATUS+12(@06)                                0238 00203000
*        /************************************************************/ 00204000
*        /*                                                  @YL026UK*/ 00205000
*        /* CHECK IF STATUS IS GREATER THAN ZERO             @YL026UK*/ 00206000
*        /*                                                  @YL026UK*/ 00207000
*        /************************************************************/ 00208000
*                                                                  0239 00209000
*        IF STATUS(2) > 0                                          0239 00210000
*          THEN                                                    0239 00211000
*                                                                  0239 00212000
         LTR   @03,@03                                             0239 00213000
         BNP   @RF00239                                            0239 00214000
*            /********************************************************/ 00215000
*            /*                                              @YL026UK*/ 00216000
*            /* FREE THE AREA                                @YL026UK*/ 00217000
*            /*                                              @YL026UK*/ 00218000
*            /********************************************************/ 00219000
*                                                                  0240 00220000
*            DO;                                           /*@YL026UK*/ 00221000
*              RESPECIFY (REG1,REG11) RSTD;                /*@YL026UK*/ 00222000
*              TEMPPTR = REG11 - 8;                        /*@YL026UK*/ 00223000
         LR    @06,REG11                                           0242 00224000
         SL    @06,@CF00175                                        0242 00225000
         ST    @06,TEMPPTR                                         0242 00226000
*              RESPECIFY (REG11) UNRSTD;                   /*@YL026UK*/ 00227000
*              REG0 = AUTOSIZE;                            /*@YL026UK*/ 00228000
         ICM   REG0,15,AUTOSIZE(@06)                               0244 00229000
*              REG1 = TEMPPTR;                             /*@YL026UK*/ 00230000
         LR    REG1,@06                                            0245 00231000
*LFREM7:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));         /*@YL026UK*/ 00232000
LFREM7   FREEMAIN R,LV=(REG0),A=(REG1)                                  00233000
*              RESPECIFY (REG0,REG1) UNRSTD;               /*@YL026UK*/ 00234000
*            END;                                          /*@YL026UK*/ 00235000
*                                                                  0248 00236000
*        /************************************************************/ 00237000
*        /*                                                  @YL026UK*/ 00238000
*        /* RESTORE OLD SAVEAREA POINTER,                    @YL026UK*/ 00239000
*        /* LOAD THE ADDRESS OF THE ENTRY POINT TO BE BRANCHED TO    */ 00240000
*        /* INTO REGISTER 15, AND RESTORE REGISTERS EXCLUDING        */ 00241000
*        /* REGISTER 15 WHICH IS USED IN THE BRANCH          @YL026UK*/ 00242000
*        /*                                                  @YL026UK*/ 00243000
*        /************************************************************/ 00244000
*                                                                  0249 00245000
*        REG13 = REG7;                                     /*@YL026UK*/ 00246000
@RF00239 LR    REG13,REG7                                          0249 00247000
*        RESPECIFY (REG7) UNRSTD;                          /*@YL026UK*/ 00248000
*        RESPECIFY (REG15) RSTD;                           /*@YL026UK*/ 00249000
*        REG15 = REG2;                                     /*@YL026UK*/ 00250000
         LR    REG15,REG2                                          0252 00251000
*        RESPECIFY (REG2) UNRSTD;                          /*@YL026UK*/ 00252000
*        GEN(L     REG14,12(REG13));                       /*@YL026UK*/ 00253000
         L     REG14,12(REG13)                                          00254000
*        GEN(LM    REG0,REG12,20(REG13));                  /*@YL026UK*/ 00255000
         LM    REG0,REG12,20(REG13)                                     00256000
*        RESPECIFY (REG13) UNRSTD;                         /*@YL026UK*/ 00257000
*                                                                  0256 00258000
*        /************************************************************/ 00259000
*        /*                                                  @YL026UK*/ 00260000
*        /* PREPARE FOR LINKAGE BY ADJUSTING THE ADDRESS LIST FOR THE*/ 00261000
*        /* PARAMETER LIST RECEIVED (ADDRESS OF MODULE NAME FOR      */ 00262000
*        /* MODULE TO BE CALLED IS NO LONGER NEEDED) AND EXECUTE A   */ 00263000
*        /* BRANCH ON REGISTER 15                            @YL026UK*/ 00264000
*        /*                                                  @YL026UK*/ 00265000
*        /************************************************************/ 00266000
*                                                                  0257 00267000
*        RESPECIFY(REG1) RSTD;                             /*@YL026UK*/ 00268000
*        GEN(MVC   4(4,REG1),0(REG1));                     /*@YL026UK*/ 00269000
         MVC   4(4,REG1),0(REG1)                                        00270000
*        GEN(LA    REG1,4(REG1));                          /*@YL026UK*/ 00271000
         LA    REG1,4(REG1)                                             00272000
*        GEN(BR    REG15);                                 /*@YL026UK*/ 00273000
         BR    REG15                                                    00274000
*        RESPECIFY(REG1,REG15) UNRSTD;                     /*@YL026UK*/ 00275000
*        /************************************************************/ 00276000
*        /************************************************************/ 00277000
*        /*                                                  @YL026UK*/ 00278000
*        /* ULOAD ENTRY POINT                                @YL026UK*/ 00279000
*        /*                                                  @YL026UK*/ 00280000
*        /************************************************************/ 00281000
*        /************************************************************/ 00282000
*                                                                  0262 00283000
*AMSSALD:  ENTRY(GDTTBLX,LDMODX,LDPOINTX);                 /*@YL026UK*/ 00284000
*                                                                  0262 00285000
@EC00262 DS    0H                                                  0263 00286000
*AMSSALD1:                                                         0263 00287000
*                                                                  0263 00288000
*        DCL LDMOD CHAR(8) BASED;      /* MODULE NAME FOR ULOAD      */ 00289000
*                                                                  0263 00290000
AMSSALD1 DS    0H                                                  0264 00291000
*        DCL LDPOINT PTR(31) BASED;    /* MODULE ADDRESS FOR ULOAD   */ 00292000
*                                                                  0264 00293000
*        RESPECIFY LDMOD BASED(PARMPTR2);                  /*@YL026UK*/ 00294000
*                                      /* BASE LDMOD         @YL026UK*/ 00295000
*                                                                  0266 00296000
*        RESPECIFY LDPOINT BASED(PARMPTR3);                /*@YL026UK*/ 00297000
*                                      /* BASE LDPOINT       @YL026UK*/ 00298000
*                                                                  0267 00299000
*        /************************************************************/ 00300000
*        /*                                                  @YL026UK*/ 00301000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 00302000
*        /*                                                  @YL026UK*/ 00303000
*        /************************************************************/ 00304000
*                                                                  0267 00305000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 00306000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 00307000
         L     GDTPR,ADDR1(,REG1PTR)                               0268 00308000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 00309000
         L     @00,ADDR2+4(,REG1PTR)                               0269 00310000
         ST    @00,PARMPTR2                                        0269 00311000
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/ 00312000
         L     @15,ADDR3+8(,REG1PTR)                               0270 00313000
         ST    @15,PARMPTR3                                        0270 00314000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 00315000
*                                                                  0271 00316000
*        OLDERID2 = NEWERID2;                                      0272 00317000
         L     @14,GDTTR2(,GDTPR)                                  0272 00318000
         MVC   @TS00001(95),NEWERID2(@14)                          0272 00319000
         MVC   OLDERID2(95,@14),@TS00001                           0272 00320000
*        NEWID2 = 'SALD';                                  /*@YL026UK*/ 00321000
*                                                                  0273 00322000
         MVC   NEWID2(4,@14),@CC01686                              0273 00323000
*        /************************************************************/ 00324000
*        /*                                                  @Z40GSBF*/ 00325000
*        /*  ISSUE CALL TO FINDNAME RTN TO GET MODULE ENRTY POINT    */ 00326000
*        /*  IF MODULE IS LOADED THEN ONLY UP USE COUNT BY ONE       */ 00327000
*        /*  IF NOT IN LOAD LIST LOAD THE MODULE MAKE USE COUNT      */ 00328000
*        /*  ONE AND RETURN ENTRY POINT EITHER CONDITION             */ 00329000
*        /*                                                  @Z40GSBF*/ 00330000
*        /************************************************************/ 00331000
*                                                                  0274 00332000
*        TEMPEPN = LDMOD;                                  /*@YL026UK*/ 00333000
         LR    @01,@00                                             0274 00334000
         MVC   TEMPEPN(8),LDMOD(@01)                               0274 00335000
*        CALL FINDNAME(TEMPEPN,LDPOINT);                   /*@Z40GSBF*/ 00336000
*                                                                  0275 00337000
         LA    @14,TEMPEPN                                         0275 00338000
         ST    @14,@AL00001                                        0275 00339000
         ST    @15,@AL00001+4                                      0275 00340000
         LA    @01,@AL00001                                        0275 00341000
         BAL   @14,FINDNAME                                        0275 00342000
*        /************************************************************/ 00343000
*        /*                                                  @YL026UK*/ 00344000
*        /* RETURN CONTROL TO THE ULOAD CALLER               @YL026UK*/ 00345000
*        /*                                                  @YL026UK*/ 00346000
*        /************************************************************/ 00347000
*                                                                  0276 00348000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0276 00349000
         ST    GDTPR,@AL00001                                      0276 00350000
         LA    @15,MODID                                           0276 00351000
         ST    @15,@AL00001+4                                      0276 00352000
         MVI   @AL00001+4,X'80'                                    0276 00353000
         L     @15,GDTEPL(,GDTPR)                                  0276 00354000
         LA    @01,@AL00001                                        0276 00355000
         BALR  @14,@15                                             0276 00356000
*         /*@YL026UK*/                                             0277 00357000
*        /************************************************************/ 00358000
*        /************************************************************/ 00359000
*        /*                                                  @YL026UK*/ 00360000
*        /* UDELETE ENTRY POINT                              @YL026UK*/ 00361000
*        /*                                                  @YL026UK*/ 00362000
*        /************************************************************/ 00363000
*        /************************************************************/ 00364000
*                                                                  0277 00365000
*AMSSADE:  ENTRY(GDTTBLX,DEMODX);                          /*@YL026UK*/ 00366000
*                                                                  0277 00367000
@EC00277 DS    0H                                                  0278 00368000
*AMSSADE1:                                                         0278 00369000
*                                                                  0278 00370000
*        DCL DEMOD CHAR(8) BASED;      /* MODULE NAME FOR UDELETE    */ 00371000
*                                                                  0278 00372000
AMSSADE1 DS    0H                                                  0279 00373000
*        RESPECIFY DEMOD BASED(PARMPTR2);                  /*@YL026UK*/ 00374000
*                                      /* BASE DEMOD         @YL026UK*/ 00375000
*                                                                  0280 00376000
*        /************************************************************/ 00377000
*        /*                                                  @YL026UK*/ 00378000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 00379000
*        /*                                                  @YL026UK*/ 00380000
*        /************************************************************/ 00381000
*                                                                  0280 00382000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 00383000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 00384000
         L     GDTPR,ADDR1(,REG1PTR)                               0281 00385000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 00386000
         L     @00,ADDR2+4(,REG1PTR)                               0282 00387000
         ST    @00,PARMPTR2                                        0282 00388000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 00389000
*                                                                  0283 00390000
*        OLDERID2 = NEWERID2;                                      0284 00391000
         L     @15,GDTTR2(,GDTPR)                                  0284 00392000
         MVC   @TS00001(95),NEWERID2(@15)                          0284 00393000
         MVC   OLDERID2(95,@15),@TS00001                           0284 00394000
*        NEWID2 = 'SADE';                                  /*@YL026UK*/ 00395000
*                                                                  0285 00396000
*                                                                  0285 00397000
         MVC   NEWID2(4,@15),@CC01698                              0285 00398000
*        /************************************************************/ 00399000
*        /*                                                  @Z40GSBF*/ 00400000
*        /*  UDELETE RTN NOW WILL SEARCH LLBLK(S)            @Z40GSBF*/ 00401000
*        /*  FOR MATCH OF NAME AND REDUCE USE CTR BY ONE     @Z40GSBF*/ 00402000
*        /*  UNLESS ITS ZERO ALREADY.THIS SHOULD NOT HAPPEN. @Z40GSBF*/ 00403000
*        /*                                                  @Z40GSBF*/ 00404000
*        /************************************************************/ 00405000
*                                                                  0286 00406000
*        IX = 0;                                           /*@Z40GSBF*/ 00407000
         SLR   @15,@15                                             0286 00408000
         ST    @15,IX                                              0286 00409000
*        CONTROL = OFF;                                    /*@Z40GSBF*/ 00410000
         NI    CONTROL,B'01111111'                                 0287 00411000
*        NAMEFND = OFF;                                    /*@Z40GSBF*/ 00412000
         NI    NAMEFND,B'01111111'                                 0288 00413000
*        DO WHILE CONTROL = OFF;                           /*@Z40GSBF*/ 00414000
         B     @DE00289                                            0289 00415000
@DL00289 DS    0H                                                  0290 00416000
*          IF IX = 0                                       /*@Z40GSBF*/ 00417000
*                                                                  0290 00418000
*          /**********************************************************/ 00419000
*          /*                                                @Z40GSBF*/ 00420000
*          /*    FIRST TIME USE POINTER IN SYSTEM            @Z40GSBF*/ 00421000
*          /*    HIST SAVE AREA TO LOAD LIST BLOCK           @Z40GSBF*/ 00422000
*          /*                                                @Z40GSBF*/ 00423000
*          /**********************************************************/ 00424000
*                                                                  0290 00425000
*            THEN                                          /*@Z40GSBF*/ 00426000
         L     @15,IX                                              0290 00427000
         LTR   @15,@15                                             0290 00428000
         BNZ   @RF00290                                            0290 00429000
*              P = LLBLKPTR;                               /*@Z40GSBF*/ 00430000
         L     @01,GDTSAH(,GDTPR)                                  0291 00431000
         L     @15,LLBLKPTR(,@01)                                  0291 00432000
         ST    @15,P                                               0291 00433000
*            ELSE;                                         /*@Z40GSBF*/ 00434000
*                                                                  0292 00435000
@RF00290 DS    0H                                                  0293 00436000
*          DO IX = 1 TO LLSLTCNT BY 1 WHILE CONTROL = OFF; /*@Z40GSBF*/ 00437000
*                                                                  0293 00438000
         LA    @15,1                                               0293 00439000
         ST    @15,IX                                              0293 00440000
@DL00293 TM    CONTROL,B'10000000'                                 0293 00441000
         BNZ   @DC00293                                            0293 00442000
*          /**********************************************************/ 00443000
*          /*                                                @Z40GSBF*/ 00444000
*          /*  LOOK FOR MATCH OF NAME IN LLBLK               @Z40GSBF*/ 00445000
*          /*  WHEN FOUND REDUCE USE CTR BY ONE              @Z40GSBF*/ 00446000
*          /*                                                @Z40GSBF*/ 00447000
*          /**********************************************************/ 00448000
*                                                                  0294 00449000
*            IF DEMOD = LLNAME(IX)                         /*@Z40GSBF*/ 00450000
*              THEN                                        /*@Z40GSBF*/ 00451000
         L     @14,P                                               0294 00452000
         SLA   @15,4                                               0294 00453000
         L     @01,PARMPTR2                                        0294 00454000
         ST    @15,@TF00001                                        0294 00455000
         ALR   @15,@14                                             0294 00456000
         AL    @15,@CF02460                                        0294 00457000
         CLC   DEMOD(8,@01),LLNAME-8(@15)                          0294 00458000
         BNE   @RF00294                                            0294 00459000
*                DO;                                       /*@Z40GSBF*/ 00460000
*                  CONTROL = ON;                           /*@Z40GSBF*/ 00461000
         OI    CONTROL,B'10000000'                                 0296 00462000
*                  NAMEFND = ON;                           /*@Z40GSBF*/ 00463000
         OI    NAMEFND,B'10000000'                                 0297 00464000
*                    IF LLUSECTR(IX) = 0                   /*@Z40GSBF*/ 00465000
*                      THEN                                /*@Z40GSBF*/ 00466000
         L     @15,@TF00001                                        0298 00467000
         SLR   @07,@07                                             0298 00468000
         IC    @07,LLUSECTR-16(@15,@14)                            0298 00469000
         C     @07,@CF00111                                        0298 00470000
         BNE   @RF00298                                            0298 00471000
*                        NAMEFND = OFF;                    /*@Z40GSBF*/ 00472000
         NI    NAMEFND,B'01111111'                                 0299 00473000
*                      ELSE                                /*@Z40GSBF*/ 00474000
*                        LLUSECTR(IX) = LLUSECTR(IX)-1;    /*@Z40GSBF*/ 00475000
         B     @RC00298                                            0300 00476000
@RF00298 L     @15,P                                               0300 00477000
         L     @14,IX                                              0300 00478000
         SLA   @14,4                                               0300 00479000
         SLR   @07,@07                                             0300 00480000
         IC    @07,LLUSECTR-16(@14,@15)                            0300 00481000
         BCTR  @07,0                                               0300 00482000
         STC   @07,LLUSECTR-16(@14,@15)                            0300 00483000
*                END;                                      /*@Z40GSBF*/ 00484000
*              ELSE;                                       /*@Z40GSBF*/ 00485000
@RF00294 DS    0H                                                  0303 00486000
*          END;                                            /*@Z40GSBF*/ 00487000
@RC00294 LA    @15,1                                               0303 00488000
         AL    @15,IX                                              0303 00489000
         ST    @15,IX                                              0303 00490000
         C     @15,@CF00306                                        0303 00491000
         BNH   @DL00293                                            0303 00492000
@DC00293 DS    0H                                                  0304 00493000
*            IF LLNXTBLK = 0                               /*@Z40GSBF*/ 00494000
*                                                                  0304 00495000
*            /********************************************************/ 00496000
*            /*                                              @Z40GSBF*/ 00497000
*            /*     WHEN ZERO THIS IS LAST LLBLK             @Z40GSBF*/ 00498000
*            /*                                              @Z40GSBF*/ 00499000
*            /********************************************************/ 00500000
*                                                                  0304 00501000
*              THEN                                        /*@Z40GSBF*/ 00502000
         L     @01,P                                               0304 00503000
         L     @15,LLNXTBLK(,@01)                                  0304 00504000
         LTR   @15,@15                                             0304 00505000
         BNZ   @RF00304                                            0304 00506000
*                CONTROL = ON;                             /*@Z40GSBF*/ 00507000
         OI    CONTROL,B'10000000'                                 0305 00508000
*              ELSE                                        /*@Z40GSBF*/ 00509000
*                P = LLNXTBLK;                             /*@Z40GSBF*/ 00510000
         B     @RC00304                                            0306 00511000
@RF00304 L     @01,P                                               0306 00512000
         L     @15,LLNXTBLK(,@01)                                  0306 00513000
         ST    @15,P                                               0306 00514000
*        END;                                              /*@Z40GSBF*/ 00515000
*                                                                  0307 00516000
@RC00304 DS    0H                                                  0307 00517000
@DE00289 TM    CONTROL,B'10000000'                                 0307 00518000
         BZ    @DL00289                                            0307 00519000
*        /************************************************************/ 00520000
*        /*                                                  @YL026UK*/ 00521000
*        /*   RETURN TO THE UDELETE CALLER                   @YL026UK*/ 00522000
*        /*                                                  @YL026UK*/ 00523000
*        /************************************************************/ 00524000
*                                                                  0308 00525000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0308 00526000
         ST    GDTPR,@AL00001                                      0308 00527000
         LA    @15,MODID                                           0308 00528000
         ST    @15,@AL00001+4                                      0308 00529000
         MVI   @AL00001+4,X'80'                                    0308 00530000
         L     @15,GDTEPL(,GDTPR)                                  0308 00531000
         LA    @01,@AL00001                                        0308 00532000
         BALR  @14,@15                                             0308 00533000
*         /*@YL026UK*/                                             0309 00534000
*        /************************************************************/ 00535000
*        /************************************************************/ 00536000
*        /*                                                  @YL026UK*/ 00537000
*        /* UGSPACE ENTRY POINT                              @YL026UK*/ 00538000
*        /*                                                  @YL026UK*/ 00539000
*        /************************************************************/ 00540000
*        /************************************************************/ 00541000
*                                                                  0309 00542000
*AMSSAGS:  ENTRY(GDTTBLX,GSSIZEX,GSPOINTX,GSINITX,GSSPIDX);/*@Y30LSMK*/ 00543000
*                                                                  0309 00544000
@EC00309 DS    0H                                                  0310 00545000
*AMSSAGS1:                                                         0310 00546000
*                                                                  0310 00547000
*        DCL GSSIZE FIXED(31) BASED;   /* SPACE SIZE FOR UGSPACE     */ 00548000
*                                                                  0310 00549000
AMSSAGS1 DS    0H                                                  0311 00550000
*        DCL GSPOINT PTR(31) BASED;    /* SPACE ADDR FOR UGSPACE     */ 00551000
*                                                                  0311 00552000
*        DCL GSINIT CHAR(4) BASED;     /* UGSPACE INIT ARGUMENT      */ 00553000
*                                                                  0312 00554000
*        DCL GSSPID FIXED(8) BASED;    /* UGSPACE SUBPOOL ID @Y30LSMK*/ 00555000
*                                                                  0313 00556000
*        RESPECIFY GSSIZE BASED(PARMPTR2);                 /*@YL026UK*/ 00557000
*                                      /* BASE GSSIZE        @YL026UK*/ 00558000
*                                                                  0315 00559000
*        RESPECIFY GSPOINT BASED(PARMPTR3);                /*@YL026UK*/ 00560000
*                                      /* BASE GSPOINT       @YL026UK*/ 00561000
*                                                                  0316 00562000
*        RESPECIFY GSINIT BASED(PARMPTR4);                 /*@YL026UK*/ 00563000
*                                      /* BASE GSINIT        @YL026UK*/ 00564000
*                                                                  0317 00565000
*        RESPECIFY GSSPID BASED(PARMPTR5);                 /*@Y30LSMK*/ 00566000
*                                      /* BASE GSSID         @Y30LSMK*/ 00567000
*                                                                  0318 00568000
*        /************************************************************/ 00569000
*        /*                                                  @YL026UK*/ 00570000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 00571000
*        /*                                                  @YL026UK*/ 00572000
*        /************************************************************/ 00573000
*                                                                  0318 00574000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 00575000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 00576000
         L     GDTPR,ADDR1(,REG1PTR)                               0319 00577000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 00578000
         L     @00,ADDR2+4(,REG1PTR)                               0320 00579000
         ST    @00,PARMPTR2                                        0320 00580000
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/ 00581000
         L     @00,ADDR3+8(,REG1PTR)                               0321 00582000
         ST    @00,PARMPTR3                                        0321 00583000
*        PARMPTR4 = ADDR4;                                 /*@YL026UK*/ 00584000
         L     @00,ADDR4+12(,REG1PTR)                              0322 00585000
         ST    @00,PARMPTR4                                        0322 00586000
*        PARMPTR5 = ADDR5;                                 /*@Y30LSMK*/ 00587000
         L     @00,ADDR5+16(,REG1PTR)                              0323 00588000
         ST    @00,PARMPTR5                                        0323 00589000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 00590000
*                                                                  0324 00591000
*                                                                  0324 00592000
*                                                                  0325 00593000
*        /************************************************************/ 00594000
*        /*                                                          */ 00595000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 00596000
*        /*                                                          */ 00597000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 00598000
*        /*              TO THIS ROUTINE                             */ 00599000
*        /*                                                          */ 00600000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 00601000
*        /*               ADDRESS LIST                               */ 00602000
*        /*                                                          */ 00603000
*        /************************************************************/ 00604000
*                                                                  0325 00605000
*        GEN;                                                      0325 00606000
        ST    1,LISTPTR                                                 00607000
        ST    1,LISTSCAN                                                00608000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0326 00609000
         LA    @15,1                                               0326 00610000
         STC   @15,LISTLN                                          0326 00611000
@DL00326 L     @14,LISTSCAN                                        0326 00612000
         TM    LISTTEST(@14),B'10000000'                           0326 00613000
         BNZ   @DC00326                                            0326 00614000
*          LISTSCAN = LISTSCAN + 4;                                0327 00615000
         AL    @14,@CF00038                                        0327 00616000
         ST    @14,LISTSCAN                                        0327 00617000
*        END;                                                      0328 00618000
*                                                                  0328 00619000
         AL    @15,@CF00215                                        0328 00620000
         STC   @15,LISTLN                                          0328 00621000
         C     @15,@CF01724                                        0328 00622000
         BNH   @DL00326                                            0328 00623000
@DC00326 DS    0H                                                  0329 00624000
*        OLDERID2 = NEWERID2;                                      0329 00625000
         L     @15,GDTTR2(,GDTPR)                                  0329 00626000
         MVC   @TS00001(95),NEWERID2(@15)                          0329 00627000
         MVC   OLDERID2(95,@15),@TS00001                           0329 00628000
*        NEWID2 = 'SAGS';                                  /*@YL026UK*/ 00629000
*                                                                  0330 00630000
         MVC   NEWID2(4,@15),@CC01725                              0330 00631000
*        RESPECIFY (REG4) RSTD;                            /*@YL026UK*/ 00632000
*        REG4 = GSSIZE + 8;                                /*@YL026UK*/ 00633000
*                                                                  0332 00634000
         LA    REG4,8                                              0332 00635000
         L     @05,PARMPTR2                                        0332 00636000
         AL    REG4,GSSIZE(,@05)                                   0332 00637000
*        /************************************************************/ 00638000
*        /*                                                  @YL026UK*/ 00639000
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE PLUS CONTROL      */ 00640000
*        /* INFORMATION AREA                                 @YL026UK*/ 00641000
*        /*                                                  @YL026UK*/ 00642000
*        /************************************************************/ 00643000
*                                                                  0333 00644000
*        GETLIST = GETGEN;                                 /*@YL026UK*/ 00645000
         MVC   GETLIST(10),GETGEN                                  0333 00646000
*        GETSZ = REG4;                                     /*@YL026UK*/ 00647000
         ST    REG4,GETSZ                                          0334 00648000
*        GETPT = ADDR(TEMPPTR);                            /*@YL026UK*/ 00649000
         LA    @05,TEMPPTR                                         0335 00650000
         ST    @05,GETPT                                           0335 00651000
*        IF LISTLN = 5                                             0336 00652000
*          THEN                                                    0336 00653000
*                                                                  0336 00654000
         CLI   LISTLN,5                                            0336 00655000
         BNE   @RF00336                                            0336 00656000
*            /********************************************************/ 00657000
*            /*                                              @Y30LSMK*/ 00658000
*            /* IF A SPECIFIC SUBPOOL WAS REQUESTED, INSERT THE      */ 00659000
*            /* SUBPOOL ID IN THE GETMAIN PARAMETER LIST.    @Y30LSMK*/ 00660000
*            /*                                              @Y30LSMK*/ 00661000
*            /********************************************************/ 00662000
*                                                                  0337 00663000
*              GETSP = GSSPID;                             /*@Y30LSMK*/ 00664000
*                                                                  0337 00665000
         L     @05,PARMPTR5                                        0337 00666000
         IC    @15,GSSPID(,@05)                                    0337 00667000
         STC   @15,GETSP                                           0337 00668000
*        RESPECIFY (REG1) RSTD;                            /*#YL026UK*/ 00669000
@RF00336 DS    0H                                                  0339 00670000
*        REG1 = ADDR(GETLIST);                             /*#YL026UK*/ 00671000
         LA    REG1,GETLIST                                        0339 00672000
*LGETM3: GEN(GETMAIN MF=(E,(REG1)));                       /*#YL026UK*/ 00673000
LGETM3   GETMAIN MF=(E,(REG1))                                          00674000
*        RESPECIFY (REG1) UNRSTD;                          /*#YL026UK*/ 00675000
*        RESPECIFY RTNREG RSTD;                                    0342 00676000
*        TESTRC = RTNREG;                                          0343 00677000
         STH   RTNREG,TESTRC                                       0343 00678000
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UK*/ 00679000
*                                                                  0344 00680000
*        /************************************************************/ 00681000
*        /*                                                  #YL026UK*/ 00682000
*        /* CHECK RETURN CODE FROM CORE REQUEST              #YL026UK*/ 00683000
*        /*                                                  #YL026UK*/ 00684000
*        /************************************************************/ 00685000
*                                                                  0345 00686000
*        IF TESTRC ^= 0                                            0345 00687000
*        /************************************************************/ 00688000
*        /*                                                  @Z40GSBF*/ 00689000
*        /* IF NO CORE AVAILABLE FREE MODULES NOT IN USE     @Z40GSBF*/ 00690000
*        /* AND TRY TO GETCORE AGAIN                         @Z40GSBF*/ 00691000
*        /*                                                  @Z40GSBF*/ 00692000
*        /************************************************************/ 00693000
*                                                                  0345 00694000
*          THEN                                                    0345 00695000
         LH    @05,TESTRC                                          0345 00696000
         LTR   @05,@05                                             0345 00697000
         BZ    @RF00345                                            0345 00698000
*            DO;                                           /*#YL026UK*/ 00699000
*              CALL RELECORE;                              /*@Z40GSBF*/ 00700000
         BAL   @14,RELECORE                                        0347 00701000
*              RESPECIFY (REG1) RSTD;                      /*@Z40GSBF*/ 00702000
*              REG1 = ADDR(GETLIST);                       /*@Z40GSBF*/ 00703000
         LA    REG1,GETLIST                                        0349 00704000
*LGETM3X:      GEN(GETMAIN MF=(E,(REG1)));                 /*@Z40GSBF*/ 00705000
LGETM3X  GETMAIN MF=(E,(REG1))                                          00706000
*              RESPECIFY (REG1) UNRSTD;                    /*@Z40GSBF*/ 00707000
*              RESPECIFY RTNREG RSTD;                              0352 00708000
*              TESTRC = RTNREG;                                    0353 00709000
         STH   RTNREG,TESTRC                                       0353 00710000
*              RESPECIFY RTNREG UNRSTD;                    /*@Z40GSBF*/ 00711000
*                                                                  0354 00712000
*              /******************************************************/ 00713000
*              /*                                            @Z40GSBF*/ 00714000
*              /* CHECK RETURN CODE FROM CORE REQUEST        @Z40GSBF*/ 00715000
*              /*                                            @Z40GSBF*/ 00716000
*              /******************************************************/ 00717000
*                                                                  0355 00718000
*              IF TESTRC ^= 0                              /*@Z40GSBF*/ 00719000
*                THEN                                      /*@Z40GSBF*/ 00720000
         LH    @05,TESTRC                                          0355 00721000
         SLR   @15,@15                                             0355 00722000
         CR    @05,@15                                             0355 00723000
         BE    @RF00355                                            0355 00724000
*                  DO;                                     /*@Z40GSBF*/ 00725000
*                    SETRC = 4;                            /*@Z40GSBF*/ 00726000
         MVC   SETRC(2),@CH00038                                   0357 00727000
*                    GSPOINT = 0;                          /*@Z40GSBF*/ 00728000
         L     @05,PARMPTR3                                        0358 00729000
         ST    @15,GSPOINT(,@05)                                   0358 00730000
*                  END;                                    /*@Z40GSBF*/ 00731000
*                ELSE                                      /*@Z40GSBF*/ 00732000
*                  SETRC = 0;                              /*@Z40GSBF*/ 00733000
         B     @RC00355                                            0360 00734000
@RF00355 SLR   @05,@05                                             0360 00735000
         STH   @05,SETRC                                           0360 00736000
*            END;                                          /*@Z40GSBF*/ 00737000
*          ELSE                                            /*@Z40GSBF*/ 00738000
*            SETRC = 0;                                    /*@Z40GSBF*/ 00739000
         B     @RC00345                                            0362 00740000
@RF00345 SLR   @05,@05                                             0362 00741000
         STH   @05,SETRC                                           0362 00742000
*        IF SETRC = 0                                      /*@Z40GSBF*/ 00743000
*          THEN                                            /*@Z40GSBF*/ 00744000
@RC00345 LH    @05,SETRC                                           0363 00745000
         LTR   @05,@05                                             0363 00746000
         BNZ   @RF00363                                            0363 00747000
*            DO;                                           /*@Z40GSBF*/ 00748000
*                                                          /*@Z40GSBF*/ 00749000
*              /******************************************************/ 00750000
*              /*                                            @YL026UK*/ 00751000
*              /* INITIALIZE THE UGSPACE AREA CONTROL INFORMATION,   */ 00752000
*              /* AND INITIALIZE THE UGSPACE AREA POINTER RETURNED   */ 00753000
*              /* TO THE USER                                @YL026UK*/ 00754000
*              /*                                            @YL026UK*/ 00755000
*              /******************************************************/ 00756000
*                                                                  0365 00757000
*              GSLEN = REG4;                               /*@YL026UK*/ 00758000
         L     @05,TEMPPTR                                         0365 00759000
         ST    REG4,GSLEN(,@05)                                    0365 00760000
*              RESPECIFY (REG4) UNRSTD;                    /*@YL026UK*/ 00761000
*              GSID = ' ';                                 /*@YL026UK*/ 00762000
         MVI   GSID+1(@05),C' '                                    0367 00763000
         MVC   GSID+2(2,@05),GSID+1(@05)                           0367 00764000
         MVI   GSID(@05),C' '                                      0367 00765000
*              GSPOINT = TEMPPTR + 8;                      /*@YL026UK*/ 00766000
*                                                                  0368 00767000
         LA    @04,8                                               0368 00768000
         ALR   @04,@05                                             0368 00769000
         L     @01,PARMPTR3                                        0368 00770000
         ST    @04,GSPOINT(,@01)                                   0368 00771000
*              /******************************************************/ 00772000
*              /*                                            @Y30LSMK*/ 00773000
*              /* BEFORE SETTING SUBPOOL ID, CHECK IF FIFTH  @Y30LSMK*/ 00774000
*              /* ARGUMENT IS SPECIFIED.                     @Y30LSMK*/ 00775000
*              /*                                            @Y30LSMK*/ 00776000
*              /******************************************************/ 00777000
*                                                                  0369 00778000
*              IF LISTLN = 5                                       0369 00779000
*                THEN                                              0369 00780000
         CLI   LISTLN,5                                            0369 00781000
         BNE   @RF00369                                            0369 00782000
*                  GSSUBPID = GSSPID;                      /*@Y30LSMK*/ 00783000
         L     @01,PARMPTR5                                        0370 00784000
         IC    @00,GSSPID(,@01)                                    0370 00785000
         STC   @00,GSSUBPID(,@05)                                  0370 00786000
*                ELSE                                              0371 00787000
*                  GSSUBPID = 0;                           /*@Y30LSMK*/ 00788000
*                                                                  0371 00789000
         B     @RC00369                                            0371 00790000
@RF00369 L     @01,TEMPPTR                                         0371 00791000
         MVI   GSSUBPID(@01),X'00'                                 0371 00792000
*              /******************************************************/ 00793000
*              /*                                            #YL026UK*/ 00794000
*              /* CHECK IF CORE INITIALIZATION REQUESTED BY CHECKING */ 00795000
*              /* FOR FOURTH ARGUMENT                        #YL026UK*/ 00796000
*              /*                                            #YL026UK*/ 00797000
*              /******************************************************/ 00798000
*                                                                  0372 00799000
*              IF LISTLN >= 4                                      0372 00800000
*                THEN                                              0372 00801000
@RC00369 CLI   LISTLN,4                                            0372 00802000
         BL    @RF00372                                            0372 00803000
*                  DO;                                     /*#YL026UK*/ 00804000
*                                                                  0373 00805000
*                    /************************************************/ 00806000
*                    /*                                      #YL026UK*/ 00807000
*                    /* PREPARE FOR CORE INITIALIZATION      #YL026UK*/ 00808000
*                    /*                                      #YL026UK*/ 00809000
*                    /************************************************/ 00810000
*                                                                  0374 00811000
*                    INITSIZE = GSSIZE;                    /*#YL026UK*/ 00812000
         L     @01,PARMPTR2                                        0374 00813000
         L     @15,GSSIZE(,@01)                                    0374 00814000
         ST    @15,INITSIZE                                        0374 00815000
*                    INITPTR = GSPOINT;                    /*#YL026UK*/ 00816000
*                                                                  0375 00817000
         L     @01,PARMPTR3                                        0375 00818000
         L     @15,GSPOINT(,@01)                                   0375 00819000
         ST    @15,INITPTR                                         0375 00820000
*                    /************************************************/ 00821000
*                    /*                                      #YL026UK*/ 00822000
*                    /* CHECK FOR INVALID LAST ARGUMENT, ABORT       */ 00823000
*                    /* IF INVALID                           #YL026UK*/ 00824000
*                    /*                                      #YL026UK*/ 00825000
*                    /************************************************/ 00826000
*                                                                  0376 00827000
*                    IF GSINIT ^= 'ZERO' & GSINIT ^= 'BLNK'        0376 00828000
*                      &  GSINIT ^= 'NSET'                         0376 00829000
*                      THEN                                        0376 00830000
*                                                                  0376 00831000
         L     @15,PARMPTR4                                        0376 00832000
         CLC   GSINIT(4,@15),@CC00167                              0376 00833000
         BE    @RF00376                                            0376 00834000
         CLC   GSINIT(4,@15),@CC00169                              0376 00835000
         BE    @RF00376                                            0376 00836000
         CLC   GSINIT(4,@15),@CC00171                              0376 00837000
         BE    @RF00376                                            0376 00838000
*                        DO;                                       0377 00839000
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      0378 00840000
*                          REG15 = ARGERR;                         0379 00841000
         LA    REG15,40                                            0379 00842000
*                          REG14 = GDTABT;                         0380 00843000
         L     REG14,GDTABT(,GDTPR)                                0380 00844000
*                          REG13 = GDTABH;                         0381 00845000
         L     REG13,GDTABH(,GDTPR)                                0381 00846000
*                          GEN(BR    REG14);                       0382 00847000
         BR    REG14                                                    00848000
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     0383 00849000
*                        END;                   /*#YL026UK*/       0384 00850000
*                                                                  0384 00851000
*                    /************************************************/ 00852000
*                    /*                                      #YL026UK*/ 00853000
*                    /* CHECK FOR ZERO INITIALIZATION REQUEST        */ 00854000
*                    /*                                      #YL026UK*/ 00855000
*                    /************************************************/ 00856000
*                                                                  0385 00857000
*                    IF GSINIT = 'ZERO'                            0385 00858000
*                      THEN                                        0385 00859000
*                                                                  0385 00860000
@RF00376 L     @01,PARMPTR4                                        0385 00861000
         CLC   GSINIT(4,@01),@CC00167                              0385 00862000
         BNE   @RF00385                                            0385 00863000
*                        /********************************************/ 00864000
*                        /*                                  #YL026UK*/ 00865000
*                        /* ZERO AREA                        #YL026UK*/ 00866000
*                        /*                                  #YL026UK*/ 00867000
*                        /********************************************/ 00868000
*                                                                  0386 00869000
*                        CALL COREINIT(INITSIZE,INITPTR,SET0);     0386 00870000
         LA    @15,INITSIZE                                        0386 00871000
         ST    @15,@AL00001                                        0386 00872000
         LA    @15,INITPTR                                         0386 00873000
         ST    @15,@AL00001+4                                      0386 00874000
         LA    @15,SET0                                            0386 00875000
         ST    @15,@AL00001+8                                      0386 00876000
         LA    @01,@AL00001                                        0386 00877000
         BAL   @14,COREINIT                                        0386 00878000
*                      ELSE                                        0387 00879000
*                                                                  0387 00880000
*                        /********************************************/ 00881000
*                        /*                                  @Y30LSMK*/ 00882000
*                        /* CHECK FOR BLANK INITIALIZATION   @Y30LSMK*/ 00883000
*                        /*                                  @Y30LSMK*/ 00884000
*                        /********************************************/ 00885000
*                                                                  0387 00886000
*                        IF GSINIT = 'BLNK'                        0387 00887000
*                          THEN                                    0387 00888000
*                                                                  0387 00889000
         B     @RC00385                                            0387 00890000
@RF00385 L     @01,PARMPTR4                                        0387 00891000
         CLC   GSINIT(4,@01),@CC00169                              0387 00892000
         BNE   @RF00387                                            0387 00893000
*                            /****************************************/ 00894000
*                            /*                              @Y30LSMK*/ 00895000
*                            /* BLANK AREA                   @Y30LSMK*/ 00896000
*                            /*                              @Y30LSMK*/ 00897000
*                            /****************************************/ 00898000
*                                                                  0388 00899000
*                            CALL COREINIT(INITSIZE,INITPTR,SETB); 0388 00900000
         LA    @15,INITSIZE                                        0388 00901000
         ST    @15,@AL00001                                        0388 00902000
         LA    @15,INITPTR                                         0388 00903000
         ST    @15,@AL00001+4                                      0388 00904000
         LA    @15,SETB                                            0388 00905000
         ST    @15,@AL00001+8                                      0388 00906000
         LA    @01,@AL00001                                        0388 00907000
         BAL   @14,COREINIT                                        0388 00908000
*                  END;                                    /*#YL026UK*/ 00909000
*            END;                                          /*#YL026UK*/ 00910000
*          ELSE;                                           /*@Z40GSBF*/ 00911000
*                                                                  0391 00912000
@RF00363 DS    0H                                                  0392 00913000
*        /************************************************************/ 00914000
*        /*                                                  #YL026UK*/ 00915000
*        /* RETURN TO THE UGSPACE CALLER                     #YL026UK*/ 00916000
*        /*                                                  #YL026UK*/ 00917000
*        /************************************************************/ 00918000
*                                                                  0392 00919000
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0392 00920000
@RC00363 ST    GDTPR,@AL00001                                      0392 00921000
         LA    @15,MODID                                           0392 00922000
         ST    @15,@AL00001+4                                      0392 00923000
         LA    @15,SETRC                                           0392 00924000
         ST    @15,@AL00001+8                                      0392 00925000
         MVI   @AL00001+8,X'80'                                    0392 00926000
         L     @15,GDTEPL(,GDTPR)                                  0392 00927000
         LA    @01,@AL00001                                        0392 00928000
         BALR  @14,@15                                             0392 00929000
*        /*#YL026UK*/                                              0393 00930000
*        /************************************************************/ 00931000
*        /************************************************************/ 00932000
*        /*                                                  #YL026UK*/ 00933000
*        /* UFSPACE ENTRY POINT                              #YL026UK*/ 00934000
*        /*                                                  #YL026UK*/ 00935000
*        /************************************************************/ 00936000
*        /************************************************************/ 00937000
*                                                                  0393 00938000
*AMSSAFS:  ENTRY(GDTTBLX,FSPOINTX);                        /*#YL026UK*/ 00939000
*                                                                  0393 00940000
@EC00393 DS    0H                                                  0394 00941000
*AMSSAFS1:                                                         0394 00942000
*                                                                  0394 00943000
*        DCL FSPOINT PTR(31) BASED;    /* SPACE ADDR FOR UGSPACE     */ 00944000
*                                                                  0394 00945000
AMSSAFS1 DS    0H                                                  0395 00946000
*        RESPECIFY FSPOINT BASED(PARMPTR2);                /*#YL026UK*/ 00947000
*                                      /* BASE FSPOINT       #YL026UK*/ 00948000
*                                                                  0396 00949000
*        DCL SPIDPTR  PTR(31);         /* PTR TO SUBPOOL ID  @Y30LSMK*/ 00950000
*                                                                  0396 00951000
*        /************************************************************/ 00952000
*        /*                                                  #YL026UK*/ 00953000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/ 00954000
*        /*                                                  #YL026UK*/ 00955000
*        /************************************************************/ 00956000
*                                                                  0397 00957000
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/ 00958000
*        GDTPR = ADDR1;                                    /*#YL026UK*/ 00959000
         L     GDTPR,ADDR1(,REG1PTR)                               0398 00960000
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/ 00961000
         LA    @15,4                                               0399 00962000
         LR    @14,REG1PTR                                         0399 00963000
         ALR   @14,@15                                             0399 00964000
         L     @00,ADDR2(,@14)                                     0399 00965000
         ST    @00,PARMPTR2                                        0399 00966000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/ 00967000
*                                                                  0400 00968000
*        OLDERID2 = NEWERID2;                                      0401 00969000
         L     @14,GDTTR2(,GDTPR)                                  0401 00970000
         MVC   @TS00001(95),NEWERID2(@14)                          0401 00971000
         MVC   OLDERID2(95,@14),@TS00001                           0401 00972000
*        NEWID2 = 'SAFS';                                  /*#YL026UK*/ 00973000
*                                                                  0402 00974000
         MVC   NEWID2(4,@14),@CC01745                              0402 00975000
*        /************************************************************/ 00976000
*        /*                                                  #YL026UK*/ 00977000
*        /* CHECK IF AREA TO BE FREED IS A UGSPACE OR UGPOOL AREA    */ 00978000
*        /*                                                  #YL026UK*/ 00979000
*        /************************************************************/ 00980000
*                                                                  0403 00981000
*        TEMPPTR = FSPOINT - 4;                            /*#YL026UK*/ 00982000
         LR    @01,@00                                             0403 00983000
         L     @14,FSPOINT(,@01)                                   0403 00984000
         SLR   @14,@15                                             0403 00985000
         ST    @14,TEMPPTR                                         0403 00986000
*        IF FREEID(1:3) = '   '                                    0404 00987000
*          THEN                                                    0404 00988000
         CLC   FREEID(3,@14),@CC01746                              0404 00989000
         BNE   @RF00404                                            0404 00990000
*            DO;                                           /*#YL026UK*/ 00991000
*                                                                  0405 00992000
*              /******************************************************/ 00993000
*              /*                                            #YL026UK*/ 00994000
*              /* FREE UGSPACE AREA                          #YL026UK*/ 00995000
*              /*                                            #YL026UK*/ 00996000
*              /******************************************************/ 00997000
*                                                                  0406 00998000
*              SPIDPTR = TEMPPTR - 4;                      /*@Y30LSMK*/ 00999000
         LCR   @15,@15                                             0406 01000000
         ALR   @15,@14                                             0406 01001000
         ST    @15,SPIDPTR                                         0406 01002000
*              SPIDPTR -> GSLENID = FREEID(4:4);           /*@Y30LSMK*/ 01003000
         IC    @07,FREEID+3(,@14)                                  0407 01004000
         STC   @07,GSLENID(,@15)                                   0407 01005000
*              TEMPPTR = TEMPPTR - 4;                      /*#YL026UK*/ 01006000
         ST    @15,TEMPPTR                                         0408 01007000
*              RESPECIFY (REG0,REG1) RSTD;                 /*#YL026UK*/ 01008000
*              REG0 = GSLEN;                               /*#YL026UK*/ 01009000
         L     REG0,GSLEN(,@15)                                    0410 01010000
*              REG1 = TEMPPTR;                             /*#YL026UK*/ 01011000
*                                                                  0411 01012000
         LR    REG1,@15                                            0411 01013000
*              /******************************************************/ 01014000
*              /*                                            #YL026UK*/ 01015000
*              /* ISSUE FREEMAIN MACRO TO FREE CORE          #YL026UK*/ 01016000
*              /*                                            #YL026UK*/ 01017000
*              /******************************************************/ 01018000
*                                                                  0412 01019000
*LFREM8:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));         /*#YL026UK*/ 01020000
LFREM8   FREEMAIN R,LV=(REG0),A=(REG1)                                  01021000
*              RESPECIFY (REG0,REG1) UNRSTD;               /*@YL026UK*/ 01022000
*            END;                                          /*#YL026UK*/ 01023000
*          ELSE                                                    0415 01024000
*            DO;                                           /*#YL026UK*/ 01025000
*                                                                  0415 01026000
         B     @RC00404                                            0415 01027000
@RF00404 DS    0H                                                  0416 01028000
*              /******************************************************/ 01029000
*              /*                                            #YL026UK*/ 01030000
*              /* CHECK IF UGPOOL AREA TO BE FREED IS THE LAST AREA  */ 01031000
*              /* IN THE UGPOOL CHAIN                        #YL026UK*/ 01032000
*              /*                                            #YL026UK*/ 01033000
*              /******************************************************/ 01034000
*                                                                  0416 01035000
*              TEMPPTR = TEMPPTR - 12;                     /*#YL026UK*/ 01036000
         L     @15,TEMPPTR                                         0416 01037000
         SL    @15,@CF00034                                        0416 01038000
         ST    @15,TEMPPTR                                         0416 01039000
*              IF GPLAST = TEMPPTR                                 0417 01040000
*                THEN                                              0417 01041000
         L     @14,GDTSAH(,GDTPR)                                  0417 01042000
         C     @15,GPLAST(,@14)                                    0417 01043000
         BNE   @RF00417                                            0417 01044000
*                  DO;                                     /*#YL026UK*/ 01045000
*                                                                  0418 01046000
*                    /************************************************/ 01047000
*                    /*                                      #YL026UK*/ 01048000
*                    /* UPDATE FORWARD CHAIN POINTER AND LAST UGPOOL */ 01049000
*                    /* AREA POINTER                         #YL026UK*/ 01050000
*                    /*                                      #YL026UK*/ 01051000
*                    /************************************************/ 01052000
*                                                                  0419 01053000
*                    PREFWD = 0;                           /*#YL026UK*/ 01054000
         L     @15,GPBACK(,@15)                                    0419 01055000
         SLR   @07,@07                                             0419 01056000
         ST    @07,PREFWD(,@15)                                    0419 01057000
*                    GPLAST = GPBACK;                      /*#YL026UK*/ 01058000
         ST    @15,GPLAST(,@14)                                    0420 01059000
*                  END;                                    /*#YL026UK*/ 01060000
*                ELSE                                              0422 01061000
*                  DO;                                     /*#YL026UK*/ 01062000
*                                                                  0422 01063000
         B     @RC00417                                            0422 01064000
@RF00417 DS    0H                                                  0423 01065000
*                    /************************************************/ 01066000
*                    /*                                      #YL026UK*/ 01067000
*                    /* UPDATE FORWARD AND BACKWARD CHAIN POINTERS   */ 01068000
*                    /*                                      #YL026UK*/ 01069000
*                    /************************************************/ 01070000
*                                                                  0423 01071000
*                    PREFWD = GPFORWRD;                    /*#YL026UK*/ 01072000
         L     @15,TEMPPTR                                         0423 01073000
         L     @14,GPBACK(,@15)                                    0423 01074000
         L     @15,GPFORWRD(,@15)                                  0423 01075000
         ST    @15,PREFWD(,@14)                                    0423 01076000
*                    PASBACK = GPBACK;                     /*#YL026UK*/ 01077000
         ST    @14,PASBACK(,@15)                                   0424 01078000
*                  END;                                    /*#YL026UK*/ 01079000
*                                                                  0425 01080000
*              /******************************************************/ 01081000
*              /*                                            #YL026UK*/ 01082000
*              /* FREE UGPOOL AREA                           #YL026UK*/ 01083000
*              /*                                            #YL026UK*/ 01084000
*              /******************************************************/ 01085000
*                                                                  0426 01086000
*              RESPECIFY (REG0,REG1) RSTD;                 /*#YL026UK*/ 01087000
@RC00417 DS    0H                                                  0427 01088000
*              REG0 = GPLEN;                               /*#YL026UK*/ 01089000
         L     @15,TEMPPTR                                         0427 01090000
         L     REG0,GPLEN(,@15)                                    0427 01091000
*              REG1 = TEMPPTR;                             /*#YL026UK*/ 01092000
*                                                                  0428 01093000
         LR    REG1,@15                                            0428 01094000
*              /******************************************************/ 01095000
*              /*                                            @YL026UK*/ 01096000
*              /* ISSUE FREEMAIN MACRO TO FREE CORE          @YL026UK*/ 01097000
*              /*                                            @YL026UK*/ 01098000
*              /******************************************************/ 01099000
*                                                                  0429 01100000
*LFREM9:       GEN(FREEMAIN R,LV=(REG0),A=(REG1));         /*@YL026UK*/ 01101000
LFREM9   FREEMAIN R,LV=(REG0),A=(REG1)                                  01102000
*              RESPECIFY (REG0,REG1) UNRSTD;               /*@YL026UK*/ 01103000
*            END;                                          /*@YL026UK*/ 01104000
*                                                                  0431 01105000
*        /************************************************************/ 01106000
*        /*                                                  @YL026UK*/ 01107000
*        /* RETURN TO THE UFSPACE CALLER                     @YL026UK*/ 01108000
*        /*                                                  @YL026UK*/ 01109000
*        /************************************************************/ 01110000
*                                                                  0432 01111000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0432 01112000
@RC00404 ST    GDTPR,@AL00001                                      0432 01113000
         LA    @15,MODID                                           0432 01114000
         ST    @15,@AL00001+4                                      0432 01115000
         MVI   @AL00001+4,X'80'                                    0432 01116000
         L     @15,GDTEPL(,GDTPR)                                  0432 01117000
         LA    @01,@AL00001                                        0432 01118000
         BALR  @14,@15                                             0432 01119000
*         /*@YL026UK*/                                             0433 01120000
*        /************************************************************/ 01121000
*        /************************************************************/ 01122000
*        /*                                                  @YL026UK*/ 01123000
*        /* UGPOOL ENTRY POINT                               @YL026UK*/ 01124000
*        /*                                                  @YL026UK*/ 01125000
*        /************************************************************/ 01126000
*        /************************************************************/ 01127000
*                                                                  0433 01128000
*AMSSAGP:  ENTRY(GDTTBLX,GPSIZEX,GPPOINTX,GPIDVARX,GPINITX);       0433 01129000
*                                                                  0433 01130000
@EC00433 DS    0H                                                  0434 01131000
*AMSSAGP1:                                                         0434 01132000
*                                                                  0434 01133000
*        DCL GPSIZE FIXED(31) BASED;   /* SIZE FOR UGPOOL    @YL026UK*/ 01134000
*                                                                  0434 01135000
AMSSAGP1 DS    0H                                                  0435 01136000
*        DCL GPPOINT PTR(31) BASED;    /* ADDR FOR UGPOOL    @YL026UK*/ 01137000
*                                                                  0435 01138000
*        DCL GPIDVAR CHAR(4) BASED;    /* ID FOR UGPOOL      @YL026UK*/ 01139000
*                                                                  0436 01140000
*        DCL GPINIT CHAR(4) BASED;     /* UGPOOL INIT ARGUMENT       */ 01141000
*                                                                  0437 01142000
*        DCL GPFCHAIN PTR(31) BASED(GPLAST);               /*@YL026UK*/ 01143000
*                                      /* UGPOOL FORWARD CHAIN       */ 01144000
*                                                                  0439 01145000
*        RESPECIFY GPSIZE BASED(PARMPTR2);                 /*@YL026UK*/ 01146000
*                                      /* BASE GPSIZE        @YL026UK*/ 01147000
*                                                                  0440 01148000
*        RESPECIFY GPPOINT BASED(PARMPTR3);                /*@YL026UK*/ 01149000
*                                      /* BASE GPPOINT       @YL026UK*/ 01150000
*                                                                  0441 01151000
*        RESPECIFY GPIDVAR BASED(PARMPTR4);                /*@YL026UK*/ 01152000
*                                      /* BASE GPIDVAR       @YL026UK*/ 01153000
*                                                                  0442 01154000
*        RESPECIFY GPINIT BASED(PARMPTR5);                 /*@YL026UK*/ 01155000
*                                      /* BASE GPINIT        @YL026UK*/ 01156000
*                                                                  0443 01157000
*        DCL PGCNTPTR PTR(31);         /* PTR TO 24-BYTE CONTROL INFO   01158000
*                                                            @Y30LSMK*/ 01159000
*                                                                  0443 01160000
*        /************************************************************/ 01161000
*        /*                                                  #YL026UK*/ 01162000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/ 01163000
*        /*                                                  #YL026UK*/ 01164000
*        /************************************************************/ 01165000
*                                                                  0444 01166000
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/ 01167000
*        GDTPR = ADDR1;                                    /*#YL026UK*/ 01168000
         L     GDTPR,ADDR1(,REG1PTR)                               0445 01169000
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/ 01170000
         L     @00,ADDR2+4(,REG1PTR)                               0446 01171000
         ST    @00,PARMPTR2                                        0446 01172000
*        PARMPTR3 = ADDR3;                                 /*#YL026UK*/ 01173000
         L     @00,ADDR3+8(,REG1PTR)                               0447 01174000
         ST    @00,PARMPTR3                                        0447 01175000
*        PARMPTR4 = ADDR4;                                 /*#YL026UK*/ 01176000
         L     @00,ADDR4+12(,REG1PTR)                              0448 01177000
         ST    @00,PARMPTR4                                        0448 01178000
*        PARMPTR5 = ADDR5;                                 /*#YL026UK*/ 01179000
         L     @00,ADDR5+16(,REG1PTR)                              0449 01180000
         ST    @00,PARMPTR5                                        0449 01181000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/ 01182000
*                                                                  0450 01183000
*                                                                  0450 01184000
*                                                                  0451 01185000
*        /************************************************************/ 01186000
*        /*                                                          */ 01187000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 01188000
*        /*                                                          */ 01189000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 01190000
*        /*              TO THIS ROUTINE                             */ 01191000
*        /*                                                          */ 01192000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 01193000
*        /*               ADDRESS LIST                               */ 01194000
*        /*                                                          */ 01195000
*        /************************************************************/ 01196000
*                                                                  0451 01197000
*        GEN;                                                      0451 01198000
        ST    1,LISTPTR                                                 01199000
        ST    1,LISTSCAN                                                01200000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0452 01201000
         LA    @15,1                                               0452 01202000
         STC   @15,LISTLN                                          0452 01203000
@DL00452 L     @14,LISTSCAN                                        0452 01204000
         TM    LISTTEST(@14),B'10000000'                           0452 01205000
         BNZ   @DC00452                                            0452 01206000
*          LISTSCAN = LISTSCAN + 4;                                0453 01207000
         AL    @14,@CF00038                                        0453 01208000
         ST    @14,LISTSCAN                                        0453 01209000
*        END;                                                      0454 01210000
*                                                                  0454 01211000
         AL    @15,@CF00215                                        0454 01212000
         STC   @15,LISTLN                                          0454 01213000
         C     @15,@CF01724                                        0454 01214000
         BNH   @DL00452                                            0454 01215000
@DC00452 DS    0H                                                  0455 01216000
*        OLDERID2 = NEWERID2;                                      0455 01217000
         L     @15,GDTTR2(,GDTPR)                                  0455 01218000
         MVC   @TS00001(95),NEWERID2(@15)                          0455 01219000
         MVC   OLDERID2(95,@15),@TS00001                           0455 01220000
*        NEWID2 = 'SAGP';                                  /*#YL026UK*/ 01221000
*                                                                  0456 01222000
         MVC   NEWID2(4,@15),@CC01776                              0456 01223000
*        RESPECIFY (REG4) RSTD;                            /*#YL026UK*/ 01224000
*                                                                  0457 01225000
*        /************************************************************/ 01226000
*        /*                                                  @Y30LSMK*/ 01227000
*        /* CHECK FOR A GET POOL REQUEST ON A PAGE BOUNDARY, IF YES, */ 01228000
*        /* A GETMAIN MUST BE ISSUED FOR THE PAGE BOUNDARY   @Y30LSMK*/ 01229000
*        /* CORE WITH NO CONTROL INFORMATION AREA, OTHERWISE @Y30LSMK*/ 01230000
*        /* THE CONTROL INFORMATION IS ADDED TO THE GETMAIN  @Y30LSMK*/ 01231000
*        /* REQUEST.                                         @Y30LSMK*/ 01232000
*        /*                                                  @Y30LSMK*/ 01233000
*        /************************************************************/ 01234000
*                                                                  0458 01235000
*        IF GPIDVAR(3:4) = 'PG'                                    0458 01236000
*          THEN                                                    0458 01237000
         L     @05,PARMPTR4                                        0458 01238000
         CLC   GPIDVAR+2(2,@05),@CC01777                           0458 01239000
         BNE   @RF00458                                            0458 01240000
*            DO;                                           /*@Y30LSMK*/ 01241000
*              REG4 = GPSIZE;                              /*@Y30LSMK*/ 01242000
         L     @01,PARMPTR2                                        0460 01243000
         L     REG4,GPSIZE(,@01)                                   0460 01244000
*              GETLIST = GETGENPG;                         /*@Y30LSMK*/ 01245000
         MVC   GETLIST(10),GETGENPG                                0461 01246000
*            END;                                          /*@Y30LSMK*/ 01247000
*          ELSE                                                    0463 01248000
*            DO;                                           /*@Y30LSMK*/ 01249000
         B     @RC00458                                            0463 01250000
@RF00458 DS    0H                                                  0464 01251000
*              REG4 = GPSIZE + 16;                         /*@Y30LSMK*/ 01252000
         LA    REG4,16                                             0464 01253000
         L     @05,PARMPTR2                                        0464 01254000
         AL    REG4,GPSIZE(,@05)                                   0464 01255000
*              GETLIST = GETGEN;                           /*@Y30LSMK*/ 01256000
         MVC   GETLIST(10),GETGEN                                  0465 01257000
*            END;                                          /*@Y30LSMK*/ 01258000
*                                                                  0466 01259000
*        /************************************************************/ 01260000
*        /*                                                  @Y30LSMK*/ 01261000
*        /* ISSUE GETMAIN MACRO FOR REQUESTED CORE           @Y30LSMK*/ 01262000
*        /*                                                  @Y30LSMK*/ 01263000
*        /************************************************************/ 01264000
*                                                                  0467 01265000
*        GETSZ = REG4;                                     /*@Y30LSMK*/ 01266000
@RC00458 ST    REG4,GETSZ                                          0467 01267000
*        GETPT = ADDR(TEMPPTR);                            /*@Y30LSMK*/ 01268000
         LA    @05,TEMPPTR                                         0468 01269000
         ST    @05,GETPT                                           0468 01270000
*        RESPECIFY (REG1) RSTD;                            /*@Y30LSMK*/ 01271000
*        REG1 = ADDR(GETLIST);                             /*@Y30LSMK*/ 01272000
         LA    REG1,GETLIST                                        0470 01273000
*LGETM4: GEN(GETMAIN MF=(E,(REG1)));                       /*@Y30LSMK*/ 01274000
LGETM4   GETMAIN MF=(E,(REG1))                                          01275000
*        RESPECIFY (REG1) UNRSTD;                          /*@Y30LSMK*/ 01276000
*        RESPECIFY RTNREG RSTD;                                    0473 01277000
*        TESTRC = RTNREG;                                          0474 01278000
         STH   RTNREG,TESTRC                                       0474 01279000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30LSMK*/ 01280000
*                                                                  0475 01281000
*        /************************************************************/ 01282000
*        /*                                                  @Y30LSMK*/ 01283000
*        /* CHECK RETURN CODE FROM CORE REQUEST              @Y30LSMK*/ 01284000
*        /*                                                  @Y30LSMK*/ 01285000
*        /************************************************************/ 01286000
*                                                          /*@Z40SGBF*/ 01287000
*        IF TESTRC ^= 0                                    /*@Z40SGBF*/ 01288000
*          THEN                                            /*@Z40SGBF*/ 01289000
         LH    @05,TESTRC                                          0476 01290000
         LTR   @05,@05                                             0476 01291000
         BZ    @RF00476                                            0476 01292000
*            DO;                                           /*@Z40SGBF*/ 01293000
*              /******************************************************/ 01294000
*              /*                                            @Z40SGBF*/ 01295000
*              /* NO CORE AVAILABLE DELETE MODULES NOT IN    @Z40SGBF*/ 01296000
*              /* USE AND TRY GET CORE AGAIN                 @Z40SGBF*/ 01297000
*              /*                                            @Z40SGBF*/ 01298000
*              /******************************************************/ 01299000
*              CALL RELECORE;                              /*@Z40SGBF*/ 01300000
         BAL   @14,RELECORE                                        0478 01301000
*              RESPECIFY (REG1) RSTD;                      /*@Z40SGBF*/ 01302000
*              REG1 = ADDR(GETLIST);                       /*@Z40SGBF*/ 01303000
         LA    REG1,GETLIST                                        0480 01304000
*LGETM4X:      GEN(GETMAIN MF=(E,(REG1)));                 /*@Z40SGBF*/ 01305000
LGETM4X  GETMAIN MF=(E,(REG1))                                          01306000
*              RESPECIFY (REG1) UNRSTD;                    /*@Z40SGBF*/ 01307000
*              RESPECIFY RTNREG RSTD;                              0483 01308000
*              TESTRC = RTNREG;                                    0484 01309000
         STH   RTNREG,TESTRC                                       0484 01310000
*              RESPECIFY RTNREG UNRSTD;                    /*@Z40SGBF*/ 01311000
*                                                          /*@Z40SGBF*/ 01312000
*              /******************************************************/ 01313000
*              /*                                            @Z40SGBF*/ 01314000
*              /* CHECK RETURN CODE FROM CORE REQUEST        @Z40SGBF*/ 01315000
*              /*                                            @Z40SGBF*/ 01316000
*              /******************************************************/ 01317000
*                                                          /*@Z40SGBF*/ 01318000
*              IF TESTRC ^= 0                              /*@Z40SGBF*/ 01319000
*                THEN                                      /*@Z40SGBF*/ 01320000
         LH    @05,TESTRC                                          0486 01321000
         SLR   @15,@15                                             0486 01322000
         CR    @05,@15                                             0486 01323000
         BE    @RF00486                                            0486 01324000
*                  DO;                                     /*@Z40SGBF*/ 01325000
*                    SETRC = 4;                            /*@Z40SGBF*/ 01326000
         MVC   SETRC(2),@CH00038                                   0488 01327000
*                    GPPOINT = 0;                          /*@Z40SGBF*/ 01328000
         L     @05,PARMPTR3                                        0489 01329000
         ST    @15,GPPOINT(,@05)                                   0489 01330000
*                  END;                                    /*@Z40SGBF*/ 01331000
*                ELSE                                      /*@Z40SGBF*/ 01332000
*                  SETRC = 0;                              /*@Z40SGBF*/ 01333000
         B     @RC00486                                            0491 01334000
@RF00486 SLR   @05,@05                                             0491 01335000
         STH   @05,SETRC                                           0491 01336000
*            END;                                          /*@Z40SGBF*/ 01337000
*          ELSE                                            /*@Z40SGBF*/ 01338000
*            SETRC = 0;                                    /*@Z40SGBF*/ 01339000
         B     @RC00476                                            0493 01340000
@RF00476 SLR   @05,@05                                             0493 01341000
         STH   @05,SETRC                                           0493 01342000
*        IF TESTRC = 0                                     /*@Z40SGBF*/ 01343000
*          THEN                                            /*@Z40SGBF*/ 01344000
@RC00476 LH    @05,TESTRC                                          0494 01345000
         LTR   @05,@05                                             0494 01346000
         BNZ   @RF00494                                            0494 01347000
*            DO;                                           /*@Z40SGBF*/ 01348000
*                                                          /*@Z40SGBF*/ 01349000
*              /******************************************************/ 01350000
*              /*                                            @Y30LSMK*/ 01351000
*              /* CHECK FOR A GET POOL REQUEST ON A PAGE BOUNDARY,   */ 01352000
*              /* IF YES, ISSUE GETMAIN FOR A 24-BYTE        @Y30LSMK*/ 01353000
*              /* CONTROL INFORMATION AREA.                  @Y30LSMK*/ 01354000
*              /*                                            @Y30LSMK*/ 01355000
*              /******************************************************/ 01356000
*                                                                  0496 01357000
*              IF GPIDVAR(3:4) = 'PG'                              0496 01358000
*                THEN                                              0496 01359000
         L     @05,PARMPTR4                                        0496 01360000
         CLC   GPIDVAR+2(2,@05),@CC01777                           0496 01361000
         BNE   @RF00496                                            0496 01362000
*PGCNTRL:          DO;                                     /*@Y30LSMK*/ 01363000
PGCNTRL  DS    0H                                                  0498 01364000
*                    RESPECIFY (REG5) RSTD;                /*@Y30LSMK*/ 01365000
*                    REG5 = 24;                            /*@Y30LSMK*/ 01366000
         LA    REG5,24                                             0499 01367000
*                    GETLIST = GETGEN;                     /*@Y30LSMK*/ 01368000
         MVC   GETLIST(10),GETGEN                                  0500 01369000
*                    GETSZ = REG5;                         /*@Y30LSMK*/ 01370000
         ST    REG5,GETSZ                                          0501 01371000
*                    GETPT = ADDR(PGCNTPTR);               /*@Y30LSMK*/ 01372000
         LA    @15,PGCNTPTR                                        0502 01373000
         ST    @15,GETPT                                           0502 01374000
*                    RESPECIFY (REG1) RSTD;                /*@Y30LSMK*/ 01375000
*                    REG1 = ADDR(GETLIST);                 /*@Y30LSMK*/ 01376000
         LA    REG1,GETLIST                                        0504 01377000
*LGETM5:             GEN(GETMAIN MF=(E,(REG1)));           /*@Y30LSMK*/ 01378000
LGETM5   GETMAIN MF=(E,(REG1))                                          01379000
*                    RESPECIFY (REG1) UNRSTD;              /*@Y30LSMK*/ 01380000
*                    RESPECIFY RTNREG RSTD;                        0507 01381000
*                    TESTRC = RTNREG;                              0508 01382000
         STH   RTNREG,TESTRC                                       0508 01383000
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30LSMK*/ 01384000
*                                                                  0509 01385000
*                    /************************************************/ 01386000
*                    /*                                      @Z40GSBF*/ 01387000
*                    /* CKECK RETURN CODE FROM CORE REQUEST  @Z40GSBF*/ 01388000
*                    /*                                      @Z40GSBF*/ 01389000
*                    /************************************************/ 01390000
*                                                                  0510 01391000
*                    IF TESTRC ^= 0                        /*@Z40GSBF*/ 01392000
*                      THEN                                /*@Z40GSBF*/ 01393000
         LH    @15,TESTRC                                          0510 01394000
         LTR   @15,@15                                             0510 01395000
         BZ    @RF00510                                            0510 01396000
*                        DO;                               /*@Z40GSBF*/ 01397000
*                                                                  0511 01398000
*                          /******************************************/ 01399000
*                          /*                                @Z40GSBF*/ 01400000
*                          /* NO CORE AVAILABLE DELETE MODULES     0512 01401000
*                          /* NOT IN USE AND TRY TO GET CORE AGAIN 0512 01402000
*                          /*                                @Z40GSBF*/ 01403000
*                          /******************************************/ 01404000
*                                                                  0512 01405000
*                          CALL RELECORE;                  /*@Z40GSBF*/ 01406000
         BAL   @14,RELECORE                                        0512 01407000
*                          RESPECIFY (REG1) RSTD;          /*@Z40GSBF*/ 01408000
*                          REG1 = ADDR(GETLIST);           /*@Z40GSBF*/ 01409000
         LA    REG1,GETLIST                                        0514 01410000
*LGETM5X:                  GEN(GETMAIN MF=(E,(REG1)));     /*@Z40GSBF*/ 01411000
LGETM5X  GETMAIN MF=(E,(REG1))                                          01412000
*                          RESPECIFY (REG1) UNRSTD;        /*@Z40GSBF*/ 01413000
*                          RESPECIFY RTNREG RSTD;                  0517 01414000
*                          TESTRC = RTNREG;                        0518 01415000
         STH   RTNREG,TESTRC                                       0518 01416000
*                          RESPECIFY RTNREG UNRSTD;        /*@Z40GSBF*/ 01417000
*                                                                  0519 01418000
*                            IF TESTRC ^= 0                /*@Z40GSBF*/ 01419000
*                              THEN                        /*@Z40GSBF*/ 01420000
         LH    @15,TESTRC                                          0520 01421000
         SLR   @14,@14                                             0520 01422000
         CR    @15,@14                                             0520 01423000
         BE    @RF00520                                            0520 01424000
*                                DO;                       /*@Z40GSBF*/ 01425000
*                                  /**********************************/ 01426000
*                                  /*                        @Z40GSBF*/ 01427000
*                                  /* THE REQUEST FOR MAIN STORAGE   */ 01428000
*                                  /* FAILED,SET THE RETURN CODE,ZERO*/ 01429000
*                                  /* OUT USER GETPOOL PTR, FREE THE */ 01430000
*                                  /* PAGE BOUNDARY CORE AND RETURN  */ 01431000
*                                  /* TO THE UGPOOL CALLER.          */ 01432000
*                                  /*                        @Z40GSBF*/ 01433000
*                                  /**********************************/ 01434000
*                                                                  0522 01435000
*                                  SETRC = 4;              /*@Z40GSBF*/ 01436000
         MVC   SETRC(2),@CH00038                                   0522 01437000
*                                  GPPOINT = 0;            /*@Z40GSBF*/ 01438000
         L     @15,PARMPTR3                                        0523 01439000
         ST    @14,GPPOINT(,@15)                                   0523 01440000
*                                  RESPECIFY (REG0,REG1) RSTD;     0524 01441000
*                                                          /*@Z40GSBF*/ 01442000
*                                  REG1 = TEMPPTR;         /*@Z40GSBF*/ 01443000
         L     REG1,TEMPPTR                                        0525 01444000
*                                  REG0 = REG4;            /*@Z40GSBF*/ 01445000
         LR    REG0,REG4                                           0526 01446000
*LFREM12:                          GEN(FREEMAIN R,LV=(REG0),A=(REG1));  01447000
LFREM12  FREEMAIN R,LV=(REG0),A=(REG1)                                  01448000
*                                                          /*@Z40GSBF*/ 01449000
*                                  RESPECIFY (REG0,REG1) UNRSTD;   0528 01450000
*                                                          /*@Z40GSBF*/ 01451000
*                                  CALL IDCSAEP0(GDTTBL,MODID,SETRC);   01452000
         ST    GDTPR,@AL00001                                      0529 01453000
         LA    @15,MODID                                           0529 01454000
         ST    @15,@AL00001+4                                      0529 01455000
         LA    @15,SETRC                                           0529 01456000
         ST    @15,@AL00001+8                                      0529 01457000
         MVI   @AL00001+8,X'80'                                    0529 01458000
         L     @15,GDTEPL(,GDTPR)                                  0529 01459000
         LA    @01,@AL00001                                        0529 01460000
         BALR  @14,@15                                             0529 01461000
*        /*@Z40GSBF*/                                              0530 01462000
*                                END;                      /*@Z40GSBF*/ 01463000
*                        END;                              /*@Z40GSBF*/ 01464000
@RF00520 DS    0H                                                  0532 01465000
*                  END PGCNTRL;                                    0532 01466000
*                                                                  0532 01467000
@RF00510 DS    0H                                                  0533 01468000
*              /******************************************************/ 01469000
*              /*                                            @Y30LSMK*/ 01470000
*              /* INITIALIZE THE UGPOOL AREA CONTROL INFORMATION,    */ 01471000
*              /* AND INITIALIZE THE UGPOOL AREA POINTER RETURNED TO */ 01472000
*              /* THE USER                                   @Y30LSMK*/ 01473000
*              /* NOTE - FOR A 24-BYTE CONTROL INFORMATION   @Y30LSMK*/ 01474000
*              /* AREA, THE ADDR AND LEN OF THE PAGE BOUNDARY        */ 01475000
*              /* CORE IS STORED IN WORDS 5 AND 6.           @Y30LSMK*/ 01476000
*              /*                                            @Y30LSMK*/ 01477000
*              /******************************************************/ 01478000
*                                                                  0533 01479000
*              IF GPIDVAR(3:4) = 'PG'                              0533 01480000
*                THEN                                              0533 01481000
@RF00496 L     @01,PARMPTR4                                        0533 01482000
         CLC   GPIDVAR+2(2,@01),@CC01777                           0533 01483000
         BNE   @RF00533                                            0533 01484000
*                  DO;                                     /*@Y30LSMK*/ 01485000
*                    PGCNTPTR->GPADRPG = TEMPPTR;          /*@Y30LSMK*/ 01486000
         L     @15,TEMPPTR                                         0535 01487000
         L     @14,PGCNTPTR                                        0535 01488000
         ST    @15,GPADRPG(,@14)                                   0535 01489000
*                    PGCNTPTR->GPLENPG = REG4;             /*@Y30LSMK*/ 01490000
         ST    REG4,GPLENPG(,@14)                                  0536 01491000
*                    PGCNTPTR->GPLEN = REG5;               /*@Y30LSMK*/ 01492000
         ST    REG5,GPLEN(,@14)                                    0537 01493000
*                    RESPECIFY (REG5) UNRSTD;              /*@Y30LSMK*/ 01494000
*                    GPPOINT = TEMPPTR;                    /*@Y30LSMK*/ 01495000
         L     @05,PARMPTR3                                        0539 01496000
         ST    @15,GPPOINT(,@05)                                   0539 01497000
*                    TEMPPTR = PGCNTPTR;                   /*@Y30LSMK*/ 01498000
         ST    @14,TEMPPTR                                         0540 01499000
*                  END;                                    /*@Y30LSMK*/ 01500000
*                ELSE                                              0542 01501000
*                  DO;                                     /*@Y30LSMK*/ 01502000
         B     @RC00533                                            0542 01503000
@RF00533 DS    0H                                                  0543 01504000
*                    GPLEN = REG4;                         /*@Y30LSMK*/ 01505000
         L     @05,TEMPPTR                                         0543 01506000
         ST    REG4,GPLEN(,@05)                                    0543 01507000
*                    RESPECIFY (REG4) UNRSTD;              /*@Y30LSMK*/ 01508000
*                    GPPOINT = TEMPPTR + 16;               /*@Y30LSMK*/ 01509000
         AL    @05,@CF00478                                        0545 01510000
         L     @04,PARMPTR3                                        0545 01511000
         ST    @05,GPPOINT(,@04)                                   0545 01512000
*                  END;                                    /*@Y30LSMK*/ 01513000
*                                                                  0546 01514000
*              GPFORWRD = 0;                               /*@Y30LSMK*/ 01515000
@RC00533 L     @15,TEMPPTR                                         0547 01516000
         SLR   @14,@14                                             0547 01517000
         ST    @14,GPFORWRD(,@15)                                  0547 01518000
*              GPID = GPIDVAR;                             /*@Y30LSMK*/ 01519000
         L     @14,PARMPTR4                                        0548 01520000
         MVC   GPID(4,@15),GPIDVAR(@14)                            0548 01521000
*              GPBACK = GPLAST;                            /*@Y30LSMK*/ 01522000
         L     @14,GDTSAH(,GDTPR)                                  0549 01523000
         L     @07,GPLAST(,@14)                                    0549 01524000
         ST    @07,GPBACK(,@15)                                    0549 01525000
*              GPFCHAIN = TEMPPTR;                         /*@Y30LSMK*/ 01526000
         ST    @15,GPFCHAIN(,@07)                                  0550 01527000
*              GPLAST = TEMPPTR;                           /*@Y30LSMK*/ 01528000
*                                                                  0551 01529000
         ST    @15,GPLAST(,@14)                                    0551 01530000
*              /******************************************************/ 01531000
*              /*                                            #YL026UK*/ 01532000
*              /* CHECK IF CORE INITIALIZATION REQUESTED     #YL026UK*/ 01533000
*              /*                                            #YL026UK*/ 01534000
*              /******************************************************/ 01535000
*                                                                  0552 01536000
*              IF LISTLN = 5                                       0552 01537000
*                THEN                                              0552 01538000
         CLI   LISTLN,5                                            0552 01539000
         BNE   @RF00552                                            0552 01540000
*                  DO;                                     /*#YL026UK*/ 01541000
*                                                                  0553 01542000
*                    /************************************************/ 01543000
*                    /*                                      #YL026UK*/ 01544000
*                    /* PREPARE FOR CORE INITIALIZATION      #YL026UK*/ 01545000
*                    /*                                      #YL026UK*/ 01546000
*                    /************************************************/ 01547000
*                                                                  0554 01548000
*                    INITSIZE = GPSIZE;                    /*#YL026UK*/ 01549000
         L     @01,PARMPTR2                                        0554 01550000
         L     @15,GPSIZE(,@01)                                    0554 01551000
         ST    @15,INITSIZE                                        0554 01552000
*                    INITPTR = GPPOINT;                    /*#YL026UK*/ 01553000
*                                                                  0555 01554000
         L     @01,PARMPTR3                                        0555 01555000
         L     @15,GPPOINT(,@01)                                   0555 01556000
         ST    @15,INITPTR                                         0555 01557000
*                    /************************************************/ 01558000
*                    /*                                      #YL026UK*/ 01559000
*                    /* CHECK FOR INVALID LAST ARGUMENT      #YL026UK*/ 01560000
*                    /*                                      #YL026UK*/ 01561000
*                    /************************************************/ 01562000
*                                                                  0556 01563000
*                    IF GPINIT ^= 'BLNK' & GPINIT ^= 'ZERO'        0556 01564000
*                      THEN                                        0556 01565000
*                                                                  0556 01566000
         L     @15,PARMPTR5                                        0556 01567000
         CLC   GPINIT(4,@15),@CC00169                              0556 01568000
         BE    @RF00556                                            0556 01569000
         CLC   GPINIT(4,@15),@CC00167                              0556 01570000
         BE    @RF00556                                            0556 01571000
*                        DO;                                       0557 01572000
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      0558 01573000
*                          REG15 = ARGERR;                         0559 01574000
         LA    REG15,40                                            0559 01575000
*                          REG14 = GDTABT;                         0560 01576000
         L     REG14,GDTABT(,GDTPR)                                0560 01577000
*                          REG13 = GDTABH;                         0561 01578000
         L     REG13,GDTABH(,GDTPR)                                0561 01579000
*                          GEN(BR    REG14);                       0562 01580000
         BR    REG14                                                    01581000
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     0563 01582000
*                        END;                   /*#YL026UK*/       0564 01583000
*                                                                  0564 01584000
*                    /************************************************/ 01585000
*                    /*                                      #YL026UK*/ 01586000
*                    /* CHECK FOR ZERO INITIALIZATION REQUEST        */ 01587000
*                    /*                                      #YL026UK*/ 01588000
*                    /************************************************/ 01589000
*                                                                  0565 01590000
*                    IF GPINIT = 'ZERO'                            0565 01591000
*                      THEN                                        0565 01592000
*                                                                  0565 01593000
@RF00556 L     @01,PARMPTR5                                        0565 01594000
         CLC   GPINIT(4,@01),@CC00167                              0565 01595000
         BNE   @RF00565                                            0565 01596000
*                        /********************************************/ 01597000
*                        /*                                  #YL026UK*/ 01598000
*                        /* ZERO AREA                        #YL026UK*/ 01599000
*                        /*                                  #YL026UK*/ 01600000
*                        /********************************************/ 01601000
*                                                                  0566 01602000
*                        CALL COREINIT(INITSIZE,INITPTR,SET0);     0566 01603000
         LA    @15,INITSIZE                                        0566 01604000
         ST    @15,@AL00001                                        0566 01605000
         LA    @15,INITPTR                                         0566 01606000
         ST    @15,@AL00001+4                                      0566 01607000
         LA    @15,SET0                                            0566 01608000
         ST    @15,@AL00001+8                                      0566 01609000
         LA    @01,@AL00001                                        0566 01610000
         BAL   @14,COREINIT                                        0566 01611000
*                      ELSE                                        0567 01612000
*                                                                  0567 01613000
*                        /********************************************/ 01614000
*                        /*                                  @YL026UK*/ 01615000
*                        /* BLANK AREA                       @YL026UK*/ 01616000
*                        /*                                  @YL026UK*/ 01617000
*                        /********************************************/ 01618000
*                                                                  0567 01619000
*                        CALL COREINIT(INITSIZE,INITPTR,SETB);     0567 01620000
         B     @RC00565                                            0567 01621000
@RF00565 LA    @15,INITSIZE                                        0567 01622000
         ST    @15,@AL00001                                        0567 01623000
         LA    @15,INITPTR                                         0567 01624000
         ST    @15,@AL00001+4                                      0567 01625000
         LA    @15,SETB                                            0567 01626000
         ST    @15,@AL00001+8                                      0567 01627000
         LA    @01,@AL00001                                        0567 01628000
         BAL   @14,COREINIT                                        0567 01629000
*                  END;                                    /*@YL026UK*/ 01630000
*            END;                                          /*@YL026UK*/ 01631000
*          ELSE;                                           /*@Z40GSBF*/ 01632000
*                                                                  0570 01633000
@RF00494 DS    0H                                                  0571 01634000
*        /************************************************************/ 01635000
*        /*                                                  @YL026UK*/ 01636000
*        /* RETURN TO THE UGPOOL CALLER                      @YL026UK*/ 01637000
*        /*                                                  @YL026UK*/ 01638000
*        /************************************************************/ 01639000
*                                                                  0571 01640000
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0571 01641000
@RC00494 ST    GDTPR,@AL00001                                      0571 01642000
         LA    @15,MODID                                           0571 01643000
         ST    @15,@AL00001+4                                      0571 01644000
         LA    @15,SETRC                                           0571 01645000
         ST    @15,@AL00001+8                                      0571 01646000
         MVI   @AL00001+8,X'80'                                    0571 01647000
         L     @15,GDTEPL(,GDTPR)                                  0571 01648000
         LA    @01,@AL00001                                        0571 01649000
         BALR  @14,@15                                             0571 01650000
*        /*@YL026UK*/                                              0572 01651000
*        /************************************************************/ 01652000
*        /************************************************************/ 01653000
*        /*                                                  @YL026UK*/ 01654000
*        /* UFPOOL ENTRY POINT                               @YL026UK*/ 01655000
*        /*                                                  @YL026UK*/ 01656000
*        /************************************************************/ 01657000
*        /************************************************************/ 01658000
*                                                                  0572 01659000
*AMSSAFP:  ENTRY(GDTTBLX,FPIDVARX,FPALLX);                 /*@YL026UK*/ 01660000
*                                                                  0572 01661000
@EC00572 DS    0H                                                  0573 01662000
*AMSSAFP1:                                                         0573 01663000
*                                                                  0573 01664000
*        DCL FPIDVAR CHAR(4) BASED;    /* SPACE ID FOR UFPOOL        */ 01665000
*                                                                  0573 01666000
AMSSAFP1 DS    0H                                                  0574 01667000
*        DCL FPALL CHAR(3) BASED;      /* UFPOOL ALL ARGUMENT        */ 01668000
*                                                                  0574 01669000
*        RESPECIFY FPIDVAR BASED(PARMPTR2);                /*@YL026UK*/ 01670000
*                                      /* BASE FPIDVAR       @YL026UK*/ 01671000
*                                                                  0576 01672000
*        RESPECIFY FPALL BASED(PARMPTR3);                  /*@YL026UK*/ 01673000
*                                      /* BASE FPALL         @YL026UK*/ 01674000
*                                                                  0577 01675000
*        /************************************************************/ 01676000
*        /*                                                  @YL026UK*/ 01677000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 01678000
*        /*                                                  @YL026UK*/ 01679000
*        /************************************************************/ 01680000
*                                                                  0577 01681000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 01682000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 01683000
         L     GDTPR,ADDR1(,REG1PTR)                               0578 01684000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 01685000
         L     @00,ADDR2+4(,REG1PTR)                               0579 01686000
         ST    @00,PARMPTR2                                        0579 01687000
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/ 01688000
         L     @00,ADDR3+8(,REG1PTR)                               0580 01689000
         ST    @00,PARMPTR3                                        0580 01690000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 01691000
*                                                                  0581 01692000
*                                                                  0581 01693000
*                                                                  0582 01694000
*        /************************************************************/ 01695000
*        /*                                                          */ 01696000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 01697000
*        /*                                                          */ 01698000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 01699000
*        /*              TO THIS ROUTINE                             */ 01700000
*        /*                                                          */ 01701000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 01702000
*        /*               ADDRESS LIST                               */ 01703000
*        /*                                                          */ 01704000
*        /************************************************************/ 01705000
*                                                                  0582 01706000
*        GEN;                                                      0582 01707000
        ST    1,LISTPTR                                                 01708000
        ST    1,LISTSCAN                                                01709000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0583 01710000
         LA    @15,1                                               0583 01711000
         STC   @15,LISTLN                                          0583 01712000
@DL00583 L     @14,LISTSCAN                                        0583 01713000
         TM    LISTTEST(@14),B'10000000'                           0583 01714000
         BNZ   @DC00583                                            0583 01715000
*          LISTSCAN = LISTSCAN + 4;                                0584 01716000
         AL    @14,@CF00038                                        0584 01717000
         ST    @14,LISTSCAN                                        0584 01718000
*        END;                                                      0585 01719000
*                                                                  0585 01720000
         AL    @15,@CF00215                                        0585 01721000
         STC   @15,LISTLN                                          0585 01722000
         C     @15,@CF01724                                        0585 01723000
         BNH   @DL00583                                            0585 01724000
@DC00583 DS    0H                                                  0586 01725000
*        OLDERID2 = NEWERID2;                                      0586 01726000
         L     @15,GDTTR2(,GDTPR)                                  0586 01727000
         MVC   @TS00001(95),NEWERID2(@15)                          0586 01728000
         MVC   OLDERID2(95,@15),@TS00001                           0586 01729000
*        NEWID2 = 'SAFP';                                  /*@YL026UK*/ 01730000
*                                                                  0587 01731000
         MVC   NEWID2(4,@15),@CC01805                              0587 01732000
*        /************************************************************/ 01733000
*        /*                                                  @YL026UK*/ 01734000
*        /* CHECK FOR INVALID LAST ARGUMENT                  @YL026UK*/ 01735000
*        /*                                                  @YL026UK*/ 01736000
*        /************************************************************/ 01737000
*                                                                  0588 01738000
*        IF LISTPTR = 3 & FPALL ^= 'ALL'                           0588 01739000
*          THEN                                                    0588 01740000
*                                                                  0588 01741000
         CLC   LISTPTR(4),@CF00158                                 0588 01742000
         BNE   @RF00588                                            0588 01743000
         L     @01,PARMPTR3                                        0588 01744000
         CLC   FPALL(3,@01),@CC00159                               0588 01745000
         BE    @RF00588                                            0588 01746000
*            DO;                                                   0589 01747000
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0590 01748000
*              REG15 = ARGERR;                                     0591 01749000
         LA    REG15,40                                            0591 01750000
*              REG14 = GDTABT;                                     0592 01751000
         L     REG14,GDTABT(,GDTPR)                                0592 01752000
*              REG13 = GDTABH;                                     0593 01753000
         L     REG13,GDTABH(,GDTPR)                                0593 01754000
*              GEN(BR    REG14);                                   0594 01755000
         BR    REG14                                                    01756000
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0595 01757000
*            END;                               /*@YL026UK*/       0596 01758000
*                                                                  0596 01759000
*        /************************************************************/ 01760000
*        /*                                                  @YL026UK*/ 01761000
*        /* CHECK FOR NO UGPOOL AREAS TO FREE                @YL026UK*/ 01762000
*        /*                                                  @YL026UK*/ 01763000
*        /************************************************************/ 01764000
*                                                                  0597 01765000
*        IF GPFIRST = 0                                            0597 01766000
*          THEN                                                    0597 01767000
@RF00588 L     @01,GDTSAH(,GDTPR)                                  0597 01768000
         L     @15,GPFIRST(,@01)                                   0597 01769000
         LTR   @15,@15                                             0597 01770000
         BNZ   @RF00597                                            0597 01771000
*            DO;                                           /*@YL026UK*/ 01772000
*              CALL IDCSAEP0(GDTTBL,MODID);                        0599 01773000
         ST    GDTPR,@AL00001                                      0599 01774000
         LA    @15,MODID                                           0599 01775000
         ST    @15,@AL00001+4                                      0599 01776000
         MVI   @AL00001+4,X'80'                                    0599 01777000
         L     @15,GDTEPL(,GDTPR)                                  0599 01778000
         LA    @01,@AL00001                                        0599 01779000
         BALR  @14,@15                                             0599 01780000
*         /*@YL026UK*/                                             0600 01781000
*            END;                                          /*@YL026UK*/ 01782000
*                                                                  0600 01783000
*        /************************************************************/ 01784000
*        /*                                                  @YL026UK*/ 01785000
*        /* SCAN UGPOOL AREAS AND RELEASE AREAS TO BE RELEASED       */ 01786000
*        /*                                                  @YL026UK*/ 01787000
*        /************************************************************/ 01788000
*                                                                  0601 01789000
*        DOCNTRL = ON;                                     /*@YL026UK*/ 01790000
@RF00597 OI    DOCNTRL,B'10000000'                                 0601 01791000
*        TEMPPTR = GPFIRST;                                /*@YL026UK*/ 01792000
         L     @01,GDTSAH(,GDTPR)                                  0602 01793000
         L     @15,GPFIRST(,@01)                                   0602 01794000
         ST    @15,TEMPPTR                                         0602 01795000
*FPDO:   DO WHILE (DOCNTRL = ON);                          /*@YL026UK*/ 01796000
*                                                                  0603 01797000
FPDO     B     @DE00603                                            0603 01798000
@DL00603 DS    0H                                                  0604 01799000
*          /**********************************************************/ 01800000
*          /*                                                @YL026UK*/ 01801000
*          /* CHECK IF THIS AREA IS TO BE FREED              @YL026UK*/ 01802000
*          /*                                                @YL026UK*/ 01803000
*          /**********************************************************/ 01804000
*                                                                  0604 01805000
*          IF (LISTLN=3 & GPID(1:2)=FPIDVAR(1:2)) | (GPID=FPIDVAR) 0604 01806000
*            THEN                                                  0604 01807000
         CLI   LISTLN,3                                            0604 01808000
         BNE   @GL00005                                            0604 01809000
         L     @01,TEMPPTR                                         0604 01810000
         L     @15,PARMPTR2                                        0604 01811000
         CLC   GPID(2,@01),FPIDVAR(@15)                            0604 01812000
         BE    @RT00604                                            0604 01813000
@GL00005 L     @01,TEMPPTR                                         0604 01814000
         L     @15,PARMPTR2                                        0604 01815000
         CLC   GPID(4,@01),FPIDVAR(@15)                            0604 01816000
         BNE   @RF00604                                            0604 01817000
@RT00604 DS    0H                                                  0605 01818000
*              DO;                                         /*@YL026UK*/ 01819000
*                                                                  0605 01820000
*                /****************************************************/ 01821000
*                /*                                          @YL026UK*/ 01822000
*                /* CHECK IF UGPOOL AREA TO BE FREED IS THE LAST AREA*/ 01823000
*                /* IN THE UGPOOL CHAIN                      @YL026UK*/ 01824000
*                /*                                          @YL026UK*/ 01825000
*                /****************************************************/ 01826000
*                                                                  0606 01827000
*                IF GPLAST = TEMPPTR                               0606 01828000
*                  THEN                                            0606 01829000
         L     @15,TEMPPTR                                         0606 01830000
         L     @14,GDTSAH(,GDTPR)                                  0606 01831000
         C     @15,GPLAST(,@14)                                    0606 01832000
         BNE   @RF00606                                            0606 01833000
*                    DO;                                   /*@YL026UK*/ 01834000
*                                                                  0607 01835000
*                      /**********************************************/ 01836000
*                      /*                                    @YL026UK*/ 01837000
*                      /* UPDATE FORWARD CHAIN POINTER AND LAST      */ 01838000
*                      /* UGPOOL AREA POINTER, AND SET DOCNTRL TO    */ 01839000
*                      /* FALL OUT OF DO WHILE LOOP          @YL026UK*/ 01840000
*                      /*                                    @YL026UK*/ 01841000
*                      /**********************************************/ 01842000
*                                                                  0608 01843000
*                      DOCNTRL = OFF;                      /*@YL026UK*/ 01844000
         NI    DOCNTRL,B'01111111'                                 0608 01845000
*                      PREFWD = 0;                         /*@YL026UK*/ 01846000
         L     @15,GPBACK(,@15)                                    0609 01847000
         SLR   @07,@07                                             0609 01848000
         ST    @07,PREFWD(,@15)                                    0609 01849000
*                      GPLAST = GPBACK;                    /*@YL026UK*/ 01850000
         ST    @15,GPLAST(,@14)                                    0610 01851000
*                    END;                                  /*@YL026UK*/ 01852000
*                  ELSE                                            0612 01853000
*                    DO;                                   /*@YL026UK*/ 01854000
*                                                                  0612 01855000
         B     @RC00606                                            0612 01856000
@RF00606 DS    0H                                                  0613 01857000
*                      /**********************************************/ 01858000
*                      /*                                    @YL026UK*/ 01859000
*                      /* UPDATE FORWARD AND BACKWARD CHAIN POINTERS */ 01860000
*                      /*                                    @YL026UK*/ 01861000
*                      /**********************************************/ 01862000
*                                                                  0613 01863000
*                      PREFWD = GPFORWRD;                  /*@YL026UK*/ 01864000
         L     @15,TEMPPTR                                         0613 01865000
         L     @14,GPBACK(,@15)                                    0613 01866000
         L     @15,GPFORWRD(,@15)                                  0613 01867000
         ST    @15,PREFWD(,@14)                                    0613 01868000
*                      PASBACK = GPBACK;                   /*@YL026UK*/ 01869000
         ST    @14,PASBACK(,@15)                                   0614 01870000
*                    END;                                  /*@YL026UK*/ 01871000
*                                                                  0615 01872000
*                /****************************************************/ 01873000
*                /*                                          @Y30LSMK*/ 01874000
*                /* CHECK FOR A 24-BYTE CONTROL INFORMATION AREA     */ 01875000
*                /* REQUIRED FOR THE SPACE GOTTEN ON THE PAGE        */ 01876000
*                /* BOUNDARY.                                @Y30LSMK*/ 01877000
*                /*                                          @Y30LSMK*/ 01878000
*                /****************************************************/ 01879000
*                                                                  0616 01880000
*                IF GPID(3:4) = 'PG'                               0616 01881000
*                  THEN                                            0616 01882000
*                                                                  0616 01883000
@RC00606 L     @15,TEMPPTR                                         0616 01884000
         CLC   GPID+2(2,@15),@CC01777                              0616 01885000
         BNE   @RF00616                                            0616 01886000
*                    /************************************************/ 01887000
*                    /*                                      @Y30LSMK*/ 01888000
*                    /* FREE THE PAGE BOUNDARY AREA.  THE SPACE      */ 01889000
*                    /* TO BE FREED IS POINTED TO BY THE 5-WORD      */ 01890000
*                    /* OF THE 24-BYTE CONTROL INFORMATION   @Y30LSMK*/ 01891000
*                    /* AREA.                                @Y30LSMK*/ 01892000
*                    /*                                      @Y30LSMK*/ 01893000
*                    /************************************************/ 01894000
*                                                                  0617 01895000
*                    DO;                                   /*@Y30LSMK*/ 01896000
*                      RESPECIFY (REG0,REG1) RSTD;         /*@Y30LSMK*/ 01897000
*                      REG1 = GPADRPG;                     /*@Y30LSMK*/ 01898000
         L     REG1,GPADRPG(,@15)                                  0619 01899000
*                      REG0 = GPLENPG;                     /*@Y30LSMK*/ 01900000
*                                                                  0620 01901000
         L     REG0,GPLENPG(,@15)                                  0620 01902000
*                      /**********************************************/ 01903000
*                      /*                                    @Y30LSMK*/ 01904000
*                      /* ISSUE FREEMAIN MACRO TO FREE PAGE  @Y30LSMK*/ 01905000
*                      /* BOUNDARY CORE.                     @Y30LSMK*/ 01906000
*                      /*                                    @Y30LSMK*/ 01907000
*                      /**********************************************/ 01908000
*                                                                  0621 01909000
*LFREM13:              GEN(FREEMAIN R,LV=(REG0),A=(REG1)); /*@Y30LSMK*/ 01910000
LFREM13  FREEMAIN R,LV=(REG0),A=(REG1)                                  01911000
*                      RESPECIFY (REG0,REG1) UNRSTD;       /*@Y30LSMK*/ 01912000
*                    END;                                  /*@Y30LSMK*/ 01913000
*                                                                  0623 01914000
*                /****************************************************/ 01915000
*                /*                                          #YL026UK*/ 01916000
*                /* FREE UGPOOL AREA                         #YL026UK*/ 01917000
*                /*                                          #YL026UK*/ 01918000
*                /****************************************************/ 01919000
*                                                                  0624 01920000
*                RESPECIFY (REG0,REG1) RSTD;               /*#YL026UK*/ 01921000
@RF00616 DS    0H                                                  0625 01922000
*                REG1 = TEMPPTR;                           /*#YL026UK*/ 01923000
         L     @15,TEMPPTR                                         0625 01924000
         LR    REG1,@15                                            0625 01925000
*                REG0 = GPLEN;                             /*#YL026UK*/ 01926000
         L     REG0,GPLEN(,@15)                                    0626 01927000
*                TEMPPTR = GPFORWRD;                       /*#YL026UK*/ 01928000
*                                                                  0627 01929000
         L     @15,GPFORWRD(,@15)                                  0627 01930000
         ST    @15,TEMPPTR                                         0627 01931000
*                /****************************************************/ 01932000
*                /*                                          @YL026UK*/ 01933000
*                /* ISSUE FREEMAIN MACRO TO FREE CORE        @YL026UK*/ 01934000
*                /*                                          @YL026UK*/ 01935000
*                /****************************************************/ 01936000
*                                                                  0628 01937000
*LFREM10:        GEN(FREEMAIN R,LV=(REG0),A=(REG1));       /*@YL026UK*/ 01938000
LFREM10  FREEMAIN R,LV=(REG0),A=(REG1)                                  01939000
*                RESPECIFY (REG0,REG1) UNRSTD;             /*@YL026UK*/ 01940000
*              END;                                        /*@YL026UK*/ 01941000
*            ELSE                                                  0631 01942000
*              DO;                                         /*@YL026UK*/ 01943000
*                                                                  0631 01944000
         B     @RC00604                                            0631 01945000
@RF00604 DS    0H                                                  0632 01946000
*                /****************************************************/ 01947000
*                /*                                          @YL026UK*/ 01948000
*                /* CHECK IF UGPOOL AREA EXAMINED IS THE LAST AREA   */ 01949000
*                /* IN THE UGPOOL CHAIN                      @YL026UK*/ 01950000
*                /*                                          @YL026UK*/ 01951000
*                /****************************************************/ 01952000
*                                                                  0632 01953000
*                IF GPLAST = TEMPPTR                               0632 01954000
*                  THEN                                            0632 01955000
*                                                                  0632 01956000
         L     @01,GDTSAH(,GDTPR)                                  0632 01957000
         CLC   GPLAST(4,@01),TEMPPTR                               0632 01958000
         BNE   @RF00632                                            0632 01959000
*                    /************************************************/ 01960000
*                    /*                                      @YL026UK*/ 01961000
*                    /* SET DOCNTRL TO FALL OUT OF DO WHILE LOOP     */ 01962000
*                    /*                                      @YL026UK*/ 01963000
*                    /************************************************/ 01964000
*                                                                  0633 01965000
*                    DOCNTRL = OFF;                        /*@YL026UK*/ 01966000
         NI    DOCNTRL,B'01111111'                                 0633 01967000
*                  ELSE                                            0634 01968000
*                                                                  0634 01969000
*                    /************************************************/ 01970000
*                    /*                                      @YL026UK*/ 01971000
*                    /* UPDATE UGPOOL AREA SCAN POINTER FOR NEXT     */ 01972000
*                    /* ITERATION                            @YL026UK*/ 01973000
*                    /*                                      @YL026UK*/ 01974000
*                    /************************************************/ 01975000
*                                                                  0634 01976000
*                    TEMPPTR = GPFORWRD;                   /*@YL026UK*/ 01977000
         B     @RC00632                                            0634 01978000
@RF00632 L     @01,TEMPPTR                                         0634 01979000
         L     @15,GPFORWRD(,@01)                                  0634 01980000
         ST    @15,TEMPPTR                                         0634 01981000
*              END;                                        /*@YL026UK*/ 01982000
@RC00632 DS    0H                                                  0636 01983000
*        END FPDO;                                         /*@YL026UK*/ 01984000
*                                                                  0636 01985000
@RC00604 DS    0H                                                  0636 01986000
@DE00603 TM    DOCNTRL,B'10000000'                                 0636 01987000
         BO    @DL00603                                            0636 01988000
*        /************************************************************/ 01989000
*        /*                                                  @YL026UK*/ 01990000
*        /* RETURN TO THE UFPOOL CALLER                      @YL026UK*/ 01991000
*        /*                                                  @YL026UK*/ 01992000
*        /************************************************************/ 01993000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0637 01994000
         ST    GDTPR,@AL00001                                      0637 01995000
         LA    @15,MODID                                           0637 01996000
         ST    @15,@AL00001+4                                      0637 01997000
         MVI   @AL00001+4,X'80'                                    0637 01998000
         L     @15,GDTEPL(,GDTPR)                                  0637 01999000
         LA    @01,@AL00001                                        0637 02000000
         BALR  @14,@15                                             0637 02001000
*         /*@YL026UK*/                                             0638 02002000
*        /************************************************************/ 02003000
*        /************************************************************/ 02004000
*        /*                                                  @YL026UK*/ 02005000
*        /* UTIME ENTRY POINT                                @YL026UK*/ 02006000
*        /*                                                  @YL026UK*/ 02007000
*        /************************************************************/ 02008000
*        /************************************************************/ 02009000
*                                                                  0638 02010000
*AMSSATI:  ENTRY(GDTTBLX,TITIMEX,TIDATEX,TIFORMX);         /*@YL026UK*/ 02011000
*                                                                  0638 02012000
@EC00638 DS    0H                                                  0639 02013000
*AMSSATI1:                                                         0639 02014000
*                                                                  0639 02015000
*        DCL TIDATE CHAR(8) BASED;     /* DATE FOR UTIME     @YL026UK*/ 02016000
*                                                                  0639 02017000
AMSSATI1 DS    0H                                                  0640 02018000
*        DCL TITIME CHAR(8) BASED;     /* TIME FOR UTIME     @YL026UK*/ 02019000
*                                                                  0640 02020000
*        DCL TIFORM CHAR(4) BASED;     /* FORMAT FOR UTIME   @YL026UK*/ 02021000
*                                                                  0641 02022000
*        RESPECIFY TIDATE BASED(PARMPTR3);                 /*@YL026UK*/ 02023000
*                                      /* BASE TIDATE        @YL026UK*/ 02024000
*                                                                  0643 02025000
*        RESPECIFY TITIME BASED(PARMPTR2);                 /*@YL026UK*/ 02026000
*                                      /* BASE TITIME        @YL026UK*/ 02027000
*                                                                  0644 02028000
*        RESPECIFY TIFORM BASED(PARMPTR4);                 /*@YL026UK*/ 02029000
*                                      /* BASE TIFORM        @YL026UK*/ 02030000
*                                                                  0645 02031000
*        /* DATE AND TIME OF DAY ENTRY NAME                  @YL026UK*/ 02032000
*        DCL IDCSA05 ENTRY;                                /*@YL026UK*/ 02033000
*                                                                  0645 02034000
*        /************************************************************/ 02035000
*        /*                                                  @YL026UK*/ 02036000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 02037000
*        /*                                                  @YL026UK*/ 02038000
*        /************************************************************/ 02039000
*                                                                  0646 02040000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 02041000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 02042000
         L     GDTPR,ADDR1(,REG1PTR)                               0647 02043000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 02044000
         L     @00,ADDR2+4(,REG1PTR)                               0648 02045000
         ST    @00,PARMPTR2                                        0648 02046000
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/ 02047000
         L     @00,ADDR3+8(,REG1PTR)                               0649 02048000
         ST    @00,PARMPTR3                                        0649 02049000
*        PARMPTR4 = ADDR4;                                 /*@YL026UK*/ 02050000
         L     @00,ADDR4+12(,REG1PTR)                              0650 02051000
         ST    @00,PARMPTR4                                        0650 02052000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 02053000
*                                                                  0651 02054000
*                                                                  0651 02055000
*                                                                  0652 02056000
*        /************************************************************/ 02057000
*        /*                                                          */ 02058000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 02059000
*        /*                                                          */ 02060000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 02061000
*        /*              TO THIS ROUTINE                             */ 02062000
*        /*                                                          */ 02063000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 02064000
*        /*               ADDRESS LIST                               */ 02065000
*        /*                                                          */ 02066000
*        /************************************************************/ 02067000
*                                                                  0652 02068000
*        GEN;                                                      0652 02069000
        ST    1,LISTPTR                                                 02070000
        ST    1,LISTSCAN                                                02071000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0653 02072000
         LA    @15,1                                               0653 02073000
         STC   @15,LISTLN                                          0653 02074000
@DL00653 L     @14,LISTSCAN                                        0653 02075000
         TM    LISTTEST(@14),B'10000000'                           0653 02076000
         BNZ   @DC00653                                            0653 02077000
*          LISTSCAN = LISTSCAN + 4;                                0654 02078000
         AL    @14,@CF00038                                        0654 02079000
         ST    @14,LISTSCAN                                        0654 02080000
*        END;                                                      0655 02081000
*                                                                  0655 02082000
         AL    @15,@CF00215                                        0655 02083000
         STC   @15,LISTLN                                          0655 02084000
         C     @15,@CF01724                                        0655 02085000
         BNH   @DL00653                                            0655 02086000
@DC00653 DS    0H                                                  0656 02087000
*        OLDERID2 = NEWERID2;                                      0656 02088000
         L     @15,GDTTR2(,GDTPR)                                  0656 02089000
         MVC   @TS00001(95),NEWERID2(@15)                          0656 02090000
         MVC   OLDERID2(95,@15),@TS00001                           0656 02091000
*        NEWID2 = 'SATI';                                  /*@YL026UK*/ 02092000
*                                                                  0657 02093000
         MVC   NEWID2(4,@15),@CC01832                              0657 02094000
*        /************************************************************/ 02095000
*        /*                                                  @YL026UK*/ 02096000
*        /* CALL THE UTIME MODULE IDCSA05                    @YL026UK*/ 02097000
*        /*                                                  @YL026UK*/ 02098000
*        /************************************************************/ 02099000
*                                                                  0658 02100000
*        CALL IDCSA05(GDTTBL,TITIME,TIDATE,TIFORM,LISTLN); /*@YL026UK*/ 02101000
*                                                                  0658 02102000
         ST    GDTPR,@AL00001                                      0658 02103000
         L     @01,PARMPTR2                                        0658 02104000
         ST    @01,@AL00001+4                                      0658 02105000
         L     @01,PARMPTR3                                        0658 02106000
         ST    @01,@AL00001+8                                      0658 02107000
         L     @01,PARMPTR4                                        0658 02108000
         ST    @01,@AL00001+12                                     0658 02109000
         LA    @15,LISTLN                                          0658 02110000
         ST    @15,@AL00001+16                                     0658 02111000
         L     @15,@CV01831                                        0658 02112000
         LA    @01,@AL00001                                        0658 02113000
         BALR  @14,@15                                             0658 02114000
*        /************************************************************/ 02115000
*        /*                                                  @YL026UK*/ 02116000
*        /* RETURN TO THE UTIME CALLER                       @YL026UK*/ 02117000
*        /*                                                  @YL026UK*/ 02118000
*        /************************************************************/ 02119000
*                                                                  0659 02120000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0659 02121000
         ST    GDTPR,@AL00001                                      0659 02122000
         LA    @15,MODID                                           0659 02123000
         ST    @15,@AL00001+4                                      0659 02124000
         MVI   @AL00001+4,X'80'                                    0659 02125000
         L     @15,GDTEPL(,GDTPR)                                  0659 02126000
         LA    @01,@AL00001                                        0659 02127000
         BALR  @14,@15                                             0659 02128000
*         /*@YL026UK*/                                             0660 02129000
*        /************************************************************/ 02130000
*        /************************************************************/ 02131000
*        /*                                                  @YL026UK*/ 02132000
*        /* UCATLG ENTRY POINT                               @YL026UK*/ 02133000
*        /*                                                  @YL026UK*/ 02134000
*        /************************************************************/ 02135000
*        /************************************************************/ 02136000
*                                                                  0660 02137000
*AMSSACA:  ENTRY(GDTTBLX,CPLPTRX);                         /*@YL026UK*/ 02138000
*                                                                  0660 02139000
@EC00660 DS    0H                                                  0661 02140000
*AMSSACA1:                                                         0661 02141000
*                                                                  0661 02142000
*        DCL CPLPTR PTR(31) BASED;     /* CATALOG PARAMETER LIST PTR */ 02143000
*                                                                  0661 02144000
AMSSACA1 DS    0H                                                  0662 02145000
*        RESPECIFY CPLPTR BASED(PARMPTR2);                 /*@YL026UK*/ 02146000
*                                      /* BASE CPLPTR        @YL026UK*/ 02147000
*                                                                  0663 02148000
*        /************************************************************/ 02149000
*        /*                                                  @YL026UK*/ 02150000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 02151000
*        /*                                                  @YL026UK*/ 02152000
*        /************************************************************/ 02153000
*                                                                  0663 02154000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 02155000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 02156000
         L     GDTPR,ADDR1(,REG1PTR)                               0664 02157000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 02158000
         L     @00,ADDR2+4(,REG1PTR)                               0665 02159000
         ST    @00,PARMPTR2                                        0665 02160000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 02161000
*                                                                  0666 02162000
*        OLDERID2 = NEWERID2;                                      0667 02163000
         L     @15,GDTTR2(,GDTPR)                                  0667 02164000
         MVC   @TS00001(95),NEWERID2(@15)                          0667 02165000
         MVC   OLDERID2(95,@15),@TS00001                           0667 02166000
*        NEWID2 = 'SACA';                                  /*@YL026UK*/ 02167000
         MVC   NEWID2(4,@15),@CC01844                              0668 02168000
*        IF GDTDBG = NULLPTR                                       0669 02169000
*          THEN;                                                   0669 02170000
         L     @15,GDTDBG(,GDTPR)                                  0669 02171000
         LTR   @15,@15                                             0669 02172000
         BZ    @RT00669                                            0669 02173000
*          ELSE                                                    0671 02174000
*            CALL IDCDB010(GDTTBL,'ZZCA');                         0671 02175000
         ST    GDTPR,@AL00001                                      0671 02176000
         LA    @15,@CC01845                                        0671 02177000
         ST    @15,@AL00001+4                                      0671 02178000
         MVI   @AL00001+4,X'80'                                    0671 02179000
         L     @15,GDTDBG(,GDTPR)                                  0671 02180000
         LA    @01,@AL00001                                        0671 02181000
         BALR  @14,@15                                             0671 02182000
*                                                          /*@YL026UK*/ 02183000
*        RESPECIFY (REG1) RSTD;                            /*@YL026UK*/ 02184000
@RT00669 DS    0H                                                  0673 02185000
*        REG1 = CPLPTR;                                    /*@YL026UK*/ 02186000
*                                                                  0673 02187000
         L     @15,PARMPTR2                                        0673 02188000
         L     REG1,CPLPTR(,@15)                                   0673 02189000
*        /************************************************************/ 02190000
*        /*                                                  @YL026UK*/ 02191000
*        /* ISSUE CATLG MACRO                                @YL026UK*/ 02192000
*        /*                                                  @YL026UK*/ 02193000
*        /************************************************************/ 02194000
*                                                                  0674 02195000
*LCATLG1:GEN(CATLG MF=(E,(REG1)));                         /*@YL026UK*/ 02196000
LCATLG1  CATLG MF=(E,(REG1))                                            02197000
*        RESPECIFY (RTNREG) RSTD;                          /*@YL026UK*/ 02198000
*        RESPECIFY RTNREG RSTD;                                    0676 02199000
*        TESTRC = RTNREG;                                          0677 02200000
         STH   RTNREG,TESTRC                                       0677 02201000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UK*/ 02202000
*        RESPECIFY (RTNREG) UNRSTD;                        /*@YL026UK*/ 02203000
*        IF GDTDBG = NULLPTR                                       0680 02204000
*          THEN;                                                   0680 02205000
         L     @00,GDTDBG(,GDTPR)                                  0680 02206000
         LTR   @00,@00                                             0680 02207000
         BZ    @RT00680                                            0680 02208000
*          ELSE                                                    0682 02209000
*            CALL IDCDB010(GDTTBL,'ZZCA');                         0682 02210000
         ST    GDTPR,@AL00001                                      0682 02211000
         LA    @00,@CC01845                                        0682 02212000
         ST    @00,@AL00001+4                                      0682 02213000
         MVI   @AL00001+4,X'80'                                    0682 02214000
         L     @15,GDTDBG(,GDTPR)                                  0682 02215000
         LA    @01,@AL00001                                        0682 02216000
         BALR  @14,@15                                             0682 02217000
*                                                          /*@YL026UK*/ 02218000
*        RESPECIFY (REG1) UNRSTD;                          /*@YL026UK*/ 02219000
*                                                                  0683 02220000
@RT00680 DS    0H                                                  0684 02221000
*        /************************************************************/ 02222000
*        /*                                                  @YL026UK*/ 02223000
*        /* RETURN TO THE UCATLG CALLER                      @YL026UK*/ 02224000
*        /*                                                  @YL026UK*/ 02225000
*        /************************************************************/ 02226000
*                                                                  0684 02227000
*        CALL IDCSAEP0(GDTTBL,MODID,TESTRC);                       0684 02228000
         ST    GDTPR,@AL00001                                      0684 02229000
         LA    @15,MODID                                           0684 02230000
         ST    @15,@AL00001+4                                      0684 02231000
         LA    @15,TESTRC                                          0684 02232000
         ST    @15,@AL00001+8                                      0684 02233000
         MVI   @AL00001+8,X'80'                                    0684 02234000
         L     @15,GDTEPL(,GDTPR)                                  0684 02235000
         LA    @01,@AL00001                                        0684 02236000
         BALR  @14,@15                                             0684 02237000
*        /*@YL026UK*/                                              0685 02238000
*        /************************************************************/ 02239000
*        /************************************************************/ 02240000
*        /*                                                  @YL026UK*/ 02241000
*        /* USNAP ENTRY POINT                                @YL026UK*/ 02242000
*        /*                                                  @YL026UK*/ 02243000
*        /************************************************************/ 02244000
*        /************************************************************/ 02245000
*                                                                  0685 02246000
*AMSSASN:  ENTRY(GDTTBLX,SNAPIDX);                         /*@YL026UK*/ 02247000
*                                                                  0685 02248000
@EC00685 DS    0H                                                  0686 02249000
*AMSSASN1:                                                         0686 02250000
*                                                                  0686 02251000
*        DCL SNAPID FIXED(15) BASED;   /* SNAP IDENTIFIER    @YL026UK*/ 02252000
*                                                                  0686 02253000
AMSSASN1 DS    0H                                                  0687 02254000
*        RESPECIFY SNAPID BASED(PARMPTR2);                 /*@YL026UK*/ 02255000
*                                      /* BASE SNAPID        @YL026UK*/ 02256000
*                                                                  0688 02257000
*        /* OPEN MACRO LIST                                  @YL026UK*/ 02258000
*        DCL 1 OPENLIST CHAR(4) BDY(WORD),                         0688 02259000
*              2 OPENOPT CHAR(1),      /* OPEN OPTIONS       @YL026UK*/ 02260000
*              2 OPENADDR PTR(24);     /* DCB ADDRESS        @YL026UK*/ 02261000
*                                                                  0688 02262000
*        /* SNAP MACRO LIST                                  @YL026UK*/ 02263000
*        DCL 1 SNAPLIST CHAR(20) BDY(WORD),                        0689 02264000
*              2 SNAPIDEN FIXED(8),    /* SNAP ID            @YL026UK*/ 02265000
*              2 SNAPOPT CHAR(7),      /* SNAP OPTIONS       @YL026UK*/ 02266000
*              2 SNAPPTR PTR(31),      /* SNAP DCB ADDRESS   @YL026UK*/ 02267000
*              2 SNAPTCB PTR(31),      /* SNAP TCB ADDRESS   @YL026UK*/ 02268000
*              2 SNAPLST PTR(31);      /* SNAP-SHOT LIST ADDR        */ 02269000
*                                                                  0689 02270000
*        DCL DUMPDCB CHAR(90) BDY(WORD);                   /*@YL026UK*/ 02271000
*                                      /* FULL REGION (SNAP) DUMP DCB*/ 02272000
*                                                                  0691 02273000
*        /* DCB ADDRESS FOR CLOSING                          @YL026UK*/ 02274000
*        DCL 1 SADCBACB PTR(31) BDY(WORD),                         0691 02275000
*              2 BLOCKFLG BIT(1);      /* CONTROL BLOCK ADDRESS FLAG */ 02276000
*                                                                  0691 02277000
*        DCL LIST3 GENERATED LABEL;    /* OPEN MACRO LIST LABEL      */ 02278000
*                                                                  0692 02279000
*        DCL LIST4 GENERATED LABEL;    /* SNAP MACRO LIST LABEL      */ 02280000
*                                                                  0693 02281000
*        DCL SNAPDCB GENERATED LABEL;  /* SNAP DCB LABEL     @YL026UK*/ 02282000
*                                                                  0694 02283000
*        DCL OPENGEN CHAR(4) DEFINED(LIST3);               /*@YL026UK*/ 02284000
*                                      /* GENERATED LIST FORM OF     */ 02285000
*                                      /* OPEN               @YL026UK*/ 02286000
*                                                                  0696 02287000
*        DCL SNAPGEN CHAR(20) DEFINED(LIST4);              /*@YL026UK*/ 02288000
*                                      /* GENERATED LIST FORM OF SNAP*/ 02289000
*                                                                  0697 02290000
*        DCL DCBFORM CHAR(90) DEFINED(SNAPDCB);            /*@YL026UK*/ 02291000
*                                      /* GENERATED SNAP DCB @YL026UK*/ 02292000
*                                                                  0698 02293000
*        DCL BADSNAP FIXED(31) CONSTANT(44);               /*@YL026UK*/ 02294000
*                                      /* UABORT MESSAGE FOR @YL026UK*/ 02295000
*                                      /* UNSUCCESSFUL SNAP  @YL026UK*/ 02296000
*                                                                  0699 02297000
*        /************************************************************/ 02298000
*        /*                                                  @YL026UK*/ 02299000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 02300000
*        /*                                                  @YL026UK*/ 02301000
*        /************************************************************/ 02302000
*                                                                  0699 02303000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 02304000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 02305000
         L     GDTPR,ADDR1(,REG1PTR)                               0700 02306000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 02307000
         L     @00,ADDR2+4(,REG1PTR)                               0701 02308000
         ST    @00,PARMPTR2                                        0701 02309000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 02310000
*                                                                  0702 02311000
*        OLDERID2 = NEWERID2;                                      0703 02312000
         L     @15,GDTTR2(,GDTPR)                                  0703 02313000
         MVC   @TS00001(95),NEWERID2(@15)                          0703 02314000
         MVC   OLDERID2(95,@15),@TS00001                           0703 02315000
*        NEWID2 = 'SASN';                                  /*@YL026UK*/ 02316000
*                                                                  0704 02317000
         MVC   NEWID2(4,@15),@CC01879                              0704 02318000
*        /************************************************************/ 02319000
*        /*                                                  @YL026UK*/ 02320000
*        /* MOVE DCB AND OPEN LISTS INTO DYNAMIC STORAGE AND OPEN    */ 02321000
*        /* THE SNAP DCB FOR PROCESSING                      @YL026UK*/ 02322000
*        /*                                                  @YL026UK*/ 02323000
*        /************************************************************/ 02324000
*                                                                  0705 02325000
*        DUMPDCB = DCBFORM;                                /*@YL026UK*/ 02326000
         MVC   DUMPDCB(90),DCBFORM                                 0705 02327000
*        OPENLIST = OPENGEN;                               /*@YL026UK*/ 02328000
         MVC   OPENLIST(4),OPENGEN                                 0706 02329000
*        OPENADDR = ADDR(DUMPDCB);                         /*@YL026UK*/ 02330000
         LA    @15,DUMPDCB                                         0707 02331000
         STCM  @15,7,OPENADDR                                      0707 02332000
*        RESPECIFY (REG1) RSTD;                            /*@YL026UK*/ 02333000
*        REG1 = ADDR(OPENLIST);                            /*@YL026UK*/ 02334000
         LA    REG1,OPENLIST                                       0709 02335000
*LOPEN2: GEN(OPEN  MF=(E,(REG1)));                         /*@YL026UK*/ 02336000
LOPEN2   OPEN  MF=(E,(REG1))                                            02337000
*        RESPECIFY (REG1) UNRSTD;                          /*@YL026UK*/ 02338000
*                                                                  0711 02339000
*        /************************************************************/ 02340000
*        /*                                                  @YL026UK*/ 02341000
*        /* MOVE SNAP MACRO LIST INTO DYNAMIC STORAGE AND ISSUE THE  */ 02342000
*        /* SNAP MACRO FOR A FULL REGION DUMP                @YL026UK*/ 02343000
*        /*                                                  @YL026UK*/ 02344000
*        /************************************************************/ 02345000
*                                                                  0712 02346000
*        SNAPLIST = SNAPGEN;                               /*@YL026UK*/ 02347000
         MVC   SNAPLIST(20),SNAPGEN                                0712 02348000
*        SNAPPTR = ADDR(DUMPDCB);                          /*@YL026UK*/ 02349000
         LA    @15,DUMPDCB                                         0713 02350000
         ST    @15,SNAPPTR                                         0713 02351000
*        SNAPIDEN = SNAPID;                                /*@YL026UK*/ 02352000
         L     @01,PARMPTR2                                        0714 02353000
         LH    @15,SNAPID(,@01)                                    0714 02354000
         STC   @15,SNAPIDEN                                        0714 02355000
*        RESPECIFY (REG1) RSTD;                            /*@YL026UK*/ 02356000
*        REG1 = ADDR(SNAPLIST);                            /*@YL026UK*/ 02357000
         LA    REG1,SNAPLIST                                       0716 02358000
*LSNAP2: GEN(SNAP  MF=(E,(REG1)));                         /*@YL026UK*/ 02359000
LSNAP2   SNAP  MF=(E,(REG1))                                            02360000
*        RESPECIFY (REG15) RSTD;                           /*@YL026UK*/ 02361000
*        RESPECIFY RTNREG RSTD;                                    0719 02362000
*        TESTRC = RTNREG;                                          0720 02363000
         STH   RTNREG,TESTRC                                       0720 02364000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UK*/ 02365000
*        RESPECIFY (REG15) UNRSTD;                         /*@YL026UK*/ 02366000
*                                                                  0722 02367000
*        /************************************************************/ 02368000
*        /*                                                  @YL026UK*/ 02369000
*        /* CLOSE THE SNAP DCB                               @YL026UK*/ 02370000
*        /*                                                  @YL026UK*/ 02371000
*        /************************************************************/ 02372000
*                                                                  0723 02373000
*        SADCBACB = ADDR(DUMPDCB);                         /*@YL026UK*/ 02374000
         LA    @00,DUMPDCB                                         0723 02375000
         ST    @00,SADCBACB                                        0723 02376000
*        BLOCKFLG = ON;                                    /*@YL026UK*/ 02377000
         OI    BLOCKFLG,B'10000000'                                0724 02378000
*        REG1 = ADDR(SADCBACB);                            /*@YL026UK*/ 02379000
         LA    REG1,SADCBACB                                       0725 02380000
*LCLOSE3:GEN(CLOSE MF=(E,(REG1)));                         /*@YL026UK*/ 02381000
LCLOSE3  CLOSE MF=(E,(REG1))                                            02382000
*        RESPECIFY (REG1) UNRSTD;                          /*@YL026UK*/ 02383000
*                                                                  0727 02384000
*        /************************************************************/ 02385000
*        /*                                                  @YL026UK*/ 02386000
*        /* CHECK RETURN CODE FROM SNAP MACRO AND ABORT IF IT IS BAD */ 02387000
*        /*                                                  @YL026UK*/ 02388000
*        /************************************************************/ 02389000
*                                                                  0728 02390000
*        IF TESTRC ^= 0                                            0728 02391000
*          THEN                                                    0728 02392000
*                                                                  0728 02393000
         LH    @15,TESTRC                                          0728 02394000
         LTR   @15,@15                                             0728 02395000
         BZ    @RF00728                                            0728 02396000
*            DO;                                                   0729 02397000
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0730 02398000
*              REG15 = BADSNAP;                                    0731 02399000
         LA    REG15,44                                            0731 02400000
*              REG14 = GDTABT;                                     0732 02401000
         L     REG14,GDTABT(,GDTPR)                                0732 02402000
*              REG13 = GDTABH;                                     0733 02403000
         L     REG13,GDTABH(,GDTPR)                                0733 02404000
*              GEN(BR    REG14);                                   0734 02405000
         BR    REG14                                                    02406000
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0735 02407000
*            END;                              /*@YL026UK*/        0736 02408000
*                                                                  0736 02409000
*        /************************************************************/ 02410000
*        /*                                                  @YL026UK*/ 02411000
*        /* RETURN TO THE USNAP CALLER                       @YL026UK*/ 02412000
*        /*                                                  @YL026UK*/ 02413000
*        /************************************************************/ 02414000
*                                                                  0737 02415000
*        CALL IDCSAEP0(GDTTBL,MODID);                              0737 02416000
@RF00728 ST    GDTPR,@AL00001                                      0737 02417000
         LA    @15,MODID                                           0737 02418000
         ST    @15,@AL00001+4                                      0737 02419000
         MVI   @AL00001+4,X'80'                                    0737 02420000
         L     @15,GDTEPL(,GDTPR)                                  0737 02421000
         LA    @01,@AL00001                                        0737 02422000
         BALR  @14,@15                                             0737 02423000
*         /*@YL026UK*/                                             0738 02424000
*        /************************************************************/ 02425000
*        /************************************************************/ 02426000
*        /*                                                  @YL026UK*/ 02427000
*        /* UPROMPT ENTRY POINT                              @YL026UK*/ 02428000
*        /*                                                  @YL026UK*/ 02429000
*        /************************************************************/ 02430000
*        /************************************************************/ 02431000
*                                                                  0738 02432000
*AMSSAPT:  ENTRY(GDTTBLX,PTTEXTPX,PTTEXTLX,PTREPLPX,               0738 02433000
*                PTREPLLX);                                /*@YL026UK*/ 02434000
*                                                                  0738 02435000
@EC00738 DS    0H                                                  0739 02436000
*AMSSAPT1:                                                         0739 02437000
*                                                                  0739 02438000
*        DCL PTTEXTP PTR(31) BASED;    /* TEXT POINTER       @YL026UK*/ 02439000
*                                                                  0739 02440000
AMSSAPT1 DS    0H                                                  0740 02441000
*        DCL PTTEXTL FIXED(15) BASED;  /* TEXT LENGTH        @YL026UK*/ 02442000
*                                                                  0740 02443000
*        DCL PTREPLP PTR(31) BASED;    /* REPLY POINTER      @YL026UK*/ 02444000
*                                                                  0741 02445000
*        DCL PTREPLL FIXED(15) BASED;  /* REPLY LENGTH       @YL026UK*/ 02446000
*                                                                  0742 02447000
*        RESPECIFY PTTEXTP BASED(PARMPTR2);                /*@YL026UK*/ 02448000
*                                      /* BASE TEXT POINTER  @YL026UK*/ 02449000
*                                                                  0744 02450000
*        RESPECIFY PTTEXTL BASED(PARMPTR3);                /*@YL026UK*/ 02451000
*                                      /* BASE TEXT LENGTH   @YL026UK*/ 02452000
*                                                                  0745 02453000
*        RESPECIFY PTREPLP BASED(PARMPTR4);                /*@YL026UK*/ 02454000
*                                      /* BASE REPLY POINTER @YL026UK*/ 02455000
*                                                                  0746 02456000
*        RESPECIFY PTREPLL BASED(PARMPTR5);                /*@YL026UK*/ 02457000
*                                      /* BASE REPLY LENGTH  @YL026UK*/ 02458000
*                                                                  0747 02459000
*        DCL INVMSG FIXED(31) CONSTANT(48);                /*@YL026UK*/ 02460000
*                                      /* UABORT CODE FOR    @YL026UK*/ 02461000
*                                      /* INVALID LENGTH     @YL026UK*/ 02462000
*                                      /* UPROMPT MESSAGE    @YL026UK*/ 02463000
*                                                                  0748 02464000
*        /* PUTGET LINE BUFFER                               @YL026UK*/ 02465000
*        DCL 1 PGLB CHAR(76) BDY(WORD),                            0748 02466000
*              2 PGLNG FIXED(15),      /* LENGTH VALUE       @YL026UK*/ 02467000
*              2 PGOFF FIXED(15),      /* OFFSET VALUE       @YL026UK*/ 02468000
*              2 PGLINE CHAR(72);      /* TEXT LINE          @YL026UK*/ 02469000
*                                                                  0748 02470000
*        /* UPROMPT MESSAGE TEXT                             @YL026UK*/ 02471000
*        DCL UPMSG CHAR(72) BASED(PTTEXTP);                /*@YL026UK*/ 02472000
*                                                                  0749 02473000
*        /* PUTGET PARAMETER BLOCK                           @YL026UK*/ 02474000
*        DCL 1 PUTGETPB CHAR(16) BDY(WORD),                        0750 02475000
*              2 PGFLG1 CHAR(4),       /* FLAGS              @YL026UK*/ 02476000
*              2 PGOLD PTR(31),        /* ADDRESS OF OUTPUT  @YL026UK*/ 02477000
*                                      /* LINE DESCRIPTOR    @YL026UK*/ 02478000
*              2 PGFLG2 CHAR(4),       /* FLAGS              @YL026UK*/ 02479000
*              2 PGINBUF PTR(31);      /* ADDR OF INPUT      @YL026UK*/ 02480000
*                                      /* BUFFER             @YL026UK*/ 02481000
*                                                                  0751 02482000
*        DCL LIST5 GENERATED LABEL;    /* PUTGET MACRO LIST  @YL026UK*/ 02483000
*                                      /* LABEL              @YL026UK*/ 02484000
*                                                                  0752 02485000
*        /* GENERATED LIST FORM OF PUTGET MACRO              @YL026UK*/ 02486000
*        DCL PGLIST CHAR(16) DEFINED(LIST5);               /*@YL026UK*/ 02487000
*                                                                  0752 02488000
*        /* TSO INPUT OUTPUT PARAMETER LIST                  @YL026UK*/ 02489000
*        DCL 1 TSOIOPL CHAR(16) BDY(WORD),                         0753 02490000
*              2 TSOUPT PTR(31),       /* ADDR OF USER       @YL026UK*/ 02491000
*                                      /* PROFILE TABLE      @YL026UK*/ 02492000
*              2 TSOECT PTR(31),       /* ADDR OF ENVIRON-   @YL026UK*/ 02493000
*                                      /* MENT CONTROL TBL   @YL026UK*/ 02494000
*              2 TSOECB PTR(31),       /* ADDR OF EVENT      @YL026UK*/ 02495000
*                                      /* CONTROL BLOCK      @YL026UK*/ 02496000
*              2 TSOPGPB PTR(31);      /* ADDR OF PUTGET     @YL026UK*/ 02497000
*                                      /* PARAMETER BLOCK    @YL026UK*/ 02498000
*                                                                  0754 02499000
*        /* TSO COMMAND PROCESSOR EVENT CONTROL BLOCK        @YL026UK*/ 02500000
*        DCL CPECB FIXED(31);                              /*@YL026UK*/ 02501000
*                                                                  0754 02502000
*        /* LENGTH OF REPLY TEXT INCLUDING HEADER WORD       @YL026UK*/ 02503000
*        DCL INBUFLN FIXED(15) BASED(PGINBUF);             /*@YL026UK*/ 02504000
*                                                                  0755 02505000
*        /* TSO OUTPUT LINE DESCRIPTOR                       @YL026UK*/ 02506000
*        DCL 1 TSOOLD CHAR(8) BDY(WORD),                           0756 02507000
*              2 TSOSEGNO FIXED(31),   /* NUMBER OF SEGMENTS @YL026UK*/ 02508000
*              2 TSOSEGAD PTR(31);     /* ADDR OF SEGMENT    @YL026UK*/ 02509000
*                                                                  0756 02510000
*        /* STID NUMBER FOR PUTGET ERROR CODE                @YL026UK*/ 02511000
*        DCL PGSTID FIXED(8) CONSTANT(12);                 /*@YL026UK*/ 02512000
*                                                                  0757 02513000
*        /* PUTGET PROFILE NOPROMPT RETURN CODE              @Y30SSMK*/ 02514000
*        DCL PGNOPRC FIXED(8) CONSTANT(12);                /*@Y30SSMK*/ 02515000
*                                                                  0758 02516000
*        /* UPROMPT PROFILE NOPROMPT RETURN CODE             @Y30SSMK*/ 02517000
*        DCL UPNOPRC FIXED(8) CONSTANT(8);                 /*@Y30SSMK*/ 02518000
*                                                                  0759 02519000
*        /************************************************************/ 02520000
*        /*                                                  #YL026UK*/ 02521000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/ 02522000
*        /*                                                  #YL026UK*/ 02523000
*        /************************************************************/ 02524000
*                                                                  0760 02525000
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/ 02526000
*        GDTPR = ADDR1;                                    /*#YL026UK*/ 02527000
         L     GDTPR,ADDR1(,REG1PTR)                               0761 02528000
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/ 02529000
         L     @00,ADDR2+4(,REG1PTR)                               0762 02530000
         ST    @00,PARMPTR2                                        0762 02531000
*        PARMPTR3 = ADDR3;                                 /*#YL026UK*/ 02532000
         L     @00,ADDR3+8(,REG1PTR)                               0763 02533000
         ST    @00,PARMPTR3                                        0763 02534000
*        PARMPTR4 = ADDR4;                                 /*#YL026UK*/ 02535000
         L     @00,ADDR4+12(,REG1PTR)                              0764 02536000
         ST    @00,PARMPTR4                                        0764 02537000
*        PARMPTR5 = ADDR5;                                 /*#YL026UK*/ 02538000
         L     @00,ADDR5+16(,REG1PTR)                              0765 02539000
         ST    @00,PARMPTR5                                        0765 02540000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/ 02541000
*                                                                  0766 02542000
*        OLDERID2 = NEWERID2;                                      0767 02543000
         L     @15,GDTTR2(,GDTPR)                                  0767 02544000
         MVC   @TS00001(95),NEWERID2(@15)                          0767 02545000
         MVC   OLDERID2(95,@15),@TS00001                           0767 02546000
*        NEWID2 = 'SAPT';                                  /*#YL026UK*/ 02547000
*                                                                  0768 02548000
         MVC   NEWID2(4,@15),@CC01938                              0768 02549000
*        /************************************************************/ 02550000
*        /*                                                  #YL026UK*/ 02551000
*        /* CHECK WHETHER OR NOT AMS WAS INVOKED VIA TSO BY  #YL026UK*/ 02552000
*        /* CHECKING WHETHER OR NOT THERE IS A TSO           #YL026UK*/ 02553000
*        /* ENVIRONMENT CONTROL TABLE                        #YL026UK*/ 02554000
*        /*                                                  #YL026UK*/ 02555000
*        /************************************************************/ 02556000
*                                                                  0769 02557000
*        IF GDTECT = 0                                             0769 02558000
*          THEN                                                    0769 02559000
*                                                                  0769 02560000
         L     @15,GDTECT(,GDTPR)                                  0769 02561000
         LTR   @15,@15                                             0769 02562000
         BNZ   @RF00769                                            0769 02563000
*            /********************************************************/ 02564000
*            /*                                              #YL026UK*/ 02565000
*            /* AMS WAS NOT INVOKED VIA TSO--CALL PROCEDURE  #YL026UK*/ 02566000
*            /* NOSUPP TO PRINT OUT ERROR MESSAGE, SET       #YL026UK*/ 02567000
*            /* RETURN CODE, AND RETURN TO CALLER            #YL026UK*/ 02568000
*            /*                                              #YL026UK*/ 02569000
*            /********************************************************/ 02570000
*                                                                  0770 02571000
*            DO;                                           /*#YL026UK*/ 02572000
*              CALL NOSUPP;                                /*#YL026UK*/ 02573000
         BAL   @14,NOSUPP                                          0771 02574000
*              SETRC = 4;                                  /*#YL026UK*/ 02575000
         MVC   SETRC(2),@CH00038                                   0772 02576000
*              CALL IDCSAEP0(GDTTBL,MODID,SETRC);                  0773 02577000
         ST    GDTPR,@AL00001                                      0773 02578000
         LA    @15,MODID                                           0773 02579000
         ST    @15,@AL00001+4                                      0773 02580000
         LA    @15,SETRC                                           0773 02581000
         ST    @15,@AL00001+8                                      0773 02582000
         MVI   @AL00001+8,X'80'                                    0773 02583000
         L     @15,GDTEPL(,GDTPR)                                  0773 02584000
         LA    @01,@AL00001                                        0773 02585000
         BALR  @14,@15                                             0773 02586000
*        /*#YL026UK*/                                              0774 02587000
*            END;                                          /*#YL026UK*/ 02588000
*                                                                  0774 02589000
*        /************************************************************/ 02590000
*        /*                                                  #YL026UK*/ 02591000
*        /* CHECK FOR AN INVALID LENGTH UPROMPT MESSAGE AND  #YL026UK*/ 02592000
*        /* UABORT IF LENGTH IS INVALID                      #YL026UK*/ 02593000
*        /*                                                  #YL026UK*/ 02594000
*        /************************************************************/ 02595000
*                                                                  0775 02596000
*        IF PTTEXTL < 1 | PTTEXTL > 72                             0775 02597000
*          THEN                                                    0775 02598000
*                                                                  0775 02599000
@RF00769 L     @01,PARMPTR3                                        0775 02600000
         LH    @15,PTTEXTL(,@01)                                   0775 02601000
         LTR   @15,@15                                             0775 02602000
         BNP   @RT00775                                            0775 02603000
         C     @15,@CF01916                                        0775 02604000
         BNH   @RF00775                                            0775 02605000
@RT00775 DS    0H                                                  0776 02606000
*            DO;                                                   0776 02607000
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0777 02608000
*              REG15 = INVMSG;                                     0778 02609000
         LA    REG15,48                                            0778 02610000
*              REG14 = GDTABT;                                     0779 02611000
         L     REG14,GDTABT(,GDTPR)                                0779 02612000
*              REG13 = GDTABH;                                     0780 02613000
         L     REG13,GDTABH(,GDTPR)                                0780 02614000
*              GEN(BR    REG14);                                   0781 02615000
         BR    REG14                                                    02616000
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0782 02617000
*            END;                               /*#YL026UK*/       0783 02618000
*                                                                  0783 02619000
*        /************************************************************/ 02620000
*        /*                                                  #YL026UK*/ 02621000
*        /* MOVE THE UPROMPT MESSAGE TEXT INTO THE PUTGET    #YL026UK*/ 02622000
*        /* LINE BUFFER AND INITIALIZE THE HEADER WORD OF    #YL026UK*/ 02623000
*        /* THIS BUFFER                                      #YL026UK*/ 02624000
*        /*                                                  #YL026UK*/ 02625000
*        /************************************************************/ 02626000
*                                                                  0784 02627000
*        PGLINE(1:PTTEXTL) = UPMSG(1:PTTEXTL);             /*#YL026UK*/ 02628000
@RF00775 L     @01,PARMPTR3                                        0784 02629000
         LH    @15,PTTEXTL(,@01)                                   0784 02630000
         LR    @14,@15                                             0784 02631000
         BCTR  @14,0                                               0784 02632000
         L     @01,PARMPTR2                                        0784 02633000
         L     @01,PTTEXTP(,@01)                                   0784 02634000
         EX    @14,@SM02462                                        0784 02635000
*        PGOFF = 0;                                        /*#YL026UK*/ 02636000
         SLR   @14,@14                                             0785 02637000
         STH   @14,PGOFF                                           0785 02638000
*        PGLNG = PTTEXTL + 4;                              /*#YL026UK*/ 02639000
*                                                                  0786 02640000
         LA    @15,4(,@15)                                         0786 02641000
         STH   @15,PGLNG                                           0786 02642000
*        /************************************************************/ 02643000
*        /*                                                  #YL026UK*/ 02644000
*        /* MOVE PUTGET MACRO LIST INTO DYNAMIC STORAGE      #YL026UK*/ 02645000
*        /*                                                  #YL026UK*/ 02646000
*        /************************************************************/ 02647000
*                                                                  0787 02648000
*        PUTGETPB = PGLIST;                                /*#YL026UK*/ 02649000
*                                                                  0787 02650000
         MVC   PUTGETPB(16),PGLIST                                 0787 02651000
*        /************************************************************/ 02652000
*        /*                                                  #YL026UK*/ 02653000
*        /* INITIALIZE THE EVENT CONTROL BLOCK TO ZERO AND   #YL026UK*/ 02654000
*        /* INITIALIZE THE TSO INPUT OUTPUT PARAMETER LIST   #YL026UK*/ 02655000
*        /*                                                  #YL026UK*/ 02656000
*        /************************************************************/ 02657000
*                                                                  0788 02658000
*        CPECB = 0;                                        /*#YL026UK*/ 02659000
         ST    @14,CPECB                                           0788 02660000
*        TSOUPT = GDTUPT;                                  /*#YL026UK*/ 02661000
         L     @15,GDTUPT(,GDTPR)                                  0789 02662000
         ST    @15,TSOUPT                                          0789 02663000
*        TSOECT = GDTECT;                                  /*#YL026UK*/ 02664000
         L     @15,GDTECT(,GDTPR)                                  0790 02665000
         ST    @15,TSOECT                                          0790 02666000
*        TSOECB = ADDR(CPECB);                             /*#YL026UK*/ 02667000
         LA    @15,CPECB                                           0791 02668000
         ST    @15,TSOECB                                          0791 02669000
*        TSOPGPB = ADDR(PUTGETPB);                         /*#YL026UK*/ 02670000
*                                                                  0792 02671000
         LA    @15,PUTGETPB                                        0792 02672000
         ST    @15,TSOPGPB                                         0792 02673000
*        /************************************************************/ 02674000
*        /*                                                  #YL026UK*/ 02675000
*        /* INITIALIZE THE TSO OUTPUT LINE DESCRIPTOR        #YL026UK*/ 02676000
*        /*                                                  #YL026UK*/ 02677000
*        /************************************************************/ 02678000
*                                                                  0793 02679000
*        TSOSEGNO = 1;                                     /*#YL026UK*/ 02680000
         MVC   TSOSEGNO(4),@CF00215                                0793 02681000
*        TSOSEGAD = ADDR(PGLB);                            /*#YL026UK*/ 02682000
*                                                                  0794 02683000
         LA    @15,PGLB                                            0794 02684000
         ST    @15,TSOSEGAD                                        0794 02685000
*        /************************************************************/ 02686000
*        /*                                                  #YL026UK*/ 02687000
*        /* ISSUE EXECUTE FORM OF THE TSO PUTGET MACRO       #YL026UK*/ 02688000
*        /* WHERE:                                           #YL026UK*/ 02689000
*        /* TSOOLD - OUTPUT ADDRESS                          #YL026UK*/ 02690000
*        /* SINGLE - SINGLE LEVEL OUTPUT MESSAGE             #YL026UK*/ 02691000
*        /* PROMPT - THE OUTPUT MESSAGE IS A PROMPT MESSAGE  #YL026UK*/ 02692000
*        /*                                                  #YL026UK*/ 02693000
*        /************************************************************/ 02694000
*                                                                  0795 02695000
*LPUTG1: GEN(PUTGET OUTPUT=(TSOOLD,SINGLE,PROMPT),MF=(E,TSOIOPL)); 0795 02696000
*                                                                  0795 02697000
LPUTG1   PUTGET OUTPUT=(TSOOLD,SINGLE,PROMPT),MF=(E,TSOIOPL)            02698000
*        /************************************************************/ 02699000
*        /*                                                  #YL026UK*/ 02700000
*        /* CHECK RETURN CODE FROM PUTGET MACRO              #YL026UK*/ 02701000
*        /*                                                  #YL026UK*/ 02702000
*        /************************************************************/ 02703000
*                                                                  0796 02704000
*        RESPECIFY (RTNREG) RSTD;                          /*#YL026UK*/ 02705000
*        RESPECIFY RTNREG RSTD;                                    0797 02706000
*        TESTRC = RTNREG;                                          0798 02707000
         STH   RTNREG,TESTRC                                       0798 02708000
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UK*/ 02709000
*        RESPECIFY (RTNREG) UNRSTD;                        /*#YL026UK*/ 02710000
*                                                                  0800 02711000
*        IF (TESTRC ^= 0  &  TESTRC ^= PGNOPRC)                    0801 02712000
*          THEN                                                    0801 02713000
*                                                                  0801 02714000
         LH    @15,TESTRC                                          0801 02715000
         LTR   @15,@15                                             0801 02716000
         BZ    @RF00801                                            0801 02717000
         C     @15,@CF00034                                        0801 02718000
         BE    @RF00801                                            0801 02719000
*            /********************************************************/ 02720000
*            /*                                              #YL026UK*/ 02721000
*            /* BAD RETURN CODE FROM PUTGET--PRINT ERROR     #YL026UK*/ 02722000
*            /* MESSAGE AND SET RETURN CODE TO 4             #YL026UK*/ 02723000
*            /*                                              #YL026UK*/ 02724000
*            /********************************************************/ 02725000
*                                                                  0802 02726000
*            DO;                                           /*#YL026UK*/ 02727000
*              DDSTRU = ADDR(MSGAREA);                     /*#YL026UK*/ 02728000
         LA    @15,MSGAREA                                         0803 02729000
         ST    @15,DDSTRU                                          0803 02730000
*              DARGLIST = '0'B;                            /*#YL026UK*/ 02731000
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  0804 02732000
         MVI   DARGLIST(@15),B'00000000'                           0804 02733000
*              DARGSMOD = RI1MOD;                          /*#YL026UK*/ 02734000
         MVC   DARGSMOD(3,@15),@CC01350                            0805 02735000
*              DARGSENT = PGSTID;                          /*#YL026UK*/ 02736000
         MVI   DARGSENT(@15),X'0C'                                 0806 02737000
*              DARGDBP = ADDR(TESTRC);                     /*#YL026UK*/ 02738000
         LA    @14,TESTRC                                          0807 02739000
         ST    @14,DARGDBP(,@15)                                   0807 02740000
*              DARGILP = 2;                                /*#YL026UK*/ 02741000
*                                                                  0808 02742000
         MVC   DARGILP(2,@15),@CH00149                             0808 02743000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*#YL026UK*/ 02744000
*                                                                  0809 02745000
         ST    GDTPR,@AL00001                                      0809 02746000
         LA    @15,@CF00111                                        0809 02747000
         ST    @15,@AL00001+4                                      0809 02748000
         LA    @15,DDSTRU                                          0809 02749000
         ST    @15,@AL00001+8                                      0809 02750000
         MVI   @AL00001+8,X'80'                                    0809 02751000
         L     @15,GDTPRT(,GDTPR)                                  0809 02752000
         LA    @01,@AL00001                                        0809 02753000
         BALR  @14,@15                                             0809 02754000
*              SETRC = 4;                                  /*#YL026UK*/ 02755000
         MVC   SETRC(2),@CH00038                                   0810 02756000
*            END;                                          /*#YL026UK*/ 02757000
*          ELSE                                                    0812 02758000
*                                                                  0812 02759000
*            /********************************************************/ 02760000
*            /*                                              @Y30SSMK*/ 02761000
*            /* A RETURN CODE 12 INDICATES A PROFILE         @Y30SSMK*/ 02762000
*            /* NOPROMPT WAS REQUESTED.  SET THE RETURN CODE @Y30SSMK*/ 02763000
*            /* TO 8.                                        @Y30SSMK*/ 02764000
*            /*                                              @Y30SSMK*/ 02765000
*            /********************************************************/ 02766000
*                                                                  0812 02767000
*            IF TESTRC = PGNOPRC                                   0812 02768000
*              THEN                                                0812 02769000
         B     @RC00801                                            0812 02770000
@RF00801 CLC   TESTRC(2),@CH00034                                  0812 02771000
         BNE   @RF00812                                            0812 02772000
*                SETRC = UPNOPRC;                          /*@Y30SSMK*/ 02773000
         MVC   SETRC(2),@CH00175                                   0813 02774000
*              ELSE                                                0814 02775000
*                                                                  0814 02776000
*                /****************************************************/ 02777000
*                /*                                          @YL026UK*/ 02778000
*                /* GOOD RETURN CODE FROM PUTGET MACRO.      #YL026UK*/ 02779000
*                /* RETURN THE ADDRESS OF THE REPLY TEXT     #YL026UK*/ 02780000
*                /* (INCLUDING THE HEADER WORD), RETURN THE  #YL026UK*/ 02781000
*                /* LENGTH OF THE REPLY TEXT (NOT INCLUDING  #YL026UK*/ 02782000
*                /* THE HEADER WORD), AND SET RETURN CODE    #YL026UK*/ 02783000
*                /* TO 0.                                    @Y30SSMK*/ 02784000
*                /*                                          #YL026UK*/ 02785000
*                /****************************************************/ 02786000
*                                                                  0814 02787000
*                DO;                                       /*#YL026UK*/ 02788000
         B     @RC00812                                            0814 02789000
@RF00812 DS    0H                                                  0815 02790000
*                  SETRC = 0;                              /*#YL026UK*/ 02791000
         SLR   @15,@15                                             0815 02792000
         STH   @15,SETRC                                           0815 02793000
*                  PTREPLP = PGINBUF;                      /*#YL026UK*/ 02794000
         L     @15,PGINBUF                                         0816 02795000
         L     @14,PARMPTR4                                        0816 02796000
         ST    @15,PTREPLP(,@14)                                   0816 02797000
*                  PTREPLL = INBUFLN - 4;                  /*#YL026UK*/ 02798000
         LH    @15,INBUFLN(,@15)                                   0817 02799000
         SL    @15,@CF00038                                        0817 02800000
         L     @14,PARMPTR5                                        0817 02801000
         STH   @15,PTREPLL(,@14)                                   0817 02802000
*                END;                                      /*#YL026UK*/ 02803000
*                                                                  0818 02804000
*        /************************************************************/ 02805000
*        /*                                                  #YL026UK*/ 02806000
*        /* RETURN CONTROL TO THE UPROMPT CALLER             #YL026UK*/ 02807000
*        /*                                                  #YL026UK*/ 02808000
*        /************************************************************/ 02809000
*                                                                  0819 02810000
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0819 02811000
@RC00812 DS    0H                                                  0819 02812000
@RC00801 ST    GDTPR,@AL00001                                      0819 02813000
         LA    @15,MODID                                           0819 02814000
         ST    @15,@AL00001+4                                      0819 02815000
         LA    @15,SETRC                                           0819 02816000
         ST    @15,@AL00001+8                                      0819 02817000
         MVI   @AL00001+8,X'80'                                    0819 02818000
         L     @15,GDTEPL(,GDTPR)                                  0819 02819000
         LA    @01,@AL00001                                        0819 02820000
         BALR  @14,@15                                             0819 02821000
*        /*#YL026UK*/                                              0820 02822000
*        /************************************************************/ 02823000
*        /************************************************************/ 02824000
*        /*                                                  #YL026UK*/ 02825000
*        /* UID ENTRY POINT                                  #YL026UK*/ 02826000
*        /*                                                  #YL026UK*/ 02827000
*        /************************************************************/ 02828000
*        /************************************************************/ 02829000
*                                                                  0820 02830000
*AMSSAID:  ENTRY(GDTTBLX,USERIDX,USERIDLX);                /*#YL026UK*/ 02831000
*                                                                  0820 02832000
@EC00820 DS    0H                                                  0821 02833000
*AMSSAID1:                                                         0821 02834000
*                                                                  0821 02835000
*        DCL USERID CHAR(7) BASED;     /* USERID FIELD       #YL026UK*/ 02836000
*                                                                  0821 02837000
AMSSAID1 DS    0H                                                  0822 02838000
*        DCL USERIDL FIXED(15) BASED;  /* USERID LENGTH      #YL026UK*/ 02839000
*                                                                  0822 02840000
*        RESPECIFY USERID BASED(PARMPTR2);                 /*#YL026UK*/ 02841000
*                                      /* BASE USERID FIELD  #YL026UK*/ 02842000
*                                                                  0824 02843000
*        RESPECIFY USERIDL BASED(PARMPTR3);                /*#YL026UK*/ 02844000
*                                      /* BASE USERID LENGTH #YL026UK*/ 02845000
*                                                                  0825 02846000
*        DCL UPTPTR PTR(31);           /* PTR TO TSO UPT     #Y30LSMK*/ 02847000
*                                                                  0825 02848000
*        /************************************************************/ 02849000
*        /*                                                  @YL026UK*/ 02850000
*        /* STRUCTURE FOR ADDRESSING IN THE TSO USER PROFILE @YL026UK*/ 02851000
*        /* TABLE                                            @YL026UK*/ 02852000
*        /*                                                  @YL026UK*/ 02853000
*        /************************************************************/ 02854000
*                                                                  0826 02855000
* /* *************************************************************** */ 02856000
* /* THE USER PROFILE TABLE (UPT) IS BUILT BY THE LOGON/LOGOFF       */ 02857000
* /* SCHEDULER FROM INFORMATION STORED IN THE UADS AND FROM THE      */ 02858000
* /* LOGON COMMAND.  IT IS IN CORE SHARED BY THE TMP AND THE         */ 02859000
* /* LOGON/LOGOFF SCHEDULER.  CP'S AND SERVICE ROUTINES CAN MODIFY   */ 02860000
* /* THE UPT, BUT THEY CANNOT FREE IT.                               */ 02861000
* /* *************************************************************** */ 02862000
* DECLARE                                                          0826 02863000
*   1 UPT BASED(UPTPTR),                                           0826 02864000
*    2 *        CHAR(2) BDY(WORD),   /* RESERVED                     */ 02865000
*    2 UPTUSER  CHAR(10),            /* RESERVED FOR INSTALLATION    */ 02866000
*    2 UPTSWS   CHAR(1),             /* USERS ENVIRONMENT SWITCHES   */ 02867000
*     3 UPTRCVR  BIT(1),             /* EDIT RECOVER OPTION IS     0826 02868000
*                                       REQUESTED DEFAULT    @Z40NQKG*/ 02869000
*     3 UPTNPRM  BIT(1),             /* NO PROMPTING TO BE DONE      */ 02870000
*     3 UPTMID   BIT(1),             /* PRINT MESSAGE IDENTIFIERS    */ 02871000
*     3 UPTNCOM  BIT(1),             /* NO USER COMMUNICATION      0826 02872000
*                                       ALLOWED VIA SEND COMMAND     */ 02873000
*     3 UPTPAUS  BIT(1),             /* PAUSE FOR '?' WHEN IN NON- 0826 02874000
*                                       INTERACTIVE MODE             */ 02875000
*     3 UPTALD   BIT(1),             /* ATTN HAS BEEN SPECIFIED AS 0826 02876000
*                                       THE LINE DELETE CHARACTER    */ 02877000
*     3 UPTMODE  BIT(1),             /* MODE MESSAGES DESIRED  Y01676*/ 02878000
*     3 UPTWTP   BIT(1),             /* WRITE TO PROGRAMMER    Y02669*/ 02879000
*                                    /* MSGS ARE TO BE PUT OUT Y02669*/ 02880000
*    2 UPTCDEL  CHAR(1),             /* CHAR DELETE CHARACTER        */ 02881000
*    2 UPTLDEL  CHAR(1),             /* LINE DELETE CHARACTER        */ 02882000
*    2 *        CHAR(1),             /* RESERVED                     */ 02883000
*    2 UPTPREFX CHAR(7),             /* DSNAME PREFIX          Y02669*/ 02884000
*    2 UPTPREFL PTR(8);              /* DSNAME PREFIX LENGTH   Y02669*/ 02885000
*                                                                  0826 02886000
*        /************************************************************/ 02887000
*        /*                                                  @YL026UK*/ 02888000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 02889000
*        /*                                                  @YL026UK*/ 02890000
*        /************************************************************/ 02891000
*                                                                  0827 02892000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 02893000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 02894000
         L     GDTPR,ADDR1(,REG1PTR)                               0828 02895000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 02896000
         LA    @15,4                                               0829 02897000
         LR    @14,REG1PTR                                         0829 02898000
         ALR   @14,@15                                             0829 02899000
         L     @00,ADDR2(,@14)                                     0829 02900000
         ST    @00,PARMPTR2                                        0829 02901000
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/ 02902000
         L     @14,ADDR3+8(,REG1PTR)                               0830 02903000
         ST    @14,PARMPTR3                                        0830 02904000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 02905000
*                                                                  0831 02906000
*        OLDERID2 = NEWERID2;                                      0832 02907000
         L     @01,GDTTR2(,GDTPR)                                  0832 02908000
         MVC   @TS00001(95),NEWERID2(@01)                          0832 02909000
         MVC   OLDERID2(95,@01),@TS00001                           0832 02910000
*        NEWID2 = 'SAID';                                  /*@YL026UK*/ 02911000
*                                                                  0833 02912000
         MVC   NEWID2(4,@01),@CC01975                              0833 02913000
*        /************************************************************/ 02914000
*        /*                                                  @YL026UK*/ 02915000
*        /* CHECK WHETHER OR NOT AMS WAS INVOKED VIA TSO BY  @YL026UK*/ 02916000
*        /* CHECKING WHETHER OR NOT THERE IS A TSO           @YL026UK*/ 02917000
*        /* ENVIRONMENT CONTROL TABLE                        @YL026UK*/ 02918000
*        /*                                                  @YL026UK*/ 02919000
*        /************************************************************/ 02920000
*                                                                  0834 02921000
*        IF GDTECT = 0                                             0834 02922000
*          THEN                                                    0834 02923000
*                                                                  0834 02924000
         SLR   @01,@01                                             0834 02925000
         C     @01,GDTECT(,GDTPR)                                  0834 02926000
         BNE   @RF00834                                            0834 02927000
*            /********************************************************/ 02928000
*            /*                                              @YL026UK*/ 02929000
*            /* AMS WAS NOT INVOKED VIA TSO--BLANK USERID  @YL026UK  */ 02930000
*            /* FIELD, SET USERID LENGTH TO ZERO, SET RETURN @YL026UK*/ 02931000
*            /* CODE TO FOUR, AND RETURN TO THE CALLER       @YL026UK*/ 02932000
*            /*                                              @YL026UK*/ 02933000
*            /******************************************************/   02934000
*                                                                  0835 02935000
*            DO;                                           /*@YL026UK*/ 02936000
*              USERID = ' ';                               /*@YL026UK*/ 02937000
         LR    @07,@00                                             0836 02938000
         MVI   USERID+1(@07),C' '                                  0836 02939000
         MVC   USERID+2(5,@07),USERID+1(@07)                       0836 02940000
         MVI   USERID(@07),C' '                                    0836 02941000
*              USERIDL = 0;                                /*@YL026UK*/ 02942000
         STH   @01,USERIDL(,@14)                                   0837 02943000
*              SETRC = 4;                                  /*@YL026UK*/ 02944000
         STH   @15,SETRC                                           0838 02945000
*              CALL IDCSAEP0(GDTTBL,MODID,SETRC);                  0839 02946000
         ST    GDTPR,@AL00001                                      0839 02947000
         LA    @15,MODID                                           0839 02948000
         ST    @15,@AL00001+4                                      0839 02949000
         LA    @15,SETRC                                           0839 02950000
         ST    @15,@AL00001+8                                      0839 02951000
         MVI   @AL00001+8,X'80'                                    0839 02952000
         L     @15,GDTEPL(,GDTPR)                                  0839 02953000
         LA    @01,@AL00001                                        0839 02954000
         BALR  @14,@15                                             0839 02955000
*        /*@YL026UK*/                                              0840 02956000
*            END;                                          /*@YL026UK*/ 02957000
*                                                                  0840 02958000
*        /************************************************************/ 02959000
*        /*                                                  @YL026UK*/ 02960000
*        /* MOVE TSO USERID FIELD INTO VARIABLE USERID AND THE       */ 02961000
*        /* LENGTH OF THE NON-BLANK PART OF THIS USERID INTO @YL026UK*/ 02962000
*        /* THE VARIABLE USERIDL                             @YL026UK*/ 02963000
*        /*                                                  @YL026UK*/ 02964000
*        /************************************************************/ 02965000
*                                                                  0841 02966000
*        UPTPTR = GDTUPT;                                  /*@YL026UK*/ 02967000
@RF00834 L     @15,GDTUPT(,GDTPR)                                  0841 02968000
         ST    @15,UPTPTR                                          0841 02969000
*        USERID = UPTPREFX;                                /*@YL026UK*/ 02970000
         L     @01,PARMPTR2                                        0842 02971000
         MVC   USERID(7,@01),UPTPREFX(@15)                         0842 02972000
*        USERIDL = UPTPREFL;                               /*@YL026UK*/ 02973000
*                                                                  0843 02974000
         SLR   @14,@14                                             0843 02975000
         IC    @14,UPTPREFL(,@15)                                  0843 02976000
         L     @15,PARMPTR3                                        0843 02977000
         STH   @14,USERIDL(,@15)                                   0843 02978000
*        /************************************************************/ 02979000
*        /*                                                  @YL026UK*/ 02980000
*        /* SET RETURN CODE AND RETURN TO THE UID CALLER     @YL026UK*/ 02981000
*        /*                                                  @YL026UK*/ 02982000
*        /************************************************************/ 02983000
*                                                                  0844 02984000
*        SETRC = 0;                                        /*@YL026UK*/ 02985000
         SLR   @15,@15                                             0844 02986000
         STH   @15,SETRC                                           0844 02987000
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0845 02988000
         ST    GDTPR,@AL00001                                      0845 02989000
         LA    @15,MODID                                           0845 02990000
         ST    @15,@AL00001+4                                      0845 02991000
         LA    @15,SETRC                                           0845 02992000
         ST    @15,@AL00001+8                                      0845 02993000
         MVI   @AL00001+8,X'80'                                    0845 02994000
         L     @15,GDTEPL(,GDTPR)                                  0845 02995000
         LA    @01,@AL00001                                        0845 02996000
         BALR  @14,@15                                             0845 02997000
*       /*@YL026UK*/                                               0846 02998000
*        /************************************************************/ 02999000
*        /************************************************************/ 03000000
*        /*                                                  @YL026UK*/ 03001000
*        /* UQUAL ENTRY POINT                                @YL026UK*/ 03002000
*        /*                                                  @YL026UK*/ 03003000
*        /************************************************************/ 03004000
*        /************************************************************/ 03005000
*                                                                  0846 03006000
*AMSSAQL:  ENTRY(GDTTBLX,DSNPX,DSNSX,CATNPX,PWDPX);        /*@YL026UK*/ 03007000
*                                                                  0846 03008000
@EC00846 DS    0H                                                  0847 03009000
*AMSSAQL1:                                                         0847 03010000
*                                                                  0847 03011000
*        DCL DSNS FIXED(15) BASED;     /* DSNAME SIZE        @YL026UK*/ 03012000
*                                                                  0847 03013000
AMSSAQL1 DS    0H                                                  0848 03014000
*        DCL DSNP PTR(31) BASED;       /* DSNAME POINTER     @YL026UK*/ 03015000
*                                                                  0848 03016000
*        DCL CATNP PTR(31) BASED;      /* CATALOG NAME PTR   @YL026UK*/ 03017000
*                                                                  0849 03018000
*        DCL PWDP PTR(31) BASED;       /* PASSWORD           @YL026UK*/ 03019000
*                                      /* POINTER            @YL026UK*/ 03020000
*                                                                  0851 03021000
*        RESPECIFY DSNS BASED(PARMPTR3);                   /*@YL026UK*/ 03022000
*                                      /* BASE DSNAME SIZE   @YL026UK*/ 03023000
*                                                                  0852 03024000
*        RESPECIFY DSNP BASED(PARMPTR2);                   /*@YL026UK*/ 03025000
*                                      /* BASE DSNAME PTR    @YL026UK*/ 03026000
*                                                                  0853 03027000
*        RESPECIFY CATNP BASED(PARMPTR4);                  /*@YL026UK*/ 03028000
*                                      /* BASE CATALOG NAME  @YL026UK*/ 03029000
*                                      /* PTR                @YL026UK*/ 03030000
*                                                                  0854 03031000
*        RESPECIFY PWDP BASED(PARMPTR5);                   /*@YL026UK*/ 03032000
*                                      /* BASE               @YL026UK*/ 03033000
*                                      /* PASSWORD PTR       @YL026UK*/ 03034000
*                                                                  0855 03035000
*         /* DATA SET NAME BUFFER                            @YL026UK*/ 03036000
*        DCL 1 DSNBUF CHAR(46) BDY(WORD),                          0855 03037000
*              2 DSNLEN FIXED(15),     /* DSNAME LENGTH      @YL026UK*/ 03038000
*              2 DSNFLD CHAR(44);      /* DSNAME             @YL026UK*/ 03039000
*                                                                  0855 03040000
*        /* UNQUALIFIED DATA SET NAME ON INPUT--QUALIFIED    @YL026UK*/ 03041000
*        /* DATA SET NAME ON OUTPUT                          @YL026UK*/ 03042000
*        DCL UNDSN CHAR(44) BASED(DSNP);                   /*@YL026UK*/ 03043000
*                                                                  0856 03044000
*        /* TSO DEFAULT PARAMETER BLOCK                      @YL026UK*/ 03045000
*        DCL 1 TSODFPB CHAR(20) BDY(WORD),                         0857 03046000
*              2 TSOENTRY CHAR(1),     /* ENTRY CODE         @YL026UK*/ 03047000
*              2 TSOBUF PTR(24),       /* ADDR OF DATA SET   @YL026UK*/ 03048000
*                                      /* NAME BUFFER        @YL026UK*/ 03049000
*              2 TSOCONT CHAR(1),      /* CONTROL CODE       @YL026UK*/ 03050000
*              2 TSOPROT PTR(24),      /* ADDR OF PROTECTED  @YL026UK*/ 03051000
*                                      /* STEP CONTROL BLOCK @YL026UK*/ 03052000
*              2 TSOLOC FIXED(8),      /* LOCATE RETURN CODE @YL026UK*/ 03053000
*              2 TSODEQ PTR(24),       /* DEFAULT QUALIFIER  @YL026UK*/ 03054000
*              2 TSOCAT PTR(31),       /* ADDR CATALOG DSN   @YL026UK*/ 03055000
*              2 TSOPSD PTR(31);       /* ADDR CAT PASSWORD  @YL026UK*/ 03056000
*                                                                  0857 03057000
*        /* TSO DEFAULT PARAMETER LIST                       @YL026UK*/ 03058000
*        DCL 1 TSODFPL CHAR(16) BDY(WORD),                         0858 03059000
*              2 TSOUSE PTR(31),       /* ADDR USER PROFILE  @YL026UK*/ 03060000
*                                      /* TABLE              @YL026UK*/ 03061000
*              2 TSOENV PTR(31),       /* ADDR ENVIRONMENT   @YL026UK*/ 03062000
*                                      /* CONTROL TABLE      @YL026UK*/ 03063000
*              2 TSOEVE PTR(31),       /* ADDR EVENT CONTROL @YL026UK*/ 03064000
*                                      /* BLOCK              @YL026UK*/ 03065000
*              2 TSODEF PTR(31);       /* ADDR DEFAULT       @YL026UK*/ 03066000
*                                      /* PARAMETER BLOCK    @YL026UK*/ 03067000
*                                                                  0859 03068000
*        /* EVENT CONTROL BLOCK                              @YL026UK*/ 03069000
*        DCL ECBLOCK FIXED(31);                            /*@YL026UK*/ 03070000
*                                                                  0859 03071000
*        /* DEFAULT SERVICE ROUTINE AND LOCATE RETURN CODES  @YL026UK*/ 03072000
*        /* AREA FOR UPRINT                                  @YL026UK*/ 03073000
*        DCL 1 DSRERR CHAR(4) BDY(WORD),                           0860 03074000
*              2 DSRRC FIXED(15),      /* DEFAULT SERVICE    @YL026UK*/ 03075000
*                                      /* ROUTINE RETURN     @YL026UK*/ 03076000
*                                      /* CODE               @YL026UK*/ 03077000
*              2 DSRLC FIXED(15);      /* LOCATE RETURN CODE @YL026UK*/ 03078000
*                                                                  0860 03079000
*        /* STID NUMBER FOR ERROR QUALIFYING MESSAGE         @YL026UK*/ 03080000
*        DCL DSR1STID FIXED(8) CONSTANT(13);               /*@YL026UK*/ 03081000
*                                                                  0861 03082000
*        /* STID NUMBER FOR DEFAULT ERROR CODES MESSAGE      @YL026UK*/ 03083000
*        DCL DSR2STID FIXED(8) CONSTANT(14);               /*@YL026UK*/ 03084000
*                                                                  0862 03085000
*        /************************************************************/ 03086000
*        /*                                                  @YL026UK*/ 03087000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 03088000
*        /*                                                  @YL026UK*/ 03089000
*        /************************************************************/ 03090000
*                                                                  0863 03091000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 03092000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 03093000
         L     GDTPR,ADDR1(,REG1PTR)                               0864 03094000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 03095000
         L     @00,ADDR2+4(,REG1PTR)                               0865 03096000
         ST    @00,PARMPTR2                                        0865 03097000
*        PARMPTR3 = ADDR3;                                 /*@YL026UK*/ 03098000
         L     @00,ADDR3+8(,REG1PTR)                               0866 03099000
         ST    @00,PARMPTR3                                        0866 03100000
*        PARMPTR4 = ADDR4;                                 /*@YL026UK*/ 03101000
         L     @00,ADDR4+12(,REG1PTR)                              0867 03102000
         ST    @00,PARMPTR4                                        0867 03103000
*        PARMPTR5 = ADDR5;                                 /*@YL026UK*/ 03104000
         L     @00,ADDR5+16(,REG1PTR)                              0868 03105000
         ST    @00,PARMPTR5                                        0868 03106000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 03107000
*                                                                  0869 03108000
*                                                                  0869 03109000
*                                                                  0870 03110000
*        /************************************************************/ 03111000
*        /*                                                          */ 03112000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 03113000
*        /*                                                          */ 03114000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 03115000
*        /*              TO THIS ROUTINE                             */ 03116000
*        /*                                                          */ 03117000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 03118000
*        /*               ADDRESS LIST                               */ 03119000
*        /*                                                          */ 03120000
*        /************************************************************/ 03121000
*                                                                  0870 03122000
*        GEN;                                                      0870 03123000
        ST    1,LISTPTR                                                 03124000
        ST    1,LISTSCAN                                                03125000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0871 03126000
         LA    @15,1                                               0871 03127000
         STC   @15,LISTLN                                          0871 03128000
@DL00871 L     @14,LISTSCAN                                        0871 03129000
         TM    LISTTEST(@14),B'10000000'                           0871 03130000
         BNZ   @DC00871                                            0871 03131000
*          LISTSCAN = LISTSCAN + 4;                                0872 03132000
         AL    @14,@CF00038                                        0872 03133000
         ST    @14,LISTSCAN                                        0872 03134000
*        END;                                                      0873 03135000
*                                                                  0873 03136000
         AL    @15,@CF00215                                        0873 03137000
         STC   @15,LISTLN                                          0873 03138000
         C     @15,@CF01724                                        0873 03139000
         BNH   @DL00871                                            0873 03140000
@DC00871 DS    0H                                                  0874 03141000
*        OLDERID2 = NEWERID2;                                      0874 03142000
         L     @15,GDTTR2(,GDTPR)                                  0874 03143000
         MVC   @TS00001(95),NEWERID2(@15)                          0874 03144000
         MVC   OLDERID2(95,@15),@TS00001                           0874 03145000
*        NEWID2 = 'SAQL';                                  /*@YL026UK*/ 03146000
*                                                                  0875 03147000
         MVC   NEWID2(4,@15),@CC02025                              0875 03148000
*        /************************************************************/ 03149000
*        /*                                                  @YL026UK*/ 03150000
*        /* CHECK WHETHER OR NOT AMS WAS INVOKED VIA TSO BY  @YL026UK*/ 03151000
*        /* CHECKING WHETHER OR NOT THERE IS A TSO           @YL026UK*/ 03152000
*        /* ENVIRONMENT CONTROL TABLE                        @YL026UK*/ 03153000
*        /*                                                  @YL026UK*/ 03154000
*        /************************************************************/ 03155000
*                                                                  0876 03156000
*        IF GDTECT = 0                                             0876 03157000
*          THEN                                                    0876 03158000
*                                                                  0876 03159000
         L     @15,GDTECT(,GDTPR)                                  0876 03160000
         LTR   @15,@15                                             0876 03161000
         BNZ   @RF00876                                            0876 03162000
*            /********************************************************/ 03163000
*            /*                                              @YL026UK*/ 03164000
*            /* AMS WAS NOT INVOKED VIA TSO--CALL PROCEDURE  @YL026UK*/ 03165000
*            /* NOSUPP TO PRINT OUT ERROR MESSAGE, SET       @YL026UK*/ 03166000
*            /* RETURN CODE, AND RETURN TO THE CALLER        @YL026UK*/ 03167000
*            /*                                              @YL026UK*/ 03168000
*            /********************************************************/ 03169000
*                                                                  0877 03170000
*            DO;                                           /*@YL026UK*/ 03171000
*              CALL NOSUPP;                                /*@YL026UK*/ 03172000
         BAL   @14,NOSUPP                                          0878 03173000
*              SETRC = 4;                                  /*@YL026UK*/ 03174000
         MVC   SETRC(2),@CH00038                                   0879 03175000
*              CALL IDCSAEP0(GDTTBL,MODID,SETRC);                  0880 03176000
         ST    GDTPR,@AL00001                                      0880 03177000
         LA    @15,MODID                                           0880 03178000
         ST    @15,@AL00001+4                                      0880 03179000
         LA    @15,SETRC                                           0880 03180000
         ST    @15,@AL00001+8                                      0880 03181000
         MVI   @AL00001+8,X'80'                                    0880 03182000
         L     @15,GDTEPL(,GDTPR)                                  0880 03183000
         LA    @01,@AL00001                                        0880 03184000
         BALR  @14,@15                                             0880 03185000
*        /*@YL026UK*/                                              0881 03186000
*            END;                                          /*@YL026UK*/ 03187000
*                                                                  0881 03188000
*        /************************************************************/ 03189000
*        /*                                                  @YL026UK*/ 03190000
*        /* CONSTRUCT PARTIALLY QUALIFIED DATA SET NAME      @YL026UK*/ 03191000
*        /* BUFFER                                           @YL026UK*/ 03192000
*        /*                                                  @YL026UK*/ 03193000
*        /************************************************************/ 03194000
*                                                                  0882 03195000
*        DSNFLD (1:44) = UNDSN (1:44);                     /*@YL026UK*/ 03196000
@RF00876 L     @01,PARMPTR2                                        0882 03197000
         L     @01,DSNP(,@01)                                      0882 03198000
         MVC   DSNFLD(44),UNDSN(@01)                               0882 03199000
*        DSNLEN = DSNS;                                    /*@YL026UK*/ 03200000
*                                                                  0883 03201000
         L     @01,PARMPTR3                                        0883 03202000
         LH    @15,DSNS(,@01)                                      0883 03203000
         STH   @15,DSNLEN                                          0883 03204000
*        /************************************************************/ 03205000
*        /************************************************************/ 03206000
*        /*                                                  @YL026UK*/ 03207000
*        /* INITIALIZE THE TSO DEFAULT PARAMETER BLOCK       @YL026UK*/ 03208000
*        /* INCLUDING THE ADDRESS OF A CATALOG DSNAME        @YL026UK*/ 03209000
*        /* IF SPECIFIED, AND THE ADDRESS OF A CATALOG       @YL026UK*/ 03210000
*        /* PASSWORD IF SPECIFIED.  THE TSO ENTRY CODE       @YL026UK*/ 03211000
*        /* REQUESTS FINDING A QUALIFIER.  IF MORE THAN ONE  @YL026UK*/ 03212000
*        /* EXISTS, PROMPT THE TERMINAL USER TO CHOOSE ONE.  @YL026UK*/ 03213000
*        /* NO TSO CONTROL CODE IS CODED.                    @YL026UK*/ 03214000
*        /*                                                  @YL026UK*/ 03215000
*        /************************************************************/ 03216000
*        /************************************************************/ 03217000
*                                                                  0884 03218000
*        TSOENTRY = '84'X;                                 /*@YL026UK*/ 03219000
         MVI   TSOENTRY,X'84'                                      0884 03220000
*        TSOBUF = ADDR(DSNBUF);                            /*@YL026UK*/ 03221000
         LA    @15,DSNBUF                                          0885 03222000
         STCM  @15,7,TSOBUF                                        0885 03223000
*        TSOCONT = '00'X;                                  /*@YL026UK*/ 03224000
         MVI   TSOCONT,X'00'                                       0886 03225000
*        TSOPROT = GDTPSB;                                 /*@YL026UK*/ 03226000
         MVC   TSOPROT(3),GDTPSB+1(GDTPR)                          0887 03227000
*        TSOLOC = '00'X;                                   /*@YL026UK*/ 03228000
         MVI   TSOLOC,X'00'                                        0888 03229000
*        TSODEQ = 0;                                       /*@YL026UK*/ 03230000
*                                                                  0889 03231000
         SLR   @15,@15                                             0889 03232000
         STCM  @15,7,TSODEQ                                        0889 03233000
*        /************************************************************/ 03234000
*        /*                                                  @YL026UK*/ 03235000
*        /* CHECK WHETHER OR NOT THE ADDRESS OF A CATALOG    @YL026UK*/ 03236000
*        /* DSNAME HAS BEEN SPECIFIED                        @YL026UK*/ 03237000
*        /*                                                  @YL026UK*/ 03238000
*        /************************************************************/ 03239000
*                                                                  0890 03240000
*        IF LISTLN > 3                                             0890 03241000
*          THEN                                                    0890 03242000
*                                                                  0890 03243000
         CLI   LISTLN,3                                            0890 03244000
         BNH   @RF00890                                            0890 03245000
*            /********************************************************/ 03246000
*            /*                                              @YL026UK*/ 03247000
*            /* THE ADDRESS OF A CATALOG DSNAME HAS BEEN     @YL026UK*/ 03248000
*            /* SPECIFIED                                    @YL026UK*/ 03249000
*            /*                                              @YL026UK*/ 03250000
*            /********************************************************/ 03251000
*                                                                  0891 03252000
*            DO;                                           /*@YL026UK*/ 03253000
*              TSOCAT = CATNP;                             /*@YL026UK*/ 03254000
*                                                                  0892 03255000
         L     @01,PARMPTR4                                        0892 03256000
         L     @15,CATNP(,@01)                                     0892 03257000
         ST    @15,TSOCAT                                          0892 03258000
*              /******************************************************/ 03259000
*              /*                                            @YL026UK*/ 03260000
*              /* CHECK WHETHER OR NOT THE ADDRESS OF A      @YL026UK*/ 03261000
*              /* PASSWORD HAS BEEN SPECIFIED.               @YL026UK*/ 03262000
*              /*                                            @YL026UK*/ 03263000
*              /******************************************************/ 03264000
*                                                                  0893 03265000
*              IF LISTLN > 4                                       0893 03266000
*                THEN                                              0893 03267000
*                                                                  0893 03268000
         CLI   LISTLN,4                                            0893 03269000
         BNH   @RF00893                                            0893 03270000
*                  /**************************************************/ 03271000
*                  /*                                        @YL026UK*/ 03272000
*                  /* THE ADDRESS OF A PASSWORD HAS          @YL026UK*/ 03273000
*                  /* BEEN SPECIFIED.                        @YL026UK*/ 03274000
*                  /*                                        @YL026UK*/ 03275000
*                  /**************************************************/ 03276000
*                                                                  0894 03277000
*                  TSOPSD = PWDP;                          /*@YL026UK*/ 03278000
*                                                                  0894 03279000
         L     @01,PARMPTR5                                        0894 03280000
         L     @15,PWDP(,@01)                                      0894 03281000
         ST    @15,TSOPSD                                          0894 03282000
*                ELSE                                              0895 03283000
*                                                                  0895 03284000
*                  /**************************************************/ 03285000
*                  /*                                        @YL026UK*/ 03286000
*                  /* THE ADDRESS OF A PASSWORD              @YL026UK*/ 03287000
*                  /* HAS NOT BEEN SPECIFIED                 @YL026UK*/ 03288000
*                  /*                                        @YL026UK*/ 03289000
*                  /**************************************************/ 03290000
*                                                                  0895 03291000
*                  TSOPSD = 0;                             /*@YL026UK*/ 03292000
         B     @RC00893                                            0895 03293000
@RF00893 SLR   @15,@15                                             0895 03294000
         ST    @15,TSOPSD                                          0895 03295000
*            END;                                          /*@YL026UK*/ 03296000
*          ELSE                                                    0897 03297000
*                                                                  0897 03298000
*            /********************************************************/ 03299000
*            /*                                              @YL026UK*/ 03300000
*            /* THE ADDRESS OF A CATALOG DSNAME HAS NOT      @YL026UK*/ 03301000
*            /* BEEN SPECIFIED--THEREFORE NO                 @YL026UK*/ 03302000
*            /* PASSWORD EITHER                              @YL026UK*/ 03303000
*            /*                                              @YL026UK*/ 03304000
*            /********************************************************/ 03305000
*                                                                  0897 03306000
*            DO;                                           /*@YL026UK*/ 03307000
         B     @RC00890                                            0897 03308000
@RF00890 DS    0H                                                  0898 03309000
*              TSOCAT = 0;                                 /*@YL026UK*/ 03310000
         SLR   @15,@15                                             0898 03311000
         ST    @15,TSOCAT                                          0898 03312000
*              TSOPSD = 0;                                 /*@YL026UK*/ 03313000
         ST    @15,TSOPSD                                          0899 03314000
*            END;                                          /*@YL026UK*/ 03315000
*                                                                  0900 03316000
*        /************************************************************/ 03317000
*        /*                                                  @YL026UK*/ 03318000
*        /* INITIALIZE THE EVENT CONTROL BLOCK TO ZERO AND   @YL026UK*/ 03319000
*        /* INITIALIZE THE TSO DEFAULT PARAMETER LIST        @YL026UK*/ 03320000
*        /*                                                  @YL026UK*/ 03321000
*        /************************************************************/ 03322000
*                                                                  0901 03323000
*        ECBLOCK = 0;                                      /*@YL026UK*/ 03324000
@RC00890 SLR   @15,@15                                             0901 03325000
         ST    @15,ECBLOCK                                         0901 03326000
*        TSOUSE = GDTUPT;                                  /*@YL026UK*/ 03327000
         L     @14,GDTUPT(,GDTPR)                                  0902 03328000
         ST    @14,TSOUSE                                          0902 03329000
*        TSOENV = GDTECT;                                  /*@YL026UK*/ 03330000
         L     @14,GDTECT(,GDTPR)                                  0903 03331000
         ST    @14,TSOENV                                          0903 03332000
*        TSOEVE = ADDR(ECBLOCK);                           /*@YL026UK*/ 03333000
         LA    @14,ECBLOCK                                         0904 03334000
         ST    @14,TSOEVE                                          0904 03335000
*        TSODEF = ADDR(TSODFPB);                           /*@YL026UK*/ 03336000
*                                                                  0905 03337000
         LA    @14,TSODFPB                                         0905 03338000
         ST    @14,TSODEF                                          0905 03339000
*        /************************************************************/ 03340000
*        /*                                                  @YL026UK*/ 03341000
*        /* ISSUE CALLTSSR TO ENTRY POINT IKJDFLT            @Z40GSJG*/ 03342000
*        /* (MODULE IKJEHDEF) WITH THE DEFAULT PARAMETER     @YL026UK*/ 03343000
*        /* LIST PASSED AS AN ARGUMENT                       @YL026UK*/ 03344000
*        /*                                                  @YL026UK*/ 03345000
*        /************************************************************/ 03346000
*                                                                  0906 03347000
*        DO; /*CALLTSSR EP(IKJEHDEF)MF(E,TSODFPL)*/                0906 03348000
*          RESPECIFY GPR01P RSTD;                                  0907 03349000
*          GPR01P = ADDR(TSODFPL);                                 0908 03350000
         LA    GPR01P,TSODFPL                                      0908 03351000
*          IF CVTEHDEF = 0                                         0909 03352000
*            THEN                                                  0909 03353000
         L     @14,CVTPTR                                          0909 03354000
         C     @15,CVTEHDEF(,@14)                                  0909 03355000
         BNE   @RF00909                                            0909 03356000
*              GEN(LINK EP=IKJEHDEF);                              0910 03357000
         LINK EP=IKJEHDEF                                               03358000
*            ELSE                                                  0911 03359000
*              CALL CVTEHDEF;                                      0911 03360000
         B     @RC00909                                            0911 03361000
@RF00909 L     @14,CVTPTR                                          0911 03362000
         L     @15,CVTEHDEF(,@14)                                  0911 03363000
         BALR  @14,@15                                             0911 03364000
*          RESPECIFY GPR01P UNRSTD;                                0912 03365000
@RC00909 DS    0H                                                  0913 03366000
*        END;              /*@Z40GSJG*/                            0913 03367000
*                                                                  0913 03368000
*        /************************************************************/ 03369000
*        /*                                                  @YL026UK*/ 03370000
*        /* CHECK RETURN CODE FROM DEFAULT SERVICE ROUTINE   @YL026UK*/ 03371000
*        /*                                                  @YL026UK*/ 03372000
*        /************************************************************/ 03373000
*                                                                  0914 03374000
*        RESPECIFY (RTNREG) RSTD;                          /*@YL026UK*/ 03375000
*        RESPECIFY RTNREG RSTD;                                    0915 03376000
*        TESTRC = RTNREG;                                          0916 03377000
         STH   RTNREG,TESTRC                                       0916 03378000
*        RESPECIFY RTNREG UNRSTD;                          /*@YL026UK*/ 03379000
*        RESPECIFY (RTNREG) UNRSTD;                        /*@YL026UK*/ 03380000
*                                                                  0918 03381000
*        IF TESTRC ^= 0                                            0919 03382000
*          THEN                                                    0919 03383000
*                                                                  0919 03384000
         LH    @15,TESTRC                                          0919 03385000
         LTR   @15,@15                                             0919 03386000
         BZ    @RF00919                                            0919 03387000
*            /********************************************************/ 03388000
*            /*                                              @YL026UK*/ 03389000
*            /* BAD RETURN CODE FROM THE DEFAULT SERVICE     @YL026UK*/ 03390000
*            /* ROUTINE--PRINT ERROR MESSAGES AND SET        @YL026UK*/ 03391000
*            /* RETURN CODE TO 4                             @YL026UK*/ 03392000
*            /*                                              @YL026UK*/ 03393000
*            /********************************************************/ 03394000
*                                                                  0920 03395000
*            DO;                                           /*@YL026UK*/ 03396000
*                                                                  0920 03397000
*              /******************************************************/ 03398000
*              /*                                            @YL026UK*/ 03399000
*              /* PRINT MESSAGE CONTAINING THE UNQUALIFIED   @YL026UK*/ 03400000
*              /* DATA SET NAME                              @YL026UK*/ 03401000
*              /*                                            @YL026UK*/ 03402000
*              /******************************************************/ 03403000
*                                                                  0921 03404000
*              DDSTRU = ADDR(MSGAREA);                     /*@YL026UK*/ 03405000
         LA    @15,MSGAREA                                         0921 03406000
         ST    @15,DDSTRU                                          0921 03407000
*              DARGLIST = '0'B;                            /*@YL026UK*/ 03408000
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  0922 03409000
         MVI   DARGLIST(@15),B'00000000'                           0922 03410000
*              DARGSMOD = RI1MOD;                          /*@YL026UK*/ 03411000
         MVC   DARGSMOD(3,@15),@CC01350                            0923 03412000
*              DARGSENT = DSR1STID;                        /*@YL026UK*/ 03413000
         MVI   DARGSENT(@15),X'0D'                                 0924 03414000
*              DARGDBP = DSNP;                             /*@YL026UK*/ 03415000
         L     @01,PARMPTR2                                        0925 03416000
         L     @14,DSNP(,@01)                                      0925 03417000
         ST    @14,DARGDBP(,@15)                                   0925 03418000
*              DARGILP = 44;                               /*@YL026UK*/ 03419000
*                                                                  0926 03420000
         MVC   DARGILP(2,@15),@CH01652                             0926 03421000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UK*/ 03422000
*                                                                  0927 03423000
         ST    GDTPR,@AL00001                                      0927 03424000
         LA    @15,@CF00111                                        0927 03425000
         ST    @15,@AL00001+4                                      0927 03426000
         LA    @15,DDSTRU                                          0927 03427000
         ST    @15,@AL00001+8                                      0927 03428000
         MVI   @AL00001+8,X'80'                                    0927 03429000
         L     @15,GDTPRT(,GDTPR)                                  0927 03430000
         LA    @01,@AL00001                                        0927 03431000
         BALR  @14,@15                                             0927 03432000
*              /******************************************************/ 03433000
*              /*                                            @YL026UK*/ 03434000
*              /* PRINT MESSAGE CONTAINING THE DEFAULT       @YL026UK*/ 03435000
*              /* SERVICE ROUTINE RETURN CODE AND THE LOCATE @YL026UK*/ 03436000
*              /* RETURN CODE                                @YL026UK*/ 03437000
*              /*                                            @YL026UK*/ 03438000
*              /******************************************************/ 03439000
*                                                                  0928 03440000
*              DSRRC = TESTRC;                             /*@YL026UK*/ 03441000
         LH    @15,TESTRC                                          0928 03442000
         STH   @15,DSRRC                                           0928 03443000
*              DSRLC = TSOLOC;                             /*@YL026UK*/ 03444000
         SLR   @15,@15                                             0929 03445000
         IC    @15,TSOLOC                                          0929 03446000
         STH   @15,DSRLC                                           0929 03447000
*              DDSTRU = ADDR(MSGAREA);                     /*@YL026UK*/ 03448000
         LA    @15,MSGAREA                                         0930 03449000
         ST    @15,DDSTRU                                          0930 03450000
*              DARGLIST = '0'B;                            /*@YL026UK*/ 03451000
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  0931 03452000
         MVI   DARGLIST(@15),B'00000000'                           0931 03453000
*              DARGSMOD = RI1MOD;                          /*@YL026UK*/ 03454000
         MVC   DARGSMOD(3,@15),@CC01350                            0932 03455000
*              DARGSENT = DSR2STID;                        /*@YL026UK*/ 03456000
         MVI   DARGSENT(@15),X'0E'                                 0933 03457000
*              DARGDBP = ADDR(DSRERR);                     /*@YL026UK*/ 03458000
         LA    @14,DSRERR                                          0934 03459000
         ST    @14,DARGDBP(,@15)                                   0934 03460000
*              DARGILP = 4;                                /*@YL026UK*/ 03461000
*                                                                  0935 03462000
         MVC   DARGILP(2,@15),@CH00038                             0935 03463000
*              CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);       /*@YL026UK*/ 03464000
*                                                                  0936 03465000
         ST    GDTPR,@AL00001                                      0936 03466000
         LA    @15,@CF00111                                        0936 03467000
         ST    @15,@AL00001+4                                      0936 03468000
         LA    @15,DDSTRU                                          0936 03469000
         ST    @15,@AL00001+8                                      0936 03470000
         MVI   @AL00001+8,X'80'                                    0936 03471000
         L     @15,GDTPRT(,GDTPR)                                  0936 03472000
         LA    @01,@AL00001                                        0936 03473000
         BALR  @14,@15                                             0936 03474000
*              SETRC = 4;                                  /*@YL026UK*/ 03475000
         MVC   SETRC(2),@CH00038                                   0937 03476000
*            END;                                          /*@YL026UK*/ 03477000
*          ELSE                                                    0939 03478000
*                                                                  0939 03479000
*            /********************************************************/ 03480000
*            /*                                              @YL026UK*/ 03481000
*            /* GOOD RETURN CODE FROM THE DEFAULT SERVICE    @YL026UK*/ 03482000
*            /* ROUTINE--RETURN THE LENGTH OF THE FULLY      @YL026UK*/ 03483000
*            /* QUALIFIED DATA SET NAME, RETURN THE FULLY    @YL026UK*/ 03484000
*            /* QUALIFIED DATA SET NAME, AND SET A RETURN    @YL026UK*/ 03485000
*            /* CODE OF 0                                    @YL026UK*/ 03486000
*            /*                                              @YL026UK*/ 03487000
*            /********************************************************/ 03488000
*                                                                  0939 03489000
*            DO;                                           /*@YL026UK*/ 03490000
         B     @RC00919                                            0939 03491000
@RF00919 DS    0H                                                  0940 03492000
*              SETRC = 0;                                  /*@YL026UK*/ 03493000
         SLR   @15,@15                                             0940 03494000
         STH   @15,SETRC                                           0940 03495000
*              DSNS = DSNLEN;                              /*@YL026UK*/ 03496000
         LH    @15,DSNLEN                                          0941 03497000
         L     @14,PARMPTR3                                        0941 03498000
         STH   @15,DSNS(,@14)                                      0941 03499000
*              UNDSN(1:DSNLEN) = DSNFLD(1:DSNLEN);         /*@YL026UK*/ 03500000
         L     @01,PARMPTR2                                        0942 03501000
         L     @01,DSNP(,@01)                                      0942 03502000
         BCTR  @15,0                                               0942 03503000
         EX    @15,@SM02464                                        0942 03504000
*            END;                                          /*@YL026UK*/ 03505000
*                                                                  0943 03506000
*        /************************************************************/ 03507000
*        /*                                                  @YL026UK*/ 03508000
*        /* RETURN CONTROL TO THE UQUAL CALLER               @YL026UK*/ 03509000
*        /*                                                  @YL026UK*/ 03510000
*        /************************************************************/ 03511000
*                                                                  0944 03512000
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        0944 03513000
@RC00919 ST    GDTPR,@AL00001                                      0944 03514000
         LA    @15,MODID                                           0944 03515000
         ST    @15,@AL00001+4                                      0944 03516000
         LA    @15,SETRC                                           0944 03517000
         ST    @15,@AL00001+8                                      0944 03518000
         MVI   @AL00001+8,X'80'                                    0944 03519000
         L     @15,GDTEPL(,GDTPR)                                  0944 03520000
         LA    @01,@AL00001                                        0944 03521000
         BALR  @14,@15                                             0944 03522000
*        /*@YL026UK*/                                              0945 03523000
*        /************************************************************/ 03524000
*        /************************************************************/ 03525000
*        /*                                                  @YL026UK*/ 03526000
*        /* UALLOC ENTRY POINT                               @YL026UK*/ 03527000
*        /*                                                  @YL026UK*/ 03528000
*        /************************************************************/ 03529000
*        /************************************************************/ 03530000
*                                                                  0945 03531000
*AMSSAAL:  ENTRY(GDTTBLX,ALLAGLX);                         /*@YL026UK*/ 03532000
*                                                                  0945 03533000
@EC00945 DS    0H                                                  0946 03534000
*AMSSAAL1:                                                         0946 03535000
*                                                                  0946 03536000
*        RESPECIFY ALLAGL BASED(PARMPTR2);                 /*@YL026UK*/ 03537000
AMSSAAL1 DS    0H                                                  0947 03538000
*                                      /* BASE ALLOCATION    @YL026UK*/ 03539000
*                                      /* ARGUMENT LIST      @YL026UK*/ 03540000
*                                                                  0947 03541000
*        /* VOLSER LIST ADDRESSED IN ALLAGL                  @YL026UK*/ 03542000
*        DCL 1 AGLVOL BASED(ALLVLP),                               0947 03543000
*              2 VOLCNT FIXED(15),     /* NUMBER OF ENTRIES  @YL026UK*/ 03544000
*              2 * (*) CHAR(8),        /* ENTRIES            @YL026UK*/ 03545000
*                3 VOLLEN FIXED(15),   /* LENGTH OF VOLSER   @YL026UK*/ 03546000
*                3 VOLVAL CHAR(6);     /* VOLSER             @YL026UK*/ 03547000
*                                                                  0947 03548000
*        /* UNIT LIST ADDRESSED IN ALLAGL                    @YL026UK*/ 03549000
*        DCL 1 AGLUNT BASED(ALLULP),                               0948 03550000
*              2 UNTCNT FIXED(15),     /* NUMBER OF ENTRIES  @YL026UK*/ 03551000
*              2 * (*) CHAR(10),       /* ENTRIES            @YL026UK*/ 03552000
*                3 UNTLEN FIXED(15),   /* LENGTH OF UNIT     @YL026UK*/ 03553000
*                3 UNTVAL CHAR(8);     /* UNIT               @YL026UK*/ 03554000
*                                                                  0948 03555000
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR UNIT            @YL026UK*/ 03556000
*        /* DESCRIPTION                                      @YL026UK*/ 03557000
*        DCL TEXTUNT CHAR(14) BDY(HWORD);                  /*@YL026UK*/ 03558000
*                                                                  0949 03559000
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR VOLSER          @YL026UK*/ 03560000
*        /* DESCRIPTION                                      @YL026UK*/ 03561000
*        DCL TEXTVOL CHAR(12) BDY(HWORD);                  /*@YL026UK*/ 03562000
*                                                                  0950 03563000
*        /* DDNAME TEXT UNIT POINTER FOR CONCATENATION       @YL026UK*/ 03564000
*        DCL DDLISTPT PTR(31);                             /*@YL026UK*/ 03565000
*                                                                  0951 03566000
*        /* DDNAME DYNAMIC ALLOCATION TEXT UNIT FOR          @YL026UK*/ 03567000
*        /* CONCATENATION                                    @YL026UK*/ 03568000
*        DCL 1 TEXTCON BASED(DDLISTPT),                            0952 03569000
*              2 CONKEY CHAR(2),       /* KEY                @YL026UK*/ 03570000
*              2 CONNUM FIXED(15),     /* NO OF ENTRIES      @YL026UK*/ 03571000
*              2 CONENT(*) CHAR(10),   /* ENTRIES            @YL026UK*/ 03572000
*                3 CONLN FIXED(15),    /* ENTRY LENGTH       @YL026UK*/ 03573000
*                3 CONDDN CHAR(8);     /* DDNAME ENTRY       @YL026UK*/ 03574000
*                                                                  0952 03575000
*        /* DDNAME TEXT UNIT SIZE FOR CONCATENATION          @YL026UK*/ 03576000
*        DCL DDLISTSZ FIXED(31);                           /*@YL026UK*/ 03577000
*                                                                  0953 03578000
*        /* UABORT NO AVAILABLE SPACE MESSAGE                @YL026UK*/ 03579000
*        DCL NOSPACE FIXED(31) CONSTANT (28);              /*@YL026UK*/ 03580000
*                                                                  0954 03581000
*        /* PTR FOR MULTIPLE VOLSER TEXT UNIT                @YL026UK*/ 03582000
*        DCL TEXTVOLP PTR(31);                             /*@YL026UK*/ 03583000
*                                                                  0955 03584000
*        /* MULTIPLE VOLSER TEXT UNIT                        @YL026UK*/ 03585000
*        DCL MTEXTVOL CHAR(*) BASED(TEXTVOLP);             /*@YL026UK*/ 03586000
*                                                                  0956 03587000
*        /* MULTIPLE VOLSER TEXT UNIT SIZE                   @YL026UK*/ 03588000
*        DCL TEXTVOLS FIXED(31);                           /*@YL026UK*/ 03589000
*                                                                  0957 03590000
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR PERMANENT       @YL026UK*/ 03591000
*        /* CONCATENATION ATTRIBUTE                          @YL026UK*/ 03592000
*        DCL TEXTPER CHAR(4) BDY(HWORD);                   /*@YL026UK*/ 03593000
*                                                                  0958 03594000
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR PRIVATE VOLUME  @Y30LSMK*/ 03595000
*        /* USE ATTRIBUTE                                    @Y30LSMK*/ 03596000
*        DCL TEXTPRI CHAR(4) BDY(HWORD);                   /*@Y30LSMK*/ 03597000
*                                                                  0959 03598000
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR UNIT COUNT      @Y30LSMK*/ 03599000
*        DCL TEXTUCNT CHAR(7) BDY(HWORD);                  /*@Y30LSMK*/ 03600000
*                                                                  0960 03601000
*        /* DYNAMIC ALLOCATION TEXT UNIT FOR VOLUME COUNT    @Y30LSMK*/ 03602000
*        DCL TEXTVCNT CHAR(7) BDY(HWORD);                  /*@Y30LSMK*/ 03603000
*                                                                  0961 03604000
*        DCL 1 UNTCOUNT FIXED(8),      /* UNIT COUNT         @Y30LSMK*/ 03605000
*              2 UNITCNT CHAR(1);                          /*@Y30LSMK*/ 03606000
*                                                                  0962 03607000
*        DCL 1 VOLCOUNT FIXED(8),      /* VOLUME COUNT       @Y30LSMK*/ 03608000
*              2 VOLUMCNT CHAR(1);                         /*@Y30LSMK*/ 03609000
*                                                                  0963 03610000
*        /* STID NUMBER FOR ERROR DURING DYNAMIC             @YL026UK*/ 03611000
*        /* CONCATENATION                                    @YL026UK*/ 03612000
*        DCL CONSTID FIXED(8) CONSTANT(31);                /*@YL026UK*/ 03613000
*                                                                  0964 03614000
*        /* STID NUMBER FOR ERROR DURING ALLOCATION OF       @YL026UK*/ 03615000
*        /* VOLUMES                                          @YL026UK*/ 03616000
*        DCL VOLSTID FIXED(8) CONSTANT(30);                /*@YL026UK*/ 03617000
*                                                                  0965 03618000
*        /* STID NUMBER FOR ERROR WHILE ALLOCATING DSNAME    @YL026UK*/ 03619000
*        DCL DSNSTID FIXED(8) CONSTANT(27);                /*@YL026UK*/ 03620000
*                                                                  0966 03621000
*        DCL I FIXED(15);              /* IDX IN UNIT LIST   @Y30LSMK*/ 03622000
*                                                                  0967 03623000
*        DCL J FIXED(15);              /* IDX IN VOLUME LIST @Y30LSMK*/ 03624000
*                                                                  0968 03625000
*        DCL S99TUFP PTR(31);          /* PTR TO MULT TEXT UNIT    0969 03626000
*                                                            @Y30LSMK*/ 03627000
*        DCL BLANKDDN CHAR(8) CONSTANT('        ');        /*@Y30SSMK*/ 03628000
*                                      /* BLANK OUT DDNAME   @Y30SSMK*/ 03629000
*                                                                  0971 03630000
*        /************************************************************/ 03631000
*        /*                                                  @YL026UK*/ 03632000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 03633000
*        /*                                                  @YL026UK*/ 03634000
*        /************************************************************/ 03635000
*                                                                  0971 03636000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 03637000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 03638000
         L     GDTPR,ADDR1(,REG1PTR)                               0972 03639000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 03640000
         L     @00,ADDR2+4(,REG1PTR)                               0973 03641000
         ST    @00,PARMPTR2                                        0973 03642000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 03643000
*                                                                  0974 03644000
*        OLDERID2 = NEWERID2;                                      0975 03645000
         L     @01,GDTTR2(,GDTPR)                                  0975 03646000
         MVC   @TS00001(95),NEWERID2(@01)                          0975 03647000
         MVC   OLDERID2(95,@01),@TS00001                           0975 03648000
*        NEWID2 = 'SAAL';                                  /*@YL026UK*/ 03649000
         MVC   NEWID2(4,@01),@CC02079                              0976 03650000
*        ERRORTAB = ''B;                                   /*@Z40GSBF*/ 03651000
*                                                                  0977 03652000
         XC    ERRORTAB(32),ERRORTAB                               0977 03653000
*        /************************************************************/ 03654000
*        /*                                                  @YL026UK*/ 03655000
*        /* CHECK FOR CONDITION WHERE BOTH VOLUME MOUNT AND  @YL026UK*/ 03656000
*        /* DATA SET ALLOCATION IS REQUESTED, OR WHERE       @YL026UK*/ 03657000
*        /* NEITHER IS REQUESTED--UABORT IF EITHER CONDITION @YL026UK*/ 03658000
*        /* IS DETECTED.                                     @YL026UK*/ 03659000
*        /*                                                  @YL026UK*/ 03660000
*        /************************************************************/ 03661000
*                                                                  0978 03662000
*        IF (ALLOPTVL = OFF & ALLOPTDS = OFF) |                    0978 03663000
*           (ALLOPTVL = ON & ALLOPTDS = ON)                        0978 03664000
*          THEN                                                    0978 03665000
*                                                                  0978 03666000
         LR    @01,@00                                             0978 03667000
         TM    ALLOPTVL(@01),B'11000000'                           0978 03668000
         BZ    @RT00978                                            0978 03669000
         L     @01,PARMPTR2                                        0978 03670000
         TM    ALLOPTVL(@01),B'11000000'                           0978 03671000
         BNO   @RF00978                                            0978 03672000
@RT00978 DS    0H                                                  0979 03673000
*            DO;                                                   0979 03674000
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  0980 03675000
*              REG15 = ARGERR;                                     0981 03676000
         LA    REG15,40                                            0981 03677000
*              REG14 = GDTABT;                                     0982 03678000
         L     REG14,GDTABT(,GDTPR)                                0982 03679000
*              REG13 = GDTABH;                                     0983 03680000
         L     REG13,GDTABH(,GDTPR)                                0983 03681000
*              GEN(BR    REG14);                                   0984 03682000
         BR    REG14                                                    03683000
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 0985 03684000
*            END;                               /*@YL026UK*/       0986 03685000
*                                                                  0986 03686000
*        /************************************************************/ 03687000
*        /*                                                  @Y30LSMK*/ 03688000
*        /* CHECK FOR CONDITION WERE A VOLUME MOUNT WAS      @Y30LSMK*/ 03689000
*        /* REQUESTED WITH A VOLUME LIST COUNT LESS THAN     @Y30LSMK*/ 03690000
*        /* THE UNIT LIST COUNT, OR UNIT COUNT LESS THAN     @Y30LSMK*/ 03691000
*        /* UNIT LIST COUNT, OR VOLUME COUNT LESS THAN       @Y30LSMK*/ 03692000
*        /* VOLUME LIST COUNT. -- UABORT IF ANY OF ABOVE     @Y30LSMK*/ 03693000
*        /* CONDITIONS ARE MET.                              @Y30LSMK*/ 03694000
*        /*                                                  @Y30LSMK*/ 03695000
*        /************************************************************/ 03696000
*                                                                  0987 03697000
*        IF ALLOPTVL = ON                                          0987 03698000
*          THEN                                                    0987 03699000
@RF00978 L     @15,PARMPTR2                                        0987 03700000
         TM    ALLOPTVL(@15),B'10000000'                           0987 03701000
         BNO   @RF00987                                            0987 03702000
*            IF ALLUNCNT ^= 0  |  ALLVLCNT ^= 0                    0988 03703000
*              THEN                                                0988 03704000
         CLI   ALLUNCNT(@15),0                                     0988 03705000
         BNE   @RT00988                                            0988 03706000
         CLI   ALLVLCNT(@15),0                                     0988 03707000
         BE    @RF00988                                            0988 03708000
@RT00988 DS    0H                                                  0989 03709000
*                IF VOLCNT < UNTCNT  |  ALLUNCNT < UNTCNT  |       0989 03710000
*                  ALLVLCNT < VOLCNT                               0989 03711000
*                  THEN                                            0989 03712000
*                                                                  0989 03713000
         L     @15,PARMPTR2                                        0989 03714000
         L     @01,ALLVLP(,@15)                                    0989 03715000
         LH    @14,VOLCNT(,@01)                                    0989 03716000
         L     @01,ALLULP(,@15)                                    0989 03717000
         LH    @07,UNTCNT(,@01)                                    0989 03718000
         CR    @14,@07                                             0989 03719000
         BL    @RT00989                                            0989 03720000
         SLR   @06,@06                                             0989 03721000
         IC    @06,ALLUNCNT(,@15)                                  0989 03722000
         CR    @07,@06                                             0989 03723000
         BH    @RT00989                                            0989 03724000
         SLR   @07,@07                                             0989 03725000
         IC    @07,ALLVLCNT(,@15)                                  0989 03726000
         CR    @14,@07                                             0989 03727000
         BNH   @RF00989                                            0989 03728000
@RT00989 DS    0H                                                  0990 03729000
*                    DO;                                           0990 03730000
*                      RESPECIFY(REG13,REG14,REG15) RSTD;          0991 03731000
*                      REG15 = ARGERR;                             0992 03732000
         LA    REG15,40                                            0992 03733000
*                      REG14 = GDTABT;                             0993 03734000
         L     REG14,GDTABT(,GDTPR)                                0993 03735000
*                      REG13 = GDTABH;                             0994 03736000
         L     REG13,GDTABH(,GDTPR)                                0994 03737000
*                      GEN(BR    REG14);                           0995 03738000
         BR    REG14                                                    03739000
*                      RESPECIFY(REG13,REG14,REG15)UNRSTD;         0996 03740000
*                    END;                       /*@Y30LSMK*/       0997 03741000
*                                                                  0997 03742000
*        /************************************************************/ 03743000
*        /*                                                  @YL026UK*/ 03744000
*        /* ZERO TEXT UNIT POINTER LIST AND REQUEST BLOCK    @YL026UK*/ 03745000
*        /*                                                  @YL026UK*/ 03746000
*        /************************************************************/ 03747000
*                                                                  0998 03748000
*        TUPL = '00'X;                                     /*@YL026UK*/ 03749000
@RF00989 DS    0H                                                  0998 03750000
@RF00988 DS    0H                                                  0998 03751000
@RF00987 XC    TUPL+1(31),TUPL+1                                   0998 03752000
         MVI   TUPL,X'00'                                          0998 03753000
*        S99RB = '00'X;                                    /*@YL026UK*/ 03754000
         XC    S99RB+1(19),S99RB+1                                 0999 03755000
         MVI   S99RB,X'00'                                         0999 03756000
*        RESPECIFY S99TUPL BASED(ADDR(TUPL));              /*@YL026UK*/ 03757000
*                                                                  1000 03758000
*        /************************************************************/ 03759000
*        /*                                                  @YL026UK*/ 03760000
*        /* CHECK FOR TYPE REQUEST                           @YL026UK*/ 03761000
*        /*                                                  @YL026UK*/ 03762000
*        /************************************************************/ 03763000
*                                                                  1001 03764000
*        IF ALLOPTVL = ON                                          1001 03765000
*          THEN                                                    1001 03766000
*                                                                  1001 03767000
         L     @15,PARMPTR2                                        1001 03768000
         TM    ALLOPTVL(@15),B'10000000'                           1001 03769000
         BNO   @RF01001                                            1001 03770000
*            /********************************************************/ 03771000
*            /*                                              @YL026UK*/ 03772000
*            /* REQUEST IS FOR VOLUME MOUNT                  @YL026UK*/ 03773000
*            /*                                              @YL026UK*/ 03774000
*            /********************************************************/ 03775000
*                                                                  1002 03776000
*            DO;                                           /*@YL026UK*/ 03777000
*                                                                  1002 03778000
*              /******************************************************/ 03779000
*              /*                                            @YL026UK*/ 03780000
*              /* BUILD DDNAME RETURN TEXT UNIT AND INSERT   @YL026UK*/ 03781000
*              /* ITS ADDR IN CORRESPONDING ENTRY OF TEXT    @YL026UK*/ 03782000
*              /* UNIT POINTER LIST                          @YL026UK*/ 03783000
*              /*                                            @YL026UK*/ 03784000
*              /******************************************************/ 03785000
*                                                                  1003 03786000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));    /*@YL026UK*/ 03787000
*              S99TUKEY = DALRTDDN;                        /*@YL026UK*/ 03788000
         LA    @14,TEXTDDN                                         1004 03789000
         MVC   S99TUKEY(2,@14),@CB01581                            1004 03790000
*              S99TUNUM = 1;                               /*@YL026UK*/ 03791000
         LA    @07,1                                               1005 03792000
         STCM  @07,3,S99TUNUM(@14)                                 1005 03793000
*              S99TULNG = 8;                               /*@YL026UK*/ 03794000
         MVC   S99TULNG(2,@14),@CH00175                            1006 03795000
*              S99TUPTR(2) = ADDR(TEXTDDN);                /*@YL026UK*/ 03796000
*                                                                  1007 03797000
         LA    @06,TUPL                                            1007 03798000
         ST    @14,S99TUPTR+4(,@06)                                1007 03799000
*              /******************************************************/ 03800000
*              /*                                            @YL026UK*/ 03801000
*              /* BUILD STATUS TEXT UNIT OF OLD AND INSERT   @YL026UK*/ 03802000
*              /* ITS ADDR IN CORRESPONDING ENTRY OF TEXT    @YL026UK*/ 03803000
*              /* UNIT POINTER LIST                          @YL026UK*/ 03804000
*              /*                                            @YL026UK*/ 03805000
*              /******************************************************/ 03806000
*                                                                  1008 03807000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTSTS));    /*@YL026UK*/ 03808000
*              S99TUKEY = DALSTATS;                        /*@YL026UK*/ 03809000
         LA    @14,TEXTSTS                                         1009 03810000
         MVC   S99TUKEY(2,@14),@CB01419                            1009 03811000
*              S99TUNUM = 1;                               /*@YL026UK*/ 03812000
         STCM  @07,3,S99TUNUM(@14)                                 1010 03813000
*              S99TULNG = 1;                               /*@YL026UK*/ 03814000
         STCM  @07,3,S99TULNG(@14)                                 1011 03815000
*              S99TUPAR(1) = '01'X;                        /*@YL026UK*/ 03816000
         MVI   S99TUPAR(@14),X'01'                                 1012 03817000
*              S99TUPTR(4) = ADDR(TEXTSTS);                /*@YL026UK*/ 03818000
*                                                                  1013 03819000
         ST    @14,S99TUPTR+12(,@06)                               1013 03820000
*              /******************************************************/ 03821000
*              /*                                            @YL026UK*/ 03822000
*              /* BUILD DISPOSITION TEXT UNIT OF KEEP AND    @YL026UK*/ 03823000
*              /* INSERT ITS ADDR IN CORRESPONDING ENTRY OF  @YL026UK*/ 03824000
*              /* TEXT UNIT POINTER LIST                     @YL026UK*/ 03825000
*              /*                                            @YL026UK*/ 03826000
*              /******************************************************/ 03827000
*                                                                  1014 03828000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSP));    /*@YL026UK*/ 03829000
*              S99TUKEY = DALNDISP;                        /*@YL026UK*/ 03830000
         LA    @14,TEXTDSP                                         1015 03831000
         MVC   S99TUKEY(2,@14),@CB01421                            1015 03832000
*              S99TUNUM = 1;                               /*@YL026UK*/ 03833000
         STCM  @07,3,S99TUNUM(@14)                                 1016 03834000
*              S99TULNG = 1;                               /*@YL026UK*/ 03835000
         STCM  @07,3,S99TULNG(@14)                                 1017 03836000
*              S99TUPAR(1) = '08'X;                        /*@YL026UK*/ 03837000
         MVI   S99TUPAR(@14),X'08'                                 1018 03838000
*              S99TUPTR(5) = ADDR(TEXTDSP);                /*@YL026UK*/ 03839000
*                                                                  1019 03840000
         ST    @14,S99TUPTR+16(,@06)                               1019 03841000
*              /******************************************************/ 03842000
*              /*                                            @Y30LSMK*/ 03843000
*              /* IF REQUEST IS FOR THE PRIVATE VOLUME USE   @Y30LSMK*/ 03844000
*              /* ATTRIBUTE, BUILD THE PRIVATE VOLUME TEXT   @Y30LSMK*/ 03845000
*              /* UNIT AND INSERT ITS ADDR IN CORRESPONDING  @Y30LSMK*/ 03846000
*              /* ENTRY IN TEXT UNIT POINTER LIST.           @Y30LSMK*/ 03847000
*              /*                                            @Y30LSMK*/ 03848000
*              /******************************************************/ 03849000
*                                                                  1020 03850000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTPRI));    /*@Y30LSMK*/ 03851000
*              IF ALLOPTPV = ON                                    1021 03852000
*               THEN                                               1021 03853000
         TM    ALLOPTPV(@15),B'00100000'                           1021 03854000
         BNO   @RF01021                                            1021 03855000
*                 DO;                                      /*@Y30LSMK*/ 03856000
*                   S99TUKEY = DALPRIVT;                   /*@Y30LSMK*/ 03857000
         LA    @07,TEXTPRI                                         1023 03858000
         MVC   S99TUKEY(2,@07),@CB01445                            1023 03859000
*                   S99TUNUM = 0;                          /*@Y30LSMK*/ 03860000
         SLR   @15,@15                                             1024 03861000
         STCM  @15,3,S99TUNUM(@07)                                 1024 03862000
*                   S99TUPTR(6) = ADDR(TEXTPRI);           /*@Y30LSMK*/ 03863000
         ST    @07,S99TUPTR+20(,@06)                               1025 03864000
*                 END;                                     /*@Y30LSMK*/ 03865000
*                                                                  1026 03866000
*              /******************************************************/ 03867000
*              /*                                            @YL026UK*/ 03868000
*              /* GET CORE FOR DDNAME DYNAMIC ALLOCATION     @YL026UK*/ 03869000
*              /* TEXT UNIT FOR CONCATENATION IF MORE THAN   @YL026UK*/ 03870000
*              /* ONE UNIT IS IN THE UNIT DESCRIPTOR LIST    @YL026UK*/ 03871000
*              /*                                            @YL026UK*/ 03872000
*              /******************************************************/ 03873000
*                                                                  1027 03874000
*              IF UNTCNT > 1                                       1027 03875000
*                THEN                                              1027 03876000
*                                                                  1027 03877000
@RF01021 L     @01,PARMPTR2                                        1027 03878000
         L     @01,ALLULP(,@01)                                    1027 03879000
         LH    @15,UNTCNT(,@01)                                    1027 03880000
         C     @15,@CF00215                                        1027 03881000
         BNH   @RF01027                                            1027 03882000
*                  /**************************************************/ 03883000
*                  /*                                        @YL026UK*/ 03884000
*                  /* MORE THAN ONE UNIT IN THE UNIT         @YL026UK*/ 03885000
*                  /* DESCRIPTOR LIST                        @YL026UK*/ 03886000
*                  /*                                        @YL026UK*/ 03887000
*                  /**************************************************/ 03888000
*                                                                  1028 03889000
*                  DO;                                     /*@YL026UK*/ 03890000
*                    DDLISTSZ = (10 * UNTCNT) + 4;         /*@YL026UK*/ 03891000
         MH    @15,@CH00033                                        1029 03892000
         AL    @15,@CF00038                                        1029 03893000
         ST    @15,DDLISTSZ                                        1029 03894000
*                    CALL IDCSAGS0(GDTTBL,DDLISTSZ,DDLISTPT);/*    1030 03895000
*                                                            @YL026UK*/ 03896000
*                                                                  1030 03897000
         ST    GDTPR,@AL00001                                      1030 03898000
         LA    @15,DDLISTSZ                                        1030 03899000
         ST    @15,@AL00001+4                                      1030 03900000
         LA    @15,DDLISTPT                                        1030 03901000
         ST    @15,@AL00001+8                                      1030 03902000
         MVI   @AL00001+8,X'80'                                    1030 03903000
         L     @15,GDTGSP(,GDTPR)                                  1030 03904000
         LA    @01,@AL00001                                        1030 03905000
         BALR  @14,@15                                             1030 03906000
*                    /************************************************/ 03907000
*                    /*                                      @YL026UK*/ 03908000
*                    /* CHECK RETURN CODE FROM UGSPACE AND   @YL026UK*/ 03909000
*                    /* UABORT IF UGSPACE FAILED             @YL026UK*/ 03910000
*                    /*                                      @YL026UK*/ 03911000
*                    /************************************************/ 03912000
*                                                                  1031 03913000
*                    RESPECIFY (REG15) RSTD;               /*@YL026UK*/ 03914000
*                    IF REG15 ^= 0                                 1032 03915000
*                      THEN                                        1032 03916000
*                                                                  1032 03917000
         LTR   REG15,REG15                                         1032 03918000
         BZ    @RF01032                                            1032 03919000
*                        DO;                                       1033 03920000
*                          RESPECIFY(REG13,REG14,REG15) RSTD;      1034 03921000
*                          REG15 = NOSPACE;                        1035 03922000
         LA    REG15,28                                            1035 03923000
*                          REG14 = GDTABT;                         1036 03924000
         L     REG14,GDTABT(,GDTPR)                                1036 03925000
*                          REG13 = GDTABH;                         1037 03926000
         L     REG13,GDTABH(,GDTPR)                                1037 03927000
*                          GEN(BR    REG14);                       1038 03928000
         BR    REG14                                                    03929000
*                          RESPECIFY(REG13,REG14,REG15)UNRSTD;     1039 03930000
*                        END;                  /*@YL026UK*/        1040 03931000
*                    RESPECIFY (REG15) UNRSTD;             /*@YL026UK*/ 03932000
@RF01032 DS    0H                                                  1042 03933000
*                  END;                                    /*@YL026UK*/ 03934000
*                                                                  1042 03935000
*              /******************************************************/ 03936000
*              /*                                            @Y30LSMK*/ 03937000
*              /* IF A UNIT AND VOLUME COUNT HAVE BEEN       @Y30LSMK*/ 03938000
*              /* REQUESTED, SAVE THE UNIT AND VOLUME COUNTS @Y30LSMK*/ 03939000
*              /* TO BE USED IN THE LAST CALL TO DYNAMIC     @Y30LSMK*/ 03940000
*              /* ALLOCATION.                                @Y30LSMK*/ 03941000
*              /*                                            @Y30LSMK*/ 03942000
*              /******************************************************/ 03943000
*                                                                  1043 03944000
*              IF ALLUNCNT ^= 0                                    1043 03945000
*                THEN                                              1043 03946000
@RF01027 L     @15,PARMPTR2                                        1043 03947000
         CLI   ALLUNCNT(@15),0                                     1043 03948000
         BE    @RF01043                                            1043 03949000
*                  DO;                                     /*@Y30LSMK*/ 03950000
*                    UNTCOUNT = ALLUNCNT;                  /*@Y30LSMK*/ 03951000
         IC    @14,ALLUNCNT(,@15)                                  1045 03952000
         STC   @14,UNTCOUNT                                        1045 03953000
*                    VOLCOUNT = ALLVLCNT;                  /*@Y30LSMK*/ 03954000
         IC    @14,ALLVLCNT(,@15)                                  1046 03955000
         STC   @14,VOLCOUNT                                        1046 03956000
*                  END;                                    /*@Y30LSMK*/ 03957000
*                                                                  1047 03958000
*              /******************************************************/ 03959000
*              /*                                            @YL026UK*/ 03960000
*              /* FOR EACH UNIT IN THE UNIT DESCRIPTOR LIST, @YL026UK*/ 03961000
*              /* REQUEST THAT THE CORRESPONDING VOLUME(S)   @YL026UK*/ 03962000
*              /* (BY THEIR VOLUME SERIAL NUMBERS) BE        @YL026UK*/ 03963000
*              /* MOUNTED                                    @YL026UK*/ 03964000
*              /*                                            @YL026UK*/ 03965000
*              /******************************************************/ 03966000
*                                                                  1048 03967000
*MOUNTDO:      DO I = 1 TO UNTCNT;                         /*@YL026UK*/ 03968000
*                                                                  1048 03969000
@RF01043 DS    0H                                                  1048 03970000
MOUNTDO  LA    @15,1                                               1048 03971000
         B     @DE01048                                            1048 03972000
@DL01048 DS    0H                                                  1049 03973000
*                /****************************************************/ 03974000
*                /*                                          @Y30LSMK*/ 03975000
*                /* IF THE UNIT AND VOLUME COUNTS WERE       @Y30LSMK*/ 03976000
*                /* REQUESTED, DECREMENT BOTH COUNTS ON EACH @Y30LSMK*/ 03977000
*                /* CALL TO DYNAMIC ALLOCATION.              @Y30LSMK*/ 03978000
*                /*                                          @Y30LSMK*/ 03979000
*                /****************************************************/ 03980000
*                                                                  1049 03981000
*                IF ALLUNCNT ^= 0  &  I ^= UNTCNT                  1049 03982000
*                  THEN                                            1049 03983000
         L     @14,PARMPTR2                                        1049 03984000
         CLI   ALLUNCNT(@14),0                                     1049 03985000
         BE    @RF01049                                            1049 03986000
         L     @01,ALLULP(,@14)                                    1049 03987000
         CH    @15,UNTCNT(,@01)                                    1049 03988000
         BE    @RF01049                                            1049 03989000
*                    DO;                                   /*@Y30LSMK*/ 03990000
*                      UNTCOUNT = UNTCOUNT - 1;            /*@Y30LSMK*/ 03991000
         SLR   @15,@15                                             1051 03992000
         IC    @15,UNTCOUNT                                        1051 03993000
         BCTR  @15,0                                               1051 03994000
         STC   @15,UNTCOUNT                                        1051 03995000
*                      VOLCOUNT = VOLCOUNT - 1;            /*@Y30LSMK*/ 03996000
         SLR   @15,@15                                             1052 03997000
         IC    @15,VOLCOUNT                                        1052 03998000
         BCTR  @15,0                                               1052 03999000
         STC   @15,VOLCOUNT                                        1052 04000000
*                    END;                                  /*@Y30LSMK*/ 04001000
*                                                                  1053 04002000
*                /****************************************************/ 04003000
*                /*                                          @YL026UK*/ 04004000
*                /* BUILD UNIT DESCRIPTOR TEXT UNIT AND      @YL026UK*/ 04005000
*                /* INSERT ITS ADDR IN CORRESPONDING ENTRY   @YL026UK*/ 04006000
*                /* OF TEXT UNIT POINTER LIST                @YL026UK*/ 04007000
*                /*                                          @YL026UK*/ 04008000
*                /****************************************************/ 04009000
*                                                                  1054 04010000
*                RESPECIFY S99TUNIT BASED(ADDR(TEXTUNT));  /*@YL026UK*/ 04011000
@RF01049 DS    0H                                                  1055 04012000
*                S99TUKEY = DALUNIT;                       /*@YL026UK*/ 04013000
         LA    @15,TEXTUNT                                         1055 04014000
         MVC   S99TUKEY(2,@15),@CB01453                            1055 04015000
*                S99TUNUM = 1;                             /*@YL026UK*/ 04016000
         MVC   S99TUNUM(2,@15),@CH00215                            1056 04017000
*                S99TULNG = UNTLEN(I);                     /*@YL026UK*/ 04018000
         LH    @14,I                                               1057 04019000
         LR    @07,@14                                             1057 04020000
         MH    @07,@CH00033                                        1057 04021000
         L     @06,PARMPTR2                                        1057 04022000
         L     @05,ALLULP(,@06)                                    1057 04023000
         ST    @07,@TF00001                                        1057 04024000
         ALR   @07,@05                                             1057 04025000
         AL    @07,@CF02460                                        1057 04026000
         ICM   @07,12,UNTLEN-2(@07)                                1057 04027000
         SRA   @07,16                                              1057 04028000
         STCM  @07,3,S99TULNG(@15)                                 1057 04029000
*                S99TUPAR(1:S99TULNG) = UNTVAL(I,1:S99TULNG);      1058 04030000
         BCTR  @07,0                                               1058 04031000
         LR    @04,@05                                             1058 04032000
         AL    @04,@TF00001                                        1058 04033000
         AL    @04,@CF02466                                        1058 04034000
         EX    @07,@SM02467                                        1058 04035000
*                S99TUPTR(7) = ADDR(TEXTUNT);              /*@YL026UK*/ 04036000
*                                                                  1059 04037000
         LA    @07,TUPL                                            1059 04038000
         ST    @15,S99TUPTR+24(,@07)                               1059 04039000
*                /****************************************************/ 04040000
*                /****************************************************/ 04041000
*                /*                                          @YL026UK*/ 04042000
*                /* BUILD VOLSER DESCRIPTOR TEXT UNIT AND    @YL026UK*/ 04043000
*                /* INSERT ITS ADDR IN CORRESPONDING ENTRY   @YL026UK*/ 04044000
*                /* OF TEXT UNIT POINTER LIST                @YL026UK*/ 04045000
*                /*                                          @YL026UK*/ 04046000
*                /****************************************************/ 04047000
*                /****************************************************/ 04048000
*                                                                  1060 04049000
*                /****************************************************/ 04050000
*                /*                                          @YL026UK*/ 04051000
*                /* CHECK FOR MORE THAN ONE VOLSER ENTRY TO  @YL026UK*/ 04052000
*                /* BE BUILT IN THE VOLSER DESCRIPTOR TEXT   @YL026UK*/ 04053000
*                /* UNIT                                     @YL026UK*/ 04054000
*                /*                                          @YL026UK*/ 04055000
*                /****************************************************/ 04056000
*                                                                  1060 04057000
*                IF (I = UNTCNT & VOLCNT > UNTCNT)  |              1060 04058000
*                  (I = UNTCNT  &  (ALLUNCNT > UNTCNT  |           1060 04059000
*                  ALLVLCNT > VOLCNT))                             1060 04060000
*                  THEN                                            1060 04061000
*                                                                  1060 04062000
         LH    @15,UNTCNT(,@05)                                    1060 04063000
         CR    @14,@15                                             1060 04064000
         BNE   @GL00014                                            1060 04065000
         L     @01,ALLVLP(,@06)                                    1060 04066000
         CH    @15,VOLCNT(,@01)                                    1060 04067000
         BL    @RT01060                                            1060 04068000
@GL00014 L     @15,PARMPTR2                                        1060 04069000
         L     @01,ALLULP(,@15)                                    1060 04070000
         LH    @14,UNTCNT(,@01)                                    1060 04071000
         CH    @14,I                                               1060 04072000
         BNE   @RF01060                                            1060 04073000
         SLR   @07,@07                                             1060 04074000
         IC    @07,ALLUNCNT(,@15)                                  1060 04075000
         CR    @14,@07                                             1060 04076000
         BL    @RT01060                                            1060 04077000
         L     @01,ALLVLP(,@15)                                    1060 04078000
         SLR   @14,@14                                             1060 04079000
         IC    @14,ALLVLCNT(,@15)                                  1060 04080000
         CH    @14,VOLCNT(,@01)                                    1060 04081000
         BNH   @RF01060                                            1060 04082000
@RT01060 DS    0H                                                  1061 04083000
*                    /************************************************/ 04084000
*                    /*                                      @YL026UK*/ 04085000
*                    /* MORE THAN ONE VOLSER ENTRY TO BE     @YL026UK*/ 04086000
*                    /* BUILT IN THE VOLSER DESCRIPTOR TEXT  @YL026UK*/ 04087000
*                    /* UNIT                                 @YL026UK*/ 04088000
*                    /*                                      @YL026UK*/ 04089000
*                    /************************************************/ 04090000
*                                                                  1061 04091000
*                    DO;                                   /*@YL026UK*/ 04092000
*                                                                  1061 04093000
*                        /********************************************/ 04094000
*                        /*                                  @YL026UK*/ 04095000
*                        /* GET CORE FOR MULTIPLE VOLSER     @YL026UK*/ 04096000
*                        /* TEXT UNIT                        @YL026UK*/ 04097000
*                        /*                                  @YL026UK*/ 04098000
*                        /********************************************/ 04099000
*                                                                  1062 04100000
*                        TEXTVOLS = (VOLCNT - UNTCNT + 1) * 8 + 4; 1062 04101000
         L     @15,PARMPTR2                                        1062 04102000
         L     @01,ALLVLP(,@15)                                    1062 04103000
         L     @15,ALLULP(,@15)                                    1062 04104000
         LH    @14,VOLCNT(,@01)                                    1062 04105000
         SH    @14,UNTCNT(,@15)                                    1062 04106000
         AL    @14,@CF00215                                        1062 04107000
         SLA   @14,3                                               1062 04108000
         AL    @14,@CF00038                                        1062 04109000
         ST    @14,TEXTVOLS                                        1062 04110000
*                        CALL IDCSAGS0(GDTTBL,TEXTVOLS,TEXTVOLP);/*     04111000
*                                                            @YL026UK*/ 04112000
*                                                                  1063 04113000
         ST    GDTPR,@AL00001                                      1063 04114000
         LA    @15,TEXTVOLS                                        1063 04115000
         ST    @15,@AL00001+4                                      1063 04116000
         LA    @15,TEXTVOLP                                        1063 04117000
         ST    @15,@AL00001+8                                      1063 04118000
         MVI   @AL00001+8,X'80'                                    1063 04119000
         L     @15,GDTGSP(,GDTPR)                                  1063 04120000
         LA    @01,@AL00001                                        1063 04121000
         BALR  @14,@15                                             1063 04122000
*                        /********************************************/ 04123000
*                        /*                                  @YL026UK*/ 04124000
*                        /* CHECK RETURN CODE FROM UGSPACE   @YL026UK*/ 04125000
*                        /* AND UABORT IF UGSPACE FAILED     @YL026UK*/ 04126000
*                        /*                                  @YL026UK*/ 04127000
*                        /********************************************/ 04128000
*                                                                  1064 04129000
*                        RESPECIFY (REG15) RSTD;           /*@YL026UK*/ 04130000
*                        IF REG15 ^= 0                             1065 04131000
*                          THEN                                    1065 04132000
*                                                                  1065 04133000
         LTR   REG15,REG15                                         1065 04134000
         BZ    @RF01065                                            1065 04135000
*                            DO;                                   1066 04136000
*                              RESPECIFY(REG13,REG14,REG15) RSTD;  1067 04137000
*                              REG15 = NOSPACE;                    1068 04138000
         LA    REG15,28                                            1068 04139000
*                              REG14 = GDTABT;                     1069 04140000
         L     REG14,GDTABT(,GDTPR)                                1069 04141000
*                              REG13 = GDTABH;                     1070 04142000
         L     REG13,GDTABH(,GDTPR)                                1070 04143000
*                              GEN(BR    REG14);                   1071 04144000
         BR    REG14                                                    04145000
*                              RESPECIFY(REG13,REG14,REG15)UNRSTD; 1072 04146000
*                            END;              /*@YL026UK*/        1073 04147000
*                        RESPECIFY (REG15) UNRSTD;         /*@YL026UK*/ 04148000
*                                                                  1074 04149000
@RF01065 DS    0H                                                  1075 04150000
*                        /********************************************/ 04151000
*                        /********************************************/ 04152000
*                        /*                                  @YL026UK*/ 04153000
*                        /* BUILD VOLSER TEXT UNIT, INSERT   @YL026UK*/ 04154000
*                        /* ITS ADDR IN THE CORRESPONDING    @YL026UK*/ 04155000
*                        /* ENTRY OF THE TEXT UNIT POINTER   @YL026UK*/ 04156000
*                        /* LIST, AND TURN THE HIGH ORDER    @YL026UK*/ 04157000
*                        /* BIT OF THIS ADDR ON              @YL026UK*/ 04158000
*                        /*                                  @YL026UK*/ 04159000
*                        /********************************************/ 04160000
*                        /********************************************/ 04161000
*                                                                  1075 04162000
*                                                                  1075 04163000
*                        RESPECIFY S99TUNIT BASED(TEXTVOLP);       1075 04164000
*                        S99TUKEY = DALVLSER;              /*@YL026UK*/ 04165000
         L     @15,TEXTVOLP                                        1076 04166000
         MVC   S99TUKEY(2,@15),@CB01443                            1076 04167000
*                        S99TUNUM = VOLCNT - UNTCNT + 1;   /*@YL026UK*/ 04168000
         L     @14,PARMPTR2                                        1077 04169000
         L     @01,ALLVLP(,@14)                                    1077 04170000
         L     @14,ALLULP(,@14)                                    1077 04171000
         LH    @07,VOLCNT(,@01)                                    1077 04172000
         SH    @07,UNTCNT(,@14)                                    1077 04173000
         AL    @07,@CF00215                                        1077 04174000
         STCM  @07,3,S99TUNUM(@15)                                 1077 04175000
*                        S99TUFP = TEXTVOLP + 4;           /*@YL026UK*/ 04176000
*                                                                  1078 04177000
         AL    @15,@CF00038                                        1078 04178000
         ST    @15,S99TUFP                                         1078 04179000
*                        /********************************************/ 04180000
*                        /*                                  @YL026UK*/ 04181000
*                        /* DO LOOP FOR VOLSER'S             @YL026UK*/ 04182000
*                        /*                                  @YL026UK*/ 04183000
*                        /********************************************/ 04184000
*                                                                  1079 04185000
*SERDO:                  DO J = I TO VOLCNT;               /*@YL026UK*/ 04186000
SERDO    LH    @15,I                                               1079 04187000
         B     @DE01079                                            1079 04188000
@DL01079 DS    0H                                                  1080 04189000
*                          S99TULEN = VOLLEN(J);           /*@YL026UK*/ 04190000
         L     @14,S99TUFP                                         1080 04191000
         LR    @07,@15                                             1080 04192000
         SLA   @07,3                                               1080 04193000
         L     @01,PARMPTR2                                        1080 04194000
         L     @06,ALLVLP(,@01)                                    1080 04195000
         ST    @07,@TF00001                                        1080 04196000
         ALR   @07,@06                                             1080 04197000
         AL    @07,@CF02466                                        1080 04198000
         ICM   @07,12,VOLLEN-2(@07)                                1080 04199000
         SRA   @07,16                                              1080 04200000
         STCM  @07,3,S99TULEN(@14)                                 1080 04201000
*                          S99TUPRM(1:S99TULEN) =                  1081 04202000
*                            VOLVAL(J,1:S99TULEN);         /*@YL026UK*/ 04203000
         LR    @05,@07                                             1081 04204000
         BCTR  @05,0                                               1081 04205000
         AL    @06,@TF00001                                        1081 04206000
         AL    @06,@CF02469                                        1081 04207000
         EX    @05,@SM02470                                        1081 04208000
*                          S99TUFP = S99TUFP + S99TULEN            1082 04209000
*                            + 2;                          /*@YL026UK*/ 04210000
         ALR   @14,@07                                             1082 04211000
         AL    @14,@CF00149                                        1082 04212000
         ST    @14,S99TUFP                                         1082 04213000
*                        END SERDO;                        /*@YL026UK*/ 04214000
*                                                                  1083 04215000
         AL    @15,@CF00215                                        1083 04216000
@DE01079 STH   @15,J                                               1083 04217000
         L     @14,PARMPTR2                                        1083 04218000
         L     @14,ALLVLP(,@14)                                    1083 04219000
         CH    @15,VOLCNT(,@14)                                    1083 04220000
         BNH   @DL01079                                            1083 04221000
*                        S99TUPTR(8) = TEXTVOLP;           /*@YL026UK*/ 04222000
         LA    @15,TUPL                                            1084 04223000
         L     @14,TEXTVOLP                                        1084 04224000
         ST    @14,S99TUPTR+28(,@15)                               1084 04225000
*                        S99TUPLN(8) = ON;                 /*@YL026UK*/ 04226000
*                                                                  1085 04227000
         OI    S99TUPLN+28(@15),B'10000000'                        1085 04228000
*                        /********************************************/ 04229000
*                        /*                                  @Y30LSMK*/ 04230000
*                        /* IF THE UNIT COUNT IS GREATER     @Y30LSMK*/ 04231000
*                        /* THAN THE UNIT COUNT IN THE UNIT  @Y30LSMK*/ 04232000
*                        /* LIST, OR THE VOLUME COUNT        @Y30LSMK*/ 04233000
*                        /* GREATER THAN THE VOLUME          @Y30LSMK*/ 04234000
*                        /* COUNT IN THE VOLUME              @Y30LSMK*/ 04235000
*                        /* LIST, BUILD THE UNIT COUNT TEXT  @Y30LSMK*/ 04236000
*                        /* UNIT AND VOLUME COUNT TEXT UNIT  @Y30LSMK*/ 04237000
*                        /* AND INSERT THEIR ADDRS IN THE    @Y30LSMK*/ 04238000
*                        /* CORRESPONDING ENTRY IN THE TEXT  @Y30LSMK*/ 04239000
*                        /* UNIT POINTER LIST.               @Y30LSMK*/ 04240000
*                        /*                                  @Y30LSMK*/ 04241000
*                        /********************************************/ 04242000
*                                                                  1086 04243000
*                        IF ALLUNCNT > UNTCNT  |  ALLVLCNT > VOLCNT     04244000
*                          THEN                                    1086 04245000
         L     @15,PARMPTR2                                        1086 04246000
         L     @01,ALLULP(,@15)                                    1086 04247000
         SLR   @14,@14                                             1086 04248000
         IC    @14,ALLUNCNT(,@15)                                  1086 04249000
         CH    @14,UNTCNT(,@01)                                    1086 04250000
         BH    @RT01086                                            1086 04251000
         L     @01,ALLVLP(,@15)                                    1086 04252000
         SLR   @14,@14                                             1086 04253000
         IC    @14,ALLVLCNT(,@15)                                  1086 04254000
         CH    @14,VOLCNT(,@01)                                    1086 04255000
         BNH   @RF01086                                            1086 04256000
@RT01086 DS    0H                                                  1087 04257000
*                            DO;                           /*@Y30LSMK*/ 04258000
*                              RESPECIFY S99TUNIT BASED(ADDR(TEXTUCNT)) 04259000
*                              S99TUKEY = DALUNCNT;        /*@Y30LSMK*/ 04260000
         LA    @15,TEXTUCNT                                        1089 04261000
         MVC   S99TUKEY(2,@15),@CB01455                            1089 04262000
*                              S99TUNUM = 1;               /*@Y30LSMK*/ 04263000
         LA    @14,1                                               1090 04264000
         STCM  @14,3,S99TUNUM(@15)                                 1090 04265000
*                              S99TULNG = 1;               /*@Y30LSMK*/ 04266000
         STCM  @14,3,S99TULNG(@15)                                 1091 04267000
*                              S99TUPAR(1:1) = UNITCNT;    /*@Y30LSMK*/ 04268000
         MVC   S99TUPAR(1,@15),UNITCNT                             1092 04269000
*                              S99TUPTR(1) = ADDR(TEXTUCNT);       1093 04270000
*                                                                  1093 04271000
         LA    @07,TUPL                                            1093 04272000
         ST    @15,S99TUPTR(,@07)                                  1093 04273000
*                              RESPECIFY S99TUNIT BASED(ADDR(TEXTVCNT)) 04274000
*                              S99TUKEY = DALVLCNT;        /*@Y30LSMK*/ 04275000
         LA    @15,TEXTVCNT                                        1095 04276000
         MVC   S99TUKEY(2,@15),@CB01449                            1095 04277000
*                              S99TUNUM = 1;               /*@Y30LSMK*/ 04278000
         STCM  @14,3,S99TUNUM(@15)                                 1096 04279000
*                              S99TULNG = 1;               /*@Y30LSMK*/ 04280000
         STCM  @14,3,S99TULNG(@15)                                 1097 04281000
*                              S99TUPAR(1:1) = VOLUMCNT;   /*@Y30LSMK*/ 04282000
         MVC   S99TUPAR(1,@15),VOLUMCNT                            1098 04283000
*                              S99TUPTR(3) = ADDR(TEXTVCNT);       1099 04284000
         ST    @15,S99TUPTR+8(,@07)                                1099 04285000
*                            END;                          /*@Y30LSMK*/ 04286000
*                                                                  1100 04287000
*                    END;                                  /*#YL026UK*/ 04288000
*                  ELSE                                            1102 04289000
*                                                                  1102 04290000
*                    /************************************************/ 04291000
*                    /*                                      #YL026UK*/ 04292000
*                    /* ONLY ONE VOLSER ENTRY TO BE BUILT    #YL026UK*/ 04293000
*                    /* IN THE VOLUME DESCRIPTOR TEXT UNIT   #YL026UK*/ 04294000
*                    /*                                      #YL026UK*/ 04295000
*                    /************************************************/ 04296000
*                                                                  1102 04297000
*                    DO;                                   /*#YL026UK*/ 04298000
*                                                                  1102 04299000
         B     @RC01060                                            1102 04300000
@RF01060 DS    0H                                                  1103 04301000
*                      /**********************************************/ 04302000
*                      /*                                    #YL026UK*/ 04303000
*                      /* BUILD VOLSER TEXT UNIT, INSERT     #YL026UK*/ 04304000
*                      /* ITS ADDR IN THE CORRESPONDING      #YL026UK*/ 04305000
*                      /* ENTRY OF THE TEXT UNIT POINTER     #YL026UK*/ 04306000
*                      /* LIST, AND TURN THE HIGH ORDER      #YL026UK*/ 04307000
*                      /* BIT OF THIS ADDR ON                #YL026UK*/ 04308000
*                      /*                                    #YL026UK*/ 04309000
*                      /**********************************************/ 04310000
*                                                                  1103 04311000
*                      RESPECIFY S99TUNIT BASED(ADDR(TEXTVOL));    1103 04312000
*                      S99TUKEY = DALVLSER;                /*#YL026UK*/ 04313000
         LA    @15,TEXTVOL                                         1104 04314000
         MVC   S99TUKEY(2,@15),@CB01443                            1104 04315000
*                      S99TUNUM = 1;                       /*#YL026UK*/ 04316000
         MVC   S99TUNUM(2,@15),@CH00215                            1105 04317000
*                      S99TULNG = VOLLEN(I);               /*#YL026UK*/ 04318000
         LH    @14,I                                               1106 04319000
         SLA   @14,3                                               1106 04320000
         L     @01,PARMPTR2                                        1106 04321000
         L     @07,ALLVLP(,@01)                                    1106 04322000
         ST    @14,@TF00001                                        1106 04323000
         ALR   @14,@07                                             1106 04324000
         AL    @14,@CF02466                                        1106 04325000
         ICM   @14,12,VOLLEN-2(@14)                                1106 04326000
         SRA   @14,16                                              1106 04327000
         STCM  @14,3,S99TULNG(@15)                                 1106 04328000
*                      S99TUPAR(1:S99TULNG) = VOLVAL(I,1:S99TULNG);     04329000
         BCTR  @14,0                                               1107 04330000
         AL    @07,@TF00001                                        1107 04331000
         AL    @07,@CF02469                                        1107 04332000
         EX    @14,@SM02472                                        1107 04333000
*                      S99TUPTR(8) = ADDR(TEXTVOL);        /*#YL026UK*/ 04334000
         LA    @14,TUPL                                            1108 04335000
         ST    @15,S99TUPTR+28(,@14)                               1108 04336000
*                      S99TUPLN(8) = ON;                   /*#YL026UK*/ 04337000
         OI    S99TUPLN+28(@14),B'10000000'                        1109 04338000
*                    END;                                  /*#YL026UK*/ 04339000
*                                                                  1110 04340000
*                /****************************************************/ 04341000
*                /*                                          #YL026UK*/ 04342000
*                /* INITIALIZE THE REQUEST BLOCK             #YL026UK*/ 04343000
*                /*                                          #YL026UK*/ 04344000
*                /****************************************************/ 04345000
*                                                                  1111 04346000
*                S99RBLN = '14'X;                          /*#YL026UK*/ 04347000
@RC01060 MVI   S99RBLN,X'14'                                       1111 04348000
*                S99VERB = S99VRBAL;                       /*#YL026UK*/ 04349000
         MVI   S99VERB,X'01'                                       1112 04350000
*                S99TXTPP = ADDR(TUPL);                    /*#YL026UK*/ 04351000
*                                                                  1113 04352000
         LA    @15,TUPL                                            1113 04353000
         ST    @15,S99TXTPP                                        1113 04354000
*                /****************************************************/ 04355000
*                /*                                          #YL026UK*/ 04356000
*                /* INITIALIZE THE REQUEST BLOCK POINTER     #YL026UK*/ 04357000
*                /* WITH THE HIGH ORDER BIT TURNED ON        #YL026UK*/ 04358000
*                /*                                          #YL026UK*/ 04359000
*                /****************************************************/ 04360000
*                                                                  1114 04361000
*                S99RBPTR = ADDR(S99RB);                   /*#YL026UK*/ 04362000
         LA    @15,S99RB                                           1114 04363000
         ST    @15,S99RBPTR                                        1114 04364000
*                S99RBPND = ON;                            /*#YL026UK*/ 04365000
*                                                                  1115 04366000
         OI    S99RBPND,B'10000000'                                1115 04367000
*                /****************************************************/ 04368000
*                /*                                          #YL026UK*/ 04369000
*                /* LOAD REGISTER 1 WITH THE ADDR OF THE     #YL026UK*/ 04370000
*                /* REQUEST BLOCK POINTER AND ISSUE THE      #YL026UK*/ 04371000
*                /* DYNAMIC ALLOCATION REQUEST               #YL026UK*/ 04372000
*                /*                                          #YL026UK*/ 04373000
*                /****************************************************/ 04374000
*                                                                  1116 04375000
*                IF GDTDBG = NULLPTR                               1116 04376000
*                  THEN;                                           1116 04377000
         L     @15,GDTDBG(,GDTPR)                                  1116 04378000
         LTR   @15,@15                                             1116 04379000
         BZ    @RT01116                                            1116 04380000
*                  ELSE                                            1118 04381000
*                    CALL IDCDB010(GDTTBL,'ZZAL');                 1118 04382000
         ST    GDTPR,@AL00001                                      1118 04383000
         LA    @15,@CC02106                                        1118 04384000
         ST    @15,@AL00001+4                                      1118 04385000
         MVI   @AL00001+4,X'80'                                    1118 04386000
         L     @15,GDTDBG(,GDTPR)                                  1118 04387000
         LA    @01,@AL00001                                        1118 04388000
         BALR  @14,@15                                             1118 04389000
*                                                          /*#YL026UK*/ 04390000
*                RESPECIFY (REG1) RSTD;                    /*#YL026UK*/ 04391000
@RT01116 DS    0H                                                  1120 04392000
*                REG1 = ADDR(S99RBPTR);                    /*#YL026UK*/ 04393000
         LA    REG1,S99RBPTR                                       1120 04394000
*L99SVC1:        GEN(SVC   99);                            /*#YL026UK*/ 04395000
L99SVC1  SVC   99                                                       04396000
*                RESPECIFY (REG1) UNRSTD;                  /*#YL026UK*/ 04397000
*                                                                  1122 04398000
*                /****************************************************/ 04399000
*                /*                                          #YL026UK*/ 04400000
*                /* CHECK THE RETURN CODE FROM DYNAMIC       #YL026UK*/ 04401000
*                /* ALLOCATION                               #YL026UK*/ 04402000
*                /*                                          #YL026UK*/ 04403000
*                /****************************************************/ 04404000
*                                                                  1123 04405000
*                RESPECIFY (RTNREG) RSTD;                  /*#YL026UK*/ 04406000
*                RESPECIFY RTNREG RSTD;                            1124 04407000
*                TESTRC = RTNREG;                                  1125 04408000
         STH   RTNREG,TESTRC                                       1125 04409000
*                RESPECIFY RTNREG UNRSTD;                  /*#YL026UK*/ 04410000
*                RESPECIFY (RTNREG) UNRSTD;                /*#YL026UK*/ 04411000
*                IF GDTDBG = NULLPTR                               1128 04412000
*                  THEN;                                           1128 04413000
         L     @15,GDTDBG(,GDTPR)                                  1128 04414000
         LTR   @15,@15                                             1128 04415000
         BZ    @RT01128                                            1128 04416000
*                  ELSE                                            1130 04417000
*                    CALL IDCDB010(GDTTBL,'ZZAL');                 1130 04418000
         ST    GDTPR,@AL00001                                      1130 04419000
         LA    @15,@CC02106                                        1130 04420000
         ST    @15,@AL00001+4                                      1130 04421000
         MVI   @AL00001+4,X'80'                                    1130 04422000
         L     @15,GDTDBG(,GDTPR)                                  1130 04423000
         LA    @01,@AL00001                                        1130 04424000
         BALR  @14,@15                                             1130 04425000
*                                                          /*#YL026UK*/ 04426000
*                IF TESTRC = 0                                     1131 04427000
*                  THEN                                            1131 04428000
*                                                                  1131 04429000
@RT01128 LH    @15,TESTRC                                          1131 04430000
         LTR   @15,@15                                             1131 04431000
         BNZ   @RF01131                                            1131 04432000
*                    /************************************************/ 04433000
*                    /*                                      #YL026UK*/ 04434000
*                    /* DYNAMIC ALLOCATION WAS SUCCESSFUL    #YL026UK*/ 04435000
*                    /*                                      #YL026UK*/ 04436000
*                    /************************************************/ 04437000
*                                                                  1132 04438000
*                    DO;                                   /*#YL026UK*/ 04439000
*                                                                  1132 04440000
*                      /**********************************************/ 04441000
*                      /*                                    #YL026UK*/ 04442000
*                      /* IF MORE THAN ONE UNIT WAS IN THE   #YL026UK*/ 04443000
*                      /* UNIT DESCRIPTOR LIST, THEN MOVE    #YL026UK*/ 04444000
*                      /* THE DDNAME RETURNED BY DYNAMIC     #YL026UK*/ 04445000
*                      /* ALLOCATION TO THE DDNAME           #YL026UK*/ 04446000
*                      /* DYNAMIC ALLOCATION TEXT UNIT FOR   #YL026UK*/ 04447000
*                      /* CONCATENATION AND SET THE DDNAME   #YL026UK*/ 04448000
*                      /* LENGTH                             #YL026UK*/ 04449000
*                      /*                                    #YL026UK*/ 04450000
*                      /**********************************************/ 04451000
*                                                                  1133 04452000
*                      IF UNTCNT > 1                               1133 04453000
*                        THEN                                      1133 04454000
         L     @01,PARMPTR2                                        1133 04455000
         L     @01,ALLULP(,@01)                                    1133 04456000
         LH    @15,UNTCNT(,@01)                                    1133 04457000
         C     @15,@CF00215                                        1133 04458000
         BNH   @RF01133                                            1133 04459000
*                          DO;                             /*#YL026UK*/ 04460000
*                            RESPECIFY S99TUNIT                    1135 04461000
*                              BASED(ADDR(TEXTDDN));       /*#YL026UK*/ 04462000
*                            CONDDN(I) = S99TUPAR(1:8);    /*#YL026UK*/ 04463000
         L     @15,DDLISTPT                                        1136 04464000
         LH    @14,I                                               1136 04465000
         MH    @14,@CH00033                                        1136 04466000
         ST    @14,@TF00001                                        1136 04467000
         ALR   @14,@15                                             1136 04468000
         AL    @14,@CF02469                                        1136 04469000
         LA    @07,TEXTDDN                                         1136 04470000
         MVC   CONDDN-6(8,@14),S99TUPAR(@07)                       1136 04471000
*                            CONLN(I) = 8;                 /*#YL026UK*/ 04472000
         LA    @14,8                                               1137 04473000
         AL    @15,@TF00001                                        1137 04474000
         AL    @15,@CF02466                                        1137 04475000
         STCM  @14,3,CONLN-4(@15)                                  1137 04476000
*                          END;                            /*#YL026UK*/ 04477000
*                    END;                                  /*#YL026UK*/ 04478000
*                  ELSE                                            1140 04479000
*                                                                  1140 04480000
*                    /************************************************/ 04481000
*                    /*                                      @Z40GSBF*/ 04482000
*                    /* TEST FOR TSO IF IT IS THEN CALL UERROR     1140 04483000
*                    /* TO PRINT ERROR MESSAGES AND SET RETURN     1140 04484000
*                    /* CODE TO 4 AND RETURN TO CALLER             1140 04485000
*                    /*                                      @Z40GSBF*/ 04486000
*                    /************************************************/ 04487000
*                                                                  1140 04488000
*                    DO;                                   /*@Z40GSBF*/ 04489000
         B     @RC01131                                            1140 04490000
@RF01131 DS    0H                                                  1141 04491000
*                      ERCNVADR = ADDR(ERRORTAB);          /*@Z40GSBF*/ 04492000
         LA    @15,ERRORTAB                                        1141 04493000
         ST    @15,ERCNVADR                                        1141 04494000
*                      ERDARBPT = S99RBPTR;                /*@Z40GSBF*/ 04495000
         L     @14,S99RBPTR                                        1142 04496000
         ST    @14,ERDARBPT(,@15)                                  1142 04497000
*                      ERDYNAL = ON;                       /*@Z40GSBF*/ 04498000
         OI    ERDYNAL(@15),B'00100000'                            1143 04499000
*                      ERDYNRC = TESTRC;                   /*@Z40GSBF*/ 04500000
         LH    @14,TESTRC                                          1144 04501000
         ST    @14,ERDYNRC(,@15)                                   1144 04502000
*                      CALL IDCTPER0(GDTTBL,ERCNVADR);     /*@Z40GSBF*/ 04503000
         ST    GDTPR,@AL00001                                      1145 04504000
         LA    @15,ERCNVADR                                        1145 04505000
         ST    @15,@AL00001+4                                      1145 04506000
         MVI   @AL00001+4,X'80'                                    1145 04507000
         L     @15,GDTERR(,GDTPR)                                  1145 04508000
         LA    @01,@AL00001                                        1145 04509000
         BALR  @14,@15                                             1145 04510000
*                      SETRC = 4;                          /*#YL026UK*/ 04511000
         MVC   SETRC(2),@CH00038                                   1146 04512000
*                      CALL IDCSAEP0(GDTTBL,MODID,SETRC);          1147 04513000
         ST    GDTPR,@AL00001                                      1147 04514000
         LA    @15,MODID                                           1147 04515000
         ST    @15,@AL00001+4                                      1147 04516000
         LA    @15,SETRC                                           1147 04517000
         ST    @15,@AL00001+8                                      1147 04518000
         MVI   @AL00001+8,X'80'                                    1147 04519000
         L     @15,GDTEPL(,GDTPR)                                  1147 04520000
         LA    @01,@AL00001                                        1147 04521000
         BALR  @14,@15                                             1147 04522000
*        /*#YL026UK*/                                              1148 04523000
*                    END;                                  /*#YL026UK*/ 04524000
*              END MOUNTDO;                                /*#YL026UK*/ 04525000
*                                                                  1149 04526000
@RC01131 LA    @15,1                                               1149 04527000
         AH    @15,I                                               1149 04528000
@DE01048 STH   @15,I                                               1149 04529000
         L     @14,PARMPTR2                                        1149 04530000
         L     @14,ALLULP(,@14)                                    1149 04531000
         CH    @15,UNTCNT(,@14)                                    1149 04532000
         BNH   @DL01048                                            1149 04533000
*              /******************************************************/ 04534000
*              /*                                            #YL026UK*/ 04535000
*              /* FREE CORE FOR MULTIPLE VOLSER TEXT UNIT    #YL026UK*/ 04536000
*              /* IF MORE THAN ONE VOLSER ENTRY WAS BUILT    #YL026UK*/ 04537000
*              /* IN THE VOLSER DESCRIPTOR TEXT UNIT         #YL026UK*/ 04538000
*              /*                                            #YL026UK*/ 04539000
*              /******************************************************/ 04540000
*                                                                  1150 04541000
*              IF VOLCNT > UNTCNT  |  ALLUNCNT > UNTCNT  |         1150 04542000
*                ALLVLCNT > VOLCNT                                 1150 04543000
*                THEN                                              1150 04544000
         L     @15,PARMPTR2                                        1150 04545000
         L     @01,ALLVLP(,@15)                                    1150 04546000
         LH    @14,VOLCNT(,@01)                                    1150 04547000
         L     @01,ALLULP(,@15)                                    1150 04548000
         LH    @07,UNTCNT(,@01)                                    1150 04549000
         CR    @14,@07                                             1150 04550000
         BH    @RT01150                                            1150 04551000
         SLR   @06,@06                                             1150 04552000
         IC    @06,ALLUNCNT(,@15)                                  1150 04553000
         CR    @07,@06                                             1150 04554000
         BL    @RT01150                                            1150 04555000
         SLR   @07,@07                                             1150 04556000
         IC    @07,ALLVLCNT(,@15)                                  1150 04557000
         CR    @14,@07                                             1150 04558000
         BNL   @RF01150                                            1150 04559000
@RT01150 DS    0H                                                  1151 04560000
*                  CALL IDCSAFS0(GDTTBL,TEXTVOLP);         /*#YL026UK*/ 04561000
*                                                                  1151 04562000
         ST    GDTPR,@AL00001                                      1151 04563000
         LA    @15,TEXTVOLP                                        1151 04564000
         ST    @15,@AL00001+4                                      1151 04565000
         L     @15,GDTFSP(,GDTPR)                                  1151 04566000
         LA    @01,@AL00001                                        1151 04567000
         BALR  @14,@15                                             1151 04568000
*              /******************************************************/ 04569000
*              /*                                            #YL026UK*/ 04570000
*              /* CHECK IF PERMANENT CONCATENATION IS        #YL026UK*/ 04571000
*              /* REQUIRED--I.E., THERE IS MORE THAN ONE     #YL026UK*/ 04572000
*              /* UNIT IN THE UNIT DESCRIPTOR LIST           #YL026UK*/ 04573000
*              /*                                            #YL026UK*/ 04574000
*              /******************************************************/ 04575000
*                                                                  1152 04576000
*              IF UNTCNT > 1                                       1152 04577000
*                THEN                                              1152 04578000
*                                                                  1152 04579000
@RF01150 L     @01,PARMPTR2                                        1152 04580000
         L     @01,ALLULP(,@01)                                    1152 04581000
         LH    @15,UNTCNT(,@01)                                    1152 04582000
         C     @15,@CF00215                                        1152 04583000
         BNH   @RF01152                                            1152 04584000
*                  /**************************************************/ 04585000
*                  /*                                        #YL026UK*/ 04586000
*                  /* PERMANENT CONCATENATION IS REQUIRED    #YL026UK*/ 04587000
*                  /*                                        #YL026UK*/ 04588000
*                  /**************************************************/ 04589000
*                                                                  1153 04590000
*                  DO;                                     /*#YL026UK*/ 04591000
*                                                                  1153 04592000
*                    /************************************************/ 04593000
*                    /*                                      #YL026UK*/ 04594000
*                    /* BUILD DDNAME TEXT UNIT FOR           #YL026UK*/ 04595000
*                    /* CONCATENATION AND INSERT ITS ADDRESS #YL026UK*/ 04596000
*                    /* IN CORRESPONDING ENTRY OF TEXT UNIT  #YL026UK*/ 04597000
*                    /* POINTER LIST                         #YL026UK*/ 04598000
*                    /*                                      #YL026UK*/ 04599000
*                    /************************************************/ 04600000
*                                                                  1154 04601000
*                    CONKEY = DCCDDNAM;                    /*#YL026UK*/ 04602000
         L     @14,DDLISTPT                                        1154 04603000
         MVC   CONKEY(2,@14),@CB01413                              1154 04604000
*                    CONNUM = UNTCNT;                      /*#YL026UK*/ 04605000
         STH   @15,CONNUM(,@14)                                    1155 04606000
*                    S99TUPTR(1) = ADDR(TEXTCON);          /*#YL026UK*/ 04607000
*                                                                  1156 04608000
         LA    @15,TUPL                                            1156 04609000
         ST    @14,S99TUPTR(,@15)                                  1156 04610000
*                    /************************************************/ 04611000
*                    /*                                      #YL026UK*/ 04612000
*                    /* BUILD PERMANENT CONCATENATION TEXT   #YL026UK*/ 04613000
*                    /* UNIT FOR CONCATENATION, INSERT ITS   #YL026UK*/ 04614000
*                    /* ADDR IN CORRESPONDING ENTRY OF TEXT  #YL026UK*/ 04615000
*                    /* UNIT POINTER LIST, AND TURN ON THE   #YL026UK*/ 04616000
*                    /* HIGH ORDER BIT OF THIS ADDR          #YL026UK*/ 04617000
*                    /*                                      #YL026UK*/ 04618000
*                    /************************************************/ 04619000
*                                                                  1157 04620000
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTPER));      1157 04621000
*                    S99TUKEY = DCCPERMC;                  /*#YL026UK*/ 04622000
         LA    @14,TEXTPER                                         1158 04623000
         MVC   S99TUKEY(2,@14),@CB01419                            1158 04624000
*                    S99TUNUM = 0;                         /*#YL026UK*/ 04625000
         SLR   @07,@07                                             1159 04626000
         STCM  @07,3,S99TUNUM(@14)                                 1159 04627000
*                    S99TUPTR(2) = ADDR(TEXTPER);          /*#YL026UK*/ 04628000
         ST    @14,S99TUPTR+4(,@15)                                1160 04629000
*                    S99TUPLN(2) = ON;                     /*#YL026UK*/ 04630000
*                                                                  1161 04631000
         OI    S99TUPLN+4(@15),B'10000000'                         1161 04632000
*                    /************************************************/ 04633000
*                    /*                                      #YL026UK*/ 04634000
*                    /* INITIALIZE THE REQUEST BLOCK         #YL026UK*/ 04635000
*                    /*                                      #YL026UK*/ 04636000
*                    /************************************************/ 04637000
*                                                                  1162 04638000
*                    S99RBLN = '14'X;                      /*#YL026UK*/ 04639000
         MVI   S99RBLN,X'14'                                       1162 04640000
*                    S99VERB = S99VRBCC;                   /*#YL026UK*/ 04641000
         MVI   S99VERB,X'03'                                       1163 04642000
*                    S99TXTPP = ADDR(TUPL);                /*#YL026UK*/ 04643000
*                                                                  1164 04644000
         ST    @15,S99TXTPP                                        1164 04645000
*                    /************************************************/ 04646000
*                    /*                                      #YL026UK*/ 04647000
*                    /* INITIALIZE THE REQUEST BLOCK POINTER #YL026UK*/ 04648000
*                    /* WITH THE HIGH ORDER BIT TURNED ON    #YL026UK*/ 04649000
*                    /*                                      #YL026UK*/ 04650000
*                    /************************************************/ 04651000
*                                                                  1165 04652000
*                    S99RBPTR = ADDR(S99RB);               /*#YL026UK*/ 04653000
         LA    @06,S99RB                                           1165 04654000
         ST    @06,S99RBPTR                                        1165 04655000
*                    S99RBPND = ON;                        /*#YL026UK*/ 04656000
*                                                                  1166 04657000
         OI    S99RBPND,B'10000000'                                1166 04658000
*                    /************************************************/ 04659000
*                    /*                                      #YL026UK*/ 04660000
*                    /* LOAD REGISTER 1 WITH THE ADDR OF THE #YL026UK*/ 04661000
*                    /* REQUEST BLOCK POINTER AND ISSUE THE  #YL026UK*/ 04662000
*                    /* DYNAMIC ALLOCATION REQUEST           #YL026UK*/ 04663000
*                    /*                                      #YL026UK*/ 04664000
*                    /************************************************/ 04665000
*                                                                  1167 04666000
*                    IF GDTDBG = NULLPTR                           1167 04667000
*                      THEN;                                       1167 04668000
         C     @07,GDTDBG(,GDTPR)                                  1167 04669000
         BE    @RT01167                                            1167 04670000
*                      ELSE                                        1169 04671000
*                        CALL IDCDB010(GDTTBL,'ZZAL');             1169 04672000
         ST    GDTPR,@AL00001                                      1169 04673000
         LA    @15,@CC02106                                        1169 04674000
         ST    @15,@AL00001+4                                      1169 04675000
         MVI   @AL00001+4,X'80'                                    1169 04676000
         L     @15,GDTDBG(,GDTPR)                                  1169 04677000
         LA    @01,@AL00001                                        1169 04678000
         BALR  @14,@15                                             1169 04679000
*                                                          /*#YL026UK*/ 04680000
*                    RESPECIFY (REG1) RSTD;                /*#YL026UK*/ 04681000
@RT01167 DS    0H                                                  1171 04682000
*                    REG1 = ADDR(S99RBPTR);                /*#YL026UK*/ 04683000
         LA    REG1,S99RBPTR                                       1171 04684000
*L99SVC2:            GEN(SVC   99);                        /*#YL026UK*/ 04685000
L99SVC2  SVC   99                                                       04686000
*                    RESPECIFY (REG1) UNRSTD;              /*#YL026UK*/ 04687000
*                                                                  1173 04688000
*                    /************************************************/ 04689000
*                    /*                                      #YL026UK*/ 04690000
*                    /* CHECK THE RETURN CODE FROM DYNAMIC   #YL026UK*/ 04691000
*                    /* ALLOCATION                           #YL026UK*/ 04692000
*                    /*                                      #YL026UK*/ 04693000
*                    /************************************************/ 04694000
*                                                                  1174 04695000
*                    RESPECIFY (RTNREG) RSTD;              /*#YL026UK*/ 04696000
*                    RESPECIFY RTNREG RSTD;                        1175 04697000
*                    TESTRC = RTNREG;                              1176 04698000
         STH   RTNREG,TESTRC                                       1176 04699000
*                    RESPECIFY RTNREG UNRSTD;              /*#YL026UK*/ 04700000
*                    RESPECIFY (RTNREG) UNRSTD;            /*#YL026UK*/ 04701000
*                    IF GDTDBG = NULLPTR                           1179 04702000
*                      THEN;                                       1179 04703000
         L     @15,GDTDBG(,GDTPR)                                  1179 04704000
         LTR   @15,@15                                             1179 04705000
         BZ    @RT01179                                            1179 04706000
*                      ELSE                                        1181 04707000
*                        CALL IDCDB010(GDTTBL,'ZZAL');             1181 04708000
         ST    GDTPR,@AL00001                                      1181 04709000
         LA    @15,@CC02106                                        1181 04710000
         ST    @15,@AL00001+4                                      1181 04711000
         MVI   @AL00001+4,X'80'                                    1181 04712000
         L     @15,GDTDBG(,GDTPR)                                  1181 04713000
         LA    @01,@AL00001                                        1181 04714000
         BALR  @14,@15                                             1181 04715000
*                                                          /*#YL026UK*/ 04716000
*                    IF TESTRC = 0                                 1182 04717000
*                      THEN                                        1182 04718000
*                                                                  1182 04719000
@RT01179 LH    @15,TESTRC                                          1182 04720000
         LTR   @15,@15                                             1182 04721000
         BNZ   @RF01182                                            1182 04722000
*                        /********************************************/ 04723000
*                        /*                                  #YL026UK*/ 04724000
*                        /* DYNAMIC ALLOCATION CONCATENATION #YL026UK*/ 04725000
*                        /* WAS SUCCESSFUL--RETURN THE       #YL026UK*/ 04726000
*                        /* DDNAME FOR THIS CONCATENATION,   #YL026UK*/ 04727000
*                        /* FREE DDNAME DYNAMIC ALLOCATION   #YL026UK*/ 04728000
*                        /* TEXT UNIT FOR CONCATENATION, AND #YL026UK*/ 04729000
*                        /* SET A RETURN CODE OF 0           #YL026UK*/ 04730000
*                        /*                                  #YL026UK*/ 04731000
*                        /********************************************/ 04732000
*                                                                  1183 04733000
*                        DO;                               /*#YL026UK*/ 04734000
*                          ALLDDN(1:8) = CONDDN(1);        /*#YL026UK*/ 04735000
         L     @01,PARMPTR2                                        1184 04736000
         L     @15,DDLISTPT                                        1184 04737000
         MVC   ALLDDN(8,@01),CONDDN(@15)                           1184 04738000
*                          CALL IDCSAFS0(GDTTBL,DDLISTPT); /*#YL026UK*/ 04739000
         ST    GDTPR,@AL00001                                      1185 04740000
         LA    @15,DDLISTPT                                        1185 04741000
         ST    @15,@AL00001+4                                      1185 04742000
         L     @15,GDTFSP(,GDTPR)                                  1185 04743000
         LA    @01,@AL00001                                        1185 04744000
         BALR  @14,@15                                             1185 04745000
*                          SETRC = 0;                      /*#YL026UK*/ 04746000
         SLR   @15,@15                                             1186 04747000
         STH   @15,SETRC                                           1186 04748000
*                        END;                              /*#YL026UK*/ 04749000
*                      ELSE                                        1188 04750000
*                                                                  1188 04751000
*                                                                  1188 04752000
*                    /************************************************/ 04753000
*                    /*                                      @Z40GSBF*/ 04754000
*                    /* TEST FOR TSO IF IT IS THEN CALL UERROR     1188 04755000
*                    /* TO PRINT ERROR MESSAGES AND SET RETURN     1188 04756000
*                    /* CODE TO 4 AND RETURN TO CALLER             1188 04757000
*                    /*                                      @Z40GSBF*/ 04758000
*                    /************************************************/ 04759000
*                                                                  1188 04760000
*                    DO;                                   /*@Z40GSBF*/ 04761000
         B     @RC01182                                            1188 04762000
@RF01182 DS    0H                                                  1189 04763000
*                      ERCNVADR = ADDR(ERRORTAB);          /*@Z40GSBF*/ 04764000
         LA    @15,ERRORTAB                                        1189 04765000
         ST    @15,ERCNVADR                                        1189 04766000
*                      ERDARBPT = S99RBPTR;                /*@Z40GSBF*/ 04767000
         L     @14,S99RBPTR                                        1190 04768000
         ST    @14,ERDARBPT(,@15)                                  1190 04769000
*                      ERDYNAL = ON;                       /*@Z40GSBF*/ 04770000
         OI    ERDYNAL(@15),B'00100000'                            1191 04771000
*                      ERDYNRC = TESTRC;                   /*@Z40GSBF*/ 04772000
         LH    @14,TESTRC                                          1192 04773000
         ST    @14,ERDYNRC(,@15)                                   1192 04774000
*                      CALL IDCTPER0(GDTTBL,ERCNVADR);     /*@Z40GSBF*/ 04775000
         ST    GDTPR,@AL00001                                      1193 04776000
         LA    @15,ERCNVADR                                        1193 04777000
         ST    @15,@AL00001+4                                      1193 04778000
         MVI   @AL00001+4,X'80'                                    1193 04779000
         L     @15,GDTERR(,GDTPR)                                  1193 04780000
         LA    @01,@AL00001                                        1193 04781000
         BALR  @14,@15                                             1193 04782000
*                      SETRC = 4;                          /*#YL026UK*/ 04783000
         MVC   SETRC(2),@CH00038                                   1194 04784000
*                    END;                                  /*#YL026UK*/ 04785000
*                  END;                                    /*#YL026UK*/ 04786000
*                ELSE                                              1197 04787000
*                                                                  1197 04788000
*                  /**************************************************/ 04789000
*                  /*                                        #YL026UK*/ 04790000
*                  /* PERMANENT CONCATENATION NOT REQUIRED   #YL026UK*/ 04791000
*                  /*                                        #YL026UK*/ 04792000
*                  /**************************************************/ 04793000
*                                                                  1197 04794000
*                  DO;                                     /*#YL026UK*/ 04795000
*                                                                  1197 04796000
         B     @RC01152                                            1197 04797000
@RF01152 DS    0H                                                  1198 04798000
*                    /************************************************/ 04799000
*                    /*                                      #YL026UK*/ 04800000
*                    /* RETURN THE DDNAME AND SET A RETURN   #YL026UK*/ 04801000
*                    /* CODE OF 0                            #YL026UK*/ 04802000
*                    /*                                      #YL026UK*/ 04803000
*                    /************************************************/ 04804000
*                                                                  1198 04805000
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));      1198 04806000
*                    ALLDDN(1:8) = BLANKDDN;               /*@Y30SSMK*/ 04807000
         L     @15,PARMPTR2                                        1199 04808000
         MVC   ALLDDN(8,@15),@CC02078                              1199 04809000
*                    ALLDDN(1:S99TULNG) = S99TUPAR(1:8);   /*@ZA00133*/ 04810000
         LA    @14,TEXTDDN                                         1200 04811000
         ICM   @07,12,S99TULNG(@14)                                1200 04812000
         SRA   @07,16                                              1200 04813000
         BCTR  @07,0                                               1200 04814000
         EX    @07,@SM02475                                        1200 04815000
*                    SETRC = 0;                               /*@YL026U 04816000
*                                                            #YL026UK*/ 04817000
         SLR   @15,@15                                             1201 04818000
         STH   @15,SETRC                                           1201 04819000
*                  END;                                    /*#YL026UK*/ 04820000
*                                                                  1202 04821000
*            END;                                          /*#YL026UK*/ 04822000
*          ELSE                                                    1204 04823000
*                                                                  1204 04824000
*            /********************************************************/ 04825000
*            /*                                              #YL026UK*/ 04826000
*            /* REQUEST IS FOR DATA SET ALLOCATION           #YL026UK*/ 04827000
*            /*                                              #YL026UK*/ 04828000
*            /********************************************************/ 04829000
*                                                                  1204 04830000
*            DO;                                           /*#YL026UK*/ 04831000
*                                                                  1204 04832000
         B     @RC01001                                            1204 04833000
@RF01001 DS    0H                                                  1205 04834000
*              /******************************************************/ 04835000
*              /*                                            #YL026UK*/ 04836000
*              /* BUILD DSNAME TEXT UNIT AND INSERT ITS ADDR #YL026UK*/ 04837000
*              /* IN CORRESPONDING ENTRY OF TEXT UNIT        #YL026UK*/ 04838000
*              /* POINTER LIST                               #YL026UK*/ 04839000
*              /*                                            #YL026UK*/ 04840000
*              /******************************************************/ 04841000
*                                                                  1205 04842000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSN));    /*#YL026UK*/ 04843000
*              S99TUKEY = DALDSNAM;                        /*#YL026UK*/ 04844000
         LA    @15,TEXTDSN                                         1206 04845000
         MVC   S99TUKEY(2,@15),@CB01415                            1206 04846000
*              S99TUNUM = 1;                               /*#YL026UK*/ 04847000
         LA    @14,1                                               1207 04848000
         STCM  @14,3,S99TUNUM(@15)                                 1207 04849000
*              S99TULNG = 44;                              /*#YL026UK*/ 04850000
         MVC   S99TULNG(2,@15),@CH01652                            1208 04851000
*              S99TUPAR(1:44) = AGLDSN(1:44);              /*#YL026UK*/ 04852000
         L     @07,PARMPTR2                                        1209 04853000
         L     @01,ALLDSN(,@07)                                    1209 04854000
         MVC   S99TUPAR(44,@15),AGLDSN(@01)                        1209 04855000
*              S99TUPTR(1) = ADDR(TEXTDSN);                /*#YL026UK*/ 04856000
*                                                                  1210 04857000
         LA    @06,TUPL                                            1210 04858000
         ST    @15,S99TUPTR(,@06)                                  1210 04859000
*              /******************************************************/ 04860000
*              /*                                            #YL026UK*/ 04861000
*              /* BUILD DDNAME RETURN TEXT UNIT AND INSERT   #YL026UK*/ 04862000
*              /* ITS ADDR IN CORRESPONDING ENTRY OF TEXT    #YL026UK*/ 04863000
*              /* UNIT POINTER LIST                          #YL026UK*/ 04864000
*              /*                                            #YL026UK*/ 04865000
*              /******************************************************/ 04866000
*                                                                  1211 04867000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));    /*#YL026UK*/ 04868000
*              S99TUKEY = DALRTDDN;                        /*#YL026UK*/ 04869000
         LA    @15,TEXTDDN                                         1212 04870000
         MVC   S99TUKEY(2,@15),@CB01581                            1212 04871000
*              S99TUNUM = 1;                               /*#YL026UK*/ 04872000
         STCM  @14,3,S99TUNUM(@15)                                 1213 04873000
*              S99TULNG = 8;                               /*#YL026UK*/ 04874000
         LA    @05,8                                               1214 04875000
         STCM  @05,3,S99TULNG(@15)                                 1214 04876000
*              S99TUPTR(2) = ADDR(TEXTDDN);                /*#YL026UK*/ 04877000
*                                                                  1215 04878000
         ST    @15,S99TUPTR+4(,@06)                                1215 04879000
*              /******************************************************/ 04880000
*              /*                                            #YL026UK*/ 04881000
*              /* CHECK IF A PASSWORD HAS BEEN SPECIFIED     #YL026UK*/ 04882000
*              /*                                            #YL026UK*/ 04883000
*              /******************************************************/ 04884000
*                                                                  1216 04885000
*              IF ALLPWD ^= 0                                      1216 04886000
*                THEN                                              1216 04887000
*                                                                  1216 04888000
         L     @15,ALLPWD(,@07)                                    1216 04889000
         LTR   @15,@15                                             1216 04890000
         BZ    @RF01216                                            1216 04891000
*                  /**************************************************/ 04892000
*                  /*                                        #YL026UK*/ 04893000
*                  /* A PASSWORD HAS BEEN SPECIFIED--BUILD   #YL026UK*/ 04894000
*                  /* PASSWORD TEXT UNIT AND INSERT ITS ADDR #YL026UK*/ 04895000
*                  /* IN CORRESPONDING ENTRY OF TEXT UNIT    #YL026UK*/ 04896000
*                  /* POINTER LIST                           #YL026UK*/ 04897000
*                  /*                                        #YL026UK*/ 04898000
*                  /**************************************************/ 04899000
*                                                                  1217 04900000
*                  DO;                                     /*#YL026UK*/ 04901000
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTPWD));      1218 04902000
*                    S99TUKEY = DALPASSW;                  /*#YL026UK*/ 04903000
         LA    @07,TEXTPWD                                         1219 04904000
         MVC   S99TUKEY(2,@07),@CB01571                            1219 04905000
*                    S99TUNUM = 1;                         /*#YL026UK*/ 04906000
         STCM  @14,3,S99TUNUM(@07)                                 1220 04907000
*                    S99TULNG = 8;                         /*#YL026UK*/ 04908000
         STCM  @05,3,S99TULNG(@07)                                 1221 04909000
*                    S99TUPAR(1:8) = AGLPWD(1:8);          /*#YL026UK*/ 04910000
         MVC   S99TUPAR(8,@07),AGLPWD(@15)                         1222 04911000
*                    S99TUPTR(3) = ADDR(TEXTPWD);          /*#YL026UK*/ 04912000
         ST    @07,S99TUPTR+8(,@06)                                1223 04913000
*                  END;                                    /*#YL026UK*/ 04914000
*                                                                  1224 04915000
*              /******************************************************/ 04916000
*              /*                                            #YL026UK*/ 04917000
*              /* BUILD STATUS TEXT UNIT AND INSERT ITS ADDR #YL026UK*/ 04918000
*              /* IN CORRESPONDING ENTRY OF TEXT UNIT        #YL026UK*/ 04919000
*              /* POINTER LIST                               #YL026UK*/ 04920000
*              /*                                            #YL026UK*/ 04921000
*              /******************************************************/ 04922000
*                                                                  1225 04923000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTSTS));    /*#YL026UK*/ 04924000
@RF01216 DS    0H                                                  1226 04925000
*              S99TUKEY = DALSTATS;                        /*#YL026UK*/ 04926000
         LA    @15,TEXTSTS                                         1226 04927000
         MVC   S99TUKEY(2,@15),@CB01419                            1226 04928000
*              S99TUNUM = 1;                               /*#YL026UK*/ 04929000
         LA    @14,1                                               1227 04930000
         STCM  @14,3,S99TUNUM(@15)                                 1227 04931000
*              S99TULNG = 1;                               /*#YL026UK*/ 04932000
         STCM  @14,3,S99TULNG(@15)                                 1228 04933000
*              S99TUPAR(1) = ALLSTS(1);                    /*#YL026UK*/ 04934000
         L     @07,PARMPTR2                                        1229 04935000
         MVC   S99TUPAR(1,@15),ALLSTS(@07)                         1229 04936000
*              S99TUPTR(4) = ADDR(TEXTSTS);                /*#YL026UK*/ 04937000
*                                                                  1230 04938000
         LA    @06,TUPL                                            1230 04939000
         ST    @15,S99TUPTR+12(,@06)                               1230 04940000
*              /******************************************************/ 04941000
*              /*                                            #YL026UK*/ 04942000
*              /* BUILD DISPOSITION TEXT UNIT AND INSERT ITS #YL026UK*/ 04943000
*              /* ADDR IN CORRESPONDING ENTRY OF TEXT UNIT   #YL026UK*/ 04944000
*              /* POINTER LIST                               #YL026UK*/ 04945000
*              /*                                            #YL026UK*/ 04946000
*              /******************************************************/ 04947000
*                                                                  1231 04948000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSP));    /*#YL026UK*/ 04949000
*              S99TUKEY = DALNDISP;                        /*#YL026UK*/ 04950000
         LA    @15,TEXTDSP                                         1232 04951000
         MVC   S99TUKEY(2,@15),@CB01421                            1232 04952000
*              S99TUNUM = 1;                               /*#YL026UK*/ 04953000
         STCM  @14,3,S99TUNUM(@15)                                 1233 04954000
*              S99TULNG = 1;                               /*#YL026UK*/ 04955000
         STCM  @14,3,S99TULNG(@15)                                 1234 04956000
*              S99TUPAR(1) = ALLDSP(1);                    /*#YL026UK*/ 04957000
         MVC   S99TUPAR(1,@15),ALLDSP(@07)                         1235 04958000
*              S99TUPTR(5) = ADDR(TEXTDSP);                /*#YL026UK*/ 04959000
*                                                                  1236 04960000
         ST    @15,S99TUPTR+16(,@06)                               1236 04961000
*              /******************************************************/ 04962000
*              /*                                            #YL026UK*/ 04963000
*              /* BUILD DSORG RETURN TEXT UNIT, INSERT ITS   #YL026UK*/ 04964000
*              /* ADDR IN CORRESPONDING ENTRY OF TEXT UNIT   #YL026UK*/ 04965000
*              /* POINTER LIST, AND TURN THE HIGH ORDER BIT  #YL026UK*/ 04966000
*              /* OF THIS ADDR ON                            #YL026UK*/ 04967000
*              /*                                            #YL026UK*/ 04968000
*              /******************************************************/ 04969000
*                                                                  1237 04970000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTORG));    /*#YL026UK*/ 04971000
*              S99TUKEY = DALRTORG;                        /*#YL026UK*/ 04972000
         LA    @15,TEXTORG                                         1238 04973000
         MVC   S99TUKEY(2,@15),@CB01585                            1238 04974000
*              S99TUNUM = 1;                               /*#YL026UK*/ 04975000
         STCM  @14,3,S99TUNUM(@15)                                 1239 04976000
*              S99TULNG = 2;                               /*#YL026UK*/ 04977000
         MVC   S99TULNG(2,@15),@CH00149                            1240 04978000
*              S99TUPTR(6) = ADDR(TEXTORG);                /*#YL026UK*/ 04979000
*                                                                  1241 04980000
         ST    @15,S99TUPTR+20(,@06)                               1241 04981000
*              /******************************************************/ 04982000
*              /*                                            @Y30LSMK*/ 04983000
*              /* IF A DEVICE TYPE IS REQUESTED, BUILD THE   @Y30LSMK*/ 04984000
*              /* UNIT DESCRIPTOR TEXT UNIT AND INSERT ITS   @Y30LSMK*/ 04985000
*              /* ADDR IN THE CORRESPONDING ENTRY OF TEXT    @Y30LSMK*/ 04986000
*              /* UNIT POINTER LIST.                         @Y30LSMK*/ 04987000
*              /*                                            @Y30LSMK*/ 04988000
*              /******************************************************/ 04989000
*                                                                  1242 04990000
*              IF ALLULP = NULLPTR                                 1242 04991000
*                THEN                                              1242 04992000
         L     @07,ALLULP(,@07)                                    1242 04993000
         LTR   @07,@07                                             1242 04994000
         BNZ   @RF01242                                            1242 04995000
*                  S99TUPLN(6) = ON;                       /*@Y30LSMK*/ 04996000
         OI    S99TUPLN+20(@06),B'10000000'                        1243 04997000
*                ELSE                                              1244 04998000
*                  DO;                                     /*@Y30LSMK*/ 04999000
         B     @RC01242                                            1244 05000000
@RF01242 DS    0H                                                  1245 05001000
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTUNT));      1245 05002000
*                    S99TUKEY = DALUNIT;                   /*@Y30LSMK*/ 05003000
         LA    @15,TEXTUNT                                         1246 05004000
         MVC   S99TUKEY(2,@15),@CB01453                            1246 05005000
*                    S99TUNUM = 1;                         /*@Y30LSMK*/ 05006000
         MVC   S99TUNUM(2,@15),@CH00215                            1247 05007000
*                    S99TULNG = UNTLEN(1);                 /*@Y30LSMK*/ 05008000
         L     @01,PARMPTR2                                        1248 05009000
         L     @14,ALLULP(,@01)                                    1248 05010000
         ICM   @07,12,UNTLEN(@14)                                  1248 05011000
         SRA   @07,16                                              1248 05012000
         STCM  @07,3,S99TULNG(@15)                                 1248 05013000
*                    S99TUPAR(1:S99TULNG) = UNTVAL(1,1:S99TULNG);  1249 05014000
         BCTR  @07,0                                               1249 05015000
         EX    @07,@SM02477                                        1249 05016000
*                    S99TUPTR(7) = ADDR(TEXTUNT);          /*@Y30LSMK*/ 05017000
         LA    @14,TUPL                                            1250 05018000
         ST    @15,S99TUPTR+24(,@14)                               1250 05019000
*                    S99TUPLN(7) = ON;                     /*@Y30LSMK*/ 05020000
         OI    S99TUPLN+24(@14),B'10000000'                        1251 05021000
*                  END;                                    /*@Y30LSMK*/ 05022000
*                                                                  1252 05023000
*              /******************************************************/ 05024000
*              /*                                            #YL026UK*/ 05025000
*              /* INITIALIZE THE REQUEST BLOCK               #YL026UK*/ 05026000
*              /*                                            #YL026UK*/ 05027000
*              /******************************************************/ 05028000
*                                                                  1253 05029000
*              S99RBLN = '14'X;                            /*#YL026UK*/ 05030000
@RC01242 MVI   S99RBLN,X'14'                                       1253 05031000
*              S99VERB = S99VRBAL;                         /*#YL026UK*/ 05032000
         MVI   S99VERB,X'01'                                       1254 05033000
*              S99TXTPP = ADDR(TUPL);                      /*#YL026UK*/ 05034000
*                                                                  1255 05035000
         LA    @15,TUPL                                            1255 05036000
         ST    @15,S99TXTPP                                        1255 05037000
*              /******************************************************/ 05038000
*              /*                                            #YL026UK*/ 05039000
*              /* INITIALIZE THE REQUEST BLOCK POINTER WITH  #YL026UK*/ 05040000
*              /* THE HIGH ORDER BIT TURNED ON               #YL026UK*/ 05041000
*              /*                                            #YL026UK*/ 05042000
*              /******************************************************/ 05043000
*                                                                  1256 05044000
*              S99RBPTR = ADDR(S99RB);                     /*#YL026UK*/ 05045000
         LA    @15,S99RB                                           1256 05046000
         ST    @15,S99RBPTR                                        1256 05047000
*              S99RBPND = ON;                              /*#YL026UK*/ 05048000
*                                                                  1257 05049000
         OI    S99RBPND,B'10000000'                                1257 05050000
*              /******************************************************/ 05051000
*              /*                                            #YL026UK*/ 05052000
*              /* LOAD REGISTER 1 WITH THE ADDR OF THE       #YL026UK*/ 05053000
*              /* REQUEST BLOCK POINTER AND ISSUE THE        #YL026UK*/ 05054000
*              /* DYNAMIC ALLOCATION REQUEST                 #YL026UK*/ 05055000
*              /*                                            #YL026UK*/ 05056000
*              /******************************************************/ 05057000
*                                                                  1258 05058000
*              IF GDTDBG = NULLPTR                                 1258 05059000
*                THEN;                                             1258 05060000
         L     @15,GDTDBG(,GDTPR)                                  1258 05061000
         LTR   @15,@15                                             1258 05062000
         BZ    @RT01258                                            1258 05063000
*                ELSE                                              1260 05064000
*                  CALL IDCDB010(GDTTBL,'ZZAL');                   1260 05065000
         ST    GDTPR,@AL00001                                      1260 05066000
         LA    @15,@CC02106                                        1260 05067000
         ST    @15,@AL00001+4                                      1260 05068000
         MVI   @AL00001+4,X'80'                                    1260 05069000
         L     @15,GDTDBG(,GDTPR)                                  1260 05070000
         LA    @01,@AL00001                                        1260 05071000
         BALR  @14,@15                                             1260 05072000
*                                                          /*#YL026UK*/ 05073000
*              RESPECIFY (REG1) RSTD;                      /*#YL026UK*/ 05074000
@RT01258 DS    0H                                                  1262 05075000
*              REG1 = ADDR(S99RBPTR);                      /*#YL026UK*/ 05076000
         LA    REG1,S99RBPTR                                       1262 05077000
*L99SVC3:      GEN(SVC   99);                              /*#YL026UK*/ 05078000
L99SVC3  SVC   99                                                       05079000
*              RESPECIFY (REG1) UNRSTD;                    /*#YL026UK*/ 05080000
*                                                                  1264 05081000
*              /******************************************************/ 05082000
*              /*                                            #YL026UK*/ 05083000
*              /* CHECK THE RETURN CODE FROM DYNAMIC         #YL026UK*/ 05084000
*              /* ALLOCATION                                 #YL026UK*/ 05085000
*              /*                                            #YL026UK*/ 05086000
*              /******************************************************/ 05087000
*                                                                  1265 05088000
*              RESPECIFY (RTNREG) RSTD;                    /*#YL026UK*/ 05089000
*              RESPECIFY RTNREG RSTD;                              1266 05090000
*              TESTRC = RTNREG;                                    1267 05091000
         STH   RTNREG,TESTRC                                       1267 05092000
*              RESPECIFY RTNREG UNRSTD;                    /*#YL026UK*/ 05093000
*              RESPECIFY (RTNREG) UNRSTD;                  /*#YL026UK*/ 05094000
*              IF GDTDBG = NULLPTR                                 1270 05095000
*                THEN;                                             1270 05096000
         L     @15,GDTDBG(,GDTPR)                                  1270 05097000
         LTR   @15,@15                                             1270 05098000
         BZ    @RT01270                                            1270 05099000
*                ELSE                                              1272 05100000
*                  CALL IDCDB010(GDTTBL,'ZZAL');                   1272 05101000
         ST    GDTPR,@AL00001                                      1272 05102000
         LA    @15,@CC02106                                        1272 05103000
         ST    @15,@AL00001+4                                      1272 05104000
         MVI   @AL00001+4,X'80'                                    1272 05105000
         L     @15,GDTDBG(,GDTPR)                                  1272 05106000
         LA    @01,@AL00001                                        1272 05107000
         BALR  @14,@15                                             1272 05108000
*                                                          /*#YL026UK*/ 05109000
*              IF TESTRC = 0                                       1273 05110000
*                THEN                                              1273 05111000
*                                                                  1273 05112000
@RT01270 SLR   @15,@15                                             1273 05113000
         CH    @15,TESTRC                                          1273 05114000
         BNE   @RF01273                                            1273 05115000
*                  /**************************************************/ 05116000
*                  /*                                        #YL026UK*/ 05117000
*                  /* DYNAMIC ALLOCATION WAS SUCCESSFUL--    #YL026UK*/ 05118000
*                  /* RETURN THE DDNAME, THE DSORG AND SET   #YL026UK*/ 05119000
*                  /* A RETURN CODE OF 0                     #YL026UK*/ 05120000
*                  /*                                        #YL026UK*/ 05121000
*                  /**************************************************/ 05122000
*                                                                  1274 05123000
*                  DO;                                     /*#YL026UK*/ 05124000
*                    SETRC = 0;                            /*#YL026UK*/ 05125000
         STH   @15,SETRC                                           1275 05126000
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));      1276 05127000
*                    ALLDDN(1:8) = BLANKDDN;               /*@Y30SSMK*/ 05128000
         L     @15,PARMPTR2                                        1277 05129000
         MVC   ALLDDN(8,@15),@CC02078                              1277 05130000
*                    ALLDDN(1:S99TULNG) = S99TUPAR(1:8);   /*@ZA00133*/ 05131000
         LA    @14,TEXTDDN                                         1278 05132000
         ICM   @07,12,S99TULNG(@14)                                1278 05133000
         SRA   @07,16                                              1278 05134000
         BCTR  @07,0                                               1278 05135000
         EX    @07,@SM02475                                        1278 05136000
*                    RESPECIFY S99TUNIT BASED(ADDR(TEXTORG));      1279 05137000
*                    ALLORG(1:2) = S99TUPAR(1:2);          /*#YL026UK*/ 05138000
         LA    @14,TEXTORG                                         1280 05139000
         MVC   ALLORG(2,@15),S99TUPAR(@14)                         1280 05140000
*                  END;                                    /*#YL026UK*/ 05141000
*                ELSE                                              1282 05142000
*                                                                  1282 05143000
*                                                                  1282 05144000
*                    /************************************************/ 05145000
*                    /*                                      @Z40GSBF*/ 05146000
*                    /* TEST FOR TSO IF IT IS THEN CALL UERROR     1282 05147000
*                    /* TO PRINT ERROR MESSAGES AND SET RETURN     1282 05148000
*                    /* CODE TO 4 AND RETURN TO CALLER             1282 05149000
*                    /*                                      @Z40GSBF*/ 05150000
*                    /************************************************/ 05151000
*                                                                  1282 05152000
*                    DO;                                   /*@Z40GSBF*/ 05153000
         B     @RC01273                                            1282 05154000
@RF01273 DS    0H                                                  1283 05155000
*                      ERCNVADR = ADDR(ERRORTAB);          /*@Z40GSBF*/ 05156000
         LA    @15,ERRORTAB                                        1283 05157000
         ST    @15,ERCNVADR                                        1283 05158000
*                      ERDARBPT = S99RBPTR;                /*@Z40GSBF*/ 05159000
         L     @14,S99RBPTR                                        1284 05160000
         ST    @14,ERDARBPT(,@15)                                  1284 05161000
*                      ERDYNAL = ON;                       /*@Z40GSBF*/ 05162000
         OI    ERDYNAL(@15),B'00100000'                            1285 05163000
*                      ERDYNRC = TESTRC;                   /*@Z40GSBF*/ 05164000
         LH    @14,TESTRC                                          1286 05165000
         ST    @14,ERDYNRC(,@15)                                   1286 05166000
*                      CALL IDCTPER0(GDTTBL,ERCNVADR);     /*@Z40GSBF*/ 05167000
         ST    GDTPR,@AL00001                                      1287 05168000
         LA    @15,ERCNVADR                                        1287 05169000
         ST    @15,@AL00001+4                                      1287 05170000
         MVI   @AL00001+4,X'80'                                    1287 05171000
         L     @15,GDTERR(,GDTPR)                                  1287 05172000
         LA    @01,@AL00001                                        1287 05173000
         BALR  @14,@15                                             1287 05174000
*                      SETRC = 4;                          /*#YL026UK*/ 05175000
         MVC   SETRC(2),@CH00038                                   1288 05176000
*                    END;                                  /*#YL026UK*/ 05177000
*            END;                                          /*#YL026UK*/ 05178000
*                                                                  1290 05179000
@RC01273 DS    0H                                                  1291 05180000
*        /************************************************************/ 05181000
*        /*                                                  #YL026UK*/ 05182000
*        /* RETURN CONTROL TO THE UALLOC CALLER              #YL026UK*/ 05183000
*        /*                                                  #YL026UK*/ 05184000
*        /************************************************************/ 05185000
*                                                                  1291 05186000
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        1291 05187000
@RC01001 ST    GDTPR,@AL00001                                      1291 05188000
         LA    @15,MODID                                           1291 05189000
         ST    @15,@AL00001+4                                      1291 05190000
         LA    @15,SETRC                                           1291 05191000
         ST    @15,@AL00001+8                                      1291 05192000
         MVI   @AL00001+8,X'80'                                    1291 05193000
         L     @15,GDTEPL(,GDTPR)                                  1291 05194000
         LA    @01,@AL00001                                        1291 05195000
         BALR  @14,@15                                             1291 05196000
*        /*#YL026UK*/                                              1292 05197000
*        /************************************************************/ 05198000
*        /************************************************************/ 05199000
*        /*                                                  #YL026UK*/ 05200000
*        /* UDEALLOC ENTRY POINT                             #YL026UK*/ 05201000
*        /*                                                  #YL026UK*/ 05202000
*        /************************************************************/ 05203000
*        /************************************************************/ 05204000
*                                                                  1292 05205000
*AMSSADL:  ENTRY(GDTTBLX,ALLAGLY);                         /*#YL026UK*/ 05206000
*                                                                  1292 05207000
@EC01292 DS    0H                                                  1293 05208000
*AMSSADL1:                                                         1293 05209000
*                                                                  1293 05210000
*        RESPECIFY ALLAGL BASED(PARMPTR2);                 /*#YL026UK*/ 05211000
AMSSADL1 DS    0H                                                  1294 05212000
*                                      /* BASE ALLOCATION    #YL026UK*/ 05213000
*                                      /* ARGUMENT LIST      #YL026UK*/ 05214000
*                                                                  1294 05215000
*        /* DSNAME OR DDNAME TO BE PRINTED IN UDEALLOC ERROR #YL026UK*/ 05216000
*        /* MESSAGE                                          #YL026UK*/ 05217000
*        DCL DEMSGT CHAR(44);                              /*#YL026UK*/ 05218000
*                                                                  1294 05219000
*        /* STID FOR ERROR DURING UNALLOCATION               #YL026UK*/ 05220000
*        DCL DEALSTID FIXED(8) CONSTANT(28);               /*#YL026UK*/ 05221000
*                                                                  1295 05222000
*        /* UNALLOCATE STEPCAT RETURN CODE                   @Y30SSMK*/ 05223000
*        DCL STEPRC FIXED(15) CONSTANT(12);                /*@Y30SSMK*/ 05224000
*                                                                  1296 05225000
*        /* UNALLOCATE STEPCAT ERROR CODE                    @Y30SSMK*/ 05226000
*        DCL STEPERR BIT(16) CONSTANT('0364'X);            /*@Y30SSMK*/ 05227000
*                                                                  1297 05228000
*        /* UNALLOCATE STEPCAT INFO CODE                     @Y30SSMK*/ 05229000
*        DCL STEPINFO BIT(16) CONSTANT('0004'X);           /*@Y30SSMK*/ 05230000
*                                                                  1298 05231000
*        /************************************************************/ 05232000
*        /*                                                  #YL026UK*/ 05233000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/ 05234000
*        /*                                                  #YL026UK*/ 05235000
*        /************************************************************/ 05236000
*                                                                  1299 05237000
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/ 05238000
*        GDTPR = ADDR1;                                    /*#YL026UK*/ 05239000
         L     GDTPR,ADDR1(,REG1PTR)                               1300 05240000
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/ 05241000
         L     @00,ADDR2+4(,REG1PTR)                               1301 05242000
         ST    @00,PARMPTR2                                        1301 05243000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/ 05244000
*                                                                  1302 05245000
*        OLDERID2 = NEWERID2;                                      1303 05246000
         L     @01,GDTTR2(,GDTPR)                                  1303 05247000
         MVC   @TS00001(95),NEWERID2(@01)                          1303 05248000
         MVC   OLDERID2(95,@01),@TS00001                           1303 05249000
*        NEWID2 = 'SADL';                                  /*#YL026UK*/ 05250000
*                                                                  1304 05251000
         MVC   NEWID2(4,@01),@CC02153                              1304 05252000
*        /************************************************************/ 05253000
*        /*                                                  #YL026UK*/ 05254000
*        /* ZERO TEXT UNIT POINTER LIST AND REQUEST BLOCK    #YL026UK*/ 05255000
*        /*                                                  #YL026UK*/ 05256000
*        /************************************************************/ 05257000
*                                                                  1305 05258000
*        TUPL = '00'X;                                     /*#YL026UK*/ 05259000
         XC    TUPL+1(31),TUPL+1                                   1305 05260000
         MVI   TUPL,X'00'                                          1305 05261000
*        S99RB = '00'X;                                    /*#YL026UK*/ 05262000
         XC    S99RB+1(19),S99RB+1                                 1306 05263000
         MVI   S99RB,X'00'                                         1306 05264000
*        RESPECIFY S99TUPL BASED(ADDR(TUPL));              /*#YL026UK*/ 05265000
*                                                                  1307 05266000
*        /************************************************************/ 05267000
*        /*                                                  #YL026UK*/ 05268000
*        /* CHECK IF A DSNAME HAS BEEN SPECIFIED FOR         #YL026UK*/ 05269000
*        /* UNALLOCATION                                     #YL026UK*/ 05270000
*        /*                                                  #YL026UK*/ 05271000
*        /************************************************************/ 05272000
*                                                                  1308 05273000
*        IF ALLDSN ^= 0                                            1308 05274000
*          THEN                                                    1308 05275000
*                                                                  1308 05276000
         LR    @01,@00                                             1308 05277000
         L     @15,ALLDSN(,@01)                                    1308 05278000
         LTR   @15,@15                                             1308 05279000
         BZ    @RF01308                                            1308 05280000
*            /********************************************************/ 05281000
*            /*                                              #YL026UK*/ 05282000
*            /* BUILD DSNAME TEXT UNIT AND INSERT ITS ADDR   #YL026UK*/ 05283000
*            /* IN CORRESPONDING ENTRY OF TEXT UNIT PTR LIST #YL026UK*/ 05284000
*            /*                                              #YL026UK*/ 05285000
*            /********************************************************/ 05286000
*                                                                  1309 05287000
*            DO;                                           /*#YL026UK*/ 05288000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSN));    /*#YL026UK*/ 05289000
*              S99TUKEY = DUNDSNAM;                        /*#YL026UK*/ 05290000
         LA    @14,TEXTDSN                                         1311 05291000
         MVC   S99TUKEY(2,@14),@CB01415                            1311 05292000
*              S99TUNUM = 1;                               /*#YL026UK*/ 05293000
         MVC   S99TUNUM(2,@14),@CH00215                            1312 05294000
*              S99TULNG = 44;                              /*#YL026UK*/ 05295000
         MVC   S99TULNG(2,@14),@CH01652                            1313 05296000
*              S99TUPAR(1:44) = AGLDSN(1:44);              /*#YL026UK*/ 05297000
         MVC   S99TUPAR(44,@14),AGLDSN(@15)                        1314 05298000
*              S99TUPTR(1) = ADDR(TEXTDSN);                /*#YL026UK*/ 05299000
         LA    @15,TUPL                                            1315 05300000
         ST    @14,S99TUPTR(,@15)                                  1315 05301000
*            END;                                          /*#YL026UK*/ 05302000
*          ELSE                                                    1317 05303000
*                                                                  1317 05304000
*            /********************************************************/ 05305000
*            /*                                              #YL026UK*/ 05306000
*            /* BUILD DDNAME TEXT UNIT AND INSERT ITS ADDR   #YL026UK*/ 05307000
*            /* IN CORRESPONDING ENTRY OF TEXT UNIT PTR LIST #YL026UK*/ 05308000
*            /*                                              #YL026UK*/ 05309000
*            /********************************************************/ 05310000
*                                                                  1317 05311000
*            DO;                                           /*#YL026UK*/ 05312000
         B     @RC01308                                            1317 05313000
@RF01308 DS    0H                                                  1318 05314000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDDN));    /*#YL026UK*/ 05315000
*              S99TUKEY = DUNDDNAM;                        /*#YL026UK*/ 05316000
         LA    @15,TEXTDDN                                         1319 05317000
         MVC   S99TUKEY(2,@15),@CB01413                            1319 05318000
*              S99TUNUM = 1;                               /*#YL026UK*/ 05319000
         MVC   S99TUNUM(2,@15),@CH00215                            1320 05320000
*              S99TULNG = 8;                               /*#YL026UK*/ 05321000
         MVC   S99TULNG(2,@15),@CH00175                            1321 05322000
*              S99TUPAR(1:8) = ALLDDN(1:8);                /*#YL026UK*/ 05323000
         L     @14,PARMPTR2                                        1322 05324000
         MVC   S99TUPAR(8,@15),ALLDDN(@14)                         1322 05325000
*              S99TUPTR(2) = ADDR(TEXTDDN);                /*#YL026UK*/ 05326000
         LA    @14,TUPL                                            1323 05327000
         ST    @15,S99TUPTR+4(,@14)                                1323 05328000
*            END;                                          /*#YL026UK*/ 05329000
*                                                                  1324 05330000
*        /************************************************************/ 05331000
*        /*                                                  #YL026UK*/ 05332000
*        /* CHECK WHETHER OR NOT AN OVERRIDING DISPOSITION   #YL026UK*/ 05333000
*        /* WAS SPECIFIED                                    #YL026UK*/ 05334000
*        /*                                                  #YL026UK*/ 05335000
*        /************************************************************/ 05336000
*                                                                  1325 05337000
*        IF ALLDSP = '00'X                                         1325 05338000
*          THEN                                                    1325 05339000
@RC01308 L     @01,PARMPTR2                                        1325 05340000
         CLI   ALLDSP(@01),X'00'                                   1325 05341000
         BE    @RT01325                                            1325 05342000
*              ;                                           /*#YM06134*/ 05343000
*          ELSE                                                    1327 05344000
*                                                                  1327 05345000
*            /********************************************************/ 05346000
*            /*                                              #YL026UK*/ 05347000
*            /* AN OVERRIDING DISPOSITION EXISTS--BUILD A    #YL026UK*/ 05348000
*            /* DISPOSITION TEXT UNIT. INSERT ITS ADDR IN    #YM06134*/ 05349000
*            /* THE CORRESPONDING ENTRY OF THE TEXT UNIT     #YL026UK*/ 05350000
*            /* POINTER LIST.                                #YM06134*/ 05351000
*            /*                                              @YL026UK*/ 05352000
*            /********************************************************/ 05353000
*                                                                  1327 05354000
*            DO;                                           /*@YL026UK*/ 05355000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTDSP));    /*@YL026UK*/ 05356000
*              S99TUKEY = DUNOVDSP;                        /*@YL026UK*/ 05357000
         LA    @15,TEXTDSP                                         1329 05358000
         MVC   S99TUKEY(2,@15),@CB01421                            1329 05359000
*              S99TUNUM = 1;                               /*@YL026UK*/ 05360000
         LA    @14,1                                               1330 05361000
         STCM  @14,3,S99TUNUM(@15)                                 1330 05362000
*              S99TULNG = 1;                               /*@YL026UK*/ 05363000
         STCM  @14,3,S99TULNG(@15)                                 1331 05364000
*              S99TUPAR(1) = ALLDSP(1);                    /*@YL026UK*/ 05365000
         L     @14,PARMPTR2                                        1332 05366000
         MVC   S99TUPAR(1,@15),ALLDSP(@14)                         1332 05367000
*              S99TUPTR(5) = ADDR(TEXTDSP);                /*@YL026UK*/ 05368000
         LA    @14,TUPL                                            1333 05369000
         ST    @15,S99TUPTR+16(,@14)                               1333 05370000
*            END;                                          /*@YL026UK*/ 05371000
*                                                                  1334 05372000
*        /************************************************************/ 05373000
*        /*                                                  @YM06134*/ 05374000
*        /*  IF THE UNALLOCATE OPTION HAS BEEN REQUESTED,    @Y30SSMK*/ 05375000
*        /*  SET UP THE TEXT UNIT NEEDED TO OVERIDE THE      @YM06134*/ 05376000
*        /*  PERMANENT ALLOCATION OF DATA SETS USED BY       @YM06134*/ 05377000
*        /*  THE ALLOC COMMAND OF TSO.                       @Y30SSMK*/ 05378000
*        /*  INSERT THE ADDR OF THIS UNIT IN THE POINTER     @YM06134*/ 05379000
*        /*  LIST AT THE PROPER LOCATION.                    @YM06134*/ 05380000
*        /*                                                  @YM06134*/ 05381000
*        /************************************************************/ 05382000
*                                                                  1335 05383000
*        IF ALLOPTUN = ON                                          1335 05384000
*          THEN                                                    1335 05385000
@RT01325 L     @01,PARMPTR2                                        1335 05386000
         TM    ALLOPTUN(@01),B'00010000'                           1335 05387000
         BNO   @RF01335                                            1335 05388000
*            DO;                                           /*@Y30SSMK*/ 05389000
*              RESPECIFY S99TUNIT BASED(ADDR(TEXTPERM));   /*#YM06134*/ 05390000
*              S99TUKEY = DUNUNALC;                        /*#YM06134*/ 05391000
         LA    @15,TEXTPERM                                        1338 05392000
         MVC   S99TUKEY(2,@15),@CB01425                            1338 05393000
*              S99TUNUM = 0;                               /*@YM06134*/ 05394000
         SLR   @14,@14                                             1339 05395000
         STCM  @14,3,S99TUNUM(@15)                                 1339 05396000
*              S99TUPTR(7) = ADDR(TEXTPERM);               /*@YM06134*/ 05397000
         LA    @14,TUPL                                            1340 05398000
         ST    @15,S99TUPTR+24(,@14)                               1340 05399000
*              S99TUPLN(7) = ON;                           /*@YM06134*/ 05400000
         OI    S99TUPLN+24(@14),B'10000000'                        1341 05401000
*            END;                                          /*@Y30SSMK*/ 05402000
*          ELSE                                                    1343 05403000
*            DO;                                           /*@Y30SSMK*/ 05404000
         B     @RC01335                                            1343 05405000
@RF01335 DS    0H                                                  1344 05406000
*              IF ALLDSP = '00'X                                   1344 05407000
*                THEN                                              1344 05408000
         L     @15,PARMPTR2                                        1344 05409000
         CLI   ALLDSP(@15),X'00'                                   1344 05410000
         BNE   @RF01344                                            1344 05411000
*                  DO;                                     /*@Y30SSMK*/ 05412000
*                    IF ALLDSN ^= NULLPTR                          1346 05413000
*                      THEN                                        1346 05414000
         L     @15,ALLDSN(,@15)                                    1346 05415000
         LTR   @15,@15                                             1346 05416000
         BZ    @RF01346                                            1346 05417000
*                        S99TUPLN(1) = ON;                 /*@Y30SSMK*/ 05418000
         LA    @15,TUPL                                            1347 05419000
         OI    S99TUPLN(@15),B'10000000'                           1347 05420000
*                      ELSE                                        1348 05421000
*                        S99TUPLN(2) = ON;                 /*@Y30SSMK*/ 05422000
         B     @RC01346                                            1348 05423000
@RF01346 LA    @15,TUPL                                            1348 05424000
         OI    S99TUPLN+4(@15),B'10000000'                         1348 05425000
*                  END;                                    /*@Y30SSMK*/ 05426000
*                ELSE                                              1350 05427000
*                  S99TUPLN(5) = ON;                       /*@Y30SSMK*/ 05428000
         B     @RC01344                                            1350 05429000
@RF01344 LA    @15,TUPL                                            1350 05430000
         OI    S99TUPLN+16(@15),B'10000000'                        1350 05431000
*            END;                                          /*@Y30SSMK*/ 05432000
*                                                                  1351 05433000
@RC01344 DS    0H                                                  1352 05434000
*        /************************************************************/ 05435000
*        /*                                                  #YL026UK*/ 05436000
*        /* INITIALIZE THE REQUEST BLOCK                     #YL026UK*/ 05437000
*        /*                                                  #YL026UK*/ 05438000
*        /************************************************************/ 05439000
*                                                                  1352 05440000
*        S99RBLN = '14'X;                                  /*#YL026UK*/ 05441000
@RC01335 MVI   S99RBLN,X'14'                                       1352 05442000
*        S99VERB = S99VRBUN;                               /*#YL026UK*/ 05443000
         MVI   S99VERB,X'02'                                       1353 05444000
*        S99TXTPP = ADDR(TUPL);                            /*#YL026UK*/ 05445000
*                                                                  1354 05446000
         LA    @15,TUPL                                            1354 05447000
         ST    @15,S99TXTPP                                        1354 05448000
*        /************************************************************/ 05449000
*        /*                                                  #YL026UK*/ 05450000
*        /* INITIALIZE THE REQUEST BLOCK POINTER NOW WITH    #YL026UK*/ 05451000
*        /* THE HIGH ORDER BIT TURNED ON                     #YL026UK*/ 05452000
*        /*                                                  #YL026UK*/ 05453000
*        /************************************************************/ 05454000
*                                                                  1355 05455000
*        S99RBPTR = ADDR(S99RB);                           /*#YL026UK*/ 05456000
         LA    @15,S99RB                                           1355 05457000
         ST    @15,S99RBPTR                                        1355 05458000
*        S99RBPND = ON;                                    /*#YL026UK*/ 05459000
*                                                                  1356 05460000
         OI    S99RBPND,B'10000000'                                1356 05461000
*        /************************************************************/ 05462000
*        /*                                                  #YL026UK*/ 05463000
*        /* LOAD REGISTER 1 WITH THE ADDRESS OF THE REQUEST  #YL026UK*/ 05464000
*        /* BLOCK POINTER AND ISSUE THE DYNAMIC UNALLOCATE   #YL026UK*/ 05465000
*        /* REQUEST                                          #YL026UK*/ 05466000
*        /*                                                  #YL026UK*/ 05467000
*        /************************************************************/ 05468000
*                                                                  1357 05469000
*        IF GDTDBG = NULLPTR                                       1357 05470000
*          THEN;                                                   1357 05471000
         L     @15,GDTDBG(,GDTPR)                                  1357 05472000
         LTR   @15,@15                                             1357 05473000
         BZ    @RT01357                                            1357 05474000
*          ELSE                                                    1359 05475000
*            CALL IDCDB010(GDTTBL,'ZZDL');                         1359 05476000
         ST    GDTPR,@AL00001                                      1359 05477000
         LA    @15,@CC02164                                        1359 05478000
         ST    @15,@AL00001+4                                      1359 05479000
         MVI   @AL00001+4,X'80'                                    1359 05480000
         L     @15,GDTDBG(,GDTPR)                                  1359 05481000
         LA    @01,@AL00001                                        1359 05482000
         BALR  @14,@15                                             1359 05483000
*                                                          /*#YL026UK*/ 05484000
*        RESPECIFY (REG1) RSTD;                            /*#YL026UK*/ 05485000
@RT01357 DS    0H                                                  1361 05486000
*        REG1 = ADDR(S99RBPTR);                            /*#YL026UK*/ 05487000
         LA    REG1,S99RBPTR                                       1361 05488000
*L99SVC4:GEN(SVC   99);                                    /*#YL026UK*/ 05489000
L99SVC4  SVC   99                                                       05490000
*        RESPECIFY (REG1) UNRSTD;                          /*#YL026UK*/ 05491000
*                                                                  1363 05492000
*        /************************************************************/ 05493000
*        /*                                                  #YL026UK*/ 05494000
*        /* CHECK THE RETURN CODE                            #YL026UK*/ 05495000
*        /* FROM DYNAMIC ALLOCATION TO SEE IF ERROR MESSAGES #YL026UK*/ 05496000
*        /* ARE TO BE PRINTED.                               #YL026UK*/ 05497000
*        /*                                                  #YL026UK*/ 05498000
*        /************************************************************/ 05499000
*                                                                  1364 05500000
*        RESPECIFY (RTNREG) RSTD;                          /*#YL026UK*/ 05501000
*        RESPECIFY RTNREG RSTD;                                    1365 05502000
*        TESTRC = RTNREG;                                          1366 05503000
         STH   RTNREG,TESTRC                                       1366 05504000
*        RESPECIFY RTNREG UNRSTD;                          /*#YL026UK*/ 05505000
*        RESPECIFY (RTNREG) UNRSTD;                        /*#YL026UK*/ 05506000
*        IF GDTDBG = NULLPTR                                       1369 05507000
*          THEN;                                                   1369 05508000
         L     @15,GDTDBG(,GDTPR)                                  1369 05509000
         LTR   @15,@15                                             1369 05510000
         BZ    @RT01369                                            1369 05511000
*          ELSE                                                    1371 05512000
*            CALL IDCDB010(GDTTBL,'ZZDL');                         1371 05513000
         ST    GDTPR,@AL00001                                      1371 05514000
         LA    @15,@CC02164                                        1371 05515000
         ST    @15,@AL00001+4                                      1371 05516000
         MVI   @AL00001+4,X'80'                                    1371 05517000
         L     @15,GDTDBG(,GDTPR)                                  1371 05518000
         LA    @01,@AL00001                                        1371 05519000
         BALR  @14,@15                                             1371 05520000
*                                                          /*#YL026UK*/ 05521000
*        IF (TESTRC ^= 0) & (TESTRC ^= 4)                  /*@YM07819*/ 05522000
*          THEN                                                    1372 05523000
@RT01369 LH    @15,TESTRC                                          1372 05524000
         SLR   @14,@14                                             1372 05525000
         CR    @15,@14                                             1372 05526000
         BE    @RF01372                                            1372 05527000
         C     @15,@CF00038                                        1372 05528000
         BE    @RF01372                                            1372 05529000
*            DO;                                                   1373 05530000
*                                                                  1373 05531000
*            /********************************************************/ 05532000
*            /*                                              #YL026UK*/ 05533000
*            /* ERROR MESSAGES ARE TO BE PRINTED             #YL026UK*/ 05534000
*            /*                                              #YL026UK*/ 05535000
*            /********************************************************/ 05536000
*                                                                  1374 05537000
*            IF (TESTRC = STEPRC  &  S99ERROR = STEPERR  &         1374 05538000
*              S99INFO = STEPINFO)                                 1374 05539000
*              THEN                                                1374 05540000
*                                                                  1374 05541000
         C     @15,@CF00034                                        1374 05542000
         BNE   @RF01374                                            1374 05543000
         CLC   S99ERROR(2),@CB02151                                1374 05544000
         BNE   @RF01374                                            1374 05545000
         CLC   S99INFO(2),@CB01419                                 1374 05546000
         BNE   @RF01374                                            1374 05547000
*                /****************************************************/ 05548000
*                /*                                          @Y30SSMK*/ 05549000
*                /* THE DATA SET THAT WAS UNALLOCATED WAS    @Y30SSMK*/ 05550000
*                /* ALSO A STEPCAT.  DO NOT CONSIDER THIS    @Y30SSMK*/ 05551000
*                /* AS AN ERROR SINCE DYNAMIC ALLOCATION     @Y30SSMK*/ 05552000
*                /* WILL NOT UNALLOCATE IT.                  @Y30SSMK*/ 05553000
*                /*                                          @Y30SSMK*/ 05554000
*                /****************************************************/ 05555000
*                                                                  1375 05556000
*                SETRC = 0;                                /*@Y30SSMK*/ 05557000
         STH   @14,SETRC                                           1375 05558000
*              ELSE                                                1376 05559000
*                                                                  1376 05560000
*                /****************************************************/ 05561000
*                /*                                          @Z40GSBF*/ 05562000
*                /*     TEST FOR TSO IF IT IS THEN CALL UERROR     1376 05563000
*                /*     TO PRINT ERROR MESSAGES AND SET RETURN     1376 05564000
*                /*     CODE TO 4 AND RETURN TO CALLER             1376 05565000
*                /*                                          @Z40GSBF*/ 05566000
*                /****************************************************/ 05567000
*                                                                  1376 05568000
*                DO;                                       /*@Z40GSBF*/ 05569000
         B     @RC01374                                            1376 05570000
@RF01374 DS    0H                                                  1377 05571000
*                  ERRORTAB = ''B;                         /*@ZM43202*/ 05572000
         XC    ERRORTAB(32),ERRORTAB                               1377 05573000
*                  ERCNVADR = ADDR(ERRORTAB);              /*@Z40GSBF*/ 05574000
         LA    @15,ERRORTAB                                        1378 05575000
         ST    @15,ERCNVADR                                        1378 05576000
*                  ERDARBPT = S99RBPTR;                    /*@Z40GSBF*/ 05577000
         L     @14,S99RBPTR                                        1379 05578000
         ST    @14,ERDARBPT(,@15)                                  1379 05579000
*                  ERDYNAL = ON;                           /*@Z40GSBF*/ 05580000
         OI    ERDYNAL(@15),B'00100000'                            1380 05581000
*                  ERDYNRC = TESTRC;                       /*@Z40GSBF*/ 05582000
         LH    @14,TESTRC                                          1381 05583000
         ST    @14,ERDYNRC(,@15)                                   1381 05584000
*                  CALL IDCTPER0(GDTTBL,ERCNVADR);         /*@Z40GSBF*/ 05585000
         ST    GDTPR,@AL00001                                      1382 05586000
         LA    @15,ERCNVADR                                        1382 05587000
         ST    @15,@AL00001+4                                      1382 05588000
         MVI   @AL00001+4,X'80'                                    1382 05589000
         L     @15,GDTERR(,GDTPR)                                  1382 05590000
         LA    @01,@AL00001                                        1382 05591000
         BALR  @14,@15                                             1382 05592000
*                  SETRC = 4;                              /*#YL026UK*/ 05593000
         MVC   SETRC(2),@CH00038                                   1383 05594000
*                END;                                              1384 05595000
*                                                                  1384 05596000
*            END;                                          /*@YL026UK*/ 05597000
*          ELSE                                                    1386 05598000
*                                                                  1386 05599000
*            /********************************************************/ 05600000
*            /*                                              @YL026UK*/ 05601000
*            /* NO ERROR MEGGAGES ARE TO BE PRINTED          @YL026UK*/ 05602000
*            /*                                              @YL026UK*/ 05603000
*            /********************************************************/ 05604000
*                                                                  1386 05605000
*            SETRC = 0;                                    /*@YL026UK*/ 05606000
*                                                                  1386 05607000
         B     @RC01372                                            1386 05608000
@RF01372 SLR   @15,@15                                             1386 05609000
         STH   @15,SETRC                                           1386 05610000
*        /************************************************************/ 05611000
*        /*                                                  @YL026UK*/ 05612000
*        /* RETURN CONTROL TO THE UDEALLOC CALLER WITH THE   @YL026UK*/ 05613000
*        /* RETURN CODE FROM UDEALLOC                        @YL026UK*/ 05614000
*        /*                                                  @YL026UK*/ 05615000
*        /************************************************************/ 05616000
*                                                                  1387 05617000
*        CALL IDCSAEP0(GDTTBL,MODID,SETRC);                        1387 05618000
@RC01372 ST    GDTPR,@AL00001                                      1387 05619000
         LA    @15,MODID                                           1387 05620000
         ST    @15,@AL00001+4                                      1387 05621000
         LA    @15,SETRC                                           1387 05622000
         ST    @15,@AL00001+8                                      1387 05623000
         MVI   @AL00001+8,X'80'                                    1387 05624000
         L     @15,GDTEPL(,GDTPR)                                  1387 05625000
         LA    @01,@AL00001                                        1387 05626000
         BALR  @14,@15                                             1387 05627000
*        /*@YL026UK*/                                              1388 05628000
*        /************************************************************/ 05629000
*        /************************************************************/ 05630000
*        /*                                                  @YL026UK*/ 05631000
*        /* UCIR ENTRY POINT                                 @YL026UK*/ 05632000
*        /*                                                  @YL026UK*/ 05633000
*        /************************************************************/ 05634000
*        /************************************************************/ 05635000
*                                                                  1388 05636000
*AMSSACR:  ENTRY(GDTTBLX,CIRAGLX);                         /*@YL026UK*/ 05637000
*                                                                  1388 05638000
@EC01388 DS    0H                                                  1389 05639000
*AMSSACR1:                                                         1389 05640000
*                                                                  1389 05641000
*        RESPECIFY CIRAGL BASED(PARMPTR2);                 /*@YL026UK*/ 05642000
AMSSACR1 DS    0H                                                  1390 05643000
*                                      /* BASE CATALOG       @YL026UK*/ 05644000
*                                      /* INTERFACE ARGUMENT @YL026UK*/ 05645000
*                                      /* LIST               @YL026UK*/ 05646000
*                                                                  1390 05647000
*        /************************************************************/ 05648000
*        /*                                                  @YL026UK*/ 05649000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    @YL026UK*/ 05650000
*        /*                                                  @YL026UK*/ 05651000
*        /************************************************************/ 05652000
*                                                                  1390 05653000
*        RESPECIFY (REG1PTR) RSTD;                         /*@YL026UK*/ 05654000
*        GDTPR = ADDR1;                                    /*@YL026UK*/ 05655000
         L     GDTPR,ADDR1(,REG1PTR)                               1391 05656000
*        PARMPTR2 = ADDR2;                                 /*@YL026UK*/ 05657000
         L     @00,ADDR2+4(,REG1PTR)                               1392 05658000
         ST    @00,PARMPTR2                                        1392 05659000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*@YL026UK*/ 05660000
*                                                                  1393 05661000
*        OLDERID2 = NEWERID2;                                      1394 05662000
         L     @15,GDTTR2(,GDTPR)                                  1394 05663000
         MVC   @TS00001(95),NEWERID2(@15)                          1394 05664000
         MVC   OLDERID2(95,@15),@TS00001                           1394 05665000
*        NEWID2 = 'SACR';                                  /*@YL026UK*/ 05666000
         MVC   NEWID2(4,@15),@CC02177                              1395 05667000
*        IF GDTDBG = NULLPTR                                       1396 05668000
*          THEN;                                                   1396 05669000
         L     @15,GDTDBG(,GDTPR)                                  1396 05670000
         LTR   @15,@15                                             1396 05671000
         BZ    @RT01396                                            1396 05672000
*          ELSE                                                    1398 05673000
*            CALL IDCDB010(GDTTBL,'ZZCR');                         1398 05674000
         ST    GDTPR,@AL00001                                      1398 05675000
         LA    @15,@CC02178                                        1398 05676000
         ST    @15,@AL00001+4                                      1398 05677000
         MVI   @AL00001+4,X'80'                                    1398 05678000
         L     @15,GDTDBG(,GDTPR)                                  1398 05679000
         LA    @01,@AL00001                                        1398 05680000
         BALR  @14,@15                                             1398 05681000
*                                                          /*@YL026UK*/ 05682000
*                                                                  1399 05683000
*        /*************************************************  @YL026UK*/ 05684000
*        /*                                                  @YL026UK*/ 05685000
*        /* DECLARES USED BY THE UCIR ROUTINE                @YL026UK*/ 05686000
*        /*                                                  @YL026UK*/ 05687000
*        /*************************************************  @YL026UK*/ 05688000
*                                                                  1399 05689000
*        /* ADDRESS OF VSAM CATALOG PARAMETER LIST           @YL026UK*/ 05690000
*        DCL CTGPLPTR PTR (31);                            /*@YL026UK*/ 05691000
*                                                                  1399 05692000
@RT01396 DS    0H                                                  1400 05693000
*        /* INCLUDE CATALOG PARAMETER LIST STRUCTURE         @YL026UK*/ 05694000
*/********************************************************************/ 05695000
*/*                                                                  */ 05696000
*/*   MACRO NAME = IEZCTGPL                                          */ 05697000
*/*                                                                  */ 05698000
*/*   DESCRIPTIVE NAME = CATALOG PARAMETER LIST                      */ 05699000
*/*                                                                  */ 05700000
*/*   FUNCTION = THE CATALOG PARAMETER LIST (CTGPL) DEFINES THE      */ 05701000
*/*              CATALOG MANAGEMENT REQUEST AND ITS OPTIONS, THE     */ 05702000
*/*              CATALOG RECORD TO BE PROCESSED, AND THE VSAM        */ 05703000
*/*              CATALOG THAT CONTAINES THE RECORD.  THE CTGPL IS    */ 05704000
*/*              BUILT BEFORE AN OS/VS COMPONENT ISSUES THE CATLG    */ 05705000
*/*              MACRO INSTRUCTION (SVC 26) TO PROCESS A CATALOG     */ 05706000
*/*              RECORD.  WHEN THE CATALOG MANAGEMENT ROUTINES       */ 05707000
*/*              BUILD A CCA TO SUPPORT THE REQUEST, THE ADDRESS     */ 05708000
*/*              OF THE CTGPL IS PUT INTO THE CCA (CCACPL).          */ 05709000
*/*                                                                  */ 05710000
*/*   CONTROL BLOCK STRUCTURE = THE CTGPL IS POINTED TO BY           */ 05711000
*/*                             REGISTER 1.                          */ 05712000
*/*                                                                  */ 05713000
*/*   INCLUDED MACROS = NONE                                         */ 05714000
*/*                                                                  */ 05715000
*/*   METHOD OF ACCESS = PL/S - NO DECLARES NECESSARY                */ 05716000
*/*                                                                  */ 05717000
*/*   STATUS = VS/2 RELEASE 4   (CHANGE FLAG @Z40WSXX)       @Z40WSSG*/ 05718000
*/*                                                                  */ 05719000
*/*   DATE OF LAST CHANGE = 16 AUG 77                        @ZA20773*/ 05720000
*/*                                                                  */ 05721000
*/********************************************************************/ 05722000
*   DECLARE                                                        1400 05723000
*     1 CTGPL BASED(CTGPLPTR)       /* DECLARE CTGPL LEVEL ONE       */ 05724000
*        BDY(WORD),                 /* WORD BOUNDARY                 */ 05725000
*       5 CTGOPTN1 BIT(8),          /* FIRST OPTION INDICATOR        */ 05726000
*         10 CTGBYPSS BIT(1),       /* BYPASS                        */ 05727000
*         10 CTGMAST  BIT(1),       /* VERIFY MASTER PASSWORD        */ 05728000
*         10 CTGCI    BIT(1),       /* VERIFY CONTROL INTERVAL       */ 05729000
*         10 CTGUPD   BIT(1),       /* VERIFY UPDATE                 */ 05730000
*         10 CTGREAD  BIT(1),       /* VERIFY READ                   */ 05731000
*         10 CTGNAME  BIT(1),       /* 1 = 44-BYTE NAME OR VOL SER,  */ 05732000
*                                   /* 0 = ENTRY ID NUMBER           */ 05733000
*         10 CTGCNAME BIT(1),       /* 1 = 44-BYTE NAME,             */ 05734000
*                                   /* 0 = ACB ADDRESS               */ 05735000
*         10 CTGGENLD BIT(1),       /* GENERIC LOCATE REQUEST  Y02020*/ 05736000
*       5 CTGOPTN2 BIT(8),          /* SECOND OPTION INDICATOR       */ 05737000
*         10 CTGEXT   BIT(1),       /* EXTEND       (UPDATE)         */ 05738000
*            15 CTGNSVS BIT(1),     /* CATLG CLEANUP REQUEST @ZA00605*/ 05739000
*         10 CTGERASE BIT(1),       /* ERASE        (DELETE)         */ 05740000
*            15 CTGSMF   BIT(1),    /* WRITE SMF    (LSPACE)         */ 05741000
*               20 CTGREL   BIT(1), /* RELEASE      (UPDATE)         */ 05742000
*                  25 CTGGTALL BIT(1),/* CONCAT SEARCH  FOR    Y02020*/ 05743000
*                                   /* (LISTCAT)               Y02020*/ 05744000
*         10 CTGPURG  BIT(1),       /* PURGE        (DELETE)         */ 05745000
*           15 CTGVMNT BIT(1),      /* VOLUME MOUNT CALLER           */ 05746000
*              20 CTGRCATN BIT(1),  /* RTN CATLG NAME(GLOC)    Y02020*/ 05747000
*                 25 CTGSWAP BIT(1),/* SWAPSPACE (DEFINE)    @Z40WSSG*/ 05748000
*         10 CTGGTNXT BIT(1),       /* GET NEXT     (LIST CATALOG)   */ 05749000
*         10 CTGDISC BIT(1),        /* DISCONNECT   (DELETE)         */ 05750000
*         10 CTGOVRID BIT(1),       /* ERASE OVERRIDE (DELETE)       */ 05751000
*         10 CTGSCR   BIT(1),       /* SCRATCH SPACE (DELETE)        */ 05752000
*         10 *        BIT(1),       /* RESERVED                      */ 05753000
*       5 CTGOPTN3 BIT(8),          /* THIRD OPTION INDICATOR        */ 05754000
*         10 CTGFUNC  BIT(3),       /* CATALOG FUNCTION              */ 05755000
*         10 CTGSUPLT BIT(1),       /* SUPER LOCATE                  */ 05756000
*         10 CTGGDGL  BIT(1),       /* GDG LOCATE REQUEST      Y02020*/ 05757000
*                                   /* WITH BASE LEVEL GIVEN   Y02020*/ 05758000
*                                   /* (CTGWAGB IN CTGWA)      Y02020*/ 05759000
*         10 CTGSRH   BIT(1),       /* 0 = SEARCH MASTER CATLG Y02020*/ 05760000
*                                   /*     ONLY                Y02020*/ 05761000
*                                   /* 1 = SEARCH OS CATALOG FIRST   */ 05762000
*         10 CTGNUM   BIT(1),       /* 0 = SEARCH BOTH CATALOGS,     */ 05763000
*                                   /* 1 = SEARCH ONE CATALOG        */ 05764000
*         10 CTGAM0   BIT(1),       /* VSAM REQ VERSUS NONVSAM       */ 05765000
*       5 CTGOPTN4 BIT(8),          /* GDG FLAGS                     */ 05766000
*         10 CTGLBASE BIT(1),       /* LOCATE GDG BASE ONLY Y02020   */ 05767000
*         10 CTGDOCAT BIT(1),       /* DO NOT OPEN NEEDED CATALOG    */ 05768000
*         10 CTGNPROF BIT(1),       /* NO (RAC) PROFILE SHOULD BE  1400 05769000
*                                      DEFINED OR DELETED    @Z40RSRC*/ 05770000
*         10 CTGCOIN  BIT(1),       /* CONTROLLER INTERCEPT REQUESTED   05771000
*                                                            @ZA20773*/ 05772000
*         10 CTGBYPMT BIT(1),       /* BYPASS SECURITY PROMPTING   1400 05773000
*                                       TO SYSTEM OPERATOR   @ZA07531*/ 05774000
*         10 CTGTIOT  BIT(1),       /* CALLER OWNS SYSZTIOT EXCLUSIVE   05775000
*                                                            @ZA20773*/ 05776000
*         10 *        BIT(2),       /* RESERVED              @ZA20773*/ 05777000
*       5 CTGENT   PTR(31),         /* USER ENTRY ADDR OR PTR TO VOLUME 05778000
*                                        SERIAL NUMBER (LSPACE)      */ 05779000
*         10 CTGFVT   PTR(31),      /* FVT ADDRESS (DEFINE, ALTER)   */ 05780000
*       5 CTGCAT   PTR(31),         /* CATALOG POINTER               */ 05781000
*         10 CTGCVOL PTR(31),       /* CVOL PTR (SUPER LOCATE)       */ 05782000
*       5 CTGWKA  PTR(31),          /* WORKAREA ADDR                 */ 05783000
*       5 CTGDSORG CHAR(2),         /* DATA SET ORG - SUPERLOCATE    */ 05784000
*         10 CTGOPTNS BIT(5),       /* CMS OPTIONS                   */ 05785000
*         10 *        BIT(11),      /* RESERVED                      */ 05786000
*       5 CTGTYPE  CHAR(1),         /* ENTRY TYPE - LISTCAT, DELETE  */ 05787000
*       5 CTGNOFLD PTR(8),          /* NUMBER OF FIELD POINTERS      */ 05788000
*       5 CTGDDNM PTR(31),          /* DD NAME ADDR                  */ 05789000
*         10 CTGNEWNM PTR(31),      /* NEWNAME ADDRESS - ALTER       */ 05790000
*            15 CTGFDBK  PTR(16),   /* SUPER LOCATE FEEDBACK         */ 05791000
*            15 CTGFBFLG BIT(16),   /* SUPER LOCATE FLAGS            */ 05792000
*               20 CTGPAR   BIT(1), /* PARALLEL MOUNT -SUPERLOCATE   */ 05793000
*               20 CTGKEEP  BIT(1), /* FORCED KEEP - SUPERLOCATE     */ 05794000
*               20 CTGGDGB  BIT(1), /* GDG BASE LOCATE         Y02020*/ 05795000
*               20 CTGNGDSN BIT(1), /* GDG NAME GENERATED      Y02020*/ 05796000
*               20 *        BIT(12), /* RESERVED               Y02020*/ 05797000
*       5 CTGJSCB  PTR(31),         /* JSCB ADDR                     */ 05798000
*         10 CTGPSWD  PTR(31),      /* PASSWORD ADDR                 */ 05799000
*       5 CTGFIELD(*) PTR(31) ;        /* FIELD POINTERS             */ 05800000
*/********************************************************************/ 05801000
*/*     CONSTANTS USED TO SET AND/OR TEST FIELDS DECLARED ABOVE      */ 05802000
*/********************************************************************/ 05803000
*   DECLARE                         /* CATALOG FUNCTION - CTGFUNC    */ 05804000
*     CTGLOC   BIT(3) CONSTANT('001'B), /* LOCATE                    */ 05805000
*     CTGLSP   BIT(3) CONSTANT('010'B), /* LSPACE                    */ 05806000
*     CTGUPDAT BIT(3) CONSTANT('011'B), /* UPDATE                    */ 05807000
*     CTGCMS   BIT(3) CONSTANT('100'B); /* CMS FUNCTION              */ 05808000
*   DECLARE                         /* CMS OPTIONS - CTGOPTNS        */ 05809000
*     CTGDEFIN BIT(5) CONSTANT('00001'B), /* DEFINE                  */ 05810000
*     CTGALTER BIT(5) CONSTANT('00010'B), /* ALTER                   */ 05811000
*     CTGDELET BIT(5) CONSTANT('00011'B), /* DELETE                  */ 05812000
*     CTGLTCAT BIT(5) CONSTANT('00100'B), /* LIST CATALOG            */ 05813000
*     CTGCNVTV BIT(5) CONSTANT('00110'B); /* CONVERTV        @Y30LSPS*/ 05814000
*   DECLARE                           /* RECORD ENTRY TYPE - CTGTYPE */ 05815000
*     CTGTDATA CHAR(1) CONSTANT('D'), /* DATA                        */ 05816000
*     CTGTINDX CHAR(1) CONSTANT('I'), /* INDEX                       */ 05817000
*     CTGTALIN CHAR(1) CONSTANT('A'), /* ALIEN                       */ 05818000
*     CTGTUCAT CHAR(1) CONSTANT('U'), /* USER CATALOG                */ 05819000
*     CTGTVOL  CHAR(1) CONSTANT('V'), /* VOLUME                      */ 05820000
*     CTGTCL   CHAR(1) CONSTANT('C'), /* CLUSTER                     */ 05821000
*     CTGTAIX  CHAR(1) CONSTANT('G'), /* ALTERNATE INDEX     @Y30SSPJ*/ 05822000
*     CTGTPATH CHAR(1) CONSTANT('R'), /* PATH                @Y30SSPJ*/ 05823000
*     CTGTFREE CHAR(1) CONSTANT('F'), /* FREE                @Y30SSPJ*/ 05824000
*     CTGTPTH  CHAR(1) CONSTANT('R'), /* PATH                @Y30SSSB*/ 05825000
*     CTGTUPG  CHAR(1) CONSTANT('Y'), /* UPGRADE             @Y30SSSB*/ 05826000
*     CTGTGBS  CHAR(1) CONSTANT('B'), /* GDG BASE              Y02020*/ 05827000
*     CTGTANM  CHAR(1) CONSTANT('X'), /* ALIAS NAME            Y02020*/ 05828000
*     CTGTPGSP CHAR(1) CONSTANT('P'), /* PAGE SPACE            Y02020*/ 05829000
*     CTGTMCAT CHAR(1) CONSTANT('M'); /* MASTER CATALOG              */ 05830000
*/********************************************************************/ 05831000
*/*                 PROBLEM  DETERMINATION  FIELDS                   */ 05832000
*/********************************************************************/ 05833000
*   DECLARE                                                        1404 05834000
*     1 * DEF(CTGDDNM),             /* PROBLEM DETERMINATION @Y30SSJG*/ 05835000
*       2 CTGPROB CHAR(4),          /* PROBLEM DETERMINATION @Y30SSJG*/ 05836000
*         3 CTGMODID CHAR(2),       /* MODULE IDENTIFICATION @Y30SSJG*/ 05837000
*         3 CTGREASN CHAR(2),       /* REASON CODE           @Y30SSJG*/ 05838000
*           4 CTGREAS1 CHAR(1),     /* HIGH ORDER BYTE ZERO  @Y30SSJG*/ 05839000
*           4 CTGREAS2 CHAR(1);     /* REASON CODE LOW BYTE  @Y30SSJG*/ 05840000
*                                                                  1404 05841000
*        /* DYNAMIC STORAGE FOR CATALOG PARAMETER LIST       @YL026UK*/ 05842000
*        DCL CATLIST CHAR (LENGTH (CTGPL));                /*@YL026UK*/ 05843000
*                                                                  1405 05844000
*        /* WORKAREA WHERE CATALOG RETURNS INFORMATION       @YL026UK*/ 05845000
*        DCL 1 WORKAREA BDY (WORD) BASED (POOLADDR),               1406 05846000
*              2 WORKNUM FIXED (32) UNSIGNED, /* NUMBER MATCHING */     05847000
*                                                          /*@OZ04524*/ 05848000
*                3 WORKLEN FIXED (16) UNSIGNED, /* SET WORKAREA LEN */  05849000
*                                                          /*@OZ04524*/ 05850000
*                3 WORKRET FIXED (16) UNSIGNED, /* LENGTH RETURNED */   05851000
*                                                          /*@OZ04524*/ 05852000
*              2 WORKENT (8) CHAR (45),/* ENTRIES            @YL026UK*/ 05853000
*                3 ENTTYPE CHAR (1),   /* ENTRY TYPE         @YL026UK*/ 05854000
*                3 DSNAME CHAR (44);   /* DATA SET NAME      @YL026UK*/ 05855000
*                                                                  1406 05856000
*        /* ADDRESS OF DSNAME BEING PROCESSED                @YL026UK*/ 05857000
*        DCL COMPPTR PTR (31);                             /*@YL026UK*/ 05858000
*                                                                  1407 05859000
*        /* DATA SET NAME BEING PROCESSED                    @YL026UK*/ 05860000
*        DCL COMPNAME CHAR (44) BASED (COMPPTR);           /*@YL026UK*/ 05861000
*                                                                  1408 05862000
*        /* ADDRESS OF TRAILING QUALIFIERS TO COMPARE        @YL026UK*/ 05863000
*        DCL CTRLPTR PTR (31);                             /*@YL026UK*/ 05864000
*                                                                  1409 05865000
*        /* TRAILER QUALIFIERS IN DSNAME TO COMPARE          @YL026UK*/ 05866000
*        DCL DSCMPTRL CHAR (44) BASED (CTRLPTR);           /*@YL026UK*/ 05867000
*                                                                  1410 05868000
*        /* ENTRY TYPE IDENTIFYING A CATALOG                 @YL026UK*/ 05869000
*        DCL CATTYPE CHAR (1) CONSTANT ('0');              /*@YL026UK*/ 05870000
*                                                                  1411 05871000
*        /* RETURN CODE FROM GENERIC LOCATE                  @YL026UK*/ 05872000
*        DCL CATRC FIXED (15);                             /*@YL026UK*/ 05873000
*                                                                  1412 05874000
*        /* MAXIMUM NUMBER OF ENTRIES IN WORKAREA            @OZ18318*/ 05875000
*        DCL MAXNO FIXED (31) CONSTANT (1456);             /*@OZ18318*/ 05876000
*                                                                  1413 05877000
*        /* INITIAL NUMBER OF ENTRIES IN WORKAREA            @YL026UK*/ 05878000
*        DCL INITNO FIXED (31) CONSTANT (182);             /*@OZ26403*/ 05879000
*                                                                  1414 05880000
*        /* NUMBER OF ENTRIES IN WORKAREA                    @YL026UK*/ 05881000
*        DCL WNOENT FIXED(31);                             /*@YL026UK*/ 05882000
*                                                                  1415 05883000
*        /* AMOUNT OF STORAGE REQUESTED                      @YL026UK*/ 05884000
*        DCL POOLSIZE FIXED (31);                          /*@YL026UK*/ 05885000
*                                                                  1416 05886000
*        /* ADDRESS OF UGPOOL AREA                           @YL026UK*/ 05887000
*        DCL POOLADDR PTR (31);                            /*@YL026UK*/ 05888000
*                                                                  1417 05889000
*        /* WORKAREA WHERE POOL ADDRESS RETURNED TO USER     @YL026UK*/ 05890000
*        DCL RETPOOL PTR (31) BASED (CIRWKP);              /*@YL026UK*/ 05891000
*                                                                  1418 05892000
*        /* NAME WORKAREA REQUIRED BY CATALOG                @YL026UK*/ 05893000
*        DCL 1 NAMEAREA BDY (WORD),                                1419 05894000
*              2 NAMELEN FIXED (8),    /* LENGTH OF QUAL     @YL026UK*/ 05895000
*              2 LOCNAME CHAR (44);    /* LOCATE QUALIFIER   @YL026UK*/ 05896000
*                                                                  1419 05897000
*        /* HEADER QUALIFIER SUPPLIED IN CIRAGL              @YL026UK*/ 05898000
*        DCL HEADER CHAR (44) BASED (CIRHDR);              /*@YL026UK*/ 05899000
*                                                                  1420 05900000
*        /* TRAILER QUALIFIER SUPPLIED BY CIRAGL             @YL026UK*/ 05901000
*        DCL TRAILER CHAR (44) BASED (CIRTLR);             /*@YL026UK*/ 05902000
*                                                                  1421 05903000
*        /* STID NUMBER FOR NO STORAGE AVAILABLE             @YL026UK*/ 05904000
*        DCL NOCRSTID FIXED (8) CONSTANT (26);             /*@YL026UK*/ 05905000
*                                                                  1422 05906000
*        /* STID NUMBER FOR ERROR FROM CATALOG               @YL026UK*/ 05907000
*        DCL ECATSTID FIXED (8) CONSTANT (7);              /*@YL026UK*/ 05908000
*                                                                  1423 05909000
*        /* STID FOR ENTRY XX NOT FOUND                      @ZA01484*/ 05910000
*        DCL NOTFSTID FIXED(8) CONSTANT(13);               /*@ZA01484*/ 05911000
*                                                                  1424 05912000
*        /* RETURN CODE FROM CATALOG WHEN WORKAREA IS        @YL026UK*/ 05913000
*        /* TOO SMALL AND REQUIRED LENGTH COULD NOT BE       @YL026UK*/ 05914000
*        /* DETERMINED.                                      @YL026UK*/ 05915000
*        DCL LARGSIZE FIXED (15) CONSTANT (44);            /*@YL026UK*/ 05916000
*                                                                  1425 05917000
*        /* RETURN CODE FROM CATALOG IF WORKAREA IS T00 SMALL@YL026UK*/ 05918000
*        /* AND REQUIRED LENGTH IS RETURNED IN THE WORKAREA. @YL026UK*/ 05919000
*        DCL KNOWSIZE FIXED (15) CONSTANT (40);            /*@YL026UK*/ 05920000
*                                                                  1426 05921000
*        /* RETURN CODE THAT IS RETURNED TO CALLER           @YL026UK*/ 05922000
*        DCL UCIRRC FIXED (15);                            /*@YL026UK*/ 05923000
*                                                                  1427 05924000
*        /* INDICATOR FOR UGPOOL AND UCATLG LOOP             @YL026UK*/ 05925000
*        DCL ACTION FIXED (15);                            /*@YL026UK*/ 05926000
*                                                                  1428 05927000
*        /* STOP LOOP PROCESSING                             @YL026UK*/ 05928000
*        DCL STOP FIXED (15) CONSTANT (0);                 /*@YL026UK*/ 05929000
*                                                                  1429 05930000
*        /* PROCESS LOOP AGAIN                               @YL026UK*/ 05931000
*        DCL AGAIN FIXED (15) CONSTANT (4);                /*@YL026UK*/ 05932000
*                                                                  1430 05933000
*        /* ERROR DETECTED IN LOOP                           @YL026UK*/ 05934000
*        DCL ERROR FIXED (15) CONSTANT (8);                /*@YL026UK*/ 05935000
*                                                                  1431 05936000
*        /* STATUS OF ENTRY BEING CHECKED                    @YL026UK*/ 05937000
*        DCL MATCH FIXED (15);                             /*@YL026UK*/ 05938000
*                                                                  1432 05939000
*        /* ENTRY DOES NOT MATCH                             @YL026UK*/ 05940000
*        DCL NOTEQUAL FIXED (15) CONSTANT (0);             /*@YL026UK*/ 05941000
*                                                                  1433 05942000
*        /* ENTRY MATCHES USER SPECIFICATIONS                @YL026UK*/ 05943000
*        DCL EQUAL FIXED (15) CONSTANT (4);                /*@YL026UK*/ 05944000
*                                                                  1434 05945000
*        /* ALL ENTRIES ARE EQUAL                            @YL026UK*/ 05946000
*        DCL ALLEQUAL FIXED (15) CONSTANT (8);             /*@YL026UK*/ 05947000
*                                                                  1435 05948000
*        /* STATUS INDICATOR WHEN SEARCHING FOR QUALIFIER    @YL026UK*/ 05949000
*        /* SEPARATOR.                                       @YL026UK*/ 05950000
*        DCL SEPER FIXED (15);                             /*@YL026UK*/ 05951000
*                                                                  1436 05952000
*        /* SEPARATOR NOT FOUND                              @YL026UK*/ 05953000
*        DCL NOTFOUND FIXED (15) CONSTANT (0);             /*@YL026UK*/ 05954000
*                                                                  1437 05955000
*        /* SEPARATOR FOUND                                  @YL026UK*/ 05956000
*        DCL FOUND FIXED (15) CONSTANT (4);                /*@YL026UK*/ 05957000
*                                                                  1438 05958000
*        /* FIRST CHARACTER OFFSET TO QUAL AFTER HEADER      @YL026UK*/ 05959000
*        DCL NEXTQUAL FIXED (15);                          /*@YL026UK*/ 05960000
*                                                                  1439 05961000
*        /* TOTAL LENGTH OF DATA SET NAME                    @YL026UK*/ 05962000
*        DCL TOTALLEN FIXED (15) CONSTANT (44);            /*@YL026UK*/ 05963000
*                                                                  1440 05964000
*        /* COUNTER TO CHECK EACH RETURNED ENTRY             @YL026UK*/ 05965000
*        DCL CKENT FIXED (15);                             /*@YL026UK*/ 05966000
*                                                                  1441 05967000
*        /* COUNTER USED TO CHECK BYTES IN DSNAME ENTRY      @YL026UK*/ 05968000
*        DCL BYTECTR FIXED (15);                           /*@YL026UK*/ 05969000
*                                                                  1442 05970000
*        /* OFFSET TO TRAILING QUALIFIER IN DATA SET NAME    @YL026UK*/ 05971000
*        DCL TRLQUAL FIXED (15);                           /*@YL026UK*/ 05972000
*                                                                  1443 05973000
*        /* BYTE OFFSET OF BYTE PRECEDING TRAILER QUAL       @YL026UK*/ 05974000
*        DCL TOTRAIL FIXED (15);                           /*@YL026UK*/ 05975000
*                                                                  1444 05976000
*        /* NEXT BYTE AFTER THE LAST BYTE OF TRAILER         @YL026UK*/ 05977000
*        DCL LASTBYTE FIXED (15);                          /*@YL026UK*/ 05978000
*                                                                  1445 05979000
*        /* LENGTH OF QUALIFIER SPECIFIED BY CIRAGL          @YL026UK*/ 05980000
*        DCL TRLLEN FIXED (15);                            /*@YL026UK*/ 05981000
*                                                                  1446 05982000
*        /* TOTAL NUMBER OF ENTRIES RETURNED BY CATALOG      @YL026UK*/ 05983000
*        DCL CATRETNO FIXED (15);                          /*@YL026UK*/ 05984000
*                                                                  1447 05985000
*        /* RETURN CODE IF NO ENTRIES IN LIST,  SAME         @YL026UH*/ 05986000
*        /* CODE CATALOG MANAGEMENT RETURNS IF NO ENTRY      @YL026UH*/ 05987000
*        /* IS FOUND.                                        @YL026UH*/ 05988000
*        DCL NODSENT FIXED (15) CONSTANT (8);              /*@YL026UH*/ 05989000
*                                                                  1448 05990000
*        /* CATALOG RETURN CODE = 8, NO ENTRY FOUND          @Y30SSMK*/ 05991000
*        DCL CATRC8 FIXED(15) CONSTANT(8);                 /*@Y30SSMK*/ 05992000
*                                                                  1449 05993000
*        /************************************************************/ 05994000
*        /*                                                  @YL026UK*/ 05995000
*        /* CHECK FOR CONDITION WHERE BOTH THE ONE QUAL      @YL026UK*/ 05996000
*        /* FUNCTION AND THE ALL QUAL FUNCTION IS REQUESTED  @YL026UK*/ 05997000
*        /* OR WHERE NEITHER IS REQUESTED--UABORT IF EITHER  @YL026UK*/ 05998000
*        /* CONDITION IS DECTECTED.                          @YL026UK*/ 05999000
*        /*                                                  @YL026UK*/ 06000000
*        /************************************************************/ 06001000
*                                                                  1450 06002000
*        IF (CIRTYP1Q = ON & CIRTYPAQ = ON) |                      1450 06003000
*           (CIRTYP1Q = OFF & CIRTYPAQ = OFF)                      1450 06004000
*          THEN                                                    1450 06005000
*                                                                  1450 06006000
         L     @15,PARMPTR2                                        1450 06007000
         TM    CIRTYP1Q(@15),B'11000000'                           1450 06008000
         BO    @RT01450                                            1450 06009000
         TM    CIRTYP1Q(@15),B'11000000'                           1450 06010000
         BNZ   @RF01450                                            1450 06011000
@RT01450 DS    0H                                                  1451 06012000
*            DO;                                                   1451 06013000
*              RESPECIFY(REG13,REG14,REG15) RSTD;                  1452 06014000
*              REG15 = ARGERR;                                     1453 06015000
         LA    REG15,40                                            1453 06016000
*              REG14 = GDTABT;                                     1454 06017000
         L     REG14,GDTABT(,GDTPR)                                1454 06018000
*              REG13 = GDTABH;                                     1455 06019000
         L     REG13,GDTABH(,GDTPR)                                1455 06020000
*              GEN(BR    REG14);                                   1456 06021000
         BR    REG14                                                    06022000
*              RESPECIFY(REG13,REG14,REG15)UNRSTD;                 1457 06023000
*            END;                               /*@YL026UK*/       1458 06024000
*                                                                  1458 06025000
*        /*************************************************  @YL026UK*/ 06026000
*        /*                                                  @YL026UK*/ 06027000
*        /* INITIALIZE RETURN CODE.                          @YL026UK*/ 06028000
*        /* SET ADDRESSABILITY AND INITIALIZE MESSAGE AREA.  @YL026UK*/ 06029000
*        /* SET ADDRESSABILITY TO CATALOG PARAMETER LIST.    @YL026UK*/ 06030000
*        /*                                                  @YL026UK*/ 06031000
*        /*************************************************  @YL026UK*/ 06032000
*                                                                  1459 06033000
*        UCIRRC = 0;                                       /*@YL026UK*/ 06034000
@RF01450 SLR   @15,@15                                             1459 06035000
         STH   @15,UCIRRC                                          1459 06036000
*        DDSTRU = ADDR (MSGAREA);                          /*@YL026UK*/ 06037000
         LA    @14,MSGAREA                                         1460 06038000
         ST    @14,DDSTRU                                          1460 06039000
*        DARGLIST = ''B;                                   /*@YL026UK*/ 06040000
*                                                                  1461 06041000
         XC    DARGLIST(20,@14),DARGLIST(@14)                      1461 06042000
*        CTGPLPTR = ADDR (CATLIST);                        /*@YL026UK*/ 06043000
*                                                                  1462 06044000
         LA    @14,CATLIST                                         1462 06045000
         ST    @14,CTGPLPTR                                        1462 06046000
*        /*************************************************  @YL026UK*/ 06047000
*        /*                                                  @YL026UK*/ 06048000
*        /* INITIALIZE CTGPL FLAGS AND SET GENERIC NAME      @YL026UK*/ 06049000
*        /* TO BE LOCATED.                                   @YL026UK*/ 06050000
*        /*                                                  @YL026UK*/ 06051000
*        /*************************************************  @YL026UK*/ 06052000
*                                                                  1463 06053000
*        CATLIST = ''B;                                    /*@YL026UK*/ 06054000
         XC    CATLIST(28),CATLIST                                 1463 06055000
*        CTGNAME = ON;                                     /*@YL026UK*/ 06056000
         OI    CTGNAME(@14),B'00000100'                            1464 06057000
*        CTGSUPLT = ON;                                    /*@YL026UK*/ 06058000
         OI    CTGSUPLT(@14),B'00010000'                           1465 06059000
*        CTGGENLD = ON;                                    /*@YL026UK*/ 06060000
         OI    CTGGENLD(@14),B'00000001'                           1466 06061000
*        CTGAM0 = ON;                                      /*@YL026UK*/ 06062000
         OI    CTGAM0(@14),B'00000001'                             1467 06063000
*        CTGRCATN = ON;                                    /*@YL026UK*/ 06064000
*                                                                  1468 06065000
         OI    CTGRCATN(@14),B'00100000'                           1468 06066000
*        NAMELEN = CIRHLN;                                 /*@YL026UK*/ 06067000
         L     @07,PARMPTR2                                        1469 06068000
         LH    @06,CIRHLN(,@07)                                    1469 06069000
         STC   @06,NAMELEN                                         1469 06070000
*        LOCNAME = ' ';                                    /*@YL026UK*/ 06071000
         MVI   LOCNAME+1,C' '                                      1470 06072000
         MVC   LOCNAME+2(42),LOCNAME+1                             1470 06073000
         MVI   LOCNAME,C' '                                        1470 06074000
*        LOCNAME (1:NAMELEN) = HEADER (1:NAMELEN);         /*@YL026UK*/ 06075000
         BCTR  @06,0                                               1471 06076000
         L     @01,CIRHDR(,@07)                                    1471 06077000
         EX    @06,@SM02482                                        1471 06078000
*        CTGENT = ADDR (NAMEAREA);                         /*@YL026UK*/ 06079000
*                                                                  1472 06080000
         LA    @06,NAMEAREA                                        1472 06081000
         ST    @06,CTGENT(,@14)                                    1472 06082000
*        /*************************************************  @YL026UK*/ 06083000
*        /*                                                  @YL026UK*/ 06084000
*        /* SET ADDRESS OF PASSWORD IN CTGPL. ADDRESS WILL   @YL026UK*/ 06085000
*        /* BE ZERO IF NO PASSWORD SUPPLIED                  @YL026UK*/ 06086000
*        /*                                                  @YL026UK*/ 06087000
*        /*************************************************  @YL026UK*/ 06088000
*                                                                  1473 06089000
*        CTGPSWD = CIRPWD;                                 /*@YL026UK*/ 06090000
*                                                                  1473 06091000
         L     @06,CIRPWD(,@07)                                    1473 06092000
         ST    @06,CTGPSWD(,@14)                                   1473 06093000
*        /*************************************************  @YL026UK*/ 06094000
*        /*                                                  @YL026UK*/ 06095000
*        /* IF CATALOG IS SUPPLIED, SET CATALOG FLAG AND     @YL026UK*/ 06096000
*        /* SET CATALOG NAME IN CTGPL                        @YL026UK*/ 06097000
*        /*                                                  @YL026UK*/ 06098000
*        /*************************************************  @YL026UK*/ 06099000
*                                                                  1474 06100000
*        IF CIRCAT ^= NULLPTR                                      1474 06101000
*          THEN                                                    1474 06102000
         L     @07,CIRCAT(,@07)                                    1474 06103000
         CR    @07,@15                                             1474 06104000
         BE    @RF01474                                            1474 06105000
*            DO;                                           /*@YL026UK*/ 06106000
*              CTGCNAME = ON;                              /*@YL026UK*/ 06107000
         OI    CTGCNAME(@14),B'00000010'                           1476 06108000
*              CTGCAT = CIRCAT;                            /*@YL026UK*/ 06109000
         ST    @07,CTGCAT(,@14)                                    1477 06110000
*            END;                                          /*@YL026UK*/ 06111000
*                                                                  1478 06112000
*        /*************************************************  @YL026UK*/ 06113000
*        /*                                                  @YL026UK*/ 06114000
*        /* A LOOP IS EXECUTED TO OBTAIN A WORKAREA,         @YL026UK*/ 06115000
*        /* THE LOOP INDICATOR IS SET TO EXECUTE LOOP AND    @YL026UK*/ 06116000
*        /* THE INITIAL NUMBER OF ENTRIES IN THE WORKAREA    @YL026UK*/ 06117000
*        /* IS SET.                                          @YL026UK*/ 06118000
*        /*                                                  @YL026UK*/ 06119000
*        /*************************************************  @YL026UK*/ 06120000
*                                                                  1479 06121000
*        ACTION = AGAIN;                                   /*@YL026UK*/ 06122000
@RF01474 MVC   ACTION(2),@CH00038                                  1479 06123000
*        WNOENT = INITNO;                                  /*@YL026UK*/ 06124000
*                                                                  1480 06125000
         MVC   WNOENT(4),@CF02316                                  1480 06126000
*        /*************************************************  @YL026UK*/ 06127000
*        /*                                                  @YL026UK*/ 06128000
*        /* LOOP IS EXECUTED UNTIL LOCATE IS SUCCESSFUL OR   @YL026UK*/ 06129000
*        /* UNITL AN ERROR IS DETECTED AND PROCESSING CANNOT @YL026UK*/ 06130000
*        /* CONTINUE.                                        @YL026UK*/ 06131000
*        /*                                                  @YL026UK*/ 06132000
*        /*************************************************  @YL026UK*/ 06133000
*                                                                  1481 06134000
*CTLLOOP:                                                          1481 06135000
*        DO WHILE ACTION = AGAIN;                          /*@YL026UK*/ 06136000
*                                                                  1481 06137000
CTLLOOP  B     @DE01481                                            1481 06138000
@DL01481 DS    0H                                                  1482 06139000
*          /***********************************************  @YL026UK*/ 06140000
*          /*                                                @YL026UK*/ 06141000
*          /* CALCULATE POOLSIZE AND ISSUE UGPOOL MACRO.     @YL026UK*/ 06142000
*          /*                                                @YL026UK*/ 06143000
*          /***********************************************  @YL026UK*/ 06144000
*                                                                  1482 06145000
*          POOLSIZE = (WNOENT * 45) + 4;                   /*@YL026UK*/ 06146000
*                                                                  1482 06147000
         L     @15,WNOENT                                          1482 06148000
         MH    @15,@CH02303                                        1482 06149000
         AL    @15,@CF00038                                        1482 06150000
         ST    @15,POOLSIZE                                        1482 06151000
*          CALL IDCSAGP0 (GDTTBL,POOLSIZE,POOLADDR,CIRPID);/*@YL026UK*/ 06152000
         ST    GDTPR,@AL00001                                      1483 06153000
         LA    @15,POOLSIZE                                        1483 06154000
         ST    @15,@AL00001+4                                      1483 06155000
         LA    @15,POOLADDR                                        1483 06156000
         ST    @15,@AL00001+8                                      1483 06157000
         L     @01,PARMPTR2                                        1483 06158000
         LA    @15,CIRPID(,@01)                                    1483 06159000
         ST    @15,@AL00001+12                                     1483 06160000
         MVI   @AL00001+12,X'80'                                   1483 06161000
         L     @15,GDTGPL(,GDTPR)                                  1483 06162000
         LA    @01,@AL00001                                        1483 06163000
         BALR  @14,@15                                             1483 06164000
*          RESPECIFY (RTNREG) RSTD;                        /*@YL026UK*/ 06165000
*          RESPECIFY RTNREG RSTD;                                  1485 06166000
*          TESTRC = RTNREG;                                        1486 06167000
         STH   RTNREG,TESTRC                                       1486 06168000
*          RESPECIFY RTNREG UNRSTD;                        /*@YL026UK*/ 06169000
*          RESPECIFY (RTNREG) UNRSTD;                      /*@YL026UK*/ 06170000
*                                                                  1488 06171000
*          /***********************************************  @YL026UK*/ 06172000
*          /*                                                @YL026UK*/ 06173000
*          /* IF THE UGPOOL REQUEST WAS SUCCESSFUL THE       @YL026UK*/ 06174000
*          /* UCATLG MACRO WILL BE ISSUED.                   @YL026UK*/ 06175000
*          /*                                                @YL026UK*/ 06176000
*          /***********************************************  @YL026UK*/ 06177000
*                                                                  1489 06178000
*          IF TESTRC = 0                                           1489 06179000
*            THEN                                                  1489 06180000
         LH    @15,TESTRC                                          1489 06181000
         LTR   @15,@15                                             1489 06182000
         BNZ   @RF01489                                            1489 06183000
*STOROK:       DO;                                         /*@YL026UK*/ 06184000
*                                                                  1490 06185000
STOROK   DS    0H                                                  1491 06186000
*                /*****************************************  @YL026UK*/ 06187000
*                /*                                          @YL026UK*/ 06188000
*                /* SET ADDR OF WORKAREA IN CTGPL AND        @YL026UK*/ 06189000
*                /* LENGTH OF WORKAREA IN THE WORKAREA.      @YL026UK*/ 06190000
*                /*                                          @YL026UK*/ 06191000
*                /*****************************************  @YL026UK*/ 06192000
*                                                                  1491 06193000
*                CTGWKA = POOLADDR;                        /*@YL026UK*/ 06194000
         L     @15,POOLADDR                                        1491 06195000
         L     @14,CTGPLPTR                                        1491 06196000
         ST    @15,CTGWKA(,@14)                                    1491 06197000
*                WORKLEN = POOLSIZE;                       /*@YL026UK*/ 06198000
         L     @14,POOLSIZE                                        1492 06199000
         STH   @14,WORKLEN(,@15)                                   1492 06200000
*                WORKRET = 4;                              /*@YL026UH*/ 06201000
*                                                                  1493 06202000
         MVC   WORKRET(2,@15),@CH00038                             1493 06203000
*                /*****************************************  @YL026UK*/ 06204000
*                /*                                          @YL026UK*/ 06205000
*                /* ISSUE GENERIC LOCATE AND SAVE RC         @YL026UK*/ 06206000
*                /*                                          @YL026UK*/ 06207000
*                /*****************************************  @YL026UK*/ 06208000
*                                                                  1494 06209000
*                CALL IDCSACA0 (GDTTBL,CTGPLPTR);          /*@YL026UK*/ 06210000
*                                                                  1494 06211000
         ST    GDTPR,@AL00001                                      1494 06212000
         LA    @15,CTGPLPTR                                        1494 06213000
         ST    @15,@AL00001+4                                      1494 06214000
         L     @15,GDTCAT(,GDTPR)                                  1494 06215000
         LA    @01,@AL00001                                        1494 06216000
         BALR  @14,@15                                             1494 06217000
*                RESPECIFY (RTNREG) RSTD;                  /*@YL026UK*/ 06218000
*                RESPECIFY RTNREG RSTD;                            1496 06219000
*                TESTRC = RTNREG;                                  1497 06220000
         STH   RTNREG,TESTRC                                       1497 06221000
*                RESPECIFY RTNREG UNRSTD;                  /*@YL026UK*/ 06222000
*                RESPECIFY (RTNREG) UNRSTD;                /*@YL026UK*/ 06223000
*                                                                  1499 06224000
*                CATRC = TESTRC;                           /*@YL026UK*/ 06225000
*                                                                  1500 06226000
         LH    @15,TESTRC                                          1500 06227000
         STH   @15,CATRC                                           1500 06228000
*                /*****************************************  @YL026UK*/ 06229000
*                /*                                          @YL026UK*/ 06230000
*                /* IF THE LOCATE WAS SUCCESSFUL THE ACTION  @YL026UK*/ 06231000
*                /* INDICATOR IS SET TO STOP LOOP.           @YL026UK*/ 06232000
*                /*                                          @YL026UK*/ 06233000
*                /*****************************************  @YL026UK*/ 06234000
*                                                                  1501 06235000
*                IF CATRC = 0                                      1501 06236000
*                  THEN                                            1501 06237000
         SLR   @14,@14                                             1501 06238000
         CR    @15,@14                                             1501 06239000
         BNE   @RF01501                                            1501 06240000
*                    ACTION = STOP;                        /*@YL026UK*/ 06241000
*                                                                  1502 06242000
         STH   @14,ACTION                                          1502 06243000
*                  /***************************************  @YL026UK*/ 06244000
*                  /*                                        @YL026UK*/ 06245000
*                  /* CATALOG ROUTINE DETECTED AN ERROR.     @YL026UK*/ 06246000
*                  /*                                        @YL026UK*/ 06247000
*                  /***************************************  @YL026UK*/ 06248000
*                                                                  1503 06249000
*                  ELSE                                            1503 06250000
*CATERR:             DO;                                   /*@YL026UK*/ 06251000
*                                                                  1503 06252000
         B     @RC01501                                            1503 06253000
@RF01501 DS    0H                                                  1503 06254000
CATERR   DS    0H                                                  1504 06255000
*                      /***********************************  @YL026UK*/ 06256000
*                      /*                                    @YL026UK*/ 06257000
*                      /* IF THE WORKAREA WAS NOT LARGE      @YL026UK*/ 06258000
*                      /* ENOUGH A LARGER WORKAREA WILL      @YL026UK*/ 06259000
*                      /* BE OBTAINED AND CATLG WILL BE      @YL026UK*/ 06260000
*                      /* ISSUED AGAIN.                      @YL026UK*/ 06261000
*                      /*                                    @YL026UK*/ 06262000
*                      /***********************************  @YL026UK*/ 06263000
*                                                                  1504 06264000
*                      IF (CATRC = LARGSIZE | CATRC = KNOWSIZE)    1504 06265000
*                        & WNOENT < MAXNO                  /*@OZ18318*/ 06266000
*                        THEN                                      1504 06267000
         LH    @15,CATRC                                           1504 06268000
         C     @15,@CF01652                                        1504 06269000
         BE    @GL00025                                            1504 06270000
         C     @15,@CF01269                                        1504 06271000
         BNE   @RF01504                                            1504 06272000
@GL00025 L     @15,WNOENT                                          1504 06273000
         C     @15,@CF02314                                        1504 06274000
         BNL   @RF01504                                            1504 06275000
*SIZEERR:                  DO;                             /*@YL026UK*/ 06276000
*                                                                  1505 06277000
SIZEERR  DS    0H                                                  1506 06278000
*                            /*****************************  @YL026UK*/ 06279000
*                            /*                              @YL026UK*/ 06280000
*                            /* IF THE SIZE OF THE REQUIRED  @YL026UK*/ 06281000
*                            /* WORKAREA IS RETURNED, SET    @YL026UK*/ 06282000
*                            /* WNOENT TO THE NUMBER OF      @YL026UK*/ 06283000
*                            /* ENTRIES IN THIS KNOWN        @YL026UK*/ 06284000
*                            /* WORKAREA                     @YL026UK*/ 06285000
*                            /*                              @YL026UK*/ 06286000
*                            /* IF THE REQUIRED SIZE IS NOT  @YL026UK*/ 06287000
*                            /* RETURNED, DOUBLE PREVIOUS    @YL026UK*/ 06288000
*                            /* NUMBER OF ENTRIES IN         @YL026UK*/ 06289000
*                            /* WORKAREA                     @YL026UK*/ 06290000
*                            /*                              @YL026UK*/ 06291000
*                            /*****************************  @YL026UK*/ 06292000
*                                                                  1506 06293000
*                            IF CATRC = KNOWSIZE                   1506 06294000
*                              THEN                                1506 06295000
         CLC   CATRC(2),@CH01269                                   1506 06296000
         BNE   @RF01506                                            1506 06297000
*                                WNOENT = (WORKRET - 4) / 45;      1507 06298000
         L     @01,POOLADDR                                        1507 06299000
         LH    @00,WORKRET(,@01)                                   1507 06300000
         N     @00,@CF02485                                        1507 06301000
         SL    @00,@CF00038                                        1507 06302000
         SRDA  @00,32                                              1507 06303000
         D     @00,@CF02303                                        1507 06304000
         ST    @01,WNOENT                                          1507 06305000
*                              ELSE                                1508 06306000
*                                WNOENT = WNOENT * 2;      /*@YL026UK*/ 06307000
*                                                                  1508 06308000
         B     @RC01506                                            1508 06309000
@RF01506 L     @15,WNOENT                                          1508 06310000
         ALR   @15,@15                                             1508 06311000
         ST    @15,WNOENT                                          1508 06312000
*                            /****************************   @YL026UH*/ 06313000
*                            /*                              @YL026UH*/ 06314000
*                            /* FREE PREVIOUS WORKAREA       @YL026UH*/ 06315000
*                            /*                              @YL026UH*/ 06316000
*                            /****************************   @YL026UH*/ 06317000
*                                                                  1509 06318000
*                            CALL IDCSAFP0 (GDTTBL,CIRPID);/*@YL026UH*/ 06319000
*                                                                  1509 06320000
@RC01506 ST    GDTPR,@AL00001                                      1509 06321000
         L     @01,PARMPTR2                                        1509 06322000
         LA    @15,CIRPID(,@01)                                    1509 06323000
         ST    @15,@AL00001+4                                      1509 06324000
         MVI   @AL00001+4,X'80'                                    1509 06325000
         L     @15,GDTFPL(,GDTPR)                                  1509 06326000
         LA    @01,@AL00001                                        1509 06327000
         BALR  @14,@15                                             1509 06328000
*                          END SIZEERR;                    /*#YL026UK*/ 06329000
*                                                                  1510 06330000
*                        /*********************************  #YL026UK*/ 06331000
*                        /*                                  #YL026UK*/ 06332000
*                        /* CATALOG ERROR SUCH THAT          #YL026UK*/ 06333000
*                        /* PROCESSING ENDS.  SET ERROR DATA #YL026UK*/ 06334000
*                        /*                                  #YL026UK*/ 06335000
*                        /*********************************  #YL026UK*/ 06336000
*                                                                  1511 06337000
*                        ELSE                                      1511 06338000
*CATTERM:                  DO;                             /*#YL026UK*/ 06339000
         B     @RC01504                                            1511 06340000
@RF01504 DS    0H                                                  1511 06341000
CATTERM  DS    0H                                                  1512 06342000
*                            ACTION = ERROR;               /*#YL026UK*/ 06343000
         LA    @15,8                                               1512 06344000
         STH   @15,ACTION                                          1512 06345000
*                            UCIRRC = 4;                   /*#YL026UK*/ 06346000
*                                                                  1513 06347000
         MVC   UCIRRC(2),@CH00038                                  1513 06348000
*                            /****************************************/ 06349000
*                            /*                              @Y30SSMK*/ 06350000
*                            /* AN ERROR WAS ENCOUNTERED DURING A    */ 06351000
*                            /* VSAM LOCATE, INITIALIZE THE ERROR    */ 06352000
*                            /* CONVERSION TABLE AND CALL    @Y30SSMK*/ 06353000
*                            /* UERROR.                      @Y30SSMK*/ 06354000
*                            /*                              @Y30SSMK*/ 06355000
*                            /****************************************/ 06356000
*                                                                  1514 06357000
*                            ERCNVADR = ADDR(ERRORTAB);    /*@Y30SSMK*/ 06358000
         LA    @14,ERRORTAB                                        1514 06359000
         ST    @14,ERCNVADR                                        1514 06360000
*                            ERCNVTAB = ''B;               /*@Y30SSMK*/ 06361000
         XC    ERCNVTAB(32,@14),ERCNVTAB(@14)                      1515 06362000
*                            ERCATLG = ON;                 /*@Y30SSMK*/ 06363000
         OI    ERCATLG(@14),B'10000000'                            1516 06364000
*                            ERCATLC = ON;                 /*@Y30SSMK*/ 06365000
         OI    ERCATLC(@14),B'10000000'                            1517 06366000
*                            ERCATRC = CATRC;              /*@Y30SSMK*/ 06367000
         LH    @07,CATRC                                           1518 06368000
         ST    @07,ERCATRC(,@14)                                   1518 06369000
*                            ERCPLPT = CTGPLPTR;           /*@Y30SSMK*/ 06370000
         L     @06,CTGPLPTR                                        1519 06371000
         ST    @06,ERCPLPT(,@14)                                   1519 06372000
*                            IF CATRC = CATRC8                     1520 06373000
*                              THEN                                1520 06374000
         CR    @07,@15                                             1520 06375000
         BNE   @RF01520                                            1520 06376000
*                                ERDSNM = ADDR(LOCNAME);   /*@Y30SSMK*/ 06377000
*                                                                  1521 06378000
         LA    @15,LOCNAME                                         1521 06379000
         ST    @15,ERDSNM(,@14)                                    1521 06380000
*                            CALL IDCTPER0 (GDTTBL,ERCNVADR);/*    1522 06381000
*                                                            @Y30SSMK*/ 06382000
*                                                                  1522 06383000
@RF01520 ST    GDTPR,@AL00001                                      1522 06384000
         LA    @15,ERCNVADR                                        1522 06385000
         ST    @15,@AL00001+4                                      1522 06386000
         MVI   @AL00001+4,X'80'                                    1522 06387000
         L     @15,GDTERR(,GDTPR)                                  1522 06388000
         LA    @01,@AL00001                                        1522 06389000
         BALR  @14,@15                                             1522 06390000
*                            RESPECIFY RTNREG RSTD;                1523 06391000
*                            TESTRC = RTNREG;                      1524 06392000
         STH   RTNREG,TESTRC                                       1524 06393000
*                            RESPECIFY RTNREG UNRSTD;      /*@Y30SSMK*/ 06394000
*                            UCIRRC = MAX(UCIRRC,TESTRC);  /*@Y30SSMK*/ 06395000
         LH    @15,TESTRC                                          1526 06396000
         LH    @14,UCIRRC                                          1526 06397000
         CR    @14,@15                                             1526 06398000
         BNL   *+6                                                      06399000
         LR    @14,@15                                             1526 06400000
         STH   @14,UCIRRC                                          1526 06401000
*                          END CATTERM;                    /*#YL026UK*/ 06402000
*                                                                  1527 06403000
*                    END CATERR;                           /*#YL026UK*/ 06404000
*                                                                  1528 06405000
*              END STOROK;                                 /*#YL026UK*/ 06406000
*                                                                  1529 06407000
*            /*******************************************    #YL026UK*/ 06408000
*            /*                                              #YL026UK*/ 06409000
*            /* NO STORAGE AVAILABLE.                        #YL026UK*/ 06410000
*            /* SET MESSAGE DATA AND SET LOOP ACTION         #YL026UK*/ 06411000
*            /* INDICATOR TO ERROR.                          #YL026UK*/ 06412000
*            /*                                              #YL026UK*/ 06413000
*            /*******************************************    #YL026UK*/ 06414000
*                                                                  1530 06415000
*            ELSE                                                  1530 06416000
*STORERR:      DO;                                         /*#YL026UK*/ 06417000
         B     @RC01489                                            1530 06418000
@RF01489 DS    0H                                                  1530 06419000
STORERR  DS    0H                                                  1531 06420000
*                UCIRRC = 4;                               /*#YL026UK*/ 06421000
         MVC   UCIRRC(2),@CH00038                                  1531 06422000
*                DARGSMOD = IOMOD;                         /*#YL026UK*/ 06423000
         L     @15,DDSTRU                                          1532 06424000
         MVC   DARGSMOD(3,@15),@CC01346                            1532 06425000
*                DARGSENT = NOCRSTID;                      /*#YL026UK*/ 06426000
         MVI   DARGSENT(@15),X'1A'                                 1533 06427000
*                ACTION = ERROR;                           /*#YL026UK*/ 06428000
*                                                                  1534 06429000
         MVC   ACTION(2),@CH00175                                  1534 06430000
*                CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);    /*@Y30SSMK*/ 06431000
*                                                                  1535 06432000
         ST    GDTPR,@AL00001                                      1535 06433000
         LA    @15,@CF00111                                        1535 06434000
         ST    @15,@AL00001+4                                      1535 06435000
         LA    @15,DDSTRU                                          1535 06436000
         ST    @15,@AL00001+8                                      1535 06437000
         MVI   @AL00001+8,X'80'                                    1535 06438000
         L     @15,GDTPRT(,GDTPR)                                  1535 06439000
         LA    @01,@AL00001                                        1535 06440000
         BALR  @14,@15                                             1535 06441000
*              END STORERR;                                /*#YL026UK*/ 06442000
*                                                                  1536 06443000
*        END CTLLOOP;                                      /*#YL026UK*/ 06444000
*                                                                  1537 06445000
@RC01489 DS    0H                                                  1537 06446000
@DE01481 CLC   ACTION(2),@CH00038                                  1537 06447000
         BE    @DL01481                                            1537 06448000
*        /*************************************************  #YL026UK*/ 06449000
*        /*                                                  #YL026UK*/ 06450000
*        /* IF THE RETURN CODE IS RCOK THE DATA SET NAME     #YL026UK*/ 06451000
*        /* DATA HAS BEEN PLACED IN THE WORKAREA.            #YL026UK*/ 06452000
*        /*                                                  #YL026UK*/ 06453000
*        /*************************************************  #YL026UK*/ 06454000
*                                                                  1538 06455000
*        IF UCIRRC = 0                                             1538 06456000
*          THEN                                                    1538 06457000
         LH    @15,UCIRRC                                          1538 06458000
         LTR   @15,@15                                             1538 06459000
         BNZ   @RF01538                                            1538 06460000
*WORKBLD:    DO;                                           /*#YL026UK*/ 06461000
*                                                                  1539 06462000
WORKBLD  DS    0H                                                  1540 06463000
*              /*******************************************  #YL026UK*/ 06464000
*              /*                                            #YL026UK*/ 06465000
*              /* RETURN WORKAREA ADDRESS TO CALLER.         #YL026UK*/ 06466000
*              /* CALCULATE NUMBER OF ENTRIES IN THE         #YL026UK*/ 06467000
*              /* WORKAREA.                                  #YL026UK*/ 06468000
*              /* SET NUMBER OF MATCHING ENTRIES TO ZERO.    #YL026UK*/ 06469000
*              /*                                            #YL026UK*/ 06470000
*              /*******************************************  #YL026UK*/ 06471000
*                                                                  1540 06472000
*              RETPOOL = POOLADDR;                         /*#YL026UK*/ 06473000
         L     @15,POOLADDR                                        1540 06474000
         L     @01,PARMPTR2                                        1540 06475000
         L     @01,CIRWKP(,@01)                                    1540 06476000
         ST    @15,RETPOOL(,@01)                                   1540 06477000
*              CATRETNO = (WORKRET - 4) / 45;              /*#YL026UK*/ 06478000
         LH    @00,WORKRET(,@15)                                   1541 06479000
         N     @00,@CF02485                                        1541 06480000
         SL    @00,@CF00038                                        1541 06481000
         SRDA  @00,32                                              1541 06482000
         D     @00,@CF02303                                        1541 06483000
         STH   @01,CATRETNO                                        1541 06484000
*              WORKNUM = 0;                                /*#YL026UK*/ 06485000
*                                                                  1542 06486000
         SLR   @14,@14                                             1542 06487000
         ST    @14,WORKNUM(,@15)                                   1542 06488000
*              /*******************************************  #YL026UK*/ 06489000
*              /*                                            #YL026UK*/ 06490000
*              /* CHECK ALL THE ENTRIES RETURNED IN WORKAREA #YL026UK*/ 06491000
*              /*                                            #YL026UK*/ 06492000
*              /*******************************************  #YL026UK*/ 06493000
*                                                                  1543 06494000
*CKALLENT:     DO CKENT = 1 TO CATRETNO;                   /*#YL026UK*/ 06495000
*                                                                  1543 06496000
CKALLENT LA    @15,1                                               1543 06497000
         B     @DE01543                                            1543 06498000
@DL01543 DS    0H                                                  1544 06499000
*                /*****************************************  #YL026UK*/ 06500000
*                /*                                          #YL026UK*/ 06501000
*                /* DETERMINE IF DSNAME HAS SEPARATOR AFTER  #YL026UK*/ 06502000
*                /* THE HEADER QUALIFIER                     #YL026UK*/ 06503000
*                /*                                          #YL026UK*/ 06504000
*                /*****************************************  #YL026UK*/ 06505000
*                                                                  1544 06506000
*                NEXTQUAL = CIRHLN + 1;                    /*#YL026UK*/ 06507000
         L     @01,PARMPTR2                                        1544 06508000
         LH    @01,CIRHLN(,@01)                                    1544 06509000
         LA    @01,1(,@01)                                         1544 06510000
         STH   @01,NEXTQUAL                                        1544 06511000
*                SEPER = NOTFOUND;                         /*#YL026UK*/ 06512000
         SLR   @15,@15                                             1545 06513000
         STH   @15,SEPER                                           1545 06514000
*                MATCH = NOTEQUAL;                         /*#YL026UK*/ 06515000
*                                                                  1546 06516000
         STH   @15,MATCH                                           1546 06517000
*FINDSEP:        DO BYTECTR = NEXTQUAL TO TOTALLEN;        /*#YL026UK*/ 06518000
*                                                                  1547 06519000
FINDSEP  LH    @15,NEXTQUAL                                        1547 06520000
         B     @DE01547                                            1547 06521000
@DL01547 DS    0H                                                  1548 06522000
*                  IF DSNAME (CKENT,BYTECTR) = '.'                 1548 06523000
*                    THEN                                          1548 06524000
         LH    @14,CKENT                                           1548 06525000
         MH    @14,@CH02303                                        1548 06526000
         ALR   @14,@15                                             1548 06527000
         L     @01,POOLADDR                                        1548 06528000
         ALR   @01,@14                                             1548 06529000
         AL    @01,@CF02486                                        1548 06530000
         CLI   DSNAME-5(@01),C'.'                                  1548 06531000
         BNE   @RF01548                                            1548 06532000
*                      DO;                                 /*#YL026UK*/ 06533000
*                        TOTRAIL = BYTECTR - 1;            /*#YL026UK*/ 06534000
         LR    @14,@15                                             1550 06535000
         BCTR  @14,0                                               1550 06536000
         STH   @14,TOTRAIL                                         1550 06537000
*                        TRLQUAL = BYTECTR;                /*#YL026UK*/ 06538000
         STH   @15,TRLQUAL                                         1551 06539000
*                        SEPER = FOUND;                    /*#YL026UK*/ 06540000
         MVC   SEPER(2),@CH00038                                   1552 06541000
*                        BYTECTR = TOTALLEN;               /*#YL026UK*/ 06542000
         MVC   BYTECTR(2),@CH01652                                 1553 06543000
*                      END;                                /*#YL026UK*/ 06544000
*                                                                  1554 06545000
*                END FINDSEP;                              /*#YL026UK*/ 06546000
*                                                                  1555 06547000
@RF01548 LA    @15,1                                               1555 06548000
         AH    @15,BYTECTR                                         1555 06549000
@DE01547 STH   @15,BYTECTR                                         1555 06550000
         C     @15,@CF01652                                        1555 06551000
         BNH   @DL01547                                            1555 06552000
*                /*****************************************  #YL026UK*/ 06553000
*                /*                                          #YL026UK*/ 06554000
*                /* CHECK FOR MATCHING ENTRY IF NO TRAILER   #YL026UK*/ 06555000
*                /* QUALIFIERS ARE SPECIFIED BY THE USER.    #YL026UK*/ 06556000
*                /*                                          #YL026UK*/ 06557000
*                /* IF ENTRY IS A CATALOG THIS ENTRY IS      #YL026UK*/ 06558000
*                /* ALWAYS RETURNED TO THE USER.             #YL026UK*/ 06559000
*                /*                                          #YL026UK*/ 06560000
*                /*****************************************  #YL026UK*/ 06561000
*                                                                  1556 06562000
*                IF CIRTLN = NULLPTR | ENTTYPE (CKENT) = CATTYPE   1556 06563000
*                  THEN                                            1556 06564000
         L     @01,PARMPTR2                                        1556 06565000
         LH    @15,CIRTLN(,@01)                                    1556 06566000
         LTR   @15,@15                                             1556 06567000
         BZ    @RT01556                                            1556 06568000
         LH    @15,CKENT                                           1556 06569000
         MH    @15,@CH02303                                        1556 06570000
         L     @01,POOLADDR                                        1556 06571000
         ALR   @01,@15                                             1556 06572000
         AL    @01,@CF02486                                        1556 06573000
         CLI   ENTTYPE-4(@01),C'0'                                 1556 06574000
         BNE   @RF01556                                            1556 06575000
@RT01556 DS    0H                                                  1557 06576000
*NOTRAIL:            DO;                                   /*#YL026UK*/ 06577000
*                                                                  1557 06578000
NOTRAIL  DS    0H                                                  1558 06579000
*                      /***********************************  #YL026UK*/ 06580000
*                      /*                                    #YL026UK*/ 06581000
*                      /* IF CATALOG TYPE, SET MATCH.        #YL026UK*/ 06582000
*                      /* THE OTHER CHECKS ARE STILL MADE    #YL026UK*/ 06583000
*                      /* BECAUSE ALL ENTRIES MAY BE         #YL026UK*/ 06584000
*                      /* RETURNED.                          #YL026UK*/ 06585000
*                      /*                                    #YL026UK*/ 06586000
*                      /***********************************  #YL026UK*/ 06587000
*                                                                  1558 06588000
*                      IF ENTTYPE (CKENT) = CATTYPE                1558 06589000
*                        THEN                                      1558 06590000
         LH    @15,CKENT                                           1558 06591000
         MH    @15,@CH02303                                        1558 06592000
         L     @01,POOLADDR                                        1558 06593000
         ALR   @01,@15                                             1558 06594000
         AL    @01,@CF02486                                        1558 06595000
         CLI   ENTTYPE-4(@01),C'0'                                 1558 06596000
         BNE   @RF01558                                            1558 06597000
*                          MATCH = EQUAL;                  /*@YL026UK*/ 06598000
*                                                                  1559 06599000
         MVC   MATCH(2),@CH00038                                   1559 06600000
*                        /***********************************@YL026UK*/ 06601000
*                        /*                                  @YL026UK*/ 06602000
*                        /* ALL ENTRIES MATCH IF ALL QUAL HAS@YL026UK*/ 06603000
*                        /* BEEN SPECIFIED.                  @YL026UK*/ 06604000
*                        /* THE ENTRY BEING CHECKED MATCHES  @YL026UK*/ 06605000
*                        /* IF ONE QUAL IS SPECIFIED AND DATA@YL026UK*/ 06606000
*                        /* SET NAME HAS NO MORE SEPARATORS  @YL026UK*/ 06607000
*                        /*                                  @YL026UK*/ 06608000
*                        /***********************************@YL026UK*/ 06609000
*                                                                  1560 06610000
*                        ELSE                                      1560 06611000
*                          DO;                             /*@YL026UK*/ 06612000
         B     @RC01558                                            1560 06613000
@RF01558 DS    0H                                                  1561 06614000
*                            IF CIRTYPAQ = ON                      1561 06615000
*                              THEN                                1561 06616000
         L     @01,PARMPTR2                                        1561 06617000
         TM    CIRTYPAQ(@01),B'01000000'                           1561 06618000
         BNO   @RF01561                                            1561 06619000
*                                MATCH = ALLEQUAL;         /*@YL026UK*/ 06620000
         MVC   MATCH(2),@CH00175                                   1562 06621000
*                              ELSE                                1563 06622000
*                                DO;                       /*@YL026UK*/ 06623000
         B     @RC01561                                            1563 06624000
@RF01561 DS    0H                                                  1564 06625000
*                                  IF SEPER = NOTFOUND             1564 06626000
*                                    THEN                          1564 06627000
         LH    @15,SEPER                                           1564 06628000
         LTR   @15,@15                                             1564 06629000
         BNZ   @RF01564                                            1564 06630000
*                                      MATCH = EQUAL;      /*@YL026UK*/ 06631000
         MVC   MATCH(2),@CH00038                                   1565 06632000
*                                END;                      /*@YL026UK*/ 06633000
*                          END;                            /*@YL026UK*/ 06634000
*                                                                  1567 06635000
*                    END NOTRAIL;                          /*@YL026UK*/ 06636000
*                                                                  1568 06637000
*                  /***************************************  @YL026UK*/ 06638000
*                  /*                                        @YL026UK*/ 06639000
*                  /* USER SPECIFIED A TRAILING QUALIFIER    @YL026UK*/ 06640000
*                  /*                                        @YL026UK*/ 06641000
*                  /***************************************  @YL026UK*/ 06642000
*                                                                  1569 06643000
*                  ELSE                                            1569 06644000
*CKTRAIL:            DO;                                   /*@YL026UK*/ 06645000
*                                                                  1569 06646000
         B     @RC01556                                            1569 06647000
@RF01556 DS    0H                                                  1569 06648000
CKTRAIL  DS    0H                                                  1570 06649000
*                      TRLLEN = CIRTLN;                    /*@YL026UK*/ 06650000
         L     @01,PARMPTR2                                        1570 06651000
         LH    @15,CIRTLN(,@01)                                    1570 06652000
         STH   @15,TRLLEN                                          1570 06653000
*                      COMPPTR = ADDR (DSNAME (CKENT));    /*@YL026UK*/ 06654000
*                                                                  1571 06655000
         LH    @14,CKENT                                           1571 06656000
         MH    @14,@CH02303                                        1571 06657000
         L     @01,POOLADDR                                        1571 06658000
         AL    @01,@CF02487                                        1571 06659000
         LA    @14,DSNAME-5(@14,@01)                               1571 06660000
         ST    @14,COMPPTR                                         1571 06661000
*                      /***********************************  @YL026UK*/ 06662000
*                      /*                                    @YL026UK*/ 06663000
*                      /* IF DATA SET NAME HAS A SEPARATOR   @YL026UK*/ 06664000
*                      /* AND IF THE NUMBER OF BYTES         @YL026UK*/ 06665000
*                      /* FOLLOWING (AND INCLUDING) THE      #YL026UK*/ 06666000
*                      /* SEPARATOR IS GREATER THAN OR EQUAL #YL026UK*/ 06667000
*                      /* TO THE NUMBER OF BYTES IN THE      #YL026UK*/ 06668000
*                      /* TRAILOR SUPPLIED BY THE USER,      #YL026UK*/ 06669000
*                      /* CHECK FOR A MATCH.                 #YL026UK*/ 06670000
*                      /*                                    @YL026UK*/ 06671000
*                      /***********************************  @YL026UK*/ 06672000
*                                                                  1572 06673000
*                      IF SEPER = FOUND &                          1572 06674000
*                       TOTRAIL + TRLLEN <= TOTALLEN               1572 06675000
*                        THEN                                      1572 06676000
         CLC   SEPER(2),@CH00038                                   1572 06677000
         BNE   @RF01572                                            1572 06678000
         AH    @15,TOTRAIL                                         1572 06679000
         C     @15,@CF01652                                        1572 06680000
         BH    @RF01572                                            1572 06681000
*COMPTRL:                  DO;                             /*@YL026UK*/ 06682000
*                                                                  1573 06683000
COMPTRL  DS    0H                                                  1574 06684000
*                            CTRLPTR = COMPPTR + TOTRAIL;  /*@YL026UK*/ 06685000
*                                                                  1574 06686000
         LH    @15,TOTRAIL                                         1574 06687000
         AL    @15,COMPPTR                                         1574 06688000
         ST    @15,CTRLPTR                                         1574 06689000
*                            /****************************************/ 06690000
*                            /*                              @YL026UK*/ 06691000
*                            /* CHECK REMAINING BYTES IN     @YL026UK*/ 06692000
*                            /* DATA SET NAME AGAINST        @YL026UK*/ 06693000
*                            /* TRAILING QUALIFIERS (UP TO   @YL026UK*/ 06694000
*                            /* TRAILING QUALIFIER LENGTH)   @YL026UK*/ 06695000
*                            /* FOR A MATCH                  @YL026UK*/ 06696000
*                            /*                              @YL026UK*/ 06697000
*                            /****************************************/ 06698000
*                                                                  1575 06699000
*                            IF DSCMPTRL (1:TRLLEN) =              1575 06700000
*                             TRAILER (1:TRLLEN)                   1575 06701000
*                              THEN                                1575 06702000
         L     @01,PARMPTR2                                        1575 06703000
         L     @01,CIRTLR(,@01)                                    1575 06704000
         LH    @14,TRLLEN                                          1575 06705000
         BCTR  @14,0                                               1575 06706000
         EX    @14,@SC02488                                        1575 06707000
         BNE   @RF01575                                            1575 06708000
*MATTRL:                         DO;                       /*@YL026UK*/ 06709000
*                                                                  1576 06710000
MATTRL   DS    0H                                                  1577 06711000
*                                  /***********************  @YL026UK*/ 06712000
*                                  /*                        @YL026UK*/ 06713000
*                                  /* ENTRY MATCHES IF ALL   @YL026UK*/ 06714000
*                                  /* QUAL SPECIFIED AND     @YL026UK*/ 06715000
*                                  /* LASTBYTE IS 45, OR     @YL026UK*/ 06716000
*                                  /* THE CHARACTER AT       @YL026UK*/ 06717000
*                                  /* LASTBYTE IS A PERIOD   @YL026UK*/ 06718000
*                                  /* OR A BLANK.            @YL026UK*/ 06719000
*                                  /* ENTRY MATCHES IF ONE   @YL026UK*/ 06720000
*                                  /* QUAL SPECIFIED AND THE @YL026UK*/ 06721000
*                                  /* END OF THE DSN HAS     @YL026UK*/ 06722000
*                                  /* BEEN REACHED.          @YL026UK*/ 06723000
*                                  /*                        @YL026UK*/ 06724000
*                                  /***********************  @YL026UK*/ 06725000
*                                                                  1577 06726000
*                                  LASTBYTE = TRLQUAL +            1577 06727000
*                                              TRLLEN;     /*@YL026UK*/ 06728000
*                                                                  1577 06729000
         LH    @15,TRLQUAL                                         1577 06730000
         AH    @15,TRLLEN                                          1577 06731000
         STH   @15,LASTBYTE                                        1577 06732000
*                                  IF CIRTYPAQ = ON & (COMPNAME    1578 06733000
*                                  (LASTBYTE) = '40'X | COMPNAME   1578 06734000
*                                  (LASTBYTE) = '.' | LASTBYTE = 45)    06735000
*                                    THEN                          1578 06736000
         L     @01,PARMPTR2                                        1578 06737000
         TM    CIRTYPAQ(@01),B'01000000'                           1578 06738000
         BNO   @RF01578                                            1578 06739000
         L     @14,COMPPTR                                         1578 06740000
         ALR   @15,@14                                             1578 06741000
         BCTR  @15,0                                               1578 06742000
         CLI   COMPNAME(@15),X'40'                                 1578 06743000
         BE    @RT01578                                            1578 06744000
         LH    @15,LASTBYTE                                        1578 06745000
         ALR   @14,@15                                             1578 06746000
         BCTR  @14,0                                               1578 06747000
         CLI   COMPNAME(@14),C'.'                                  1578 06748000
         BE    @RT01578                                            1578 06749000
         C     @15,@CF02303                                        1578 06750000
         BNE   @RF01578                                            1578 06751000
@RT01578 DS    0H                                                  1579 06752000
*                                      MATCH = EQUAL;      /*@YL026UK*/ 06753000
         MVC   MATCH(2),@CH00038                                   1579 06754000
*                                    ELSE                          1580 06755000
*                                      DO;                 /*@YL026UK*/ 06756000
         B     @RC01578                                            1580 06757000
@RF01578 DS    0H                                                  1581 06758000
*                                        IF LASTBYTE > TOTALLEN |  1581 06759000
*                                         COMPNAME (LASTBYTE) = '40'X   06760000
*                                          THEN                    1581 06761000
         LH    @15,LASTBYTE                                        1581 06762000
         C     @15,@CF01652                                        1581 06763000
         BH    @RT01581                                            1581 06764000
         L     @01,COMPPTR                                         1581 06765000
         ALR   @01,@15                                             1581 06766000
         BCTR  @01,0                                               1581 06767000
         CLI   COMPNAME(@01),X'40'                                 1581 06768000
         BNE   @RF01581                                            1581 06769000
@RT01581 DS    0H                                                  1582 06770000
*                                            MATCH = EQUAL;/*@YL026UK*/ 06771000
         MVC   MATCH(2),@CH00038                                   1582 06772000
*                                      END;                /*@YL026UK*/ 06773000
*                                                                  1583 06774000
@RF01581 DS    0H                                                  1584 06775000
*                                END MATTRL;               /*@YL026UK*/ 06776000
*                                                                  1584 06777000
@RC01578 DS    0H                                                  1585 06778000
*                          END COMPTRL;                    /*@YL026UK*/ 06779000
*                                                                  1585 06780000
@RF01575 DS    0H                                                  1586 06781000
*                    END CKTRAIL;                          /*@YL026UK*/ 06782000
*                                                                  1586 06783000
@RF01572 DS    0H                                                  1587 06784000
*                /*****************************************  @YL026UK*/ 06785000
*                /*                                          @YL026UK*/ 06786000
*                /* IF MATCH IS ALLEQUAL, ALL ENTRIES        @YL026UK*/ 06787000
*                /* MATCH AND ARE IN ORDER IN THE WORKAREA.  @YL026UK*/ 06788000
*                /* THE TOTAL NUMBER OF ENTRIES IS SET IN    @YL026UK*/ 06789000
*                /* THE WORKAREA AND THE CHECK ENTRY LOOP IS @YL026UK*/ 06790000
*                /* ENDED.                                   @YL026UK*/ 06791000
*                /*                                          @YL026UK*/ 06792000
*                /*****************************************  @YL026UK*/ 06793000
*                                                                  1587 06794000
*                IF MATCH = ALLEQUAL                               1587 06795000
*                  THEN                                            1587 06796000
@RC01556 CLC   MATCH(2),@CH00175                                   1587 06797000
         BNE   @RF01587                                            1587 06798000
*                    DO;                                   /*@YL026UK*/ 06799000
*                      WORKNUM = CATRETNO;                 /*@YL026UK*/ 06800000
         LH    @15,CATRETNO                                        1589 06801000
         L     @14,POOLADDR                                        1589 06802000
         ST    @15,WORKNUM(,@14)                                   1589 06803000
*                      CKENT = CATRETNO;                   /*@YL026UK*/ 06804000
         STH   @15,CKENT                                           1590 06805000
*                    END;                                  /*@YL026UK*/ 06806000
*                                                                  1591 06807000
*                  ELSE                                            1592 06808000
*                    DO;                                   /*@YL026UK*/ 06809000
*                                                                  1592 06810000
         B     @RC01587                                            1592 06811000
@RF01587 DS    0H                                                  1593 06812000
*                      /***********************************  @YL026UK*/ 06813000
*                      /*                                    @YL026UK*/ 06814000
*                      /* IF MATCH IS EQUAL, THE NUMBER OF   @YL026UK*/ 06815000
*                      /* MATCHING ENTRIES IS UPDATED AND    @YL026UK*/ 06816000
*                      /* THE ENTRY IS MOVED TO THE NEXT     @YL026UK*/ 06817000
*                      /* SLOT AVAILABLE IN THE WORKAREA     @YL026UK*/ 06818000
*                      /*                                    @YL026UK*/ 06819000
*                      /***********************************  @YL026UK*/ 06820000
*                                                                  1593 06821000
*                      IF MATCH = EQUAL                            1593 06822000
*                        THEN                                      1593 06823000
         CLC   MATCH(2),@CH00038                                   1593 06824000
         BNE   @RF01593                                            1593 06825000
*                          DO;                             /*@YL026UK*/ 06826000
*                            WORKNUM = WORKNUM + 1;        /*@YL026UK*/ 06827000
         L     @15,POOLADDR                                        1595 06828000
         LA    @14,1                                               1595 06829000
         AL    @14,WORKNUM(,@15)                                   1595 06830000
         ST    @14,WORKNUM(,@15)                                   1595 06831000
*                            IF WORKNUM ^= CKENT                   1596 06832000
*                              THEN                                1596 06833000
         LH    @07,CKENT                                           1596 06834000
         CLR   @14,@07                                             1596 06835000
         BE    @RF01596                                            1596 06836000
*                                WORKENT (WORKNUM) =               1597 06837000
*                                  WORKENT (CKENT);        /*@YL026UK*/ 06838000
         LA    @06,45                                              1597 06839000
         LR    @01,@14                                             1597 06840000
         MR    @00,@06                                             1597 06841000
         ALR   @01,@15                                             1597 06842000
         AL    @01,@CF02486                                        1597 06843000
         MR    @06,@06                                             1597 06844000
         ALR   @15,@07                                             1597 06845000
         AL    @15,@CF02486                                        1597 06846000
         MVC   @TS00001(45),WORKENT-4(@15)                         1597 06847000
         MVC   WORKENT-4(45,@01),@TS00001                          1597 06848000
*                          END;                            /*@YL026UK*/ 06849000
@RF01596 DS    0H                                                  1599 06850000
*                    END;                                  /*@YL026UK*/ 06851000
*                                                                  1599 06852000
@RF01593 DS    0H                                                  1600 06853000
*              END CKALLENT;                               /*@YL026UK*/ 06854000
*                                                                  1600 06855000
@RC01587 LA    @15,1                                               1600 06856000
         AH    @15,CKENT                                           1600 06857000
@DE01543 STH   @15,CKENT                                           1600 06858000
         CH    @15,CATRETNO                                        1600 06859000
         BNH   @DL01543                                            1600 06860000
*              /******************************************   @YL026UH*/ 06861000
*              /*                                            @YL026UH*/ 06862000
*              /* IF NO ENTRIES ARE PRESENT IN THE LIST THAT @YL026UH*/ 06863000
*              /* WILL BE RETURNED TO THE CALLER, SET THE    @YL026UH*/ 06864000
*              /* CATALOG RETURN CODE TO 8, THE AND PRINT    @YL026UH*/ 06865000
*              /* MESSAGE AS WHEN THE CATALOG CANNOT FIND    @YL026UH*/ 06866000
*              /* AN ENTRY.                                  @YL026UH*/ 06867000
*              /*                                            @YL026UH*/ 06868000
*              /******************************************   @YL026UH*/ 06869000
*                                                                  1601 06870000
*              CATRC = NODSENT;                            /*@YL026UH*/ 06871000
*                                                                  1601 06872000
         MVC   CATRC(2),@CH00175                                   1601 06873000
*              DO CKENT = 1 TO WORKNUM WHILE CATRC = NODSENT;      1602 06874000
         LA    @15,1                                               1602 06875000
         B     @DE01602                                            1602 06876000
@DL01602 CLC   CATRC(2),@CH00175                                   1602 06877000
         BNE   @DC01602                                            1602 06878000
*                IF ENTTYPE (CKENT) ^= CATTYPE                     1603 06879000
*                  THEN                                            1603 06880000
         MH    @15,@CH02303                                        1603 06881000
         L     @01,POOLADDR                                        1603 06882000
         ALR   @01,@15                                             1603 06883000
         AL    @01,@CF02486                                        1603 06884000
         CLI   ENTTYPE-4(@01),C'0'                                 1603 06885000
         BE    @RF01603                                            1603 06886000
*                    CATRC = 0;                            /*@YL026UH*/ 06887000
         SLR   @15,@15                                             1604 06888000
         STH   @15,CATRC                                           1604 06889000
*              END;                                        /*@YL026UH*/ 06890000
*                                                                  1605 06891000
@RF01603 LA    @15,1                                               1605 06892000
         AH    @15,CKENT                                           1605 06893000
@DE01602 STH   @15,CKENT                                           1605 06894000
         L     @14,POOLADDR                                        1605 06895000
         CL    @15,WORKNUM(,@14)                                   1605 06896000
         BNH   @DL01602                                            1605 06897000
@DC01602 DS    0H                                                  1606 06898000
*              IF CATRC = NODSENT                                  1606 06899000
*                THEN                                              1606 06900000
         LH    @15,CATRC                                           1606 06901000
         C     @15,@CF00175                                        1606 06902000
         BNE   @RF01606                                            1606 06903000
*                  DO;                                     /*@YL026UH*/ 06904000
*                                                                  1607 06905000
*                    UCIRRC = 4;                           /*@YL026UH*/ 06906000
*                                                                  1608 06907000
         MVC   UCIRRC(2),@CH00038                                  1608 06908000
*                    /************************************************/ 06909000
*                    /*                                      @Y30SSMK*/ 06910000
*                    /* INVOKE UERROR TO PRINT THE ERROR MESSAGE     */ 06911000
*                    /* AS WHEN THE CATALOG CANNOT FIND AN   @Y30SSMK*/ 06912000
*                    /* ENTRY.                               @Y30SSMK*/ 06913000
*                    /*                                      @Y30SSMK*/ 06914000
*                    /************************************************/ 06915000
*                                                                  1609 06916000
*                    ERCNVADR = ADDR(ERRORTAB);            /*@Y30SSMK*/ 06917000
         LA    @14,ERRORTAB                                        1609 06918000
         ST    @14,ERCNVADR                                        1609 06919000
*                    ERCNVTAB = ''B;                       /*@Y30SSMK*/ 06920000
         XC    ERCNVTAB(32,@14),ERCNVTAB(@14)                      1610 06921000
*                    ERCATLG = ON;                         /*@Y30SSMK*/ 06922000
         OI    ERCATLG(@14),B'10000000'                            1611 06923000
*                    ERCATLC = ON;                         /*@Y30SSMK*/ 06924000
         OI    ERCATLC(@14),B'10000000'                            1612 06925000
*                    ERCATRC = CATRC;                      /*@Y30SSMK*/ 06926000
         ST    @15,ERCATRC(,@14)                                   1613 06927000
*                    ERCPLPT = CTGPLPTR;                   /*@Y30SSMK*/ 06928000
         L     @15,CTGPLPTR                                        1614 06929000
         ST    @15,ERCPLPT(,@14)                                   1614 06930000
*                    ERDSNM = ADDR(LOCNAME);               /*@Y30SSMK*/ 06931000
*                                                                  1615 06932000
         LA    @15,LOCNAME                                         1615 06933000
         ST    @15,ERDSNM(,@14)                                    1615 06934000
*                    CALL IDCTPER0 (GDTTBL,ERCNVADR);      /*@Y30SSMK*/ 06935000
*                                                                  1616 06936000
         ST    GDTPR,@AL00001                                      1616 06937000
         LA    @15,ERCNVADR                                        1616 06938000
         ST    @15,@AL00001+4                                      1616 06939000
         MVI   @AL00001+4,X'80'                                    1616 06940000
         L     @15,GDTERR(,GDTPR)                                  1616 06941000
         LA    @01,@AL00001                                        1616 06942000
         BALR  @14,@15                                             1616 06943000
*                    RESPECIFY RTNREG RSTD;                        1617 06944000
*                    TESTRC = RTNREG;                              1618 06945000
         STH   RTNREG,TESTRC                                       1618 06946000
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSMK*/ 06947000
*                    UCIRRC = MAX(UCIRRC,TESTRC);          /*@Y30SSMK*/ 06948000
*                                                                  1620 06949000
         LH    @15,TESTRC                                          1620 06950000
         LH    @14,UCIRRC                                          1620 06951000
         CR    @14,@15                                             1620 06952000
         BNL   *+6                                                      06953000
         LR    @14,@15                                             1620 06954000
         STH   @14,UCIRRC                                          1620 06955000
*                  END;                                    /*@YL026UH*/ 06956000
*                                                                  1621 06957000
*            END WORKBLD;                                  /*#YL026UK*/ 06958000
*                                                                  1622 06959000
@RF01606 DS    0H                                                  1623 06960000
*        IF GDTDBG = NULLPTR                                       1623 06961000
*          THEN;                                                   1623 06962000
@RF01538 L     @15,GDTDBG(,GDTPR)                                  1623 06963000
         LTR   @15,@15                                             1623 06964000
         BZ    @RT01623                                            1623 06965000
*          ELSE                                                    1625 06966000
*            CALL IDCDB010 (GDTTBL,'ZZCR');                        1625 06967000
         ST    GDTPR,@AL00001                                      1625 06968000
         LA    @15,@CC02178                                        1625 06969000
         ST    @15,@AL00001+4                                      1625 06970000
         MVI   @AL00001+4,X'80'                                    1625 06971000
         L     @15,GDTDBG(,GDTPR)                                  1625 06972000
         LA    @01,@AL00001                                        1625 06973000
         BALR  @14,@15                                             1625 06974000
*                                                          /*#YL026UK*/ 06975000
*                                                                  1626 06976000
*        CALL IDCSAEP0(GDTTBL,MODID,UCIRRC);                       1626 06977000
@RT01623 ST    GDTPR,@AL00001                                      1626 06978000
         LA    @15,MODID                                           1626 06979000
         ST    @15,@AL00001+4                                      1626 06980000
         LA    @15,UCIRRC                                          1626 06981000
         ST    @15,@AL00001+8                                      1626 06982000
         MVI   @AL00001+8,X'80'                                    1626 06983000
         L     @15,GDTEPL(,GDTPR)                                  1626 06984000
         LA    @01,@AL00001                                        1626 06985000
         BALR  @14,@15                                             1626 06986000
*       /*#YL026UK*/                                               1627 06987000
*        /************************************************************/ 06988000
*        /************************************************************/ 06989000
*        /*                                                  #YL026UK*/ 06990000
*        /* ULINK ENTRY POINT                                #YL026UK*/ 06991000
*        /*                                                  #YL026UK*/ 06992000
*        /************************************************************/ 06993000
*        /************************************************************/ 06994000
*                                                                  1627 06995000
*AMSSALK:  ENTRY(GDTTBLX,LKNAMEX,LINKARGX);                /*#YL026UK*/ 06996000
*                                                                  1627 06997000
@EC01627 DS    0H                                                  1628 06998000
*AMSSALK1:                                                         1628 06999000
*                                                                  1628 07000000
*        DCL LKNAME CHAR(8) BASED;     /* ENTRY POINT NAME   #YL026UK*/ 07001000
AMSSALK1 DS    0H                                                  1629 07002000
*                                      /* FOR ULINK          #YL026UK*/ 07003000
*                                                                  1629 07004000
*        RESPECIFY LKNAME BASED(PARMPTR2);                 /*#YL026UK*/ 07005000
*                                      /* BASE ENTRY POINT   #YL026UK*/ 07006000
*                                      /* NAME               #YL026UK*/ 07007000
*                                                                  1630 07008000
*        DCL LINKARG CHAR(*) BASED;    /* ARGUMENT AREA      #YL026UK*/ 07009000
*                                                                  1630 07010000
*        RESPECIFY LINKARG BASED(PARMPTR3);                /*#YL026UK*/ 07011000
*                                      /* BASE ARGUMENT AREA #YL026UK*/ 07012000
*        DCL LKENTPT PTR(31);          /*ENTRY POINT LINKED MODULE   */ 07013000
*                                                          /*@Z40GSBF*/ 07014000
*                                                                  1633 07015000
*        /************************************************************/ 07016000
*        /*                                                  #YL026UK*/ 07017000
*        /* BASE INCOMING ARGUMENTS FOR CODE OPTIMIZATION    #YL026UK*/ 07018000
*        /*                                                  #YL026UK*/ 07019000
*        /************************************************************/ 07020000
*                                                                  1633 07021000
*        RESPECIFY (REG1PTR) RSTD;                         /*#YL026UK*/ 07022000
*        GDTPR = ADDR1;                                    /*#YL026UK*/ 07023000
         L     GDTPR,ADDR1(,REG1PTR)                               1634 07024000
*        PARMPTR2 = ADDR2;                                 /*#YL026UK*/ 07025000
         L     @00,ADDR2+4(,REG1PTR)                               1635 07026000
         ST    @00,PARMPTR2                                        1635 07027000
*        PARMPTR3 = ADDR3;                                 /*#YL026UK*/ 07028000
         L     @00,ADDR3+8(,REG1PTR)                               1636 07029000
         ST    @00,PARMPTR3                                        1636 07030000
*        RESPECIFY (REG1PTR) UNRSTD;                       /*#YL026UK*/ 07031000
*                                                                  1637 07032000
*                                                                  1637 07033000
*                                                                  1638 07034000
*        /************************************************************/ 07035000
*        /*                                                          */ 07036000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 07037000
*        /*                                                          */ 07038000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 07039000
*        /*              TO THIS ROUTINE                             */ 07040000
*        /*                                                          */ 07041000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 07042000
*        /*               ADDRESS LIST                               */ 07043000
*        /*                                                          */ 07044000
*        /************************************************************/ 07045000
*                                                                  1638 07046000
*        GEN;                                                      1638 07047000
        ST    1,LISTPTR                                                 07048000
        ST    1,LISTSCAN                                                07049000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              1639 07050000
         LA    @15,1                                               1639 07051000
         STC   @15,LISTLN                                          1639 07052000
@DL01639 L     @14,LISTSCAN                                        1639 07053000
         TM    LISTTEST(@14),B'10000000'                           1639 07054000
         BNZ   @DC01639                                            1639 07055000
*          LISTSCAN = LISTSCAN + 4;                                1640 07056000
         AL    @14,@CF00038                                        1640 07057000
         ST    @14,LISTSCAN                                        1640 07058000
*        END;                                                      1641 07059000
*                                                                  1641 07060000
         AL    @15,@CF00215                                        1641 07061000
         STC   @15,LISTLN                                          1641 07062000
         C     @15,@CF01724                                        1641 07063000
         BNH   @DL01639                                            1641 07064000
@DC01639 DS    0H                                                  1642 07065000
*        OLDERID2 = NEWERID2;                                      1642 07066000
         L     @15,GDTTR2(,GDTPR)                                  1642 07067000
         MVC   @TS00001(95),NEWERID2(@15)                          1642 07068000
         MVC   OLDERID2(95,@15),@TS00001                           1642 07069000
*        NEWID2 = 'SALK';                                  /*#YL026UK*/ 07070000
*                                                                  1643 07071000
         MVC   NEWID2(4,@15),@CC02399                              1643 07072000
*        /************************************************************/ 07073000
*        /*                                                  #YL026UK*/ 07074000
*        /* CALL FINDNAME RTN TO GET ENTRY POINT OF MODULE   @Z40GSBF*/ 07075000
*        /* LOAD MODULE IF NECESSARY AND TEMPORARILY         @Z40GSBF*/ 07076000
*        /* STORE THE ADDRESS OF THE ENTRY POINT TO BE       #YL026UK*/ 07077000
*        /* BRANCHED TO (CONTAINED IN REGISTER 0 AFTER       #YL026UK*/ 07078000
*        /* THE LOAD) INTO REGISTER 2                        #YL026UK*/ 07079000
*        /*                                                  #YL026UK*/ 07080000
*        /************************************************************/ 07081000
*                                                                  1644 07082000
*        TEMPEPN = LKNAME;                                 /*#YL026UK*/ 07083000
         L     @01,PARMPTR2                                        1644 07084000
         MVC   TEMPEPN(8),LKNAME(@01)                              1644 07085000
*        RESPECIFY (REG0,REG2) RSTD;                       /*#YL026UK*/ 07086000
*        CALL FINDNAME(TEMPEPN,LKENTPT);                   /*@Z40GSBF*/ 07087000
         LA    @03,TEMPEPN                                         1646 07088000
         ST    @03,@AL00001                                        1646 07089000
         LA    @03,LKENTPT                                         1646 07090000
         ST    @03,@AL00001+4                                      1646 07091000
         LA    @01,@AL00001                                        1646 07092000
         BAL   @14,FINDNAME                                        1646 07093000
*        REG2 = LKENTPT;                                   /*@Z40GSBF*/ 07094000
         L     REG2,LKENTPT                                        1647 07095000
*        RESPECIFY (REG0) UNRSTD;                          /*#YL026UK*/ 07096000
*                                                                  1648 07097000
*        /************************************************************/ 07098000
*        /*                                                  #YL026UK*/ 07099000
*        /* CHECK THE VALUE OF LISTLN TO DETERMINE IF        #YL026UK*/ 07100000
*        /* AN ARGUMENT IS TO BE PASSED TO THE CALLED        #YL026UK*/ 07101000
*        /* ROUTINE.  IF LISTLN IS GREATER THAN TWO          #YL026UK*/ 07102000
*        /* (INDICATING AN ARGUMENT), THEN REGISTER 3 IS     #YL026UK*/ 07103000
*        /* SET TO THE ADDR OF LINKARG (THE ADDRESS OF THE   #YL026UK*/ 07104000
*        /* ARGUMENT TO BE PASSED).  IF LISTLN IS NOT        #YL026UK*/ 07105000
*        /* GREATER THAN TWO (INDICATING NO ARGUMENT), THEN  #YL026UK*/ 07106000
*        /* REGISTER 3 IS SET TO ZERO.                       #YL026UK*/ 07107000
*        /*                                                  #YL026UK*/ 07108000
*        /************************************************************/ 07109000
*                                                                  1649 07110000
*        RESPECIFY (REG3) RSTD;                            /*#YL026UK*/ 07111000
*        IF LISTLN > 2                                             1650 07112000
*          THEN                                                    1650 07113000
         CLI   LISTLN,2                                            1650 07114000
         BNH   @RF01650                                            1650 07115000
*            REG3 = ADDR(LINKARG);                         /*#YL026UK*/ 07116000
         L     REG3,PARMPTR3                                       1651 07117000
*          ELSE                                                    1652 07118000
*            REG3 = 0;                                     /*#YL026UK*/ 07119000
*                                                                  1652 07120000
         B     @RC01650                                            1652 07121000
@RF01650 SLR   REG3,REG3                                           1652 07122000
*        /********************************************************** */ 07123000
*        /*                                                  #YL026UK*/ 07124000
*        /* STORE THE OLD SAVEAREA POINTER INTO REGISTER 7,  #YL026UK*/ 07125000
*        /* AND CHECK WHETHER OR NOT THIS MODULE'S AUTOMATIC #YL026UK*/ 07126000
*        /* STORAGE AREA IS TO BE FREED--NOTE DEPENDENCY     #YL026UK*/ 07127000
*        /* ON SA01 INITIALIZING TABLE AUTOTBL WITH SA02     #YL026UK*/ 07128000
*        /* AS THE SECOND ENTRY                              #YL026UK*/ 07129000
*        /*                                                  #YL026UK*/ 07130000
*        /************************************************************/ 07131000
*                                                                  1653 07132000
*        RESPECIFY (REG7,REG13) RSTD;                      /*#YL026UK*/ 07133000
@RC01650 DS    0H                                                  1654 07134000
*        GEN(L     REG7,4(REG13));                         /*#YL026UK*/ 07135000
         L     REG7,4(REG13)                                            07136000
*        STATUS(2) = STATUS(2) - 1;                        /*#YL026UK*/ 07137000
*                                                                  1655 07138000
         L     @06,GDTSAH(,GDTPR)                                  1655 07139000
         L     @06,AUTOPTR(,@06)                                   1655 07140000
         ICM   @15,12,STATUS+12(@06)                               1655 07141000
         SRA   @15,16                                              1655 07142000
         BCTR  @15,0                                               1655 07143000
         STCM  @15,3,STATUS+12(@06)                                1655 07144000
*        /************************************************************/ 07145000
*        /*                                                  #YL026UK*/ 07146000
*        /* CHECK IF THIS MODULE'S AUTOMATIC STORAGE STATUS  #YL026UK*/ 07147000
*        /* IS GREATER THAN ZERO.                            #YL026UK*/ 07148000
*        /*                                                  #YL026UK*/ 07149000
*        /************************************************************/ 07150000
*                                                                  1656 07151000
*        IF STATUS(2) > 0                                          1656 07152000
*          THEN                                                    1656 07153000
*                                                                  1656 07154000
         LTR   @15,@15                                             1656 07155000
         BNP   @RF01656                                            1656 07156000
*            /********************************************************/ 07157000
*            /*                                              #YL026UK*/ 07158000
*            /* FREE THIS MODULE'S AUTOMATIC STORAGE AREA    #YL026UK*/ 07159000
*            /*                                              #YL026UK*/ 07160000
*            /********************************************************/ 07161000
*                                                                  1657 07162000
*            DO;                                           /*#YL026UK*/ 07163000
*              RESPECIFY (REG0,REG1,REG11) RSTD;           /*#YL026UK*/ 07164000
*              TEMPPTR = REG11 - 8;                        /*#YL026UK*/ 07165000
         LR    @06,REG11                                           1659 07166000
         SL    @06,@CF00175                                        1659 07167000
         ST    @06,TEMPPTR                                         1659 07168000
*              RESPECIFY (REG11) UNRSTD;                   /*#YL026UK*/ 07169000
*              REG0 = AUTOSIZE;                            /*#YL026UK*/ 07170000
         ICM   REG0,15,AUTOSIZE(@06)                               1661 07171000
*              REG1 = TEMPPTR;                             /*#YL026UK*/ 07172000
         LR    REG1,@06                                            1662 07173000
*LFREM11:      GEN(FREEMAIN R,LV=(REG0),A=(REG1));         /*#YL026UK*/ 07174000
LFREM11  FREEMAIN R,LV=(REG0),A=(REG1)                                  07175000
*              RESPECIFY (REG0,REG1) UNRSTD;               /*#YL026UK*/ 07176000
*            END;                                          /*#YL026UK*/ 07177000
*                                                                  1665 07178000
*        /************************************************************/ 07179000
*        /*                                                  #YL026UK*/ 07180000
*        /* RESTORE OLD SAVEAREA POINTER, LOAD THE ADDRESS   #YL026UK*/ 07181000
*        /* OF THE ENTRY POINT TO BE BRANCHED TO INTO REGISTER       */ 07182000
*        /* 15, LOAD THE ADDRESS OF THE ARGUMENT TO          #YL026UK*/ 07183000
*        /* BE PASSED INTO REGISTER 1, AND RESTORE REGISTERS #YL026UK*/ 07184000
*        /* EXCLUDING REGISTERS 1 AND 15.                    #YL026UK*/ 07185000
*        /*                                                  #YL026UK*/ 07186000
*        /************************************************************/ 07187000
*                                                                  1666 07188000
*        REG13 = REG7;                                     /*#YL026UK*/ 07189000
@RF01656 LR    REG13,REG7                                          1666 07190000
*        RESPECIFY (REG7) UNRSTD;                          /*#YL026UK*/ 07191000
*        RESPECIFY (REG1,REG15) RSTD;                      /*#YL026UK*/ 07192000
*        REG15 = REG2;                                     /*#YL026UK*/ 07193000
         LR    REG15,REG2                                          1669 07194000
*        REG1 = REG3;                                      /*#YL026UK*/ 07195000
         LR    REG1,REG3                                           1670 07196000
*        RESPECIFY (REG2,REG3) UNRSTD;                     /*#YL026UK*/ 07197000
*        GEN(L     REG14,12(REG13));                       /*#YL026UK*/ 07198000
         L     REG14,12(REG13)                                          07199000
*        GEN(L     REG0,20(REG13));                        /*#YL026UK*/ 07200000
         L     REG0,20(REG13)                                           07201000
*        GEN(LM    REG2,REG12,28(REG13));                  /*#YL026UK*/ 07202000
         LM    REG2,REG12,28(REG13)                                     07203000
*        RESPECIFY (REG13) UNRSTD;                         /*#YL026UK*/ 07204000
*                                                                  1675 07205000
*        /************************************************************/ 07206000
*        /*                                                  #YL026UK*/ 07207000
*        /* EXECUTE A BRANCH ON REGISTER 15                  #YL026UK*/ 07208000
*        /*                                                  #YL026UK*/ 07209000
*        /************************************************************/ 07210000
*                                                                  1676 07211000
*        GEN(BR    REG15);                                 /*#YL026UK*/ 07212000
         BR    REG15                                                    07213000
*        RESPECIFY (REG1,REG15) UNRSTD;                    /*#YL026UK*/ 07214000
*        /************************************************************/ 07215000
*        /*                                                  #YL026UK*/ 07216000
*        /*  PROCEDURE NAME - COREINIT                       #YL026UK*/ 07217000
*        /*                                                  #YL026UK*/ 07218000
*        /*  FUNCTION - THIS PROCEDURE INITIALIZES CORE,  THE ADDRESS*/ 07219000
*        /*             OF THE CORE AND THE VALUE IT IS TO BE        */ 07220000
*        /*             INITIALIZED TO ARE PROVIDED BY THE CALLER    */ 07221000
*        /*                                                  #YL026UK*/ 07222000
*        /*  INPUT - PARAMETER LIST CONTAINING THE ADDRESS OF A SIZE */ 07223000
*        /*          ARGUMENT, THE ADDRESS OF A VARIABLE CONTAINING  */ 07224000
*        /*          THE ADDRESS OF THE CORE TO BE INITIALIZED, AND  */ 07225000
*        /*          THE ADDRESS OF AN ARGUMENT INDICATING THE VALUE */ 07226000
*        /*          TO WHICH THE CORE IS TO BE INITIALIZED. #YL026UK*/ 07227000
*        /*                                                  #YL026UK*/ 07228000
*        /*  OUTPUT - THE INITIALIZED CORE                   #YL026UK*/ 07229000
*        /*                                                  #YL026UK*/ 07230000
*        /************************************************************/ 07231000
*        /************************************************************/ 07232000
*        /*                                                  #YL026UK*/ 07233000
*        /* CORE INITIALIZATION REQUEST INNER PROCEDURE      #YL026UK*/ 07234000
*        /*                                                  #YL026UK*/ 07235000
*        /************************************************************/ 07236000
*                                                                  1678 07237000
*COREINIT: PROCEDURE(ZSIZE,ZPTR,INITC);                    /*#YL026UK*/ 07238000
*                                                                  1678 07239000
         B     @PB00002                                            1678 07240000
COREINIT STM   @14,@12,@SA00002                                    1678 07241000
         MVC   @PC00002(12),0(@01)                                 1678 07242000
*        DCL ZSIZE FIXED(31);          /* SIZE OF AREA TO INITIALIZE */ 07243000
*                                                                  1679 07244000
*        DCL ZPTR PTR(31);             /* ADDRESS OF AREA TO #YL026UK*/ 07245000
*                                      /* INITIALIZE         #YL026UK*/ 07246000
*                                                                  1681 07247000
*        DCL ALLINIT CHAR(256);        /* AREA TO INITIALIZE FROM    */ 07248000
*                                                                  1681 07249000
*        DCL INITCHAR CHAR(*) BASED(ZPTR);                 /*#YL026UK*/ 07250000
*                                      /* AREA TO BE INITIALIZED     */ 07251000
*                                                                  1683 07252000
*        DCL INITC CHAR(1);            /* INITIALIZATION CHARACTER   */ 07253000
*                                      /* PASSED             #YL026UK*/ 07254000
*                                                                  1684 07255000
*        DCL CHARIN CHAR(1);           /* INITIALIZATION CHARACTER   */ 07256000
*                                                                  1684 07257000
*        /************************************************************/ 07258000
*        /*                                                  #YL026UK*/ 07259000
*        /* INITIALIZE 256 BYTE AREA ALLINIT TO VALUE OF REQUEST     */ 07260000
*        /*                                                  #YL026UK*/ 07261000
*        /************************************************************/ 07262000
*                                                                  1685 07263000
*        CHARIN = INITC;                                   /*#YL026UK*/ 07264000
         L     @15,@PC00002+8                                      1685 07265000
         MVC   CHARIN(1),INITC(@15)                                1685 07266000
*        GEN(MVC   ALLINIT(1),CHARIN);                     /*#YL026UK*/ 07267000
         MVC   ALLINIT(1),CHARIN                                        07268000
*        GEN(MVC   ALLINIT+1(255),ALLINIT);                /*#YL026UK*/ 07269000
         MVC   ALLINIT+1(255),ALLINIT                                   07270000
*        DOCNTRL = ON;                                     /*#YL026UK*/ 07271000
         OI    DOCNTRL,B'10000000'                                 1688 07272000
*INITDO: DO WHILE (DOCNTRL = ON);                          /*#YL026UK*/ 07273000
*                                                                  1689 07274000
INITDO   B     @DE01689                                            1689 07275000
@DL01689 DS    0H                                                  1690 07276000
*          /**********************************************************/ 07277000
*          /*                                                #YL026UK*/ 07278000
*          /* CHECK FOR MORE THAN 256 BYTES TO INITIALIZE    #YL026UK*/ 07279000
*          /*                                                #YL026UK*/ 07280000
*          /**********************************************************/ 07281000
*                                                                  1690 07282000
*          IF ZSIZE > 256                                          1690 07283000
*            THEN                                                  1690 07284000
         LA    @15,256                                             1690 07285000
         L     @14,@PC00002                                        1690 07286000
         L     @07,ZSIZE(,@14)                                     1690 07287000
         CR    @07,@15                                             1690 07288000
         BNH   @RF01690                                            1690 07289000
*              DO;                                         /*#YL026UK*/ 07290000
*                                                                  1691 07291000
*                /****************************************************/ 07292000
*                /*                                          #YL026UK*/ 07293000
*                /* INITIALIZE 256 BYTES AND UPDATE SIZE AND POINTER */ 07294000
*                /* VARIABLES FOR NEXT ITERATION             #YL026UK*/ 07295000
*                /*                                          #YL026UK*/ 07296000
*                /****************************************************/ 07297000
*                                                                  1692 07298000
*                INITCHAR(1:256) = ALLINIT(1:256);         /*#YL026UK*/ 07299000
         L     @06,@PC00002+4                                      1692 07300000
         L     @05,ZPTR(,@06)                                      1692 07301000
         MVC   INITCHAR(256,@05),ALLINIT                           1692 07302000
*                ZSIZE = ZSIZE - 256;                      /*#YL026UK*/ 07303000
         SLR   @07,@15                                             1693 07304000
         ST    @07,ZSIZE(,@14)                                     1693 07305000
*                ZPTR = ZPTR + 256;                        /*#YL026UK*/ 07306000
         ALR   @05,@15                                             1694 07307000
         ST    @05,ZPTR(,@06)                                      1694 07308000
*              END;                                        /*#YL026UK*/ 07309000
*            ELSE                                                  1696 07310000
*              DO;                                         /*#YL026UK*/ 07311000
*                                                                  1696 07312000
         B     @RC01690                                            1696 07313000
@RF01690 DS    0H                                                  1697 07314000
*                /****************************************************/ 07315000
*                /*                                          #YL026UK*/ 07316000
*                /* INITIALIZE ZSIZE BYTES AND SET DOCNTRL TO FALL   */ 07317000
*                /* OUT OF LOOP                              #YL026UK*/ 07318000
*                /*                                          #YL026UK*/ 07319000
*                /****************************************************/ 07320000
*                                                                  1697 07321000
*                INITCHAR(1:ZSIZE) = ALLINIT(1:ZSIZE);     /*#YL026UK*/ 07322000
         L     @15,@PC00002+4                                      1697 07323000
         L     @01,ZPTR(,@15)                                      1697 07324000
         L     @15,@PC00002                                        1697 07325000
         L     @15,ZSIZE(,@15)                                     1697 07326000
         BCTR  @15,0                                               1697 07327000
         EX    @15,@SM02490                                        1697 07328000
*                DOCNTRL = OFF;                            /*#YL026UK*/ 07329000
         NI    DOCNTRL,B'01111111'                                 1698 07330000
*              END;                                        /*#YL026UK*/ 07331000
*        END INITDO;                                       /*#YL026UK*/ 07332000
@RC01690 DS    0H                                                  1700 07333000
@DE01689 TM    DOCNTRL,B'10000000'                                 1700 07334000
         BO    @DL01689                                            1700 07335000
*        END COREINIT;                                     /*#YL026UK*/ 07336000
@EL00002 DS    0H                                                  1701 07337000
@EF00002 DS    0H                                                  1701 07338000
@ER00002 LM    @14,@12,@SA00002                                    1701 07339000
         BR    @14                                                 1701 07340000
*        /************************************************************/ 07341000
*        /*                                                  #YL026UK*/ 07342000
*        /*  PROCEDURE NAME - NOSUPP                         #YL026UK*/ 07343000
*        /*                                                  #YL026UK*/ 07344000
*        /*  FUNCTION - THIS PROCEDURE PRINTS OUT AN ERROR   #YL026UK*/ 07345000
*        /*             MESSAGE 'FUNCTION NOT SUPPORTED IN   #YL026UK*/ 07346000
*        /*             THIS ENVIRONMENT'.                   #YL026UK*/ 07347000
*        /*                                                  #YL026UK*/ 07348000
*        /*  INPUT - NONE                                    #YL026UK*/ 07349000
*        /*                                                  #YL026UK*/ 07350000
*        /*  OUTPUT - PRINTED MESSAGE                        #YL026UK*/ 07351000
*        /*                                                  #YL026UK*/ 07352000
*        /************************************************************/ 07353000
*        /************************************************************/ 07354000
*        /*                                                  #YL026UK*/ 07355000
*        /* FUNCTION NOT SUPPORTED IN THIS ENVIRONMENT       #YL026UK*/ 07356000
*        /* INNER PROCEDURE                                  #YL026UK*/ 07357000
*        /*                                                  #YL026UK*/ 07358000
*        /************************************************************/ 07359000
*                                                                  1702 07360000
*NOSUPP: PROCEDURE;                                        /*#YL026UK*/ 07361000
*                                                                  1702 07362000
NOSUPP   STM   @14,@12,@SA00003                                    1702 07363000
*        /* STID NUMBER FOR FUNCTION NOT SUPPORTED IN THIS   #YL026UK*/ 07364000
*        /* ENVIRONMENT                                      #YL026UK*/ 07365000
*        DCL NOSUSTID FIXED(8) CONSTANT(8);                /*#YL026UK*/ 07366000
*                                                                  1703 07367000
*        /***********************************************************/  07368000
*        /*                                                  #YL026UK*/ 07369000
*        /* SET ADDRESSABILITY AND INITIALIZE MESSAGE AREA   #YL026UK*/ 07370000
*        /*                                                  #YL026UK*/ 07371000
*        /************************************************************/ 07372000
*                                                                  1704 07373000
*        DDSTRU = ADDR(MSGAREA);                           /*#YL026UK*/ 07374000
         LA    @15,MSGAREA                                         1704 07375000
         ST    @15,DDSTRU                                          1704 07376000
*        DARGLIST = '0'B;                                  /*#YL026UK*/ 07377000
*                                                                  1705 07378000
         XC    DARGLIST+1(19,@15),DARGLIST+1(@15)                  1705 07379000
         MVI   DARGLIST(@15),B'00000000'                           1705 07380000
*        /************************************************************/ 07381000
*        /*                                                  #YL026UK*/ 07382000
*        /* SET MESSAGE DATA, PRINT MESSAGE, AND RETURN      #YL026UK*/ 07383000
*        /* TO NOSUPP CALLER                                 #YL026UK*/ 07384000
*        /*                                                  #YL026UK*/ 07385000
*        /************************************************************/ 07386000
*                                                                  1706 07387000
*        DARGSMOD = UNIVMOD;                               /*#YL026UK*/ 07388000
         MVC   DARGSMOD(3,@15),@CC01344                            1706 07389000
*        DARGSENT = NOSUSTID;                              /*#YL026UK*/ 07390000
         MVI   DARGSENT(@15),X'08'                                 1707 07391000
*        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);             /*#YL026UK*/ 07392000
         ST    GDTPR,@AL00001                                      1708 07393000
         LA    @15,@CF00111                                        1708 07394000
         ST    @15,@AL00001+4                                      1708 07395000
         LA    @15,DDSTRU                                          1708 07396000
         ST    @15,@AL00001+8                                      1708 07397000
         MVI   @AL00001+8,X'80'                                    1708 07398000
         L     @15,GDTPRT(,GDTPR)                                  1708 07399000
         LA    @01,@AL00001                                        1708 07400000
         BALR  @14,@15                                             1708 07401000
*        RETURN;                                           /*#YL026UK*/ 07402000
@EL00003 DS    0H                                                  1709 07403000
@EF00003 DS    0H                                                  1709 07404000
@ER00003 LM    @14,@12,@SA00003                                    1709 07405000
         BR    @14                                                 1709 07406000
*        END NOSUPP;                                       /*#YL026UK*/ 07407000
*        /************************************************************/ 07408000
*        /*                                                  @Z40GSBF*/ 07409000
*        /*  PROCEDURE NAME - FINDNAME                       @Z40GSBF*/ 07410000
*        /*                                                  @Z40GSBF*/ 07411000
*        /*  FUNCTION - THIS PROCEDURE WILL SEARCH THE LOAD  @Z40GSBF*/ 07412000
*        /*             LIST BLOCKS TO SEE IF MODULE HAS     @Z40GSBF*/ 07413000
*        /*             BEEN LOADED AND STILL IN CORE.IF IT  @Z40GSBF*/ 07414000
*        /*             IS RETURN WITH ENTRY POINT.IF NOT    @Z40GSBF*/ 07415000
*        /*             LOAD THE CALLED MODULE,PUT NAME IN   @Z40GSBF*/ 07416000
*        /*             IN LOAD BLOCK,THEN UP USE COUNTER    @Z40GSBF*/ 07417000
*        /*             ONE AND RETURN WITH ENTRY POINT.     @Z40GSBF*/ 07418000
*        /*                                                  @Z40GSBF*/ 07419000
*        /*  INPUT - MODULE NAME                             @Z40GSBF*/ 07420000
*        /*                                                  @Z40GSBF*/ 07421000
*        /*  OUTPUT - ENTRY POINT OF MODULE                  @Z40GSBF*/ 07422000
*        /*                                                  @Z40GSBF*/ 07423000
*        /************************************************************/ 07424000
*        /***************************************************@Z40GSBF*/ 07425000
*        /***************************************************@Z40GSBF*/ 07426000
*        /*                                                  @Z40GSBF*/ 07427000
*        /*   FINDNAME THIS WILL LOAD MODULE IF NOT          @Z40GSBF*/ 07428000
*        /*   IN CORE  -  THEN RETURN ENTRY POINT            @Z40GSBF*/ 07429000
*        /*                                                  @Z40GSBF*/ 07430000
*        /***************************************************@Z40GSBF*/ 07431000
*        /***************************************************@Z40GSBF*/ 07432000
*                                                                  1711 07433000
*FINDNAME:   PROC(CLNAMX,ENTPT);                           /*@Z40GSBF*/ 07434000
FINDNAME STM   @14,@12,@SA00004                                    1711 07435000
         MVC   @PC00004(8),0(@01)                                  1711 07436000
*        DCL CLNAMX    CHAR(8);        /* NAME OF MODULE     @Z40GSBF*/ 07437000
*        DCL ENTPT     PTR(31);        /* ENTRY POINT        @Z40GSBF*/ 07438000
*        DCL P         PTR(31);        /* POINTER TO CURRENT LLBLK   */ 07439000
*                                                          /*@Z40GSBF*/ 07440000
*        DCL CONTROL   BIT(1);         /* DO LOOP CONTROL    @Z40GSBF*/ 07441000
*        DCL NAMEFND   BIT(1);         /* NAME FOUND SW      @Z40GSBF*/ 07442000
*        DCL INDX      FIXED(15);      /* LOAD LIST INDEX    @Z40GSBF*/ 07443000
*        DCL SLTOUSE  PTR(31);         /* SLOT TO USE PTR    @Z014804*/ 07444000
*        DCL LOADNAME CHAR(8);         /* NAME OF MODULE     @Z014804*/ 07445000
*                                                          /*@Z40GSBF*/ 07446000
*        INDX = 0;                                         /*@Z40GSBF*/ 07447000
         SLR   @15,@15                                             1720 07448000
         STH   @15,INDX                                            1720 07449000
*        NUMCMD  = 0;                                      /*@OZ28569*/ 07450000
         STH   @15,NUMCMD                                          1721 07451000
*        CONTROL = OFF;                                    /*@Z40GSBF*/ 07452000
         NI    CONTROL,B'01111111'                                 1722 07453000
*        NAMEFND = OFF;                                    /*@Z40GSBF*/ 07454000
         NI    NAMEFND,B'01111111'                                 1723 07455000
*                                                          /*@Z40GSBF*/ 07456000
*        /************************************************************/ 07457000
*        /*                                                  @Z40GSBF*/ 07458000
*        /* SEARCH LLBLKS FOR MATCH OF MODULE NAME           @Z40GSBF*/ 07459000
*        /*                                                  @Z40GSBF*/ 07460000
*        /************************************************************/ 07461000
*                                                          /*@Z40GSBF*/ 07462000
*FNDO:   DO WHILE CONTROL = OFF;                           /*@Z40GSBF*/ 07463000
FNDO     B     @DE01724                                            1724 07464000
@DL01724 DS    0H                                                  1725 07465000
*          IF INDX = 0                                     /*@Z40GSBF*/ 07466000
*            THEN                                          /*@Z40GSBF*/ 07467000
         LH    @15,INDX                                            1725 07468000
         LTR   @15,@15                                             1725 07469000
         BNZ   @RF01725                                            1725 07470000
*                                                          /*@Z40GSBF*/ 07471000
*              /******************************************************/ 07472000
*              /*                                            @Z40GSBF*/ 07473000
*              /*   FIRST TIME USE PTR IN SAHIST             @Z40GSBF*/ 07474000
*              /*                                            @Z40GSBF*/ 07475000
*              /******************************************************/ 07476000
*                                                          /*@Z40GSBF*/ 07477000
*              P= LLBLKPTR;                                /*@Z40GSBF*/ 07478000
         L     @01,GDTSAH(,GDTPR)                                  1726 07479000
         L     @15,LLBLKPTR(,@01)                                  1726 07480000
         ST    @15,P                                               1726 07481000
*            ELSE;                                         /*@Z40GSBF*/ 07482000
@RF01725 DS    0H                                                  1728 07483000
*                                                          /*@Z40GSBF*/ 07484000
*          /**********************************************************/ 07485000
*          /*                                                @Z40GSBF*/ 07486000
*          /*    SEARCH FOR MODULE MATCH                     @Z40GSBF*/ 07487000
*          /*                                                @Z40GSBF*/ 07488000
*          /*********************************************************/  07489000
*                                                          /*@Z40GSBF*/ 07490000
*          DO INDX = 1 TO LLSLTCNT WHILE CONTROL = OFF;    /*@Z40GSBF*/ 07491000
*                                                                  1728 07492000
         LA    @15,1                                               1728 07493000
         STH   @15,INDX                                            1728 07494000
@DL01728 TM    CONTROL,B'10000000'                                 1728 07495000
         BNZ   @DC01728                                            1728 07496000
*            /********************************************************/ 07497000
*            /*                                                      */ 07498000
*            /*  COUNT THE NUMBER OF DIFFERENT COMMANDS THAT HAVE    */ 07499000
*            /*  HAVE BEEN EXECUTED DURING THIS JOB STEP.            */ 07500000
*            /*                                                      */ 07501000
*            /********************************************************/ 07502000
*                                                                  1729 07503000
*            IF LLNAME(INDX,1:5) = 'IDCCD'                 /*@OZ28569*/ 07504000
*              THEN                                        /*@OZ25869*/ 07505000
         SLA   @15,4                                               1729 07506000
         L     @01,P                                               1729 07507000
         ALR   @01,@15                                             1729 07508000
         AL    @01,@CF02460                                        1729 07509000
         CLC   LLNAME-8(5,@01),@CC02432                            1729 07510000
         BNE   @RF01729                                            1729 07511000
*                NUMCMD = NUMCMD + 1;                      /*@OZ25869*/ 07512000
*                                                                  1730 07513000
         LH    @01,NUMCMD                                          1730 07514000
         LA    @01,1(,@01)                                         1730 07515000
         STH   @01,NUMCMD                                          1730 07516000
*            IF LLNOMOD(INDX) = 0                          /*@ZM43017*/ 07517000
*                                                          /*@Z40GSBF*/ 07518000
*            /********************************************************/ 07519000
*            /*                                              @Z40GSBF*/ 07520000
*            /*  NO MODULE IN THIS SLOT WHEN 0 IS FOUND      @Z40GSBF*/ 07521000
*            /*                                              @Z40GSBF*/ 07522000
*            /********************************************************/ 07523000
*                                                          /*@Z40GSBF*/ 07524000
*              THEN;                                       /*@Z40GSBF*/ 07525000
@RF01729 LH    @15,INDX                                            1731 07526000
         SLA   @15,4                                               1731 07527000
         L     @01,P                                               1731 07528000
         ALR   @01,@15                                             1731 07529000
         AL    @01,@CF02469                                        1731 07530000
         ICM   @00,15,LLNOMOD-12(@01)                              1731 07531000
         LTR   @00,@00                                             1731 07532000
         BZ    @RT01731                                            1731 07533000
*              ELSE                                        /*@Z40GSBF*/ 07534000
*                DO;                                       /*@Z40GSBF*/ 07535000
*                  IF CLNAMX = LLNAME(INDX)                /*@Z40GSBF*/ 07536000
*                    THEN                                  /*@Z40GSBF*/ 07537000
         L     @15,@PC00004                                        1734 07538000
         L     @14,P                                               1734 07539000
         LH    @07,INDX                                            1734 07540000
         SLA   @07,4                                               1734 07541000
         ST    @07,@TF00001                                        1734 07542000
         ALR   @07,@14                                             1734 07543000
         AL    @07,@CF02460                                        1734 07544000
         CLC   CLNAMX(8,@15),LLNAME-8(@07)                         1734 07545000
         BNE   @RF01734                                            1734 07546000
*                      DO;                                 /*@Z40GSBF*/ 07547000
*                                                          /*@Z40GSBF*/ 07548000
*                      /**********************************************/ 07549000
*                      /*                                    @Z40GSBF*/ 07550000
*                      /*   GOT A MATCH ON MODULE NAME       @Z40GSBF*/ 07551000
*                      /*                                    @Z40GSBF*/ 07552000
*                      /**********************************************/ 07553000
*                                                          /*@Z40GSBF*/ 07554000
*                        CONTROL = ON;                     /*@Z40GSBF*/ 07555000
         OI    CONTROL,B'10000000'                                 1736 07556000
*                        NAMEFND = ON;                     /*@Z40GSBF*/ 07557000
         OI    NAMEFND,B'10000000'                                 1737 07558000
*                        ENTPT = LLADDR(INDX);             /*@Z40GSBF*/ 07559000
         L     @15,@PC00004+4                                      1738 07560000
         LR    @01,@14                                             1738 07561000
         AL    @01,@TF00001                                        1738 07562000
         ICM   @00,15,LLADDR-16(@01)                               1738 07563000
         ST    @00,ENTPT(,@15)                                     1738 07564000
*                        LLUSECTR(INDX) = LLUSECTR(INDX)+1;/*@Z40GSBF*/ 07565000
         LA    @15,1                                               1739 07566000
         L     @01,@TF00001                                        1739 07567000
         SLR   @00,@00                                             1739 07568000
         IC    @00,LLUSECTR-16(@01,@14)                            1739 07569000
         ALR   @15,@00                                             1739 07570000
         L     @01,@TF00001                                        1739 07571000
         STC   @15,LLUSECTR-16(@01,@14)                            1739 07572000
*                        END;                              /*@Z40GSBF*/ 07573000
*                    ELSE;                                 /*@Z40GSBF*/ 07574000
@RF01734 DS    0H                                                  1742 07575000
*                END;                                      /*@Z40GSBF*/ 07576000
*          END;                                            /*@Z40GSBF*/ 07577000
*                                                                  1743 07578000
@RT01731 LA    @15,1                                               1743 07579000
         AH    @15,INDX                                            1743 07580000
         STH   @15,INDX                                            1743 07581000
         C     @15,@CF00306                                        1743 07582000
         BNH   @DL01728                                            1743 07583000
@DC01728 DS    0H                                                  1744 07584000
*          /**********************************************************/ 07585000
*          /*                                                @Z40GSBF*/ 07586000
*          /*   USE CHAIN PTR IN LLBLK(S) IF 0 LAST LLBLK    @Z40GSBF*/ 07587000
*          /*                                                @Z40GSBF*/ 07588000
*          /**********************************************************/ 07589000
*                                                          /*@Z40GSBF*/ 07590000
*          IF LLNXTBLK = 0                                 /*@Z40GSBF*/ 07591000
*            THEN                                          /*@Z40GSBF*/ 07592000
         L     @01,P                                               1744 07593000
         L     @15,LLNXTBLK(,@01)                                  1744 07594000
         LTR   @15,@15                                             1744 07595000
         BNZ   @RF01744                                            1744 07596000
*              CONTROL = ON;                               /*@Z40GSBF*/ 07597000
         OI    CONTROL,B'10000000'                                 1745 07598000
*            ELSE                                          /*@Z40GSBF*/ 07599000
*              P = LLNXTBLK;                               /*@Z40GSBF*/ 07600000
         B     @RC01744                                            1746 07601000
@RF01744 L     @01,P                                               1746 07602000
         L     @15,LLNXTBLK(,@01)                                  1746 07603000
         ST    @15,P                                               1746 07604000
*        END FNDO;                                         /*@Z40GSBF*/ 07605000
*                                                                  1747 07606000
@RC01744 DS    0H                                                  1747 07607000
@DE01724 TM    CONTROL,B'10000000'                                 1747 07608000
         BZ    @DL01724                                            1747 07609000
*        CONTROL = OFF;                                    /*@Z40GSBF*/ 07610000
         NI    CONTROL,B'01111111'                                 1748 07611000
*          IF NAMEFND = ON                                 /*@Z40GSBF*/ 07612000
*            THEN;                                         /*@Z40GSBF*/ 07613000
         TM    NAMEFND,B'10000000'                                 1749 07614000
         BO    @RT01749                                            1749 07615000
*            ELSE                                          /*@Z40GSBF*/ 07616000
*              DO;                                         /*@Z40GSBF*/ 07617000
*              /*********************************************@Z40GSBF*/ 07618000
*              /*                                            @Z40GSBF*/ 07619000
*              /*     MODULE WAS NOT IN LLBLK PREPARE TO     @Z40GSBF*/ 07620000
*              /*     RELEASE ANY MODULES NOT NEEDED THEN            */ 07621000
*              /*     LOAD NEEDED MODULE AND                 @Z40GSBF*/ 07622000
*              /*     FIND A AVAILABLE SLOT FOR THIS MODULE. @Z40GSBF*/ 07623000
*              /******************************************************/ 07624000
*                                                                  1752 07625000
*              IF NUMCMD > 2                               /*@OZ25869*/ 07626000
*                THEN                                      /*@OZ25869*/ 07627000
         LH    @15,NUMCMD                                          1752 07628000
         C     @15,@CF00149                                        1752 07629000
         BNH   @RF01752                                            1752 07630000
*                  CALL RELECORE;                          /*@OZ25869*/ 07631000
*                                                                  1753 07632000
         BAL   @14,RELECORE                                        1753 07633000
*              P = LLBLKPTR;                               /*@Z40GSBF*/ 07634000
@RF01752 L     @01,GDTSAH(,GDTPR)                                  1754 07635000
         L     @15,LLBLKPTR(,@01)                                  1754 07636000
         ST    @15,P                                               1754 07637000
*                DO WHILE LLFSTSLT = 0;                    /*@Z40GSBF*/ 07638000
         B     @DE01755                                            1755 07639000
@DL01755 DS    0H                                                  1756 07640000
*                                                          /*@Z40GSBF*/ 07641000
*                                                          /*@Z40GSBF*/ 07642000
*                  IF LLNXTBLK = 0                         /*@Z40GSBF*/ 07643000
*                    THEN                                  /*@Z40GSBF*/ 07644000
         L     @15,P                                               1756 07645000
         L     @14,LLNXTBLK(,@15)                                  1756 07646000
         LTR   @14,@14                                             1756 07647000
         BNZ   @RF01756                                            1756 07648000
*                      DO;                                 /*@Z40GSBF*/ 07649000
*                                                          /*@Z40GSBF*/ 07650000
*                      /*************************************@Z40GSBF*/ 07651000
*                      /*                                    @Z40GSBF*/ 07652000
*                      /* NO SLOTS AVAIL.BUILD A NEW LLBLK   @Z40GSBF*/ 07653000
*                      /*                                    @Z40GSBF*/ 07654000
*                      /*************************************@Z40GSBF*/ 07655000
*                                                          /*@Z40GSBF*/ 07656000
*                        OLDERID2 = NEWERID2;                      1758 07657000
         L     @14,GDTTR2(,GDTPR)                                  1758 07658000
         MVC   @TS00001(95),NEWERID2(@14)                          1758 07659000
         MVC   OLDERID2(95,@14),@TS00001                           1758 07660000
*                        NEWID2 = 'SABB';                  /*@Z40GSBF*/ 07661000
         MVC   NEWID2(4,@14),@CC02433                              1759 07662000
*                        CALL IDCSAGS0(GDTTBL,(LLSLTCNT*(LENGTH(LLSLOT) 07663000
*)                                                                 1760 07664000
*                        +(LENGTH(LLHDR)),LLNXTBLK,SETZERO);       1760 07665000
         ST    GDTPR,@AL00001                                      1760 07666000
         LA    @14,@CF02454                                        1760 07667000
         ST    @14,@AL00001+4                                      1760 07668000
         LA    @15,LLNXTBLK(,@15)                                  1760 07669000
         ST    @15,@AL00001+8                                      1760 07670000
         LA    @15,SETZERO                                         1760 07671000
         ST    @15,@AL00001+12                                     1760 07672000
         MVI   @AL00001+12,X'80'                                   1760 07673000
         L     @15,GDTGSP(,GDTPR)                                  1760 07674000
         LA    @01,@AL00001                                        1760 07675000
         BALR  @14,@15                                             1760 07676000
*                                                          /*@Z40GSBF*/ 07677000
*                        TESTRC = RTNREG;                  /*@Z40GSBF*/ 07678000
         STH   RTNREG,TESTRC                                       1761 07679000
*                          IF TESTRC ^= 0                  /*@Z40GSBF*/ 07680000
*                            THEN                          /*@Z40GSBF*/ 07681000
*                                                                  1762 07682000
         LH    @15,TESTRC                                          1762 07683000
         LTR   @15,@15                                             1762 07684000
         BZ    @RF01762                                            1762 07685000
*                              DO;                                 1763 07686000
*                                RESPECIFY(REG13,REG14,REG15) RSTD;     07687000
*                                REG15 = NOSPACE;                  1765 07688000
         LA    REG15,28                                            1765 07689000
*                                REG14 = GDTABT;                   1766 07690000
         L     REG14,GDTABT(,GDTPR)                                1766 07691000
*                                REG13 = GDTABH;                   1767 07692000
         L     REG13,GDTABH(,GDTPR)                                1767 07693000
*                                GEN(BR    REG14);                 1768 07694000
         BR    REG14                                                    07695000
*                                RESPECIFY(REG13,REG14,REG15)UNRSTD;    07696000
*                              END;            /*@Z40GSBF*/        1770 07697000
*                            ELSE                          /*@Z40GSBF*/ 07698000
*                              DO;                         /*@Z40GSBF*/ 07699000
         B     @RC01762                                            1771 07700000
@RF01762 DS    0H                                                  1772 07701000
*                                                          /*@Z40GSBF*/ 07702000
*                              /**************************************/ 07703000
*                              /*                            @Z40GSBF*/ 07704000
*                              /* FORMAT AND CHAIN NEW LLBLK @Z40GSBF*/ 07705000
*                              /*                            @Z40GSBF*/ 07706000
*                              /**************************************/ 07707000
*                                                          /*@Z40GSBF*/ 07708000
*                              P= LLNXTBLK;                /*@Z40GSBF*/ 07709000
         L     @01,P                                               1772 07710000
         L     @15,LLNXTBLK(,@01)                                  1772 07711000
         ST    @15,P                                               1772 07712000
*                              LLFSTSLT = ADDR(LLNXTSLT(1));       1773 07713000
         LA    @14,LLNXTSLT(,@15)                                  1773 07714000
         ST    @14,LLFSTSLT(,@15)                                  1773 07715000
*                                                          /*@Z40GSBF*/ 07716000
*                                DO INDX = 1 TO LLSLTCNT;  /*@Z40GSBF*/ 07717000
         LA    @15,1                                               1774 07718000
         STH   @15,INDX                                            1774 07719000
@DL01774 DS    0H                                                  1775 07720000
*                                  LLNXTSLT(INDX) =                1775 07721000
*                                  ADDR(LLNXTSLT(INDX+1)); /*@Z40GSBF*/ 07722000
         L     @14,P                                               1775 07723000
         LR    @07,@15                                             1775 07724000
         SLA   @07,4                                               1775 07725000
         LA    @06,LLNXTSLT(@07,@14)                               1775 07726000
         ALR   @14,@07                                             1775 07727000
         AL    @14,@CF02460                                        1775 07728000
         STCM  @06,15,LLNXTSLT-8(@14)                              1775 07729000
*                                END;                      /*@Z40GSBF*/ 07730000
         AL    @15,@CF00215                                        1776 07731000
         STH   @15,INDX                                            1776 07732000
         C     @15,@CF00306                                        1776 07733000
         BNH   @DL01774                                            1776 07734000
*                              LLNXTSLT(LLSLTCNT) = 0;     /*@Z40GSBF*/ 07735000
         L     @01,P                                               1777 07736000
         SLR   @00,@00                                             1777 07737000
         STCM  @00,15,LLNXTSLT+368(@01)                            1777 07738000
*                            END;                          /*@Z40GSBF*/ 07739000
*                      END;                                /*@Z40GSBF*/ 07740000
*                    ELSE                                  /*@Z40GSBF*/ 07741000
*                      P = LLNXTBLK;                       /*@Z40GSBF*/ 07742000
         B     @RC01756                                            1780 07743000
@RF01756 L     @01,P                                               1780 07744000
         L     @15,LLNXTBLK(,@01)                                  1780 07745000
         ST    @15,P                                               1780 07746000
*                END;                                      /*@Z40GSBF*/ 07747000
@RC01756 DS    0H                                                  1781 07748000
@DE01755 L     @15,P                                               1781 07749000
         L     @14,LLFSTSLT(,@15)                                  1781 07750000
         LTR   @14,@14                                             1781 07751000
         BZ    @DL01755                                            1781 07752000
*                SLTOUSE = LLFSTSLT;                       /*@Z40GSBF*/ 07753000
*                                                                  1782 07754000
         ST    @14,SLTOUSE                                         1782 07755000
*                /*******************************************@Z40GSBF*/ 07756000
*                /*                                          @Z40GSBF*/ 07757000
*                /*  CALCULATE THE INDX VALUE FOR SLOT       @Z40GSBF*/ 07758000
*                /*  THAT WILL BE USED FOR THIS MODULE       @Z40GSBF*/ 07759000
*                /*                                          @Z40GSBF*/ 07760000
*                /*******************************************@Z40GSBF*/ 07761000
*                                                                  1783 07762000
*                INDX = ((SLTOUSE -P -(LENGTH(LLHDR)))  /          1783 07763000
*                (LENGTH(LLSLOT))) +1;                     /*@Z40GSBF*/ 07764000
*                                                                  1783 07765000
         SLR   @14,@15                                             1783 07766000
         SL    @14,@CF00175                                        1783 07767000
         SRDA  @14,32                                              1783 07768000
         D     @14,@CF00478                                        1783 07769000
         AL    @15,@CF00215                                        1783 07770000
         STH   @15,INDX                                            1783 07771000
*                LLFSTSLT = LLNXTSLT(INDX);                /*@Z40GSBF*/ 07772000
         L     @14,P                                               1784 07773000
         SLA   @15,4                                               1784 07774000
         ALR   @15,@14                                             1784 07775000
         AL    @15,@CF02460                                        1784 07776000
         ICM   @07,15,LLNXTSLT-8(@15)                              1784 07777000
         ST    @07,LLFSTSLT(,@14)                                  1784 07778000
*                                                          /*@Z40GSBF*/ 07779000
*                /****************************************************/ 07780000
*                /*                                          @Z40GSBF*/ 07781000
*                /*      LOAD THE MODULE                     @Z014804*/ 07782000
*                /*                                          @Z40GSBF*/ 07783000
*                /****************************************************/ 07784000
*                                                          /*@Z40GSBF*/ 07785000
*                RESPECIFY (REG0,REG1) RSTD;               /*@Z014804*/ 07786000
*                LOADNAME = CLNAMX;                        /*@Z014804*/ 07787000
         L     @15,@PC00004                                        1786 07788000
         MVC   LOADNAME(8),CLNAMX(@15)                             1786 07789000
*LLDA1:          GEN(LOAD  EPLOC=LOADNAME);                /*@Z014804*/ 07790000
LLDA1    LOAD  EPLOC=LOADNAME                                           07791000
*                LLNAME(INDX) = CLNAMX;                    /*@Z014804*/ 07792000
         L     @15,P                                               1788 07793000
         LH    @14,INDX                                            1788 07794000
         SLA   @14,4                                               1788 07795000
         ST    @14,@TF00001                                        1788 07796000
         ALR   @14,@15                                             1788 07797000
         AL    @14,@CF02460                                        1788 07798000
         L     @07,@PC00004                                        1788 07799000
         MVC   LLNAME-8(8,@14),CLNAMX(@07)                         1788 07800000
*                LLMODSZ(INDX) = REG1;                     /*@Z014804*/ 07801000
         LR    @14,@15                                             1789 07802000
         AL    @14,@TF00001                                        1789 07803000
         STCM  REG1,7,LLMODSZ-16(@14)                              1789 07804000
*                                                          /*@Z014804*/ 07805000
*                /*******************************************@Z014804*/ 07806000
*                /*                                          @Z014804*/ 07807000
*                /*     PUT MODULE ENTRY POINT               @Z014804*/ 07808000
*                /*     IN AMS LOAD LIST BLOCK               @Z014804*/ 07809000
*                /*                                          @Z014804*/ 07810000
*                /*******************************************@Z014804*/ 07811000
*                                                          /*@Z014804*/ 07812000
*                ENTPT = REG0;                             /*@Z014804*/ 07813000
         L     @14,@PC00004+4                                      1790 07814000
         ST    REG0,ENTPT(,@14)                                    1790 07815000
*                LLADDR(INDX) = ENTPT;                     /*@Z014804*/ 07816000
         L     @14,@PC00004+4                                      1791 07817000
         L     @14,ENTPT(,@14)                                     1791 07818000
         LR    @07,@15                                             1791 07819000
         AL    @07,@TF00001                                        1791 07820000
         STCM  @14,15,LLADDR-16(@07)                               1791 07821000
*                                                          /*@Z014804*/ 07822000
*                /*******************************************@Z014804*/ 07823000
*                /*                                          @Z014804*/ 07824000
*                /*  UP USE CTR.FOR MODULE                   @Z014804*/ 07825000
*                /*                                          @Z014804*/ 07826000
*                /*******************************************@Z014804*/ 07827000
*                                                          /*@Z014804*/ 07828000
*                LLUSECTR(INDX) = LLUSECTR(INDX)+1;        /*@Z014804*/ 07829000
         LA    @14,1                                               1792 07830000
         L     @07,@TF00001                                        1792 07831000
         SLR   @06,@06                                             1792 07832000
         IC    @06,LLUSECTR-16(@07,@15)                            1792 07833000
         ALR   @14,@06                                             1792 07834000
         L     @07,@TF00001                                        1792 07835000
         STC   @14,LLUSECTR-16(@07,@15)                            1792 07836000
*                RESPECIFY (REG0,REG1) UNRSTD;             /*@Z014804*/ 07837000
*            END;                                          /*@Z40GSBF*/ 07838000
*        RETURN;                                           /*@Z40GSBF*/ 07839000
@EL00004 DS    0H                                                  1795 07840000
@EF00004 DS    0H                                                  1795 07841000
@ER00004 LM    @14,@12,@SA00004                                    1795 07842000
         BR    @14                                                 1795 07843000
*        END FINDNAME;                                     /*@Z40GSBF*/ 07844000
         B     @EL00004                                            1796 07845000
*                                                          /*@Z40GSBF*/ 07846000
*                                                                  1797 07847000
*            /********************************************************/ 07848000
*            /********************************************************/ 07849000
*            /*                                              @Z40GSBF*/ 07850000
*            /*  PROCEDURE NAME - RELECORE                   @Z40GSBF*/ 07851000
*            /*                                              @Z40GSBF*/ 07852000
*            /*  FUNCTION                                    @Z40GSBF*/ 07853000
*            /*      THIS RTN WILL SEARCH AMS LOAD LIST,     @Z40GSBF*/ 07854000
*            /*      FREE MODULES NOT IN USE(USE CTR WILL BE @Z40GSBF*/ 07855000
*            /*      ZERO) THIS SHOULD FREE SOME CORE        @Z40GSBF*/ 07856000
*            /*                                              @Z40GSBF*/ 07857000
*            /*  INPUT - NONE                                @Z40GSBF*/ 07858000
*            /*                                              @Z40GSBF*/ 07859000
*            /*  OUTPUT - NONE                               @Z40GSBF*/ 07860000
*            /*                                              @Z40GSBF*/ 07861000
*            /********************************************************/ 07862000
*            /********************************************************/ 07863000
*                                                                  1797 07864000
*RELECORE: PROC;                                           /*@Z40GSBF*/ 07865000
*                                                                  1797 07866000
RELECORE STM   @14,@12,@SA00005                                    1797 07867000
*            OLDERID2 = NEWERID2;                                  1798 07868000
         L     @15,GDTTR2(,GDTPR)                                  1798 07869000
         MVC   @TS00001(95),NEWERID2(@15)                          1798 07870000
         MVC   OLDERID2(95,@15),@TS00001                           1798 07871000
*            NEWID2 = 'SAD3';                              /*@Z40GSBF*/ 07872000
         MVC   NEWID2(4,@15),@CC02439                              1799 07873000
*            IX = 0;                                       /*@Z40GSBF*/ 07874000
         SLR   @15,@15                                             1800 07875000
         ST    @15,IX                                              1800 07876000
*            CONTROL = OFF;                                /*@Z40GSBF*/ 07877000
*                                                                  1801 07878000
         NI    CONTROL,B'01111111'                                 1801 07879000
*RELDO:        DO WHILE CONTROL = OFF;                     /*@Z40GSBF*/ 07880000
RELDO    B     @DE01802                                            1802 07881000
@DL01802 DS    0H                                                  1803 07882000
*                IF IX = 0                                 /*@Z40GSBF*/ 07883000
*                  THEN                                    /*@Z40GSBF*/ 07884000
         L     @15,IX                                              1803 07885000
         LTR   @15,@15                                             1803 07886000
         BNZ   @RF01803                                            1803 07887000
*                                                          /*@Z40GSBF*/ 07888000
*                      /**********************************************/ 07889000
*                      /*                                    @Z40GSBF*/ 07890000
*                      /*   FIRST TIME USE POINTER IN        @Z40GSBF*/ 07891000
*                      /*   SYSTEM HIST AREA TO LOAD         @Z40GSBF*/ 07892000
*                      /*   LIST BLOCK                       @Z40GSBF*/ 07893000
*                      /*                                    @Z40GSBF*/ 07894000
*                      /**********************************************/ 07895000
*                                                                  1804 07896000
*                      P = LLBLKPTR;                       /*@Z40GSBF*/ 07897000
         L     @01,GDTSAH(,GDTPR)                                  1804 07898000
         L     @15,LLBLKPTR(,@01)                                  1804 07899000
         ST    @15,P                                               1804 07900000
*                  ELSE;                                   /*@Z40GSBF*/ 07901000
*                                                                  1805 07902000
@RF01803 DS    0H                                                  1806 07903000
*                /****************************************************/ 07904000
*                /*                                          @Z40GSBF*/ 07905000
*                /*   SEARCH EACH LOAD LIST                  @Z40GSBF*/ 07906000
*                /*   BLOCK.WHEN MODULE NAME IS              @Z40GSBF*/ 07907000
*                /*   IN SLOT AND USE CTR IS ZERO            @Z40GSBF*/ 07908000
*                /*   THEN DELETE MODULE FROM CORE           @Z40GSBF*/ 07909000
*                /*                                          @Z40GSBF*/ 07910000
*                /*   IF MODULE TO BE DELETED IS ONE OF THE          */ 07911000
*                /*   ACCESS METHOD SERVICES MODULES WHICH WILL      */ 07912000
*                /*   BE IN CONSTANT USE THEN DON'T DELETE IT.       */ 07913000
*                /*                                                  */ 07914000
*                /****************************************************/ 07915000
*                                                          /*@Z40GSBF*/ 07916000
*                  DO IX = 1 TO LLSLTCNT;                  /*@Z40GSBF*/ 07917000
         LA    @15,1                                               1806 07918000
         ST    @15,IX                                              1806 07919000
@DL01806 DS    0H                                                  1807 07920000
*                   IF LLNOMOD(IX) =0 |                    /*@OZ25869*/ 07921000
*                   LLUSECTR(IX) ^= 0 |                    /*@OZ25869*/ 07922000
*                   LLNAME(IX) = 'IDCRI01 ' |              /*@OZ25869*/ 07923000
*                   LLNAME(IX) = 'IDCRILT ' |              /*@OZ25869*/ 07924000
*                   LLNAME(IX) = 'IDCTSUV0' |              /*@OZ25869*/ 07925000
*                   LLNAME(IX) = 'IKJFF18 ' |              /*@OZ25869*/ 07926000
*                   LLNAME(IX) = 'IDCDB01 ' |              /*@OZ25869*/ 07927000
*                   LLNAME(IX) = 'IDCTSRI0' |              /*@OZ25869*/ 07928000
*                   LLNAME(IX) = 'IDCTSTP0' |              /*@OZ25869*/ 07929000
*                   LLNAME(IX) = 'IDCTSEX0' |              /*@OZ25869*/ 07930000
*                   LLNAME(IX) = 'IDCRIKT '                /*@OZ25869*/ 07931000
*                      THEN;                               /*@Z40GSBF*/ 07932000
         SLR   @14,@14                                             1807 07933000
         L     @07,P                                               1807 07934000
         SLA   @15,4                                               1807 07935000
         ST    @15,@TF00001                                        1807 07936000
         ALR   @15,@07                                             1807 07937000
         AL    @15,@CF02469                                        1807 07938000
         ICM   @06,15,LLNOMOD-12(@15)                              1807 07939000
         CR    @14,@06                                             1807 07940000
         BE    @RT01807                                            1807 07941000
         L     @06,@TF00001                                        1807 07942000
         SLR   @15,@15                                             1807 07943000
         IC    @15,LLUSECTR-16(@06,@07)                            1807 07944000
         CR    @14,@15                                             1807 07945000
         BNE   @RT01807                                            1807 07946000
         LR    @06,@07                                             1807 07947000
         AL    @06,@TF00001                                        1807 07948000
         AL    @06,@CF02460                                        1807 07949000
         CLC   LLNAME-8(8,@06),@CC02442                            1807 07950000
         BE    @RT01807                                            1807 07951000
         LR    @06,@07                                             1807 07952000
         AL    @06,@TF00001                                        1807 07953000
         AL    @06,@CF02460                                        1807 07954000
         CLC   LLNAME-8(8,@06),@CC02443                            1807 07955000
         BE    @RT01807                                            1807 07956000
         LR    @06,@07                                             1807 07957000
         AL    @06,@TF00001                                        1807 07958000
         AL    @06,@CF02460                                        1807 07959000
         CLC   LLNAME-8(8,@06),@CC02444                            1807 07960000
         BE    @RT01807                                            1807 07961000
         LR    @06,@07                                             1807 07962000
         AL    @06,@TF00001                                        1807 07963000
         AL    @06,@CF02460                                        1807 07964000
         CLC   LLNAME-8(8,@06),@CC02445                            1807 07965000
         BE    @RT01807                                            1807 07966000
         LR    @06,@07                                             1807 07967000
         AL    @06,@TF00001                                        1807 07968000
         AL    @06,@CF02460                                        1807 07969000
         CLC   LLNAME-8(8,@06),@CC02446                            1807 07970000
         BE    @RT01807                                            1807 07971000
         LR    @06,@07                                             1807 07972000
         AL    @06,@TF00001                                        1807 07973000
         AL    @06,@CF02460                                        1807 07974000
         CLC   LLNAME-8(8,@06),@CC02447                            1807 07975000
         BE    @RT01807                                            1807 07976000
         LR    @06,@07                                             1807 07977000
         AL    @06,@TF00001                                        1807 07978000
         AL    @06,@CF02460                                        1807 07979000
         CLC   LLNAME-8(8,@06),@CC02448                            1807 07980000
         BE    @RT01807                                            1807 07981000
         LR    @06,@07                                             1807 07982000
         AL    @06,@TF00001                                        1807 07983000
         AL    @06,@CF02460                                        1807 07984000
         CLC   LLNAME-8(8,@06),@CC02449                            1807 07985000
         BE    @RT01807                                            1807 07986000
         AL    @07,@TF00001                                        1807 07987000
         AL    @07,@CF02460                                        1807 07988000
         CLC   LLNAME-8(8,@07),@CC02450                            1807 07989000
         BE    @RT01807                                            1807 07990000
*                      ELSE                                /*@Z40GSBF*/ 07991000
*                        DO;                               /*@Z40GSBF*/ 07992000
*                          RFY REG0 RSTD;                  /*@Z40GSBF*/ 07993000
*                          REG0 =  ADDR(LLNAME(IX));       /*@Z40GSBF*/ 07994000
         L     @15,IX                                              1811 07995000
         SLA   @15,4                                               1811 07996000
         L     @01,P                                               1811 07997000
         AL    @01,@CF02460                                        1811 07998000
         LA    REG0,LLNAME-8(@15,@01)                              1811 07999000
*LDEL2:                    GEN(DELETE  EPLOC=(REG0));      /*@Z40GSBF*/ 08000000
LDEL2    DELETE  EPLOC=(REG0)                                           08001000
*                          RFY REG0 UNRSTD;                /*@Z40GSBF*/ 08002000
*                          LLNOMOD(IX) = 0;                /*@Z40GSBF*/ 08003000
         L     @15,P                                               1814 08004000
         L     @14,IX                                              1814 08005000
         SLA   @14,4                                               1814 08006000
         SLR   @07,@07                                             1814 08007000
         ST    @14,@TF00001                                        1814 08008000
         ALR   @14,@15                                             1814 08009000
         AL    @14,@CF02469                                        1814 08010000
         STCM  @07,15,LLNOMOD-12(@14)                              1814 08011000
*                          LLNXTSLT(IX) = LLFSTSLT;        /*@Z40GSBF*/ 08012000
         L     @14,LLFSTSLT(,@15)                                  1815 08013000
         LR    @01,@15                                             1815 08014000
         AL    @01,@TF00001                                        1815 08015000
         AL    @01,@CF02460                                        1815 08016000
         STCM  @14,15,LLNXTSLT-8(@01)                              1815 08017000
*                          LLFSTSLT = ADDR(LLNXTSLT(IX));  /*@Z40GSBF*/ 08018000
         L     @14,@TF00001                                        1816 08019000
         AL    @14,@CF02460                                        1816 08020000
         LA    @14,LLNXTSLT-8(@14,@15)                             1816 08021000
         ST    @14,LLFSTSLT(,@15)                                  1816 08022000
*                        END;                              /*@Z40GSBF*/ 08023000
*                  END;                                    /*@Z40GSBF*/ 08024000
@RT01807 LA    @15,1                                               1818 08025000
         AL    @15,IX                                              1818 08026000
         ST    @15,IX                                              1818 08027000
         C     @15,@CF00306                                        1818 08028000
         BNH   @DL01806                                            1818 08029000
*                IF LLNXTBLK = 0                           /*@Z40GSBF*/ 08030000
*                  THEN                                    /*@Z40GSBF*/ 08031000
         L     @01,P                                               1819 08032000
         L     @15,LLNXTBLK(,@01)                                  1819 08033000
         LTR   @15,@15                                             1819 08034000
         BNZ   @RF01819                                            1819 08035000
*                    CONTROL = ON;                         /*@Z40GSBF*/ 08036000
         OI    CONTROL,B'10000000'                                 1820 08037000
*                  ELSE                                    /*@Z40GSBF*/ 08038000
*                    P = LLNXTBLK;                         /*@Z40GSBF*/ 08039000
         B     @RC01819                                            1821 08040000
@RF01819 L     @01,P                                               1821 08041000
         L     @15,LLNXTBLK(,@01)                                  1821 08042000
         ST    @15,P                                               1821 08043000
*              END RELDO;                                  /*@Z40GSBF*/ 08044000
*                                                                  1822 08045000
@RC01819 DS    0H                                                  1822 08046000
@DE01802 TM    CONTROL,B'10000000'                                 1822 08047000
         BZ    @DL01802                                            1822 08048000
*            IF GDTDBG = NULLPTR                                   1823 08049000
*              THEN;                                               1823 08050000
         L     @15,GDTDBG(,GDTPR)                                  1823 08051000
         LTR   @15,@15                                             1823 08052000
         BZ    @RT01823                                            1823 08053000
*              ELSE                                                1825 08054000
*                CALL IDCDB010(GDTTBL,'SAD4');                     1825 08055000
         ST    GDTPR,@AL00001                                      1825 08056000
         LA    @15,@CC02453                                        1825 08057000
         ST    @15,@AL00001+4                                      1825 08058000
         MVI   @AL00001+4,X'80'                                    1825 08059000
         L     @15,GDTDBG(,GDTPR)                                  1825 08060000
         LA    @01,@AL00001                                        1825 08061000
         BALR  @14,@15                                             1825 08062000
*                                                          /*@Z40GSBF*/ 08063000
*            RETURN;                                       /*@Z40GSBF*/ 08064000
@EL00005 DS    0H                                                  1826 08065000
@EF00005 DS    0H                                                  1826 08066000
@ER00005 LM    @14,@12,@SA00005                                    1826 08067000
         BR    @14                                                 1826 08068000
*        END RELECORE;                                     /*@Z40GSBF*/ 08069000
         B     @EL00005                                            1827 08070000
@PB00005 DS    0H                                                  1828 08071000
*                                                          /*@Z40GSBF*/ 08072000
*        /************************************************************/ 08073000
*        /************************************************************/ 08074000
*        /*                                                  @YL026UK*/ 08075000
*        /* GENERATED DATA                                   @YL026UK*/ 08076000
*        /*                                                  @YL026UK*/ 08077000
*        /************************************************************/ 08078000
*        /************************************************************/ 08079000
*                                                                  1828 08080000
*        /************************************************************/ 08081000
*        /*                                                  @YL026UK*/ 08082000
*        /* LIST FORM OF GETMAIN MACRO--MOVED INTO A DYNAMIC AREA FOR*/ 08083000
*        /* USE                                              @YL026UK*/ 08084000
*        /*                                                  @YL026UK*/ 08085000
*        /************************************************************/ 08086000
*                                                                  1828 08087000
*        GENERATE DATA;                                    /*@YL026UK*/ 08088000
*                                                                  1828 08089000
*        /************************************************************/ 08090000
*        /*                                                  @Y30LSMK*/ 08091000
*        /* LIST FORM OF THE GETMAIN MACRO, SPECIFYING PAGE  @Y30LSMK*/ 08092000
*        /* BOUNDARY--MOVED INTO A DYNAMIC AREA FOR USE      @Y30LSMK*/ 08093000
*        /*                                                  @Y30LSMK*/ 08094000
*        /************************************************************/ 08095000
*                                                                  1829 08096000
*        GENERATE DATA;                                    /*@Y30LSMK*/ 08097000
*                                                                  1829 08098000
*        /************************************************************/ 08099000
*        /*                                                  @YL026UK*/ 08100000
*        /* FULL REGION (SNAP) DUMP DCB - THIS IS COPIED INTO A      */ 08101000
*        /* DYNAMIC AREA FOR USE                             @YL026UK*/ 08102000
*        /*                                                  @YL026UK*/ 08103000
*        /************************************************************/ 08104000
*                                                                  1830 08105000
*        GENERATE DATA;                                    /*@YL026UK*/ 08106000
*                                                                  1830 08107000
*        /************************************************************/ 08108000
*        /*                                                  @YL026UK*/ 08109000
*        /* LIST FORM OF OPEN MACRO--MOVED INTO A DYNAMIC AREA FOR   */ 08110000
*        /* USE WITH SNAP                                    @YL026UK*/ 08111000
*        /*                                                  @YL026UK*/ 08112000
*        /************************************************************/ 08113000
*                                                                  1831 08114000
*        GENERATE DATA;                                    /*@YL026UK*/ 08115000
*                                                                  1831 08116000
*        /************************************************************/ 08117000
*        /*                                                  @YL026UK*/ 08118000
*        /* LIST FORM OF SNAP MACRO--MOVED INTO A DYNAMIC AREA FOR   */ 08119000
*        /* USE                                              @YL026UK*/ 08120000
*        /*                                                  @YL026UK*/ 08121000
*        /************************************************************/ 08122000
*                                                                  1832 08123000
*        GENERATE DATA;                                    /*@YL026UK*/ 08124000
*                                                                  1832 08125000
*        /************************************************************/ 08126000
*        /*                                                  @YL026UK*/ 08127000
*        /* LIST FORM OF THE TSO PUTGET MACRO--MOVED INTO    @YL026UK*/ 08128000
*        /* A DYNAMIC AREA FOR USE WHERE:                    @YL026UK*/ 08129000
*        /* TERMPUT EDIT - TPUT EDIT REQUEST                 @YL026UK*/ 08130000
*        /* TERMPUT WAIT - CONTROL NOT RETURNED UNTIL        @YL026UK*/ 08131000
*        /*                OUTPUT LINE IS IN BUFFER          @YL026UK*/ 08132000
*        /* TERMPUT HOLD - PROCESSING CAN'T CONTINUE UNTIL   @YL026UK*/ 08133000
*        /*                OUTPUT LINE PUT TO TERMINAL       @YL026UK*/ 08134000
*        /* TERMPUT BREAKIN - OUTPUT HAS PRECEDENCE OVER     @YL026UK*/ 08135000
*        /*                   INPUT                          @YL026UK*/ 08136000
*        /* TERMGET EDIT - TGET EDIT REQUEST                 @YL026UK*/ 08137000
*        /* TERMGET WAIT - CONTROL RETURNED ONLY AFTER INPUT @YL026UK*/ 08138000
*        /*                MESSAGE RECIEVED                  @YL026UK*/ 08139000
*        /*                                                  @YL026UK*/ 08140000
*        /************************************************************/ 08141000
*                                                                  1833 08142000
*        GENERATE DATA;                                    /*@YL026UK*/ 08143000
*                                                                  1833 08144000
*        /************************************************************/ 08145000
*        /*                                                  @YL026UK*/ 08146000
*        /* DECLARATION ALLOWING MODULE IDCSA01 ACCESS TO THIS       */ 08147000
*        /* MODULE'S AUTOMATIC STORAGE SIZE VALUE            @YL026UK*/ 08148000
*        /*                                                  @YL026UK*/ 08149000
*        /************************************************************/ 08150000
*                                                                  1834 08151000
*        GENERATE DATA;                                    /*@YL026UK*/ 08152000
*        RESPECIFY (GDTPR) UNRSTD;                         /*@YL026UK*/ 08153000
* END IDCSA02                                                      1836 08154000
*                                                                  1836 08155000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 08156000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 08157000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 08158000
*/*%INCLUDE SYSLIB  (CVT     )                                        * 08159000
*/*%INCLUDE SYSLIB  (AMSDF09 )                                        * 08160000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                        * 08161000
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                        * 08162000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        * 08163000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 08164000
*;                                                                 1836 08165000
@EL00001 L     @13,4(,@13)                                         1836 08166000
@EF00001 L     @00,@SIZDATD                                        1836 08167000
         LR    @01,@11                                             1836 08168000
         FREEMAIN R,LV=(0),A=(1)                                        08169000
@ER00001 LM    @14,@12,12(@13)                                     1836 08170000
         BR    @14                                                 1836 08171000
@DATA    DS    0H                                                       08172000
@CH00033 DC    H'10'                                                    08173000
@SM02462 MVC   PGLINE(0),UPMSG(@01)                                     08174000
@SM02464 MVC   UNDSN(0,@01),DSNFLD                                      08175000
@SM02467 MVC   S99TUPAR(0,@15),UNTVAL-4(@04)                            08176000
@SM02470 MVC   S99TUPRM(0,@14),VOLVAL-4(@06)                            08177000
@SM02472 MVC   S99TUPAR(0,@15),VOLVAL-4(@07)                            08178000
@SM02475 MVC   ALLDDN(0,@15),S99TUPAR(@14)                              08179000
@SM02477 MVC   S99TUPAR(0,@15),UNTVAL(@14)                              08180000
@SM02482 MVC   LOCNAME(0),HEADER(@01)                                   08181000
@SC02488 CLC   DSCMPTRL(0,@15),TRAILER(@01)                             08182000
@SM02490 MVC   INITCHAR(0,@01),ALLINIT                                  08183000
@DATD    DSECT                                                          08184000
         DS    0F                                                       08185000
@SA00001 DS    18F                                                      08186000
@PC00001 DS    36F                                                      08187000
@SA00004 DS    15F                                                      08188000
@PC00004 DS    2F                                                       08189000
@SA00005 DS    15F                                                      08190000
@SA00002 DS    15F                                                      08191000
@PC00002 DS    3F                                                       08192000
@SA00003 DS    15F                                                      08193000
@AL00001 DS    5A                                                       08194000
@TF00001 DS    F                                                        08195000
IDCSA02  CSECT                                                          08196000
         DS    0F                                                       08197000
@CF00111 DC    F'0'                                                     08198000
@CF00215 DC    F'1'                                                     08199000
@CH00215 EQU   @CF00215+2                                               08200000
@CF00149 DC    F'2'                                                     08201000
@CH00149 EQU   @CF00149+2                                               08202000
@CF00158 DC    F'3'                                                     08203000
@CF00038 DC    F'4'                                                     08204000
@CH00038 EQU   @CF00038+2                                               08205000
@CF00175 DC    F'8'                                                     08206000
@CH00175 EQU   @CF00175+2                                               08207000
@CF00034 DC    F'12'                                                    08208000
@CH00034 EQU   @CF00034+2                                               08209000
@CF00478 DC    F'16'                                                    08210000
@CF00306 DC    F'24'                                                    08211000
@CF01269 DC    F'40'                                                    08212000
@CH01269 EQU   @CF01269+2                                               08213000
@CF01652 DC    F'44'                                                    08214000
@CH01652 EQU   @CF01652+2                                               08215000
@CF02303 DC    F'45'                                                    08216000
@CH02303 EQU   @CF02303+2                                               08217000
@CF01916 DC    F'72'                                                    08218000
@CF02316 DC    F'182'                                                   08219000
@CF01724 DC    F'255'                                                   08220000
@CF02454 DC    F'392'                                                   08221000
@CF02314 DC    F'1456'                                                  08222000
@CF02486 DC    F'-41'                                                   08223000
@CF02487 DC    F'-40'                                                   08224000
@CF02460 DC    F'-8'                                                    08225000
@CF02466 DC    F'-6'                                                    08226000
@CF02469 DC    F'-4'                                                    08227000
@CF02485 DC    XL4'0000FFFF'                                            08228000
@DATD    DSECT                                                          08229000
         DS    0D                                                       08230000
LISTPTR  DS    A                                                        08231000
LISTSCAN DS    A                                                        08232000
IOCSPTR  DS    A                                                        08233000
OPNPTR   DS    A                                                        08234000
DDSTRU   DS    A                                                        08235000
FSADDR   DS    A                                                        08236000
ERCNVADR DS    A                                                        08237000
DMPINDEX DS    A                                                        08238000
PARMPTR2 DS    A                                                        08239000
PARMPTR3 DS    A                                                        08240000
PARMPTR4 DS    A                                                        08241000
PARMPTR5 DS    A                                                        08242000
TEMPPTR  DS    A                                                        08243000
INITPTR  DS    A                                                        08244000
INITSIZE DS    F                                                        08245000
IX       DS    F                                                        08246000
P        DS    A                                                        08247000
S99RBPTR DS    AL4                                                      08248000
         ORG   S99RBPTR                                                 08249000
S99RBPND DS    BL1                                                      08250000
         ORG   S99RBPTR+4                                               08251000
S99TUFP  DS    A                                                        08252000
CLENTPT  DS    A                                                        08253000
SPIDPTR  DS    A                                                        08254000
PGCNTPTR DS    A                                                        08255000
SADCBACB DS    AL4                                                      08256000
         ORG   SADCBACB                                                 08257000
BLOCKFLG DS    BL1                                                      08258000
         ORG   SADCBACB+4                                               08259000
CPECB    DS    F                                                        08260000
UPTPTR   DS    A                                                        08261000
ECBLOCK  DS    F                                                        08262000
DDLISTPT DS    A                                                        08263000
DDLISTSZ DS    F                                                        08264000
TEXTVOLP DS    A                                                        08265000
TEXTVOLS DS    F                                                        08266000
CTGPLPTR DS    A                                                        08267000
POOLADDR DS    A                                                        08268000
COMPPTR  DS    A                                                        08269000
CTRLPTR  DS    A                                                        08270000
WNOENT   DS    F                                                        08271000
POOLSIZE DS    F                                                        08272000
LKENTPT  DS    A                                                        08273000
SLTOUSE  DS    A                                                        08274000
DELPARM  DS    F                                                        08275000
ERCNVPTR DS    A                                                        08276000
SETRC    DS    H                                                        08277000
TESTRC   DS    H                                                        08278000
NUMCMD   DS    H                                                        08279000
I        DS    H                                                        08280000
J        DS    H                                                        08281000
CATRC    DS    H                                                        08282000
UCIRRC   DS    H                                                        08283000
ACTION   DS    H                                                        08284000
MATCH    DS    H                                                        08285000
SEPER    DS    H                                                        08286000
NEXTQUAL DS    H                                                        08287000
CKENT    DS    H                                                        08288000
BYTECTR  DS    H                                                        08289000
TRLQUAL  DS    H                                                        08290000
TOTRAIL  DS    H                                                        08291000
LASTBYTE DS    H                                                        08292000
TRLLEN   DS    H                                                        08293000
CATRETNO DS    H                                                        08294000
INDX     DS    H                                                        08295000
LISTLN   DS    FL1                                                      08296000
UNTCOUNT DS    FL1                                                      08297000
         ORG   UNTCOUNT                                                 08298000
UNITCNT  DS    CL1                                                      08299000
         ORG   UNTCOUNT+1                                               08300000
VOLCOUNT DS    FL1                                                      08301000
         ORG   VOLCOUNT                                                 08302000
VOLUMCNT DS    CL1                                                      08303000
         ORG   VOLCOUNT+1                                               08304000
@TS00001 DS    CL95                                                     08305000
DOCNTRL  DS    BL1                                                      08306000
         DS    CL7                                                      08307000
TEMPEPN  DS    CL8                                                      08308000
GETLIST  DS    CL10                                                     08309000
         ORG   GETLIST                                                  08310000
GETSZ    DS    FL4                                                      08311000
GETPT    DS    AL4                                                      08312000
GETFLG   DS    CL2                                                      08313000
         ORG   GETFLG                                                   08314000
@NM00038 DS    CL1                                                      08315000
GETSP    DS    FL1                                                      08316000
         ORG   GETLIST+10                                               08317000
         DS    CL2                                                      08318000
MSGAREA  DS    CL20                                                     08319000
S99RB    DS    CL20                                                     08320000
         ORG   S99RB                                                    08321000
S99RBLN  DS    CL1                                                      08322000
S99VERB  DS    CL1                                                      08323000
S99FLAG1 DS    CL2                                                      08324000
         ORG   S99FLAG1                                                 08325000
S99FLG11 DS    CL1                                                      08326000
         ORG   S99FLG11                                                 08327000
S99ONCNV DS    BL1                                                      08328000
S99NOCNV EQU   S99FLG11+0                                               08329000
S99NOMNT EQU   S99FLG11+0                                               08330000
S99JBSYS EQU   S99FLG11+0                                               08331000
         ORG   S99FLAG1+1                                               08332000
S99FLG12 DS    CL1                                                      08333000
         ORG   S99RB+4                                                  08334000
S99RSC   DS    CL4                                                      08335000
         ORG   S99RSC                                                   08336000
S99ERROR DS    CL2                                                      08337000
S99INFO  DS    CL2                                                      08338000
         ORG   S99RB+8                                                  08339000
S99TXTPP DS    AL4                                                      08340000
S99RSV01 DS    FL4                                                      08341000
S99FLAG2 DS    CL4                                                      08342000
         ORG   S99FLAG2                                                 08343000
S99FLG21 DS    CL1                                                      08344000
         ORG   S99FLG21                                                 08345000
S99WTVOL DS    BL1                                                      08346000
S99WTDSN EQU   S99FLG21+0                                               08347000
S99NORES EQU   S99FLG21+0                                               08348000
S99WTUNT EQU   S99FLG21+0                                               08349000
S99OFFLN EQU   S99FLG21+0                                               08350000
S99TIONQ EQU   S99FLG21+0                                               08351000
S99CATLG EQU   S99FLG21+0                                               08352000
S99MOUNT EQU   S99FLG21+0                                               08353000
         ORG   S99FLAG2+1                                               08354000
S99FLG22 DS    CL1                                                      08355000
         ORG   S99FLG22                                                 08356000
S99UDEVT DS    BL1                                                      08357000
S99PCINT EQU   S99FLG22+0                                               08358000
         ORG   S99FLAG2+2                                               08359000
S99FLG23 DS    CL1                                                      08360000
S99FLG24 DS    CL1                                                      08361000
         ORG   S99RB+20                                                 08362000
TEXTDSN  DS    CL50                                                     08363000
         DS    CL2                                                      08364000
ERRORTAB DS    CL32                                                     08365000
TEXTDDN  DS    CL14                                                     08366000
TEXTPWD  DS    CL14                                                     08367000
TEXTSTS  DS    CL7                                                      08368000
         DS    CL1                                                      08369000
TEXTDSP  DS    CL7                                                      08370000
         DS    CL1                                                      08371000
TEXTORG  DS    CL8                                                      08372000
TEXTPERM DS    CL8                                                      08373000
TUPL     DS    CL32                                                     08374000
         ORG   TUPL                                                     08375000
TUDSN    DS    AL4                                                      08376000
TUDDN    DS    AL4                                                      08377000
TUPWD    DS    AL4                                                      08378000
TUSTS    DS    AL4                                                      08379000
TUDSP    DS    AL4                                                      08380000
TUORG    DS    AL4                                                      08381000
TUULP    DS    AL4                                                      08382000
TUVLP    DS    AL4                                                      08383000
         ORG   TUPL+32                                                  08384000
CONTROL  DS    BL1                                                      08385000
NAMEFND  DS    BL1                                                      08386000
         DS    CL2                                                      08387000
OPENLIST DS    CL4                                                      08388000
         ORG   OPENLIST                                                 08389000
OPENOPT  DS    CL1                                                      08390000
OPENADDR DS    AL3                                                      08391000
         ORG   OPENLIST+4                                               08392000
SNAPLIST DS    CL20                                                     08393000
         ORG   SNAPLIST                                                 08394000
SNAPIDEN DS    FL1                                                      08395000
SNAPOPT  DS    CL7                                                      08396000
SNAPPTR  DS    AL4                                                      08397000
SNAPTCB  DS    AL4                                                      08398000
SNAPLST  DS    AL4                                                      08399000
         ORG   SNAPLIST+20                                              08400000
DUMPDCB  DS    CL90                                                     08401000
         DS    CL2                                                      08402000
PGLB     DS    CL76                                                     08403000
         ORG   PGLB                                                     08404000
PGLNG    DS    FL2                                                      08405000
PGOFF    DS    FL2                                                      08406000
PGLINE   DS    CL72                                                     08407000
         ORG   PGLB+76                                                  08408000
PUTGETPB DS    CL16                                                     08409000
         ORG   PUTGETPB                                                 08410000
PGFLG1   DS    CL4                                                      08411000
PGOLD    DS    AL4                                                      08412000
PGFLG2   DS    CL4                                                      08413000
PGINBUF  DS    AL4                                                      08414000
         ORG   PUTGETPB+16                                              08415000
TSOIOPL  DS    CL16                                                     08416000
         ORG   TSOIOPL                                                  08417000
TSOUPT   DS    AL4                                                      08418000
TSOECT   DS    AL4                                                      08419000
TSOECB   DS    AL4                                                      08420000
TSOPGPB  DS    AL4                                                      08421000
         ORG   TSOIOPL+16                                               08422000
TSOOLD   DS    CL8                                                      08423000
         ORG   TSOOLD                                                   08424000
TSOSEGNO DS    FL4                                                      08425000
TSOSEGAD DS    AL4                                                      08426000
         ORG   TSOOLD+8                                                 08427000
DSNBUF   DS    CL46                                                     08428000
         ORG   DSNBUF                                                   08429000
DSNLEN   DS    FL2                                                      08430000
DSNFLD   DS    CL44                                                     08431000
         ORG   DSNBUF+46                                                08432000
         DS    CL2                                                      08433000
TSODFPB  DS    CL20                                                     08434000
         ORG   TSODFPB                                                  08435000
TSOENTRY DS    CL1                                                      08436000
TSOBUF   DS    AL3                                                      08437000
TSOCONT  DS    CL1                                                      08438000
TSOPROT  DS    AL3                                                      08439000
TSOLOC   DS    FL1                                                      08440000
TSODEQ   DS    AL3                                                      08441000
TSOCAT   DS    AL4                                                      08442000
TSOPSD   DS    AL4                                                      08443000
         ORG   TSODFPB+20                                               08444000
TSODFPL  DS    CL16                                                     08445000
         ORG   TSODFPL                                                  08446000
TSOUSE   DS    AL4                                                      08447000
TSOENV   DS    AL4                                                      08448000
TSOEVE   DS    AL4                                                      08449000
TSODEF   DS    AL4                                                      08450000
         ORG   TSODFPL+16                                               08451000
DSRERR   DS    CL4                                                      08452000
         ORG   DSRERR                                                   08453000
DSRRC    DS    FL2                                                      08454000
DSRLC    DS    FL2                                                      08455000
         ORG   DSRERR+4                                                 08456000
TEXTUNT  DS    CL14                                                     08457000
TEXTVOL  DS    CL12                                                     08458000
TEXTPER  DS    CL4                                                      08459000
TEXTPRI  DS    CL4                                                      08460000
TEXTUCNT DS    CL7                                                      08461000
         DS    CL1                                                      08462000
TEXTVCNT DS    CL7                                                      08463000
CATLIST  DS    CL28                                                     08464000
         DS    CL3                                                      08465000
NAMEAREA DS    CL45                                                     08466000
         ORG   NAMEAREA                                                 08467000
NAMELEN  DS    FL1                                                      08468000
LOCNAME  DS    CL44                                                     08469000
         ORG   NAMEAREA+45                                              08470000
ALLINIT  DS    CL256                                                    08471000
CHARIN   DS    CL1                                                      08472000
LOADNAME DS    CL8                                                      08473000
DEMSGT   DS    CL44                                                     08474000
IDCSA02  CSECT                                                          08475000
         DS    0F                                                       08476000
@SIZDATD DC    AL1(0)                                                   08477000
         DC    AL3(@ENDDATD-@DATD)                                      08478000
@CV01831 DC    V(IDCSA05)                                               08479000
         DS    0D                                                       08480000
@CC02078 DC    C'        '                                              08481000
@CC02442 DC    C'IDCRI01 '                                              08482000
@CC02443 DC    C'IDCRILT '                                              08483000
@CC02444 DC    C'IDCTSUV0'                                              08484000
@CC02445 DC    C'IKJFF18 '                                              08485000
@CC02446 DC    C'IDCDB01 '                                              08486000
@CC02447 DC    C'IDCTSRI0'                                              08487000
@CC02448 DC    C'IDCTSTP0'                                              08488000
@CC02449 DC    C'IDCTSEX0'                                              08489000
@CC02450 DC    C'IDCRIKT '                                              08490000
@CC02432 DC    C'IDCCD'                                                 08491000
@CC00167 DC    C'ZERO'                                                  08492000
@CC00169 DC    C'BLNK'                                                  08493000
@CC00171 DC    C'NSET'                                                  08494000
@CC01667 DC    C'SACL'                                                  08495000
@CC01686 DC    C'SALD'                                                  08496000
@CC01698 DC    C'SADE'                                                  08497000
@CC01725 DC    C'SAGS'                                                  08498000
@CC01745 DC    C'SAFS'                                                  08499000
@CC01776 DC    C'SAGP'                                                  08500000
@CC01805 DC    C'SAFP'                                                  08501000
@CC01832 DC    C'SATI'                                                  08502000
@CC01844 DC    C'SACA'                                                  08503000
@CC01845 DC    C'ZZCA'                                                  08504000
@CC01879 DC    C'SASN'                                                  08505000
@CC01938 DC    C'SAPT'                                                  08506000
@CC01975 DC    C'SAID'                                                  08507000
@CC02025 DC    C'SAQL'                                                  08508000
@CC02079 DC    C'SAAL'                                                  08509000
@CC02106 DC    C'ZZAL'                                                  08510000
@CC02153 DC    C'SADL'                                                  08511000
@CC02164 DC    C'ZZDL'                                                  08512000
@CC02177 DC    C'SACR'                                                  08513000
@CC02178 DC    C'ZZCR'                                                  08514000
@CC02399 DC    C'SALK'                                                  08515000
@CC02433 DC    C'SABB'                                                  08516000
@CC02439 DC    C'SAD3'                                                  08517000
@CC02453 DC    C'SAD4'                                                  08518000
@CC00159 DC    C'ALL'                                                   08519000
@CC01344 DC    C'UV0'                                                   08520000
@CC01346 DC    C'IO0'                                                   08521000
@CC01350 DC    C'RI1'                                                   08522000
@CC01746 EQU   @CC02078                                                 08523000
@CC01777 DC    C'PG'                                                    08524000
@CB01413 DC    X'0001'                                                  08525000
@CB01415 DC    X'0002'                                                  08526000
@CB01419 DC    X'0004'                                                  08527000
@CB01421 DC    X'0005'                                                  08528000
@CB01425 DC    X'0007'                                                  08529000
@CB01443 DC    X'0010'                                                  08530000
@CB01445 DC    X'0011'                                                  08531000
@CB01449 DC    X'0013'                                                  08532000
@CB01453 DC    X'0015'                                                  08533000
@CB01455 DC    X'0016'                                                  08534000
@CB01571 DC    X'0050'                                                  08535000
@CB01581 DC    X'0055'                                                  08536000
@CB01585 DC    X'0057'                                                  08537000
@CB02151 DC    X'0364'                                                  08538000
ALL      DC    CL3'ALL'                                                 08539000
FORMAT   DC    CL4'FORM'                                                08540000
HSECOND  DC    CL4'HSEC'                                                08541000
CLOCK    DC    CL4'KLOK'                                                08542000
SETZERO  DC    CL4'ZERO'                                                08543000
SETBLANK DC    CL4'BLNK'                                                08544000
NOSET    DC    CL4'NSET'                                                08545000
OVERRIDE DC    CL4'OVRD'                                                08546000
ACQUIRE  DC    CL8'ACQUIRE '                                            08547000
RELINQ   DC    CL8'RELINQ  '                                            08548000
MOUNT    DC    CL8'MOUNT   '                                            08549000
DEMOUNT  DC    CL8'DEMOUNT '                                            08550000
DEFINE   DC    CL8'DEFINE  '                                            08551000
MOVE     DC    CL8'MOVE    '                                            08552000
TRACEQ   DC    CL8'TRACEQ  '                                            08553000
COPYTABL DC    CL8'COPYTABL'                                            08554000
COPYCRTG DC    CL8'COPYCRTG'                                            08555000
COPYVOL  DC    CL8'COPYVOL '                                            08556000
VVIC     DC    CL8'VVIC    '                                            08557000
TUNE     DC    CL8'TUNE    '                                            08558000
NAMES    DC    CL4'NAME'                                                08559000
UNIT     DC    CL4'UNIT'                                                08560000
SHR      DC    CL4'SHR '                                                08561000
EXCL     DC    CL4'EXCL'                                                08562000
NOWAIT   DC    CL4'NWAI'                                                08563000
WAIT     DC    CL4'WAIT'                                                08564000
FIXAREA  DS    CL800                                                    08565000
         ORG   FIXAREA                                                  08566000
@NM00034 DC    800X'00'                                                 08567000
         ORG   FIXAREA+800                                              08568000
MODID    DC    CL4'SA02'                                                08569000
SETB     DC    CL1' '                                                   08570000
SET0     DC    X'00'                                                    08571000
@DATD    DSECT                                                          08572000
IDCSA02 CSECT                                                           08573000
LIST1   GETMAIN EC,LV=8,A=LIST1,MF=L                                    08574000
@DATD    DSECT                                                          08575000
IDCSA02 CSECT                                                           08576000
LIST2   GETMAIN EC,LV=8,A=LIST2,BNDRY=PAGE,MF=L                         08577000
@DATD    DSECT                                                          08578000
IDCSA02 CSECT                                                           08579000
SNAPDCB  DCB   DSORG=PS,RECFM=VBA,MACRF=(W),BLKSIZE=1632,LRECL=125,   XX08580000
               DDNAME=AMSDUMP                                           08581000
@DATD    DSECT                                                          08582000
IDCSA02 CSECT                                                           08583000
LIST3    OPEN  (SNAPDCB,(OUTPUT)),MF=L                                  08584000
@DATD    DSECT                                                          08585000
IDCSA02 CSECT                                                           08586000
LIST4    SNAP  DCB=SNAPDCB,SDATA=(CB,Q),PDATA=(ALL),ID=(00),MF=L        08587000
@DATD    DSECT                                                          08588000
IDCSA02 CSECT                                                           08589000
LIST5    PUTGET TERMPUT=(EDIT,WAIT),                                  XX08590000
               TERMGET=(EDIT,WAIT),MF=L                       @ZA00133  08591000
@DATD    DSECT                                                          08592000
IDCSA02 CSECT                                                           08593000
IDCSAS2 DC    A(@SIZDATD)                                               08594000
        ENTRY IDCSAS2                                                   08595000
@DATD    DSECT                                                          08596000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                08597000
@ENDDATD EQU   *                                                        08598000
IDCSA02  CSECT                                                          08599000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       08600000
@01      EQU   01                                                       08601000
@02      EQU   02                                                       08602000
@03      EQU   03                                                       08603000
@04      EQU   04                                                       08604000
@05      EQU   05                                                       08605000
@06      EQU   06                                                       08606000
@07      EQU   07                                                       08607000
@08      EQU   08                                                       08608000
@09      EQU   09                                                       08609000
@10      EQU   10                                                       08610000
@11      EQU   11                                                       08611000
@12      EQU   12                                                       08612000
@13      EQU   13                                                       08613000
@14      EQU   14                                                       08614000
@15      EQU   15                                                       08615000
RTNREG   EQU   @15                                                      08616000
REG0     EQU   @00                                                      08617000
REG1     EQU   @01                                                      08618000
REG2     EQU   @02                                                      08619000
REG3     EQU   @03                                                      08620000
REG4     EQU   @04                                                      08621000
REG5     EQU   @05                                                      08622000
REG7     EQU   @07                                                      08623000
REG11    EQU   @11                                                      08624000
REG13    EQU   @13                                                      08625000
REG14    EQU   @14                                                      08626000
REG15    EQU   @15                                                      08627000
GPR01P   EQU   @01                                                      08628000
GDTPR    EQU   @08                                                      08629000
REG1PTR  EQU   @01                                                      08630000
GPR00F   EQU   @00                                                      08631000
GPR00P   EQU   @00                                                      08632000
GPR01F   EQU   @01                                                      08633000
GPR14F   EQU   @14                                                      08634000
GPR14P   EQU   @14                                                      08635000
GPR15F   EQU   @15                                                      08636000
GPR15P   EQU   @15                                                      08637000
REG10    EQU   @10                                                      08638000
REG12    EQU   @12                                                      08639000
REG6     EQU   @06                                                      08640000
REG8     EQU   @08                                                      08641000
REG9     EQU   @09                                                      08642000
CVTPTR   EQU   16                                                       08643000
GDTTBL   EQU   0                                                        08644000
GDTTR1   EQU   GDTTBL+8                                                 08645000
GDTTR2   EQU   GDTTBL+12                                                08646000
GDTSAH   EQU   GDTTBL+32                                                08647000
GDTDBG   EQU   GDTTBL+40                                                08648000
GDTSTC   EQU   GDTTBL+44                                                08649000
GDTPRT   EQU   GDTTBL+48                                                08650000
GDTESS   EQU   GDTTBL+52                                                08651000
GDTESA   EQU   GDTTBL+56                                                08652000
GDTRST   EQU   GDTTBL+60                                                08653000
GDTRES   EQU   GDTTBL+64                                                08654000
GDTCAL   EQU   GDTTBL+68                                                08655000
GDTGSP   EQU   GDTTBL+72                                                08656000
GDTFSP   EQU   GDTTBL+76                                                08657000
GDTGPL   EQU   GDTTBL+80                                                08658000
GDTFPL   EQU   GDTTBL+84                                                08659000
GDTLOD   EQU   GDTTBL+88                                                08660000
GDTDEL   EQU   GDTTBL+92                                                08661000
GDTPRL   EQU   GDTTBL+96                                                08662000
GDTEPL   EQU   GDTTBL+100                                               08663000
GDTTIM   EQU   GDTTBL+104                                               08664000
GDTIIO   EQU   GDTTBL+108                                               08665000
GDTTIO   EQU   GDTTBL+112                                               08666000
GDTOPN   EQU   GDTTBL+124                                               08667000
GDTCLS   EQU   GDTTBL+128                                               08668000
GDTGET   EQU   GDTTBL+132                                               08669000
GDTPUT   EQU   GDTTBL+136                                               08670000
GDTPOS   EQU   GDTTBL+140                                               08671000
GDTCPY   EQU   GDTTBL+144                                               08672000
GDTCAT   EQU   GDTTBL+148                                               08673000
GDTABT   EQU   GDTTBL+152                                               08674000
GDTABH   EQU   GDTTBL+156                                               08675000
GDTSNP   EQU   GDTTBL+164                                               08676000
GDTVFY   EQU   GDTTBL+172                                               08677000
GDTUPT   EQU   GDTTBL+180                                               08678000
GDTPSB   EQU   GDTTBL+184                                               08679000
GDTECT   EQU   GDTTBL+188                                               08680000
GDTUID   EQU   GDTTBL+192                                               08681000
GDTPMT   EQU   GDTTBL+196                                               08682000
GDTCIR   EQU   GDTTBL+200                                               08683000
GDTLNK   EQU   GDTTBL+204                                               08684000
GDTALC   EQU   GDTTBL+208                                               08685000
GDTDLC   EQU   GDTTBL+212                                               08686000
GDTQAL   EQU   GDTTBL+216                                               08687000
GDTSTW   EQU   GDTTBL+220                                               08688000
GDTSSC   EQU   GDTTBL+224                                               08689000
GDTENQ   EQU   GDTTBL+228                                               08690000
GDTRSV   EQU   GDTTBL+232                                               08691000
GDTDEQ   EQU   GDTTBL+236                                               08692000
GDTSFO   EQU   GDTTBL+240                                               08693000
GDTWTO   EQU   GDTTBL+244                                               08694000
GDTSCR   EQU   GDTTBL+248                                               08695000
GDTUNT   EQU   GDTTBL+252                                               08696000
GDTRCT   EQU   GDTTBL+256                                               08697000
GDTIFO   EQU   GDTTBL+260                                               08698000
GDTEXP   EQU   GDTTBL+264                                               08699000
GDTSTA   EQU   GDTTBL+268                                               08700000
GDTERR   EQU   GDTTBL+272                                               08701000
GDTUNC   EQU   GDTTBL+276                                               08702000
GDTLOC   EQU   GDTTBL+280                                               08703000
IDCSAEP0 EQU   0                                                        08704000
IDCSAGS0 EQU   0                                                        08705000
IDCSAFS0 EQU   0                                                        08706000
IDCSAGP0 EQU   0                                                        08707000
IDCSAFP0 EQU   0                                                        08708000
IDCSACA0 EQU   0                                                        08709000
TRACE1   EQU   0                                                        08710000
OLDERID1 EQU   TRACE1                                                   08711000
TRACE2   EQU   0                                                        08712000
OLDERID2 EQU   TRACE2                                                   08713000
NEWID2   EQU   TRACE2+95                                                08714000
NEWERID2 EQU   5                                                        08715000
LISTTEST EQU   0                                                        08716000
CIRAGL   EQU   0                                                        08717000
CIRTYPE  EQU   CIRAGL                                                   08718000
CIRTYP1Q EQU   CIRTYPE                                                  08719000
CIRTYPAQ EQU   CIRTYPE                                                  08720000
CIRHLN   EQU   CIRAGL+4                                                 08721000
CIRTLN   EQU   CIRAGL+6                                                 08722000
CIRHDR   EQU   CIRAGL+8                                                 08723000
CIRTLR   EQU   CIRAGL+12                                                08724000
CIRWKP   EQU   CIRAGL+16                                                08725000
CIRCAT   EQU   CIRAGL+20                                                08726000
CIRPWD   EQU   CIRAGL+24                                                08727000
CIRPID   EQU   CIRAGL+28                                                08728000
ALLAGL   EQU   0                                                        08729000
ALLDSN   EQU   ALLAGL                                                   08730000
ALLDDN   EQU   ALLAGL+4                                                 08731000
ALLULP   EQU   ALLAGL+12                                                08732000
ALLVLP   EQU   ALLAGL+16                                                08733000
ALLPWD   EQU   ALLAGL+20                                                08734000
ALLSTS   EQU   ALLAGL+24                                                08735000
ALLDSP   EQU   ALLAGL+25                                                08736000
ALLORG   EQU   ALLAGL+26                                                08737000
ALLOPT   EQU   ALLAGL+28                                                08738000
ALLOPTVL EQU   ALLOPT                                                   08739000
ALLOPTDS EQU   ALLOPT                                                   08740000
ALLOPTPV EQU   ALLOPT                                                   08741000
ALLOPTUN EQU   ALLOPT                                                   08742000
ALLVLCNT EQU   ALLAGL+29                                                08743000
ALLUNCNT EQU   ALLAGL+30                                                08744000
UNITABL  EQU   0                                                        08745000
UNITADR  EQU   UNITABL+4                                                08746000
@NM00010 EQU   UNITADR                                                  08747000
UNITSTAT EQU   UNITABL+6                                                08748000
IOCSTR   EQU   0                                                        08749000
IOCDSO   EQU   IOCSTR+16                                                08750000
IOCRFM   EQU   IOCSTR+17                                                08751000
IOCMAC   EQU   IOCSTR+18                                                08752000
IOCMAC2  EQU   IOCSTR+19                                                08753000
IOCCHP   EQU   IOCSTR+20                                                08754000
IOCMSG   EQU   IOCSTR+21                                                08755000
IOCRBA   EQU   IOCSTR+40                                                08756000
IOCTTR   EQU   IOCRBA                                                   08757000
IOCMEM   EQU   IOCSTR+44                                                08758000
IOCNWM   EQU   IOCSTR+48                                                08759000
IOCREL   EQU   IOCSTR+60                                                08760000
OPNAGL   EQU   0                                                        08761000
OPNOPT   EQU   OPNAGL                                                   08762000
OPNRFM   EQU   OPNAGL+1                                                 08763000
OPNTYP   EQU   OPNAGL+2                                                 08764000
OPNMOD   EQU   OPNAGL+3                                                 08765000
OPNDEV   EQU   OPNAGL+24                                                08766000
OPNDSO   EQU   OPNAGL+41                                                08767000
OPNOPT2  EQU   OPNAGL+42                                                08768000
IOINFOPT EQU   0                                                        08769000
UVOLLIST EQU   0                                                        08770000
UVOLENT  EQU   UVOLLIST+2                                               08771000
AMSTP011 EQU   0                                                        08772000
IDCTPER0 EQU   0                                                        08773000
DARGLIST EQU   0                                                        08774000
DARGDBP  EQU   DARGLIST                                                 08775000
DARGSTID EQU   DARGLIST+8                                               08776000
DARGSMOD EQU   DARGSTID                                                 08777000
DARGSENT EQU   DARGSTID+3                                               08778000
DARGILP  EQU   DARGLIST+12                                              08779000
DARGFLGS EQU   DARGLIST+19                                              08780000
DARGARY  EQU   DARGLIST+20                                              08781000
DARGINS  EQU   DARGARY                                                  08782000
DARGINL  EQU   DARGARY+2                                                08783000
FMTLIST  EQU   0                                                        08784000
FMTFLGS  EQU   FMTLIST                                                  08785000
FMTSPF   EQU   FMTLIST+2                                                08786000
FMTRFNO  EQU   FMTSPF                                                   08787000
FMTILEN  EQU   FMTRFNO                                                  08788000
FMTIOFF  EQU   FMTLIST+4                                                08789000
FMTTRBC  EQU   FMTIOFF                                                  08790000
FMTSTO   EQU   FMTTRBC                                                  08791000
FMTOCOL  EQU   FMTLIST+6                                                08792000
FMTCNVF  EQU   FMTLIST+10                                               08793000
ERCNVTAB EQU   0                                                        08794000
ERTYPE   EQU   ERCNVTAB                                                 08795000
ERCATLG  EQU   ERTYPE                                                   08796000
ERDYNAL  EQU   ERTYPE                                                   08797000
EROPER   EQU   ERCNVTAB+1                                               08798000
ERCATLC  EQU   EROPER                                                   08799000
EROSOPER EQU   ERCNVTAB+2                                               08800000
ERDSNM   EQU   ERCNVTAB+12                                              08801000
ERCATRC  EQU   ERCNVTAB+16                                              08802000
ERDYNRC  EQU   ERCATRC                                                  08803000
ERCPLPT  EQU   ERCNVTAB+20                                              08804000
ERDARBPT EQU   ERCPLPT                                                  08805000
IDCDB010 EQU   0                                                        08806000
DMPITM   EQU   0                                                        08807000
DMPARY   EQU   0                                                        08808000
CVTMAP   EQU   0                                                        08809000
CVTDAR   EQU   CVTMAP+72                                                08810000
CVTFLGS1 EQU   CVTDAR                                                   08811000
CVTDCB   EQU   CVTMAP+116                                               08812000
CVTIOQET EQU   CVTMAP+120                                               08813000
CVTIERLC EQU   CVTMAP+144                                               08814000
CVTHEAD  EQU   CVTMAP+160                                               08815000
CVTSV76C EQU   CVTHEAD                                                  08816000
CVTOPTA  EQU   CVTMAP+182                                               08817000
CVTOPTB  EQU   CVTMAP+183                                               08818000
CVTGTF   EQU   CVTMAP+236                                               08819000
CVTGTFST EQU   CVTGTF                                                   08820000
CVTGTFS  EQU   CVTGTFST                                                 08821000
CVTSTATE EQU   CVTGTFST                                                 08822000
CVTTMODE EQU   CVTGTFST                                                 08823000
CVTFORM  EQU   CVTGTFST                                                 08824000
CVTAQAVT EQU   CVTMAP+240                                               08825000
CVTTCMFG EQU   CVTAQAVT                                                 08826000
CVTVOLM2 EQU   CVTMAP+244                                               08827000
CVTTATA  EQU   CVTVOLM2                                                 08828000
CVTTSKS  EQU   CVTTATA                                                  08829000
CVTVOLF2 EQU   CVTTSKS                                                  08830000
CVTTAT   EQU   CVTTATA+1                                                08831000
CVTATER  EQU   CVTMAP+248                                               08832000
CVTEXT1  EQU   CVTMAP+252                                               08833000
CVTPURG  EQU   CVTMAP+260                                               08834000
CVTQMSG  EQU   CVTMAP+268                                               08835000
CVTDMSR  EQU   CVTMAP+272                                               08836000
CVTRSV37 EQU   CVTDMSR                                                  08837000
CVTDMSRF EQU   CVTRSV37                                                 08838000
CVTERPV  EQU   CVTMAP+316                                               08839000
CVTINTLA EQU   CVTMAP+320                                               08840000
CVTAPF   EQU   CVTMAP+324                                               08841000
CVTEXT2  EQU   CVTMAP+328                                               08842000
CVTHJES  EQU   CVTMAP+332                                               08843000
CVTPGSIA EQU   CVTMAP+348                                               08844000
CVTA1F1  EQU   CVTMAP+356                                               08845000
CVTSYSK  EQU   CVTMAP+357                                               08846000
CVTVOLM1 EQU   CVTMAP+380                                               08847000
CVTVOLF1 EQU   CVTVOLM1                                                 08848000
CVTATMCT EQU   CVTMAP+388                                               08849000
CVTXTNT1 EQU   0                                                        08850000
CVTXTNT2 EQU   0                                                        08851000
CVTDSSV  EQU   CVTXTNT2                                                 08852000
CVTFLGBT EQU   CVTXTNT2+5                                               08853000
CVTQID   EQU   CVTXTNT2+24                                              08854000
CVTRV400 EQU   CVTXTNT2+52                                              08855000
CVTRV409 EQU   CVTXTNT2+53                                              08856000
CVTATCVT EQU   CVTXTNT2+64                                              08857000
CVTRV429 EQU   CVTXTNT2+84                                              08858000
CVTRV438 EQU   CVTXTNT2+85                                              08859000
CVTRV457 EQU   CVTXTNT2+112                                             08860000
CVTRV466 EQU   CVTXTNT2+113                                             08861000
CVTFIX   EQU   0                                                        08862000
CVTRELNO EQU   CVTFIX+252                                               08863000
ADDR1    EQU   0                                                        08864000
ADDR2    EQU   0                                                        08865000
ADDR3    EQU   0                                                        08866000
ADDR4    EQU   0                                                        08867000
ADDR5    EQU   0                                                        08868000
FREEID   EQU   0                                                        08869000
LLBLK    EQU   0                                                        08870000
LLHDR    EQU   LLBLK                                                    08871000
LLFSTSLT EQU   LLHDR                                                    08872000
LLNXTBLK EQU   LLHDR+4                                                  08873000
LLSLOT   EQU   LLBLK+8                                                  08874000
LLNAME   EQU   LLSLOT                                                   08875000
LLNXTSLT EQU   LLNAME                                                   08876000
LLNOMOD  EQU   LLNAME+4                                                 08877000
LLADDR   EQU   LLSLOT+8                                                 08878000
LLUSECTR EQU   LLSLOT+12                                                08879000
LLMODSZ  EQU   LLSLOT+13                                                08880000
SAHIST   EQU   0                                                        08881000
GPFIRST  EQU   SAHIST                                                   08882000
GPLAST   EQU   SAHIST+4                                                 08883000
AUTOPTR  EQU   SAHIST+8                                                 08884000
LLBLKPTR EQU   SAHIST+16                                                08885000
AUTOTBL  EQU   0                                                        08886000
AUTOARAY EQU   AUTOTBL                                                  08887000
STATUS   EQU   AUTOARAY+4                                               08888000
@NM00035 EQU   0                                                        08889000
AUTOSIZE EQU   @NM00035                                                 08890000
GSCNTRL  EQU   0                                                        08891000
GSLEN    EQU   GSCNTRL                                                  08892000
GSLENID  EQU   GSLEN                                                    08893000
GSID     EQU   GSCNTRL+4                                                08894000
GSSUBPID EQU   GSID+3                                                   08895000
GPCNTRL  EQU   0                                                        08896000
GPFORWRD EQU   GPCNTRL                                                  08897000
GPBACK   EQU   GPCNTRL+4                                                08898000
GPLEN    EQU   GPCNTRL+8                                                08899000
GPID     EQU   GPCNTRL+12                                               08900000
GPADRPG  EQU   GPCNTRL+16                                               08901000
GPLENPG  EQU   GPCNTRL+20                                               08902000
PRECNTRL EQU   0                                                        08903000
PREFWD   EQU   PRECNTRL                                                 08904000
PASCNTRL EQU   0                                                        08905000
PASBACK  EQU   PASCNTRL+4                                               08906000
S99TUPL  EQU   0                                                        08907000
S99TUPTR EQU   S99TUPL                                                  08908000
S99TUPLN EQU   S99TUPTR                                                 08909000
S99TUP   EQU   0                                                        08910000
S99TUNIT EQU   0                                                        08911000
S99TUKEY EQU   S99TUNIT                                                 08912000
S99TUNUM EQU   S99TUNIT+2                                               08913000
S99TUENT EQU   S99TUNIT+4                                               08914000
S99TULNG EQU   S99TUENT                                                 08915000
S99TUPAR EQU   S99TUENT+2                                               08916000
S99TUFLD EQU   0                                                        08917000
S99TULEN EQU   S99TUFLD                                                 08918000
S99TUPRM EQU   S99TUFLD+2                                               08919000
AGLDSN   EQU   0                                                        08920000
AGLPWD   EQU   0                                                        08921000
CLNAME   EQU   0                                                        08922000
LDMOD    EQU   0                                                        08923000
LDPOINT  EQU   0                                                        08924000
DEMOD    EQU   0                                                        08925000
GSSIZE   EQU   0                                                        08926000
GSPOINT  EQU   0                                                        08927000
GSINIT   EQU   0                                                        08928000
GSSPID   EQU   0                                                        08929000
FSPOINT  EQU   0                                                        08930000
GPSIZE   EQU   0                                                        08931000
GPPOINT  EQU   0                                                        08932000
GPIDVAR  EQU   0                                                        08933000
GPINIT   EQU   0                                                        08934000
GPFCHAIN EQU   0                                                        08935000
FPIDVAR  EQU   0                                                        08936000
FPALL    EQU   0                                                        08937000
TIDATE   EQU   0                                                        08938000
TITIME   EQU   0                                                        08939000
TIFORM   EQU   0                                                        08940000
CPLPTR   EQU   0                                                        08941000
SNAPID   EQU   0                                                        08942000
PTTEXTP  EQU   0                                                        08943000
PTTEXTL  EQU   0                                                        08944000
PTREPLP  EQU   0                                                        08945000
PTREPLL  EQU   0                                                        08946000
UPMSG    EQU   0                                                        08947000
INBUFLN  EQU   0                                                        08948000
USERID   EQU   0                                                        08949000
USERIDL  EQU   0                                                        08950000
UPT      EQU   0                                                        08951000
UPTSWS   EQU   UPT+12                                                   08952000
UPTPREFX EQU   UPT+16                                                   08953000
UPTPREFL EQU   UPT+23                                                   08954000
DSNS     EQU   0                                                        08955000
DSNP     EQU   0                                                        08956000
CATNP    EQU   0                                                        08957000
PWDP     EQU   0                                                        08958000
UNDSN    EQU   0                                                        08959000
AGLVOL   EQU   0                                                        08960000
VOLCNT   EQU   AGLVOL                                                   08961000
@NM00041 EQU   AGLVOL+2                                                 08962000
VOLLEN   EQU   @NM00041                                                 08963000
VOLVAL   EQU   @NM00041+2                                               08964000
AGLUNT   EQU   0                                                        08965000
UNTCNT   EQU   AGLUNT                                                   08966000
@NM00042 EQU   AGLUNT+2                                                 08967000
UNTLEN   EQU   @NM00042                                                 08968000
UNTVAL   EQU   @NM00042+2                                               08969000
TEXTCON  EQU   0                                                        08970000
CONKEY   EQU   TEXTCON                                                  08971000
CONNUM   EQU   TEXTCON+2                                                08972000
CONENT   EQU   TEXTCON+4                                                08973000
CONLN    EQU   CONENT                                                   08974000
CONDDN   EQU   CONENT+2                                                 08975000
CTGPL    EQU   0                                                        08976000
CTGOPTN1 EQU   CTGPL                                                    08977000
CTGNAME  EQU   CTGOPTN1                                                 08978000
CTGCNAME EQU   CTGOPTN1                                                 08979000
CTGGENLD EQU   CTGOPTN1                                                 08980000
CTGOPTN2 EQU   CTGPL+1                                                  08981000
CTGEXT   EQU   CTGOPTN2                                                 08982000
CTGERASE EQU   CTGOPTN2                                                 08983000
CTGSMF   EQU   CTGERASE                                                 08984000
CTGREL   EQU   CTGSMF                                                   08985000
CTGPURG  EQU   CTGOPTN2                                                 08986000
CTGVMNT  EQU   CTGPURG                                                  08987000
CTGRCATN EQU   CTGVMNT                                                  08988000
CTGOPTN3 EQU   CTGPL+2                                                  08989000
CTGSUPLT EQU   CTGOPTN3                                                 08990000
CTGAM0   EQU   CTGOPTN3                                                 08991000
CTGOPTN4 EQU   CTGPL+3                                                  08992000
CTGENT   EQU   CTGPL+4                                                  08993000
CTGCAT   EQU   CTGPL+8                                                  08994000
CTGWKA   EQU   CTGPL+12                                                 08995000
CTGDSORG EQU   CTGPL+16                                                 08996000
CTGDDNM  EQU   CTGPL+20                                                 08997000
CTGNEWNM EQU   CTGDDNM                                                  08998000
CTGFBFLG EQU   CTGNEWNM+2                                               08999000
CTGJSCB  EQU   CTGPL+24                                                 09000000
CTGPSWD  EQU   CTGJSCB                                                  09001000
WORKAREA EQU   0                                                        09002000
WORKNUM  EQU   WORKAREA                                                 09003000
WORKLEN  EQU   WORKNUM                                                  09004000
WORKRET  EQU   WORKNUM+2                                                09005000
WORKENT  EQU   WORKAREA+4                                               09006000
ENTTYPE  EQU   WORKENT                                                  09007000
DSNAME   EQU   WORKENT+1                                                09008000
COMPNAME EQU   0                                                        09009000
DSCMPTRL EQU   0                                                        09010000
RETPOOL  EQU   0                                                        09011000
HEADER   EQU   0                                                        09012000
TRAILER  EQU   0                                                        09013000
LKNAME   EQU   0                                                        09014000
LINKARG  EQU   0                                                        09015000
INITCHAR EQU   0                                                        09016000
AMSTP041 EQU   0                                                        09017000
AMSTP042 EQU   0                                                        09018000
AMSTP043 EQU   0                                                        09019000
AMSTP044 EQU   0                                                        09020000
DMPTRM   EQU   0                                                        09021000
IDCIOCL0 EQU   0                                                        09022000
IDCIOCO0 EQU   0                                                        09023000
IDCIOGT0 EQU   0                                                        09024000
IDCIOIT0 EQU   0                                                        09025000
IDCIOOP0 EQU   0                                                        09026000
IDCIOPO0 EQU   0                                                        09027000
IDCIOPT0 EQU   0                                                        09028000
IDCIOSI0 EQU   0                                                        09029000
IDCIOST0 EQU   0                                                        09030000
IDCIOTM0 EQU   0                                                        09031000
IDCIOVY0 EQU   0                                                        09032000
IDCIO050 EQU   0                                                        09033000
IDCSAAL0 EQU   0                                                        09034000
IDCSACL0 EQU   0                                                        09035000
IDCSACR0 EQU   0                                                        09036000
IDCSADE0 EQU   0                                                        09037000
IDCSADL0 EQU   0                                                        09038000
IDCSADQ0 EQU   0                                                        09039000
IDCSAID0 EQU   0                                                        09040000
IDCSALC0 EQU   0                                                        09041000
IDCSALD0 EQU   0                                                        09042000
IDCSALK0 EQU   0                                                        09043000
IDCSANQ0 EQU   0                                                        09044000
IDCSAPR0 EQU   0                                                        09045000
IDCSAPT0 EQU   0                                                        09046000
IDCSAQL0 EQU   0                                                        09047000
IDCSARC0 EQU   0                                                        09048000
IDCSARV0 EQU   0                                                        09049000
IDCSASC0 EQU   0                                                        09050000
IDCSASI0 EQU   0                                                        09051000
IDCSASN0 EQU   0                                                        09052000
IDCSASS0 EQU   0                                                        09053000
IDCSAST0 EQU   0                                                        09054000
IDCSATI0 EQU   0                                                        09055000
IDCSAUC0 EQU   0                                                        09056000
IDCSAWO0 EQU   0                                                        09057000
IDCSA060 EQU   0                                                        09058000
IDCST010 EQU   0                                                        09059000
IKEBC    EQU   0                                                        09060000
IKEBF15  EQU   0                                                        09061000
IKEBF31  EQU   0                                                        09062000
IKEBP15  EQU   0                                                        09063000
IKEBP31  EQU   0                                                        09064000
IKEBP8   EQU   0                                                        09065000
MTEXTVOL EQU   0                                                        09066000
NEWERID1 EQU   5                                                        09067000
GDTTBLX  EQU   0                                                        09068000
CLNAMEX  EQU   0                                                        09069000
LDMODX   EQU   0                                                        09070000
LDPOINTX EQU   0                                                        09071000
DEMODX   EQU   0                                                        09072000
GSSIZEX  EQU   0                                                        09073000
GSPOINTX EQU   0                                                        09074000
GSINITX  EQU   0                                                        09075000
GSSPIDX  EQU   0                                                        09076000
FSPOINTX EQU   0                                                        09077000
GPSIZEX  EQU   0                                                        09078000
GPPOINTX EQU   0                                                        09079000
GPIDVARX EQU   0                                                        09080000
GPINITX  EQU   0                                                        09081000
FPIDVARX EQU   0                                                        09082000
FPALLX   EQU   0                                                        09083000
TITIMEX  EQU   0                                                        09084000
TIDATEX  EQU   0                                                        09085000
TIFORMX  EQU   0                                                        09086000
CPLPTRX  EQU   0                                                        09087000
SNAPIDX  EQU   0                                                        09088000
PTTEXTPX EQU   0                                                        09089000
PTTEXTLX EQU   0                                                        09090000
PTREPLPX EQU   0                                                        09091000
PTREPLLX EQU   0                                                        09092000
USERIDX  EQU   0                                                        09093000
USERIDLX EQU   0                                                        09094000
DSNPX    EQU   0                                                        09095000
DSNSX    EQU   0                                                        09096000
CATNPX   EQU   0                                                        09097000
PWDPX    EQU   0                                                        09098000
ALLAGLX  EQU   0                                                        09099000
ALLAGLY  EQU   0                                                        09100000
CIRAGLX  EQU   0                                                        09101000
LKNAMEX  EQU   0                                                        09102000
LINKARGX EQU   0                                                        09103000
ZSIZE    EQU   0                                                        09104000
ZPTR     EQU   0                                                        09105000
INITC    EQU   0                                                        09106000
CLNAMX   EQU   0                                                        09107000
ENTPT    EQU   0                                                        09108000
CVTS01   EQU   CVTPGSIA                                                 09109000
CVTLPDIA EQU   CVTS01+12                                                09110000
CVTDIRST EQU   CVTLPDIA                                                 09111000
CVTSLIDA EQU   CVTS01+24                                                09112000
CVTCTLFG EQU   CVTS01+50                                                09113000
CVTEHDEF EQU   CVTS01+388                                               09114000
CVTRV210 EQU   CVTS01+424                                               09115000
CVTRV219 EQU   CVTS01+425                                               09116000
CVTRV228 EQU   CVTS01+426                                               09117000
CVTRV237 EQU   CVTS01+427                                               09118000
CVTMFRTR EQU   CVTS01+452                                               09119000
CVTRV262 EQU   CVTS01+468                                               09120000
CVTRV271 EQU   CVTS01+469                                               09121000
CVTRV280 EQU   CVTS01+470                                               09122000
CVTRV289 EQU   CVTS01+471                                               09123000
CVTGSDA  EQU   CVTS01+600                                               09124000
GETGEN   EQU   LIST1                                                    09125000
GETGENPG EQU   LIST2                                                    09126000
OPENGEN  EQU   LIST3                                                    09127000
SNAPGEN  EQU   LIST4                                                    09128000
DCBFORM  EQU   SNAPDCB                                                  09129000
PGLIST   EQU   LIST5                                                    09130000
@NM00047 EQU   CTGDDNM                                                  09131000
CTGPROB  EQU   @NM00047                                                 09132000
CTGREASN EQU   CTGPROB+2                                                09133000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    09134000
CTGREAS2 EQU   CTGREASN+1                                               09135000
CTGREAS1 EQU   CTGREASN                                                 09136000
CTGMODID EQU   CTGPROB                                                  09137000
CVTRV628 EQU   CVTS01+728                                               09138000
CVTRV627 EQU   CVTS01+724                                               09139000
CVTRV626 EQU   CVTS01+720                                               09140000
CVTRV625 EQU   CVTS01+716                                               09141000
CVTRV624 EQU   CVTS01+712                                               09142000
CVTRV623 EQU   CVTS01+708                                               09143000
CVTRV622 EQU   CVTS01+704                                               09144000
CVTRV621 EQU   CVTS01+700                                               09145000
CVTIHASU EQU   CVTS01+696                                               09146000
CVTSUSP  EQU   CVTS01+692                                               09147000
CVTT6SVC EQU   CVTS01+688                                               09148000
CVTCDAL  EQU   CVTS01+684                                               09149000
CVTTCTL  EQU   CVTS01+680                                               09150000
CVTRSUME EQU   CVTS01+676                                               09151000
CVTJTERM EQU   CVTS01+672                                               09152000
CVTASMRM EQU   CVTS01+668                                               09153000
CVTTCASP EQU   CVTS01+664                                               09154000
CVT0PT03 EQU   CVTS01+660                                               09155000
CVT0PT0E EQU   CVTS01+656                                               09156000
CVTRV609 EQU   CVTS01+652                                               09157000
CVTCGK   EQU   CVTS01+648                                               09158000
CVTRAC   EQU   CVTS01+644                                               09159000
CVTHSM   EQU   CVTS01+640                                               09160000
CVTRV605 EQU   CVTS01+636                                               09161000
CVTRV604 EQU   CVTS01+632                                               09162000
CVTEFF02 EQU   CVTS01+628                                               09163000
CVTCBBR  EQU   CVTS01+624                                               09164000
CVTSSCR  EQU   CVTS01+620                                               09165000
CVTEVENT EQU   CVTS01+616                                               09166000
CVTCRCA  EQU   CVTS01+612                                               09167000
CVTTPIO  EQU   CVTS01+608                                               09168000
CVTADV   EQU   CVTS01+604                                               09169000
CVTGSDAB EQU   CVTGSDA                                                  09170000
CVTQV3   EQU   CVTS01+596                                               09171000
CVTQV2   EQU   CVTS01+592                                               09172000
CVTQV1   EQU   CVTS01+588                                               09173000
CVTRPT   EQU   CVTS01+584                                               09174000
CVTSSRB  EQU   CVTS01+580                                               09175000
CVTCSDRL EQU   CVTS01+576                                               09176000
CVTEXP1  EQU   CVTS01+572                                               09177000
CVTRMPMT EQU   CVTS01+568                                               09178000
CVTRMPTT EQU   CVTS01+564                                               09179000
CVTVPSA  EQU   CVTS01+560                                               09180000
CVTVSTOP EQU   CVTS01+556                                               09181000
CVTGTFR8 EQU   CVTS01+552                                               09182000
CVTQUIT  EQU   CVTS01+548                                               09183000
CVTVACR  EQU   CVTS01+544                                               09184000
CVTWTCB  EQU   CVTS01+540                                               09185000
CVTSTPRS EQU   CVTS01+536                                               09186000
CVT0PT02 EQU   CVTS01+532                                               09187000
CVTDARCM EQU   CVTS01+528                                               09188000
CVTIRECM EQU   CVTS01+524                                               09189000
CVTJRECM EQU   CVTS01+520                                               09190000
CVTVEMS0 EQU   CVTS01+516                                               09191000
CVTSPFRR EQU   CVTS01+512                                               09192000
CVTRLSTG EQU   CVTS01+508                                               09193000
CVT0TC0A EQU   CVTS01+504                                               09194000
CVTGMBR  EQU   CVTS01+500                                               09195000
CVTLFRM  EQU   CVTS01+496                                               09196000
CVTRMBR  EQU   CVTS01+492                                               09197000
CVTVIOP  EQU   CVTS01+488                                               09198000
CVTRV307 EQU   CVTS01+486                                               09199000
CVTRV306 EQU   CVTS01+484                                               09200000
CVTRV305 EQU   CVTS01+482                                               09201000
CVTRV304 EQU   CVTS01+480                                               09202000
CVTRV303 EQU   CVTS01+478                                               09203000
CVTRV302 EQU   CVTS01+476                                               09204000
CVTTRCA  EQU   CVTS01+472                                               09205000
CVTRV297 EQU   CVTRV289                                                 09206000
CVTRV296 EQU   CVTRV289                                                 09207000
CVTRV295 EQU   CVTRV289                                                 09208000
CVTRV294 EQU   CVTRV289                                                 09209000
CVTRV293 EQU   CVTRV289                                                 09210000
CVTRV292 EQU   CVTRV289                                                 09211000
CVTRV291 EQU   CVTRV289                                                 09212000
CVTRV290 EQU   CVTRV289                                                 09213000
CVTRV288 EQU   CVTRV280                                                 09214000
CVTRV287 EQU   CVTRV280                                                 09215000
CVTRV286 EQU   CVTRV280                                                 09216000
CVTRV285 EQU   CVTRV280                                                 09217000
CVTRV284 EQU   CVTRV280                                                 09218000
CVTRV283 EQU   CVTRV280                                                 09219000
CVTRV282 EQU   CVTRV280                                                 09220000
CVTRV281 EQU   CVTRV280                                                 09221000
CVTRV279 EQU   CVTRV271                                                 09222000
CVTRV278 EQU   CVTRV271                                                 09223000
CVTRV277 EQU   CVTRV271                                                 09224000
CVTRV276 EQU   CVTRV271                                                 09225000
CVTRV275 EQU   CVTRV271                                                 09226000
CVTRV274 EQU   CVTRV271                                                 09227000
CVTRV273 EQU   CVTRV271                                                 09228000
CVTRV272 EQU   CVTRV271                                                 09229000
CVTRV270 EQU   CVTRV262                                                 09230000
CVTRV269 EQU   CVTRV262                                                 09231000
CVTRV268 EQU   CVTRV262                                                 09232000
CVTRV267 EQU   CVTRV262                                                 09233000
CVTRV266 EQU   CVTRV262                                                 09234000
CVTRV265 EQU   CVTRV262                                                 09235000
CVTRV264 EQU   CVTRV262                                                 09236000
CVTRV263 EQU   CVTRV262                                                 09237000
CVTVFP   EQU   CVTS01+464                                               09238000
CVTVSI   EQU   CVTS01+460                                               09239000
CVTVPSIB EQU   CVTS01+456                                               09240000
CVTMFACT EQU   CVTMFRTR                                                 09241000
CVTMFCTL EQU   CVTS01+448                                               09242000
CVTPVBP  EQU   CVTS01+444                                               09243000
CVTPWI   EQU   CVTS01+440                                               09244000
CVTRV254 EQU   CVTS01+438                                               09245000
CVTRV253 EQU   CVTS01+436                                               09246000
CVTRV252 EQU   CVTS01+434                                               09247000
CVTRV251 EQU   CVTS01+433                                               09248000
CVTRV250 EQU   CVTS01+432                                               09249000
CVTRV249 EQU   CVTS01+431                                               09250000
CVTRV248 EQU   CVTS01+430                                               09251000
CVTRV247 EQU   CVTS01+429                                               09252000
CVTRV246 EQU   CVTS01+428                                               09253000
CVTRV245 EQU   CVTRV237                                                 09254000
CVTRV244 EQU   CVTRV237                                                 09255000
CVTRV243 EQU   CVTRV237                                                 09256000
CVTRV242 EQU   CVTRV237                                                 09257000
CVTRV241 EQU   CVTRV237                                                 09258000
CVTRV240 EQU   CVTRV237                                                 09259000
CVTRV239 EQU   CVTRV237                                                 09260000
CVTRV238 EQU   CVTRV237                                                 09261000
CVTRV236 EQU   CVTRV228                                                 09262000
CVTRV235 EQU   CVTRV228                                                 09263000
CVTRV234 EQU   CVTRV228                                                 09264000
CVTRV233 EQU   CVTRV228                                                 09265000
CVTRV232 EQU   CVTRV228                                                 09266000
CVTRV231 EQU   CVTRV228                                                 09267000
CVTRV230 EQU   CVTRV228                                                 09268000
CVTRV229 EQU   CVTRV228                                                 09269000
CVTRV227 EQU   CVTRV219                                                 09270000
CVTRV226 EQU   CVTRV219                                                 09271000
CVTRV225 EQU   CVTRV219                                                 09272000
CVTRV224 EQU   CVTRV219                                                 09273000
CVTRV223 EQU   CVTRV219                                                 09274000
CVTRV222 EQU   CVTRV219                                                 09275000
CVTRV221 EQU   CVTRV219                                                 09276000
CVTRV220 EQU   CVTRV219                                                 09277000
CVTRV218 EQU   CVTRV210                                                 09278000
CVTRV217 EQU   CVTRV210                                                 09279000
CVTRV216 EQU   CVTRV210                                                 09280000
CVTRV215 EQU   CVTRV210                                                 09281000
CVTRV214 EQU   CVTRV210                                                 09282000
CVTRV213 EQU   CVTRV210                                                 09283000
CVTRV212 EQU   CVTRV210                                                 09284000
CVTRV211 EQU   CVTRV210                                                 09285000
CVTLCCAT EQU   CVTS01+420                                               09286000
CVTPCCAT EQU   CVTS01+416                                               09287000
CVTIPCRP EQU   CVTS01+412                                               09288000
CVTIPCRI EQU   CVTS01+408                                               09289000
CVTIPCDS EQU   CVTS01+404                                               09290000
CVTAIDVT EQU   CVTS01+400                                               09291000
CVTSSAP  EQU   CVTS01+396                                               09292000
CVTEHCIR EQU   CVTS01+392                                               09293000
CVTDAIR  EQU   CVTS01+384                                               09294000
CVTPERFM EQU   CVTS01+380                                               09295000
CVT044R2 EQU   CVTS01+376                                               09296000
CVTFETCH EQU   CVTS01+372                                               09297000
CVTRSTWD EQU   CVTS01+368                                               09298000
CVTSPOST EQU   CVTS01+364                                               09299000
CVTIOBP  EQU   CVTS01+360                                               09300000
CVTASMVT EQU   CVTS01+356                                               09301000
CVTRECRQ EQU   CVTS01+352                                               09302000
CVTWSAC  EQU   CVTS01+348                                               09303000
CVTRV149 EQU   CVTS01+344                                               09304000
CVTWSAL  EQU   CVTS01+340                                               09305000
CVTSPSA  EQU   CVTS01+336                                               09306000
CVTGLMN  EQU   CVTS01+332                                               09307000
CVTVEAC0 EQU   CVTS01+328                                               09308000
CVT062R1 EQU   CVTS01+324                                               09309000
CVTRPOST EQU   CVTS01+320                                               09310000
CVTDQIQE EQU   CVTS01+316                                               09311000
CVTCSD   EQU   CVTS01+312                                               09312000
CVTLKRMA EQU   CVTS01+308                                               09313000
CVTRSPIE EQU   CVTS01+304                                               09314000
CVTRENQ  EQU   CVTS01+300                                               09315000
CVTLQCB  EQU   CVTS01+296                                               09316000
CVTFQCB  EQU   CVTS01+292                                               09317000
CVTQCS01 EQU   CVTS01+288                                               09318000
CVTAPFT  EQU   CVTS01+284                                               09319000
CVTPARRL EQU   CVTS01+280                                               09320000
CVTVWAIT EQU   CVTS01+276                                               09321000
CVTGSPL  EQU   CVTS01+272                                               09322000
CVTLSMQ  EQU   CVTS01+268                                               09323000
CVTGSMQ  EQU   CVTS01+264                                               09324000
CVTEXPRO EQU   CVTS01+260                                               09325000
CVTOPCTP EQU   CVTS01+256                                               09326000
CVTSIC   EQU   CVTS01+252                                               09327000
CVTTPIOS EQU   CVTS01+248                                               09328000
CVTRTMS  EQU   CVTS01+244                                               09329000
CVTSDBF  EQU   CVTS01+240                                               09330000
CVTSCBP  EQU   CVTS01+236                                               09331000
CVTSDMP  EQU   CVTS01+232                                               09332000
CVTSV60  EQU   CVTS01+228                                               09333000
CVTRTMCT EQU   CVTS01+224                                               09334000
CVTASCBL EQU   CVTS01+220                                               09335000
CVTASCBH EQU   CVTS01+216                                               09336000
CVTGDA   EQU   CVTS01+212                                               09337000
CVTASVT  EQU   CVTS01+208                                               09338000
CVTVVMDI EQU   CVTS01+204                                               09339000
CVTAQTOP EQU   CVTS01+200                                               09340000
CVTIOSCS EQU   CVTS01+196                                               09341000
CVTSDRM  EQU   CVTS01+192                                               09342000
CVTOPTE  EQU   CVTS01+188                                               09343000
CVTSTXU  EQU   CVTS01+184                                               09344000
CVTQUIS  EQU   CVTS01+180                                               09345000
CVTPARS  EQU   CVTS01+176                                               09346000
CVTS1EE  EQU   CVTS01+172                                               09347000
CVTFRAS  EQU   CVTS01+168                                               09348000
CVTQSAS  EQU   CVTS01+164                                               09349000
CVTCRAS  EQU   CVTS01+160                                               09350000
CVTCRMN  EQU   CVTS01+156                                               09351000
CVTDELCP EQU   CVTS01+152                                               09352000
CVTFRECL EQU   CVTS01+148                                               09353000
CVTGETCL EQU   CVTS01+144                                               09354000
CVTBLDCP EQU   CVTS01+140                                               09355000
CVTAUTHL EQU   CVTS01+136                                               09356000
CVTSCAN  EQU   CVTS01+132                                               09357000
CVTRV144 EQU   CVTS01+130                                               09358000
CVTMAXMP EQU   CVTS01+128                                               09359000
CVTSTCK  EQU   CVTS01+124                                               09360000
CVTRV139 EQU   CVTS01+123                                               09361000
CVTDSSAC EQU   CVTS01+122                                               09362000
CVTRV513 EQU   CVTS01+121                                               09363000
CVTIOSPL EQU   CVTS01+120                                               09364000
CVTPTGT  EQU   CVTS01+116                                               09365000
CVTCSPIE EQU   CVTS01+112                                               09366000
CVTSMFEX EQU   CVTS01+108                                               09367000
CVTOLT0A EQU   CVTS01+104                                               09368000
CVTSRBRT EQU   CVTS01+100                                               09369000
CVTPUTL  EQU   CVTS01+96                                                09370000
CVTASCRL EQU   CVTS01+92                                                09371000
CVTASCRF EQU   CVTS01+88                                                09372000
CVTRV326 EQU   CVTS01+84                                                09373000
CVTRV325 EQU   CVTS01+80                                                09374000
CVTRV324 EQU   CVTS01+76                                                09375000
CVT0VL01 EQU   CVTS01+72                                                09376000
CVTSHRVM EQU   CVTS01+68                                                09377000
CVTRV332 EQU   CVTS01+64                                                09378000
CVTTAS   EQU   CVTS01+60                                                09379000
CVTRSCN  EQU   CVTS01+56                                                09380000
CVTTRAC2 EQU   CVTS01+54                                                09381000
CVTTRACE EQU   CVTS01+52                                                09382000
CVTAPG   EQU   CVTS01+51                                                09383000
CVTSDTRC EQU   CVTCTLFG                                                 09384000
CVTGTRCE EQU   CVTCTLFG                                                 09385000
CVTNOMP  EQU   CVTCTLFG                                                 09386000
CVTRSV79 EQU   CVTCTLFG                                                 09387000
CVTDSTAT EQU   CVTCTLFG                                                 09388000
CVTRSV78 EQU   CVTCTLFG                                                 09389000
CVTRV333 EQU   CVTCTLFG                                                 09390000
CVTRV323 EQU   CVTCTLFG                                                 09391000
CVTSPVLK EQU   CVTS01+49                                                09392000
CVTRSV77 EQU   CVTS01+48                                                09393000
CVTRV331 EQU   CVTS01+44                                                09394000
CVTRV330 EQU   CVTS01+40                                                09395000
CVTRV329 EQU   CVTS01+36                                                09396000
CVTRV328 EQU   CVTS01+32                                                09397000
CVTRV322 EQU   CVTS01+28                                                09398000
CVTSLID  EQU   CVTSLIDA+1                                               09399000
CVTSYLK  EQU   CVTSLIDA                                                 09400000
CVTRV321 EQU   CVTS01+20                                                09401000
CVTRV320 EQU   CVTS01+16                                                09402000
CVTLPDIR EQU   CVTLPDIA+1                                               09403000
CVTRSV69 EQU   CVTDIRST                                                 09404000
CVTRSV68 EQU   CVTDIRST                                                 09405000
CVTRSV67 EQU   CVTDIRST                                                 09406000
CVTRSV66 EQU   CVTDIRST                                                 09407000
CVTRSV65 EQU   CVTDIRST                                                 09408000
CVTRSV64 EQU   CVTDIRST                                                 09409000
CVTRSV63 EQU   CVTDIRST                                                 09410000
CVTDICOM EQU   CVTDIRST                                                 09411000
CVTPVTP  EQU   CVTS01+8                                                 09412000
CVTLPDSR EQU   CVTS01+4                                                 09413000
CVTGETL  EQU   CVTS01                                                   09414000
CTGFIELD EQU   CTGPL+28                                                 09415000
@NM00046 EQU   CTGFBFLG                                                 09416000
CTGNGDSN EQU   CTGFBFLG                                                 09417000
CTGGDGB  EQU   CTGFBFLG                                                 09418000
CTGKEEP  EQU   CTGFBFLG                                                 09419000
CTGPAR   EQU   CTGFBFLG                                                 09420000
CTGFDBK  EQU   CTGNEWNM                                                 09421000
CTGNOFLD EQU   CTGPL+19                                                 09422000
CTGTYPE  EQU   CTGPL+18                                                 09423000
@NM00045 EQU   CTGDSORG                                                 09424000
CTGOPTNS EQU   CTGDSORG                                                 09425000
CTGCVOL  EQU   CTGCAT                                                   09426000
CTGFVT   EQU   CTGENT                                                   09427000
@NM00044 EQU   CTGOPTN4                                                 09428000
CTGTIOT  EQU   CTGOPTN4                                                 09429000
CTGBYPMT EQU   CTGOPTN4                                                 09430000
CTGCOIN  EQU   CTGOPTN4                                                 09431000
CTGNPROF EQU   CTGOPTN4                                                 09432000
CTGDOCAT EQU   CTGOPTN4                                                 09433000
CTGLBASE EQU   CTGOPTN4                                                 09434000
CTGNUM   EQU   CTGOPTN3                                                 09435000
CTGSRH   EQU   CTGOPTN3                                                 09436000
CTGGDGL  EQU   CTGOPTN3                                                 09437000
CTGFUNC  EQU   CTGOPTN3                                                 09438000
@NM00043 EQU   CTGOPTN2                                                 09439000
CTGSCR   EQU   CTGOPTN2                                                 09440000
CTGOVRID EQU   CTGOPTN2                                                 09441000
CTGDISC  EQU   CTGOPTN2                                                 09442000
CTGGTNXT EQU   CTGOPTN2                                                 09443000
CTGSWAP  EQU   CTGRCATN                                                 09444000
CTGGTALL EQU   CTGREL                                                   09445000
CTGNSVS  EQU   CTGEXT                                                   09446000
CTGREAD  EQU   CTGOPTN1                                                 09447000
CTGUPD   EQU   CTGOPTN1                                                 09448000
CTGCI    EQU   CTGOPTN1                                                 09449000
CTGMAST  EQU   CTGOPTN1                                                 09450000
CTGBYPSS EQU   CTGOPTN1                                                 09451000
@NM00040 EQU   UPT+15                                                   09452000
UPTLDEL  EQU   UPT+14                                                   09453000
UPTCDEL  EQU   UPT+13                                                   09454000
UPTWTP   EQU   UPTSWS                                                   09455000
UPTMODE  EQU   UPTSWS                                                   09456000
UPTALD   EQU   UPTSWS                                                   09457000
UPTPAUS  EQU   UPTSWS                                                   09458000
UPTNCOM  EQU   UPTSWS                                                   09459000
UPTMID   EQU   UPTSWS                                                   09460000
UPTNPRM  EQU   UPTSWS                                                   09461000
UPTRCVR  EQU   UPTSWS                                                   09462000
UPTUSER  EQU   UPT+2                                                    09463000
@NM00039 EQU   UPT                                                      09464000
S99TUPND EQU   S99TUP                                                   09465000
PASFWD   EQU   PASCNTRL                                                 09466000
@NM00037 EQU   GSID                                                     09467000
@NM00036 EQU   GSLEN+1                                                  09468000
AUTOID   EQU   @NM00035+4                                               09469000
PTR1     EQU   AUTOARAY+8                                               09470000
ASIZE    EQU   AUTOARAY+6                                               09471000
AREAID   EQU   AUTOARAY                                                 09472000
SAHSTA   EQU   SAHIST+12                                                09473000
CVTLEVL  EQU   CVTRELNO+2                                               09474000
CVTNUMB  EQU   CVTRELNO                                                 09475000
CVTMDL   EQU   CVTFIX+250                                               09476000
@NM00033 EQU   CVTFIX+248                                               09477000
@NM00032 EQU   CVTFIX                                                   09478000
CVTRV482 EQU   CVTXTNT2+128                                             09479000
CVTRV481 EQU   CVTXTNT2+124                                             09480000
CVTRV480 EQU   CVTXTNT2+120                                             09481000
CVTRV479 EQU   CVTXTNT2+118                                             09482000
CVTRV478 EQU   CVTXTNT2+117                                             09483000
CVTRV477 EQU   CVTXTNT2+116                                             09484000
CVTRV476 EQU   CVTXTNT2+115                                             09485000
CVTRV475 EQU   CVTXTNT2+114                                             09486000
CVTRV474 EQU   CVTRV466                                                 09487000
CVTRV473 EQU   CVTRV466                                                 09488000
CVTRV472 EQU   CVTRV466                                                 09489000
CVTRV471 EQU   CVTRV466                                                 09490000
CVTRV470 EQU   CVTRV466                                                 09491000
CVTRV469 EQU   CVTRV466                                                 09492000
CVTRV468 EQU   CVTRV466                                                 09493000
CVTRV467 EQU   CVTRV466                                                 09494000
CVTRV465 EQU   CVTRV457                                                 09495000
CVTRV464 EQU   CVTRV457                                                 09496000
CVTRV463 EQU   CVTRV457                                                 09497000
CVTRV462 EQU   CVTRV457                                                 09498000
CVTRV461 EQU   CVTRV457                                                 09499000
CVTRV460 EQU   CVTRV457                                                 09500000
CVTRV459 EQU   CVTRV457                                                 09501000
CVTRV458 EQU   CVTRV457                                                 09502000
CVTRV456 EQU   CVTXTNT2+108                                             09503000
CVTRV455 EQU   CVTXTNT2+104                                             09504000
CVTRV454 EQU   CVTXTNT2+100                                             09505000
CVTRV453 EQU   CVTXTNT2+96                                              09506000
CVTRV452 EQU   CVTXTNT2+94                                              09507000
CVTRV451 EQU   CVTXTNT2+92                                              09508000
CVTRV450 EQU   CVTXTNT2+90                                              09509000
CVTRV449 EQU   CVTXTNT2+88                                              09510000
CVTRV448 EQU   CVTXTNT2+87                                              09511000
CVTRV447 EQU   CVTXTNT2+86                                              09512000
CVTRV446 EQU   CVTRV438                                                 09513000
CVTRV445 EQU   CVTRV438                                                 09514000
CVTRV444 EQU   CVTRV438                                                 09515000
CVTRV443 EQU   CVTRV438                                                 09516000
CVTRV442 EQU   CVTRV438                                                 09517000
CVTRV441 EQU   CVTRV438                                                 09518000
CVTRV440 EQU   CVTRV438                                                 09519000
CVTRV439 EQU   CVTRV438                                                 09520000
CVTRV437 EQU   CVTRV429                                                 09521000
CVTRV436 EQU   CVTRV429                                                 09522000
CVTRV435 EQU   CVTRV429                                                 09523000
CVTRV434 EQU   CVTRV429                                                 09524000
CVTRV433 EQU   CVTRV429                                                 09525000
CVTRV432 EQU   CVTRV429                                                 09526000
CVTRV431 EQU   CVTRV429                                                 09527000
CVTRV430 EQU   CVTRV429                                                 09528000
CVTRV428 EQU   CVTXTNT2+80                                              09529000
CVTRV427 EQU   CVTXTNT2+76                                              09530000
CVTRV426 EQU   CVTXTNT2+72                                              09531000
CVTRV425 EQU   CVTXTNT2+68                                              09532000
CVTATACT EQU   CVTATCVT                                                 09533000
CVTRV423 EQU   CVTXTNT2+62                                              09534000
CVTRV422 EQU   CVTXTNT2+60                                              09535000
CVTRV421 EQU   CVTXTNT2+58                                              09536000
CVTRV420 EQU   CVTXTNT2+56                                              09537000
CVTRV419 EQU   CVTXTNT2+55                                              09538000
CVTRV418 EQU   CVTXTNT2+54                                              09539000
CVTRV417 EQU   CVTRV409                                                 09540000
CVTRV416 EQU   CVTRV409                                                 09541000
CVTRV415 EQU   CVTRV409                                                 09542000
CVTRV414 EQU   CVTRV409                                                 09543000
CVTRV413 EQU   CVTRV409                                                 09544000
CVTRV412 EQU   CVTRV409                                                 09545000
CVTRV411 EQU   CVTRV409                                                 09546000
CVTRV410 EQU   CVTRV409                                                 09547000
CVTRV408 EQU   CVTRV400                                                 09548000
CVTRV407 EQU   CVTRV400                                                 09549000
CVTRV406 EQU   CVTRV400                                                 09550000
CVTRV405 EQU   CVTRV400                                                 09551000
CVTRV404 EQU   CVTRV400                                                 09552000
CVTRV403 EQU   CVTRV400                                                 09553000
CVTRV402 EQU   CVTRV400                                                 09554000
CVTRV401 EQU   CVTRV400                                                 09555000
CVTICB   EQU   CVTXTNT2+48                                              09556000
CVTSKTA  EQU   CVTXTNT2+44                                              09557000
CVTCCVT  EQU   CVTXTNT2+40                                              09558000
CVTRSV98 EQU   CVTXTNT2+36                                              09559000
CVTRSV97 EQU   CVTXTNT2+34                                              09560000
CVTRSV96 EQU   CVTXTNT2+32                                              09561000
CVTOLTEP EQU   CVTXTNT2+28                                              09562000
CVTQIDA  EQU   CVTQID+1                                                 09563000
CVTRSV95 EQU   CVTQID                                                   09564000
CVTRSV94 EQU   CVTXTNT2+20                                              09565000
CVTRSV93 EQU   CVTXTNT2+16                                              09566000
CVTRSV92 EQU   CVTXTNT2+12                                              09567000
CVTDEBVR EQU   CVTXTNT2+8                                               09568000
CVTRSV91 EQU   CVTXTNT2+6                                               09569000
CVTRSV9H EQU   CVTFLGBT                                                 09570000
CVTRSV9G EQU   CVTFLGBT                                                 09571000
CVTRSV9F EQU   CVTFLGBT                                                 09572000
CVTRSV9E EQU   CVTFLGBT                                                 09573000
CVTRSV9D EQU   CVTFLGBT                                                 09574000
CVTRSV9C EQU   CVTFLGBT                                                 09575000
CVTVME   EQU   CVTFLGBT                                                 09576000
CVTNPE   EQU   CVTFLGBT                                                 09577000
CVTNUCLS EQU   CVTXTNT2+4                                               09578000
CVTDSSVA EQU   CVTDSSV+1                                                09579000
CVTRSV89 EQU   CVTDSSV                                                  09580000
CVTRSV88 EQU   CVTXTNT1+8                                               09581000
CVTRSV87 EQU   CVTXTNT1+4                                               09582000
CVTFACHN EQU   CVTXTNT1                                                 09583000
CVTRV488 EQU   CVTMAP+412                                               09584000
CVTRV487 EQU   CVTMAP+408                                               09585000
CVTRV486 EQU   CVTMAP+404                                               09586000
CVTRV485 EQU   CVTMAP+400                                               09587000
CVTACTAP EQU   CVTMAP+396                                               09588000
CVTAUTH  EQU   CVTMAP+392                                               09589000
CVTATMCA EQU   CVTATMCT+1                                               09590000
CVTATMST EQU   CVTATMCT                                                 09591000
CVTRSV61 EQU   CVTMAP+384                                               09592000
CVTVOLT1 EQU   CVTVOLM1+1                                               09593000
CVTVOLI1 EQU   CVTVOLF1                                                 09594000
CVTSTOA  EQU   CVTMAP+376                                               09595000
CVTRSV58 EQU   CVTMAP+374                                               09596000
CVTRSV57 EQU   CVTMAP+372                                               09597000
CVTDDCE  EQU   CVTMAP+368                                               09598000
CVTPNWFR EQU   CVTMAP+364                                               09599000
CVTSMF   EQU   CVTMAP+360                                               09600000
CVTSULK  EQU   CVTMAP+358                                               09601000
CVTSLKO  EQU   CVTSYSK                                                  09602000
CVTSLKP  EQU   CVTSYSK                                                  09603000
CVTSLKQ  EQU   CVTSYSK                                                  09604000
CVTSLKR  EQU   CVTSYSK                                                  09605000
CVTRSV56 EQU   CVTSYSK                                                  09606000
CVTRSV55 EQU   CVTSYSK                                                  09607000
CVTRSV54 EQU   CVTSYSK                                                  09608000
CVTRSV53 EQU   CVTSYSK                                                  09609000
CVTRSV52 EQU   CVTA1F1                                                  09610000
CVTRSV51 EQU   CVTA1F1                                                  09611000
CVTRSV50 EQU   CVTA1F1                                                  09612000
CVTRSV49 EQU   CVTA1F1                                                  09613000
CVTRSV48 EQU   CVTA1F1                                                  09614000
CVTRSV47 EQU   CVTA1F1                                                  09615000
CVTSRSW  EQU   CVTA1F1                                                  09616000
CVTPFSW  EQU   CVTA1F1                                                  09617000
CVTPCVT  EQU   CVTMAP+352                                               09618000
CVTRSV46 EQU   CVTMAP+344                                               09619000
CVTRSV45 EQU   CVTMAP+340                                               09620000
CVTRSV44 EQU   CVTMAP+338                                               09621000
CVTRSV43 EQU   CVTMAP+336                                               09622000
CVTHJESA EQU   CVTHJES+1                                                09623000
CVTRSV42 EQU   CVTHJES                                                  09624000
CVTEXT2A EQU   CVTEXT2+1                                                09625000
CVTRSV41 EQU   CVTEXT2                                                  09626000
CVTAPFA  EQU   CVTAPF+1                                                 09627000
CVTRSV40 EQU   CVTAPF                                                   09628000
CVTRV518 EQU   CVTINTLA                                                 09629000
CVTRV517 EQU   CVTERPV                                                  09630000
CVTEORM  EQU   CVTMAP+312                                               09631000
CVTMCHPR EQU   CVTMAP+308                                               09632000
CVTTZ    EQU   CVTMAP+304                                               09633000
CVTJEPS  EQU   CVTMAP+300                                               09634000
CVTJESCT EQU   CVTMAP+296                                               09635000
CVTMODE  EQU   CVTMAP+292                                               09636000
CVTPTRV  EQU   CVTMAP+288                                               09637000
CVTREAL  EQU   CVTMAP+284                                               09638000
CVTRSV39 EQU   CVTMAP+280                                               09639000
CVTRSV38 EQU   CVTMAP+276                                               09640000
CVTDMSRA EQU   CVTDMSR+1                                                09641000
CVTRV634 EQU   CVTDMSRF                                                 09642000
CVTRV633 EQU   CVTDMSRF                                                 09643000
CVTRV632 EQU   CVTDMSRF                                                 09644000
CVTRV631 EQU   CVTDMSRF                                                 09645000
CVTRV630 EQU   CVTDMSRF                                                 09646000
CVTRV629 EQU   CVTDMSRF                                                 09647000
CVTUDUMP EQU   CVTDMSRF                                                 09648000
CVTSDUMP EQU   CVTDMSRF                                                 09649000
CVTQMSGA EQU   CVTQMSG+1                                                09650000
CVTRSV36 EQU   CVTQMSG                                                  09651000
CVTAMFF  EQU   CVTMAP+264                                               09652000
CVTPURGA EQU   CVTPURG+1                                                09653000
CVTRSV35 EQU   CVTPURG                                                  09654000
CVTCBSP  EQU   CVTMAP+256                                               09655000
CVTATERA EQU   CVTATER+1                                                09656000
CVTSYST  EQU   CVTATER                                                  09657000
CVTVOLT2 EQU   CVTTAT                                                   09658000
CVTVOLI2 EQU   CVTVOLF2                                                 09659000
CVTAQAVB EQU   CVTAQAVT+1                                               09660000
CVTRSV34 EQU   CVTTCMFG                                                 09661000
CVTRSV33 EQU   CVTTCMFG                                                 09662000
CVTRSV32 EQU   CVTTCMFG                                                 09663000
CVTRSV31 EQU   CVTTCMFG                                                 09664000
CVTRSV30 EQU   CVTTCMFG                                                 09665000
CVTRSV29 EQU   CVTTCMFG                                                 09666000
CVTLDEV  EQU   CVTTCMFG                                                 09667000
CVTTCRDY EQU   CVTTCMFG                                                 09668000
CVTGTFA  EQU   CVTGTF+1                                                 09669000
CVTRSV27 EQU   CVTGTFST                                                 09670000
CVTRNIO  EQU   CVTGTFST                                                 09671000
CVTUSR   EQU   CVTGTFST                                                 09672000
CVTRV318 EQU   CVTFORM                                                  09673000
CVTRV317 EQU   CVTTMODE                                                 09674000
CVTRV316 EQU   CVTSTATE                                                 09675000
CVTRV315 EQU   CVTGTFS                                                  09676000
CVTGTFAV EQU   CVTGTFS                                                  09677000
CVT0SCR1 EQU   CVTMAP+232                                               09678000
CVTRV515 EQU   CVTMAP+228                                               09679000
CVTRMS   EQU   CVTMAP+224                                               09680000
CVTPATCH EQU   CVTMAP+220                                               09681000
CVTTSCE  EQU   CVTMAP+216                                               09682000
CVTLNKSC EQU   CVTMAP+214                                               09683000
CVTQABST EQU   CVTMAP+212                                               09684000
CVTMDLDS EQU   CVTMAP+208                                               09685000
CVTUSER  EQU   CVTMAP+204                                               09686000
CVTABEND EQU   CVTMAP+200                                               09687000
CVTSMCA  EQU   CVTMAP+196                                               09688000
CVTRSV18 EQU   CVTMAP+192                                               09689000
CVTQLPAQ EQU   CVTMAP+188                                               09690000
CVTQCDSR EQU   CVTMAP+184                                               09691000
CVTRSV17 EQU   CVTOPTB                                                  09692000
CVTRSV16 EQU   CVTOPTB                                                  09693000
CVTFP    EQU   CVTOPTB                                                  09694000
CVTAPTHR EQU   CVTOPTB                                                  09695000
CVTNLOG  EQU   CVTOPTB                                                  09696000
CVTTOD   EQU   CVTOPTB                                                  09697000
CVTCTIMS EQU   CVTOPTB                                                  09698000
CVTPROT  EQU   CVTOPTB                                                  09699000
CVTXPFP  EQU   CVTOPTA                                                  09700000
CVTASCII EQU   CVTOPTA                                                  09701000
CVTRSV13 EQU   CVTOPTA                                                  09702000
CVTRSV12 EQU   CVTOPTA                                                  09703000
CVTNIP   EQU   CVTOPTA                                                  09704000
CVTDDR   EQU   CVTOPTA                                                  09705000
CVTAPR   EQU   CVTOPTA                                                  09706000
CVTCCH   EQU   CVTOPTA                                                  09707000
CVTSNCTR EQU   CVTMAP+180                                               09708000
CVTQMWR  EQU   CVTMAP+176                                               09709000
CVTQOCR  EQU   CVTMAP+172                                               09710000
CVT1EF00 EQU   CVTMAP+168                                               09711000
CVTMZ00  EQU   CVTMAP+164                                               09712000
CVTSV76Q EQU   CVTSV76C                                                 09713000
CVTRSV11 EQU   CVTMAP+156                                               09714000
CVT0PT01 EQU   CVTMAP+152                                               09715000
CVTMSER  EQU   CVTMAP+148                                               09716000
CVTRV516 EQU   CVTIERLC                                                 09717000
CVTILCH  EQU   CVTMAP+140                                               09718000
CVT0DS   EQU   CVTMAP+136                                               09719000
CVTFBOSV EQU   CVTMAP+132                                               09720000
CVTNUCB  EQU   CVTMAP+128                                               09721000
CVTIXAVL EQU   CVTMAP+124                                               09722000
CVTSV76M EQU   CVTIOQET                                                 09723000
CVTDCBA  EQU   CVTMAP+117                                               09724000
CVTMVS2  EQU   CVTDCB                                                   09725000
CVT6DAT  EQU   CVTDCB                                                   09726000
CVT4MPS  EQU   CVTDCB                                                   09727000
CVTRSV09 EQU   CVTDCB                                                   09728000
CVT4MS1  EQU   CVTDCB                                                   09729000
CVT2SPS  EQU   CVTDCB                                                   09730000
CVT1SSS  EQU   CVTDCB                                                   09731000
CVTRSV08 EQU   CVTDCB                                                   09732000
CVTSTB   EQU   CVTMAP+112                                               09733000
CVTQTD00 EQU   CVTMAP+108                                               09734000
CVTQTE00 EQU   CVTMAP+104                                               09735000
CVTCUCB  EQU   CVTMAP+100                                               09736000
CVTSJQ   EQU   CVTMAP+96                                                09737000
CVTPBLDL EQU   CVTMAP+92                                                09738000
CVTTPC   EQU   CVTMAP+88                                                09739000
CVTSVDCB EQU   CVTMAP+84                                                09740000
CVTBRET  EQU   CVTMAP+82                                                09741000
CVTEXIT  EQU   CVTMAP+80                                                09742000
CVT0FN00 EQU   CVTMAP+76                                                09743000
CVTDARA  EQU   CVTDAR+1                                                 09744000
CVTRSV07 EQU   CVTFLGS1                                                 09745000
CVTRSV06 EQU   CVTFLGS1                                                 09746000
CVTRSV05 EQU   CVTFLGS1                                                 09747000
CVTRSV04 EQU   CVTFLGS1                                                 09748000
CVTRSV03 EQU   CVTFLGS1                                                 09749000
CVTRSV02 EQU   CVTFLGS1                                                 09750000
CVTRSV01 EQU   CVTFLGS1                                                 09751000
CVTDMPLK EQU   CVTFLGS1                                                 09752000
CVTXITP  EQU   CVTMAP+68                                                09753000
CVTZDTAB EQU   CVTMAP+64                                                09754000
CVTMSLT  EQU   CVTMAP+60                                                09755000
CVTDATE  EQU   CVTMAP+56                                                09756000
CVTBTERM EQU   CVTMAP+52                                                09757000
CVTSYSAD EQU   CVTMAP+48                                                09758000
CVTXTLER EQU   CVTMAP+44                                                09759000
CVTILK2  EQU   CVTMAP+40                                                09760000
CVTILK1  EQU   CVTMAP+36                                                09761000
CVTPRLTV EQU   CVTMAP+32                                                09762000
CVTPCNVT EQU   CVTMAP+28                                                09763000
CVT0VL00 EQU   CVTMAP+24                                                09764000
CVTXAPG  EQU   CVTMAP+20                                                09765000
CVTBUF   EQU   CVTMAP+16                                                09766000
CVTJOB   EQU   CVTMAP+12                                                09767000
CVTLINK  EQU   CVTMAP+8                                                 09768000
CVT0EF00 EQU   CVTMAP+4                                                 09769000
CVTTCBP  EQU   CVTMAP                                                   09770000
CVT      EQU   CVTMAP                                                   09771000
@NM00031 EQU   DMPARY+15                                                09772000
DMPARYTP EQU   DMPARY+14                                                09773000
DMPARYEX EQU   DMPARY+12                                                09774000
DMPARYIC EQU   DMPARY+10                                                09775000
DMPARYSZ EQU   DMPARY+8                                                 09776000
DMPARYNM EQU   DMPARY                                                   09777000
@NM00030 EQU   DMPITM+15                                                09778000
DMPITMTP EQU   DMPITM+14                                                09779000
DMPITMLN EQU   DMPITM+12                                                09780000
DMPITMPT EQU   DMPITM+8                                                 09781000
DMPITMNM EQU   DMPITM                                                   09782000
@NM00029 EQU   ERCNVTAB+24                                              09783000
@NM00028 EQU   ERCNVTAB+4                                               09784000
@NM00027 EQU   ERCNVTAB+3                                               09785000
@NM00026 EQU   EROSOPER                                                 09786000
EROSUCDX EQU   EROSOPER                                                 09787000
EROSCATL EQU   EROSOPER                                                 09788000
@NM00025 EQU   EROPER                                                   09789000
ERCATAL  EQU   EROPER                                                   09790000
ERCATDL  EQU   EROPER                                                   09791000
ERCATDE  EQU   EROPER                                                   09792000
@NM00024 EQU   ERTYPE                                                   09793000
EROSCAT  EQU   ERTYPE                                                   09794000
@NM00023 EQU   FMTCNVF+1                                                09795000
FMTAR    EQU   FMTCNVF+1                                                09796000
FMTBS    EQU   FMTCNVF+1                                                09797000
FMTSS    EQU   FMTCNVF+1                                                09798000
FMTAL    EQU   FMTCNVF+1                                                09799000
FMTZS    EQU   FMTCNVF+1                                                09800000
@NM00022 EQU   FMTCNVF                                                  09801000
FMTPU    EQU   FMTCNVF                                                  09802000
FMTBD    EQU   FMTCNVF                                                  09803000
FMTBHD   EQU   FMTCNVF                                                  09804000
FMTBHA   EQU   FMTCNVF                                                  09805000
FMTBH    EQU   FMTCNVF                                                  09806000
FMTOLEN  EQU   FMTLIST+8                                                09807000
FMTRIO   EQU   FMTOCOL                                                  09808000
FMTSPT   EQU   FMTSTO                                                   09809000
FMTSTL   EQU   FMTILEN                                                  09810000
@NM00021 EQU   FMTFLGS+1                                                09811000
FMTSMSG  EQU   FMTFLGS+1                                                09812000
FMTHDF   EQU   FMTFLGS                                                  09813000
FMTDFF   EQU   FMTFLGS                                                  09814000
FMTSTF   EQU   FMTFLGS                                                  09815000
FMTREPF  EQU   FMTFLGS                                                  09816000
FMTBDF   EQU   FMTFLGS                                                  09817000
FMTIDF   EQU   FMTFLGS                                                  09818000
FMTSCF   EQU   FMTFLGS                                                  09819000
FMTEOLF  EQU   FMTFLGS                                                  09820000
DARGDTM  EQU   DARGARY+4                                                09821000
DARGPCT  EQU   DARGINL                                                  09822000
DARGREP  EQU   DARGINS                                                  09823000
@NM00020 EQU   DARGFLGS                                                 09824000
DARGFULL EQU   DARGFLGS                                                 09825000
DARGIND  EQU   DARGLIST+18                                              09826000
DARGRETL EQU   DARGLIST+16                                              09827000
DARGCNT  EQU   DARGLIST+14                                              09828000
DARGRETP EQU   DARGLIST+4                                               09829000
UVOLVOL  EQU   UVOLENT+4                                                09830000
UVOLDEV  EQU   UVOLENT                                                  09831000
UVOLCNT  EQU   UVOLLIST                                                 09832000
@NM00019 EQU   IOINFOPT                                                 09833000
IOINFLUB EQU   IOINFOPT                                                 09834000
IOINFTMS EQU   IOINFOPT                                                 09835000
IOINFSUP EQU   IOINFOPT                                                 09836000
IOINFDSN EQU   IOINFOPT                                                 09837000
IOINFVOL EQU   IOINFOPT                                                 09838000
IOINFDVT EQU   IOINFOPT                                                 09839000
OPNVOL   EQU   OPNAGL+44                                                09840000
OPNSTRNO EQU   OPNAGL+43                                                09841000
@NM00018 EQU   OPNOPT2                                                  09842000
OPNOPTJM EQU   OPNOPT2                                                  09843000
OPNOPTNM EQU   OPNOPT2                                                  09844000
OPNOPTAS EQU   OPNOPT2                                                  09845000
@NM00017 EQU   OPNDSO                                                   09846000
OPNDSOPO EQU   OPNDSO                                                   09847000
OPNDSOIS EQU   OPNDSO                                                   09848000
OPNDSOPS EQU   OPNDSO                                                   09849000
OPNDSOAM EQU   OPNDSO                                                   09850000
OPNKYL   EQU   OPNAGL+40                                                09851000
OPNBLK   EQU   OPNAGL+36                                                09852000
OPNREC   EQU   OPNAGL+32                                                09853000
OPNDEVIX EQU   OPNDEV+4                                                 09854000
OPNDEVDT EQU   OPNDEV                                                   09855000
OPNCBP   EQU   OPNAGL+20                                                09856000
OPNDSN   EQU   OPNAGL+16                                                09857000
OPNPWA   EQU   OPNAGL+12                                                09858000
OPNDDN   EQU   OPNAGL+8                                                 09859000
OPNIOC   EQU   OPNAGL+4                                                 09860000
OPNMODRP EQU   OPNMOD                                                   09861000
OPNMODUB EQU   OPNMOD                                                   09862000
OPNMODRS EQU   OPNMOD                                                   09863000
OPNMODAX EQU   OPNMOD                                                   09864000
OPNMODRR EQU   OPNMOD                                                   09865000
OPNMODRC EQU   OPNMOD                                                   09866000
OPNMODAC EQU   OPNMOD                                                   09867000
OPNMODPD EQU   OPNMOD                                                   09868000
OPNTYPSY EQU   OPNTYP                                                   09869000
OPNTYPRV EQU   OPNTYP                                                   09870000
OPNTYPEX EQU   OPNTYP                                                   09871000
OPNTYPRA EQU   OPNTYP                                                   09872000
OPNTYPXM EQU   OPNTYP                                                   09873000
OPNTYPCI EQU   OPNTYP                                                   09874000
OPNTYPSO EQU   OPNTYP                                                   09875000
OPNTYPSI EQU   OPNTYP                                                   09876000
@NM00016 EQU   OPNRFM                                                   09877000
OPNRFMBK EQU   OPNRFM                                                   09878000
OPNRFMSF EQU   OPNRFM                                                   09879000
OPNRFMUN EQU   OPNRFM                                                   09880000
OPNRFMVR EQU   OPNRFM                                                   09881000
OPNRFMFX EQU   OPNRFM                                                   09882000
OPNOPTSK EQU   OPNOPT                                                   09883000
OPNOPTDR EQU   OPNOPT                                                   09884000
OPNOPTCR EQU   OPNOPT                                                   09885000
OPNOPTKS EQU   OPNOPT                                                   09886000
OPNOPTBK EQU   OPNOPT                                                   09887000
OPNOPTUP EQU   OPNOPT                                                   09888000
OPNOPTOT EQU   OPNOPT                                                   09889000
OPNOPTIN EQU   OPNOPT                                                   09890000
IOCEXT   EQU   IOCSTR+64                                                09891000
IOCTSML  EQU   IOCREL+2                                                 09892000
IOCTPML  EQU   IOCREL                                                   09893000
IOCWORK  EQU   IOCSTR+56                                                09894000
IOCRRN   EQU   IOCSTR+52                                                09895000
IOCPNM   EQU   IOCNWM+2                                                 09896000
IOCPTL   EQU   IOCNWM                                                   09897000
IOCKYA   EQU   IOCMEM                                                   09898000
IOCVRC   EQU   IOCTTR                                                   09899000
IOCCBP   EQU   IOCSTR+36                                                09900000
IOCDSN   EQU   IOCSTR+32                                                09901000
IOCHURBA EQU   IOCSTR+28                                                09902000
IOCVOLSR EQU   IOCSTR+22                                                09903000
@NM00015 EQU   IOCMSG                                                   09904000
IOCMSGSM EQU   IOCMSG                                                   09905000
IOCMSGAE EQU   IOCMSG                                                   09906000
IOCMSGCE EQU   IOCMSG                                                   09907000
IOCMSGOE EQU   IOCMSG                                                   09908000
IOCMSGOP EQU   IOCMSG                                                   09909000
IOCCHPKG EQU   IOCMSG                                                   09910000
IOCCHPKE EQU   IOCMSG                                                   09911000
IOCCHPNU EQU   IOCCHP                                                   09912000
IOCCHPUP EQU   IOCCHP                                                   09913000
IOCCHPBK EQU   IOCCHP                                                   09914000
IOCCHPCR EQU   IOCCHP                                                   09915000
IOCCHPKS EQU   IOCCHP                                                   09916000
IOCCHPSK EQU   IOCCHP                                                   09917000
IOCCHPDR EQU   IOCCHP                                                   09918000
IOCCHPSQ EQU   IOCCHP                                                   09919000
IOCMACNT EQU   IOCMAC2                                                  09920000
IOCMACER EQU   IOCMAC2                                                  09921000
IOCMACPA EQU   IOCMAC2                                                  09922000
IOCMACEN EQU   IOCMAC2                                                  09923000
IOCMACCP EQU   IOCMAC2                                                  09924000
IOCMACRR EQU   IOCMAC2                                                  09925000
IOCMACAS EQU   IOCMAC2                                                  09926000
IOCMACSK EQU   IOCMAC2                                                  09927000
@NM00014 EQU   IOCMAC                                                   09928000
IOCMACCC EQU   IOCMAC                                                   09929000
IOCMACDR EQU   IOCMAC                                                   09930000
IOCMACBK EQU   IOCMAC                                                   09931000
IOCMACCR EQU   IOCMAC                                                   09932000
IOCMACUP EQU   IOCMAC                                                   09933000
IOCMACOT EQU   IOCMAC                                                   09934000
IOCMACIN EQU   IOCMAC                                                   09935000
@NM00013 EQU   IOCRFM                                                   09936000
IOCRFMBK EQU   IOCRFM                                                   09937000
IOCRFMSF EQU   IOCRFM                                                   09938000
IOCRFMUN EQU   IOCRFM                                                   09939000
IOCRFMVR EQU   IOCRFM                                                   09940000
IOCRFMFX EQU   IOCRFM                                                   09941000
@NM00012 EQU   IOCDSO                                                   09942000
IOCDSOPO EQU   IOCDSO                                                   09943000
IOCDSOIS EQU   IOCDSO                                                   09944000
IOCDSOPS EQU   IOCDSO                                                   09945000
IOCDSOAM EQU   IOCDSO                                                   09946000
IOCRKP   EQU   IOCSTR+13                                                09947000
IOCKYL   EQU   IOCSTR+12                                                09948000
IOCTRN   EQU   IOCSTR+8                                                 09949000
IOCDLN   EQU   IOCSTR+4                                                 09950000
IOCDAD   EQU   IOCSTR                                                   09951000
UNITVTOC EQU   UNITABL+7                                                09952000
@NM00011 EQU   UNITSTAT                                                 09953000
UNITUSHR EQU   UNITSTAT                                                 09954000
UNITXSHR EQU   UNITSTAT                                                 09955000
UNITISHR EQU   UNITSTAT                                                 09956000
UNITUA   EQU   @NM00010+1                                               09957000
UNITCHA  EQU   @NM00010                                                 09958000
UNITUCB  EQU   UNITABL                                                  09959000
@NM00009 EQU   ALLOPT                                                   09960000
@NM00008 EQU   ALLORG+1                                                 09961000
ALLORGVS EQU   ALLORG+1                                                 09962000
@NM00007 EQU   ALLORG+1                                                 09963000
ALLORGGS EQU   ALLORG+1                                                 09964000
ALLORGUN EQU   ALLORG                                                   09965000
ALLORGPO EQU   ALLORG                                                   09966000
ALLORGMQ EQU   ALLORG                                                   09967000
ALLORGCQ EQU   ALLORG                                                   09968000
ALLORGCX EQU   ALLORG                                                   09969000
ALLORGDA EQU   ALLORG                                                   09970000
ALLORGPS EQU   ALLORG                                                   09971000
ALLORGIS EQU   ALLORG                                                   09972000
ALLDSPUN EQU   ALLDSP                                                   09973000
ALLDSPCG EQU   ALLDSP                                                   09974000
ALLDSPDE EQU   ALLDSP                                                   09975000
ALLDSPKP EQU   ALLDSP                                                   09976000
@NM00006 EQU   ALLDSP                                                   09977000
ALLSTSOD EQU   ALLSTS                                                   09978000
ALLSTSMD EQU   ALLSTS                                                   09979000
ALLSTSNW EQU   ALLSTS                                                   09980000
ALLSTSSR EQU   ALLSTS                                                   09981000
@NM00005 EQU   ALLSTS                                                   09982000
@NM00004 EQU   CIRAGL+1                                                 09983000
@NM00003 EQU   CIRTYPE                                                  09984000
NEWID1   EQU   TRACE1+95                                                09985000
CALLID   EQU   OLDERID1+90                                              09986000
@NM00002 EQU   OLDERID1                                                 09987000
GDTCMB   EQU   GDTTBL+176                                               09988000
GDTSPR   EQU   GDTTBL+168                                               09989000
@NM00001 EQU   GDTTBL+160                                               09990000
GDTTOH   EQU   GDTTBL+120                                               09991000
GDTRIP   EQU   GDTTBL+116                                               09992000
GDTIOH   EQU   GDTTBL+36                                                09993000
GDTTPH   EQU   GDTTBL+28                                                09994000
GDTRIH   EQU   GDTTBL+24                                                09995000
GDTSTH   EQU   GDTTBL+20                                                09996000
GDTDBH   EQU   GDTTBL+16                                                09997000
GDTPRM   EQU   GDTTBL+4                                                 09998000
GDTHDR   EQU   GDTTBL                                                   09999000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      10000000
@RC00298 EQU   @RC00294                                                 10001000
@RC00355 EQU   @RC00345                                                 10002000
@RF00372 EQU   @RC00363                                                 10003000
@RF00387 EQU   @RC00363                                                 10004000
@RC00385 EQU   @RC00363                                                 10005000
@RC00486 EQU   @RC00476                                                 10006000
@RF00552 EQU   @RC00494                                                 10007000
@RC00565 EQU   @RC00494                                                 10008000
@RC00893 EQU   @RC00890                                                 10009000
@RF01086 EQU   @RC01060                                                 10010000
@RF01133 EQU   @RC01131                                                 10011000
@RC01152 EQU   @RC01001                                                 10012000
@RC01346 EQU   @RC01344                                                 10013000
@RC01374 EQU   @RC01372                                                 10014000
@RC01501 EQU   @RC01489                                                 10015000
@RC01504 EQU   @RC01489                                                 10016000
@RC01558 EQU   @RC01556                                                 10017000
@RC01561 EQU   @RC01556                                                 10018000
@RF01564 EQU   @RC01556                                                 10019000
@RC01762 EQU   @RC01756                                                 10020000
@RT01749 EQU   @EL00004                                                 10021000
@PB00004 EQU   @PB00005                                                 10022000
@RT01823 EQU   @EL00005                                                 10023000
@RC01182 EQU   @RC01152                                                 10024000
@PB00003 EQU   @PB00004                                                 10025000
@PB00002 EQU   @PB00003                                                 10026000
@ENDDATA EQU   *                                                        10027000
         END   IDCSA02,(C'PLS1646',0701,78171)                          10028000
