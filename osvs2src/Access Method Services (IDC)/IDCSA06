SA06     TITLE '**********  IDCSA06:  UMSSUNIT SYSTEM ADAPTER  *********00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCSA06  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCSA06   76.231'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @09,0                                               0002 00021000
@PSTART  LA    @10,4095(,@09)                                      0002 00022000
         LA    @12,4095(,@10)                                      0002 00023000
         USING @PSTART,@09                                         0002 00024000
         USING @PSTART+4095,@10                                    0002 00025000
         USING @PSTART+8190,@12                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @11,@01                                             0002 00029000
         USING @DATD,@11                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @11,8(,@13)                                         0002 00033000
         LR    @13,@11                                             0002 00034000
         MVC   @PC00001(12),0(@01)                                 0002 00035000
JSCBDISP EQU 188                                                        00036000
JSCBAOS1 EQU  72                                                        00037000
JSCBAOS2 EQU 192                                                        00038000
*   OLDERID2=NEWERID2;                                             0307 00039000
         L     @08,@PC00001                                        0307 00040000
         L     @04,GDTTR2(,@08)                                    0307 00041000
         MVC   @TS00001(95),NEWERID2(@04)                          0307 00042000
         MVC   OLDERID2(95,@04),@TS00001                           0307 00043000
*   NEWID2='SA06';                  /*                       #Y30LB37*/ 00044000
         MVC   NEWID2(4,@04),@CC02523                              0308 00045000
*   IF GDTDBG=NULLPTR THEN                                         0309 00046000
         L     @08,GDTDBG(,@08)                                    0309 00047000
         LTR   @08,@08                                             0309 00048000
         BZ    @RT00309                                            0309 00049000
*     ;                                                            0310 00050000
*   ELSE                                                           0311 00051000
*     CALL IDCDB010(GDTTBL,'SAIN'); /*                       #Y30LB37*/ 00052000
         L     @08,@PC00001                                        0311 00053000
         ST    @08,@AL00001                                        0311 00054000
         LA    @04,@CC02620                                        0311 00055000
         ST    @04,@AL00001+4                                      0311 00056000
         MVI   @AL00001+4,X'80'                                    0311 00057000
         L     @15,GDTDBG(,@08)                                    0311 00058000
         LA    @01,@AL00001                                        0311 00059000
         BALR  @14,@15                                             0311 00060000
*   RETCODE=0;                      /* INITIALIZE RETURN CODE      0312 00061000
*                                                            #Y30LB37*/ 00062000
@RT00309 SLR   @08,@08                                             0312 00063000
         STH   @08,RETCODE                                         0312 00064000
*   DDSTRU=ADDR(PRINTARG);          /* INIT UPRINT ARGLPTR   #Y30LB37*/ 00065000
         LA    @08,PRINTARG                                        0313 00066000
         ST    @08,DDSTRU                                          0313 00067000
*   PRINTARG=''B;                   /* CLEAR PRINTARG BLOCK  #Y30LB37*/ 00068000
         XC    PRINTARG(52),PRINTARG                               0314 00069000
*   UNITPTR=ADDR(UNITAREA);         /* INIT UNITABL PTR      #Y30LB37*/ 00070000
         LA    @08,UNITAREA                                        0315 00071000
         ST    @08,UNITPTR                                         0315 00072000
*   UNITABL=''B;                    /* CLEAR UNITABL OUTPUT  #Y30LB37*/ 00073000
         XC    UNITABL(11,@08),UNITABL(@08)                        0316 00074000
*   MNTSTATS=''B;                   /* CLEAR MOUNT STATUS    #Y30LB37*/ 00075000
         XC    MNTSTATS(8),MNTSTATS                                0317 00076000
*   SA06SWS=''B;                    /* CLEAR PROGRAM SWITCHES      0318 00077000
*                                                            @YD00175*/ 00078000
*                                                                  0318 00079000
         MVI   SA06SWS,X'00'                                       0318 00080000
*   /*****************************************************************/ 00081000
*   /*                                                               */ 00082000
*   /* PUT THE ADDRESS OF THE CALLER'S ARGUMENT LIST INTO    #Y30LB37*/ 00083000
*   /* ARGLPTR AND MOVE THE CALLER'S REQUEST KEYWORD INTO    #Y30LB37*/ 00084000
*   /* THE FIRST 8 BYTES OF THE ARGUMENT LIST AS A HEADER.   #Y30LB37*/ 00085000
*   /*                                                               */ 00086000
*   /*****************************************************************/ 00087000
*                                                                  0319 00088000
*   ARGLPTR=ADDR(ARGLIST);          /* INIT ARGLIST PTR      #Y30LB37*/ 00089000
         L     @08,@PC00001+8                                      0319 00090000
         ST    @08,ARGLPTR                                         0319 00091000
*   ARGNAME=REQUEST;                /* MOVE IN REQUEST       #Y30LB37*/ 00092000
         L     @04,@PC00001+4                                      0320 00093000
         MVC   ARGNAME(8,@08),REQUEST(@04)                         0320 00094000
*                                                                  0321 00095000
*   /*****************************************************************/ 00096000
*   /*                                                               */ 00097000
*   /* DETERMINE IF A USYSINFO MACRO SHOULD BE ISSUED        #Y30LB37*/ 00098000
*   /* BY INTERROGATING THE UCB POINTER OF THE ARGLIST.      #Y30LB37*/ 00099000
*   /* IF ZEROS ISSUE USYSINFO TO GET UCB POINTER AND PUT    #Y30LB37*/ 00100000
*   /* THE UCB ADDRESS INTO THE CALLER'S UCB ADDRESS AREA.   #Y30LB37*/ 00101000
*   /* IF THE REQUEST IS CHECK AND NO FLAGS ARE SET THEN     #Y30LB37*/ 00102000
*   /* SET AN INVALID REQUEST TO CAUSE A UABORT IN THE NEXT  #Y30LB37*/ 00103000
*   /* STEP WHERE THE REQUEST IS CHECKED TO BE VALID.        #Y30LB37*/ 00104000
*   /*                                                               */ 00105000
*   /*****************************************************************/ 00106000
*                                                                  0321 00107000
*   IF REQUEST=MOUNT|REQUEST=DEMOUNT THEN                          0321 00108000
         CLC   REQUEST(8,@04),MOUNT                                0321 00109000
         BE    @RT00321                                            0321 00110000
         CLC   REQUEST(8,@04),DEMOUNT                              0321 00111000
         BNE   @RF00321                                            0321 00112000
@RT00321 DS    0H                                                  0322 00113000
*     DO;                           /*                       #Y30LB37*/ 00114000
*       RFY                                                        0323 00115000
*         MDAGL BASED(ARGLPTR);     /*                       #Y30LB37*/ 00116000
*       IF MDUCBADR=NULLPTR THEN                                   0324 00117000
         L     @08,ARGLPTR                                         0324 00118000
         L     @04,MDUCBPTR(,@08)                                  0324 00119000
         L     @04,MDUCBADR(,@04)                                  0324 00120000
         LTR   @04,@04                                             0324 00121000
         BNZ   @RF00324                                            0324 00122000
*         DO;                       /*                       #Y30LB37*/ 00123000
*           CALL IDCSASI0(GDTTBL,UNIT,UNITPTR,MDDDNAME);/*   #Y30LB37*/ 00124000
         L     @04,@PC00001                                        0326 00125000
         ST    @04,@AL00001                                        0326 00126000
         LA    @03,UNIT                                            0326 00127000
         ST    @03,@AL00001+4                                      0326 00128000
         LA    @03,UNITPTR                                         0326 00129000
         ST    @03,@AL00001+8                                      0326 00130000
         LA    @08,MDDDNAME(,@08)                                  0326 00131000
         ST    @08,@AL00001+12                                     0326 00132000
         MVI   @AL00001+12,X'80'                                   0326 00133000
         L     @15,GDTSFO(,@04)                                    0326 00134000
         LA    @01,@AL00001                                        0326 00135000
         BALR  @14,@15                                             0326 00136000
*           RESPECIFY                                              0327 00137000
*             RTNREG RSTD;                                         0327 00138000
*           TESTRC=RTNREG;                                         0328 00139000
         LR    TESTRC,RTNREG                                       0328 00140000
*           RESPECIFY                                              0329 00141000
*             RTNREG UNRSTD;        /*                       #Y30LB37*/ 00142000
*           RETCODE=TESTRC;         /*                       #Y30LB37*/ 00143000
         STH   TESTRC,RETCODE                                      0330 00144000
*           IF RETCODE=0 THEN                                      0331 00145000
         LH    @08,RETCODE                                         0331 00146000
         LTR   @08,@08                                             0331 00147000
         BNZ   @RF00331                                            0331 00148000
*             MDUCBADR=UNITUCB;     /*                       #Y30LB37*/ 00149000
         L     @08,ARGLPTR                                         0332 00150000
         L     @08,MDUCBPTR(,@08)                                  0332 00151000
         L     @04,UNITPTR                                         0332 00152000
         L     @04,UNITUCB(,@04)                                   0332 00153000
         ST    @04,MDUCBADR(,@08)                                  0332 00154000
*         END;                      /*                       #Y30LB37*/ 00155000
*     END;                          /*                       #Y30LB37*/ 00156000
*   ELSE                                                           0335 00157000
*     IF REQUEST=CHECK THEN                                        0335 00158000
         B     @RC00321                                            0335 00159000
@RF00321 L     @08,@PC00001+4                                      0335 00160000
         CLC   REQUEST(8,@08),CHECK                                0335 00161000
         BNE   @RF00335                                            0335 00162000
*       DO;                         /*                       #Y30LB37*/ 00163000
*         RFY                                                      0337 00164000
*           CKAGL BASED(ARGLPTR);   /*                       #Y30LB37*/ 00165000
*         IF CKRETTYP=OFF&CKTESTVT=OFF&CKDMTABL=OFF THEN           0338 00166000
         L     @08,ARGLPTR                                         0338 00167000
         TM    CKRETTYP(@08),B'11100000'                           0338 00168000
         BNZ   @RF00338                                            0338 00169000
*           CKHEAD=CHKERROR;        /*                       #Y30LB37*/ 00170000
         MVC   CKHEAD(8,@08),CHKERROR                              0339 00171000
*         IF CKUCBADR=NULLPTR THEN                                 0340 00172000
@RF00338 L     @08,ARGLPTR                                         0340 00173000
         L     @04,CKUCBPTR(,@08)                                  0340 00174000
         L     @04,CKUCBADR(,@04)                                  0340 00175000
         LTR   @04,@04                                             0340 00176000
         BNZ   @RF00340                                            0340 00177000
*           DO;                     /*                       #Y30LB37*/ 00178000
*             CALL IDCSASI0(GDTTBL,UNIT,UNITPTR,CKDDNAME);/* #Y30LB37*/ 00179000
         L     @04,@PC00001                                        0342 00180000
         ST    @04,@AL00001                                        0342 00181000
         LA    @03,UNIT                                            0342 00182000
         ST    @03,@AL00001+4                                      0342 00183000
         LA    @03,UNITPTR                                         0342 00184000
         ST    @03,@AL00001+8                                      0342 00185000
         LA    @08,CKDDNAME(,@08)                                  0342 00186000
         ST    @08,@AL00001+12                                     0342 00187000
         MVI   @AL00001+12,X'80'                                   0342 00188000
         L     @15,GDTSFO(,@04)                                    0342 00189000
         LA    @01,@AL00001                                        0342 00190000
         BALR  @14,@15                                             0342 00191000
*             RESPECIFY                                            0343 00192000
*               RTNREG RSTD;                                       0343 00193000
*             TESTRC=RTNREG;                                       0344 00194000
         LR    TESTRC,RTNREG                                       0344 00195000
*             RESPECIFY                                            0345 00196000
*               RTNREG UNRSTD;      /*                       #Y30LB37*/ 00197000
*             RETCODE=TESTRC;       /*                       #Y30LB37*/ 00198000
         STH   TESTRC,RETCODE                                      0346 00199000
*             IF RETCODE=0 THEN                                    0347 00200000
         LH    @08,RETCODE                                         0347 00201000
         LTR   @08,@08                                             0347 00202000
         BNZ   @RF00347                                            0347 00203000
*               CKUCBADR=UNITUCB;   /*                       #Y30LB37*/ 00204000
         L     @08,ARGLPTR                                         0348 00205000
         L     @08,CKUCBPTR(,@08)                                  0348 00206000
         L     @04,UNITPTR                                         0348 00207000
         L     @04,UNITUCB(,@04)                                   0348 00208000
         ST    @04,CKUCBADR(,@08)                                  0348 00209000
*           END;                    /*                       #Y30LB37*/ 00210000
*       END;                        /*                       #Y30LB37*/ 00211000
*                                                                  0351 00212000
*   /*****************************************************************/ 00213000
*   /*                                                               */ 00214000
*   /* DETERMINE IF A USYSINFO MACRO SHOULD BE ISSUED        @YD00175*/ 00215000
*   /* BY INTERROGATING THE UCB POINTER OF THE EXCLAGL.      @YD00175*/ 00216000
*   /* IF ZEROS ISSUE USYSINFO TO GET UCB POINTER AND PUT    @YD00175*/ 00217000
*   /* THE UCB ADDRESS INTO THE CALLER'S UCB ADDRESS AREA.   @YD00175*/ 00218000
*   /*                                                               */ 00219000
*   /*****************************************************************/ 00220000
*                                                                  0351 00221000
*     ELSE                                                         0351 00222000
*       IF REQUEST=CHANGEX THEN                                    0351 00223000
         B     @RC00335                                            0351 00224000
@RF00335 L     @08,@PC00001+4                                      0351 00225000
         CLC   REQUEST(8,@08),CHANGEX                              0351 00226000
         BNE   @RF00351                                            0351 00227000
*         DO;                       /*                       @YD00175*/ 00228000
*           RFY                                                    0353 00229000
*             EXCLAGL BASED(ARGLPTR);/*                      @YD00175*/ 00230000
*           IF EXUCBADR=NULLPTR THEN                               0354 00231000
         L     @08,ARGLPTR                                         0354 00232000
         L     @04,EXCLUCBP(,@08)                                  0354 00233000
         L     @04,EXUCBADR(,@04)                                  0354 00234000
         LTR   @04,@04                                             0354 00235000
         BNZ   @RF00354                                            0354 00236000
*             DO;                   /*                       @YD00175*/ 00237000
*               CALL IDCSASI0(GDTTBL,UNIT,UNITPTR,EXDDNAME);/*     0356 00238000
*                                                            @YD00175*/ 00239000
         L     @04,@PC00001                                        0356 00240000
         ST    @04,@AL00001                                        0356 00241000
         LA    @03,UNIT                                            0356 00242000
         ST    @03,@AL00001+4                                      0356 00243000
         LA    @03,UNITPTR                                         0356 00244000
         ST    @03,@AL00001+8                                      0356 00245000
         L     @08,EXCLDDP(,@08)                                   0356 00246000
         ST    @08,@AL00001+12                                     0356 00247000
         MVI   @AL00001+12,X'80'                                   0356 00248000
         L     @15,GDTSFO(,@04)                                    0356 00249000
         LA    @01,@AL00001                                        0356 00250000
         BALR  @14,@15                                             0356 00251000
*               RESPECIFY                                          0357 00252000
*                 RTNREG RSTD;                                     0357 00253000
*               TESTRC=RTNREG;                                     0358 00254000
         LR    TESTRC,RTNREG                                       0358 00255000
*               RESPECIFY                                          0359 00256000
*                 RTNREG UNRSTD;    /*                       @YD00175*/ 00257000
*               RETCODE=TESTRC;     /*                       @YD00175*/ 00258000
         STH   TESTRC,RETCODE                                      0360 00259000
*               IF RETCODE=0 THEN                                  0361 00260000
         LH    @08,RETCODE                                         0361 00261000
         LTR   @08,@08                                             0361 00262000
         BNZ   @RF00361                                            0361 00263000
*                 EXUCBADR=UNITUCB; /*                       @YD00175*/ 00264000
         L     @08,ARGLPTR                                         0362 00265000
         L     @08,EXCLUCBP(,@08)                                  0362 00266000
         L     @04,UNITPTR                                         0362 00267000
         L     @04,UNITUCB(,@04)                                   0362 00268000
         ST    @04,EXUCBADR(,@08)                                  0362 00269000
*             END;                  /*                       @YD00175*/ 00270000
@RF00361 DS    0H                                                  0364 00271000
*         END;                      /*                       @YD00175*/ 00272000
@RF00354 DS    0H                                                  0365 00273000
*                                                                  0365 00274000
*   /*****************************************************************/ 00275000
*   /*                                                               */ 00276000
*   /* DETERMINE REQUEST PASSED BY THE CALLER AND CALL THE   #Y30LB37*/ 00277000
*   /* APPROPRIATE ROUTINE TO PROCESS THE REQUEST OR UABORT  #Y30LB37*/ 00278000
*   /* IF AN INVALID REQUEST OR CKECK FLAGS NOT SPECIFIED.   #Y30LB37*/ 00279000
*   /*                                                               */ 00280000
*   /*****************************************************************/ 00281000
*                                                                  0365 00282000
*   IF RETCODE=0 THEN               /* WAS USYSINFO GOOD - 0 #Y30LB37*/ 00283000
@RF00351 DS    0H                                                  0365 00284000
@RC00335 DS    0H                                                  0365 00285000
@RC00321 LH    @08,RETCODE                                         0365 00286000
         LTR   @08,@08                                             0365 00287000
         BNZ   @RF00365                                            0365 00288000
*     DO;                           /*                       #Y30LB37*/ 00289000
*       IF REQUEST=CHECK&CKHEAD^=CHKERROR THEN                     0367 00290000
         L     @08,@PC00001+4                                      0367 00291000
         CLC   REQUEST(8,@08),CHECK                                0367 00292000
         BNE   @RF00367                                            0367 00293000
         L     @08,ARGLPTR                                         0367 00294000
         CLC   CKHEAD(8,@08),CHKERROR                              0367 00295000
         BE    @RF00367                                            0367 00296000
*         CALL UCBCHECK(ARGLPTR);   /*                       #Y30LB37*/ 00297000
         LA    @08,ARGLPTR                                         0368 00298000
         ST    @08,@AL00001                                        0368 00299000
         LA    @01,@AL00001                                        0368 00300000
         BAL   @14,UCBCHECK                                        0368 00301000
*       ELSE                                                       0369 00302000
*         IF REQUEST=POSTUCB THEN                                  0369 00303000
         B     @RC00367                                            0369 00304000
@RF00367 L     @08,@PC00001+4                                      0369 00305000
         CLC   REQUEST(8,@08),POSTUCB                              0369 00306000
         BNE   @RF00369                                            0369 00307000
*           CALL UCBPOST(POST,ARGLPTR);/*                    #Y30LB37*/ 00308000
         LA    @08,POST                                            0370 00309000
         ST    @08,@AL00001                                        0370 00310000
         LA    @08,ARGLPTR                                         0370 00311000
         ST    @08,@AL00001+4                                      0370 00312000
         LA    @01,@AL00001                                        0370 00313000
         BAL   @14,UCBPOST                                         0370 00314000
*         ELSE                                                     0371 00315000
*           IF REQUEST=MOUNT|REQUEST=DEMOUNT THEN                  0371 00316000
         B     @RC00369                                            0371 00317000
@RF00369 L     @08,@PC00001+4                                      0371 00318000
         CLC   REQUEST(8,@08),MOUNT                                0371 00319000
         BE    @RT00371                                            0371 00320000
         CLC   REQUEST(8,@08),DEMOUNT                              0371 00321000
         BNE   @RF00371                                            0371 00322000
@RT00371 DS    0H                                                  0372 00323000
*             CALL MDSETUP(ARGLPTR);/*                       #Y30LB37*/ 00324000
         LA    @08,ARGLPTR                                         0372 00325000
         ST    @08,@AL00001                                        0372 00326000
         LA    @01,@AL00001                                        0372 00327000
         BAL   @14,MDSETUP                                         0372 00328000
*           ELSE                                                   0373 00329000
*             IF REQUEST=SELECTX THEN                              0373 00330000
         B     @RC00371                                            0373 00331000
@RF00371 L     @08,@PC00001+4                                      0373 00332000
         CLC   REQUEST(8,@08),SELECTX                              0373 00333000
         BNE   @RF00373                                            0373 00334000
*               CALL FINDEXCL(ARGLPTR);/*                    @YD00175*/ 00335000
         LA    @08,ARGLPTR                                         0374 00336000
         ST    @08,@AL00001                                        0374 00337000
         LA    @01,@AL00001                                        0374 00338000
         BAL   @14,FINDEXCL                                        0374 00339000
*             ELSE                                                 0375 00340000
*               IF REQUEST=CHANGEX THEN                            0375 00341000
         B     @RC00373                                            0375 00342000
@RF00373 L     @08,@PC00001+4                                      0375 00343000
         CLC   REQUEST(8,@08),CHANGEX                              0375 00344000
         BNE   @RF00375                                            0375 00345000
*                 CALL GETEXCL(ARGLPTR);/*                   @YD00175*/ 00346000
         LA    @08,ARGLPTR                                         0376 00347000
         ST    @08,@AL00001                                        0376 00348000
         LA    @01,@AL00001                                        0376 00349000
         BAL   @14,GETEXCL                                         0376 00350000
*               ELSE                                               0377 00351000
*                 IF REQUEST=SELECTDD THEN                         0377 00352000
         B     @RC00375                                            0377 00353000
@RF00375 L     @08,@PC00001+4                                      0377 00354000
         CLC   REQUEST(8,@08),SELECTDD                             0377 00355000
         BNE   @RF00377                                            0377 00356000
*                   CALL SELECTD(ARGLPTR);/*                 @Z40LB37*/ 00357000
         LA    @08,ARGLPTR                                         0378 00358000
         ST    @08,@AL00001                                        0378 00359000
         LA    @01,@AL00001                                        0378 00360000
         BAL   @14,SELECTD                                         0378 00361000
*                 ELSE                                             0379 00362000
*                   DO;                                            0379 00363000
         B     @RC00377                                            0379 00364000
@RF00377 DS    0H                                                  0380 00365000
*                     RESPECIFY                                    0380 00366000
*                      (REG13,                                     0380 00367000
*                       REG14,                                     0380 00368000
*                       REG15) RSTD;                               0380 00369000
*                     REG15=40;                                    0381 00370000
         LA    REG15,40                                            0381 00371000
*                     REG14=GDTABT;                                0382 00372000
         L     @08,@PC00001                                        0382 00373000
         L     REG14,GDTABT(,@08)                                  0382 00374000
*                     REG13=GDTABH;                                0383 00375000
         L     REG13,GDTABH(,@08)                                  0383 00376000
*                     GEN(BR    REG14);                            0384 00377000
         BR    REG14                                                    00378000
*                     RESPECIFY                                    0385 00379000
*                      (REG13,                                     0385 00380000
*                       REG14,                                     0385 00381000
*                       REG15) UNRSTD;                             0385 00382000
*                   END;            /* ISSUE UABORT FOR BAD  @YD00175   00383000
*                                      ARGUMENT LIST         #Y30LB37*/ 00384000
*       RESPECIFY                                                  0387 00385000
*         RTNREG RSTD;                                             0387 00386000
@RC00377 DS    0H                                                  0387 00387000
@RC00375 DS    0H                                                  0387 00388000
@RC00373 DS    0H                                                  0387 00389000
@RC00371 DS    0H                                                  0387 00390000
@RC00369 DS    0H                                                  0387 00391000
@RC00367 DS    0H                                                  0388 00392000
*       TESTRC=RTNREG;                                             0388 00393000
         LR    TESTRC,RTNREG                                       0388 00394000
*       RESPECIFY                                                  0389 00395000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 00396000
*       IF TESTRC^=LASTCC00 THEN                                   0390 00397000
         LTR   TESTRC,TESTRC                                       0390 00398000
         BZ    @RF00390                                            0390 00399000
*         RETCODE=TESTRC;           /*                       #Y30LB37*/ 00400000
         STH   TESTRC,RETCODE                                      0391 00401000
*     END;                          /*                       #Y30LB37*/ 00402000
@RF00390 DS    0H                                                  0393 00403000
*                                                                  0393 00404000
*   /*****************************************************************/ 00405000
*   /*                                                               */ 00406000
*   /* RETURN TO THE CALLER OF THIS SYSTEM ADAPTER           #Y30LB37*/ 00407000
*   /*                                                               */ 00408000
*   /*****************************************************************/ 00409000
*                                                                  0393 00410000
*   IF GDTDBG=NULLPTR THEN                                         0393 00411000
@RF00365 L     @08,@PC00001                                        0393 00412000
         L     @08,GDTDBG(,@08)                                    0393 00413000
         LTR   @08,@08                                             0393 00414000
         BZ    @RT00393                                            0393 00415000
*     ;                                                            0394 00416000
*   ELSE                                                           0395 00417000
*     CALL IDCDB010(GDTTBL,'SAEX'); /* UDUMP EXIT            #Y30LB37*/ 00418000
         L     @08,@PC00001                                        0395 00419000
         ST    @08,@AL00001                                        0395 00420000
         LA    @15,@CC02632                                        0395 00421000
         ST    @15,@AL00001+4                                      0395 00422000
         MVI   @AL00001+4,X'80'                                    0395 00423000
         L     @15,GDTDBG(,@08)                                    0395 00424000
         LA    @01,@AL00001                                        0395 00425000
         BALR  @14,@15                                             0395 00426000
*   CALL IDCSAEP0(GDTTBL,MODID,RETCODE);/* RETURN            #Y30LB37*/ 00427000
@RT00393 L     @08,@PC00001                                        0396 00428000
         ST    @08,@AL00001                                        0396 00429000
         LA    @15,MODID                                           0396 00430000
         ST    @15,@AL00001+4                                      0396 00431000
         LA    @15,RETCODE                                         0396 00432000
         ST    @15,@AL00001+8                                      0396 00433000
         MVI   @AL00001+8,X'80'                                    0396 00434000
         L     @15,GDTEPL(,@08)                                    0396 00435000
         LA    @01,@AL00001                                        0396 00436000
         BALR  @14,@15                                             0396 00437000
*                                                                  0397 00438000
*/********************************************************************/ 00439000
*/*                                                                  */ 00440000
*/*  PROCEDURE NAME - UCBCHECK                               #Y30LB37*/ 00441000
*/*                                                          #Y30LB37*/ 00442000
*/*  FUNCTION - THIS PROCEDURE CHECKS THE UCB INFORMATION    #Y30LB37*/ 00443000
*/*             TO DETERMINE IF THE UCB IS REAL OR VIRT-     #Y30LB37*/ 00444000
*/*             UAL OR THE UCB IS DEMOUNTABLE.  UCBCHECK     @Z40LB37*/ 00445000
*/*             ISSUES ERROR MESSAGES IDC3380I, IDC3383I     @Z40LB37*/ 00446000
*/*             AND IDC3384I FOR NEGATIVE RESULTS.           @YD00175*/ 00447000
*/*                                                          #Y30LB37*/ 00448000
*/*  INPUT - THE INFORMATION RETRIEVED IF A USYSINFO WAS     #Y30LB37*/ 00449000
*/*          ISSUED AND THE UCBCHECK ARGUMENT LIST WITH      #Y30LB37*/ 00450000
*/*          THE UCB INFORMATION AND REQUEST FLAGS.          #Y30LB37*/ 00451000
*/*                                                          #Y30LB37*/ 00452000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       #Y30LB37*/ 00453000
*/*          OR FOUR ERROR CODE AND/OR RETURNED INFORMA-     #Y30LB37*/ 00454000
*/*          TION ABOUT THE UCB ACCORDING TO THE INPUT       #Y30LB37*/ 00455000
*/*          REQUEST FLAGS.  IF CKRETTYP IS ON THEN RETURN   #Y30LB37*/ 00456000
*/*          EITHER 'REAL' OR 'VIRT' TO THE CALLER DEPENDING #Y30LB37*/ 00457000
*/*          ON THE DEVICE TYPE.  RETURN CODES IN REG15 ARE: #Y30LB37*/ 00458000
*/*          0 - SUCCESSFUL                                  #Y30LB37*/ 00459000
*/*          4 - CHECK REQUESTED WAS UNSUCCESSFUL            #Y30LB37*/ 00460000
*/*                                                                  */ 00461000
*/********************************************************************/ 00462000
*                                                                  0397 00463000
*UCBCHECK:                                                         0397 00464000
*   PROCEDURE(CKAGLPTR);            /*                       #Y30LB37*/ 00465000
*                                                                  0397 00466000
@EL00001 L     @13,4(,@13)                                         0397 00467000
@EF00001 L     @00,@SIZDATD                                        0397 00468000
         LR    @01,@11                                             0397 00469000
         FREEMAIN R,LV=(0),A=(1)                                        00470000
@ER00001 LM    @14,@12,12(@13)                                     0397 00471000
         BR    @14                                                 0397 00472000
UCBCHECK STM   @14,@12,@SA00002                                    0397 00473000
         MVC   @PC00002(4),0(@01)                                  0397 00474000
*   /*****************************************************************/ 00475000
*   /*                                                               */ 00476000
*   /* LOCAL DECLARATIONS FOR UCBCHECK                       #Y30LB37*/ 00477000
*   /*                                                               */ 00478000
*   /*****************************************************************/ 00479000
*                                                                  0398 00480000
*   DCL                                                            0398 00481000
*     CHECKRC FIXED(15);            /* UCBCHECK RETURN CODE  #Y30LB37*/ 00482000
*   DCL                                                            0399 00483000
*     CKAGLPTR PTR(31);             /* PTR TO CKAGL          #Y30LB37*/ 00484000
*   DCL                                                            0400 00485000
*     CKRVAREA CHAR(4) BASED(CKDATYPE);/* REAL / VIRTUAL AREA      0400 00486000
*                                                            #Y30LB37*/ 00487000
*   DCL                                                            0401 00488000
*     UNIT3330 CHAR(1) STATIC INIT('09'X);/* 3330 MODEL 1 DEVICE   0401 00489000
*                                                            #Y30LB37*/ 00490000
*   DCL                                                            0402 00491000
*     1 CHECKSWS,                   /* TEST SWITCHES         #Y30LB37*/ 00492000
*      2 NOTDASW BIT(1),            /* NOT DIRECT ACCESS     #Y30LB37*/ 00493000
*      2 NOTVTSW BIT(1),            /* NOT VIRTUAL UNIT      #Y30LB37*/ 00494000
*      2 NOTDMNT BIT(1),            /* NOT DEMOUNTABLE       @Z40LB37*/ 00495000
*      2 * BIT(5);                  /* RESERVED              @Z40LB37*/ 00496000
*                                                                  0403 00497000
*   /*****************************************************************/ 00498000
*   /*                                                               */ 00499000
*   /* INITIALIZE UCBPTR, SET CHECK SWITCHES TO ZEROS AFTER  #Y30LB37*/ 00500000
*   /* ISSUING UTRACE MACRO                                  #Y30LB37*/ 00501000
*   /*                                                               */ 00502000
*   /*****************************************************************/ 00503000
*                                                                  0403 00504000
*   RFY                                                            0403 00505000
*     CKAGL BASED(CKAGLPTR);        /* BASE CKAGL ON PARM    #Y30LB37*/ 00506000
*   OLDERID2=NEWERID2;                                             0404 00507000
         L     @08,@PC00001                                        0404 00508000
         L     @08,GDTTR2(,@08)                                    0404 00509000
         MVC   @TS00001(95),NEWERID2(@08)                          0404 00510000
         MVC   OLDERID2(95,@08),@TS00001                           0404 00511000
*   NEWID2='SACK';                  /*                       #Y30LB37*/ 00512000
         MVC   NEWID2(4,@08),@CC02648                              0405 00513000
*   UCBPTR=CKUCBADR;                /* INITIALIZE UCB PTR    #Y30LB37*/ 00514000
         L     @08,@PC00002                                        0406 00515000
         L     @08,CKAGLPTR(,@08)                                  0406 00516000
         L     @08,CKUCBPTR(,@08)                                  0406 00517000
         L     UCBPTR,CKUCBADR(,@08)                               0406 00518000
*   CHECKSWS=OFF;                   /* INITIALIZE CHECK SWS  #Y30LB37*/ 00519000
         MVI   CHECKSWS,B'00000000'                                0407 00520000
*   CHECKRC=0;                      /* INITIALIZE RETURN CODE      0408 00521000
*                                                            #Y30LB37*/ 00522000
*                                                                  0408 00523000
         SLR   CHECKRC,CHECKRC                                     0408 00524000
*   /*****************************************************************/ 00525000
*   /*                                                               */ 00526000
*   /* TEST THE UCB FOR DIRECT ACCESS AND 3330 DEVICE TYPE.  #Y30LB37*/ 00527000
*   /* SET THE NOTDASW ON IF EITHER THE UNIT IS NOT DIRECT   #Y30LB37*/ 00528000
*   /* ACCESS OR IS NOT A 3330 DEVICE TYPE.                  #Y30LB37*/ 00529000
*   /*                                                               */ 00530000
*   /*****************************************************************/ 00531000
*                                                                  0409 00532000
*   IF UCB3DACC=ON THEN                                            0409 00533000
         TM    UCB3DACC(UCBPTR),B'00100000'                        0409 00534000
         BNO   @RF00409                                            0409 00535000
*     IF UCBUNTYP^=UNIT3330 THEN                                   0410 00536000
         CLC   UCBUNTYP(1,UCBPTR),UNIT3330                         0410 00537000
         BE    @RF00410                                            0410 00538000
*       NOTDASW=ON;                 /*                       #Y30LB37*/ 00539000
         OI    NOTDASW,B'10000000'                                 0411 00540000
*     ELSE                                                         0412 00541000
*       ;                           /*                       @Y30LB37*/ 00542000
@RF00410 DS    0H                                                  0413 00543000
*   ELSE                                                           0413 00544000
*     NOTDASW=ON;                   /*                       @Y30LB37*/ 00545000
*                                                                  0413 00546000
         B     @RC00409                                            0413 00547000
@RF00409 OI    NOTDASW,B'10000000'                                 0413 00548000
*   /*****************************************************************/ 00549000
*   /*                                                               */ 00550000
*   /* TEST THE UCB FOR VIRTUAL (3330V) TYPE. SET THE NOT    @Y30LB37*/ 00551000
*   /* VIRTUAL SWITCH ON IF EITHER THE UNIT IS NOT DIRECT    @Y30LB37*/ 00552000
*   /* ACCESS OR NOT 3330 OR NOT A 3330V.                    @Y30LB37*/ 00553000
*   /*                                                               */ 00554000
*   /*****************************************************************/ 00555000
*                                                                  0414 00556000
*   IF CKTESTVT=ON THEN                                            0414 00557000
@RC00409 L     @08,@PC00002                                        0414 00558000
         L     @08,CKAGLPTR(,@08)                                  0414 00559000
         TM    CKTESTVT(@08),B'10000000'                           0414 00560000
         BNO   @RF00414                                            0414 00561000
*     IF NOTDASW=ON THEN                                           0415 00562000
         TM    NOTDASW,B'10000000'                                 0415 00563000
         BNO   @RF00415                                            0415 00564000
*       NOTVTSW=ON;                 /*                       @Y30LB37*/ 00565000
         OI    NOTVTSW,B'01000000'                                 0416 00566000
*     ELSE                                                         0417 00567000
*       IF UCBRVDEV=OFF THEN                                       0417 00568000
         B     @RC00415                                            0417 00569000
@RF00415 TM    UCBRVDEV(UCBPTR),B'00001000'                        0417 00570000
         BNZ   @RF00417                                            0417 00571000
*         NOTVTSW=ON;               /*                       @Y30LB37*/ 00572000
         OI    NOTVTSW,B'01000000'                                 0418 00573000
*                                                                  0419 00574000
*   /*****************************************************************/ 00575000
*   /*                                                               */ 00576000
*   /* TEST FOR RETURN THE REAL OR VIRTUAL (3330V) TYPE.     @Y30LB37*/ 00577000
*   /* IF REQUESTED, RETURN IN THE CALLER'S AREA, THE        @Y30LB37*/ 00578000
*   /* CHARACTERS VIRT IF THE UNIT IS A 3330V OR THE         @Y30LB37*/ 00579000
*   /* CHARACTERS REAL IF THE UNIT IS A 3330.                @Y30LB37*/ 00580000
*   /*                                                               */ 00581000
*   /*****************************************************************/ 00582000
*                                                                  0419 00583000
*   IF CKRETTYP=ON THEN                                            0419 00584000
@RF00417 DS    0H                                                  0419 00585000
@RC00415 DS    0H                                                  0419 00586000
@RF00414 L     @08,@PC00002                                        0419 00587000
         L     @08,CKAGLPTR(,@08)                                  0419 00588000
         TM    CKRETTYP(@08),B'01000000'                           0419 00589000
         BNO   @RF00419                                            0419 00590000
*     IF UCBRVDEV=ON THEN                                          0420 00591000
         TM    UCBRVDEV(UCBPTR),B'00001000'                        0420 00592000
         BNO   @RF00420                                            0420 00593000
*       CKRVAREA='VIRT';            /*                       @Y30LB37*/ 00594000
         L     @08,CKDATYPE(,@08)                                  0421 00595000
         MVC   CKRVAREA(4,@08),@CC02649                            0421 00596000
*     ELSE                                                         0422 00597000
*       CKRVAREA='REAL';            /*                       @Y30LB37*/ 00598000
*                                                                  0422 00599000
         B     @RC00420                                            0422 00600000
@RF00420 L     @08,@PC00002                                        0422 00601000
         L     @08,CKAGLPTR(,@08)                                  0422 00602000
         L     @08,CKDATYPE(,@08)                                  0422 00603000
         MVC   CKRVAREA(4,@08),@CC02650                            0422 00604000
*   /*****************************************************************/ 00605000
*   /*                                                               */ 00606000
*   /* TEST IF THE CKDMTABL FLAG IS ON. IF SO, CHECK         @Z40LB37*/ 00607000
*   /* IF THE UCB IS DEMOUNTABLE. IF THE UCB IS NOT          @Z40LB37*/ 00608000
*   /* DEMOUNTABLE THEN SET THE NOTDMNT FLAG ON, ELSE        @Z40LB37*/ 00609000
*   /* SET THE NOTDMNT FLAG OFF.                             @Z40LB37*/ 00610000
*   /*                                                               */ 00611000
*   /*****************************************************************/ 00612000
*                                                                  0423 00613000
*   IF CKDMTABL=ON THEN                                            0423 00614000
@RC00420 DS    0H                                                  0423 00615000
@RF00419 L     @08,@PC00002                                        0423 00616000
         L     @08,CKAGLPTR(,@08)                                  0423 00617000
         TM    CKDMTABL(@08),B'00100000'                           0423 00618000
         BNO   @RF00423                                            0423 00619000
*     DO;                           /*                       @Z40LB37*/ 00620000
*                                                                  0424 00621000
*       /*************************************************************/ 00622000
*       /*                                                           */ 00623000
*       /* CHECK FOR A DEMOUNTABLE UCB.                      @Z40LB37*/ 00624000
*       /*                                                           */ 00625000
*       /*************************************************************/ 00626000
*                                                                  0425 00627000
*       IF UCBBSVL=ON&UCBPRES=OFF&UCBRESV=OFF&UCBDMCT=ZERODMC THEN 0425 00628000
         TM    UCBBSVL(UCBPTR),B'10000000'                         0425 00629000
         BNO   @RF00425                                            0425 00630000
         TM    UCBPRES(UCBPTR),B'00100100'                         0425 00631000
         BNZ   @RF00425                                            0425 00632000
         CLC   UCBDMCT(1,UCBPTR),ZERODMC                           0425 00633000
         BNE   @RF00425                                            0425 00634000
*         NOTDMNT=OFF;              /*                       @Z40LB37*/ 00635000
         NI    NOTDMNT,B'11011111'                                 0426 00636000
*       ELSE                                                       0427 00637000
*         NOTDMNT=ON;               /*                       @Z40LB37*/ 00638000
         B     @RC00425                                            0427 00639000
@RF00425 OI    NOTDMNT,B'00100000'                                 0427 00640000
*     END;                          /*                       @Z40LB37*/ 00641000
@RC00425 DS    0H                                                  0429 00642000
*                                                                  0429 00643000
*   /*****************************************************************/ 00644000
*   /*                                                               */ 00645000
*   /* TEST IF RETURN TYPE WAS SPECIFIED AND UCB WAS NOT     #Y30LB37*/ 00646000
*   /* DIRECT ACCESS AND ISSUE ERROR MESSAGE IDC3384I.       #Y30LB37*/ 00647000
*   /* SET RETURN CODE TO INDICATE FAILURE.                  #Y30LB37*/ 00648000
*   /*                                                               */ 00649000
*   /*****************************************************************/ 00650000
*                                                                  0429 00651000
*   IF NOTDASW=ON&CKRETTYP=ON THEN                                 0429 00652000
@RF00423 TM    NOTDASW,B'10000000'                                 0429 00653000
         BNO   @RF00429                                            0429 00654000
         L     @08,@PC00002                                        0429 00655000
         L     @08,CKAGLPTR(,@08)                                  0429 00656000
         TM    CKRETTYP(@08),B'01000000'                           0429 00657000
         BNO   @RF00429                                            0429 00658000
*     DO;                           /*                       #Y30LB37*/ 00659000
*       CHECKRC=LASTCC04;           /*                       #Y30LB37*/ 00660000
         LA    CHECKRC,4                                           0431 00661000
*       DARGSMOD=MSGMODID;          /*                       #Y30LB37*/ 00662000
         L     @03,DDSTRU                                          0432 00663000
         MVC   DARGSMOD(3,@03),@CC02595                            0432 00664000
*       DARGSENT=MSG3384I;          /*                       #Y30LB37*/ 00665000
         MVI   DARGSENT(@03),X'04'                                 0433 00666000
*       DARGDBP=ADDR(CKDDNAME);     /*                       #Y30LB37*/ 00667000
         LA    @08,CKDDNAME(,@08)                                  0434 00668000
         ST    @08,DARGDBP(,@03)                                   0434 00669000
*       DARGILP=LENGTH(CKDDNAME);   /*                       #Y30LB37*/ 00670000
         MVC   DARGILP(2,@03),@CH00179                             0435 00671000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB37*/ 00672000
         L     @08,@PC00001                                        0436 00673000
         ST    @08,@AL00001                                        0436 00674000
         LA    @03,@CF00115                                        0436 00675000
         ST    @03,@AL00001+4                                      0436 00676000
         LA    @03,DDSTRU                                          0436 00677000
         ST    @03,@AL00001+8                                      0436 00678000
         MVI   @AL00001+8,X'80'                                    0436 00679000
         L     @15,GDTPRT(,@08)                                    0436 00680000
         LA    @01,@AL00001                                        0436 00681000
         BALR  @14,@15                                             0436 00682000
*     END;                          /*                       @Y30LB37*/ 00683000
*                                                                  0437 00684000
*   /*****************************************************************/ 00685000
*   /*                                                               */ 00686000
*   /* TEST IF CHECK VIRTUAL WAS SPECIFIED AND DEVICE IS     @Y30LB37*/ 00687000
*   /* NOT VIRTUAL AND ISSUE ERROR MESSAGE IDC3383I.         @Y30LB37*/ 00688000
*   /* SET RETURN CODE TO INDICATE FAILURE.                  @Y30LB37*/ 00689000
*   /*                                                               */ 00690000
*   /*****************************************************************/ 00691000
*                                                                  0438 00692000
*   IF NOTVTSW=ON&CKTESTVT=ON THEN                                 0438 00693000
@RF00429 TM    NOTVTSW,B'01000000'                                 0438 00694000
         BNO   @RF00438                                            0438 00695000
         L     @08,@PC00002                                        0438 00696000
         L     @08,CKAGLPTR(,@08)                                  0438 00697000
         TM    CKTESTVT(@08),B'10000000'                           0438 00698000
         BNO   @RF00438                                            0438 00699000
*     DO;                           /*                       @Y30LB37*/ 00700000
*       CHECKRC=LASTCC04;           /*                       @Y30LB37*/ 00701000
         LA    CHECKRC,4                                           0440 00702000
*       DARGSMOD=MSGMODID;          /*                       @Y30LB37*/ 00703000
         L     @03,DDSTRU                                          0441 00704000
         MVC   DARGSMOD(3,@03),@CC02595                            0441 00705000
*       DARGSENT=MSG3383I;          /*                       @Y30LB37*/ 00706000
         MVI   DARGSENT(@03),X'03'                                 0442 00707000
*       DARGDBP=ADDR(CKDDNAME);     /*                       @Y30LB37*/ 00708000
         LA    @08,CKDDNAME(,@08)                                  0443 00709000
         ST    @08,DARGDBP(,@03)                                   0443 00710000
*       DARGILP=LENGTH(CKDDNAME);   /*                       @Y30LB37*/ 00711000
         MVC   DARGILP(2,@03),@CH00179                             0444 00712000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB37*/ 00713000
         L     @08,@PC00001                                        0445 00714000
         ST    @08,@AL00001                                        0445 00715000
         LA    @03,@CF00115                                        0445 00716000
         ST    @03,@AL00001+4                                      0445 00717000
         LA    @03,DDSTRU                                          0445 00718000
         ST    @03,@AL00001+8                                      0445 00719000
         MVI   @AL00001+8,X'80'                                    0445 00720000
         L     @15,GDTPRT(,@08)                                    0445 00721000
         LA    @01,@AL00001                                        0445 00722000
         BALR  @14,@15                                             0445 00723000
*     END;                          /*                       @Y30LB37*/ 00724000
*                                                                  0447 00725000
*   /*****************************************************************/ 00726000
*   /*                                                               */ 00727000
*   /* TEST IF CHECK DEMOUNTABLE WAS SPECIFIED AND DEVICE    @Z40LB37*/ 00728000
*   /* IS NOT DEMOUNTABLE AND ISSUE ERROR MESSAGE IDC3380I.  @Z40LB37*/ 00729000
*   /* SET RETURN CODE TO INDICATE FAILURE.                  @Z40LB37*/ 00730000
*   /*                                                               */ 00731000
*   /*****************************************************************/ 00732000
*                                                                  0447 00733000
*   IF NOTDMNT=ON&CKDMTABL=ON THEN                                 0447 00734000
@RF00438 TM    NOTDMNT,B'00100000'                                 0447 00735000
         BNO   @RF00447                                            0447 00736000
         L     @08,@PC00002                                        0447 00737000
         L     @08,CKAGLPTR(,@08)                                  0447 00738000
         TM    CKDMTABL(@08),B'00100000'                           0447 00739000
         BNO   @RF00447                                            0447 00740000
*     DO;                           /*                       @Z40LB37*/ 00741000
*       CHECKRC=LASTCC04;           /*                       @Z40LB37*/ 00742000
         LA    CHECKRC,4                                           0449 00743000
*       DARGSMOD=MSGMODID;          /*                       @Z40LB37*/ 00744000
         L     @03,DDSTRU                                          0450 00745000
         MVC   DARGSMOD(3,@03),@CC02595                            0450 00746000
*       DARGSENT=MSG3380I;          /*                       @Z40LB37*/ 00747000
         MVI   DARGSENT(@03),X'0D'                                 0451 00748000
*       DARGDBP=ADDR(CKDDNAME);     /*                       @Z40LB37*/ 00749000
         LA    @08,CKDDNAME(,@08)                                  0452 00750000
         ST    @08,DARGDBP(,@03)                                   0452 00751000
*       DARGILP=LENGTH(CKDDNAME);   /*                       @Z40LB37*/ 00752000
         MVC   DARGILP(2,@03),@CH00179                             0453 00753000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB37*/ 00754000
         L     @08,@PC00001                                        0454 00755000
         ST    @08,@AL00001                                        0454 00756000
         LA    @03,@CF00115                                        0454 00757000
         ST    @03,@AL00001+4                                      0454 00758000
         LA    @03,DDSTRU                                          0454 00759000
         ST    @03,@AL00001+8                                      0454 00760000
         MVI   @AL00001+8,X'80'                                    0454 00761000
         L     @15,GDTPRT(,@08)                                    0454 00762000
         LA    @01,@AL00001                                        0454 00763000
         BALR  @14,@15                                             0454 00764000
*     END;                          /*                       @Z40LB37*/ 00765000
*                                                                  0455 00766000
*   /*****************************************************************/ 00767000
*   /*                                                               */ 00768000
*   /* SET RETURN CODE AND RETURN TO THE MAIN PROCEDURE.     #Y30LB37*/ 00769000
*   /*                                                               */ 00770000
*   /*****************************************************************/ 00771000
*                                                                  0456 00772000
*   RETURN CODE(CHECKRC);           /* RETURN TO MAIN ROUTINE      0456 00773000
*                                                            #Y30LB37*/ 00774000
@RF00447 LR    @15,CHECKRC                                         0456 00775000
         L     @14,@SA00002                                        0456 00776000
         LM    @00,@12,@SA00002+8                                  0456 00777000
         BR    @14                                                 0456 00778000
*   END UCBCHECK;                   /* END OF UCBCHECK PROC  @Y30LB37*/ 00779000
*                                                                  0458 00780000
*/********************************************************************/ 00781000
*/*                                                                  */ 00782000
*/*  PROCEDURE NAME - UCBPOST                                @Y30LB37*/ 00783000
*/*                                                          @Y30LB37*/ 00784000
*/*  FUNCTION - THIS ROUTINE WILL BUILD THE PARAMETER        @Y30LB37*/ 00785000
*/*             LIST REQUIRED AND ISSUE SVC 82 (DASDR)       @Y30LB37*/ 00786000
*/*             TO POST THE UCB WITH THE VOLUME LABEL        @Y30LB37*/ 00787000
*/*             AND TTR TO THE VTOC. THIS ROUTINE ON A       @Y30LB37*/ 00788000
*/*             CLEAR REQUEST WILL CLEAR THE VOLSER AND      @Y30LB37*/ 00789000
*/*             TTR TO THE VTOC FROM THE UCB AND             @Y30LB37*/ 00790000
*/*             PASS THE CLEARED INFORMATION BACK            @Y30LB37*/ 00791000
*/*             TO THE CALLER FOR POSTING BACK THE UCB       @Y30LB37*/ 00792000
*/*             AT END OF CALLERS JOB.  IF A DUPLICATE       @Y30LB37*/ 00793000
*/*             VOLSER IS IN THE SYSTEM ISSUE MESSAGE        @Y30LB37*/ 00794000
*/*             IDC2381I VIA UPRINT.                         @Y30LB37*/ 00795000
*/*                                                          @Y30LB37*/ 00796000
*/*  INPUT - INPUT INFORMATION TO THIS ROUTINE IS IN THE     @Y30LB37*/ 00797000
*/*          FORM OF A PUAGL ARGUMENT LIST WITH THE UCB      @Y30LB37*/ 00798000
*/*          INFORMATION TO POST THE VOLUME LABEL AND THE    @Y30LB37*/ 00799000
*/*          TTR INTO THE UCB.  ALSO KEYWORD OF EITHER       @Y30LB37*/ 00800000
*/*          'POST' OR 'CLEAR'.                              @Y30LB37*/ 00801000
*/*                                                          @Y30LB37*/ 00802000
*/*  OUTPUT- IF THE REQUEST IS A POST REQUEST THE            @Y30LB37*/ 00803000
*/*          CLEARED INFORMATION IS RETURNED IN AREAS        @Y30LB37*/ 00804000
*/*          POINTED TO OUT OF THE PULABELP AND PUTTRPTR     @Y30LB37*/ 00805000
*/*          FIELDS OF THE PUAGL.  RETURN CODES IN           @Y30LB37*/ 00806000
*/*          REGISTER 15 ARE:                                @Y30LB37*/ 00807000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 00808000
*/*          4 - DUPLICATE VOLUME SERIAL IN SYSTEM ON A      @Y30LB37*/ 00809000
*/*              POST REQUEST                                @Y30LB37*/ 00810000
*/*                                                                  */ 00811000
*/********************************************************************/ 00812000
*                                                                  0458 00813000
*UCBPOST:                                                          0458 00814000
*   PROCEDURE(COMMAND,PUAGLPTR);    /*                       @Y30LB37*/ 00815000
UCBPOST  STM   @14,@12,@SA00003                                    0458 00816000
         MVC   @PC00003(8),0(@01)                                  0458 00817000
*                                                                  0459 00818000
*   /*****************************************************************/ 00819000
*   /*                                                               */ 00820000
*   /* LOCAL DECLARATIONS FOR UCBPOST                        @Y30LB37*/ 00821000
*   /*                                                               */ 00822000
*   /*****************************************************************/ 00823000
*                                                                  0459 00824000
*   DCL                                                            0459 00825000
*     UPOSTRC FIXED(15);            /* UCBPOST RETURN CODE   @Y30LB37*/ 00826000
*   DCL                                                            0460 00827000
*     COMMAND CHAR(8);              /* POST OR CLEAR COMMAND @Y30LB37*/ 00828000
*   DCL                                                            0461 00829000
*     PUAGLPTR PTR(31);             /* PTR TO PUAGL          @Y30LB37*/ 00830000
*   DCL                                                            0462 00831000
*     PURETVOL CHAR(6) BASED(PULABELP);/* RETURNED VOLSER    @Y30LB37*/ 00832000
*   DCL                                                            0463 00833000
*     PURETTTR CHAR(4) BASED(PUTTRPTR);/* RETURNED TTR VTOC  @Y30LB37*/ 00834000
*   DCL                                                            0464 00835000
*     CLEARCD BIT(8) STATIC INIT('22'X);/* CLEAR OPERATION   @Y30LB37*/ 00836000
*   DCL                                                            0465 00837000
*     POSTCD BIT(8) STATIC INIT('23'X);/* POST OPERATION     @Y30LB37*/ 00838000
*   DCL                                                            0466 00839000
*     1 RETAREA BDY(WORD),          /* RETURN AREA FOR SVC82 @Y30LB37*/ 00840000
*      2 RETVOLSR CHAR(6),          /* RETURNED VOLSER       @Y30LB37*/ 00841000
*      2 RETTTR CHAR(4);            /* RETURNED TTR TO VTOC  @Y30LB37*/ 00842000
*   DCL                                                            0467 00843000
*     SV82CORE CHAR(LENGTH(SV82LIST))/* SVC 82 ARGUMENT LIST @Y30LB37*/ 00844000
*         BDY(WORD);                /* GETMAINED CORE        @Y30LB37*/ 00845000
*                                                                  0468 00846000
*   /*****************************************************************/ 00847000
*   /*                                                               */ 00848000
*   /* RESPECIFY PUAGL BASED ON PARAMETER BEFORE             @Y30LB37*/ 00849000
*   /* ISSUING UTRACE MACRO AND RESPECIFY SV82LIST.          @Y30LB37*/ 00850000
*   /*                                                               */ 00851000
*   /*****************************************************************/ 00852000
*                                                                  0468 00853000
*   RFY                                                            0468 00854000
*     PUAGL BASED(PUAGLPTR);        /*                       @Y30LB37*/ 00855000
*   RFY                                                            0469 00856000
*     SV82LIST BASED(ADDR(SV82CORE));/*                      @Y30LB37*/ 00857000
*   OLDERID2=NEWERID2;                                             0470 00858000
         L     @08,@PC00001                                        0470 00859000
         L     @08,GDTTR2(,@08)                                    0470 00860000
         MVC   @TS00001(95),NEWERID2(@08)                          0470 00861000
         MVC   OLDERID2(95,@08),@TS00001                           0470 00862000
*   NEWID2='SAPU';                  /*                       @Y30LB37*/ 00863000
         MVC   NEWID2(4,@08),@CC02672                              0471 00864000
*   UPOSTRC=0;                      /* INITIALIZE RETURN CODE      0472 00865000
*                                                            @Y30LB37*/ 00866000
*                                                                  0472 00867000
         SLR   @08,@08                                             0472 00868000
         LR    UPOSTRC,@08                                         0472 00869000
*   /*****************************************************************/ 00870000
*   /*                                                               */ 00871000
*   /* IF COMMAND IS TO CLEAR THE UCB THEN SET UP THE SVC    @Y30LB37*/ 00872000
*   /* 82 PARAMETER LIST AND ISSUE SVC 82 TO CLEAR THE       @Y30LB37*/ 00873000
*   /* UCB. RETURN THE VOLUME SERIAL NUMBER AND THE TTR TO   @Y30LB37*/ 00874000
*   /* THE VTOC CLEARED FROM THE UCB TO THE CALLER.          @Y30LB37*/ 00875000
*   /*                                                               */ 00876000
*   /*****************************************************************/ 00877000
*                                                                  0473 00878000
*   IF COMMAND=CLEAR THEN                                          0473 00879000
         L     @05,@PC00003                                        0473 00880000
         CLC   COMMAND(8,@05),CLEAR                                0473 00881000
         BNE   @RF00473                                            0473 00882000
*     DO;                           /*                       @Y30LB37*/ 00883000
*       SV82CODE=CLEARCD;           /*                       @Y30LB37*/ 00884000
         LA    @05,SV82CORE                                        0475 00885000
         MVC   SV82CODE(1,@05),CLEARCD                             0475 00886000
*       SV82UCBP=PUUCBADR;          /*                       @Y30LB37*/ 00887000
         L     @15,@PC00003+4                                      0476 00888000
         L     @01,PUAGLPTR(,@15)                                  0476 00889000
         L     @01,PUUCBPTR(,@01)                                  0476 00890000
         MVC   SV82UCBP(3,@05),PUUCBADR+1(@01)                     0476 00891000
*       SV82VOLP=NULLPTR;           /*                       @Y30LB37*/ 00892000
         ST    @08,SV82VOLP(,@05)                                  0477 00893000
*       SV82TTRP=NULLPTR;           /*                       @Y30LB37*/ 00894000
         ST    @08,SV82TTRP(,@05)                                  0478 00895000
*       SV82WRKP=ADDR(RETAREA);     /*                       @Y30LB37*/ 00896000
         LA    @08,RETAREA                                         0479 00897000
         ST    @08,SV82WRKP(,@05)                                  0479 00898000
*       RFY                                                        0480 00899000
*         REG1 RESTRICTED;          /*                       @Y30LB37*/ 00900000
*       REG1=ADDR(SV82LIST);        /*                       @Y30LB37*/ 00901000
         LR    REG1,@05                                            0481 00902000
*       RFY                                                        0482 00903000
*         REG1 UNRESTRICTED;        /*                       @Y30LB37*/ 00904000
*L82SVC1:                                                          0483 00905000
*       SVC(82);                    /*                       @Y30LB37*/ 00906000
L82SVC1  SVC   82                                                  0483 00907000
*       PURETTTR=RETTTR;            /*                       @Y30LB37*/ 00908000
         L     @08,@PC00003+4                                      0484 00909000
         L     @08,PUAGLPTR(,@08)                                  0484 00910000
         L     @05,PUTTRPTR(,@08)                                  0484 00911000
         MVC   PURETTTR(4,@05),RETTTR                              0484 00912000
*       PURETVOL=RETVOLSR;          /*                       @Y30LB37*/ 00913000
         L     @08,PULABELP(,@08)                                  0485 00914000
         MVC   PURETVOL(6,@08),RETVOLSR                            0485 00915000
*     END;                          /*                       @Y30LB37*/ 00916000
*                                                                  0487 00917000
*   /*****************************************************************/ 00918000
*   /*                                                               */ 00919000
*   /* IF COMMAND IS TO POST THE UCB AND THE RETURN INFORM-  @Y30LB37*/ 00920000
*   /* ATION TO BE POSTED IS NOT ZEROS THEN SET UP THE SVC   @Y30LB37*/ 00921000
*   /* 82 PARAMETER LIST AND ISSUE SVC 82 TO POST THE        @Y30LB37*/ 00922000
*   /* UCB WITH THE CALLER'S INFORMATION FROM THE PUAGL.     @Y30LB37*/ 00923000
*   /* POSTING ZERO INFORMATION IS NOT CONSIDERED AN ERROR   @Y30LB37*/ 00924000
*   /* BECAUSE DURING A MOUNT WITH THE CLEAR UCB FUNCTION    @Y30LB37*/ 00925000
*   /* COULD HAVE CLEARED ZEROS FROM THE REAL UCB, WHICH AT  @Y30LB37*/ 00926000
*   /* AT THIS TIME IS POSTING BACK THAT INFORMATION.        @Y30LB37*/ 00927000
*   /*                                                               */ 00928000
*   /*****************************************************************/ 00929000
*                                                                  0487 00930000
*   IF COMMAND=POST&PURETVOL^=ZEROVOL THEN                         0487 00931000
@RF00473 L     @08,@PC00003                                        0487 00932000
         CLC   COMMAND(8,@08),POST                                 0487 00933000
         BNE   @RF00487                                            0487 00934000
         L     @08,@PC00003+4                                      0487 00935000
         L     @08,PUAGLPTR(,@08)                                  0487 00936000
         L     @05,PULABELP(,@08)                                  0487 00937000
         CLC   PURETVOL(6,@05),ZEROVOL                             0487 00938000
         BE    @RF00487                                            0487 00939000
*     DO;                           /*                       @Y30LB37*/ 00940000
*       SV82CODE=POSTCD;            /*                       @Y30LB37*/ 00941000
         LA    @04,SV82CORE                                        0489 00942000
         MVC   SV82CODE(1,@04),POSTCD                              0489 00943000
*       SV82UCBP=PUUCBADR;          /*                       @Y30LB37*/ 00944000
         L     @01,PUUCBPTR(,@08)                                  0490 00945000
         MVC   SV82UCBP(3,@04),PUUCBADR+1(@01)                     0490 00946000
*       SV82VOLP=PULABELP;          /*                       @Y30LB37*/ 00947000
         ST    @05,SV82VOLP(,@04)                                  0491 00948000
*       SV82TTRP=PUTTRPTR;          /*                       @Y30LB37*/ 00949000
         L     @08,PUTTRPTR(,@08)                                  0492 00950000
         ST    @08,SV82TTRP(,@04)                                  0492 00951000
*       SV82WRKP=NULLPTR;           /*                       @Y30LB37*/ 00952000
         SLR   @08,@08                                             0493 00953000
         ST    @08,SV82WRKP(,@04)                                  0493 00954000
*       RFY                                                        0494 00955000
*         REG1 RESTRICTED;          /*                       @Y30LB37*/ 00956000
*       REG1=ADDR(SV82LIST);        /*                       @Y30LB37*/ 00957000
         LR    REG1,@04                                            0495 00958000
*       RFY                                                        0496 00959000
*         REG1 UNRESTRICTED;        /*                       @Y30LB37*/ 00960000
*L82SVC2:                                                          0497 00961000
*       SVC(82);                    /*                       @Y30LB37*/ 00962000
L82SVC2  SVC   82                                                  0497 00963000
*       RESPECIFY                                                  0498 00964000
*         RTNREG RSTD;                                             0498 00965000
*       TESTRC=RTNREG;                                             0499 00966000
         LR    TESTRC,RTNREG                                       0499 00967000
*       RESPECIFY                                                  0500 00968000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 00969000
*       IF TESTRC=0 THEN                                           0501 00970000
         LTR   TESTRC,TESTRC                                       0501 00971000
         BNZ   @RF00501                                            0501 00972000
*         UPOSTRC=TESTRC;           /*                       @Y30LB37*/ 00973000
         LR    UPOSTRC,TESTRC                                      0502 00974000
*       ELSE                                                       0503 00975000
*         UPOSTRC=4;                /*                       @Y30LB37*/ 00976000
         B     @RC00501                                            0503 00977000
@RF00501 LA    UPOSTRC,4                                           0503 00978000
*     END;                          /*                       @Y30LB37*/ 00979000
@RC00501 DS    0H                                                  0505 00980000
*                                                                  0505 00981000
*   /*****************************************************************/ 00982000
*   /*                                                               */ 00983000
*   /* IF THE POST UCB FAILED, SET UP AND ISSUE THE          @Y30LB37*/ 00984000
*   /* UPRINT MACRO AND ISSUE ERROR MESSAGE IDC2381I, TO     @Y30LB37*/ 00985000
*   /* INDICATE A DUPLICATE VOLSER WAS FOUND. SET RETURN     @Y30LB37*/ 00986000
*   /* CODE TO INDICATE THERE WAS A FAILURE.                 @Y30LB37*/ 00987000
*   /*                                                               */ 00988000
*   /*****************************************************************/ 00989000
*                                                                  0505 00990000
*   IF UPOSTRC^=0 THEN                                             0505 00991000
@RF00487 LTR   UPOSTRC,UPOSTRC                                     0505 00992000
         BZ    @RF00505                                            0505 00993000
*     DO;                           /*                       @Y30LB37*/ 00994000
*       DARGSMOD=MSGMODID;          /*                       @Y30LB37*/ 00995000
         L     @08,DDSTRU                                          0507 00996000
         MVC   DARGSMOD(3,@08),@CC02595                            0507 00997000
*       DARGSENT=MSG2381I;          /*                       @Y30LB37*/ 00998000
         MVI   DARGSENT(@08),X'01'                                 0508 00999000
*       DARGDBP=PULABELP;           /*                       @Y30LB37*/ 01000000
         L     @05,@PC00003+4                                      0509 01001000
         L     @05,PUAGLPTR(,@05)                                  0509 01002000
         L     @05,PULABELP(,@05)                                  0509 01003000
         ST    @05,DARGDBP(,@08)                                   0509 01004000
*       DARGILP=VOLSERLN;           /*                       @Y30LB37*/ 01005000
         MVC   DARGILP(2,@08),@CH00156                             0510 01006000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB37*/ 01007000
         L     @08,@PC00001                                        0511 01008000
         ST    @08,@AL00001                                        0511 01009000
         LA    @05,@CF00115                                        0511 01010000
         ST    @05,@AL00001+4                                      0511 01011000
         LA    @05,DDSTRU                                          0511 01012000
         ST    @05,@AL00001+8                                      0511 01013000
         MVI   @AL00001+8,X'80'                                    0511 01014000
         L     @15,GDTPRT(,@08)                                    0511 01015000
         LA    @01,@AL00001                                        0511 01016000
         BALR  @14,@15                                             0511 01017000
*     END;                          /*                       @Y30LB37*/ 01018000
*                                                                  0512 01019000
*   /*****************************************************************/ 01020000
*   /*                                                               */ 01021000
*   /* SET RETURN CODE AND RETURN TO THE MAIN PROCEDURE.     @Y30LB37*/ 01022000
*   /*                                                               */ 01023000
*   /*****************************************************************/ 01024000
*                                                                  0513 01025000
*   RETURN CODE(UPOSTRC);           /* RETURN TO MAIN ROUTINE      0513 01026000
*                                                            @Y30LB37*/ 01027000
@RF00505 LR    @15,UPOSTRC                                         0513 01028000
         L     @14,@SA00003                                        0513 01029000
         LM    @00,@12,@SA00003+8                                  0513 01030000
         BR    @14                                                 0513 01031000
*   END UCBPOST;                    /* END OF UCBPOST PROC   @Y30LB37*/ 01032000
*                                                                  0515 01033000
*/********************************************************************/ 01034000
*/*                                                                  */ 01035000
*/*  PROCEDURE NAME - MDSETUP                                @Y30LB37*/ 01036000
*/*                                                          @Y30LB37*/ 01037000
*/*  FUNCTION - THIS IS THE PREPARATION ROUTINE FOR A        @Y30LB37*/ 01038000
*/*             MOUNT OR A DEMOUNT REQUEST. THIS ROUTINE     @Y30LB37*/ 01039000
*/*             ISSUES THE USTAE MACRO WHO IN TURN           @Y30LB37*/ 01040000
*/*             INITIALIZES THE ESTAE(VS-2) OR STAE(VS-1)    @Y30LB37*/ 01041000
*/*             PARAMETER LIST. MDSETUP ISSUES THE APPRO-    @Y30LB37*/ 01042000
*/*             PRIATE CALL TO INVOKE EITHER MOUNTCTL OR     @Y30LB37*/ 01043000
*/*             DEMNTVOL DEPENDANT UPON THE MDAGL INPUT.     @Y30LB37*/ 01044000
*/*                                                          @Y30LB37*/ 01045000
*/*  INPUT - THE INPUT ARGUMENT LIST MDAGL IS USED TO        @Y30LB37*/ 01046000
*/*          DETERMINE THE TYPE REQUEST. IF THE STAE PARM    @Y30LB37*/ 01047000
*/*          LIST POINTER SAHSTA IS ZERO, THEN MDSETUP WILL  @Y30LB37*/ 01048000
*/*          ISSUE THE USTAE MACRO.                          @Y30LB37*/ 01049000
*/*                                                          @Y30LB37*/ 01050000
*/*  OUTPUT- IS IN THE FORM OF A COMPLETED MOUNT OR DE-      @Y30LB37*/ 01051000
*/*          MOUNT REQUEST AND AN INITIALIZED PARAMETER      @Y30LB37*/ 01052000
*/*          LIST FOR STAE/ESTAE RECOVERY.                   @Y30LB37*/ 01053000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 01054000
*/*          4 - USTAE MACRO WAS UNSUCCESSFUL                @Y30LB37*/ 01055000
*/*              MOUNT WAS UNSUCCESSFUL                      @Y30LB37*/ 01056000
*/*              DEMOUNT WAS UNSUCCESSFUL                    @Y30LB37*/ 01057000
*/*                                                                  */ 01058000
*/********************************************************************/ 01059000
*                                                                  0515 01060000
*MDSETUP:                                                          0515 01061000
*   PROCEDURE(MDAGLPTR);            /*                       @Y30LB37*/ 01062000
*                                                                  0515 01063000
MDSETUP  STM   @14,@12,@SA00004                                    0515 01064000
         MVC   @PC00004(4),0(@01)                                  0515 01065000
*   /*****************************************************************/ 01066000
*   /*                                                               */ 01067000
*   /* LOCAL DECLARATIONS FOR MDSETUP                        @Y30LB37*/ 01068000
*   /*                                                               */ 01069000
*   /*****************************************************************/ 01070000
*                                                                  0516 01071000
*   DCL                                                            0516 01072000
*     MDSETRC FIXED(15);            /* MDSETUP RETURN CODE   @Y30LB37*/ 01073000
*   DCL                                                            0517 01074000
*     MDAGLPTR PTR(31);             /* PTR TO MDAGL          @Y30LB37*/ 01075000
*   DCL                                                            0518 01076000
*     RCUSFAIL FIXED(15) CONSTANT(8);/* USTAE FAILED RETCODE @Y30LB37*/ 01077000
*                                                                  0519 01078000
*   /*****************************************************************/ 01079000
*   /*                                                               */ 01080000
*   /* THIS IS THE MAIN CONTROLLING ROUTINE FOR ALL MOUNT    @Y30LB37*/ 01081000
*   /* AND DEMOUNT FUNCTIONS. IT CONTROLS THE USTAE MACRO    @Y30LB37*/ 01082000
*   /* RECOVERY BY SETTING AND CANCELLING IT AS NEEDED.      @Y30LB37*/ 01083000
*   /*                                                               */ 01084000
*   /*****************************************************************/ 01085000
*                                                                  0519 01086000
*   RFY                                                            0519 01087000
*     MDAGL BASED(MDAGLPTR);        /*                       @Y30LB37*/ 01088000
*   OLDERID2=NEWERID2;                                             0520 01089000
         L     @08,@PC00001                                        0520 01090000
         L     @03,GDTTR2(,@08)                                    0520 01091000
         MVC   @TS00001(95),NEWERID2(@03)                          0520 01092000
         MVC   OLDERID2(95,@03),@TS00001                           0520 01093000
*   NEWID2='SAPR';                  /*                       @Y30LB37*/ 01094000
         MVC   NEWID2(4,@03),@CC02687                              0521 01095000
*   MDSETRC=0;                      /*                       @Y30LB37*/ 01096000
         SLR   @03,@03                                             0522 01097000
         LR    MDSETRC,@03                                         0522 01098000
*   UCBPTR=MDUCBADR;                /*                       @Y30LB37*/ 01099000
*                                                                  0523 01100000
         L     @15,@PC00004                                        0523 01101000
         L     @01,MDAGLPTR(,@15)                                  0523 01102000
         L     @01,MDUCBPTR(,@01)                                  0523 01103000
         L     UCBPTR,MDUCBADR(,@01)                               0523 01104000
*   /*****************************************************************/ 01105000
*   /*                                                               */ 01106000
*   /* COMPUTE THE CURRENT TCB ADDRESS FOR ENQDEQ.           @Y30LB37*/ 01107000
*   /*                                                               */ 01108000
*   /*****************************************************************/ 01109000
*                                                                  0524 01110000
*   TCBPTR=CURTCBP;                 /*                       @Y30LB37*/ 01111000
         L     @01,CVTPTR                                          0524 01112000
         L     @01,TCBWDSP(,@01)                                   0524 01113000
         L     TCBPTR,CURTCBP(,@01)                                0524 01114000
*   TCBP=JSCBTCBP;                  /*                       @Y30LB37*/ 01115000
*                                                                  0525 01116000
         L     @01,TCBJSCB(,TCBPTR)                                0525 01117000
         L     @15,JSCBTCBP(,@01)                                  0525 01118000
         ST    @15,TCBP                                            0525 01119000
*   /*****************************************************************/ 01120000
*   /*                                                               */ 01121000
*   /* ISSUE USTAE MACRO AND SET MDSETRC IF UNSUCCESSFUL.    @Y30LB37*/ 01122000
*   /*                                                               */ 01123000
*   /*****************************************************************/ 01124000
*                                                                  0526 01125000
*   IF SAHSTA=NULLPTR THEN                                         0526 01126000
         L     @01,GDTSAH(,@08)                                    0526 01127000
         C     @03,SAHSTA(,@01)                                    0526 01128000
         BNE   @RF00526                                            0526 01129000
*     DO;                           /*                       @Y30LB37*/ 01130000
*       CALL IDCSAST0(GDTTBL,SET);  /* ISSUE USTAE TO RECOVER      0528 01131000
*                                                            @Y30LB37*/ 01132000
         ST    @08,@AL00001                                        0528 01133000
         LA    @03,SET                                             0528 01134000
         ST    @03,@AL00001+4                                      0528 01135000
         MVI   @AL00001+4,X'80'                                    0528 01136000
         L     @15,GDTSTA(,@08)                                    0528 01137000
         LA    @01,@AL00001                                        0528 01138000
         BALR  @14,@15                                             0528 01139000
*       RESPECIFY                                                  0529 01140000
*         RTNREG RSTD;                                             0529 01141000
*       TESTRC=RTNREG;                                             0530 01142000
         LR    TESTRC,RTNREG                                       0530 01143000
*       RESPECIFY                                                  0531 01144000
*         RTNREG UNRSTD;            /* GET RETURN CODE       @Y30LB37*/ 01145000
*       IF TESTRC^=0 THEN                                          0532 01146000
         LTR   TESTRC,TESTRC                                       0532 01147000
         BZ    @RF00532                                            0532 01148000
*         MDSETRC=RCUSFAIL;         /* SET RETURN CODE TO 8  @Y30LB37*/ 01149000
         LA    MDSETRC,8                                           0533 01150000
*     END;                          /*                       @Y30LB37*/ 01151000
@RF00532 DS    0H                                                  0535 01152000
*                                                                  0535 01153000
*   /*****************************************************************/ 01154000
*   /*                                                               */ 01155000
*   /* CALL MOUNTCTL OR DEMNTVOL DEPENDING ON MDAGL HEADING  @Y30LB37*/ 01156000
*   /*                                                               */ 01157000
*   /*****************************************************************/ 01158000
*                                                                  0535 01159000
*   IF MDSETRC=0 THEN                                              0535 01160000
@RF00526 LTR   MDSETRC,MDSETRC                                     0535 01161000
         BNZ   @RF00535                                            0535 01162000
*     DO;                           /*                       @Y30LB37*/ 01163000
*       IF MDHEAD=MOUNT THEN                                       0537 01164000
         L     @08,@PC00004                                        0537 01165000
         L     @04,MDAGLPTR(,@08)                                  0537 01166000
         CLC   MDHEAD(8,@04),MOUNT                                 0537 01167000
         BNE   @RF00537                                            0537 01168000
*         CALL MOUNTCTL(MDAGLPTR);  /*                       @Y30LB37*/ 01169000
         ST    @08,@AL00001                                        0538 01170000
         LA    @01,@AL00001                                        0538 01171000
         BAL   @14,MOUNTCTL                                        0538 01172000
*       ELSE                                                       0539 01173000
*         IF MDHEAD=DEMOUNT THEN                                   0539 01174000
         B     @RC00537                                            0539 01175000
@RF00537 L     @08,@PC00004                                        0539 01176000
         L     @04,MDAGLPTR(,@08)                                  0539 01177000
         CLC   MDHEAD(8,@04),DEMOUNT                               0539 01178000
         BNE   @RF00539                                            0539 01179000
*           CALL DEMNTVOL(MDAGLPTR);/*                       @Y30LB37*/ 01180000
         ST    @08,@AL00001                                        0540 01181000
         LA    @01,@AL00001                                        0540 01182000
         BAL   @14,DEMNTVOL                                        0540 01183000
*       RESPECIFY                                                  0541 01184000
*         RTNREG RSTD;                                             0541 01185000
@RF00539 DS    0H                                                  0541 01186000
@RC00537 DS    0H                                                  0542 01187000
*       TESTRC=RTNREG;                                             0542 01188000
         LR    TESTRC,RTNREG                                       0542 01189000
*       RESPECIFY                                                  0543 01190000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 01191000
*       MDSETRC=TESTRC;             /*                       @Y30LB37*/ 01192000
         LR    MDSETRC,TESTRC                                      0544 01193000
*     END;                          /*                       @Y30LB37*/ 01194000
*                                                                  0545 01195000
*   /*****************************************************************/ 01196000
*   /*                                                               */ 01197000
*   /* ISSUE USTAE MACRO TO CANCEL USTAE IF SUCCESSFUL.      @Y30LB37*/ 01198000
*   /*                                                               */ 01199000
*   /*****************************************************************/ 01200000
*                                                                  0546 01201000
*   IF MDSETRC^=RCUSFAIL THEN                                      0546 01202000
@RF00535 C     MDSETRC,@CF00179                                    0546 01203000
         BE    @RF00546                                            0546 01204000
*     IF STACLEAR=OFF THEN                                         0547 01205000
         L     @08,@PC00001                                        0547 01206000
         L     @05,GDTSAH(,@08)                                    0547 01207000
         L     @05,SAHSTA(,@05)                                    0547 01208000
         TM    STACLEAR(@05),B'00001000'                           0547 01209000
         BNZ   @RF00547                                            0547 01210000
*       CALL IDCSAST0(GDTTBL,CANCEL);/* ISSUE USTAE TO CANCEL      0548 01211000
*                                                            @Y30LB37*/ 01212000
         ST    @08,@AL00001                                        0548 01213000
         LA    @05,CANCEL                                          0548 01214000
         ST    @05,@AL00001+4                                      0548 01215000
         MVI   @AL00001+4,X'80'                                    0548 01216000
         L     @15,GDTSTA(,@08)                                    0548 01217000
         LA    @01,@AL00001                                        0548 01218000
         BALR  @14,@15                                             0548 01219000
*   IF MDSETRC=RCUSFAIL THEN                                       0549 01220000
@RF00547 DS    0H                                                  0549 01221000
@RF00546 C     MDSETRC,@CF00179                                    0549 01222000
         BNE   @RF00549                                            0549 01223000
*     MDSETRC=4;                    /*                       @Y30LB37*/ 01224000
         LA    MDSETRC,4                                           0550 01225000
*   RETURN CODE(MDSETRC);           /* RETURN TO MAIN ROUTINE      0551 01226000
*                                                            @Y30LB37*/ 01227000
@RF00549 LR    @15,MDSETRC                                         0551 01228000
         L     @14,@SA00004                                        0551 01229000
         LM    @00,@12,@SA00004+8                                  0551 01230000
         BR    @14                                                 0551 01231000
*   END MDSETUP;                    /* END OF MDSETUP TO MOUNT OR  0552 01232000
*                                      DEMOUNT PROCEDURE     @Y30LB37*/ 01233000
*                                                                  0553 01234000
*/********************************************************************/ 01235000
*/*                                                                  */ 01236000
*/*  PROCEDURE NAME - MOUNTCTL                               @Y30LB37*/ 01237000
*/*                                                          @Y30LB37*/ 01238000
*/*  FUNCTION - THIS IS THE MOUNT CONTROLLING ROUTINE FOR    @Y30LB37*/ 01239000
*/*             THE MOUNTING OF A 3330V VIRTUAL VOLUME.      @Y30LB37*/ 01240000
*/*             IT PERFORMS THE SETUP AND CHECK TO SEE IF    @Y30LB37*/ 01241000
*/*             THE VOLUME IS ALREADY MOUNTED OR IF          @Y30LB37*/ 01242000
*/*             ANOTHER VOLUME IS ALREADY MOUNTED AND        @Y30LB37*/ 01243000
*/*             MUST BE DEMOUNTED FIRST.  MOUNTCTL USES      @Y30LB37*/ 01244000
*/*             SUBORDINATE FUNCTIONS MOUNTVOL, DEMNTVOL     @Y30LB37*/ 01245000
*/*             AND UCBPOST TO ACHIEVE THE MOUNTING 0F A     @Y30LB37*/ 01246000
*/*             3330V VOLUME. IT ALSO CLEARS A UCB PRIOR     @Y30LB37*/ 01247000
*/*             TO MOUNTING THE VIRTUAL VOLUME IF THE        @Y30LB37*/ 01248000
*/*             CLEAR OPTION WAS SPECIFIED.                  @Y30LB37*/ 01249000
*/*                                                          @Y30LB37*/ 01250000
*/*  INPUT - THE INPUT ARGUMENT LIST MDAGL IS USED TO        @Y30LB37*/ 01251000
*/*          SET UP THE MOUNT REQUEST. THE UCB IS POINTED    @Y30LB37*/ 01252000
*/*          TO OUT OF THE MDAGL AND IS USED TO CHECK THE    @Y30LB37*/ 01253000
*/*          VOLUME SERIAL MOUNTED.                          @Y30LB37*/ 01254000
*/*                                                          @Y30LB37*/ 01255000
*/*  OUTPUT- IS IN THE FORM OF A COMPLETED MOUNT REQUEST     @Y30LB37*/ 01256000
*/*          AND A CLEARED UCB IF SPECIFIED WITH THE         @Y30LB37*/ 01257000
*/*          CLEAR OPTION ALONG WITH THE MOUNT.   RETURN     @Y30LB37*/ 01258000
*/*          CODES ARE AS FOLLOWS:                           @Y30LB37*/ 01259000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 01260000
*/*          4 - MOUNT WAS UNSUCCESSFUL                      @Y30LB37*/ 01261000
*/*            - DEMOUNT OF PREVIOUS VOLUME WAS UNSUCCESSFUL @Y30LB37*/ 01262000
*/*                                                                  */ 01263000
*/********************************************************************/ 01264000
*                                                                  0553 01265000
*MOUNTCTL:                                                         0553 01266000
*   PROCEDURE(MTAGLPTR);            /*                       @Y30LB37*/ 01267000
*                                                                  0553 01268000
MOUNTCTL STM   @14,@12,@SA00005                                    0553 01269000
         MVC   @PC00005(4),0(@01)                                  0553 01270000
*   /*****************************************************************/ 01271000
*   /*                                                               */ 01272000
*   /* LOCAL DECLARATIONS FOR MOUNTCTL                       @Y30LB37*/ 01273000
*   /*                                                               */ 01274000
*   /*****************************************************************/ 01275000
*                                                                  0554 01276000
*   DCL                                                            0554 01277000
*     MTCTLRC FIXED(15);            /* MOUNTCTL RETURN CODE  @Y30LB37*/ 01278000
*   DCL                                                            0555 01279000
*     MTAGLPTR PTR(31);             /* PTR TO MDAGL          @Y30LB37*/ 01280000
*   DCL                                                            0556 01281000
*     MYAGLPTR PTR(31);             /* PTR TO SA6'S MDAGL    @Y30LB37*/ 01282000
*   DCL                                                            0557 01283000
*     SA6MDAGL BDY(WORD)            /* SA6'S SKELETON        @Y30LB37*/ 01284000
*         CHAR(LENGTH(MDAGL));      /* MDAGL ARGLIST         @Y30LB37*/ 01285000
*   DCL                                                            0558 01286000
*     PUVOLRET CHAR(6) BASED(PULABELP);/* RETURNED VOLSER    @Y30LB37*/ 01287000
*   DCL                                                            0559 01288000
*     PUTTRRET CHAR(4) BASED(PUTTRPTR);/* RETURNED TTR VTOC  @Y30LB37*/ 01289000
*                                                                  0560 01290000
*   /*****************************************************************/ 01291000
*   /*                                                               */ 01292000
*   /* RESPECIFY MDAGL BASED ON PARAMETER BEFORE             @Y30LB37*/ 01293000
*   /* ISSUING UTRACE MACRO.                                 @Y30LB37*/ 01294000
*   /*                                                               */ 01295000
*   /*****************************************************************/ 01296000
*                                                                  0560 01297000
*   RFY                                                            0560 01298000
*     MDAGL BASED(MTAGLPTR);        /*                       @Y30LB37*/ 01299000
*   OLDERID2=NEWERID2;                                             0561 01300000
         L     @08,@PC00001                                        0561 01301000
         L     @08,GDTTR2(,@08)                                    0561 01302000
         MVC   @TS00001(95),NEWERID2(@08)                          0561 01303000
         MVC   OLDERID2(95,@08),@TS00001                           0561 01304000
*   NEWID2='SAMC';                  /*                       @Y30LB37*/ 01305000
         MVC   NEWID2(4,@08),@CC02701                              0562 01306000
*   MTCTLRC=0;                      /*                       @Y30LB37*/ 01307000
*                                                                  0563 01308000
         SLR   @08,@08                                             0563 01309000
         LR    MTCTLRC,@08                                         0563 01310000
*   /*****************************************************************/ 01311000
*   /*                                                               */ 01312000
*   /* THE UCB IS INTERROGATED TO DETERMINE IF THE UNIT IS   @Y30LB37*/ 01313000
*   /* READY AND A VOLUME SERIAL NUMBER IS IN THE UCB,       @Y30LB37*/ 01314000
*   /* INDICATING A VOLUME IS ALREADY MOUNTED ON THAT        @Y30LB37*/ 01315000
*   /* UNIT. IF SO, THEN THE VOLUME SERIAL FIELD             @Y30LB37*/ 01316000
*   /* (UCBVOLI) WILL BE COMPARED TO DETERMINE IF THE        @Y30LB37*/ 01317000
*   /* VOLUME TO BE MOUNTED IS THE ONE MOUNTED. IF           @Y30LB37*/ 01318000
*   /* A DIFFERENT SERIAL NUMBER, OTHER THAN ZEROS, THEN     @Y30LB37*/ 01319000
*   /* BUILD A MDAGL AND CALL DEMNTVOL WITH THE INTERNALLY   @Y30LB37*/ 01320000
*   /* BUILT SA6MDAGL. IF EQUAL THEN SET RETURN CODE 8 TO    @Y30LB37*/ 01321000
*   /* INDICATE THE VOLUME DOES NOT NEED MOUNTING AGAIN.     @Y30LB37*/ 01322000
*   /*                                                               */ 01323000
*   /*****************************************************************/ 01324000
*                                                                  0564 01325000
*   IF UCBNOTRD=OFF&UCBVOLI^=ZEROVOL THEN                          0564 01326000
         TM    UCBNOTRD(UCBPTR),B'01000000'                        0564 01327000
         BNZ   @RF00564                                            0564 01328000
         CLC   UCBVOLI(6,UCBPTR),ZEROVOL                           0564 01329000
         BE    @RF00564                                            0564 01330000
*     IF UCBVOLI^=MDLABEL THEN                                     0565 01331000
         L     @15,@PC00005                                        0565 01332000
         L     @15,MTAGLPTR(,@15)                                  0565 01333000
         CLC   UCBVOLI(6,UCBPTR),MDLABEL(@15)                      0565 01334000
         BE    @RF00565                                            0565 01335000
*       DO;                         /*                       @Y30LB37*/ 01336000
*         SA6MDAGL=''B;             /*                       @Y30LB37*/ 01337000
         XC    SA6MDAGL(37),SA6MDAGL                               0567 01338000
*         MYAGLPTR=ADDR(SA6MDAGL);  /*                       @Y30LB37*/ 01339000
         LA    @14,SA6MDAGL                                        0568 01340000
         ST    @14,MYAGLPTR                                        0568 01341000
*         MYAGLPTR->MDHEAD=DEMOUNT; /*                       @Y30LB37*/ 01342000
         MVC   MDHEAD(8,@14),DEMOUNT                               0569 01343000
*         MYAGLPTR->MDUCBPTR=MTAGLPTR->MDUCBPTR;/*           @Y30LB37*/ 01344000
         L     @07,MDUCBPTR(,@15)                                  0570 01345000
         ST    @07,MDUCBPTR(,@14)                                  0570 01346000
*         MYAGLPTR->MDDDNAME=MTAGLPTR->MDDDNAME;/*           @Y30LB37*/ 01347000
         MVC   MDDDNAME(8,@14),MDDDNAME(@15)                       0571 01348000
*         MYAGLPTR->MDPUAGL=NULLPTR;/*                       @Y30LB37*/ 01349000
         ST    @08,MDPUAGL(,@14)                                   0572 01350000
*         MYAGLPTR->MDLABEL=UCBVOLI;/*                       @Y30LB37*/ 01351000
         MVC   MDLABEL(6,@14),UCBVOLI(UCBPTR)                      0573 01352000
*         CALL DEMNTVOL(MYAGLPTR);  /*                       @Y30LB37*/ 01353000
         LA    @08,MYAGLPTR                                        0574 01354000
         ST    @08,@AL00001                                        0574 01355000
         LA    @01,@AL00001                                        0574 01356000
         BAL   @14,DEMNTVOL                                        0574 01357000
*         RESPECIFY                                                0575 01358000
*           RTNREG RSTD;                                           0575 01359000
*         TESTRC=RTNREG;                                           0576 01360000
         LR    TESTRC,RTNREG                                       0576 01361000
*         RESPECIFY                                                0577 01362000
*           RTNREG UNRSTD;          /*                       @Y30LB37*/ 01363000
*         IF TESTRC^=0 THEN                                        0578 01364000
         LTR   TESTRC,TESTRC                                       0578 01365000
         BZ    @RF00578                                            0578 01366000
*           MTCTLRC=RCDMFAIL;       /*                       @Y30LB37*/ 01367000
         LA    MTCTLRC,16                                          0579 01368000
*       END;                        /*                       @Y30LB37*/ 01369000
*     ELSE                                                         0581 01370000
*       MTCTLRC=RCMONTED;           /*                       @Y30LB37*/ 01371000
         B     @RC00565                                            0581 01372000
@RF00565 LA    MTCTLRC,8                                           0581 01373000
*                                                                  0582 01374000
*   /*****************************************************************/ 01375000
*   /*                                                               */ 01376000
*   /* THE MOUNT FUNCTION WILL BE TERMINATED ABNORMALLY IF   @Y30LB37*/ 01377000
*   /* A RETURN CODE OF 16 FROM DEMNTVOL. MESSAGE IDC2386I   @Y30LB37*/ 01378000
*   /* WILL BE SENT TO SYSPRINT TO INDICATE THE UNIT COULD   @Y30LB37*/ 01379000
*   /* NOT BE READIED FOR MOUNTING.                          @Y30LB37*/ 01380000
*   /*                                                               */ 01381000
*   /*****************************************************************/ 01382000
*                                                                  0582 01383000
*   IF MTCTLRC=RCDMFAIL THEN                                       0582 01384000
@RC00565 DS    0H                                                  0582 01385000
@RF00564 C     MTCTLRC,@CF00473                                    0582 01386000
         BNE   @RF00582                                            0582 01387000
*     DO;                           /*                       @Y30LB37*/ 01388000
*       DARGSMOD=MSGMODID;          /*                       @Y30LB37*/ 01389000
         L     @08,DDSTRU                                          0584 01390000
         MVC   DARGSMOD(3,@08),@CC02595                            0584 01391000
*       DARGSENT=MSG2386I;          /*                       @Y30LB37*/ 01392000
         MVI   DARGSENT(@08),X'06'                                 0585 01393000
*       DARGDBP=ADDR(MDDDNAME);     /*                       @Y30LB37*/ 01394000
         L     @15,@PC00005                                        0586 01395000
         L     @01,MTAGLPTR(,@15)                                  0586 01396000
         LA    @15,MDDDNAME(,@01)                                  0586 01397000
         ST    @15,DARGDBP(,@08)                                   0586 01398000
*       DARGILP=LENGTH(MDDDNAME);   /*                       @Y30LB37*/ 01399000
         MVC   DARGILP(2,@08),@CH00179                             0587 01400000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB37*/ 01401000
         L     @08,@PC00001                                        0588 01402000
         ST    @08,@AL00001                                        0588 01403000
         LA    @15,@CF00115                                        0588 01404000
         ST    @15,@AL00001+4                                      0588 01405000
         LA    @15,DDSTRU                                          0588 01406000
         ST    @15,@AL00001+8                                      0588 01407000
         MVI   @AL00001+8,X'80'                                    0588 01408000
         L     @15,GDTPRT(,@08)                                    0588 01409000
         LA    @01,@AL00001                                        0588 01410000
         BALR  @14,@15                                             0588 01411000
*     END;                          /*                       @Y30LB37*/ 01412000
*                                                                  0589 01413000
*   /*****************************************************************/ 01414000
*   /*                                                               */ 01415000
*   /* IF NO FAILURE HAS OCCURRED AND THE CALLER REQUESTED   @Y30LB37*/ 01416000
*   /* A UCB TO BE CLEARED PRIOR TO MOUNT AND THE MDCLEAR    @Y30LB37*/ 01417000
*   /* FLAG IS ON, THEN CALL UCBPOST TO RETURN THE PRESENT   @Y30LB37*/ 01418000
*   /* TTR AND THE VOLUME SERIAL, TO THE CALLER'S PRE-SET    @Y30LB37*/ 01419000
*   /* PUAGL POINTED TO OUT OF THE MDPUAGL FIELD.            @Y30LB37*/ 01420000
*   /*                                                               */ 01421000
*   /*****************************************************************/ 01422000
*                                                                  0590 01423000
*   IF MTCTLRC^=RCDMFAIL&MDCLEAR=ON THEN                           0590 01424000
@RF00582 C     MTCTLRC,@CF00473                                    0590 01425000
         BE    @RF00590                                            0590 01426000
         L     @08,@PC00005                                        0590 01427000
         L     @08,MTAGLPTR(,@08)                                  0590 01428000
         TM    MDCLEAR(@08),B'01000000'                            0590 01429000
         BNO   @RF00590                                            0590 01430000
*     DO;                           /*                       @Y30LB37*/ 01431000
*       RFY                                                        0592 01432000
*         PUAGL BASED(MDPUAGL);     /*                       @Y30LB37*/ 01433000
*       CALL UCBPOST(CLEAR,MDPUAGL);/*                       @Y30LB37*/ 01434000
         LA    @15,CLEAR                                           0593 01435000
         ST    @15,@AL00001                                        0593 01436000
         LA    @08,MDPUAGL(,@08)                                   0593 01437000
         ST    @08,@AL00001+4                                      0593 01438000
         LA    @01,@AL00001                                        0593 01439000
         BAL   @14,UCBPOST                                         0593 01440000
*       IF PUVOLRET^=ZEROVOL THEN                                  0594 01441000
         L     @08,@PC00005                                        0594 01442000
         L     @08,MTAGLPTR(,@08)                                  0594 01443000
         L     @08,MDPUAGL(,@08)                                   0594 01444000
         L     @15,PULABELP(,@08)                                  0594 01445000
         CLC   PUVOLRET(6,@15),ZEROVOL                             0594 01446000
         BE    @RF00594                                            0594 01447000
*         DO;                       /*                       @Y30LB37*/ 01448000
*           STARUCB=PUUCBADR;       /* INITIALIZE REAL UCB   @Y30LB37*/ 01449000
         L     @14,@PC00001                                        0596 01450000
         L     @01,GDTSAH(,@14)                                    0596 01451000
         L     @14,SAHSTA(,@01)                                    0596 01452000
         L     @01,PUUCBPTR(,@08)                                  0596 01453000
         L     @07,PUUCBADR(,@01)                                  0596 01454000
         ST    @07,STARUCB(,@14)                                   0596 01455000
*           STARVOL=PUVOLRET;       /* INIT RETURNED VOLSER  @Y30LB37*/ 01456000
         MVC   STARVOL(6,@14),PUVOLRET(@15)                        0597 01457000
*           STARTTR=PUTTRRET;       /* INIT RETURNED TTR     @Y30LB37*/ 01458000
         L     @08,PUTTRPTR(,@08)                                  0598 01459000
         MVC   STARTTR(4,@14),PUTTRRET(@08)                        0598 01460000
*           STACLEAR=ON;            /* TURN ON CLEARED FLAG  @Y30LB37*/ 01461000
         OI    STACLEAR(@14),B'00001000'                           0599 01462000
*         END;                      /*                       @Y30LB37*/ 01463000
*     END;                          /*                       @Y30LB37*/ 01464000
@RF00594 DS    0H                                                  0602 01465000
*                                                                  0602 01466000
*   /*****************************************************************/ 01467000
*   /*                                                               */ 01468000
*   /* IF RETURN CODE IS ZERO THEN CALL MOUNTVOL TO MOUNT    @Y30LB37*/ 01469000
*   /* AND READ THE LABEL OF THE 3330V VOLUME. IF AN ERROR   @Y30LB37*/ 01470000
*   /* OCCURRS FROM MOUNTVOL THEN PRINT MSG IDC2387I TO      @Y30LB37*/ 01471000
*   /* SYSPRINT TO INDICATE THE VOL COULD NOT BE MOUNTED.    @Y30LB37*/ 01472000
*   /*                                                               */ 01473000
*   /*****************************************************************/ 01474000
*                                                                  0602 01475000
*   IF MTCTLRC=0 THEN                                              0602 01476000
@RF00590 LTR   MTCTLRC,MTCTLRC                                     0602 01477000
         BNZ   @RF00602                                            0602 01478000
*     DO;                           /*                       @Y30LB37*/ 01479000
*       CALL MOUNTVOL(MTAGLPTR);    /*                       @Y30LB37*/ 01480000
         L     @08,@PC00005                                        0604 01481000
         ST    @08,@AL00001                                        0604 01482000
         LA    @01,@AL00001                                        0604 01483000
         BAL   @14,MOUNTVOL                                        0604 01484000
*       RESPECIFY                                                  0605 01485000
*         RTNREG RSTD;                                             0605 01486000
*       TESTRC=RTNREG;                                             0606 01487000
         LR    TESTRC,RTNREG                                       0606 01488000
*       RESPECIFY                                                  0607 01489000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 01490000
*       IF TESTRC^=0 THEN                                          0608 01491000
         LTR   TESTRC,TESTRC                                       0608 01492000
         BZ    @RF00608                                            0608 01493000
*         DO;                       /*                       @Y30LB37*/ 01494000
*           MTCTLRC=TESTRC;         /*                       @Y30LB37*/ 01495000
         LR    MTCTLRC,TESTRC                                      0610 01496000
*           DARGSMOD=MSGMODID;      /*                       @Y30LB37*/ 01497000
         L     @08,DDSTRU                                          0611 01498000
         MVC   DARGSMOD(3,@08),@CC02595                            0611 01499000
*           DARGSENT=MSG2387I;      /*                       @Y30LB37*/ 01500000
         MVI   DARGSENT(@08),X'07'                                 0612 01501000
*           DARGDBP=ADDR(MDLABEL);  /*                       @Y30LB37*/ 01502000
         L     @15,@PC00005                                        0613 01503000
         L     @01,MTAGLPTR(,@15)                                  0613 01504000
         LA    @15,MDLABEL(,@01)                                   0613 01505000
         ST    @15,DARGDBP(,@08)                                   0613 01506000
*           DARGILP=VOLSERLN;       /*                       @Y30LB37*/ 01507000
         MVC   DARGILP(2,@08),@CH00156                             0614 01508000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB37*/ 01509000
         L     @08,@PC00001                                        0615 01510000
         ST    @08,@AL00001                                        0615 01511000
         LA    @15,@CF00115                                        0615 01512000
         ST    @15,@AL00001+4                                      0615 01513000
         LA    @15,DDSTRU                                          0615 01514000
         ST    @15,@AL00001+8                                      0615 01515000
         MVI   @AL00001+8,X'80'                                    0615 01516000
         L     @15,GDTPRT(,@08)                                    0615 01517000
         LA    @01,@AL00001                                        0615 01518000
         BALR  @14,@15                                             0615 01519000
*         END;                      /*                       @Y30LB37*/ 01520000
*     END;                          /*                       @Y30LB37*/ 01521000
*                                                                  0617 01522000
@RF00608 DS    0H                                                  0618 01523000
*   /*****************************************************************/ 01524000
*   /*                                                               */ 01525000
*   /* IF RETURN CODE IS FOUR THEN MOUNT FAILED AND THE      @Y30LB37*/ 01526000
*   /* REAL UCB HAS TO BE POSTED BACK WITH THE CLEARED       @Y30LB37*/ 01527000
*   /* INFORMATION. SET THE CLEAR SWITCH OFF IN STAEPARM.    @Y30LB37*/ 01528000
*   /*                                                               */ 01529000
*   /*****************************************************************/ 01530000
*                                                                  0618 01531000
*   IF MTCTLRC=4&STACLEAR=ON THEN                                  0618 01532000
@RF00602 C     MTCTLRC,@CF00042                                    0618 01533000
         BNE   @RF00618                                            0618 01534000
         L     @08,@PC00001                                        0618 01535000
         L     @08,GDTSAH(,@08)                                    0618 01536000
         L     @08,SAHSTA(,@08)                                    0618 01537000
         TM    STACLEAR(@08),B'00001000'                           0618 01538000
         BNO   @RF00618                                            0618 01539000
*     DO;                           /*                       @Y30LB37*/ 01540000
*       RFY                                                        0620 01541000
*         PUAGL BASED(MDPUAGL);     /*                       @Y30LB37*/ 01542000
*       CALL UCBPOST(POST,MDPUAGL); /*                       @Y30LB37*/ 01543000
         LA    @08,POST                                            0621 01544000
         ST    @08,@AL00001                                        0621 01545000
         L     @08,@PC00005                                        0621 01546000
         L     @08,MTAGLPTR(,@08)                                  0621 01547000
         LA    @08,MDPUAGL(,@08)                                   0621 01548000
         ST    @08,@AL00001+4                                      0621 01549000
         LA    @01,@AL00001                                        0621 01550000
         BAL   @14,UCBPOST                                         0621 01551000
*       STACLEAR=OFF;               /* TURN OFF CLEAR SW     @Y30LB37*/ 01552000
         L     @08,@PC00001                                        0622 01553000
         L     @08,GDTSAH(,@08)                                    0622 01554000
         L     @08,SAHSTA(,@08)                                    0622 01555000
         NI    STACLEAR(@08),B'11110111'                           0622 01556000
*     END;                          /*                       @Y30LB37*/ 01557000
*                                                                  0624 01558000
*   /*****************************************************************/ 01559000
*   /*                                                               */ 01560000
*   /* IF THE POST OF THE VIRTUAL UCB FAILED BUT MOUNT       @Y30LB37*/ 01561000
*   /* WAS SUCCESSFUL (RETURN CODE 12), THEN SETUP A NEW     @Y30LB37*/ 01562000
*   /* MDAGL TO DEMOUNT THE MOUNTED VOLUME. IF THE MDCLEAR   @Y30LB37*/ 01563000
*   /* FLAG IS ON, THEN SET THE MDPOST FLAG ON AND USE THE   @Y30LB37*/ 01564000
*   /* CALLER'S PUAGL TO CLEAR FOR THE POSTING BACK OF THE   @Y30LB37*/ 01565000
*   /* CLEARED INFORMATION.                                  @Y30LB37*/ 01566000
*   /*                                                               */ 01567000
*   /*****************************************************************/ 01568000
*                                                                  0624 01569000
*   IF MTCTLRC=RCNOPOST THEN                                       0624 01570000
@RF00618 C     MTCTLRC,@CF00037                                    0624 01571000
         BNE   @RF00624                                            0624 01572000
*     DO;                           /*                       @Y30LB37*/ 01573000
*       MNTSTATS=MNTERROR;          /*                       @Y30LB37*/ 01574000
         MVC   MNTSTATS(8),MNTERROR                                0626 01575000
*       SA6MDAGL=''B;               /*                       @Y30LB37*/ 01576000
         XC    SA6MDAGL(37),SA6MDAGL                               0627 01577000
*       MYAGLPTR=ADDR(SA6MDAGL);    /*                       @Y30LB37*/ 01578000
         LA    @08,SA6MDAGL                                        0628 01579000
         ST    @08,MYAGLPTR                                        0628 01580000
*       MYAGLPTR->MDHEAD=DEMOUNT;   /*                       @Y30LB37*/ 01581000
         MVC   MDHEAD(8,@08),DEMOUNT                               0629 01582000
*       MYAGLPTR->MDUCBPTR=MTAGLPTR->MDUCBPTR;/*             @Y30LB37*/ 01583000
         L     @15,@PC00005                                        0630 01584000
         L     @15,MTAGLPTR(,@15)                                  0630 01585000
         L     @14,MDUCBPTR(,@15)                                  0630 01586000
         ST    @14,MDUCBPTR(,@08)                                  0630 01587000
*       MYAGLPTR->MDDDNAME=MTAGLPTR->MDDDNAME;/*             @Y30LB37*/ 01588000
         MVC   MDDDNAME(8,@08),MDDDNAME(@15)                       0631 01589000
*       MYAGLPTR->MDLABEL=MTAGLPTR->MDLABEL;/*               @Y30LB37*/ 01590000
         MVC   MDLABEL(6,@08),MDLABEL(@15)                         0632 01591000
*       MYAGLPTR->MDPUAGL=NULLPTR;  /*                       @Y30LB37*/ 01592000
         SLR   @14,@14                                             0633 01593000
         ST    @14,MDPUAGL(,@08)                                   0633 01594000
*       MYAGLPTR->MDWAIT=ON;        /*                       @YM04317*/ 01595000
         OI    MDWAIT(@08),B'00010000'                             0634 01596000
*       IF MTAGLPTR->MDENQ=ON THEN                                 0635 01597000
         TM    MDENQ(@15),B'00001000'                              0635 01598000
         BNO   @RF00635                                            0635 01599000
*         MYAGLPTR->MDENQ=ON;       /*                       @Y30LB37*/ 01600000
         OI    MDENQ(@08),B'00001000'                              0636 01601000
*       IF STACLEAR=ON THEN                                        0637 01602000
@RF00635 L     @08,@PC00001                                        0637 01603000
         L     @08,GDTSAH(,@08)                                    0637 01604000
         L     @08,SAHSTA(,@08)                                    0637 01605000
         TM    STACLEAR(@08),B'00001000'                           0637 01606000
         BNO   @RF00637                                            0637 01607000
*         DO;                       /*                       @Y30LB37*/ 01608000
*           MYAGLPTR->MDPOST=ON;    /*                       @Y30LB37*/ 01609000
         L     @08,MYAGLPTR                                        0639 01610000
         OI    MDPOST(@08),B'00100000'                             0639 01611000
*           MYAGLPTR->MDPUAGL=MTAGLPTR->MDPUAGL;/*           @Y30LB37*/ 01612000
         L     @15,@PC00005                                        0640 01613000
         L     @01,MTAGLPTR(,@15)                                  0640 01614000
         L     @15,MDPUAGL(,@01)                                   0640 01615000
         ST    @15,MDPUAGL(,@08)                                   0640 01616000
*         END;                      /*                       @Y30LB37*/ 01617000
*       CALL DEMNTVOL(MYAGLPTR);    /*                       @Y30LB37*/ 01618000
@RF00637 LA    @08,MYAGLPTR                                        0642 01619000
         ST    @08,@AL00001                                        0642 01620000
         LA    @01,@AL00001                                        0642 01621000
         BAL   @14,DEMNTVOL                                        0642 01622000
*     END;                          /*                       @Y30LB37*/ 01623000
*                                                                  0644 01624000
*   /*****************************************************************/ 01625000
*   /*                                                               */ 01626000
*   /* RETURN CODE OF EIGHT WILL BE TRANSLATED TO A ZERO     @Y30LB37*/ 01627000
*   /* MEANING VOLUME ALREADY MOUNTED. RETURN CODE OF        @Y30LB37*/ 01628000
*   /* TWELVE WILL BE TRANSLATED TO A FOUR MEANING MOUNT     @Y30LB37*/ 01629000
*   /* FAILED.                                               @Y30LB37*/ 01630000
*   /*                                                               */ 01631000
*   /*****************************************************************/ 01632000
*                                                                  0644 01633000
*   IF MTCTLRC=RCMONTED THEN                                       0644 01634000
@RF00624 C     MTCTLRC,@CF00179                                    0644 01635000
         BNE   @RF00644                                            0644 01636000
*     MTCTLRC=0;                    /*                       @Y30LB37*/ 01637000
         SLR   MTCTLRC,MTCTLRC                                     0645 01638000
*   ELSE                                                           0646 01639000
*     IF MTCTLRC=RCNOPOST|MTCTLRC=RCDMFAIL THEN                    0646 01640000
         B     @RC00644                                            0646 01641000
@RF00644 C     MTCTLRC,@CF00037                                    0646 01642000
         BE    @RT00646                                            0646 01643000
         C     MTCTLRC,@CF00473                                    0646 01644000
         BNE   @RF00646                                            0646 01645000
@RT00646 DS    0H                                                  0647 01646000
*       MTCTLRC=4;                  /*                       @Y30LB37*/ 01647000
         LA    MTCTLRC,4                                           0647 01648000
*   RETURN CODE(MTCTLRC);           /* RETURN TO MAIN ROUTINE      0648 01649000
*                                                            @Y30LB37*/ 01650000
@RF00646 DS    0H                                                  0648 01651000
@RC00644 LR    @15,MTCTLRC                                         0648 01652000
         L     @14,@SA00005                                        0648 01653000
         LM    @00,@12,@SA00005+8                                  0648 01654000
         BR    @14                                                 0648 01655000
*   END MOUNTCTL;                   /* END OF MOUNTCTL TO MOUNT A  0649 01656000
*                                      VIRTUAL VOLUME        @Y30LB37*/ 01657000
*                                                                  0650 01658000
*/********************************************************************/ 01659000
*/*                                                                  */ 01660000
*/*  PROCEDURE NAME - MOUNTVOL                               @Y30LB37*/ 01661000
*/*                                                          @Y30LB37*/ 01662000
*/*  FUNCTION - THIS IS THE SECOND CONTROLLING ROUTINE       @Y30LB37*/ 01663000
*/*             FOR THE MOUNTING OF A 3330V VIRTUAL          @Y30LB37*/ 01664000
*/*             VOLUME. IT WILL PERFORM THE SETUP TO CALL    @Y30LB37*/ 01665000
*/*             SUBORDINATE FUNCTIONS ISSUEMNT, RDLABEL      @Y30LB37*/ 01666000
*/*             AND ENQDEQ TO ACHIEVE THE MOUNTING 0F A      @Y30LB37*/ 01667000
*/*             3330V VOLUME. IT ALSO, POSTS A UCB AFTER     @Y30LB37*/ 01668000
*/*             THE MOUNTING THE VIRTUAL VOLUME.             @Y30LB37*/ 01669000
*/*                                                          @Y30LB37*/ 01670000
*/*  INPUT - THE INPUT ARGUMENT LIST MDAGL IS USED TO        @Y30LB37*/ 01671000
*/*          SET UP THE MOUNT REQUEST. THE UCB IS POINTED    @Y30LB37*/ 01672000
*/*          TO OUT OF THE MDAGL AND IS USED TO READ THE     @Y30LB37*/ 01673000
*/*          VOLUME SERIAL MOUNTED.                          @Y30LB37*/ 01674000
*/*                                                          @Y30LB37*/ 01675000
*/*  OUTPUT- IS IN THE FORM OF A COMPLETED MOUNT REQUEST     @Y30LB37*/ 01676000
*/*          AND A POSTED UCB IF THE MOUNT WAS SUCCESSFUL.   @Y30LB37*/ 01677000
*/*          RETURN CODES IN REG15 ARE AS FOLLOWS:           @Y30LB37*/ 01678000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 01679000
*/*          4 - VOLUME NOT MOUNTED                          @Y30LB37*/ 01680000
*/*         12 - VOLUME MOUNTED BUT NOT POSTED               @Y30LB37*/ 01681000
*/*                                                                  */ 01682000
*/********************************************************************/ 01683000
*                                                                  0650 01684000
*MOUNTVOL:                                                         0650 01685000
*   PROCEDURE(MTMDAGLP);            /*                       @Y30LB37*/ 01686000
*                                                                  0650 01687000
MOUNTVOL STM   @14,@12,@SA00006                                    0650 01688000
         MVC   @PC00006(4),0(@01)                                  0650 01689000
*   /*****************************************************************/ 01690000
*   /*                                                               */ 01691000
*   /* LOCAL DECLARATIONS FOR MOUNTVOL                       @Y30LB37*/ 01692000
*   /*                                                               */ 01693000
*   /*****************************************************************/ 01694000
*                                                                  0651 01695000
*   DCL                                                            0651 01696000
*     MTVOLRC FIXED(15);            /* MOUNTVOL RETURN CODE  @Y30LB37*/ 01697000
*   DCL                                                            0652 01698000
*     MTMDAGLP PTR(31);             /* PTR TO MDAGL          @Y30LB37*/ 01699000
*   DCL                                                            0653 01700000
*     MTPUAGL BDY(WORD)             /* PUAGL FOR POSTING     @Y30LB37*/ 01701000
*         CHAR(LENGTH(PUAGL));      /* A UCB                 @Y30LB37*/ 01702000
*   DCL                                                            0654 01703000
*     MTPUAGLP PTR(31);             /* PTR TO THE MTPUAGL    @Y30LB37*/ 01704000
*                                                                  0655 01705000
*   /*****************************************************************/ 01706000
*   /*                                                               */ 01707000
*   /* RESPECIFY MDAGL BASED ON PARAMETER BEFORE ISSUING     @Y30LB37*/ 01708000
*   /* UTRACE MACRO.                                         @Y30LB37*/ 01709000
*   /*                                                               */ 01710000
*   /*****************************************************************/ 01711000
*                                                                  0655 01712000
*   RFY                                                            0655 01713000
*     MDAGL BASED(MTMDAGLP);        /*                       @Y30LB37*/ 01714000
*   OLDERID2=NEWERID2;                                             0656 01715000
         L     @08,@PC00001                                        0656 01716000
         L     @08,GDTTR2(,@08)                                    0656 01717000
         MVC   @TS00001(95),NEWERID2(@08)                          0656 01718000
         MVC   OLDERID2(95,@08),@TS00001                           0656 01719000
*   NEWID2='SAMT';                  /*                       @Y30LB37*/ 01720000
*                                                                  0657 01721000
         MVC   NEWID2(4,@08),@CC02714                              0657 01722000
*   /*****************************************************************/ 01723000
*   /*                                                               */ 01724000
*   /* ENQDEQ IS CALLED TO DETERMINE IF AN ENQUEUE IS        @Y30LB37*/ 01725000
*   /* REQUIRED ON THE VOLUME SERIAL.                        @Y30LB37*/ 01726000
*   /*                                                               */ 01727000
*   /*****************************************************************/ 01728000
*                                                                  0658 01729000
*   CALL ENQDEQ(ENQCMD,MTMDAGLP);   /*                       @Y30LB37*/ 01730000
         LA    @08,ENQCMD                                          0658 01731000
         ST    @08,@AL00001                                        0658 01732000
         L     @08,@PC00006                                        0658 01733000
         ST    @08,@AL00001+4                                      0658 01734000
         LA    @01,@AL00001                                        0658 01735000
         BAL   @14,ENQDEQ                                          0658 01736000
*   RESPECIFY                                                      0659 01737000
*     RTNREG RSTD;                                                 0659 01738000
*   TESTRC=RTNREG;                                                 0660 01739000
         LR    TESTRC,RTNREG                                       0660 01740000
*   RESPECIFY                                                      0661 01741000
*     RTNREG UNRSTD;                /*                       @Y30LB37*/ 01742000
*   MTVOLRC=TESTRC;                 /*                       @Y30LB37*/ 01743000
*                                                                  0662 01744000
         LR    MTVOLRC,TESTRC                                      0662 01745000
*   /*****************************************************************/ 01746000
*   /*                                                               */ 01747000
*   /* IF THE RETURN CODE IS ZERO THEN CALL ISSUEMNT TO      @Y30LB37*/ 01748000
*   /* COMPLETE THE MOUNT REQUEST. IF MOUNT FAILS THEN       @Y30LB37*/ 01749000
*   /* ISSUE A DEQ REQUEST TO ENQDEQ TO DEQUEUE THE VOLSER.  @Y30LB37*/ 01750000
*   /* IF MOUNT IS OK, BUT ACQUIRE FAILS THEN DON'T DEQ.     @Y30LB37*/ 01751000
*   /*                                                               */ 01752000
*   /*****************************************************************/ 01753000
*                                                                  0663 01754000
*   IF MTVOLRC=0 THEN                                              0663 01755000
         LTR   MTVOLRC,MTVOLRC                                     0663 01756000
         BNZ   @RF00663                                            0663 01757000
*     DO;                           /*                       @Y30LB37*/ 01758000
*       CALL ISSUEMNT(MTMDAGLP);    /*                       @Y30LB37*/ 01759000
         L     @08,@PC00006                                        0665 01760000
         ST    @08,@AL00001                                        0665 01761000
         LA    @01,@AL00001                                        0665 01762000
         BAL   @14,ISSUEMNT                                        0665 01763000
*       RESPECIFY                                                  0666 01764000
*         RTNREG RSTD;                                             0666 01765000
*       TESTRC=RTNREG;                                             0667 01766000
         LR    TESTRC,RTNREG                                       0667 01767000
*       RESPECIFY                                                  0668 01768000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 01769000
*       MTVOLRC=TESTRC;             /*                       @Y30LB37*/ 01770000
         LR    MTVOLRC,TESTRC                                      0669 01771000
*       IF MTVOLRC=4&MDENQ=ON THEN                                 0670 01772000
         C     MTVOLRC,@CF00042                                    0670 01773000
         BNE   @RF00670                                            0670 01774000
         L     @08,@PC00006                                        0670 01775000
         L     @05,MTMDAGLP(,@08)                                  0670 01776000
         TM    MDENQ(@05),B'00001000'                              0670 01777000
         BNO   @RF00670                                            0670 01778000
*         CALL ENQDEQ(DEQCMD,MTMDAGLP);/*                    @Y30LB37*/ 01779000
         LA    @05,DEQCMD                                          0671 01780000
         ST    @05,@AL00001                                        0671 01781000
         ST    @08,@AL00001+4                                      0671 01782000
         LA    @01,@AL00001                                        0671 01783000
         BAL   @14,ENQDEQ                                          0671 01784000
*     END;                          /*                       @Y30LB37*/ 01785000
@RF00670 DS    0H                                                  0673 01786000
*                                                                  0673 01787000
*   /*****************************************************************/ 01788000
*   /*                                                               */ 01789000
*   /* TO DETERMINE WHERE THE VTOC IS LOCATED ON THE VOLUME  @Y30LB37*/ 01790000
*   /* THE LABEL IS READ BY CALLING RDLABEL. IF THE VOLUME   @ZA05112*/ 01791000
*   /* JUST MOUNTED IS NOT NEW (MDNEWVOL IS OFF), STAVTTR    @ZA05112*/ 01792000
*   /* IS FILLED FROM THE LABEL. IF RDLABEL IS NOT           @ZA05112*/ 01793000
*   /* SUCCESSFUL, THEN SET THE RETURN CODE TO 12            @ZA05112*/ 01794000
*   /* TO INDICATE THAT THE VOLUME WAS MOUNTED BUT WAS       @ZA05112*/ 01795000
*   /* NOT POSTED.                                           @ZA05112*/ 01796000
*   /*                                                               */ 01797000
*   /*****************************************************************/ 01798000
*                                                                  0673 01799000
*   IF MTVOLRC=0 THEN                                              0673 01800000
@RF00663 LTR   MTVOLRC,MTVOLRC                                     0673 01801000
         BNZ   @RF00673                                            0673 01802000
*     IF MDNEWVOL=OFF THEN                                         0674 01803000
         L     @08,@PC00006                                        0674 01804000
         L     @05,MTMDAGLP(,@08)                                  0674 01805000
         TM    MDNEWVOL(@05),B'10000000'                           0674 01806000
         BNZ   @RF00674                                            0674 01807000
*       DO;                         /*                       #Y30LB37*/ 01808000
*         CALL RDLABEL(MTMDAGLP);   /*                       #Y30LB37*/ 01809000
         ST    @08,@AL00001                                        0676 01810000
         LA    @01,@AL00001                                        0676 01811000
         BAL   @14,RDLABEL                                         0676 01812000
*         RESPECIFY                                                0677 01813000
*           RTNREG RSTD;                                           0677 01814000
*         TESTRC=RTNREG;                                           0678 01815000
         LR    TESTRC,RTNREG                                       0678 01816000
*         RESPECIFY                                                0679 01817000
*           RTNREG UNRSTD;          /*                       #Y30LB37*/ 01818000
*         IF TESTRC^=0 THEN                                        0680 01819000
         LTR   TESTRC,TESTRC                                       0680 01820000
         BZ    @RF00680                                            0680 01821000
*           MTVOLRC=RCNOPOST;       /*                       #Y30LB37*/ 01822000
         LA    MTVOLRC,12                                          0681 01823000
*         ELSE                                                     0682 01824000
*           STAVTTR=TTRWORK;        /*                       @ZA05112*/ 01825000
         B     @RC00680                                            0682 01826000
@RF00680 L     @08,@PC00001                                        0682 01827000
         L     @08,GDTSAH(,@08)                                    0682 01828000
         L     @08,SAHSTA(,@08)                                    0682 01829000
         MVC   STAVTTR(4,@08),TTRWORK                              0682 01830000
*       END;                        /*                       #Y30LB37*/ 01831000
@RC00680 DS    0H                                                  0684 01832000
*                                                                  0684 01833000
*   /*****************************************************************/ 01834000
*   /*                                                               */ 01835000
*   /* THE UCBPOST ROUTINE IS CALLED TO HAVE THE VOLUME      #Y30LB37*/ 01836000
*   /* LABEL AND TTR TO THE VTOC POSTED IN THE VIRTUAL UCB.  #Y30LB37*/ 01837000
*   /* TURN ON POST TRACKING FLAG STAVPOST IF SUCCESSFUL.    #Y30LB37*/ 01838000
*   /* IF AN ERROR IN POST THEN SET RETURN CODE TO 12.       #Y30LB37*/ 01839000
*   /*                                                               */ 01840000
*   /*****************************************************************/ 01841000
*                                                                  0684 01842000
*   IF MTVOLRC=0 THEN                                              0684 01843000
@RF00674 DS    0H                                                  0684 01844000
@RF00673 LTR   MTVOLRC,MTVOLRC                                     0684 01845000
         BNZ   @RF00684                                            0684 01846000
*     DO;                           /*                       #Y30LB37*/ 01847000
*       MTPUAGLP=ADDR(MTPUAGL);     /*                       #Y30LB37*/ 01848000
         LA    @08,MTPUAGL                                         0686 01849000
         ST    @08,MTPUAGLP                                        0686 01850000
*       MTPUAGLP->PUHEAD=POST;      /*                       #Y30LB37*/ 01851000
         MVC   PUHEAD(8,@08),POST                                  0687 01852000
*       MTPUAGLP->PUUCBPTR=MDUCBPTR;/*                       #Y30LB37*/ 01853000
         L     @05,@PC00006                                        0688 01854000
         L     @05,MTMDAGLP(,@05)                                  0688 01855000
         L     @15,MDUCBPTR(,@05)                                  0688 01856000
         ST    @15,PUUCBPTR(,@08)                                  0688 01857000
*       MTPUAGLP->PUTTRPTR=ADDR(TTRWORK);/*                  #Y30LB37*/ 01858000
         LA    @15,TTRWORK                                         0689 01859000
         ST    @15,PUTTRPTR(,@08)                                  0689 01860000
*       MTPUAGLP->PULABELP=ADDR(MDLABEL);/*                  #Y30LB37*/ 01861000
         LA    @05,MDLABEL(,@05)                                   0690 01862000
         ST    @05,PULABELP(,@08)                                  0690 01863000
*       CALL UCBPOST(POST,MTPUAGLP);/*                       #Y30LB37*/ 01864000
         LA    @08,POST                                            0691 01865000
         ST    @08,@AL00001                                        0691 01866000
         LA    @08,MTPUAGLP                                        0691 01867000
         ST    @08,@AL00001+4                                      0691 01868000
         LA    @01,@AL00001                                        0691 01869000
         BAL   @14,UCBPOST                                         0691 01870000
*       RESPECIFY                                                  0692 01871000
*         RTNREG RSTD;                                             0692 01872000
*       TESTRC=RTNREG;                                             0693 01873000
         LR    TESTRC,RTNREG                                       0693 01874000
*       RESPECIFY                                                  0694 01875000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 01876000
*       IF TESTRC^=0 THEN                                          0695 01877000
         LTR   TESTRC,TESTRC                                       0695 01878000
         BZ    @RF00695                                            0695 01879000
*         MTVOLRC=RCNOPOST;         /*                       #Y30LB37*/ 01880000
         LA    MTVOLRC,12                                          0696 01881000
*       ELSE                                                       0697 01882000
*         STAVPOST=ON;              /* TURN ON POST TRACKING #Y30LB37*/ 01883000
         B     @RC00695                                            0697 01884000
@RF00695 L     @08,@PC00001                                        0697 01885000
         L     @08,GDTSAH(,@08)                                    0697 01886000
         L     @08,SAHSTA(,@08)                                    0697 01887000
         OI    STAVPOST(@08),B'00010000'                           0697 01888000
*     END;                          /*                       #Y30LB37*/ 01889000
@RC00695 DS    0H                                                  0699 01890000
*   RETURN CODE(MTVOLRC);           /* RETURN TO MAIN ROUTINE      0699 01891000
*                                                            #Y30LB37*/ 01892000
@RF00684 LR    @15,MTVOLRC                                         0699 01893000
         L     @14,@SA00006                                        0699 01894000
         LM    @00,@12,@SA00006+8                                  0699 01895000
         BR    @14                                                 0699 01896000
*   END MOUNTVOL;                   /* END OF MOUNTVOL TO MOUNT A  0700 01897000
*                                      VIRTUAL VOLUME        #Y30LB37*/ 01898000
*                                                                  0701 01899000
*/********************************************************************/ 01900000
*/*                                                                  */ 01901000
*/*  PROCEDURE NAME - ISSUEMNT                               #Y30LB37*/ 01902000
*/*                                                          #Y30LB37*/ 01903000
*/*  FUNCTION - THIS ROUTINE WILL PREPARE AND ISSUE THE      #Y30LB37*/ 01904000
*/*             USSC MACRO TO MOUNT A 3330V VIRTUAL          #Y30LB37*/ 01905000
*/*             VOLUME. IF THE MOUNT IS SUCCESSFUL IT        #Y30LB37*/ 01906000
*/*             THEN ISSUES AN ACQUIRE USSC MACRO TO         #Y30LB37*/ 01907000
*/*             ACQUIRE THE CYLINDER ZERO OF THE VOLUME.     #Y30LB37*/ 01908000
*/*                                                          #Y30LB37*/ 01909000
*/*  INPUT - THE INPUT ARGUMENT LIST MDAGL IS USED TO        #Y30LB37*/ 01910000
*/*          SET UP THE USSC MACRO. THE UCB IS POINTED       #Y30LB37*/ 01911000
*/*          TO OUT OF THE MDAGL AND IS USED TO GET          #Y30LB37*/ 01912000
*/*          THE UCB'S UNIT ADDRESS.                         #Y30LB37*/ 01913000
*/*                                                          #Y30LB37*/ 01914000
*/*  OUTPUT- IS IN THE FORM OF A COMPLETED MOUNT AND A       #Y30LB37*/ 01915000
*/*          ACQUIRED CYL 0 IF THE MOUNT WAS SUCCESSFUL.     #Y30LB37*/ 01916000
*/*          RETURN CODES ARE AS FOLLOWS:                    #Y30LB37*/ 01917000
*/*          0 - SUCCESSFUL                                  #Y30LB37*/ 01918000
*/*          4 - USSC MOUNT FAILED                           #Y30LB37*/ 01919000
*/*         12 - ACQUIRE FAILED                              #Y30LB37*/ 01920000
*/*                                                                  */ 01921000
*/********************************************************************/ 01922000
*                                                                  0701 01923000
*ISSUEMNT:                                                         0701 01924000
*   PROCEDURE(IMMDAGLP);            /*                       #Y30LB37*/ 01925000
*                                                                  0701 01926000
ISSUEMNT STM   @14,@12,@SA00007                                    0701 01927000
         MVC   @PC00007(4),0(@01)                                  0701 01928000
*   /*****************************************************************/ 01929000
*   /*                                                               */ 01930000
*   /* LOCAL DECLARATIONS FOR ISSUEMNT                       #Y30LB37*/ 01931000
*   /*                                                               */ 01932000
*   /*****************************************************************/ 01933000
*                                                                  0702 01934000
*   DCL                                                            0702 01935000
*     ISUEMRC FIXED(15);            /* ISSUEMNT RETURN CODE  #Y30LB37*/ 01936000
*   DCL                                                            0703 01937000
*     IMMDAGLP PTR(31);             /* PTR TO MDAGL          #Y30LB37*/ 01938000
*   DCL                                                            0704 01939000
*     MNTLPTR PTR(31);              /* PTR TO THE MNTLIST    #Y30LB37*/ 01940000
*   DCL                                                            0705 01941000
*     ACQLPTR PTR(31);              /* PTR TO THE ACQLIST    @Y30LB37*/ 01942000
*   DCL                                                            0706 01943000
*     ACQOP FIXED(8) STATIC         /* ACQUIRE OPERATION     @Y30LB37*/ 01944000
*         INIT('02'X);              /* CODE                  #Y30LB37*/ 01945000
*   DCL                                                            0707 01946000
*     DEFALTTR CHAR(4) STATIC       /* DEFAULT TTR TO        @ZA05112*/ 01947000
*         INIT('00010100'X);        /* THE VTOC              @ZA05112*/ 01948000
*   DCL                                                            0708 01949000
*     DEFTTR CHAR(2) INIT('0100'X); /* DEFAULT VTOC HH       @ZDR2057*/ 01950000
*   DCL                                                            0709 01951000
*     MDREG1 REG(1) PTR;            /* ADDRESS OF REQUEST BLOCK    0709 01952000
*                                                            @Y30LB02*/ 01953000
*                                                                  0709 01954000
*   /*****************************************************************/ 01955000
*   /*                                                               */ 01956000
*   /* ********************************************************      */ 01957000
*   /*                                                       @Y30LB02*/ 01958000
*   /* MACMEAN MSSC MOUNT MACRO                              @Y30LB02*/ 01959000
*   /* VS2-3 VERSION--02/06/76                               @G18MB04*/ 01960000
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/ 01961000
*   /* ********************************************************      */ 01962000
*   /*                                                       @Y30LB02*/ 01963000
*   /*                                                               */ 01964000
*   /*****************************************************************/ 01965000
*                                                                  0710 01966000
*   DCL                                                            0710 01967000
*     1 MNTLIST BASED(MNTLPTR),     /* MOUNT REQUEST BLOCK   @Y30LB02*/ 01968000
*      2 MDLEN FIXED(31),           /* LENGTH OF BLOCK = 1C HEX BYTES   01969000
*                                                            @Y30LB02*/ 01970000
*      2 MDOPCD FIXED(8),           /* MOUNT OPCODE = 08 HEX @Y30LB02*/ 01971000
*      2 * CHAR(1),                 /* ONE BYTE OF ZERO      @Y30LB02*/ 01972000
*      2 MDFLG BIT(16),             /* FLAGS AREA            @Y30LB02*/ 01973000
*       3 * BIT(1),                 /* RESERVED              @YD00125*/ 01974000
*       3 MDVISMNT BIT(1),          /* MSVC ISSUING THE MOUNT      0710 01975000
*                                                            @Y30LB02*/ 01976000
*       3 MDVSVRQ BIT(1),           /* MSVC SECONDARY VOLUME REQUEST    01977000
*                                                            @Y30LB02*/ 01978000
*       3 MDSRTCH BIT(1),           /* SCRATCH               @Y30LB02*/ 01979000
*       3 MDMEXT BIT(1),            /* MOUNT EXTENSION       @G18MB04*/ 01980000
*       3 * BIT(11),                /* RESERVED BITS         @YD00125*/ 01981000
*      2 MDVOL CHAR(6),             /* VOLID                 @Y30LB02*/ 01982000
*      2 MDVUA FIXED(15),           /* VIRTUAL UNIT ADDRESS  @Y30LB02*/ 01983000
*      2 MDHOST CHAR(5),            /* 5-BYTES HOSTID AREA   @Y30LB02*/ 01984000
*      2 * CHAR(3),                 /* RESERVED              @Y30LB02*/ 01985000
*      2 MNTEXTP PTR(31),           /* ADDRESS OF MOUNT LIST       0710 01986000
*                                      EXTENSION             @G18MB04*/ 01987000
*       3 MDJFCB FIXED(31);         /* ADDRESS OF JFCB       @G18MB04   01988000
*                                      MNT                   #Y30LB37*/ 01989000
*                                                                  0711 01990000
*   /*****************************************************************/ 01991000
*   /*                                                               */ 01992000
*   /* CONTINUED LOCAL DECLARATIONS FOR ISSUEMNT             #Y30LB37*/ 01993000
*   /*                                                               */ 01994000
*   /*****************************************************************/ 01995000
*                                                                  0711 01996000
*   DCL                                                            0711 01997000
*     ARR1 REG(1) PTR;              /* WILL CONTAIN LIST ADDRESS   0711 01998000
*                                                            @Y30LB02*/ 01999000
*                                                                  0711 02000000
*   /*****************************************************************/ 02001000
*   /*                                                               */ 02002000
*   /* *******************************************************       */ 02003000
*   /*                                                       @Y30LB02*/ 02004000
*   /* MACMEAN MSSC ACQUIRE/RELINQUISH MACRO                 @Y30LB02*/ 02005000
*   /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                @Y30LB02*/ 02006000
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/ 02007000
*   /* *******************************************************       */ 02008000
*   /*                                                       @Y30LB02*/ 02009000
*   /*                                                               */ 02010000
*   /*****************************************************************/ 02011000
*                                                                  0712 02012000
*   DCL                                                            0712 02013000
*     1 ACQLIST BASED(ACQLPTR),                                    0712 02014000
*      2 ARLL FIXED(31),            /* LENGTH=96 BYTES       @Y30LB02*/ 02015000
*      2 AROP FIXED(8),             /* OPCODE=02             @Y30LB02*/ 02016000
*      2 * CHAR(1),                 /* RESERVED AREA         @Y30LB02*/ 02017000
*      2 ARFLG BIT(8),              /* FLAGS                 @Y30LB02*/ 02018000
*       3 ARBDUBD BIT(1),           /* BIND/UNBIND BIT       @Y30LB02*/ 02019000
*       3 ARDRES BIT(1),            /* DELAYED RESPONSE BIT  @Y30LB02*/ 02020000
*       3 ARINH BIT(1),             /* INHIBIT (DE)STAGE BIT @Y30LB02*/ 02021000
*       3 * BIT(5),                 /* THESE BITS ALWAYS ZEROES    0712 02022000
*                                                            @Y30LB02*/ 02023000
*      2 ARNMEXT FIXED(8),          /* #EXTS                 @Y30LB02*/ 02024000
*      2 ARVOL CHAR(6),             /* VOLID                 @Y30LB02*/ 02025000
*      2 ARASID CHAR(2),            /* ASID FIELD            @Y30LB02*/ 02026000
*      2 ARECB FIXED(31),           /* ADDR OF ECB           @Y30LB02*/ 02027000
*      2 ARHOST CHAR(5),            /* HOSTID                @Y30LB02*/ 02028000
*      2 * CHAR(1),                 /* ZEROES                @Y30LB02*/ 02029000
*      2 ARCOMPC CHAR(2),           /* COMP CODE             @Y30LB02*/ 02030000
*      2 AREXT(16),                 /* EXTENTS               @Y30LB02*/ 02031000
*       3 * CHAR(4),                /* ELEMENT OF EXTS ARRAY @Y30LB02*/ 02032000
*      2 ARNEDB FIXED(31);          /* ADDR OF NEDB          @Y30LB02   02033000
*                                      ACQ                   #Y30LB37*/ 02034000
*                                                                  0713 02035000
*   /*****************************************************************/ 02036000
*   /*                                                               */ 02037000
*   /* STORAGE AREAS FOR MOUNT AND ACQUIRE ARGUMENT LISTS.   #Y30LB37*/ 02038000
*   /*                                                               */ 02039000
*   /*****************************************************************/ 02040000
*                                                                  0713 02041000
*   DCL                                                            0713 02042000
*     MNTLST CHAR(LENGTH(MNTLIST))  /* STORAGE AREA FOR      #Y30LB37*/ 02043000
*         BDY(WORD);                /* MOUNT ARGUMENT LIST   #Y30LB37*/ 02044000
*   DCL                                                            0714 02045000
*     ACQLST CHAR(LENGTH(ACQLIST))  /* STORAGE AREA FOR      #Y30LB37*/ 02046000
*         BDY(WORD);                /* ACQUIRE ARGUMENT LIST #Y30LB37*/ 02047000
*                                                                  0715 02048000
*   /*****************************************************************/ 02049000
*   /*                                                               */ 02050000
*   /* RESPECIFY MDAGL ON INPUT PARAMETER AND INITIALIZE     #Y30LB37*/ 02051000
*   /* RETURN CODE AREA AND ISSUE UTRACE MACRO.              #Y30LB37*/ 02052000
*   /*                                                               */ 02053000
*   /*****************************************************************/ 02054000
*                                                                  0715 02055000
*   RFY                                                            0715 02056000
*     MDAGL BASED(IMMDAGLP);        /*                       #Y30LB37*/ 02057000
*   OLDERID2=NEWERID2;                                             0716 02058000
         L     @08,@PC00001                                        0716 02059000
         L     @04,GDTTR2(,@08)                                    0716 02060000
         MVC   @TS00001(95),NEWERID2(@04)                          0716 02061000
         MVC   OLDERID2(95,@04),@TS00001                           0716 02062000
*   NEWID2='SAIM';                  /*                       #Y30LB37*/ 02063000
         MVC   NEWID2(4,@04),@CC02773                              0717 02064000
*   MNTLPTR=ADDR(MNTLST);           /* INIT ARGUMENT LIST PTR      0718 02065000
*                                                            #Y30LB37*/ 02066000
         LA    @04,MNTLST                                          0718 02067000
         ST    @04,MNTLPTR                                         0718 02068000
*   MNTLST=''B;                     /* CLEAR THE MOUNT LIST  #Y30LB37*/ 02069000
         XC    MNTLST(28),MNTLST                                   0719 02070000
*   ACQLPTR=ADDR(ACQLST);           /* INIT ARGUMENT LIST PTR      0720 02071000
*                                                            #Y30LB37*/ 02072000
         LA    @04,ACQLST                                          0720 02073000
         ST    @04,ACQLPTR                                         0720 02074000
*   ACQLST=''B;                     /* CLEAR THE ACQUIRE LIST      0721 02075000
*                                                            #Y30LB37*/ 02076000
*                                                                  0721 02077000
         XC    ACQLST(96),ACQLST                                   0721 02078000
*   /*****************************************************************/ 02079000
*   /*                                                               */ 02080000
*   /* INITIALIZE AND SET ON STAEPARM TRACKING AREAS.        #Y30LB37*/ 02081000
*   /*                                                               */ 02082000
*   /*****************************************************************/ 02083000
*                                                                  0722 02084000
*   STAVVOL=MDLABEL;                /* INITIALIZE VOLSER     #Y30LB37*/ 02085000
         L     @08,GDTSAH(,@08)                                    0722 02086000
         L     @08,SAHSTA(,@08)                                    0722 02087000
         L     @04,@PC00007                                        0722 02088000
         L     @04,IMMDAGLP(,@04)                                  0722 02089000
         MVC   STAVVOL(6,@08),MDLABEL(@04)                         0722 02090000
*   STAVUCB=MDUCBADR;               /* INITIALIZE UCB ADDRESS      0723 02091000
*                                                            #Y30LB37*/ 02092000
*                                                                  0723 02093000
         L     @01,MDUCBPTR(,@04)                                  0723 02094000
         L     @15,MDUCBADR(,@01)                                  0723 02095000
         ST    @15,STAVUCB(,@08)                                   0723 02096000
*   /*****************************************************************/ 02097000
*   /*                                                               */ 02098000
*   /* CHECK FOR USER SUPPLIED CCHH OR TO USE THE DEFAULT.   @ZDR2057*/ 02099000
*   /*                                                               */ 02100000
*   /*****************************************************************/ 02101000
*                                                                  0724 02102000
*   IF MDVTOCTR=ON THEN                                            0724 02103000
         TM    MDVTOCTR(@04),B'00000001'                           0724 02104000
         BNO   @RF00724                                            0724 02105000
*     DO;                           /*                       @ZDR2057*/ 02106000
*       CCWORK=(19*MDCC)+MDHH;      /*                       @ZDR2057*/ 02107000
         LH    @08,MDCC(,@04)                                      0726 02108000
         MH    @08,@CH02774                                        0726 02109000
         AH    @08,MDHH(,@04)                                      0726 02110000
         STH   @08,CCWORK                                          0726 02111000
*       HHWORK=DEFTTR;              /*                       @ZDR2057*/ 02112000
         MVC   HHWORK(2),DEFTTR                                    0727 02113000
*     END;                          /*                       @ZDR2057*/ 02114000
*   ELSE                                                           0729 02115000
*     TTRWORK=DEFALTTR;             /* INITIALIZE TO DEFAULT @ZA05112*/ 02116000
         B     @RC00724                                            0729 02117000
@RF00724 MVC   TTRWORK(4),DEFALTTR                                 0729 02118000
*   STAVTTR=TTRWORK;                /* STORE DEFAULT TTR     @ZA05112*/ 02119000
@RC00724 L     @08,@PC00001                                        0730 02120000
         L     @03,GDTSAH(,@08)                                    0730 02121000
         L     @03,SAHSTA(,@03)                                    0730 02122000
         MVC   STAVTTR(4,@03),TTRWORK                              0730 02123000
*   STAVMNT=ON;                     /* TURN ON MOUNT FLAG    #Y30LB37*/ 02124000
         OI    STAVMNT(@03),B'10000000'                            0731 02125000
*                                                                  0732 02126000
*   /*****************************************************************/ 02127000
*   /*                                                               */ 02128000
*   /* ISSUE USSC MACRO TO HAVE VOLUME MOUNTED BY THE MSC.   #Y30LB37*/ 02129000
*   /* THE FOLLOWING SSC MACRO FIELDS ARE SET: MDVOL         #Y30LB37*/ 02130000
*   /* AND MDVUA.                                            #Y30LB37*/ 02131000
*   /*                                                               */ 02132000
*   /*****************************************************************/ 02133000
*                                                                  0732 02134000
*   MDVUA=UCBCHAN;                  /*                       #Y30LB37*/ 02135000
         L     @03,MNTLPTR                                         0732 02136000
         LH    @15,UCBCHAN(,UCBPTR)                                0732 02137000
         N     @15,@CF03052                                        0732 02138000
         STH   @15,MDVUA(,@03)                                     0732 02139000
*   MDVOL=MDLABEL;                  /*                       #Y30LB37*/ 02140000
         L     @05,@PC00007                                        0733 02141000
         L     @05,IMMDAGLP(,@05)                                  0733 02142000
         MVC   MDVOL(6,@03),MDLABEL(@05)                           0733 02143000
*   CALL IDCSASS0(GDTTBL,MOUNT,MNTLPTR,REASONCD);/*          #Y30LB37*/ 02144000
         ST    @08,@AL00001                                        0734 02145000
         LA    @05,MOUNT                                           0734 02146000
         ST    @05,@AL00001+4                                      0734 02147000
         LA    @05,MNTLPTR                                         0734 02148000
         ST    @05,@AL00001+8                                      0734 02149000
         LA    @05,REASONCD                                        0734 02150000
         ST    @05,@AL00001+12                                     0734 02151000
         MVI   @AL00001+12,X'80'                                   0734 02152000
         L     @15,GDTSSC(,@08)                                    0734 02153000
         LA    @01,@AL00001                                        0734 02154000
         BALR  @14,@15                                             0734 02155000
*   RESPECIFY                                                      0735 02156000
*     RTNREG RSTD;                                                 0735 02157000
*   TESTRC=RTNREG;                                                 0736 02158000
         LR    TESTRC,RTNREG                                       0736 02159000
*   RESPECIFY                                                      0737 02160000
*     RTNREG UNRSTD;                /*                       #Y30LB37*/ 02161000
*   ISUEMRC=TESTRC;                 /*                       #Y30LB37*/ 02162000
*                                                                  0738 02163000
         LR    ISUEMRC,TESTRC                                      0738 02164000
*   /*****************************************************************/ 02165000
*   /*                                                               */ 02166000
*   /* IF A ERROR OCCURS IN MOUNT SET STAEVMNT OFF AND SET   #Y30LB37*/ 02167000
*   /* RETURN CODE TO 4. CALL SSCMSG TO PRINT COMMON         #Y30LB37*/ 02168000
*   /* MESSAGE.                                              #Y30LB37*/ 02169000
*   /*                                                               */ 02170000
*   /*****************************************************************/ 02171000
*                                                                  0739 02172000
*   IF ISUEMRC^=0 THEN                                             0739 02173000
         LTR   ISUEMRC,ISUEMRC                                     0739 02174000
         BZ    @RF00739                                            0739 02175000
*     DO;                           /*                       #Y30LB37*/ 02176000
*       STAVMNT=OFF;                /*                       #Y30LB37*/ 02177000
         L     @08,@PC00001                                        0741 02178000
         L     @08,GDTSAH(,@08)                                    0741 02179000
         L     @08,SAHSTA(,@08)                                    0741 02180000
         NI    STAVMNT(@08),B'01111111'                            0741 02181000
*       CALL SSCMSG(REASONCD);      /*                       #Y30LB37*/ 02182000
         LA    @08,REASONCD                                        0742 02183000
         ST    @08,@AL00001                                        0742 02184000
         LA    @01,@AL00001                                        0742 02185000
         BAL   @14,SSCMSG                                          0742 02186000
*     END;                          /*                       #Y30LB37*/ 02187000
*                                                                  0744 02188000
*   /*****************************************************************/ 02189000
*   /*                                                               */ 02190000
*   /* IF THE RETURN CODE IS ZERO, THEN ISSUE THE USSC       #Y30LB37*/ 02191000
*   /* MACRO TO ACQUIRE THE FIRST CYLINDER OF THE VOLUME     #Y30LB37*/ 02192000
*   /* MOUNTED AND WAIT ON THE ACQUIRE.                      #Y30LB37*/ 02193000
*   /*                                                               */ 02194000
*   /*****************************************************************/ 02195000
*                                                                  0744 02196000
*   IF ISUEMRC=0 THEN                                              0744 02197000
@RF00739 SLR   @08,@08                                             0744 02198000
         CR    ISUEMRC,@08                                         0744 02199000
         BNE   @RF00744                                            0744 02200000
*     DO;                           /*                       #Y30LB37*/ 02201000
*       ARLL=LENGTH(ACQLIST);       /*                       #Y30LB37*/ 02202000
         L     @05,ACQLPTR                                         0746 02203000
         MVC   ARLL(4,@05),@CF02065                                0746 02204000
*       AROP=ACQOP;                 /*                       #Y30LB37*/ 02205000
         MVC   AROP(1,@05),ACQOP                                   0747 02206000
*       ARDRES=ON;                  /*                       #Y30LB37*/ 02207000
         OI    ARDRES(@05),B'01000000'                             0748 02208000
*       ARNMEXT=ONE;                /*                       #Y30LB37*/ 02209000
         MVI   ARNMEXT(@05),X'01'                                  0749 02210000
*       ARVOL=MDLABEL;              /*                       #Y30LB37*/ 02211000
         L     @03,@PC00007                                        0750 02212000
         L     @03,IMMDAGLP(,@03)                                  0750 02213000
         MVC   ARVOL(6,@05),MDLABEL(@03)                           0750 02214000
*       AREXT(1)=''B;               /*                       #Y30LB37*/ 02215000
         XC    AREXT(4,@05),AREXT(@05)                             0751 02216000
*       ARNEDB=NULLPTR;             /*                       #Y30LB37*/ 02217000
         ST    @08,ARNEDB(,@05)                                    0752 02218000
*       CALL IDCSASS0(GDTTBL,ACQUIRE,ACQLPTR,REASONCD,ECBCODE);/*  0753 02219000
*                                                            #Y30LB37*/ 02220000
         L     @08,@PC00001                                        0753 02221000
         ST    @08,@AL00001                                        0753 02222000
         LA    @05,ACQUIRE                                         0753 02223000
         ST    @05,@AL00001+4                                      0753 02224000
         LA    @05,ACQLPTR                                         0753 02225000
         ST    @05,@AL00001+8                                      0753 02226000
         LA    @05,REASONCD                                        0753 02227000
         ST    @05,@AL00001+12                                     0753 02228000
         LA    @05,ECBCODE                                         0753 02229000
         ST    @05,@AL00001+16                                     0753 02230000
         MVI   @AL00001+16,X'80'                                   0753 02231000
         L     @15,GDTSSC(,@08)                                    0753 02232000
         LA    @01,@AL00001                                        0753 02233000
         BALR  @14,@15                                             0753 02234000
*       RESPECIFY                                                  0754 02235000
*         RTNREG RSTD;                                             0754 02236000
*       TESTRC=RTNREG;                                             0755 02237000
         LR    TESTRC,RTNREG                                       0755 02238000
*       RESPECIFY                                                  0756 02239000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 02240000
*                                                                  0756 02241000
*       /*************************************************************/ 02242000
*       /*                                                           */ 02243000
*       /* IF AN ERROR OCCURRED IN THE SSC ACQUIRE, THEN     #Y30LB37*/ 02244000
*       /* CALL THE SSCMSG ROUTINE TO PRINT OUT THE COMMON   #Y30LB37*/ 02245000
*       /* ERROR MESSAGE.                                    #Y30LB37*/ 02246000
*       /*                                                           */ 02247000
*       /*************************************************************/ 02248000
*                                                                  0757 02249000
*       IF TESTRC^=0 THEN                                          0757 02250000
         LTR   TESTRC,TESTRC                                       0757 02251000
         BZ    @RF00757                                            0757 02252000
*         DO;                       /*                       #Y30LB37*/ 02253000
*           ISUEMRC=RCNOPOST;       /*                       #Y30LB37*/ 02254000
         LA    ISUEMRC,12                                          0759 02255000
*           CALL SSCMSG(REASONCD,ECBCODE);/*                 #Y30LB37*/ 02256000
         LA    @08,REASONCD                                        0760 02257000
         ST    @08,@AL00001                                        0760 02258000
         LA    @08,ECBCODE                                         0760 02259000
         ST    @08,@AL00001+4                                      0760 02260000
         LA    @01,@AL00001                                        0760 02261000
         BAL   @14,SSCMSG                                          0760 02262000
*         END;                      /*                       #Y30LB37*/ 02263000
*     END;                          /*                       #Y30LB37*/ 02264000
@RF00757 DS    0H                                                  0763 02265000
*   RETURN CODE(ISUEMRC);           /* RETURN TO MAIN ROUTINE      0763 02266000
*                                                            #Y30LB37*/ 02267000
@RF00744 LR    @15,ISUEMRC                                         0763 02268000
         L     @14,@SA00007                                        0763 02269000
         LM    @00,@12,@SA00007+8                                  0763 02270000
         BR    @14                                                 0763 02271000
*   END ISSUEMNT;                   /* END OF ISSUEMNT TO MOUNT A  0764 02272000
*                                      VIRTUAL VOLUME        #Y30LB37*/ 02273000
*                                                                  0765 02274000
*/********************************************************************/ 02275000
*/*                                                                  */ 02276000
*/*  PROCEDURE NAME - RDLABEL                                #Y30LB37*/ 02277000
*/*                                                          #Y30LB37*/ 02278000
*/*  FUNCTION - THIS ROUTINE WILL PERFORM THE EXCP STEPS     #Y30LB37*/ 02279000
*/*             TO OPEN, READ AND CLOSE THE VOLUME VIA       #Y30LB37*/ 02280000
*/*             THE UEXCP MACRO.  RDLABEL MUST ALSO          #Y30LB37*/ 02281000
*/*             CONVERT THE CCHHR TO A VALID TTR PTR TO      #Y30LB37*/ 02282000
*/*             THE VTOC AND INSERT IN TTRWORK, FOR          #Y30LB37*/ 02283000
*/*             MOUNTVOL TO USE WHEN POSTING THE UCB.        #Y30LB37*/ 02284000
*/*                                                          #Y30LB37*/ 02285000
*/*  INPUT - THE INPUT ARGUMENT LIST MDAGL IS USED TO        #Y30LB37*/ 02286000
*/*          SET UP THE UEXCP MACRO.                         #Y30LB37*/ 02287000
*/*                                                          #Y30LB37*/ 02288000
*/*  OUTPUT- IS IN THE FORM OF A COMPLETED READ AND A        #Y30LB37*/ 02289000
*/*          CONVERTED CCHHR IF THE READ WAS SUCCESSFUL.     #Y30LB37*/ 02290000
*/*          RETURN CODES IN REG15 ARE AS FOLLOWS:           #Y30LB37*/ 02291000
*/*          0 - SUCCESSFUL                                  #Y30LB37*/ 02292000
*/*          4 - UNSUCCESSFUL                                #Y30LB37*/ 02293000
*/*                                                                  */ 02294000
*/********************************************************************/ 02295000
*                                                                  0765 02296000
*RDLABEL:                                                          0765 02297000
*   PROCEDURE(RDMDAGLP);            /*                       #Y30LB37*/ 02298000
RDLABEL  STM   @14,@12,@SA00008                                    0765 02299000
         MVC   @PC00008(4),0(@01)                                  0765 02300000
*                                                                  0766 02301000
*   /*****************************************************************/ 02302000
*   /*                                                               */ 02303000
*   /* LOCAL DECLARATIONS FOR RDLABEL                        #Y30LB37*/ 02304000
*   /*                                                               */ 02305000
*   /*****************************************************************/ 02306000
*                                                                  0766 02307000
*   DCL                                                            0766 02308000
*     RDLABRC FIXED(15);            /* RDLABEL RETURN CODE   #Y30LB37*/ 02309000
*   DCL                                                            0767 02310000
*     RDMDAGLP PTR(31);             /* PTR TO MDAGL          #Y30LB37*/ 02311000
*   DCL                                                            0768 02312000
*     SEARCHCC CHAR(5) STATIC       /* SEARCH FOR RECORD     #Y30LB37*/ 02313000
*         INIT('0000000003'X);      /* VOLUME LABEL 3        #Y30LB37*/ 02314000
*   DCL                                                            0769 02315000
*     EXT3330 FIXED(8) CONSTANT(19);/* EXTENTS FOR 3330      #Y30LB37*/ 02316000
*   DCL                                                            0770 02317000
*     RTNAREA PTR(31) BDY(WORD);    /* UEXCP PARM AREA       #Y30LB37*/ 02318000
*   DCL                                                            0771 02319000
*     EXOLIST CHAR(LENGTH(EXOARG))  /* EXCP OPEN ARGUMENT    #Y30LB37*/ 02320000
*         BDY(WORD);                /* LIST                  #Y30LB37*/ 02321000
*   DCL                                                            0772 02322000
*     EXGLIST CHAR(LENGTH(EXGARG))  /* EXCP GET ARGUMENT     #Y30LB37*/ 02323000
*         BDY(WORD);                /* LIST                  #Y30LB37*/ 02324000
*   DCL                                                            0773 02325000
*     1 RECAREA BDY(WORD),          /* VOLUME LABEL 3 AREA   #Y30LB37*/ 02326000
*      2 * CHAR(LENGTH(VOLLABEL));  /* LENGTH OF VOLLABEL    #Y30LB37*/ 02327000
*   DCL                                                            0774 02328000
*     1 CCHHRWK CHAR(5) BDY(WORD),  /* CONVERSION WORK AREA  #Y30LB37*/ 02329000
*      2 CC FIXED(15),              /* CYLINDER              #Y30LB37*/ 02330000
*      2 HH FIXED(15),              /* HEAD                  #Y30LB37*/ 02331000
*      2 R FIXED(8);                /* RECORD                #Y30LB37*/ 02332000
*                                                                  0775 02333000
*   /*****************************************************************/ 02334000
*   /*                                                               */ 02335000
*   /* INITIALIZE THE OPEN ARGUMENT LIST AND ISSUE THE OPEN  #Y30LB37*/ 02336000
*   /* MACRO VIA THE UEXCP MACRO.                            #Y30LB37*/ 02337000
*   /*                                                               */ 02338000
*   /*****************************************************************/ 02339000
*                                                                  0775 02340000
*   RFY                                                            0775 02341000
*     MDAGL BASED(RDMDAGLP);        /*                       #Y30LB37*/ 02342000
*   RFY                                                            0776 02343000
*     EXOARG BASED(ADDR(EXOLIST));  /*                       #Y30LB37*/ 02344000
*   RFY                                                            0777 02345000
*     EXGARG BASED(ADDR(EXGLIST));  /*                       #Y30LB37*/ 02346000
*   RFY                                                            0778 02347000
*     VOLLABEL BASED(ADDR(RECAREA));/*                       #Y30LB37*/ 02348000
*   OLDERID2=NEWERID2;                                             0779 02349000
         L     @08,@PC00001                                        0779 02350000
         L     @03,GDTTR2(,@08)                                    0779 02351000
         MVC   @TS00001(95),NEWERID2(@03)                          0779 02352000
         MVC   OLDERID2(95,@03),@TS00001                           0779 02353000
*   NEWID2='SARD';                  /*                       #Y30LB37*/ 02354000
         MVC   NEWID2(4,@03),@CC02802                              0780 02355000
*   RTNAREA=NULLPTR;                /*                       #Y30LB37*/ 02356000
         SLR   @03,@03                                             0781 02357000
         ST    @03,RTNAREA                                         0781 02358000
*   EXOARG=''B;                     /*                       #Y30LB37*/ 02359000
         LA    @03,EXOLIST                                         0782 02360000
         XC    EXOARG(34,@03),EXOARG(@03)                          0782 02361000
*   EXODDN=ADDR(MDDDNAME);          /*                       #Y30LB37*/ 02362000
         L     @15,@PC00008                                        0783 02363000
         L     @15,RDMDAGLP(,@15)                                  0783 02364000
         LA    @14,MDDDNAME(,@15)                                  0783 02365000
         ST    @14,EXODDN(,@03)                                    0783 02366000
*   EXOUCB=MDUCBADR;                /*                       #Y30LB37*/ 02367000
         L     @01,MDUCBPTR(,@15)                                  0784 02368000
         L     @15,MDUCBADR(,@01)                                  0784 02369000
         ST    @15,EXOUCB(,@03)                                    0784 02370000
*   EXOCTLBK=ADDR(RTNAREA);         /*                       #Y30LB37*/ 02371000
         LA    @15,RTNAREA                                         0785 02372000
         ST    @15,EXOCTLBK(,@03)                                  0785 02373000
*   EXONEW=ON;                      /*                       #Y30LB37*/ 02374000
         OI    EXONEW(@03),B'00010000'                             0786 02375000
*   CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                     #Y30LB37*/ 02376000
         ST    @08,@AL00001                                        0787 02377000
         LA    @15,OPEN                                            0787 02378000
         ST    @15,@AL00001+4                                      0787 02379000
         ST    @03,@AL00001+8                                      0787 02380000
         MVI   @AL00001+8,X'80'                                    0787 02381000
         L     @15,GDTEXP(,@08)                                    0787 02382000
         LA    @01,@AL00001                                        0787 02383000
         BALR  @14,@15                                             0787 02384000
*   RESPECIFY                                                      0788 02385000
*     RTNREG RSTD;                                                 0788 02386000
*   TESTRC=RTNREG;                                                 0789 02387000
         LR    TESTRC,RTNREG                                       0789 02388000
*   RESPECIFY                                                      0790 02389000
*     RTNREG UNRSTD;                /*                       #Y30LB37*/ 02390000
*                                                                  0791 02391000
*   /*****************************************************************/ 02392000
*   /*                                                               */ 02393000
*   /* INITIALIZE THE GET ARGUMENT LIST AND ISSUE THE GET    #Y30LB37*/ 02394000
*   /* MACRO VIA THE UEXCP MACRO.                            #Y30LB37*/ 02395000
*   /*                                                               */ 02396000
*   /*****************************************************************/ 02397000
*                                                                  0791 02398000
*   IF TESTRC=0 THEN                                               0791 02399000
         LTR   TESTRC,TESTRC                                       0791 02400000
         BNZ   @RF00791                                            0791 02401000
*     DO;                           /*                       #Y30LB37*/ 02402000
*       EXGARG=''B;                 /*                       #Y30LB37*/ 02403000
         LA    @08,EXGLIST                                         0793 02404000
         XC    EXGARG(32,@08),EXGARG(@08)                          0793 02405000
*       VOLLABEL=''B;               /*                       #Y30LB37*/ 02406000
         LA    @03,RECAREA                                         0794 02407000
         XC    VOLLABEL(84,@03),VOLLABEL(@03)                      0794 02408000
*       EXGCTLBK=RTNAREA;           /*                       #Y30LB37*/ 02409000
         L     @15,RTNAREA                                         0795 02410000
         ST    @15,EXGCTLBK(,@08)                                  0795 02411000
*       EXGCCHH2=ADDR(SEARCHCC);    /*                       #Y30LB37*/ 02412000
         LA    @15,SEARCHCC                                        0796 02413000
         ST    @15,EXGCCHH2(,@08)                                  0796 02414000
*       EXGRECNO=ONE;               /*                       #Y30LB37*/ 02415000
         MVC   EXGRECNO(4,@08),@CF00219                            0797 02416000
*       EXGDATAP=ADDR(VOLLABEL);    /*                       #Y30LB37*/ 02417000
         ST    @03,EXGDATAP(,@08)                                  0798 02418000
*       EXGKEYLN=LENGTH(VOLKEY);    /*                       #Y30LB37*/ 02419000
         MVI   EXGKEYLN(@08),X'04'                                 0799 02420000
*       EXGDATAL=LENGTH(VOLLABEL)-LENGTH(VOLKEY);/*          #Y30LB37*/ 02421000
         MVC   EXGDATAL(2,@08),@CH03033                            0800 02422000
*       CALL IDCIO050(GDTTBL,GET,EXGARG);/*                  #Y30LB37*/ 02423000
         L     @03,@PC00001                                        0801 02424000
         ST    @03,@AL00001                                        0801 02425000
         LA    @15,GET                                             0801 02426000
         ST    @15,@AL00001+4                                      0801 02427000
         ST    @08,@AL00001+8                                      0801 02428000
         MVI   @AL00001+8,X'80'                                    0801 02429000
         L     @15,GDTEXP(,@03)                                    0801 02430000
         LA    @01,@AL00001                                        0801 02431000
         BALR  @14,@15                                             0801 02432000
*       RESPECIFY                                                  0802 02433000
*         RTNREG RSTD;                                             0802 02434000
*       TESTRC=RTNREG;                                             0803 02435000
         LR    TESTRC,RTNREG                                       0803 02436000
*       RESPECIFY                                                  0804 02437000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 02438000
*                                                                  0804 02439000
*       /*************************************************************/ 02440000
*       /*                                                           */ 02441000
*       /* IF THE UEXCP GET IS SUCCESSFUL, THEN CONVERT THE  #Y30LB37*/ 02442000
*       /* CCHHR FIELD OF RECORD THREE TO A TTR AND PUT THE  #Y30LB37*/ 02443000
*       /* CONVERTED CCHHR INTO THE TTR WORK FIELD FOR LATER #Y30LB37*/ 02444000
*       /* USE BY THE MOUNTVOL ROUTINE FOR POSTING.          #Y30LB37*/ 02445000
*       /*                                                           */ 02446000
*       /*************************************************************/ 02447000
*                                                                  0805 02448000
*       IF TESTRC=0 THEN                                           0805 02449000
         LTR   TESTRC,TESTRC                                       0805 02450000
         BNZ   @RF00805                                            0805 02451000
*         DO;                       /*                       #Y30LB37*/ 02452000
*           CCHHRWK=VOLVTOC;        /*                       #Y30LB37*/ 02453000
         LA    @08,RECAREA                                         0807 02454000
         MVC   CCHHRWK(5),VOLVTOC(@08)                             0807 02455000
*           CCWORK=(CC*EXT3330)+HH; /*                       #Y30LB37*/ 02456000
         LH    @08,CC                                              0808 02457000
         MH    @08,@CH02774                                        0808 02458000
         AH    @08,HH                                              0808 02459000
         STH   @08,CCWORK                                          0808 02460000
*           HHWORK='0100'X;         /*                       #Y30LB37*/ 02461000
         MVC   HHWORK(2),@CH02731                                  0809 02462000
*         END;                      /*                       #Y30LB37*/ 02463000
*     END;                          /*                       #Y30LB37*/ 02464000
@RF00805 DS    0H                                                  0812 02465000
*                                                                  0812 02466000
*   /*****************************************************************/ 02467000
*   /*                                                               */ 02468000
*   /* IF THE OPEN WAS SUCCESSFUL THEN ISSUE THE CLOSE       #Y30LB37*/ 02469000
*   /* MACRO VIA THE UEXCP MACRO.                            #Y30LB37*/ 02470000
*   /*                                                               */ 02471000
*   /*****************************************************************/ 02472000
*                                                                  0812 02473000
*   IF RTNAREA^=NULLPTR THEN                                       0812 02474000
@RF00791 L     @08,RTNAREA                                         0812 02475000
         LTR   @08,@08                                             0812 02476000
         BZ    @RF00812                                            0812 02477000
*     CALL IDCIO050(GDTTBL,CLOSE,RTNAREA);/*                 #Y30LB37*/ 02478000
*                                                                  0813 02479000
         L     @08,@PC00001                                        0813 02480000
         ST    @08,@AL00001                                        0813 02481000
         LA    @03,CLOSE                                           0813 02482000
         ST    @03,@AL00001+4                                      0813 02483000
         LA    @03,RTNAREA                                         0813 02484000
         ST    @03,@AL00001+8                                      0813 02485000
         MVI   @AL00001+8,X'80'                                    0813 02486000
         L     @15,GDTEXP(,@08)                                    0813 02487000
         LA    @01,@AL00001                                        0813 02488000
         BALR  @14,@15                                             0813 02489000
*   /*****************************************************************/ 02490000
*   /*                                                               */ 02491000
*   /* RETURN TO CALLER WITH A RETURN CODE OF FOUR IF AN     #Y30LB37*/ 02492000
*   /* ERROR OCCURRED OR ZERO IF SUCCESSFUL.                 #Y30LB37*/ 02493000
*   /*                                                               */ 02494000
*   /*****************************************************************/ 02495000
*                                                                  0814 02496000
*   IF TESTRC^=0 THEN                                              0814 02497000
@RF00812 LTR   TESTRC,TESTRC                                       0814 02498000
         BZ    @RF00814                                            0814 02499000
*     RDLABRC=4;                    /*                       #Y30LB37*/ 02500000
         LA    RDLABRC,4                                           0815 02501000
*   ELSE                                                           0816 02502000
*     RDLABRC=0;                    /*                       #Y30LB37*/ 02503000
         B     @RC00814                                            0816 02504000
@RF00814 SLR   RDLABRC,RDLABRC                                     0816 02505000
*   RETURN CODE(RDLABRC);           /* RETURN TO MAIN ROUTINE      0817 02506000
*                                                            #Y30LB37*/ 02507000
@RC00814 LR    @15,RDLABRC                                         0817 02508000
         L     @14,@SA00008                                        0817 02509000
         LM    @00,@12,@SA00008+8                                  0817 02510000
         BR    @14                                                 0817 02511000
*   END RDLABEL;                    /* END OF RDLABEL TO READ A    0818 02512000
*                                      VIRTUAL VOLUME        #Y30LB37*/ 02513000
*                                                                  0819 02514000
*/********************************************************************/ 02515000
*/*                                                                  */ 02516000
*/*  PROCEDURE NAME - DEMNTVOL                               #Y30LB37*/ 02517000
*/*                                                          #Y30LB37*/ 02518000
*/*  FUNCTION - THIS IS THE CONTROLLING ROUTINE FOR          #Y30LB37*/ 02519000
*/*             THE DEMOUNTING OF A 3330V VIRTUAL VOLUME.    #Y30LB37*/ 02520000
*/*             IT PERFORMS THE SETUP AND CHECK TO SEE IF    #Y30LB37*/ 02521000
*/*             THE VOLUME IS THE ONE TO BE DEMOUNTED AND    #Y30LB37*/ 02522000
*/*             RETURNS IF IT IS NOT.  DEMNTVOL USES         #Y30LB37*/ 02523000
*/*             SUBORDINATE FUNCTIONS ISSUEDMT, ENQDEQ       #Y30LB37*/ 02524000
*/*             AND UCBPOST TO ACHIEVE THE DEMOUNTING 0F     #Y30LB37*/ 02525000
*/*             A 3330V VOLUME.  IT ALSO, POSTS A UCB        #Y30LB37*/ 02526000
*/*             AFTER THE DEMOUNTING OF THE VIRTUAL          #Y30LB37*/ 02527000
*/*             VOLUME IF THE POST OPTION WAS SPECIFIED.     #Y30LB37*/ 02528000
*/*                                                          #Y30LB37*/ 02529000
*/*  INPUT - THE INPUT ARGUMENT LIST MDAGL IS USED TO        #Y30LB37*/ 02530000
*/*          SET UP THE DEMOUNT REQUEST. THE UCB IS          #Y30LB37*/ 02531000
*/*          POINTED TO OUT OF THE MDAGL AND IS USED TO      #Y30LB37*/ 02532000
*/*          CHECK THE VOLUME SERIAL MOUNTED.                #Y30LB37*/ 02533000
*/*                                                          #Y30LB37*/ 02534000
*/*  OUTPUT- IS IN THE FORM OF A COMPLETED DEMOUNT           #Y30LB37*/ 02535000
*/*          REQUEST AND A POSTED UCB IF SPECIFIED WITH      #Y30LB37*/ 02536000
*/*          THE POST OPTION ALONG WITH THE DEMOUNT.         #Y30LB37*/ 02537000
*/*          RETURN CODES IN REG 15 ARE AS FOLLOWS:          #Y30LB37*/ 02538000
*/*          0 - SUCCESSFUL                                  #Y30LB37*/ 02539000
*/*          4 - DEMOUNT WAS UNSUCCESSFUL                    #Y30LB37*/ 02540000
*/*                                                                  */ 02541000
*/********************************************************************/ 02542000
*                                                                  0819 02543000
*DEMNTVOL:                                                         0819 02544000
*   PROCEDURE(DMAGLPTR);            /*                       #Y30LB37*/ 02545000
DEMNTVOL STM   @14,@12,@SA00009                                    0819 02546000
         MVC   @PC00009(4),0(@01)                                  0819 02547000
*                                                                  0820 02548000
*   /*****************************************************************/ 02549000
*   /*                                                               */ 02550000
*   /* LOCAL DECLARATIONS FOR DEMNTVOL                       #Y30LB37*/ 02551000
*   /*                                                               */ 02552000
*   /*****************************************************************/ 02553000
*                                                                  0820 02554000
*   DCL                                                            0820 02555000
*     DEMNTRC FIXED(15);            /* DEMNTVOL RETURN CODE  #Y30LB37*/ 02556000
*   DCL                                                            0821 02557000
*     DMAGLPTR PTR(31);             /* PTR TO MDAGL          #Y30LB37*/ 02558000
*   DCL                                                            0822 02559000
*     MDPUAGLP PTR(31);             /* DEMOUNT PUAGL PTR     #Y30LB37*/ 02560000
*   DCL                                                            0823 02561000
*     PUVOLSER CHAR(6) BASED(PULABELP);/* VOLSER IF MDPOST ON      0823 02562000
*                                                            #Y30LB37*/ 02563000
*   DCL                                                            0824 02564000
*     SA6PUAGL BDY(WORD)            /* SA06'S SKELETON PUAGL #Y30LB37*/ 02565000
*         CHAR(LENGTH(PUAGL));      /* FOR POSTING           #Y30LB37*/ 02566000
*   DCL                                                            0825 02567000
*     SA6PUVOL CHAR(6);             /* VOLUME SERIAL NUMBER  #Y30LB37*/ 02568000
*   DCL                                                            0826 02569000
*     SA6PUTTR CHAR(4);             /* TTR TO THE VTOC       #Y30LB37*/ 02570000
*   DCL                                                            0827 02571000
*     WTOPTR POINTER(31);           /* WTO MSG POINTER       @ZA00698*/ 02572000
*   DCL                                                            0828 02573000
*     WTOLEN FIXED(15);             /* LENGTH OF WTO MSG     @ZA00698*/ 02574000
*   DCL                                                            0829 02575000
*     WTOMSG CHAR(72);              /* UWTO MESSAGE AREA     @ZA00698*/ 02576000
*                                                                  0830 02577000
*   /*****************************************************************/ 02578000
*   /*                                                               */ 02579000
*   /* THE UCB IS INTERROGATED TO DETERMINE IF THE UNIT      #Y30LB37*/ 02580000
*   /* IS READY (INDICATING A VOLUME IS MOUNTED) AND THE     #Y30LB37*/ 02581000
*   /* VOLUME IS THE VOLUME TO BE DEMOUNTED. IF SO DEMOUNT   #Y30LB37*/ 02582000
*   /* THE VOLUME.                                           #Y30LB37*/ 02583000
*   /*                                                               */ 02584000
*   /*****************************************************************/ 02585000
*                                                                  0830 02586000
*   RFY                                                            0830 02587000
*     MDAGL BASED(DMAGLPTR);        /*                       #Y30LB37*/ 02588000
*   OLDERID2=NEWERID2;                                             0831 02589000
         L     @08,@PC00001                                        0831 02590000
         L     @08,GDTTR2(,@08)                                    0831 02591000
         MVC   @TS00001(95),NEWERID2(@08)                          0831 02592000
         MVC   OLDERID2(95,@08),@TS00001                           0831 02593000
*   NEWID2='SADM';                  /*                       #Y30LB37*/ 02594000
         MVC   NEWID2(4,@08),@CC02819                              0832 02595000
*   DEMNTRC=0;                      /*                       #Y30LB37*/ 02596000
         SLR   DEMNTRC,DEMNTRC                                     0833 02597000
*   IF(UCBNOTRD=OFF&UCBVOLI=MDLABEL)|/*                      @ZA00678*/ 02598000
*       MNTSTATS=MNTERROR|          /*                       @ZA09522*/ 02599000
*       MDFORCE=ON THEN             /*                       @ZA09522*/ 02600000
         TM    UCBNOTRD(UCBPTR),B'01000000'                        0834 02601000
         BNZ   @GL00016                                            0834 02602000
         L     @08,@PC00009                                        0834 02603000
         L     @08,DMAGLPTR(,@08)                                  0834 02604000
         CLC   UCBVOLI(6,UCBPTR),MDLABEL(@08)                      0834 02605000
         BE    @RT00834                                            0834 02606000
@GL00016 CLC   MNTSTATS(8),MNTERROR                                0834 02607000
         BE    @RT00834                                            0834 02608000
         L     @08,@PC00009                                        0834 02609000
         L     @08,DMAGLPTR(,@08)                                  0834 02610000
         TM    MDFORCE(@08),B'00000010'                            0834 02611000
         BNO   @RF00834                                            0834 02612000
@RT00834 DS    0H                                                  0835 02613000
*     DO;                           /*                       #Y30LB37*/ 02614000
*       CALL ISSUEDMT(DMAGLPTR);    /*                       #Y30LB37*/ 02615000
         L     @08,@PC00009                                        0836 02616000
         ST    @08,@AL00001                                        0836 02617000
         LA    @01,@AL00001                                        0836 02618000
         BAL   @14,ISSUEDMT                                        0836 02619000
*       RESPECIFY                                                  0837 02620000
*         RTNREG RSTD;                                             0837 02621000
*       TESTRC=RTNREG;                                             0838 02622000
         LR    TESTRC,RTNREG                                       0838 02623000
*       RESPECIFY                                                  0839 02624000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 02625000
*                                                                  0839 02626000
*       /*************************************************************/ 02627000
*       /*                                                           */ 02628000
*       /* ISSUE ERROR MESSAGE IDC2388I OR IDC2389I IF       #Y30LB37*/ 02629000
*       /* A DEMOUNT OR DESTAGING FAILURE RESPECTIVELY.      #Y30LB37*/ 02630000
*       /*                                                           */ 02631000
*       /*************************************************************/ 02632000
*                                                                  0840 02633000
*       IF TESTRC^=0 THEN                                          0840 02634000
         LTR   TESTRC,TESTRC                                       0840 02635000
         BZ    @RF00840                                            0840 02636000
*         DO;                       /*                       #Y30LB37*/ 02637000
*           IF TESTRC=4|TESTRC=8 THEN/*                      @ZA00698*/ 02638000
         C     TESTRC,@CF00042                                     0842 02639000
         BE    @RT00842                                            0842 02640000
         C     TESTRC,@CF00179                                     0842 02641000
         BNE   @RF00842                                            0842 02642000
@RT00842 DS    0H                                                  0843 02643000
*             DARGSENT=MSG2388I;    /*                       #Y30LB37*/ 02644000
         L     @08,DDSTRU                                          0843 02645000
         MVI   DARGSENT(@08),X'08'                                 0843 02646000
*           ELSE                                                   0844 02647000
*             DARGSENT=MSG2389I;    /*                       #Y30LB37*/ 02648000
         B     @RC00842                                            0844 02649000
@RF00842 L     @08,DDSTRU                                          0844 02650000
         MVI   DARGSENT(@08),X'09'                                 0844 02651000
*           DARGSMOD=MSGMODID;      /*                       #Y30LB37*/ 02652000
@RC00842 L     @08,DDSTRU                                          0845 02653000
         MVC   DARGSMOD(3,@08),@CC02595                            0845 02654000
*           DARGDBP=ADDR(MDLABEL);  /*                       #Y30LB37*/ 02655000
         L     @03,@PC00009                                        0846 02656000
         L     @03,DMAGLPTR(,@03)                                  0846 02657000
         LA    @03,MDLABEL(,@03)                                   0846 02658000
         ST    @03,DARGDBP(,@08)                                   0846 02659000
*           DARGILP=VOLSERLN;       /*                       #Y30LB37*/ 02660000
         MVC   DARGILP(2,@08),@CH00156                             0847 02661000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          #Y30LB37*/ 02662000
         L     @08,@PC00001                                        0848 02663000
         ST    @08,@AL00001                                        0848 02664000
         LA    @03,@CF00115                                        0848 02665000
         ST    @03,@AL00001+4                                      0848 02666000
         LA    @03,DDSTRU                                          0848 02667000
         ST    @03,@AL00001+8                                      0848 02668000
         MVI   @AL00001+8,X'80'                                    0848 02669000
         L     @15,GDTPRT(,@08)                                    0848 02670000
         LA    @01,@AL00001                                        0848 02671000
         BALR  @14,@15                                             0848 02672000
*           DEMNTRC=4;              /*                       #Y30LB37*/ 02673000
         LA    DEMNTRC,4                                           0849 02674000
*         END;                      /*                       #Y30LB37*/ 02675000
*                                                                  0851 02676000
*       /*************************************************************/ 02677000
*       /*                                                           */ 02678000
*       /* IF THE RETURN CODE FROM ISSUEDMT IS 8, THE        @ZA00698*/ 02679000
*       /* DEMOUNT WAS NOT PERFORMED, THEREFORE NOTHING      @ZA00698*/ 02680000
*       /* MORE IS REQUIRED.                                 @ZA00698*/ 02681000
*       /*                                                           */ 02682000
*       /*************************************************************/ 02683000
*                                                                  0851 02684000
*       IF TESTRC=8 THEN            /*                       @ZA00698*/ 02685000
@RF00840 C     TESTRC,@CF00179                                     0851 02686000
         BE    @RT00851                                            0851 02687000
*         ;                         /*                       @ZA00698*/ 02688000
*       ELSE                        /*                       @ZA00698*/ 02689000
*                                                                  0853 02690000
*         /***********************************************************/ 02691000
*         /*                                                         */ 02692000
*         /* IF THE DEMOUNT FAILED, ISSUE USYSINFO AND UWTO  @ZA00698*/ 02693000
*         /* TO SEND THE OPERATOR MESSAGE IDC394I.           @ZA00698*/ 02694000
*         /*                                                         */ 02695000
*         /***********************************************************/ 02696000
*                                                                  0853 02697000
*         IF TESTRC=4 THEN                                         0853 02698000
         C     TESTRC,@CF00042                                     0853 02699000
         BNE   @RF00853                                            0853 02700000
*           DO;                     /*                       @ZA00698*/ 02701000
*             WTOPTR=ADDR(WTOMSG);  /*                       @ZA00698*/ 02702000
*                                                                  0855 02703000
         LA    @08,WTOMSG                                          0855 02704000
         ST    @08,WTOPTR                                          0855 02705000
*             /*******************************************************/ 02706000
*             /*                                                     */ 02707000
*             /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND  @ZA00698*/ 02708000
*             /* STEPNAME TO BE USED IN MESSAGE IDC394I.     @ZA00698*/ 02709000
*             /*                                                     */ 02710000
*             /*******************************************************/ 02711000
*                                                                  0856 02712000
*             CALL IDCSASI0(GDTTBL,NAMES,ADDR(SYSIN));/*     @ZA00698*/ 02713000
*                                                                  0856 02714000
         L     @08,@PC00001                                        0856 02715000
         ST    @08,@AL00001                                        0856 02716000
         LA    @15,NAMES                                           0856 02717000
         ST    @15,@AL00001+4                                      0856 02718000
         LA    @15,SYSIN                                           0856 02719000
         ST    @15,@AFTEMPS                                        0856 02720000
         LA    @15,@AFTEMPS                                        0856 02721000
         ST    @15,@AL00001+8                                      0856 02722000
         MVI   @AL00001+8,X'80'                                    0856 02723000
         L     @15,GDTSFO(,@08)                                    0856 02724000
         LA    @01,@AL00001                                        0856 02725000
         BALR  @14,@15                                             0856 02726000
*             /*******************************************************/ 02727000
*             /*                                                     */ 02728000
*             /* INITIIALIZE DARGLIST WITH MULTIPLE INSERTS  @ZA00698*/ 02729000
*             /* FOR MESSAGE IDC394I.                        @ZA00698*/ 02730000
*             /*                                                     */ 02731000
*             /*******************************************************/ 02732000
*                                                                  0857 02733000
*             DARGSMOD=MSGMODID;    /*                       @ZA00698*/ 02734000
         L     @08,DDSTRU                                          0857 02735000
         MVC   DARGSMOD(3,@08),@CC02595                            0857 02736000
*             DARGSENT=MSG394I;     /*                       @ZA00698*/ 02737000
         MVI   DARGSENT(@08),X'0E'                                 0858 02738000
*             DARGDBP=ADDR(JOBNAM); /*                       @ZA00698*/ 02739000
         LA    @15,JOBNAM                                          0859 02740000
         ST    @15,DARGDBP(,@08)                                   0859 02741000
*             DARGILP=LENGTH(JOBNAM);/*                      @ZA00698*/ 02742000
         LA    @15,8                                               0860 02743000
         STH   @15,DARGILP(,@08)                                   0860 02744000
*             DARGRETP=WTOPTR;      /*                       @ZA00698*/ 02745000
         L     @14,WTOPTR                                          0861 02746000
         ST    @14,DARGRETP(,@08)                                  0861 02747000
*             DARGRETL=LENGTH(WTOMSG);/*                     @ZA00698*/ 02748000
         MVC   DARGRETL(2,@08),@CH02817                            0862 02749000
*                                                                  0863 02750000
*             /*******************************************************/ 02751000
*             /*                                                     */ 02752000
*             /* MESSAGE IDC394I IS WRITTEN WITH 1 DATA      @ZA00698*/ 02753000
*             /* BLOCK AND FOUR INSERTS. THE DATA BLOCK WILL @ZA00698*/ 02754000
*             /* BE THE JOB NAME. THE FOUR INSERTS ARE:      @ZA00698*/ 02755000
*             /* STEP NAME, UCB ADDRESS, VOLUME SERIAL       @ZA00698*/ 02756000
*             /* AND REASON CODE.                            @ZA00698*/ 02757000
*             /*                                                     */ 02758000
*             /*******************************************************/ 02759000
*                                                                  0863 02760000
*             DARGCNT='4'X;         /*                       @ZA00698*/ 02761000
         LA    @14,4                                               0863 02762000
         STH   @14,DARGCNT(,@08)                                   0863 02763000
*             DARGINS(1)='1'X;      /*                       @ZA00698*/ 02764000
         LA    @07,1                                               0864 02765000
         STH   @07,DARGINS(,@08)                                   0864 02766000
*             DARGINL(1)=LENGTH(STEPNM);/*                   @ZA00698*/ 02767000
         STH   @15,DARGINL(,@08)                                   0865 02768000
*             DARGDTM(1)=ADDR(STEPNM);/*                     @ZA00698*/ 02769000
         LA    @15,STEPNM                                          0866 02770000
         ST    @15,DARGDTM(,@08)                                   0866 02771000
*             DARGINS(2)='2'X;      /*                       @ZA00698*/ 02772000
         LA    @15,2                                               0867 02773000
         STH   @15,DARGINS+8(,@08)                                 0867 02774000
*             DARGINL(2)=VOLSERLN;  /*                       @ZA00698*/ 02775000
         MVC   DARGINL+8(2,@08),@CH00156                           0868 02776000
*             DARGDTM(2)=ADDR(MDLABEL);/*                    @ZA00698*/ 02777000
         L     @15,@PC00009                                        0869 02778000
         L     @01,DMAGLPTR(,@15)                                  0869 02779000
         LA    @15,MDLABEL(,@01)                                   0869 02780000
         ST    @15,DARGDTM+8(,@08)                                 0869 02781000
*             DARGINS(3)='3'X;      /*                       @ZA00698*/ 02782000
         LA    @15,3                                               0870 02783000
         STH   @15,DARGINS+16(,@08)                                0870 02784000
*             DARGINL(3)=LENGTH(UCBNAME);/*                  @ZA00698*/ 02785000
         MVC   DARGINL+16(2,@08),@CH00162                          0871 02786000
*             DARGDTM(3)=ADDR(UCBNAME);/*                    @ZA00698*/ 02787000
         LA    @15,UCBNAME(,UCBPTR)                                0872 02788000
         ST    @15,DARGDTM+16(,@08)                                0872 02789000
*             DARGINS(4)='4'X;      /*                       @ZA00698*/ 02790000
         STH   @14,DARGINS+24(,@08)                                0873 02791000
*             DARGINL(4)=LENGTH(REASON);/*                   @ZA00698*/ 02792000
         MVC   DARGINL+24(2,@08),@CH00153                          0874 02793000
*             DARGDTM(4)=ADDR(REASON);/*                     @ZA00698*/ 02794000
*                                                                  0875 02795000
         LA    @15,REASON                                          0875 02796000
         ST    @15,DARGDTM+24(,@08)                                0875 02797000
*             /*******************************************************/ 02798000
*             /*                                                     */ 02799000
*             /* ISSUE UPRINT TO PUT MSG INTO MESSAGE AREA   @ZA00698*/ 02800000
*             /* FOR UWTO.                                   @ZA00698*/ 02801000
*             /*                                                     */ 02802000
*             /*******************************************************/ 02803000
*                                                                  0876 02804000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @ZA00698*/ 02805000
*                                                                  0876 02806000
         L     @08,@PC00001                                        0876 02807000
         ST    @08,@AL00001                                        0876 02808000
         LA    @15,@CF00115                                        0876 02809000
         ST    @15,@AL00001+4                                      0876 02810000
         LA    @15,DDSTRU                                          0876 02811000
         ST    @15,@AL00001+8                                      0876 02812000
         MVI   @AL00001+8,X'80'                                    0876 02813000
         L     @15,GDTPRT(,@08)                                    0876 02814000
         LA    @01,@AL00001                                        0876 02815000
         BALR  @14,@15                                             0876 02816000
*             /*******************************************************/ 02817000
*             /*                                                     */ 02818000
*             /* SET MESSAGE LENGTH AND ROUTING AND DES-     @ZA00698*/ 02819000
*             /* CRIPTOR CODES FOR UWTO MACRO. ISSUE UWTO    @ZA00698*/ 02820000
*             /* MACRO TO WRITE MESSAGE IDC394I TO THE       @ZA00698*/ 02821000
*             /* SYSTEM OPERATOR.                            @ZA00698*/ 02822000
*             /*                                                     */ 02823000
*             /*******************************************************/ 02824000
*                                                                  0877 02825000
*             WTOLEN=LENGTH(WTOMSG);/*                       @ZA00698*/ 02826000
         MVC   WTOLEN(2),@CH02817                                  0877 02827000
*             ROUTCD=''B;           /*                       @ZA00698*/ 02828000
         XC    ROUTCD(2),ROUTCD                                    0878 02829000
*             CD1=ON;               /*                       @ZA00698*/ 02830000
         OI    CD1,B'10000000'                                     0879 02831000
*             DESCCD=''B;           /*                       @ZA00698*/ 02832000
         XC    DESCCD(2),DESCCD                                    0880 02833000
*             DESC4=ON;             /*                       @ZA00698*/ 02834000
         OI    DESC4,B'00010000'                                   0881 02835000
*             CALL IDCSAWO0(GDTTBL,WTOLEN,WTOPTR,ROUTCD,DESCCD);/* 0882 02836000
*                                                            @ZA00698*/ 02837000
         L     @08,@PC00001                                        0882 02838000
         ST    @08,@AL00001                                        0882 02839000
         LA    @15,WTOLEN                                          0882 02840000
         ST    @15,@AL00001+4                                      0882 02841000
         LA    @15,WTOPTR                                          0882 02842000
         ST    @15,@AL00001+8                                      0882 02843000
         LA    @15,ROUTCD                                          0882 02844000
         ST    @15,@AL00001+12                                     0882 02845000
         LA    @15,DESCCD                                          0882 02846000
         ST    @15,@AL00001+16                                     0882 02847000
         MVI   @AL00001+16,X'80'                                   0882 02848000
         L     @15,GDTWTO(,@08)                                    0882 02849000
         LA    @01,@AL00001                                        0882 02850000
         BALR  @14,@15                                             0882 02851000
*           END;                    /*                       @ZA00698*/ 02852000
*         ELSE                      /*                       @ZA00698*/ 02853000
*                                                                  0884 02854000
*           /*********************************************************/ 02855000
*           /*                                                       */ 02856000
*           /* THIS PORTION OF THE CODE IS EXECUTED IF THE   @ZA00698*/ 02857000
*           /* DEMOUNT(ISSUEDMT) WAS SUCCESSFUL OR IF A      @ZA00698*/ 02858000
*           /* DESTAGE ERROR OCCURS.                         @ZA00698*/ 02859000
*           /*                                                       */ 02860000
*           /*********************************************************/ 02861000
*                                                                  0884 02862000
*           DO;                     /*                       @ZA00698*/ 02863000
*                                                                  0884 02864000
         B     @RC00853                                            0884 02865000
@RF00853 DS    0H                                                  0885 02866000
*             /*******************************************************/ 02867000
*             /*                                                     */ 02868000
*             /* CALL UCBPOST TO CLEAR THE VIRTUAL UCB TO    #Y30LB37*/ 02869000
*             /* ZEROS UNLESS AN ERROR OCCURRED. THEN TURN   @ZA00698*/ 02870000
*             /* OFF THE BIT IN THE STAE PARM LIST THAT      #Y30LB37*/ 02871000
*             /* INDICATES A VOLUME IS DEMOUNTED BUT THE UCB #Y30LB37*/ 02872000
*             /* IS NOT CLEARED.                             #Y30LB37*/ 02873000
*             /*                                                     */ 02874000
*             /*******************************************************/ 02875000
*                                                                  0885 02876000
*             MDPUAGLP=ADDR(SA6PUAGL);/*                     #Y30LB37*/ 02877000
         LA    @08,SA6PUAGL                                        0885 02878000
         ST    @08,MDPUAGLP                                        0885 02879000
*             MDPUAGLP->PUHEAD=CLEAR;/*                      #Y30LB37*/ 02880000
         MVC   PUHEAD(8,@08),CLEAR                                 0886 02881000
*             MDPUAGLP->PUUCBPTR=MDUCBPTR;/*                 #Y30LB37*/ 02882000
         L     @15,@PC00009                                        0887 02883000
         L     @01,DMAGLPTR(,@15)                                  0887 02884000
         L     @15,MDUCBPTR(,@01)                                  0887 02885000
         ST    @15,PUUCBPTR(,@08)                                  0887 02886000
*             MDPUAGLP->PUTTRPTR=ADDR(SA6PUTTR);/*           #Y30LB37*/ 02887000
         LA    @15,SA6PUTTR                                        0888 02888000
         ST    @15,PUTTRPTR(,@08)                                  0888 02889000
*             MDPUAGLP->PULABELP=ADDR(SA6PUVOL);/*           #Y30LB37*/ 02890000
         LA    @15,SA6PUVOL                                        0889 02891000
         ST    @15,PULABELP(,@08)                                  0889 02892000
*             CALL UCBPOST(CLEAR,MDPUAGLP);/*                #Y30LB37*/ 02893000
         LA    @08,CLEAR                                           0890 02894000
         ST    @08,@AL00001                                        0890 02895000
         LA    @08,MDPUAGLP                                        0890 02896000
         ST    @08,@AL00001+4                                      0890 02897000
         LA    @01,@AL00001                                        0890 02898000
         BAL   @14,UCBPOST                                         0890 02899000
*             RESPECIFY                                            0891 02900000
*               RTNREG RSTD;                                       0891 02901000
*             TESTRC=RTNREG;                                       0892 02902000
         LR    TESTRC,RTNREG                                       0892 02903000
*             RESPECIFY                                            0893 02904000
*               RTNREG UNRSTD;      /*                       #Y30LB37*/ 02905000
*             STAVDMNT=OFF;         /* TURN OFF DMNT RECOVERY      0894 02906000
*                                                            #Y30LB37*/ 02907000
*                                                                  0894 02908000
         L     @08,@PC00001                                        0894 02909000
         L     @08,GDTSAH(,@08)                                    0894 02910000
         L     @08,SAHSTA(,@08)                                    0894 02911000
         NI    STAVDMNT(@08),B'10111111'                           0894 02912000
*             /*******************************************************/ 02913000
*             /*                                                     */ 02914000
*             /* DEQ IF MDENQ AND MDDEQ FLAGS ARE ON         @YD00175*/ 02915000
*             /* INDICATING AN ENQUEUE WAS DONE DURING THE   @YD00175*/ 02916000
*             /* PREVIOUS MOUNT AND THIS IS THE FINAL        @YD00175*/ 02917000
*             /* DEMOUNT OF THE VOLUME.                      @YD00175*/ 02918000
*             /*                                                     */ 02919000
*             /*******************************************************/ 02920000
*                                                                  0895 02921000
*             IF MDENQ=ON&MDDEQ=ON THEN                            0895 02922000
         L     @08,@PC00009                                        0895 02923000
         L     @01,DMAGLPTR(,@08)                                  0895 02924000
         TM    MDENQ(@01),B'00001100'                              0895 02925000
         BNO   @RF00895                                            0895 02926000
*               CALL ENQDEQ(DEQCMD,DMAGLPTR);/*              #Y30LB37*/ 02927000
         LA    @15,DEQCMD                                          0896 02928000
         ST    @15,@AL00001                                        0896 02929000
         ST    @08,@AL00001+4                                      0896 02930000
         LA    @01,@AL00001                                        0896 02931000
         BAL   @14,ENQDEQ                                          0896 02932000
*           END;                    /*                       #Y30LB37*/ 02933000
@RF00895 DS    0H                                                  0898 02934000
*     END;                          /*                       @ZA00698*/ 02935000
@RC00853 DS    0H                                                  0898 02936000
@RT00851 DS    0H                                                  0899 02937000
*                                                                  0899 02938000
*   /*****************************************************************/ 02939000
*   /*                                                               */ 02940000
*   /* IF THIS IS A POST WITH DEMOUNT OPTION CALL            #Y30LB37*/ 02941000
*   /* UCBPOST TO POST THE REAL UCB.                         #Y30LB37*/ 02942000
*   /*                                                               */ 02943000
*   /*****************************************************************/ 02944000
*                                                                  0899 02945000
*   IF MDPOST=ON THEN                                              0899 02946000
@RF00834 L     @08,@PC00009                                        0899 02947000
         L     @08,DMAGLPTR(,@08)                                  0899 02948000
         TM    MDPOST(@08),B'00100000'                             0899 02949000
         BNO   @RF00899                                            0899 02950000
*     DO;                           /*                       #Y30LB37*/ 02951000
*       MDPUAGLP=MDPUAGL;           /*                       #Y30LB37*/ 02952000
         L     @08,MDPUAGL(,@08)                                   0901 02953000
         ST    @08,MDPUAGLP                                        0901 02954000
*       CALL UCBPOST(POST,MDPUAGLP);/*                       #Y30LB37*/ 02955000
         LA    @08,POST                                            0902 02956000
         ST    @08,@AL00001                                        0902 02957000
         LA    @08,MDPUAGLP                                        0902 02958000
         ST    @08,@AL00001+4                                      0902 02959000
         LA    @01,@AL00001                                        0902 02960000
         BAL   @14,UCBPOST                                         0902 02961000
*       RESPECIFY                                                  0903 02962000
*         RTNREG RSTD;                                             0903 02963000
*       TESTRC=RTNREG;                                             0904 02964000
         LR    TESTRC,RTNREG                                       0904 02965000
*       RESPECIFY                                                  0905 02966000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 02967000
*       STACLEAR=OFF;               /* TURN OFF RECOVERY     #Y30LB37*/ 02968000
         L     @08,@PC00001                                        0906 02969000
         L     @08,GDTSAH(,@08)                                    0906 02970000
         L     @08,SAHSTA(,@08)                                    0906 02971000
         NI    STACLEAR(@08),B'11110111'                           0906 02972000
*     END;                          /*                       #Y30LB37*/ 02973000
*   RETURN CODE(DEMNTRC);           /* RETURN TO MAIN ROUTINE      0908 02974000
*                                                            #Y30LB37*/ 02975000
@RF00899 LR    @15,DEMNTRC                                         0908 02976000
         L     @14,@SA00009                                        0908 02977000
         LM    @00,@12,@SA00009+8                                  0908 02978000
         BR    @14                                                 0908 02979000
*   END DEMNTVOL;                   /* END OF DEMNTVOL TO DEMOUNT A     02980000
*                                      VIRTUAL VOLUME        #Y30LB37*/ 02981000
*                                                                  0910 02982000
*/********************************************************************/ 02983000
*/*                                                                  */ 02984000
*/*  PROCEDURE NAME - ISSUEDMT                               #Y30LB37*/ 02985000
*/*                                                          #Y30LB37*/ 02986000
*/*  FUNCTION - THIS IS THE ROUTINE THAT ISSUES THE          #Y30LB37*/ 02987000
*/*             USSC MACRO WITH DELAYED RESPONSE IF THE      #Y30LB37*/ 02988000
*/*             CALLER SPECIFIES IT, OR THE NORMAL USSC      #Y30LB37*/ 02989000
*/*             DEMOUNT MACRO WITHOUT DELAYED RESPONSE FOR   #Y30LB37*/ 02990000
*/*             THE DEMOUNTING OF A 3330V VIRTUAL VOLUME.    #Y30LB37*/ 02991000
*/*             IT ALSO CALLS SSCMSG IF AN ERROR OCCURS      #Y30LB37*/ 02992000
*/*             DURING THE DEMOUNTING OF THE VIRTUAL         #Y30LB37*/ 02993000
*/*             VOLUME.                                      #Y30LB37*/ 02994000
*/*                                                          #Y30LB37*/ 02995000
*/*  INPUT - THE INPUT ARGUMENT LIST MDAGL IS USED TO        #Y30LB37*/ 02996000
*/*          ISSUE THE DEMOUNT MACRO.  THE MDWAIT FLAG       #Y30LB37*/ 02997000
*/*          SET BY THE CALLER IN THE MDAGL IS USED TO       #Y30LB37*/ 02998000
*/*          DETERMINE IF DELAYED RESPONSE IS REQUIRED.      #Y30LB37*/ 02999000
*/*                                                          #Y30LB37*/ 03000000
*/*  OUTPUT- IS IN THE FORM OF A ISSUED DEMOUNT MACRO        #Y30LB37*/ 03001000
*/*          AND USSC ERROR MESSAGES PRINTED IF AN ERROR     #Y30LB37*/ 03002000
*/*          OCCURRED DURING THE DEMOUNT.                    #Y30LB37*/ 03003000
*/*          RETURN CODES ARE AS FOLLOWS:                    #Y30LB37*/ 03004000
*/*          0 - SUCCESSFUL                                  #Y30LB37*/ 03005000
*/*          4 - DEMOUNT WAS UNSUCCESSFUL                    #Y30LB37*/ 03006000
*/*          8 - DEMOUNT NOT DONE - NO CORE(USSC)            @ZA00698*/ 03007000
*/*          12 - DESTAGING WAS UNSUCCESSFUL                 #Y30LB37*/ 03008000
*/*                                                                  */ 03009000
*/********************************************************************/ 03010000
*                                                                  0910 03011000
*ISSUEDMT:                                                         0910 03012000
*   PROCEDURE(IDMDAGLP);            /*                       #Y30LB37*/ 03013000
*                                                                  0910 03014000
ISSUEDMT STM   @14,@12,@SA00010                                    0910 03015000
         MVC   @PC00010(4),0(@01)                                  0910 03016000
*   /*****************************************************************/ 03017000
*   /*                                                               */ 03018000
*   /* LOCAL DECLARATIONS FOR ISSUEDMT                       #Y30LB37*/ 03019000
*   /*                                                               */ 03020000
*   /*****************************************************************/ 03021000
*                                                                  0911 03022000
*   DCL                                                            0911 03023000
*     ISUEDRC FIXED(15);            /* ISSUEDMT RETURN CODE  #Y30LB37*/ 03024000
*   DCL                                                            0912 03025000
*     IDMDAGLP PTR(31);             /* PTR TO MDAGL          #Y30LB37*/ 03026000
*   DCL                                                            0913 03027000
*     DMNTLPTR PTR(31);             /* PTR TO THE DMNTLIST   #Y30LB37*/ 03028000
*                                                                  0914 03029000
*   /*****************************************************************/ 03030000
*   /*                                                               */ 03031000
*   /* ********************************************************      */ 03032000
*   /*                                                       @Y30LB02*/ 03033000
*   /* MACMEAN MSSC DEMOUNT MACRO                            @Y30LB02*/ 03034000
*   /* VS1-4/VS2-3 VERSION--01/19/76 LEVEL 00                @ZDR2048*/ 03035000
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/ 03036000
*   /* ********************************************************      */ 03037000
*   /*                                                       @Y30LB02*/ 03038000
*   /*                                                               */ 03039000
*   /*****************************************************************/ 03040000
*                                                                  0914 03041000
*   DCL                                                            0914 03042000
*     1 DMNTLIST BASED(DMNTLPTR),   /* DEMOUNT REQUEST BLOCK @Y30LB02*/ 03043000
*      2 DMLEN FIXED(31),           /* LENGTH OF DEMOUNT REQ BLK = 1C   03044000
*                                      HEX BYTES             @Y30LB02*/ 03045000
*      2 DMOPCD FIXED(8),           /* DEMOUNT OPCODE = 06 HEX     0914 03046000
*                                                            @Y30LB02*/ 03047000
*      2 DMNTRES1 CHAR(1),          /* RESERVED              @Y30LB02*/ 03048000
*      2 DMNTFLAG BIT(16),          /* FLAGS AREA            @Y30LB02*/ 03049000
*       3 DMBITRE1 BIT(1),          /* ONE RESERVED BIT      @YM02186*/ 03050000
*       3 DMDELRSP BIT(1),          /* DEMOUNT DELAYED RESPONSE    0914 03051000
*                                      ATTRIBUTE             @YM02186*/ 03052000
*       3 DMVUAVAL BIT(1),          /* DEMOUNT VUA VALID ATTRIBUTE 0914 03053000
*                                                            @ZDR2048*/ 03054000
*       3 DMBITRES BIT(13),         /* THIRTEEN RESERVED BITS      0914 03055000
*                                                            @ZDR2048*/ 03056000
*      2 DMVOL CHAR(6),             /* VOLID FIELD           @Y30LB02*/ 03057000
*      2 DMNTASID CHAR(2),          /* ASID AREA             @Y30LB02*/ 03058000
*      2 DMNTECB FIXED(31),         /* DEMOUNT EVENT CONTROL BLOCK 0914 03059000
*                                                            @Y30LB02*/ 03060000
*      2 DMHOST CHAR(5),            /* 5-BYTE HOSTID AREA    @Y30LB02*/ 03061000
*      2 DMNTRES2 CHAR(1),          /* RESERVED              @ZDR2048*/ 03062000
*      2 DMNTVUA FIXED(15);         /* VIRTUAL UNIT ADDRESS  @ZDR2048   03063000
*                                                            #Y30LB37*/ 03064000
*                                                                  0914 03065000
*   /*****************************************************************/ 03066000
*   /*                                                               */ 03067000
*   /* STORAGE AREA FOR DEMOUNT ARGUMENT LIST                #Y30LB37*/ 03068000
*   /*                                                               */ 03069000
*   /*****************************************************************/ 03070000
*                                                                  0915 03071000
*   DCL                                                            0915 03072000
*     DEMNTLST CHAR(LENGTH(DMNTLIST))/* STORAGE AREA FOR     #Y30LB37*/ 03073000
*         BDY(WORD);                /* DEMOUNT ARGUMENT LIST #Y30LB37*/ 03074000
*                                                                  0916 03075000
*   /*****************************************************************/ 03076000
*   /*                                                               */ 03077000
*   /* RESPECIFY MDAGL ON INPUT PARAMETER AND INITIALIZE     #Y30LB37*/ 03078000
*   /* RETURN CODE AREA AND ISSUE UTRACE MACRO.              #Y30LB37*/ 03079000
*   /*                                                               */ 03080000
*   /*****************************************************************/ 03081000
*                                                                  0916 03082000
*   RFY                                                            0916 03083000
*     MDAGL BASED(IDMDAGLP);        /*                       #Y30LB37*/ 03084000
*   OLDERID2=NEWERID2;                                             0917 03085000
         L     @08,@PC00001                                        0917 03086000
         L     @05,GDTTR2(,@08)                                    0917 03087000
         MVC   @TS00001(95),NEWERID2(@05)                          0917 03088000
         MVC   OLDERID2(95,@05),@TS00001                           0917 03089000
*   NEWID2='SAID';                  /*                       #Y30LB37*/ 03090000
         MVC   NEWID2(4,@05),@CC02849                              0918 03091000
*   DMNTLPTR=ADDR(DEMNTLST);        /* INIT ARGUMENT LIST PTR      0919 03092000
*                                                            #Y30LB37*/ 03093000
         LA    @05,DEMNTLST                                        0919 03094000
         ST    @05,DMNTLPTR                                        0919 03095000
*   DEMNTLST=''B;                   /* CLEAR THE DEMOUNT LIST      0920 03096000
*                                                            #Y30LB37*/ 03097000
         XC    DEMNTLST(28),DEMNTLST                               0920 03098000
*   ISUEDRC=0;                      /*                       #Y30LB37*/ 03099000
         SLR   ISUEDRC,ISUEDRC                                     0921 03100000
*                                                                  0922 03101000
*   /*****************************************************************/ 03102000
*   /*                                                               */ 03103000
*   /* DETERMINE THE TYPE OF DEMOUNT THAT IS REQUESTED BY    #Y30LB37*/ 03104000
*   /* CHECKING THE MDAGL MDWAIT FLAG TO DETERMINE IF THE    #Y30LB37*/ 03105000
*   /* CALLER WISHES DELAYED RESPONSE ON THE DEMOUNT. IF     #Y30LB37*/ 03106000
*   /* THE MDWAIT FLAG IS ON THIS INDICATES DELAYED          #Y30LB37*/ 03107000
*   /* RESPONSE ON THE DEMOUNT.                              #Y30LB37*/ 03108000
*   /*                                                               */ 03109000
*   /*****************************************************************/ 03110000
*                                                                  0922 03111000
*   IF MDWAIT=ON THEN                                              0922 03112000
         L     @15,@PC00010                                        0922 03113000
         L     @15,IDMDAGLP(,@15)                                  0922 03114000
         TM    MDWAIT(@15),B'00010000'                             0922 03115000
         BNO   @RF00922                                            0922 03116000
*     DO;                           /*                       #Y30LB37*/ 03117000
*       DMDELRSP=ON;                /*                       #Y30LB37*/ 03118000
         OI    DMDELRSP(@05),B'01000000'                           0924 03119000
*       DMVOL=MDLABEL;              /*                       #Y30LB37*/ 03120000
*                                                                  0925 03121000
         MVC   DMVOL(6,@05),MDLABEL(@15)                           0925 03122000
*       /*************************************************************/ 03123000
*       /*                                                           */ 03124000
*       /* ISSUE USSC MACRO TO DEMOUNT THE VOLUME.           #Y30LB37*/ 03125000
*       /*                                                           */ 03126000
*       /*************************************************************/ 03127000
*                                                                  0926 03128000
*       CALL IDCSASS0(GDTTBL,DEMOUNT,DMNTLPTR,REASONCD,ECBCODE);/* 0926 03129000
*                                                            #Y30LB37*/ 03130000
         ST    @08,@AL00001                                        0926 03131000
         LA    @05,DEMOUNT                                         0926 03132000
         ST    @05,@AL00001+4                                      0926 03133000
         LA    @05,DMNTLPTR                                        0926 03134000
         ST    @05,@AL00001+8                                      0926 03135000
         LA    @05,REASONCD                                        0926 03136000
         ST    @05,@AL00001+12                                     0926 03137000
         LA    @05,ECBCODE                                         0926 03138000
         ST    @05,@AL00001+16                                     0926 03139000
         MVI   @AL00001+16,X'80'                                   0926 03140000
         L     @15,GDTSSC(,@08)                                    0926 03141000
         LA    @01,@AL00001                                        0926 03142000
         BALR  @14,@15                                             0926 03143000
*       RESPECIFY                                                  0927 03144000
*         RTNREG RSTD;                                             0927 03145000
*       TESTRC=RTNREG;                                             0928 03146000
         LR    TESTRC,RTNREG                                       0928 03147000
*       RESPECIFY                                                  0929 03148000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 03149000
*                                                                  0929 03150000
*       /*************************************************************/ 03151000
*       /*                                                           */ 03152000
*       /* CALL SSCMSG TO PRINT AN ERROR MESSAGE IF RETURN   @ZA00698*/ 03153000
*       /* CODE IS 4 ELSE SET RETURN CODE TO 8 IF USSC       @ZA00698*/ 03154000
*       /* RETURN CODE IS 8 INDICATING NO CORE.              #Y30LB37*/ 03155000
*       /* IF RETURN CODE IS 4 BUT REASON CODE IS VOLUME     @ZA00698*/ 03156000
*       /* NOT MOUNTED (RC=57), LEAVE RETURN CODE 0.         @ZA00698*/ 03157000
*       /*                                                           */ 03158000
*       /*************************************************************/ 03159000
*                                                                  0930 03160000
*       IF TESTRC=4&REASONCD='57'X THEN/*                    @ZA00698*/ 03161000
         C     TESTRC,@CF00042                                     0930 03162000
         BNE   @RF00930                                            0930 03163000
         CLC   REASONCD(4),@CF02850                                0930 03164000
         BE    @RT00930                                            0930 03165000
*         ;                         /*                       @ZA00698*/ 03166000
*       ELSE                        /*                       @ZA00698*/ 03167000
*         IF TESTRC=4 THEN                                         0932 03168000
@RF00930 C     TESTRC,@CF00042                                     0932 03169000
         BNE   @RF00932                                            0932 03170000
*           DO;                     /*                       #Y30LB37*/ 03171000
*             IF ECBCODE^=ECBZERO THEN                             0934 03172000
         CLC   ECBCODE(1),ECBZERO                                  0934 03173000
         BE    @RF00934                                            0934 03174000
*               ISUEDRC=RCNODSTG;   /*                       #Y30LB37*/ 03175000
         LA    ISUEDRC,12                                          0935 03176000
*             ELSE                                                 0936 03177000
*               ISUEDRC=TESTRC;     /*                       #Y30LB37*/ 03178000
         B     @RC00934                                            0936 03179000
@RF00934 LR    ISUEDRC,TESTRC                                      0936 03180000
*             CALL SSCMSG(REASONCD,ECBCODE);/*               #Y30LB37*/ 03181000
@RC00934 LA    @08,REASONCD                                        0937 03182000
         ST    @08,@AL00001                                        0937 03183000
         LA    @08,ECBCODE                                         0937 03184000
         ST    @08,@AL00001+4                                      0937 03185000
         LA    @01,@AL00001                                        0937 03186000
         BAL   @14,SSCMSG                                          0937 03187000
*           END;                    /*                       #Y30LB37*/ 03188000
*         ELSE                                                     0939 03189000
*           IF TESTRC=8 THEN                                       0939 03190000
         B     @RC00932                                            0939 03191000
@RF00932 C     TESTRC,@CF00179                                     0939 03192000
         BNE   @RF00939                                            0939 03193000
*             ISUEDRC=TESTRC;       /*                       @ZA00698*/ 03194000
         LR    ISUEDRC,TESTRC                                      0940 03195000
*     END;                          /*                       #Y30LB37*/ 03196000
*   ELSE                                                           0942 03197000
*     DO;                           /*                       #Y30LB37*/ 03198000
         B     @RC00922                                            0942 03199000
@RF00922 DS    0H                                                  0943 03200000
*       DMVOL=MDLABEL;              /*                       #Y30LB37*/ 03201000
*                                                                  0943 03202000
         L     @08,DMNTLPTR                                        0943 03203000
         L     @03,@PC00010                                        0943 03204000
         L     @03,IDMDAGLP(,@03)                                  0943 03205000
         MVC   DMVOL(6,@08),MDLABEL(@03)                           0943 03206000
*       /*************************************************************/ 03207000
*       /*                                                           */ 03208000
*       /* ISSUE USSC MACRO TO DEMOUNT THE VOLUME.           #Y30LB37*/ 03209000
*       /*                                                           */ 03210000
*       /*************************************************************/ 03211000
*                                                                  0944 03212000
*       CALL IDCSASS0(GDTTBL,DEMOUNT,DMNTLPTR,REASONCD);/*   #Y30LB37*/ 03213000
         L     @08,@PC00001                                        0944 03214000
         ST    @08,@AL00001                                        0944 03215000
         LA    @03,DEMOUNT                                         0944 03216000
         ST    @03,@AL00001+4                                      0944 03217000
         LA    @03,DMNTLPTR                                        0944 03218000
         ST    @03,@AL00001+8                                      0944 03219000
         LA    @03,REASONCD                                        0944 03220000
         ST    @03,@AL00001+12                                     0944 03221000
         MVI   @AL00001+12,X'80'                                   0944 03222000
         L     @15,GDTSSC(,@08)                                    0944 03223000
         LA    @01,@AL00001                                        0944 03224000
         BALR  @14,@15                                             0944 03225000
*       RESPECIFY                                                  0945 03226000
*         RTNREG RSTD;                                             0945 03227000
*       TESTRC=RTNREG;                                             0946 03228000
         LR    TESTRC,RTNREG                                       0946 03229000
*       RESPECIFY                                                  0947 03230000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 03231000
*                                                                  0947 03232000
*       /*************************************************************/ 03233000
*       /*                                                           */ 03234000
*       /* CALL SSCMSG TO PRINT A ERROR MESSAGE IF FAILED.   #Y30LB37*/ 03235000
*       /*                                                           */ 03236000
*       /*************************************************************/ 03237000
*                                                                  0948 03238000
*       IF TESTRC=4 THEN                                           0948 03239000
         C     TESTRC,@CF00042                                     0948 03240000
         BNE   @RF00948                                            0948 03241000
*         CALL SSCMSG(REASONCD);    /*                       #Y30LB37*/ 03242000
         LA    @08,REASONCD                                        0949 03243000
         ST    @08,@AL00001                                        0949 03244000
         LA    @01,@AL00001                                        0949 03245000
         BAL   @14,SSCMSG                                          0949 03246000
*       ISUEDRC=TESTRC;             /*                       #Y30LB37*/ 03247000
@RF00948 LR    ISUEDRC,TESTRC                                      0950 03248000
*     END;                          /*                       #Y30LB37*/ 03249000
*                                                                  0952 03250000
*   /*****************************************************************/ 03251000
*   /*                                                               */ 03252000
*   /* INITIALIZE AND SET OFF STAEPARM TRACKING AREAS.       #Y30LB37*/ 03253000
*   /*                                                               */ 03254000
*   /*****************************************************************/ 03255000
*                                                                  0952 03256000
*   STAVMNT=OFF;                    /* TURN OFF MOUNT BIT    #Y30LB37*/ 03257000
@RC00922 DS    0H                                                  0953 03258000
*   STAVPOST=OFF;                   /* TURN OFF POST TRACKING      0953 03259000
*                                                            #Y30LB37*/ 03260000
         L     @08,@PC00001                                        0953 03261000
         L     @08,GDTSAH(,@08)                                    0953 03262000
         L     @08,SAHSTA(,@08)                                    0953 03263000
         NI    STAVMNT(@08),B'01101111'                            0953 03264000
*   STAVVOL=MDLABEL;                /* INITIALIZE VOLSER     #Y30LB37*/ 03265000
         L     @05,@PC00010                                        0954 03266000
         L     @05,IDMDAGLP(,@05)                                  0954 03267000
         MVC   STAVVOL(6,@08),MDLABEL(@05)                         0954 03268000
*   STAVUCB=MDUCBADR;               /* INITIALIZE UCB ADDRESS      0955 03269000
*                                                            #Y30LB37*/ 03270000
*                                                                  0955 03271000
         L     @05,MDUCBPTR(,@05)                                  0955 03272000
         L     @05,MDUCBADR(,@05)                                  0955 03273000
         ST    @05,STAVUCB(,@08)                                   0955 03274000
*   /*****************************************************************/ 03275000
*   /*                                                               */ 03276000
*   /* IF DEMOUNT ORDER WAS ACCEPTED, SET FLAG.              @ZA00698*/ 03277000
*   /*                                                               */ 03278000
*   /*****************************************************************/ 03279000
*                                                                  0956 03280000
*   IF TESTRC=0|TESTRC=RCNODSTG THEN                               0956 03281000
         LTR   TESTRC,TESTRC                                       0956 03282000
         BZ    @RT00956                                            0956 03283000
         C     TESTRC,@CF00037                                     0956 03284000
         BNE   @RF00956                                            0956 03285000
@RT00956 DS    0H                                                  0957 03286000
*     STAVDMNT=ON;                  /* TURN ON DEMOUNT FLAG  @ZA00698*/ 03287000
         L     @08,@PC00001                                        0957 03288000
         L     @08,GDTSAH(,@08)                                    0957 03289000
         L     @08,SAHSTA(,@08)                                    0957 03290000
         OI    STAVDMNT(@08),B'01000000'                           0957 03291000
*   IF MDENQ=ON THEN                                               0958 03292000
@RF00956 L     @08,@PC00010                                        0958 03293000
         L     @08,IDMDAGLP(,@08)                                  0958 03294000
         TM    MDENQ(@08),B'00001000'                              0958 03295000
         BNO   @RF00958                                            0958 03296000
*     DO;                           /*                       #Y30LB37*/ 03297000
*       STATCB=TCBP;                /*                       #Y30LB37*/ 03298000
         L     @08,@PC00001                                        0960 03299000
         L     @08,GDTSAH(,@08)                                    0960 03300000
         L     @08,SAHSTA(,@08)                                    0960 03301000
         L     @05,TCBP                                            0960 03302000
         ST    @05,STATCB(,@08)                                    0960 03303000
*       STAVENQ=ON;                 /*                       #Y30LB37*/ 03304000
         OI    STAVENQ(@08),B'00100000'                            0961 03305000
*     END;                          /*                       #Y30LB37*/ 03306000
*   RETURN CODE(ISUEDRC);           /* RETURN TO MAIN ROUTINE      0963 03307000
*                                                            #Y30LB37*/ 03308000
@RF00958 LR    @15,ISUEDRC                                         0963 03309000
         L     @14,@SA00010                                        0963 03310000
         LM    @00,@12,@SA00010+8                                  0963 03311000
         BR    @14                                                 0963 03312000
*   END ISSUEDMT;                   /* END OF ISSUEDMT TO DEMOUNT A     03313000
*                                      VIRTUAL VOLUME        #Y30LB37*/ 03314000
*                                                                  0965 03315000
*/********************************************************************/ 03316000
*/*                                                                  */ 03317000
*/*  PROCEDURE NAME - ENQDEQ                                 #Y30LB37*/ 03318000
*/*                                                          #Y30LB37*/ 03319000
*/*  FUNCTION - THIS IS THE ROUTINE THAT ISSUES THE          #Y30LB37*/ 03320000
*/*             DEQ MACRO IF THE REQUEST IS A DEQ, OR THE    #Y30LB37*/ 03321000
*/*             ENQ MACRO IF CALLER SPECIFIED A ENQ REQUEST. #Y30LB37*/ 03322000
*/*             THE ENQ MACRO IS ISSUED TO EXCLUSIVELY       #Y30LB37*/ 03323000
*/*             CONTROL THE VOLUME SERIAL RESOURCE.          #Y30LB37*/ 03324000
*/*             IT ALSO ISSUES MESSAGE IDC2390I IF AN        #Y30LB37*/ 03325000
*/*             ERROR OCCURS ON THE ENQUEUE OF THE           #Y30LB37*/ 03326000
*/*             VIRTUAL VOLUME.                              #Y30LB37*/ 03327000
*/*                                                          #Y30LB37*/ 03328000
*/*  INPUT - THE INPUT ARGUMENT LIST MDAGL IS USED TO        #Y30LB37*/ 03329000
*/*          ISSUE THE ENQ/DEQ MACRO.                        #Y30LB37*/ 03330000
*/*                                                          #Y30LB37*/ 03331000
*/*  OUTPUT- IS IN THE FORM OF A ISSUED ENQ/DEQ MACRO.       #Y30LB37*/ 03332000
*/*          THE MDENQ FLAG IS SET ON IN THE MDAGL IF        #Y30LB37*/ 03333000
*/*          AN ENQUEUE WAS PERFORMED: THE MDENQ FLAG IS     #Y30LB37*/ 03334000
*/*          SET OFF IF A DEQUEUE WAS PERFORMED.             #Y30LB37*/ 03335000
*/*          RETURN CODES ARE AS FOLLOWS:                    #Y30LB37*/ 03336000
*/*          0 - SUCCESSFUL                                  #Y30LB37*/ 03337000
*/*          4 - ENQ/DEQ WAS UNSUCCESSFUL                    #Y30LB37*/ 03338000
*/*                                                                  */ 03339000
*/********************************************************************/ 03340000
*                                                                  0965 03341000
*ENQDEQ:                                                           0965 03342000
*   PROCEDURE(ORDER,EDAGLPTR);      /*                       #Y30LB37*/ 03343000
ENQDEQ   STM   @14,@12,@SA00011                                    0965 03344000
         MVC   @PC00011(8),0(@01)                                  0965 03345000
*                                                                  0966 03346000
*   /*****************************************************************/ 03347000
*   /*                                                               */ 03348000
*   /* LOCAL DECLARATIONS FOR ENQDEQ                         #Y30LB37*/ 03349000
*   /*                                                               */ 03350000
*   /*****************************************************************/ 03351000
*                                                                  0966 03352000
*   DCL                                                            0966 03353000
*     ENQDQRC FIXED(15);            /* ENQDEQ RETURN CODE    #Y30LB37*/ 03354000
*   DCL                                                            0967 03355000
*     ORDER CHAR(8);                /* ENQDEQ REQUEST CODE   #Y30LB37*/ 03356000
*   DCL                                                            0968 03357000
*     EDAGLPTR PTR(31);             /* ENQDEQ MDAGL PTR      #Y30LB37*/ 03358000
*   DCL                                                            0969 03359000
*     ENQBEGIN CHAR(*) GEND;        /* ENQ LIST BEGINNING    #Y30LB37*/ 03360000
*   DCL                                                            0970 03361000
*     DEQBEGIN CHAR(*) GEND;        /* DEQ LIST BEGINNING    #Y30LB37*/ 03362000
*   DCL                                                            0971 03363000
*     TENQBEGN CHAR(*) GEND;        /* ENQ LIST BEGINNING    #Y30LB37*/ 03364000
*   DCL                                                            0972 03365000
*     ENQLIST CHAR(*) GEND;         /* ENQUEUE GETMAINED     #Y30LB37*/ 03366000
*   DCL                                                            0973 03367000
*     DEQLIST CHAR(*) GEND;         /* DEQUEUE GETMAINED     #Y30LB37*/ 03368000
*   DCL                                                            0974 03369000
*     TENQLIST CHAR(*) GEND;        /* ENQUEUE GETMAINED     #Y30LB37*/ 03370000
*   DCL                                                            0975 03371000
*     MAJNAME CHAR(8) STATIC        /* MAJOR ENQ / DEQ       #Y30LB37*/ 03372000
*         INIT('SYSZVOLS');         /* RESOURCE NAME         #Y30LB37*/ 03373000
*   DCL                                                            0976 03374000
*     VOLSER CHAR(6) BDY(WORD);     /* VOLSER FIELD FOR ENQ  #Y30LB37*/ 03375000
*                                                                  0977 03376000
*   /*****************************************************************/ 03377000
*   /*                                                               */ 03378000
*   /* CONTINUED LOCAL DECLARATIONS FOR ENQDEQ               #Y30LB37*/ 03379000
*   /*                                                               */ 03380000
*   /*****************************************************************/ 03381000
*                                                                  0977 03382000
*   DCL                                                            0977 03383000
*     ENQCORE CHAR(*) STATIC LOCAL GEND;/* GEND CORE DECLARE #Y30LB37*/ 03384000
*   DCL                                                            0978 03385000
*     DEQCORE CHAR(*) STATIC LOCAL GEND;/* GEND CORE DECLARE #Y30LB37*/ 03386000
*   DCL                                                            0979 03387000
*     TENQCORE CHAR(*) STATIC LOCAL GEND;/* GEND CORE DECLARE      0979 03388000
*                                                            #Y30LB37*/ 03389000
*   DCL                                                            0980 03390000
*     TENQLEN FIXED(31) STATIC LOCAL GEND;/* GEND LENGTH DCL #Y30LB37*/ 03391000
*   DCL                                                            0981 03392000
*     ENQLEN FIXED(31) STATIC LOCAL GEND;/* GEND LENGTH DCL  #Y30LB37*/ 03393000
*   DCL                                                            0982 03394000
*     DEQLEN FIXED(31) STATIC LOCAL GEND;/* GEND LENGTH DCL  #Y30LB37*/ 03395000
*   GENERATE DATA DEFS(ENQCORE,DEQCORE,TENQCORE,TENQLEN,ENQLEN,DEQLEN)  03396000
*       REFS(MAJNAME);                                             0983 03397000
*   GENERATE DATA DEFS(ENQLIST,DEQLIST,TENQLIST,ENQBEGIN,DEQBEGIN, 0984 03398000
*       TENQBEGN) REFS(MAJNAME);                                   0984 03399000
*                                                                  0985 03400000
*   /*****************************************************************/ 03401000
*   /*                                                               */ 03402000
*   /* RESPECIFY MDAGL ON INPUT PARAMETER AND INITIALIZE     #Y30LB37*/ 03403000
*   /* RETURN CODE AREA AND ISSUE UTRACE MACRO.              #Y30LB37*/ 03404000
*   /*                                                               */ 03405000
*   /*****************************************************************/ 03406000
*                                                                  0985 03407000
*   RFY                                                            0985 03408000
*     MDAGL BASED(EDAGLPTR);        /*                       #Y30LB37*/ 03409000
*   OLDERID2=NEWERID2;                                             0986 03410000
         L     @08,@PC00001                                        0986 03411000
         L     @05,GDTTR2(,@08)                                    0986 03412000
         MVC   @TS00001(95),NEWERID2(@05)                          0986 03413000
         MVC   OLDERID2(95,@05),@TS00001                           0986 03414000
*   NEWID2='SAED';                  /*                       #Y30LB37*/ 03415000
         MVC   NEWID2(4,@05),@CC02887                              0987 03416000
*   ENQDQRC=0;                      /*                       #Y30LB37*/ 03417000
         SLR   ENQDQRC,ENQDQRC                                     0988 03418000
*                                                                  0989 03419000
*   /*****************************************************************/ 03420000
*   /*                                                               */ 03421000
*   /* CHECK THE ORDER KEYWORD FOR A ENQ COMMAND. IF AN      #Y30LB37*/ 03422000
*   /* ENQ THEN ISSUE THE DIRECTED ENQUE TO THE INITIATOR'S  #Y30LB37*/ 03423000
*   /* TCB. IF DEQ COMMAND THEN DO THE ELSE STEP.            #Y30LB37*/ 03424000
*   /*                                                               */ 03425000
*   /*****************************************************************/ 03426000
*                                                                  0989 03427000
*   IF ORDER=ENQCMD THEN                                           0989 03428000
         L     @05,@PC00011                                        0989 03429000
         CLC   ORDER(8,@05),ENQCMD                                 0989 03430000
         BNE   @RF00989                                            0989 03431000
*     DO;                           /*                       #Y30LB37*/ 03432000
*       VOLSER=MDLABEL;             /*                       #Y30LB37*/ 03433000
         L     @15,@PC00011+4                                      0991 03434000
         L     @15,EDAGLPTR(,@15)                                  0991 03435000
         MVC   VOLSER(6),MDLABEL(@15)                              0991 03436000
*       ENQBEGIN(1:ENQLEN)=ENQCORE(1:ENQLEN);/*              #Y30LB37*/ 03437000
         L     @14,ENQLEN                                          0992 03438000
         BCTR  @14,0                                               0992 03439000
         EX    @14,@SM03055                                        0992 03440000
*       STAVVOL=MDLABEL;            /*                       #Y30LB37*/ 03441000
         L     @08,GDTSAH(,@08)                                    0993 03442000
         L     @08,SAHSTA(,@08)                                    0993 03443000
         MVC   STAVVOL(6,@08),MDLABEL(@15)                         0993 03444000
*       STATCB=TCBP;                /*                       #Y30LB37*/ 03445000
         L     @15,TCBP                                            0994 03446000
         ST    @15,STATCB(,@08)                                    0994 03447000
*       STAVENQ=ON;                 /*                       #Y30LB37*/ 03448000
         OI    STAVENQ(@08),B'00100000'                            0995 03449000
*LENQ1:                                                            0996 03450000
*       GENERATE REFS(MAJNAME,VOLSER,ENQLIST,TCBP);                0996 03451000
LENQ1    DS    0H                                                  0996 03452000
*                                                         /*#Y30LB37*/  03453000
         ENQ   (MAJNAME,VOLSER,E,6,SYSTEM),RET=USE,MF=(E,ENQLIST),    **03454000
               TCB=TCBP            DIRECTED ENQUEUE                     03455000
*       RESPECIFY                                                  0997 03456000
*         RTNREG RSTD;                                             0997 03457000
*       TESTRC=RTNREG;                                             0998 03458000
         LR    TESTRC,RTNREG                                       0998 03459000
*       RESPECIFY                                                  0999 03460000
*         RTNREG UNRSTD;            /*                       #Y30LB37*/ 03461000
*       ENQDQRC=TESTRC;             /*                       #Y30LB37*/ 03462000
*                                                                  1000 03463000
         LR    ENQDQRC,TESTRC                                      1000 03464000
*       /*************************************************************/ 03465000
*       /*                                                           */ 03466000
*       /* IF THE ENQ WAS SUCCESSFUL, SET THE ENQ BIT IN     #Y30LB37*/ 03467000
*       /* THE STAE PARAMETER LIST AND IN THE MDAGL.         #Y30LB37*/ 03468000
*       /* IF THE ENQ WAS NOT SUCCESSFUL, SET THE ENQ        #Y30LB37*/ 03469000
*       /* BIT OFF IN THE MDAGL AND THE STAEPARM.            #Y30LB37*/ 03470000
*       /*                                                           */ 03471000
*       /*************************************************************/ 03472000
*                                                                  1001 03473000
*       IF ENQDQRC=0 THEN                                          1001 03474000
         LTR   ENQDQRC,ENQDQRC                                     1001 03475000
         BNZ   @RF01001                                            1001 03476000
*         MDENQ=ON;                 /*                       #Y30LB37*/ 03477000
         L     @08,@PC00011+4                                      1002 03478000
         L     @08,EDAGLPTR(,@08)                                  1002 03479000
         OI    MDENQ(@08),B'00001000'                              1002 03480000
*       ELSE                                                       1003 03481000
*         DO;                       /*                       #Y30LB37*/ 03482000
         B     @RC01001                                            1003 03483000
@RF01001 DS    0H                                                  1004 03484000
*           MDENQ=OFF;              /*                       #Y30LB37*/ 03485000
         L     @08,@PC00011+4                                      1004 03486000
         L     @08,EDAGLPTR(,@08)                                  1004 03487000
         NI    MDENQ(@08),B'11110111'                              1004 03488000
*           STAVENQ=OFF;            /*                       #Y30LB37*/ 03489000
         L     @08,@PC00001                                        1005 03490000
         L     @08,GDTSAH(,@08)                                    1005 03491000
         L     @08,SAHSTA(,@08)                                    1005 03492000
         NI    STAVENQ(@08),B'11011111'                            1005 03493000
*         END;                      /*                       #Y30LB37*/ 03494000
*                                                                  1007 03495000
*       /*************************************************************/ 03496000
*       /*                                                           */ 03497000
*       /* CHECK THE RETURN CODE TO SEE IF ENQ WAS           #Y30LB37*/ 03498000
*       /* SUCCESSFUL OR NOT. IF THE ENQ FAILED, THEN ISSUE  #Y30LB37*/ 03499000
*       /* A ENQ TO CHECK IF THE VOLUME CAN BE SHARED.       #Y30LB37*/ 03500000
*       /*                                                           */ 03501000
*       /*************************************************************/ 03502000
*                                                                  1007 03503000
*       IF ENQDQRC^=0 THEN                                         1007 03504000
@RC01001 LTR   ENQDQRC,ENQDQRC                                     1007 03505000
         BZ    @RF01007                                            1007 03506000
*         DO;                       /*                       #Y30LB37*/ 03507000
*           TENQBEGN(1:TENQLEN)=TENQCORE(1:TENQLEN);/*       #Y30LB37*/ 03508000
         L     @08,TENQLEN                                         1009 03509000
         BCTR  @08,0                                               1009 03510000
         EX    @08,@SM03057                                        1009 03511000
*LENQ2:                                                            1010 03512000
*           GENERATE REFS(MAJNAME,VOLSER,TENQLIST,TCBP);           1010 03513000
LENQ2    DS    0H                                                  1010 03514000
*                                                         /*#Y30LB37*/  03515000
           ENQ (MAJNAME,VOLSER,S,6,SYSTEM),RET=TEST,MF=(E,TENQLIST),  **03516000
               TCB=TCBP            ENQ FOR SHARED                       03517000
*           RESPECIFY                                              1011 03518000
*             RTNREG RSTD;                                         1011 03519000
*           TESTRC=RTNREG;                                         1012 03520000
         LR    TESTRC,RTNREG                                       1012 03521000
*           RESPECIFY                                              1013 03522000
*             RTNREG UNRSTD;        /*                       #Y30LB37*/ 03523000
*                                                                  1013 03524000
*           /*********************************************************/ 03525000
*           /*                                                       */ 03526000
*           /* CHECK THE RETURN CODE TO SEE IF ENQ WAS       #Y30LB37*/ 03527000
*           /* SUCCESSFUL OR NOT. IF THE ENQ WAS SUCCESSFUL  #Y30LB37*/ 03528000
*           /* MEANS IT IS ENQUEUED FOR EXCL USE SO, THEN    #Y30LB37*/ 03529000
*           /* ISSUE ERROR MESSAGE IDC2390I.                 #Y30LB37*/ 03530000
*           /*                                                       */ 03531000
*           /*********************************************************/ 03532000
*                                                                  1014 03533000
*           IF TESTRC=0 THEN                                       1014 03534000
         LTR   TESTRC,TESTRC                                       1014 03535000
         BNZ   @RF01014                                            1014 03536000
*             DO;                   /*                       #Y30LB37*/ 03537000
*               ENQDQRC=4;          /*                       #Y30LB37*/ 03538000
         LA    ENQDQRC,4                                           1016 03539000
*               DARGSMOD=MSGMODID;  /*                       #Y30LB37*/ 03540000
         L     @08,DDSTRU                                          1017 03541000
         MVC   DARGSMOD(3,@08),@CC02595                            1017 03542000
*               DARGSENT=MSG2390I;  /*                       #Y30LB37*/ 03543000
         MVI   DARGSENT(@08),X'0A'                                 1018 03544000
*               DARGDBP=ADDR(MDLABEL);/*                     #Y30LB37*/ 03545000
         L     @05,@PC00011+4                                      1019 03546000
         L     @05,EDAGLPTR(,@05)                                  1019 03547000
         LA    @05,MDLABEL(,@05)                                   1019 03548000
         ST    @05,DARGDBP(,@08)                                   1019 03549000
*               DARGILP=VOLSERLN;   /*                       #Y30LB37*/ 03550000
         MVC   DARGILP(2,@08),@CH00156                             1020 03551000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      #Y30LB37*/ 03552000
         L     @08,@PC00001                                        1021 03553000
         ST    @08,@AL00001                                        1021 03554000
         LA    @05,@CF00115                                        1021 03555000
         ST    @05,@AL00001+4                                      1021 03556000
         LA    @05,DDSTRU                                          1021 03557000
         ST    @05,@AL00001+8                                      1021 03558000
         MVI   @AL00001+8,X'80'                                    1021 03559000
         L     @15,GDTPRT(,@08)                                    1021 03560000
         LA    @01,@AL00001                                        1021 03561000
         BALR  @14,@15                                             1021 03562000
*             END;                  /*                       #Y30LB37*/ 03563000
*           ELSE                                                   1023 03564000
*             ENQDQRC=0;            /*                       #Y30LB37*/ 03565000
         B     @RC01014                                            1023 03566000
@RF01014 SLR   ENQDQRC,ENQDQRC                                     1023 03567000
*         END;                      /*                       #Y30LB37*/ 03568000
*     END;                          /*                       #Y30LB37*/ 03569000
*                                                                  1026 03570000
*   /*****************************************************************/ 03571000
*   /*                                                               */ 03572000
*   /* CHECK THE ORDER KEYWORD FOR A DEQ COMMAND. IF AN      #Y30LB37*/ 03573000
*   /* DEQ THEN ISSUE THE DEQUEUE TO THE INITIATOR'S         #Y30LB37*/ 03574000
*   /* TCB. IF NOT A DEQUEUE THEN NO FUNCTION IS PERFORMED.  #Y30LB37*/ 03575000
*   /* SET THE ENQ BIT OFF IN THE STAE PARAMETER LIST AND    #Y30LB37*/ 03576000
*   /* IN THE MDAGL.                                         #Y30LB37*/ 03577000
*   /*                                                               */ 03578000
*   /*****************************************************************/ 03579000
*                                                                  1026 03580000
*   ELSE                                                           1026 03581000
*     IF ORDER=DEQCMD THEN                                         1026 03582000
         B     @RC00989                                            1026 03583000
@RF00989 L     @08,@PC00011                                        1026 03584000
         CLC   ORDER(8,@08),DEQCMD                                 1026 03585000
         BNE   @RF01026                                            1026 03586000
*       DO;                         /*                       #Y30LB37*/ 03587000
*         VOLSER=MDLABEL;           /*                       #Y30LB37*/ 03588000
         L     @08,@PC00011+4                                      1028 03589000
         L     @08,EDAGLPTR(,@08)                                  1028 03590000
         MVC   VOLSER(6),MDLABEL(@08)                              1028 03591000
*         DEQBEGIN(1:DEQLEN)=DEQCORE(1:DEQLEN);/*            #Y30LB37*/ 03592000
         L     @08,DEQLEN                                          1029 03593000
         BCTR  @08,0                                               1029 03594000
         EX    @08,@SM03059                                        1029 03595000
*LDEQ1:                                                            1030 03596000
*         GENERATE REFS(MAJNAME,VOLSER,TCBP,DEQLIST);              1030 03597000
LDEQ1    DS    0H                                                  1030 03598000
*                                                         /*#Y30LB37*/  03599000
         DEQ   (MAJNAME,VOLSER,6,SYSTEM),RET=HAVE,MF=(E,DEQLIST),     **03600000
               TCB=TCBP            DEQ WITH HAVE OPTION                 03601000
*         STAVENQ=OFF;              /*                       #Y30LB37*/ 03602000
         L     @08,@PC00001                                        1031 03603000
         L     @08,GDTSAH(,@08)                                    1031 03604000
         L     @08,SAHSTA(,@08)                                    1031 03605000
         NI    STAVENQ(@08),B'11011111'                            1031 03606000
*         MDENQ=OFF;                /*                       #Y30LB37*/ 03607000
         L     @08,@PC00011+4                                      1032 03608000
         L     @08,EDAGLPTR(,@08)                                  1032 03609000
         NI    MDENQ(@08),B'11110111'                              1032 03610000
*       END;                        /*                       #Y30LB37*/ 03611000
*                                                                  1033 03612000
*   /*****************************************************************/ 03613000
*   /*                                                               */ 03614000
*   /* RETURN TO MAIN PROCEDURE.                             #Y30LB37*/ 03615000
*   /*                                                               */ 03616000
*   /*****************************************************************/ 03617000
*                                                                  1034 03618000
*   RETURN CODE(ENQDQRC);           /* RETURN TO MAIN ROUTINE      1034 03619000
*                                                            #Y30LB37*/ 03620000
@RF01026 DS    0H                                                  1034 03621000
@RC00989 LR    @15,ENQDQRC                                         1034 03622000
         L     @14,@SA00011                                        1034 03623000
         LM    @00,@12,@SA00011+8                                  1034 03624000
         BR    @14                                                 1034 03625000
*   END ENQDEQ;                     /* END OF ENQDEQ TO ENQ / DEQ A     03626000
*                                      VIRTUAL VOLUME        @Y30LB37*/ 03627000
*                                                                  1036 03628000
*/********************************************************************/ 03629000
*/*                                                                  */ 03630000
*/*  PROCEDURE NAME - FINDEXCL                               @YD00175*/ 03631000
*/*                                                          @YD00175*/ 03632000
*/*  FUNCTION - THIS ROUTINE DETERMINES IF THE VOLUME IS     @YD00175*/ 03633000
*/*             ALLOCATED EXCLUSIVELY.  IF SO, RETURNS THE   @YD00175*/ 03634000
*/*             UCB ADDRESS AND THE DDNAME FOR THE VOLUME    @YD00175*/ 03635000
*/*             TO THE CALLER.  ISSUES ERROR MESSAGE         @YD00175*/ 03636000
*/*             IDC3392I IF AN ERROR OCCURRS.                @YD00175*/ 03637000
*/*                                                          @YD00175*/ 03638000
*/*  INPUT - THE INPUT ARGUMENT LIST EXCLAGL IS USED TO      @YD00175*/ 03639000
*/*          COMPARE VOLSER TO THE UCBVOLI FIELD.  THE UCB   @YD00175*/ 03640000
*/*          ADDRESS IN THE EXCLAGL IS USED TO FIND THE UCB. @YD00175*/ 03641000
*/*                                                          @YD00175*/ 03642000
*/*  OUTPUT- ISSUE ERROR MESSAGE AND RETURN TO CALLER WITH   @YD00175*/ 03643000
*/*          RETURN CODE IN REGISTER 15 AS FOLLOWS:          @YD00175*/ 03644000
*/*          0 - SUCCESSFUL, DDNAME TO USE WAS FOUND, OR     @YD00175*/ 03645000
*/*              THE VOLUME CAN BE DYNAMICALLY ALLOCATED.    @YD00175*/ 03646000
*/*          4 - THE VOLUME IS ALLOCATED EXCLUSIVELY TO THIS @YD00175*/ 03647000
*/*              JOB STEP BUT THERE IS NO UNIT AVAILABLE.    @YD00175*/ 03648000
*/*                                                                  */ 03649000
*/********************************************************************/ 03650000
*                                                                  1036 03651000
*FINDEXCL:                                                         1036 03652000
*   PROCEDURE(EXAGLPTR);            /*                       @YD00175*/ 03653000
FINDEXCL STM   @14,@12,@SA00012                                    1036 03654000
         MVC   @PC00012(4),0(@01)                                  1036 03655000
*                                                                  1037 03656000
*   /*****************************************************************/ 03657000
*   /*                                                               */ 03658000
*   /* LOCAL DECLARATIONS FOR FINDEXCL                       @YD00175*/ 03659000
*   /*                                                               */ 03660000
*   /*****************************************************************/ 03661000
*                                                                  1037 03662000
*   DCL                                                            1037 03663000
*     1 TCODE BASED(TESTRC),        /*                       @ZA11676*/ 03664000
*      2 * CHAR(3),                 /*                       @ZA13046*/ 03665000
*      2 TESTCODE FIXED(8);         /* RET CODE FROM ENQ     @ZA13046*/ 03666000
*   DCL                                                            1038 03667000
*     ENQRC08 FIXED(8) CONSTANT(8); /* ENQ CODE 8            @ZA13046*/ 03668000
*   DCL                                                            1039 03669000
*     FINDXRC FIXED(15);            /* FINDEXCL RETURN CODE  @YD00175*/ 03670000
*   DCL                                                            1040 03671000
*     EXAGLPTR PTR(31);             /* FINDEXCL EXCLAGL PTR  @YD00175*/ 03672000
*   DCL                                                            1041 03673000
*     MAJRNAM CHAR(8) STATIC        /* MAJOR ENQUEUE NAME    @YD00175*/ 03674000
*         BDY(WORD) INIT('SYSZTIOT');/* INITIALIZED          @YD00175*/ 03675000
*   DCL                                                            1042 03676000
*     1 MINRNAME,                   /* MINOR ENQUEUE NAME    @YD00175*/ 03677000
*      2 MINRLEN FIXED(8),          /* LENGTH OF MINOR NAME  @YD00175*/ 03678000
*      2 MINRASID CHAR(2),          /* ASID OF THIS JOB STEP @YD00175*/ 03679000
*      2 MINRQDB CHAR(4);           /* QDB ADDRESS           @YD00175*/ 03680000
*   DCL                                                            1043 03681000
*     ENQBEGN3 CHAR(*) GEND;        /* ENQ LIST BEGINNING    @YD00175*/ 03682000
*   DCL                                                            1044 03683000
*     ENQLIST3 CHAR(*) GEND;        /* ENQUEUE GETMAINED     @YD00175*/ 03684000
*   DCL                                                            1045 03685000
*     MAJNAME3 CHAR(8) STATIC       /* MAJOR ENQ / DEQ       @YD00175*/ 03686000
*         INIT('SYSZVOLS');         /* RESOURCE NAME         @YD00175*/ 03687000
*   DCL                                                            1046 03688000
*     VOLSER3 CHAR(6) BDY(WORD);    /* VOLSER FIELD FOR ENQ  @YD00175*/ 03689000
*   DCL                                                            1047 03690000
*     ENQCORE3 CHAR(*) STATIC LOCAL GEND;/* GEND CORE DECLARE      1047 03691000
*                                                            @YD00175*/ 03692000
*   DCL                                                            1048 03693000
*     ENQLEN3 FIXED(31) STATIC LOCAL GEND;/* GEND LENGTH DCL @YD00175*/ 03694000
*   GENERATE DATA DEFS(ENQCORE3,ENQLEN3) REFS(MAJNAME3);           1049 03695000
*   GENERATE DATA DEFS(ENQLIST3,ENQBEGN3) REFS(MAJNAME3);          1050 03696000
*                                                                  1051 03697000
*   /*****************************************************************/ 03698000
*   /*                                                               */ 03699000
*   /* RESPECIFY EXCLAGL ON INPUT PARAMETER AND INITIALIZE   @YD00175*/ 03700000
*   /* RETURN CODE AREA AND ISSUE UTRACE MACRO.              @YD00175*/ 03701000
*   /*                                                               */ 03702000
*   /*****************************************************************/ 03703000
*                                                                  1051 03704000
*   RFY                                                            1051 03705000
*     EXCLAGL BASED(EXAGLPTR);      /*                       @YD00175*/ 03706000
*   OLDERID2=NEWERID2;                                             1052 03707000
         L     @08,@PC00001                                        1052 03708000
         L     @15,GDTTR2(,@08)                                    1052 03709000
         MVC   @TS00001(95),NEWERID2(@15)                          1052 03710000
         MVC   OLDERID2(95,@15),@TS00001                           1052 03711000
*   NEWID2='SAFE';                  /*                       @YD00175*/ 03712000
         MVC   NEWID2(4,@15),@CC02921                              1053 03713000
*   FINDXRC=0;                      /*                       @YD00175*/ 03714000
*                                                                  1054 03715000
         SLR   FINDXRC,FINDXRC                                     1054 03716000
*   /*****************************************************************/ 03717000
*   /*                                                               */ 03718000
*   /* INITIALIZE POINTERS TO THE TCB, ASCB, QDB, AND DSAB.  @YD00175*/ 03719000
*   /* SET MINOR LENGTH FOR UENQ MACRO.                      @YD00175*/ 03720000
*   /*                                                               */ 03721000
*   /*****************************************************************/ 03722000
*                                                                  1055 03723000
*   ASCBPTR=PSAAOLD;                /*                       @YD00175*/ 03724000
         L     ASCBPTR,PSAAOLD                                     1055 03725000
*   MINRASID=ASCBASID;              /*                       @YD00175*/ 03726000
         MVC   MINRASID(2),ASCBASID(ASCBPTR)                       1056 03727000
*   TCBPTR=CURTCBP;                 /*                       @YD00175*/ 03728000
         L     @01,CVTPTR                                          1057 03729000
         L     @01,TCBWDSP(,@01)                                   1057 03730000
         L     TCBPTR,CURTCBP(,@01)                                1057 03731000
*   TCBP=JSCBTCBP;                  /*                       @YD00175*/ 03732000
         L     @15,TCBJSCB(,TCBPTR)                                1058 03733000
         L     @14,JSCBTCBP(,@15)                                  1058 03734000
         ST    @14,TCBP                                            1058 03735000
*   QDBPTR=JSCDSABQ;                /*                       @YD00175*/ 03736000
         L     QDBPTR,JSCDSABQ(,@15)                               1059 03737000
*   DSABPTR=QDBFELMP;               /*                       @YD00175*/ 03738000
         L     DSABPTR,QDBFELMP(,QDBPTR)                           1060 03739000
*   MINRQDB=QDBPTR;                 /*                       @YD00175*/ 03740000
         STCM  QDBPTR,15,MINRQDB                                   1061 03741000
*   MINRLEN=LENGTH(MINRASID)+LENGTH(MINRQDB);/*              @YD00175*/ 03742000
         MVI   MINRLEN,X'06'                                       1062 03743000
*                                                                  1063 03744000
*   /*****************************************************************/ 03745000
*   /*                                                               */ 03746000
*   /* ISSUE UENQ MACRO TO ENQUEUE ON THE TIOT AND WAIT.     @YD00175*/ 03747000
*   /*                                                               */ 03748000
*   /*****************************************************************/ 03749000
*                                                                  1063 03750000
*   CALL IDCSANQ0(GDTTBL,SHR,WAIT,MAJRNAM,MINRNAME);/*       @YD00175*/ 03751000
*                                                                  1063 03752000
         MVC   @AL00001+4(12),@AL01063                             1063 03753000
         ST    @08,@AL00001                                        1063 03754000
         LA    @15,MINRNAME                                        1063 03755000
         ST    @15,@AL00001+16                                     1063 03756000
         MVI   @AL00001+16,X'80'                                   1063 03757000
         L     @15,GDTENQ(,@08)                                    1063 03758000
         LA    @01,@AL00001                                        1063 03759000
         BALR  @14,@15                                             1063 03760000
*   /*****************************************************************/ 03761000
*   /*                                                               */ 03762000
*   /* CALL SCANTIOT IF DSAB POINTER IS NOT ZEROS.           @YD00175*/ 03763000
*   /* IF THERE ARE NO DD ENTRIES THEN RETURN TO CALLER      @YD00175*/ 03764000
*   /* AFTER SETTING ON FOUNDVOL FLAG AND CLEARING ARGLIST.  @YD00175*/ 03765000
*   /*                                                               */ 03766000
*   /*****************************************************************/ 03767000
*                                                                  1064 03768000
*   IF DSABPTR^=NULLPTR THEN                                       1064 03769000
         LTR   DSABPTR,DSABPTR                                     1064 03770000
         BZ    @RF01064                                            1064 03771000
*     CALL SCANTIOT(EXAGLPTR);      /*                       @YD00175*/ 03772000
         L     @08,@PC00012                                        1065 03773000
         ST    @08,@AL00001                                        1065 03774000
         LA    @01,@AL00001                                        1065 03775000
         BAL   @14,SCANTIOT                                        1065 03776000
*   ELSE                                                           1066 03777000
*     DO;                           /*                       @YD00175*/ 03778000
         B     @RC01064                                            1066 03779000
@RF01064 DS    0H                                                  1067 03780000
*       FOUNDVOL=ON;                /*                       @YD00175*/ 03781000
         OI    FOUNDVOL,B'10000000'                                1067 03782000
*       EXDDNAME=''B;               /*                       @YD00175*/ 03783000
         L     @08,@PC00012                                        1068 03784000
         L     @08,EXAGLPTR(,@08)                                  1068 03785000
         L     @05,EXCLDDP(,@08)                                   1068 03786000
         XC    EXDDNAME(8,@05),EXDDNAME(@05)                       1068 03787000
*       EXUCBADR=''B;               /*                       @YD00175*/ 03788000
         L     @08,EXCLUCBP(,@08)                                  1069 03789000
         SLR   @05,@05                                             1069 03790000
         ST    @05,EXUCBADR(,@08)                                  1069 03791000
*     END;                          /*                       @YD00175*/ 03792000
*                                                                  1071 03793000
*   /*****************************************************************/ 03794000
*   /*                                                               */ 03795000
*   /* ISSUE THE TEST ENQUEUE TO THE INITIATOR'S TCB IF      @YD00175*/ 03796000
*   /* THE CALLERS VOLSER WAS NOT FOUND.                     @YD00175*/ 03797000
*   /*                                                               */ 03798000
*   /*****************************************************************/ 03799000
*                                                                  1071 03800000
*   IF FOUNDVOL=OFF THEN                                           1071 03801000
@RC01064 TM    FOUNDVOL,B'10000000'                                1071 03802000
         BNZ   @RF01071                                            1071 03803000
*     DO;                           /*                       @YD00175*/ 03804000
*       VOLSER3=EXCLVOL;            /*                       @YD00175*/ 03805000
         L     @08,@PC00012                                        1073 03806000
         L     @08,EXAGLPTR(,@08)                                  1073 03807000
         MVC   VOLSER3(6),EXCLVOL(@08)                             1073 03808000
*       ENQBEGN3(1:ENQLEN3)=ENQCORE3(1:ENQLEN3);/*           @YD00175*/ 03809000
         L     @08,ENQLEN3                                         1074 03810000
         BCTR  @08,0                                               1074 03811000
         EX    @08,@SM03061                                        1074 03812000
*LENQ3:                                                            1075 03813000
*       GENERATE REFS(MAJNAME3,VOLSER3,ENQLIST3,TCBP);             1075 03814000
LENQ3    DS    0H                                                  1075 03815000
*                                                         /*@YD00175*/  03816000
         ENQ   (MAJNAME3,VOLSER3,E,6,SYSTEM),RET=TEST,                **03817000
               MF=(E,ENQLIST3),TCB=TCBP  TEST ENQUEUE         @YD00175  03818000
*       RESPECIFY                                                  1076 03819000
*         RTNREG RSTD;                                             1076 03820000
*       TESTRC=RTNREG;                                             1077 03821000
         LR    TESTRC,RTNREG                                       1077 03822000
*       RESPECIFY                                                  1078 03823000
*         RTNREG UNRSTD;            /*                       @YD00175*/ 03824000
*                                                                  1078 03825000
*       /*************************************************************/ 03826000
*       /*                                                           */ 03827000
*       /* IF RETURN CODE IS 8, OUR TASK HAS CONTROL OF THE  @YD00175*/ 03828000
*       /* RESOURCE. THEREFORE, HAVE WE FOUND A NON-SHAR-    @YD00175*/ 03829000
*       /* ABLE AND NON-CATALOG DD THAT WE CAN USE. IF       @YD00175*/ 03830000
*       /* NOT ISSUE ERROR MESSAGE IDC3392I.                 @YD00175*/ 03831000
*       /* NOTE THAT REG 15 CONTAINS THE ADDRESS OF THE      @ZA11676*/ 03832000
*       /* REASON CODE RETURNED - NOT THE CODE ITSELF.       @ZA11676*/ 03833000
*       /*                                                           */ 03834000
*       /*************************************************************/ 03835000
*                                                                  1079 03836000
*       IF TESTRC^=0 THEN           /*                       @ZA11676*/ 03837000
         LTR   TESTRC,TESTRC                                       1079 03838000
         BZ    @RF01079                                            1079 03839000
*         IF TESTCODE=ENQRC08 THEN  /*                       @ZA13046*/ 03840000
         CLI   TESTCODE(TESTRC),8                                  1080 03841000
         BNE   @RF01080                                            1080 03842000
*           DO;                     /*                       @YD00175*/ 03843000
*             IF FOUNDADD=OFF THEN                                 1082 03844000
         TM    FOUNDADD,B'01000000'                                1082 03845000
         BNZ   @RF01082                                            1082 03846000
*               DO;                 /*                       @YD00175*/ 03847000
*                 FINDXRC=LASTCC04; /*                       @YD00175*/ 03848000
         LA    FINDXRC,4                                           1084 03849000
*                 EXDDNAME=''B;     /*                       @YD00175*/ 03850000
         L     @08,@PC00012                                        1085 03851000
         L     @08,EXAGLPTR(,@08)                                  1085 03852000
         L     @05,EXCLDDP(,@08)                                   1085 03853000
         XC    EXDDNAME(8,@05),EXDDNAME(@05)                       1085 03854000
*                 EXUCBADR=''B;     /*                       @YD00175*/ 03855000
         L     @05,EXCLUCBP(,@08)                                  1086 03856000
         SLR   @15,@15                                             1086 03857000
         ST    @15,EXUCBADR(,@05)                                  1086 03858000
*                 DARGSMOD=MSGMODID;/*                       @YD00175*/ 03859000
         L     @05,DDSTRU                                          1087 03860000
         MVC   DARGSMOD(3,@05),@CC02595                            1087 03861000
*                 DARGSENT=MSG3392I;/*                       @YD00175*/ 03862000
         MVI   DARGSENT(@05),X'0C'                                 1088 03863000
*                 DARGDBP=ADDR(EXCLVOL);/*                   @YD00175*/ 03864000
         LA    @08,EXCLVOL(,@08)                                   1089 03865000
         ST    @08,DARGDBP(,@05)                                   1089 03866000
*                 DARGILP=VOLSERLN; /*                       @YD00175*/ 03867000
         MVC   DARGILP(2,@05),@CH00156                             1090 03868000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @YD00175*/ 03869000
         L     @08,@PC00001                                        1091 03870000
         ST    @08,@AL00001                                        1091 03871000
         LA    @05,@CF00115                                        1091 03872000
         ST    @05,@AL00001+4                                      1091 03873000
         LA    @05,DDSTRU                                          1091 03874000
         ST    @05,@AL00001+8                                      1091 03875000
         MVI   @AL00001+8,X'80'                                    1091 03876000
         L     @15,GDTPRT(,@08)                                    1091 03877000
         LA    @01,@AL00001                                        1091 03878000
         BALR  @14,@15                                             1091 03879000
*               END;                /*                       @YD00175*/ 03880000
*           END;                    /*                       @YD00175*/ 03881000
*                                                                  1094 03882000
*       /*************************************************************/ 03883000
*       /*                                                           */ 03884000
*       /* IF RETURN CODE IS OTHER THAN 8 THEN RETURN A      @YD00175*/ 03885000
*       /* CLEARED ARGLIST TO THE CALLER.                    @YD00175*/ 03886000
*       /*                                                           */ 03887000
*       /*************************************************************/ 03888000
*                                                                  1094 03889000
*         ELSE                                                     1094 03890000
*           DO;                     /*                       @YD00175*/ 03891000
         B     @RC01080                                            1094 03892000
@RF01080 DS    0H                                                  1095 03893000
*             EXDDNAME=''B;         /*                       @YD00175*/ 03894000
         L     @08,@PC00012                                        1095 03895000
         L     @08,EXAGLPTR(,@08)                                  1095 03896000
         L     @05,EXCLDDP(,@08)                                   1095 03897000
         XC    EXDDNAME(8,@05),EXDDNAME(@05)                       1095 03898000
*             EXUCBADR=''B;         /*                       @YD00175*/ 03899000
         L     @08,EXCLUCBP(,@08)                                  1096 03900000
         SLR   @05,@05                                             1096 03901000
         ST    @05,EXUCBADR(,@08)                                  1096 03902000
*           END;                    /*                       @YD00175*/ 03903000
*       ELSE                                                       1098 03904000
*         DO;                       /*                       @ZA13046*/ 03905000
         B     @RC01079                                            1098 03906000
@RF01079 DS    0H                                                  1099 03907000
*           EXDDNAME=''B;           /*                       @ZA13046*/ 03908000
         L     @08,@PC00012                                        1099 03909000
         L     @08,EXAGLPTR(,@08)                                  1099 03910000
         L     @05,EXCLDDP(,@08)                                   1099 03911000
         XC    EXDDNAME(8,@05),EXDDNAME(@05)                       1099 03912000
*           EXUCBADR=''B;           /*                       @ZA13046*/ 03913000
         L     @08,EXCLUCBP(,@08)                                  1100 03914000
         SLR   @05,@05                                             1100 03915000
         ST    @05,EXUCBADR(,@08)                                  1100 03916000
*         END;                      /*                       @ZA13046*/ 03917000
*     END;                          /*                       @YD00175*/ 03918000
*                                                                  1102 03919000
@RC01079 DS    0H                                                  1103 03920000
*   /*****************************************************************/ 03921000
*   /*                                                               */ 03922000
*   /* ISSUE UDEQ MACRO TO DEQUEUE ON THE TIOT AND RETURN.   @YD00175*/ 03923000
*   /*                                                               */ 03924000
*   /*****************************************************************/ 03925000
*                                                                  1103 03926000
*   CALL IDCSADQ0(GDTTBL,MAJRNAM,MINRNAME);/*                @YD00175*/ 03927000
@RF01071 L     @08,@PC00001                                        1103 03928000
         ST    @08,@AL00001                                        1103 03929000
         LA    @05,MAJRNAM                                         1103 03930000
         ST    @05,@AL00001+4                                      1103 03931000
         LA    @05,MINRNAME                                        1103 03932000
         ST    @05,@AL00001+8                                      1103 03933000
         MVI   @AL00001+8,X'80'                                    1103 03934000
         L     @15,GDTDEQ(,@08)                                    1103 03935000
         LA    @01,@AL00001                                        1103 03936000
         BALR  @14,@15                                             1103 03937000
*   RETURN CODE(FINDXRC);           /* RETURN TO MAIN ROUTINE      1104 03938000
*                                                            @YD00175*/ 03939000
         LR    @15,FINDXRC                                         1104 03940000
         L     @14,@SA00012                                        1104 03941000
         LM    @00,@12,@SA00012+8                                  1104 03942000
         BR    @14                                                 1104 03943000
*   END FINDEXCL;                   /* END OF FINDEXCL TO LOCATE AN     03944000
*                                      EXCLUSIVE VOLUME      @YD00175*/ 03945000
*                                                                  1106 03946000
*/********************************************************************/ 03947000
*/*                                                                  */ 03948000
*/*  PROCEDURE NAME - SCANTIOT                               @YD00175*/ 03949000
*/*                                                          @YD00175*/ 03950000
*/*  FUNCTION - THIS ROUTINE SCANS THE TIOT TO (1) FIND IF   @YD00175*/ 03951000
*/*             THE VOLUME IS MOUNTED OR IN THE JFCB, OR TO  @YD00175*/ 03952000
*/*             (2) FIND A NON-SHARABLE UCB AND DD THAT      @YD00175*/ 03953000
*/*             CAN BE USED FOR THE VOLUME TO BE MOUNTED IF  @YD00175*/ 03954000
*/*             THE VOLUME IS NOT MOUNTED OR IN THE JFCB,    @YD00175*/ 03955000
*/*             BUT IS ALLOCATED EXCLUSIVELY TO THIS JOB     @YD00175*/ 03956000
*/*             STEP.                                        @YD00175*/ 03957000
*/*                                                          @YD00175*/ 03958000
*/*  INPUT - THE INPUT ARGUMENT LIST EXCLAGL IS USED TO      @YD00175*/ 03959000
*/*          COMPARE VOLSER TO THE UCBVOLI FIELD.  THE UCB   @YD00175*/ 03960000
*/*          ADDRESS IN THE EXCLAGL IS USED TO FIND THE UCB. @YD00175*/ 03961000
*/*                                                          @YD00175*/ 03962000
*/*  OUTPUT- INFORMATION RETURNED IN THE EXCLAGL AND BIT     @YD00175*/ 03963000
*/*          SWITCHES AS FOLLOWS:                            @YD00175*/ 03964000
*/*          FOUNDVOL = ON -                                 @YD00175*/ 03965000
*/*            FOUNDVOL BIT ON IF THE CALLER'S VOLSER WAS    @YD00175*/ 03966000
*/*            FOUND IN THE UCB OR JFCB.  THE CALLER'S AREAS @YD00175*/ 03967000
*/*            WILL BE SET WITH (1) DDNAME AND UCB ADDRESS   @YD00175*/ 03968000
*/*            IF THE UCB IS EXCLUSIVE AND VIRTUAL OR (2)    @YD00175*/ 03969000
*/*            ZERO IF UCB IS NOT EXCLUSIVE OR NOT VIRTUAL.  @YD00175*/ 03970000
*/*          FOUNDVOL = OFF & FOUNDADD = ON -                @YD00175*/ 03971000
*/*            FOUNDVOL IS OFF AND FOUNDADD IS ON IF THE     @YD00175*/ 03972000
*/*            CALLER'S VOLSER WAS NOT FOUND BUT A VIRTUAL,  @YD00175*/ 03973000
*/*            NON-SHARABLE, NON-CATALOG DD HAS BEEN FOUND.  @YD00175*/ 03974000
*/*            CALLER'S AREAS CONTAIN DDNAME AND UCB         @YD00175*/ 03975000
*/*            ADDRESS.                                      @YD00175*/ 03976000
*/*                                                                  */ 03977000
*/********************************************************************/ 03978000
*                                                                  1106 03979000
*SCANTIOT:                                                         1106 03980000
*   PROCEDURE(SCAGLPTR);            /*                       @YD00175*/ 03981000
SCANTIOT STM   @14,@12,@SA00013                                    1106 03982000
         MVC   @PC00013(4),0(@01)                                  1106 03983000
*                                                                  1107 03984000
*   /*****************************************************************/ 03985000
*   /*                                                               */ 03986000
*   /* LOCAL DECLARATIONS FOR SCANTIOT                       @YD00175*/ 03987000
*   /*                                                               */ 03988000
*   /*****************************************************************/ 03989000
*                                                                  1107 03990000
*   DCL                                                            1107 03991000
*     SCAGLPTR PTR(31);             /* SCANTIOT EXCLAGL PTR  @YD00175*/ 03992000
*   DCL                                                            1108 03993000
*     OPTINFO CHAR(LENGTH(IOINFOPT));/* UIOINFO OPTION FLAGS @YD00175*/ 03994000
*   DCL                                                            1109 03995000
*     VOLSPTR PTR(31);              /* PTR TO UIOINFO AREA   @YD00175*/ 03996000
*   DCL                                                            1110 03997000
*     1 INFOAREA BDY(WORD),         /* IOINFO RETURN AREA    @YD00175*/ 03998000
*      2 INFOHEAD,                  /* HEADER INFORMATION    @YD00175*/ 03999000
*       3 INWKLEN FIXED(15),        /* AREA LENGTH           @YD00175*/ 04000000
*       3 RETNLEN FIXED(15),        /* RETURN AREA LENGTH    @YD00175*/ 04001000
*      2 INFOTYPE FIXED(15),        /* DATA TYPE             @YD00175*/ 04002000
*      2 DATALEN FIXED(15),         /* DATA LENGTH           @YD00175*/ 04003000
*      2 VOLAREA(5) CHAR(6);        /* RETURNED VOLSERS      @YD00175*/ 04004000
*                                                                  1110 04005000
*   /*****************************************************************/ 04006000
*   /*                                                               */ 04007000
*   /* RESPECIFY EXCLAGL ON INPUT PARAMETER AND ISSUE        @YD00175*/ 04008000
*   /* UTRACE MACRO.                                         @YD00175*/ 04009000
*   /*                                                               */ 04010000
*   /*****************************************************************/ 04011000
*                                                                  1111 04012000
*   RFY                                                            1111 04013000
*     EXCLAGL BASED(SCAGLPTR);      /*                       @YD00175*/ 04014000
*   RFY                                                            1112 04015000
*     IOINFOPT BASED(ADDR(OPTINFO));/*                       @YD00175*/ 04016000
*   OLDERID2=NEWERID2;                                             1113 04017000
         L     @08,@PC00001                                        1113 04018000
         L     @08,GDTTR2(,@08)                                    1113 04019000
         MVC   @TS00001(95),NEWERID2(@08)                          1113 04020000
         MVC   OLDERID2(95,@08),@TS00001                           1113 04021000
*   NEWID2='SAST';                  /*                       @YD00175*/ 04022000
         MVC   NEWID2(4,@08),@CC02942                              1114 04023000
*                                                                  1115 04024000
*   /*****************************************************************/ 04025000
*   /*                                                               */ 04026000
*   /* SCAN THE TIOT DSAB CHAIN FOR (1) A VOLSER IN THE UCB  @YD00175*/ 04027000
*   /* OR IN THE JFCB THAT MATCHES THE CALLERS VOLSER OR     @YD00175*/ 04028000
*   /* (2) A ZERO VOLSER THAT CAN BE USED FOR THE MOUNTING   @YD00175*/ 04029000
*   /* OF A VOLUME.                                          @YD00175*/ 04030000
*   /*                                                               */ 04031000
*   /*****************************************************************/ 04032000
*                                                                  1115 04033000
*SCANVOL:                                                          1115 04034000
*   DO WHILE FOUNDVOL=OFF&DSABPTR^=NULLPTR;/*                @YD00175*/ 04035000
SCANVOL  B     @DE01115                                            1115 04036000
@DL01115 DS    0H                                                  1116 04037000
*     UCBPTR=TIOEFSRT;              /*                       @YD00175*/ 04038000
         L     @08,DSABTIOT(,DSABPTR)                              1116 04039000
         L     UCBPTR,TIOEFSRT-1(,@08)                             1116 04040000
         LA    UCBPTR,0(,UCBPTR)                                   1116 04041000
*     IF UCBVOLI=EXCLVOL THEN                                      1117 04042000
         L     @08,@PC00013                                        1117 04043000
         L     @08,SCAGLPTR(,@08)                                  1117 04044000
         CLC   UCBVOLI(6,UCBPTR),EXCLVOL(@08)                      1117 04045000
         BNE   @RF01117                                            1117 04046000
*       FOUNDVOL=ON;                /*                       @YD00175*/ 04047000
*                                                                  1118 04048000
         OI    FOUNDVOL,B'10000000'                                1118 04049000
*     /***************************************************************/ 04050000
*     /*                                                             */ 04051000
*     /* ISSUE UIOINFO MACRO FOR ZERO VOLSER VIRTUAL UCB     @YD00175*/ 04052000
*     /* TO SEE IF IT IS THE CALLER'S VOLSER IN THE JFCB.    @YD00175*/ 04053000
*     /* IGNORE DDNAMES THAT ARE BLANK.                      @ZM00733*/ 04054000
*     /*                                                             */ 04055000
*     /***************************************************************/ 04056000
*                                                                  1119 04057000
*     IF UCBVOLI=ZEROVOL&UCBRVDEV=ON&TIOEDDNM^=BLANKDDN THEN       1119 04058000
@RF01117 CLC   UCBVOLI(6,UCBPTR),ZEROVOL                           1119 04059000
         BNE   @RF01119                                            1119 04060000
         TM    UCBRVDEV(UCBPTR),B'00001000'                        1119 04061000
         BNO   @RF01119                                            1119 04062000
         L     @08,DSABTIOT(,DSABPTR)                              1119 04063000
         CLC   TIOEDDNM(8,@08),BLANKDDN                            1119 04064000
         BE    @RF01119                                            1119 04065000
*       DO;                         /*                       @ZM00733*/ 04066000
*         INFOAREA=''B;             /*                       @YD00175*/ 04067000
         XC    INFOAREA(38),INFOAREA                               1121 04068000
*         IOINFOPT=''B;             /*                       @YD00175*/ 04069000
         LA    @04,OPTINFO                                         1122 04070000
         MVI   IOINFOPT(@04),X'00'                                 1122 04071000
*         VOLSPTR=ADDR(INFOAREA);   /*                       @YD00175*/ 04072000
         LA    @15,INFOAREA                                        1123 04073000
         ST    @15,VOLSPTR                                         1123 04074000
*         INWKLEN=LENGTH(INFOAREA); /*                       @YD00175*/ 04075000
         MVC   INWKLEN(2),@CH03034                                 1124 04076000
*         IOINFVOL=ON;              /*                       @YD00175*/ 04077000
         OI    IOINFVOL(@04),B'01000000'                           1125 04078000
*         CALL IDCIOSI0(GDTTBL,IOINFOPT,VOLSPTR,TIOEDDNM);/* @YD00175*/ 04079000
         L     @15,@PC00001                                        1126 04080000
         ST    @15,@AL00001                                        1126 04081000
         ST    @04,@AL00001+4                                      1126 04082000
         LA    @04,VOLSPTR                                         1126 04083000
         ST    @04,@AL00001+8                                      1126 04084000
         LA    @08,TIOEDDNM(,@08)                                  1126 04085000
         ST    @08,@AL00001+12                                     1126 04086000
         MVI   @AL00001+12,X'80'                                   1126 04087000
         L     @15,GDTIFO(,@15)                                    1126 04088000
         LA    @01,@AL00001                                        1126 04089000
         BALR  @14,@15                                             1126 04090000
*                                                                  1127 04091000
*         /***********************************************************/ 04092000
*         /*                                                         */ 04093000
*         /* IF THE CALLER'S VOLSER IS IN THE JFCB, SET      @YD00175*/ 04094000
*         /* SWITCH TO INDICATE VOLUME FOUND. IF             @YD00175*/ 04095000
*         /* CALLER'S VOLSER IS NOT IN JFCB, SET SWITCH      @YD00175*/ 04096000
*         /* TO INDICATE A UCB WITH ZEROS IN THE VOLSER      @YD00175*/ 04097000
*         /* HAS BEEN FOUND AND RETURN UCB ADDRESS AND       @YD00175*/ 04098000
*         /* DDNAME TO CALLER IN THE EXCLAGL.                @YD00175*/ 04099000
*         /*                                                         */ 04100000
*         /***********************************************************/ 04101000
*                                                                  1127 04102000
*         IF VOLAREA(1)=EXCLVOL THEN                               1127 04103000
         L     @08,@PC00013                                        1127 04104000
         L     @08,SCAGLPTR(,@08)                                  1127 04105000
         CLC   VOLAREA(6),EXCLVOL(@08)                             1127 04106000
         BNE   @RF01127                                            1127 04107000
*           FOUNDVOL=ON;            /*                       @YD00175*/ 04108000
         OI    FOUNDVOL,B'10000000'                                1128 04109000
*         ELSE                                                     1129 04110000
*           IF FOUNDADD=OFF THEN                                   1129 04111000
         B     @RC01127                                            1129 04112000
@RF01127 TM    FOUNDADD,B'01000000'                                1129 04113000
         BNZ   @RF01129                                            1129 04114000
*             DO;                   /*                       @YD00175*/ 04115000
*               FOUNDADD=ON;        /*                       @YD00175*/ 04116000
         OI    FOUNDADD,B'01000000'                                1131 04117000
*               EXDDNAME=TIOEDDNM;  /*                       @YD00175*/ 04118000
         L     @08,@PC00013                                        1132 04119000
         L     @08,SCAGLPTR(,@08)                                  1132 04120000
         L     @04,EXCLDDP(,@08)                                   1132 04121000
         L     @15,DSABTIOT(,DSABPTR)                              1132 04122000
         MVC   EXDDNAME(8,@04),TIOEDDNM(@15)                       1132 04123000
*               EXUCBADR=TIOEFSRT;  /*                       @YD00175*/ 04124000
         L     @08,EXCLUCBP(,@08)                                  1133 04125000
         L     @04,TIOEFSRT-1(,@15)                                1133 04126000
         LA    @04,0(,@04)                                         1133 04127000
         ST    @04,EXUCBADR(,@08)                                  1133 04128000
*             END;                  /*                       @YD00175*/ 04129000
*       END;                        /*                       @YD00175*/ 04130000
@RF01129 DS    0H                                                  1135 04131000
@RC01127 DS    0H                                                  1136 04132000
*     IF FOUNDVOL^=ON THEN                                         1136 04133000
@RF01119 TM    FOUNDVOL,B'10000000'                                1136 04134000
         BO    @RF01136                                            1136 04135000
*       DSABPTR=DSABFCHN;           /*                       @YD00175*/ 04136000
         L     DSABPTR,DSABFCHN(,DSABPTR)                          1137 04137000
*   END SCANVOL;                    /*                       @YD00175*/ 04138000
*                                                                  1138 04139000
@RF01136 DS    0H                                                  1138 04140000
@DE01115 TM    FOUNDVOL,B'10000000'                                1138 04141000
         BNZ   @DC01115                                            1138 04142000
         LTR   DSABPTR,DSABPTR                                     1138 04143000
         BNZ   @DL01115                                            1138 04144000
@DC01115 DS    0H                                                  1139 04145000
*   /*****************************************************************/ 04146000
*   /*                                                               */ 04147000
*   /* IF A DD HAS BEEN FOUND WITH THE CALLER'S VOLSER       @YD00175*/ 04148000
*   /* THEN CHECK THE UCBBSVL BIT TO BE SURE THAT IT IS      @YD00175*/ 04149000
*   /* EXCLUSIVE AND CHECK THE UCBRVDEV BIT TO SEE IF IT     @YD00175*/ 04150000
*   /* IS VIRTUAL. IF IT IS, RETURN IT TO THE CALLER.        @YD00175*/ 04151000
*   /* IF NOT, ZERO OUT THE CALLER'S EXCLAGL.                @YD00175*/ 04152000
*   /*                                                               */ 04153000
*   /*****************************************************************/ 04154000
*                                                                  1139 04155000
*   IF FOUNDVOL=ON THEN                                            1139 04156000
         TM    FOUNDVOL,B'10000000'                                1139 04157000
         BNO   @RF01139                                            1139 04158000
*     IF UCBBSVL=ON&UCBRVDEV=ON THEN                               1140 04159000
         TM    UCBBSVL(UCBPTR),B'10000000'                         1140 04160000
         BNO   @RF01140                                            1140 04161000
         TM    UCBRVDEV(UCBPTR),B'00001000'                        1140 04162000
         BNO   @RF01140                                            1140 04163000
*       DO;                         /*                       @YD00175*/ 04164000
*         EXDDNAME=TIOEDDNM;        /*                       @YD00175*/ 04165000
         L     @08,@PC00013                                        1142 04166000
         L     @08,SCAGLPTR(,@08)                                  1142 04167000
         L     @01,EXCLDDP(,@08)                                   1142 04168000
         L     @15,DSABTIOT(,DSABPTR)                              1142 04169000
         MVC   EXDDNAME(8,@01),TIOEDDNM(@15)                       1142 04170000
*         EXUCBADR=TIOEFSRT;        /*                       @YD00175*/ 04171000
         L     @08,EXCLUCBP(,@08)                                  1143 04172000
         L     @15,TIOEFSRT-1(,@15)                                1143 04173000
         LA    @15,0(,@15)                                         1143 04174000
         ST    @15,EXUCBADR(,@08)                                  1143 04175000
*       END;                        /*                       @YD00175*/ 04176000
*     ELSE                                                         1145 04177000
*       DO;                         /*                       @YD00175*/ 04178000
         B     @RC01140                                            1145 04179000
@RF01140 DS    0H                                                  1146 04180000
*         EXDDNAME=''B;             /*                       @YD00175*/ 04181000
         L     @08,@PC00013                                        1146 04182000
         L     @08,SCAGLPTR(,@08)                                  1146 04183000
         L     @02,EXCLDDP(,@08)                                   1146 04184000
         XC    EXDDNAME(8,@02),EXDDNAME(@02)                       1146 04185000
*         EXUCBADR=''B;             /*                       @YD00175*/ 04186000
         L     @08,EXCLUCBP(,@08)                                  1147 04187000
         SLR   @02,@02                                             1147 04188000
         ST    @02,EXUCBADR(,@08)                                  1147 04189000
*       END;                        /*                       @YD00175*/ 04190000
*                                                                  1149 04191000
*   /*****************************************************************/ 04192000
*   /*                                                               */ 04193000
*   /* IF A DD HASN'T BEEN FOUND THAT CAN BE USED THEN       @YD00175*/ 04194000
*   /* SEARCH THE DSAB ENTRIES FOR A USABLE UCB FOR          @YD00175*/ 04195000
*   /* MOUNTING THE VOLUME AND INDICATE ACCORDINGLY.         @YD00175*/ 04196000
*   /*                                                               */ 04197000
*   /*****************************************************************/ 04198000
*                                                                  1149 04199000
*   IF FOUNDVOL=OFF&FOUNDADD=OFF THEN                              1149 04200000
@RC01140 DS    0H                                                  1149 04201000
@RF01139 TM    FOUNDVOL,B'11000000'                                1149 04202000
         BNZ   @RF01149                                            1149 04203000
*     DO;                           /*                       @YD00175*/ 04204000
*       DSABPTR=QDBFELMP;           /*                       @YD00175*/ 04205000
         L     DSABPTR,QDBFELMP(,QDBPTR)                           1151 04206000
*       VOLWORK=''B;                /*                       @YD00175*/ 04207000
         XC    VOLWORK(6),VOLWORK                                  1152 04208000
*       SAVEDSAB=''B;               /*                       @YD00175*/ 04209000
*                                                                  1153 04210000
         SLR   SAVEDSAB,SAVEDSAB                                   1153 04211000
*       /*************************************************************/ 04212000
*       /*                                                           */ 04213000
*       /* SEARCH THE DSAB ENTRIES FOR AN EXCLUSIVE, VIRT-   @YD00175*/ 04214000
*       /* UAL UCB THAT DOES NOT HAVE THE DSABCATL FLAG      @YD00175*/ 04215000
*       /* ON IN THE DSAB. IGNORE DDNAMES THAT ARE BLANK.    @ZM00733*/ 04216000
*       /*                                                           */ 04217000
*       /*************************************************************/ 04218000
*                                                                  1154 04219000
*SCANDD:                                                           1154 04220000
*       DO WHILE DSABPTR^=NULLPTR&FOUNDADD=OFF;/*            @YD00175*/ 04221000
SCANDD   B     @DE01154                                            1154 04222000
@DL01154 DS    0H                                                  1155 04223000
*         UCBPTR=TIOEFSRT;          /*                       @YD00175*/ 04224000
         L     @08,DSABTIOT(,DSABPTR)                              1155 04225000
         L     UCBPTR,TIOEFSRT-1(,@08)                             1155 04226000
         LA    UCBPTR,0(,UCBPTR)                                   1155 04227000
*         IF DSABCATL=OFF&UCBBSVL=ON&UCBRVDEV=ON&TIOEDDNM^=BLANKDDN     04228000
*           THEN                                                   1156 04229000
         TM    DSABCATL(DSABPTR),B'00001000'                       1156 04230000
         BNZ   @RF01156                                            1156 04231000
         TM    UCBBSVL(UCBPTR),B'10000000'                         1156 04232000
         BNO   @RF01156                                            1156 04233000
         TM    UCBRVDEV(UCBPTR),B'00001000'                        1156 04234000
         BNO   @RF01156                                            1156 04235000
         CLC   TIOEDDNM(8,@08),BLANKDDN                            1156 04236000
         BE    @RF01156                                            1156 04237000
*           DO;                     /*                       @ZM00733*/ 04238000
*                                                                  1157 04239000
*             /*******************************************************/ 04240000
*             /*                                                     */ 04241000
*             /* IF A DD HAS BEEN FOUND THAT CAN BE USED     @YD00175*/ 04242000
*             /* THEN SEARCH THE ENTIRE DSAB CHAIN TO        @YD00175*/ 04243000
*             /* BESURE THERE IS NO CATALOG DATA SET DDNAME  @YD00175*/ 04244000
*             /* WITH THE SAME VOLSER IN THE UCB VOLSER      @YD00175*/ 04245000
*             /* FIELD. INDICATE ACCORDINGLY.                @YD00175*/ 04246000
*             /*                                                     */ 04247000
*             /*******************************************************/ 04248000
*                                                                  1158 04249000
*             VOLWORK=UCBVOLI;      /*                       @YD00175*/ 04250000
         MVC   VOLWORK(6),UCBVOLI(UCBPTR)                          1158 04251000
*             SAVEDSAB=DSABPTR;     /*                       @YD00175*/ 04252000
         LR    SAVEDSAB,DSABPTR                                    1159 04253000
*             DSABPTR=QDBFELMP;     /*                       @YD00175*/ 04254000
         L     DSABPTR,QDBFELMP(,QDBPTR)                           1160 04255000
*             FOUNDCAT=OFF;         /*                       @YD00175*/ 04256000
         NI    FOUNDCAT,B'11011111'                                1161 04257000
*SCANCAT:                                                          1162 04258000
*             DO WHILE DSABPTR^=NULLPTR&FOUNDCAT=OFF;/*      @YD00175*/ 04259000
SCANCAT  B     @DE01162                                            1162 04260000
@DL01162 DS    0H                                                  1163 04261000
*               UCBPTR=TIOEFSRT;    /*                       @YD00175*/ 04262000
         L     @08,DSABTIOT(,DSABPTR)                              1163 04263000
         L     UCBPTR,TIOEFSRT-1(,@08)                             1163 04264000
         LA    UCBPTR,0(,UCBPTR)                                   1163 04265000
*                                                                  1164 04266000
*               /*****************************************************/ 04267000
*               /*                                                   */ 04268000
*               /* IF A CATALOG DDNAME, THEN IF VOLSERS      @YD00175*/ 04269000
*               /* MATCH THEN INDICATE VOLSER IS FOR A       @YD00175*/ 04270000
*               /* CATALOG VOLUME, IT CANNOT BE USED.        @YD00175*/ 04271000
*               /*                                                   */ 04272000
*               /*****************************************************/ 04273000
*                                                                  1164 04274000
*               IF DSABCATL=ON THEN                                1164 04275000
         TM    DSABCATL(DSABPTR),B'00001000'                       1164 04276000
         BNO   @RF01164                                            1164 04277000
*                 IF VOLWORK=UCBVOLI THEN                          1165 04278000
         CLC   VOLWORK(6),UCBVOLI(UCBPTR)                          1165 04279000
         BNE   @RF01165                                            1165 04280000
*                   FOUNDCAT=ON;    /*                       @YD00175*/ 04281000
         OI    FOUNDCAT,B'00100000'                                1166 04282000
*               DSABPTR=DSABFCHN;   /*                       @YD00175*/ 04283000
@RF01165 DS    0H                                                  1167 04284000
@RF01164 L     DSABPTR,DSABFCHN(,DSABPTR)                          1167 04285000
*             END SCANCAT;          /*                       @YD00175*/ 04286000
*                                                                  1168 04287000
@DE01162 LTR   DSABPTR,DSABPTR                                     1168 04288000
         BZ    @DC01162                                            1168 04289000
         TM    FOUNDCAT,B'00100000'                                1168 04290000
         BZ    @DL01162                                            1168 04291000
@DC01162 DS    0H                                                  1169 04292000
*             /*******************************************************/ 04293000
*             /*                                                     */ 04294000
*             /* RESTORE SAVED DSAB POINTER & RESET UCBPTR.  @YD00175*/ 04295000
*             /*                                                     */ 04296000
*             /*******************************************************/ 04297000
*                                                                  1169 04298000
*             DSABPTR=SAVEDSAB;     /*                       @YD00175*/ 04299000
         LR    DSABPTR,SAVEDSAB                                    1169 04300000
*             UCBPTR=TIOEFSRT;      /*                       @YD00175*/ 04301000
*                                                                  1170 04302000
         L     @08,DSABTIOT(,DSABPTR)                              1170 04303000
         L     @15,TIOEFSRT-1(,@08)                                1170 04304000
         LA    @15,0(,@15)                                         1170 04305000
         LR    UCBPTR,@15                                          1170 04306000
*             /*******************************************************/ 04307000
*             /*                                                     */ 04308000
*             /* IF NO CATALOG DD'S HAVE BEEN FOUND, THEN    @YD00175*/ 04309000
*             /* RETURN THE DDNAME AND UCB ADDRESS TO THE    @YD00175*/ 04310000
*             /* CALLER. SET THE SWITCH TO INDICATE A NON-   @YD00175*/ 04311000
*             /* CATALOG DD HAS BEEN FOUND.                  @YD00175*/ 04312000
*             /*                                                     */ 04313000
*             /*******************************************************/ 04314000
*                                                                  1171 04315000
*             IF FOUNDCAT=OFF THEN                                 1171 04316000
         TM    FOUNDCAT,B'00100000'                                1171 04317000
         BNZ   @RF01171                                            1171 04318000
*               DO;                 /*                       @YD00175*/ 04319000
*                 FOUNDADD=ON;      /*                       @YD00175*/ 04320000
         OI    FOUNDADD,B'01000000'                                1173 04321000
*                 EXDDNAME=TIOEDDNM;/*                       @YD00175*/ 04322000
         L     @14,@PC00013                                        1174 04323000
         L     @14,SCAGLPTR(,@14)                                  1174 04324000
         L     @01,EXCLDDP(,@14)                                   1174 04325000
         MVC   EXDDNAME(8,@01),TIOEDDNM(@08)                       1174 04326000
*                 EXUCBADR=TIOEFSRT;/*                       @YD00175*/ 04327000
         L     @08,EXCLUCBP(,@14)                                  1175 04328000
         ST    @15,EXUCBADR(,@08)                                  1175 04329000
*               END;                /*                       @YD00175*/ 04330000
*           END;                    /*                       @YD00175*/ 04331000
*                                                                  1177 04332000
@RF01171 DS    0H                                                  1178 04333000
*         /***********************************************************/ 04334000
*         /*                                                         */ 04335000
*         /* INCREMENT TO NEXT DSAB VIA FORWARD CHAIN PTR.   @YD00175*/ 04336000
*         /*                                                         */ 04337000
*         /***********************************************************/ 04338000
*                                                                  1178 04339000
*         DSABPTR=DSABFCHN;         /*                       @YD00175*/ 04340000
@RF01156 L     DSABPTR,DSABFCHN(,DSABPTR)                          1178 04341000
*       END SCANDD;                 /*                       @YD00175*/ 04342000
@DE01154 LTR   DSABPTR,DSABPTR                                     1179 04343000
         BZ    @DC01154                                            1179 04344000
         TM    FOUNDADD,B'01000000'                                1179 04345000
         BZ    @DL01154                                            1179 04346000
@DC01154 DS    0H                                                  1180 04347000
*     END;                          /*                       @YD00175*/ 04348000
*                                                                  1181 04349000
*   /*****************************************************************/ 04350000
*   /*                                                               */ 04351000
*   /* RETURN TO CALLER.                                     @YD00175*/ 04352000
*   /*                                                               */ 04353000
*   /*****************************************************************/ 04354000
*                                                                  1181 04355000
*   RETURN;                         /* RETURN TO MAIN ROUTINE      1181 04356000
*                                                            @YD00175*/ 04357000
@EL00013 DS    0H                                                  1181 04358000
@EF00013 DS    0H                                                  1181 04359000
@ER00013 LM    @14,@12,@SA00013                                    1181 04360000
         BR    @14                                                 1181 04361000
*   END SCANTIOT;                   /* END OF SCANTIOT TO LOCATE AN     04362000
*                                      EXCLUSIVE VOLUME      @YD00175*/ 04363000
         B     @EL00013                                            1182 04364000
*                                                                  1183 04365000
*/********************************************************************/ 04366000
*/*                                                                  */ 04367000
*/*  PROCEDURE NAME - GETEXCL                                @YD00175*/ 04368000
*/*                                                          @YD00175*/ 04369000
*/*  FUNCTION - THIS ROUTINE DETERMINES IF ALLOCATION OF     @YD00175*/ 04370000
*/*             THE UNIT CAN BE CHANGED TO EXCLUSIVE.  IF    @YD00175*/ 04371000
*/*             SO, CALLS SETEXCL PROCEDURE.  IF NOT ISSUES  @YD00175*/ 04372000
*/*             ERROR MESSAGE IDC3385I.                      @YD00175*/ 04373000
*/*                                                          @YD00175*/ 04374000
*/*  INPUT - THE INPUT ARGUMENT LIST EXCLAGL IS USED TO      @YD00175*/ 04375000
*/*          COMPARE VOLSER TO THE UCBVOLI FIELD.  THE UCB   @YD00175*/ 04376000
*/*          ADDRESS IN THE EXCLAGL IS USED TO FIND THE UCB. @YD00175*/ 04377000
*/*                                                          @YD00175*/ 04378000
*/*  OUTPUT- ISSUE ERROR MESSAGES AND RETURN TO CALLER WITH  @YD00175*/ 04379000
*/*          RETURN CODE IN REGISTER 15 AS FOLLOWS:          @YD00175*/ 04380000
*/*          0 - SUCCESSFUL, UCB IS MARKED EXCLUSIVE OR      @YD00175*/ 04381000
*/*              SPECIFIED VOLUME WAS NOT MOUNTED.           @YD00175*/ 04382000
*/*          4 - VOLUME IS RESIDENT OR PERMANENTLY RESERVED, @YD00175*/ 04383000
*/*              OR UCB IS ALLOCATED TO ANOTHER JOB.         @YD00175*/ 04384000
*/*                                                                  */ 04385000
*/********************************************************************/ 04386000
*                                                                  1183 04387000
*GETEXCL:                                                          1183 04388000
*   PROCEDURE(GXAGLPTR);            /*                       @YD00175*/ 04389000
*                                                                  1183 04390000
GETEXCL  STM   @14,@12,@SA00014                                    1183 04391000
         MVC   @PC00014(4),0(@01)                                  1183 04392000
*   /*****************************************************************/ 04393000
*   /*                                                               */ 04394000
*   /* LOCAL DECLARATIONS FOR GETEXCL                        @YD00175*/ 04395000
*   /*                                                               */ 04396000
*   /*****************************************************************/ 04397000
*                                                                  1184 04398000
*   DCL                                                            1184 04399000
*     GETEXRC FIXED(15);            /* GETEXCL RETURN CODE   @YD00175*/ 04400000
*   DCL                                                            1185 04401000
*     GXAGLPTR PTR(31);             /* GETEXCL EXCLAGL PTR   @YD00175*/ 04402000
*                                                                  1186 04403000
*   /*****************************************************************/ 04404000
*   /*                                                               */ 04405000
*   /* RESPECIFY EXCLAGL ON INPUT PARAMETER AND INITIALIZE   @YD00175*/ 04406000
*   /* RETURN CODE AREA AND ISSUE UTRACE MACRO.              @YD00175*/ 04407000
*   /*                                                               */ 04408000
*   /*****************************************************************/ 04409000
*                                                                  1186 04410000
*   RFY                                                            1186 04411000
*     EXCLAGL BASED(GXAGLPTR);      /*                       @YD00175*/ 04412000
*   OLDERID2=NEWERID2;                                             1187 04413000
         L     @08,@PC00001                                        1187 04414000
         L     @15,GDTTR2(,@08)                                    1187 04415000
         MVC   @TS00001(95),NEWERID2(@15)                          1187 04416000
         MVC   OLDERID2(95,@15),@TS00001                           1187 04417000
*   NEWID2='SAGE';                  /*                       @YD00175*/ 04418000
         MVC   NEWID2(4,@15),@CC02956                              1188 04419000
*   GETEXRC=0;                      /*                       @YD00175*/ 04420000
*                                                                  1189 04421000
         SLR   GETEXRC,GETEXRC                                     1189 04422000
*   /*****************************************************************/ 04423000
*   /*                                                               */ 04424000
*   /* TEST IF UCB IS RESERVED OR RESIDENT AND THEREFORE     @YD00175*/ 04425000
*   /* CANNOT BE ALLOCATED EXCLUSIVELY. IF VOLUME IS         @YD00175*/ 04426000
*   /* RESIDENT OR RESERVED THEN ISSUE MESSAGE IDC3385I      @YD00175*/ 04427000
*   /* SET RETURN CODE TO INDICATE FAILURE.                  @YD00175*/ 04428000
*   /*                                                               */ 04429000
*   /*****************************************************************/ 04430000
*                                                                  1190 04431000
*   UCBPTR=EXUCBADR;                /*                       @YD00175*/ 04432000
         L     @15,@PC00014                                        1190 04433000
         L     @01,GXAGLPTR(,@15)                                  1190 04434000
         L     @01,EXCLUCBP(,@01)                                  1190 04435000
         L     UCBPTR,EXUCBADR(,@01)                               1190 04436000
*   IF UCBRESV=ON|UCBPRES=ON THEN                                  1191 04437000
         TM    UCBRESV(UCBPTR),B'00100100'                         1191 04438000
         BZ    @RF01191                                            1191 04439000
*     DO;                           /*                       @YD00175*/ 04440000
*       GETEXRC=LASTCC04;           /*                       @YD00175*/ 04441000
         LA    GETEXRC,4                                           1193 04442000
*       DARGSENT=MSG3385I;          /*                       @YD00175*/ 04443000
         L     @15,DDSTRU                                          1194 04444000
         MVI   DARGSENT(@15),X'05'                                 1194 04445000
*       DARGDBP=ADDR(UCBVOLI);      /*                       @YD00175*/ 04446000
         LA    @14,UCBVOLI(,UCBPTR)                                1195 04447000
         ST    @14,DARGDBP(,@15)                                   1195 04448000
*       DARGILP=VOLSERLN;           /*                       @YD00175*/ 04449000
         MVC   DARGILP(2,@15),@CH00156                             1196 04450000
*       DARGSMOD=MSGMODID;          /*                       @YD00175*/ 04451000
         MVC   DARGSMOD(3,@15),@CC02595                            1197 04452000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @YD00175*/ 04453000
         ST    @08,@AL00001                                        1198 04454000
         LA    @05,@CF00115                                        1198 04455000
         ST    @05,@AL00001+4                                      1198 04456000
         LA    @05,DDSTRU                                          1198 04457000
         ST    @05,@AL00001+8                                      1198 04458000
         MVI   @AL00001+8,X'80'                                    1198 04459000
         L     @15,GDTPRT(,@08)                                    1198 04460000
         LA    @01,@AL00001                                        1198 04461000
         BALR  @14,@15                                             1198 04462000
*     END;                          /*                       @YD00175*/ 04463000
*                                                                  1200 04464000
*   /*****************************************************************/ 04465000
*   /*                                                               */ 04466000
*   /* TEST IF UCB IS ALREADY EXCLUSIVE BY CHECKING THE      @YD00175*/ 04467000
*   /* UCBBSVL BIT TO BE SET ON. IF IT IS OFF THEN TEST      @YD00175*/ 04468000
*   /* THE EXCLMNT FLAG. IF EXCLMNT IS OFF THE CALLER        @YD00175*/ 04469000
*   /* REQUIRES EXCLUSIVE CONTROL NO MATTER WHICH VOLUME     @YD00175*/ 04470000
*   /* IS MOUNTED ON THE UNIT SO CALL SETEXCL. IF EXCLMNT    @YD00175*/ 04471000
*   /* IS ON, THE CALLER REQUIRES EXCLUSIVE CONTROL ONLY     @YD00175*/ 04472000
*   /* IF THE VOLUME IN THE EXCLAGL IS MOUNTED, SO CALL      @YD00175*/ 04473000
*   /* SETEXCL ONLY IF THE VOLSER IN THE UCB IS THE SAME     @YD00175*/ 04474000
*   /* AS IN THE EXCLAGL. IF AN ERROR OCCURS, SET RETURN     @YD00175*/ 04475000
*   /* CODE TO INDICATE FAILURE.                             @YD00175*/ 04476000
*   /*                                                               */ 04477000
*   /*****************************************************************/ 04478000
*                                                                  1200 04479000
*   ELSE                                                           1200 04480000
*     IF UCBBSVL=OFF THEN                                          1200 04481000
         B     @RC01191                                            1200 04482000
@RF01191 TM    UCBBSVL(UCBPTR),B'10000000'                         1200 04483000
         BNZ   @RF01200                                            1200 04484000
*       IF EXCLMNT=OFF|EXCLMNT=ON&EXCLVOL=UCBVOLI THEN             1201 04485000
         L     @08,@PC00014                                        1201 04486000
         L     @08,GXAGLPTR(,@08)                                  1201 04487000
         TM    EXCLMNT(@08),B'10000000'                            1201 04488000
         BZ    @RT01201                                            1201 04489000
         TM    EXCLMNT(@08),B'10000000'                            1201 04490000
         BNO   @RF01201                                            1201 04491000
         CLC   EXCLVOL(6,@08),UCBVOLI(UCBPTR)                      1201 04492000
         BNE   @RF01201                                            1201 04493000
@RT01201 DS    0H                                                  1202 04494000
*         DO;                       /*                       @YD00175*/ 04495000
*           CALL SETEXCL(GXAGLPTR); /*                       @YD00175*/ 04496000
         L     @08,@PC00014                                        1203 04497000
         ST    @08,@AL00001                                        1203 04498000
         LA    @01,@AL00001                                        1203 04499000
         BAL   @14,SETEXCL                                         1203 04500000
*           RESPECIFY                                              1204 04501000
*             RTNREG RSTD;                                         1204 04502000
*           TESTRC=RTNREG;                                         1205 04503000
         LR    TESTRC,RTNREG                                       1205 04504000
*           RESPECIFY                                              1206 04505000
*             RTNREG UNRSTD;        /*                       @YD00175*/ 04506000
*           IF TESTRC^=0 THEN                                      1207 04507000
         LTR   TESTRC,TESTRC                                       1207 04508000
         BZ    @RF01207                                            1207 04509000
*             GETEXRC=TESTRC;       /*                       @YD00175*/ 04510000
         LR    GETEXRC,TESTRC                                      1208 04511000
*         END;                      /*                       @YD00175*/ 04512000
@RF01207 DS    0H                                                  1210 04513000
*   RETURN CODE(GETEXRC);           /* RETURN TO MAIN ROUTINE      1210 04514000
*                                                            @YD00175*/ 04515000
@RF01201 DS    0H                                                  1210 04516000
@RF01200 DS    0H                                                  1210 04517000
@RC01191 LR    @15,GETEXRC                                         1210 04518000
         L     @14,@SA00014                                        1210 04519000
         LM    @00,@12,@SA00014+8                                  1210 04520000
         BR    @14                                                 1210 04521000
*   END GETEXCL;                    /* END OF GETEXCL TO CHANGE TO AN   04522000
*                                      EXCLUSIVE VOLUME      @YD00175*/ 04523000
*                                                                  1212 04524000
*/********************************************************************/ 04525000
*/*                                                                  */ 04526000
*/*  PROCEDURE NAME - SETEXCL                                @YD00175*/ 04527000
*/*                                                          @YD00175*/ 04528000
*/*  FUNCTION - THIS ROUTINE CHANGES THE ENQUEUE OF THE      @YD00175*/ 04529000
*/*             VOLUME SERIAL TO EXCLUSIVE AND MARKS THE     @YD00175*/ 04530000
*/*             THE UCB NON-SHARABLE.  IF AN ERROR OCCURRS   @YD00175*/ 04531000
*/*             THEN PRINT MESSAGE IDC2390I.                 @YD00175*/ 04532000
*/*                                                          @YD00175*/ 04533000
*/*  INPUT - THE INPUT ARGUMENT LIST EXCLAGL IS USED TO      @YD00175*/ 04534000
*/*          ENQUEUE THE VOLSER EXCLUSIVELY.  THE UCB        @YD00175*/ 04535000
*/*          ADDRESS IN THE EXCLAGL IS USED TO FIND THE UCB. @YD00175*/ 04536000
*/*                                                          @YD00175*/ 04537000
*/*  OUTPUT- ISSUE ERROR MESSAGES AND RETURN TO CALLER WITH  @YD00175*/ 04538000
*/*          RETURN CODE IN REGISTER 15 AS FOLLOWS:          @YD00175*/ 04539000
*/*          0 - SUCCESSFUL, UCB IS MARKED EXCLUSIVE         @YD00175*/ 04540000
*/*          4 - UCB IS ALLOCATED TO ANOTHER JOB.            @YD00175*/ 04541000
*/*                                                                  */ 04542000
*/********************************************************************/ 04543000
*                                                                  1212 04544000
*SETEXCL:                                                          1212 04545000
*   PROCEDURE(SXAGLPTR);            /*                       @YD00175*/ 04546000
SETEXCL  STM   @14,@12,@SA00015                                    1212 04547000
         MVC   @PC00015(4),0(@01)                                  1212 04548000
*                                                                  1213 04549000
*   /*****************************************************************/ 04550000
*   /*                                                               */ 04551000
*   /* LOCAL DECLARATIONS FOR SETEXCL                        @YD00175*/ 04552000
*   /*                                                               */ 04553000
*   /*****************************************************************/ 04554000
*                                                                  1213 04555000
*   DCL                                                            1213 04556000
*     SXAGLPTR PTR(31);             /* SETEXCL EXCLAGL PTR   @YD00175*/ 04557000
*   DCL                                                            1214 04558000
*     SETEXRC FIXED(15);            /* SETEXCL RETURN CODE   @YD00175*/ 04559000
*   DCL                                                            1215 04560000
*     ENQBEGN1 CHAR(*) GEND;        /* ENQ LIST BEGINNING    @YD00175*/ 04561000
*   DCL                                                            1216 04562000
*     ENQLIST1 CHAR(*) GEND;        /* ENQUEUE GETMAINED     @YD00175*/ 04563000
*   DCL                                                            1217 04564000
*     MAJNAME1 CHAR(8) STATIC       /* MAJOR ENQ / DEQ       @YD00175*/ 04565000
*         INIT('SYSZVOLS');         /* RESOURCE NAME         @YD00175*/ 04566000
*   DCL                                                            1218 04567000
*     VOLSER1 CHAR(6) BDY(WORD);    /* VOLSER FIELD FOR ENQ  @YD00175*/ 04568000
*   DCL                                                            1219 04569000
*     ENQCORE1 CHAR(*) STATIC LOCAL GEND;/* GEND CORE DECLARE      1219 04570000
*                                                            @YD00175*/ 04571000
*   DCL                                                            1220 04572000
*     ENQLEN1 FIXED(31) STATIC LOCAL GEND;/* GEND LENGTH DCL @YD00175*/ 04573000
*   GENERATE DATA DEFS(ENQCORE1,ENQLEN1) REFS(MAJNAME1);           1221 04574000
*   GENERATE DATA DEFS(ENQLIST1,ENQBEGN1) REFS(MAJNAME1);          1222 04575000
*                                                                  1223 04576000
*   /*****************************************************************/ 04577000
*   /*                                                               */ 04578000
*   /* RESPECIFY EXCLAGL ON INPUT PARAMETER LIST AND INIT-   @YD00175*/ 04579000
*   /* IALIZE RETURN CODE AREA AND ISSUE UTRACE MACRO.       @YD00175*/ 04580000
*   /*                                                               */ 04581000
*   /*****************************************************************/ 04582000
*                                                                  1223 04583000
*   RFY                                                            1223 04584000
*     EXCLAGL BASED(SXAGLPTR);      /*                       @YD00175*/ 04585000
*   OLDERID2=NEWERID2;                                             1224 04586000
         L     @08,@PC00001                                        1224 04587000
         L     @08,GDTTR2(,@08)                                    1224 04588000
         MVC   @TS00001(95),NEWERID2(@08)                          1224 04589000
         MVC   OLDERID2(95,@08),@TS00001                           1224 04590000
*   NEWID2='SASE';                  /*                       @YD00175*/ 04591000
         MVC   NEWID2(4,@08),@CC02975                              1225 04592000
*   SETEXRC=0;                      /*                       @YD00175*/ 04593000
*                                                                  1226 04594000
         SLR   SETEXRC,SETEXRC                                     1226 04595000
*   /*****************************************************************/ 04596000
*   /*                                                               */ 04597000
*   /* COMPUTE THE CURRENT TCB ADDRESS FOR SETEXCL.          @YD00175*/ 04598000
*   /*                                                               */ 04599000
*   /*****************************************************************/ 04600000
*                                                                  1227 04601000
*   TCBPTR=CURTCBP;                 /*                       @Y30LB37*/ 04602000
         L     @08,CVTPTR                                          1227 04603000
         L     @08,TCBWDSP(,@08)                                   1227 04604000
         L     TCBPTR,CURTCBP(,@08)                                1227 04605000
*   TCBP=JSCBTCBP;                  /*                       @Y30LB37*/ 04606000
         L     @08,TCBJSCB(,TCBPTR)                                1228 04607000
         L     @08,JSCBTCBP(,@08)                                  1228 04608000
         ST    @08,TCBP                                            1228 04609000
*                                                                  1229 04610000
*   /*****************************************************************/ 04611000
*   /*                                                               */ 04612000
*   /* ISSUE THE DIRECTED ENQUEUE TO THE INITIATOR'S         @YD00175*/ 04613000
*   /* TCB TO CHANGE THE ENQUEUE ON THE VOLUME FROM          @YD00175*/ 04614000
*   /* SHARED TO EXCLUSIVE.                                  @YD00175*/ 04615000
*   /*                                                               */ 04616000
*   /*****************************************************************/ 04617000
*                                                                  1229 04618000
*   VOLSER1=UCBVOLI;                /*                       @YD00175*/ 04619000
         MVC   VOLSER1(6),UCBVOLI(UCBPTR)                          1229 04620000
*   ENQBEGN1(1:ENQLEN1)=ENQCORE1(1:ENQLEN1);/*               @YD00175*/ 04621000
         L     @08,ENQLEN1                                         1230 04622000
         BCTR  @08,0                                               1230 04623000
         EX    @08,@SM03063                                        1230 04624000
*LENQ4:                                                            1231 04625000
*   GENERATE REFS(MAJNAME1,VOLSER1,ENQLIST1,TCBP);                 1231 04626000
LENQ4    DS    0H                                                  1231 04627000
*                                                         /*@YD00175*/  04628000
         ENQ   (MAJNAME1,VOLSER1,E,6,SYSTEM),RET=CHNG,                **04629000
               MF=(E,ENQLIST1),TCB=TCBP  DIRECTED ENQUEUE     @YD00175  04630000
*   RESPECIFY                                                      1232 04631000
*     RTNREG RSTD;                                                 1232 04632000
*   TESTRC=RTNREG;                                                 1233 04633000
         LR    TESTRC,RTNREG                                       1233 04634000
*   RESPECIFY                                                      1234 04635000
*     RTNREG UNRSTD;                /*                       @YD00175*/ 04636000
*                                                                  1234 04637000
*   /*****************************************************************/ 04638000
*   /*                                                               */ 04639000
*   /* IF ENQUEUE IS SUCCESSFUL THEN ISSUE MODESET MACRO     @YD00175*/ 04640000
*   /* FOR KEY ZERO AUTHORITY, AND SET THE UCB BIT THAT      @YD00175*/ 04641000
*   /* INDICATES EXCLUSIVE CONTROL. RESET MODESET TO         @YD00175*/ 04642000
*   /* PROBLEM STATE.                                        @YD00175*/ 04643000
*   /*                                                               */ 04644000
*   /*****************************************************************/ 04645000
*                                                                  1235 04646000
*   IF TESTRC=0 THEN                                               1235 04647000
         LTR   TESTRC,TESTRC                                       1235 04648000
         BNZ   @RF01235                                            1235 04649000
*     DO;                           /*                       @YD00175*/ 04650000
*LMODE1:                                                           1237 04651000
*       GENERATE(MODESET KEY=ZERO,MODE=SUP);/*               @YD00175*/ 04652000
LMODE1   MODESET KEY=ZERO,MODE=SUP                                      04653000
*       UCBBSVL=ON;                 /*                       @YD00175*/ 04654000
         OI    UCBBSVL(UCBPTR),B'10000000'                         1238 04655000
*LMODE2:                                                           1239 04656000
*       GENERATE(MODESET KEY=NZERO,MODE=PROB);/*             @YD00175*/ 04657000
LMODE2   MODESET KEY=NZERO,MODE=PROB                                    04658000
*     END;                          /*                       @YD00175*/ 04659000
*                                                                  1241 04660000
*   /*****************************************************************/ 04661000
*   /*                                                               */ 04662000
*   /* IF ENQUEUE FAILED, THEN PRINT ERROR MESSAGE           @YD00175*/ 04663000
*   /* IDC2390I AND RETURN CODE FOUR.                        @YD00175*/ 04664000
*   /*                                                               */ 04665000
*   /*****************************************************************/ 04666000
*                                                                  1241 04667000
*   ELSE                                                           1241 04668000
*     DO;                           /*                       @YD00175*/ 04669000
         B     @RC01235                                            1241 04670000
@RF01235 DS    0H                                                  1242 04671000
*       SETEXRC=LASTCC04;           /*                       @YD00175*/ 04672000
         LA    SETEXRC,4                                           1242 04673000
*       DARGSENT=MSG2390I;          /*                       @YD00175*/ 04674000
         L     @08,DDSTRU                                          1243 04675000
         MVI   DARGSENT(@08),X'0A'                                 1243 04676000
*       DARGDBP=ADDR(UCBVOLI);      /*                       @YD00175*/ 04677000
         LA    @15,UCBVOLI(,UCBPTR)                                1244 04678000
         ST    @15,DARGDBP(,@08)                                   1244 04679000
*       DARGILP=VOLSERLN;           /*                       @YD00175*/ 04680000
         MVC   DARGILP(2,@08),@CH00156                             1245 04681000
*       DARGSMOD=MSGMODID;          /*                       @YD00175*/ 04682000
         MVC   DARGSMOD(3,@08),@CC02595                            1246 04683000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @YD00175*/ 04684000
         L     @08,@PC00001                                        1247 04685000
         ST    @08,@AL00001                                        1247 04686000
         LA    @05,@CF00115                                        1247 04687000
         ST    @05,@AL00001+4                                      1247 04688000
         LA    @05,DDSTRU                                          1247 04689000
         ST    @05,@AL00001+8                                      1247 04690000
         MVI   @AL00001+8,X'80'                                    1247 04691000
         L     @15,GDTPRT(,@08)                                    1247 04692000
         LA    @01,@AL00001                                        1247 04693000
         BALR  @14,@15                                             1247 04694000
*     END;                          /*                       @YD00175*/ 04695000
*   RETURN CODE(SETEXRC);           /* RETURN TO MAIN ROUTINE      1249 04696000
*                                                            @YD00175*/ 04697000
@RC01235 LR    @15,SETEXRC                                         1249 04698000
         L     @14,@SA00015                                        1249 04699000
         LM    @00,@12,@SA00015+8                                  1249 04700000
         BR    @14                                                 1249 04701000
*   END SETEXCL;                    /* END OF SETEXCL TO CHANGE TO AN   04702000
*                                      EXCLUSIVE VOLUME      @YD00175*/ 04703000
*                                                                  1251 04704000
*/********************************************************************/ 04705000
*/*                                                                  */ 04706000
*/*  PROCEDURE NAME - SELECTD                                @Z40LB37*/ 04707000
*/*                                                          @Z40LB37*/ 04708000
*/*  FUNCTION - THIS ROUTINE DETERMINES IF THE VOLUME IS     @Z40LB37*/ 04709000
*/*             MOUNTED TO THIS JOB STEP.  IF SO, RETURNS    @Z40LB37*/ 04710000
*/*             THE UCB ADDRESS AND THE DDNAME FOR THE       @Z40LB37*/ 04711000
*/*             VOLUME TO THE CALLER.                        @Z40LB37*/ 04712000
*/*                                                          @Z40LB37*/ 04713000
*/*  INPUT - THE INPUT ARGUMENT LIST SELAGL IS USED TO       @Z40LB37*/ 04714000
*/*          COMPARE VOLSER TO THE UCBVOLI FIELD.            @Z40LB37*/ 04715000
*/*                                                          @Z40LB37*/ 04716000
*/*  OUTPUT- RETURN TO CALLER WITH RETURN CODE IN REGISTER   @Z40LB37*/ 04717000
*/*          15 AS FOLLOWS:                                  @Z40LB37*/ 04718000
*/*          0 - SUCCESSFUL, THE VOLUME IS MOUNTED TO THIS   @Z40LB37*/ 04719000
*/*              JOB STEP.                                   @Z40LB37*/ 04720000
*/*          4 - THE VOLUME IS NOT MOUNTED TO THIS JOB       @Z40LB37*/ 04721000
*/*              STEP.                                       @Z40LB37*/ 04722000
*/*                                                                  */ 04723000
*/********************************************************************/ 04724000
*                                                                  1251 04725000
*SELECTD:                                                          1251 04726000
*   PROCEDURE(SLAGLPTR);            /*                       @Z40LB37*/ 04727000
*                                                                  1251 04728000
SELECTD  STM   @14,@12,@SA00016                                    1251 04729000
         MVC   @PC00016(4),0(@01)                                  1251 04730000
*   /*****************************************************************/ 04731000
*   /*                                                               */ 04732000
*   /* LOCAL DECLARATIONS FOR SELECTD                        @Z40LB37*/ 04733000
*   /*                                                               */ 04734000
*   /*****************************************************************/ 04735000
*                                                                  1252 04736000
*   DCL                                                            1252 04737000
*     SELEDRC FIXED(15);            /* SELECTD RETURN CODE   @Z40LB37*/ 04738000
*   DCL                                                            1253 04739000
*     SLAGLPTR PTR(31);             /* SELECTD SELAGL PTR    @Z40LB37*/ 04740000
*   DCL                                                            1254 04741000
*     SMJRNAM CHAR(8) STATIC        /* MAJOR ENQUEUE NAME    @Z40LB37*/ 04742000
*         BDY(WORD) INIT('SYSZTIOT');/* INITIALIZED          @Z40LB37*/ 04743000
*   DCL                                                            1255 04744000
*     1 SMNRNAME,                   /* MINOR ENQUEUE NAME    @Z40LB37*/ 04745000
*      2 SMNRLEN FIXED(8),          /* LENGTH OF MINOR NAME  @Z40LB37*/ 04746000
*      2 SMNRASID CHAR(2),          /* ASID OF THIS JOB STEP @Z40LB37*/ 04747000
*      2 SMNRQDB CHAR(4);           /* QDB ADDRESS           @Z40LB37*/ 04748000
*                                                                  1256 04749000
*   /*****************************************************************/ 04750000
*   /*                                                               */ 04751000
*   /* RESPECIFY SELAGL ON INPUT PARAMETER AND INITIALIZE    @Z40LB37*/ 04752000
*   /* RETURN CODE AREA AND ISSUE UTRACE MACRO.              @Z40LB37*/ 04753000
*   /*                                                               */ 04754000
*   /*****************************************************************/ 04755000
*                                                                  1256 04756000
*   RFY                                                            1256 04757000
*     SELAGL BASED(SLAGLPTR);       /*                       @Z40LB37*/ 04758000
*   OLDERID2=NEWERID2;                                             1257 04759000
         L     @08,@PC00001                                        1257 04760000
         L     @05,GDTTR2(,@08)                                    1257 04761000
         MVC   @TS00001(95),NEWERID2(@05)                          1257 04762000
         MVC   OLDERID2(95,@05),@TS00001                           1257 04763000
*   NEWID2='SASD';                  /*                       @Z40LB37*/ 04764000
         MVC   NEWID2(4,@05),@CC02994                              1258 04765000
*   SELEDRC=0;                      /*                       @Z40LB37*/ 04766000
*                                                                  1259 04767000
         SLR   SELEDRC,SELEDRC                                     1259 04768000
*   /*****************************************************************/ 04769000
*   /*                                                               */ 04770000
*   /* INITIALIZE POINTERS TO THE TCB, ASCB, QDB, AND DSAB.  @Z40LB37*/ 04771000
*   /* SET MINOR LENGTH FOR UENQ MACRO.                      @Z40LB37*/ 04772000
*   /*                                                               */ 04773000
*   /*****************************************************************/ 04774000
*                                                                  1260 04775000
*   ASCBPTR=PSAAOLD;                /*                       @Z40LB37*/ 04776000
         L     ASCBPTR,PSAAOLD                                     1260 04777000
*   SMNRASID=ASCBASID;              /*                       @Z40LB37*/ 04778000
         MVC   SMNRASID(2),ASCBASID(ASCBPTR)                       1261 04779000
*   TCBPTR=CURTCBP;                 /*                       @Z40LB37*/ 04780000
         L     @05,CVTPTR                                          1262 04781000
         L     @05,TCBWDSP(,@05)                                   1262 04782000
         L     TCBPTR,CURTCBP(,@05)                                1262 04783000
*   TCBP=JSCBTCBP;                  /*                       @Z40LB37*/ 04784000
         L     @05,TCBJSCB(,TCBPTR)                                1263 04785000
         L     @15,JSCBTCBP(,@05)                                  1263 04786000
         ST    @15,TCBP                                            1263 04787000
*   QDBPTR=JSCDSABQ;                /*                       @Z40LB37*/ 04788000
         L     QDBPTR,JSCDSABQ(,@05)                               1264 04789000
*   DSABPTR=QDBFELMP;               /*                       @Z40LB37*/ 04790000
         L     DSABPTR,QDBFELMP(,QDBPTR)                           1265 04791000
*   SMNRQDB=QDBPTR;                 /*                       @Z40LB37*/ 04792000
         STCM  QDBPTR,15,SMNRQDB                                   1266 04793000
*   SMNRLEN=LENGTH(SMNRASID)+LENGTH(SMNRQDB);/*              @Z40LB37*/ 04794000
*                                                                  1267 04795000
         MVI   SMNRLEN,X'06'                                       1267 04796000
*   /*****************************************************************/ 04797000
*   /*                                                               */ 04798000
*   /* ISSUE UENQ MACRO TO ENQUEUE ON THE TIOT AND WAIT.     @Z40LB37*/ 04799000
*   /*                                                               */ 04800000
*   /*****************************************************************/ 04801000
*                                                                  1268 04802000
*   CALL IDCSANQ0(GDTTBL,SHR,WAIT,SMJRNAM,SMNRNAME);/*       @Z40LB37*/ 04803000
         MVC   @AL00001+4(12),@AL01268                             1268 04804000
         ST    @08,@AL00001                                        1268 04805000
         LA    @05,SMNRNAME                                        1268 04806000
         ST    @05,@AL00001+16                                     1268 04807000
         MVI   @AL00001+16,X'80'                                   1268 04808000
         L     @15,GDTENQ(,@08)                                    1268 04809000
         LA    @01,@AL00001                                        1268 04810000
         BALR  @14,@15                                             1268 04811000
*                                                                  1269 04812000
*   /*****************************************************************/ 04813000
*   /*                                                               */ 04814000
*   /* CALL SELESCAN IF DSAB POINTER IS NOT ZEROS. IF        @Z40LB37*/ 04815000
*   /* THERE ARE NO DD ENTRIES THEN SET VOLFOUND FLAG TO     @Z40LB37*/ 04816000
*   /* OFF.                                                  @Z40LB37*/ 04817000
*   /*                                                               */ 04818000
*   /*****************************************************************/ 04819000
*                                                                  1269 04820000
*   IF DSABPTR^=NULLPTR THEN                                       1269 04821000
         LTR   DSABPTR,DSABPTR                                     1269 04822000
         BZ    @RF01269                                            1269 04823000
*     CALL SELESCAN(SLAGLPTR);      /*                       @Z40LB37*/ 04824000
         L     @08,@PC00016                                        1270 04825000
         ST    @08,@AL00001                                        1270 04826000
         LA    @01,@AL00001                                        1270 04827000
         BAL   @14,SELESCAN                                        1270 04828000
*   ELSE                                                           1271 04829000
*     VOLFOUND=OFF;                 /*                       @Z40LB37*/ 04830000
*                                                                  1271 04831000
         B     @RC01269                                            1271 04832000
@RF01269 NI    VOLFOUND,B'11101111'                                1271 04833000
*   /*****************************************************************/ 04834000
*   /*                                                               */ 04835000
*   /* IF THE VOLFOUND FLAG IS OFF, THEN THE CALLERS         @Z40LB37*/ 04836000
*   /* VOLSER WAS NOT FOUND, SO SET THE RETURN CODE          @Z40LB37*/ 04837000
*   /* TO FOUR AND CLEAR THE ARGLIST.                        @Z40LB37*/ 04838000
*   /*                                                               */ 04839000
*   /*****************************************************************/ 04840000
*                                                                  1272 04841000
*   IF VOLFOUND=OFF THEN                                           1272 04842000
@RC01269 TM    VOLFOUND,B'00010000'                                1272 04843000
         BNZ   @RF01272                                            1272 04844000
*     DO;                           /*                       @Z40LB37*/ 04845000
*       SLDDNAME=''B;               /*                       @Z40LB37*/ 04846000
         L     @08,@PC00016                                        1274 04847000
         L     @08,SLAGLPTR(,@08)                                  1274 04848000
         L     @05,SELDDNP(,@08)                                   1274 04849000
         XC    SLDDNAME(8,@05),SLDDNAME(@05)                       1274 04850000
*       SLUCBADR=''B;               /*                       @Z40LB37*/ 04851000
         L     @08,SELUCBP(,@08)                                   1275 04852000
         SLR   @05,@05                                             1275 04853000
         ST    @05,SLUCBADR(,@08)                                  1275 04854000
*       SELEDRC=4;                  /*                       @Z40LB37*/ 04855000
         LA    SELEDRC,4                                           1276 04856000
*     END;                          /*                       @Z40LB37*/ 04857000
*                                                                  1277 04858000
*   /*****************************************************************/ 04859000
*   /*                                                               */ 04860000
*   /* ISSUE UDEQ MACRO TO DEQUEUE ON THE TIOT AND RETURN.   @Z40LB37*/ 04861000
*   /*                                                               */ 04862000
*   /*****************************************************************/ 04863000
*                                                                  1278 04864000
*   CALL IDCSADQ0(GDTTBL,SMJRNAM,SMNRNAME);/*                @Z40LB37*/ 04865000
@RF01272 L     @08,@PC00001                                        1278 04866000
         ST    @08,@AL00001                                        1278 04867000
         LA    @05,SMJRNAM                                         1278 04868000
         ST    @05,@AL00001+4                                      1278 04869000
         LA    @05,SMNRNAME                                        1278 04870000
         ST    @05,@AL00001+8                                      1278 04871000
         MVI   @AL00001+8,X'80'                                    1278 04872000
         L     @15,GDTDEQ(,@08)                                    1278 04873000
         LA    @01,@AL00001                                        1278 04874000
         BALR  @14,@15                                             1278 04875000
*   RETURN CODE(SELEDRC);           /* RETURN TO MAIN ROUTINE      1279 04876000
*                                                            @Z40LB37*/ 04877000
         LR    @15,SELEDRC                                         1279 04878000
         L     @14,@SA00016                                        1279 04879000
         LM    @00,@12,@SA00016+8                                  1279 04880000
         BR    @14                                                 1279 04881000
*   END SELECTD;                    /* END OF SELECTD TO LOCATE A  1280 04882000
*                                      MOUNTED VOLUME        @Z40LB37*/ 04883000
*                                                                  1281 04884000
*/********************************************************************/ 04885000
*/*                                                                  */ 04886000
*/*  PROCEDURE NAME - SELESCAN                               @Z40LB37*/ 04887000
*/*                                                          @Z40LB37*/ 04888000
*/*  FUNCTION - THIS ROUTINE SCANS THE TIOT TO FIND IF       @Z40LB37*/ 04889000
*/*             THE VOLUME IS ALREADY MOUNTED.               @Z40LB37*/ 04890000
*/*                                                          @Z40LB37*/ 04891000
*/*  INPUT - THE INPUT ARGUMENT LIST SELAGL IS USED TO       @Z40LB37*/ 04892000
*/*          COMPARE VOLSER TO THE UCBVOLI FIELD.            @Z40LB37*/ 04893000
*/*                                                          @Z40LB37*/ 04894000
*/*  OUTPUT- INFORMATION RETURNED IN THE SELAGL AND BIT      @Z40LB37*/ 04895000
*/*          SWITCH AS FOLLOWS:                              @Z40LB37*/ 04896000
*/*          VOLFOUND = ON -                                 @Z40LB37*/ 04897000
*/*            VOLFOUND BIT ON IF THE CALLER'S VOLSER WAS    @Z40LB37*/ 04898000
*/*            FOUND IN THE UCB.  THE CALLER'S AREAS WILL    @Z40LB37*/ 04899000
*/*            BE SET WITH THE DDNAME AND UCB ADDRESS OF     @Z40LB37*/ 04900000
*/*            THE VOLUME.                                   @Z40LB37*/ 04901000
*/*          VOLFOUND = OFF -                                @Z40LB37*/ 04902000
*/*            VOLFOUND IS OFF IF THE CALLER'S VOLSER WAS    @Z40LB37*/ 04903000
*/*            NOT FOUND.  THE CALLER'S AREAS DO NOT         @Z40LB37*/ 04904000
*/*            CONTAIN THE DDNAME AND UCB ADDRESS.           @Z40LB37*/ 04905000
*/*                                                                  */ 04906000
*/********************************************************************/ 04907000
*                                                                  1281 04908000
*SELESCAN:                                                         1281 04909000
*   PROCEDURE(SSAGLPTR);            /*                       @Z40LB37*/ 04910000
*                                                                  1281 04911000
SELESCAN STM   @14,@12,12(@13)                                     1281 04912000
         MVC   @PC00017(4),0(@01)                                  1281 04913000
*   /*****************************************************************/ 04914000
*   /*                                                               */ 04915000
*   /* LOCAL DECLARATIONS FOR SELESCAN                       @Z40LB37*/ 04916000
*   /*                                                               */ 04917000
*   /*****************************************************************/ 04918000
*                                                                  1282 04919000
*   DCL                                                            1282 04920000
*     SSAGLPTR PTR(31);             /* SELESCAN SELAGL PTR   @Z40LB37*/ 04921000
*   DCL                                                            1283 04922000
*     TOTENTRY FIXED(31);           /* TOTAL DEVICE ENTRIES  @Z40LB37*/ 04923000
*   DCL                                                            1284 04924000
*     COUNTI FIXED(31);             /* DEVICE ENTRY COUNTER  @Z40LB37*/ 04925000
*   DCL                                                            1285 04926000
*     JOBCAT CHAR(8) STATIC         /* JOBCAT STATIC         @ZM41117*/ 04927000
*         INIT('JOBCAT  ');         /* CONSTANT              @ZM41117*/ 04928000
*   DCL                                                            1286 04929000
*     STEPCAT CHAR(8) STATIC        /* STEPCAT STATIC        @ZM41117*/ 04930000
*         INIT('STEPCAT ');         /* CONSTANT              @ZM41117*/ 04931000
*                                                                  1287 04932000
*   /*****************************************************************/ 04933000
*   /*                                                               */ 04934000
*   /* RESPECIFY SELAGL ON INPUT PARAMETER AND ISSUE         @Z40LB37*/ 04935000
*   /* UTRACE MACRO.                                         @Z40LB37*/ 04936000
*   /*                                                               */ 04937000
*   /*****************************************************************/ 04938000
*                                                                  1287 04939000
*   RFY                                                            1287 04940000
*     SELAGL BASED(SSAGLPTR);       /*                       @Z40LB37*/ 04941000
*   OLDERID2=NEWERID2;                                             1288 04942000
         L     @08,@PC00001                                        1288 04943000
         L     @08,GDTTR2(,@08)                                    1288 04944000
         MVC   @TS00001(95),NEWERID2(@08)                          1288 04945000
         MVC   OLDERID2(95,@08),@TS00001                           1288 04946000
*   NEWID2='SASC';                  /*                       @Z40LB37*/ 04947000
*                                                                  1289 04948000
         MVC   NEWID2(4,@08),@CC03008                              1289 04949000
*   /*****************************************************************/ 04950000
*   /*                                                               */ 04951000
*   /* SCAN THE TIOT DSAB CHAIN FOR A VOLSER IN THE UCB      @Z40LB37*/ 04952000
*   /* THAT MATCHES THE CALLERS VOLSER.                      @Z40LB37*/ 04953000
*   /*                                                               */ 04954000
*   /*****************************************************************/ 04955000
*                                                                  1290 04956000
*SSCANVOL:                                                         1290 04957000
*   DO WHILE VOLFOUND=OFF&DSABPTR^=NULLPTR;/*                @Z40LB37*/ 04958000
*                                                                  1290 04959000
SSCANVOL B     @DE01290                                            1290 04960000
@DL01290 DS    0H                                                  1291 04961000
*     /***************************************************************/ 04962000
*     /*                                                             */ 04963000
*     /* CHECK IF THE DSAB IS FOR A CONCATINATION MEMBER,    @Z40LB37*/ 04964000
*     /* AND THE TIOT DDNAME IS NOT EQUAL TO BLANKS,         @ZM41117*/ 04965000
*     /* IF IT IS NOT THEN CONTINUE.                         @Z40LB37*/ 04966000
*     /*                                                             */ 04967000
*     /***************************************************************/ 04968000
*                                                                  1291 04969000
*     IF TIOEDDNM^=BLANKDDN&((DSABCATL=OFF)|/*               @ZM41117*/ 04970000
*         (DSABCATL=ON&DSABJSCT=OFF)|/*                      @ZM41117*/ 04971000
*         (DSABCATL=ON&DSABJSCT=ON& /*                       @ZM41117*/ 04972000
*         (TIOEDDNM=JOBCAT|TIOEDDNM=STEPCAT))) THEN/*        @ZM41117*/ 04973000
         L     @08,DSABTIOT(,DSABPTR)                              1291 04974000
         CLC   TIOEDDNM(8,@08),BLANKDDN                            1291 04975000
         BE    @RF01291                                            1291 04976000
         TM    DSABCATL(DSABPTR),B'00001000'                       1291 04977000
         BZ    @RT01291                                            1291 04978000
         TM    DSABCATL(DSABPTR),B'00001000'                       1291 04979000
         BNO   @GL00033                                            1291 04980000
         TM    DSABJSCT(DSABPTR),B'00000100'                       1291 04981000
         BZ    @RT01291                                            1291 04982000
@GL00033 TM    DSABCATL(DSABPTR),B'00001100'                       1291 04983000
         BNO   @RF01291                                            1291 04984000
         L     @08,DSABTIOT(,DSABPTR)                              1291 04985000
         CLC   TIOEDDNM(8,@08),JOBCAT                              1291 04986000
         BE    @RT01291                                            1291 04987000
         CLC   TIOEDDNM(8,@08),STEPCAT                             1291 04988000
         BNE   @RF01291                                            1291 04989000
@RT01291 DS    0H                                                  1292 04990000
*       DO;                         /*                       @Z40LB37*/ 04991000
*                                                                  1292 04992000
*         /***********************************************************/ 04993000
*         /*                                                         */ 04994000
*         /* DETERMINE THE NUMBER OF DEVICE ENTRIES IN THE   @Z40LB37*/ 04995000
*         /* TIOT AND SET TOTENTRY.                          @Z40LB37*/ 04996000
*         /*                                                         */ 04997000
*         /***********************************************************/ 04998000
*                                                                  1293 04999000
*         TOTENTRY=ONE;             /*                       @Z40LB37*/ 05000000
         LA    @08,1                                               1293 05001000
         LR    TOTENTRY,@08                                        1293 05002000
*         IF TIOELNGH>(LENGTH(TIOENTRY)-LENGTH(POOLSTAR)) THEN     1294 05003000
         L     @05,DSABTIOT(,DSABPTR)                              1294 05004000
         CLI   TIOELNGH(@05),20                                    1294 05005000
         BNH   @RF01294                                            1294 05006000
*           TOTENTRY=((TIOELNGH-(LENGTH(TIOENTRY)-LENGTH(POOLSTAR)))/   05007000
*               LENGTH(TIOEDEVE))+1;/*                       @Z40LB37*/ 05008000
         SLR   @00,@00                                             1295 05009000
         IC    @00,TIOELNGH(,@05)                                  1295 05010000
         SL    @00,@CF03035                                        1295 05011000
         SRDA  @00,32                                              1295 05012000
         D     @00,@CF00042                                        1295 05013000
         ALR   @01,@08                                             1295 05014000
         LR    TOTENTRY,@01                                        1295 05015000
*                                                                  1296 05016000
*         /***********************************************************/ 05017000
*         /*                                                         */ 05018000
*         /* SCAN THE DEVICE ENTRIES FOR THE CALLER'S        @Z40LB37*/ 05019000
*         /* VOLUME SERIAL TO SEE IF IT IS IN ONE OF THE     @Z40LB37*/ 05020000
*         /* UCBS FOR THIS TIOT ENTRY.                       @Z40LB37*/ 05021000
*         /*                                                         */ 05022000
*         /***********************************************************/ 05023000
*                                                                  1296 05024000
*         DO COUNTI=1 TO TOTENTRY WHILE VOLFOUND=OFF;/*      @Z40LB37*/ 05025000
*                                                                  1296 05026000
@RF01294 LA    COUNTI,1                                            1296 05027000
         B     @DE01296                                            1296 05028000
@DL01296 TM    VOLFOUND,B'00010000'                                1296 05029000
         BNZ   @DC01296                                            1296 05030000
*           /*********************************************************/ 05031000
*           /*                                                       */ 05032000
*           /* SET THE UCBPTR TO THE CURRENT DEVICE ENTRY.   @Z40LB37*/ 05033000
*           /* IF CALLER'S VOLSER IS IN THE UCB THEN SET     @Z40LB37*/ 05034000
*           /* THE CALLER'S SELAGL WITH THE TIOT DDNAME      @Z40LB37*/ 05035000
*           /* AND THE UCB ADDRESS.                          @Z40LB37*/ 05036000
*           /*                                                       */ 05037000
*           /*********************************************************/ 05038000
*                                                                  1297 05039000
*           UCBPTR=TIOUCBP(COUNTI); /*                       @Z40LB37*/ 05040000
         LR    @08,COUNTI                                          1297 05041000
         SLA   @08,2                                               1297 05042000
         L     @15,DSABTIOT(,DSABPTR)                              1297 05043000
         L     @08,TIOUCBP-5(@08,@15)                              1297 05044000
         LA    @08,0(,@08)                                         1297 05045000
         LR    UCBPTR,@08                                          1297 05046000
*           IF UCBVOLI=SELVOL THEN                                 1298 05047000
         L     @14,@PC00017                                        1298 05048000
         L     @14,SSAGLPTR(,@14)                                  1298 05049000
         CLC   UCBVOLI(6,UCBPTR),SELVOL(@14)                       1298 05050000
         BNE   @RF01298                                            1298 05051000
*             DO;                   /*                       @Z40LB37*/ 05052000
*                                                                  1299 05053000
*               /*****************************************************/ 05054000
*               /*                                                   */ 05055000
*               /* SET THE SELAGL WITH THE TIOT DDNAME AND   @Z40LB37*/ 05056000
*               /* THE UCB ADDRESS OF THE CURRENT DEVICE     @Z40LB37*/ 05057000
*               /* ENTRY. SET THE VOLFOUND FLAG ON.          @Z40LB37*/ 05058000
*               /*                                                   */ 05059000
*               /*****************************************************/ 05060000
*                                                                  1300 05061000
*               SLDDNAME=TIOEDDNM;  /*                       @Z40LB37*/ 05062000
         L     @05,SELDDNP(,@14)                                   1300 05063000
         MVC   SLDDNAME(8,@05),TIOEDDNM(@15)                       1300 05064000
*               SLUCBADR=TIOUCBP(COUNTI);/*                  @Z40LB37*/ 05065000
         L     @05,SELUCBP(,@14)                                   1301 05066000
         ST    @08,SLUCBADR(,@05)                                  1301 05067000
*               VOLFOUND=ON;        /*                       @Z40LB37*/ 05068000
         OI    VOLFOUND,B'00010000'                                1302 05069000
*             END;                  /*                       @Z40LB37*/ 05070000
*         END;                      /*                       @Z40LB37*/ 05071000
@RF01298 AL    COUNTI,@CF00219                                     1304 05072000
@DE01296 CR    COUNTI,TOTENTRY                                     1304 05073000
         BNH   @DL01296                                            1304 05074000
@DC01296 DS    0H                                                  1305 05075000
*       END;                        /*                       @Z40LB37*/ 05076000
*                                                                  1305 05077000
*     /***************************************************************/ 05078000
*     /*                                                             */ 05079000
*     /* IF THE CALLER'S VOLSER IS NOT FOUND THEN GO TO      @Z40LB37*/ 05080000
*     /* THE NEXT DSAB ON THE CHAIN.                         @Z40LB37*/ 05081000
*     /*                                                             */ 05082000
*     /***************************************************************/ 05083000
*                                                                  1306 05084000
*     IF VOLFOUND^=ON THEN                                         1306 05085000
@RF01291 TM    VOLFOUND,B'00010000'                                1306 05086000
         BO    @RF01306                                            1306 05087000
*       DSABPTR=DSABFCHN;           /*                       @Z40LB37*/ 05088000
         L     DSABPTR,DSABFCHN(,DSABPTR)                          1307 05089000
*   END SSCANVOL;                   /*                       @Z40LB37*/ 05090000
@RF01306 DS    0H                                                  1308 05091000
@DE01290 TM    VOLFOUND,B'00010000'                                1308 05092000
         BNZ   @DC01290                                            1308 05093000
         LTR   DSABPTR,DSABPTR                                     1308 05094000
         BNZ   @DL01290                                            1308 05095000
@DC01290 DS    0H                                                  1309 05096000
*                                                                  1309 05097000
*   /*****************************************************************/ 05098000
*   /*                                                               */ 05099000
*   /* RETURN TO CALLER.                                     @Z40LB37*/ 05100000
*   /*                                                               */ 05101000
*   /*****************************************************************/ 05102000
*                                                                  1309 05103000
*   RETURN;                         /* RETURN TO MAIN ROUTINE      1309 05104000
*                                                            @Z40LB37*/ 05105000
@EL00017 DS    0H                                                  1309 05106000
@EF00017 DS    0H                                                  1309 05107000
@ER00017 LM    @14,@12,12(@13)                                     1309 05108000
         BR    @14                                                 1309 05109000
*   END SELESCAN;                   /* END OF SELESCAN TO LOCATE A 1310 05110000
*                                      MOUNTED VOLUME        @Z40LB37*/ 05111000
*                                                                  1311 05112000
*/***********************************************************@Y30LB39*/ 05113000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 05114000
*/*                                                          @Y30LB39*/ 05115000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 05116000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 05117000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 05118000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 05119000
*/*                                                          @Y30LB39*/ 05120000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 05121000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 05122000
*/*   IN SSECBCD.                                            @Y30LB39*/ 05123000
*/*                                                          @Y30LB39*/ 05124000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 05125000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 05126000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 05127000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 05128000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 05129000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 05130000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 05131000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 05132000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 05133000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 05134000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 05135000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 05136000
*/*                                                          @Y30LB39*/ 05137000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 05138000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 05139000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 05140000
*/*                                                          @Y30LB39*/ 05141000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 05142000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 05143000
*/*                                                          @Y30LB39*/ 05144000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 05145000
*/*                                                          @Y30LB39*/ 05146000
*/***********************************************************@Y30LB39*/ 05147000
*                                                                  1311 05148000
*                                   /*                       @Y30LB39*/ 05149000
*SSCMSG:                                                           1311 05150000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 05151000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   05152000
*                                                            @Y30LB39*/ 05153000
SSCMSG   STM   @14,@12,@SA00018                                    1311 05154000
         MVC   @PC00018(8),0(@01)                                  1311 05155000
*                                   /*                       @Y30LB39*/ 05156000
*                                                                  1312 05157000
*   /*****************************************************************/ 05158000
*   /*                                                               */ 05159000
*   /*                                                       @Y30LB39*/ 05160000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 05161000
*   /*                                                       @Y30LB39*/ 05162000
*   /*                                                               */ 05163000
*   /*****************************************************************/ 05164000
*                                                                  1312 05165000
*                                   /*                       @Y30LB39   05166000
*                                                            @Y30LB39*/ 05167000
*                                                                  1312 05168000
*   /*****************************************************************/ 05169000
*   /*                                                               */ 05170000
*   /*                                                       @Y30LB39*/ 05171000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 05172000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 05173000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 05174000
*   /*                                                       @Y30LB39*/ 05175000
*   /*                                                               */ 05176000
*   /*****************************************************************/ 05177000
*                                                                  1312 05178000
*                                   /*                       @Y30LB39*/ 05179000
*   DCL                                                            1312 05180000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 05181000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 05182000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 05183000
*   DCL                                                            1313 05184000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   05185000
*                                                            @Y30LB39   05186000
*                                                            @Y30LB39*/ 05187000
*                                                                  1313 05188000
*   /*****************************************************************/ 05189000
*   /*                                                               */ 05190000
*   /*                                                       @Y30LB39*/ 05191000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 05192000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 05193000
*   /*                                                       @Y30LB39*/ 05194000
*   /*                                                               */ 05195000
*   /*****************************************************************/ 05196000
*                                                                  1314 05197000
*                                   /*                       @Y30LB39*/ 05198000
*   DCL                                                            1314 05199000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 05200000
*   DCL                                                            1315 05201000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   05202000
*                                                            @Y30LB39*/ 05203000
*                                                                  1315 05204000
*   /*****************************************************************/ 05205000
*   /*                                                               */ 05206000
*   /*                                                       @Y30LB39*/ 05207000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 05208000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 05209000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 05210000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 05211000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 05212000
*   /*                                                       @Y30LB39*/ 05213000
*   /*                                                               */ 05214000
*   /*****************************************************************/ 05215000
*                                                                  1316 05216000
*                                   /*                       @Y30LB39*/ 05217000
*   DECLARE                                                        1316 05218000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   05219000
*                                                            @Y30LB39*/ 05220000
*                                                                  1316 05221000
*   /*****************************************************************/ 05222000
*   /*                                                               */ 05223000
*   /*                                                       @Y30LB39*/ 05224000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 05225000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 05226000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 05227000
*   /* IDCTSCM0.                                             @Y30LB39*/ 05228000
*   /*                                                       @Y30LB39*/ 05229000
*   /*                                                               */ 05230000
*   /*****************************************************************/ 05231000
*                                                                  1317 05232000
*                                   /*                       @Y30LB39*/ 05233000
*   DECLARE                                                        1317 05234000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   05235000
*                                                            @Y30LB39*/ 05236000
*                                                                  1317 05237000
*   /*****************************************************************/ 05238000
*   /*                                                               */ 05239000
*   /*                                                       @Y30LB39*/ 05240000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 05241000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 05242000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 05243000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 05244000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 05245000
*   /*                                                       @Y30LB39*/ 05246000
*   /*                                                               */ 05247000
*   /*****************************************************************/ 05248000
*                                                                  1318 05249000
*                                   /*                       @Y30LB39*/ 05250000
*   DECLARE                                                        1318 05251000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 05252000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   05253000
*                                                            @Y30LB39*/ 05254000
*                                                                  1318 05255000
*   /*****************************************************************/ 05256000
*   /*                                                               */ 05257000
*   /*                                                       @Y30LB39*/ 05258000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 05259000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 05260000
*   /*                                                       @Y30LB39*/ 05261000
*   /*                                                               */ 05262000
*   /*****************************************************************/ 05263000
*                                                                  1319 05264000
*                                   /*                       @Y30LB39*/ 05265000
*   DECLARE                                                        1319 05266000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   05267000
*                                                            @Y30LB39*/ 05268000
*                                                                  1319 05269000
*   /*****************************************************************/ 05270000
*   /*                                                               */ 05271000
*   /*                                                       @Y30LB39*/ 05272000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 05273000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 05274000
*   /*                                                       @Y30LB39*/ 05275000
*   /*                                                               */ 05276000
*   /*****************************************************************/ 05277000
*                                                                  1320 05278000
*                                   /*                       @Y30LB39*/ 05279000
*   DECLARE                                                        1320 05280000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   05281000
*                                                            @Y30LB39*/ 05282000
*                                   /*                       @Y30LB39*/ 05283000
*                                                                  1321 05284000
*   /*****************************************************************/ 05285000
*   /*                                                               */ 05286000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 05287000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 05288000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 05289000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 05290000
*   /*                                                       @Y30LB39*/ 05291000
*   /*                                                               */ 05292000
*   /*****************************************************************/ 05293000
*                                                                  1321 05294000
*                                   /*                       @Y30LB39*/ 05295000
*   OLDERID2=NEWERID2;                                             1321 05296000
         L     @08,@PC00001                                        1321 05297000
         L     @15,GDTTR2(,@08)                                    1321 05298000
         MVC   @TS00001(95),NEWERID2(@15)                          1321 05299000
         MVC   OLDERID2(95,@15),@TS00001                           1321 05300000
*   NEWID2='SSAA';                  /*                       @Y30LB39   05301000
*                                                            @Y30LB39*/ 05302000
*                                                                  1322 05303000
         MVC   NEWID2(4,@15),@CC03031                              1322 05304000
*   /*****************************************************************/ 05305000
*   /*                                                               */ 05306000
*   /*                                                       @Y30LB39*/ 05307000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 05308000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 05309000
*   /*                                                       @Y30LB39*/ 05310000
*   /*                                                               */ 05311000
*   /*****************************************************************/ 05312000
*                                                                  1323 05313000
*                                   /*                       @Y30LB39*/ 05314000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   05315000
*                                                            @Y30LB39*/ 05316000
*                                                                  1323 05317000
         LA    @15,SSDRGLT                                         1323 05318000
         ST    @15,SSDLPTR                                         1323 05319000
*   /*****************************************************************/ 05320000
*   /*                                                               */ 05321000
*   /*                                                       @Y30LB39*/ 05322000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 05323000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 05324000
*   /*                                                       @Y30LB39*/ 05325000
*   /*                                                               */ 05326000
*   /*****************************************************************/ 05327000
*                                                                  1324 05328000
*                                   /*                       @Y30LB39*/ 05329000
*   IF SSRCODE>0 THEN                                              1324 05330000
         L     @14,@PC00018                                        1324 05331000
         L     @14,SSRCODE(,@14)                                   1324 05332000
         LTR   @14,@14                                             1324 05333000
         BNP   @RF01324                                            1324 05334000
*     DO;                           /*                       @Y30LB39   05335000
*                                                            @Y30LB39*/ 05336000
*                                                                  1325 05337000
*       /*************************************************************/ 05338000
*       /*                                                           */ 05339000
*       /*                                                   @Y30LB39*/ 05340000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 05341000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 05342000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 05343000
*       /* CODES.                                            @Y30LB39*/ 05344000
*       /*                                                   @Y30LB39*/ 05345000
*       /*                                                           */ 05346000
*       /*************************************************************/ 05347000
*                                                                  1326 05348000
*                                   /*                       @Y30LB39*/ 05349000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 05350000
         XC    SSDRGLT(20),SSDRGLT                                 1326 05351000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 05352000
         LA    @03,SSINXLST                                        1327 05353000
         ST    @03,DARGRETP(,@15)                                  1327 05354000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 05355000
         MVC   DARGSMOD(3,@15),SSMODSS0                            1328 05356000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 05357000
         MVI   DARGSENT(@15),X'01'                                 1329 05358000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   05359000
*                                                            @Y30LB39*/ 05360000
*                                                                  1330 05361000
         MVC   DARGRETL(2,@15),@CH03036                            1330 05362000
*       /*************************************************************/ 05363000
*       /*                                                           */ 05364000
*       /*                                                   @Y30LB39*/ 05365000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 05366000
*       /* ARRAY.                                            @Y30LB39*/ 05367000
*       /*                                                   @Y30LB39*/ 05368000
*       /*                                                           */ 05369000
*       /*************************************************************/ 05370000
*                                                                  1331 05371000
*                                   /*                       @Y30LB39*/ 05372000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   05373000
*                                                            @Y30LB39*/ 05374000
*                                                                  1331 05375000
         ST    @08,@AL00001                                        1331 05376000
         LA    @03,@CF00115                                        1331 05377000
         ST    @03,@AL00001+4                                      1331 05378000
         LA    @03,SSDLPTR                                         1331 05379000
         ST    @03,@AL00001+8                                      1331 05380000
         MVI   @AL00001+8,X'80'                                    1331 05381000
         L     @15,GDTPRT(,@08)                                    1331 05382000
         LA    @01,@AL00001                                        1331 05383000
         BALR  @14,@15                                             1331 05384000
*       /*************************************************************/ 05385000
*       /*                                                           */ 05386000
*       /*                                                   @Y30LB39*/ 05387000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 05388000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 05389000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 05390000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 05391000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 05392000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 05393000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 05394000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 05395000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 05396000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 05397000
*       /* REASON CODE.                                      @Y30LB39*/ 05398000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 05399000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 05400000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 05401000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 05402000
*       /*                                                   @Y30LB39*/ 05403000
*       /*                                                           */ 05404000
*       /*************************************************************/ 05405000
*                                                                  1332 05406000
*                                   /*                       @Y30LB39*/ 05407000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 05408000
         LA    ENTRYNUM,1                                          1332 05409000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1333 05410000
@DL01333 DS    0H                                                  1334 05411000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 05412000
         AL    ENTRYNUM,@CF00219                                   1334 05413000
*       END;                        /*                       @Y30LB39   05414000
*                                                            @Y30LB39*/ 05415000
*                                                                  1335 05416000
@DE01333 L     @08,@PC00018                                        1335 05417000
         LR    @03,ENTRYNUM                                        1335 05418000
         ALR   @03,@03                                             1335 05419000
         LH    @03,SSARRAY-2(@03)                                  1335 05420000
         CH    @03,SSRHALF(,@08)                                   1335 05421000
         BE    @DC01333                                            1335 05422000
         SLR   @15,@15                                             1335 05423000
         CR    @03,@15                                             1335 05424000
         BNE   @DL01333                                            1335 05425000
@DC01333 DS    0H                                                  1336 05426000
*       /*************************************************************/ 05427000
*       /*                                                           */ 05428000
*       /*                                                   @Y30LB39*/ 05429000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 05430000
*       /*                                                   @Y30LB39*/ 05431000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 05432000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 05433000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 05434000
*       /* CODE OR                                           @Y30LB39*/ 05435000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 05436000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 05437000
*       /*                                                   @Y30LB39*/ 05438000
*       /*                                                           */ 05439000
*       /*************************************************************/ 05440000
*                                                                  1336 05441000
*                                   /*                       @Y30LB39*/ 05442000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 05443000
         XC    SSDRGLT(20),SSDRGLT                                 1336 05444000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 05445000
         L     @14,SSDLPTR                                         1337 05446000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1337 05447000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 05448000
         STC   ENTRYNUM,DARGSENT(,@14)                             1338 05449000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 05450000
         CR    @03,@15                                             1339 05451000
         BNE   @RF01339                                            1339 05452000
*         DO;                       /*                       @Y30LB39*/ 05453000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 05454000
         ST    @08,DARGDBP(,@14)                                   1341 05455000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 05456000
         MVC   DARGILP(2,@14),@CH00042                             1342 05457000
*         END;                      /*                       @Y30LB39*/ 05458000
*     END;                          /*                       @Y30LB39*/ 05459000
*                                   /*                       @Y30LB39*/ 05460000
*                                                                  1345 05461000
*   /*****************************************************************/ 05462000
*   /*                                                               */ 05463000
*   /*                                                       @Y30LB39*/ 05464000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 05465000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 05466000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 05467000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 05468000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 05469000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 05470000
*   /* POST CODE.                                            @Y30LB39*/ 05471000
*   /*                                                       @Y30LB39*/ 05472000
*   /*                                                               */ 05473000
*   /*****************************************************************/ 05474000
*                                                                  1345 05475000
*                                   /*                       @Y30LB39*/ 05476000
*   ELSE                            /*                       @Y30LB39*/ 05477000
*     DO;                           /*                       @Y30LB39*/ 05478000
         B     @RC01324                                            1345 05479000
@RF01324 DS    0H                                                  1346 05480000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 05481000
         XC    SSDRGLT(20),SSDRGLT                                 1346 05482000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 05483000
         L     @08,SSDLPTR                                         1347 05484000
         MVC   DARGSMOD(3,@08),SSMODCM0                            1347 05485000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 05486000
         MVC   DARGSENT(1,@08),SSMSGNUM                            1348 05487000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 05488000
         L     @15,@PC00018+4                                      1349 05489000
         ST    @15,DARGDBP(,@08)                                   1349 05490000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 05491000
         MVC   DARGILP(2,@08),@CH00219                             1350 05492000
*     END;                          /*                       @Y30LB39   05493000
*                                                            @Y30LB39*/ 05494000
*                                                                  1351 05495000
*   /*****************************************************************/ 05496000
*   /*                                                               */ 05497000
*   /*                                                       @Y30LB39*/ 05498000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 05499000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 05500000
*   /*                                                       @Y30LB39*/ 05501000
*   /*                                                               */ 05502000
*   /*****************************************************************/ 05503000
*                                                                  1352 05504000
*                                   /*                       @Y30LB39*/ 05505000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   05506000
*                                                            @Y30LB39*/ 05507000
*                                                                  1352 05508000
@RC01324 L     @08,@PC00001                                        1352 05509000
         ST    @08,@AL00001                                        1352 05510000
         LA    @15,@CF00115                                        1352 05511000
         ST    @15,@AL00001+4                                      1352 05512000
         LA    @15,SSDLPTR                                         1352 05513000
         ST    @15,@AL00001+8                                      1352 05514000
         MVI   @AL00001+8,X'80'                                    1352 05515000
         L     @15,GDTPRT(,@08)                                    1352 05516000
         LA    @01,@AL00001                                        1352 05517000
         BALR  @14,@15                                             1352 05518000
*   /*****************************************************************/ 05519000
*   /*                                                               */ 05520000
*   /*                                                       @Y30LB39*/ 05521000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 05522000
*   /*                                                       @Y30LB39*/ 05523000
*   /*                                                               */ 05524000
*   /*****************************************************************/ 05525000
*                                                                  1353 05526000
*                                   /*                       @Y30LB39   05527000
*                                                            @Y30LB39*/ 05528000
*   RETURN CODE(0);                 /*                       @Y30LB39   05529000
*                                                            @Y30LB39*/ 05530000
         SLR   @15,@15                                             1353 05531000
         L     @14,@SA00018                                        1353 05532000
         LM    @00,@12,@SA00018+8                                  1353 05533000
         BR    @14                                                 1353 05534000
*   END SSCMSG;                     /*                       @Y30LB39*/ 05535000
*   END IDCSA06                     /* END OF MSS SYSTEM ADAPTER - 1355 05536000
*                                      IDCSA06               @Y30LB37*/ 05537000
*                                                                  1355 05538000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05539000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 05540000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 05541000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 05542000
*/*%INCLUDE SYSLIB  (AMSDF09 )                                       */ 05543000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 05544000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 05545000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 05546000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */ 05547000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 05548000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 05549000
*/*%INCLUDE SYSLIB  (IHADSAB )                                       */ 05550000
*/*%INCLUDE SYSLIB  (IHAQDB  )                                       */ 05551000
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                       */ 05552000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 05553000
*                                                                  1355 05554000
*       ;                                                          1355 05555000
@DATA    DS    0H                                                       05556000
@CH00153 DC    H'2'                                                     05557000
@CH00162 DC    H'3'                                                     05558000
@CH00156 DC    H'6'                                                     05559000
@CH02774 DC    H'19'                                                    05560000
@CH03034 DC    H'38'                                                    05561000
@CH02817 DC    H'72'                                                    05562000
@CH03033 DC    H'80'                                                    05563000
@CH03036 DC    H'120'                                                   05564000
@CH02731 DC    XL2'0100'                                                05565000
@SM03055 MVC   ENQBEGIN(0),ENQCORE                                      05566000
@SM03057 MVC   TENQBEGN(0),TENQCORE                                     05567000
@SM03059 MVC   DEQBEGIN(0),DEQCORE                                      05568000
@SM03061 MVC   ENQBEGN3(0),ENQCORE3                                     05569000
@SM03063 MVC   ENQBEGN1(0),ENQCORE1                                     05570000
         DS    0F                                                       05571000
@AL01063 DC    A(SHR)                  LIST WITH   3 ARGUMENT(S)        05572000
         DC    A(WAIT)                                                  05573000
         DC    A(MAJRNAM)                                               05574000
@AL01268 DC    A(SHR)                  LIST WITH   3 ARGUMENT(S)        05575000
         DC    A(WAIT)                                                  05576000
         DC    A(SMJRNAM)                                               05577000
@DATD    DSECT                                                          05578000
         DS    0F                                                       05579000
@SA00001 DS    18F                                                      05580000
@PC00001 DS    3F                                                       05581000
@SA00002 DS    15F                                                      05582000
@PC00002 DS    1F                                                       05583000
@SA00003 DS    15F                                                      05584000
@PC00003 DS    2F                                                       05585000
@SA00004 DS    15F                                                      05586000
@PC00004 DS    1F                                                       05587000
@SA00012 DS    15F                                                      05588000
@PC00012 DS    1F                                                       05589000
@SA00014 DS    15F                                                      05590000
@PC00014 DS    1F                                                       05591000
@SA00016 DS    15F                                                      05592000
@PC00016 DS    1F                                                       05593000
@SA00005 DS    15F                                                      05594000
@PC00005 DS    1F                                                       05595000
@SA00009 DS    15F                                                      05596000
@PC00009 DS    1F                                                       05597000
@SA00006 DS    15F                                                      05598000
@PC00006 DS    1F                                                       05599000
@SA00011 DS    15F                                                      05600000
@PC00011 DS    2F                                                       05601000
@SA00007 DS    15F                                                      05602000
@PC00007 DS    1F                                                       05603000
@SA00008 DS    15F                                                      05604000
@PC00008 DS    1F                                                       05605000
@SA00018 DS    15F                                                      05606000
@PC00018 DS    2F                                                       05607000
@SA00010 DS    15F                                                      05608000
@PC00010 DS    1F                                                       05609000
@SA00013 DS    15F                                                      05610000
@PC00013 DS    1F                                                       05611000
@SA00015 DS    15F                                                      05612000
@PC00015 DS    1F                                                       05613000
@PC00017 DS    1F                                                       05614000
@AL00001 DS    5A                                                       05615000
@AFTEMPS DS    1F                                                       05616000
IDCSA06  CSECT                                                          05617000
         DS    0F                                                       05618000
@CF00115 DC    F'0'                                                     05619000
@CF00219 DC    F'1'                                                     05620000
@CH00219 EQU   @CF00219+2                                               05621000
@CF00042 DC    F'4'                                                     05622000
@CH00042 EQU   @CF00042+2                                               05623000
@CF00179 DC    F'8'                                                     05624000
@CH00179 EQU   @CF00179+2                                               05625000
@CF00037 DC    F'12'                                                    05626000
@CF00473 DC    F'16'                                                    05627000
@CF03035 DC    F'20'                                                    05628000
@CF02065 DC    F'96'                                                    05629000
@CF03052 DC    XL4'0000FFFF'                                            05630000
@CF02850 DC    XL4'57'                                                  05631000
@DATD    DSECT                                                          05632000
         DS    0D                                                       05633000
LISTSCAN DS    A                                                        05634000
IOCSPTR  DS    A                                                        05635000
OPNPTR   DS    A                                                        05636000
DDSTRU   DS    A                                                        05637000
FSADDR   DS    A                                                        05638000
ERCNVADR DS    A                                                        05639000
DMPINDEX DS    A                                                        05640000
CCMSGPTR DS    A                                                        05641000
CMMSGPTR DS    A                                                        05642000
CTMSGPTR DS    A                                                        05643000
ELEMENT  DS    F                                                        05644000
TIOTPTR  DS    A                                                        05645000
ARGLPTR  DS    A                                                        05646000
TCBP     DS    A                                                        05647000
REASONCD DS    FL4                                                      05648000
         ORG   REASONCD                                                 05649000
@NM00133 DS    FL2                                                      05650000
REASON   DS    FL2                                                      05651000
         ORG   REASONCD+4                                               05652000
UNITPTR  DS    A                                                        05653000
MYAGLPTR DS    A                                                        05654000
MTPUAGLP DS    A                                                        05655000
MNTLPTR  DS    A                                                        05656000
ACQLPTR  DS    A                                                        05657000
RTNAREA  DS    A                                                        05658000
MDPUAGLP DS    A                                                        05659000
WTOPTR   DS    A                                                        05660000
DMNTLPTR DS    A                                                        05661000
VOLSPTR  DS    A                                                        05662000
SSDLPTR  DS    A                                                        05663000
LISTPTR  DS    A                                                        05664000
RETCODE  DS    H                                                        05665000
WTOLEN   DS    H                                                        05666000
SETRC    DS    H                                                        05667000
LISTLN   DS    FL1                                                      05668000
@TS00001 DS    CL95                                                     05669000
         DS    CL2                                                      05670000
TTRWORK  DS    CL4                                                      05671000
         ORG   TTRWORK                                                  05672000
CCWORK   DS    FL2                                                      05673000
HHWORK   DS    FL2                                                      05674000
         ORG   TTRWORK+4                                                05675000
SYSIN    DS    CL16                                                     05676000
         ORG   SYSIN                                                    05677000
JOBNAM   DS    CL8                                                      05678000
STEPNM   DS    CL8                                                      05679000
         ORG   SYSIN+16                                                 05680000
ROUTCD   DS    BL2                                                      05681000
         ORG   ROUTCD                                                   05682000
CD1      DS    BL1                                                      05683000
@NM00129 EQU   ROUTCD+0                                                 05684000
         ORG   ROUTCD+2                                                 05685000
DESCCD   DS    BL2                                                      05686000
         ORG   DESCCD                                                   05687000
@NM00130 DS    BL1                                                      05688000
DESC4    EQU   DESCCD+0                                                 05689000
@NM00131 EQU   DESCCD+0                                                 05690000
         ORG   DESCCD+2                                                 05691000
SA06SWS  DS    CL1                                                      05692000
         ORG   SA06SWS                                                  05693000
FOUNDVOL DS    BL1                                                      05694000
FOUNDADD EQU   SA06SWS+0                                                05695000
FOUNDCAT EQU   SA06SWS+0                                                05696000
VOLFOUND EQU   SA06SWS+0                                                05697000
@NM00132 EQU   SA06SWS+0                                                05698000
         ORG   SA06SWS+1                                                05699000
MNTSTATS DS    CL8                                                      05700000
ECBCODE  DS    CL1                                                      05701000
VOLWORK  DS    CL6                                                      05702000
PRINTARG DS    CL52                                                     05703000
UNITAREA DS    CL11                                                     05704000
CHECKSWS DS    CL1                                                      05705000
         ORG   CHECKSWS                                                 05706000
NOTDASW  DS    BL1                                                      05707000
NOTVTSW  EQU   CHECKSWS+0                                               05708000
NOTDMNT  EQU   CHECKSWS+0                                               05709000
@NM00134 EQU   CHECKSWS+0                                               05710000
         ORG   CHECKSWS+1                                               05711000
RETAREA  DS    CL10                                                     05712000
         ORG   RETAREA                                                  05713000
RETVOLSR DS    CL6                                                      05714000
RETTTR   DS    CL4                                                      05715000
         ORG   RETAREA+10                                               05716000
         DS    CL2                                                      05717000
SV82CORE DS    CL16                                                     05718000
SA6MDAGL DS    CL37                                                     05719000
         DS    CL3                                                      05720000
MTPUAGL  DS    CL20                                                     05721000
MNTLST   DS    CL28                                                     05722000
ACQLST   DS    CL96                                                     05723000
EXOLIST  DS    CL34                                                     05724000
         DS    CL2                                                      05725000
EXGLIST  DS    CL32                                                     05726000
RECAREA  DS    CL84                                                     05727000
         ORG   RECAREA                                                  05728000
@NM00143 DS    CL84                                                     05729000
         ORG   RECAREA+84                                               05730000
CCHHRWK  DS    CL5                                                      05731000
         ORG   CCHHRWK                                                  05732000
CC       DS    FL2                                                      05733000
HH       DS    FL2                                                      05734000
R        DS    FL1                                                      05735000
         ORG   CCHHRWK+5                                                05736000
         DS    CL3                                                      05737000
SA6PUAGL DS    CL20                                                     05738000
SA6PUVOL DS    CL6                                                      05739000
SA6PUTTR DS    CL4                                                      05740000
WTOMSG   DS    CL72                                                     05741000
         DS    CL2                                                      05742000
DEMNTLST DS    CL28                                                     05743000
VOLSER   DS    CL6                                                      05744000
MINRNAME DS    CL7                                                      05745000
         ORG   MINRNAME                                                 05746000
MINRLEN  DS    FL1                                                      05747000
MINRASID DS    CL2                                                      05748000
MINRQDB  DS    CL4                                                      05749000
         ORG   MINRNAME+7                                               05750000
         DS    CL3                                                      05751000
VOLSER3  DS    CL6                                                      05752000
OPTINFO  DS    CL1                                                      05753000
         DS    CL1                                                      05754000
INFOAREA DS    CL38                                                     05755000
         ORG   INFOAREA                                                 05756000
INFOHEAD DS    CL4                                                      05757000
         ORG   INFOHEAD                                                 05758000
INWKLEN  DS    FL2                                                      05759000
RETNLEN  DS    FL2                                                      05760000
         ORG   INFOAREA+4                                               05761000
INFOTYPE DS    FL2                                                      05762000
DATALEN  DS    FL2                                                      05763000
VOLAREA  DS    5CL6                                                     05764000
         ORG   INFOAREA+38                                              05765000
         DS    CL2                                                      05766000
VOLSER1  DS    CL6                                                      05767000
SMNRNAME DS    CL7                                                      05768000
         ORG   SMNRNAME                                                 05769000
SMNRLEN  DS    FL1                                                      05770000
SMNRASID DS    CL2                                                      05771000
SMNRQDB  DS    CL4                                                      05772000
         ORG   SMNRNAME+7                                               05773000
SSDRGLT  DS    CL20                                                     05774000
         DS    CL3                                                      05775000
SSINXLST DS    CL120                                                    05776000
         ORG   SSINXLST                                                 05777000
SSARRAY  DS    60H                                                      05778000
         ORG   SSINXLST+120                                             05779000
IDCSA06  CSECT                                                          05780000
         DS    0F                                                       05781000
@SIZDATD DC    AL1(0)                                                   05782000
         DC    AL3(@ENDDATD-@DATD)                                      05783000
         DS    0D                                                       05784000
ACQOP    DC    XL1'02'                                                  05785000
SSMSGNUM DC    AL1(56)                                                  05786000
@CC02523 DC    C'SA06'                                                  05787000
@CC02620 DC    C'SAIN'                                                  05788000
@CC02632 DC    C'SAEX'                                                  05789000
@CC02648 DC    C'SACK'                                                  05790000
@CC02649 DC    C'VIRT'                                                  05791000
@CC02650 DC    C'REAL'                                                  05792000
@CC02672 DC    C'SAPU'                                                  05793000
@CC02687 DC    C'SAPR'                                                  05794000
@CC02701 DC    C'SAMC'                                                  05795000
@CC02714 DC    C'SAMT'                                                  05796000
@CC02773 DC    C'SAIM'                                                  05797000
@CC02802 DC    C'SARD'                                                  05798000
@CC02819 DC    C'SADM'                                                  05799000
@CC02849 DC    C'SAID'                                                  05800000
@CC02887 DC    C'SAED'                                                  05801000
@CC02921 DC    C'SAFE'                                                  05802000
@CC02942 DC    C'SAST'                                                  05803000
@CC02956 DC    C'SAGE'                                                  05804000
@CC02975 DC    C'SASE'                                                  05805000
@CC02994 DC    C'SASD'                                                  05806000
@CC03008 DC    C'SASC'                                                  05807000
@CC03031 DC    C'SSAA'                                                  05808000
@CC02595 DC    C'SA6'                                                   05809000
ALL      DC    CL3'ALL'                                                 05810000
FORMAT   DC    CL4'FORM'                                                05811000
HSECOND  DC    CL4'HSEC'                                                05812000
CLOCK    DC    CL4'KLOK'                                                05813000
SETZERO  DC    CL4'ZERO'                                                05814000
SETBLANK DC    CL4'BLNK'                                                05815000
NOSET    DC    CL4'NSET'                                                05816000
OVERRIDE DC    CL4'OVRD'                                                05817000
ACQUIRE  DC    CL8'ACQUIRE '                                            05818000
RELINQ   DC    CL8'RELINQ  '                                            05819000
MOUNT    DC    CL8'MOUNT   '                                            05820000
DEMOUNT  DC    CL8'DEMOUNT '                                            05821000
DEFINE   DC    CL8'DEFINE  '                                            05822000
MOVE     DC    CL8'MOVE    '                                            05823000
TRACEQ   DC    CL8'TRACEQ  '                                            05824000
COPYTABL DC    CL8'COPYTABL'                                            05825000
COPYCRTG DC    CL8'COPYCRTG'                                            05826000
COPYVOL  DC    CL8'COPYVOL '                                            05827000
VVIC     DC    CL8'VVIC    '                                            05828000
TUNE     DC    CL8'TUNE    '                                            05829000
NAMES    DC    CL4'NAME'                                                05830000
UNIT     DC    CL4'UNIT'                                                05831000
SHR      DC    CL4'SHR '                                                05832000
EXCL     DC    CL4'EXCL'                                                05833000
NOWAIT   DC    CL4'NWAI'                                                05834000
WAIT     DC    CL4'WAIT'                                                05835000
SECCHECK DC    CL8'SECCHECK'                                            05836000
SCRVTOC  DC    CL8'SCRVTOC '                                            05837000
GETVTOC  DC    CL8'GETVTOC '                                            05838000
PUTVTOC  DC    CL8'PUTVTOC '                                            05839000
RECATLG  DC    CL8'RECATLG '                                            05840000
INITVOL  DC    CL8'INITVOL '                                            05841000
CHECK    DC    CL8'CHECK   '                                            05842000
POSTUCB  DC    CL8'POSTUCB '                                            05843000
GET      DC    CL8'GET     '                                            05844000
PUT      DC    CL8'PUT     '                                            05845000
CLOSE    DC    CL8'CLOSE   '                                            05846000
OPEN     DC    CL8'OPEN    '                                            05847000
PUTLABEL DC    CL8'PUTLABEL'                                            05848000
GETLABEL DC    CL8'GETLABEL'                                            05849000
CANCEL   DC    CL8'CANCEL  '                                            05850000
SET      DC    CL8'SET     '                                            05851000
SELECTX  DC    CL8'SELECTX '                                            05852000
CHANGEX  DC    CL8'CHANGEX '                                            05853000
SELECTDD DC    CL8'SELECTDD'                                            05854000
SELECTDS DC    CL8'SELECTDS'                                            05855000
TBLREST  DC    CL8'TBLREST '                                            05856000
NULLIFYC DC    CL8'NULLIFYC'                                            05857000
RDMSC    DC    CL8'RDMSC   '                                            05858000
RDMSCTBL DC    CL8'RDMSCTBL'                                            05859000
RDCARTLB DC    CL8'RDCARTLB'                                            05860000
AUDITCEL DC    CL8'AUDITCEL'                                            05861000
RDSTGAD  DC    CL8'RDSTGAD '                                            05862000
MODID    DC    CL4'SA06'                                                05863000
POST     DC    CL8'POST    '                                            05864000
CLEAR    DC    CL8'CLEAR   '                                            05865000
ENQCMD   DC    CL8'ENQ     '                                            05866000
DEQCMD   DC    CL8'DEQ     '                                            05867000
ZEROVOL  DC    X'000000000000'                                          05868000
BLANKDDN DC    CL8'        '                                            05869000
ECBZERO  DC    X'00'                                                    05870000
ZEROBITS DS    CL1                                                      05871000
         ORG   ZEROBITS                                                 05872000
ZERODMC  DC    B'00000000'                                              05873000
         ORG   ZEROBITS+1                                               05874000
CHKERROR DC    CL8'CHECKERR'                                            05875000
MNTERROR DC    CL8'MOUNTERR'                                            05876000
FIXAREA  DS    CL400                                                    05877000
         ORG   FIXAREA                                                  05878000
ZAPAREA  DC    400X'00'                                                 05879000
         ORG   FIXAREA+400                                              05880000
UNIT3330 DC    X'09'                                                    05881000
CLEARCD  DC    X'22'                                                    05882000
POSTCD   DC    X'23'                                                    05883000
DEFALTTR DC    X'00010100'                                              05884000
DEFTTR   DC    X'0100'                                                  05885000
SEARCHCC DC    X'0000000003'                                            05886000
MAJNAME  DC    CL8'SYSZVOLS'                                            05887000
         DS    CL2                                                      05888000
MAJRNAM  DC    CL8'SYSZTIOT'                                            05889000
MAJNAME3 DC    CL8'SYSZVOLS'                                            05890000
MAJNAME1 DC    CL8'SYSZVOLS'                                            05891000
SMJRNAM  DC    CL8'SYSZTIOT'                                            05892000
JOBCAT   DC    CL8'JOBCAT  '                                            05893000
STEPCAT  DC    CL8'STEPCAT '                                            05894000
SSMODSS0 DC    CL3'SS0'                                                 05895000
SSMODCM0 DC    CL3'CM0'                                                 05896000
@DATD    DSECT                                                          05897000
*                                                         /*#Y30LB37*/  05898000
*                                                                       05899000
IDCSA06  CSECT                                                          05900000
         ENTRY IDCSAS6                                                  05901000
IDCSAS6  DC    A(@SIZDATD)                                              05902000
IDCSA06  CSECT                                                          05903000
*                                                         /*#Y30LB37*/  05904000
ENQCORE  DS   0F                                                        05905000
         ENQ  (MAJNAME,,E,6,SYSTEM),RET=USE,MF=L,TCB=0  USE VOL ENQ     05906000
ENQLEN   DC   A(*-ENQCORE)                                    @Y30LB37  05907000
DEQCORE  DS   0F                                                        05908000
         DEQ  (MAJNAME,,6,SYSTEM),RET=HAVE,MF=L,TCB=0   HAVE VOL DEQ    05909000
DEQLEN   DC   A(*-DEQCORE)                                    @Y30LB37  05910000
TENQCORE DS   0F                                                        05911000
         ENQ  (MAJNAME,,S,6,SYSTEM),RET=TEST,MF=L,TCB=0 SHARE VOL ENQ   05912000
TENQLEN  DC   A(*-TENQCORE)                                   @Y30LB37  05913000
@DATD    DSECT                                                          05914000
*                                                         /*#Y30LB37*/  05915000
ENQBEGIN DS   0F                                              #Y30LB37  05916000
ENQLIST  ENQ  (MAJNAME,,E,6,SYSTEM),RET=USE,MF=L,TCB=0  USE VOL ENQ     05917000
DEQBEGIN DS   0F                                              #Y30LB37  05918000
DEQLIST  DEQ  (MAJNAME,,6,SYSTEM),RET=HAVE,MF=L,TCB=0   HAVE VOL DEQ    05919000
TENQBEGN DS   0F                                              #Y30LB37  05920000
TENQLIST ENQ  (MAJNAME,,S,6,SYSTEM),RET=TEST,MF=L,TCB=0 SHARE VOL ENQ   05921000
IDCSA06  CSECT                                                          05922000
*                                                         /*@YD00175*/  05923000
ENQCORE3 DS   0F                                                        05924000
         ENQ  (MAJNAME3,,E,6,SYSTEM),RET=TEST,MF=L,TCB=0  TEST VOL ENQ  05925000
ENQLEN3  DC   A(*-ENQCORE3)                                   @YD00175  05926000
@DATD    DSECT                                                          05927000
*                                                         /*@YD00175*/  05928000
ENQBEGN3 DS   0F                                              @YD00175  05929000
ENQLIST3 ENQ  (MAJNAME3,,E,6,SYSTEM),RET=TEST,MF=L,TCB=0  TEST VOL ENQ  05930000
IDCSA06  CSECT                                                          05931000
*                                                         /*@YD00175*/  05932000
ENQCORE1 DS   0F                                                        05933000
         ENQ  (MAJNAME1,,E,6,SYSTEM),RET=CHNG,MF=L,TCB=0  CHNG VOL ENQ  05934000
ENQLEN1  DC   A(*-ENQCORE1)                                   @YD00175  05935000
@DATD    DSECT                                                          05936000
*                                                         /*@YD00175*/  05937000
ENQBEGN1 DS   0F                                              @YD00175  05938000
ENQLIST1 ENQ  (MAJNAME1,,E,6,SYSTEM),RET=CHNG,MF=L,TCB=0  CHNG VOL ENQ  05939000
@DATD    DSECT                                                          05940000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05941000
@ENDDATD EQU   *                                                        05942000
IDCSA06  CSECT                                                          05943000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05944000
@01      EQU   01                                                       05945000
@02      EQU   02                                                       05946000
@03      EQU   03                                                       05947000
@04      EQU   04                                                       05948000
@05      EQU   05                                                       05949000
@06      EQU   06                                                       05950000
@07      EQU   07                                                       05951000
@08      EQU   08                                                       05952000
@09      EQU   09                                                       05953000
@10      EQU   10                                                       05954000
@11      EQU   11                                                       05955000
@12      EQU   12                                                       05956000
@13      EQU   13                                                       05957000
@14      EQU   14                                                       05958000
@15      EQU   15                                                       05959000
ENTRYNUM EQU   @02                                                      05960000
COUNTI   EQU   @03                                                      05961000
TOTENTRY EQU   @04                                                      05962000
SELEDRC  EQU   @04                                                      05963000
SETEXRC  EQU   @04                                                      05964000
GETEXRC  EQU   @04                                                      05965000
FINDXRC  EQU   @04                                                      05966000
ENQDQRC  EQU   @04                                                      05967000
ISUEDRC  EQU   @04                                                      05968000
DEMNTRC  EQU   @04                                                      05969000
RDLABRC  EQU   @02                                                      05970000
ISUEMRC  EQU   @04                                                      05971000
MTVOLRC  EQU   @04                                                      05972000
MTCTLRC  EQU   @04                                                      05973000
MDSETRC  EQU   @04                                                      05974000
UPOSTRC  EQU   @04                                                      05975000
CHECKRC  EQU   @02                                                      05976000
SAVEDSAB EQU   @04                                                      05977000
QDBPTR   EQU   @03                                                      05978000
DSABPTR  EQU   @02                                                      05979000
ASCBPTR  EQU   @02                                                      05980000
TCBPTR   EQU   @02                                                      05981000
UCBPTR   EQU   @05                                                      05982000
TESTRC   EQU   @02                                                      05983000
RTNREG   EQU   @15                                                      05984000
REG1     EQU   @01                                                      05985000
REG13    EQU   @13                                                      05986000
REG14    EQU   @14                                                      05987000
REG15    EQU   @15                                                      05988000
ARR1     EQU   @01                                                      05989000
MDREG1   EQU   @01                                                      05990000
REG0     EQU   @00                                                      05991000
REG10    EQU   @10                                                      05992000
REG11    EQU   @11                                                      05993000
REG12    EQU   @12                                                      05994000
REG2     EQU   @02                                                      05995000
REG3     EQU   @03                                                      05996000
REG4     EQU   @04                                                      05997000
REG5     EQU   @05                                                      05998000
REG6     EQU   @06                                                      05999000
REG7     EQU   @07                                                      06000000
REG8     EQU   @08                                                      06001000
REG9     EQU   @09                                                      06002000
PSA      EQU   0                                                        06003000
FLCRNPSW EQU   PSA                                                      06004000
FLCROPSW EQU   PSA+8                                                    06005000
FLCICCW2 EQU   PSA+16                                                   06006000
PSAEEPSW EQU   PSA+132                                                  06007000
PSAESPSW EQU   PSA+136                                                  06008000
FLCSVILC EQU   PSAESPSW+1                                               06009000
PSAEPPSW EQU   PSA+140                                                  06010000
FLCPIILC EQU   PSAEPPSW+1                                               06011000
FLCPICOD EQU   PSAEPPSW+2                                               06012000
PSAPICOD EQU   FLCPICOD+1                                               06013000
FLCTEA   EQU   PSAEPPSW+4                                               06014000
FLCPER   EQU   PSA+152                                                  06015000
FLCMCLA  EQU   PSA+168                                                  06016000
FLCIOEL  EQU   FLCMCLA+4                                                06017000
FLCIOA   EQU   FLCMCLA+16                                               06018000
FLCFSA   EQU   FLCMCLA+80                                               06019000
PSAAOLD  EQU   PSA+548                                                  06020000
PSASUPER EQU   PSA+552                                                  06021000
PSASUP1  EQU   PSASUPER                                                 06022000
PSASUP2  EQU   PSASUPER+1                                               06023000
PSASUP3  EQU   PSASUPER+2                                               06024000
PSASUP4  EQU   PSASUPER+3                                               06025000
PSACLHT  EQU   PSA+640                                                  06026000
PSALKSA  EQU   PSA+696                                                  06027000
PSAHLHI  EQU   PSA+760                                                  06028000
PSADSSFL EQU   PSA+836                                                  06029000
PSADSSF1 EQU   PSADSSFL                                                 06030000
PSADSSF3 EQU   PSADSSFL+2                                               06031000
PSADSSF4 EQU   PSADSSFL+3                                               06032000
PSARSVT  EQU   PSA+896                                                  06033000
CVTPTR   EQU   16                                                       06034000
IDCSAEP0 EQU   0                                                        06035000
IDCSASS0 EQU   0                                                        06036000
IDCSANQ0 EQU   0                                                        06037000
IDCSADQ0 EQU   0                                                        06038000
IDCSASI0 EQU   0                                                        06039000
IDCSAWO0 EQU   0                                                        06040000
IDCSAST0 EQU   0                                                        06041000
TRACE1   EQU   0                                                        06042000
OLDERID1 EQU   TRACE1                                                   06043000
TRACE2   EQU   0                                                        06044000
OLDERID2 EQU   TRACE2                                                   06045000
NEWID2   EQU   TRACE2+95                                                06046000
NEWERID2 EQU   5                                                        06047000
CIRAGL   EQU   0                                                        06048000
CIRTYPE  EQU   CIRAGL                                                   06049000
ALLAGL   EQU   0                                                        06050000
ALLSTS   EQU   ALLAGL+24                                                06051000
ALLDSP   EQU   ALLAGL+25                                                06052000
ALLORG   EQU   ALLAGL+26                                                06053000
ALLOPT   EQU   ALLAGL+28                                                06054000
UNITABL  EQU   0                                                        06055000
UNITUCB  EQU   UNITABL                                                  06056000
UNITADR  EQU   UNITABL+4                                                06057000
@NM00010 EQU   UNITADR                                                  06058000
UNITSTAT EQU   UNITABL+6                                                06059000
IDCIOSI0 EQU   0                                                        06060000
IDCIO050 EQU   0                                                        06061000
IOCSTR   EQU   0                                                        06062000
IOCDSO   EQU   IOCSTR+16                                                06063000
IOCRFM   EQU   IOCSTR+17                                                06064000
IOCMAC   EQU   IOCSTR+18                                                06065000
IOCMAC2  EQU   IOCSTR+19                                                06066000
IOCCHP   EQU   IOCSTR+20                                                06067000
IOCMSG   EQU   IOCSTR+21                                                06068000
IOCRBA   EQU   IOCSTR+40                                                06069000
IOCTTR   EQU   IOCRBA                                                   06070000
IOCMEM   EQU   IOCSTR+44                                                06071000
IOCNWM   EQU   IOCSTR+48                                                06072000
OPNAGL   EQU   0                                                        06073000
OPNOPT   EQU   OPNAGL                                                   06074000
OPNRFM   EQU   OPNAGL+1                                                 06075000
OPNTYP   EQU   OPNAGL+2                                                 06076000
OPNMOD   EQU   OPNAGL+3                                                 06077000
OPNDEV   EQU   OPNAGL+24                                                06078000
OPNDSO   EQU   OPNAGL+41                                                06079000
OPNOPT2  EQU   OPNAGL+42                                                06080000
IOINFOPT EQU   0                                                        06081000
IOINFVOL EQU   IOINFOPT                                                 06082000
UVOLLIST EQU   0                                                        06083000
UVOLENT  EQU   UVOLLIST+2                                               06084000
AMSTP011 EQU   0                                                        06085000
DARGLIST EQU   0                                                        06086000
DARGDBP  EQU   DARGLIST                                                 06087000
DARGRETP EQU   DARGLIST+4                                               06088000
DARGSTID EQU   DARGLIST+8                                               06089000
DARGSMOD EQU   DARGSTID                                                 06090000
DARGSENT EQU   DARGSTID+3                                               06091000
DARGILP  EQU   DARGLIST+12                                              06092000
DARGCNT  EQU   DARGLIST+14                                              06093000
DARGRETL EQU   DARGLIST+16                                              06094000
DARGARY  EQU   DARGLIST+20                                              06095000
DARGINS  EQU   DARGARY                                                  06096000
DARGINL  EQU   DARGARY+2                                                06097000
DARGDTM  EQU   DARGARY+4                                                06098000
FMTLIST  EQU   0                                                        06099000
FMTFLGS  EQU   FMTLIST                                                  06100000
FMTSPF   EQU   FMTLIST+2                                                06101000
FMTRFNO  EQU   FMTSPF                                                   06102000
FMTILEN  EQU   FMTRFNO                                                  06103000
FMTIOFF  EQU   FMTLIST+4                                                06104000
FMTTRBC  EQU   FMTIOFF                                                  06105000
FMTSTO   EQU   FMTTRBC                                                  06106000
FMTOCOL  EQU   FMTLIST+6                                                06107000
FMTCNVF  EQU   FMTLIST+10                                               06108000
ERCNVTAB EQU   0                                                        06109000
ERTYPE   EQU   ERCNVTAB                                                 06110000
EROPER   EQU   ERCNVTAB+1                                               06111000
EROSOPER EQU   ERCNVTAB+2                                               06112000
IDCDB010 EQU   0                                                        06113000
DMPITM   EQU   0                                                        06114000
DMPARY   EQU   0                                                        06115000
SAHIST   EQU   0                                                        06116000
AUTOPTR  EQU   SAHIST+8                                                 06117000
SAHSTA   EQU   SAHIST+12                                                06118000
AUTOTBL  EQU   0                                                        06119000
AUTOARAY EQU   AUTOTBL                                                  06120000
CCMSG    EQU   0                                                        06121000
CMMSG    EQU   0                                                        06122000
CMVOLFLG EQU   CMMSG+6                                                  06123000
CTMSG    EQU   0                                                        06124000
CTARRAY  EQU   CTMSG+4                                                  06125000
MDAGL    EQU   0                                                        06126000
MDHEAD   EQU   MDAGL                                                    06127000
MDUCBPTR EQU   MDAGL+8                                                  06128000
MDDDNAME EQU   MDAGL+12                                                 06129000
MDPUAGL  EQU   MDAGL+20                                                 06130000
MDLABEL  EQU   MDAGL+24                                                 06131000
MDFLAGS  EQU   MDAGL+30                                                 06132000
MDNEWVOL EQU   MDFLAGS                                                  06133000
MDCLEAR  EQU   MDFLAGS                                                  06134000
MDPOST   EQU   MDFLAGS                                                  06135000
MDWAIT   EQU   MDFLAGS                                                  06136000
MDENQ    EQU   MDFLAGS                                                  06137000
MDDEQ    EQU   MDFLAGS                                                  06138000
MDFORCE  EQU   MDFLAGS                                                  06139000
MDVTOCTR EQU   MDFLAGS                                                  06140000
MDVTOC   EQU   MDAGL+32                                                 06141000
MDCC     EQU   MDVTOC                                                   06142000
MDHH     EQU   MDVTOC+2                                                 06143000
PUAGL    EQU   0                                                        06144000
PUHEAD   EQU   PUAGL                                                    06145000
PUUCBPTR EQU   PUAGL+8                                                  06146000
PUTTRPTR EQU   PUAGL+12                                                 06147000
PULABELP EQU   PUAGL+16                                                 06148000
CKAGL    EQU   0                                                        06149000
CKHEAD   EQU   CKAGL                                                    06150000
CKUCBPTR EQU   CKAGL+8                                                  06151000
CKDDNAME EQU   CKAGL+12                                                 06152000
CKDATYPE EQU   CKAGL+20                                                 06153000
CKFLAGS  EQU   CKAGL+28                                                 06154000
CKTESTVT EQU   CKFLAGS                                                  06155000
CKRETTYP EQU   CKFLAGS                                                  06156000
CKDMTABL EQU   CKFLAGS                                                  06157000
EXCLAGL  EQU   0                                                        06158000
EXCLUCBP EQU   EXCLAGL+8                                                06159000
EXCLDDP  EQU   EXCLAGL+12                                               06160000
EXCLVOL  EQU   EXCLAGL+16                                               06161000
EXCLFLAG EQU   EXCLAGL+22                                               06162000
EXCLMNT  EQU   EXCLFLAG                                                 06163000
EXOARG   EQU   0                                                        06164000
EXODDN   EQU   EXOARG+8                                                 06165000
EXOUCB   EQU   EXOARG+20                                                06166000
EXOCTLBK EQU   EXOARG+28                                                06167000
EXOPT    EQU   EXOARG+32                                                06168000
EXONEW   EQU   EXOPT                                                    06169000
EXFLG    EQU   EXOARG+33                                                06170000
EXGARG   EQU   0                                                        06171000
EXGCTLBK EQU   EXGARG+8                                                 06172000
EXGCCHH2 EQU   EXGARG+16                                                06173000
EXGRECNO EQU   EXGARG+20                                                06174000
EXGDATAP EQU   EXGARG+24                                                06175000
EXGKEYLN EQU   EXGARG+28                                                06176000
EXGDATAL EQU   EXGARG+30                                                06177000
EXPARG   EQU   0                                                        06178000
EXPDATA  EQU   EXPARG+12                                                06179000
EXPDATAB EQU   0                                                        06180000
EXPARRAY EQU   EXPDATAB+4                                               06181000
VS2AGL   EQU   0                                                        06182000
VSLABOPT EQU   VS2AGL+28                                                06183000
VS2MSG   EQU   VS2AGL+35                                                06184000
VS2RESOP EQU   VS2AGL+36                                                06185000
VS1AGL   EQU   0                                                        06186000
VSSECOPT EQU   VS1AGL+68                                                06187000
VSVTOPT  EQU   VS1AGL+69                                                06188000
VSCATOPT EQU   VS1AGL+70                                                06189000
VSRETURN EQU   VS1AGL+71                                                06190000
VSMSG    EQU   VS1AGL+72                                                06191000
VSRESOPT EQU   VS1AGL+73                                                06192000
RCTAGL   EQU   0                                                        06193000
RCTOPT   EQU   RCTAGL+8                                                 06194000
STAEPARM EQU   0                                                        06195000
STAVUCB  EQU   STAEPARM+8                                               06196000
STAVVOL  EQU   STAEPARM+12                                              06197000
STARUCB  EQU   STAEPARM+20                                              06198000
STARVOL  EQU   STAEPARM+24                                              06199000
STARTTR  EQU   STAEPARM+32                                              06200000
STATCB   EQU   STAEPARM+48                                              06201000
STARCVY  EQU   STAEPARM+52                                              06202000
STAVMNT  EQU   STARCVY                                                  06203000
STAVDMNT EQU   STARCVY                                                  06204000
STAVENQ  EQU   STARCVY                                                  06205000
STAVPOST EQU   STARCVY                                                  06206000
STACLEAR EQU   STARCVY                                                  06207000
STARETRY EQU   STAEPARM+53                                              06208000
STAVTTR  EQU   STAEPARM+54                                              06209000
VOLLABEL EQU   0                                                        06210000
VOLKEY   EQU   VOLLABEL                                                 06211000
VOLVTOC  EQU   VOLLABEL+15                                              06212000
SV82LIST EQU   0                                                        06213000
SV82CODE EQU   SV82LIST                                                 06214000
SV82UCBP EQU   SV82LIST+1                                               06215000
@NM00066 EQU   SV82LIST+4                                               06216000
SV82DCBP EQU   @NM00066                                                 06217000
SV82VOLP EQU   SV82DCBP                                                 06218000
SV82TTRP EQU   SV82LIST+8                                               06219000
@NM00067 EQU   SV82LIST+12                                              06220000
SV82WRKP EQU   @NM00067                                                 06221000
SRTAGL   EQU   0                                                        06222000
LCTINFO  EQU   0                                                        06223000
LCTFLAGS EQU   LCTINFO+32                                               06224000
UCTAGL   EQU   0                                                        06225000
UCTFLAGS EQU   UCTAGL+68                                                06226000
SELAGL   EQU   0                                                        06227000
SELUCBP  EQU   SELAGL+8                                                 06228000
SELDDNP  EQU   SELAGL+12                                                06229000
SELVOL   EQU   SELAGL+16                                                06230000
SELFLAGS EQU   SELAGL+22                                                06231000
DATESAGL EQU   0                                                        06232000
DATESOPT EQU   DATESAGL+20                                              06233000
VS3AGL   EQU   0                                                        06234000
VS3FLAGS EQU   VS3AGL+58                                                06235000
VSDVTOC  EQU   0                                                        06236000
VSDSTAT  EQU   0                                                        06237000
VSDSFLG1 EQU   VSDSTAT+16                                               06238000
VSDFLG2  EQU   VSDSTAT+17                                               06239000
VSDSCR   EQU   0                                                        06240000
VSDSCRFL EQU   VSDSCR+4                                                 06241000
VSDUSAGE EQU   0                                                        06242000
VSDDORG  EQU   VSDUSAGE+9                                               06243000
VSDALLOC EQU   VSDUSAGE+10                                              06244000
VSDUSEF  EQU   VSDUSAGE+11                                              06245000
VSDDSORG EQU   VSDUSAGE+16                                              06246000
VSDBLOCK EQU   0                                                        06247000
VSDSPACE EQU   VSDBLOCK+12                                              06248000
VSDARRAY EQU   VSDBLOCK+16                                              06249000
VSDVARY  EQU   VSDARRAY+48                                              06250000
UCB      EQU   0                                                        06251000
UCBOB    EQU   0                                                        06252000
UCBJBNR  EQU   UCBOB                                                    06253000
UCBFL5   EQU   UCBOB+1                                                  06254000
UCBAF    EQU   UCBFL5                                                   06255000
UCBSTAT  EQU   UCBOB+3                                                  06256000
UCBRESV  EQU   UCBSTAT                                                  06257000
UCBPRES  EQU   UCBSTAT                                                  06258000
UCBCHAN  EQU   UCBOB+4                                                  06259000
UCBSFLS  EQU   UCBOB+6                                                  06260000
UCBFLA   EQU   UCBSFLS                                                  06261000
UCBFL1   EQU   UCBFLA                                                   06262000
UCBBSY   EQU   UCBFL1                                                   06263000
UCBNRY   EQU   UCBFL1                                                   06264000
UCBNOTRD EQU   UCBNRY                                                   06265000
UCBPST   EQU   UCBFL1                                                   06266000
UCBCUB   EQU   UCBFL1                                                   06267000
UCBFLB   EQU   UCBSFLS+1                                                06268000
UCBCHM   EQU   UCBOB+8                                                  06269000
UCBCHM1  EQU   UCBCHM                                                   06270000
UCBPTH0  EQU   UCBCHM1                                                  06271000
UCBPTH1  EQU   UCBCHM1                                                  06272000
UCBWGT   EQU   UCBOB+12                                                 06273000
UCBNAME  EQU   UCBOB+13                                                 06274000
UCBTYP   EQU   UCBOB+16                                                 06275000
UCBTBYT1 EQU   UCBTYP                                                   06276000
UCB1FEA5 EQU   UCBTBYT1                                                 06277000
UCB1FEA6 EQU   UCBTBYT1                                                 06278000
UCBTBYT2 EQU   UCBTYP+1                                                 06279000
UCB2OPT2 EQU   UCBTBYT2                                                 06280000
UCBDUDN1 EQU   UCB2OPT2                                                 06281000
UCB2OPT3 EQU   UCBTBYT2                                                 06282000
UCBDUDN2 EQU   UCB2OPT3                                                 06283000
UCB2OPT4 EQU   UCBTBYT2                                                 06284000
UCBRWTAU EQU   UCB2OPT4                                                 06285000
UCBRVDEV EQU   UCBRWTAU                                                 06286000
UCB2OPT6 EQU   UCBTBYT2                                                 06287000
UCB2OPT7 EQU   UCBTBYT2                                                 06288000
UCBTBYT3 EQU   UCBTYP+2                                                 06289000
UCBDVCLS EQU   UCBTBYT3                                                 06290000
UCB3DACC EQU   UCBDVCLS                                                 06291000
UCBTBYT4 EQU   UCBTYP+3                                                 06292000
UCBUNTYP EQU   UCBTBYT4                                                 06293000
UCBEXTPT EQU   UCBOB+20                                                 06294000
UCBFLC   EQU   UCBEXTPT                                                 06295000
UCBDEV   EQU   UCBOB+24                                                 06296000
UCBCMEXT EQU   0                                                        06297000
UCBATI   EQU   UCBCMEXT+3                                               06298000
@NM00088 EQU   UCBATI                                                   06299000
UCBFLP1  EQU   UCBCMEXT+5                                               06300000
UCBMT    EQU   0                                                        06301000
UCBOCR   EQU   0                                                        06302000
UCB3540X EQU   0                                                        06303000
UCBDKBYT EQU   UCB3540X+6                                               06304000
UCB3800X EQU   0                                                        06305000
UCBOPTNS EQU   UCB3800X                                                 06306000
UCBACTIV EQU   UCB3800X+3                                               06307000
UCBMDRBF EQU   UCB3800X+36                                              06308000
UCBUCS   EQU   0                                                        06309000
UCBUCSOP EQU   UCBUCS+4                                                 06310000
UCBFCBOP EQU   UCBUCS+5                                                 06311000
TCBFIX   EQU   0                                                        06312000
TCBFRS   EQU   TCBFIX                                                   06313000
TCB      EQU   0                                                        06314000
TCBPIE   EQU   TCB+4                                                    06315000
TCBPMASK EQU   TCBPIE                                                   06316000
TCBCMP   EQU   TCB+16                                                   06317000
TCBCMPF  EQU   TCBCMP                                                   06318000
TCBCPP   EQU   TCBCMPF                                                  06319000
TCBSTCC  EQU   TCBCMPF                                                  06320000
TCBCDBL  EQU   TCBCMPF                                                  06321000
TCBCWTO  EQU   TCBCMPF                                                  06322000
TCBCIND  EQU   TCBCMPF                                                  06323000
TCBCMSG  EQU   TCBCMPF                                                  06324000
TCBTRN   EQU   TCB+20                                                   06325000
TCBABF   EQU   TCBTRN                                                   06326000
TCBMSS   EQU   TCB+24                                                   06327000
TCBPKF   EQU   TCB+28                                                   06328000
TCBFLGS  EQU   TCB+29                                                   06329000
TCBFLGS1 EQU   TCBFLGS                                                  06330000
TCBFLGS2 EQU   TCBFLGS+1                                                06331000
TCBFLGS3 EQU   TCBFLGS+2                                                06332000
TCBFLGS4 EQU   TCBFLGS+3                                                06333000
TCBFLGS5 EQU   TCBFLGS+4                                                06334000
TCBABWF  EQU   TCBFLGS5                                                 06335000
TCBJPQ   EQU   TCB+44                                                   06336000
TCBPURGE EQU   TCBJPQ                                                   06337000
TCBGRS   EQU   TCB+48                                                   06338000
TCBFSA   EQU   TCB+112                                                  06339000
TCBTME   EQU   TCB+120                                                  06340000
TCBJSTCB EQU   TCB+124                                                  06341000
TCBTSFLG EQU   TCB+148                                                  06342000
TCBTSTSK EQU   TCBTSFLG                                                 06343000
TCBSTAB  EQU   TCB+160                                                  06344000
TCBNSTAE EQU   TCBSTAB                                                  06345000
TCBTCT   EQU   TCB+164                                                  06346000
TCBTCTGF EQU   TCBTCT                                                   06347000
TCBSCNDY EQU   TCB+172                                                  06348000
TCBNDSP  EQU   TCBSCNDY                                                 06349000
TCBNDSP1 EQU   TCBNDSP+1                                                06350000
TCBNDSP2 EQU   TCBNDSP+2                                                06351000
TCBNDSP3 EQU   TCBNDSP+3                                                06352000
TCBJSCB  EQU   TCB+180                                                  06353000
TCBRECDE EQU   TCBJSCB                                                  06354000
TCBEXT1  EQU   TCB+196                                                  06355000
TCBBITS  EQU   TCB+200                                                  06356000
TCBNDSP4 EQU   TCBBITS                                                  06357000
TCBNDSP5 EQU   TCBBITS+1                                                06358000
TCBFLGS6 EQU   TCBBITS+2                                                06359000
TCBFLGS7 EQU   TCBBITS+3                                                06360000
TCBDAR   EQU   TCB+204                                                  06361000
TCBDARC  EQU   TCBDAR                                                   06362000
TCBEXT2  EQU   TCB+208                                                  06363000
TCBFOE   EQU   TCB+244                                                  06364000
TCBESTAE EQU   TCB+264                                                  06365000
TCBESTRM EQU   TCBESTAE+1                                               06366000
TCBFBYT1 EQU   TCB+276                                                  06367000
TCBFBYT2 EQU   TCB+277                                                  06368000
TCBRV124 EQU   TCB+278                                                  06369000
TCBRV133 EQU   TCB+279                                                  06370000
TCBXTNT2 EQU   0                                                        06371000
TCBGTF   EQU   TCBXTNT2                                                 06372000
TCBTFLG  EQU   TCBGTF                                                   06373000
TCBRV146 EQU   TCBXTNT2+28                                              06374000
TCBRV155 EQU   TCBXTNT2+29                                              06375000
TCBRV164 EQU   TCBXTNT2+30                                              06376000
TCBRV173 EQU   TCBXTNT2+31                                              06377000
IEZJSCB  EQU   0                                                        06378000
JSCBSEC1 EQU   IEZJSCB+188                                              06379000
JSCHPCE  EQU   JSCBSEC1+4                                               06380000
JSCBTCBP EQU   JSCBSEC1+20                                              06381000
JSCBDCB  EQU   JSCBSEC1+36                                              06382000
JSCBOPTS EQU   JSCBSEC1+48                                              06383000
JSCBSWT1 EQU   JSCBSEC1+55                                              06384000
JSCBWTP  EQU   JSCBSEC1+64                                              06385000
JSCBWTFG EQU   JSCBWTP                                                  06386000
JSCBEND1 EQU   IEZJSCB+260                                              06387000
ASCB     EQU   0                                                        06388000
ASCBASID EQU   ASCB+36                                                  06389000
ASCBFW1  EQU   ASCB+100                                                 06390000
ASCBRCTF EQU   ASCBFW1+2                                                06391000
ASCBFLG1 EQU   ASCBFW1+3                                                06392000
ASCBDSP1 EQU   ASCB+114                                                 06393000
ASCBFLG2 EQU   ASCB+115                                                 06394000
DSAB     EQU   0                                                        06395000
DSABFCHN EQU   DSAB+4                                                   06396000
DSABTIOT EQU   DSAB+16                                                  06397000
DSABGIDP EQU   DSAB+24                                                  06398000
DSABANMP EQU   DSAB+28                                                  06399000
DSABORG  EQU   DSAB+32                                                  06400000
DSABORG1 EQU   DSABORG                                                  06401000
DSABORG2 EQU   DSABORG+1                                                06402000
DSABFLG1 EQU   DSAB+34                                                  06403000
DSABFLG2 EQU   DSAB+35                                                  06404000
DSABFLG3 EQU   DSAB+36                                                  06405000
DSABCATL EQU   DSABFLG3                                                 06406000
DSABJSCT EQU   DSABFLG3                                                 06407000
DSABFLG4 EQU   DSAB+37                                                  06408000
DSABANMI EQU   0                                                        06409000
DSABGIDL EQU   0                                                        06410000
QDB      EQU   0                                                        06411000
QDBFELMP EQU   QDB+12                                                   06412000
TIOT1    EQU   0                                                        06413000
TIOENTRY EQU   0                                                        06414000
TIOELNGH EQU   TIOENTRY                                                 06415000
TIOESTTA EQU   TIOENTRY+1                                               06416000
TIOERLOC EQU   TIOENTRY+2                                               06417000
TIOELINK EQU   TIOERLOC+1                                               06418000
TIOESYOT EQU   TIOELINK                                                 06419000
TIOEDDNM EQU   TIOENTRY+4                                               06420000
TIOESTTC EQU   TIOENTRY+15                                              06421000
TIOESTTB EQU   TIOENTRY+16                                              06422000
TIOEFSRT EQU   TIOENTRY+17                                              06423000
POOLSTAR EQU   TIOENTRY+20                                              06424000
MDUCBADR EQU   0                                                        06425000
CKUCBADR EQU   0                                                        06426000
PUUCBADR EQU   0                                                        06427000
EXUCBADR EQU   0                                                        06428000
EXDDNAME EQU   0                                                        06429000
SLUCBADR EQU   0                                                        06430000
SLDDNAME EQU   0                                                        06431000
TCBWDSP  EQU   0                                                        06432000
TCBWORDS EQU   0                                                        06433000
CURTCBP  EQU   TCBWORDS+4                                               06434000
CKRVAREA EQU   0                                                        06435000
PURETVOL EQU   0                                                        06436000
PURETTTR EQU   0                                                        06437000
PUVOLRET EQU   0                                                        06438000
PUTTRRET EQU   0                                                        06439000
MNTLIST  EQU   0                                                        06440000
MDFLG    EQU   MNTLIST+6                                                06441000
MDVOL    EQU   MNTLIST+8                                                06442000
MDVUA    EQU   MNTLIST+14                                               06443000
MNTEXTP  EQU   MNTLIST+24                                               06444000
ACQLIST  EQU   0                                                        06445000
ARLL     EQU   ACQLIST                                                  06446000
AROP     EQU   ACQLIST+4                                                06447000
ARFLG    EQU   ACQLIST+6                                                06448000
ARDRES   EQU   ARFLG                                                    06449000
ARNMEXT  EQU   ACQLIST+7                                                06450000
ARVOL    EQU   ACQLIST+8                                                06451000
AREXT    EQU   ACQLIST+28                                               06452000
ARNEDB   EQU   ACQLIST+92                                               06453000
DMNTLIST EQU   0                                                        06454000
DMNTFLAG EQU   DMNTLIST+6                                               06455000
DMDELRSP EQU   DMNTFLAG                                                 06456000
DMVOL    EQU   DMNTLIST+8                                               06457000
TCODE    EQU   0                                                        06458000
TESTCODE EQU   TCODE+3                                                  06459000
AMSTP041 EQU   0                                                        06460000
AMSTP042 EQU   0                                                        06461000
AMSTP043 EQU   0                                                        06462000
AMSTP044 EQU   0                                                        06463000
DMPTRM   EQU   0                                                        06464000
IDCIOCL0 EQU   0                                                        06465000
IDCIOCO0 EQU   0                                                        06466000
IDCIOGT0 EQU   0                                                        06467000
IDCIOIT0 EQU   0                                                        06468000
IDCIOOP0 EQU   0                                                        06469000
IDCIOPO0 EQU   0                                                        06470000
IDCIOPT0 EQU   0                                                        06471000
IDCIOST0 EQU   0                                                        06472000
IDCIOTM0 EQU   0                                                        06473000
IDCIOVY0 EQU   0                                                        06474000
IDCSAAL0 EQU   0                                                        06475000
IDCSACA0 EQU   0                                                        06476000
IDCSACL0 EQU   0                                                        06477000
IDCSACR0 EQU   0                                                        06478000
IDCSADE0 EQU   0                                                        06479000
IDCSADL0 EQU   0                                                        06480000
IDCSAFP0 EQU   0                                                        06481000
IDCSAFS0 EQU   0                                                        06482000
IDCSAGP0 EQU   0                                                        06483000
IDCSAGS0 EQU   0                                                        06484000
IDCSAID0 EQU   0                                                        06485000
IDCSALC0 EQU   0                                                        06486000
IDCSALD0 EQU   0                                                        06487000
IDCSALK0 EQU   0                                                        06488000
IDCSAPR0 EQU   0                                                        06489000
IDCSAPT0 EQU   0                                                        06490000
IDCSAQL0 EQU   0                                                        06491000
IDCSARC0 EQU   0                                                        06492000
IDCSARV0 EQU   0                                                        06493000
IDCSASC0 EQU   0                                                        06494000
IDCSASN0 EQU   0                                                        06495000
IDCSATI0 EQU   0                                                        06496000
IDCSAUC0 EQU   0                                                        06497000
IDCSA060 EQU   0                                                        06498000
IDCST010 EQU   0                                                        06499000
IDCTPER0 EQU   0                                                        06500000
LISTTEST EQU   0                                                        06501000
NEWERID1 EQU   5                                                        06502000
PUVOLSER EQU   0                                                        06503000
UCBBGN   EQU   0                                                        06504000
GDTTBL   EQU   0                                                        06505000
GDTTR1   EQU   GDTTBL+8                                                 06506000
GDTTR2   EQU   GDTTBL+12                                                06507000
GDTSAH   EQU   GDTTBL+32                                                06508000
GDTDBG   EQU   GDTTBL+40                                                06509000
GDTSTC   EQU   GDTTBL+44                                                06510000
GDTPRT   EQU   GDTTBL+48                                                06511000
GDTESS   EQU   GDTTBL+52                                                06512000
GDTESA   EQU   GDTTBL+56                                                06513000
GDTRST   EQU   GDTTBL+60                                                06514000
GDTRES   EQU   GDTTBL+64                                                06515000
GDTCAL   EQU   GDTTBL+68                                                06516000
GDTGSP   EQU   GDTTBL+72                                                06517000
GDTFSP   EQU   GDTTBL+76                                                06518000
GDTGPL   EQU   GDTTBL+80                                                06519000
GDTFPL   EQU   GDTTBL+84                                                06520000
GDTLOD   EQU   GDTTBL+88                                                06521000
GDTDEL   EQU   GDTTBL+92                                                06522000
GDTPRL   EQU   GDTTBL+96                                                06523000
GDTEPL   EQU   GDTTBL+100                                               06524000
GDTTIM   EQU   GDTTBL+104                                               06525000
GDTIIO   EQU   GDTTBL+108                                               06526000
GDTTIO   EQU   GDTTBL+112                                               06527000
GDTOPN   EQU   GDTTBL+124                                               06528000
GDTCLS   EQU   GDTTBL+128                                               06529000
GDTGET   EQU   GDTTBL+132                                               06530000
GDTPUT   EQU   GDTTBL+136                                               06531000
GDTPOS   EQU   GDTTBL+140                                               06532000
GDTCPY   EQU   GDTTBL+144                                               06533000
GDTCAT   EQU   GDTTBL+148                                               06534000
GDTABT   EQU   GDTTBL+152                                               06535000
GDTABH   EQU   GDTTBL+156                                               06536000
GDTSNP   EQU   GDTTBL+164                                               06537000
GDTVFY   EQU   GDTTBL+172                                               06538000
GDTUID   EQU   GDTTBL+192                                               06539000
GDTPMT   EQU   GDTTBL+196                                               06540000
GDTCIR   EQU   GDTTBL+200                                               06541000
GDTLNK   EQU   GDTTBL+204                                               06542000
GDTALC   EQU   GDTTBL+208                                               06543000
GDTDLC   EQU   GDTTBL+212                                               06544000
GDTQAL   EQU   GDTTBL+216                                               06545000
GDTSTW   EQU   GDTTBL+220                                               06546000
GDTSSC   EQU   GDTTBL+224                                               06547000
GDTENQ   EQU   GDTTBL+228                                               06548000
GDTRSV   EQU   GDTTBL+232                                               06549000
GDTDEQ   EQU   GDTTBL+236                                               06550000
GDTSFO   EQU   GDTTBL+240                                               06551000
GDTWTO   EQU   GDTTBL+244                                               06552000
GDTSCR   EQU   GDTTBL+248                                               06553000
GDTUNT   EQU   GDTTBL+252                                               06554000
GDTRCT   EQU   GDTTBL+256                                               06555000
GDTIFO   EQU   GDTTBL+260                                               06556000
GDTEXP   EQU   GDTTBL+264                                               06557000
GDTSTA   EQU   GDTTBL+268                                               06558000
GDTERR   EQU   GDTTBL+272                                               06559000
GDTUNC   EQU   GDTTBL+276                                               06560000
GDTLOC   EQU   GDTTBL+280                                               06561000
REQUEST  EQU   0                                                        06562000
ARGLIST  EQU   0                                                        06563000
ARGNAME  EQU   ARGLIST                                                  06564000
CKAGLPTR EQU   0                                                        06565000
COMMAND  EQU   0                                                        06566000
PUAGLPTR EQU   0                                                        06567000
MDAGLPTR EQU   0                                                        06568000
MTAGLPTR EQU   0                                                        06569000
MTMDAGLP EQU   0                                                        06570000
IMMDAGLP EQU   0                                                        06571000
RDMDAGLP EQU   0                                                        06572000
DMAGLPTR EQU   0                                                        06573000
IDMDAGLP EQU   0                                                        06574000
ORDER    EQU   0                                                        06575000
EDAGLPTR EQU   0                                                        06576000
EXAGLPTR EQU   0                                                        06577000
SCAGLPTR EQU   0                                                        06578000
GXAGLPTR EQU   0                                                        06579000
SXAGLPTR EQU   0                                                        06580000
SLAGLPTR EQU   0                                                        06581000
SSAGLPTR EQU   0                                                        06582000
SSRCODE  EQU   0                                                        06583000
SSRHALF  EQU   SSRCODE+2                                                06584000
SSECBCD  EQU   0                                                        06585000
UCBOBS01 EQU   UCBDEV                                                   06586000
UCBVOLI  EQU   UCBOBS01+4                                               06587000
UCBSTAB  EQU   UCBOBS01+10                                              06588000
UCBBSVL  EQU   UCBSTAB                                                  06589000
UCBPRSRS EQU   UCBSTAB                                                  06590000
UCBDMCT  EQU   UCBOBS01+11                                              06591000
UCBFL4   EQU   UCBOBS01+13                                              06592000
UCBOBS02 EQU   UCBDEV                                                   06593000
UCBTFL1  EQU   UCBOBS02+19                                              06594000
UCBXTN   EQU   UCBOBS02+20                                              06595000
UCBVOPT  EQU   UCBXTN                                                   06596000
UCBOBS03 EQU   UCBDEV                                                   06597000
UCBXTADR EQU   UCBOBS03                                                 06598000
UCBOBS04 EQU   UCBDEV                                                   06599000
UCBBTA   EQU   UCBOBS04+12                                              06600000
UCBOBS06 EQU   UCBDEV                                                   06601000
UCBAOF   EQU   UCBOBS06                                                 06602000
UCBAOF1  EQU   UCBAOF                                                   06603000
UCBAOF2  EQU   UCBAOF+1                                                 06604000
@NM00087 EQU   UCBOBS06+3                                               06605000
UCBIRB   EQU   UCBOBS06+4                                               06606000
UCBGRAF  EQU   UCBIRB                                                   06607000
UCBLDNCA EQU   UCBOBS06+8                                               06608000
UCBRDYQ  EQU   UCBLDNCA                                                 06609000
UCBIRLN  EQU   UCBRDYQ                                                  06610000
UCBLDNCB EQU   UCBRDYQ+1                                                06611000
UCBCTLNK EQU   UCBOBS06+12                                              06612000
UCBOBS07 EQU   UCBDEV                                                   06613000
UCBOBS08 EQU   UCBDEV                                                   06614000
UCBCTCAD EQU   UCBOBS08                                                 06615000
UCBCTCF1 EQU   UCBOBS08+4                                               06616000
UCBOBS09 EQU   UCBDEV                                                   06617000
JSCBSEC2 EQU   JSCBEND1                                                 06618000
JSCBSEC3 EQU   JSCBEND1                                                 06619000
JSCBJCT  EQU   JSCBSEC3                                                 06620000
JSCBJCTA EQU   JSCBJCT+1                                                06621000
JSCBASID EQU   JSCBSEC3+8                                               06622000
JSCBFBYT EQU   JSCBSEC3+10                                              06623000
JSCBJNL  EQU   JSCBSEC3+28                                              06624000
JSCBJJSB EQU   JSCBJNL                                                  06625000
JSCBSUB  EQU   JSCBSEC3+40                                              06626000
JSCDSABQ EQU   JSCBSEC3+60                                              06627000
JSCSCT   EQU   JSCBSEC3+68                                              06628000
JSCRSV45 EQU   JSCBSEC3+112                                             06629000
JSCRSV46 EQU   JSCRSV45                                                 06630000
JSCRSV47 EQU   JSCRSV45+2                                               06631000
PSARSVTE EQU   PSARSVT                                                  06632000
TIOEDEVE EQU   TIOESTTB                                                 06633000
TIOSTTB  EQU   TIOEDEVE                                                 06634000
TIOUCBP  EQU   TIOEDEVE+1                                               06635000
FLC      EQU   PSA                                                      06636000
*                                      START UNREFERENCED COMPONENTS    06637000
TIOVERF  EQU   TIOSTTB                                                  06638000
TIOUNLD  EQU   TIOSTTB                                                  06639000
TIOMNTD  EQU   TIOSTTB                                                  06640000
TIOSETU  EQU   TIOSTTB                                                  06641000
TIOVLSR  EQU   TIOSTTB                                                  06642000
TIOPVIO  EQU   TIOSTTB                                                  06643000
TIOREQD  EQU   TIOSTTB                                                  06644000
TIOUSED  EQU   TIOSTTB                                                  06645000
PSARSAV  EQU   PSARSVTE+60                                              06646000
PSARSTK  EQU   PSARSVTE+56                                              06647000
PSAESAV3 EQU   PSARSVTE+52                                              06648000
PSAESTK3 EQU   PSARSVTE+48                                              06649000
PSAESAV2 EQU   PSARSVTE+44                                              06650000
PSAESTK2 EQU   PSARSVTE+40                                              06651000
PSAESAV1 EQU   PSARSVTE+36                                              06652000
PSAESTK1 EQU   PSARSVTE+32                                              06653000
PSAPSAV  EQU   PSARSVTE+28                                              06654000
PSAPSTK  EQU   PSARSVTE+24                                              06655000
PSAMSAV  EQU   PSARSVTE+20                                              06656000
PSAMSTK  EQU   PSARSVTE+16                                              06657000
PSASSAV  EQU   PSARSVTE+12                                              06658000
PSASSTK  EQU   PSARSVTE+8                                               06659000
PSANSTK  EQU   PSARSVTE+4                                               06660000
PSACSTK  EQU   PSARSVTE                                                 06661000
JSCBEND3 EQU   JSCBSEC3+120                                             06662000
JSCRSV52 EQU   JSCBSEC3+116                                             06663000
JSCRSV51 EQU   JSCRSV47+1                                               06664000
JSCRSV50 EQU   JSCRSV47                                                 06665000
JSCRSV49 EQU   JSCRSV46+1                                               06666000
JSCRSV48 EQU   JSCRSV46                                                 06667000
JSCRSV44 EQU   JSCBSEC3+108                                             06668000
JSCRSV43 EQU   JSCBSEC3+104                                             06669000
JSCRSV42 EQU   JSCBSEC3+100                                             06670000
JSCBASWA EQU   JSCBSEC3+96                                              06671000
JSCBUFPT EQU   JSCBSEC3+92                                              06672000
JSCBACT  EQU   JSCBSEC3+88                                              06673000
JSCBSWSP EQU   JSCBSEC3+87                                              06674000
JSCRSV33 EQU   JSCBSEC3+86                                              06675000
JSCDDNUM EQU   JSCBSEC3+84                                              06676000
JSCRSV53 EQU   JSCBSEC3+82                                              06677000
JSCDDNNO EQU   JSCBSEC3+80                                              06678000
JSCBVATA EQU   JSCBSEC3+76                                              06679000
JSCTMCOR EQU   JSCBSEC3+72                                              06680000
JSCSCTP  EQU   JSCSCT+1                                                 06681000
JSCRSV55 EQU   JSCSCT                                                   06682000
JSCRSV54 EQU   JSCBSEC3+64                                              06683000
JSCBSSIB EQU   JSCBSEC3+56                                              06684000
JSCBFRBA EQU   JSCBSEC3+48                                              06685000
JSCRSV28 EQU   JSCBSEC3+46                                              06686000
JSCBSONO EQU   JSCBSEC3+44                                              06687000
JSCBSUBA EQU   JSCBSUB+1                                                06688000
JSCRSV31 EQU   JSCBSUB                                                  06689000
JSCBSMLR EQU   JSCBSEC3+36                                              06690000
JSCBJNLR EQU   JSCBSEC3+32                                              06691000
JSCBJNLA EQU   JSCBJNL+1                                                06692000
JSCBJSBT EQU   JSCBJJSB                                                 06693000
JSCBJSBX EQU   JSCBJJSB                                                 06694000
JSCBJSBA EQU   JSCBJJSB                                                 06695000
JSCBJSBI EQU   JSCBJJSB                                                 06696000
@NM00096 EQU   JSCBJJSB                                                 06697000
JSCBJNLE EQU   JSCBJJSB                                                 06698000
JSCBJNLF EQU   JSCBJJSB                                                 06699000
JSCBJNLN EQU   JSCBJJSB                                                 06700000
@NM00095 EQU   JSCBSEC3+24                                              06701000
JSCBJRBA EQU   JSCBSEC3+16                                              06702000
JSCBIECB EQU   JSCBSEC3+12                                              06703000
JSCBRV08 EQU   JSCBSEC3+11                                              06704000
JSCBRV07 EQU   JSCBFBYT                                                 06705000
JSCBRV06 EQU   JSCBFBYT                                                 06706000
JSCBRV05 EQU   JSCBFBYT                                                 06707000
JSCBRV04 EQU   JSCBFBYT                                                 06708000
JSCBRV03 EQU   JSCBFBYT                                                 06709000
JSCBRV02 EQU   JSCBFBYT                                                 06710000
JSCBADSP EQU   JSCBFBYT                                                 06711000
JSCBRV01 EQU   JSCBFBYT                                                 06712000
JSCBTJID EQU   JSCBASID                                                 06713000
JSCBPSCB EQU   JSCBSEC3+4                                               06714000
JSCJCTP  EQU   JSCBJCTA                                                 06715000
JSCRSV24 EQU   JSCBJCT                                                  06716000
JSCBEND2 EQU   JSCBSEC2                                                 06717000
UCBRV066 EQU   UCBOBS09+4                                               06718000
UCBIOSBA EQU   UCBOBS09                                                 06719000
UCBRV042 EQU   UCBOBS08+5                                               06720000
UCBRV082 EQU   UCBCTCF1                                                 06721000
UCBRV081 EQU   UCBCTCF1                                                 06722000
UCBRV080 EQU   UCBCTCF1                                                 06723000
UCBRV079 EQU   UCBCTCF1                                                 06724000
UCBRV078 EQU   UCBCTCF1                                                 06725000
UCBRV077 EQU   UCBCTCF1                                                 06726000
UCBRV076 EQU   UCBCTCF1                                                 06727000
UCBCTC80 EQU   UCBCTCF1                                                 06728000
UCBCTCAL EQU   UCBCTCAD                                                 06729000
UCBICNCB EQU   UCBOBS07+4                                               06730000
UCBRV040 EQU   UCBOBS07                                                 06731000
UCBCTLNA EQU   UCBCTLNK+1                                               06732000
UCBRLN   EQU   UCBCTLNK                                                 06733000
UCBRDYQA EQU   UCBLDNCB                                                 06734000
UCBINRLN EQU   UCBIRLN                                                  06735000
UCBIRBA  EQU   UCBIRB+1                                                 06736000
UCBRV039 EQU   UCBGRAF                                                  06737000
UCBDWNR  EQU   UCBGRAF                                                  06738000
UCBRPND  EQU   UCBGRAF                                                  06739000
UCBUPM   EQU   UCBGRAF                                                  06740000
UCBBTAM  EQU   UCBGRAF                                                  06741000
UCBDRNO  EQU   UCBGRAF                                                  06742000
UCBDRO   EQU   UCBGRAF                                                  06743000
UCBOIP   EQU   UCBGRAF                                                  06744000
UCBATRCD EQU   @NM00087                                                 06745000
UCBSKPFG EQU   @NM00087                                                 06746000
UCBRIPND EQU   @NM00087                                                 06747000
UCBRTIAC EQU   @NM00087                                                 06748000
UCBRSV79 EQU   @NM00087                                                 06749000
UCBRSV78 EQU   @NM00087                                                 06750000
UCBRSV77 EQU   @NM00087                                                 06751000
UCBOLTEP EQU   @NM00087                                                 06752000
UCBATNCT EQU   UCBOBS06+2                                               06753000
UCBRSV76 EQU   UCBAOF2                                                  06754000
UCBRSV75 EQU   UCBAOF2                                                  06755000
UCBRSV74 EQU   UCBAOF2                                                  06756000
UCBRSV73 EQU   UCBAOF2                                                  06757000
UCBRSV72 EQU   UCBAOF2                                                  06758000
UCBRSV71 EQU   UCBAOF2                                                  06759000
UCBRSV70 EQU   UCBAOF2                                                  06760000
UCBRSV69 EQU   UCBAOF2                                                  06761000
UCBRSV68 EQU   UCBAOF1                                                  06762000
UCBRSV67 EQU   UCBAOF1                                                  06763000
UCBRSV66 EQU   UCBAOF1                                                  06764000
UCBRSV65 EQU   UCBAOF1                                                  06765000
UCBRSV64 EQU   UCBAOF1                                                  06766000
UCBOFNL  EQU   UCBAOF1                                                  06767000
UCBOFSP  EQU   UCBAOF1                                                  06768000
UCBOFMCR EQU   UCBAOF1                                                  06769000
UCBBTB   EQU   UCBBTA+1                                                 06770000
UCBDI    EQU   UCBBTA                                                   06771000
UCBSNS   EQU   UCBOBS04+8                                               06772000
UCBTEB   EQU   UCBOBS04+4                                               06773000
UCBGCB   EQU   UCBOBS04+3                                               06774000
UCBOPEN  EQU   UCBOBS04+2                                               06775000
UCBSTART EQU   UCBOBS04                                                 06776000
UCBXTNB  EQU   UCBXTN+1                                                 06777000
UCBRSV22 EQU   UCBVOPT                                                  06778000
UCBRSV21 EQU   UCBVOPT                                                  06779000
UCBRSV20 EQU   UCBVOPT                                                  06780000
UCBESVE  EQU   UCBVOPT                                                  06781000
UCBERPC  EQU   UCBVOPT                                                  06782000
UCBESVC  EQU   UCBVOPT                                                  06783000
UCBEVA   EQU   UCBVOPT                                                  06784000
UCBESV   EQU   UCBVOPT                                                  06785000
UCBRV009 EQU   UCBTFL1                                                  06786000
UCBRV008 EQU   UCBTFL1                                                  06787000
UCBRV007 EQU   UCBTFL1                                                  06788000
UCBRV006 EQU   UCBTFL1                                                  06789000
UCBRV005 EQU   UCBTFL1                                                  06790000
UCBRV038 EQU   UCBTFL1                                                  06791000
UCBNSLTP EQU   UCBTFL1                                                  06792000
UCBNLTP  EQU   UCBTFL1                                                  06793000
UCBRES1B EQU   UCBOBS02+18                                              06794000
UCBFSER  EQU   UCBOBS02+12                                              06795000
@NM00086 EQU   UCBOBS02+4                                               06796000
UCBFSEQ  EQU   UCBOBS02+2                                               06797000
UCBFSCT  EQU   UCBOBS02                                                 06798000
UCBNEXP  EQU   UCBOBS01+20                                              06799000
UCBBASE  EQU   UCBOBS01+16                                              06800000
UCBRES1A EQU   UCBOBS01+15                                              06801000
UCBUSER  EQU   UCBOBS01+14                                              06802000
UCBFL47  EQU   UCBFL4                                                   06803000
UCBFL46  EQU   UCBFL4                                                   06804000
UCBFL45  EQU   UCBFL4                                                   06805000
UCBRV065 EQU   UCBFL4                                                   06806000
UCBDSS   EQU   UCBFL4                                                   06807000
UCBRV028 EQU   UCBFL4                                                   06808000
UCBWDAV  EQU   UCBFL4                                                   06809000
UCBDAVV  EQU   UCBFL4                                                   06810000
UCBSQC   EQU   UCBOBS01+12                                              06811000
UCBDATP  EQU   UCBOBS01+12                                              06812000
UCBDMC   EQU   UCBDMCT                                                  06813000
UCBMOUNT EQU   UCBDMCT                                                  06814000
UCBBNUL  EQU   UCBSTAB                                                  06815000
UCBSHAR  EQU   UCBSTAB                                                  06816000
UCBBSTR  EQU   UCBSTAB                                                  06817000
UCBBPUB  EQU   UCBSTAB                                                  06818000
UCBBPRV  EQU   UCBSTAB                                                  06819000
UCBBALB  EQU   UCBPRSRS                                                 06820000
UCBPGFL  EQU   UCBSTAB                                                  06821000
UCBDVSHR EQU   UCBBSVL                                                  06822000
UCBVTOC  EQU   UCBOBS01                                                 06823000
@NM00145 EQU   SSRCODE                                                  06824000
@NM00128 EQU   ARGLIST+8                                                06825000
GDTECT   EQU   GDTTBL+188                                               06826000
GDTPSB   EQU   GDTTBL+184                                               06827000
GDTUPT   EQU   GDTTBL+180                                               06828000
GDTCMB   EQU   GDTTBL+176                                               06829000
GDTSPR   EQU   GDTTBL+168                                               06830000
@NM00001 EQU   GDTTBL+160                                               06831000
GDTTOH   EQU   GDTTBL+120                                               06832000
GDTRIP   EQU   GDTTBL+116                                               06833000
GDTIOH   EQU   GDTTBL+36                                                06834000
GDTTPH   EQU   GDTTBL+28                                                06835000
GDTRIH   EQU   GDTTBL+24                                                06836000
GDTSTH   EQU   GDTTBL+20                                                06837000
GDTDBH   EQU   GDTTBL+16                                                06838000
GDTPRM   EQU   GDTTBL+4                                                 06839000
GDTHDR   EQU   GDTTBL                                                   06840000
@NM00144 EQU   TCODE                                                    06841000
DMNTVUA  EQU   DMNTLIST+26                                              06842000
DMNTRES2 EQU   DMNTLIST+25                                              06843000
DMHOST   EQU   DMNTLIST+20                                              06844000
DMNTECB  EQU   DMNTLIST+16                                              06845000
DMNTASID EQU   DMNTLIST+14                                              06846000
DMBITRES EQU   DMNTFLAG                                                 06847000
DMVUAVAL EQU   DMNTFLAG                                                 06848000
DMBITRE1 EQU   DMNTFLAG                                                 06849000
DMNTRES1 EQU   DMNTLIST+5                                               06850000
DMOPCD   EQU   DMNTLIST+4                                               06851000
DMLEN    EQU   DMNTLIST                                                 06852000
@NM00142 EQU   AREXT                                                    06853000
ARCOMPC  EQU   ACQLIST+26                                               06854000
@NM00141 EQU   ACQLIST+25                                               06855000
ARHOST   EQU   ACQLIST+20                                               06856000
ARECB    EQU   ACQLIST+16                                               06857000
ARASID   EQU   ACQLIST+14                                               06858000
@NM00140 EQU   ARFLG                                                    06859000
ARINH    EQU   ARFLG                                                    06860000
ARBDUBD  EQU   ARFLG                                                    06861000
@NM00139 EQU   ACQLIST+5                                                06862000
MDJFCB   EQU   MNTEXTP                                                  06863000
@NM00138 EQU   MNTLIST+21                                               06864000
MDHOST   EQU   MNTLIST+16                                               06865000
@NM00137 EQU   MDFLG                                                    06866000
MDMEXT   EQU   MDFLG                                                    06867000
MDSRTCH  EQU   MDFLG                                                    06868000
MDVSVRQ  EQU   MDFLG                                                    06869000
MDVISMNT EQU   MDFLG                                                    06870000
@NM00136 EQU   MDFLG                                                    06871000
@NM00135 EQU   MNTLIST+5                                                06872000
MDOPCD   EQU   MNTLIST+4                                                06873000
MDLEN    EQU   MNTLIST                                                  06874000
OLDTCBP  EQU   TCBWORDS                                                 06875000
TIOTFEND EQU   POOLSTAR+16                                              06876000
TIOPSLOT EQU   POOLSTAR+13                                              06877000
TIOPSTTB EQU   POOLSTAR+12                                              06878000
TIOPPOOL EQU   POOLSTAR+4                                               06879000
TIOPNSRT EQU   POOLSTAR+3                                               06880000
@NM00127 EQU   POOLSTAR+2                                               06881000
TIOPNSLT EQU   POOLSTAR+1                                               06882000
@NM00126 EQU   POOLSTAR                                                 06883000
TIOSVERF EQU   TIOESTTB                                                 06884000
TIOSUNLD EQU   TIOESTTB                                                 06885000
TIOSMNTD EQU   TIOESTTB                                                 06886000
TIOSSETU EQU   TIOESTTB                                                 06887000
TIOSVLSR EQU   TIOESTTB                                                 06888000
TIOSPVIO EQU   TIOESTTB                                                 06889000
TIOSREQD EQU   TIOESTTB                                                 06890000
TIOSUSED EQU   TIOESTTB                                                 06891000
TIOSBALS EQU   TIOESTTC                                                 06892000
TIOSBALP EQU   TIOESTTC                                                 06893000
TIOSVOLS EQU   TIOESTTC                                                 06894000
TIOSVOLP EQU   TIOESTTC                                                 06895000
TIOSAFFS EQU   TIOESTTC                                                 06896000
TIOSAFFP EQU   TIOESTTC                                                 06897000
TIOSDEFR EQU   TIOESTTC                                                 06898000
TIOSDKCR EQU   TIOESTTC                                                 06899000
TIOEJFCB EQU   TIOENTRY+12                                              06900000
TIOTREM  EQU   TIOELINK                                                 06901000
TIOESSDS EQU   TIOESYOT                                                 06902000
TIOESYIN EQU   TIOELINK                                                 06903000
TIOEQNAM EQU   TIOELINK                                                 06904000
TIOEDYNM EQU   TIOELINK                                                 06905000
TIOTTERM EQU   TIOELINK                                                 06906000
TIOTRV01 EQU   TIOELINK                                                 06907000
TIOSYOUT EQU   TIOELINK                                                 06908000
TIOEWTCT EQU   TIOERLOC                                                 06909000
TIOSDSP2 EQU   TIOESTTA                                                 06910000
TIOSDSP1 EQU   TIOESTTA                                                 06911000
TIOSLABL EQU   TIOESTTA                                                 06912000
TIOSDADS EQU   TIOESTTA                                                 06913000
TIOSJBLB EQU   TIOESTTA                                                 06914000
TIOSPLTS EQU   TIOESTTA                                                 06915000
TIOSPLTP EQU   TIOESTTA                                                 06916000
TIOSLTYP EQU   TIOESTTA                                                 06917000
TIOCSTEP EQU   TIOT1+8                                                  06918000
TIOCNJOB EQU   TIOT1                                                    06919000
QDBRV002 EQU   QDB+28                                                   06920000
QDBPRDS  EQU   QDB+26                                                   06921000
QDBPRSZ  EQU   QDB+24                                                   06922000
QDBBPTDS EQU   QDB+22                                                   06923000
QDBFPTDS EQU   QDB+20                                                   06924000
QDBLELMP EQU   QDB+16                                                   06925000
QDBNELMS EQU   QDB+8                                                    06926000
QDBRV001 EQU   QDB+6                                                    06927000
QDBATTR  EQU   QDB+4                                                    06928000
QDBQDB   EQU   QDB                                                      06929000
DSABGRID EQU   DSABGIDL+4                                               06930000
DSABLLEN EQU   DSABGIDL                                                 06931000
DSABANAM EQU   DSABANMI+1                                               06932000
DSABANML EQU   DSABANMI                                                 06933000
DSABRS04 EQU   DSAB+68                                                  06934000
DSABSIOT EQU   DSAB+64                                                  06935000
DSABRS03 EQU   DSAB+62                                                  06936000
DSABDCBM EQU   DSAB+56                                                  06937000
DSABSSCM EQU   DSAB+52                                                  06938000
DSABSSNM EQU   DSAB+48                                                  06939000
DSABPTTR EQU   DSAB+44                                                  06940000
DSABTCBP EQU   DSAB+40                                                  06941000
DSABRS02 EQU   DSAB+38                                                  06942000
@NM00125 EQU   DSABFLG4                                                 06943000
DSABCKSI EQU   DSABFLG4                                                 06944000
DSABCKVL EQU   DSABFLG4                                                 06945000
DSABCKDS EQU   DSABFLG4                                                 06946000
@NM00124 EQU   DSABFLG3                                                 06947000
DSABVMSC EQU   DSABFLG3                                                 06948000
DSABVAM  EQU   DSABFLG3                                                 06949000
DSABPASS EQU   DSABFLG3                                                 06950000
DSABDEFR EQU   DSABFLG3                                                 06951000
@NM00123 EQU   DSABFLG2                                                 06952000
DSABUNAL EQU   DSABFLG2                                                 06953000
DSABIRM  EQU   DSABFLG2                                                 06954000
DSABOPEN EQU   DSABFLG2                                                 06955000
DSABNUSE EQU   DSABFLG1                                                 06956000
DSABCATM EQU   DSABFLG1                                                 06957000
DSABPCAT EQU   DSABFLG1                                                 06958000
DSABDCAT EQU   DSABFLG1                                                 06959000
DSABCONV EQU   DSABFLG1                                                 06960000
DSABDCNV EQU   DSABFLG1                                                 06961000
DSABPALC EQU   DSABFLG1                                                 06962000
DSABDALC EQU   DSABFLG1                                                 06963000
@NM00122 EQU   DSABORG2                                                 06964000
DSABTR   EQU   DSABORG2                                                 06965000
DSABAM   EQU   DSABORG2                                                 06966000
@NM00121 EQU   DSABORG2                                                 06967000
DSABTQ   EQU   DSABORG2                                                 06968000
DSABTX   EQU   DSABORG2                                                 06969000
DSABGS   EQU   DSABORG2                                                 06970000
DSABU    EQU   DSABORG1                                                 06971000
DSABPO   EQU   DSABORG1                                                 06972000
DSABMQ   EQU   DSABORG1                                                 06973000
DSABCQ   EQU   DSABORG1                                                 06974000
DSABCX   EQU   DSABORG1                                                 06975000
DSABDA   EQU   DSABORG1                                                 06976000
DSABPS   EQU   DSABORG1                                                 06977000
DSABIS   EQU   DSABORG1                                                 06978000
DSABSSVA EQU   DSAB+21                                                  06979000
DSABRS01 EQU   DSAB+20                                                  06980000
DSABOPCT EQU   DSAB+14                                                  06981000
DSABLNTH EQU   DSAB+12                                                  06982000
DSABBCHN EQU   DSAB+8                                                   06983000
DSABID   EQU   DSAB                                                     06984000
ASCBEND  EQU   ASCB+208                                                 06985000
ASCBSRBT EQU   ASCB+200                                                 06986000
ASCBSWTL EQU   ASCB+196                                                 06987000
ASCBRS14 EQU   ASCB+195                                                 06988000
ASCBSMCT EQU   ASCB+194                                                 06989000
ASCBRS12 EQU   ASCB+192                                                 06990000
ASCBPCTT EQU   ASCB+188                                                 06991000
ASCBVGTT EQU   ASCB+184                                                 06992000
ASCBLGCB EQU   ASCB+180                                                 06993000
ASCBJBNS EQU   ASCB+176                                                 06994000
ASCBJBNI EQU   ASCB+172                                                 06995000
ASCBMCC  EQU   ASCB+168                                                 06996000
ASCBRTWA EQU   ASCB+164                                                 06997000
ASCBIQEA EQU   ASCB+160                                                 06998000
ASCBXMPQ EQU   ASCB+156                                                 06999000
ASCBRS01 EQU   ASCB+154                                                 07000000
ASCBFMCT EQU   ASCB+152                                                 07001000
ASCBOUXB EQU   ASCB+148                                                 07002000
ASCBOUCB EQU   ASCB+144                                                 07003000
ASCBMECB EQU   ASCB+140                                                 07004000
ASCBQECB EQU   ASCB+136                                                 07005000
ASCBCMSB EQU   ASCB+132                                                 07006000
ASCBCMSF EQU   ASCB+128                                                 07007000
ASCBTCBS EQU   ASCB+124                                                 07008000
ASCBNVSC EQU   ASCB+122                                                 07009000
ASCBVSC  EQU   ASCB+120                                                 07010000
ASCBSRBS EQU   ASCB+118                                                 07011000
ASCBSSRB EQU   ASCB+116                                                 07012000
ASCBRV06 EQU   ASCBFLG2                                                 07013000
ASCBRV05 EQU   ASCBFLG2                                                 07014000
ASCBRV04 EQU   ASCBFLG2                                                 07015000
ASCBSNQS EQU   ASCBFLG2                                                 07016000
ASCBS2S  EQU   ASCBFLG2                                                 07017000
ASCBCEXT EQU   ASCBFLG2                                                 07018000
ASCBPXMT EQU   ASCBFLG2                                                 07019000
ASCBXMPT EQU   ASCBFLG2                                                 07020000
ASCBRF07 EQU   ASCBDSP1                                                 07021000
ASCBRF06 EQU   ASCBDSP1                                                 07022000
ASCBRF05 EQU   ASCBDSP1                                                 07023000
ASCBRF04 EQU   ASCBDSP1                                                 07024000
ASCBRF03 EQU   ASCBDSP1                                                 07025000
ASCBRF02 EQU   ASCBDSP1                                                 07026000
ASCBFAIL EQU   ASCBDSP1                                                 07027000
ASCBNOQ  EQU   ASCBDSP1                                                 07028000
ASCBSWCT EQU   ASCB+112                                                 07029000
ASCBASXB EQU   ASCB+108                                                 07030000
ASCBTMCH EQU   ASCB+104                                                 07031000
ASCBNSWP EQU   ASCBFLG1                                                 07032000
ASCBTYP1 EQU   ASCBFLG1                                                 07033000
ASCBSTND EQU   ASCBFLG1                                                 07034000
ASCBABNT EQU   ASCBFLG1                                                 07035000
ASCBTERM EQU   ASCBFLG1                                                 07036000
ASCBS3S  EQU   ASCBFLG1                                                 07037000
ASCBCMSH EQU   ASCBFLG1                                                 07038000
ASCBTOFF EQU   ASCBFLG1                                                 07039000
ASCBRF01 EQU   ASCBRCTF                                                 07040000
ASCBTMLW EQU   ASCBRCTF                                                 07041000
ASCBOUT  EQU   ASCBRCTF                                                 07042000
ASCBWAIT EQU   ASCBRCTF                                                 07043000
ASCBRV08 EQU   ASCBRCTF                                                 07044000
ASCBFQU  EQU   ASCBRCTF                                                 07045000
ASCBFRS  EQU   ASCBRCTF                                                 07046000
ASCBTMNO EQU   ASCBRCTF                                                 07047000
ASCBAFFN EQU   ASCBFW1                                                  07048000
ASCBDUMP EQU   ASCB+96                                                  07049000
ASCBQSVC EQU   ASCB+92                                                  07050000
ASCBUBET EQU   ASCB+88                                                  07051000
ASCBECB  EQU   ASCB+84                                                  07052000
ASCBJSTL EQU   ASCB+80                                                  07053000
ASCBEWST EQU   ASCB+72                                                  07054000
ASCBEJST EQU   ASCB+64                                                  07055000
ASCBTSB  EQU   ASCB+60                                                  07056000
ASCBCSCB EQU   ASCB+56                                                  07057000
ASCBRSM  EQU   ASCB+52                                                  07058000
ASCBLDA  EQU   ASCB+48                                                  07059000
ASCBSTOR EQU   ASCB+44                                                  07060000
ASCBDP   EQU   ASCB+43                                                  07061000
ASCBRV07 EQU   ASCB+42                                                  07062000
ASCBIOSM EQU   ASCB+40                                                  07063000
ASCBSEQN EQU   ASCB+38                                                  07064000
ASCBCPUS EQU   ASCB+32                                                  07065000
ASCBSPL  EQU   ASCB+28                                                  07066000
ASCBLSLQ EQU   ASCB+24                                                  07067000
ASCBFSLQ EQU   ASCB+20                                                  07068000
ASCBIOSP EQU   ASCB+16                                                  07069000
ASCBLOCK EQU   ASCB+12                                                  07070000
ASCBBWDP EQU   ASCB+8                                                   07071000
ASCBFWDP EQU   ASCB+4                                                   07072000
ASCBASCB EQU   ASCB                                                     07073000
ASCBEGIN EQU   ASCB                                                     07074000
JSCBCSCB EQU   JSCBSEC1+68                                              07075000
JSCBPMG  EQU   JSCBWTP+2                                                07076000
JSCBWTSP EQU   JSCBWTP+1                                                07077000
JSCRSV23 EQU   JSCBWTFG                                                 07078000
JSCRSV22 EQU   JSCBWTFG                                                 07079000
JSCRSV21 EQU   JSCBWTFG                                                 07080000
JSCRSV20 EQU   JSCBWTFG                                                 07081000
JSCRSV19 EQU   JSCBWTFG                                                 07082000
JSCRSV18 EQU   JSCBWTFG                                                 07083000
JSCBRET  EQU   JSCBWTFG                                                 07084000
JSCBIOFG EQU   JSCBWTFG                                                 07085000
@NM00094 EQU   JSCBSEC1+60                                              07086000
JSCBQMPI EQU   JSCBSEC1+56                                              07087000
JSCBPMSG EQU   JSCBSWT1                                                 07088000
JSCRSV16 EQU   JSCBSWT1                                                 07089000
JSCRSV15 EQU   JSCBSWT1                                                 07090000
JSCRSV14 EQU   JSCBSWT1                                                 07091000
JSCRSV13 EQU   JSCBSWT1                                                 07092000
JSCRSV12 EQU   JSCBSWT1                                                 07093000
JSCRSV11 EQU   JSCBSWT1                                                 07094000
JSCBPASS EQU   JSCBSWT1                                                 07095000
JSCBTTTR EQU   JSCBSEC1+52                                              07096000
JSCRSV10 EQU   JSCBSEC1+49                                              07097000
JSCBAUTH EQU   JSCBOPTS                                                 07098000
JSCSIOTS EQU   JSCBOPTS                                                 07099000
JSCRSV08 EQU   JSCBOPTS                                                 07100000
JSCRSV07 EQU   JSCBOPTS                                                 07101000
JSCRSV06 EQU   JSCBOPTS                                                 07102000
JSCBLONG EQU   JSCBOPTS                                                 07103000
JSCRSV05 EQU   JSCBOPTS                                                 07104000
JSCRSV04 EQU   JSCBOPTS                                                 07105000
JSCBSECB EQU   JSCBSEC1+44                                              07106000
JSCRSV03 EQU   JSCBSEC1+41                                              07107000
JSCBSTEP EQU   JSCBSEC1+40                                              07108000
JSCBDCBA EQU   JSCBDCB+1                                                07109000
JSCRSV02 EQU   JSCBDCB                                                  07110000
JSCBID   EQU   JSCBSEC1+32                                              07111000
JSCBDBTB EQU   JSCBSEC1+28                                              07112000
JSCBIJSC EQU   JSCBSEC1+24                                              07113000
JSCBPCC  EQU   JSCBSEC1+16                                              07114000
JSCBTCP  EQU   JSCBSEC1+12                                              07115000
JSCBSHR  EQU   JSCBSEC1+8                                               07116000
JSCHPCEA EQU   JSCHPCE+1                                                07117000
JSCRSV32 EQU   JSCHPCE                                                  07118000
JSCRSV01 EQU   JSCBSEC1                                                 07119000
@NM00093 EQU   IEZJSCB                                                  07120000
@NM00092 EQU   TCBXTNT2+32                                              07121000
TCBRV181 EQU   TCBRV173                                                 07122000
TCBRV180 EQU   TCBRV173                                                 07123000
TCBRV179 EQU   TCBRV173                                                 07124000
TCBRV178 EQU   TCBRV173                                                 07125000
TCBRV177 EQU   TCBRV173                                                 07126000
TCBRV176 EQU   TCBRV173                                                 07127000
TCBRV175 EQU   TCBRV173                                                 07128000
TCBRV174 EQU   TCBRV173                                                 07129000
TCBRV172 EQU   TCBRV164                                                 07130000
TCBRV171 EQU   TCBRV164                                                 07131000
TCBRV170 EQU   TCBRV164                                                 07132000
TCBRV169 EQU   TCBRV164                                                 07133000
TCBRV168 EQU   TCBRV164                                                 07134000
TCBRV167 EQU   TCBRV164                                                 07135000
TCBRV166 EQU   TCBRV164                                                 07136000
TCBRV165 EQU   TCBRV164                                                 07137000
TCBRV163 EQU   TCBRV155                                                 07138000
TCBRV162 EQU   TCBRV155                                                 07139000
TCBRV161 EQU   TCBRV155                                                 07140000
TCBRV160 EQU   TCBRV155                                                 07141000
TCBRV159 EQU   TCBRV155                                                 07142000
TCBRV158 EQU   TCBRV155                                                 07143000
TCBRV157 EQU   TCBRV155                                                 07144000
TCBRV156 EQU   TCBRV155                                                 07145000
TCBRV154 EQU   TCBRV146                                                 07146000
TCBRV153 EQU   TCBRV146                                                 07147000
TCBRV152 EQU   TCBRV146                                                 07148000
TCBRV151 EQU   TCBRV146                                                 07149000
TCBRV150 EQU   TCBRV146                                                 07150000
TCBRV149 EQU   TCBRV146                                                 07151000
TCBRV148 EQU   TCBRV146                                                 07152000
TCBRV147 EQU   TCBRV146                                                 07153000
TCBRV145 EQU   TCBXTNT2+26                                              07154000
TCBRV144 EQU   TCBXTNT2+24                                              07155000
TCBRV143 EQU   TCBXTNT2+20                                              07156000
TCBRV142 EQU   TCBXTNT2+16                                              07157000
TCBRSV49 EQU   TCBXTNT2+12                                              07158000
TCBEVENT EQU   TCBXTNT2+8                                               07159000
TCBRCMP  EQU   TCBXTNT2+5                                               07160000
TCBRSVAB EQU   TCBXTNT2+4                                               07161000
TCBGTFA  EQU   TCBGTF+1                                                 07162000
TCBRSV47 EQU   TCBTFLG                                                  07163000
TCBRSV46 EQU   TCBTFLG                                                  07164000
TCBRSV45 EQU   TCBTFLG                                                  07165000
TCBRSV44 EQU   TCBTFLG                                                  07166000
TCBRSV43 EQU   TCBTFLG                                                  07167000
TCBDSPIT EQU   TCBTFLG                                                  07168000
TCBERRTN EQU   TCBTFLG                                                  07169000
TCBASYNC EQU   TCBTFLG                                                  07170000
@NM00091 EQU   TCB+296                                                  07171000
TCBSVCA2 EQU   TCB+292                                                  07172000
TCBSWASA EQU   TCB+288                                                  07173000
TCBDBTB  EQU   TCB+284                                                  07174000
TCBRPT   EQU   TCB+280                                                  07175000
TCBRV141 EQU   TCBRV133                                                 07176000
TCBRV140 EQU   TCBRV133                                                 07177000
TCBRV139 EQU   TCBRV133                                                 07178000
TCBRV138 EQU   TCBRV133                                                 07179000
TCBRV137 EQU   TCBRV133                                                 07180000
TCBRV136 EQU   TCBRV133                                                 07181000
TCBRV135 EQU   TCBRV133                                                 07182000
TCBRV134 EQU   TCBRV133                                                 07183000
TCBRV132 EQU   TCBRV124                                                 07184000
TCBRV131 EQU   TCBRV124                                                 07185000
TCBRV130 EQU   TCBRV124                                                 07186000
TCBRV129 EQU   TCBRV124                                                 07187000
TCBRV128 EQU   TCBRV124                                                 07188000
TCBRV127 EQU   TCBRV124                                                 07189000
TCBRV126 EQU   TCBRV124                                                 07190000
TCBRV125 EQU   TCBRV124                                                 07191000
TCBRV123 EQU   TCBFBYT2                                                 07192000
TCBRV122 EQU   TCBFBYT2                                                 07193000
TCBECBNV EQU   TCBFBYT2                                                 07194000
TCBSSSYN EQU   TCBFBYT2                                                 07195000
TCBFPRAP EQU   TCBFBYT2                                                 07196000
TCBFDW   EQU   TCBFBYT2                                                 07197000
TCBFMW   EQU   TCBFBYT2                                                 07198000
TCBCNCB  EQU   TCBFBYT2                                                 07199000
TCBLLH   EQU   TCBFBYT1                                                 07200000
TCBRV113 EQU   TCBFBYT1                                                 07201000
TCBEOT   EQU   TCBFBYT1                                                 07202000
TCBRTM2  EQU   TCBFBYT1                                                 07203000
TCBPGNLY EQU   TCBFBYT1                                                 07204000
TCBNDIOS EQU   TCBFBYT1                                                 07205000
TCBACTIV EQU   TCBFBYT1                                                 07206000
TCBEOTFM EQU   TCBFBYT1                                                 07207000
TCBAFFN  EQU   TCB+274                                                  07208000
TCBCCPVI EQU   TCB+272                                                  07209000
TCBUKYSP EQU   TCB+268                                                  07210000
TCBMODE  EQU   TCBESTAE+3                                               07211000
TCBERTYP EQU   TCBESTAE+2                                               07212000
TCBRV314 EQU   TCBESTRM                                                 07213000
TCBRV313 EQU   TCBESTRM                                                 07214000
TCBRV312 EQU   TCBESTRM                                                 07215000
TCBRV311 EQU   TCBESTRM                                                 07216000
TCBRV310 EQU   TCBESTRM                                                 07217000
TCBRV309 EQU   TCBESTRM                                                 07218000
TCBRV308 EQU   TCBESTRM                                                 07219000
TCBETERM EQU   TCBESTRM                                                 07220000
TCBSCBKY EQU   TCBESTAE                                                 07221000
TCBRTM12 EQU   TCB+260                                                  07222000
TCBTCBID EQU   TCB+256                                                  07223000
TCBRSV96 EQU   TCB+252                                                  07224000
TCBSWA   EQU   TCB+248                                                  07225000
TCBFOEA  EQU   TCBFOE+1                                                 07226000
TCBRSV42 EQU   TCBFOE                                                   07227000
TCBRV306 EQU   TCB+240                                                  07228000
TCBRSV41 EQU   TCB+239                                                  07229000
TCBTID   EQU   TCB+238                                                  07230000
TCBRSVAA EQU   TCB+237                                                  07231000
TCBABCUR EQU   TCB+236                                                  07232000
TCBTMSAV EQU   TCB+232                                                  07233000
TCBIOTIM EQU   TCB+228                                                  07234000
TCBRTWA  EQU   TCB+224                                                  07235000
TCBBACK  EQU   TCB+220                                                  07236000
TCBTIRB  EQU   TCB+216                                                  07237000
TCBAECB  EQU   TCB+212                                                  07238000
TCBEXT2A EQU   TCBEXT2+1                                                07239000
TCBRSV39 EQU   TCBEXT2                                                  07240000
TCBSTMCT EQU   TCB+207                                                  07241000
TCBSYSCT EQU   TCB+206                                                  07242000
TCBRSV37 EQU   TCB+205                                                  07243000
TCBEXSVC EQU   TCBDAR                                                   07244000
TCBDARMS EQU   TCBDAR                                                   07245000
TCBDARWT EQU   TCBDAR                                                   07246000
TCBDARO  EQU   TCBDAR                                                   07247000
TCBDARMC EQU   TCBDARC                                                  07248000
TCBDARD  EQU   TCBDAR                                                   07249000
TCBDARS  EQU   TCBDAR                                                   07250000
TCBDARP  EQU   TCBDAR                                                   07251000
TCBGTOFM EQU   TCBFLGS7                                                 07252000
TCBADMP  EQU   TCBFLGS7                                                 07253000
TCBRSTSK EQU   TCBFLGS7                                                 07254000
TCBSVCS  EQU   TCBFLGS7                                                 07255000
TCBSTACK EQU   TCBFLGS7                                                 07256000
TCBRSV34 EQU   TCBFLGS7                                                 07257000
TCBRSV33 EQU   TCBFLGS7                                                 07258000
TCBGPECB EQU   TCBFLGS7                                                 07259000
TCBNTJS  EQU   TCBFLGS6                                                 07260000
TCBAPG   EQU   TCBFLGS6                                                 07261000
TCBMIGR  EQU   TCBFLGS6                                                 07262000
TCBRV303 EQU   TCBFLGS6                                                 07263000
TCBSPVLK EQU   TCBFLGS6                                                 07264000
TCBCPU   EQU   TCBFLGS6                                                 07265000
TCBPIE17 EQU   TCBFLGS6                                                 07266000
TCBRV    EQU   TCBFLGS6                                                 07267000
TCBRSV79 EQU   TCBNDSP5                                                 07268000
TCBRSV78 EQU   TCBNDSP5                                                 07269000
TCBRSV77 EQU   TCBNDSP5                                                 07270000
TCBRSV76 EQU   TCBNDSP5                                                 07271000
TCBRSV75 EQU   TCBNDSP5                                                 07272000
TCBRSV74 EQU   TCBNDSP5                                                 07273000
TCBRSV95 EQU   TCBNDSP5                                                 07274000
TCBRSV94 EQU   TCBNDSP5                                                 07275000
TCBRSV93 EQU   TCBNDSP4                                                 07276000
TCBRSV92 EQU   TCBNDSP4                                                 07277000
TCBRSV91 EQU   TCBNDSP4                                                 07278000
TCBRSV90 EQU   TCBNDSP4                                                 07279000
TCBRSV89 EQU   TCBNDSP4                                                 07280000
TCBRSV88 EQU   TCBNDSP4                                                 07281000
TCBRSV87 EQU   TCBNDSP4                                                 07282000
TCBRSV86 EQU   TCBNDSP4                                                 07283000
TCBEXT1A EQU   TCBEXT1+1                                                07284000
TCBRSV32 EQU   TCBEXT1                                                  07285000
TCBEXCPD EQU   TCB+192                                                  07286000
TCBIOBRC EQU   TCB+188                                                  07287000
TCBDDWTC EQU   TCB+186                                                  07288000
TCBDDEXC EQU   TCB+184                                                  07289000
TCBJSCBB EQU   TCBJSCB+1                                                07290000
@NM00090 EQU   TCBRECDE                                                 07291000
TCBREC   EQU   TCBRECDE                                                 07292000
TCBMDIDS EQU   TCB+176                                                  07293000
TCBNDINT EQU   TCBNDSP3                                                 07294000
TCBRSV27 EQU   TCBNDSP3                                                 07295000
TCBRSV26 EQU   TCBNDSP3                                                 07296000
TCBRSV25 EQU   TCBNDSP3                                                 07297000
TCBRSV24 EQU   TCBNDSP3                                                 07298000
TCBSRBND EQU   TCBNDSP3                                                 07299000
TCBRV302 EQU   TCBNDSP3                                                 07300000
TCBLJSND EQU   TCBNDSP3                                                 07301000
TCBABE   EQU   TCBNDSP2                                                 07302000
TCBDSS   EQU   TCBNDSP2                                                 07303000
TCBOWAIT EQU   TCBNDSP2                                                 07304000
TCBIWAIT EQU   TCBNDSP2                                                 07305000
TCBNDTS  EQU   TCBNDSP2                                                 07306000
TCBNDSVC EQU   TCBNDSP2                                                 07307000
TCBSTPP  EQU   TCBNDSP2                                                 07308000
TCBABD   EQU   TCBNDSP2                                                 07309000
TCBRSV22 EQU   TCBNDSP1                                                 07310000
TCBPIEND EQU   TCBNDSP1                                                 07311000
TCBTPSP  EQU   TCBNDSP1                                                 07312000
TCBDDRND EQU   TCBNDSP1                                                 07313000
TCBRSPND EQU   TCBNDSP1                                                 07314000
TCBRSTND EQU   TCBNDSP1                                                 07315000
TCBDARPN EQU   TCBNDSP1                                                 07316000
TCBDARTN EQU   TCBNDSP1                                                 07317000
TCBNDSP0 EQU   TCBNDSP                                                  07318000
TCBUSER  EQU   TCB+168                                                  07319000
TCBTCTB  EQU   TCBTCT+1                                                 07320000
TCBRSV9C EQU   TCBTCTGF                                                 07321000
TCBRSV9B EQU   TCBTCTGF                                                 07322000
TCBRSV9A EQU   TCBTCTGF                                                 07323000
TCBRSV99 EQU   TCBTCTGF                                                 07324000
TCBRSV98 EQU   TCBTCTGF                                                 07325000
TCBRSV97 EQU   TCBTCTGF                                                 07326000
TCBRSV20 EQU   TCBTCTGF                                                 07327000
TCBSMFGF EQU   TCBTCTGF                                                 07328000
TCBSTABB EQU   TCBSTAB+1                                                07329000
TCBSTCUR EQU   TCBNSTAE                                                 07330000
TCBRV301 EQU   TCBNSTAE                                                 07331000
TCBSYNCH EQU   TCBNSTAE                                                 07332000
TCBHALT  EQU   TCBNSTAE                                                 07333000
TCBPPSUP EQU   TCBNSTAE                                                 07334000
TCB33E   EQU   TCBNSTAE                                                 07335000
TCBQUIES EQU   TCBNSTAE                                                 07336000
TCBSTABE EQU   TCBNSTAE                                                 07337000
TCBAQE   EQU   TCB+156                                                  07338000
TCBPQE   EQU   TCB+152                                                  07339000
TCBTSDP  EQU   TCB+151                                                  07340000
TCBTSLP  EQU   TCB+150                                                  07341000
TCBSTPCT EQU   TCB+149                                                  07342000
TCBCPUBN EQU   TCBTSFLG                                                 07343000
TCBDYDSP EQU   TCBTSFLG                                                 07344000
TCBRSV18 EQU   TCBTSFLG                                                 07345000
TCBRSV17 EQU   TCBTSFLG                                                 07346000
TCBTIOTG EQU   TCBTSFLG                                                 07347000
TCBATT   EQU   TCBTSFLG                                                 07348000
TCBSTPPR EQU   TCBTSFLG                                                 07349000
TCBRV300 EQU   TCBTSTSK                                                 07350000
TCBECB   EQU   TCB+144                                                  07351000
TCBIQE   EQU   TCB+140                                                  07352000
TCBLTC   EQU   TCB+136                                                  07353000
TCBOTC   EQU   TCB+132                                                  07354000
TCBNTC   EQU   TCB+128                                                  07355000
TCBJSTCA EQU   TCBJSTCB+1                                               07356000
TCBRSV16 EQU   TCBJSTCB                                                 07357000
TCBTQET  EQU   TCBTME                                                   07358000
TCBTCB   EQU   TCB+116                                                  07359000
TCBFSAB  EQU   TCBFSA+1                                                 07360000
TCBQEL   EQU   TCBFSA                                                   07361000
TCBGRS15 EQU   TCBGRS+60                                                07362000
TCBGRS14 EQU   TCBGRS+56                                                07363000
TCBGRS13 EQU   TCBGRS+52                                                07364000
TCBGRS12 EQU   TCBGRS+48                                                07365000
TCBGRS11 EQU   TCBGRS+44                                                07366000
TCBGRS10 EQU   TCBGRS+40                                                07367000
TCBGRS9  EQU   TCBGRS+36                                                07368000
TCBGRS8  EQU   TCBGRS+32                                                07369000
TCBGRS7  EQU   TCBGRS+28                                                07370000
TCBGRS6  EQU   TCBGRS+24                                                07371000
TCBGRS5  EQU   TCBGRS+20                                                07372000
TCBGRS4  EQU   TCBGRS+16                                                07373000
TCBGRS3  EQU   TCBGRS+12                                                07374000
TCBGRS2  EQU   TCBGRS+8                                                 07375000
TCBGRS1  EQU   TCBGRS+4                                                 07376000
TCBGRS0  EQU   TCBGRS                                                   07377000
TCBJPQB  EQU   TCBJPQ+1                                                 07378000
TCBRSV15 EQU   TCBPURGE                                                 07379000
TCBRSV14 EQU   TCBPURGE                                                 07380000
TCBRSV13 EQU   TCBPURGE                                                 07381000
TCBRSV12 EQU   TCBPURGE                                                 07382000
TCBRSV11 EQU   TCBPURGE                                                 07383000
TCBRSV10 EQU   TCBPURGE                                                 07384000
TCBRSV09 EQU   TCBPURGE                                                 07385000
TCBJPQF  EQU   TCBPURGE                                                 07386000
TCBJLB   EQU   TCB+40                                                   07387000
TCBLLS   EQU   TCB+36                                                   07388000
TCBDSP   EQU   TCB+35                                                   07389000
TCBLMP   EQU   TCB+34                                                   07390000
TCBPNDSP EQU   TCBFLGS5                                                 07391000
TCBFCD1  EQU   TCBFLGS5                                                 07392000
TCBSTP   EQU   TCBFLGS5                                                 07393000
TCBSYS   EQU   TCBFLGS5                                                 07394000
TCBANDSP EQU   TCBFLGS5                                                 07395000
TCBPAGE  EQU   TCBFLGS5                                                 07396000
TCBUXNDF EQU   TCBABWF                                                  07397000
TCBFC    EQU   TCBFLGS5                                                 07398000
TCBONDSP EQU   TCBFLGS4                                                 07399000
TCBMPCND EQU   TCBFLGS4                                                 07400000
TCBMPCVQ EQU   TCBFLGS4                                                 07401000
TCBUXNDV EQU   TCBFLGS4                                                 07402000
TCBHNDSP EQU   TCBFLGS4                                                 07403000
TCBRQENA EQU   TCBFLGS4                                                 07404000
TCBSER   EQU   TCBFLGS4                                                 07405000
TCBNDUMP EQU   TCBFLGS4                                                 07406000
TCBDWSTA EQU   TCBFLGS3                                                 07407000
TCBRSV08 EQU   TCBFLGS3                                                 07408000
TCBRSV07 EQU   TCBFLGS3                                                 07409000
TCBRSV06 EQU   TCBFLGS3                                                 07410000
TCBABGM  EQU   TCBFLGS3                                                 07411000
TCBABTRM EQU   TCBFLGS3                                                 07412000
TCBADINP EQU   TCBFLGS3                                                 07413000
TCBFSM   EQU   TCBFLGS3                                                 07414000
TCBFTS   EQU   TCBFLGS2                                                 07415000
TCBFETXR EQU   TCBFLGS2                                                 07416000
TCBFDSOP EQU   TCBFLGS2                                                 07417000
TCBFJMC  EQU   TCBFLGS2                                                 07418000
TCBFSMC  EQU   TCBFLGS2                                                 07419000
TCBFABOP EQU   TCBFLGS2                                                 07420000
TCBFSTI  EQU   TCBFLGS2                                                 07421000
TCBFOINP EQU   TCBFLGS2                                                 07422000
TCBFX    EQU   TCBFLGS1                                                 07423000
TCBFS    EQU   TCBFLGS1                                                 07424000
TCBFT    EQU   TCBFLGS1                                                 07425000
TCBPDUMP EQU   TCBFLGS1                                                 07426000
TCBNONPR EQU   TCBFLGS1                                                 07427000
TCBFERA  EQU   TCBFLGS1                                                 07428000
TCBFE    EQU   TCBFLGS1                                                 07429000
TCBFA    EQU   TCBFLGS1                                                 07430000
TCBZERO  EQU   TCBPKF                                                   07431000
TCBFLAG  EQU   TCBPKF                                                   07432000
TCBMSSB  EQU   TCBMSS+1                                                 07433000
TCBRSV03 EQU   TCBMSS                                                   07434000
TCBTRNB  EQU   TCBTRN+1                                                 07435000
TCBRSV02 EQU   TCBABF                                                   07436000
TCBOLTEP EQU   TCBABF                                                   07437000
TCBTCP   EQU   TCBABF                                                   07438000
TCBTCPP  EQU   TCBABF                                                   07439000
TCBRSV01 EQU   TCBABF                                                   07440000
TCBGRPH  EQU   TCBABF                                                   07441000
TCBNOCHK EQU   TCBABF                                                   07442000
TCBMOD91 EQU   TCBABF                                                   07443000
TCBCMPC  EQU   TCBCMP+1                                                 07444000
TCBRV318 EQU   TCBCMSG                                                  07445000
TCBRV317 EQU   TCBCIND                                                  07446000
TCBRV316 EQU   TCBCWTO                                                  07447000
TCBCASID EQU   TCBCDBL                                                  07448000
TCBNOCC  EQU   TCBSTCC                                                  07449000
TCBDMPO  EQU   TCBCPP                                                   07450000
TCBCSTEP EQU   TCBCMPF                                                  07451000
TCBCREQ  EQU   TCBCMPF                                                  07452000
TCBTIO   EQU   TCB+12                                                   07453000
TCBDEB   EQU   TCB+8                                                    07454000
TCBPIEA  EQU   TCBPIE+1                                                 07455000
TCBPM    EQU   TCBPMASK                                                 07456000
@NM00089 EQU   TCBPMASK                                                 07457000
TCBRBP   EQU   TCB                                                      07458000
TCBFRS6  EQU   TCBFRS+24                                                07459000
TCBFRS4  EQU   TCBFRS+16                                                07460000
TCBFRS2  EQU   TCBFRS+8                                                 07461000
TCBFRS0  EQU   TCBFRS                                                   07462000
UCBERADR EQU   UCBUCS+12                                                07463000
UCBFCBID EQU   UCBUCS+8                                                 07464000
UCBERCNT EQU   UCBUCS+7                                                 07465000
UCBRSV51 EQU   UCBUCS+6                                                 07466000
UCBRSV50 EQU   UCBFCBOP                                                 07467000
UCBRSV49 EQU   UCBFCBOP                                                 07468000
UCBRSV48 EQU   UCBFCBOP                                                 07469000
UCBRSV47 EQU   UCBFCBOP                                                 07470000
UCBRSV46 EQU   UCBFCBOP                                                 07471000
UCBRSV45 EQU   UCBFCBOP                                                 07472000
UCBRSV44 EQU   UCBFCBOP                                                 07473000
UCBFCBO1 EQU   UCBFCBOP                                                 07474000
UCBUCSPE EQU   UCBUCSOP                                                 07475000
UCBRSV43 EQU   UCBUCSOP                                                 07476000
UCBRSV42 EQU   UCBUCSOP                                                 07477000
UCBRSV41 EQU   UCBUCSOP                                                 07478000
UCBRSV40 EQU   UCBUCSOP                                                 07479000
UCBRSV39 EQU   UCBUCSOP                                                 07480000
UCBUCSO2 EQU   UCBUCSOP                                                 07481000
UCBUCSO1 EQU   UCBUCSOP                                                 07482000
UCBUCSID EQU   UCBUCS                                                   07483000
UCBMDRBA EQU   UCBMDRBF+1                                               07484000
UCBRV075 EQU   UCBMDRBF                                                 07485000
UCBRV074 EQU   UCB3800X+32                                              07486000
UCBIMAGE EQU   UCB3800X+28                                              07487000
UCBFCBNM EQU   UCB3800X+24                                              07488000
UCBCHAR4 EQU   UCB3800X+20                                              07489000
UCBCHAR3 EQU   UCB3800X+16                                              07490000
UCBCHAR2 EQU   UCB3800X+12                                              07491000
UCBCHAR1 EQU   UCB3800X+8                                               07492000
UCBCGMID EQU   UCB3800X+4                                               07493000
UCBBRSTA EQU   UCBACTIV                                                 07494000
UCBRV063 EQU   UCBACTIV                                                 07495000
UCBRV062 EQU   UCBACTIV                                                 07496000
UCBRV061 EQU   UCBACTIV                                                 07497000
UCBRV060 EQU   UCBACTIV                                                 07498000
UCBRV059 EQU   UCBACTIV                                                 07499000
UCBRV058 EQU   UCBACTIV                                                 07500000
UCBRV057 EQU   UCBACTIV                                                 07501000
UCBRV050 EQU   UCB3800X+2                                               07502000
UCBCGMNO EQU   UCB3800X+1                                               07503000
UCBRV083 EQU   UCBOPTNS                                                 07504000
UCBBRSTR EQU   UCBOPTNS                                                 07505000
UCBRV056 EQU   UCBOPTNS                                                 07506000
UCBRV055 EQU   UCBOPTNS                                                 07507000
UCBRV054 EQU   UCBOPTNS                                                 07508000
UCBRV053 EQU   UCBOPTNS                                                 07509000
UCBRV052 EQU   UCBOPTNS                                                 07510000
UCBRV051 EQU   UCBOPTNS                                                 07511000
UCBRV073 EQU   UCB3540X+7                                               07512000
UCBRV072 EQU   UCBDKBYT                                                 07513000
UCBRV071 EQU   UCBDKBYT                                                 07514000
UCBRV070 EQU   UCBDKBYT                                                 07515000
UCBRV069 EQU   UCBDKBYT                                                 07516000
UCBRV068 EQU   UCBDKBYT                                                 07517000
UCBRV067 EQU   UCBDKBYT                                                 07518000
UCBVLVER EQU   UCBDKBYT                                                 07519000
UCBDKAMX EQU   UCBDKBYT                                                 07520000
UCBVLSER EQU   UCB3540X                                                 07521000
UCBRDATA EQU   UCBOCR+4                                                 07522000
UCBFRID  EQU   UCBOCR                                                   07523000
UCBCLN   EQU   UCBMT+14                                                 07524000
UCBERG   EQU   UCBMT+12                                                 07525000
UCBMS    EQU   UCBMT+11                                                 07526000
UCBNB    EQU   UCBMT+10                                                 07527000
UCBPW    EQU   UCBMT+9                                                  07528000
UCBPR    EQU   UCBMT+8                                                  07529000
UCBSIO   EQU   UCBMT+6                                                  07530000
UCBTW    EQU   UCBMT+5                                                  07531000
UCBTR    EQU   UCBMT+4                                                  07532000
UCBTWT   EQU   UCBMT+3                                                  07533000
UCBTRT   EQU   UCBMT+2                                                  07534000
UCBCTD   EQU   UCBMT                                                    07535000
UCBWTOID EQU   UCBCMEXT+17                                              07536000
UCBRV043 EQU   UCBCMEXT+16                                              07537000
UCBASID  EQU   UCBCMEXT+14                                              07538000
UCBMFCNT EQU   UCBCMEXT+12                                              07539000
UCBPMSK  EQU   UCBCMEXT+10                                              07540000
UCBCCWOF EQU   UCBCMEXT+8                                               07541000
UCBRV041 EQU   UCBCMEXT+6                                               07542000
UCBRV036 EQU   UCBFLP1                                                  07543000
UCBRV035 EQU   UCBFLP1                                                  07544000
UCBERLOG EQU   UCBFLP1                                                  07545000
UCBRV033 EQU   UCBFLP1                                                  07546000
UCBRV032 EQU   UCBFLP1                                                  07547000
UCBRV031 EQU   UCBFLP1                                                  07548000
UCBSHRUP EQU   UCBFLP1                                                  07549000
UCBNSRCH EQU   UCBFLP1                                                  07550000
UCBSNSCT EQU   UCBCMEXT+4                                               07551000
UCBHPDV  EQU   @NM00088                                                 07552000
UCBHALI  EQU   @NM00088                                                 07553000
UCBRSV09 EQU   @NM00088                                                 07554000
UCBRSV08 EQU   @NM00088                                                 07555000
UCBRSV07 EQU   @NM00088                                                 07556000
UCBRSV06 EQU   @NM00088                                                 07557000
UCBRSV05 EQU   @NM00088                                                 07558000
UCBRSV04 EQU   @NM00088                                                 07559000
UCBDTI   EQU   UCBCMEXT+2                                               07560000
UCBSTI   EQU   UCBCMEXT+1                                               07561000
UCBETI   EQU   UCBCMEXT                                                 07562000
UCBEXTP  EQU   UCBEXTPT+1                                               07563000
UCBDDRSW EQU   UCBFLC                                                   07564000
UCBTICBT EQU   UCBFLC                                                   07565000
UCBIVRR  EQU   UCBFLC                                                   07566000
UCBIVRS  EQU   UCBFLC                                                   07567000
UCBITF   EQU   UCBFLC                                                   07568000
UCBUDE   EQU   UCBFLC                                                   07569000
UCBWAA   EQU   UCBFLC                                                   07570000
UCBATTP  EQU   UCBFLC                                                   07571000
UCBRSV11 EQU   UCBDVCLS                                                 07572000
UCBRSV10 EQU   UCBDVCLS                                                 07573000
UCB3CHAR EQU   UCBDVCLS                                                 07574000
UCB3UREC EQU   UCBDVCLS                                                 07575000
UCB3DISP EQU   UCBDVCLS                                                 07576000
UCB3COMM EQU   UCBDVCLS                                                 07577000
UCB3TAPE EQU   UCBDVCLS                                                 07578000
UCBDVPWR EQU   UCB2OPT7                                                 07579000
UCBVLPWR EQU   UCB2OPT6                                                 07580000
UCB2OPT5 EQU   UCBTBYT2                                                 07581000
UCBRPS   EQU   UCBDUDN2                                                 07582000
UCBRR    EQU   UCBDUDN1                                                 07583000
UCB2OPT1 EQU   UCBTBYT2                                                 07584000
UCB2OPT0 EQU   UCBTBYT2                                                 07585000
UCB1FEA7 EQU   UCBTBYT1                                                 07586000
UCBD6250 EQU   UCB1FEA6                                                 07587000
UCBD1600 EQU   UCB1FEA5                                                 07588000
UCB1FEA4 EQU   UCBTBYT1                                                 07589000
UCB1FEA3 EQU   UCBTBYT1                                                 07590000
UCB1FEA2 EQU   UCBTBYT1                                                 07591000
UCB1FEA1 EQU   UCBTBYT1                                                 07592000
UCB1FEA0 EQU   UCBTBYT1                                                 07593000
UCBRV029 EQU   UCBWGT                                                   07594000
UCBVHRSN EQU   UCBWGT                                                   07595000
UCBVORSN EQU   UCBWGT                                                   07596000
UCBMTPXP EQU   UCBWGT                                                   07597000
UCBREW   EQU   UCBWGT                                                   07598000
UCBPUB   EQU   UCBWGT                                                   07599000
UCBOUT   EQU   UCBWGT                                                   07600000
UCBIN    EQU   UCBWGT                                                   07601000
UCBCPU   EQU   UCBOB+11                                                 07602000
UCBLCI   EQU   UCBOB+10                                                 07603000
UCBCNT   EQU   UCBOB+9                                                  07604000
UCBRV017 EQU   UCBCHM1                                                  07605000
UCBRV016 EQU   UCBCHM1                                                  07606000
UCBRV015 EQU   UCBCHM1                                                  07607000
UCBRV014 EQU   UCBCHM1                                                  07608000
UCBSPB   EQU   UCBPTH1                                                  07609000
UCBPPB   EQU   UCBPTH1                                                  07610000
UCBSPA   EQU   UCBPTH0                                                  07611000
UCBPPA   EQU   UCBPTH0                                                  07612000
UCBSIGP  EQU   UCBFLB                                                   07613000
UCBVALPH EQU   UCBFLB                                                   07614000
UCBCRHSN EQU   UCBFLB                                                   07615000
UCBCRHRV EQU   UCBFLB                                                   07616000
UCBRESVH EQU   UCBFLB                                                   07617000
UCBSPST  EQU   UCBFLB                                                   07618000
UCBASNS  EQU   UCBFLB                                                   07619000
UCBIORST EQU   UCBFLB                                                   07620000
UCBQISCE EQU   UCBFL1                                                   07621000
UCBACTV  EQU   UCBFL1                                                   07622000
UCBSAP   EQU   UCBFL1                                                   07623000
UCBNOTRC EQU   UCBCUB                                                   07624000
UCBPSNS  EQU   UCBFL1                                                   07625000
UCBUSING EQU   UCBPST                                                   07626000
UCBBUSYD EQU   UCBBSY                                                   07627000
UCBUA    EQU   UCBCHAN+1                                                07628000
UCBCHA   EQU   UCBCHAN                                                  07629000
UCBDADI  EQU   UCBSTAT                                                  07630000
UCBSYSR  EQU   UCBSTAT                                                  07631000
UCBALOC  EQU   UCBSTAT                                                  07632000
UCBUNLD  EQU   UCBSTAT                                                  07633000
UCBCHGS  EQU   UCBSTAT                                                  07634000
UCBONLI  EQU   UCBSTAT                                                  07635000
UCBID    EQU   UCBOB+2                                                  07636000
UCBALTPH EQU   UCBFL5                                                   07637000
UCBALTCU EQU   UCBFL5                                                   07638000
UCBNALOC EQU   UCBFL5                                                   07639000
UCBENVRD EQU   UCBFL5                                                   07640000
UCBVSDR  EQU   UCBFL5                                                   07641000
UCBSASK  EQU   UCBFL5                                                   07642000
UCBAMV   EQU   UCBAF                                                    07643000
UCBDCC   EQU   UCBFL5                                                   07644000
UCBMONT  EQU   UCBJBNR                                                  07645000
UCBRV011 EQU   UCBJBNR                                                  07646000
UCBRSV02 EQU   UCBJBNR                                                  07647000
UCBOLDSM EQU   UCBJBNR                                                  07648000
UCBRV003 EQU   UCBJBNR                                                  07649000
UCBDUC   EQU   UCBJBNR                                                  07650000
UCBJES3  EQU   UCBJBNR                                                  07651000
UCBVRDEV EQU   UCBJBNR                                                  07652000
UCBCMSEG EQU   UCBOB                                                    07653000
UCBPFXND EQU   UCB+512                                                  07654000
UCBIOQ   EQU   UCB+508                                                  07655000
UCBLOCK  EQU   UCB+504                                                  07656000
UCBPXST  EQU   UCB+504                                                  07657000
@NM00085 EQU   UCB                                                      07658000
VSDDSN   EQU   VSDARRAY+4                                               07659000
VSDVOLCT EQU   VSDARRAY                                                 07660000
VSDFMT0  EQU   VSDBLOCK+8                                               07661000
VSDVTOCS EQU   VSDBLOCK+4                                               07662000
VSDELEM  EQU   VSDBLOCK                                                 07663000
VSDFREE  EQU   VSDUSAGE+24                                              07664000
VSDALLC  EQU   VSDUSAGE+19                                              07665000
VSDDSOR3 EQU   VSDDSORG+2                                               07666000
@NM00084 EQU   VSDDSORG                                                 07667000
VSDSCAL  EQU   VSDUSAGE+12                                              07668000
@NM00083 EQU   VSDUSEF                                                  07669000
VSDCALFR EQU   VSDUSEF                                                  07670000
@NM00082 EQU   VSDALLOC                                                 07671000
VSDABSTR EQU   VSDALLOC                                                 07672000
VSDABLK  EQU   VSDALLOC                                                 07673000
VSDATRK  EQU   VSDALLOC                                                 07674000
VSDACYL  EQU   VSDALLOC                                                 07675000
@NM00081 EQU   VSDDORG                                                  07676000
VSDOU    EQU   VSDDORG                                                  07677000
VSDOIS   EQU   VSDDORG                                                  07678000
VSDODA   EQU   VSDDORG                                                  07679000
VSDOUN   EQU   VSDDORG                                                  07680000
VSDOPS   EQU   VSDDORG                                                  07681000
VSDOPO   EQU   VSDDORG                                                  07682000
VSDEXTS  EQU   VSDUSAGE+8                                               07683000
VSDSECAL EQU   VSDUSAGE+4                                               07684000
VSDFTRK  EQU   VSDUSAGE+2                                               07685000
VSDTRKS  EQU   VSDUSAGE                                                 07686000
@NM00080 EQU   VSDSCR+5                                                 07687000
@NM00079 EQU   VSDSCRFL                                                 07688000
VSDVSAM  EQU   VSDSCRFL                                                 07689000
VSDCATLC EQU   VSDSCRFL                                                 07690000
VSDACBPT EQU   VSDSCR                                                   07691000
VSDPRTC  EQU   VSDSTAT+25                                               07692000
VSDCAT   EQU   VSDSTAT+22                                               07693000
VSDEXP   EQU   VSDSTAT+20                                               07694000
VSDCRE   EQU   VSDSTAT+18                                               07695000
@NM00078 EQU   VSDFLG2                                                  07696000
VSDERROR EQU   VSDFLG2                                                  07697000
VSDPROT  EQU   VSDFLG2                                                  07698000
VSDPWW   EQU   VSDFLG2                                                  07699000
VSDPWR   EQU   VSDFLG2                                                  07700000
@NM00077 EQU   VSDSFLG1                                                 07701000
VSDCVSAM EQU   VSDSFLG1                                                 07702000
VSDCATLG EQU   VSDSFLG1                                                 07703000
VSDVSAME EQU   VSDSFLG1                                                 07704000
VSDVSAMC EQU   VSDSFLG1                                                 07705000
VSDVTOCE EQU   VSDSFLG1                                                 07706000
VSDVTOCC EQU   VSDSFLG1                                                 07707000
VSDOWNER EQU   VSDSTAT+8                                                07708000
VSDEXPIR EQU   VSDSTAT+4                                                07709000
VSDCREAT EQU   VSDSTAT                                                  07710000
VSDFRCCL EQU   VSDVTOC+21                                               07711000
@NM00076 EQU   VSDVTOC+20                                               07712000
VSDFREXT EQU   VSDVTOC+16                                               07713000
@NM00075 EQU   VSDVTOC+15                                               07714000
VSDFRTRK EQU   VSDVTOC+11                                               07715000
@NM00074 EQU   VSDVTOC+10                                               07716000
VSDFRCYL EQU   VSDVTOC+6                                                07717000
@NM00073 EQU   VSDVTOC                                                  07718000
@NM00072 EQU   VS3FLAGS                                                 07719000
VS3SYSNM EQU   VS3FLAGS                                                 07720000
VS3UNCAT EQU   VS3FLAGS                                                 07721000
VS3SCR   EQU   VS3FLAGS                                                 07722000
VS3USAGE EQU   VS3FLAGS                                                 07723000
VS3STAT  EQU   VS3FLAGS                                                 07724000
VS3DD    EQU   VS3AGL+50                                                07725000
VS3VOL   EQU   VS3AGL+44                                                07726000
VS3POOL  EQU   VS3AGL+40                                                07727000
VS3DEV   EQU   VS3AGL+36                                                07728000
VS3UCBP  EQU   VS3AGL+32                                                07729000
VS3CREAT EQU   VS3AGL+28                                                07730000
VS3EXPIR EQU   VS3AGL+24                                                07731000
VS3AST   EQU   VS3AGL+22                                                07732000
VS3LEVLN EQU   VS3AGL+20                                                07733000
VS3LEVP  EQU   VS3AGL+16                                                07734000
VS3EXDSP EQU   VS3AGL+12                                                07735000
VS3LISTP EQU   VS3AGL+8                                                 07736000
VS3HEAD  EQU   VS3AGL                                                   07737000
@NM00071 EQU   DATESOPT                                                 07738000
DATDAYOP EQU   DATESOPT                                                 07739000
DATDTEOP EQU   DATESOPT                                                 07740000
DATSUB   EQU   DATESOPT                                                 07741000
DATADD   EQU   DATESOPT                                                 07742000
DATRETRN EQU   DATESAGL+16                                              07743000
DATDAYS  EQU   DATESAGL+12                                              07744000
DATDATE  EQU   DATESAGL+8                                               07745000
DATHEAD  EQU   DATESAGL                                                 07746000
@NM00070 EQU   SELFLAGS                                                 07747000
SELHEAD  EQU   SELAGL                                                   07748000
@NM00069 EQU   UCTFLAGS                                                 07749000
UCTVSCAT EQU   UCTFLAGS                                                 07750000
UCTDD    EQU   UCTAGL+60                                                07751000
UCTVOLP  EQU   UCTAGL+56                                                07752000
UCTACBP  EQU   UCTAGL+52                                                07753000
UCTDSN   EQU   UCTAGL+8                                                 07754000
UCTHEAD  EQU   UCTAGL                                                   07755000
@NM00068 EQU   LCTFLAGS                                                 07756000
LCTVSCAT EQU   LCTFLAGS                                                 07757000
LCTOWNER EQU   LCTINFO+24                                               07758000
LCTEXPIR EQU   LCTINFO+20                                               07759000
LCTCREAT EQU   LCTINFO+16                                               07760000
LCTACBP  EQU   LCTINFO+12                                               07761000
LCTMULVC EQU   LCTINFO+8                                                07762000
LCTHEAD  EQU   LCTINFO                                                  07763000
SRTWORKP EQU   SRTAGL+28                                                07764000
SRTFLDLN EQU   SRTAGL+24                                                07765000
SRTPOSIT EQU   SRTAGL+20                                                07766000
SRTLEN   EQU   SRTAGL+16                                                07767000
SRTNUM   EQU   SRTAGL+12                                                07768000
SRTADDR  EQU   SRTAGL+8                                                 07769000
SRTHEAD  EQU   SRTAGL                                                   07770000
SV82DEBP EQU   SV82WRKP                                                 07771000
VOLRESV3 EQU   VOLLABEL+55                                              07772000
VOLOWNER EQU   VOLLABEL+45                                              07773000
VOLRESV1 EQU   VOLLABEL+20                                              07774000
VOLSECTY EQU   VOLLABEL+14                                              07775000
VOLSERNO EQU   VOLLABEL+8                                               07776000
VOLNO    EQU   VOLLABEL+7                                               07777000
VOLLABI  EQU   VOLLABEL+4                                               07778000
@NM00065 EQU   STARETRY                                                 07779000
STAVTOC  EQU   STARETRY                                                 07780000
STAOFF   EQU   STARETRY                                                 07781000
STAIO05  EQU   STARETRY                                                 07782000
@NM00064 EQU   STARCVY                                                  07783000
STARTADD EQU   STAEPARM+44                                              07784000
STAEXSAV EQU   STAEPARM+40                                              07785000
STARTSAV EQU   STAEPARM+36                                              07786000
@NM00063 EQU   STAEPARM+30                                              07787000
@NM00062 EQU   STAEPARM+18                                              07788000
STAHEAD  EQU   STAEPARM                                                 07789000
RCTDSET  EQU   RCTAGL+32                                                07790000
RCTNVOL  EQU   RCTAGL+26                                                07791000
RCTOVOL  EQU   RCTAGL+20                                                07792000
RCTNDEV  EQU   RCTAGL+16                                                07793000
RCTODEV  EQU   RCTAGL+12                                                07794000
@NM00061 EQU   RCTAGL+10                                                07795000
@NM00060 EQU   RCTOPT                                                   07796000
RCTVOL   EQU   RCTOPT                                                   07797000
RCTDEV   EQU   RCTOPT                                                   07798000
RCTHEAD  EQU   RCTAGL                                                   07799000
@NM00059 EQU   VSRESOPT                                                 07800000
VSREAL   EQU   VSRESOPT                                                 07801000
VSRES    EQU   VSRESOPT                                                 07802000
@NM00058 EQU   VSMSG                                                    07803000
VSTOV    EQU   VSMSG                                                    07804000
VSFROMV  EQU   VSMSG                                                    07805000
@NM00057 EQU   VSRETURN                                                 07806000
VSUCAT   EQU   VSRETURN                                                 07807000
VSVSAM   EQU   VSRETURN                                                 07808000
@NM00056 EQU   VSCATOPT                                                 07809000
VSLIST   EQU   VSCATOPT                                                 07810000
VSSERIAL EQU   VSCATOPT                                                 07811000
VSDEVICE EQU   VSCATOPT                                                 07812000
@NM00055 EQU   VSVTOPT                                                  07813000
VSVSFLAG EQU   VSVTOPT                                                  07814000
VSALTTRK EQU   VSVTOPT                                                  07815000
VSTIME   EQU   VSVTOPT                                                  07816000
VSUCMAST EQU   VSSECOPT                                                 07817000
VSOPCAT  EQU   VSSECOPT                                                 07818000
VSUCTEST EQU   VSSECOPT                                                 07819000
VSWRITE  EQU   VSSECOPT                                                 07820000
VSREAD   EQU   VSSECOPT                                                 07821000
VSNONONV EQU   VSSECOPT                                                 07822000
VSMASTER EQU   VSSECOPT                                                 07823000
VSNOVSAM EQU   VSSECOPT                                                 07824000
VSODEVP  EQU   VS1AGL+64                                                07825000
VSOSERP  EQU   VS1AGL+60                                                07826000
VSDEVP   EQU   VS1AGL+56                                                07827000
VSSERP   EQU   VS1AGL+52                                                07828000
VSPFILEP EQU   VS1AGL+48                                                07829000
VSPSWDP  EQU   VS1AGL+44                                                07830000
VSCATDDP EQU   VS1AGL+40                                                07831000
VSACBP   EQU   VS1AGL+36                                                07832000
VSCATP   EQU   VS1AGL+32                                                07833000
VSNXTATP EQU   VS1AGL+28                                                07834000
VSNUMATP EQU   VS1AGL+24                                                07835000
VSIOP    EQU   VS1AGL+20                                                07836000
VSFILEP  EQU   VS1AGL+16                                                07837000
VSVOLP   EQU   VS1AGL+12                                                07838000
VSUCBP   EQU   VS1AGL+8                                                 07839000
VSHEAD   EQU   VS1AGL                                                   07840000
VSVTOCPT EQU   VS2AGL+48                                                07841000
@NM00054 EQU   VS2AGL+45                                                07842000
VSDDNAME EQU   VS2AGL+37                                                07843000
@NM00053 EQU   VS2RESOP                                                 07844000
VS2REAL  EQU   VS2RESOP                                                 07845000
VS2RES   EQU   VS2RESOP                                                 07846000
@NM00052 EQU   VS2MSG                                                   07847000
VS2TOV   EQU   VS2MSG                                                   07848000
VSVOLUME EQU   VS2AGL+29                                                07849000
@NM00051 EQU   VSLABOPT                                                 07850000
VSNOVTOC EQU   VSLABOPT                                                 07851000
VSVOLSER EQU   VSLABOPT                                                 07852000
VSOWNER  EQU   VSLABOPT                                                 07853000
VSIOBKPT EQU   VS2AGL+24                                                07854000
VSVOLPTR EQU   VS2AGL+20                                                07855000
VSOWNPTR EQU   VS2AGL+16                                                07856000
VSVTOCSZ EQU   VS2AGL+12                                                07857000
VSUCBPTR EQU   VS2AGL+8                                                 07858000
VS2HEAD  EQU   VS2AGL                                                   07859000
EXPDATAL EQU   EXPARRAY+6                                               07860000
@NM00050 EQU   EXPARRAY+5                                               07861000
EXPKEYLN EQU   EXPARRAY+4                                               07862000
EXPDATAP EQU   EXPARRAY                                                 07863000
EXPRECNO EQU   EXPDATAB                                                 07864000
EXPCCHHR EQU   EXPARG+16                                                07865000
EXPCTLBK EQU   EXPARG+8                                                 07866000
EXPHEAD  EQU   EXPARG                                                   07867000
@NM00049 EQU   EXGARG+29                                                07868000
EXGCCHH1 EQU   EXGARG+12                                                07869000
EXGHEAD  EQU   EXGARG                                                   07870000
@NM00048 EQU   EXFLG                                                    07871000
EXOREAD  EQU   EXFLG                                                    07872000
@NM00047 EQU   EXOPT                                                    07873000
EXOVTOC  EQU   EXOPT                                                    07874000
EXOPASS  EQU   EXOPT                                                    07875000
EXOLAB   EQU   EXOPT                                                    07876000
EXOTAB   EQU   EXOPT                                                    07877000
EXOEXT   EQU   EXOARG+24                                                07878000
EXOVSN   EQU   EXOARG+16                                                07879000
EXODSN   EQU   EXOARG+12                                                07880000
EXOHEAD  EQU   EXOARG                                                   07881000
@NM00046 EQU   EXCLFLAG                                                 07882000
EXCLHEAD EQU   EXCLAGL                                                  07883000
@NM00045 EQU   CKFLAGS                                                  07884000
CKLABELP EQU   CKAGL+24                                                 07885000
MDR      EQU   MDVTOC+4                                                 07886000
@NM00044 EQU   MDAGL+31                                                 07887000
CTTBLRR  EQU   CTARRAY+3                                                07888000
CTTBLHH  EQU   CTARRAY+2                                                07889000
CTTBLCC  EQU   CTARRAY+1                                                07890000
CTTBLID  EQU   CTARRAY                                                  07891000
CTREALH  EQU   CTMSG+3                                                  07892000
CTREALCC EQU   CTMSG+1                                                  07893000
@NM00043 EQU   CTMSG                                                    07894000
CMCSN2   EQU   CMMSG+28                                                 07895000
CMCSN1   EQU   CMMSG+16                                                 07896000
CMNUMCRT EQU   CMMSG+15                                                 07897000
@NM00042 EQU   CMMSG+14                                                 07898000
CMNEWVOL EQU   CMMSG+8                                                  07899000
@NM00041 EQU   CMMSG+7                                                  07900000
@NM00040 EQU   CMVOLFLG                                                 07901000
CMRONLY  EQU   CMVOLFLG                                                 07902000
CMBIND   EQU   CMVOLFLG                                                 07903000
CMSCRCRT EQU   CMVOLFLG                                                 07904000
CMEXCL   EQU   CMVOLFLG                                                 07905000
CMDERAS  EQU   CMVOLFLG                                                 07906000
CMSCRVOL EQU   CMVOLFLG                                                 07907000
CMCECART EQU   CMVOLFLG                                                 07908000
CMOLDVOL EQU   CMMSG                                                    07909000
CCOLDCSN EQU   CCMSG+24                                                 07910000
CCNEWCSN EQU   CCMSG+12                                                 07911000
@NM00039 EQU   CCMSG+10                                                 07912000
CCVOL    EQU   CCMSG+4                                                  07913000
@NM00038 EQU   CCMSG+2                                                  07914000
CCEJCODE EQU   CCMSG+1                                                  07915000
CCPSTCDE EQU   CCMSG                                                    07916000
PTR1     EQU   AUTOARAY+8                                               07917000
ASIZE    EQU   AUTOARAY+6                                               07918000
STATUS   EQU   AUTOARAY+4                                               07919000
AREAID   EQU   AUTOARAY                                                 07920000
GPLAST   EQU   SAHIST+4                                                 07921000
GPFIRST  EQU   SAHIST                                                   07922000
@NM00037 EQU   DMPARY+15                                                07923000
DMPARYTP EQU   DMPARY+14                                                07924000
DMPARYEX EQU   DMPARY+12                                                07925000
DMPARYIC EQU   DMPARY+10                                                07926000
DMPARYSZ EQU   DMPARY+8                                                 07927000
DMPARYNM EQU   DMPARY                                                   07928000
@NM00036 EQU   DMPITM+15                                                07929000
DMPITMTP EQU   DMPITM+14                                                07930000
DMPITMLN EQU   DMPITM+12                                                07931000
DMPITMPT EQU   DMPITM+8                                                 07932000
DMPITMNM EQU   DMPITM                                                   07933000
@NM00035 EQU   ERCNVTAB+24                                              07934000
ERCPLPT  EQU   ERCNVTAB+20                                              07935000
ERCATRC  EQU   ERCNVTAB+16                                              07936000
ERDSNM   EQU   ERCNVTAB+12                                              07937000
@NM00034 EQU   ERCNVTAB+4                                               07938000
@NM00033 EQU   ERCNVTAB+3                                               07939000
@NM00032 EQU   EROSOPER                                                 07940000
EROSUCDX EQU   EROSOPER                                                 07941000
EROSCATL EQU   EROSOPER                                                 07942000
@NM00031 EQU   EROPER                                                   07943000
ERCATAL  EQU   EROPER                                                   07944000
ERCATDL  EQU   EROPER                                                   07945000
ERCATDE  EQU   EROPER                                                   07946000
ERCATLC  EQU   EROPER                                                   07947000
@NM00030 EQU   ERTYPE                                                   07948000
EROSCAT  EQU   ERTYPE                                                   07949000
ERCATLG  EQU   ERTYPE                                                   07950000
@NM00029 EQU   FMTCNVF+1                                                07951000
FMTAR    EQU   FMTCNVF+1                                                07952000
FMTBS    EQU   FMTCNVF+1                                                07953000
FMTSS    EQU   FMTCNVF+1                                                07954000
FMTAL    EQU   FMTCNVF+1                                                07955000
FMTZS    EQU   FMTCNVF+1                                                07956000
@NM00028 EQU   FMTCNVF                                                  07957000
FMTPU    EQU   FMTCNVF                                                  07958000
FMTBD    EQU   FMTCNVF                                                  07959000
FMTBHD   EQU   FMTCNVF                                                  07960000
FMTBHA   EQU   FMTCNVF                                                  07961000
FMTBH    EQU   FMTCNVF                                                  07962000
FMTOLEN  EQU   FMTLIST+8                                                07963000
FMTRIO   EQU   FMTOCOL                                                  07964000
FMTSPT   EQU   FMTSTO                                                   07965000
FMTSTL   EQU   FMTILEN                                                  07966000
@NM00027 EQU   FMTFLGS+1                                                07967000
FMTHDF   EQU   FMTFLGS                                                  07968000
FMTDFF   EQU   FMTFLGS                                                  07969000
FMTSTF   EQU   FMTFLGS                                                  07970000
FMTREPF  EQU   FMTFLGS                                                  07971000
FMTBDF   EQU   FMTFLGS                                                  07972000
FMTIDF   EQU   FMTFLGS                                                  07973000
FMTSCF   EQU   FMTFLGS                                                  07974000
FMTEOLF  EQU   FMTFLGS                                                  07975000
DARGPCT  EQU   DARGINL                                                  07976000
DARGREP  EQU   DARGINS                                                  07977000
@NM00026 EQU   DARGLIST+19                                              07978000
DARGIND  EQU   DARGLIST+18                                              07979000
UVOLVOL  EQU   UVOLENT+4                                                07980000
UVOLDEV  EQU   UVOLENT                                                  07981000
UVOLCNT  EQU   UVOLLIST                                                 07982000
@NM00025 EQU   IOINFOPT                                                 07983000
IOINFTMS EQU   IOINFOPT                                                 07984000
IOINFSUP EQU   IOINFOPT                                                 07985000
IOINFDSN EQU   IOINFOPT                                                 07986000
IOINFDVT EQU   IOINFOPT                                                 07987000
OPNVOL   EQU   OPNAGL+44                                                07988000
@NM00024 EQU   OPNAGL+43                                                07989000
@NM00023 EQU   OPNOPT2                                                  07990000
OPNOPTJM EQU   OPNOPT2                                                  07991000
@NM00022 EQU   OPNOPT2                                                  07992000
OPNOPTAS EQU   OPNOPT2                                                  07993000
@NM00021 EQU   OPNDSO                                                   07994000
OPNDSOPO EQU   OPNDSO                                                   07995000
OPNDSOIS EQU   OPNDSO                                                   07996000
OPNDSOPS EQU   OPNDSO                                                   07997000
OPNDSOAM EQU   OPNDSO                                                   07998000
OPNKYL   EQU   OPNAGL+40                                                07999000
OPNBLK   EQU   OPNAGL+36                                                08000000
OPNREC   EQU   OPNAGL+32                                                08001000
OPNDEVIX EQU   OPNDEV+4                                                 08002000
OPNDEVDT EQU   OPNDEV                                                   08003000
OPNCBP   EQU   OPNAGL+20                                                08004000
OPNDSN   EQU   OPNAGL+16                                                08005000
OPNPWA   EQU   OPNAGL+12                                                08006000
OPNDDN   EQU   OPNAGL+8                                                 08007000
OPNIOC   EQU   OPNAGL+4                                                 08008000
OPNMODRP EQU   OPNMOD                                                   08009000
OPNMODUB EQU   OPNMOD                                                   08010000
OPNMODRS EQU   OPNMOD                                                   08011000
OPNMODAX EQU   OPNMOD                                                   08012000
OPNMODRR EQU   OPNMOD                                                   08013000
OPNMODRC EQU   OPNMOD                                                   08014000
OPNMODAC EQU   OPNMOD                                                   08015000
OPNMODPD EQU   OPNMOD                                                   08016000
@NM00020 EQU   OPNTYP                                                   08017000
OPNTYPRV EQU   OPNTYP                                                   08018000
OPNTYPEX EQU   OPNTYP                                                   08019000
OPNTYPRA EQU   OPNTYP                                                   08020000
OPNTYPXM EQU   OPNTYP                                                   08021000
OPNTYPCI EQU   OPNTYP                                                   08022000
OPNTYPSO EQU   OPNTYP                                                   08023000
OPNTYPSI EQU   OPNTYP                                                   08024000
@NM00019 EQU   OPNRFM                                                   08025000
OPNRFMBK EQU   OPNRFM                                                   08026000
OPNRFMSF EQU   OPNRFM                                                   08027000
OPNRFMUN EQU   OPNRFM                                                   08028000
OPNRFMVR EQU   OPNRFM                                                   08029000
OPNRFMFX EQU   OPNRFM                                                   08030000
OPNOPTSK EQU   OPNOPT                                                   08031000
OPNOPTDR EQU   OPNOPT                                                   08032000
OPNOPTCR EQU   OPNOPT                                                   08033000
OPNOPTKS EQU   OPNOPT                                                   08034000
OPNOPTBK EQU   OPNOPT                                                   08035000
OPNOPTUP EQU   OPNOPT                                                   08036000
OPNOPTOT EQU   OPNOPT                                                   08037000
OPNOPTIN EQU   OPNOPT                                                   08038000
IOCEXT   EQU   IOCSTR+64                                                08039000
IOCREL   EQU   IOCSTR+60                                                08040000
IOCWORK  EQU   IOCSTR+56                                                08041000
IOCRRN   EQU   IOCSTR+52                                                08042000
IOCPNM   EQU   IOCNWM+2                                                 08043000
IOCPTL   EQU   IOCNWM                                                   08044000
IOCKYA   EQU   IOCMEM                                                   08045000
IOCVRC   EQU   IOCTTR                                                   08046000
IOCCBP   EQU   IOCSTR+36                                                08047000
IOCDSN   EQU   IOCSTR+32                                                08048000
IOCHURBA EQU   IOCSTR+28                                                08049000
IOCVOLSR EQU   IOCSTR+22                                                08050000
@NM00018 EQU   IOCMSG                                                   08051000
IOCMSGAE EQU   IOCMSG                                                   08052000
IOCMSGCE EQU   IOCMSG                                                   08053000
IOCMSGOE EQU   IOCMSG                                                   08054000
IOCMSGOP EQU   IOCMSG                                                   08055000
@NM00017 EQU   IOCMSG                                                   08056000
IOCCHPSY EQU   IOCCHP                                                   08057000
IOCCHPAS EQU   IOCCHP                                                   08058000
IOCCHPBK EQU   IOCCHP                                                   08059000
IOCCHPCR EQU   IOCCHP                                                   08060000
IOCCHPKS EQU   IOCCHP                                                   08061000
IOCCHPSK EQU   IOCCHP                                                   08062000
IOCCHPDR EQU   IOCCHP                                                   08063000
IOCCHPSQ EQU   IOCCHP                                                   08064000
@NM00016 EQU   IOCMAC2                                                  08065000
IOCMACPA EQU   IOCMAC2                                                  08066000
@NM00015 EQU   IOCMAC2                                                  08067000
IOCMACCP EQU   IOCMAC2                                                  08068000
IOCMACRR EQU   IOCMAC2                                                  08069000
IOCMACAS EQU   IOCMAC2                                                  08070000
IOCMACSK EQU   IOCMAC2                                                  08071000
@NM00014 EQU   IOCMAC                                                   08072000
IOCMACCC EQU   IOCMAC                                                   08073000
IOCMACDR EQU   IOCMAC                                                   08074000
IOCMACBK EQU   IOCMAC                                                   08075000
IOCMACCR EQU   IOCMAC                                                   08076000
IOCMACUP EQU   IOCMAC                                                   08077000
IOCMACOT EQU   IOCMAC                                                   08078000
IOCMACIN EQU   IOCMAC                                                   08079000
@NM00013 EQU   IOCRFM                                                   08080000
IOCRFMBK EQU   IOCRFM                                                   08081000
IOCRFMSF EQU   IOCRFM                                                   08082000
IOCRFMUN EQU   IOCRFM                                                   08083000
IOCRFMVR EQU   IOCRFM                                                   08084000
IOCRFMFX EQU   IOCRFM                                                   08085000
@NM00012 EQU   IOCDSO                                                   08086000
IOCDSOPO EQU   IOCDSO                                                   08087000
IOCDSOIS EQU   IOCDSO                                                   08088000
IOCDSOPS EQU   IOCDSO                                                   08089000
IOCDSOAM EQU   IOCDSO                                                   08090000
IOCRKP   EQU   IOCSTR+13                                                08091000
IOCKYL   EQU   IOCSTR+12                                                08092000
IOCTRN   EQU   IOCSTR+8                                                 08093000
IOCDLN   EQU   IOCSTR+4                                                 08094000
IOCDAD   EQU   IOCSTR                                                   08095000
UNITVTOC EQU   UNITABL+7                                                08096000
@NM00011 EQU   UNITSTAT                                                 08097000
UNITUSHR EQU   UNITSTAT                                                 08098000
UNITXSHR EQU   UNITSTAT                                                 08099000
UNITISHR EQU   UNITSTAT                                                 08100000
UNITUA   EQU   @NM00010+1                                               08101000
UNITCHA  EQU   @NM00010                                                 08102000
ALLUNCNT EQU   ALLAGL+30                                                08103000
ALLVLCNT EQU   ALLAGL+29                                                08104000
@NM00009 EQU   ALLOPT                                                   08105000
ALLOPTUN EQU   ALLOPT                                                   08106000
ALLOPTPV EQU   ALLOPT                                                   08107000
ALLOPTDS EQU   ALLOPT                                                   08108000
ALLOPTVL EQU   ALLOPT                                                   08109000
@NM00008 EQU   ALLORG+1                                                 08110000
ALLORGVS EQU   ALLORG+1                                                 08111000
@NM00007 EQU   ALLORG+1                                                 08112000
ALLORGGS EQU   ALLORG+1                                                 08113000
ALLORGUN EQU   ALLORG                                                   08114000
ALLORGPO EQU   ALLORG                                                   08115000
ALLORGMQ EQU   ALLORG                                                   08116000
ALLORGCQ EQU   ALLORG                                                   08117000
ALLORGCX EQU   ALLORG                                                   08118000
ALLORGDA EQU   ALLORG                                                   08119000
ALLORGPS EQU   ALLORG                                                   08120000
ALLORGIS EQU   ALLORG                                                   08121000
ALLDSPUN EQU   ALLDSP                                                   08122000
ALLDSPCG EQU   ALLDSP                                                   08123000
ALLDSPDE EQU   ALLDSP                                                   08124000
ALLDSPKP EQU   ALLDSP                                                   08125000
@NM00006 EQU   ALLDSP                                                   08126000
ALLSTSOD EQU   ALLSTS                                                   08127000
ALLSTSMD EQU   ALLSTS                                                   08128000
ALLSTSNW EQU   ALLSTS                                                   08129000
ALLSTSSR EQU   ALLSTS                                                   08130000
@NM00005 EQU   ALLSTS                                                   08131000
ALLPWD   EQU   ALLAGL+20                                                08132000
ALLVLP   EQU   ALLAGL+16                                                08133000
ALLULP   EQU   ALLAGL+12                                                08134000
ALLDDN   EQU   ALLAGL+4                                                 08135000
ALLDSN   EQU   ALLAGL                                                   08136000
CIRPID   EQU   CIRAGL+28                                                08137000
CIRPWD   EQU   CIRAGL+24                                                08138000
CIRCAT   EQU   CIRAGL+20                                                08139000
CIRWKP   EQU   CIRAGL+16                                                08140000
CIRTLR   EQU   CIRAGL+12                                                08141000
CIRHDR   EQU   CIRAGL+8                                                 08142000
CIRTLN   EQU   CIRAGL+6                                                 08143000
CIRHLN   EQU   CIRAGL+4                                                 08144000
@NM00004 EQU   CIRAGL+1                                                 08145000
@NM00003 EQU   CIRTYPE                                                  08146000
CIRTYPAQ EQU   CIRTYPE                                                  08147000
CIRTYP1Q EQU   CIRTYPE                                                  08148000
NEWID1   EQU   TRACE1+95                                                08149000
CALLID   EQU   OLDERID1+90                                              08150000
@NM00002 EQU   OLDERID1                                                 08151000
@NM00120 EQU   PSA+3668                                                 08152000
PSASTAK  EQU   PSA+3072                                                 08153000
@NM00119 EQU   PSA+1048                                                 08154000
PSAUSEND EQU   PSA+1048                                                 08155000
PSARV062 EQU   PSA+1044                                                 08156000
PSACDAL  EQU   PSA+1040                                                 08157000
PSAWTCOD EQU   PSA+1036                                                 08158000
PSAATCVT EQU   PSA+1032                                                 08159000
PSAPCPSW EQU   PSA+1024                                                 08160000
PSAPIR2  EQU   PSA+1020                                                 08161000
PSARV059 EQU   PSA+1018                                                 08162000
PSASVC13 EQU   PSA+1016                                                 08163000
PSALSFCC EQU   PSA+1012                                                 08164000
PSASFACC EQU   PSA+1008                                                 08165000
PSASTOP  EQU   PSA+992                                                  08166000
PSASTART EQU   PSA+976                                                  08167000
PSARSPSW EQU   PSA+968                                                  08168000
PSASRPSW EQU   PSA+960                                                  08169000
PSARV045 EQU   PSA+892                                                  08170000
PSARV044 EQU   PSA+888                                                  08171000
PSARV043 EQU   PSA+884                                                  08172000
PSARV042 EQU   PSA+880                                                  08173000
PSARV041 EQU   PSA+876                                                  08174000
PSARV040 EQU   PSA+872                                                  08175000
PSARV025 EQU   PSA+868                                                  08176000
PSADSSED EQU   PSA+868                                                  08177000
PSADSSPR EQU   PSA+864                                                  08178000
PSADSSFW EQU   PSA+860                                                  08179000
PSADSS14 EQU   PSA+856                                                  08180000
PSADSSPP EQU   PSA+848                                                  08181000
PSADSSRP EQU   PSA+840                                                  08182000
PSADSS05 EQU   PSADSSF4                                                 08183000
PSADSS10 EQU   PSADSSF4                                                 08184000
PSADSSVE EQU   PSADSSF4                                                 08185000
PSADSSDE EQU   PSADSSF4                                                 08186000
PSADSSC0 EQU   PSADSSF4                                                 08187000
PSADSSIE EQU   PSADSSF4                                                 08188000
PSADSS12 EQU   PSADSSF4                                                 08189000
PSADSSRC EQU   PSADSSF4                                                 08190000
PSARV057 EQU   PSADSSF3                                                 08191000
PSARV056 EQU   PSADSSF3                                                 08192000
PSARV055 EQU   PSADSSF3                                                 08193000
PSADSSMC EQU   PSADSSF3                                                 08194000
PSADSSRW EQU   PSADSSF3                                                 08195000
PSADSSNM EQU   PSADSSF3                                                 08196000
PSADSSES EQU   PSADSSF3                                                 08197000
PSADSSGP EQU   PSADSSF3                                                 08198000
PSADSSF2 EQU   PSADSSFL+1                                               08199000
PSADSSPI EQU   PSADSSF1                                                 08200000
PSADSSOI EQU   PSADSSF1                                                 08201000
PSADSSSP EQU   PSADSSF1                                                 08202000
PSADSSTP EQU   PSADSSF1                                                 08203000
PSADSSDW EQU   PSADSSF1                                                 08204000
PSADSSDD EQU   PSADSSF1                                                 08205000
PSADSSDM EQU   PSADSSF1                                                 08206000
PSADSSMV EQU   PSADSSF1                                                 08207000
PSADSSTS EQU   PSA+816                                                  08208000
PSADSSWK EQU   PSA+812                                                  08209000
PSADSSR3 EQU   PSA+808                                                  08210000
PSADSSR2 EQU   PSA+804                                                  08211000
PSADSSRS EQU   PSA+800                                                  08212000
PSASTOR  EQU   PSA+796                                                  08213000
PSACPUSA EQU   PSA+794                                                  08214000
PSAVSTAP EQU   PSA+792                                                  08215000
PSAWKVAP EQU   PSA+788                                                  08216000
PSAWKRAP EQU   PSA+784                                                  08217000
PSAMCHIC EQU   PSA+783                                                  08218000
PSARV061 EQU   PSA+782                                                  08219000
PSASYMSK EQU   PSA+781                                                  08220000
PSAMCHFL EQU   PSA+780                                                  08221000
PSACR0   EQU   PSA+776                                                  08222000
PSAPSWSV EQU   PSA+768                                                  08223000
PSALITA  EQU   PSA+764                                                  08224000
PSACLHS  EQU   PSAHLHI                                                  08225000
PSALKR15 EQU   PSALKSA+60                                               08226000
PSALKR14 EQU   PSALKSA+56                                               08227000
PSALKR13 EQU   PSALKSA+52                                               08228000
PSALKR12 EQU   PSALKSA+48                                               08229000
PSALKR11 EQU   PSALKSA+44                                               08230000
PSALKR10 EQU   PSALKSA+40                                               08231000
PSALKR9  EQU   PSALKSA+36                                               08232000
PSALKR8  EQU   PSALKSA+32                                               08233000
PSALKR7  EQU   PSALKSA+28                                               08234000
PSALKR6  EQU   PSALKSA+24                                               08235000
PSALKR5  EQU   PSALKSA+20                                               08236000
PSALKR4  EQU   PSALKSA+16                                               08237000
PSALKR3  EQU   PSALKSA+12                                               08238000
PSALKR2  EQU   PSALKSA+8                                                08239000
PSALKR1  EQU   PSALKSA+4                                                08240000
PSALKR0  EQU   PSALKSA                                                  08241000
PSARV023 EQU   PSACLHT+52                                               08242000
PSALOCAL EQU   PSACLHT+48                                               08243000
PSACMSL  EQU   PSACLHT+44                                               08244000
PSAOPTL  EQU   PSACLHT+40                                               08245000
PSATPACL EQU   PSACLHT+36                                               08246000
PSATPDNL EQU   PSACLHT+32                                               08247000
PSATPNCL EQU   PSACLHT+28                                               08248000
PSAIOSLL EQU   PSACLHT+24                                               08249000
PSAIOSUL EQU   PSACLHT+20                                               08250000
PSAIOSCL EQU   PSACLHT+16                                               08251000
PSAIOSSL EQU   PSACLHT+12                                               08252000
PSASALCL EQU   PSACLHT+8                                                08253000
PSAASML  EQU   PSACLHT+4                                                08254000
PSADISPL EQU   PSACLHT                                                  08255000
PSASRSA  EQU   PSA+636                                                  08256000
PSARV050 EQU   PSA+634                                                  08257000
PSADSSGO EQU   PSA+633                                                  08258000
PSARECUR EQU   PSA+632                                                  08259000
PSAHLHIS EQU   PSA+628                                                  08260000
PSAIPCSA EQU   PSA+624                                                  08261000
@NM00118 EQU   PSA+621                                                  08262000
PSAIPCDM EQU   PSA+620                                                  08263000
PSAIPCD  EQU   PSA+616                                                  08264000
@NM00117 EQU   PSA+613                                                  08265000
PSAIPCRM EQU   PSA+612                                                  08266000
PSAIPCR  EQU   PSA+608                                                  08267000
PSAMCHEX EQU   PSA+600                                                  08268000
PSAMPSW  EQU   PSA+592                                                  08269000
PSAEXPS2 EQU   PSA+584                                                  08270000
PSAEXPS1 EQU   PSA+576                                                  08271000
PSAPIREG EQU   PSA+572                                                  08272000
PSARSREG EQU   PSA+568                                                  08273000
PSAGPREG EQU   PSA+556                                                  08274000
PSARV022 EQU   PSASUP4                                                  08275000
PSARV021 EQU   PSASUP4                                                  08276000
PSARV020 EQU   PSASUP4                                                  08277000
PSARV019 EQU   PSASUP4                                                  08278000
PSARV018 EQU   PSASUP4                                                  08279000
PSARV017 EQU   PSASUP4                                                  08280000
PSARV016 EQU   PSASUP4                                                  08281000
PSARV015 EQU   PSASUP4                                                  08282000
PSARV014 EQU   PSASUP3                                                  08283000
PSARV013 EQU   PSASUP3                                                  08284000
PSARV012 EQU   PSASUP3                                                  08285000
PSAESTA  EQU   PSASUP3                                                  08286000
PSASPR   EQU   PSASUP3                                                  08287000
PSAPSREG EQU   PSASUP3                                                  08288000
PSAPI2   EQU   PSASUP3                                                  08289000
PSAIOSUP EQU   PSASUP3                                                  08290000
PSALCR   EQU   PSASUP2                                                  08291000
PSARTM   EQU   PSASUP2                                                  08292000
PSAACR   EQU   PSASUP2                                                  08293000
PSAIPCE2 EQU   PSASUP2                                                  08294000
PSAIPCES EQU   PSASUP2                                                  08295000
PSAIPCEC EQU   PSASUP2                                                  08296000
PSAGTF   EQU   PSASUP2                                                  08297000
PSAIPCRI EQU   PSASUP2                                                  08298000
PSATYPE6 EQU   PSASUP1                                                  08299000
PSATCTL  EQU   PSASUP1                                                  08300000
PSADISP  EQU   PSASUP1                                                  08301000
PSALOCK  EQU   PSASUP1                                                  08302000
PSAPI    EQU   PSASUP1                                                  08303000
PSAEXT   EQU   PSASUP1                                                  08304000
PSASVC   EQU   PSASUP1                                                  08305000
PSAIO    EQU   PSASUP1                                                  08306000
PSAANEW  EQU   PSA+544                                                  08307000
PSATOLD  EQU   PSA+540                                                  08308000
PSATNEW  EQU   PSA+536                                                  08309000
PSALCCAR EQU   PSA+532                                                  08310000
PSALCCAV EQU   PSA+528                                                  08311000
PSAPCCAR EQU   PSA+524                                                  08312000
PSAPCCAV EQU   PSA+520                                                  08313000
PSACPULA EQU   PSA+518                                                  08314000
PSACPUPA EQU   PSA+516                                                  08315000
PSAPSA   EQU   PSA+512                                                  08316000
FLCHDEND EQU   PSA+512                                                  08317000
FLCCRSAV EQU   FLCMCLA+280                                              08318000
FLCGRSAV EQU   FLCMCLA+216                                              08319000
FLCFPSAV EQU   FLCMCLA+184                                              08320000
FLCFLA   EQU   FLCMCLA+88                                               08321000
FLCRGNCD EQU   FLCMCLA+84                                               08322000
FLCFSAA  EQU   FLCFSA+1                                                 08323000
@NM00116 EQU   FLCFSA                                                   08324000
@NM00115 EQU   FLCMCLA+72                                               08325000
FLCMCIC  EQU   FLCMCLA+64                                               08326000
@NM00114 EQU   FLCMCLA+20                                               08327000
FLCIOAA  EQU   FLCIOA+1                                                 08328000
@NM00113 EQU   FLCIOA                                                   08329000
@NM00112 EQU   FLCMCLA+15                                               08330000
@NM00111 EQU   FLCMCLA+14                                               08331000
@NM00110 EQU   FLCMCLA+12                                               08332000
FLCLCL   EQU   FLCMCLA+8                                                08333000
FLCIOELA EQU   FLCIOEL+1                                                08334000
@NM00109 EQU   FLCIOEL                                                  08335000
FLCCHNID EQU   FLCMCLA                                                  08336000
@NM00108 EQU   PSA+160                                                  08337000
FLCMTRCD EQU   PSA+157                                                  08338000
@NM00107 EQU   PSA+156                                                  08339000
FLCPERA  EQU   FLCPER+1                                                 08340000
@NM00106 EQU   FLCPER                                                   08341000
@NM00105 EQU   PSA+151                                                  08342000
FLCPERCD EQU   PSA+150                                                  08343000
FLCMCNUM EQU   PSA+149                                                  08344000
@NM00104 EQU   PSA+148                                                  08345000
FLCTEAA  EQU   FLCTEA+1                                                 08346000
@NM00103 EQU   FLCTEA                                                   08347000
PSAPIPC  EQU   PSAPICOD                                                 08348000
PSAPIMC  EQU   PSAPICOD                                                 08349000
PSAPIPER EQU   PSAPICOD                                                 08350000
PSARV049 EQU   FLCPICOD                                                 08351000
FLCPILCB EQU   FLCPIILC                                                 08352000
@NM00102 EQU   FLCPIILC                                                 08353000
@NM00101 EQU   PSAEPPSW                                                 08354000
FLCSVCN  EQU   PSAESPSW+2                                               08355000
FLCSILCB EQU   FLCSVILC                                                 08356000
@NM00100 EQU   FLCSVILC                                                 08357000
@NM00099 EQU   PSAESPSW                                                 08358000
FLCEICOD EQU   PSAEEPSW+2                                               08359000
PSASPAD  EQU   PSAEEPSW                                                 08360000
@NM00098 EQU   PSA+128                                                  08361000
FLCINPSW EQU   PSA+120                                                  08362000
FLCMNPSW EQU   PSA+112                                                  08363000
FLCPNPSW EQU   PSA+104                                                  08364000
FLCSNPSW EQU   PSA+96                                                   08365000
FLCENPSW EQU   PSA+88                                                   08366000
FLCTRACE EQU   PSA+84                                                   08367000
FLCTIMER EQU   PSA+80                                                   08368000
FLCCVT2  EQU   PSA+76                                                   08369000
FLCCAW   EQU   PSA+72                                                   08370000
FLCCSW   EQU   PSA+64                                                   08371000
FLCIOPSW EQU   PSA+56                                                   08372000
FLCMOPSW EQU   PSA+48                                                   08373000
FLCPOPSW EQU   PSA+40                                                   08374000
FLCSOPSW EQU   PSA+32                                                   08375000
FLCEOPSW EQU   PSA+24                                                   08376000
@NM00097 EQU   FLCICCW2+4                                               08377000
FLCCVT   EQU   FLCICCW2                                                 08378000
FLCICCW1 EQU   FLCROPSW                                                 08379000
FLCIPPSW EQU   FLCRNPSW                                                 08380000
*                                      END UNREFERENCED COMPONENTS      08381000
@RF00324 EQU   @RC00321                                                 08382000
@RF00331 EQU   @RC00321                                                 08383000
@RF00340 EQU   @RC00335                                                 08384000
@RF00347 EQU   @RC00335                                                 08385000
@RF00578 EQU   @RC00565                                                 08386000
@RF00939 EQU   @RC00922                                                 08387000
@RC00932 EQU   @RC00922                                                 08388000
@RT00930 EQU   @RC00922                                                 08389000
@RF01007 EQU   @RC00989                                                 08390000
@RC01014 EQU   @RC00989                                                 08391000
@RC01080 EQU   @RC01079                                                 08392000
@RF01149 EQU   @EL00013                                                 08393000
@RF01339 EQU   @RC01324                                                 08394000
@PB00018 EQU   @EL00001                                                 08395000
@RF01082 EQU   @RC01080                                                 08396000
@PB00017 EQU   @PB00018                                                 08397000
@PB00016 EQU   @PB00017                                                 08398000
@PB00015 EQU   @PB00016                                                 08399000
@PB00014 EQU   @PB00015                                                 08400000
@PB00013 EQU   @PB00014                                                 08401000
@PB00012 EQU   @PB00013                                                 08402000
@PB00011 EQU   @PB00012                                                 08403000
@PB00010 EQU   @PB00011                                                 08404000
@PB00009 EQU   @PB00010                                                 08405000
@PB00008 EQU   @PB00009                                                 08406000
@PB00007 EQU   @PB00008                                                 08407000
@PB00006 EQU   @PB00007                                                 08408000
@PB00005 EQU   @PB00006                                                 08409000
@PB00004 EQU   @PB00005                                                 08410000
@PB00003 EQU   @PB00004                                                 08411000
@PB00002 EQU   @PB00003                                                 08412000
@ENDDATA EQU   *                                                        08413000
         END   IDCSA06,(C'PLS0913',0603,76231)                          08414000
