         TITLE '**************** IDCSA07:   CATALOG SYSTEM ADAPTOR *****00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCSA07  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL2(@EP00002-@MAINENT)                                   00017000
         DC    AL1(16)                                             0002 00018000
         DC    C'IDCSA07   75.323'                                 0002 00019000
IDCSARC  DS    0H                                                  0002 00020000
         USING *,@15                                               0002 00021000
         B     @PROLOG                                             0002 00022000
         DC    AL2(@EP00267-IDCSARC)                                    00023000
         ENTRY IDCSARC                                                  00024000
IDCSAUC  DS    0H                                                  0002 00025000
         USING *,@15                                               0002 00026000
         B     @PROLOG                                             0002 00027000
         DC    AL2(@EP00444-IDCSAUC)                                    00028000
         ENTRY IDCSAUC                                                  00029000
IDCSALC  DS    0H                                                  0002 00030000
         USING *,@15                                               0002 00031000
         B     @PROLOG                                             0002 00032000
         DC    AL2(@EP00596-IDCSALC)                                    00033000
         ENTRY IDCSALC                                                  00034000
         DROP  @15                                                      00035000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00036000
         BALR  @12,0                                               0002 00037000
@PSTART  LA    @10,4095(,@12)                                      0002 00038000
         USING @PSTART,@12                                         0002 00039000
         USING @PSTART+4095,@10                                    0002 00040000
         L     @00,@SIZDATD                                        0002 00041000
         GETMAIN  R,LV=(0)                                              00042000
         LR    @11,@01                                             0002 00043000
         USING @DATD,@11                                           0002 00044000
         ST    @13,@SA00001+4                                      0002 00045000
         LM    @15,@01,16(@13)                                     0002 00046000
         ST    @11,8(,@13)                                         0002 00047000
         LR    @13,@11                                             0002 00048000
         AH    @15,4(,@15)                                         0002 00049000
         BR    @15                                                 0002 00050000
@EP00002 DS    0H                                                  0003 00051000
*                                                                  0266 00052000
*/********************************************************** #Y30LB34*/ 00053000
*/*                                                          #Y30LB34*/ 00054000
*/* ENTRY POINT FOR URECAT                                   @Z40LB30*/ 00055000
*/*                                                          #Y30LB34*/ 00056000
*/********************************************************** #Y30LB34*/ 00057000
*                                                                  0267 00058000
*IDCSARC:                                                          0267 00059000
*   ENTRY(GDTTBL,                   /* GLOBAL DATA TABLE     #Y30LB34*/ 00060000
*       RCTAGLAR);                  /* URECAT ARG LIST       #Y30LB34*/ 00061000
         B     @EC00267                                            0267 00062000
@EP00267 MVC   @PC00001(8),0(@01)                                  0267 00063000
@EC00267 DS    0H                                                  0268 00064000
*                                                                  0268 00065000
*/********************************************************** #Y30LB34*/ 00066000
*/*                                                          #Y30LB34*/ 00067000
*/* THIS IS THE BEGINNING OF THE MAIN PROCEDURE FOR URECAT   @Z40LB30*/ 00068000
*/*                                                          #Y30LB34*/ 00069000
*/* FUNCTION - CALLS PROCEDURES TO:                          #Y30LB34*/ 00070000
*/*                A) GET THE CATALOG ENTRY FOR THE DATA     #Y30LB34*/ 00071000
*/*                   SET,                                   #Y30LB34*/ 00072000
*/*                B) DETERMINE IF THAT DATA SET SHOULD      #Y30LB34*/ 00073000
*/*                   OR COULD BE RECATALOGED,               #Y30LB34*/ 00074000
*/*                C) UPDATE THE VOLUME LIST AND RECATALOG   @Y30LB34*/ 00075000
*/*                   THE DATA SET.                          @Y30LB34*/ 00076000
*/*                                                          @Y30LB34*/ 00077000
*/*********************************************************  @Y30LB34*/ 00078000
*                                                                  0268 00079000
*   /*****************************************************************/ 00080000
*   /*                                                               */ 00081000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 00082000
*   /*                                                               */ 00083000
*   /*****************************************************************/ 00084000
*                                                                  0268 00085000
*   OLDERID2=NEWERID2;                                             0268 00086000
         L     @04,@PC00001                                        0268 00087000
         L     @02,GDTTR2(,@04)                                    0268 00088000
         MVC   @TS00001(95),NEWERID2(@02)                          0268 00089000
         MVC   OLDERID2(95,@02),@TS00001                           0268 00090000
*   NEWID2='RCEX';                  /*                       @Y30LB34*/ 00091000
*                                                                  0269 00092000
         MVC   NEWID2(4,@02),@CC01217                              0269 00093000
*   /*****************************************************************/ 00094000
*   /*                                                               */ 00095000
*   /* ESTABLISH ADDRESSABILITY TO DATA AREAS                @Y30LB34*/ 00096000
*   /*                                                               */ 00097000
*   /*****************************************************************/ 00098000
*                                                                  0270 00099000
*   RESPECIFY                                                      0270 00100000
*     RCTAGL BASED(RCTPTR);         /*                       @Y30LB34*/ 00101000
*   RCTPTR=ADDR(RCTAGLAR);          /*                       @Y30LB34*/ 00102000
         L     RCTPTR,@PC00001+4                                   0271 00103000
*   DDSTRU=ADDR(DARGAREA);          /*                       @Y30LB34*/ 00104000
*                                                                  0272 00105000
         LA    @02,DARGAREA                                        0272 00106000
         ST    @02,DDSTRU                                          0272 00107000
*   /*****************************************************************/ 00108000
*   /*                                                               */ 00109000
*   /* INITIALIZE DATA AREAS AND WORK AREAS                  @Y30LB34*/ 00110000
*   /*                                                               */ 00111000
*   /*****************************************************************/ 00112000
*                                                                  0273 00113000
*   DARGAREA=''B;                   /*                       @Y30LB34*/ 00114000
         XC    DARGAREA(28),DARGAREA                               0273 00115000
*   CAMLST=''B;                     /*                       @Y30LB34*/ 00116000
         XC    CAMLST(20),CAMLST                                   0274 00117000
*   CAMPTR1=ADDR(RCTDSET);          /*                       @Y30LB34*/ 00118000
         LA    @02,RCTDSET(,RCTPTR)                                0275 00119000
         ST    @02,CAMPTR1                                         0275 00120000
*   CAMPTR3=ADDR(WKAREA);           /*                       @Y30LB34*/ 00121000
         LA    @02,WKAREA                                          0276 00122000
         ST    @02,CAMPTR3                                         0276 00123000
*   AREA1=''B;                      /*                       @Y30LB34*/ 00124000
         XC    AREA1(256),AREA1                                    0277 00125000
*   AREA2=''B;                      /*                       @Y30LB34*/ 00126000
         XC    AREA2(9),AREA2                                      0278 00127000
*   RCTHEAD=RECATHDR;               /*                       @Y30LB34*/ 00128000
         MVC   RCTHEAD(8,RCTPTR),@CC01206                          0279 00129000
*                                                                  0280 00130000
*   /*****************************************************************/ 00131000
*   /*                                                               */ 00132000
*   /* ESTABLISH A DUMP POINT AFTER INITIALIZATION OF DATA   @Y30LB34*/ 00133000
*   /* AREAS                                                 @Y30LB34*/ 00134000
*   /*                                                               */ 00135000
*   /*****************************************************************/ 00136000
*                                                                  0280 00137000
*   IF GDTDBG=NULLPTR THEN                                         0280 00138000
         L     @04,GDTDBG(,@04)                                    0280 00139000
         LTR   @04,@04                                             0280 00140000
         BZ    @RT00280                                            0280 00141000
*     ;                                                            0281 00142000
*   ELSE                                                           0282 00143000
*     CALL IDCDB010(GDTTBL,'RCBG'); /*                       @Y30LB34*/ 00144000
*                                                                  0282 00145000
         L     @04,@PC00001                                        0282 00146000
         ST    @04,@AL00001                                        0282 00147000
         LA    @02,@CC01220                                        0282 00148000
         ST    @02,@AL00001+4                                      0282 00149000
         MVI   @AL00001+4,X'80'                                    0282 00150000
         L     @15,GDTDBG(,@04)                                    0282 00151000
         LA    @01,@AL00001                                        0282 00152000
         BALR  @14,@15                                             0282 00153000
*   /*****************************************************************/ 00154000
*   /*                                                               */ 00155000
*   /* CALL GETENT TO RETRIEVE THE CATALOG ENTRY FOR THE     @Y30LB34*/ 00156000
*   /* SPECIFIED DATA SET                                    @Y30LB34*/ 00157000
*   /*                                                               */ 00158000
*   /*****************************************************************/ 00159000
*                                                                  0283 00160000
*   CALL GETENT;                    /*                       @Y30LB34*/ 00161000
@RT00280 BAL   @14,GETENT                                          0283 00162000
*   RESPECIFY                                                      0284 00163000
*     RTNREG RSTD;                                                 0284 00164000
*   TESTRC=RTNREG;                                                 0285 00165000
         STH   RTNREG,TESTRC                                       0285 00166000
*   RESPECIFY                                                      0286 00167000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 00168000
*   SETRC=TESTRC;                   /*                       @Y30LB34*/ 00169000
*                                                                  0287 00170000
         LH    @04,TESTRC                                          0287 00171000
         STH   @04,SETRC                                           0287 00172000
*   /*****************************************************************/ 00173000
*   /*                                                               */ 00174000
*   /* IF THE RETURN CODE FROM GETENT WAS ZERO, CALL TESTENT @Y30LB34*/ 00175000
*   /* TO DETERMINE IF THE DATA SET SHOULD AND CAN BE        @Y30LB34*/ 00176000
*   /* RECATALOGED                                           @Y30LB34*/ 00177000
*   /*                                                               */ 00178000
*   /*****************************************************************/ 00179000
*                                                                  0288 00180000
*   IF SETRC=0 THEN                                                0288 00181000
         LTR   @04,@04                                             0288 00182000
         BNZ   @RF00288                                            0288 00183000
*     DO;                           /*                       @Y30LB34*/ 00184000
*       CALL TESTENT;               /*                       @Y30LB34*/ 00185000
         BAL   @14,TESTENT                                         0290 00186000
*       RESPECIFY                                                  0291 00187000
*         RTNREG RSTD;                                             0291 00188000
*       TESTRC=RTNREG;                                             0292 00189000
         STH   RTNREG,TESTRC                                       0292 00190000
*       RESPECIFY                                                  0293 00191000
*         RTNREG UNRSTD;            /*                       @Y30LB34*/ 00192000
*       SETRC=TESTRC;               /*                       @Y30LB34*/ 00193000
         LH    @04,TESTRC                                          0294 00194000
         STH   @04,SETRC                                           0294 00195000
*                                                                  0295 00196000
*       /*************************************************************/ 00197000
*       /*                                                           */ 00198000
*       /* IF THE RETURN CODE FROM TESTENT WAS ZERO, CALL    @Y30LB34*/ 00199000
*       /* UPDATENT TO UPDATE THE VOLUME LIST AND RECATALOG  @Y30LB34*/ 00200000
*       /* THE DATA SET                                      @Y30LB34*/ 00201000
*       /*                                                           */ 00202000
*       /*************************************************************/ 00203000
*                                                                  0295 00204000
*       IF SETRC=0 THEN                                            0295 00205000
         LTR   @04,@04                                             0295 00206000
         BNZ   @RF00295                                            0295 00207000
*         DO;                       /*                       @Y30LB34*/ 00208000
*           CALL UPDATENT;          /*                       @Y30LB34*/ 00209000
         BAL   @14,UPDATENT                                        0297 00210000
*           RESPECIFY                                              0298 00211000
*             RTNREG RSTD;                                         0298 00212000
*           TESTRC=RTNREG;                                         0299 00213000
         STH   RTNREG,TESTRC                                       0299 00214000
*           RESPECIFY                                              0300 00215000
*             RTNREG UNRSTD;        /*                       @Y30LB34*/ 00216000
*           SETRC=TESTRC;           /*                       @Y30LB34*/ 00217000
         LH    @15,TESTRC                                          0301 00218000
         STH   @15,SETRC                                           0301 00219000
*         END;                      /*                       @Y30LB34*/ 00220000
*     END;                          /*                       @Y30LB34*/ 00221000
*                                                                  0303 00222000
@RF00295 DS    0H                                                  0304 00223000
*   /*****************************************************************/ 00224000
*   /*                                                               */ 00225000
*   /* ESTABLISH A DUMP POINT AT END OF MODULE               @Y30LB34*/ 00226000
*   /*                                                               */ 00227000
*   /*****************************************************************/ 00228000
*                                                                  0304 00229000
*   IF GDTDBG=NULLPTR THEN                                         0304 00230000
@RF00288 L     @15,@PC00001                                        0304 00231000
         L     @15,GDTDBG(,@15)                                    0304 00232000
         LTR   @15,@15                                             0304 00233000
         BZ    @RT00304                                            0304 00234000
*     ;                                                            0305 00235000
*   ELSE                                                           0306 00236000
*     CALL IDCDB010(GDTTBL,'RCND'); /*                       @Y30LB34*/ 00237000
*                                                                  0306 00238000
         L     @15,@PC00001                                        0306 00239000
         ST    @15,@AL00001                                        0306 00240000
         LA    @14,@CC01224                                        0306 00241000
         ST    @14,@AL00001+4                                      0306 00242000
         MVI   @AL00001+4,X'80'                                    0306 00243000
         L     @15,GDTDBG(,@15)                                    0306 00244000
         LA    @01,@AL00001                                        0306 00245000
         BALR  @14,@15                                             0306 00246000
*   /*****************************************************************/ 00247000
*   /*                                                               */ 00248000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 00249000
*   /*                                                               */ 00250000
*   /*****************************************************************/ 00251000
*                                                                  0307 00252000
*   CALL IDCSAEP0(GDTTBL,MODID,SETRC);/*                     @Y30LB34*/ 00253000
@RT00304 L     @15,@PC00001                                        0307 00254000
         ST    @15,@AL00001                                        0307 00255000
         LA    @14,MODID                                           0307 00256000
         ST    @14,@AL00001+4                                      0307 00257000
         LA    @14,SETRC                                           0307 00258000
         ST    @14,@AL00001+8                                      0307 00259000
         MVI   @AL00001+8,X'80'                                    0307 00260000
         L     @15,GDTEPL(,@15)                                    0307 00261000
         LA    @01,@AL00001                                        0307 00262000
         BALR  @14,@15                                             0307 00263000
*                                                                  0308 00264000
*/*********************************************************  #Y30LB34*/ 00265000
*/*                                                          #Y30LB34*/ 00266000
*/* PROCEDURE NAME - GETENT                                  #Y30LB34*/ 00267000
*/*                                                          @Y30LB34*/ 00268000
*/* FUNCTION - ISSUES THE LOCATE MACRO TO RETRIEVE THE       @Y30LB34*/ 00269000
*/*            CATALOG ENTRY FOR THE DATA SET                @Y30LB34*/ 00270000
*/*                                                          @Y30LB34*/ 00271000
*/*            PRINTS MESSAGE IDC2100I IF THE RETURN CODE    @Y30LB34*/ 00272000
*/*            FROM LOCATE IS NOT 0 OR 8, AND PRINTS         @Y30LB34*/ 00273000
*/*            MESSAGE IDC0396I NOTIFYING THE DATA SET WAS   @Y30LB34*/ 00274000
*/*            NOT RECATALOGED.                              @Y30LB34*/ 00275000
*/*                                                          @Y30LB34*/ 00276000
*/* INPUT - CAMLST,RCTAGL                                    @Y30LB34*/ 00277000
*/*                                                          @Y30LB34*/ 00278000
*/* OUTPUT - WKAREA                                          @Y30LB34*/ 00279000
*/*                                                          @Y30LB34*/ 00280000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 00281000
*/*            R. C. = 0, SUCCESSFUL COMPLETION              @Y30LB34*/ 00282000
*/*            R. C. = 4, ERROR LOCATING DATA SET            @Y30LB34*/ 00283000
*/*            R. C. = 8, DATA SET NOT FOUND IN CATALOGS     @Y30LB34*/ 00284000
*/*                                                          @Y30LB34*/ 00285000
*/*********************************************************  @Y30LB34*/ 00286000
*                                                                  0308 00287000
*GETENT:                                                           0308 00288000
*   PROCEDURE;                      /*                       @Y30LB34*/ 00289000
         B     @PB00002                                            0308 00290000
GETENT   STM   @14,@12,@SA00002                                    0308 00291000
*                                                                  0309 00292000
*   /*****************************************************************/ 00293000
*   /*                                                               */ 00294000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/ 00295000
*   /*                                                               */ 00296000
*   /*****************************************************************/ 00297000
*                                                                  0309 00298000
*   CC01=0;                         /*                       @Y30LB34*/ 00299000
*                                                                  0309 00300000
         SLR   CC01,CC01                                           0309 00301000
*   /*****************************************************************/ 00302000
*   /*                                                               */ 00303000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 00304000
*   /*                                                               */ 00305000
*   /*****************************************************************/ 00306000
*                                                                  0310 00307000
*   OLDERID2=NEWERID2;                                             0310 00308000
         L     @15,@PC00001                                        0310 00309000
         L     @15,GDTTR2(,@15)                                    0310 00310000
         MVC   @TS00001(95),NEWERID2(@15)                          0310 00311000
         MVC   OLDERID2(95,@15),@TS00001                           0310 00312000
*   NEWID2='RCGE';                  /*                       @Y30LB34*/ 00313000
*                                                                  0311 00314000
         MVC   NEWID2(4,@15),@CC01228                              0311 00315000
*   /*****************************************************************/ 00316000
*   /*                                                               */ 00317000
*   /* INITIALIZE THE CAMLST OPTION1 TO LOCATE BY NAME       @Y30LB34*/ 00318000
*   /*                                                               */ 00319000
*   /*****************************************************************/ 00320000
*                                                                  0312 00321000
*   CAMOPTN1=LOCNAME;               /*                       @Y30LB34*/ 00322000
*                                                                  0312 00323000
         MVI   CAMOPTN1,B'00000000'                                0312 00324000
*   /*****************************************************************/ 00325000
*   /*                                                               */ 00326000
*   /* ISSUE THE LOCATE MACRO POINTING TO CAMLST CODED BY    @Y30LB34*/ 00327000
*   /* IDCSARC                                               @Y30LB34*/ 00328000
*   /*                                                               */ 00329000
*   /*****************************************************************/ 00330000
*                                                                  0313 00331000
*LLOCAT1:                                                          0313 00332000
*   GEN(LOCATE CAMLST);             /*                       @Y30LB34*/ 00333000
LLOCAT1  LOCATE CAMLST                                                  00334000
*   RESPECIFY                                                      0314 00335000
*     RTNREG RSTD;                                                 0314 00336000
*   TESTRC=RTNREG;                                                 0315 00337000
         STH   RTNREG,TESTRC                                       0315 00338000
*   RESPECIFY                                                      0316 00339000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 00340000
*                                                                  0317 00341000
*   /*****************************************************************/ 00342000
*   /*                                                               */ 00343000
*   /* ESTABLISH A DUMP POINT FOR THE VOLUME LIST RETURNED   @Y30LB34*/ 00344000
*   /* BY LOCATE                                             @Y30LB34*/ 00345000
*   /*                                                               */ 00346000
*   /*****************************************************************/ 00347000
*                                                                  0317 00348000
*   IF GDTDBG=NULLPTR THEN                                         0317 00349000
         L     @15,@PC00001                                        0317 00350000
         L     @15,GDTDBG(,@15)                                    0317 00351000
         LTR   @15,@15                                             0317 00352000
         BZ    @RT00317                                            0317 00353000
*     ;                                                            0318 00354000
*   ELSE                                                           0319 00355000
*     DO;                                                          0319 00356000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB34*/ 00357000
         LA    DMPINDEX,DUMPAREA                                   0320 00358000
*       DMPITMNM='WKAREA';                                         0321 00359000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0321 00360000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0321 00361000
         MVC   DMPITMNM(6,DMPINDEX),@CC01231                       0321 00362000
*       DMPITMPT=ADDR(WKAREA);                                     0322 00363000
         LA    @03,WKAREA                                          0322 00364000
         ST    @03,DMPITMPT(,DMPINDEX)                             0322 00365000
*       DMPITMLN=LENGTH(AREA1)+LENGTH(AREA2);                      0323 00366000
         MVC   DMPITMLN(2,DMPINDEX),@CH01342                       0323 00367000
*       DMPITMTP='H';                                              0324 00368000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0324 00369000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB34*/ 00370000
         AL    DMPINDEX,@CF00466                                   0325 00371000
*       DMPTRM=DMPTRMVL;                                           0326 00372000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0326 00373000
*     END;                          /*                       @Y30LB34*/ 00374000
*   IF GDTDBG=NULLPTR THEN                                         0328 00375000
@RT00317 L     @15,@PC00001                                        0328 00376000
         L     @15,GDTDBG(,@15)                                    0328 00377000
         LTR   @15,@15                                             0328 00378000
         BZ    @RT00328                                            0328 00379000
*     ;                                                            0329 00380000
*   ELSE                                                           0330 00381000
*     CALL IDCDB010(GDTTBL,'RCAC',ADDR(DUMPAREA));/*         @Y30LB34*/ 00382000
*                                                                  0330 00383000
         L     @15,@PC00001                                        0330 00384000
         ST    @15,@AL00001                                        0330 00385000
         LA    @14,@CC01233                                        0330 00386000
         ST    @14,@AL00001+4                                      0330 00387000
         LA    @14,DUMPAREA                                        0330 00388000
         ST    @14,@AFTEMPS                                        0330 00389000
         LA    @14,@AFTEMPS                                        0330 00390000
         ST    @14,@AL00001+8                                      0330 00391000
         MVI   @AL00001+8,X'80'                                    0330 00392000
         L     @15,GDTDBG(,@15)                                    0330 00393000
         LA    @01,@AL00001                                        0330 00394000
         BALR  @14,@15                                             0330 00395000
*   /*****************************************************************/ 00396000
*   /*                                                               */ 00397000
*   /* IF LOCATE RETURNED A CODE GREATER THAN ZERO           @Y30LB34*/ 00398000
*   /* DETERMINE TYPE OF ERROR                               @Y30LB34*/ 00399000
*   /*                                                               */ 00400000
*   /*****************************************************************/ 00401000
*                                                                  0331 00402000
*   IF TESTRC>0 THEN                                               0331 00403000
@RT00328 LH    @15,TESTRC                                          0331 00404000
         LTR   @15,@15                                             0331 00405000
         BNP   @RF00331                                            0331 00406000
*     DO;                           /*                       @Y30LB34*/ 00407000
*                                                                  0333 00408000
*       /*************************************************************/ 00409000
*       /*                                                           */ 00410000
*       /* IF RETURN CODE IS 8, INDICATING THE ENTRY WAS     @Y30LB34*/ 00411000
*       /* NOT FOUND, SET CONDITION CODE TO 8                @Y30LB34*/ 00412000
*       /*                                                           */ 00413000
*       /*************************************************************/ 00414000
*                                                                  0333 00415000
*       IF TESTRC=NOTFOUND THEN                                    0333 00416000
         LA    @04,8                                               0333 00417000
         CR    @15,@04                                             0333 00418000
         BNE   @RF00333                                            0333 00419000
*         CC01=8;                   /*                       @Y30LB34*/ 00420000
*                                                                  0334 00421000
         LA    @15,8                                               0334 00422000
         LR    CC01,@15                                            0334 00423000
*       /*************************************************************/ 00424000
*       /*                                                           */ 00425000
*       /* IF RETURN CODE IS NOT 8, INDICATING AN ERROR,     @Y30LB34*/ 00426000
*       /* PRINT MESSAGE IDC2100I INFORMING THE USER WHAT    @Y30LB34*/ 00427000
*       /* THE RETURN CODE IS, AND PRINTS MESSAGE IDC0396I   @Y30LB34*/ 00428000
*       /* STATING THE DATA SET WAS NOT RECATALOGED          @Y30LB34*/ 00429000
*       /*                                                           */ 00430000
*       /*************************************************************/ 00431000
*                                                                  0335 00432000
*       ELSE                                                       0335 00433000
*         DO;                       /*                       @Y30LB34*/ 00434000
         B     @RC00333                                            0335 00435000
@RF00333 DS    0H                                                  0336 00436000
*           DARGSMOD=SA07MSG;       /*                       @Y30LB34*/ 00437000
         L     @15,DDSTRU                                          0336 00438000
         MVC   DARGSMOD(3,@15),@CC01179                            0336 00439000
*           DARGSENT=MSG2100I;      /*                       @Y30LB34*/ 00440000
         MVI   DARGSENT(@15),X'03'                                 0337 00441000
*           DARGDBP=ADDR(TESTRC);   /*                       @Y30LB34*/ 00442000
         LA    @14,TESTRC                                          0338 00443000
         ST    @14,DARGDBP(,@15)                                   0338 00444000
*           DARGILP=LENGTH(TESTRC); /*                       @Y30LB34*/ 00445000
         MVC   DARGILP(2,@15),@CH00147                             0339 00446000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 00447000
         L     @15,@PC00001                                        0340 00448000
         ST    @15,@AL00001                                        0340 00449000
         LA    @14,@CF00109                                        0340 00450000
         ST    @14,@AL00001+4                                      0340 00451000
         LA    @14,DDSTRU                                          0340 00452000
         ST    @14,@AL00001+8                                      0340 00453000
         MVI   @AL00001+8,X'80'                                    0340 00454000
         L     @15,GDTPRT(,@15)                                    0340 00455000
         LA    @01,@AL00001                                        0340 00456000
         BALR  @14,@15                                             0340 00457000
*           DARGSMOD=SA07MSG;       /*                       @Y30LB34*/ 00458000
         L     @15,DDSTRU                                          0341 00459000
         MVC   DARGSMOD(3,@15),@CC01179                            0341 00460000
*           DARGSENT=MSG0396I;      /*                       @Y30LB34*/ 00461000
         MVI   DARGSENT(@15),X'01'                                 0342 00462000
*           DARGDBP=ADDR(RCTDSET);  /*                       @Y30LB34*/ 00463000
         LA    @14,RCTDSET(,RCTPTR)                                0343 00464000
         ST    @14,DARGDBP(,@15)                                   0343 00465000
*           DARGILP=LENGTH(RCTDSET);/*                       @Y30LB34*/ 00466000
         MVC   DARGILP(2,@15),@CH00767                             0344 00467000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 00468000
         L     @15,@PC00001                                        0345 00469000
         ST    @15,@AL00001                                        0345 00470000
         LA    @14,@CF00109                                        0345 00471000
         ST    @14,@AL00001+4                                      0345 00472000
         LA    @14,DDSTRU                                          0345 00473000
         ST    @14,@AL00001+8                                      0345 00474000
         MVI   @AL00001+8,X'80'                                    0345 00475000
         L     @15,GDTPRT(,@15)                                    0345 00476000
         LA    @01,@AL00001                                        0345 00477000
         BALR  @14,@15                                             0345 00478000
*           CC01=4;                 /*                       @Y30LB34*/ 00479000
         LA    CC01,4                                              0346 00480000
*         END;                      /*                       @Y30LB34*/ 00481000
*     END;                          /*                       @Y30LB34*/ 00482000
*                                                                  0348 00483000
@RC00333 DS    0H                                                  0349 00484000
*   /*****************************************************************/ 00485000
*   /*                                                               */ 00486000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 00487000
*   /*                                                               */ 00488000
*   /*****************************************************************/ 00489000
*                                                                  0349 00490000
*   RETURN CODE(CC01);              /*                       @Y30LB34*/ 00491000
@RF00331 LR    @15,CC01                                            0349 00492000
         L     @14,@SA00002                                        0349 00493000
         LM    @00,@12,@SA00002+8                                  0349 00494000
         BR    @14                                                 0349 00495000
*   END GETENT;                     /*                       @Y30LB34*/ 00496000
*                                                                  0351 00497000
*/********************************************************** @Y30LB34*/ 00498000
*/*                                                          @Y30LB34*/ 00499000
*/* PROCEDURE NAME - TESTENT                                 @Y30LB34*/ 00500000
*/*                                                          @Y30LB34*/ 00501000
*/* FUNCTION - DETERMINES IF DATA SET RESIDES ON MORE OR     @Y30LB34*/ 00502000
*/*            LESS THAN 20 VOLUMES.                         @Y30LB34*/ 00503000
*/*                                                          @Y30LB34*/ 00504000
*/*            IF LESS THAN OR EQUAL TO 20 VOLUMES,          @Y30LB34*/ 00505000
*/*            SEARCHES THE VOLUME LIST FOR A MATCH WITH     @Y30LB34*/ 00506000
*/*            THE OLD DEVTYPE/VOLSER.  IF FOUND, SAVES      @Y30LB34*/ 00507000
*/*            THE ENTRY NUMBER.                             @Y30LB34*/ 00508000
*/*                                                          @Y30LB34*/ 00509000
*/*            IF MORE THAN 20 VOLUMES, SEARCHES THE VOLUME  @Y30LB34*/ 00510000
*/*            LIST FOR A MATCH WITH THE NEW DEVTYPE/        @Y30LB34*/ 00511000
*/*            VOLSER.  IF FOUND, THE DATA SET HAS BEEN      @Y30LB34*/ 00512000
*/*            RECATALOGED.  IF NOT FOUND, PRINTS MESSAGE    @Y30LB34*/ 00513000
*/*            IDC0398I NOTIFYING THE USER THE DATA SET      @Y30LB34*/ 00514000
*/*            RESIDES ON MORE THAN 20 VOLUMES, AND MESSAGE  @Y30LB34*/ 00515000
*/*            IDC0396I, NOTIFYING THE USER THE DATA SET     @Y30LB34*/ 00516000
*/*            WAS NOT RECATALOGED.                          @Y30LB34*/ 00517000
*/*                                                          @Y30LB34*/ 00518000
*/* INPUT - WKAREA,RCTAGL                                    @Y30LB34*/ 00519000
*/*                                                          @Y30LB34*/ 00520000
*/* OUTPUT - ENTRY NUMBER                                    @Y30LB34*/ 00521000
*/*                                                          @Y30LB34*/ 00522000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB34*/ 00523000
*/*            R. C. =  0, DATA SET CAN BE RECATALOGED       @Y30LB34*/ 00524000
*/*            R. C. =  8, DATA SET ALREADY RECATALOGED,     @Y30LB34*/ 00525000
*/*                        RECATALOGING NOT SUPPORTED        @Y30LB34*/ 00526000
*/*                        BECAUSE DATA SET RESIDES ON       @Y30LB34*/ 00527000
*/*                        MORE THAN 20 VOLUMES.             @Y30LB34*/ 00528000
*/*                                                          @Y30LB34*/ 00529000
*/********************************************************** @Y30LB34*/ 00530000
*                                                                  0351 00531000
*TESTENT:                                                          0351 00532000
*   PROCEDURE;                      /*                       @Y30LB34*/ 00533000
TESTENT  STM   @14,@02,@SA00003                                    0351 00534000
         STM   @04,@12,@SA00003+20                                 0351 00535000
*                                                                  0352 00536000
*   /*****************************************************************/ 00537000
*   /*                                                               */ 00538000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 00539000
*   /*                                                               */ 00540000
*   /*****************************************************************/ 00541000
*                                                                  0352 00542000
*   OLDERID2=NEWERID2;                                             0352 00543000
         L     @02,@PC00001                                        0352 00544000
         L     @02,GDTTR2(,@02)                                    0352 00545000
         MVC   @TS00001(95),NEWERID2(@02)                          0352 00546000
         MVC   OLDERID2(95,@02),@TS00001                           0352 00547000
*   NEWID2='RCTE';                  /*                       @Y30LB34*/ 00548000
*                                                                  0353 00549000
         MVC   NEWID2(4,@02),@CC01237                              0353 00550000
*   /*****************************************************************/ 00551000
*   /*                                                               */ 00552000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/ 00553000
*   /*                                                               */ 00554000
*   /*****************************************************************/ 00555000
*                                                                  0354 00556000
*   CC01=0;                         /*                       @Y30LB34*/ 00557000
*                                                                  0354 00558000
         SLR   @02,@02                                             0354 00559000
         LR    CC01,@02                                            0354 00560000
*   /*****************************************************************/ 00561000
*   /*                                                               */ 00562000
*   /* SET UP THE DEVICE TYPE IN A HOLD AREA SO WE           @ZM01090*/ 00563000
*   /* CAN AND OUT THE BITS THAT ARE NOT NEEDED FOR CATALOGING       */ 00564000
*   /*                                                       @ZM01090*/ 00565000
*   /*                                                               */ 00566000
*   /*****************************************************************/ 00567000
*                                                                  0355 00568000
*   TSTRCTND=RCTNDEV;               /*                       @ZM01090*/ 00569000
         MVC   TSTRCTND(4),RCTNDEV(RCTPTR)                         0355 00570000
*   TSTRCTOD=RCTODEV;               /*                       @ZM01090*/ 00571000
*                                                                  0356 00572000
         MVC   TSTRCTOD(4),RCTODEV(RCTPTR)                         0356 00573000
*   /*****************************************************************/ 00574000
*   /*                                                               */ 00575000
*   /* USE THE MASK TO AND OUT THE UNUSED BITS FROM          @ZM01090*/ 00576000
*   /* THE DEVTYPE WE GOT FROM THE UCB SO THAT OUR COMPARES AND      */ 00577000
*   /* CATALOGING ARE DONE CORRECTLY                         @ZM01090*/ 00578000
*   /*                                                               */ 00579000
*   /*****************************************************************/ 00580000
*                                                                  0357 00581000
*   TSTOCODE=TSTOCODE&TSTDMASK;     /*                       @ZM01090*/ 00582000
         NC    TSTOCODE(2),TSTDMASK                                0357 00583000
*   TSTNCODE=TSTNCODE&TSTDMASK;     /*                       @ZM01090*/ 00584000
*                                                                  0358 00585000
         NC    TSTNCODE(2),TSTDMASK                                0358 00586000
*   /*****************************************************************/ 00587000
*   /*                                                               */ 00588000
*   /* IF DATA SET IS ON 20 VOLUMES OR LESS FIND THE         #Y30LB34*/ 00589000
*   /* ENTRY TO BE UPDATED                                   @Y30LB34*/ 00590000
*   /*                                                               */ 00591000
*   /*****************************************************************/ 00592000
*                                                                  0359 00593000
*   IF VOLCOUNT<=VOLLIMIT THEN                                     0359 00594000
         LH    @15,VOLCOUNT                                        0359 00595000
         C     @15,@CF01109                                        0359 00596000
         BH    @RF00359                                            0359 00597000
*     DO;                           /*                       @Y30LB34*/ 00598000
*       NUMBER=0;                   /*                       @Y30LB34*/ 00599000
         SLR   @15,@15                                             0361 00600000
         LR    NUMBER,@15                                          0361 00601000
*       DO UNTIL(NUMBER=VOLCOUNT|(DEVCODE(NUMBER)=TSTRCTOD/* @ZM01090*/ 00602000
*             &VOLSER(NUMBER)=RCTOVOL));/*                   @Y30LB34*/ 00603000
@DL00362 DS    0H                                                  0363 00604000
*         NUMBER=NUMBER+1;          /*                       @Y30LB34*/ 00605000
         AL    NUMBER,@CF00213                                     0363 00606000
*       END;                        /*                       @Y30LB34*/ 00607000
*                                                                  0364 00608000
@DE00362 CH    NUMBER,VOLCOUNT                                     0364 00609000
         BE    @DC00362                                            0364 00610000
         LR    @15,NUMBER                                          0364 00611000
         MH    @15,@CH00032                                        0364 00612000
         LA    @14,DEVCODE-12(@15)                                 0364 00613000
         CLC   0(4,@14),TSTRCTOD                                   0364 00614000
         BNE   @DL00362                                            0364 00615000
         LA    @14,VOLSER-12(@15)                                  0364 00616000
         CLC   0(6,@14),RCTOVOL(RCTPTR)                            0364 00617000
         BNE   @DL00362                                            0364 00618000
@DC00362 DS    0H                                                  0365 00619000
*       /*************************************************************/ 00620000
*       /*                                                           */ 00621000
*       /* IF DEVICE TYPE/VOLSER OF OLD VOLUME DOES          @Y30LB34*/ 00622000
*       /* MATCH DEVICE TYPE/VOLSER ENTRY IN CATALOG,        @Y30LB34*/ 00623000
*       /* RECATALOGING WILL TAKE PLACE. OTHERWISE           @Y30LB34*/ 00624000
*       /* SET RETURN CODE TO 8.                             @Y30LB34*/ 00625000
*       /*                                                           */ 00626000
*       /*************************************************************/ 00627000
*                                                                  0365 00628000
*       IF DEVCODE(NUMBER)=TSTRCTOD&VOLSER(NUMBER)=RCTOVOL THEN    0365 00629000
         LR    @15,NUMBER                                          0365 00630000
         MH    @15,@CH00032                                        0365 00631000
         LA    @14,DEVCODE-12(@15)                                 0365 00632000
         CLC   0(4,@14),TSTRCTOD                                   0365 00633000
         BNE   @RF00365                                            0365 00634000
         LA    @14,VOLSER-12(@15)                                  0365 00635000
         CLC   0(6,@14),RCTOVOL(RCTPTR)                            0365 00636000
         BNE   @RF00365                                            0365 00637000
*         ENTNO=NUMBER;             /*                       @Y30LB34*/ 00638000
         LR    ENTNO,NUMBER                                        0366 00639000
*       ELSE                                                       0367 00640000
*         CC01=8;                   /*                       @Y30LB34*/ 00641000
         B     @RC00365                                            0367 00642000
@RF00365 LA    CC01,8                                              0367 00643000
*     END;                          /*                       @Y30LB34*/ 00644000
*                                                                  0369 00645000
*   /*****************************************************************/ 00646000
*   /*                                                               */ 00647000
*   /* IF DATA SET IS ON MORE THAN 20 VOLUMES DETERMINE IF   @Y30LB34*/ 00648000
*   /* DATA SET HAS BEEN RECATALOGED                         @Y30LB34*/ 00649000
*   /*                                                               */ 00650000
*   /*****************************************************************/ 00651000
*                                                                  0369 00652000
*   ELSE                                                           0369 00653000
*     DO;                           /*                       @Y30LB34*/ 00654000
         B     @RC00359                                            0369 00655000
@RF00359 DS    0H                                                  0370 00656000
*       NUMBER=0;                   /*                       @Y30LB34*/ 00657000
         SLR   NUMBER,NUMBER                                       0370 00658000
*       DO UNTIL(NUMBER=VOLLIMIT|(DEVCODE(NUMBER)=TSTRCTND&VOLSER( 0371 00659000
*             NUMBER)=RCTNVOL));    /*                       @Y30LB34*/ 00660000
@DL00371 DS    0H                                                  0372 00661000
*         NUMBER=NUMBER+1;          /*                       @Y30LB34*/ 00662000
         AL    NUMBER,@CF00213                                     0372 00663000
*       END;                        /*                       @Y30LB34*/ 00664000
*                                                                  0373 00665000
@DE00371 C     NUMBER,@CF01109                                     0373 00666000
         BE    @DC00371                                            0373 00667000
         LR    @04,NUMBER                                          0373 00668000
         MH    @04,@CH00032                                        0373 00669000
         LA    @01,DEVCODE-12(@04)                                 0373 00670000
         CLC   0(4,@01),TSTRCTND                                   0373 00671000
         BNE   @DL00371                                            0373 00672000
         LA    @01,VOLSER-12(@04)                                  0373 00673000
         CLC   0(6,@01),RCTNVOL(RCTPTR)                            0373 00674000
         BNE   @DL00371                                            0373 00675000
@DC00371 DS    0H                                                  0374 00676000
*       /*************************************************************/ 00677000
*       /*                                                           */ 00678000
*       /* IF DEVICE TYPE/VOLSER OF NEW VOLUME MATCH DEVICE  @Y30LB34*/ 00679000
*       /* TYPE/VOLUME ENTRY IN CATALOG, DATA SET HAS BEEN   @Y30LB34*/ 00680000
*       /* RECATALOGED. SET RETURN CODE TO 8.                @Y30LB34*/ 00681000
*       /*                                                           */ 00682000
*       /*************************************************************/ 00683000
*                                                                  0374 00684000
*       IF(DEVCODE(NUMBER)=TSTRCTND&VOLSER(NUMBER)=RCTNVOL) THEN   0374 00685000
         LR    @04,NUMBER                                          0374 00686000
         MH    @04,@CH00032                                        0374 00687000
         LA    @01,DEVCODE-12(@04)                                 0374 00688000
         CLC   0(4,@01),TSTRCTND                                   0374 00689000
         BNE   @RF00374                                            0374 00690000
         LA    @01,VOLSER-12(@04)                                  0374 00691000
         CLC   0(6,@01),RCTNVOL(RCTPTR)                            0374 00692000
         BNE   @RF00374                                            0374 00693000
*         CC01=8;                   /*                       @Y30LB34*/ 00694000
*                                                                  0375 00695000
         LA    CC01,8                                              0375 00696000
*       /*************************************************************/ 00697000
*       /*                                                           */ 00698000
*       /* IF NO MATCH ON DEVICE TYPE/VOLSER, THE DATA SET   @Y30LB34*/ 00699000
*       /* HAS NOT BEEN RECATALOGED ON FIRST 20 VOLUMES.     @Y30LB34*/ 00700000
*       /* PRINT MESSAGE IDC0398I STATING DATA SET RESIDES   @Y30LB34*/ 00701000
*       /* ON MORE THAN 20 VOLUMES, AND MESSAGE IDC0396I     @Y30LB34*/ 00702000
*       /* NOTIFYING DATA SET NOT RECATALOGED.               @Y30LB34*/ 00703000
*       /*                                                           */ 00704000
*       /*************************************************************/ 00705000
*                                                                  0376 00706000
*       ELSE                                                       0376 00707000
*         DO;                       /*                       @Y30LB34*/ 00708000
         B     @RC00374                                            0376 00709000
@RF00374 DS    0H                                                  0377 00710000
*           DARGAREA=''B;           /*                       @Y30LB34*/ 00711000
         XC    DARGAREA(28),DARGAREA                               0377 00712000
*           DARGSMOD=SA07MSG;       /*                       @Y30LB34*/ 00713000
         L     @02,DDSTRU                                          0378 00714000
         MVC   DARGSMOD(3,@02),@CC01179                            0378 00715000
*           DARGSENT=MSG0398I;      /*                       @Y30LB34*/ 00716000
         MVI   DARGSENT(@02),X'05'                                 0379 00717000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 00718000
         L     @02,@PC00001                                        0380 00719000
         ST    @02,@AL00001                                        0380 00720000
         LA    @15,@CF00109                                        0380 00721000
         ST    @15,@AL00001+4                                      0380 00722000
         LA    @15,DDSTRU                                          0380 00723000
         ST    @15,@AL00001+8                                      0380 00724000
         MVI   @AL00001+8,X'80'                                    0380 00725000
         L     @15,GDTPRT(,@02)                                    0380 00726000
         LA    @01,@AL00001                                        0380 00727000
         BALR  @14,@15                                             0380 00728000
*           DARGSMOD=SA07MSG;       /*                       @Y30LB34*/ 00729000
         L     @02,DDSTRU                                          0381 00730000
         MVC   DARGSMOD(3,@02),@CC01179                            0381 00731000
*           DARGSENT=MSG0396I;      /*                       @Y30LB34*/ 00732000
         MVI   DARGSENT(@02),X'01'                                 0382 00733000
*           DARGDBP=ADDR(RCTDSET);  /*                       @Y30LB34*/ 00734000
         LA    @15,RCTDSET(,RCTPTR)                                0383 00735000
         ST    @15,DARGDBP(,@02)                                   0383 00736000
*           DARGILP=LENGTH(RCTDSET);/*                       @Y30LB34*/ 00737000
         MVC   DARGILP(2,@02),@CH00767                             0384 00738000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB34*/ 00739000
         L     @02,@PC00001                                        0385 00740000
         ST    @02,@AL00001                                        0385 00741000
         LA    @15,@CF00109                                        0385 00742000
         ST    @15,@AL00001+4                                      0385 00743000
         LA    @15,DDSTRU                                          0385 00744000
         ST    @15,@AL00001+8                                      0385 00745000
         MVI   @AL00001+8,X'80'                                    0385 00746000
         L     @15,GDTPRT(,@02)                                    0385 00747000
         LA    @01,@AL00001                                        0385 00748000
         BALR  @14,@15                                             0385 00749000
*           CC01=8;                 /*                       @Y30LB34*/ 00750000
         LA    CC01,8                                              0386 00751000
*         END;                      /*                       @Y30LB34*/ 00752000
*     END;                          /*                       @Y30LB34*/ 00753000
*                                                                  0388 00754000
@RC00374 DS    0H                                                  0389 00755000
*   /*****************************************************************/ 00756000
*   /*                                                               */ 00757000
*   /* RETURN TO CALLER                                      @Y30LB34*/ 00758000
*   /*                                                               */ 00759000
*   /*****************************************************************/ 00760000
*                                                                  0389 00761000
*   RETURN CODE(CC01);              /*                       @Y30LB34*/ 00762000
@RC00359 LR    @15,CC01                                            0389 00763000
         L     @14,@SA00003                                        0389 00764000
         LM    @00,@02,@SA00003+8                                  0389 00765000
         LM    @04,@12,@SA00003+20                                 0389 00766000
         BR    @14                                                 0389 00767000
*   END TESTENT;                    /*                       @Y30LB34*/ 00768000
*                                                                  0391 00769000
*/*********************************************************  @Y30LB34*/ 00770000
*/*                                                          @Y30LB34*/ 00771000
*/* PROCEDURE NAME - UPDATENT                                @Y30LB34*/ 00772000
*/*                                                          @Y30LB34*/ 00773000
*/* FUNCTION - UPDATES THE DEVICE TYPE AND VOLUME SERIAL     @Y30LB34*/ 00774000
*/*            NUMBER IN VOLUME LIST ENTRY                   @Y30LB34*/ 00775000
*/*                                                          @Y30LB34*/ 00776000
*/*            ISSUES THE CATALOG MACRO TO RECATALOG THE     @Y30LB34*/ 00777000
*/*            DATA SET                                      @Y30LB34*/ 00778000
*/*                                                          @Y30LB34*/ 00779000
*/* INPUT - WKAREA, RCTAGL, CAMLST                           @Y30LB34*/ 00780000
*/*                                                          @Y30LB34*/ 00781000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Y30LB34*/ 00782000
*/*          R. C. = 0, DATA SET RECATALOGED SUCCESSFULLY    @Y30LB34*/ 00783000
*/*          R. C. = 4, ERROR RECATALOGING DATA SET          @Y30LB34*/ 00784000
*/*                                                          @Y30LB34*/ 00785000
*/*********************************************************  @Y30LB34*/ 00786000
*                                                                  0391 00787000
*UPDATENT:                                                         0391 00788000
*   PROCEDURE;                      /*                       @Y30LB34*/ 00789000
UPDATENT STM   @14,@12,@SA00004                                    0391 00790000
*                                                                  0392 00791000
*   /*****************************************************************/ 00792000
*   /*                                                               */ 00793000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Y30LB34*/ 00794000
*   /*                                                               */ 00795000
*   /*****************************************************************/ 00796000
*                                                                  0392 00797000
*   OLDERID2=NEWERID2;                                             0392 00798000
         L     @02,@PC00001                                        0392 00799000
         L     @02,GDTTR2(,@02)                                    0392 00800000
         MVC   @TS00001(95),NEWERID2(@02)                          0392 00801000
         MVC   OLDERID2(95,@02),@TS00001                           0392 00802000
*   NEWID2='RCUE';                  /*                       @Y30LB34*/ 00803000
*                                                                  0393 00804000
         MVC   NEWID2(4,@02),@CC01241                              0393 00805000
*   /*****************************************************************/ 00806000
*   /*                                                               */ 00807000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Y30LB34*/ 00808000
*   /*                                                               */ 00809000
*   /*****************************************************************/ 00810000
*                                                                  0394 00811000
*   CC01=0;                         /*                       @Y30LB34*/ 00812000
*                                                                  0394 00813000
         SLR   CC01,CC01                                           0394 00814000
*   /*****************************************************************/ 00815000
*   /*                                                               */ 00816000
*   /* CHANGE THE DEVICE TYPE AND/OR VOLUME SERIAL NUMBER    @Y30LB34*/ 00817000
*   /* IN THE APPROPRIATE ENTRY OF THE VOLUME LIST           @Y30LB34*/ 00818000
*   /*                                                               */ 00819000
*   /*****************************************************************/ 00820000
*                                                                  0395 00821000
*   IF RCTDEV=ON THEN                                              0395 00822000
         TM    RCTDEV(RCTPTR),B'10000000'                          0395 00823000
         BNO   @RF00395                                            0395 00824000
*     DEVCODE(ENTNO)=TSTRCTND;      /*                       @ZM01090*/ 00825000
         LR    @02,ENTNO                                           0396 00826000
         MH    @02,@CH00032                                        0396 00827000
         LA    @01,DEVCODE-12(@02)                                 0396 00828000
         MVC   0(4,@01),TSTRCTND                                   0396 00829000
*   IF RCTVOL=ON THEN                                              0397 00830000
@RF00395 TM    RCTVOL(RCTPTR),B'01000000'                          0397 00831000
         BNO   @RF00397                                            0397 00832000
*     VOLSER(ENTNO)=RCTNVOL;        /*                       @Y30LB34*/ 00833000
*                                                                  0398 00834000
         LR    @02,ENTNO                                           0398 00835000
         MH    @02,@CH00032                                        0398 00836000
         LA    @01,VOLSER-12(@02)                                  0398 00837000
         MVC   0(6,@01),RCTNVOL(RCTPTR)                            0398 00838000
*   /*****************************************************************/ 00839000
*   /*                                                               */ 00840000
*   /* INITIALIZE THE CAMLST OPTION 1 TO RECATALOG AND IF    @Y30LB34*/ 00841000
*   /* THE DATA SET RESIDES ON ONE VOLUME SPECIFY THE DSCB   @Y30LB34*/ 00842000
*   /* TTR                                                   @Y30LB34*/ 00843000
*   /*                                                               */ 00844000
*   /*****************************************************************/ 00845000
*                                                                  0399 00846000
*   CAMOPTN1=RECAT;                 /*                       @Y30LB34*/ 00847000
@RF00397 MVI   CAMOPTN1,B'00010000'                                0399 00848000
*   IF VOLCOUNT=1 THEN                                             0400 00849000
         CLC   VOLCOUNT(2),@CH00213                                0400 00850000
         BNE   @RF00400                                            0400 00851000
*     CAMDSCB=ADDR(TTRDSCB);        /*                       @Y30LB34*/ 00852000
         LA    @15,TTRDSCB                                         0401 00853000
         ST    @15,CAMDSCB                                         0401 00854000
*                                                                  0402 00855000
*   /*****************************************************************/ 00856000
*   /*                                                               */ 00857000
*   /* ISSUE THE CATALOG MACRO POINTING TO CAMLST            @Y30LB34*/ 00858000
*   /*                                                               */ 00859000
*   /*****************************************************************/ 00860000
*                                                                  0402 00861000
*   RESPECIFY                                                      0402 00862000
*     REG0 RSTD;                    /*                       @Y30LB34*/ 00863000
@RF00400 DS    0H                                                  0403 00864000
*LCATLG1:                                                          0403 00865000
*   GEN(CATALOG CAMLST);            /*                       @Y30LB34*/ 00866000
LCATLG1  CATALOG CAMLST                                                 00867000
*   RESPECIFY                                                      0404 00868000
*     RTNREG RSTD;                                                 0404 00869000
*   TESTRC=RTNREG;                                                 0405 00870000
         STH   RTNREG,TESTRC                                       0405 00871000
*   RESPECIFY                                                      0406 00872000
*     RTNREG UNRSTD;                /*                       @Y30LB34*/ 00873000
*   RSNCODE=REG0;                   /*                       @Y30LB34*/ 00874000
         STH   REG0,RSNCODE                                        0407 00875000
*   RESPECIFY                                                      0408 00876000
*     REG0 UNRSTD;                  /*                       @Y30LB34*/ 00877000
*                                                                  0408 00878000
*   /*****************************************************************/ 00879000
*   /*                                                               */ 00880000
*   /* ESTABLISH A DUMP POINT FOR THE VOLUME LIST AFTER      @Y30LB34*/ 00881000
*   /* RECATALOG                                             @Y30LB34*/ 00882000
*   /*                                                               */ 00883000
*   /*****************************************************************/ 00884000
*                                                                  0409 00885000
*   IF GDTDBG=NULLPTR THEN                                         0409 00886000
         L     @15,@PC00001                                        0409 00887000
         L     @15,GDTDBG(,@15)                                    0409 00888000
         LTR   @15,@15                                             0409 00889000
         BZ    @RT00409                                            0409 00890000
*     ;                                                            0410 00891000
*   ELSE                                                           0411 00892000
*     DO;                                                          0411 00893000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB34*/ 00894000
         LA    DMPINDEX,DUMPAREA                                   0412 00895000
*       DMPITMNM='WKAREA';                                         0413 00896000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0413 00897000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0413 00898000
         MVC   DMPITMNM(6,DMPINDEX),@CC01231                       0413 00899000
*       DMPITMPT=ADDR(WKAREA);                                     0414 00900000
         LA    @03,WKAREA                                          0414 00901000
         ST    @03,DMPITMPT(,DMPINDEX)                             0414 00902000
*       DMPITMLN=LENGTH(AREA1)+LENGTH(AREA2);                      0415 00903000
         MVC   DMPITMLN(2,DMPINDEX),@CH01342                       0415 00904000
*       DMPITMTP='H';                                              0416 00905000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0416 00906000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB34*/ 00907000
         AL    DMPINDEX,@CF00466                                   0417 00908000
*       DMPTRM=DMPTRMVL;                                           0418 00909000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0418 00910000
*     END;                          /*                       @Y30LB34*/ 00911000
*   IF GDTDBG=NULLPTR THEN                                         0420 00912000
@RT00409 L     @15,@PC00001                                        0420 00913000
         L     @15,GDTDBG(,@15)                                    0420 00914000
         LTR   @15,@15                                             0420 00915000
         BZ    @RT00420                                            0420 00916000
*     ;                                                            0421 00917000
*   ELSE                                                           0422 00918000
*     CALL IDCDB010(GDTTBL,'RCAC',ADDR(DUMPAREA));/*         @Y30LB34*/ 00919000
         L     @15,@PC00001                                        0422 00920000
         ST    @15,@AL00001                                        0422 00921000
         LA    @14,@CC01233                                        0422 00922000
         ST    @14,@AL00001+4                                      0422 00923000
         LA    @14,DUMPAREA                                        0422 00924000
         ST    @14,@AFTEMPS+4                                      0422 00925000
         LA    @14,@AFTEMPS+4                                      0422 00926000
         ST    @14,@AL00001+8                                      0422 00927000
         MVI   @AL00001+8,X'80'                                    0422 00928000
         L     @15,GDTDBG(,@15)                                    0422 00929000
         LA    @01,@AL00001                                        0422 00930000
         BALR  @14,@15                                             0422 00931000
*                                                                  0423 00932000
*   /*****************************************************************/ 00933000
*   /*                                                               */ 00934000
*   /* IF CATALOG RETURNED A CODE GREATER THAN ZERO          @Y30LB34*/ 00935000
*   /* RECATALOGONG WAS NOT PERFORMED                        @Y30LB34*/ 00936000
*   /*                                                               */ 00937000
*   /*****************************************************************/ 00938000
*                                                                  0423 00939000
*   IF TESTRC>0 THEN                                               0423 00940000
@RT00420 LH    @15,TESTRC                                          0423 00941000
         LTR   @15,@15                                             0423 00942000
         BNP   @RF00423                                            0423 00943000
*     DO;                           /*                       @Y30LB34*/ 00944000
*                                                                  0424 00945000
*       /*************************************************************/ 00946000
*       /*                                                           */ 00947000
*       /* PRINT MESSAGE IDC21019 STATING THE RECATALOG      @Y30LB34*/ 00948000
*       /* RETURN CODE AND REASON CODE                       @Y30LB34*/ 00949000
*       /*                                                           */ 00950000
*       /*************************************************************/ 00951000
*                                                                  0425 00952000
*       CC01=4;                     /*                       @Y30LB34*/ 00953000
         LA    CC01,4                                              0425 00954000
*       DARGSMOD=SA07MSG;           /*                       @Y30LB34*/ 00955000
         L     @15,DDSTRU                                          0426 00956000
         MVC   DARGSMOD(3,@15),@CC01179                            0426 00957000
*       DARGSENT=MSG2101I;          /*                       @Y30LB34*/ 00958000
         MVI   DARGSENT(@15),X'04'                                 0427 00959000
*       DARGDBP=ADDR(TESTRC);       /*                       @Y30LB34*/ 00960000
         LA    @14,TESTRC                                          0428 00961000
         ST    @14,DARGDBP(,@15)                                   0428 00962000
*       DARGILP=LENGTH(TESTRC);     /*                       @Y30LB34*/ 00963000
         LA    @14,2                                               0429 00964000
         STH   @14,DARGILP(,@15)                                   0429 00965000
*       DARGCNT=1;                  /*                       @Y30LB34*/ 00966000
         LA    @09,1                                               0430 00967000
         STH   @09,DARGCNT(,@15)                                   0430 00968000
*       DARGINS(1)=1;               /*                       @Y30LB34*/ 00969000
         STH   @09,DARGINS(,@15)                                   0431 00970000
*       DARGINL(1)=LENGTH(RSNCODE); /*                       @Y30LB34*/ 00971000
         STH   @14,DARGINL(,@15)                                   0432 00972000
*       DARGDTM(1)=ADDR(RSNCODE);   /*                       @Y30LB34*/ 00973000
         LA    @14,RSNCODE                                         0433 00974000
         ST    @14,DARGDTM(,@15)                                   0433 00975000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 00976000
*                                                                  0434 00977000
         L     @15,@PC00001                                        0434 00978000
         ST    @15,@AL00001                                        0434 00979000
         LA    @14,@CF00109                                        0434 00980000
         ST    @14,@AL00001+4                                      0434 00981000
         LA    @14,DDSTRU                                          0434 00982000
         ST    @14,@AL00001+8                                      0434 00983000
         MVI   @AL00001+8,X'80'                                    0434 00984000
         L     @15,GDTPRT(,@15)                                    0434 00985000
         LA    @01,@AL00001                                        0434 00986000
         BALR  @14,@15                                             0434 00987000
*       /*************************************************************/ 00988000
*       /*                                                           */ 00989000
*       /* PRINT MESSAGE IDC0396I NOTIFYING DATA SET NOT     @Y30LB34*/ 00990000
*       /* RECATALOGED                                       @Y30LB34*/ 00991000
*       /*                                                           */ 00992000
*       /*************************************************************/ 00993000
*                                                                  0435 00994000
*       DARGAREA=''B;               /*                       @Y30LB34*/ 00995000
         XC    DARGAREA(28),DARGAREA                               0435 00996000
*       DARGSMOD=SA07MSG;           /*                       @Y30LB34*/ 00997000
         L     @15,DDSTRU                                          0436 00998000
         MVC   DARGSMOD(3,@15),@CC01179                            0436 00999000
*       DARGSENT=MSG0396I;          /*                       @Y30LB34*/ 01000000
         MVI   DARGSENT(@15),X'01'                                 0437 01001000
*       DARGDBP=ADDR(RCTDSET);      /*                       @Y30LB34*/ 01002000
         LA    @14,RCTDSET(,RCTPTR)                                0438 01003000
         ST    @14,DARGDBP(,@15)                                   0438 01004000
*       DARGILP=LENGTH(RCTDSET);    /*                       @Y30LB34*/ 01005000
         MVC   DARGILP(2,@15),@CH00767                             0439 01006000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB34*/ 01007000
         L     @05,@PC00001                                        0440 01008000
         ST    @05,@AL00001                                        0440 01009000
         LA    @15,@CF00109                                        0440 01010000
         ST    @15,@AL00001+4                                      0440 01011000
         LA    @15,DDSTRU                                          0440 01012000
         ST    @15,@AL00001+8                                      0440 01013000
         MVI   @AL00001+8,X'80'                                    0440 01014000
         L     @15,GDTPRT(,@05)                                    0440 01015000
         LA    @01,@AL00001                                        0440 01016000
         BALR  @14,@15                                             0440 01017000
*     END;                          /*                       @Y30LB34*/ 01018000
*                                                                  0441 01019000
*   /*****************************************************************/ 01020000
*   /*                                                               */ 01021000
*   /* RETURN TO CALLER                                              */ 01022000
*   /*                                                               */ 01023000
*   /*****************************************************************/ 01024000
*                                                                  0442 01025000
*                                   /*                       @Y30LB34*/ 01026000
*   RETURN CODE(CC01);              /*                       @Y30LB34*/ 01027000
@RF00423 LR    @15,CC01                                            0442 01028000
         L     @14,@SA00004                                        0442 01029000
         LM    @00,@12,@SA00004+8                                  0442 01030000
         BR    @14                                                 0442 01031000
*   END UPDATENT;                   /*                       @Y30LB34*/ 01032000
*                                                                  0444 01033000
*/*********************************************************  @Z40LB30*/ 01034000
*/*                                                          @Z40LB30*/ 01035000
*/* PROCEDURE NAME - IDCSAUC (ENTRY POINT FOR UUNCATLG)      @Z40LB30*/ 01036000
*/*                                                          @Z40LB30*/ 01037000
*/* FUNCTION - CONTROLS THE SCRATCH AND UNCATALOG OF A       @Z40LB30*/ 01038000
*/*            NON-VSAM DATA SET                             @Z40LB30*/ 01039000
*/*                                                          @Z40LB30*/ 01040000
*/* INPUT - GDTTBL, UCTAGL                                   @Z40LB30*/ 01041000
*/*                                                          @Z40LB30*/ 01042000
*/* OUTPUT - UCTAGL HEADER IS SET                            @Z40LB30*/ 01043000
*/*                                                          @Z40LB30*/ 01044000
*/*          R. C. = 0, DATA SET SCRATCHED FROM VTOC AND     @Z40LB30*/ 01045000
*/*                     UNCATALOGED SUCCESSFULLY OR DATA     @Z40LB30*/ 01046000
*/*                     SET WAS ALREADY SCRATCHED AND/OR     @Z40LB30*/ 01047000
*/*                     UNCATALOGED                          @Z40LB30*/ 01048000
*/*                                                          @Z40LB30*/ 01049000
*/*          R. C. = 4, DATA SET NOT SCRATCHED AND UNCATA-   @Z40LB30*/ 01050000
*/*                     LOGED SUCCESSFULLY                   @Z40LB30*/ 01051000
*/*                                                          @Z40LB30*/ 01052000
*/********************************************************   @Z40LB30*/ 01053000
*                                                                  0444 01054000
*IDCSAUC:                                                          0444 01055000
*   ENTRY(GDTTBL,                   /* GLOBAL DATA TABLE     @Z40LB30*/ 01056000
*       UARGAREA);                  /* UUNCATLG ARGUMENT LIST      0444 01057000
*                                                            @Z40LB30*/ 01058000
         B     @EC00444                                            0444 01059000
@EP00444 MVC   @PC00001(4),0(@01)                                  0444 01060000
         MVC   @PC00001+8(4),4(@01)                                0444 01061000
@EC00444 DS    0H                                                  0445 01062000
*                                                                  0445 01063000
*   /*****************************************************************/ 01064000
*   /*                                                               */ 01065000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 01066000
*   /*                                                               */ 01067000
*   /*****************************************************************/ 01068000
*                                                                  0445 01069000
*   OLDERID2=NEWERID2;                                             0445 01070000
         L     @15,@PC00001                                        0445 01071000
         L     @14,GDTTR2(,@15)                                    0445 01072000
         MVC   @TS00001(95),NEWERID2(@14)                          0445 01073000
         MVC   OLDERID2(95,@14),@TS00001                           0445 01074000
*   NEWID2='SAUC';                  /*                       @Z40LB30*/ 01075000
*                                                                  0446 01076000
         MVC   NEWID2(4,@14),@CC01250                              0446 01077000
*   /*****************************************************************/ 01078000
*   /*                                                               */ 01079000
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB30*/ 01080000
*   /*                                                               */ 01081000
*   /*****************************************************************/ 01082000
*                                                                  0447 01083000
*   IF GDTDBG=NULLPTR THEN                                         0447 01084000
         L     @15,GDTDBG(,@15)                                    0447 01085000
         LTR   @15,@15                                             0447 01086000
         BZ    @RT00447                                            0447 01087000
*     ;                                                            0448 01088000
*   ELSE                                                           0449 01089000
*     CALL IDCDB010(GDTTBL,'SAUC'); /*                       @Z40LB30*/ 01090000
*                                                                  0449 01091000
         L     @15,@PC00001                                        0449 01092000
         ST    @15,@AL00001                                        0449 01093000
         LA    @14,@CC01250                                        0449 01094000
         ST    @14,@AL00001+4                                      0449 01095000
         MVI   @AL00001+4,X'80'                                    0449 01096000
         L     @15,GDTDBG(,@15)                                    0449 01097000
         LA    @01,@AL00001                                        0449 01098000
         BALR  @14,@15                                             0449 01099000
*   /*****************************************************************/ 01100000
*   /*                                                               */ 01101000
*   /* ESTABLISH ADDRESSABILITY TO INPUT ARGUMENT            @Z40LB30*/ 01102000
*   /* LIST AND TO UPRINT ARGUMENT LIST AND TO UERROR        @Z40LB30*/ 01103000
*   /* ARGUMENT LIST AND TO USCRATCH ARGUMENT LIST           @Z40LB30*/ 01104000
*   /* THE USCRATCH ARGUMENT LIST IS BASED ON THE            @Z40LB30*/ 01105000
*   /* ADDRESS PROVIDED BY THE CALLER.                       @Z40LB30*/ 01106000
*   /*                                                               */ 01107000
*   /*****************************************************************/ 01108000
*                                                                  0450 01109000
*   RESPECIFY                                                      0450 01110000
*     UCTAGL BASED(UARGPTR);        /*                       @Z40LB30*/ 01111000
@RT00447 DS    0H                                                  0451 01112000
*   UARGPTR=ADDR(UARGAREA);         /*                       @Z40LB30*/ 01113000
         L     UARGPTR,@PC00001+8                                  0451 01114000
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB30*/ 01115000
         LA    @02,DARGAREA                                        0452 01116000
         ST    @02,DDSTRU                                          0452 01117000
*   ERCNVADR=ADDR(ERRAREA);         /*                       @Z40LB37*/ 01118000
         LA    @02,ERRAREA                                         0453 01119000
         ST    @02,ERCNVADR                                        0453 01120000
*   RESPECIFY                                                      0454 01121000
*     UVOLLIST BASED(UCTVOLP);      /*                       @Z40LB30*/ 01122000
*                                                                  0454 01123000
*   /*****************************************************************/ 01124000
*   /*                                                               */ 01125000
*   /* SET HEADER IN UCTAGL                                  @Z40LB30*/ 01126000
*   /*                                                               */ 01127000
*   /*****************************************************************/ 01128000
*                                                                  0455 01129000
*   UCTHEAD=UNCATHDR;               /*                       @Z40LB30*/ 01130000
*                                                                  0455 01131000
         MVC   UCTHEAD(8,UARGPTR),@CC01208                         0455 01132000
*   /*****************************************************************/ 01133000
*   /*                                                               */ 01134000
*   /* IF THE UCTVSCAT BIT IN THE UCTAGL IS SET              @Z40LB30*/ 01135000
*   /* INDICATING A VSAM DELETE CAN BE USED TO SCRATCH AND   @Z40LB30*/ 01136000
*   /* UNCATALOG THE DATA SET, CALL VSAMUCT PROCEDURE. OTHER @Z40LB30*/ 01137000
*   /* WISE CALL OSUCT PROCEDURE. SAVE THE RETURN CODE       @Z40LB30*/ 01138000
*   /*                                                               */ 01139000
*   /*****************************************************************/ 01140000
*                                                                  0456 01141000
*   IF UCTVSCAT=ON THEN             /*                       @Z40LB30*/ 01142000
         TM    UCTVSCAT(UARGPTR),B'10000000'                       0456 01143000
         BNO   @RF00456                                            0456 01144000
*     CALL VSAMUCT;                 /*                       @Z40LB30*/ 01145000
         BAL   @14,VSAMUCT                                         0457 01146000
*   ELSE                            /*                       @Z40LB30*/ 01147000
*     CALL OSUCT;                   /*                       @Z40LB30*/ 01148000
         B     @RC00456                                            0458 01149000
@RF00456 BAL   @14,OSUCT                                           0458 01150000
*   RESPECIFY                                                      0459 01151000
*     RTNREG RSTD;                                                 0459 01152000
@RC00456 DS    0H                                                  0460 01153000
*   TESTRC=RTNREG;                                                 0460 01154000
         STH   RTNREG,TESTRC                                       0460 01155000
*   RESPECIFY                                                      0461 01156000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 01157000
*                                                                  0461 01158000
*   /*****************************************************************/ 01159000
*   /*                                                               */ 01160000
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB30*/ 01161000
*   /*                                                               */ 01162000
*   /*****************************************************************/ 01163000
*                                                                  0462 01164000
*   IF GDTDBG=NULLPTR THEN                                         0462 01165000
         L     @15,@PC00001                                        0462 01166000
         L     @15,GDTDBG(,@15)                                    0462 01167000
         LTR   @15,@15                                             0462 01168000
         BZ    @RT00462                                            0462 01169000
*     ;                                                            0463 01170000
*   ELSE                                                           0464 01171000
*     CALL IDCDB010(GDTTBL,'SAUE'); /*                       @Z40LB30*/ 01172000
*                                                                  0464 01173000
         L     @15,@PC00001                                        0464 01174000
         ST    @15,@AL00001                                        0464 01175000
         LA    @14,@CC01255                                        0464 01176000
         ST    @14,@AL00001+4                                      0464 01177000
         MVI   @AL00001+4,X'80'                                    0464 01178000
         L     @15,GDTDBG(,@15)                                    0464 01179000
         LA    @01,@AL00001                                        0464 01180000
         BALR  @14,@15                                             0464 01181000
*   /*****************************************************************/ 01182000
*   /*                                                               */ 01183000
*   /* RETURN TO THE CALLER WITH THE RETURN CODE             @Z40LB30*/ 01184000
*   /*                                                               */ 01185000
*   /*****************************************************************/ 01186000
*                                                                  0465 01187000
*   CALL IDCSAEP0(GDTTBL,MODID,TESTRC);/*                    @Z40LB30*/ 01188000
@RT00462 L     @15,@PC00001                                        0465 01189000
         ST    @15,@AL00001                                        0465 01190000
         LA    @14,MODID                                           0465 01191000
         ST    @14,@AL00001+4                                      0465 01192000
         LA    @14,TESTRC                                          0465 01193000
         ST    @14,@AL00001+8                                      0465 01194000
         MVI   @AL00001+8,X'80'                                    0465 01195000
         L     @15,GDTEPL(,@15)                                    0465 01196000
         LA    @01,@AL00001                                        0465 01197000
         BALR  @14,@15                                             0465 01198000
*                                                                  0466 01199000
*/********************************************************   @Z40LB30*/ 01200000
*/*                                                          @Z40LB30*/ 01201000
*/* PROCEDURE NAME - OSUCT                                   @Z40LB30*/ 01202000
*/*                                                          @Z40LB30*/ 01203000
*/* FUNCTION - SCRATCHES AND UNCATALOGS A NON-VSAM           @Z40LB30*/ 01204000
*/*            DATA SET THAT IS CATALOGED IN THE OS SYSTEM   @Z40LB30*/ 01205000
*/*            CATALOG OR IN AN OS CVOL CATALOG.  THIS       @Z40LB30*/ 01206000
*/*            PROCEDURE SHOULD BE CALLED ONLY IN VS1.       @Z40LB30*/ 01207000
*/*            MESSAGE IDC0112I IS ISSUED IF THE DATA SET    @Z40LB30*/ 01208000
*/*            IS SCRATCHED SUCCESSFULLY BUT AN ERROR        @Z40LB30*/ 01209000
*/*            OCCURS UNCATALOGING.  MESSAGE IDC0363I IS     @Z40LB30*/ 01210000
*/*            ISSUED IF THE DATA SET IS NOT UNCATALOGED     @Z40LB30*/ 01211000
*/*            SUCCESSFULLY.                                 @Z40LB30*/ 01212000
*/*                                                          @Z40LB30*/ 01213000
*/* INPUT - UCTAGL                                           @Z40LB30*/ 01214000
*/*                                                          @Z40LB30*/ 01215000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Z40LB30*/ 01216000
*/*          R. C. = 0, DATA SET SCRATCHED AND UNCATALOGED   @Z40LB30*/ 01217000
*/*                     SUCCESSFULLY OR DATA SET NOT FOUND   @Z40LB30*/ 01218000
*/*          R. C. = 4, ERROR OCCURRED SCRATCHING OR         @Z40LB30*/ 01219000
*/*                     UNCATALOGING THE DATA SET.           @Z40LB30*/ 01220000
*/*                                                          @Z40LB30*/ 01221000
*/********************************************************   @Z40LB30*/ 01222000
*                                                                  0466 01223000
*OSUCT:                                                            0466 01224000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 01225000
         B     @PB00005                                            0466 01226000
OSUCT    ST    @14,@SA00005                                        0466 01227000
*                                                                  0467 01228000
*   /*****************************************************************/ 01229000
*   /*                                                               */ 01230000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 01231000
*   /*                                                               */ 01232000
*   /*****************************************************************/ 01233000
*                                                                  0467 01234000
*   OLDERID2=NEWERID2;                                             0467 01235000
         L     @05,@PC00001                                        0467 01236000
         L     @02,GDTTR2(,@05)                                    0467 01237000
         MVC   @TS00001(95),NEWERID2(@02)                          0467 01238000
         MVC   OLDERID2(95,@02),@TS00001                           0467 01239000
*   NEWID2='SAOU';                  /*                       @Z40LB30*/ 01240000
*                                                                  0468 01241000
         MVC   NEWID2(4,@02),@CC01260                              0468 01242000
*   /*****************************************************************/ 01243000
*   /*                                                               */ 01244000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Z40LB30*/ 01245000
*   /*                                                               */ 01246000
*   /*****************************************************************/ 01247000
*                                                                  0469 01248000
*   CC01=0;                         /*                       @Z40LB30*/ 01249000
*                                                                  0469 01250000
         SLR   CC01,CC01                                           0469 01251000
*   /*****************************************************************/ 01252000
*   /*                                                               */ 01253000
*   /* ISSUE USCRATCH MACRO TO SCRATCH THE DATA SET. GET     @Z40LB30*/ 01254000
*   /* DATA SET NAME FROM UCTAGL. INDICATE EXPIRATION DATE   @Z40LB30*/ 01255000
*   /* IS TO BE OVERRIDDEN. SAVE THE RETURN CODE.            @Z40LB30*/ 01256000
*   /*                                                               */ 01257000
*   /*****************************************************************/ 01258000
*                                                                  0470 01259000
*   CALL IDCSASC0(GDTTBL,UCTDSN,ADDR(UVOLLIST),OVERRIDE);/*  @Z40LB30*/ 01260000
         ST    @05,@AL00001                                        0470 01261000
         LA    @02,UCTDSN(,UARGPTR)                                0470 01262000
         ST    @02,@AL00001+4                                      0470 01263000
         LA    @02,UCTVOLP(,UARGPTR)                               0470 01264000
         ST    @02,@AL00001+8                                      0470 01265000
         LA    @02,OVERRIDE                                        0470 01266000
         ST    @02,@AL00001+12                                     0470 01267000
         MVI   @AL00001+12,X'80'                                   0470 01268000
         L     @15,GDTSCR(,@05)                                    0470 01269000
         LA    @01,@AL00001                                        0470 01270000
         BALR  @14,@15                                             0470 01271000
*   RESPECIFY                                                      0471 01272000
*     RTNREG RSTD;                                                 0471 01273000
*   TESTRC=RTNREG;                                                 0472 01274000
         STH   RTNREG,TESTRC                                       0472 01275000
*   RESPECIFY                                                      0473 01276000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 01277000
*                                                                  0473 01278000
*   /*****************************************************************/ 01279000
*   /*                                                               */ 01280000
*   /* IF THE SCRATCH WAS NOT SUCCESSFUL, SET THE INTERNAL   @Z40LB30*/ 01281000
*   /* CONDITION CODE AND ISSUE UPRINT TO PRINT MESSAGE      @Z40LB30*/ 01282000
*   /* IDC0363I TO INDICATE THE DATA SET WAS NOT UNCATALOGED @Z40LB30*/ 01283000
*   /* EITHER. USCRATCH HAS ISSUED MESSAGES TO INCICATE THE  @Z40LB30*/ 01284000
*   /* DATA SET WAS NOT SCRATCHED.                           @Z40LB30*/ 01285000
*   /*                                                               */ 01286000
*   /*****************************************************************/ 01287000
*                                                                  0474 01288000
*   IF TESTRC^=0 THEN               /*                       @Z40LB30*/ 01289000
         LH    @05,TESTRC                                          0474 01290000
         LTR   @05,@05                                             0474 01291000
         BZ    @RF00474                                            0474 01292000
*     DO;                           /*                       @Z40LB30*/ 01293000
*       CC01=4;                     /*                       @Z40LB30*/ 01294000
         LA    CC01,4                                              0476 01295000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 01296000
         XC    DARGAREA(28),DARGAREA                               0477 01297000
*       DARGSMOD=SA07MSG;           /*                       @Z40LB30*/ 01298000
         L     @05,DDSTRU                                          0478 01299000
         MVC   DARGSMOD(3,@05),@CC01179                            0478 01300000
*       DARGSENT=MSG0363I;          /*                       @Z40LB30*/ 01301000
         MVI   DARGSENT(@05),X'0B'                                 0479 01302000
*       DARGDBP=ADDR(UCTDSN);       /*                       @Z40LB30*/ 01303000
         LA    @02,UCTDSN(,UARGPTR)                                0480 01304000
         ST    @02,DARGDBP(,@05)                                   0480 01305000
*       DARGILP=LENGTH(UCTDSN);     /*                       @Z40LB30*/ 01306000
         MVC   DARGILP(2,@05),@CH00767                             0481 01307000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 01308000
         L     @05,@PC00001                                        0482 01309000
         ST    @05,@AL00001                                        0482 01310000
         LA    @15,@CF00109                                        0482 01311000
         ST    @15,@AL00001+4                                      0482 01312000
         LA    @15,DDSTRU                                          0482 01313000
         ST    @15,@AL00001+8                                      0482 01314000
         MVI   @AL00001+8,X'80'                                    0482 01315000
         L     @15,GDTPRT(,@05)                                    0482 01316000
         LA    @01,@AL00001                                        0482 01317000
         BALR  @14,@15                                             0482 01318000
*     END;                          /*                       @Z40LB30*/ 01319000
*                                                                  0484 01320000
*   /*****************************************************************/ 01321000
*   /*                                                               */ 01322000
*   /* IF THE SCRATCH WAS SUCCESSFUL, INITIALIZE THE CAMLST  @Z40LB30*/ 01323000
*   /* AND ISSUE CATALOG MACRO TO UNCATALOG THE DATA SET     @Z40LB30*/ 01324000
*   /*                                                               */ 01325000
*   /*****************************************************************/ 01326000
*                                                                  0484 01327000
*   ELSE                            /*                       @Z40LB30*/ 01328000
*     DO;                           /*                       @Z40LB30*/ 01329000
*                                                                  0484 01330000
         B     @RC00474                                            0484 01331000
@RF00474 DS    0H                                                  0485 01332000
*       /*************************************************************/ 01333000
*       /*                                                           */ 01334000
*       /* SET THE FIRST BYTE OF CAMLST TO INDICATE AN       @Z40LB30*/ 01335000
*       /* UNCATALOG REQUEST. SET THE SECOND BYTE TO         @Z40LB30*/ 01336000
*       /* INDICATE DELETE EMPTY HIGHER LEVEL INDEXES.       @Z40LB30*/ 01337000
*       /* SET THE THIRD BYTE TO INDICATE SEARCH ONLY OS     @Z40LB30*/ 01338000
*       /* CATALOG                                           @Z40LB30*/ 01339000
*       /*                                                           */ 01340000
*       /*************************************************************/ 01341000
*                                                                  0485 01342000
*       CAMLST=''B;                 /*                       @Z40LB30*/ 01343000
         XC    CAMLST(20),CAMLST                                   0485 01344000
*       CAMOPTN1=UCAT;              /*                       @Z40LB30*/ 01345000
         MVI   CAMOPTN1,B'00001000'                                0486 01346000
*       CAMOPTN2=UCATDX;            /*                       @Z40LB30*/ 01347000
         MVI   CAMOPTN2,B'00000100'                                0487 01348000
*       CAMOPTN3=OSCAT;             /*                       @Z40LB30*/ 01349000
*                                                                  0488 01350000
         MVI   CAMOPTN3,B'00000110'                                0488 01351000
*       /*************************************************************/ 01352000
*       /*                                                           */ 01353000
*       /* SET THE POINTER TO THE DATA SET NAME FROM UCTAGL  @Z40LB30*/ 01354000
*       /*                                                           */ 01355000
*       /*************************************************************/ 01356000
*                                                                  0489 01357000
*       CAMPTR1=ADDR(UCTDSN);       /*                       @Z40LB30*/ 01358000
*                                                                  0489 01359000
         LA    @05,UCTDSN(,UARGPTR)                                0489 01360000
         ST    @05,CAMPTR1                                         0489 01361000
*       /*************************************************************/ 01362000
*       /*                                                           */ 01363000
*       /* ISSUE CATALOG MACRO TO UNCATALOG THE DATA SET AND @Z40LB30*/ 01364000
*       /* SAVE THE RETURN CODE                              @Z40LB30*/ 01365000
*       /*                                                           */ 01366000
*       /*************************************************************/ 01367000
*                                                                  0490 01368000
*LCATLG2:                           /*                       @Z40LB30*/ 01369000
*       GEN(CATALOG CAMLST);        /*                       @Z40LB30*/ 01370000
LCATLG2  CATALOG CAMLST                                                 01371000
*       RESPECIFY                                                  0491 01372000
*         RTNREG RSTD;                                             0491 01373000
*       TESTRC=RTNREG;                                             0492 01374000
         STH   RTNREG,TESTRC                                       0492 01375000
*       RESPECIFY                                                  0493 01376000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 01377000
*                                                                  0493 01378000
*       /*************************************************************/ 01379000
*       /*                                                           */ 01380000
*       /* ESTABLISH A DUMP POINT TO DUMP REGISTER 15        @Z40LB30*/ 01381000
*       /* AND THE CAMLST                                    @Z40LB30*/ 01382000
*       /*                                                           */ 01383000
*       /*************************************************************/ 01384000
*                                                                  0494 01385000
*       IF GDTDBG=NULLPTR THEN                                     0494 01386000
         L     @05,@PC00001                                        0494 01387000
         L     @05,GDTDBG(,@05)                                    0494 01388000
         LTR   @05,@05                                             0494 01389000
         BZ    @RT00494                                            0494 01390000
*         ;                                                        0495 01391000
*       ELSE                                                       0496 01392000
*         DO;                                                      0496 01393000
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Z40LB30*/ 01394000
         LA    DMPINDEX,DUMPAREA                                   0497 01395000
*           DMPITMNM='TESTRC';                                     0498 01396000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0498 01397000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0498 01398000
         MVC   DMPITMNM(6,DMPINDEX),@CC01263                       0498 01399000
*           DMPITMPT=ADDR(TESTRC);                                 0499 01400000
         LA    @05,TESTRC                                          0499 01401000
         ST    @05,DMPITMPT(,DMPINDEX)                             0499 01402000
*           DMPITMLN=LENGTH(TESTRC);                               0500 01403000
         MVC   DMPITMLN(2,DMPINDEX),@CH00147                       0500 01404000
*           DMPITMTP='H';                                          0501 01405000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0501 01406000
*           DMPINDEX=DMPINDEX+DMPELEMT;/*                    @Z40LB30*/ 01407000
         LA    @05,16                                              0502 01408000
         ALR   DMPINDEX,@05                                        0502 01409000
*           DMPITMNM='CAMLST';                                     0503 01410000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           0503 01411000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0503 01412000
         MVC   DMPITMNM(6,DMPINDEX),@CC01264                       0503 01413000
*           DMPITMPT=ADDR(CAMLST);                                 0504 01414000
         LA    @15,CAMLST                                          0504 01415000
         ST    @15,DMPITMPT(,DMPINDEX)                             0504 01416000
*           DMPITMLN=LENGTH(CAMLST);                               0505 01417000
         MVC   DMPITMLN(2,DMPINDEX),@CH01109                       0505 01418000
*           DMPITMTP='H';                                          0506 01419000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0506 01420000
*           DMPINDEX=DMPINDEX+DMPELEMT;/*                    @Z40LB30*/ 01421000
         ALR   DMPINDEX,@05                                        0507 01422000
*           DMPTRM=DMPTRMVL;                                       0508 01423000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0508 01424000
*         END;                      /*                       @Z40LB30*/ 01425000
*       IF GDTDBG=NULLPTR THEN                                     0510 01426000
@RT00494 L     @05,@PC00001                                        0510 01427000
         L     @05,GDTDBG(,@05)                                    0510 01428000
         LTR   @05,@05                                             0510 01429000
         BZ    @RT00510                                            0510 01430000
*         ;                                                        0511 01431000
*       ELSE                                                       0512 01432000
*         CALL IDCDB010(GDTTBL,'SAOD',ADDR(DUMPAREA));/*     @Z40LB30*/ 01433000
*                                                                  0512 01434000
         L     @05,@PC00001                                        0512 01435000
         ST    @05,@AL00001                                        0512 01436000
         LA    @02,@CC01265                                        0512 01437000
         ST    @02,@AL00001+4                                      0512 01438000
         LA    @02,DUMPAREA                                        0512 01439000
         ST    @02,@AFTEMPS+8                                      0512 01440000
         LA    @02,@AFTEMPS+8                                      0512 01441000
         ST    @02,@AL00001+8                                      0512 01442000
         MVI   @AL00001+8,X'80'                                    0512 01443000
         L     @15,GDTDBG(,@05)                                    0512 01444000
         LA    @01,@AL00001                                        0512 01445000
         BALR  @14,@15                                             0512 01446000
*       /*************************************************************/ 01447000
*       /*                                                           */ 01448000
*       /* IF THE RETURN CODE IS NOT '0 OR 8', AN ERROR      @Z40LB30*/ 01449000
*       /* OCCURRED DURING THE UNCATALOG                     @Z40LB30*/ 01450000
*       /*                                                           */ 01451000
*       /*************************************************************/ 01452000
*                                                                  0513 01453000
*       IF TESTRC^=0&TESTRC^=NOTFOUND THEN                         0513 01454000
@RT00510 LH    @05,TESTRC                                          0513 01455000
         LTR   @05,@05                                             0513 01456000
         BZ    @RF00513                                            0513 01457000
         C     @05,@CF00173                                        0513 01458000
         BE    @RF00513                                            0513 01459000
*         DO;                       /*                       @Z40LB30*/ 01460000
*                                                                  0514 01461000
*           /*********************************************************/ 01462000
*           /*                                                       */ 01463000
*           /* SET INTERNAL RETURN CODE                      @Z40LB30*/ 01464000
*           /*                                                       */ 01465000
*           /*********************************************************/ 01466000
*                                                                  0515 01467000
*           CC01=4;                 /*                       @Z40LB30*/ 01468000
*                                                                  0515 01469000
         LA    CC01,4                                              0515 01470000
*           /*********************************************************/ 01471000
*           /*                                                       */ 01472000
*           /* ISSUE UPRINT TO PRINT MESSAGE IDC0112I TO     @Z40LB30*/ 01473000
*           /* EXPLAIN THAT THE DATA SET WAS SCRATCHED       @Z40LB30*/ 01474000
*           /*                                                       */ 01475000
*           /*********************************************************/ 01476000
*                                                                  0516 01477000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 01478000
         XC    DARGAREA(28),DARGAREA                               0516 01479000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 01480000
         L     @05,DDSTRU                                          0517 01481000
         MVC   DARGSMOD(3,@05),@CC01181                            0517 01482000
*           DARGSENT=MSG0112I;      /*                       @Z40LB30*/ 01483000
         MVI   DARGSENT(@05),X'44'                                 0518 01484000
*           DARGDBP=ADDR(UCTDSN);   /*                       @Z40LB30*/ 01485000
         LA    @02,UCTDSN(,UARGPTR)                                0519 01486000
         ST    @02,DARGDBP(,@05)                                   0519 01487000
*           DARGILP=LENGTH(UCTDSN); /*                       @Z40LB30*/ 01488000
         MVC   DARGILP(2,@05),@CH00767                             0520 01489000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 01490000
*                                                                  0521 01491000
         L     @05,@PC00001                                        0521 01492000
         ST    @05,@AL00001                                        0521 01493000
         LA    @02,@CF00109                                        0521 01494000
         ST    @02,@AL00001+4                                      0521 01495000
         LA    @02,DDSTRU                                          0521 01496000
         ST    @02,@AL00001+8                                      0521 01497000
         MVI   @AL00001+8,X'80'                                    0521 01498000
         L     @15,GDTPRT(,@05)                                    0521 01499000
         LA    @01,@AL00001                                        0521 01500000
         BALR  @14,@15                                             0521 01501000
*           /*********************************************************/ 01502000
*           /*                                                       */ 01503000
*           /* ISSUE UERROR TO PRINT MESSAGES IDENTIFYING    @Z40LB30*/ 01504000
*           /* THE CATALOG ERROR                             @Z40LB30*/ 01505000
*           /*                                                       */ 01506000
*           /*********************************************************/ 01507000
*                                                                  0522 01508000
*           ERCNVTAB=''B;           /* SET TO 0              @Z40LB30*/ 01509000
         L     @05,ERCNVADR                                        0522 01510000
         XC    ERCNVTAB(32,@05),ERCNVTAB(@05)                      0522 01511000
*           EROSCAT=ON;             /* OS CATALOG ERROR      @Z40LB30*/ 01512000
         OI    EROSCAT(@05),B'01000000'                            0523 01513000
*           EROSUCDX=ON;            /* DELETE INDEX FUNCTION @Z40LB30*/ 01514000
         OI    EROSUCDX(@05),B'01000000'                           0524 01515000
*           ERDSNM=ADDR(UCTDSN);    /* DATA SET NAME         @Z40LB30*/ 01516000
         LA    @02,UCTDSN(,UARGPTR)                                0525 01517000
         ST    @02,ERDSNM(,@05)                                    0525 01518000
*           ERCATRC=TESTRC;         /* CATALOG RETURN CODE   @Z40LB30*/ 01519000
         LH    @02,TESTRC                                          0526 01520000
         ST    @02,ERCATRC(,@05)                                   0526 01521000
*           ERCPLPT=ADDR(CAMLST);   /* CATALOG PARAMETER LIST      0527 01522000
*                                                            @Z40LB30*/ 01523000
         LA    @02,CAMLST                                          0527 01524000
         ST    @02,ERCPLPT(,@05)                                   0527 01525000
*           CALL IDCTPER0(GDTTBL,ERCNVADR);/*                @Z40LB37*/ 01526000
*                                                                  0528 01527000
         L     @05,@PC00001                                        0528 01528000
         ST    @05,@AL00001                                        0528 01529000
         LA    @02,ERCNVADR                                        0528 01530000
         ST    @02,@AL00001+4                                      0528 01531000
         MVI   @AL00001+4,X'80'                                    0528 01532000
         L     @15,GDTERR(,@05)                                    0528 01533000
         LA    @01,@AL00001                                        0528 01534000
         BALR  @14,@15                                             0528 01535000
*           /*********************************************************/ 01536000
*           /*                                                       */ 01537000
*           /* ISSUE UPRINT TO PRINT MESSAGE IDC0363I TO     @Z40LB30*/ 01538000
*           /* EXPLAIN THAT THE DATA SET WAS NOT UNCATALOGED @Z40LB30*/ 01539000
*           /*                                                       */ 01540000
*           /*********************************************************/ 01541000
*                                                                  0529 01542000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 01543000
         XC    DARGAREA(28),DARGAREA                               0529 01544000
*           DARGSMOD=SA07MSG;       /*                       @Z40LB30*/ 01545000
         L     @05,DDSTRU                                          0530 01546000
         MVC   DARGSMOD(3,@05),@CC01179                            0530 01547000
*           DARGSENT=MSG0363I;      /*                       @Z40LB30*/ 01548000
         MVI   DARGSENT(@05),X'0B'                                 0531 01549000
*           DARGDBP=ADDR(UCTDSN);   /*                       @Z40LB30*/ 01550000
         LA    @02,UCTDSN(,UARGPTR)                                0532 01551000
         ST    @02,DARGDBP(,@05)                                   0532 01552000
*           DARGILP=LENGTH(UCTDSN); /*                       @Z40LB30*/ 01553000
         MVC   DARGILP(2,@05),@CH00767                             0533 01554000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 01555000
         L     @05,@PC00001                                        0534 01556000
         ST    @05,@AL00001                                        0534 01557000
         LA    @15,@CF00109                                        0534 01558000
         ST    @15,@AL00001+4                                      0534 01559000
         LA    @15,DDSTRU                                          0534 01560000
         ST    @15,@AL00001+8                                      0534 01561000
         MVI   @AL00001+8,X'80'                                    0534 01562000
         L     @15,GDTPRT(,@05)                                    0534 01563000
         LA    @01,@AL00001                                        0534 01564000
         BALR  @14,@15                                             0534 01565000
*         END;                      /*                       @Z40LB30*/ 01566000
*     END;                          /*                       @Z40LB30*/ 01567000
*                                                                  0536 01568000
@RF00513 DS    0H                                                  0537 01569000
*   /*****************************************************************/ 01570000
*   /*                                                               */ 01571000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 01572000
*   /*                                                               */ 01573000
*   /*****************************************************************/ 01574000
*                                                                  0537 01575000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 01576000
@RC00474 LR    @15,CC01                                            0537 01577000
@EL00005 DS    0H                                                  0537 01578000
@EF00005 DS    0H                                                  0537 01579000
@ER00005 L     @14,@SA00005                                        0537 01580000
         BR    @14                                                 0537 01581000
*   END OSUCT;                      /*                       @Z40LB30*/ 01582000
*                                                                  0539 01583000
*/*******************************************************    @Z40LB30*/ 01584000
*/*                                                          @Z40LB30*/ 01585000
*/* PROCEDURE NAME - VSAMUCT                                 @Z40LB30*/ 01586000
*/*                                                          @Z40LB30*/ 01587000
*/* FUNCTION - SCRATCHES AND UNCATALOGS A NON-VSAM DATA      @Z40LB30*/ 01588000
*/*            SET THAT IS CATALOGED IN A VSAM CATALOG       @Z40LB30*/ 01589000
*/*            IN VS/1 OR VS/2 OR THAT IS CATALOGED IN       @Z40LB30*/ 01590000
*/*            AN OS CVOL THAT IS CONNECTED TO THE VSAM      @Z40LB30*/ 01591000
*/*            MASTER CATALOG IN VS/2.  MESSAGES IDC0362I    @Z40LB30*/ 01592000
*/*            AND IDC0363I ARE ISSUED IF THE DATA SET       @Z40LB30*/ 01593000
*/*            WAS NOT SCRATCHED OR UNCATALOGED SUCCESS-     @Z40LB30*/ 01594000
*/*            FULLY                                         @Z40LB30*/ 01595000
*/*                                                          @Z40LB30*/ 01596000
*/* INPUT - UCTAGL                                           @Z40LB30*/ 01597000
*/*                                                          @Z40LB30*/ 01598000
*/* OUTPUT - RETURN CODE IN REGISTER 15                      @Z40LB30*/ 01599000
*/*          R. C. = 0, DATA SET SCRATCHED AND               @Z40LB30*/ 01600000
*/*                     UNCATALOGED SUCCESSFULLY OR DATA     @Z40LB30*/ 01601000
*/*                     SET WAS NOT FOUND ON THE VTOC OR     @Z40LB30*/ 01602000
*/*                     IN THE CATALOG                       @Z40LB30*/ 01603000
*/*          R. C. = 4, AN ERROR OCCURRED SCRATCHING AND/OR  @Z40LB30*/ 01604000
*/*                     UNCATALOGING THE DATA SET            @Z40LB30*/ 01605000
*/*                                                          @Z40LB30*/ 01606000
*/*********************************************************  @Z40LB30*/ 01607000
*                                                                  0539 01608000
*VSAMUCT:                                                          0539 01609000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 01610000
*                                                                  0539 01611000
VSAMUCT  ST    @14,@SA00006                                        0539 01612000
*   /*****************************************************************/ 01613000
*   /*                                                               */ 01614000
*   /* DECLARATIONS OF AREAS FOR VSAM CATALOG PARAMETER LIST @Z40LB30*/ 01615000
*   /* AND WORK AREA                                         @Z40LB30*/ 01616000
*   /*                                                               */ 01617000
*   /*****************************************************************/ 01618000
*                                                                  0540 01619000
*   DCL                                                            0540 01620000
*     CPLAREA CHAR(LENGTH(CTGPL)+LENGTH(CTGFIELD)) BDY(WORD);/*    0540 01621000
*                                                            @Z40LB30*/ 01622000
*   DCL                                                            0541 01623000
*     1 WORKAREA BDY(WORD),         /*                       @Z40LB30*/ 01624000
*      2 WRKALEN CHAR(2),           /* LENGTH OF WORK AREA   @Z40LB30*/ 01625000
*      2 * CHAR(47);                /* RETURNED BY VSAM      @Z40LB30*/ 01626000
*                                                                  0542 01627000
*   /*****************************************************************/ 01628000
*   /*                                                               */ 01629000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 01630000
*   /*                                                               */ 01631000
*   /*****************************************************************/ 01632000
*                                                                  0542 01633000
*   OLDERID2=NEWERID2;                                             0542 01634000
         L     @05,@PC00001                                        0542 01635000
         L     @05,GDTTR2(,@05)                                    0542 01636000
         MVC   @TS00001(95),NEWERID2(@05)                          0542 01637000
         MVC   OLDERID2(95,@05),@TS00001                           0542 01638000
*   NEWID2='SAVU';                  /*                       @Z40LB30*/ 01639000
*                                                                  0543 01640000
         MVC   NEWID2(4,@05),@CC01274                              0543 01641000
*   /*****************************************************************/ 01642000
*   /*                                                               */ 01643000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Z40LB30*/ 01644000
*   /*                                                               */ 01645000
*   /*****************************************************************/ 01646000
*                                                                  0544 01647000
*   CC01=0;                         /*                       @Z40LB30*/ 01648000
*                                                                  0544 01649000
         SLR   @02,@02                                             0544 01650000
         LR    CC01,@02                                            0544 01651000
*   /*****************************************************************/ 01652000
*   /*                                                               */ 01653000
*   /* INITIALIZE THE IEZCTGPL TO SCRATCH AND UNCATALOG      @Z40LB30*/ 01654000
*   /* THE DATA SET                                          @Z40LB30*/ 01655000
*   /*                                                               */ 01656000
*   /*****************************************************************/ 01657000
*                                                                  0545 01658000
*   CTGPLPTR=ADDR(CPLAREA);         /*                       @Z40LB30*/ 01659000
         LA    @05,CPLAREA                                         0545 01660000
         ST    @05,CTGPLPTR                                        0545 01661000
*   CPLAREA=''B;                    /* SET TO 0              @Z40LB30*/ 01662000
         XC    CPLAREA(32),CPLAREA                                 0546 01663000
*   CTGFUNC='100'B;                 /* CATALOG MANAGEMENT    @Z40LB30   01664000
*                                      SERVICES REQUEST      @Z40LB30*/ 01665000
         NI    CTGFUNC(@05),B'10011111'                            0547 01666000
         OI    CTGFUNC(@05),B'10000000'                            0547 01667000
*   CTGNAME=ON;                     /* CTGENT POINTS TO ENTRY      0548 01668000
*                                                            @Z40LB30   01669000
*                                      NAME                  @Z40LB30*/ 01670000
         OI    CTGNAME(@05),B'00000100'                            0548 01671000
*   CTGAM0=ON;                      /* VSAM PARAMETER LIST   @Z40LB30*/ 01672000
         OI    CTGAM0(@05),B'00000001'                             0549 01673000
*   CTGOPTNS='00011'B;              /* DELETE FUNCTION       @Z40LB30*/ 01674000
         NI    CTGOPTNS(@05),B'00011111'                           0550 01675000
         OI    CTGOPTNS(@05),B'00011000'                           0550 01676000
*   CTGDDNM=ADDR(UCTDD);            /* DD NAME               @Z40LB30*/ 01677000
         LA    @15,UCTDD(,UARGPTR)                                 0551 01678000
         ST    @15,CTGDDNM(,@05)                                   0551 01679000
*   CTGTYPE='A';                    /* NON-VSAM DATA SET     @Z40LB30*/ 01680000
         MVI   CTGTYPE(@05),C'A'                                   0552 01681000
*   CTGPURG=ON;                     /* OVERRIDE EXPIRATION   @Z40LB30   01682000
*                                      DATE                  @Z40LB30*/ 01683000
*   CTGSCR=ON;                      /* SCRATCH OPTION        @Z40LB30*/ 01684000
         OI    CTGPURG(@05),B'00100010'                            0554 01685000
*   CTGENT=ADDR(UCTDSN);            /* DATA SET NAME         @Z40LB30*/ 01686000
         LA    @15,UCTDSN(,UARGPTR)                                0555 01687000
         ST    @15,CTGENT(,@05)                                    0555 01688000
*   CTGWKA=ADDR(WORKAREA);          /* WORK AREA             @Z40LB30*/ 01689000
*                                                                  0556 01690000
         LA    @15,WORKAREA                                        0556 01691000
         ST    @15,CTGWKA(,@05)                                    0556 01692000
*   /*****************************************************************/ 01693000
*   /*                                                               */ 01694000
*   /* IF A CATALOG ACB IS SPECIFIED IN THE UCTAGL, SET ITS  @Z40LB30*/ 01695000
*   /* ADDRESS IN THE CATALOG PARAMETER LIST.                @Z40LB30*/ 01696000
*   /*                                                               */ 01697000
*   /*****************************************************************/ 01698000
*                                                                  0557 01699000
*   IF UCTACBP^=NULLPTR THEN        /*                       @Z40LB30*/ 01700000
         C     @02,UCTACBP(,UARGPTR)                               0557 01701000
         BE    @RF00557                                            0557 01702000
*     CTGCAT=ADDR(UCTACBP);         /*                       @Z40LB30*/ 01703000
         LA    @02,UCTACBP(,UARGPTR)                               0558 01704000
         ST    @02,CTGCAT(,@05)                                    0558 01705000
*   ELSE                            /*                       @Z40LB30*/ 01706000
*     CTGCNAME=ON;                  /* INDICATE NO CATALOG ACB     0559 01707000
*                                                            @Z40LB30*/ 01708000
*                                                                  0559 01709000
         B     @RC00557                                            0559 01710000
@RF00557 L     @05,CTGPLPTR                                        0559 01711000
         OI    CTGCNAME(@05),B'00000010'                           0559 01712000
*   /*****************************************************************/ 01713000
*   /*                                                               */ 01714000
*   /* INITIALIZE THE CATALOG WORK AREA                      @Z40LB30*/ 01715000
*   /*                                                               */ 01716000
*   /*****************************************************************/ 01717000
*                                                                  0560 01718000
*   WORKAREA=''B;                   /*                       @Z40LB30*/ 01719000
@RC00557 XC    WORKAREA(49),WORKAREA                               0560 01720000
*   WRKALEN=LENGTH(WORKAREA);       /*                       @Z40LB30*/ 01721000
*                                                                  0561 01722000
         MVC   WRKALEN(2),@CH01343                                 0561 01723000
*   /*****************************************************************/ 01724000
*   /*                                                               */ 01725000
*   /* ISSUE UCATLG AND SAVE RETURN CODE                     @Z40LB30*/ 01726000
*   /*                                                               */ 01727000
*   /*****************************************************************/ 01728000
*                                                                  0562 01729000
*   CALL IDCSACA0(GDTTBL,CTGPLPTR); /*                       @Z40LB30*/ 01730000
         L     @05,@PC00001                                        0562 01731000
         ST    @05,@AL00001                                        0562 01732000
         LA    @02,CTGPLPTR                                        0562 01733000
         ST    @02,@AL00001+4                                      0562 01734000
         L     @15,GDTCAT(,@05)                                    0562 01735000
         LA    @01,@AL00001                                        0562 01736000
         BALR  @14,@15                                             0562 01737000
*   RESPECIFY                                                      0563 01738000
*     RTNREG RSTD;                                                 0563 01739000
*   TESTRC=RTNREG;                                                 0564 01740000
         STH   RTNREG,TESTRC                                       0564 01741000
*   RESPECIFY                                                      0565 01742000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 01743000
*                                                                  0566 01744000
*   /*****************************************************************/ 01745000
*   /*                                                               */ 01746000
*   /* IF THE RETURN CODE IS NOT 0 OR 8, AN ERROR OCCURRED   @Z40LB30*/ 01747000
*   /* UNCATALOGING OR SCRATCHING THE DATA SET               @Z40LB30*/ 01748000
*   /*                                                               */ 01749000
*   /*****************************************************************/ 01750000
*                                                                  0566 01751000
*   IF TESTRC^=0&TESTRC^=NOTFOUND THEN/*                     @Z40LB30*/ 01752000
         LH    @05,TESTRC                                          0566 01753000
         LTR   @05,@05                                             0566 01754000
         BZ    @RF00566                                            0566 01755000
         C     @05,@CF00173                                        0566 01756000
         BE    @RF00566                                            0566 01757000
*     DO;                           /*                       @Z40LB30*/ 01758000
*                                                                  0567 01759000
*       /*************************************************************/ 01760000
*       /*                                                           */ 01761000
*       /* INITIALIZE UERROR ARGUMENT LIST AND ISSUE UERROR  @Z40LB30*/ 01762000
*       /* TO PRINT MESSAGES IDENTIFYING THE CATALOG ERROR   @Z40LB30*/ 01763000
*       /*                                                           */ 01764000
*       /*************************************************************/ 01765000
*                                                                  0568 01766000
*       ERCNVTAB=''B;               /* SET TO 0              @Z40LB30*/ 01767000
         L     @02,ERCNVADR                                        0568 01768000
         XC    ERCNVTAB(32,@02),ERCNVTAB(@02)                      0568 01769000
*       ERCATLG=ON;                 /* VSAM CATALOG ERROR    @Z40LB30*/ 01770000
         OI    ERCATLG(@02),B'10000000'                            0569 01771000
*       ERCATDL=ON;                 /* DELETE FUNCTION       @Z40LB30*/ 01772000
         OI    ERCATDL(@02),B'00100000'                            0570 01773000
*       ERDSNM=ADDR(UCTDSN);        /* DATA SET NAME         @Z40LB30*/ 01774000
         LA    @15,UCTDSN(,UARGPTR)                                0571 01775000
         ST    @15,ERDSNM(,@02)                                    0571 01776000
*       ERCATRC=TESTRC;             /* CATALOG RETURN CODE   @Z40LB30*/ 01777000
         ST    @05,ERCATRC(,@02)                                   0572 01778000
*       ERCPLPT=CTGPLPTR;           /* CATALOG PARAMETER LIST      0573 01779000
*                                                            @Z40LB30*/ 01780000
         L     @05,CTGPLPTR                                        0573 01781000
         ST    @05,ERCPLPT(,@02)                                   0573 01782000
*       CALL IDCTPER0(GDTTBL,ERCNVADR);/*                    @Z40LB37*/ 01783000
*                                                                  0574 01784000
         L     @05,@PC00001                                        0574 01785000
         ST    @05,@AL00001                                        0574 01786000
         LA    @02,ERCNVADR                                        0574 01787000
         ST    @02,@AL00001+4                                      0574 01788000
         MVI   @AL00001+4,X'80'                                    0574 01789000
         L     @15,GDTERR(,@05)                                    0574 01790000
         LA    @01,@AL00001                                        0574 01791000
         BALR  @14,@15                                             0574 01792000
*       /*************************************************************/ 01793000
*       /*                                                           */ 01794000
*       /* INITIALIZE UPRINT ARGUMENT LIST AND ISSUE UPRINT  @Z40LB30*/ 01795000
*       /* TO PRINT MESSAGE IDC0362I TO SAY THAT THE DATA    @Z40LB30*/ 01796000
*       /* SET WAS NOT SCRATCHED                             @Z40LB30*/ 01797000
*       /*                                                           */ 01798000
*       /*************************************************************/ 01799000
*                                                                  0575 01800000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 01801000
         XC    DARGAREA(28),DARGAREA                               0575 01802000
*       DARGSMOD=SA07MSG;           /*                       @Z40LB30*/ 01803000
         L     @05,DDSTRU                                          0576 01804000
         MVC   DARGSMOD(3,@05),@CC01179                            0576 01805000
*       DARGSENT=MSG0362I;          /*                       @Z40LB30*/ 01806000
         MVI   DARGSENT(@05),X'0A'                                 0577 01807000
*       DARGDBP=ADDR(UCTDSN);       /*                       @Z40LB30*/ 01808000
         LA    @02,UCTDSN(,UARGPTR)                                0578 01809000
         ST    @02,DARGDBP(,@05)                                   0578 01810000
*       DARGILP=LENGTH(UCTDSN);     /*                       @Z40LB30*/ 01811000
         MVC   DARGILP(2,@05),@CH00767                             0579 01812000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 01813000
*                                                                  0580 01814000
         L     @05,@PC00001                                        0580 01815000
         ST    @05,@AL00001                                        0580 01816000
         LA    @15,@CF00109                                        0580 01817000
         ST    @15,@AL00001+4                                      0580 01818000
         LA    @15,DDSTRU                                          0580 01819000
         ST    @15,@AL00001+8                                      0580 01820000
         MVI   @AL00001+8,X'80'                                    0580 01821000
         L     @15,GDTPRT(,@05)                                    0580 01822000
         LA    @01,@AL00001                                        0580 01823000
         BALR  @14,@15                                             0580 01824000
*       /*************************************************************/ 01825000
*       /*                                                           */ 01826000
*       /* ISSUE UPRINT TO PRINT MESSAGE IDC0363I TO SAY     @Z40LB30*/ 01827000
*       /* THE DATA SET WAS NOT UNCATALOGED                  @Z40LB30*/ 01828000
*       /*                                                           */ 01829000
*       /*************************************************************/ 01830000
*                                                                  0581 01831000
*       DARGSENT=MSG0363I;          /*                       @Z40LB30*/ 01832000
         L     @05,DDSTRU                                          0581 01833000
         MVI   DARGSENT(@05),X'0B'                                 0581 01834000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 01835000
*                                                                  0582 01836000
         L     @05,@PC00001                                        0582 01837000
         ST    @05,@AL00001                                        0582 01838000
         LA    @15,@CF00109                                        0582 01839000
         ST    @15,@AL00001+4                                      0582 01840000
         LA    @15,DDSTRU                                          0582 01841000
         ST    @15,@AL00001+8                                      0582 01842000
         MVI   @AL00001+8,X'80'                                    0582 01843000
         L     @15,GDTPRT(,@05)                                    0582 01844000
         LA    @01,@AL00001                                        0582 01845000
         BALR  @14,@15                                             0582 01846000
*       /*************************************************************/ 01847000
*       /*                                                           */ 01848000
*       /* SET INTERNAL RETURN CODE                          @Z40LB30*/ 01849000
*       /*                                                           */ 01850000
*       /*************************************************************/ 01851000
*                                                                  0583 01852000
*       CC01=4;                     /*                       @Z40LB30*/ 01853000
         LA    CC01,4                                              0583 01854000
*     END;                          /*                       @Z40LB30*/ 01855000
*                                                                  0585 01856000
*   /*****************************************************************/ 01857000
*   /*                                                               */ 01858000
*   /* IF THE CATALOG RETURN CODE WAS 8, INDICATING THE      @Z40LB30*/ 01859000
*   /* DATA SET WAS NOT FOUND IN THE CATALOG, ATTEMPT TO     @Z40LB30*/ 01860000
*   /* SCRATCH THE DATA SET FROM THE VTOC                    @Z40LB30*/ 01861000
*   /*                                                               */ 01862000
*   /*****************************************************************/ 01863000
*                                                                  0585 01864000
*   ELSE                                                           0585 01865000
*     IF TESTRC=NOTFOUND THEN                                      0585 01866000
         B     @RC00566                                            0585 01867000
@RF00566 CLC   TESTRC(2),@CH00173                                  0585 01868000
         BNE   @RF00585                                            0585 01869000
*       DO;                         /*                       @Z40LB30*/ 01870000
*                                                                  0586 01871000
*         /***********************************************************/ 01872000
*         /*                                                         */ 01873000
*         /* ISSUE USCRATCH MACRO TO SCRATCH THE DATA SET.   @Z40LB30*/ 01874000
*         /* IF THE DATA SET IS NOT ON THE VTOC, USCRATCH    @Z40LB30*/ 01875000
*         /* WILL RETURN A SUCCESSFUL CODE. SPECIFY ON       @Z40LB30*/ 01876000
*         /* USCRATCH MACRO THE DATA SET NAME AND INDICATE   @Z40LB30*/ 01877000
*         /* EXPIRATION DATE IS TO BE OVERRIDDEN. SAVE THE   @Z40LB30*/ 01878000
*         /* RETURN CODE.                                    @Z40LB30*/ 01879000
*         /*                                                         */ 01880000
*         /***********************************************************/ 01881000
*                                                                  0587 01882000
*         CALL IDCSASC0(GDTTBL,UCTDSN,ADDR(UVOLLIST),OVERRIDE);/*  0587 01883000
*                                                            @Z40LB30*/ 01884000
         L     @05,@PC00001                                        0587 01885000
         ST    @05,@AL00001                                        0587 01886000
         LA    @02,UCTDSN(,UARGPTR)                                0587 01887000
         ST    @02,@AL00001+4                                      0587 01888000
         LA    @02,UCTVOLP(,UARGPTR)                               0587 01889000
         ST    @02,@AL00001+8                                      0587 01890000
         LA    @02,OVERRIDE                                        0587 01891000
         ST    @02,@AL00001+12                                     0587 01892000
         MVI   @AL00001+12,X'80'                                   0587 01893000
         L     @15,GDTSCR(,@05)                                    0587 01894000
         LA    @01,@AL00001                                        0587 01895000
         BALR  @14,@15                                             0587 01896000
*         RESPECIFY                                                0588 01897000
*           RTNREG RSTD;                                           0588 01898000
*         TESTRC=RTNREG;                                           0589 01899000
         STH   RTNREG,TESTRC                                       0589 01900000
*         RESPECIFY                                                0590 01901000
*           RTNREG UNRSTD;          /*                       @Z40LB30*/ 01902000
*                                                                  0590 01903000
*         /***********************************************************/ 01904000
*         /*                                                         */ 01905000
*         /* IF THE USCRATCH RETURN CODE IS NOT ZERO, SET    @Z40LB30*/ 01906000
*         /* THE INTERNAL RETURN CODE. USCRATCH HAS ISSUED   @Z40LB30*/ 01907000
*         /* NECESSARY MESSAGES                              @Z40LB30*/ 01908000
*         /*                                                         */ 01909000
*         /***********************************************************/ 01910000
*                                                                  0591 01911000
*         IF TESTRC^=0 THEN                                        0591 01912000
         LH    @05,TESTRC                                          0591 01913000
         LTR   @05,@05                                             0591 01914000
         BZ    @RF00591                                            0591 01915000
*           CC01=4;                 /*                       @Z40LB30*/ 01916000
         LA    CC01,4                                              0592 01917000
*       END;                        /*                       @Z40LB30*/ 01918000
*                                                                  0593 01919000
@RF00591 DS    0H                                                  0594 01920000
*   /*****************************************************************/ 01921000
*   /*                                                               */ 01922000
*   /* RETURN TO THE CALLER                                  @Z40LB30*/ 01923000
*   /*                                                               */ 01924000
*   /*****************************************************************/ 01925000
*                                                                  0594 01926000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 01927000
@RF00585 DS    0H                                                  0594 01928000
@RC00566 LR    @15,CC01                                            0594 01929000
@EL00006 DS    0H                                                  0594 01930000
@EF00006 DS    0H                                                  0594 01931000
@ER00006 L     @14,@SA00006                                        0594 01932000
         BR    @14                                                 0594 01933000
*   END VSAMUCT;                    /*                       @Z40LB30*/ 01934000
*                                                                  0596 01935000
*/********************************************************************/ 01936000
*/*                                                          @Z40LB37*/ 01937000
*/* PROCEDURE NAME - IDCSALC (ENTRY POINT FOR ULOCATE)       @Z40LB37*/ 01938000
*/*                                                          @Z40LB37*/ 01939000
*/* FUNCTION - CONTROLS THE FLOW AMONG LOWER PROCEDURES      @Z40LB37*/ 01940000
*/*            FOR LOCATING A NON-VSAM DATA SET              @Z40LB37*/ 01941000
*/*                                                          @Z40LB37*/ 01942000
*/* INPUT  - GDTTBL, DSNAME VARIABLE, VOLSER VARIABLE,       @Z40LB37*/ 01943000
*/*          DEVICE TYPE VARIABLE, LCTINFO AREA ADDRESS      @Z40LB37*/ 01944000
*/*                                                          @Z40LB37*/ 01945000
*/* OUTPUT - LCTINFO HEADER IS SET                           @Z40LB37*/ 01946000
*/*                                                          @Z40LB37*/ 01947000
*/*          R. C. = 0, DATA SET LOCATED SUCCESSFULLY.       @Z40LB37*/ 01948000
*/*                                                          @Z40LB37*/ 01949000
*/*          R. C. = 4, DATA SET NOT LOCATED SUCCESSFULLY.   @Z40LB37*/ 01950000
*/*                     CATALOG ERROR.                       @Z40LB37*/ 01951000
*/*                                                          @Z40LB37*/ 01952000
*/*          R. C. = 8, DATA SET NOT FOUND IN CATALOG        @Z40LB37*/ 01953000
*/*                     SEARCH.                              @Z40LB37*/ 01954000
*/*                                                          @Z40LB37*/ 01955000
*/********************************************************************/ 01956000
*                                                                  0596 01957000
*IDCSALC:                                                          0596 01958000
*   ENTRY(GDTTBL,                   /* GLOBAL DATA TABLE     @Z40LB37*/ 01959000
*       DSNVAR,                     /* DSNAME VARIABLE       @Z40LB37*/ 01960000
*       VOLVAR,                     /* VOLSER VARIABLE       @Z40LB37*/ 01961000
*       DEVVAR,                     /* DEVICE TYPE VARIABLE  @Z40LB37*/ 01962000
*       LOCAREAP);                  /* LOCATE INFO AREA PTR  @Z40LB37*/ 01963000
         B     @EC00596                                            0596 01964000
@EP00596 MVC   @PC00001(4),0(@01)                                  0596 01965000
         MVC   @PC00001+12(16),4(@01)                              0596 01966000
@EC00596 DS    0H                                                  0597 01967000
*                                                                  0597 01968000
*   /*****************************************************************/ 01969000
*   /*                                                               */ 01970000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB37*/ 01971000
*   /*                                                               */ 01972000
*   /*****************************************************************/ 01973000
*                                                                  0597 01974000
*   OLDERID2=NEWERID2;                                             0597 01975000
         L     @15,@PC00001                                        0597 01976000
         L     @14,GDTTR2(,@15)                                    0597 01977000
         MVC   @TS00001(95),NEWERID2(@14)                          0597 01978000
         MVC   OLDERID2(95,@14),@TS00001                           0597 01979000
*   NEWID2='SALT';                  /*                       @Z40LB37*/ 01980000
*                                                                  0598 01981000
         MVC   NEWID2(4,@14),@CC01291                              0598 01982000
*   /*****************************************************************/ 01983000
*   /*                                                               */ 01984000
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB37*/ 01985000
*   /*                                                               */ 01986000
*   /*****************************************************************/ 01987000
*                                                                  0599 01988000
*   IF GDTDBG=NULLPTR THEN                                         0599 01989000
         L     @15,GDTDBG(,@15)                                    0599 01990000
         LTR   @15,@15                                             0599 01991000
         BZ    @RT00599                                            0599 01992000
*     ;                                                            0600 01993000
*   ELSE                                                           0601 01994000
*     CALL IDCDB010(GDTTBL,'SALC'); /*                       @Z40LB37*/ 01995000
*                                                                  0601 01996000
         L     @15,@PC00001                                        0601 01997000
         ST    @15,@AL00001                                        0601 01998000
         LA    @14,@CC01292                                        0601 01999000
         ST    @14,@AL00001+4                                      0601 02000000
         MVI   @AL00001+4,X'80'                                    0601 02001000
         L     @15,GDTDBG(,@15)                                    0601 02002000
         LA    @01,@AL00001                                        0601 02003000
         BALR  @14,@15                                             0601 02004000
*   /*****************************************************************/ 02005000
*   /*                                                               */ 02006000
*   /* ESTABLISH ADDRESSABILITY TO INPUT VARIABLE            @Z40LB37*/ 02007000
*   /* LISTS AND TO UPRINT ARGUMENT LIST AND TO UERROR       @Z40LB37*/ 02008000
*   /* ARGUMENT LIST                                         @Z40LB37*/ 02009000
*   /*                                                               */ 02010000
*   /*****************************************************************/ 02011000
*                                                                  0602 02012000
*   RESPECIFY                                                      0602 02013000
*     LOCTDSN BASED(ADDR(DSNVAR));  /*                       @Z40LB37*/ 02014000
@RT00599 DS    0H                                                  0603 02015000
*   RESPECIFY                                                      0603 02016000
*     LOCTVOL BASED(ADDR(VOLVAR));  /*                       @Z40LB37*/ 02017000
*   RESPECIFY                                                      0604 02018000
*     LOCTDEV BASED(ADDR(DEVVAR));  /*                       @Z40LB37*/ 02019000
*   RESPECIFY                                                      0605 02020000
*     LCTINFO BASED(LOCTPTR);       /*                       @Z40LB37*/ 02021000
*   LOCTPTR=LOCAREAP;               /*                       @Z40LB37*/ 02022000
         L     @15,@PC00001+24                                     0606 02023000
         L     LOCTPTR,LOCAREAP(,@15)                              0606 02024000
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB37*/ 02025000
         LA    @15,DARGAREA                                        0607 02026000
         ST    @15,DDSTRU                                          0607 02027000
*   ERCNVADR=ADDR(ERRAREA);         /*                       @Z40LB37*/ 02028000
*                                                                  0608 02029000
         LA    @15,ERRAREA                                         0608 02030000
         ST    @15,ERCNVADR                                        0608 02031000
*   /*****************************************************************/ 02032000
*   /*                                                               */ 02033000
*   /* SET HEADER IN LCTINFO                                 @Z40LB37*/ 02034000
*   /*                                                               */ 02035000
*   /*****************************************************************/ 02036000
*                                                                  0609 02037000
*   LCTHEAD=LOCTHDR;                /*                       @Z40LB37*/ 02038000
         MVC   LCTHEAD(8,LOCTPTR),LOCTHDR                          0609 02039000
*                                                                  0610 02040000
*   /*****************************************************************/ 02041000
*   /*                                                               */ 02042000
*   /* CALL VSAMLOC PROCEDURE TO LOCATE A NON-VSAM DATA      @Z40LB37*/ 02043000
*   /* SET. SAVE THE RETURN CODE                             @Z40LB37*/ 02044000
*   /*                                                               */ 02045000
*   /*****************************************************************/ 02046000
*                                                                  0610 02047000
*   CALL VSAMLOC;                   /*                       @Z40LB37*/ 02048000
         BAL   @14,VSAMLOC                                         0610 02049000
*   RESPECIFY                                                      0611 02050000
*     RTNREG RSTD;                                                 0611 02051000
*   TESTRC=RTNREG;                                                 0612 02052000
         STH   RTNREG,TESTRC                                       0612 02053000
*   RESPECIFY                                                      0613 02054000
*     RTNREG UNRSTD;                /*                       @Z40LB37*/ 02055000
*                                                                  0613 02056000
*   /*****************************************************************/ 02057000
*   /*                                                               */ 02058000
*   /* IF RETURN CODE IS SUCCESSFUL THEN CHECK VOLSER AND    @Z40LB37*/ 02059000
*   /* DEVICE TYPE AGAINST LOCATED ENTRY.                    @Z40LB37*/ 02060000
*   /*                                                               */ 02061000
*   /*****************************************************************/ 02062000
*                                                                  0614 02063000
*   IF TESTRC=0 THEN                                               0614 02064000
         LH    @03,TESTRC                                          0614 02065000
         LTR   @03,@03                                             0614 02066000
         BNZ   @RF00614                                            0614 02067000
*     DO;                           /*                       @Z40LB37*/ 02068000
*                                                                  0615 02069000
*       /*************************************************************/ 02070000
*       /*                                                           */ 02071000
*       /* CHECK THE VOLSER AND DEVICE TYPE FROM CALLER.     @Z40LB37*/ 02072000
*       /*                                                           */ 02073000
*       /*************************************************************/ 02074000
*                                                                  0616 02075000
*       DEVICEOK=OFF;               /*                       @Z40LB37*/ 02076000
         NI    DEVICEOK,B'01111111'                                0616 02077000
*       VOLSEROK=OFF;               /*                       @Z40LB37*/ 02078000
         NI    VOLSEROK,B'01111111'                                0617 02079000
*       DO COUNTI=1 TO LOCCOUNT;    /*                       @Z40LB37*/ 02080000
         LA    COUNTI,1                                            0618 02081000
         B     @DE00618                                            0618 02082000
@DL00618 DS    0H                                                  0619 02083000
*         IF LOCTVOL=LOCTVOLS(COUNTI) THEN                         0619 02084000
         L     @15,@PC00001+16                                     0619 02085000
         LR    @14,COUNTI                                          0619 02086000
         MH    @14,@CH00222                                        0619 02087000
         L     @09,CTGFLPT(,CTGFLPTR)                              0619 02088000
         ST    @14,@TF00001                                        0619 02089000
         ALR   @14,@09                                             0619 02090000
         AL    @14,@CF01356                                        0619 02091000
         CLC   LOCTVOL(6,@15),LOCTVOLS-6(@14)                      0619 02092000
         BNE   @RF00619                                            0619 02093000
*           DO;                     /*                       @Z40LB37*/ 02094000
*             VOLSEROK=ON;          /*                       @Z40LB37*/ 02095000
         OI    VOLSEROK,B'10000000'                                0621 02096000
*             IF((LOCTRV=ON&LOCTCRV(COUNTI)=ON)|(LOCTRV=OFF&LOCTCRV(    02097000
*                 COUNTI)=OFF))&(LOCTDTYP=LOCTCTYP(COUNTI)) THEN   0622 02098000
         L     @08,@PC00001+20                                     0622 02099000
         TM    LOCTRV(@08),B'00001000'                             0622 02100000
         BNO   @GL00010                                            0622 02101000
         AL    @09,@TF00001                                        0622 02102000
         AL    @09,@CF01357                                        0622 02103000
         TM    LOCTCRV-3(@09),B'00001000'                          0622 02104000
         BO    @GL00009                                            0622 02105000
@GL00010 L     @15,@PC00001+20                                     0622 02106000
         TM    LOCTRV(@15),B'00001000'                             0622 02107000
         BNZ   @RF00622                                            0622 02108000
         LR    @15,COUNTI                                          0622 02109000
         MH    @15,@CH00222                                        0622 02110000
         L     @01,CTGFLPT(,CTGFLPTR)                              0622 02111000
         ALR   @01,@15                                             0622 02112000
         AL    @01,@CF01357                                        0622 02113000
         TM    LOCTCRV-3(@01),B'00001000'                          0622 02114000
         BNZ   @RF00622                                            0622 02115000
@GL00009 L     @15,@PC00001+20                                     0622 02116000
         LR    @14,COUNTI                                          0622 02117000
         MH    @14,@CH00222                                        0622 02118000
         L     @01,CTGFLPT(,CTGFLPTR)                              0622 02119000
         ALR   @01,@14                                             0622 02120000
         AL    @01,@CF01358                                        0622 02121000
         CLC   LOCTDTYP(2,@15),LOCTCTYP-4(@01)                     0622 02122000
         BNE   @RF00622                                            0622 02123000
*               DEVICEOK=ON;        /*                       @Z40LB37*/ 02124000
         OI    DEVICEOK,B'10000000'                                0623 02125000
*           END;                    /*                       @Z40LB37*/ 02126000
@RF00622 DS    0H                                                  0625 02127000
*       END;                        /*                       @Z40LB37*/ 02128000
@RF00619 AL    COUNTI,@CF00213                                     0625 02129000
@DE00618 C     COUNTI,LOCCOUNT                                     0625 02130000
         BNH   @DL00618                                            0625 02131000
*                                                                  0626 02132000
*       /*************************************************************/ 02133000
*       /*                                                           */ 02134000
*       /* IF VOLSER IS NOT THE SAME AS THE CALLER'S INPUT,  @Z40LB37*/ 02135000
*       /* THEN PRINT MESSAGE IDC2399I.                      @Z40LB37*/ 02136000
*       /*                                                           */ 02137000
*       /*************************************************************/ 02138000
*                                                                  0626 02139000
*       IF VOLSEROK^=ON THEN                                       0626 02140000
         TM    VOLSEROK,B'10000000'                                0626 02141000
         BO    @RF00626                                            0626 02142000
*         DO;                       /*                       @Z40LB37*/ 02143000
*           DARGAREA=''B;           /*                       @Z40LB37*/ 02144000
         XC    DARGAREA(28),DARGAREA                               0628 02145000
*           DARGSMOD=SA07MSG;       /*                       @Z40LB37*/ 02146000
         L     @15,DDSTRU                                          0629 02147000
         MVC   DARGSMOD(3,@15),@CC01179                            0629 02148000
*           DARGSENT=MSG2399I;      /*                       @Z40LB37*/ 02149000
         MVI   DARGSENT(@15),X'07'                                 0630 02150000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB37*/ 02151000
         L     @15,@PC00001                                        0631 02152000
         ST    @15,@AL00001                                        0631 02153000
         LA    @14,@CF00109                                        0631 02154000
         ST    @14,@AL00001+4                                      0631 02155000
         LA    @14,DDSTRU                                          0631 02156000
         ST    @14,@AL00001+8                                      0631 02157000
         MVI   @AL00001+8,X'80'                                    0631 02158000
         L     @15,GDTPRT(,@15)                                    0631 02159000
         LA    @01,@AL00001                                        0631 02160000
         BALR  @14,@15                                             0631 02161000
*           TESTRC=4;               /*                       @Z40LB37*/ 02162000
         MVC   TESTRC(2),@CH00036                                  0632 02163000
*         END;                      /*                       @Z40LB37*/ 02164000
*                                                                  0633 02165000
*       /*************************************************************/ 02166000
*       /*                                                           */ 02167000
*       /* IF DEVICE IS NOT THE SAME AS THE CALLER'S INPUT,  @Z40LB37*/ 02168000
*       /* THEN PRINT MESSAGE IDC2360I.                      @Z40LB37*/ 02169000
*       /*                                                           */ 02170000
*       /*************************************************************/ 02171000
*                                                                  0634 02172000
*       ELSE                                                       0634 02173000
*         IF DEVICEOK^=ON THEN                                     0634 02174000
         B     @RC00626                                            0634 02175000
@RF00626 TM    DEVICEOK,B'10000000'                                0634 02176000
         BO    @RF00634                                            0634 02177000
*           DO;                     /*                       @Z40LB37*/ 02178000
*             DARGAREA=''B;         /*                       @Z40LB37*/ 02179000
         XC    DARGAREA(28),DARGAREA                               0636 02180000
*             DARGSMOD=SA07MSG;     /*                       @Z40LB37*/ 02181000
         L     @15,DDSTRU                                          0637 02182000
         MVC   DARGSMOD(3,@15),@CC01179                            0637 02183000
*             DARGSENT=MSG2360I;    /*                       @Z40LB37*/ 02184000
         MVI   DARGSENT(@15),X'08'                                 0638 02185000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB37*/ 02186000
         L     @15,@PC00001                                        0639 02187000
         ST    @15,@AL00001                                        0639 02188000
         LA    @14,@CF00109                                        0639 02189000
         ST    @14,@AL00001+4                                      0639 02190000
         LA    @14,DDSTRU                                          0639 02191000
         ST    @14,@AL00001+8                                      0639 02192000
         MVI   @AL00001+8,X'80'                                    0639 02193000
         L     @15,GDTPRT(,@15)                                    0639 02194000
         LA    @01,@AL00001                                        0639 02195000
         BALR  @14,@15                                             0639 02196000
*             TESTRC=4;             /*                       @Z40LB37*/ 02197000
         MVC   TESTRC(2),@CH00036                                  0640 02198000
*           END;                    /*                       @Z40LB37*/ 02199000
*     END;                          /*                       @Z40LB37*/ 02200000
@RF00634 DS    0H                                                  0642 02201000
@RC00626 DS    0H                                                  0643 02202000
*                                                                  0643 02203000
*   /*****************************************************************/ 02204000
*   /*                                                               */ 02205000
*   /* IF RETURN CODE IS NOT ZERO AND NOT EIGHT, THEN        @Z40LB37*/ 02206000
*   /* A CATALOG ERROR OCCURRED. PRINT ERROR MESSAGE         @Z40LB37*/ 02207000
*   /* IDC0361I AND SET RETURN CODE.                         @Z40LB37*/ 02208000
*   /*                                                               */ 02209000
*   /*****************************************************************/ 02210000
*                                                                  0643 02211000
*   IF TESTRC^=0&TESTRC^=8 THEN                                    0643 02212000
@RF00614 LH    @15,TESTRC                                          0643 02213000
         LTR   @15,@15                                             0643 02214000
         BZ    @RF00643                                            0643 02215000
         C     @15,@CF00173                                        0643 02216000
         BE    @RF00643                                            0643 02217000
*     DO;                           /*                       @Z40LB37*/ 02218000
*       DARGAREA=''B;               /*                       @Z40LB37*/ 02219000
         XC    DARGAREA(28),DARGAREA                               0645 02220000
*       DARGSMOD=SA07MSG;           /*                       @Z40LB37*/ 02221000
         L     @15,DDSTRU                                          0646 02222000
         MVC   DARGSMOD(3,@15),@CC01179                            0646 02223000
*       DARGSENT=MSG0361I;          /*                       @Z40LB37*/ 02224000
         MVI   DARGSENT(@15),X'09'                                 0647 02225000
*       DARGDBP=ADDR(LOCTDSN);      /*                       @Z40LB37*/ 02226000
         L     @14,@PC00001+12                                     0648 02227000
         ST    @14,DARGDBP(,@15)                                   0648 02228000
*       DARGILP=LENGTH(LOCTDSN);    /*                       @Z40LB37*/ 02229000
         MVC   DARGILP(2,@15),@CH00767                             0649 02230000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB37*/ 02231000
         L     @15,@PC00001                                        0650 02232000
         ST    @15,@AL00001                                        0650 02233000
         LA    @14,@CF00109                                        0650 02234000
         ST    @14,@AL00001+4                                      0650 02235000
         LA    @14,DDSTRU                                          0650 02236000
         ST    @14,@AL00001+8                                      0650 02237000
         MVI   @AL00001+8,X'80'                                    0650 02238000
         L     @15,GDTPRT(,@15)                                    0650 02239000
         LA    @01,@AL00001                                        0650 02240000
         BALR  @14,@15                                             0650 02241000
*       TESTRC=4;                   /*                       @Z40LB37*/ 02242000
         MVC   TESTRC(2),@CH00036                                  0651 02243000
*     END;                          /*                       @Z40LB37*/ 02244000
*                                                                  0652 02245000
*   /*****************************************************************/ 02246000
*   /*                                                               */ 02247000
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB37*/ 02248000
*   /*                                                               */ 02249000
*   /*****************************************************************/ 02250000
*                                                                  0653 02251000
*   IF GDTDBG=NULLPTR THEN                                         0653 02252000
@RF00643 L     @15,@PC00001                                        0653 02253000
         L     @15,GDTDBG(,@15)                                    0653 02254000
         LTR   @15,@15                                             0653 02255000
         BZ    @RT00653                                            0653 02256000
*     ;                                                            0654 02257000
*   ELSE                                                           0655 02258000
*     CALL IDCDB010(GDTTBL,'SALE'); /*                       @Z40LB37*/ 02259000
*                                                                  0655 02260000
         L     @15,@PC00001                                        0655 02261000
         ST    @15,@AL00001                                        0655 02262000
         LA    @14,@CC01301                                        0655 02263000
         ST    @14,@AL00001+4                                      0655 02264000
         MVI   @AL00001+4,X'80'                                    0655 02265000
         L     @15,GDTDBG(,@15)                                    0655 02266000
         LA    @01,@AL00001                                        0655 02267000
         BALR  @14,@15                                             0655 02268000
*   /*****************************************************************/ 02269000
*   /*                                                               */ 02270000
*   /* RETURN TO THE CALLER WITH THE RETURN CODE             @Z40LB37*/ 02271000
*   /*                                                               */ 02272000
*   /*****************************************************************/ 02273000
*                                                                  0656 02274000
*   CALL IDCSAEP0(GDTTBL,MODID,TESTRC);/*                    @Z40LB37*/ 02275000
@RT00653 L     @15,@PC00001                                        0656 02276000
         ST    @15,@AL00001                                        0656 02277000
         LA    @14,MODID                                           0656 02278000
         ST    @14,@AL00001+4                                      0656 02279000
         LA    @14,TESTRC                                          0656 02280000
         ST    @14,@AL00001+8                                      0656 02281000
         MVI   @AL00001+8,X'80'                                    0656 02282000
         L     @15,GDTEPL(,@15)                                    0656 02283000
         LA    @01,@AL00001                                        0656 02284000
         BALR  @14,@15                                             0656 02285000
*                                                                  0657 02286000
*/********************************************************************/ 02287000
*/*                                                          @Z40LB37*/ 02288000
*/* PROCEDURE NAME - VSAMLOC                                 @Z40LB37*/ 02289000
*/*                                                          @Z40LB37*/ 02290000
*/* FUNCTION - VSAMLOC LOCATES A NON-VSAM DATA SET ENTRY     @Z40LB37*/ 02291000
*/*            THAT IS CATALOGED IN A VSAM CATALOG           @Z40LB37*/ 02292000
*/*            IN VS/1 OR VS/2 OR THAT IS CATALOGED IN       @Z40LB37*/ 02293000
*/*            AN OS CVOL THAT IS CONNECTED TO THE VSAM      @Z40LB37*/ 02294000
*/*            MASTER CATALOG IN VS/2.  MESSAGE IDC2364I     @Z40LB37*/ 02295000
*/*            IS ISSUED IF THE DATA SET WAS NOT A NON-VSAM  @Z40LB37*/ 02296000
*/*            DATA SET.                                     @Z40LB37*/ 02297000
*/*                                                          @Z40LB37*/ 02298000
*/* INPUT  - LCTINFO, DSNAME VARIABLE                        @Z40LB37*/ 02299000
*/*                                                          @Z40LB37*/ 02300000
*/* OUTPUT - RETURN CODE IN REGISTER 15.  LOCCOUNT SET WITH  @Z40LB37*/ 02301000
*/*          NUMBER OF VOLUME ENTRIES IF RETURN CODE IS 0.   @Z40LB37*/ 02302000
*/*                                                          @Z40LB37*/ 02303000
*/*          R. C. = 0, DATA SET LOCATED SUCCESSFULLY.       @Z40LB37*/ 02304000
*/*                                                          @Z40LB37*/ 02305000
*/*          R. C. = 4, AN ERROR OCCURRED LOCATING THE       @Z40LB37*/ 02306000
*/*                     DATA SET.                            @Z40LB37*/ 02307000
*/*                                                          @Z40LB37*/ 02308000
*/*          R. C. = 8, DATA SET ENTRY WAS NOT FOUND IN THE  @Z40LB37*/ 02309000
*/*                     CATALOG.                             @Z40LB37*/ 02310000
*/*                                                          @Z40LB37*/ 02311000
*/********************************************************************/ 02312000
*                                                                  0657 02313000
*VSAMLOC:                                                          0657 02314000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB37*/ 02315000
         B     @PB00007                                            0657 02316000
VSAMLOC  ST    @14,@SA00007                                        0657 02317000
*                                                                  0658 02318000
*   /*****************************************************************/ 02319000
*   /*                                                               */ 02320000
*   /* DECLARATIONS OF AREAS FOR VSAM CATALOG PARAMETER      @Z40LB37*/ 02321000
*   /* LIST, VSAM CATALOG FIELD PARAMETER LISTS, AND THE     @Z40LB37*/ 02322000
*   /* CATALOG WORK AREA                                     @Z40LB37*/ 02323000
*   /*                                                               */ 02324000
*   /*****************************************************************/ 02325000
*                                                                  0658 02326000
*   DCL                                                            0658 02327000
*     LCPLAREA CHAR(LENGTH(CTGPL)+(LENGTH(CTGFIELD)*6)) BDY(WORD);/*    02328000
*                                                            @Z40LB37*/ 02329000
*   DCL                                                            0659 02330000
*     LCFLAREA CHAR((LENGTH(CTGFL)+LENGTH(CTGFLDAT))*6) BDY(WORD);/*    02331000
*                                                            @Z40LB37*/ 02332000
*   DCL                                                            0660 02333000
*     1 LOCWAREA BDY(WORD),         /*                       @Z40LB37*/ 02334000
*      2 LOCWLEN1 CHAR(2),          /* LENGTH OF WORK AREA   @Z40LB37*/ 02335000
*      2 LOCWLEN2 CHAR(2),          /* RETURNED BY VSAM      @Z40LB37*/ 02336000
*      2 LOCWENTP CHAR(1),          /* ENTRY TYPE RETURNED   @Z40LB37*/ 02337000
*      2 LOCWDATE,                  /* RETURNED DATE FIELDS  @Z40LB37*/ 02338000
*       3 LOCWCRDT CHAR(3),         /* RETURNED CREATION     @Z40LB37*/ 02339000
*       3 LOCWEXDT CHAR(3),         /* RETURNED EXPIRATION   @Z40LB37*/ 02340000
*       3 * CHAR(1),                /* RESERVED              @Z40LB37*/ 02341000
*      2 LOCWOWNR CHAR(8),          /* OWNER ID RETURNED     @Z40LB37*/ 02342000
*      2 LOCWACBP PTR(31),          /* ACBPTR RETURNED       @Z40LB37*/ 02343000
*      2 LOCWVOLL(255),             /* RETURNED VOLSER FIELD @Z40LB37*/ 02344000
*       3 LOCWREP CHAR(2),          /* RETURNED REPEAT CNT   @Z40LB37*/ 02345000
*       3 LOCWDEVT CHAR(4),         /* RETURNED DEVICE TYPE  @Z40LB37*/ 02346000
*       3 LOCWVOL CHAR(6),          /* RETURNED VOLSER       @Z40LB37*/ 02347000
*       3 LOCWFILS CHAR(2),         /* RETURNED FILES        @Z40LB37*/ 02348000
*       3 LOCWVOLF CHAR(1);         /* RETURNED VOL FLAGS    @Z40LB37*/ 02349000
*   DCL                                                            0661 02350000
*     VLOCRC FIXED(15) BDY(HWORD);  /* VSAMLOC RETURN CODE   @Z40LB37*/ 02351000
*   DCL                                                            0662 02352000
*     LCTGFNUM PTR(8) CONSTANT(6);  /* NUM OF CTGFLS         @Z40LB37*/ 02353000
*   DCL                                                            0663 02354000
*     DSENTYP CHAR(8) INIT('ENTYPE  ');/* ENTRY TYPE         @Z40LB37*/ 02355000
*   DCL                                                            0664 02356000
*     DSCRDT CHAR(8) INIT('DSETCRDT');/* CREATION DATE       @Z40LB37*/ 02357000
*   DCL                                                            0665 02358000
*     DSEXDT CHAR(8) INIT('DSETEXDT');/* EXPIRATION DATE     @Z40LB37*/ 02359000
*   DCL                                                            0666 02360000
*     DSOWNR CHAR(8) INIT('OWNERID ');/* OWNER IDENT         @Z40LB37*/ 02361000
*   DCL                                                            0667 02362000
*     DSCATACB CHAR(8) INIT('CATACB  ');/* CATALOG ACBPTR    @Z40LB37*/ 02363000
*   DCL                                                            0668 02364000
*     DSCATVOL CHAR(8) INIT('CATVOL  ');/* VOLSER & DEVICE   @Z40LB37   02365000
*                                      TYPE LIST REQUESTED   @Z40LB37*/ 02366000
*                                                                  0669 02367000
*   /*****************************************************************/ 02368000
*   /*                                                               */ 02369000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB37*/ 02370000
*   /*                                                               */ 02371000
*   /*****************************************************************/ 02372000
*                                                                  0669 02373000
*   OLDERID2=NEWERID2;                                             0669 02374000
         L     @06,@PC00001                                        0669 02375000
         L     @06,GDTTR2(,@06)                                    0669 02376000
         MVC   @TS00001(95),NEWERID2(@06)                          0669 02377000
         MVC   OLDERID2(95,@06),@TS00001                           0669 02378000
*   NEWID2='SAVL';                  /*                       @Z40LB37*/ 02379000
*                                                                  0670 02380000
         MVC   NEWID2(4,@06),@CC01338                              0670 02381000
*   /*****************************************************************/ 02382000
*   /*                                                               */ 02383000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Z40LB37*/ 02384000
*   /*                                                               */ 02385000
*   /*****************************************************************/ 02386000
*                                                                  0671 02387000
*   VLOCRC=0;                       /*                       @Z40LB37*/ 02388000
         SLR   VLOCRC,VLOCRC                                       0671 02389000
*                                                                  0672 02390000
*   /*****************************************************************/ 02391000
*   /*                                                               */ 02392000
*   /* INITIALIZE THE IEZCTGPL TO LOCATE THE NON-VSAM        @Z40LB37*/ 02393000
*   /* DATA SET ENTRY                                        @Z40LB37*/ 02394000
*   /*                                                               */ 02395000
*   /*****************************************************************/ 02396000
*                                                                  0672 02397000
*   CTGPLPTR=ADDR(LCPLAREA);        /*                       @Z40LB37*/ 02398000
         LA    @06,LCPLAREA                                        0672 02399000
         ST    @06,CTGPLPTR                                        0672 02400000
*   CTGFLPTR=ADDR(LCFLAREA);        /*                       @Z40LB37*/ 02401000
         LA    CTGFLPTR,LCFLAREA                                   0673 02402000
*   LCPLAREA=''B;                   /* SET TO 0              @Z40LB37*/ 02403000
         XC    LCPLAREA(52),LCPLAREA                               0674 02404000
*   LCFLAREA=''B;                   /* SET TO 0              @Z40LB37*/ 02405000
         XC    LCFLAREA(144),LCFLAREA                              0675 02406000
*   CTGFUNC='001'B;                 /* CATALOG MANAGEMENT    @Z40LB37   02407000
*                                      SERVICES REQUEST      @Z40LB37*/ 02408000
         NI    CTGFUNC(@06),B'00111111'                            0676 02409000
         OI    CTGFUNC(@06),B'00100000'                            0676 02410000
*   CTGNAME=ON;                     /* CTGENT POINTS TO ENTRY      0677 02411000
*                                                            @Z40LB37   02412000
*                                      NAME                  @Z40LB37*/ 02413000
*   CTGCNAME=ON;                    /* NO ACBPTR PASSED      @Z40LB37*/ 02414000
         OI    CTGNAME(@06),B'00000110'                            0678 02415000
*   CTGAM0=ON;                      /* VSAM PARAMETER LIST   @Z40LB37*/ 02416000
         OI    CTGAM0(@06),B'00000001'                             0679 02417000
*   CTGENT=ADDR(LOCTDSN);           /* DATA SET NAME         @Z40LB37*/ 02418000
         L     @15,@PC00001+12                                     0680 02419000
         ST    @15,CTGENT(,@06)                                    0680 02420000
*   CTGWKA=ADDR(LOCWAREA);          /* WORK AREA             @Z40LB37*/ 02421000
         LA    @15,LOCWAREA                                        0681 02422000
         ST    @15,CTGWKA(,@06)                                    0681 02423000
*   CTGNOFLD=LCTGFNUM;              /* NUMBER OF CTGFLS (6)  @Z40LB37*/ 02424000
         MVI   CTGNOFLD(@06),X'06'                                 0682 02425000
*   CTGFIELD(1)=CTGFLPTR;           /* ADDRESS OF CTGFL #1   @Z40LB37*/ 02426000
         ST    CTGFLPTR,CTGFIELD(,@06)                             0683 02427000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02428000
         LA    @14,24                                              0684 02429000
         ALR   CTGFLPTR,@14                                        0684 02430000
*   CTGFIELD(2)=CTGFLPTR;           /* ADDRESS OF CTGFL #2   @Z40LB37*/ 02431000
         ST    CTGFLPTR,CTGFIELD+4(,@06)                           0685 02432000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02433000
         ALR   CTGFLPTR,@14                                        0686 02434000
*   CTGFIELD(3)=CTGFLPTR;           /* ADDRESS OF CTGFL #3   @Z40LB37*/ 02435000
         ST    CTGFLPTR,CTGFIELD+8(,@06)                           0687 02436000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02437000
         ALR   CTGFLPTR,@14                                        0688 02438000
*   CTGFIELD(4)=CTGFLPTR;           /* ADDRESS OF CTGFL #4   @Z40LB37*/ 02439000
         ST    CTGFLPTR,CTGFIELD+12(,@06)                          0689 02440000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02441000
         ALR   CTGFLPTR,@14                                        0690 02442000
*   CTGFIELD(5)=CTGFLPTR;           /* ADDRESS OF CTGFL #5   @Z40LB37*/ 02443000
         ST    CTGFLPTR,CTGFIELD+16(,@06)                          0691 02444000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02445000
         ALR   CTGFLPTR,@14                                        0692 02446000
*   CTGFIELD(6)=CTGFLPTR;           /* ADDRESS OF CTGFL #6   @Z40LB37*/ 02447000
         ST    CTGFLPTR,CTGFIELD+20(,@06)                          0693 02448000
*                                                                  0694 02449000
*   /*****************************************************************/ 02450000
*   /*                                                               */ 02451000
*   /* INITIALIZE THE CTGFL FIELD NAMES                      @Z40LB37*/ 02452000
*   /*                                                               */ 02453000
*   /*****************************************************************/ 02454000
*                                                                  0694 02455000
*   CTGFLPTR=ADDR(LCFLAREA);        /*                       @Z40LB37*/ 02456000
         LA    @06,LCFLAREA                                        0694 02457000
         LR    CTGFLPTR,@06                                        0694 02458000
*   CTGFLDNM=ADDR(DSENTYP);         /*                       @Z40LB37*/ 02459000
         LA    @09,DSENTYP                                         0695 02460000
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0695 02461000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02462000
         ALR   CTGFLPTR,@14                                        0696 02463000
*   CTGFLDNM=ADDR(DSCRDT);          /*                       @Z40LB37*/ 02464000
         LA    @09,DSCRDT                                          0697 02465000
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0697 02466000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02467000
         ALR   CTGFLPTR,@14                                        0698 02468000
*   CTGFLDNM=ADDR(DSEXDT);          /*                       @Z40LB37*/ 02469000
         LA    @09,DSEXDT                                          0699 02470000
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0699 02471000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02472000
         ALR   CTGFLPTR,@14                                        0700 02473000
*   CTGFLDNM=ADDR(DSOWNR);          /*                       @Z40LB37*/ 02474000
         LA    @09,DSOWNR                                          0701 02475000
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0701 02476000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02477000
         ALR   CTGFLPTR,@14                                        0702 02478000
*   CTGFLDNM=ADDR(DSCATACB);        /*                       @Z40LB37*/ 02479000
         LA    @09,DSCATACB                                        0703 02480000
         ST    @09,CTGFLDNM(,CTGFLPTR)                             0703 02481000
*   CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));/*    @Z40LB37*/ 02482000
         ALR   CTGFLPTR,@14                                        0704 02483000
*   CTGFLDNM=ADDR(DSCATVOL);        /*                       @Z40LB37*/ 02484000
         LA    @14,DSCATVOL                                        0705 02485000
         ST    @14,CTGFLDNM(,CTGFLPTR)                             0705 02486000
*   CTGFLPTR=ADDR(LCFLAREA);        /*                       @Z40LB37*/ 02487000
         LR    CTGFLPTR,@06                                        0706 02488000
*                                                                  0707 02489000
*   /*****************************************************************/ 02490000
*   /*                                                               */ 02491000
*   /* INITIALIZE THE CATALOG WORK AREA                      @Z40LB37*/ 02492000
*   /*                                                               */ 02493000
*   /*****************************************************************/ 02494000
*                                                                  0707 02495000
*   RESPECIFY                                                      0707 02496000
*    (REG4,                                                        0707 02497000
*     REG5,                                                        0707 02498000
*     REG8,                                                        0707 02499000
*     REG9) RSTD;                   /*                       @Z40LB37*/ 02500000
*   REG4=ADDR(LOCWAREA);            /*                       @Z40LB37*/ 02501000
         LR    REG4,@15                                            0708 02502000
*   REG5=LENGTH(LOCWAREA);          /*                       @Z40LB37*/ 02503000
         LA    REG5,3849                                           0709 02504000
*   REG8=''B;                       /*                       @Z40LB37*/ 02505000
         SLR   @06,@06                                             0710 02506000
         LR    REG8,@06                                            0710 02507000
*   REG9=''B;                       /*                       @Z40LB37*/ 02508000
         LR    REG9,@06                                            0711 02509000
*   MVCL(REG4,REG8);                /* ZERO LOCWAREA         @Z40LB37*/ 02510000
         MVCL  REG4,REG8                                           0712 02511000
*   RESPECIFY                                                      0713 02512000
*    (REG4,                                                        0713 02513000
*     REG5,                                                        0713 02514000
*     REG8,                                                        0713 02515000
*     REG9) UNRSTD;                 /*                       @Z40LB37*/ 02516000
*   LOCWLEN1=LENGTH(LOCWAREA);      /*                       @Z40LB37*/ 02517000
*                                                                  0714 02518000
         MVC   LOCWLEN1(2),@CH01344                                0714 02519000
*   /*****************************************************************/ 02520000
*   /*                                                               */ 02521000
*   /* ISSUE UCATLG AND SAVE RETURN CODE                     @Z40LB37*/ 02522000
*   /*                                                               */ 02523000
*   /*****************************************************************/ 02524000
*                                                                  0715 02525000
*   CALL IDCSACA0(GDTTBL,CTGPLPTR); /*                       @Z40LB37*/ 02526000
         L     @06,@PC00001                                        0715 02527000
         ST    @06,@AL00001                                        0715 02528000
         LA    @15,CTGPLPTR                                        0715 02529000
         ST    @15,@AL00001+4                                      0715 02530000
         L     @15,GDTCAT(,@06)                                    0715 02531000
         LA    @01,@AL00001                                        0715 02532000
         BALR  @14,@15                                             0715 02533000
*   RESPECIFY                                                      0716 02534000
*     RTNREG RSTD;                                                 0716 02535000
*   TESTRC=RTNREG;                                                 0717 02536000
         STH   RTNREG,TESTRC                                       0717 02537000
*   RESPECIFY                                                      0718 02538000
*     RTNREG UNRSTD;                /*                       @Z40LB37*/ 02539000
*                                                                  0719 02540000
*   /*****************************************************************/ 02541000
*   /*                                                               */ 02542000
*   /* IF THE RETURN CODE IS NOT 0 AND NOT 8, AN ERROR       @Z40LB37*/ 02543000
*   /* OCCURRED LOCATING THE NON-VSAM DATA SET               @Z40LB37*/ 02544000
*   /*                                                               */ 02545000
*   /*****************************************************************/ 02546000
*                                                                  0719 02547000
*   IF TESTRC^=0&TESTRC^=8 THEN                                    0719 02548000
         LH    @06,TESTRC                                          0719 02549000
         LTR   @06,@06                                             0719 02550000
         BZ    @RF00719                                            0719 02551000
         C     @06,@CF00173                                        0719 02552000
         BE    @RF00719                                            0719 02553000
*     DO;                           /*                       @Z40LB37*/ 02554000
*                                                                  0720 02555000
*       /*************************************************************/ 02556000
*       /*                                                           */ 02557000
*       /* INITIALIZE UERROR ARGUMENT LIST AND ISSUE UERROR  @Z40LB37*/ 02558000
*       /* TO PRINT MESSAGES IDENTIFYING THE CATALOG ERROR   @Z40LB37*/ 02559000
*       /*                                                           */ 02560000
*       /*************************************************************/ 02561000
*                                                                  0721 02562000
*       ERCNVTAB=''B;               /* SET TO 0              @Z40LB37*/ 02563000
         L     @15,ERCNVADR                                        0721 02564000
         XC    ERCNVTAB(32,@15),ERCNVTAB(@15)                      0721 02565000
*       ERCATLG=ON;                 /* CATALOG ERROR         @Z40LB37*/ 02566000
         OI    ERCATLG(@15),B'10000000'                            0722 02567000
*       ERCATLC=ON;                 /* LOCATE FUNCTION       @Z40LB37*/ 02568000
         OI    ERCATLC(@15),B'10000000'                            0723 02569000
*       ERDSNM=ADDR(LOCTDSN);       /* DATA SET NAME         @Z40LB37*/ 02570000
         L     @14,@PC00001+12                                     0724 02571000
         ST    @14,ERDSNM(,@15)                                    0724 02572000
*       ERCATRC=TESTRC;             /* CATALOG RETURN CODE   @Z40LB37*/ 02573000
         ST    @06,ERCATRC(,@15)                                   0725 02574000
*       ERCPLPT=CTGPLPTR;           /* CATALOG PARAMETER LIST      0726 02575000
*                                                            @Z40LB37*/ 02576000
         L     @06,CTGPLPTR                                        0726 02577000
         ST    @06,ERCPLPT(,@15)                                   0726 02578000
*       CALL IDCTPER0(GDTTBL,ERCNVADR);/*                    @Z40LB37*/ 02579000
         L     @06,@PC00001                                        0727 02580000
         ST    @06,@AL00001                                        0727 02581000
         LA    @15,ERCNVADR                                        0727 02582000
         ST    @15,@AL00001+4                                      0727 02583000
         MVI   @AL00001+4,X'80'                                    0727 02584000
         L     @15,GDTERR(,@06)                                    0727 02585000
         LA    @01,@AL00001                                        0727 02586000
         BALR  @14,@15                                             0727 02587000
*       VLOCRC=4;                   /*                       @Z40LB37*/ 02588000
         LA    VLOCRC,4                                            0728 02589000
*     END;                          /*                       @Z40LB37*/ 02590000
*                                                                  0729 02591000
*   /*****************************************************************/ 02592000
*   /*                                                               */ 02593000
*   /* IF THE RETURN CODE IS 0 AND THE ENTRY THAT WAS FOUND  @Z40LB37*/ 02594000
*   /* IS A NON-VSAM DATA SET ENTRY, THEN PROCESS RETURNED   @Z40LB37*/ 02595000
*   /* CATALOG INFORMATION INTO THE LCTINFO AREA, ELSE PRINT @Z40LB37*/ 02596000
*   /* MESSAGE IDC2364I.                                     @Z40LB37*/ 02597000
*   /*                                                               */ 02598000
*   /*****************************************************************/ 02599000
*                                                                  0730 02600000
*   IF TESTRC=0 THEN                                               0730 02601000
@RF00719 LH    @06,TESTRC                                          0730 02602000
         LTR   @06,@06                                             0730 02603000
         BNZ   @RF00730                                            0730 02604000
*     IF LOCTENTP='A' THEN                                         0731 02605000
         L     @06,CTGFLPT(,CTGFLPTR)                              0731 02606000
         CLI   LOCTENTP(@06),C'A'                                  0731 02607000
         BNE   @RF00731                                            0731 02608000
*       DO;                         /*                       @Z40LB37*/ 02609000
*                                                                  0733 02610000
*         /***********************************************************/ 02611000
*         /*                                                         */ 02612000
*         /* CONVERT TO BINARY CREATION DATE IF RETURNED     @Z40LB37*/ 02613000
*         /*                                                         */ 02614000
*         /***********************************************************/ 02615000
*                                                                  0733 02616000
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0733 02617000
         AL    CTGFLPTR,@CF00302                                   0733 02618000
*         IF LOCTCRDT^=FOXES THEN                                  0734 02619000
         L     @06,CTGFLPT(,CTGFLPTR)                              0734 02620000
         CLC   LOCTCRDT(3,@06),FOXES                               0734 02621000
         BE    @RF00734                                            0734 02622000
*           DO;                     /*                       @Z40LB37*/ 02623000
*             FULWORD=''B;          /*                       @Z40LB37*/ 02624000
         SLR   FULWORD,FULWORD                                     0736 02625000
*             CVB(FULWORD,LOCTCRDT);/*                       @Z40LB37*/ 02626000
         XC    @TS00001(8),@TS00001                                0737 02627000
         MVC   @TS00001+5(3),LOCTCRDT(@06)                         0737 02628000
         CVB   FULWORD,@TS00001                                    0737 02629000
*             LCTCREAT(3:4)=FULWORD//THOUSAND;/*             @Z40LB37*/ 02630000
         L     @06,THOUSAND                                        0738 02631000
         LR    @00,FULWORD                                         0738 02632000
         SRDA  @00,32                                              0738 02633000
         DR    @00,@06                                             0738 02634000
         STCM  @00,3,LCTCREAT+2(LOCTPTR)                           0738 02635000
*             LCTCREAT(1:2)=FULWORD/THOUSAND;/*              @Z40LB37*/ 02636000
         LR    @00,FULWORD                                         0739 02637000
         SRDA  @00,32                                              0739 02638000
         DR    @00,@06                                             0739 02639000
         STCM  @01,3,LCTCREAT(LOCTPTR)                             0739 02640000
*           END;                    /*                       @Z40LB37*/ 02641000
*         ELSE                                                     0741 02642000
*           LCTCREAT=NULENTRY;      /*                       @Z40LB37*/ 02643000
*                                                                  0741 02644000
         B     @RC00734                                            0741 02645000
@RF00734 MVC   LCTCREAT(4,LOCTPTR),NULENTRY                        0741 02646000
*         /***********************************************************/ 02647000
*         /*                                                         */ 02648000
*         /* CONVERT TO BINARY EXPIRATION DATE IF RETURNED   @Z40LB37*/ 02649000
*         /*                                                         */ 02650000
*         /***********************************************************/ 02651000
*                                                                  0742 02652000
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0742 02653000
@RC00734 AL    CTGFLPTR,@CF00302                                   0742 02654000
*         IF LOCTEXDT^=FOXES THEN                                  0743 02655000
         L     @06,CTGFLPT(,CTGFLPTR)                              0743 02656000
         CLC   LOCTEXDT(3,@06),FOXES                               0743 02657000
         BE    @RF00743                                            0743 02658000
*           DO;                     /*                       @Z40LB37*/ 02659000
*             FULWORD=''B;          /*                       @Z40LB37*/ 02660000
         SLR   FULWORD,FULWORD                                     0745 02661000
*             CVB(FULWORD,LOCTEXDT);/*                       @Z40LB37*/ 02662000
         XC    @TS00001(8),@TS00001                                0746 02663000
         MVC   @TS00001+5(3),LOCTEXDT(@06)                         0746 02664000
         CVB   FULWORD,@TS00001                                    0746 02665000
*             LCTEXPIR(3:4)=FULWORD//THOUSAND;/*             @Z40LB37*/ 02666000
         L     @06,THOUSAND                                        0747 02667000
         LR    @00,FULWORD                                         0747 02668000
         SRDA  @00,32                                              0747 02669000
         DR    @00,@06                                             0747 02670000
         STCM  @00,3,LCTEXPIR+2(LOCTPTR)                           0747 02671000
*             LCTEXPIR(1:2)=FULWORD/THOUSAND;/*              @Z40LB37*/ 02672000
         LR    @00,FULWORD                                         0748 02673000
         SRDA  @00,32                                              0748 02674000
         DR    @00,@06                                             0748 02675000
         STCM  @01,3,LCTEXPIR(LOCTPTR)                             0748 02676000
*           END;                    /*                       @Z40LB37*/ 02677000
*         ELSE                                                     0750 02678000
*           LCTEXPIR=NULENTRY;      /*                       @Z40LB37*/ 02679000
         B     @RC00743                                            0750 02680000
@RF00743 MVC   LCTEXPIR(4,LOCTPTR),NULENTRY                        0750 02681000
*                                                                  0751 02682000
*         /***********************************************************/ 02683000
*         /*                                                         */ 02684000
*         /* SET OWNER ID IN LCTINFO AREA IF RETURNED        @Z40LB37*/ 02685000
*         /*                                                         */ 02686000
*         /***********************************************************/ 02687000
*                                                                  0751 02688000
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0751 02689000
@RC00743 AL    CTGFLPTR,@CF00302                                   0751 02690000
*         IF LOCTOWNR(6:8)^=FOXES THEN                             0752 02691000
         L     @06,CTGFLPT(,CTGFLPTR)                              0752 02692000
         CLC   LOCTOWNR+5(3,@06),FOXES                             0752 02693000
         BE    @RF00752                                            0752 02694000
*           LCTOWNER=LOCTOWNR;      /*                       @Z40LB37*/ 02695000
         MVC   LCTOWNER(8,LOCTPTR),LOCTOWNR(@06)                   0753 02696000
*         ELSE                                                     0754 02697000
*           LCTOWNER=NULOWNER;      /*                       @Z40LB37*/ 02698000
*                                                                  0754 02699000
         B     @RC00752                                            0754 02700000
@RF00752 MVC   LCTOWNER(8,LOCTPTR),NULOWNER                        0754 02701000
*         /***********************************************************/ 02702000
*         /*                                                         */ 02703000
*         /* SET CATALOG ACB POINTER IN LCTINFO IF NOT ZERO  @Z40LB37*/ 02704000
*         /*                                                         */ 02705000
*         /***********************************************************/ 02706000
*                                                                  0755 02707000
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0755 02708000
@RC00752 AL    CTGFLPTR,@CF00302                                   0755 02709000
*         IF CTGFLPT(1)^=NULLPTR THEN                              0756 02710000
         L     @06,CTGFLPT(,CTGFLPTR)                              0756 02711000
         LTR   @06,@06                                             0756 02712000
         BZ    @RF00756                                            0756 02713000
*           LCTACBP=LOCTCATA;       /*                       @Z40LB37*/ 02714000
         L     @06,LOCTCATA(,@06)                                  0757 02715000
         ST    @06,LCTACBP(,LOCTPTR)                               0757 02716000
*         ELSE                                                     0758 02717000
*           LCTACBP=''B;            /*                       @Z40LB37*/ 02718000
*                                                                  0758 02719000
         B     @RC00756                                            0758 02720000
@RF00756 SLR   @06,@06                                             0758 02721000
         ST    @06,LCTACBP(,LOCTPTR)                               0758 02722000
*         /***********************************************************/ 02723000
*         /*                                                         */ 02724000
*         /* SET VOLUME SERIAL COUNT IN LCTINFO AREA         @Z40LB37*/ 02725000
*         /*                                                         */ 02726000
*         /***********************************************************/ 02727000
*                                                                  0759 02728000
*         CTGFLPTR=CTGFLPTR+(LENGTH(CTGFL)+LENGTH(CTGFLDAT));      0759 02729000
@RC00756 AL    CTGFLPTR,@CF00302                                   0759 02730000
*         LOCCOUNT=CTGFLNG(1)/LENGTH(LOCTVOLL);/*            @Z40LB37*/ 02731000
         L     @00,CTGFLNG(,CTGFLPTR)                              0760 02732000
         SRDA  @00,32                                              0760 02733000
         D     @00,@CF00222                                        0760 02734000
         ST    @01,LOCCOUNT                                        0760 02735000
*         LCTMULVC=LOCCOUNT;        /*                       @Z40LB37*/ 02736000
*                                                                  0761 02737000
         ST    @01,LCTMULVC(,LOCTPTR)                              0761 02738000
*         /***********************************************************/ 02739000
*         /*                                                         */ 02740000
*         /* TURN ON LOCATED IN A VSAM CATALOG SWITCH        @Z40LB37*/ 02741000
*         /*                                                         */ 02742000
*         /***********************************************************/ 02743000
*                                                                  0762 02744000
*         LCTVSCAT=ON;              /*                       @Z40LB37*/ 02745000
         OI    LCTVSCAT(LOCTPTR),B'10000000'                       0762 02746000
*       END;                        /*                       @Z40LB37*/ 02747000
*     ELSE                                                         0764 02748000
*       DO;                         /*                       @Z40LB37*/ 02749000
*                                                                  0764 02750000
         B     @RC00731                                            0764 02751000
@RF00731 DS    0H                                                  0765 02752000
*         /***********************************************************/ 02753000
*         /*                                                         */ 02754000
*         /* INITIALIZE UPRINT ARGUMENT LIST, ISSUE UPRINT   @Z40LB37*/ 02755000
*         /* TO PRINT MESSAGE IDC2364I TO SAY THAT THE DATA  @Z40LB37*/ 02756000
*         /* SET WAS NOT A NON-VSAM DATA SET                 @Z40LB37*/ 02757000
*         /*                                                         */ 02758000
*         /***********************************************************/ 02759000
*                                                                  0765 02760000
*         DARGAREA=''B;             /*                       @Z40LB37*/ 02761000
         XC    DARGAREA(28),DARGAREA                               0765 02762000
*         DARGSMOD=SA07MSG;         /*                       @Z40LB37*/ 02763000
         L     @06,DDSTRU                                          0766 02764000
         MVC   DARGSMOD(3,@06),@CC01179                            0766 02765000
*         DARGSENT=MSG2364I;        /*                       @Z40LB37*/ 02766000
         MVI   DARGSENT(@06),X'0C'                                 0767 02767000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB37*/ 02768000
*                                                                  0768 02769000
         L     @06,@PC00001                                        0768 02770000
         ST    @06,@AL00001                                        0768 02771000
         LA    @03,@CF00109                                        0768 02772000
         ST    @03,@AL00001+4                                      0768 02773000
         LA    @03,DDSTRU                                          0768 02774000
         ST    @03,@AL00001+8                                      0768 02775000
         MVI   @AL00001+8,X'80'                                    0768 02776000
         L     @15,GDTPRT(,@06)                                    0768 02777000
         LA    @01,@AL00001                                        0768 02778000
         BALR  @14,@15                                             0768 02779000
*         /***********************************************************/ 02780000
*         /*                                                         */ 02781000
*         /* SET INTERNAL RETURN CODE                        @Z40LB37*/ 02782000
*         /*                                                         */ 02783000
*         /***********************************************************/ 02784000
*                                                                  0769 02785000
*         VLOCRC=4;                 /*                       @Z40LB37*/ 02786000
         LA    VLOCRC,4                                            0769 02787000
*       END;                        /*                       @Z40LB37*/ 02788000
*                                                                  0770 02789000
*   /*****************************************************************/ 02790000
*   /*                                                               */ 02791000
*   /* IF THE CATALOG RETURN CODE WAS 8, INDICATING THE      @Z40LB37*/ 02792000
*   /* DATA SET WAS NOT LOCATED IN THE CATALOG, SET RETURN   @Z40LB37*/ 02793000
*   /* CODE TO RCNLOCAT.                                     @Z40LB37*/ 02794000
*   /*                                                               */ 02795000
*   /*****************************************************************/ 02796000
*                                                                  0771 02797000
*   IF TESTRC=8 THEN                                               0771 02798000
@RC00731 DS    0H                                                  0771 02799000
@RF00730 LA    @06,8                                               0771 02800000
         CH    @06,TESTRC                                          0771 02801000
         BNE   @RF00771                                            0771 02802000
*     VLOCRC=8;                     /*                       @Z40LB37*/ 02803000
*                                                                  0772 02804000
         LR    VLOCRC,@06                                          0772 02805000
*   /*****************************************************************/ 02806000
*   /*                                                               */ 02807000
*   /* RETURN TO THE CALLER                                  @Z40LB37*/ 02808000
*   /*                                                               */ 02809000
*   /*****************************************************************/ 02810000
*                                                                  0773 02811000
*   RETURN CODE(VLOCRC);            /*                       @Z40LB37*/ 02812000
@RF00771 LR    @15,VLOCRC                                          0773 02813000
@EL00007 DS    0H                                                  0773 02814000
@EF00007 DS    0H                                                  0773 02815000
@ER00007 L     @14,@SA00007                                        0773 02816000
         BR    @14                                                 0773 02817000
*   END VSAMLOC;                    /*                       @Z40LB37*/ 02818000
*   END IDCSA07                     /*                       @Z40LB30*/ 02819000
*                                                                  0775 02820000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02821000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 02822000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 02823000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 02824000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 02825000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */ 02826000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                       */ 02827000
*                                                                  0775 02828000
*       ;                                                          0775 02829000
@EL00001 L     @13,4(,@13)                                         0775 02830000
@EF00001 L     @00,@SIZDATD                                        0775 02831000
         LR    @01,@11                                             0775 02832000
         FREEMAIN R,LV=(0),A=(1)                                        02833000
@ER00001 LM    @14,@12,12(@13)                                     0775 02834000
         BR    @14                                                 0775 02835000
@DATA    DS    0H                                                       02836000
@CH00147 DC    H'2'                                                     02837000
@CH00036 DC    H'4'                                                     02838000
@CH00032 DC    H'12'                                                    02839000
@CH00767 DC    H'44'                                                    02840000
@CH01343 DC    H'49'                                                    02841000
@CH01342 DC    H'265'                                                   02842000
@CH01344 DC    H'3849'                                                  02843000
@DATD    DSECT                                                          02844000
         DS    0F                                                       02845000
@SA00001 DS    18F                                                      02846000
@PC00001 DS    7F                                                       02847000
@SA00002 DS    15F                                                      02848000
@SA00003 DS    14F                                                      02849000
@SA00004 DS    15F                                                      02850000
@SA00006 DS    1F                                                       02851000
@SA00005 DS    1F                                                       02852000
@SA00007 DS    1F                                                       02853000
@AL00001 DS    4A                                                       02854000
@TF00001 DS    F                                                        02855000
@AFTEMPS DS    3F                                                       02856000
IDCSA07  CSECT                                                          02857000
         DS    0F                                                       02858000
@CF00109 DC    F'0'                                                     02859000
@CF00213 DC    F'1'                                                     02860000
@CH00213 EQU   @CF00213+2                                               02861000
@CF00173 DC    F'8'                                                     02862000
@CH00173 EQU   @CF00173+2                                               02863000
@CF00222 DC    F'15'                                                    02864000
@CH00222 EQU   @CF00222+2                                               02865000
@CF00466 DC    F'16'                                                    02866000
@CF01109 DC    F'20'                                                    02867000
@CH01109 EQU   @CF01109+2                                               02868000
@CF00302 DC    F'24'                                                    02869000
@CF01357 DC    F'-12'                                                   02870000
@CF01358 DC    F'-11'                                                   02871000
@CF01356 DC    F'-9'                                                    02872000
@DATD    DSECT                                                          02873000
         DS    0D                                                       02874000
LISTSCAN DS    A                                                        02875000
IOCSPTR  DS    A                                                        02876000
OPNPTR   DS    A                                                        02877000
DDSTRU   DS    A                                                        02878000
FSADDR   DS    A                                                        02879000
ERCNVADR DS    A                                                        02880000
CCMSGPTR DS    A                                                        02881000
CMMSGPTR DS    A                                                        02882000
CTMSGPTR DS    A                                                        02883000
ELEMENT  DS    F                                                        02884000
CTGPLPTR DS    A                                                        02885000
LOCCOUNT DS    F                                                        02886000
LISTPTR  DS    A                                                        02887000
SETRC    DS    H                                                        02888000
TESTRC   DS    H                                                        02889000
RSNCODE  DS    H                                                        02890000
LISTLN   DS    FL1                                                      02891000
         DS    0D                                                       02892000
@TS00001 DS    CL95                                                     02893000
         DS    CL1                                                      02894000
CAMLST   DS    CL20                                                     02895000
         ORG   CAMLST                                                   02896000
CAMOPTNS DS    CL4                                                      02897000
         ORG   CAMOPTNS                                                 02898000
CAMOPTN1 DS    BL1                                                      02899000
CAMOPTN2 DS    BL1                                                      02900000
CAMOPTN3 DS    BL1                                                      02901000
@NM00089 DS    BL1                                                      02902000
         ORG   CAMLST+4                                                 02903000
CAMPTR1  DS    AL4                                                      02904000
CAMCVOL  DS    AL4                                                      02905000
CAMPTR3  DS    AL4                                                      02906000
CAMDSCB  DS    AL4                                                      02907000
         ORG   CAMLST+20                                                02908000
         DS    CL4                                                      02909000
WKAREA   DS    CL265                                                    02910000
         ORG   WKAREA                                                   02911000
AREA1    DS    CL256                                                    02912000
AREA2    DS    CL9                                                      02913000
         ORG   WKAREA+265                                               02914000
TSTRCTOD DS    CL4                                                      02915000
         ORG   TSTRCTOD                                                 02916000
TSTOCODE DS    CL2                                                      02917000
@NM00090 DS    CL2                                                      02918000
         ORG   TSTRCTOD+4                                               02919000
TSTRCTND DS    CL4                                                      02920000
         ORG   TSTRCTND                                                 02921000
TSTNCODE DS    CL2                                                      02922000
@NM00091 DS    CL2                                                      02923000
         ORG   TSTRCTND+4                                               02924000
         DS    CL3                                                      02925000
DUMPAREA DS    CL49                                                     02926000
         DS    CL3                                                      02927000
DARGAREA DS    CL28                                                     02928000
ERRAREA  DS    CL32                                                     02929000
DEVICEOK DS    BL1                                                      02930000
VOLSEROK DS    BL1                                                      02931000
         DS    CL2                                                      02932000
CPLAREA  DS    CL32                                                     02933000
WORKAREA DS    CL49                                                     02934000
         ORG   WORKAREA                                                 02935000
WRKALEN  DS    CL2                                                      02936000
@NM00102 DS    CL47                                                     02937000
         ORG   WORKAREA+49                                              02938000
         DS    CL3                                                      02939000
LCPLAREA DS    CL52                                                     02940000
LCFLAREA DS    CL144                                                    02941000
LOCWAREA DS    CL3849                                                   02942000
         ORG   LOCWAREA                                                 02943000
LOCWLEN1 DS    CL2                                                      02944000
LOCWLEN2 DS    CL2                                                      02945000
LOCWENTP DS    CL1                                                      02946000
LOCWDATE DS    CL7                                                      02947000
         ORG   LOCWDATE                                                 02948000
LOCWCRDT DS    CL3                                                      02949000
LOCWEXDT DS    CL3                                                      02950000
@NM00103 DS    CL1                                                      02951000
         ORG   LOCWAREA+12                                              02952000
LOCWOWNR DS    CL8                                                      02953000
LOCWACBP DS    AL4                                                      02954000
LOCWVOLL DS    CL15                                                     02955000
         ORG   LOCWVOLL+0                                               02956000
LOCWREP  DS    CL2                                                      02957000
LOCWDEVT DS    CL4                                                      02958000
LOCWVOL  DS    CL6                                                      02959000
LOCWFILS DS    CL2                                                      02960000
LOCWVOLF DS    CL1                                                      02961000
         ORG   LOCWAREA+3849                                            02962000
IDCSA07  CSECT                                                          02963000
         DS    0F                                                       02964000
@SIZDATD DC    AL1(0)                                                   02965000
         DC    AL3(@ENDDATD-@DATD)                                      02966000
         DS    0D                                                       02967000
THOUSAND DC    F'1000'                                                  02968000
@CC01206 DC    C'RCTAGL  '                                              02969000
@CC01208 DC    C'UCTAGL  '                                              02970000
@CC01231 DC    C'WKAREA'                                                02971000
@CC01263 DC    C'TESTRC'                                                02972000
@CC01264 DC    C'CAMLST'                                                02973000
@CC01217 DC    C'RCEX'                                                  02974000
@CC01220 DC    C'RCBG'                                                  02975000
@CC01224 DC    C'RCND'                                                  02976000
@CC01228 DC    C'RCGE'                                                  02977000
@CC01233 DC    C'RCAC'                                                  02978000
@CC01237 DC    C'RCTE'                                                  02979000
@CC01241 DC    C'RCUE'                                                  02980000
@CC01250 DC    C'SAUC'                                                  02981000
@CC01255 DC    C'SAUE'                                                  02982000
@CC01260 DC    C'SAOU'                                                  02983000
@CC01265 DC    C'SAOD'                                                  02984000
@CC01274 DC    C'SAVU'                                                  02985000
@CC01291 DC    C'SALT'                                                  02986000
@CC01292 DC    C'SALC'                                                  02987000
@CC01301 DC    C'SALE'                                                  02988000
@CC01338 DC    C'SAVL'                                                  02989000
@CC01179 DC    C'SA7'                                                   02990000
@CC01181 DC    C'CM0'                                                   02991000
ALL      DC    CL3'ALL'                                                 02992000
FORMAT   DC    CL4'FORM'                                                02993000
HSECOND  DC    CL4'HSEC'                                                02994000
CLOCK    DC    CL4'KLOK'                                                02995000
SETZERO  DC    CL4'ZERO'                                                02996000
SETBLANK DC    CL4'BLNK'                                                02997000
NOSET    DC    CL4'NSET'                                                02998000
OVERRIDE DC    CL4'OVRD'                                                02999000
ACQUIRE  DC    CL8'ACQUIRE '                                            03000000
RELINQ   DC    CL8'RELINQ  '                                            03001000
MOUNT    DC    CL8'MOUNT   '                                            03002000
DEMOUNT  DC    CL8'DEMOUNT '                                            03003000
DEFINE   DC    CL8'DEFINE  '                                            03004000
MOVE     DC    CL8'MOVE    '                                            03005000
TRACEQ   DC    CL8'TRACEQ  '                                            03006000
COPYTABL DC    CL8'COPYTABL'                                            03007000
COPYCRTG DC    CL8'COPYCRTG'                                            03008000
COPYVOL  DC    CL8'COPYVOL '                                            03009000
VVIC     DC    CL8'VVIC    '                                            03010000
TUNE     DC    CL8'TUNE    '                                            03011000
NAMES    DC    CL4'NAME'                                                03012000
UNIT     DC    CL4'UNIT'                                                03013000
SHR      DC    CL4'SHR '                                                03014000
EXCL     DC    CL4'EXCL'                                                03015000
NOWAIT   DC    CL4'NWAI'                                                03016000
WAIT     DC    CL4'WAIT'                                                03017000
SECCHECK DC    CL8'SECCHECK'                                            03018000
SCRVTOC  DC    CL8'SCRVTOC '                                            03019000
GETVTOC  DC    CL8'GETVTOC '                                            03020000
PUTVTOC  DC    CL8'PUTVTOC '                                            03021000
RECATLG  DC    CL8'RECATLG '                                            03022000
INITVOL  DC    CL8'INITVOL '                                            03023000
CHECK    DC    CL8'CHECK   '                                            03024000
POSTUCB  DC    CL8'POSTUCB '                                            03025000
GET      DC    CL8'GET     '                                            03026000
PUT      DC    CL8'PUT     '                                            03027000
CLOSE    DC    CL8'CLOSE   '                                            03028000
OPEN     DC    CL8'OPEN    '                                            03029000
PUTLABEL DC    CL8'PUTLABEL'                                            03030000
GETLABEL DC    CL8'GETLABEL'                                            03031000
CANCEL   DC    CL8'CANCEL  '                                            03032000
SET      DC    CL8'SET     '                                            03033000
SELECTX  DC    CL8'SELECTX '                                            03034000
CHANGEX  DC    CL8'CHANGEX '                                            03035000
SELECTDD DC    CL8'SELECTDD'                                            03036000
SELECTDS DC    CL8'SELECTDS'                                            03037000
TBLREST  DC    CL8'TBLREST '                                            03038000
NULLIFYC DC    CL8'NULLIFYC'                                            03039000
RDMSC    DC    CL8'RDMSC   '                                            03040000
RDMSCTBL DC    CL8'RDMSCTBL'                                            03041000
RDCARTLB DC    CL8'RDCARTLB'                                            03042000
AUDITCEL DC    CL8'AUDITCEL'                                            03043000
RDSTGAD  DC    CL8'RDSTGAD '                                            03044000
TSTDMASK DC    X'FF7C'                                                  03045000
MODID    DC    CL4'SA07'                                                03046000
LOCTHDR  DC    CL8'LCTINFO '                                            03047000
         DS    CL3                                                      03048000
NULENTRY DS    CL4                                                      03049000
         ORG   NULENTRY                                                 03050000
@NM00100 DC    X'00'                                                    03051000
FOXES    DC    X'FFFFFF'                                                03052000
         ORG   NULENTRY+4                                               03053000
NULOWNER DS    CL8                                                      03054000
         ORG   NULOWNER                                                 03055000
BLANKS   DC    CL8'        '                                            03056000
         ORG   NULOWNER+8                                               03057000
FIXAREA  DS    CL300                                                    03058000
         ORG   FIXAREA                                                  03059000
@NM00101 DC    300X'00'                                                 03060000
         ORG   FIXAREA+300                                              03061000
DSENTYP  DC    CL8'ENTYPE  '                                            03062000
DSCRDT   DC    CL8'DSETCRDT'                                            03063000
DSEXDT   DC    CL8'DSETEXDT'                                            03064000
DSOWNR   DC    CL8'OWNERID '                                            03065000
DSCATACB DC    CL8'CATACB  '                                            03066000
DSCATVOL DC    CL8'CATVOL  '                                            03067000
@DATD    DSECT                                                          03068000
*                                                         /*#Y30LB34*/  03069000
IDCSA07  CSECT                                                          03070000
         ENTRY IDCSAS7                                                  03071000
IDCSAS7  DC    A(@SIZDATD)                                              03072000
@DATD    DSECT                                                          03073000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03074000
@ENDDATD EQU   *                                                        03075000
IDCSA07  CSECT                                                          03076000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03077000
@01      EQU   01                                                       03078000
@02      EQU   02                                                       03079000
@03      EQU   03                                                       03080000
@04      EQU   04                                                       03081000
@05      EQU   05                                                       03082000
@06      EQU   06                                                       03083000
@07      EQU   07                                                       03084000
@08      EQU   08                                                       03085000
@09      EQU   09                                                       03086000
@10      EQU   10                                                       03087000
@11      EQU   11                                                       03088000
@12      EQU   12                                                       03089000
@13      EQU   13                                                       03090000
@14      EQU   14                                                       03091000
@15      EQU   15                                                       03092000
VLOCRC   EQU   @07                                                      03093000
COUNTI   EQU   @03                                                      03094000
FULWORD  EQU   @04                                                      03095000
LOCTPTR  EQU   @03                                                      03096000
NUMBER   EQU   @02                                                      03097000
ENTNO    EQU   @03                                                      03098000
CC01     EQU   @04                                                      03099000
UARGPTR  EQU   @03                                                      03100000
RCTPTR   EQU   @05                                                      03101000
CTGFLPTR EQU   @02                                                      03102000
DMPINDEX EQU   @02                                                      03103000
RTNREG   EQU   @15                                                      03104000
REG0     EQU   @00                                                      03105000
REG4     EQU   @04                                                      03106000
REG5     EQU   @05                                                      03107000
REG8     EQU   @08                                                      03108000
REG9     EQU   @09                                                      03109000
REG1     EQU   @01                                                      03110000
REG10    EQU   @10                                                      03111000
REG11    EQU   @11                                                      03112000
REG12    EQU   @12                                                      03113000
REG13    EQU   @13                                                      03114000
REG14    EQU   @14                                                      03115000
REG15    EQU   @15                                                      03116000
REG2     EQU   @02                                                      03117000
REG3     EQU   @03                                                      03118000
REG6     EQU   @06                                                      03119000
REG7     EQU   @07                                                      03120000
IDCSAEP0 EQU   0                                                        03121000
IDCSACA0 EQU   0                                                        03122000
IDCSASC0 EQU   0                                                        03123000
TRACE1   EQU   0                                                        03124000
OLDERID1 EQU   TRACE1                                                   03125000
TRACE2   EQU   0                                                        03126000
OLDERID2 EQU   TRACE2                                                   03127000
NEWID2   EQU   TRACE2+95                                                03128000
NEWERID2 EQU   5                                                        03129000
CIRAGL   EQU   0                                                        03130000
CIRTYPE  EQU   CIRAGL                                                   03131000
ALLAGL   EQU   0                                                        03132000
ALLSTS   EQU   ALLAGL+24                                                03133000
ALLDSP   EQU   ALLAGL+25                                                03134000
ALLORG   EQU   ALLAGL+26                                                03135000
ALLOPT   EQU   ALLAGL+28                                                03136000
UNITABL  EQU   0                                                        03137000
UNITADR  EQU   UNITABL+4                                                03138000
@NM00010 EQU   UNITADR                                                  03139000
UNITSTAT EQU   UNITABL+6                                                03140000
IOCSTR   EQU   0                                                        03141000
IOCDSO   EQU   IOCSTR+16                                                03142000
IOCRFM   EQU   IOCSTR+17                                                03143000
IOCMAC   EQU   IOCSTR+18                                                03144000
IOCMAC2  EQU   IOCSTR+19                                                03145000
IOCCHP   EQU   IOCSTR+20                                                03146000
IOCMSG   EQU   IOCSTR+21                                                03147000
IOCRBA   EQU   IOCSTR+40                                                03148000
IOCTTR   EQU   IOCRBA                                                   03149000
IOCMEM   EQU   IOCSTR+44                                                03150000
IOCNWM   EQU   IOCSTR+48                                                03151000
OPNAGL   EQU   0                                                        03152000
OPNOPT   EQU   OPNAGL                                                   03153000
OPNRFM   EQU   OPNAGL+1                                                 03154000
OPNTYP   EQU   OPNAGL+2                                                 03155000
OPNMOD   EQU   OPNAGL+3                                                 03156000
OPNDEV   EQU   OPNAGL+24                                                03157000
OPNDSO   EQU   OPNAGL+41                                                03158000
OPNOPT2  EQU   OPNAGL+42                                                03159000
IOINFOPT EQU   0                                                        03160000
UVOLLIST EQU   0                                                        03161000
UVOLENT  EQU   UVOLLIST+2                                               03162000
AMSTP011 EQU   0                                                        03163000
IDCTPER0 EQU   0                                                        03164000
DARGLIST EQU   0                                                        03165000
DARGDBP  EQU   DARGLIST                                                 03166000
DARGSTID EQU   DARGLIST+8                                               03167000
DARGSMOD EQU   DARGSTID                                                 03168000
DARGSENT EQU   DARGSTID+3                                               03169000
DARGILP  EQU   DARGLIST+12                                              03170000
DARGCNT  EQU   DARGLIST+14                                              03171000
DARGARY  EQU   DARGLIST+20                                              03172000
DARGINS  EQU   DARGARY                                                  03173000
DARGINL  EQU   DARGARY+2                                                03174000
DARGDTM  EQU   DARGARY+4                                                03175000
FMTLIST  EQU   0                                                        03176000
FMTFLGS  EQU   FMTLIST                                                  03177000
FMTSPF   EQU   FMTLIST+2                                                03178000
FMTRFNO  EQU   FMTSPF                                                   03179000
FMTILEN  EQU   FMTRFNO                                                  03180000
FMTIOFF  EQU   FMTLIST+4                                                03181000
FMTTRBC  EQU   FMTIOFF                                                  03182000
FMTSTO   EQU   FMTTRBC                                                  03183000
FMTOCOL  EQU   FMTLIST+6                                                03184000
FMTCNVF  EQU   FMTLIST+10                                               03185000
ERCNVTAB EQU   0                                                        03186000
ERTYPE   EQU   ERCNVTAB                                                 03187000
ERCATLG  EQU   ERTYPE                                                   03188000
EROSCAT  EQU   ERTYPE                                                   03189000
EROPER   EQU   ERCNVTAB+1                                               03190000
ERCATLC  EQU   EROPER                                                   03191000
ERCATDL  EQU   EROPER                                                   03192000
EROSOPER EQU   ERCNVTAB+2                                               03193000
EROSUCDX EQU   EROSOPER                                                 03194000
ERDSNM   EQU   ERCNVTAB+12                                              03195000
ERCATRC  EQU   ERCNVTAB+16                                              03196000
ERCPLPT  EQU   ERCNVTAB+20                                              03197000
IDCDB010 EQU   0                                                        03198000
DMPITM   EQU   0                                                        03199000
DMPITMNM EQU   DMPITM                                                   03200000
DMPITMPT EQU   DMPITM+8                                                 03201000
DMPITMLN EQU   DMPITM+12                                                03202000
DMPITMTP EQU   DMPITM+14                                                03203000
DMPARY   EQU   0                                                        03204000
DMPTRM   EQU   0                                                        03205000
CCMSG    EQU   0                                                        03206000
CMMSG    EQU   0                                                        03207000
CMVOLFLG EQU   CMMSG+6                                                  03208000
CTMSG    EQU   0                                                        03209000
CTARRAY  EQU   CTMSG+4                                                  03210000
MDAGL    EQU   0                                                        03211000
MDFLAGS  EQU   MDAGL+30                                                 03212000
PUAGL    EQU   0                                                        03213000
CKAGL    EQU   0                                                        03214000
CKFLAGS  EQU   CKAGL+28                                                 03215000
EXCLAGL  EQU   0                                                        03216000
EXCLFLAG EQU   EXCLAGL+22                                               03217000
EXOARG   EQU   0                                                        03218000
EXOPT    EQU   EXOARG+32                                                03219000
EXFLG    EQU   EXOARG+33                                                03220000
EXGARG   EQU   0                                                        03221000
EXPARG   EQU   0                                                        03222000
EXPDATA  EQU   EXPARG+12                                                03223000
EXPDATAB EQU   0                                                        03224000
EXPARRAY EQU   EXPDATAB+4                                               03225000
VS2AGL   EQU   0                                                        03226000
VSLABOPT EQU   VS2AGL+28                                                03227000
VS2MSG   EQU   VS2AGL+35                                                03228000
VS2RESOP EQU   VS2AGL+36                                                03229000
VS1AGL   EQU   0                                                        03230000
VSSECOPT EQU   VS1AGL+68                                                03231000
VSVTOPT  EQU   VS1AGL+69                                                03232000
VSCATOPT EQU   VS1AGL+70                                                03233000
VSRETURN EQU   VS1AGL+71                                                03234000
VSMSG    EQU   VS1AGL+72                                                03235000
VSRESOPT EQU   VS1AGL+73                                                03236000
RCTAGL   EQU   0                                                        03237000
RCTHEAD  EQU   RCTAGL                                                   03238000
RCTOPT   EQU   RCTAGL+8                                                 03239000
RCTDEV   EQU   RCTOPT                                                   03240000
RCTVOL   EQU   RCTOPT                                                   03241000
RCTODEV  EQU   RCTAGL+12                                                03242000
RCTNDEV  EQU   RCTAGL+16                                                03243000
RCTOVOL  EQU   RCTAGL+20                                                03244000
RCTNVOL  EQU   RCTAGL+26                                                03245000
RCTDSET  EQU   RCTAGL+32                                                03246000
STAEPARM EQU   0                                                        03247000
STARCVY  EQU   STAEPARM+52                                              03248000
STARETRY EQU   STAEPARM+53                                              03249000
VOLLABEL EQU   0                                                        03250000
SV82LIST EQU   0                                                        03251000
@NM00065 EQU   SV82LIST+4                                               03252000
SV82DCBP EQU   @NM00065                                                 03253000
@NM00066 EQU   SV82LIST+12                                              03254000
SV82WRKP EQU   @NM00066                                                 03255000
SRTAGL   EQU   0                                                        03256000
LCTINFO  EQU   0                                                        03257000
LCTHEAD  EQU   LCTINFO                                                  03258000
LCTMULVC EQU   LCTINFO+8                                                03259000
LCTACBP  EQU   LCTINFO+12                                               03260000
LCTCREAT EQU   LCTINFO+16                                               03261000
LCTEXPIR EQU   LCTINFO+20                                               03262000
LCTOWNER EQU   LCTINFO+24                                               03263000
LCTFLAGS EQU   LCTINFO+32                                               03264000
LCTVSCAT EQU   LCTFLAGS                                                 03265000
UCTAGL   EQU   0                                                        03266000
UCTHEAD  EQU   UCTAGL                                                   03267000
UCTDSN   EQU   UCTAGL+8                                                 03268000
UCTACBP  EQU   UCTAGL+52                                                03269000
UCTVOLP  EQU   UCTAGL+56                                                03270000
UCTDD    EQU   UCTAGL+60                                                03271000
UCTFLAGS EQU   UCTAGL+68                                                03272000
UCTVSCAT EQU   UCTFLAGS                                                 03273000
SELAGL   EQU   0                                                        03274000
SELFLAGS EQU   SELAGL+22                                                03275000
DATESAGL EQU   0                                                        03276000
DATESOPT EQU   DATESAGL+20                                              03277000
VS3AGL   EQU   0                                                        03278000
VS3FLAGS EQU   VS3AGL+58                                                03279000
VSDVTOC  EQU   0                                                        03280000
VSDSTAT  EQU   0                                                        03281000
VSDSFLG1 EQU   VSDSTAT+16                                               03282000
VSDFLG2  EQU   VSDSTAT+17                                               03283000
VSDSCR   EQU   0                                                        03284000
VSDSCRFL EQU   VSDSCR+4                                                 03285000
VSDUSAGE EQU   0                                                        03286000
VSDDORG  EQU   VSDUSAGE+9                                               03287000
VSDALLOC EQU   VSDUSAGE+10                                              03288000
VSDUSEF  EQU   VSDUSAGE+11                                              03289000
VSDDSORG EQU   VSDUSAGE+16                                              03290000
VSDBLOCK EQU   0                                                        03291000
VSDSPACE EQU   VSDBLOCK+12                                              03292000
VSDARRAY EQU   VSDBLOCK+16                                              03293000
VSDVARY  EQU   VSDARRAY+48                                              03294000
CTGPL    EQU   0                                                        03295000
CTGOPTN1 EQU   CTGPL                                                    03296000
CTGNAME  EQU   CTGOPTN1                                                 03297000
CTGCNAME EQU   CTGOPTN1                                                 03298000
CTGOPTN2 EQU   CTGPL+1                                                  03299000
CTGEXT   EQU   CTGOPTN2                                                 03300000
CTGERASE EQU   CTGOPTN2                                                 03301000
CTGSMF   EQU   CTGERASE                                                 03302000
CTGREL   EQU   CTGSMF                                                   03303000
CTGPURG  EQU   CTGOPTN2                                                 03304000
CTGVMNT  EQU   CTGPURG                                                  03305000
CTGSCR   EQU   CTGOPTN2                                                 03306000
CTGOPTN3 EQU   CTGPL+2                                                  03307000
CTGFUNC  EQU   CTGOPTN3                                                 03308000
CTGAM0   EQU   CTGOPTN3                                                 03309000
CTGOPTN4 EQU   CTGPL+3                                                  03310000
CTGENT   EQU   CTGPL+4                                                  03311000
CTGCAT   EQU   CTGPL+8                                                  03312000
CTGWKA   EQU   CTGPL+12                                                 03313000
CTGDSORG EQU   CTGPL+16                                                 03314000
CTGOPTNS EQU   CTGDSORG                                                 03315000
CTGTYPE  EQU   CTGPL+18                                                 03316000
CTGNOFLD EQU   CTGPL+19                                                 03317000
CTGDDNM  EQU   CTGPL+20                                                 03318000
CTGNEWNM EQU   CTGDDNM                                                  03319000
CTGFBFLG EQU   CTGNEWNM+2                                               03320000
CTGJSCB  EQU   CTGPL+24                                                 03321000
CTGFIELD EQU   CTGPL+28                                                 03322000
CTGFL    EQU   0                                                        03323000
CTGFLDRE EQU   CTGFL+3                                                  03324000
CTGFLDNM EQU   CTGFL+8                                                  03325000
CTGFLDAT EQU   CTGFL+16                                                 03326000
CTGFLNG  EQU   CTGFLDAT                                                 03327000
CTGFLPT  EQU   CTGFLDAT+4                                               03328000
LOCTDSN  EQU   0                                                        03329000
LOCTVOL  EQU   0                                                        03330000
LOCTDEV  EQU   0                                                        03331000
LOCTBITS EQU   LOCTDEV+1                                                03332000
LOCTRV   EQU   LOCTBITS                                                 03333000
LOCTDTYP EQU   LOCTDEV+2                                                03334000
LOCTENTP EQU   0                                                        03335000
LOCTCRDT EQU   0                                                        03336000
LOCTEXDT EQU   0                                                        03337000
LOCTOWNR EQU   0                                                        03338000
LOCTCATA EQU   0                                                        03339000
LOCTVOLL EQU   0                                                        03340000
LOCTDEVT EQU   LOCTVOLL+2                                               03341000
LOCTFLGS EQU   LOCTDEVT+1                                               03342000
LOCTCRV  EQU   LOCTFLGS                                                 03343000
LOCTCTYP EQU   LOCTDEVT+2                                               03344000
LOCTVOLS EQU   LOCTVOLL+6                                               03345000
AMSTP041 EQU   0                                                        03346000
AMSTP042 EQU   0                                                        03347000
AMSTP043 EQU   0                                                        03348000
AMSTP044 EQU   0                                                        03349000
IDCIOCL0 EQU   0                                                        03350000
IDCIOCO0 EQU   0                                                        03351000
IDCIOGT0 EQU   0                                                        03352000
IDCIOIT0 EQU   0                                                        03353000
IDCIOOP0 EQU   0                                                        03354000
IDCIOPO0 EQU   0                                                        03355000
IDCIOPT0 EQU   0                                                        03356000
IDCIOSI0 EQU   0                                                        03357000
IDCIOST0 EQU   0                                                        03358000
IDCIOTM0 EQU   0                                                        03359000
IDCIOVY0 EQU   0                                                        03360000
IDCIO050 EQU   0                                                        03361000
IDCSAAL0 EQU   0                                                        03362000
IDCSACL0 EQU   0                                                        03363000
IDCSACR0 EQU   0                                                        03364000
IDCSADE0 EQU   0                                                        03365000
IDCSADL0 EQU   0                                                        03366000
IDCSADQ0 EQU   0                                                        03367000
IDCSAFP0 EQU   0                                                        03368000
IDCSAFS0 EQU   0                                                        03369000
IDCSAGP0 EQU   0                                                        03370000
IDCSAGS0 EQU   0                                                        03371000
IDCSAID0 EQU   0                                                        03372000
IDCSALC0 EQU   0                                                        03373000
IDCSALD0 EQU   0                                                        03374000
IDCSALK0 EQU   0                                                        03375000
IDCSANQ0 EQU   0                                                        03376000
IDCSAPR0 EQU   0                                                        03377000
IDCSAPT0 EQU   0                                                        03378000
IDCSAQL0 EQU   0                                                        03379000
IDCSARC0 EQU   0                                                        03380000
IDCSARV0 EQU   0                                                        03381000
IDCSASI0 EQU   0                                                        03382000
IDCSASN0 EQU   0                                                        03383000
IDCSASS0 EQU   0                                                        03384000
IDCSAST0 EQU   0                                                        03385000
IDCSATI0 EQU   0                                                        03386000
IDCSAUC0 EQU   0                                                        03387000
IDCSAWO0 EQU   0                                                        03388000
IDCSA060 EQU   0                                                        03389000
IDCST010 EQU   0                                                        03390000
LISTTEST EQU   0                                                        03391000
NEWERID1 EQU   5                                                        03392000
GDTTBL   EQU   0                                                        03393000
GDTTR1   EQU   GDTTBL+8                                                 03394000
GDTTR2   EQU   GDTTBL+12                                                03395000
GDTDBG   EQU   GDTTBL+40                                                03396000
GDTSTC   EQU   GDTTBL+44                                                03397000
GDTPRT   EQU   GDTTBL+48                                                03398000
GDTESS   EQU   GDTTBL+52                                                03399000
GDTESA   EQU   GDTTBL+56                                                03400000
GDTRST   EQU   GDTTBL+60                                                03401000
GDTRES   EQU   GDTTBL+64                                                03402000
GDTCAL   EQU   GDTTBL+68                                                03403000
GDTGSP   EQU   GDTTBL+72                                                03404000
GDTFSP   EQU   GDTTBL+76                                                03405000
GDTGPL   EQU   GDTTBL+80                                                03406000
GDTFPL   EQU   GDTTBL+84                                                03407000
GDTLOD   EQU   GDTTBL+88                                                03408000
GDTDEL   EQU   GDTTBL+92                                                03409000
GDTPRL   EQU   GDTTBL+96                                                03410000
GDTEPL   EQU   GDTTBL+100                                               03411000
GDTTIM   EQU   GDTTBL+104                                               03412000
GDTIIO   EQU   GDTTBL+108                                               03413000
GDTTIO   EQU   GDTTBL+112                                               03414000
GDTOPN   EQU   GDTTBL+124                                               03415000
GDTCLS   EQU   GDTTBL+128                                               03416000
GDTGET   EQU   GDTTBL+132                                               03417000
GDTPUT   EQU   GDTTBL+136                                               03418000
GDTPOS   EQU   GDTTBL+140                                               03419000
GDTCPY   EQU   GDTTBL+144                                               03420000
GDTCAT   EQU   GDTTBL+148                                               03421000
GDTSNP   EQU   GDTTBL+164                                               03422000
GDTVFY   EQU   GDTTBL+172                                               03423000
GDTUID   EQU   GDTTBL+192                                               03424000
GDTPMT   EQU   GDTTBL+196                                               03425000
GDTCIR   EQU   GDTTBL+200                                               03426000
GDTLNK   EQU   GDTTBL+204                                               03427000
GDTALC   EQU   GDTTBL+208                                               03428000
GDTDLC   EQU   GDTTBL+212                                               03429000
GDTQAL   EQU   GDTTBL+216                                               03430000
GDTSTW   EQU   GDTTBL+220                                               03431000
GDTSSC   EQU   GDTTBL+224                                               03432000
GDTENQ   EQU   GDTTBL+228                                               03433000
GDTRSV   EQU   GDTTBL+232                                               03434000
GDTDEQ   EQU   GDTTBL+236                                               03435000
GDTSFO   EQU   GDTTBL+240                                               03436000
GDTWTO   EQU   GDTTBL+244                                               03437000
GDTSCR   EQU   GDTTBL+248                                               03438000
GDTUNT   EQU   GDTTBL+252                                               03439000
GDTRCT   EQU   GDTTBL+256                                               03440000
GDTIFO   EQU   GDTTBL+260                                               03441000
GDTEXP   EQU   GDTTBL+264                                               03442000
GDTSTA   EQU   GDTTBL+268                                               03443000
GDTERR   EQU   GDTTBL+272                                               03444000
GDTUNC   EQU   GDTTBL+276                                               03445000
GDTLOC   EQU   GDTTBL+280                                               03446000
RCTAGLAR EQU   0                                                        03447000
UARGAREA EQU   0                                                        03448000
DSNVAR   EQU   0                                                        03449000
VOLVAR   EQU   0                                                        03450000
DEVVAR   EQU   0                                                        03451000
LOCAREAP EQU   0                                                        03452000
VOLCOUNT EQU   WKAREA                                                   03453000
VOLPOINT EQU   WKAREA+2                                                 03454000
DEVCODE  EQU   VOLPOINT                                                 03455000
VOLSER   EQU   VOLPOINT+4                                               03456000
TTRDSCB  EQU   WKAREA+251                                               03457000
*                                      START UNREFERENCED COMPONENTS    03458000
SEQNO    EQU   VOLPOINT+10                                              03459000
GDTECT   EQU   GDTTBL+188                                               03460000
GDTPSB   EQU   GDTTBL+184                                               03461000
GDTUPT   EQU   GDTTBL+180                                               03462000
GDTCMB   EQU   GDTTBL+176                                               03463000
GDTSPR   EQU   GDTTBL+168                                               03464000
@NM00001 EQU   GDTTBL+160                                               03465000
GDTABH   EQU   GDTTBL+156                                               03466000
GDTABT   EQU   GDTTBL+152                                               03467000
GDTTOH   EQU   GDTTBL+120                                               03468000
GDTRIP   EQU   GDTTBL+116                                               03469000
GDTIOH   EQU   GDTTBL+36                                                03470000
GDTSAH   EQU   GDTTBL+32                                                03471000
GDTTPH   EQU   GDTTBL+28                                                03472000
GDTRIH   EQU   GDTTBL+24                                                03473000
GDTSTH   EQU   GDTTBL+20                                                03474000
GDTDBH   EQU   GDTTBL+16                                                03475000
GDTPRM   EQU   GDTTBL+4                                                 03476000
GDTHDR   EQU   GDTTBL                                                   03477000
@NM00099 EQU   LOCTVOLL+12                                              03478000
@NM00098 EQU   LOCTFLGS                                                 03479000
@NM00097 EQU   LOCTFLGS                                                 03480000
@NM00096 EQU   LOCTDEVT                                                 03481000
@NM00095 EQU   LOCTVOLL                                                 03482000
@NM00094 EQU   LOCTBITS                                                 03483000
@NM00093 EQU   LOCTBITS                                                 03484000
@NM00092 EQU   LOCTDEV                                                  03485000
CTGFLCHN EQU   CTGFL+12                                                 03486000
CTGFLDWA EQU   CTGFL+4                                                  03487000
CTGFLDTS EQU   CTGFLDRE                                                 03488000
@NM00088 EQU   CTGFLDRE                                                 03489000
CTGFLDGC EQU   CTGFL+2                                                  03490000
CTGFLDCD EQU   CTGFL+1                                                  03491000
CTGFLDNO EQU   CTGFL                                                    03492000
CTGPSWD  EQU   CTGJSCB                                                  03493000
@NM00087 EQU   CTGFBFLG                                                 03494000
CTGNGDSN EQU   CTGFBFLG                                                 03495000
CTGGDGB  EQU   CTGFBFLG                                                 03496000
CTGKEEP  EQU   CTGFBFLG                                                 03497000
CTGPAR   EQU   CTGFBFLG                                                 03498000
CTGFDBK  EQU   CTGNEWNM                                                 03499000
@NM00086 EQU   CTGDSORG                                                 03500000
CTGCVOL  EQU   CTGCAT                                                   03501000
CTGFVT   EQU   CTGENT                                                   03502000
@NM00085 EQU   CTGOPTN4                                                 03503000
CTGDOCAT EQU   CTGOPTN4                                                 03504000
CTGLBASE EQU   CTGOPTN4                                                 03505000
CTGNUM   EQU   CTGOPTN3                                                 03506000
CTGSRH   EQU   CTGOPTN3                                                 03507000
CTGGDGL  EQU   CTGOPTN3                                                 03508000
CTGSUPLT EQU   CTGOPTN3                                                 03509000
@NM00084 EQU   CTGOPTN2                                                 03510000
CTGOVRID EQU   CTGOPTN2                                                 03511000
CTGDISC  EQU   CTGOPTN2                                                 03512000
CTGGTNXT EQU   CTGOPTN2                                                 03513000
CTGRCATN EQU   CTGVMNT                                                  03514000
CTGGTALL EQU   CTGREL                                                   03515000
CTGNSVS  EQU   CTGEXT                                                   03516000
CTGGENLD EQU   CTGOPTN1                                                 03517000
CTGREAD  EQU   CTGOPTN1                                                 03518000
CTGUPD   EQU   CTGOPTN1                                                 03519000
CTGCI    EQU   CTGOPTN1                                                 03520000
CTGMAST  EQU   CTGOPTN1                                                 03521000
CTGBYPSS EQU   CTGOPTN1                                                 03522000
VSDDSN   EQU   VSDARRAY+4                                               03523000
VSDVOLCT EQU   VSDARRAY                                                 03524000
VSDFMT0  EQU   VSDBLOCK+8                                               03525000
VSDVTOCS EQU   VSDBLOCK+4                                               03526000
VSDELEM  EQU   VSDBLOCK                                                 03527000
VSDFREE  EQU   VSDUSAGE+24                                              03528000
VSDALLC  EQU   VSDUSAGE+19                                              03529000
VSDDSOR3 EQU   VSDDSORG+2                                               03530000
@NM00083 EQU   VSDDSORG                                                 03531000
VSDSCAL  EQU   VSDUSAGE+12                                              03532000
@NM00082 EQU   VSDUSEF                                                  03533000
VSDCALFR EQU   VSDUSEF                                                  03534000
@NM00081 EQU   VSDALLOC                                                 03535000
VSDABSTR EQU   VSDALLOC                                                 03536000
VSDABLK  EQU   VSDALLOC                                                 03537000
VSDATRK  EQU   VSDALLOC                                                 03538000
VSDACYL  EQU   VSDALLOC                                                 03539000
@NM00080 EQU   VSDDORG                                                  03540000
VSDOU    EQU   VSDDORG                                                  03541000
VSDOIS   EQU   VSDDORG                                                  03542000
VSDODA   EQU   VSDDORG                                                  03543000
VSDOUN   EQU   VSDDORG                                                  03544000
VSDOPS   EQU   VSDDORG                                                  03545000
VSDOPO   EQU   VSDDORG                                                  03546000
VSDEXTS  EQU   VSDUSAGE+8                                               03547000
VSDSECAL EQU   VSDUSAGE+4                                               03548000
VSDFTRK  EQU   VSDUSAGE+2                                               03549000
VSDTRKS  EQU   VSDUSAGE                                                 03550000
@NM00079 EQU   VSDSCR+5                                                 03551000
@NM00078 EQU   VSDSCRFL                                                 03552000
VSDVSAM  EQU   VSDSCRFL                                                 03553000
VSDCATLC EQU   VSDSCRFL                                                 03554000
VSDACBPT EQU   VSDSCR                                                   03555000
VSDPRTC  EQU   VSDSTAT+25                                               03556000
VSDCAT   EQU   VSDSTAT+22                                               03557000
VSDEXP   EQU   VSDSTAT+20                                               03558000
VSDCRE   EQU   VSDSTAT+18                                               03559000
@NM00077 EQU   VSDFLG2                                                  03560000
VSDERROR EQU   VSDFLG2                                                  03561000
VSDPROT  EQU   VSDFLG2                                                  03562000
VSDPWW   EQU   VSDFLG2                                                  03563000
VSDPWR   EQU   VSDFLG2                                                  03564000
@NM00076 EQU   VSDSFLG1                                                 03565000
VSDCVSAM EQU   VSDSFLG1                                                 03566000
VSDCATLG EQU   VSDSFLG1                                                 03567000
VSDVSAME EQU   VSDSFLG1                                                 03568000
VSDVSAMC EQU   VSDSFLG1                                                 03569000
VSDVTOCE EQU   VSDSFLG1                                                 03570000
VSDVTOCC EQU   VSDSFLG1                                                 03571000
VSDOWNER EQU   VSDSTAT+8                                                03572000
VSDEXPIR EQU   VSDSTAT+4                                                03573000
VSDCREAT EQU   VSDSTAT                                                  03574000
VSDFRCCL EQU   VSDVTOC+21                                               03575000
@NM00075 EQU   VSDVTOC+20                                               03576000
VSDFREXT EQU   VSDVTOC+16                                               03577000
@NM00074 EQU   VSDVTOC+15                                               03578000
VSDFRTRK EQU   VSDVTOC+11                                               03579000
@NM00073 EQU   VSDVTOC+10                                               03580000
VSDFRCYL EQU   VSDVTOC+6                                                03581000
@NM00072 EQU   VSDVTOC                                                  03582000
@NM00071 EQU   VS3FLAGS                                                 03583000
VS3SYSNM EQU   VS3FLAGS                                                 03584000
VS3UNCAT EQU   VS3FLAGS                                                 03585000
VS3SCR   EQU   VS3FLAGS                                                 03586000
VS3USAGE EQU   VS3FLAGS                                                 03587000
VS3STAT  EQU   VS3FLAGS                                                 03588000
VS3DD    EQU   VS3AGL+50                                                03589000
VS3VOL   EQU   VS3AGL+44                                                03590000
VS3POOL  EQU   VS3AGL+40                                                03591000
VS3DEV   EQU   VS3AGL+36                                                03592000
VS3UCBP  EQU   VS3AGL+32                                                03593000
VS3CREAT EQU   VS3AGL+28                                                03594000
VS3EXPIR EQU   VS3AGL+24                                                03595000
VS3AST   EQU   VS3AGL+22                                                03596000
VS3LEVLN EQU   VS3AGL+20                                                03597000
VS3LEVP  EQU   VS3AGL+16                                                03598000
VS3EXDSP EQU   VS3AGL+12                                                03599000
VS3LISTP EQU   VS3AGL+8                                                 03600000
VS3HEAD  EQU   VS3AGL                                                   03601000
@NM00070 EQU   DATESOPT                                                 03602000
DATDAYOP EQU   DATESOPT                                                 03603000
DATDTEOP EQU   DATESOPT                                                 03604000
DATSUB   EQU   DATESOPT                                                 03605000
DATADD   EQU   DATESOPT                                                 03606000
DATRETRN EQU   DATESAGL+16                                              03607000
DATDAYS  EQU   DATESAGL+12                                              03608000
DATDATE  EQU   DATESAGL+8                                               03609000
DATHEAD  EQU   DATESAGL                                                 03610000
@NM00069 EQU   SELFLAGS                                                 03611000
SELVOL   EQU   SELAGL+16                                                03612000
SELDDNP  EQU   SELAGL+12                                                03613000
SELUCBP  EQU   SELAGL+8                                                 03614000
SELHEAD  EQU   SELAGL                                                   03615000
@NM00068 EQU   UCTFLAGS                                                 03616000
@NM00067 EQU   LCTFLAGS                                                 03617000
SRTWORKP EQU   SRTAGL+28                                                03618000
SRTFLDLN EQU   SRTAGL+24                                                03619000
SRTPOSIT EQU   SRTAGL+20                                                03620000
SRTLEN   EQU   SRTAGL+16                                                03621000
SRTNUM   EQU   SRTAGL+12                                                03622000
SRTADDR  EQU   SRTAGL+8                                                 03623000
SRTHEAD  EQU   SRTAGL                                                   03624000
SV82DEBP EQU   SV82WRKP                                                 03625000
SV82TTRP EQU   SV82LIST+8                                               03626000
SV82VOLP EQU   SV82DCBP                                                 03627000
SV82UCBP EQU   SV82LIST+1                                               03628000
SV82CODE EQU   SV82LIST                                                 03629000
VOLRESV3 EQU   VOLLABEL+55                                              03630000
VOLOWNER EQU   VOLLABEL+45                                              03631000
VOLRESV1 EQU   VOLLABEL+20                                              03632000
VOLVTOC  EQU   VOLLABEL+15                                              03633000
VOLSECTY EQU   VOLLABEL+14                                              03634000
VOLSERNO EQU   VOLLABEL+8                                               03635000
VOLNO    EQU   VOLLABEL+7                                               03636000
VOLLABI  EQU   VOLLABEL+4                                               03637000
VOLKEY   EQU   VOLLABEL                                                 03638000
STAVTTR  EQU   STAEPARM+54                                              03639000
@NM00064 EQU   STARETRY                                                 03640000
STAVTOC  EQU   STARETRY                                                 03641000
STAOFF   EQU   STARETRY                                                 03642000
STAIO05  EQU   STARETRY                                                 03643000
@NM00063 EQU   STARCVY                                                  03644000
STACLEAR EQU   STARCVY                                                  03645000
STAVPOST EQU   STARCVY                                                  03646000
STAVENQ  EQU   STARCVY                                                  03647000
STAVDMNT EQU   STARCVY                                                  03648000
STAVMNT  EQU   STARCVY                                                  03649000
STATCB   EQU   STAEPARM+48                                              03650000
STARTADD EQU   STAEPARM+44                                              03651000
STAEXSAV EQU   STAEPARM+40                                              03652000
STARTSAV EQU   STAEPARM+36                                              03653000
STARTTR  EQU   STAEPARM+32                                              03654000
@NM00062 EQU   STAEPARM+30                                              03655000
STARVOL  EQU   STAEPARM+24                                              03656000
STARUCB  EQU   STAEPARM+20                                              03657000
@NM00061 EQU   STAEPARM+18                                              03658000
STAVVOL  EQU   STAEPARM+12                                              03659000
STAVUCB  EQU   STAEPARM+8                                               03660000
STAHEAD  EQU   STAEPARM                                                 03661000
@NM00060 EQU   RCTAGL+10                                                03662000
@NM00059 EQU   RCTOPT                                                   03663000
@NM00058 EQU   VSRESOPT                                                 03664000
VSREAL   EQU   VSRESOPT                                                 03665000
VSRES    EQU   VSRESOPT                                                 03666000
@NM00057 EQU   VSMSG                                                    03667000
VSTOV    EQU   VSMSG                                                    03668000
VSFROMV  EQU   VSMSG                                                    03669000
@NM00056 EQU   VSRETURN                                                 03670000
VSUCAT   EQU   VSRETURN                                                 03671000
VSVSAM   EQU   VSRETURN                                                 03672000
@NM00055 EQU   VSCATOPT                                                 03673000
VSLIST   EQU   VSCATOPT                                                 03674000
VSSERIAL EQU   VSCATOPT                                                 03675000
VSDEVICE EQU   VSCATOPT                                                 03676000
@NM00054 EQU   VSVTOPT                                                  03677000
VSVSFLAG EQU   VSVTOPT                                                  03678000
VSALTTRK EQU   VSVTOPT                                                  03679000
VSTIME   EQU   VSVTOPT                                                  03680000
VSUCMAST EQU   VSSECOPT                                                 03681000
VSOPCAT  EQU   VSSECOPT                                                 03682000
VSUCTEST EQU   VSSECOPT                                                 03683000
VSWRITE  EQU   VSSECOPT                                                 03684000
VSREAD   EQU   VSSECOPT                                                 03685000
VSNONONV EQU   VSSECOPT                                                 03686000
VSMASTER EQU   VSSECOPT                                                 03687000
VSNOVSAM EQU   VSSECOPT                                                 03688000
VSODEVP  EQU   VS1AGL+64                                                03689000
VSOSERP  EQU   VS1AGL+60                                                03690000
VSDEVP   EQU   VS1AGL+56                                                03691000
VSSERP   EQU   VS1AGL+52                                                03692000
VSPFILEP EQU   VS1AGL+48                                                03693000
VSPSWDP  EQU   VS1AGL+44                                                03694000
VSCATDDP EQU   VS1AGL+40                                                03695000
VSACBP   EQU   VS1AGL+36                                                03696000
VSCATP   EQU   VS1AGL+32                                                03697000
VSNXTATP EQU   VS1AGL+28                                                03698000
VSNUMATP EQU   VS1AGL+24                                                03699000
VSIOP    EQU   VS1AGL+20                                                03700000
VSFILEP  EQU   VS1AGL+16                                                03701000
VSVOLP   EQU   VS1AGL+12                                                03702000
VSUCBP   EQU   VS1AGL+8                                                 03703000
VSHEAD   EQU   VS1AGL                                                   03704000
VSDDNAME EQU   VS2AGL+37                                                03705000
@NM00053 EQU   VS2RESOP                                                 03706000
VS2REAL  EQU   VS2RESOP                                                 03707000
VS2RES   EQU   VS2RESOP                                                 03708000
@NM00052 EQU   VS2MSG                                                   03709000
VS2TOV   EQU   VS2MSG                                                   03710000
VSVOLUME EQU   VS2AGL+29                                                03711000
@NM00051 EQU   VSLABOPT                                                 03712000
VSVOLSER EQU   VSLABOPT                                                 03713000
VSOWNER  EQU   VSLABOPT                                                 03714000
VSIOBKPT EQU   VS2AGL+24                                                03715000
VSVOLPTR EQU   VS2AGL+20                                                03716000
VSOWNPTR EQU   VS2AGL+16                                                03717000
VSVTOCSZ EQU   VS2AGL+12                                                03718000
VSUCBPTR EQU   VS2AGL+8                                                 03719000
VS2HEAD  EQU   VS2AGL                                                   03720000
EXPDATAL EQU   EXPARRAY+6                                               03721000
@NM00050 EQU   EXPARRAY+5                                               03722000
EXPKEYLN EQU   EXPARRAY+4                                               03723000
EXPDATAP EQU   EXPARRAY                                                 03724000
EXPRECNO EQU   EXPDATAB                                                 03725000
EXPCCHHR EQU   EXPARG+16                                                03726000
EXPCTLBK EQU   EXPARG+8                                                 03727000
EXPHEAD  EQU   EXPARG                                                   03728000
EXGDATAL EQU   EXGARG+30                                                03729000
@NM00049 EQU   EXGARG+29                                                03730000
EXGKEYLN EQU   EXGARG+28                                                03731000
EXGDATAP EQU   EXGARG+24                                                03732000
EXGRECNO EQU   EXGARG+20                                                03733000
EXGCCHH2 EQU   EXGARG+16                                                03734000
EXGCCHH1 EQU   EXGARG+12                                                03735000
EXGCTLBK EQU   EXGARG+8                                                 03736000
EXGHEAD  EQU   EXGARG                                                   03737000
@NM00048 EQU   EXFLG                                                    03738000
EXOREAD  EQU   EXFLG                                                    03739000
@NM00047 EQU   EXOPT                                                    03740000
EXOVTOC  EQU   EXOPT                                                    03741000
EXONEW   EQU   EXOPT                                                    03742000
EXOPASS  EQU   EXOPT                                                    03743000
EXOLAB   EQU   EXOPT                                                    03744000
EXOTAB   EQU   EXOPT                                                    03745000
EXOCTLBK EQU   EXOARG+28                                                03746000
EXOEXT   EQU   EXOARG+24                                                03747000
EXOUCB   EQU   EXOARG+20                                                03748000
EXOVSN   EQU   EXOARG+16                                                03749000
EXODSN   EQU   EXOARG+12                                                03750000
EXODDN   EQU   EXOARG+8                                                 03751000
EXOHEAD  EQU   EXOARG                                                   03752000
@NM00046 EQU   EXCLFLAG                                                 03753000
EXCLMNT  EQU   EXCLFLAG                                                 03754000
EXCLVOL  EQU   EXCLAGL+16                                               03755000
EXCLDDP  EQU   EXCLAGL+12                                               03756000
EXCLUCBP EQU   EXCLAGL+8                                                03757000
EXCLHEAD EQU   EXCLAGL                                                  03758000
@NM00045 EQU   CKFLAGS                                                  03759000
CKDMTABL EQU   CKFLAGS                                                  03760000
CKRETTYP EQU   CKFLAGS                                                  03761000
CKTESTVT EQU   CKFLAGS                                                  03762000
CKLABELP EQU   CKAGL+24                                                 03763000
CKDATYPE EQU   CKAGL+20                                                 03764000
CKDDNAME EQU   CKAGL+12                                                 03765000
CKUCBPTR EQU   CKAGL+8                                                  03766000
CKHEAD   EQU   CKAGL                                                    03767000
PULABELP EQU   PUAGL+16                                                 03768000
PUTTRPTR EQU   PUAGL+12                                                 03769000
PUUCBPTR EQU   PUAGL+8                                                  03770000
PUHEAD   EQU   PUAGL                                                    03771000
@NM00044 EQU   MDFLAGS                                                  03772000
MDDEQ    EQU   MDFLAGS                                                  03773000
MDENQ    EQU   MDFLAGS                                                  03774000
MDWAIT   EQU   MDFLAGS                                                  03775000
MDPOST   EQU   MDFLAGS                                                  03776000
MDCLEAR  EQU   MDFLAGS                                                  03777000
MDNEWVOL EQU   MDFLAGS                                                  03778000
MDLABEL  EQU   MDAGL+24                                                 03779000
MDPUAGL  EQU   MDAGL+20                                                 03780000
MDDDNAME EQU   MDAGL+12                                                 03781000
MDUCBPTR EQU   MDAGL+8                                                  03782000
MDHEAD   EQU   MDAGL                                                    03783000
CTTBLRR  EQU   CTARRAY+3                                                03784000
CTTBLHH  EQU   CTARRAY+2                                                03785000
CTTBLCC  EQU   CTARRAY+1                                                03786000
CTTBLID  EQU   CTARRAY                                                  03787000
CTREALH  EQU   CTMSG+3                                                  03788000
CTREALCC EQU   CTMSG+1                                                  03789000
@NM00043 EQU   CTMSG                                                    03790000
CMCSN2   EQU   CMMSG+28                                                 03791000
CMCSN1   EQU   CMMSG+16                                                 03792000
CMNUMCRT EQU   CMMSG+15                                                 03793000
@NM00042 EQU   CMMSG+14                                                 03794000
CMNEWVOL EQU   CMMSG+8                                                  03795000
@NM00041 EQU   CMMSG+7                                                  03796000
@NM00040 EQU   CMVOLFLG                                                 03797000
CMRONLY  EQU   CMVOLFLG                                                 03798000
CMBIND   EQU   CMVOLFLG                                                 03799000
CMSCRCRT EQU   CMVOLFLG                                                 03800000
CMEXCL   EQU   CMVOLFLG                                                 03801000
CMDERAS  EQU   CMVOLFLG                                                 03802000
CMSCRVOL EQU   CMVOLFLG                                                 03803000
CMCECART EQU   CMVOLFLG                                                 03804000
CMOLDVOL EQU   CMMSG                                                    03805000
CCOLDCSN EQU   CCMSG+24                                                 03806000
CCNEWCSN EQU   CCMSG+12                                                 03807000
@NM00039 EQU   CCMSG+10                                                 03808000
CCVOL    EQU   CCMSG+4                                                  03809000
@NM00038 EQU   CCMSG+2                                                  03810000
CCEJCODE EQU   CCMSG+1                                                  03811000
CCPSTCDE EQU   CCMSG                                                    03812000
@NM00037 EQU   DMPARY+15                                                03813000
DMPARYTP EQU   DMPARY+14                                                03814000
DMPARYEX EQU   DMPARY+12                                                03815000
DMPARYIC EQU   DMPARY+10                                                03816000
DMPARYSZ EQU   DMPARY+8                                                 03817000
DMPARYNM EQU   DMPARY                                                   03818000
@NM00036 EQU   DMPITM+15                                                03819000
@NM00035 EQU   ERCNVTAB+24                                              03820000
@NM00034 EQU   ERCNVTAB+4                                               03821000
@NM00033 EQU   ERCNVTAB+3                                               03822000
@NM00032 EQU   EROSOPER                                                 03823000
EROSCATL EQU   EROSOPER                                                 03824000
@NM00031 EQU   EROPER                                                   03825000
ERCATAL  EQU   EROPER                                                   03826000
ERCATDE  EQU   EROPER                                                   03827000
@NM00030 EQU   ERTYPE                                                   03828000
@NM00029 EQU   FMTCNVF+1                                                03829000
FMTBS    EQU   FMTCNVF+1                                                03830000
FMTSS    EQU   FMTCNVF+1                                                03831000
FMTAL    EQU   FMTCNVF+1                                                03832000
FMTZS    EQU   FMTCNVF+1                                                03833000
@NM00028 EQU   FMTCNVF                                                  03834000
FMTPU    EQU   FMTCNVF                                                  03835000
FMTBD    EQU   FMTCNVF                                                  03836000
FMTBHD   EQU   FMTCNVF                                                  03837000
FMTBHA   EQU   FMTCNVF                                                  03838000
FMTBH    EQU   FMTCNVF                                                  03839000
FMTOLEN  EQU   FMTLIST+8                                                03840000
FMTRIO   EQU   FMTOCOL                                                  03841000
FMTSPT   EQU   FMTSTO                                                   03842000
FMTSTL   EQU   FMTILEN                                                  03843000
@NM00027 EQU   FMTFLGS+1                                                03844000
FMTHDF   EQU   FMTFLGS                                                  03845000
FMTDFF   EQU   FMTFLGS                                                  03846000
FMTSTF   EQU   FMTFLGS                                                  03847000
FMTREPF  EQU   FMTFLGS                                                  03848000
FMTBDF   EQU   FMTFLGS                                                  03849000
FMTIDF   EQU   FMTFLGS                                                  03850000
FMTSCF   EQU   FMTFLGS                                                  03851000
FMTEOLF  EQU   FMTFLGS                                                  03852000
DARGPCT  EQU   DARGINL                                                  03853000
DARGREP  EQU   DARGINS                                                  03854000
@NM00026 EQU   DARGLIST+19                                              03855000
DARGIND  EQU   DARGLIST+18                                              03856000
DARGRETL EQU   DARGLIST+16                                              03857000
DARGRETP EQU   DARGLIST+4                                               03858000
UVOLVOL  EQU   UVOLENT+4                                                03859000
UVOLDEV  EQU   UVOLENT                                                  03860000
UVOLCNT  EQU   UVOLLIST                                                 03861000
@NM00025 EQU   IOINFOPT                                                 03862000
IOINFTMS EQU   IOINFOPT                                                 03863000
IOINFSUP EQU   IOINFOPT                                                 03864000
IOINFDSN EQU   IOINFOPT                                                 03865000
IOINFVOL EQU   IOINFOPT                                                 03866000
IOINFDVT EQU   IOINFOPT                                                 03867000
OPNVOL   EQU   OPNAGL+44                                                03868000
@NM00024 EQU   OPNAGL+43                                                03869000
@NM00023 EQU   OPNOPT2                                                  03870000
OPNOPTJM EQU   OPNOPT2                                                  03871000
@NM00022 EQU   OPNOPT2                                                  03872000
OPNOPTAS EQU   OPNOPT2                                                  03873000
@NM00021 EQU   OPNDSO                                                   03874000
OPNDSOPO EQU   OPNDSO                                                   03875000
OPNDSOIS EQU   OPNDSO                                                   03876000
OPNDSOPS EQU   OPNDSO                                                   03877000
OPNDSOAM EQU   OPNDSO                                                   03878000
OPNKYL   EQU   OPNAGL+40                                                03879000
OPNBLK   EQU   OPNAGL+36                                                03880000
OPNREC   EQU   OPNAGL+32                                                03881000
OPNDEVIX EQU   OPNDEV+4                                                 03882000
OPNDEVDT EQU   OPNDEV                                                   03883000
OPNCBP   EQU   OPNAGL+20                                                03884000
OPNDSN   EQU   OPNAGL+16                                                03885000
OPNPWA   EQU   OPNAGL+12                                                03886000
OPNDDN   EQU   OPNAGL+8                                                 03887000
OPNIOC   EQU   OPNAGL+4                                                 03888000
OPNMODRP EQU   OPNMOD                                                   03889000
OPNMODUB EQU   OPNMOD                                                   03890000
OPNMODRS EQU   OPNMOD                                                   03891000
OPNMODAX EQU   OPNMOD                                                   03892000
OPNMODRR EQU   OPNMOD                                                   03893000
OPNMODRC EQU   OPNMOD                                                   03894000
OPNMODAC EQU   OPNMOD                                                   03895000
OPNMODPD EQU   OPNMOD                                                   03896000
@NM00020 EQU   OPNTYP                                                   03897000
OPNTYPRV EQU   OPNTYP                                                   03898000
OPNTYPEX EQU   OPNTYP                                                   03899000
OPNTYPRA EQU   OPNTYP                                                   03900000
OPNTYPXM EQU   OPNTYP                                                   03901000
OPNTYPCI EQU   OPNTYP                                                   03902000
OPNTYPSO EQU   OPNTYP                                                   03903000
OPNTYPSI EQU   OPNTYP                                                   03904000
@NM00019 EQU   OPNRFM                                                   03905000
OPNRFMBK EQU   OPNRFM                                                   03906000
OPNRFMSF EQU   OPNRFM                                                   03907000
OPNRFMUN EQU   OPNRFM                                                   03908000
OPNRFMVR EQU   OPNRFM                                                   03909000
OPNRFMFX EQU   OPNRFM                                                   03910000
OPNOPTSK EQU   OPNOPT                                                   03911000
OPNOPTDR EQU   OPNOPT                                                   03912000
OPNOPTCR EQU   OPNOPT                                                   03913000
OPNOPTKS EQU   OPNOPT                                                   03914000
OPNOPTBK EQU   OPNOPT                                                   03915000
OPNOPTUP EQU   OPNOPT                                                   03916000
OPNOPTOT EQU   OPNOPT                                                   03917000
OPNOPTIN EQU   OPNOPT                                                   03918000
IOCEXT   EQU   IOCSTR+64                                                03919000
IOCREL   EQU   IOCSTR+60                                                03920000
IOCWORK  EQU   IOCSTR+56                                                03921000
IOCRRN   EQU   IOCSTR+52                                                03922000
IOCPNM   EQU   IOCNWM+2                                                 03923000
IOCPTL   EQU   IOCNWM                                                   03924000
IOCKYA   EQU   IOCMEM                                                   03925000
IOCVRC   EQU   IOCTTR                                                   03926000
IOCCBP   EQU   IOCSTR+36                                                03927000
IOCDSN   EQU   IOCSTR+32                                                03928000
IOCHURBA EQU   IOCSTR+28                                                03929000
IOCVOLSR EQU   IOCSTR+22                                                03930000
@NM00018 EQU   IOCMSG                                                   03931000
IOCMSGAE EQU   IOCMSG                                                   03932000
IOCMSGCE EQU   IOCMSG                                                   03933000
IOCMSGOE EQU   IOCMSG                                                   03934000
IOCMSGOP EQU   IOCMSG                                                   03935000
@NM00017 EQU   IOCMSG                                                   03936000
IOCCHPSY EQU   IOCCHP                                                   03937000
IOCCHPAS EQU   IOCCHP                                                   03938000
IOCCHPBK EQU   IOCCHP                                                   03939000
IOCCHPCR EQU   IOCCHP                                                   03940000
IOCCHPKS EQU   IOCCHP                                                   03941000
IOCCHPSK EQU   IOCCHP                                                   03942000
IOCCHPDR EQU   IOCCHP                                                   03943000
IOCCHPSQ EQU   IOCCHP                                                   03944000
@NM00016 EQU   IOCMAC2                                                  03945000
IOCMACPA EQU   IOCMAC2                                                  03946000
@NM00015 EQU   IOCMAC2                                                  03947000
IOCMACCP EQU   IOCMAC2                                                  03948000
IOCMACRR EQU   IOCMAC2                                                  03949000
IOCMACAS EQU   IOCMAC2                                                  03950000
IOCMACSK EQU   IOCMAC2                                                  03951000
@NM00014 EQU   IOCMAC                                                   03952000
IOCMACCC EQU   IOCMAC                                                   03953000
IOCMACDR EQU   IOCMAC                                                   03954000
IOCMACBK EQU   IOCMAC                                                   03955000
IOCMACCR EQU   IOCMAC                                                   03956000
IOCMACUP EQU   IOCMAC                                                   03957000
IOCMACOT EQU   IOCMAC                                                   03958000
IOCMACIN EQU   IOCMAC                                                   03959000
@NM00013 EQU   IOCRFM                                                   03960000
IOCRFMBK EQU   IOCRFM                                                   03961000
IOCRFMSF EQU   IOCRFM                                                   03962000
IOCRFMUN EQU   IOCRFM                                                   03963000
IOCRFMVR EQU   IOCRFM                                                   03964000
IOCRFMFX EQU   IOCRFM                                                   03965000
@NM00012 EQU   IOCDSO                                                   03966000
IOCDSOPO EQU   IOCDSO                                                   03967000
IOCDSOIS EQU   IOCDSO                                                   03968000
IOCDSOPS EQU   IOCDSO                                                   03969000
IOCDSOAM EQU   IOCDSO                                                   03970000
IOCRKP   EQU   IOCSTR+13                                                03971000
IOCKYL   EQU   IOCSTR+12                                                03972000
IOCTRN   EQU   IOCSTR+8                                                 03973000
IOCDLN   EQU   IOCSTR+4                                                 03974000
IOCDAD   EQU   IOCSTR                                                   03975000
UNITVTOC EQU   UNITABL+7                                                03976000
@NM00011 EQU   UNITSTAT                                                 03977000
UNITXSHR EQU   UNITSTAT                                                 03978000
UNITISHR EQU   UNITSTAT                                                 03979000
UNITUA   EQU   @NM00010+1                                               03980000
UNITCHA  EQU   @NM00010                                                 03981000
UNITUCB  EQU   UNITABL                                                  03982000
ALLUNCNT EQU   ALLAGL+30                                                03983000
ALLVLCNT EQU   ALLAGL+29                                                03984000
@NM00009 EQU   ALLOPT                                                   03985000
ALLOPTUN EQU   ALLOPT                                                   03986000
ALLOPTPV EQU   ALLOPT                                                   03987000
ALLOPTDS EQU   ALLOPT                                                   03988000
ALLOPTVL EQU   ALLOPT                                                   03989000
@NM00008 EQU   ALLORG+1                                                 03990000
ALLORGVS EQU   ALLORG+1                                                 03991000
@NM00007 EQU   ALLORG+1                                                 03992000
ALLORGGS EQU   ALLORG+1                                                 03993000
ALLORGUN EQU   ALLORG                                                   03994000
ALLORGPO EQU   ALLORG                                                   03995000
ALLORGMQ EQU   ALLORG                                                   03996000
ALLORGCQ EQU   ALLORG                                                   03997000
ALLORGCX EQU   ALLORG                                                   03998000
ALLORGDA EQU   ALLORG                                                   03999000
ALLORGPS EQU   ALLORG                                                   04000000
ALLORGIS EQU   ALLORG                                                   04001000
ALLDSPUN EQU   ALLDSP                                                   04002000
ALLDSPCG EQU   ALLDSP                                                   04003000
ALLDSPDE EQU   ALLDSP                                                   04004000
ALLDSPKP EQU   ALLDSP                                                   04005000
@NM00006 EQU   ALLDSP                                                   04006000
ALLSTSOD EQU   ALLSTS                                                   04007000
ALLSTSMD EQU   ALLSTS                                                   04008000
ALLSTSNW EQU   ALLSTS                                                   04009000
ALLSTSSR EQU   ALLSTS                                                   04010000
@NM00005 EQU   ALLSTS                                                   04011000
ALLPWD   EQU   ALLAGL+20                                                04012000
ALLVLP   EQU   ALLAGL+16                                                04013000
ALLULP   EQU   ALLAGL+12                                                04014000
ALLDDN   EQU   ALLAGL+4                                                 04015000
ALLDSN   EQU   ALLAGL                                                   04016000
CIRPID   EQU   CIRAGL+28                                                04017000
CIRPWD   EQU   CIRAGL+24                                                04018000
CIRCAT   EQU   CIRAGL+20                                                04019000
CIRWKP   EQU   CIRAGL+16                                                04020000
CIRTLR   EQU   CIRAGL+12                                                04021000
CIRHDR   EQU   CIRAGL+8                                                 04022000
CIRTLN   EQU   CIRAGL+6                                                 04023000
CIRHLN   EQU   CIRAGL+4                                                 04024000
@NM00004 EQU   CIRAGL+1                                                 04025000
@NM00003 EQU   CIRTYPE                                                  04026000
CIRTYPAQ EQU   CIRTYPE                                                  04027000
CIRTYP1Q EQU   CIRTYPE                                                  04028000
NEWID1   EQU   TRACE1+95                                                04029000
CALLID   EQU   OLDERID1+90                                              04030000
@NM00002 EQU   OLDERID1                                                 04031000
*                                      END UNREFERENCED COMPONENTS      04032000
@RC00365 EQU   @RC00359                                                 04033000
@PB00004 EQU   @EC00444                                                 04034000
@PB00006 EQU   @EC00596                                                 04035000
@PB00007 EQU   @EL00001                                                 04036000
@PB00003 EQU   @PB00004                                                 04037000
@PB00005 EQU   @PB00006                                                 04038000
@PB00002 EQU   @PB00003                                                 04039000
@ENDDATA EQU   *                                                        04040000
         END   IDCSA07,(C'PLS0041',0603,75323)                          04041000
