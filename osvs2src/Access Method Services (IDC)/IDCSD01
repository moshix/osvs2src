         TITLE '**************** IDCSD01:   SCRDSET FSR ****************00001000
               *********'                                               00002000
         MACRO                                                          00003000
         GETMAIN &R,&LV=                                                00004000
         L     REG15,0(REG1)           GDTTBL ADDRESS                   00005000
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS             00006000
         CNOP  2,4                     BOUNDARY ALIGNMENT               00007000
         LA    REG14,*+14              RETURN ADDRESS                   00008000
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE          00009000
         DC    A(MODID)                MODULE ID ADDRESS                00010000
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS   00011000
         MEND                                                           00012000
IDCSD01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCSD01   76.306'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         USING @PSTART,@12                                         0002 00024000
         USING @PSTART+4095,@11                                    0002 00025000
         USING @PSTART+8190,@10                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @09,@01                                             0002 00029000
         USING @DATD,@09                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @09,8(,@13)                                         0002 00033000
         LR    @13,@09                                             0002 00034000
         MVC   @PC00001(12),0(@01)                                 0002 00035000
*                                                                  0315 00036000
*   /*****************************************************************/ 00037000
*   /*                                                               */ 00038000
*   /* THIS IS THE START OF THE EXECUTABLE PORTION OF        @Z40LB30*/ 00039000
*   /* THE MODULE. THIS SECTION DOES INITIALIZATION,         @Z40LB30*/ 00040000
*   /* CHECKS THE LEVEL PARAMETER FOR VALIDITY,              @Z40LB30*/ 00041000
*   /* CALLS A PROCEDURE TO CALCULATE AN EXPIRATION          @Z40LB30*/ 00042000
*   /* OR CREATION DATE, CALLS THE CORRECT PROCEDURE TO      @Z40LB30*/ 00043000
*   /* EXECUTE THE FUNCTION REQUESTED ON THE COMMAND, AND    @Z40LB30*/ 00044000
*   /* SETS THE LASTCOND FIELD.                              @Z40LB30*/ 00045000
*   /*                                                       @Z40LB30*/ 00046000
*   /* ESTABLISH TRACE POINT AND FULL REGION DUMP POINT      @Z40LB30*/ 00047000
*   /*                                                               */ 00048000
*   /*****************************************************************/ 00049000
*                                                                  0315 00050000
*   OLDERID2=NEWERID2;                                             0315 00051000
         L     @08,@PC00001                                        0315 00052000
         L     @15,GDTTR2(,@08)                                    0315 00053000
         MVC   @TS00001(95),NEWERID2(@15)                          0315 00054000
         MVC   OLDERID2(95,@15),@TS00001                           0315 00055000
*   NEWID2='SD01';                  /*                       @Z40LB30*/ 00056000
         MVC   NEWID2(4,@15),@CC01361                              0316 00057000
*   IF GDTDBG=NULLPTR THEN                                         0317 00058000
         L     @08,GDTDBG(,@08)                                    0317 00059000
         LTR   @08,@08                                             0317 00060000
         BZ    @RT00317                                            0317 00061000
*     ;                                                            0318 00062000
*   ELSE                                                           0319 00063000
*     CALL IDCDB010(GDTTBL,'SDST'); /*                       @Z40LB30*/ 00064000
*                                                                  0319 00065000
         L     @08,@PC00001                                        0319 00066000
         ST    @08,@AL00001                                        0319 00067000
         LA    @15,@CC01488                                        0319 00068000
         ST    @15,@AL00001+4                                      0319 00069000
         MVI   @AL00001+4,X'80'                                    0319 00070000
         L     @15,GDTDBG(,@08)                                    0319 00071000
         LA    @01,@AL00001                                        0319 00072000
         BALR  @14,@15                                             0319 00073000
*   /*****************************************************************/ 00074000
*   /*                                                               */ 00075000
*   /* SET ADDRESSABILITY TO UPRINT AGRUMENT LIST            @Z40LB30*/ 00076000
*   /*                                                               */ 00077000
*   /*****************************************************************/ 00078000
*                                                                  0320 00079000
*   DDSTRU=ADDR(DARGAREA);          /*                       @Z40LB30*/ 00080000
*                                                                  0320 00081000
@RT00317 LA    @08,DARGAREA                                        0320 00082000
         ST    @08,DDSTRU                                          0320 00083000
*   /*****************************************************************/ 00084000
*   /*                                                               */ 00085000
*   /* ZERO FLAG AREAS                                       @Z40LB30*/ 00086000
*   /*                                                               */ 00087000
*   /*****************************************************************/ 00088000
*                                                                  0321 00089000
*   COMFLAGS=''B;                   /*                       @Z40LB30*/ 00090000
         MVI   COMFLAGS,X'00'                                      0321 00091000
*   FLAGS=''B;                      /*                       @Z40LB30*/ 00092000
*                                                                  0322 00093000
         MVI   FLAGS,X'00'                                         0322 00094000
*   /*****************************************************************/ 00095000
*   /*                                                               */ 00096000
*   /* SET ADDRESSABILITY TO VOLUME RECORD AND GROUP RECORD  @Z40LB30*/ 00097000
*   /*                                                               */ 00098000
*   /*****************************************************************/ 00099000
*                                                                  0323 00100000
*   BASEVPTR=ADDR(VOLREC);          /*                       @Z40LB30*/ 00101000
         LA    BASEVPTR,VOLREC                                     0323 00102000
*   GROUPPTR=ADDR(GRPREC);          /*                       @Z40LB30*/ 00103000
         LA    @04,GRPREC                                          0324 00104000
         ST    @04,GROUPPTR                                        0324 00105000
*                                                                  0325 00106000
*   /*****************************************************************/ 00107000
*   /*                                                               */ 00108000
*   /* IF THE LEVEL PARAMETER WAS SPECIFIED AND THE LAST     @Z40LB30*/ 00109000
*   /* CHARACTER IS AN ASTERISK, ISSUE MESSAGE IDC3113I      @Z40LB30*/ 00110000
*   /* AND SET THE LASTCOND FIELD                            @Z40LB30*/ 00111000
*   /*                                                               */ 00112000
*   /*****************************************************************/ 00113000
*                                                                  0325 00114000
*   IF ADDR(LEVEL)^=NULLPTR&LEVELPOS=LEVELLEN THEN/*         @Z40LB30*/ 00115000
         L     @04,@PC00001+4                                      0325 00116000
         L     @04,FDTPTR+20(,@04)                                 0325 00117000
         LTR   @04,@04                                             0325 00118000
         BZ    @RF00325                                            0325 00119000
         CLC   LEVELPOS(1,@04),LEVELLEN(@04)                       0325 00120000
         BNE   @RF00325                                            0325 00121000
*     DO;                           /*                       @Z40LB30*/ 00122000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 00123000
         XC    DARGAREA(28),DARGAREA                               0327 00124000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/ 00125000
         MVC   DARGSMOD(3,@08),@CC01418                            0328 00126000
*       DARGSENT=MSG3113I;          /*                       @Z40LB30*/ 00127000
         MVI   DARGSENT(@08),X'45'                                 0329 00128000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 00129000
         L     @08,@PC00001                                        0330 00130000
         ST    @08,@AL00001                                        0330 00131000
         LA    @04,@CF00116                                        0330 00132000
         ST    @04,@AL00001+4                                      0330 00133000
         LA    @04,DDSTRU                                          0330 00134000
         ST    @04,@AL00001+8                                      0330 00135000
         MVI   @AL00001+8,X'80'                                    0330 00136000
         L     @15,GDTPRT(,@08)                                    0330 00137000
         LA    @01,@AL00001                                        0330 00138000
         BALR  @14,@15                                             0330 00139000
*       LASTCOND=LASTCC12;          /*                       @Z40LB30*/ 00140000
         L     @08,@PC00001+8                                      0331 00141000
         MVC   LASTCOND(2,@08),@CH00035                            0331 00142000
*     END;                          /*                       @Z40LB30*/ 00143000
*                                                                  0332 00144000
*   /*****************************************************************/ 00145000
*   /*                                                               */ 00146000
*   /* IF THE FILE PARAMETER WAS SPECIFIED ON THE COMMAND,   @Z40LB30*/ 00147000
*   /* ISSUE THE UMSSUNIT MACRO TO CHECK THAT IT IS          @Z40LB30*/ 00148000
*   /* A VIRTUAL DEVICE AND A DEMOUNTABLE UNIT. SAVE THE     @Z40LB30*/ 00149000
*   /* RETURN CODE AND SET THE LASTCOND FIELD.               @Z40LB30*/ 00150000
*   /*                                                               */ 00151000
*   /*****************************************************************/ 00152000
*                                                                  0333 00153000
*   IF ADDR(FILE)^=NULLPTR THEN     /*                       @Z40LB30*/ 00154000
@RF00325 SLR   @08,@08                                             0333 00155000
         L     @04,@PC00001+4                                      0333 00156000
         L     @04,FDTPTR+44(,@04)                                 0333 00157000
         CR    @04,@08                                             0333 00158000
         BE    @RF00333                                            0333 00159000
*     DO;                           /*                       @Z40LB30*/ 00160000
*       RESPECIFY                                                  0335 00161000
*         CKAGL BASED(ADDR(CHKAREA));/*                      @Z40LB30*/ 00162000
*       CKAGL=''B;                  /*                       @Z40LB30*/ 00163000
         LA    @02,CHKAREA                                         0336 00164000
         XC    CKAGL(29,@02),CKAGL(@02)                            0336 00165000
*       CKTESTVT=ON;                /* TEST FOR VIRTUAL      @Z40LB30*/ 00166000
*       CKDMTABL=ON;                /* TEST FOR DEMOUNTABLE  @Z40LB30*/ 00167000
         OI    CKTESTVT(@02),B'10100000'                           0338 00168000
*       CKDDNAME=FILEVAL;           /*                       @Z40LB30*/ 00169000
         MVC   CKDDNAME(8,@02),FILEVAL(@04)                        0339 00170000
*       CKUCBPTR=ADDR(FILEUCB);     /* UCB ADDRESS TO BE RETURNED  0340 00171000
*                                                            @Z40LB30*/ 00172000
         LA    @04,FILEUCB                                         0340 00173000
         ST    @04,CKUCBPTR(,@02)                                  0340 00174000
*       FILEUCB=NULLPTR;            /*                       @Z40LB30*/ 00175000
         ST    @08,FILEUCB                                         0341 00176000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB30*/ 00177000
         L     @08,@PC00001                                        0342 00178000
         ST    @08,@AL00001                                        0342 00179000
         LA    @04,CHECK                                           0342 00180000
         ST    @04,@AL00001+4                                      0342 00181000
         ST    @02,@AL00001+8                                      0342 00182000
         MVI   @AL00001+8,X'80'                                    0342 00183000
         L     @15,GDTUNT(,@08)                                    0342 00184000
         LA    @01,@AL00001                                        0342 00185000
         BALR  @14,@15                                             0342 00186000
*       RESPECIFY                                                  0343 00187000
*         RTNREG RSTD;                                             0343 00188000
*       TESTRC=RTNREG;                                             0344 00189000
         LR    TESTRC,RTNREG                                       0344 00190000
*       RESPECIFY                                                  0345 00191000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 00192000
*       IF TESTRC^=0 THEN           /*                       @Z40LB30*/ 00193000
         LTR   TESTRC,TESTRC                                       0346 00194000
         BZ    @RF00346                                            0346 00195000
*         LASTCOND=LASTCC12;        /*                       @Z40LB30*/ 00196000
         L     @08,@PC00001+8                                      0347 00197000
         MVC   LASTCOND(2,@08),@CH00035                            0347 00198000
*     END;                          /*                       @Z40LB30*/ 00199000
@RF00346 DS    0H                                                  0349 00200000
*                                                                  0349 00201000
*   /*****************************************************************/ 00202000
*   /*                                                               */ 00203000
*   /* IF ALL CHECKS WERE SUCCESSFUL, CONTINUE WITH          @Z40LB30*/ 00204000
*   /* PROCESSING                                            @Z40LB30*/ 00205000
*   /*                                                               */ 00206000
*   /*****************************************************************/ 00207000
*                                                                  0349 00208000
*   IF LASTCOND=LASTCC00 THEN       /*                       @Z40LB30*/ 00209000
@RF00333 SLR   @08,@08                                             0349 00210000
         L     @04,@PC00001+8                                      0349 00211000
         CH    @08,LASTCOND(,@04)                                  0349 00212000
         BNE   @RF00349                                            0349 00213000
*     DO;                           /*                       @Z40LB30*/ 00214000
*       RESPECIFY                                                  0351 00215000
*         DATESAGL BASED(ADDR(DTSAREA));/*                   @Z40LB30*/ 00216000
*                                                                  0351 00217000
*       /*************************************************************/ 00218000
*       /*                                                           */ 00219000
*       /* IF EXPIRATION PARAMETERS WERE SPECIFIED ON        @Z40LB30*/ 00220000
*       /* THE COMMAND, CALL THE DATES PROCEDURE TO          @Z40LB30*/ 00221000
*       /* CALCULATE A DATE FOR COMPARISON                   @Z40LB30*/ 00222000
*       /*                                                           */ 00223000
*       /*************************************************************/ 00224000
*                                                                  0352 00225000
*       IF ADDR(EXPIR)^=NULLPTR|ADDR(EXPDT)^=NULLPTR/*       @Z40LB30*/ 00226000
*         THEN                      /*                       @Z40LB30*/ 00227000
         L     @04,@PC00001+4                                      0352 00228000
         C     @08,FDTPTR+32(,@04)                                 0352 00229000
         BNE   @RT00352                                            0352 00230000
         C     @08,FDTPTR+28(,@04)                                 0352 00231000
         BE    @RF00352                                            0352 00232000
@RT00352 DS    0H                                                  0353 00233000
*         DO;                       /*                       @Z40LB30*/ 00234000
*           DATESAGL=''B;           /*                       @Z40LB30*/ 00235000
         LA    @08,DTSAREA                                         0354 00236000
         XC    DATESAGL(21,@08),DATESAGL(@08)                      0354 00237000
*           DATRETRN=ADDR(EXPDATE); /* PLACE TO RETURN       @Z40LB30   00238000
*                                      DATE                  @Z40LB30*/ 00239000
*                                                                  0355 00240000
         LA    @04,EXPDATE                                         0355 00241000
         ST    @04,DATRETRN(,@08)                                  0355 00242000
*           /*********************************************************/ 00243000
*           /*                                                       */ 00244000
*           /* SPECIFY EITHER THE NUMBER OF DAYS OR THE DATE @Z40LB30*/ 00245000
*           /*                                                       */ 00246000
*           /*********************************************************/ 00247000
*                                                                  0356 00248000
*           IF ADDR(EXPIR)^=NULLPTR THEN/*                   @Z40LB30*/ 00249000
         L     @04,@PC00001+4                                      0356 00250000
         L     @04,FDTPTR+32(,@04)                                 0356 00251000
         LTR   @04,@04                                             0356 00252000
         BZ    @RF00356                                            0356 00253000
*             DO;                   /*                       @Z40LB30*/ 00254000
*               DATDAYOP=ON;        /* DAYS OPTION           @Z40LB30*/ 00255000
         OI    DATDAYOP(@08),B'00010000'                           0358 00256000
*               DATDAYS=EXPIRVAL;   /* NUMBER OF DAYS        @Z40LB30*/ 00257000
         L     @04,EXPIRVAL(,@04)                                  0359 00258000
         ST    @04,DATDAYS(,@08)                                   0359 00259000
*               DATADD=ON;          /* ADD DAYS TO CURRENT   @Z40LB30   00260000
*                                      DATE                  @Z40LB30*/ 00261000
         OI    DATADD(@08),B'10000000'                             0360 00262000
*             END;                  /*                       @Z40LB30*/ 00263000
*           ELSE                    /*                       @Z40LB30*/ 00264000
*             DO;                   /*                       @Z40LB30*/ 00265000
         B     @RC00356                                            0362 00266000
@RF00356 DS    0H                                                  0363 00267000
*               DATDTEOP=ON;        /* DATE OPTION           @Z40LB30*/ 00268000
         LA    @08,DTSAREA                                         0363 00269000
         OI    DATDTEOP(@08),B'00100000'                           0363 00270000
*               DATDATE=EXPDTVAL;   /* DATE                  @Z40LB30*/ 00271000
         L     @04,@PC00001+4                                      0364 00272000
         L     @04,FDTPTR+28(,@04)                                 0364 00273000
         L     @04,EXPDTVAL(,@04)                                  0364 00274000
         ST    @04,DATDATE(,@08)                                   0364 00275000
*             END;                  /*                       @Z40LB30*/ 00276000
*           CALL DATES(DATESAGL);   /*                       @Z40LB30*/ 00277000
@RC00356 LA    @08,DTSAREA                                         0366 00278000
         ST    @08,@AL00001                                        0366 00279000
         LA    @01,@AL00001                                        0366 00280000
         BAL   @14,DATES                                           0366 00281000
*         END;                      /*                       @Z40LB30*/ 00282000
*                                                                  0368 00283000
*       /*************************************************************/ 00284000
*       /*                                                           */ 00285000
*       /* IF CREATION PARAMETERS WERE SPECIFIED ON THE      @Z40LB30*/ 00286000
*       /* COMMAND, CALL THE DATES PROCEDURE TO CALCULATE    @Z40LB30*/ 00287000
*       /* A DATE FOR COMPARISON                             @Z40LB30*/ 00288000
*       /*                                                           */ 00289000
*       /*************************************************************/ 00290000
*                                                                  0368 00291000
*       IF ADDR(CREAT)^=NULLPTR|ADDR(CREDT)^=NULLPTR/*       @Z40LB30*/ 00292000
*         THEN                      /*                       @Z40LB30*/ 00293000
@RF00352 SLR   @08,@08                                             0368 00294000
         L     @04,@PC00001+4                                      0368 00295000
         C     @08,FDTPTR+40(,@04)                                 0368 00296000
         BNE   @RT00368                                            0368 00297000
         C     @08,FDTPTR+36(,@04)                                 0368 00298000
         BE    @RF00368                                            0368 00299000
@RT00368 DS    0H                                                  0369 00300000
*         DO;                       /*                       @Z40LB30*/ 00301000
*           DATESAGL=''B;           /*                       @Z40LB30*/ 00302000
         LA    @08,DTSAREA                                         0370 00303000
         XC    DATESAGL(21,@08),DATESAGL(@08)                      0370 00304000
*           DATRETRN=ADDR(CREDATE); /* PLACE TO RETURN       @Z40LB30   00305000
*                                      DATE                  @Z40LB30*/ 00306000
*                                                                  0371 00307000
         LA    @04,CREDATE                                         0371 00308000
         ST    @04,DATRETRN(,@08)                                  0371 00309000
*           /*********************************************************/ 00310000
*           /*                                                       */ 00311000
*           /* SPECIFY EITHER THE NUMBER OF DAYS OR THE DATE @Z40LB30*/ 00312000
*           /*                                                       */ 00313000
*           /*********************************************************/ 00314000
*                                                                  0372 00315000
*           IF ADDR(CREAT)^=NULLPTR THEN/*                   @Z40LB30*/ 00316000
         L     @04,@PC00001+4                                      0372 00317000
         L     @04,FDTPTR+40(,@04)                                 0372 00318000
         LTR   @04,@04                                             0372 00319000
         BZ    @RF00372                                            0372 00320000
*             DO;                   /*                       @Z40LB30*/ 00321000
*               DATDAYOP=ON;        /* DAYS OPTION           @Z40LB30*/ 00322000
         OI    DATDAYOP(@08),B'00010000'                           0374 00323000
*               DATDAYS=CREATVAL;   /* NUMBER OF DAYS        @Z40LB30*/ 00324000
         L     @04,CREATVAL(,@04)                                  0375 00325000
         ST    @04,DATDAYS(,@08)                                   0375 00326000
*               DATSUB=ON;          /* SUBTRACT DAYS FROM    @Z40LB30   00327000
*                                      CURRENT DATE          @Z40LB30*/ 00328000
         OI    DATSUB(@08),B'01000000'                             0376 00329000
*             END;                  /*                       @Z40LB30*/ 00330000
*           ELSE                    /*                       @Z40LB30*/ 00331000
*             DO;                   /*                       @Z40LB30*/ 00332000
         B     @RC00372                                            0378 00333000
@RF00372 DS    0H                                                  0379 00334000
*               DATDTEOP=ON;        /* DATE OPTION           @Z40LB30*/ 00335000
         LA    @08,DTSAREA                                         0379 00336000
         OI    DATDTEOP(@08),B'00100000'                           0379 00337000
*               DATDATE=CREDTVAL;   /* DATE                  @Z40LB30*/ 00338000
         L     @04,@PC00001+4                                      0380 00339000
         L     @04,FDTPTR+36(,@04)                                 0380 00340000
         L     @04,CREDTVAL(,@04)                                  0380 00341000
         ST    @04,DATDATE(,@08)                                   0380 00342000
*             END;                  /*                       @Z40LB30*/ 00343000
*           CALL DATES(DATESAGL);   /*                       @Z40LB30*/ 00344000
@RC00372 LA    @08,DTSAREA                                         0382 00345000
         ST    @08,@AL00001                                        0382 00346000
         LA    @01,@AL00001                                        0382 00347000
         BAL   @14,DATES                                           0382 00348000
*         END;                      /*                       @Z40LB30*/ 00349000
*                                                                  0384 00350000
*       /*************************************************************/ 00351000
*       /*                                                           */ 00352000
*       /* CALL THE PROPER PROCEDURE TO PROCESS THE VOLUMES  @Z40LB30*/ 00353000
*       /* BASED ON THE PARAMETER SPECIFIED ON THE COMMAND:  @Z40LB30*/ 00354000
*       /* VOLUMES, GROUPS, NONGROUPED, ALLVOLUMES, OR       @Z40LB30*/ 00355000
*       /* ALLGROUPS                                         @Z40LB30*/ 00356000
*       /*                                                           */ 00357000
*       /*************************************************************/ 00358000
*                                                                  0384 00359000
*       IF ADDR(VOL)^=NULLPTR THEN  /*                       @Z40LB30*/ 00360000
@RF00368 L     @08,@PC00001+4                                      0384 00361000
         L     @08,FDTPTR(,@08)                                    0384 00362000
         LTR   @08,@08                                             0384 00363000
         BZ    @RF00384                                            0384 00364000
*         CALL SPECVOL;             /*                       @Z40LB30*/ 00365000
         BAL   @14,SPECVOL                                         0385 00366000
*       ELSE                        /*                       @Z40LB30*/ 00367000
*         IF ADDR(GRP)^=NULLPTR THEN/*                       @Z40LB30*/ 00368000
         B     @RC00384                                            0386 00369000
@RF00384 L     @08,@PC00001+4                                      0386 00370000
         L     @08,FDTPTR+4(,@08)                                  0386 00371000
         LTR   @08,@08                                             0386 00372000
         BZ    @RF00386                                            0386 00373000
*           CALL SPECGRP;           /*                       @Z40LB30*/ 00374000
         BAL   @14,SPECGRP                                         0387 00375000
*         ELSE                      /*                       @Z40LB30*/ 00376000
*           IF ADDR(NGRPD)^=NULLPTR THEN/*                   @Z40LB30*/ 00377000
         B     @RC00386                                            0388 00378000
@RF00386 L     @08,@PC00001+4                                      0388 00379000
         L     @08,FDTPTR+16(,@08)                                 0388 00380000
         LTR   @08,@08                                             0388 00381000
         BZ    @RF00388                                            0388 00382000
*             CALL NONGRPD;         /*                       @Z40LB30*/ 00383000
         BAL   @14,NONGRPD                                         0389 00384000
*           ELSE                    /*                       @Z40LB30*/ 00385000
*             IF ADDR(AGRP)^=NULLPTR THEN/*                  @Z40LB30*/ 00386000
         B     @RC00388                                            0390 00387000
@RF00388 L     @08,@PC00001+4                                      0390 00388000
         L     @08,FDTPTR+12(,@08)                                 0390 00389000
         LTR   @08,@08                                             0390 00390000
         BZ    @RF00390                                            0390 00391000
*               CALL ALLGRPS;       /*                       @Z40LB30*/ 00392000
         BAL   @14,ALLGRPS                                         0391 00393000
*             ELSE                  /*                       @Z40LB30*/ 00394000
*               IF ADDR(AVOL)^=NULLPTR THEN/*                @Z40LB30*/ 00395000
         B     @RC00390                                            0392 00396000
@RF00390 L     @08,@PC00001+4                                      0392 00397000
         L     @08,FDTPTR+8(,@08)                                  0392 00398000
         LTR   @08,@08                                             0392 00399000
         BZ    @RF00392                                            0392 00400000
*                 CALL ALLVOLS;     /*                       @Z40LB30*/ 00401000
*                                                                  0393 00402000
         BAL   @14,ALLVOLS                                         0393 00403000
*       /*************************************************************/ 00404000
*       /*                                                           */ 00405000
*       /* SAVE THE RETURN CODE AND SET THE LASTCOND         @Z40LB30*/ 00406000
*       /* FIELD EQUAL TO THE RETURN CODE                    @Z40LB30*/ 00407000
*       /*                                                           */ 00408000
*       /*************************************************************/ 00409000
*                                                                  0394 00410000
*       RESPECIFY                                                  0394 00411000
*         RTNREG RSTD;                                             0394 00412000
@RF00392 DS    0H                                                  0394 00413000
@RC00390 DS    0H                                                  0394 00414000
@RC00388 DS    0H                                                  0394 00415000
@RC00386 DS    0H                                                  0394 00416000
@RC00384 DS    0H                                                  0395 00417000
*       TESTRC=RTNREG;                                             0395 00418000
         LR    TESTRC,RTNREG                                       0395 00419000
*       RESPECIFY                                                  0396 00420000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 00421000
*       LASTCOND=TESTRC;            /*                       @Z40LB30*/ 00422000
         L     @08,@PC00001+8                                      0397 00423000
         STH   TESTRC,LASTCOND(,@08)                               0397 00424000
*     END;                          /*                       @Z40LB30*/ 00425000
*                                                                  0399 00426000
*   /*****************************************************************/ 00427000
*   /*                                                               */ 00428000
*   /* ISSUE MESSAGE IDC0001I IF THE LAST CONDITION CODE     @Z40LB30*/ 00429000
*   /* IS < 12 OR ISSUE MESSAGE IDC3003I IF THE LAST         @Z40LB30*/ 00430000
*   /* CONDITION CODE IS 12                                  @Z40LB30*/ 00431000
*   /*                                                               */ 00432000
*   /*****************************************************************/ 00433000
*                                                                  0399 00434000
*   DARGAREA=''B;                   /*                       @Z40LB30*/ 00435000
@RF00349 XC    DARGAREA(28),DARGAREA                               0399 00436000
*   DARGSMOD=UV0MSG;                /*                       @Z40LB30*/ 00437000
         L     @08,DDSTRU                                          0400 00438000
         MVC   DARGSMOD(3,@08),@CC01422                            0400 00439000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Z40LB30*/ 00440000
         L     @15,@PC00001+8                                      0401 00441000
         ST    @15,DARGDBP(,@08)                                   0401 00442000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Z40LB30*/ 00443000
         MVC   DARGILP(2,@08),@CH00155                             0402 00444000
*   IF LASTCOND<LASTCC12 THEN       /*                       @Z40LB30*/ 00445000
         LH    @15,LASTCOND(,@15)                                  0403 00446000
         C     @15,@CF00035                                        0403 00447000
         BNL   @RF00403                                            0403 00448000
*     DARGSENT=MSG0001I;            /*                       @Z40LB30*/ 00449000
         MVI   DARGSENT(@08),X'01'                                 0404 00450000
*   ELSE                            /*                       @Z40LB30*/ 00451000
*     DARGSENT=MSG3003I;            /*                       @Z40LB30*/ 00452000
         B     @RC00403                                            0405 00453000
@RF00403 L     @08,DDSTRU                                          0405 00454000
         MVI   DARGSENT(@08),X'03'                                 0405 00455000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB30*/ 00456000
*                                                                  0406 00457000
@RC00403 L     @08,@PC00001                                        0406 00458000
         ST    @08,@AL00001                                        0406 00459000
         LA    @15,@CF00116                                        0406 00460000
         ST    @15,@AL00001+4                                      0406 00461000
         LA    @15,DDSTRU                                          0406 00462000
         ST    @15,@AL00001+8                                      0406 00463000
         MVI   @AL00001+8,X'80'                                    0406 00464000
         L     @15,GDTPRT(,@08)                                    0406 00465000
         LA    @01,@AL00001                                        0406 00466000
         BALR  @14,@15                                             0406 00467000
*   /*****************************************************************/ 00468000
*   /*                                                               */ 00469000
*   /* ESTABLISH A FULL REGION DUMP POINT                    @Z40LB30*/ 00470000
*   /*                                                               */ 00471000
*   /*****************************************************************/ 00472000
*                                                                  0407 00473000
*   IF GDTDBG=NULLPTR THEN                                         0407 00474000
         L     @08,@PC00001                                        0407 00475000
         L     @08,GDTDBG(,@08)                                    0407 00476000
         LTR   @08,@08                                             0407 00477000
         BZ    @RT00407                                            0407 00478000
*     ;                                                            0408 00479000
*   ELSE                                                           0409 00480000
*     CALL IDCDB010(GDTTBL,'SDED'); /*                       @Z40LB30*/ 00481000
*                                                                  0409 00482000
         L     @08,@PC00001                                        0409 00483000
         ST    @08,@AL00001                                        0409 00484000
         LA    @15,@CC01500                                        0409 00485000
         ST    @15,@AL00001+4                                      0409 00486000
         MVI   @AL00001+4,X'80'                                    0409 00487000
         L     @15,GDTDBG(,@08)                                    0409 00488000
         LA    @01,@AL00001                                        0409 00489000
         BALR  @14,@15                                             0409 00490000
*   /*****************************************************************/ 00491000
*   /*                                                               */ 00492000
*   /* RETURN TO THE CALLER                                  @Z40LB30*/ 00493000
*   /*                                                               */ 00494000
*   /*****************************************************************/ 00495000
*                                                                  0410 00496000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);/*                  @Z40LB30*/ 00497000
@RT00407 L     @08,@PC00001                                        0410 00498000
         ST    @08,@AL00001                                        0410 00499000
         LA    @15,MODID                                           0410 00500000
         ST    @15,@AL00001+4                                      0410 00501000
         L     @15,@PC00001+8                                      0410 00502000
         ST    @15,@AL00001+8                                      0410 00503000
         MVI   @AL00001+8,X'80'                                    0410 00504000
         L     @15,GDTEPL(,@08)                                    0410 00505000
         LA    @01,@AL00001                                        0410 00506000
         BALR  @14,@15                                             0410 00507000
*                                                                  0411 00508000
*/********************************************************   @Z40LB30*/ 00509000
*/*                                                          @Z40LB30*/ 00510000
*/* PROCEDURE - SPECVOL                                      @Z40LB30*/ 00511000
*/*                                                          @Z40LB30*/ 00512000
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL    @Z40LB30*/ 00513000
*/*           TO READ EACH VOLUME RECORD SPECIFIED ON THE    @Z40LB30*/ 00514000
*/*           SCRDSET COMMAND.  CALL PROCEDURES TO CHECK     @Z40LB30*/ 00515000
*/*           IF THERE ARE ANY RECOVERY FLAGS ON AND         @Z40LB30*/ 00516000
*/*           TO PROCESS THE VOLUME.  PRINT MESSAGE          @Z40LB30*/ 00517000
*/*           IDC2074I IF THE VOLUME IS NOT ACTIVE,          @Z40LB30*/ 00518000
*/*           FOLLOWED BY MESSAGE IDC2108I.  IF AN ERROR     @Z40LB30*/ 00519000
*/*           OCCURS READING A VOLUME RECORD, PRINT MESSAGE  @Z40LB30*/ 00520000
*/*           IDC2080I.                                      @Z40LB30*/ 00521000
*/*                                                          @Z40LB30*/ 00522000
*/* INPUT - FUNCTION DATA TABLE                              @Z40LB30*/ 00523000
*/*                                                          @Z40LB30*/ 00524000
*/* OUTPUT - REGISTER 15 = 0, NO ERROR OCCURRED              @Z40LB30*/ 00525000
*/*                        4, ERROR DEALLOCATING VOLUME      @Z40LB30*/ 00526000
*/*                           OR CLOSING VTOC                @Z40LB30*/ 00527000
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/ 00528000
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/ 00529000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 00530000
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/ 00531000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 00532000
*/*                                                          @Z40LB30*/ 00533000
*/********************************************************   @Z40LB30*/ 00534000
*                                                                  0411 00535000
*SPECVOL:                                                          0411 00536000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 00537000
@EL00001 L     @13,4(,@13)                                         0411 00538000
@EF00001 L     @00,@SIZDATD                                        0411 00539000
         LR    @01,@09                                             0411 00540000
         FREEMAIN R,LV=(0),A=(1)                                        00541000
@ER00001 LM    @14,@12,12(@13)                                     0411 00542000
         BR    @14                                                 0411 00543000
SPECVOL  ST    @14,@SA00002                                        0411 00544000
*                                                                  0412 00545000
*   /*****************************************************************/ 00546000
*   /*                                                               */ 00547000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 00548000
*   /*                                                               */ 00549000
*   /*****************************************************************/ 00550000
*                                                                  0412 00551000
*   OLDERID2=NEWERID2;                                             0412 00552000
         L     @08,@PC00001                                        0412 00553000
         L     @08,GDTTR2(,@08)                                    0412 00554000
         MVC   @TS00001(95),NEWERID2(@08)                          0412 00555000
         MVC   OLDERID2(95,@08),@TS00001                           0412 00556000
*   NEWID2='SDSV';                  /*                       @Z40LB30*/ 00557000
*                                                                  0413 00558000
         MVC   NEWID2(4,@08),@CC01504                              0413 00559000
*   /*****************************************************************/ 00560000
*   /*                                                               */ 00561000
*   /* SET INTERNAL CONDITION CODE TO ZERO                   @Z40LB30*/ 00562000
*   /*                                                               */ 00563000
*   /*****************************************************************/ 00564000
*                                                                  0414 00565000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 00566000
*                                                                  0414 00567000
         SLR   CC01,CC01                                           0414 00568000
*   /*****************************************************************/ 00569000
*   /*                                                               */ 00570000
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ A SPECIFIC   @Z40LB30*/ 00571000
*   /* BASE VOLUME RECORD FROM THE INVENTORY AND TEST THAT   @Z40LB30*/ 00572000
*   /* IT IS ACTIVE                                          @Z40LB30*/ 00573000
*   /*                                                               */ 00574000
*   /*****************************************************************/ 00575000
*                                                                  0415 00576000
*   VOLRVVI=''B;                    /*                       @Z40LB30*/ 00577000
         XC    VOLRVVI(68),VOLRVVI                                 0415 00578000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/ 00579000
         LA    @08,VOLRVVI                                         0416 00580000
         ST    @08,RVVIPTR                                         0416 00581000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 00582000
         LH    @15,RVVLEN                                          0417 00583000
         ST    @15,RVVLNGTH(,@08)                                  0417 00584000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 00585000
         MVI   RVVCODE(@08),X'87'                                  0418 00586000
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/ 00587000
         MVC   RVVBUFLN(2,@08),@CH01625                            0419 00588000
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 00589000
         LA    @15,VOLREC                                          0420 00590000
         ST    @15,RVVRTBUF(,@08)                                  0420 00591000
*   RVVRDR=ON;                      /* READ A RECORD         @Z40LB30*/ 00592000
         OI    RVVRDR(@08),B'10000000'                             0421 00593000
*   RVVBVRCD=ON;                    /* BASE RECORD           @Z40LB30*/ 00594000
         OI    RVVBVRCD(@08),B'10000000'                           0422 00595000
*   RVVACTV=ON;                     /* ACTIVE VOLUME         @Z40LB30*/ 00596000
         OI    RVVACTV(@08),B'00000100'                            0423 00597000
*   RVVSVOL=ON;                     /* VOLUME SERIAL IS      @Z40LB30   00598000
*                                      SPECIFIED             @Z40LB30*/ 00599000
         OI    RVVSVOL(@08),B'00000001'                            0424 00600000
*                                                                  0425 00601000
*   /*****************************************************************/ 00602000
*   /*                                                               */ 00603000
*   /* READ THE BASE VOLUME RECORD FOR EACH VOLUME SPECIFIED @Z40LB30*/ 00604000
*   /* ON THE SCRDSET COMMAND                                @Z40LB30*/ 00605000
*   /*                                                               */ 00606000
*   /*****************************************************************/ 00607000
*                                                                  0425 00608000
*   DO INDEX=1 TO VOLCNT;           /*                       @Z40LB30*/ 00609000
*                                                                  0425 00610000
         LA    @08,1                                               0425 00611000
         B     @DE00425                                            0425 00612000
@DL00425 DS    0H                                                  0426 00613000
*     /***************************************************************/ 00614000
*     /*                                                             */ 00615000
*     /* PUT THE VOLUME SERIAL IN THE IEZRVVI PARAMETER LIST @Z40LB30*/ 00616000
*     /*                                                             */ 00617000
*     /***************************************************************/ 00618000
*                                                                  0426 00619000
*     RVVOLUME=VOLVAL(INDEX);       /*                       @Z40LB30*/ 00620000
*                                                                  0426 00621000
         L     @02,RVVIPTR                                         0426 00622000
         SLA   @08,3                                               0426 00623000
         L     @15,@PC00001+4                                      0426 00624000
         L     @01,FDTPTR(,@15)                                    0426 00625000
         ALR   @01,@08                                             0426 00626000
         AL    @01,@CF01643                                        0426 00627000
         MVC   RVVOLUME(6,@02),VOLVAL-3(@01)                       0426 00628000
*     /***************************************************************/ 00629000
*     /*                                                             */ 00630000
*     /* ISSUE USSC TO READ THE RECORD. SAVE THE RETURN      @Z40LB30*/ 00631000
*     /* CODE                                                @Z40LB30*/ 00632000
*     /*                                                             */ 00633000
*     /***************************************************************/ 00634000
*                                                                  0427 00635000
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/ 00636000
         L     @08,@PC00001                                        0427 00637000
         ST    @08,@AL00001                                        0427 00638000
         LA    @02,VVIC                                            0427 00639000
         ST    @02,@AL00001+4                                      0427 00640000
         LA    @02,RVVIPTR                                         0427 00641000
         ST    @02,@AL00001+8                                      0427 00642000
         LA    @02,VVICODE                                         0427 00643000
         ST    @02,@AL00001+12                                     0427 00644000
         MVI   @AL00001+12,X'80'                                   0427 00645000
         L     @15,GDTSSC(,@08)                                    0427 00646000
         LA    @01,@AL00001                                        0427 00647000
         BALR  @14,@15                                             0427 00648000
*     RESPECIFY                                                    0428 00649000
*       RTNREG RSTD;                                               0428 00650000
*     TESTRC=RTNREG;                                               0429 00651000
         LR    TESTRC,RTNREG                                       0429 00652000
*     RESPECIFY                                                    0430 00653000
*       RTNREG UNRSTD;              /*                       @Z40LB30*/ 00654000
*                                                                  0430 00655000
*     /***************************************************************/ 00656000
*     /*                                                             */ 00657000
*     /* IF THE READ WAS SUCCESSFUL, CONTINUE                @Z40LB30*/ 00658000
*     /*                                                             */ 00659000
*     /***************************************************************/ 00660000
*                                                                  0431 00661000
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/ 00662000
         LTR   TESTRC,TESTRC                                       0431 00663000
         BNZ   @RF00431                                            0431 00664000
*       DO;                         /*                       @Z40LB30*/ 00665000
*                                                                  0432 00666000
*         /***********************************************************/ 00667000
*         /*                                                         */ 00668000
*         /* CALL CKRECEXC TO SEE IF ANY RECOVERY FLAGS ARE  @Z40LB30*/ 00669000
*         /* ON IN THE RECORD AND THE VOLUME CANNOT BE       @Z40LB30*/ 00670000
*         /* PROCESSED                                       @Z40LB30*/ 00671000
*         /*                                                         */ 00672000
*         /***********************************************************/ 00673000
*                                                                  0433 00674000
*         CALL CKRECEXC;            /*                       @Z40LB30*/ 00675000
         BAL   @14,CKRECEXC                                        0433 00676000
*         RESPECIFY                                                0434 00677000
*           RTNREG RSTD;                                           0434 00678000
*         TESTRC=RTNREG;                                           0435 00679000
         LR    TESTRC,RTNREG                                       0435 00680000
*         RESPECIFY                                                0436 00681000
*           RTNREG UNRSTD;          /*                       @Z40LB30*/ 00682000
*                                                                  0436 00683000
*         /***********************************************************/ 00684000
*         /*                                                         */ 00685000
*         /* ACCUMULATE THE HIGHEST RETURN CODE IN THE       @Z40LB30*/ 00686000
*         /* INTERNAL CONDITION CODE AREA                    @Z40LB30*/ 00687000
*         /*                                                         */ 00688000
*         /***********************************************************/ 00689000
*                                                                  0437 00690000
*         CC01=MAX(CC01,TESTRC);    /*                       @Z40LB30*/ 00691000
*                                                                  0437 00692000
         CR    CC01,TESTRC                                         0437 00693000
         BNL   *+6                                                      00694000
         LR    CC01,TESTRC                                         0437 00695000
*         /***********************************************************/ 00696000
*         /*                                                         */ 00697000
*         /* IF NO ERRORS WERE FOUND, CALL PROCVOL TO        @Z40LB30*/ 00698000
*         /* PROCESS THE VOLUME. SAVE THE RETURN CODE        @Z40LB30*/ 00699000
*         /* AND PUT THE HIGHEST RETURN CODE IN THE INTER-   @Z40LB30*/ 00700000
*         /* NAL CONDITION CODE AREA                         @Z40LB30*/ 00701000
*         /*                                                         */ 00702000
*         /***********************************************************/ 00703000
*                                                                  0438 00704000
*         IF TESTRC=LASTCC00 THEN   /*                       @Z40LB30*/ 00705000
         LTR   TESTRC,TESTRC                                       0438 00706000
         BNZ   @RF00438                                            0438 00707000
*           DO;                     /*                       @Z40LB30*/ 00708000
*             CALL PROCVOL;         /*                       @Z40LB30*/ 00709000
         BAL   @14,PROCVOL                                         0440 00710000
*             RESPECIFY                                            0441 00711000
*               RTNREG RSTD;                                       0441 00712000
*             TESTRC=RTNREG;                                       0442 00713000
         LR    TESTRC,RTNREG                                       0442 00714000
*             RESPECIFY                                            0443 00715000
*               RTNREG UNRSTD;      /*                       @Z40LB30*/ 00716000
*             CC01=MAX(CC01,TESTRC);/*                       @Z40LB30*/ 00717000
*                                                                  0444 00718000
         CR    CC01,TESTRC                                         0444 00719000
         BNL   *+6                                                      00720000
         LR    CC01,TESTRC                                         0444 00721000
*             /*******************************************************/ 00722000
*             /*                                                     */ 00723000
*             /* IF THE RETURN CODE INDICATES A VOLUME WAS   @Z40LB30*/ 00724000
*             /* PROCESSED, SET AN INDICATOR                 @Z40LB30*/ 00725000
*             /*                                                     */ 00726000
*             /*******************************************************/ 00727000
*                                                                  0445 00728000
*             IF TESTRC<LASTCC12 THEN/*                      @Z40LB30*/ 00729000
         C     TESTRC,@CF00035                                     0445 00730000
         BNL   @RF00445                                            0445 00731000
*               ONEDONE=ON;         /*                       @Z40LB30*/ 00732000
         OI    ONEDONE,B'10000000'                                 0446 00733000
*           END;                    /*                       @Z40LB30*/ 00734000
*       END;                        /*                       @Z40LB30*/ 00735000
*                                                                  0448 00736000
*     /***************************************************************/ 00737000
*     /*                                                             */ 00738000
*     /* IF THE READ WAS NOT SUCCESSFUL, ISSUE THE PROPER    @Z40LB30*/ 00739000
*     /* MESSAGES                                            @Z40LB30*/ 00740000
*     /*                                                             */ 00741000
*     /***************************************************************/ 00742000
*                                                                  0449 00743000
*     ELSE                          /*                       @Z40LB30*/ 00744000
*                                                                  0449 00745000
*       /*************************************************************/ 00746000
*       /*                                                           */ 00747000
*       /* IF THE REASON CODE INDICATES THE VOLUME IS NOT    @Z40LB30*/ 00748000
*       /* ACTIVE, PRINT MESSAGE IDC2074I, FOLLOWED BY       @Z40LB30*/ 00749000
*       /* MESSAGE IDC2108I. SET THE CONDITION CODE          @Z40LB30*/ 00750000
*       /*                                                           */ 00751000
*       /*************************************************************/ 00752000
*                                                                  0449 00753000
*       IF VVICODE=NOACTIVE THEN    /*                       @Z40LB30*/ 00754000
         B     @RC00431                                            0449 00755000
@RF00431 CLC   VVICODE(4),@CF01475                                 0449 00756000
         BNE   @RF00449                                            0449 00757000
*         DO;                       /*                       @Z40LB30*/ 00758000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 00759000
         XC    DARGAREA(28),DARGAREA                               0451 00760000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 00761000
         L     @08,DDSTRU                                          0452 00762000
         MVC   DARGSMOD(3,@08),@CC01418                            0452 00763000
*           DARGSENT=MSG2074I;      /*                       @Z40LB30*/ 00764000
         MVI   DARGSENT(@08),X'20'                                 0453 00765000
*           DARGDBP=ADDR(VOLVAL(INDEX));/*                   @Z40LB30*/ 00766000
         LH    @15,INDEX                                           0454 00767000
         SLA   @15,3                                               0454 00768000
         L     @14,@PC00001+4                                      0454 00769000
         L     @01,FDTPTR(,@14)                                    0454 00770000
         AL    @01,@CF01643                                        0454 00771000
         LA    @15,VOLVAL-3(@15,@01)                               0454 00772000
         ST    @15,DARGDBP(,@08)                                   0454 00773000
*           DARGILP=LENGTH(VOLVAL(INDEX));/*                 @Z40LB30*/ 00774000
         MVC   DARGILP(2,@08),@CH00158                             0455 00775000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 00776000
         L     @08,@PC00001                                        0456 00777000
         ST    @08,@AL00001                                        0456 00778000
         LA    @15,@CF00116                                        0456 00779000
         ST    @15,@AL00001+4                                      0456 00780000
         LA    @15,DDSTRU                                          0456 00781000
         ST    @15,@AL00001+8                                      0456 00782000
         MVI   @AL00001+8,X'80'                                    0456 00783000
         L     @15,GDTPRT(,@08)                                    0456 00784000
         LA    @01,@AL00001                                        0456 00785000
         BALR  @14,@15                                             0456 00786000
*           DARGSENT=MSG2108I;      /*                       @Z40LB30*/ 00787000
         L     @08,DDSTRU                                          0457 00788000
         MVI   DARGSENT(@08),X'40'                                 0457 00789000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 00790000
         L     @08,@PC00001                                        0458 00791000
         ST    @08,@AL00001                                        0458 00792000
         LA    @15,@CF00116                                        0458 00793000
         ST    @15,@AL00001+4                                      0458 00794000
         LA    @15,DDSTRU                                          0458 00795000
         ST    @15,@AL00001+8                                      0458 00796000
         MVI   @AL00001+8,X'80'                                    0458 00797000
         L     @15,GDTPRT(,@08)                                    0458 00798000
         LA    @01,@AL00001                                        0458 00799000
         BALR  @14,@15                                             0458 00800000
*           CC01=LASTCC12;          /*                       @Z40LB30*/ 00801000
         LA    CC01,12                                             0459 00802000
*         END;                      /*                       @Z40LB30*/ 00803000
*                                                                  0460 00804000
*     /***************************************************************/ 00805000
*     /*                                                             */ 00806000
*     /* IF ANOTHER ERROR OCCURRED, CALL SSCMSG TO PRINT     @Z40LB30*/ 00807000
*     /* THE REASON CODE. THEN ISSUE MESSAGE IDC2080I TO     @Z40LB30*/ 00808000
*     /* IDENTIFY THE VOLUME. SET THE CONDITION CODE         @Z40LB30*/ 00809000
*     /*                                                             */ 00810000
*     /***************************************************************/ 00811000
*                                                                  0461 00812000
*       ELSE                        /*                       @Z40LB30*/ 00813000
*         DO;                       /*                       @Z40LB30*/ 00814000
         B     @RC00449                                            0461 00815000
@RF00449 DS    0H                                                  0462 00816000
*           CALL SSCMSG(VVICODE);   /*                       @Z40LB30*/ 00817000
         LA    @08,VVICODE                                         0462 00818000
         ST    @08,@AL00001                                        0462 00819000
         LA    @01,@AL00001                                        0462 00820000
         BAL   @14,SSCMSG                                          0462 00821000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 00822000
         XC    DARGAREA(28),DARGAREA                               0463 00823000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 00824000
         L     @08,DDSTRU                                          0464 00825000
         MVC   DARGSMOD(3,@08),@CC01418                            0464 00826000
*           DARGSENT=MSG2080I;      /*                       @Z40LB30*/ 00827000
         MVI   DARGSENT(@08),X'1A'                                 0465 00828000
*           DARGDBP=ADDR(VOLVAL(INDEX));/*                   @Z40LB30*/ 00829000
         LH    @15,INDEX                                           0466 00830000
         SLA   @15,3                                               0466 00831000
         L     @14,@PC00001+4                                      0466 00832000
         L     @01,FDTPTR(,@14)                                    0466 00833000
         AL    @01,@CF01643                                        0466 00834000
         LA    @15,VOLVAL-3(@15,@01)                               0466 00835000
         ST    @15,DARGDBP(,@08)                                   0466 00836000
*           DARGILP=LENGTH(VOLVAL(INDEX));/*                 @Z40LB30*/ 00837000
         MVC   DARGILP(2,@08),@CH00158                             0467 00838000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 00839000
         L     @08,@PC00001                                        0468 00840000
         ST    @08,@AL00001                                        0468 00841000
         LA    @15,@CF00116                                        0468 00842000
         ST    @15,@AL00001+4                                      0468 00843000
         LA    @15,DDSTRU                                          0468 00844000
         ST    @15,@AL00001+8                                      0468 00845000
         MVI   @AL00001+8,X'80'                                    0468 00846000
         L     @15,GDTPRT(,@08)                                    0468 00847000
         LA    @01,@AL00001                                        0468 00848000
         BALR  @14,@15                                             0468 00849000
*           CC01=LASTCC12;          /*                       @Z40LB30*/ 00850000
         LA    CC01,12                                             0469 00851000
*         END;                      /*                       @Z40LB30*/ 00852000
*                                                                  0470 00853000
*     /***************************************************************/ 00854000
*     /*                                                             */ 00855000
*     /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE IN ORDER   @Z40LB30*/ 00856000
*     /* TO SPACE BETWEEN THE MESSAGES FOR EACH VOLUME       @Z40LB30*/ 00857000
*     /*                                                             */ 00858000
*     /***************************************************************/ 00859000
*                                                                  0471 00860000
*     DARGAREA=''B;                 /*                       @Z40LB30*/ 00861000
@RC00449 DS    0H                                                  0471 00862000
@RC00431 XC    DARGAREA(28),DARGAREA                               0471 00863000
*     DARGSMOD=SD01MSG;             /*                       @Z40LB30*/ 00864000
         L     @08,DDSTRU                                          0472 00865000
         MVC   DARGSMOD(3,@08),@CC01420                            0472 00866000
*     DARGSENT=BLANKS;              /*                       @Z40LB30*/ 00867000
         MVI   DARGSENT(@08),X'06'                                 0473 00868000
*     CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                @Z40LB30*/ 00869000
         L     @08,@PC00001                                        0474 00870000
         ST    @08,@AL00001                                        0474 00871000
         LA    @15,@CF00116                                        0474 00872000
         ST    @15,@AL00001+4                                      0474 00873000
         LA    @15,DDSTRU                                          0474 00874000
         ST    @15,@AL00001+8                                      0474 00875000
         MVI   @AL00001+8,X'80'                                    0474 00876000
         L     @15,GDTPRT(,@08)                                    0474 00877000
         LA    @01,@AL00001                                        0474 00878000
         BALR  @14,@15                                             0474 00879000
*   END;                            /*                       @Z40LB30*/ 00880000
         LA    @08,1                                               0475 00881000
         AH    @08,INDEX                                           0475 00882000
@DE00425 STH   @08,INDEX                                           0475 00883000
         L     @15,@PC00001+4                                      0475 00884000
         L     @01,FDTPTR(,@15)                                    0475 00885000
         CH    @08,VOLCNT(,@01)                                    0475 00886000
         BNH   @DL00425                                            0475 00887000
*                                                                  0476 00888000
*   /*****************************************************************/ 00889000
*   /*                                                               */ 00890000
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/ 00891000
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/ 00892000
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF SO, LOWER    @Z40LB30*/ 00893000
*   /* THE FINAL CONDITION CODE                              @Z40LB30*/ 00894000
*   /*                                                               */ 00895000
*   /*****************************************************************/ 00896000
*                                                                  0476 00897000
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/ 00898000
         C     CC01,@CF00035                                       0476 00899000
         BNE   @RF00476                                            0476 00900000
         TM    ONEDONE,B'10000000'                                 0476 00901000
         BNO   @RF00476                                            0476 00902000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 00903000
*                                                                  0477 00904000
         LA    CC01,8                                              0477 00905000
*   /*****************************************************************/ 00906000
*   /*                                                               */ 00907000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 00908000
*   /*                                                               */ 00909000
*   /*****************************************************************/ 00910000
*                                                                  0478 00911000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 00912000
@RF00476 LR    @15,CC01                                            0478 00913000
@EL00002 DS    0H                                                  0478 00914000
@EF00002 DS    0H                                                  0478 00915000
@ER00002 L     @14,@SA00002                                        0478 00916000
         BR    @14                                                 0478 00917000
*   END SPECVOL;                    /*                       @Z40LB30*/ 00918000
*                                                                  0480 00919000
*/********************************************************   @Z40LB30*/ 00920000
*/*                                                          @Z40LB30*/ 00921000
*/* PROCEDURE - SPECGRP                                      @Z40LB30*/ 00922000
*/*                                                          @Z40LB30*/ 00923000
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL    @Z40LB30*/ 00924000
*/*           TO READ THE INVENTORY RECORD FOR EACH GROUP    @Z40LB30*/ 00925000
*/*           SPECIFIED ON THE SCRDSET COMMAND.  THEN CALL   @Z40LB30*/ 00926000
*/*           A PROCEDURE TO READ THE RECORD FOR EACH ACTIVE @Z40LB30*/ 00927000
*/*           BASE VOLUME IN THE GROUP.  FOR EACH VOLUME,    @Z40LB30*/ 00928000
*/*           CALL PROCEDURES TO SEE IF THE VOLUME IS TO BE  @Z40LB30*/ 00929000
*/*           EXCLUDED OR HAS RECOVERY FLAGS ON IN THE       @Z40LB30*/ 00930000
*/*           RECORD AND TO PROCESS THE VOLUME.  ISSUE       @Z40LB30*/ 00931000
*/*           MESSAGE IDC2079I IF A GROUP RECORD CANNOT      @Z40LB30*/ 00932000
*/*           BE READ.  ISSUE MESSAGE IDC0817I IF ALL THE    @Z40LB30*/ 00933000
*/*           VOLUMES IN A GROUP WERE EXCLUDED.              @Z40LB30*/ 00934000
*/*                                                          @Z40LB30*/ 00935000
*/* INPUT - FUNCTION DATA TABLE                              @Z40LB30*/ 00936000
*/*                                                          @Z40LB30*/ 00937000
*/* OUTPUT - REGISTER 15 = 0, NO ERROR                       @Z40LB30*/ 00938000
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/ 00939000
*/*                           CLOSING VTOC                   @Z40LB30*/ 00940000
*/*                        8, ONE OR MORE DATA SETS OR       @Z40LB30*/ 00941000
*/*                           VOLUMES COULD NOT BE PROCESSED @Z40LB30*/ 00942000
*/*                           DUE TO ERROR                   @Z40LB30*/ 00943000
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/ 00944000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 00945000
*/*                                                          @Z40LB30*/ 00946000
*/********************************************************   @Z40LB30*/ 00947000
*                                                                  0480 00948000
*SPECGRP:                                                          0480 00949000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 00950000
SPECGRP  ST    @14,@SA00003                                        0480 00951000
*                                                                  0481 00952000
*   /*****************************************************************/ 00953000
*   /*                                                               */ 00954000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 00955000
*   /*                                                               */ 00956000
*   /*****************************************************************/ 00957000
*                                                                  0481 00958000
*   OLDERID2=NEWERID2;                                             0481 00959000
         L     @08,@PC00001                                        0481 00960000
         L     @08,GDTTR2(,@08)                                    0481 00961000
         MVC   @TS00001(95),NEWERID2(@08)                          0481 00962000
         MVC   OLDERID2(95,@08),@TS00001                           0481 00963000
*   NEWID2='SDSG';                  /*                       @Z40LB30*/ 00964000
*                                                                  0482 00965000
         MVC   NEWID2(4,@08),@CC01511                              0482 00966000
*   /*****************************************************************/ 00967000
*   /*                                                               */ 00968000
*   /* SET INTERNAL CONDITION CODE TO ZERO                   @Z40LB30*/ 00969000
*   /*                                                               */ 00970000
*   /*****************************************************************/ 00971000
*                                                                  0483 00972000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 00973000
*                                                                  0483 00974000
         SLR   CC01,CC01                                           0483 00975000
*   /*****************************************************************/ 00976000
*   /*                                                               */ 00977000
*   /* INITIALIZE THE IEZRVVI ARGUMENT LIST TO READ A        @Z40LB30*/ 00978000
*   /* SPECIFIC GROUP RECORD FROM THE INVENTORY              @Z40LB30*/ 00979000
*   /*                                                               */ 00980000
*   /*****************************************************************/ 00981000
*                                                                  0484 00982000
*   GRPRVVI=''B;                    /*                       @Z40LB30*/ 00983000
         XC    GRPRVVI(68),GRPRVVI                                 0484 00984000
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Z40LB30*/ 00985000
         LA    @08,GRPRVVI                                         0485 00986000
         ST    @08,RVVIPTR                                         0485 00987000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 00988000
         LH    @15,RVVLEN                                          0486 00989000
         ST    @15,RVVLNGTH(,@08)                                  0486 00990000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 00991000
         MVI   RVVCODE(@08),X'87'                                  0487 00992000
*   RVVBUFLN=LENGTH(GRPREC);        /*                       @Z40LB30*/ 00993000
         MVC   RVVBUFLN(2,@08),@CH01626                            0488 00994000
*   RVVRTBUF=ADDR(GRPREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 00995000
         LA    @15,GRPREC                                          0489 00996000
         ST    @15,RVVRTBUF(,@08)                                  0489 00997000
*   RVVRDR=ON;                      /* READ NEXT             @Z40LB30*/ 00998000
         OI    RVVRDR(@08),B'10000000'                             0490 00999000
*   RVVGRPRC=ON;                    /* READ GROUP RECORD     @Z40LB30*/ 01000000
         OI    RVVGRPRC(@08),B'01000000'                           0491 01001000
*   RVVSGRP=ON;                     /* GROUP NAME SPECIFIED  @Z40LB30*/ 01002000
         OI    RVVSGRP(@08),B'10000000'                            0492 01003000
*                                                                  0493 01004000
*   /*****************************************************************/ 01005000
*   /*                                                               */ 01006000
*   /* READ THE RECORD FOR EACH GROUP SPECIFIED ON THE       @Z40LB30*/ 01007000
*   /* SCRDSET COMMAND                                       @Z40LB30*/ 01008000
*   /*                                                               */ 01009000
*   /*****************************************************************/ 01010000
*                                                                  0493 01011000
*   DO INDEX=1 TO GRPCNT;           /*                       @Z40LB30*/ 01012000
*                                                                  0493 01013000
         LA    @08,1                                               0493 01014000
         B     @DE00493                                            0493 01015000
@DL00493 DS    0H                                                  0494 01016000
*     /***************************************************************/ 01017000
*     /*                                                             */ 01018000
*     /* INITIALIZE COUNTS OF HOW MANY VOLUMES HAVE          @Z40LB30*/ 01019000
*     /* BEEN READ FROM THE GROUP AND HOW MANY HAVE          @Z40LB30*/ 01020000
*     /* BEEN EXCLUDED. INITIALIZE TO OFF INDICATOR          @Z40LB30*/ 01021000
*     /* OF WHETHER LAST VOLUME PROCESSED WAS EXCLUDED.      @Z40LB30*/ 01022000
*     /*                                                             */ 01023000
*     /***************************************************************/ 01024000
*                                                                  0494 01025000
*     EXCLCNT=0;                    /*                       @Z40LB30*/ 01026000
         SLR   @02,@02                                             0494 01027000
         STH   @02,EXCLCNT                                         0494 01028000
*     VOLRDCNT=0;                   /*                       @Z40LB30*/ 01029000
         STH   @02,VOLRDCNT                                        0495 01030000
*     EXCVOL=OFF;                   /*                       @Z40LB30*/ 01031000
*                                                                  0496 01032000
         NI    EXCVOL,B'11101111'                                  0496 01033000
*     /***************************************************************/ 01034000
*     /*                                                             */ 01035000
*     /* RESET THE POINTER TO THE IEZRVVI PARAMETER LIST AND @Z40LB30*/ 01036000
*     /* SET THE GROUP NAME IN THE PARAMETER LIST            @Z40LB30*/ 01037000
*     /*                                                             */ 01038000
*     /***************************************************************/ 01039000
*                                                                  0497 01040000
*     RVVIPTR=ADDR(GRPRVVI);        /*                       @Z40LB30*/ 01041000
         LA    @02,GRPRVVI                                         0497 01042000
         ST    @02,RVVIPTR                                         0497 01043000
*     RVVGROUP=GRPVAL(INDEX);       /*                       @Z40LB30*/ 01044000
*                                                                  0498 01045000
         MH    @08,@CH00037                                        0498 01046000
         L     @15,@PC00001+4                                      0498 01047000
         L     @01,FDTPTR+4(,@15)                                  0498 01048000
         ALR   @01,@08                                             0498 01049000
         AL    @01,@CF01645                                        0498 01050000
         MVC   RVVGROUP(8,@02),GRPVAL-3(@01)                       0498 01051000
*     /***************************************************************/ 01052000
*     /*                                                             */ 01053000
*     /* ISSUE USSC MACRO TO READ A GROUP RECORD. SAVE THE   @Z40LB30*/ 01054000
*     /* RETURN CODE                                         @Z40LB30*/ 01055000
*     /*                                                             */ 01056000
*     /***************************************************************/ 01057000
*                                                                  0499 01058000
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/ 01059000
         L     @08,@PC00001                                        0499 01060000
         ST    @08,@AL00001                                        0499 01061000
         LA    @02,VVIC                                            0499 01062000
         ST    @02,@AL00001+4                                      0499 01063000
         LA    @02,RVVIPTR                                         0499 01064000
         ST    @02,@AL00001+8                                      0499 01065000
         LA    @02,VVICODE                                         0499 01066000
         ST    @02,@AL00001+12                                     0499 01067000
         MVI   @AL00001+12,X'80'                                   0499 01068000
         L     @15,GDTSSC(,@08)                                    0499 01069000
         LA    @01,@AL00001                                        0499 01070000
         BALR  @14,@15                                             0499 01071000
*     RESPECIFY                                                    0500 01072000
*       RTNREG RSTD;                                               0500 01073000
*     TESTRC=RTNREG;                                               0501 01074000
         LR    TESTRC,RTNREG                                       0501 01075000
*     RESPECIFY                                                    0502 01076000
*       RTNREG UNRSTD;              /*                       @Z40LB30*/ 01077000
*                                                                  0502 01078000
*     /***************************************************************/ 01079000
*     /*                                                             */ 01080000
*     /* IF THE GROUP RECORD WAS READ SUCCESSFULLY, CONTINUE @Z40LB30*/ 01081000
*     /*                                                             */ 01082000
*     /***************************************************************/ 01083000
*                                                                  0503 01084000
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/ 01085000
         SLR   @08,@08                                             0503 01086000
         CR    TESTRC,@08                                          0503 01087000
         BNE   @RF00503                                            0503 01088000
*       DO;                         /*                       @Z40LB30*/ 01089000
*                                                                  0504 01090000
*         /***********************************************************/ 01091000
*         /*                                                         */ 01092000
*         /* SET THE ADDRESS OF THE BASE VOLUME RECORD TO 0  @Z40LB30*/ 01093000
*         /* TO PASS TO RDGRPCHN                             @Z40LB30*/ 01094000
*         /*                                                         */ 01095000
*         /***********************************************************/ 01096000
*                                                                  0505 01097000
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/ 01098000
*                                                                  0505 01099000
         ST    @08,VOLPTR                                          0505 01100000
*         /***********************************************************/ 01101000
*         /*                                                         */ 01102000
*         /* READ EACH ACTIVE BASE VOLUME RECORD + PROCESS   @Z40LB30*/ 01103000
*         /* THE VOLUME UNTIL THERE ARE NO MORE VOLUME       @Z40LB30*/ 01104000
*         /* RECORDS OR A READ ERROR OCCURS                  @Z40LB30*/ 01105000
*         /*                                                         */ 01106000
*         /***********************************************************/ 01107000
*                                                                  0506 01108000
*         RDERROR=OFF;              /*                       @Z40LB30*/ 01109000
         NI    RDERROR,B'10111111'                                 0506 01110000
*         DO UNTIL VOLPTR=NULLPTR|RDERROR=ON;/*              @Z40LB30*/ 01111000
*                                                                  0507 01112000
@DL00507 DS    0H                                                  0508 01113000
*           /*********************************************************/ 01114000
*           /*                                                       */ 01115000
*           /* CALL RDGRPCHN TO READ A ACTIVE VOLUME RECORD. @Z40LB30*/ 01116000
*           /*                                                       */ 01117000
*           /*********************************************************/ 01118000
*                                                                  0508 01119000
*           CALL RDGRPCHN;          /*                       @Z40LB30*/ 01120000
         BAL   @14,RDGRPCHN                                        0508 01121000
*           RESPECIFY                                              0509 01122000
*             RTNREG RSTD;                                         0509 01123000
*           TESTRC=RTNREG;                                         0510 01124000
         LR    TESTRC,RTNREG                                       0510 01125000
*           RESPECIFY                                              0511 01126000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 01127000
*                                                                  0511 01128000
*           /*********************************************************/ 01129000
*           /*                                                       */ 01130000
*           /* IF THERE ARE NO READ ERRORS, CONTINUE TO SEE  @Z40LB30*/ 01131000
*           /* IF THERE IS A VOLUME TO PROCESS               @Z40LB30*/ 01132000
*           /*                                                       */ 01133000
*           /*********************************************************/ 01134000
*                                                                  0512 01135000
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/ 01136000
         SLR   @08,@08                                             0512 01137000
         CR    TESTRC,@08                                          0512 01138000
         BNE   @RF00512                                            0512 01139000
*             IF VOLPTR^=NULLPTR THEN/*                      @Z40LB30*/ 01140000
         C     @08,VOLPTR                                          0513 01141000
         BE    @RF00513                                            0513 01142000
*               DO;                 /*                       @Z40LB30*/ 01143000
*                                                                  0514 01144000
*                 /***************************************************/ 01145000
*                 /*                                                 */ 01146000
*                 /* INCREMENT THE COUNT OF THE NUMBER OF    @Z40LB30*/ 01147000
*                 /* VOLUMES READ.                           @Z40LB30*/ 01148000
*                 /*                                                 */ 01149000
*                 /***************************************************/ 01150000
*                                                                  0515 01151000
*                 VOLRDCNT=VOLRDCNT+1;/*                     @Z40LB30*/ 01152000
*                                                                  0515 01153000
         LA    @08,1                                               0515 01154000
         AH    @08,VOLRDCNT                                        0515 01155000
         STH   @08,VOLRDCNT                                        0515 01156000
*                 /***************************************************/ 01157000
*                 /*                                                 */ 01158000
*                 /* CALL CKRECEXC TO SEE IF THE VOLUME IS   @Z40LB30*/ 01159000
*                 /* TO BE EXCLUDED OR IF RECOVERY FLAGS     @Z40LB30*/ 01160000
*                 /* ARE ON IN THE RECORD. SAVE THE RETURN   @Z40LB30*/ 01161000
*                 /* CODE                                    @Z40LB30*/ 01162000
*                 /*                                                 */ 01163000
*                 /***************************************************/ 01164000
*                                                                  0516 01165000
*                 CALL CKRECEXC;    /*                       @Z40LB30*/ 01166000
         BAL   @14,CKRECEXC                                        0516 01167000
*                 RESPECIFY                                        0517 01168000
*                   RTNREG RSTD;                                   0517 01169000
*                 TESTRC=RTNREG;                                   0518 01170000
         LR    TESTRC,RTNREG                                       0518 01171000
*                 RESPECIFY                                        0519 01172000
*                   RTNREG UNRSTD;  /*                       @Z40LB30*/ 01173000
*                                                                  0519 01174000
*                 /***************************************************/ 01175000
*                 /*                                                 */ 01176000
*                 /* IF THE RETURN CODE INDICATES AN ERROR   @Z40LB30*/ 01177000
*                 /* (> 4), SET THE CONDITION CODE TO INDI-  @Z40LB30*/ 01178000
*                 /* CATE A VOLUME WAS NOT PROCESSED         @Z40LB30*/ 01179000
*                 /*                                                 */ 01180000
*                 /***************************************************/ 01181000
*                                                                  0520 01182000
*                 IF TESTRC>LASTCC04 THEN/*                  @Z40LB30*/ 01183000
         C     TESTRC,@CF00042                                     0520 01184000
         BNH   @RF00520                                            0520 01185000
*                   CC01=LASTCC12;  /*                       @Z40LB30*/ 01186000
*                                                                  0521 01187000
         LA    CC01,12                                             0521 01188000
*                 /***************************************************/ 01189000
*                 /*                                                 */ 01190000
*                 /* IF THE VOLUME CAN BE PROCESSED,         @Z40LB30*/ 01191000
*                 /* PROCESS IT.                             @Z40LB30*/ 01192000
*                 /*                                                 */ 01193000
*                 /***************************************************/ 01194000
*                                                                  0522 01195000
*                 ELSE              /*                       @Z40LB30*/ 01196000
*                   IF TESTRC=LASTCC00 THEN/*                @Z40LB30*/ 01197000
         B     @RC00520                                            0522 01198000
@RF00520 LTR   TESTRC,TESTRC                                       0522 01199000
         BNZ   @RF00522                                            0522 01200000
*                     DO;           /*                       @Z40LB30*/ 01201000
*                                                                  0523 01202000
*                       /*********************************************/ 01203000
*                       /*                                           */ 01204000
*                       /* CALL PROCVOL TO PROCESS THE       @Z40LB30*/ 01205000
*                       /* VOLUME. SAVE THE RETURN CODE.     @Z40LB30*/ 01206000
*                       /* SET THE RETURN CODE IN THE        @Z40LB30*/ 01207000
*                       /* INTERNAL CONDITION CODE AREA IF   @Z40LB30*/ 01208000
*                       /* IT IS HIGHER THAN CURRENT ONE     @Z40LB30*/ 01209000
*                       /*                                           */ 01210000
*                       /*********************************************/ 01211000
*                                                                  0524 01212000
*                       CALL PROCVOL;/*                      @Z40LB30*/ 01213000
         BAL   @14,PROCVOL                                         0524 01214000
*                       RESPECIFY                                  0525 01215000
*                         RTNREG RSTD;                             0525 01216000
*                       TESTRC=RTNREG;                             0526 01217000
         LR    TESTRC,RTNREG                                       0526 01218000
*                       RESPECIFY                                  0527 01219000
*                         RTNREG UNRSTD;/*                   @Z40LB30*/ 01220000
*                       CC01=MAX(CC01,TESTRC);/*             @Z40LB30*/ 01221000
*                                                                  0528 01222000
         CR    CC01,TESTRC                                         0528 01223000
         BNL   *+6                                                      01224000
         LR    CC01,TESTRC                                         0528 01225000
*                       /*********************************************/ 01226000
*                       /*                                           */ 01227000
*                       /* IF THE RETURN CODE INDICATES A    @Z40LB30*/ 01228000
*                       /* VOLUME WAS PROCESSED, SET         @Z40LB30*/ 01229000
*                       /* INDICATOR                         @Z40LB30*/ 01230000
*                       /*                                           */ 01231000
*                       /*********************************************/ 01232000
*                                                                  0529 01233000
*                       IF TESTRC<LASTCC12 THEN/*            @Z40LB30*/ 01234000
         C     TESTRC,@CF00035                                     0529 01235000
         BNL   @RF00529                                            0529 01236000
*                         ONEDONE=ON;/*                      @Z40LB30*/ 01237000
         OI    ONEDONE,B'10000000'                                 0530 01238000
*                     END;          /*                       @Z40LB30*/ 01239000
*                                                                  0531 01240000
*                 /***************************************************/ 01241000
*                 /*                                                 */ 01242000
*                 /* IF THE VOLUME WAS EXCLUDED, INCREMENT   @Z40LB30*/ 01243000
*                 /* THE COUNT OF EXCLUDED VOLUMES AND       @Z40LB30*/ 01244000
*                 /* ALSO SET AN INDICATOR.                  @Z40LB30*/ 01245000
*                 /*                                                 */ 01246000
*                 /***************************************************/ 01247000
*                                                                  0532 01248000
*                   ELSE            /*                       @Z40LB30*/ 01249000
*                     DO;           /*                       @Z40LB30*/ 01250000
         B     @RC00522                                            0532 01251000
@RF00522 DS    0H                                                  0533 01252000
*                       EXCLCNT=EXCLCNT+1;/*                 @Z40LB30*/ 01253000
         LA    @08,1                                               0533 01254000
         AH    @08,EXCLCNT                                         0533 01255000
         STH   @08,EXCLCNT                                         0533 01256000
*                       EXCVOL=ON;  /*                       @Z40LB30*/ 01257000
         OI    EXCVOL,B'00010000'                                  0534 01258000
*                     END;          /*                       @Z40LB30*/ 01259000
*               END;                /*                       @Z40LB30*/ 01260000
*                                                                  0536 01261000
*           /*********************************************************/ 01262000
*           /*                                                       */ 01263000
*           /* NOTHING TO DO IF NO MORE VOLUMES IN GROUP     @Z40LB30*/ 01264000
*           /*                                                       */ 01265000
*           /*********************************************************/ 01266000
*                                                                  0537 01267000
*             ELSE                                                 0537 01268000
*               ;                   /*                       @Z40LB30*/ 01269000
*                                                                  0537 01270000
@RF00513 DS    0H                                                  0538 01271000
*           /*********************************************************/ 01272000
*           /*                                                       */ 01273000
*           /* IF AN ERROR OCCURRED READING A VOLUME RECORD  @Z40LB30*/ 01274000
*           /* INDICATE THAT AND SET THE CONDITION CODE TO   @Z40LB30*/ 01275000
*           /* INDICATE A VOLUME COULD NOT BE PROCESSED.     @Z40LB30*/ 01276000
*           /*                                                       */ 01277000
*           /*********************************************************/ 01278000
*                                                                  0538 01279000
*           ELSE                    /*                       @Z40LB30*/ 01280000
*             DO;                   /*                       @Z40LB30*/ 01281000
         B     @RC00512                                            0538 01282000
@RF00512 DS    0H                                                  0539 01283000
*               RDERROR=ON;         /*                       @Z40LB30*/ 01284000
         OI    RDERROR,B'01000000'                                 0539 01285000
*               CC01=LASTCC12;      /*                       @Z40LB30*/ 01286000
         LA    CC01,12                                             0540 01287000
*             END;                  /*                       @Z40LB30*/ 01288000
*                                                                  0541 01289000
*           /*********************************************************/ 01290000
*           /*                                                       */ 01291000
*           /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE      @Z40LB30*/ 01292000
*           /* IN ORDER TO SPACE BETWEEN THE MESSAGES        @Z40LB30*/ 01293000
*           /* FOR EACH VOLUME                               @Z40LB30*/ 01294000
*           /*                                                       */ 01295000
*           /*********************************************************/ 01296000
*                                                                  0542 01297000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 01298000
@RC00512 XC    DARGAREA(28),DARGAREA                               0542 01299000
*           DARGSMOD=SD01MSG;       /*                       @Z40LB30*/ 01300000
         L     @08,DDSTRU                                          0543 01301000
         MVC   DARGSMOD(3,@08),@CC01420                            0543 01302000
*           DARGSENT=BLANKS;        /*                       @Z40LB30*/ 01303000
         MVI   DARGSENT(@08),X'06'                                 0544 01304000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 01305000
         L     @08,@PC00001                                        0545 01306000
         ST    @08,@AL00001                                        0545 01307000
         LA    @15,@CF00116                                        0545 01308000
         ST    @15,@AL00001+4                                      0545 01309000
         LA    @15,DDSTRU                                          0545 01310000
         ST    @15,@AL00001+8                                      0545 01311000
         MVI   @AL00001+8,X'80'                                    0545 01312000
         L     @15,GDTPRT(,@08)                                    0545 01313000
         LA    @01,@AL00001                                        0545 01314000
         BALR  @14,@15                                             0545 01315000
*         END;                      /*                       @Z40LB30*/ 01316000
@DE00507 L     @08,VOLPTR                                          0546 01317000
         LTR   @08,@08                                             0546 01318000
         BZ    @DC00507                                            0546 01319000
         TM    RDERROR,B'01000000'                                 0546 01320000
         BNO   @DL00507                                            0546 01321000
@DC00507 DS    0H                                                  0547 01322000
*       END;                        /*                       @Z40LB30*/ 01323000
*                                                                  0547 01324000
*     /***************************************************************/ 01325000
*     /*                                                             */ 01326000
*     /* IF AN ERROR OCCURRED READING A GROUP RECORD, CALL   @Z40LB30*/ 01327000
*     /* SSCMSG TO PRINT THE REASON CODE. THEN PRINT         @Z40LB30*/ 01328000
*     /* MESSAGE IDC2079I TO INDICATE THE GROUP NAME.        @Z40LB30*/ 01329000
*     /* THEN SET THE CONDITION CODE TO INDICATE A SEVERE    @Z40LB30*/ 01330000
*     /* ERROR                                               @Z40LB30*/ 01331000
*     /*                                                             */ 01332000
*     /***************************************************************/ 01333000
*                                                                  0548 01334000
*     ELSE                          /*                       @Z40LB30*/ 01335000
*       DO;                         /*                       @Z40LB30*/ 01336000
         B     @RC00503                                            0548 01337000
@RF00503 DS    0H                                                  0549 01338000
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/ 01339000
         LA    @08,VVICODE                                         0549 01340000
         ST    @08,@AL00001                                        0549 01341000
         LA    @01,@AL00001                                        0549 01342000
         BAL   @14,SSCMSG                                          0549 01343000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 01344000
         XC    DARGAREA(28),DARGAREA                               0550 01345000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 01346000
         L     @08,DDSTRU                                          0551 01347000
         MVC   DARGSMOD(3,@08),@CC01418                            0551 01348000
*         DARGSENT=MSG2079I;        /*                       @Z40LB30*/ 01349000
         MVI   DARGSENT(@08),X'1B'                                 0552 01350000
*         DARGDBP=ADDR(GRPVAL(INDEX));/*                     @Z40LB30*/ 01351000
         LH    @15,INDEX                                           0553 01352000
         MH    @15,@CH00037                                        0553 01353000
         L     @14,@PC00001+4                                      0553 01354000
         L     @01,FDTPTR+4(,@14)                                  0553 01355000
         AL    @01,@CF01645                                        0553 01356000
         LA    @15,GRPVAL-3(@15,@01)                               0553 01357000
         ST    @15,DARGDBP(,@08)                                   0553 01358000
*         DARGILP=LENGTH(GRPVAL(INDEX));/*                   @Z40LB30*/ 01359000
         MVC   DARGILP(2,@08),@CH00181                             0554 01360000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 01361000
         L     @08,@PC00001                                        0555 01362000
         ST    @08,@AL00001                                        0555 01363000
         LA    @15,@CF00116                                        0555 01364000
         ST    @15,@AL00001+4                                      0555 01365000
         LA    @15,DDSTRU                                          0555 01366000
         ST    @15,@AL00001+8                                      0555 01367000
         MVI   @AL00001+8,X'80'                                    0555 01368000
         L     @15,GDTPRT(,@08)                                    0555 01369000
         LA    @01,@AL00001                                        0555 01370000
         BALR  @14,@15                                             0555 01371000
*         CC01=LASTCC12;            /*                       @Z40LB30*/ 01372000
*                                                                  0556 01373000
         LA    CC01,12                                             0556 01374000
*         /***********************************************************/ 01375000
*         /*                                                         */ 01376000
*         /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE        @Z40LB30*/ 01377000
*         /* IN ORDER TO SPACE BETWEEN THE MESSAGES          @Z40LB30*/ 01378000
*         /* FOR EACH VOLUME. ISSUE UPRINT ONLY IF THE       @Z40LB30*/ 01379000
*         /* PREVIOUS VOLUME WAS NOT EXCLUDED SINCE          @Z40LB30*/ 01380000
*         /* NO MESSAGES WERE ISSUED IF THE VOLUME WAS       @Z40LB30*/ 01381000
*         /* EXCLUDED.                                       @Z40LB30*/ 01382000
*         /*                                                         */ 01383000
*         /***********************************************************/ 01384000
*                                                                  0557 01385000
*         IF EXCVOL=OFF THEN        /*                       @Z40LB30*/ 01386000
         TM    EXCVOL,B'00010000'                                  0557 01387000
         BNZ   @RF00557                                            0557 01388000
*           DO;                     /*                       @Z40LB30*/ 01389000
*             DARGAREA=''B;         /*                       @Z40LB30*/ 01390000
         XC    DARGAREA(28),DARGAREA                               0559 01391000
*             DARGSMOD=SD01MSG;     /*                       @Z40LB30*/ 01392000
         L     @08,DDSTRU                                          0560 01393000
         MVC   DARGSMOD(3,@08),@CC01420                            0560 01394000
*             DARGSENT=BLANKS;      /*                       @Z40LB30*/ 01395000
         MVI   DARGSENT(@08),X'06'                                 0561 01396000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB30*/ 01397000
         L     @08,@PC00001                                        0562 01398000
         ST    @08,@AL00001                                        0562 01399000
         LA    @15,@CF00116                                        0562 01400000
         ST    @15,@AL00001+4                                      0562 01401000
         LA    @15,DDSTRU                                          0562 01402000
         ST    @15,@AL00001+8                                      0562 01403000
         MVI   @AL00001+8,X'80'                                    0562 01404000
         L     @15,GDTPRT(,@08)                                    0562 01405000
         LA    @01,@AL00001                                        0562 01406000
         BALR  @14,@15                                             0562 01407000
*           END;                    /*                       @Z40LB30*/ 01408000
*       END;                        /*                       @Z40LB30*/ 01409000
*                                                                  0564 01410000
@RF00557 DS    0H                                                  0565 01411000
*     /***************************************************************/ 01412000
*     /*                                                             */ 01413000
*     /* DETERMINE IF ALL THE ACTIVE VOLUMES IN THE GROUP    @Z40LB30*/ 01414000
*     /* HAVE BEEN EXCLUDED. IF NO ERRORS HAVE OCCURRED,     @Z40LB30*/ 01415000
*     /* AND AT LEAST 1 VOL HAS BEEN READ, COMPARE THE COUNT @Z40LB30*/ 01416000
*     /* OF THE NUMBER OF VOLUMES READ IN THE GROUP TO THE   @Z40LB30*/ 01417000
*     /* NUMBER EXCLUDED. IF THE COUNTS MATCH, PRINT         @Z40LB30*/ 01418000
*     /* MESSAGE IDC0817I TO SAY ALL THE VOLUMES IN THE      @Z40LB30*/ 01419000
*     /* GROUP HAVE BEEN EXCLUDED AND SET AN INDICATOR.      @Z40LB30*/ 01420000
*     /*                                                             */ 01421000
*     /***************************************************************/ 01422000
*                                                                  0565 01423000
*     IF RDERROR=OFF&VOLRDCNT>0&VOLRDCNT=EXCLCNT/*           @Z40LB30*/ 01424000
*       THEN                        /*                       @Z40LB30*/ 01425000
@RC00503 TM    RDERROR,B'01000000'                                 0565 01426000
         BNZ   @RF00565                                            0565 01427000
         LH    @08,VOLRDCNT                                        0565 01428000
         LTR   @08,@08                                             0565 01429000
         BNP   @RF00565                                            0565 01430000
         CH    @08,EXCLCNT                                         0565 01431000
         BNE   @RF00565                                            0565 01432000
*       DO;                         /*                       @Z40LB30*/ 01433000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 01434000
         XC    DARGAREA(28),DARGAREA                               0567 01435000
*         DARGSMOD=SD01MSG;         /*                       @Z40LB30*/ 01436000
         L     @08,DDSTRU                                          0568 01437000
         MVC   DARGSMOD(3,@08),@CC01420                            0568 01438000
*         DARGSENT=MSG0817I;        /*                       @Z40LB30*/ 01439000
         MVI   DARGSENT(@08),X'09'                                 0569 01440000
*         DARGDBP=ADDR(GROVVGRP);   /*                       @Z40LB30*/ 01441000
         L     @01,GROUPPTR                                        0570 01442000
         LA    @15,GROVVGRP(,@01)                                  0570 01443000
         ST    @15,DARGDBP(,@08)                                   0570 01444000
*         DARGILP=LENGTH(GROVVGRP); /*                       @Z40LB30*/ 01445000
         MVC   DARGILP(2,@08),@CH00181                             0571 01446000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 01447000
         L     @08,@PC00001                                        0572 01448000
         ST    @08,@AL00001                                        0572 01449000
         LA    @15,@CF00116                                        0572 01450000
         ST    @15,@AL00001+4                                      0572 01451000
         LA    @15,DDSTRU                                          0572 01452000
         ST    @15,@AL00001+8                                      0572 01453000
         MVI   @AL00001+8,X'80'                                    0572 01454000
         L     @15,GDTPRT(,@08)                                    0572 01455000
         LA    @01,@AL00001                                        0572 01456000
         BALR  @14,@15                                             0572 01457000
*         EMPTYGRP=ON;              /*                       @Z40LB30*/ 01458000
         OI    EMPTYGRP,B'00001000'                                0573 01459000
*       END;                        /*                       @Z40LB30*/ 01460000
*   END;                            /*                       @Z40LB30*/ 01461000
@RF00565 LA    @08,1                                               0575 01462000
         AH    @08,INDEX                                           0575 01463000
@DE00493 STH   @08,INDEX                                           0575 01464000
         L     @15,@PC00001+4                                      0575 01465000
         L     @01,FDTPTR+4(,@15)                                  0575 01466000
         CH    @08,GRPCNT(,@01)                                    0575 01467000
         BNH   @DL00493                                            0575 01468000
*                                                                  0576 01469000
*   /*****************************************************************/ 01470000
*   /*                                                               */ 01471000
*   /* IF THE CONDITION CODE INDICATES A SEVERE ERROR THAT   @Z40LB30*/ 01472000
*   /* PREVENTED A VOLUME FROM BEING PROCESSED, CHECK IF     @Z40LB30*/ 01473000
*   /* AT LEAST ONE VOLUME WAS PROCESSED OR IF AT            @Z40LB30*/ 01474000
*   /* LEAST ONE EMPTY GROUP WAS PROCESSED. IF SO,           @Z40LB30*/ 01475000
*   /* LOWER THE FINAL CONDITION CODE.                       @Z40LB30*/ 01476000
*   /*                                                               */ 01477000
*   /*****************************************************************/ 01478000
*                                                                  0576 01479000
*   IF CC01=LASTCC12&(ONEDONE=ON|EMPTYGRP=ON) THEN/*         @Z40LB30*/ 01480000
         C     CC01,@CF00035                                       0576 01481000
         BNE   @RF00576                                            0576 01482000
         TM    ONEDONE,B'10001000'                                 0576 01483000
         BZ    @RF00576                                            0576 01484000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 01485000
*                                                                  0577 01486000
         LA    CC01,8                                              0577 01487000
*   /*****************************************************************/ 01488000
*   /*                                                               */ 01489000
*   /* RETURN TO THE CALLER                                  @Z40LB30*/ 01490000
*   /*                                                               */ 01491000
*   /*****************************************************************/ 01492000
*                                                                  0578 01493000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 01494000
@RF00576 LR    @15,CC01                                            0578 01495000
@EL00003 DS    0H                                                  0578 01496000
@EF00003 DS    0H                                                  0578 01497000
@ER00003 L     @14,@SA00003                                        0578 01498000
         BR    @14                                                 0578 01499000
*   END SPECGRP;                    /*                       @Z40LB30*/ 01500000
*                                                                  0580 01501000
*/********************************************************   @Z40LB30*/ 01502000
*/*                                                          @Z40LB30*/ 01503000
*/* PROCEDURE - NONGRPD                                      @Z40LB30*/ 01504000
*/*                                                          @Z40LB30*/ 01505000
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL TO @Z40LB30*/ 01506000
*/*           READ EACH ACTIVE NON-GROUPED VOLUME RECORD.    @Z40LB30*/ 01507000
*/*           FOR EACH ACTIVE NON-GROUPED VOLUME, CALL A     @Z40LB30*/ 01508000
*/*           PROCEDURE TO SEE IF THE VOLUME IS EXCLUDED OR  @Z40LB30*/ 01509000
*/*           IF THE RECORD HAS ANY RECOVERY FLAGS ON. CALL  @Z40LB30*/ 01510000
*/*           ANOTHER PROCEDURE TO PROCESS THE VOLUME.       @Z40LB30*/ 01511000
*/*           ISSUE MESSAGE IDC0102I IF THERE ARE NO         @Z40LB30*/ 01512000
*/*           ACTIVE NON-GROUPED VOLUMES.  ISSUE MESSAGE     @Z40LB30*/ 01513000
*/*           IDC2103I IF THE NON-GROUPED RECORD CHAIN IS    @Z40LB30*/ 01514000
*/*           BROKEN.  ISSUE MESSAGE IDC2109I IF AN ERROR    @Z40LB30*/ 01515000
*/*           OCCURS READING AND NO MORE VOLUMES CAN BE      @Z40LB30*/ 01516000
*/*           PROCESSED.                                     @Z40LB30*/ 01517000
*/*                                                          @Z40LB30*/ 01518000
*/* INPUT - NONE                                             @Z40LB30*/ 01519000
*/*                                                          @Z40LB30*/ 01520000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/ 01521000
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/ 01522000
*/*                           CLOSING VTOC                   @Z40LB30*/ 01523000
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/ 01524000
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/ 01525000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 01526000
*/*                       12, NO VOLUMES COULD BE PROCESSED  @Z40LB30*/ 01527000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 01528000
*/*                                                          @Z40LB30*/ 01529000
*/*********************************************************  @Z40LB30*/ 01530000
*                                                                  0580 01531000
*NONGRPD:                                                          0580 01532000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 01533000
NONGRPD  ST    @14,@SA00004                                        0580 01534000
*                                                                  0581 01535000
*   /*****************************************************************/ 01536000
*   /*                                                               */ 01537000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 01538000
*   /*                                                               */ 01539000
*   /*****************************************************************/ 01540000
*                                                                  0581 01541000
*   OLDERID2=NEWERID2;                                             0581 01542000
         L     @08,@PC00001                                        0581 01543000
         L     @02,GDTTR2(,@08)                                    0581 01544000
         MVC   @TS00001(95),NEWERID2(@02)                          0581 01545000
         MVC   OLDERID2(95,@02),@TS00001                           0581 01546000
*   NEWID2='SDNG';                  /*                       @Z40LB30*/ 01547000
*                                                                  0582 01548000
         MVC   NEWID2(4,@02),@CC01516                              0582 01549000
*   /*****************************************************************/ 01550000
*   /*                                                               */ 01551000
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/ 01552000
*   /*                                                               */ 01553000
*   /*****************************************************************/ 01554000
*                                                                  0583 01555000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 01556000
*                                                                  0583 01557000
         SLR   CC01,CC01                                           0583 01558000
*   /*****************************************************************/ 01559000
*   /*                                                               */ 01560000
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ THE ACTIVE   @Z40LB30*/ 01561000
*   /* NON-GROUPED VOLUME RECORDS                            @Z40LB30*/ 01562000
*   /*                                                               */ 01563000
*   /*****************************************************************/ 01564000
*                                                                  0584 01565000
*   VOLRVVI=''B;                    /*                       @Z40LB30*/ 01566000
         XC    VOLRVVI(68),VOLRVVI                                 0584 01567000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/ 01568000
         LA    @02,VOLRVVI                                         0585 01569000
         ST    @02,RVVIPTR                                         0585 01570000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 01571000
         LH    @15,RVVLEN                                          0586 01572000
         ST    @15,RVVLNGTH(,@02)                                  0586 01573000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 01574000
         MVI   RVVCODE(@02),X'87'                                  0587 01575000
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/ 01576000
         MVC   RVVBUFLN(2,@02),@CH01625                            0588 01577000
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 01578000
         LA    @15,VOLREC                                          0589 01579000
         ST    @15,RVVRTBUF(,@02)                                  0589 01580000
*   RVVRDCH=ON;                     /* READ CHAIN            @Z40LB30*/ 01581000
         OI    RVVRDCH(@02),B'00100000'                            0590 01582000
*   RVVBVRCD=ON;                    /* BASE VOLUME RECORDS   @Z40LB30*/ 01583000
         OI    RVVBVRCD(@02),B'10000000'                           0591 01584000
*   RVVACTV=ON;                     /* ACTIVE VOLUMES ONLY   @Z40LB30*/ 01585000
         OI    RVVACTV(@02),B'00000100'                            0592 01586000
*   RVVNGVOL=ON;                    /* NON-GROUPED CHAIN     @Z40LB30*/ 01587000
*                                                                  0593 01588000
         OI    RVVNGVOL(@02),B'01000000'                           0593 01589000
*   /*****************************************************************/ 01590000
*   /*                                                               */ 01591000
*   /* ISSUE USSC MACRO TO READ FIRST ACTIVE NON-GROUPED     @Z40LB30*/ 01592000
*   /* VOLUME. SAVE THE RETURN CODE.                         @Z40LB30*/ 01593000
*   /*                                                               */ 01594000
*   /*****************************************************************/ 01595000
*                                                                  0594 01596000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*            @Z40LB30*/ 01597000
         ST    @08,@AL00001                                        0594 01598000
         LA    @02,VVIC                                            0594 01599000
         ST    @02,@AL00001+4                                      0594 01600000
         LA    @02,RVVIPTR                                         0594 01601000
         ST    @02,@AL00001+8                                      0594 01602000
         LA    @02,VVICODE                                         0594 01603000
         ST    @02,@AL00001+12                                     0594 01604000
         MVI   @AL00001+12,X'80'                                   0594 01605000
         L     @15,GDTSSC(,@08)                                    0594 01606000
         LA    @01,@AL00001                                        0594 01607000
         BALR  @14,@15                                             0594 01608000
*   RESPECIFY                                                      0595 01609000
*     RTNREG RSTD;                                                 0595 01610000
*   TESTRC=RTNREG;                                                 0596 01611000
         LR    TESTRC,RTNREG                                       0596 01612000
*   RESPECIFY                                                      0597 01613000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 01614000
*                                                                  0597 01615000
*   /*****************************************************************/ 01616000
*   /*                                                               */ 01617000
*   /* IF THERE ARE NO NON-GROUPED VOLUMES OR NO ACTIVE NON- @Z40LB30*/ 01618000
*   /* GROUPED VOLUMES, ISSUE MESSAGE IDC0102I.              @Z40LB30*/ 01619000
*   /*                                                               */ 01620000
*   /*****************************************************************/ 01621000
*                                                                  0598 01622000
*   IF TESTRC^=0 THEN               /*                       @Z40LB30*/ 01623000
         LTR   TESTRC,TESTRC                                       0598 01624000
         BZ    @RF00598                                            0598 01625000
*     IF VVICODE=NORECORD|VVICODE=NOACTIVE THEN/*            @Z40LB30*/ 01626000
         L     @08,VVICODE                                         0599 01627000
         C     @08,@CF01473                                        0599 01628000
         BE    @RT00599                                            0599 01629000
         C     @08,@CF01475                                        0599 01630000
         BNE   @RF00599                                            0599 01631000
@RT00599 DS    0H                                                  0600 01632000
*       DO;                         /*                       @Z40LB30*/ 01633000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 01634000
         XC    DARGAREA(28),DARGAREA                               0601 01635000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 01636000
         L     @08,DDSTRU                                          0602 01637000
         MVC   DARGSMOD(3,@08),@CC01418                            0602 01638000
*         DARGSENT=MSG0102I;        /*                       @Z40LB30*/ 01639000
         MVI   DARGSENT(@08),X'3A'                                 0603 01640000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 01641000
         L     @08,@PC00001                                        0604 01642000
         ST    @08,@AL00001                                        0604 01643000
         LA    @05,@CF00116                                        0604 01644000
         ST    @05,@AL00001+4                                      0604 01645000
         LA    @05,DDSTRU                                          0604 01646000
         ST    @05,@AL00001+8                                      0604 01647000
         MVI   @AL00001+8,X'80'                                    0604 01648000
         L     @15,GDTPRT(,@08)                                    0604 01649000
         LA    @01,@AL00001                                        0604 01650000
         BALR  @14,@15                                             0604 01651000
*       END;                        /*                       @Z40LB30*/ 01652000
*                                                                  0605 01653000
*   /*****************************************************************/ 01654000
*   /*                                                               */ 01655000
*   /* IF AN ERROR OCCURRED, CALL SSCMSG TO PRINT THE        @Z40LB30*/ 01656000
*   /* REASON CODE AND SET AN INDICATOR.                     @Z40LB30*/ 01657000
*   /*                                                               */ 01658000
*   /*****************************************************************/ 01659000
*                                                                  0606 01660000
*     ELSE                          /*                       @Z40LB30*/ 01661000
*       DO;                         /*                       @Z40LB30*/ 01662000
         B     @RC00599                                            0606 01663000
@RF00599 DS    0H                                                  0607 01664000
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/ 01665000
         LA    @08,VVICODE                                         0607 01666000
         ST    @08,@AL00001                                        0607 01667000
         LA    @01,@AL00001                                        0607 01668000
         BAL   @14,SSCMSG                                          0607 01669000
*         RDERROR=ON;               /*                       @Z40LB30*/ 01670000
         OI    RDERROR,B'01000000'                                 0608 01671000
*       END;                        /*                       @Z40LB30*/ 01672000
*                                                                  0610 01673000
*   /*****************************************************************/ 01674000
*   /*                                                               */ 01675000
*   /* IF A RECORD WAS RETURNED, PROCESS AND READ ALL THE    @Z40LB30*/ 01676000
*   /* ACTIVE NON-GROUPED VOLUMES UNTIL A READ ERROR OCCURS  @Z40LB30*/ 01677000
*   /* OR END OF FILE.                                       @Z40LB30*/ 01678000
*   /*                                                               */ 01679000
*   /*****************************************************************/ 01680000
*                                                                  0610 01681000
*   ELSE                            /*                       @Z40LB30*/ 01682000
*     DO WHILE RDERROR=OFF&EOFILE=OFF;/*                     @Z40LB30*/ 01683000
*                                                                  0610 01684000
         B     @RC00598                                            0610 01685000
@RF00598 B     @DE00610                                            0610 01686000
@DL00610 DS    0H                                                  0611 01687000
*       /*************************************************************/ 01688000
*       /*                                                           */ 01689000
*       /* CALL CKRECEXC TO SEE IF THE VOLUME WAS EXCLUDED   @Z40LB30*/ 01690000
*       /* OR IF RECOVERY FLAGS ARE ON. SAVE THE RETURN      @Z40LB30*/ 01691000
*       /* CODE.                                             @Z40LB30*/ 01692000
*       /*                                                           */ 01693000
*       /*************************************************************/ 01694000
*                                                                  0611 01695000
*       CALL CKRECEXC;              /*                       @Z40LB30*/ 01696000
         BAL   @14,CKRECEXC                                        0611 01697000
*       RESPECIFY                                                  0612 01698000
*         RTNREG RSTD;                                             0612 01699000
*       TESTRC=RTNREG;                                             0613 01700000
         LR    TESTRC,RTNREG                                       0613 01701000
*       RESPECIFY                                                  0614 01702000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 01703000
*                                                                  0614 01704000
*       /*************************************************************/ 01705000
*       /*                                                           */ 01706000
*       /* IF AN ERROR OCCURRED, SET THE CONDITION CODE      @Z40LB30*/ 01707000
*       /*                                                           */ 01708000
*       /*************************************************************/ 01709000
*                                                                  0615 01710000
*       IF TESTRC>LASTCC04 THEN     /*                       @Z40LB30*/ 01711000
         C     TESTRC,@CF00042                                     0615 01712000
         BNH   @RF00615                                            0615 01713000
*         CC01=LASTCC12;            /*                       @Z40LB30*/ 01714000
*                                                                  0616 01715000
         LA    CC01,12                                             0616 01716000
*       /*************************************************************/ 01717000
*       /*                                                           */ 01718000
*       /* IF THE RECORD CAN BE PROCESSED CALL PROCVOL TO    @Z40LB30*/ 01719000
*       /* PROCESS THE VOLUME. SAVE THE RETURN CODE.         @Z40LB30*/ 01720000
*       /*                                                           */ 01721000
*       /*************************************************************/ 01722000
*                                                                  0617 01723000
*       IF TESTRC=LASTCC00 THEN     /*                       @Z40LB30*/ 01724000
@RF00615 LTR   TESTRC,TESTRC                                       0617 01725000
         BNZ   @RF00617                                            0617 01726000
*         DO;                       /*                       @Z40LB30*/ 01727000
*           CALL PROCVOL;           /*                       @Z40LB30*/ 01728000
         BAL   @14,PROCVOL                                         0619 01729000
*           RESPECIFY                                              0620 01730000
*             RTNREG RSTD;                                         0620 01731000
*           TESTRC=RTNREG;                                         0621 01732000
         LR    TESTRC,RTNREG                                       0621 01733000
*           RESPECIFY                                              0622 01734000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 01735000
*                                                                  0622 01736000
*           /*********************************************************/ 01737000
*           /*                                                       */ 01738000
*           /* SET THE CONDITION CODE TO THE HIGHEST VALUE   @Z40LB30*/ 01739000
*           /*                                                       */ 01740000
*           /*********************************************************/ 01741000
*                                                                  0623 01742000
*           CC01=MAX(CC01,TESTRC);  /*                       @Z40LB30*/ 01743000
*                                                                  0623 01744000
         CR    CC01,TESTRC                                         0623 01745000
         BNL   *+6                                                      01746000
         LR    CC01,TESTRC                                         0623 01747000
*           /*********************************************************/ 01748000
*           /*                                                       */ 01749000
*           /* IF THE RETURN CODE INDICATES A VOLUME WAS     @Z40LB30*/ 01750000
*           /* PROCESSED, SET AN INDICATOR.                  @Z40LB30*/ 01751000
*           /*                                                       */ 01752000
*           /*********************************************************/ 01753000
*                                                                  0624 01754000
*           IF TESTRC<LASTCC12 THEN /*                       @Z40LB30*/ 01755000
         C     TESTRC,@CF00035                                     0624 01756000
         BNL   @RF00624                                            0624 01757000
*             ONEDONE=ON;           /*                       @Z40LB30*/ 01758000
         OI    ONEDONE,B'10000000'                                 0625 01759000
*         END;                      /*                       @Z40LB30*/ 01760000
*                                                                  0626 01761000
@RF00624 DS    0H                                                  0627 01762000
*       /*************************************************************/ 01763000
*       /*                                                           */ 01764000
*       /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE IN ORDER @Z40LB30*/ 01765000
*       /* TO SPACE BETWEEN THE MESSAGES FOR EACH VOLUME     @Z40LB30*/ 01766000
*       /*                                                           */ 01767000
*       /*************************************************************/ 01768000
*                                                                  0627 01769000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 01770000
@RF00617 XC    DARGAREA(28),DARGAREA                               0627 01771000
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/ 01772000
         L     @08,DDSTRU                                          0628 01773000
         MVC   DARGSMOD(3,@08),@CC01420                            0628 01774000
*       DARGSENT=BLANKS;            /*                       @Z40LB30*/ 01775000
         MVI   DARGSENT(@08),X'06'                                 0629 01776000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 01777000
*                                                                  0630 01778000
         L     @08,@PC00001                                        0630 01779000
         ST    @08,@AL00001                                        0630 01780000
         LA    @15,@CF00116                                        0630 01781000
         ST    @15,@AL00001+4                                      0630 01782000
         LA    @15,DDSTRU                                          0630 01783000
         ST    @15,@AL00001+8                                      0630 01784000
         MVI   @AL00001+8,X'80'                                    0630 01785000
         L     @15,GDTPRT(,@08)                                    0630 01786000
         LA    @01,@AL00001                                        0630 01787000
         BALR  @14,@15                                             0630 01788000
*       /*************************************************************/ 01789000
*       /*                                                           */ 01790000
*       /* IF THE CURRENT RECORD WAS NOT THE LAST, ISSUE     @Z40LB30*/ 01791000
*       /* USSC TO READ THE NEXT RECORD. FIRST SET THE       @Z40LB30*/ 01792000
*       /* NEW VOLUME SERIAL IN THE IEZRVVI ARGUMENT LIST.   @Z40LB30*/ 01793000
*       /*                                                           */ 01794000
*       /*************************************************************/ 01795000
*                                                                  0631 01796000
*       IF BASLAST^=ON THEN         /*                       @Z40LB30*/ 01797000
         TM    BASLAST(BASEVPTR),B'00001000'                       0631 01798000
         BO    @RF00631                                            0631 01799000
*         DO;                       /*                       @Z40LB30*/ 01800000
*           RVVSVOL=ON;             /*                       @Z40LB30*/ 01801000
         L     @08,RVVIPTR                                         0633 01802000
         OI    RVVSVOL(@08),B'00000001'                            0633 01803000
*           RVVOLUME=BASNEXTV;      /*                       @Z40LB30*/ 01804000
         MVC   RVVOLUME(6,@08),BASNEXTV(BASEVPTR)                  0634 01805000
*           CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*    @Z40LB30*/ 01806000
         L     @08,@PC00001                                        0635 01807000
         ST    @08,@AL00001                                        0635 01808000
         LA    @02,VVIC                                            0635 01809000
         ST    @02,@AL00001+4                                      0635 01810000
         LA    @02,RVVIPTR                                         0635 01811000
         ST    @02,@AL00001+8                                      0635 01812000
         LA    @02,VVICODE                                         0635 01813000
         ST    @02,@AL00001+12                                     0635 01814000
         MVI   @AL00001+12,X'80'                                   0635 01815000
         L     @15,GDTSSC(,@08)                                    0635 01816000
         LA    @01,@AL00001                                        0635 01817000
         BALR  @14,@15                                             0635 01818000
*           RESPECIFY                                              0636 01819000
*             RTNREG RSTD;                                         0636 01820000
*           TESTRC=RTNREG;                                         0637 01821000
         LR    TESTRC,RTNREG                                       0637 01822000
*           RESPECIFY                                              0638 01823000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 01824000
*                                                                  0638 01825000
*           /*********************************************************/ 01826000
*           /*                                                       */ 01827000
*           /* IF NO ACTIVE VOLUMES LEFT, SET END OF FILE    @Z40LB30*/ 01828000
*           /*                                                       */ 01829000
*           /*********************************************************/ 01830000
*                                                                  0639 01831000
*           IF TESTRC^=0 THEN       /*                       @Z40LB30*/ 01832000
         LTR   TESTRC,TESTRC                                       0639 01833000
         BZ    @RF00639                                            0639 01834000
*             IF VVICODE=NOACTIVE THEN/*                     @Z40LB30*/ 01835000
         CLC   VVICODE(4),@CF01475                                 0640 01836000
         BNE   @RF00640                                            0640 01837000
*               EOFILE=ON;          /*                       @Z40LB30*/ 01838000
*                                                                  0641 01839000
         OI    EOFILE,B'00100000'                                  0641 01840000
*           /*********************************************************/ 01841000
*           /*                                                       */ 01842000
*           /* IF THE NEXT VOLUME IN THE CHAIN COULD NOT     @Z40LB30*/ 01843000
*           /* BE FOUND OR IF IT WAS FOUND TO BE A GROUPED   @Z40LB30*/ 01844000
*           /* VOLUME, ISSUE MESSAGE IDC2103I.               @Z40LB30*/ 01845000
*           /*                                                       */ 01846000
*           /*********************************************************/ 01847000
*                                                                  0642 01848000
*             ELSE                  /*                       @Z40LB30*/ 01849000
*               IF VVICODE=NORECORD|VVICODE=WRONGCHN/*       @Z40LB30*/ 01850000
*                 THEN              /*                       @Z40LB30*/ 01851000
         B     @RC00640                                            0642 01852000
@RF00640 L     @08,VVICODE                                         0642 01853000
         C     @08,@CF01473                                        0642 01854000
         BE    @RT00642                                            0642 01855000
         C     @08,@CF01477                                        0642 01856000
         BNE   @RF00642                                            0642 01857000
@RT00642 DS    0H                                                  0643 01858000
*                 DO;               /*                       @Z40LB30*/ 01859000
*                   RDERROR=ON;     /*                       @Z40LB30*/ 01860000
         OI    RDERROR,B'01000000'                                 0644 01861000
*                   DARGAREA=''B;   /*                       @Z40LB30*/ 01862000
         XC    DARGAREA(28),DARGAREA                               0645 01863000
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/ 01864000
         L     @08,DDSTRU                                          0646 01865000
         MVC   DARGSMOD(3,@08),@CC01418                            0646 01866000
*                   DARGSENT=MSG2103I;/*                     @Z40LB30*/ 01867000
         MVI   DARGSENT(@08),X'3B'                                 0647 01868000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/ 01869000
         L     @08,@PC00001                                        0648 01870000
         ST    @08,@AL00001                                        0648 01871000
         LA    @15,@CF00116                                        0648 01872000
         ST    @15,@AL00001+4                                      0648 01873000
         LA    @15,DDSTRU                                          0648 01874000
         ST    @15,@AL00001+8                                      0648 01875000
         MVI   @AL00001+8,X'80'                                    0648 01876000
         L     @15,GDTPRT(,@08)                                    0648 01877000
         LA    @01,@AL00001                                        0648 01878000
         BALR  @14,@15                                             0648 01879000
*                 END;              /*                       @Z40LB30*/ 01880000
*                                                                  0649 01881000
*           /*********************************************************/ 01882000
*           /*                                                       */ 01883000
*           /* IF ANOTHER ERROR OCCURRED, CALL SSCMSG        @Z40LB30*/ 01884000
*           /* TO PRINT THE REASON CODE                      @Z40LB30*/ 01885000
*           /*                                                       */ 01886000
*           /*********************************************************/ 01887000
*                                                                  0650 01888000
*               ELSE                /*                       @Z40LB30*/ 01889000
*                 DO;               /*                       @Z40LB30*/ 01890000
         B     @RC00642                                            0650 01891000
@RF00642 DS    0H                                                  0651 01892000
*                   RDERROR=ON;     /*                       @Z40LB30*/ 01893000
         OI    RDERROR,B'01000000'                                 0651 01894000
*                   CALL SSCMSG(VVICODE);/*                  @Z40LB30*/ 01895000
         LA    @08,VVICODE                                         0652 01896000
         ST    @08,@AL00001                                        0652 01897000
         LA    @01,@AL00001                                        0652 01898000
         BAL   @14,SSCMSG                                          0652 01899000
*                 END;              /*                       @Z40LB30*/ 01900000
*                                                                  0653 01901000
*           /*********************************************************/ 01902000
*           /*                                                       */ 01903000
*           /* IF NO ERRORS OCCURRED, NOTHING TO DO          @Z40LB30*/ 01904000
*           /*                                                       */ 01905000
*           /*********************************************************/ 01906000
*                                                                  0654 01907000
*           ELSE                                                   0654 01908000
*             ;                     /*                       @Z40LB30*/ 01909000
@RF00639 DS    0H                                                  0655 01910000
*         END;                      /*                       @Z40LB30*/ 01911000
*                                                                  0655 01912000
*       /*************************************************************/ 01913000
*       /*                                                           */ 01914000
*       /* IF THE CURRENT RECORD IS THE LAST, SET THE        @Z40LB30*/ 01915000
*       /* END-OF-FILE INDICATOR.                            @Z40LB30*/ 01916000
*       /*                                                           */ 01917000
*       /*************************************************************/ 01918000
*                                                                  0656 01919000
*       ELSE                        /*                       @Z40LB30*/ 01920000
*         EOFILE=ON;                /*                       @Z40LB30*/ 01921000
         B     @RC00631                                            0656 01922000
@RF00631 OI    EOFILE,B'00100000'                                  0656 01923000
*     END;                          /*                       @Z40LB30*/ 01924000
@RC00631 DS    0H                                                  0657 01925000
@DE00610 TM    RDERROR,B'01100000'                                 0657 01926000
         BZ    @DL00610                                            0657 01927000
*                                                                  0658 01928000
*   /*****************************************************************/ 01929000
*   /*                                                               */ 01930000
*   /* IF A READ ERROR OCCURRED, SET THE CONDITION CODE      @Z40LB30*/ 01931000
*   /* AND ISSUE SECONDARY MESSAGE IDC2109I TO SAY NO MORE   @Z40LB30*/ 01932000
*   /* VOLUMES CAN BE PROCESSED.                             @Z40LB30*/ 01933000
*   /*                                                               */ 01934000
*   /*****************************************************************/ 01935000
*                                                                  0658 01936000
*   IF RDERROR=ON THEN              /*                       @Z40LB30*/ 01937000
@RC00598 TM    RDERROR,B'01000000'                                 0658 01938000
         BNO   @RF00658                                            0658 01939000
*     DO;                           /*                       @Z40LB30*/ 01940000
*       CC01=LASTCC12;              /*                       @Z40LB30*/ 01941000
         LA    CC01,12                                             0660 01942000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 01943000
         XC    DARGAREA(28),DARGAREA                               0661 01944000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/ 01945000
         L     @08,DDSTRU                                          0662 01946000
         MVC   DARGSMOD(3,@08),@CC01418                            0662 01947000
*       DARGSENT=MSG2109I;          /*                       @Z40LB30*/ 01948000
         MVI   DARGSENT(@08),X'41'                                 0663 01949000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 01950000
         L     @08,@PC00001                                        0664 01951000
         ST    @08,@AL00001                                        0664 01952000
         LA    @05,@CF00116                                        0664 01953000
         ST    @05,@AL00001+4                                      0664 01954000
         LA    @05,DDSTRU                                          0664 01955000
         ST    @05,@AL00001+8                                      0664 01956000
         MVI   @AL00001+8,X'80'                                    0664 01957000
         L     @15,GDTPRT(,@08)                                    0664 01958000
         LA    @01,@AL00001                                        0664 01959000
         BALR  @14,@15                                             0664 01960000
*     END;                          /*                       @Z40LB30*/ 01961000
*                                                                  0666 01962000
*   /*****************************************************************/ 01963000
*   /*                                                               */ 01964000
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/ 01965000
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/ 01966000
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF SO, LOWER    @Z40LB30*/ 01967000
*   /* THE FINAL CONDITION CODE.                             @Z40LB30*/ 01968000
*   /*                                                               */ 01969000
*   /*****************************************************************/ 01970000
*                                                                  0666 01971000
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/ 01972000
@RF00658 C     CC01,@CF00035                                       0666 01973000
         BNE   @RF00666                                            0666 01974000
         TM    ONEDONE,B'10000000'                                 0666 01975000
         BNO   @RF00666                                            0666 01976000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 01977000
*                                                                  0667 01978000
         LA    CC01,8                                              0667 01979000
*   /*****************************************************************/ 01980000
*   /*                                                               */ 01981000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 01982000
*   /*                                                               */ 01983000
*   /*****************************************************************/ 01984000
*                                                                  0668 01985000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 01986000
@RF00666 LR    @15,CC01                                            0668 01987000
@EL00004 DS    0H                                                  0668 01988000
@EF00004 DS    0H                                                  0668 01989000
@ER00004 L     @14,@SA00004                                        0668 01990000
         BR    @14                                                 0668 01991000
*   END NONGRPD;                    /*                       @Z40LB30*/ 01992000
*                                                                  0670 01993000
*/*********************************************************  @Z40LB30*/ 01994000
*/*                                                          @Z40LB30*/ 01995000
*/* PROCEDURE - ALLGRPS                                      @Z40LB30*/ 01996000
*/*                                                          @Z40LB30*/ 01997000
*/* FUNCTION - INTERFACE WITH MASS STORAGE VOLUME CONTROL TO @Z40LB30*/ 01998000
*/*           READ EACH GROUP RECORD IN THE INVENTORY.  THEN @Z40LB30*/ 01999000
*/*           CALL A PROCEDURE TO READ EACH ACTIVE BASE      @Z40LB30*/ 02000000
*/*           VOLUME IN THE GROUP.  FOR EACH VOLUME, CALL    @Z40LB30*/ 02001000
*/*           PROCEDURES TO CHECK IF THE VOLUME IS TO BE     @Z40LB30*/ 02002000
*/*           EXCLUDED OR HAS A RECOVERY FLAG ON IN THE      @Z40LB30*/ 02003000
*/*           VOLUME RECORD AND TO PROCESS THE VOLUME.       @Z40LB30*/ 02004000
*/*           ISSUE MESSAGE IDC2111I IF AN ERROR             @Z40LB30*/ 02005000
*/*           OCCURS AND THE REMAINING GROUPS CANNOT         @Z40LB30*/ 02006000
*/*           BE PROCESSED.  ISSUE MESSAGE IDC0817I IF ALL   @Z40LB30*/ 02007000
*/*           THE VOLUMES IN A GROUP WERE EXCLUDED FROM      @Z40LB30*/ 02008000
*/*           PROCESSING.                                    @Z40LB30*/ 02009000
*/*                                                          @Z40LB30*/ 02010000
*/* INPUT - NONE                                             @Z40LB30*/ 02011000
*/*                                                          @Z40LB30*/ 02012000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/ 02013000
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/ 02014000
*/*                           CLOSING VTOC                   @Z40LB30*/ 02015000
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/ 02016000
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/ 02017000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 02018000
*/*                       12, NO VOLUMES WERE PROCESSED DUE  @Z40LB30*/ 02019000
*/*                           TO ERRORS                      @Z40LB30*/ 02020000
*/*                                                          @Z40LB30*/ 02021000
*/*********************************************************  @Z40LB30*/ 02022000
*                                                                  0670 02023000
*ALLGRPS:                                                          0670 02024000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 02025000
ALLGRPS  ST    @14,@SA00005                                        0670 02026000
*                                                                  0671 02027000
*   /*****************************************************************/ 02028000
*   /*                                                               */ 02029000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 02030000
*   /*                                                               */ 02031000
*   /*****************************************************************/ 02032000
*                                                                  0671 02033000
*   OLDERID2=NEWERID2;                                             0671 02034000
         L     @08,@PC00001                                        0671 02035000
         L     @08,GDTTR2(,@08)                                    0671 02036000
         MVC   @TS00001(95),NEWERID2(@08)                          0671 02037000
         MVC   OLDERID2(95,@08),@TS00001                           0671 02038000
*   NEWID2='SDAG';                  /*                       @Z40LB30*/ 02039000
*                                                                  0672 02040000
         MVC   NEWID2(4,@08),@CC01520                              0672 02041000
*   /*****************************************************************/ 02042000
*   /*                                                               */ 02043000
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/ 02044000
*   /*                                                               */ 02045000
*   /*****************************************************************/ 02046000
*                                                                  0673 02047000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 02048000
*                                                                  0673 02049000
         SLR   @08,@08                                             0673 02050000
         LR    CC01,@08                                            0673 02051000
*   /*****************************************************************/ 02052000
*   /*                                                               */ 02053000
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ EACH GROUP   @Z40LB30*/ 02054000
*   /* RECORD                                                @Z40LB30*/ 02055000
*   /*                                                               */ 02056000
*   /*****************************************************************/ 02057000
*                                                                  0674 02058000
*   GRPRVVI=''B;                    /*                       @Z40LB30*/ 02059000
         XC    GRPRVVI(68),GRPRVVI                                 0674 02060000
*   RVVIPTR=ADDR(GRPRVVI);          /*                       @Z40LB30*/ 02061000
         LA    @15,GRPRVVI                                         0675 02062000
         ST    @15,RVVIPTR                                         0675 02063000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 02064000
         LH    @14,RVVLEN                                          0676 02065000
         ST    @14,RVVLNGTH(,@15)                                  0676 02066000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 02067000
         MVI   RVVCODE(@15),X'87'                                  0677 02068000
*   RVVBUFLN=LENGTH(GRPREC);        /*                       @Z40LB30*/ 02069000
         MVC   RVVBUFLN(2,@15),@CH01626                            0678 02070000
*   RVVRTBUF=ADDR(GRPREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 02071000
         LA    @14,GRPREC                                          0679 02072000
         ST    @14,RVVRTBUF(,@15)                                  0679 02073000
*   RVVRDNR=ON;                     /* READ NEXT             @Z40LB30*/ 02074000
         OI    RVVRDNR(@15),B'01000000'                            0680 02075000
*   RVVGRPRC=ON;                    /* GROUP RECORD          @Z40LB30*/ 02076000
         OI    RVVGRPRC(@15),B'01000000'                           0681 02077000
*                                                                  0682 02078000
*   /*****************************************************************/ 02079000
*   /*                                                               */ 02080000
*   /* LOOP THROUGH ALL THE GROUPS UNTIL NO MORE GROUPS CAN  @Z40LB30*/ 02081000
*   /* BE READ DUE TO ERROR OR BECAUSE THERE ARE NO MORE.    @Z40LB30*/ 02082000
*   /*                                                               */ 02083000
*   /*****************************************************************/ 02084000
*                                                                  0682 02085000
*   VVICODE=0;                      /*                       @Z40LB30*/ 02086000
         ST    @08,VVICODE                                         0682 02087000
*   DO UNTIL VVICODE^=0;            /*                       @Z40LB30*/ 02088000
*                                                                  0683 02089000
@DL00683 DS    0H                                                  0684 02090000
*     /***************************************************************/ 02091000
*     /*                                                             */ 02092000
*     /* INITIALIZE COUNTS OF HOW MANY VOLUMES HAVE BEEN     @Z40LB30*/ 02093000
*     /* READ FROM THE GROUP AND HOW MANY HAVE BEEN          @Z40LB30*/ 02094000
*     /* EXCLUDED. SET INDICATOR OF WHETHER LAST             @Z40LB30*/ 02095000
*     /* VOLUME PROCESSED WAS EXCLUDED TO OFF.               @Z40LB30*/ 02096000
*     /*                                                             */ 02097000
*     /***************************************************************/ 02098000
*                                                                  0684 02099000
*     EXCLCNT=0;                    /*                       @Z40LB30*/ 02100000
         SLR   @08,@08                                             0684 02101000
         STH   @08,EXCLCNT                                         0684 02102000
*     VOLRDCNT=0;                   /*                       @Z40LB30*/ 02103000
         STH   @08,VOLRDCNT                                        0685 02104000
*     EXCVOL=OFF;                   /*                       @Z40LB30*/ 02105000
*                                                                  0686 02106000
         NI    EXCVOL,B'11101111'                                  0686 02107000
*     /***************************************************************/ 02108000
*     /*                                                             */ 02109000
*     /* ISSUE USSC MACRO TO READ A GROUP RECORD.            @Z40LB30*/ 02110000
*     /* SAVE THE RETURN CODE.                               @Z40LB30*/ 02111000
*     /*                                                             */ 02112000
*     /***************************************************************/ 02113000
*                                                                  0687 02114000
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*          @Z40LB30*/ 02115000
         L     @08,@PC00001                                        0687 02116000
         ST    @08,@AL00001                                        0687 02117000
         LA    @02,VVIC                                            0687 02118000
         ST    @02,@AL00001+4                                      0687 02119000
         LA    @02,RVVIPTR                                         0687 02120000
         ST    @02,@AL00001+8                                      0687 02121000
         LA    @02,VVICODE                                         0687 02122000
         ST    @02,@AL00001+12                                     0687 02123000
         MVI   @AL00001+12,X'80'                                   0687 02124000
         L     @15,GDTSSC(,@08)                                    0687 02125000
         LA    @01,@AL00001                                        0687 02126000
         BALR  @14,@15                                             0687 02127000
*     RESPECIFY                                                    0688 02128000
*       RTNREG RSTD;                                               0688 02129000
*     TESTRC=RTNREG;                                               0689 02130000
         LR    TESTRC,RTNREG                                       0689 02131000
*     RESPECIFY                                                    0690 02132000
*       RTNREG UNRSTD;              /*                       @Z40LB30*/ 02133000
*                                                                  0690 02134000
*     /***************************************************************/ 02135000
*     /*                                                             */ 02136000
*     /* IF THE READ WAS SUCCESSFUL, CONTINUE                @Z40LB30*/ 02137000
*     /*                                                             */ 02138000
*     /***************************************************************/ 02139000
*                                                                  0691 02140000
*     IF TESTRC=0 THEN              /*                       @Z40LB30*/ 02141000
         SLR   @08,@08                                             0691 02142000
         CR    TESTRC,@08                                          0691 02143000
         BNE   @RF00691                                            0691 02144000
*       DO;                         /*                       @Z40LB30*/ 02145000
*                                                                  0692 02146000
*         /***********************************************************/ 02147000
*         /*                                                         */ 02148000
*         /* SET THE ADDRESS OF THE BASE VOLUME RECORD TO    @Z40LB30*/ 02149000
*         /* ZERO TO PASS TO RDGRPCHN PROCEDURE.             @Z40LB30*/ 02150000
*         /*                                                         */ 02151000
*         /***********************************************************/ 02152000
*                                                                  0693 02153000
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/ 02154000
*                                                                  0693 02155000
         ST    @08,VOLPTR                                          0693 02156000
*         /***********************************************************/ 02157000
*         /*                                                         */ 02158000
*         /* READ AND PROCESS ALL ACTIVE BASE VOLUME RECORDS @Z40LB30*/ 02159000
*         /* UNTIL THERE ARE NO MORE OR A READ ERROR OCCURS. @Z40LB30*/ 02160000
*         /*                                                         */ 02161000
*         /***********************************************************/ 02162000
*                                                                  0694 02163000
*         RDERROR=OFF;              /*                       @Z40LB30*/ 02164000
         NI    RDERROR,B'10111111'                                 0694 02165000
*         DO UNTIL VOLPTR=NULLPTR|RDERROR=ON;/*              @Z40LB30*/ 02166000
*                                                                  0695 02167000
@DL00695 DS    0H                                                  0696 02168000
*           /*********************************************************/ 02169000
*           /*                                                       */ 02170000
*           /* CALL RDGRPCHN TO READ A ACTIVE VOLUME RECORD. @Z40LB30*/ 02171000
*           /* SAVE THE RETURN CODE.                         @Z40LB30*/ 02172000
*           /*                                                       */ 02173000
*           /*********************************************************/ 02174000
*                                                                  0696 02175000
*           CALL RDGRPCHN;          /*                       @Z40LB30*/ 02176000
         BAL   @14,RDGRPCHN                                        0696 02177000
*           RESPECIFY                                              0697 02178000
*             RTNREG RSTD;                                         0697 02179000
*           TESTRC=RTNREG;                                         0698 02180000
         LR    TESTRC,RTNREG                                       0698 02181000
*           RESPECIFY                                              0699 02182000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 02183000
*                                                                  0699 02184000
*           /*********************************************************/ 02185000
*           /*                                                       */ 02186000
*           /* IF THERE ARE NO READ ERRORS, CONTINUE TO SEE  @Z40LB30*/ 02187000
*           /* IF THERE IS A VOLUME TO PROCESS.              @Z40LB30*/ 02188000
*           /*                                                       */ 02189000
*           /*********************************************************/ 02190000
*                                                                  0700 02191000
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/ 02192000
         SLR   @08,@08                                             0700 02193000
         CR    TESTRC,@08                                          0700 02194000
         BNE   @RF00700                                            0700 02195000
*             IF VOLPTR^=NULLPTR    /*                       @Z40LB30*/ 02196000
*               THEN                /*                       @Z40LB30*/ 02197000
*                                                                  0701 02198000
         C     @08,VOLPTR                                          0701 02199000
         BE    @RF00701                                            0701 02200000
*               /*****************************************************/ 02201000
*               /*                                                   */ 02202000
*               /* PROCESS THE VOLUME                        @Z40LB30*/ 02203000
*               /*                                                   */ 02204000
*               /*****************************************************/ 02205000
*                                                                  0702 02206000
*               DO;                 /*                       @Z40LB30*/ 02207000
*                                                                  0702 02208000
*                 /***************************************************/ 02209000
*                 /*                                                 */ 02210000
*                 /* INCREMENT THE COUNT OF THE NUMBER       @Z40LB30*/ 02211000
*                 /* OF VOLUMES READ                         @Z40LB30*/ 02212000
*                 /*                                                 */ 02213000
*                 /***************************************************/ 02214000
*                                                                  0703 02215000
*                 VOLRDCNT=VOLRDCNT+1;/*                     @Z40LB30*/ 02216000
*                                                                  0703 02217000
         LA    @08,1                                               0703 02218000
         AH    @08,VOLRDCNT                                        0703 02219000
         STH   @08,VOLRDCNT                                        0703 02220000
*                 /***************************************************/ 02221000
*                 /*                                                 */ 02222000
*                 /* CALL CKRECEXC TO SEE IF THE VOLUME      @Z40LB30*/ 02223000
*                 /* IS EXCLUDED OR IF ANY RECOVERY FLAGS    @Z40LB30*/ 02224000
*                 /* ARE ON. SAVE THE RETURN CODE.           @Z40LB30*/ 02225000
*                 /*                                                 */ 02226000
*                 /***************************************************/ 02227000
*                                                                  0704 02228000
*                 CALL CKRECEXC;    /*                       @Z40LB30*/ 02229000
         BAL   @14,CKRECEXC                                        0704 02230000
*                 RESPECIFY                                        0705 02231000
*                   RTNREG RSTD;                                   0705 02232000
*                 TESTRC=RTNREG;                                   0706 02233000
         LR    TESTRC,RTNREG                                       0706 02234000
*                 RESPECIFY                                        0707 02235000
*                   RTNREG UNRSTD;  /*                       @Z40LB30*/ 02236000
*                                                                  0707 02237000
*                 /***************************************************/ 02238000
*                 /*                                                 */ 02239000
*                 /* IF THE RETURN CODE INDICATES AN ERROR   @Z40LB30*/ 02240000
*                 /* (>4), SET THE CONDITION CODE TO         @Z40LB30*/ 02241000
*                 /* INDICATE A VOLUME COULD NOT BE          @Z40LB30*/ 02242000
*                 /* PROCESSED.                              @Z40LB30*/ 02243000
*                 /*                                                 */ 02244000
*                 /***************************************************/ 02245000
*                                                                  0708 02246000
*                 IF TESTRC>LASTCC04 THEN/*                  @Z40LB30*/ 02247000
         C     TESTRC,@CF00042                                     0708 02248000
         BNH   @RF00708                                            0708 02249000
*                   CC01=LASTCC12;  /*                       @Z40LB30*/ 02250000
*                                                                  0709 02251000
         LA    CC01,12                                             0709 02252000
*                 /***************************************************/ 02253000
*                 /*                                                 */ 02254000
*                 /* IF THE VOLUME CAN BE PROCESSED,         @Z40LB30*/ 02255000
*                 /* PROCESS IT.                             @Z40LB30*/ 02256000
*                 /*                                                 */ 02257000
*                 /***************************************************/ 02258000
*                                                                  0710 02259000
*                 ELSE              /*                       @Z40LB30*/ 02260000
*                   IF TESTRC=LASTCC00 THEN/*                @Z40LB30*/ 02261000
         B     @RC00708                                            0710 02262000
@RF00708 LTR   TESTRC,TESTRC                                       0710 02263000
         BNZ   @RF00710                                            0710 02264000
*                     DO;           /*                       @Z40LB30*/ 02265000
*                                                                  0711 02266000
*                       /*********************************************/ 02267000
*                       /*                                           */ 02268000
*                       /* CALL PROCVOL TO PROCESS THE       @Z40LB30*/ 02269000
*                       /* VOLUME. SAVE THE RETURN           @Z40LB30*/ 02270000
*                       /* CODE. ACCUMULATE THE LARGEST      @Z40LB30*/ 02271000
*                       /* RETURN CODE IN THE INTERNAL       @Z40LB30*/ 02272000
*                       /* CONDITION CODE AREA.              @Z40LB30*/ 02273000
*                       /*                                           */ 02274000
*                       /*********************************************/ 02275000
*                                                                  0712 02276000
*                       CALL PROCVOL;/*                      @Z40LB30*/ 02277000
         BAL   @14,PROCVOL                                         0712 02278000
*                       RESPECIFY                                  0713 02279000
*                         RTNREG RSTD;                             0713 02280000
*                       TESTRC=RTNREG;                             0714 02281000
         LR    TESTRC,RTNREG                                       0714 02282000
*                       RESPECIFY                                  0715 02283000
*                         RTNREG UNRSTD;/*                   @Z40LB30*/ 02284000
*                       CC01=MAX(CC01,TESTRC);/*             @Z40LB30*/ 02285000
*                                                                  0716 02286000
         CR    CC01,TESTRC                                         0716 02287000
         BNL   *+6                                                      02288000
         LR    CC01,TESTRC                                         0716 02289000
*                       /*********************************************/ 02290000
*                       /*                                           */ 02291000
*                       /* IF THE RETURN CODE INDICATES      @Z40LB30*/ 02292000
*                       /* A VOLUME WAS PROCESSED, SET       @Z40LB30*/ 02293000
*                       /* AN INDICATOR.                     @Z40LB30*/ 02294000
*                       /*                                           */ 02295000
*                       /*********************************************/ 02296000
*                                                                  0717 02297000
*                       IF TESTRC<LASTCC12 THEN/*            @Z40LB30*/ 02298000
         C     TESTRC,@CF00035                                     0717 02299000
         BNL   @RF00717                                            0717 02300000
*                         ONEDONE=ON;/*                      @Z40LB30*/ 02301000
         OI    ONEDONE,B'10000000'                                 0718 02302000
*                     END;          /*                       @Z40LB30*/ 02303000
*                                                                  0719 02304000
*                 /***************************************************/ 02305000
*                 /*                                                 */ 02306000
*                 /* IF THE VOLUME WAS EXCLUDED,             @Z40LB30*/ 02307000
*                 /* INCREMENT THE COUNT OF EXCLUDED         @Z40LB30*/ 02308000
*                 /* VOLUME AND SET AN INDICATOR.            @Z40LB30*/ 02309000
*                 /*                                                 */ 02310000
*                 /***************************************************/ 02311000
*                                                                  0720 02312000
*                   ELSE            /*                       @Z40LB30*/ 02313000
*                     DO;           /*                       @Z40LB30*/ 02314000
         B     @RC00710                                            0720 02315000
@RF00710 DS    0H                                                  0721 02316000
*                       EXCLCNT=EXCLCNT+1;/*                 @Z40LB30*/ 02317000
         LA    @08,1                                               0721 02318000
         AH    @08,EXCLCNT                                         0721 02319000
         STH   @08,EXCLCNT                                         0721 02320000
*                       EXCVOL=ON;  /*                       @Z40LB30*/ 02321000
         OI    EXCVOL,B'00010000'                                  0722 02322000
*                     END;          /*                       @Z40LB30*/ 02323000
*               END;                /*                       @Z40LB30*/ 02324000
*                                                                  0724 02325000
*           /*********************************************************/ 02326000
*           /*                                                       */ 02327000
*           /* NOTHING TO DO IF NO MORE VOLUMES IN GROUP.    @Z40LB30*/ 02328000
*           /*                                                       */ 02329000
*           /*********************************************************/ 02330000
*                                                                  0725 02331000
*             ELSE                                                 0725 02332000
*               ;                   /*                       @Z40LB30*/ 02333000
*                                                                  0725 02334000
@RF00701 DS    0H                                                  0726 02335000
*           /*********************************************************/ 02336000
*           /*                                                       */ 02337000
*           /* IF THERE WAS AN ERROR READING A VOLUME RECORD @Z40LB30*/ 02338000
*           /* INDICATE THAT AND SET THE CONDITION CODE TO   @Z40LB30*/ 02339000
*           /* INDICATE A VOLUME COULD NOT BE PROCESSED.     @Z40LB30*/ 02340000
*           /*                                                       */ 02341000
*           /*********************************************************/ 02342000
*                                                                  0726 02343000
*           ELSE                    /*                       @Z40LB30*/ 02344000
*             DO;                   /*                       @Z40LB30*/ 02345000
         B     @RC00700                                            0726 02346000
@RF00700 DS    0H                                                  0727 02347000
*               RDERROR=ON;         /*                       @Z40LB30*/ 02348000
         OI    RDERROR,B'01000000'                                 0727 02349000
*               CC01=LASTCC12;      /*                       @Z40LB30*/ 02350000
         LA    CC01,12                                             0728 02351000
*             END;                  /*                       @Z40LB30*/ 02352000
*                                                                  0729 02353000
*           /*********************************************************/ 02354000
*           /*                                                       */ 02355000
*           /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE IN   @Z40LB30*/ 02356000
*           /* ORDER TO SPACE BETWEEN THE MESSAGES FOR EACH  @Z40LB30*/ 02357000
*           /* VOLUME. ISSUE UPRINT ONLY IF LAST VOLUME      @Z40LB30*/ 02358000
*           /* WAS NOT EXCLUDED SINCE NO MESSAGES WERE ISSUED        */ 02359000
*           /*                                               @Z40LB30*/ 02360000
*           /* IF THE VOLUME WAS EXCLUDED.                   @Z40LB30*/ 02361000
*           /*                                                       */ 02362000
*           /*********************************************************/ 02363000
*                                                                  0730 02364000
*           IF EXCVOL=OFF THEN      /*                       @Z40LB30*/ 02365000
@RC00700 TM    EXCVOL,B'00010000'                                  0730 02366000
         BNZ   @RF00730                                            0730 02367000
*             DO;                   /*                       @Z40LB30*/ 02368000
*               DARGAREA=''B;       /*                       @Z40LB30*/ 02369000
         XC    DARGAREA(28),DARGAREA                               0732 02370000
*               DARGSMOD=SD01MSG;   /*                       @Z40LB30*/ 02371000
         L     @08,DDSTRU                                          0733 02372000
         MVC   DARGSMOD(3,@08),@CC01420                            0733 02373000
*               DARGSENT=BLANKS;    /*                       @Z40LB30*/ 02374000
         MVI   DARGSENT(@08),X'06'                                 0734 02375000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB30*/ 02376000
         L     @08,@PC00001                                        0735 02377000
         ST    @08,@AL00001                                        0735 02378000
         LA    @15,@CF00116                                        0735 02379000
         ST    @15,@AL00001+4                                      0735 02380000
         LA    @15,DDSTRU                                          0735 02381000
         ST    @15,@AL00001+8                                      0735 02382000
         MVI   @AL00001+8,X'80'                                    0735 02383000
         L     @15,GDTPRT(,@08)                                    0735 02384000
         LA    @01,@AL00001                                        0735 02385000
         BALR  @14,@15                                             0735 02386000
*             END;                  /*                       @Z40LB30*/ 02387000
*         END;                      /*                       @Z40LB30*/ 02388000
*                                                                  0737 02389000
@RF00730 DS    0H                                                  0737 02390000
@DE00695 SLR   @08,@08                                             0737 02391000
         C     @08,VOLPTR                                          0737 02392000
         BE    @DC00695                                            0737 02393000
         TM    RDERROR,B'01000000'                                 0737 02394000
         BNO   @DL00695                                            0737 02395000
@DC00695 DS    0H                                                  0738 02396000
*         /***********************************************************/ 02397000
*         /*                                                         */ 02398000
*         /* DETERMINE IF ALL THE ACTIVE VOLUMES IN THE      @Z40LB30*/ 02399000
*         /* GROUP HAVE BEEN EXCLUDED. IF NO ERRORS HAVE     @Z40LB30*/ 02400000
*         /* OCCURRED, AND AT LEAST 1 VOLUME HAS BEEN READ,  @Z40LB30*/ 02401000
*         /* COMPARE THE COUNT OF THE NUMBER OF VOLUMES READ @Z40LB30*/ 02402000
*         /* IN THE GROUP TO THE NUMBER EXCLUDED. IF THE     @Z40LB30*/ 02403000
*         /* COUNTS MATCH, PRINT MESSAGE IDC0817I TO SAY     @Z40LB30*/ 02404000
*         /* ALL THE VOLUMES IN THE GROUP HAVE BEEN          @Z40LB30*/ 02405000
*         /* EXCLUDED AND SET AN INDICATOR.                  @Z40LB30*/ 02406000
*         /*                                                         */ 02407000
*         /***********************************************************/ 02408000
*                                                                  0738 02409000
*         IF RDERROR=OFF&VOLRDCNT>0 /*                       @Z40LB30*/ 02410000
*             &VOLRDCNT=EXCLCNT THEN/*                       @Z40LB30*/ 02411000
         TM    RDERROR,B'01000000'                                 0738 02412000
         BNZ   @RF00738                                            0738 02413000
         LH    @15,VOLRDCNT                                        0738 02414000
         CR    @15,@08                                             0738 02415000
         BNH   @RF00738                                            0738 02416000
         CH    @15,EXCLCNT                                         0738 02417000
         BNE   @RF00738                                            0738 02418000
*           DO;                     /*                       @Z40LB30*/ 02419000
*             DARGAREA=''B;         /*                       @Z40LB30*/ 02420000
         XC    DARGAREA(28),DARGAREA                               0740 02421000
*             DARGSMOD=SD01MSG;     /*                       @Z40LB30*/ 02422000
         L     @08,DDSTRU                                          0741 02423000
         MVC   DARGSMOD(3,@08),@CC01420                            0741 02424000
*             DARGSENT=MSG0817I;    /*                       @Z40LB30*/ 02425000
         MVI   DARGSENT(@08),X'09'                                 0742 02426000
*             DARGDBP=ADDR(GROVVGRP);/*                      @Z40LB30*/ 02427000
         L     @01,GROUPPTR                                        0743 02428000
         LA    @15,GROVVGRP(,@01)                                  0743 02429000
         ST    @15,DARGDBP(,@08)                                   0743 02430000
*             DARGILP=LENGTH(GROVVGRP);/*                    @Z40LB30*/ 02431000
         MVC   DARGILP(2,@08),@CH00181                             0744 02432000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB30*/ 02433000
         L     @08,@PC00001                                        0745 02434000
         ST    @08,@AL00001                                        0745 02435000
         LA    @15,@CF00116                                        0745 02436000
         ST    @15,@AL00001+4                                      0745 02437000
         LA    @15,DDSTRU                                          0745 02438000
         ST    @15,@AL00001+8                                      0745 02439000
         MVI   @AL00001+8,X'80'                                    0745 02440000
         L     @15,GDTPRT(,@08)                                    0745 02441000
         LA    @01,@AL00001                                        0745 02442000
         BALR  @14,@15                                             0745 02443000
*             EMPTYGRP=ON;          /*                       @Z40LB30*/ 02444000
         OI    EMPTYGRP,B'00001000'                                0746 02445000
*           END;                    /*                       @Z40LB30*/ 02446000
*                                                                  0747 02447000
*         /***********************************************************/ 02448000
*         /*                                                         */ 02449000
*         /* RESET THE POINTER TO THE IEZRVVI ARGUMENT LIST. @Z40LB30*/ 02450000
*         /* INCREMENT GROUP NAME IN IEZRVVI ARGUMENT LIST   @Z40LB30*/ 02451000
*         /* SO THAT NEXT GROUP RECORD IS READ.              @Z40LB30*/ 02452000
*         /*                                                         */ 02453000
*         /***********************************************************/ 02454000
*                                                                  0748 02455000
*         RVVIPTR=ADDR(GRPRVVI);    /*                       @Z40LB30*/ 02456000
@RF00738 LA    @08,GRPRVVI                                         0748 02457000
         ST    @08,RVVIPTR                                         0748 02458000
*         RVVGROUP=GROVVGRP;        /*                       @Z40LB30*/ 02459000
         L     @01,GROUPPTR                                        0749 02460000
         MVC   RVVGROUP(8,@08),GROVVGRP(@01)                       0749 02461000
*         RVVSGRP=ON;               /*                       @Z40LB30*/ 02462000
         OI    RVVSGRP(@08),B'10000000'                            0750 02463000
*       END;                        /*                       @Z40LB30*/ 02464000
*   END;                            /*                       @Z40LB30*/ 02465000
@RF00691 DS    0H                                                  0752 02466000
@DE00683 L     @08,VVICODE                                         0752 02467000
         LTR   @08,@08                                             0752 02468000
         BZ    @DL00683                                            0752 02469000
*                                                                  0753 02470000
*   /*****************************************************************/ 02471000
*   /*                                                               */ 02472000
*   /* IF THERE WAS AN ERROR READING A GROUP RECORD, CALL    @Z40LB30*/ 02473000
*   /* SSCMSG TO PRINT THE REASON CODE. THEN PRINT MESSAGE   @Z40LB30*/ 02474000
*   /* IDC2111I TO SAY NO MORE GROUPS COULD BE PROCESSED.    @Z40LB30*/ 02475000
*   /* THEN SET CONDITION CODE TO INDICATE A SEVERE ERROR.   @Z40LB30*/ 02476000
*   /*                                                               */ 02477000
*   /*****************************************************************/ 02478000
*                                                                  0753 02479000
*   IF VVICODE^=NORECORD THEN       /*                       @Z40LB30*/ 02480000
         C     @08,@CF01473                                        0753 02481000
         BE    @RF00753                                            0753 02482000
*     DO;                           /*                       @Z40LB30*/ 02483000
*       CALL SSCMSG(VVICODE);       /*                       @Z40LB30*/ 02484000
         LA    @08,VVICODE                                         0755 02485000
         ST    @08,@AL00001                                        0755 02486000
         LA    @01,@AL00001                                        0755 02487000
         BAL   @14,SSCMSG                                          0755 02488000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 02489000
         XC    DARGAREA(28),DARGAREA                               0756 02490000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/ 02491000
         L     @08,DDSTRU                                          0757 02492000
         MVC   DARGSMOD(3,@08),@CC01418                            0757 02493000
*       DARGSENT=MSG2111I;          /*                       @Z40LB30*/ 02494000
         MVI   DARGSENT(@08),X'43'                                 0758 02495000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 02496000
         L     @08,@PC00001                                        0759 02497000
         ST    @08,@AL00001                                        0759 02498000
         LA    @05,@CF00116                                        0759 02499000
         ST    @05,@AL00001+4                                      0759 02500000
         LA    @05,DDSTRU                                          0759 02501000
         ST    @05,@AL00001+8                                      0759 02502000
         MVI   @AL00001+8,X'80'                                    0759 02503000
         L     @15,GDTPRT(,@08)                                    0759 02504000
         LA    @01,@AL00001                                        0759 02505000
         BALR  @14,@15                                             0759 02506000
*       CC01=LASTCC12;              /*                       @Z40LB30*/ 02507000
         LA    CC01,12                                             0760 02508000
*     END;                          /*                       @Z40LB30*/ 02509000
*                                                                  0762 02510000
*   /*****************************************************************/ 02511000
*   /*                                                               */ 02512000
*   /* IF THE FINAL CONDITION CODE INDICATES A SEVERE ERROR  @Z40LB30*/ 02513000
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/ 02514000
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED OR AT LEAST      @Z40LB30*/ 02515000
*   /* ONE EMPTY GROUP WAS PROCESSED. IF SO, LOWER THE       @Z40LB30*/ 02516000
*   /* FINAL CONDITION CODE.                                 @Z40LB30*/ 02517000
*   /*                                                               */ 02518000
*   /*****************************************************************/ 02519000
*                                                                  0762 02520000
*   IF CC01=LASTCC12&(ONEDONE=ON|EMPTYGRP=ON) THEN/*         @Z40LB30*/ 02521000
@RF00753 C     CC01,@CF00035                                       0762 02522000
         BNE   @RF00762                                            0762 02523000
         TM    ONEDONE,B'10001000'                                 0762 02524000
         BZ    @RF00762                                            0762 02525000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 02526000
*                                                                  0763 02527000
         LA    CC01,8                                              0763 02528000
*   /*****************************************************************/ 02529000
*   /*                                                               */ 02530000
*   /* RETURN TO CALLER.                                     @Z40LB30*/ 02531000
*   /*                                                               */ 02532000
*   /*****************************************************************/ 02533000
*                                                                  0764 02534000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 02535000
@RF00762 LR    @15,CC01                                            0764 02536000
@EL00005 DS    0H                                                  0764 02537000
@EF00005 DS    0H                                                  0764 02538000
@ER00005 L     @14,@SA00005                                        0764 02539000
         BR    @14                                                 0764 02540000
*   END ALLGRPS;                    /*                       @Z40LB30*/ 02541000
*                                                                  0766 02542000
*/********************************************************   @Z40LB30*/ 02543000
*/*                                                          @Z40LB30*/ 02544000
*/* PROCEDURE - ALLVOLS                                      @Z40LB30*/ 02545000
*/*                                                          @Z40LB30*/ 02546000
*/* FUNCTION - INTERFACE WITH THE MSVC PROGRAM TO READ EACH  @Z40LB30*/ 02547000
*/*           ACTIVE BASE VOLUME RECORD IN THE INVENTORY.    @Z40LB30*/ 02548000
*/*           THEN CALL A PROCEDURE TO CHECK IF THE VOLUME   @Z40LB30*/ 02549000
*/*           IS TO BE EXCLUDED OR IF THE RECORD HAS ANY     @Z40LB30*/ 02550000
*/*           RECOVERY FLAGS ON.  THEN CALL A PROCEDURE.     @Z40LB30*/ 02551000
*/*           TO PROCESS THE VOLUME.  ISSUE MESSAGE          @Z40LB30*/ 02552000
*/*           IDC0104I IF THERE ARE NO ACTIVE VOLUMES        @Z40LB30*/ 02553000
*/*           IN THE INVENTORY AND MESSAGE IDC2109I          @Z40LB30*/ 02554000
*/*           IF AN ERROR OCCURS AND NO MORE VOLUMES         @Z40LB30*/ 02555000
*/*           CAN BE PROCESSED.                              @Z40LB30*/ 02556000
*/*                                                          @Z40LB30*/ 02557000
*/* INPUT - NONE                                             @Z40LB30*/ 02558000
*/*                                                          @Z40LB30*/ 02559000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS OCCURRED             @Z40LB30*/ 02560000
*/*                        4, ERROR DEALLOCATING VOLUME OR   @Z40LB30*/ 02561000
*/*                           CLOSING VTOC                   @Z40LB30*/ 02562000
*/*                        8, ONE OR MORE VOLUMES OR DATA    @Z40LB30*/ 02563000
*/*                           SETS COULD NOT BE PROCESSED    @Z40LB30*/ 02564000
*/*                           DUE TO ERRORS                  @Z40LB30*/ 02565000
*/*                       12, NO VOLUMES WERE PROCESSED DUE  @Z40LB30*/ 02566000
*/*                           TO ERRORS                      @Z40LB30*/ 02567000
*/*                                                          @Z40LB30*/ 02568000
*/********************************************************   @Z40LB30*/ 02569000
*                                                                  0766 02570000
*ALLVOLS:                                                          0766 02571000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 02572000
ALLVOLS  ST    @14,@SA00006                                        0766 02573000
*                                                                  0767 02574000
*   /*****************************************************************/ 02575000
*   /*                                                               */ 02576000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 02577000
*   /*                                                               */ 02578000
*   /*****************************************************************/ 02579000
*                                                                  0767 02580000
*   OLDERID2=NEWERID2;                                             0767 02581000
         L     @08,@PC00001                                        0767 02582000
         L     @02,GDTTR2(,@08)                                    0767 02583000
         MVC   @TS00001(95),NEWERID2(@02)                          0767 02584000
         MVC   OLDERID2(95,@02),@TS00001                           0767 02585000
*   NEWID2='SDAV';                  /*                       @Z40LB30*/ 02586000
*                                                                  0768 02587000
         MVC   NEWID2(4,@02),@CC01524                              0768 02588000
*   /*****************************************************************/ 02589000
*   /*                                                               */ 02590000
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/ 02591000
*   /* SET MSVC REASON CODE TO 0                             @Z40LB30*/ 02592000
*   /*                                                               */ 02593000
*   /*****************************************************************/ 02594000
*                                                                  0769 02595000
*   CC01=LASTCC00;                  /*                       @Z40LB30*/ 02596000
         SLR   @02,@02                                             0769 02597000
         LR    CC01,@02                                            0769 02598000
*   VVICODE=0;                      /*                       @Z40LB30*/ 02599000
*                                                                  0770 02600000
         ST    @02,VVICODE                                         0770 02601000
*   /*****************************************************************/ 02602000
*   /*                                                               */ 02603000
*   /* INITIALIZE IEZRVVI ARGUMENT LIST TO READ AN ACTIVE    @Z40LB30*/ 02604000
*   /* BASE VOLUME RECORD.                                   @Z40LB30*/ 02605000
*   /*                                                               */ 02606000
*   /*****************************************************************/ 02607000
*                                                                  0771 02608000
*   VOLRVVI=''B;                    /*                       @Z40LB30*/ 02609000
         XC    VOLRVVI(68),VOLRVVI                                 0771 02610000
*   RVVIPTR=ADDR(VOLRVVI);          /*                       @Z40LB30*/ 02611000
         LA    @02,VOLRVVI                                         0772 02612000
         ST    @02,RVVIPTR                                         0772 02613000
*   RVVLNGTH=RVVLEN;                /*                       @Z40LB30*/ 02614000
         LH    @15,RVVLEN                                          0773 02615000
         ST    @15,RVVLNGTH(,@02)                                  0773 02616000
*   RVVCODE=RVVOP;                  /*                       @Z40LB30*/ 02617000
         MVI   RVVCODE(@02),X'87'                                  0774 02618000
*   RVVBUFLN=LENGTH(VOLREC);        /*                       @Z40LB30*/ 02619000
         MVC   RVVBUFLN(2,@02),@CH01625                            0775 02620000
*   RVVRTBUF=ADDR(VOLREC);          /* ADDRESS OF BUFFER     @Z40LB30*/ 02621000
         LA    @15,VOLREC                                          0776 02622000
         ST    @15,RVVRTBUF(,@02)                                  0776 02623000
*   RVVRDNR=ON;                     /* READ NEXT RECORDS     @Z40LB30*/ 02624000
         OI    RVVRDNR(@02),B'01000000'                            0777 02625000
*   RVVBVRCD=ON;                    /* BASE RECORDS ONLY     @Z40LB30*/ 02626000
         OI    RVVBVRCD(@02),B'10000000'                           0778 02627000
*   RVVACTV=ON;                     /* ACTIVE VOLUMES ONLY   @Z40LB30*/ 02628000
*                                                                  0779 02629000
         OI    RVVACTV(@02),B'00000100'                            0779 02630000
*   /*****************************************************************/ 02631000
*   /*                                                               */ 02632000
*   /* ISSUE USSC MACRO TO READ FIRST RECORD.                @Z40LB30*/ 02633000
*   /* SAVE THE RETURN CODE.                                 @Z40LB30*/ 02634000
*   /*                                                               */ 02635000
*   /*****************************************************************/ 02636000
*                                                                  0780 02637000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*            @Z40LB30*/ 02638000
         ST    @08,@AL00001                                        0780 02639000
         LA    @02,VVIC                                            0780 02640000
         ST    @02,@AL00001+4                                      0780 02641000
         LA    @02,RVVIPTR                                         0780 02642000
         ST    @02,@AL00001+8                                      0780 02643000
         LA    @02,VVICODE                                         0780 02644000
         ST    @02,@AL00001+12                                     0780 02645000
         MVI   @AL00001+12,X'80'                                   0780 02646000
         L     @15,GDTSSC(,@08)                                    0780 02647000
         LA    @01,@AL00001                                        0780 02648000
         BALR  @14,@15                                             0780 02649000
*   RESPECIFY                                                      0781 02650000
*     RTNREG RSTD;                                                 0781 02651000
*   TESTRC=RTNREG;                                                 0782 02652000
         LR    TESTRC,RTNREG                                       0782 02653000
*   RESPECIFY                                                      0783 02654000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 02655000
*                                                                  0784 02656000
*   /*****************************************************************/ 02657000
*   /*                                                               */ 02658000
*   /* IF THE FIRST RECORD WAS READ SUCCESSFULLY, START A    @Z40LB30*/ 02659000
*   /* LOOP TO PROCESS THE VOLUME AND THEN READ THE NEXT     @Z40LB30*/ 02660000
*   /* VOLUME RECORD. END THE LOOP WHEN THERE ARE NO MORE    @Z40LB30*/ 02661000
*   /* ACTIVE BASE VOLUME RECORDS THAT CAN BE READ FROM THE  @Z40LB30*/ 02662000
*   /* INVENTORY.                                            @Z40LB30*/ 02663000
*   /*                                                               */ 02664000
*   /*****************************************************************/ 02665000
*                                                                  0784 02666000
*   IF TESTRC=0 THEN                /*                       @Z40LB30*/ 02667000
         LTR   TESTRC,TESTRC                                       0784 02668000
         BNZ   @RF00784                                            0784 02669000
*     DO WHILE VVICODE=0;           /*                       @Z40LB30*/ 02670000
*                                                                  0785 02671000
         B     @DE00785                                            0785 02672000
@DL00785 DS    0H                                                  0786 02673000
*       /*************************************************************/ 02674000
*       /*                                                           */ 02675000
*       /* CALL CKRECEXC TO SEE IF THE VOLUME IS EXCLUDED    @Z40LB30*/ 02676000
*       /* BY THE SCRDSET COMMAND OR IF A RECOVERY FLAG IS   @Z40LB30*/ 02677000
*       /* ON IN THE VOLUME RECORD. SAVE THE RETURN CODE.    @Z40LB30*/ 02678000
*       /*                                                           */ 02679000
*       /*************************************************************/ 02680000
*                                                                  0786 02681000
*       CALL CKRECEXC;              /*                       @Z40LB30*/ 02682000
         BAL   @14,CKRECEXC                                        0786 02683000
*       RESPECIFY                                                  0787 02684000
*         RTNREG RSTD;                                             0787 02685000
*       TESTRC=RTNREG;                                             0788 02686000
         LR    TESTRC,RTNREG                                       0788 02687000
*       RESPECIFY                                                  0789 02688000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 02689000
*                                                                  0789 02690000
*       /*************************************************************/ 02691000
*       /*                                                           */ 02692000
*       /* IF THE RETURN CODE INDICATES AN ERROR (>4), SET   @Z40LB30*/ 02693000
*       /* THE CONDITION CODE TO INDICATE A SEVERE ERROR     @Z40LB30*/ 02694000
*       /* THAT PREVENTED A VOLUME BEING PROCESSED.          @Z40LB30*/ 02695000
*       /*                                                           */ 02696000
*       /*************************************************************/ 02697000
*                                                                  0790 02698000
*       IF TESTRC>LASTCC04 THEN     /*                       @Z40LB30*/ 02699000
         C     TESTRC,@CF00042                                     0790 02700000
         BNH   @RF00790                                            0790 02701000
*         CC01=LASTCC12;            /*                       @Z40LB30*/ 02702000
*                                                                  0791 02703000
         LA    CC01,12                                             0791 02704000
*       /*************************************************************/ 02705000
*       /*                                                           */ 02706000
*       /* IF THE VOLUME CAN BE PROCESSED, PROCESS IT.       @Z40LB30*/ 02707000
*       /*                                                           */ 02708000
*       /*************************************************************/ 02709000
*                                                                  0792 02710000
*       ELSE                        /*                       @Z40LB30*/ 02711000
*         IF TESTRC=LASTCC00 THEN   /*                       @Z40LB30*/ 02712000
         B     @RC00790                                            0792 02713000
@RF00790 LTR   TESTRC,TESTRC                                       0792 02714000
         BNZ   @RF00792                                            0792 02715000
*           DO;                     /*                       @Z40LB30*/ 02716000
*                                                                  0793 02717000
*             /*******************************************************/ 02718000
*             /*                                                     */ 02719000
*             /* CALL PROCVOL TO PROCESS THE VOLUME. SAVE    @Z40LB30*/ 02720000
*             /* THE RETURN CODE. ACCUMULATE THE HIGHEST     @Z40LB30*/ 02721000
*             /* RETURN CODE IN THE INTERNAL CONDITION       @Z40LB30*/ 02722000
*             /* CODE AREA.                                  @Z40LB30*/ 02723000
*             /*                                                     */ 02724000
*             /*******************************************************/ 02725000
*                                                                  0794 02726000
*             CALL PROCVOL;         /*                       @Z40LB30*/ 02727000
         BAL   @14,PROCVOL                                         0794 02728000
*             RESPECIFY                                            0795 02729000
*               RTNREG RSTD;                                       0795 02730000
*             TESTRC=RTNREG;                                       0796 02731000
         LR    TESTRC,RTNREG                                       0796 02732000
*             RESPECIFY                                            0797 02733000
*               RTNREG UNRSTD;      /*                       @Z40LB30*/ 02734000
*             CC01=MAX(CC01,TESTRC);/*                       @Z40LB30*/ 02735000
*                                                                  0798 02736000
         CR    CC01,TESTRC                                         0798 02737000
         BNL   *+6                                                      02738000
         LR    CC01,TESTRC                                         0798 02739000
*             /*******************************************************/ 02740000
*             /*                                                     */ 02741000
*             /* IF THE RETURN CODE INDICATES THE VOLUME     @Z40LB30*/ 02742000
*             /* WAS PROCESSED, SET AN INDICATOR.            @Z40LB30*/ 02743000
*             /*                                                     */ 02744000
*             /*******************************************************/ 02745000
*                                                                  0799 02746000
*             IF TESTRC<LASTCC12 THEN/*                      @Z40LB30*/ 02747000
         C     TESTRC,@CF00035                                     0799 02748000
         BNL   @RF00799                                            0799 02749000
*               ONEDONE=ON;         /*                       @Z40LB30*/ 02750000
         OI    ONEDONE,B'10000000'                                 0800 02751000
*           END;                    /*                       @Z40LB30*/ 02752000
*                                                                  0801 02753000
@RF00799 DS    0H                                                  0802 02754000
*       /*************************************************************/ 02755000
*       /*                                                           */ 02756000
*       /* ISSUE UPRINT MACRO TO PRINT A BLANK LINE IN       @Z40LB30*/ 02757000
*       /* ORDER TO SPACE BETWEEN THE MESSAGES FOR EACH      @Z40LB30*/ 02758000
*       /* VOLUME                                            @Z40LB30*/ 02759000
*       /*                                                           */ 02760000
*       /*************************************************************/ 02761000
*                                                                  0802 02762000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 02763000
@RF00792 DS    0H                                                  0802 02764000
@RC00790 XC    DARGAREA(28),DARGAREA                               0802 02765000
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/ 02766000
         L     @08,DDSTRU                                          0803 02767000
         MVC   DARGSMOD(3,@08),@CC01420                            0803 02768000
*       DARGSENT=BLANKS;            /*                       @Z40LB30*/ 02769000
         MVI   DARGSENT(@08),X'06'                                 0804 02770000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 02771000
*                                                                  0805 02772000
         L     @08,@PC00001                                        0805 02773000
         ST    @08,@AL00001                                        0805 02774000
         LA    @02,@CF00116                                        0805 02775000
         ST    @02,@AL00001+4                                      0805 02776000
         LA    @02,DDSTRU                                          0805 02777000
         ST    @02,@AL00001+8                                      0805 02778000
         MVI   @AL00001+8,X'80'                                    0805 02779000
         L     @15,GDTPRT(,@08)                                    0805 02780000
         LA    @01,@AL00001                                        0805 02781000
         BALR  @14,@15                                             0805 02782000
*       /*************************************************************/ 02783000
*       /*                                                           */ 02784000
*       /* SET THE VOLUME SERIAL IN THE IEZRVVI ARGUMENT     @Z40LB30*/ 02785000
*       /* LIST TO THE SERIAL IN THE CURRENT BASE VOLUME     @Z40LB30*/ 02786000
*       /* RECORD IN PREPARATION FOR READING THE NEXT        @Z40LB30*/ 02787000
*       /* RECORD.                                           @Z40LB30*/ 02788000
*       /*                                                           */ 02789000
*       /*************************************************************/ 02790000
*                                                                  0806 02791000
*       RVVOLUME=BASSERNO;          /*                       @Z40LB30*/ 02792000
         L     @08,RVVIPTR                                         0806 02793000
         MVC   RVVOLUME(6,@08),BASSERNO(BASEVPTR)                  0806 02794000
*       RVVSVOL=ON;                 /*                       @Z40LB30*/ 02795000
*                                                                  0807 02796000
         OI    RVVSVOL(@08),B'00000001'                            0807 02797000
*       /*************************************************************/ 02798000
*       /*                                                           */ 02799000
*       /* ISSUE USSC TO READ THE NEXT RECORD. SAVE THE      @Z40LB30*/ 02800000
*       /* RETURN CODE.                                      @Z40LB30*/ 02801000
*       /*                                                           */ 02802000
*       /*************************************************************/ 02803000
*                                                                  0808 02804000
*       CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE);/*        @Z40LB30*/ 02805000
         L     @08,@PC00001                                        0808 02806000
         ST    @08,@AL00001                                        0808 02807000
         LA    @02,VVIC                                            0808 02808000
         ST    @02,@AL00001+4                                      0808 02809000
         LA    @02,RVVIPTR                                         0808 02810000
         ST    @02,@AL00001+8                                      0808 02811000
         LA    @02,VVICODE                                         0808 02812000
         ST    @02,@AL00001+12                                     0808 02813000
         MVI   @AL00001+12,X'80'                                   0808 02814000
         L     @15,GDTSSC(,@08)                                    0808 02815000
         LA    @01,@AL00001                                        0808 02816000
         BALR  @14,@15                                             0808 02817000
*       RESPECIFY                                                  0809 02818000
*         RTNREG RSTD;                                             0809 02819000
*       TESTRC=RTNREG;                                             0810 02820000
         LR    TESTRC,RTNREG                                       0810 02821000
*       RESPECIFY                                                  0811 02822000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 02823000
*                                                                  0811 02824000
*       /*************************************************************/ 02825000
*       /*                                                           */ 02826000
*       /* IF THE RETURN CODES INDICATE AN ERROR OCCURRED,   @Z40LB30*/ 02827000
*       /* CALL THE SSCMSG PROCEDURE TO PRINT THE REASON     @Z40LB30*/ 02828000
*       /* CODE AND THEN PRINT MESSAGE IDC2109I TO SAY NO    @Z40LB30*/ 02829000
*       /* MORE VOLUMES COULD BE PROCESSED.                  @Z40LB30*/ 02830000
*       /*                                                           */ 02831000
*       /*************************************************************/ 02832000
*                                                                  0812 02833000
*       IF TESTRC^=0&VVICODE^=NORECORD&/*                    @Z40LB30*/ 02834000
*           VVICODE^=NOACTIVE THEN  /*                       @Z40LB30*/ 02835000
         LTR   TESTRC,TESTRC                                       0812 02836000
         BZ    @RF00812                                            0812 02837000
         L     @08,VVICODE                                         0812 02838000
         C     @08,@CF01473                                        0812 02839000
         BE    @RF00812                                            0812 02840000
         C     @08,@CF01475                                        0812 02841000
         BE    @RF00812                                            0812 02842000
*         DO;                       /*                       @Z40LB30*/ 02843000
*           CALL SSCMSG(VVICODE);   /*                       @Z40LB30*/ 02844000
         LA    @08,VVICODE                                         0814 02845000
         ST    @08,@AL00001                                        0814 02846000
         LA    @01,@AL00001                                        0814 02847000
         BAL   @14,SSCMSG                                          0814 02848000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 02849000
         XC    DARGAREA(28),DARGAREA                               0815 02850000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 02851000
         L     @08,DDSTRU                                          0816 02852000
         MVC   DARGSMOD(3,@08),@CC01418                            0816 02853000
*           DARGSENT=MSG2109I;      /*                       @Z40LB30*/ 02854000
         MVI   DARGSENT(@08),X'41'                                 0817 02855000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 02856000
*                                                                  0818 02857000
         L     @08,@PC00001                                        0818 02858000
         ST    @08,@AL00001                                        0818 02859000
         LA    @15,@CF00116                                        0818 02860000
         ST    @15,@AL00001+4                                      0818 02861000
         LA    @15,DDSTRU                                          0818 02862000
         ST    @15,@AL00001+8                                      0818 02863000
         MVI   @AL00001+8,X'80'                                    0818 02864000
         L     @15,GDTPRT(,@08)                                    0818 02865000
         LA    @01,@AL00001                                        0818 02866000
         BALR  @14,@15                                             0818 02867000
*           /*********************************************************/ 02868000
*           /*                                                       */ 02869000
*           /* SET THE INTERNAL CONDITION CODE.              @Z40LB30*/ 02870000
*           /*                                                       */ 02871000
*           /*********************************************************/ 02872000
*                                                                  0819 02873000
*           CC01=LASTCC12;          /*                       @Z40LB30*/ 02874000
         LA    CC01,12                                             0819 02875000
*         END;                      /*                       @Z40LB30*/ 02876000
*     END;                          /*                       @Z40LB30*/ 02877000
@RF00812 DS    0H                                                  0821 02878000
@DE00785 L     @08,VVICODE                                         0821 02879000
         LTR   @08,@08                                             0821 02880000
         BZ    @DL00785                                            0821 02881000
*                                                                  0822 02882000
*   /*****************************************************************/ 02883000
*   /*                                                               */ 02884000
*   /* IF A RECORD WAS NOT RETURNED BY THE FIRST READ,       @Z40LB30*/ 02885000
*   /* DETERMINE IF IT WAS AN ERROR OR IF THERE ARE NO       @Z40LB30*/ 02886000
*   /* ACTIVE VOLUME RECORDS IN THE INVENTORY.               @Z40LB30*/ 02887000
*   /*                                                               */ 02888000
*   /*****************************************************************/ 02889000
*                                                                  0822 02890000
*   ELSE                            /*                       @Z40LB30*/ 02891000
*                                                                  0822 02892000
*     /***************************************************************/ 02893000
*     /*                                                             */ 02894000
*     /* IF THE RETURN CODE INDICATES NO ACTIVE VOLUME       @Z40LB30*/ 02895000
*     /* RECORDS, PRINT MESSAGE IDC0104I.                    @Z40LB30*/ 02896000
*     /*                                                             */ 02897000
*     /***************************************************************/ 02898000
*                                                                  0822 02899000
*     IF VVICODE=NORECORD|VVICODE=NOACTIVE THEN/*            @Z40LB30*/ 02900000
         B     @RC00784                                            0822 02901000
@RF00784 L     @08,VVICODE                                         0822 02902000
         C     @08,@CF01473                                        0822 02903000
         BE    @RT00822                                            0822 02904000
         C     @08,@CF01475                                        0822 02905000
         BNE   @RF00822                                            0822 02906000
@RT00822 DS    0H                                                  0823 02907000
*       DO;                         /*                       @Z40LB30*/ 02908000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 02909000
         XC    DARGAREA(28),DARGAREA                               0824 02910000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 02911000
         L     @08,DDSTRU                                          0825 02912000
         MVC   DARGSMOD(3,@08),@CC01418                            0825 02913000
*         DARGSENT=MSG0104I;        /*                       @Z40LB30*/ 02914000
         MVI   DARGSENT(@08),X'3C'                                 0826 02915000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 02916000
         L     @08,@PC00001                                        0827 02917000
         ST    @08,@AL00001                                        0827 02918000
         LA    @05,@CF00116                                        0827 02919000
         ST    @05,@AL00001+4                                      0827 02920000
         LA    @05,DDSTRU                                          0827 02921000
         ST    @05,@AL00001+8                                      0827 02922000
         MVI   @AL00001+8,X'80'                                    0827 02923000
         L     @15,GDTPRT(,@08)                                    0827 02924000
         LA    @01,@AL00001                                        0827 02925000
         BALR  @14,@15                                             0827 02926000
*       END;                        /*                       @Z40LB30*/ 02927000
*                                                                  0828 02928000
*   /*****************************************************************/ 02929000
*   /*                                                               */ 02930000
*   /* IF AN ERROR OCCURRED, CALL SSCMSG TO PRINT THE        @Z40LB30*/ 02931000
*   /* REASON CODE AND PRINT MESSAGE IDC2109I TO SAY NO      @Z40LB30*/ 02932000
*   /* MORE VOLUMES CAN BE PROCESSED.                        @Z40LB30*/ 02933000
*   /*                                                               */ 02934000
*   /*****************************************************************/ 02935000
*                                                                  0829 02936000
*     ELSE                          /*                       @Z40LB30*/ 02937000
*       DO;                         /*                       @Z40LB30*/ 02938000
         B     @RC00822                                            0829 02939000
@RF00822 DS    0H                                                  0830 02940000
*         CALL SSCMSG(VVICODE);     /*                       @Z40LB30*/ 02941000
         LA    @08,VVICODE                                         0830 02942000
         ST    @08,@AL00001                                        0830 02943000
         LA    @01,@AL00001                                        0830 02944000
         BAL   @14,SSCMSG                                          0830 02945000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 02946000
         XC    DARGAREA(28),DARGAREA                               0831 02947000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 02948000
         L     @08,DDSTRU                                          0832 02949000
         MVC   DARGSMOD(3,@08),@CC01418                            0832 02950000
*         DARGSENT=MSG2109I;        /*                       @Z40LB30*/ 02951000
         MVI   DARGSENT(@08),X'41'                                 0833 02952000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 02953000
*                                                                  0834 02954000
         L     @08,@PC00001                                        0834 02955000
         ST    @08,@AL00001                                        0834 02956000
         LA    @05,@CF00116                                        0834 02957000
         ST    @05,@AL00001+4                                      0834 02958000
         LA    @05,DDSTRU                                          0834 02959000
         ST    @05,@AL00001+8                                      0834 02960000
         MVI   @AL00001+8,X'80'                                    0834 02961000
         L     @15,GDTPRT(,@08)                                    0834 02962000
         LA    @01,@AL00001                                        0834 02963000
         BALR  @14,@15                                             0834 02964000
*         /***********************************************************/ 02965000
*         /*                                                         */ 02966000
*         /* SET THE INTERNAL CONDITION CODE TO INDICATE NO  @Z40LB30*/ 02967000
*         /* VOLUMES PROCESSED.                              @Z40LB30*/ 02968000
*         /*                                                         */ 02969000
*         /***********************************************************/ 02970000
*                                                                  0835 02971000
*         CC01=LASTCC12;            /*                       @Z40LB30*/ 02972000
         LA    CC01,12                                             0835 02973000
*       END;                        /*                       @Z40LB30*/ 02974000
*                                                                  0837 02975000
*   /*****************************************************************/ 02976000
*   /*                                                               */ 02977000
*   /* IF THE FINAL CONDITON CODE INDICATES A SEVERE ERROR   @Z40LB30*/ 02978000
*   /* THAT PREVENTED A VOLUME FROM BEING PROCESSED, CHECK   @Z40LB30*/ 02979000
*   /* IF AT LEAST ONE VOLUME WAS PROCESSED. IF AT LEAST     @Z40LB30*/ 02980000
*   /* ONE VOLUME WAS PROCESSED, LOWER THE FINAL CONDITION   @Z40LB30*/ 02981000
*   /* CODE.                                                 @Z40LB30*/ 02982000
*   /*                                                               */ 02983000
*   /*****************************************************************/ 02984000
*                                                                  0837 02985000
*   IF CC01=LASTCC12&ONEDONE=ON THEN/*                       @Z40LB30*/ 02986000
@RC00822 DS    0H                                                  0837 02987000
@RC00784 C     CC01,@CF00035                                       0837 02988000
         BNE   @RF00837                                            0837 02989000
         TM    ONEDONE,B'10000000'                                 0837 02990000
         BNO   @RF00837                                            0837 02991000
*     CC01=LASTCC08;                /*                       @Z40LB30*/ 02992000
*                                                                  0838 02993000
         LA    CC01,8                                              0838 02994000
*   /*****************************************************************/ 02995000
*   /*                                                               */ 02996000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 02997000
*   /*                                                               */ 02998000
*   /*****************************************************************/ 02999000
*                                                                  0839 03000000
*   RETURN CODE(CC01);              /*                       @Z40LB30*/ 03001000
@RF00837 LR    @15,CC01                                            0839 03002000
@EL00006 DS    0H                                                  0839 03003000
@EF00006 DS    0H                                                  0839 03004000
@ER00006 L     @14,@SA00006                                        0839 03005000
         BR    @14                                                 0839 03006000
*   END ALLVOLS;                    /*                       @Z40LB30*/ 03007000
*                                                                  0841 03008000
*/********************************************************** @Z40LB30*/ 03009000
*/*                                                          @Z40LB30*/ 03010000
*/* PROCEDURE - RDGRPCHN                                     @Z40LB30*/ 03011000
*/*                                                          @Z40LB30*/ 03012000
*/* FUNCTION - READ THE NEXT ACTIVE AND, OPTIONALLY, GENERAL @Z40LB30*/ 03013000
*/*           USE VOLUME RECORD IN A SPECIFIC GROUP.  IF     @Z40LB30*/ 03014000
*/*           THERE ARE NO ACTIVE AND, OPTIONALLY, GENERAL-  @Z40LB30*/ 03015000
*/*           USE VOLUMES IN THE GROUP, ISSUE MESSAGE        @Z40LB30*/ 03016000
*/*           IDC0105I OR MESSAGE IDC0106I.  IF A CHAIN      @Z40LB30*/ 03017000
*/*           ERROR OCCURS, ISSUE MESSAGE IDC2103I.  IF      @Z40LB30*/ 03018000
*/*           ANY READ ERROR OCCURS, ISSUE MESSAGE IDC2110I. @Z40LB30*/ 03019000
*/*                                                          @Z40LB30*/ 03020000
*/* INPUT - GROUP RECORD. POINTER TO BASE VOLUME RECORD      @Z40LB30*/ 03021000
*/*         (VOLPTR) SET WITH 0 IF NO VOLUME RECORDS HAVE    @Z40LB30*/ 03022000
*/*         BEEN READ YET OR SET WITH THE ADDRESS OF THE     @Z40LB30*/ 03023000
*/*         LAST VOLUME RECORD READ. FUNTION DEFINITION      @Z40LB30*/ 03024000
*/*         TABLE.                                           @Z40LB30*/ 03025000
*/*                                                          @Z40LB30*/ 03026000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS OCCURRED             @Z40LB30*/ 03027000
*/*                        4, AN ERROR OCCURRED              @Z40LB30*/ 03028000
*/*                                                          @Z40LB30*/ 03029000
*/*          POINTER TO VOLUME RECORD SET WITH 0 IF NO MORE  @Z40LB30*/ 03030000
*/*          RECORDS ARE IN THE GROUP OR SET WITH ADDRESS    @Z40LB30*/ 03031000
*/*          OF VOLUME RECORD JUST READ                      @Z40LB30*/ 03032000
*/*                                                          @Z40LB30*/ 03033000
*/********************************************************** @Z40LB30*/ 03034000
*                                                                  0841 03035000
*RDGRPCHN:                                                         0841 03036000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 03037000
RDGRPCHN ST    @14,@SA00007                                        0841 03038000
*                                                                  0842 03039000
*   /*****************************************************************/ 03040000
*   /*                                                               */ 03041000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE.    @Z40LB30*/ 03042000
*   /*                                                               */ 03043000
*   /*****************************************************************/ 03044000
*                                                                  0842 03045000
*   OLDERID2=NEWERID2;                                             0842 03046000
         L     @08,@PC00001                                        0842 03047000
         L     @06,GDTTR2(,@08)                                    0842 03048000
         MVC   @TS00001(95),NEWERID2(@06)                          0842 03049000
         MVC   OLDERID2(95,@06),@TS00001                           0842 03050000
*   NEWID2='SDRG';                  /*                       @Z40LB30*/ 03051000
*                                                                  0843 03052000
         MVC   NEWID2(4,@06),@CC01528                              0843 03053000
*   /*****************************************************************/ 03054000
*   /*                                                               */ 03055000
*   /* SET CONDITION CODE TO ZERO AND INITIALIZE INDICATOR   @Z40LB30*/ 03056000
*   /*                                                               */ 03057000
*   /*****************************************************************/ 03058000
*                                                                  0844 03059000
*   CC02=0;                         /*                       @Z40LB30*/ 03060000
         SLR   @15,@15                                             0844 03061000
         LR    CC02,@15                                            0844 03062000
*   NOVOLS=OFF;                     /*                       @Z40LB30*/ 03063000
         NI    NOVOLS,B'11101111'                                  0845 03064000
*                                                                  0846 03065000
*   /*****************************************************************/ 03066000
*   /*                                                               */ 03067000
*   /* IF NO BASE VOLUME RECORDS HAVE BEEN READ YET FOR      @Z40LB30*/ 03068000
*   /* THIS GROUP, CHECK FOR NO VOLUMES IN THE GROUP AND     @Z40LB30*/ 03069000
*   /* INITIALIZE THE IEZRVVI ARGUMENT LIST.                 @Z40LB30*/ 03070000
*   /*                                                               */ 03071000
*   /*****************************************************************/ 03072000
*                                                                  0846 03073000
*   IF VOLPTR=NULLPTR THEN          /*                       @Z40LB30*/ 03074000
         C     @15,VOLPTR                                          0846 03075000
         BNE   @RF00846                                            0846 03076000
*     DO;                           /*                       @Z40LB30*/ 03077000
*                                                                  0847 03078000
*       /*************************************************************/ 03079000
*       /*                                                           */ 03080000
*       /* IF GENERAL WAS SPECIFIED, BUT THERE ARE NO        @Z40LB30*/ 03081000
*       /* ACTIVE GENERAL VOLUMES IN THE GROUP, ISSUE        @Z40LB30*/ 03082000
*       /* MESSAGE IDC0106I.                                 @Z40LB30*/ 03083000
*       /*                                                           */ 03084000
*       /*************************************************************/ 03085000
*                                                                  0848 03086000
*       IF ADDR(GENER)^=NULLPTR&GRONGEN=0 THEN/*             @Z40LB30*/ 03087000
         L     @06,@PC00001+4                                      0848 03088000
         C     @15,FDTPTR+60(,@06)                                 0848 03089000
         BE    @RF00848                                            0848 03090000
         L     @06,GROUPPTR                                        0848 03091000
         CH    @15,GRONGEN(,@06)                                   0848 03092000
         BNE   @RF00848                                            0848 03093000
*         DO;                       /*                       @Z40LB30*/ 03094000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 03095000
         XC    DARGAREA(28),DARGAREA                               0850 03096000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 03097000
         L     @15,DDSTRU                                          0851 03098000
         MVC   DARGSMOD(3,@15),@CC01418                            0851 03099000
*           DARGSENT=MSG0106I;      /*                       @Z40LB30*/ 03100000
         MVI   DARGSENT(@15),X'3E'                                 0852 03101000
*           DARGDBP=ADDR(GROVVGRP); /*                       @Z40LB30*/ 03102000
         LA    @06,GROVVGRP(,@06)                                  0853 03103000
         ST    @06,DARGDBP(,@15)                                   0853 03104000
*           DARGILP=LENGTH(GROVVGRP);/*                      @Z40LB30*/ 03105000
         MVC   DARGILP(2,@15),@CH00181                             0854 03106000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 03107000
         ST    @08,@AL00001                                        0855 03108000
         LA    @06,@CF00116                                        0855 03109000
         ST    @06,@AL00001+4                                      0855 03110000
         LA    @06,DDSTRU                                          0855 03111000
         ST    @06,@AL00001+8                                      0855 03112000
         MVI   @AL00001+8,X'80'                                    0855 03113000
         L     @15,GDTPRT(,@08)                                    0855 03114000
         LA    @01,@AL00001                                        0855 03115000
         BALR  @14,@15                                             0855 03116000
*           NOVOLS=ON;              /*                       @Z40LB30*/ 03117000
         OI    NOVOLS,B'00010000'                                  0856 03118000
*         END;                      /*                       @Z40LB30*/ 03119000
*                                                                  0857 03120000
*       /*************************************************************/ 03121000
*       /*                                                           */ 03122000
*       /* IF GENERAL WAS NOT SPECIFIED, BUT THERE ARE NO    @Z40LB30*/ 03123000
*       /* ACTIVE GENERAL OR RESTRICTED VOLUMES IN THE GROUP @Z40LB30*/ 03124000
*       /* ISSUE MESSAGE IDC0105I.                           @Z40LB30*/ 03125000
*       /*                                                           */ 03126000
*       /*************************************************************/ 03127000
*                                                                  0858 03128000
*       IF ADDR(GENER)=NULLPTR&GRONGEN=0&/*                  @Z40LB30*/ 03129000
*           GRONRSTD=0 THEN         /*                       @Z40LB30*/ 03130000
@RF00848 SLR   @08,@08                                             0858 03131000
         L     @06,@PC00001+4                                      0858 03132000
         C     @08,FDTPTR+60(,@06)                                 0858 03133000
         BNE   @RF00858                                            0858 03134000
         L     @06,GROUPPTR                                        0858 03135000
         CH    @08,GRONGEN(,@06)                                   0858 03136000
         BNE   @RF00858                                            0858 03137000
         CH    @08,GRONRSTD(,@06)                                  0858 03138000
         BNE   @RF00858                                            0858 03139000
*         DO;                       /*                       @Z40LB30*/ 03140000
*           DARGAREA=''B;           /*                       @Z40LB30*/ 03141000
         XC    DARGAREA(28),DARGAREA                               0860 03142000
*           DARGSMOD=CM0MSG;        /*                       @Z40LB30*/ 03143000
         L     @08,DDSTRU                                          0861 03144000
         MVC   DARGSMOD(3,@08),@CC01418                            0861 03145000
*           DARGSENT=MSG0105I;      /*                       @Z40LB30*/ 03146000
         MVI   DARGSENT(@08),X'3D'                                 0862 03147000
*           DARGDBP=ADDR(GROVVGRP); /*                       @Z40LB30*/ 03148000
         LA    @06,GROVVGRP(,@06)                                  0863 03149000
         ST    @06,DARGDBP(,@08)                                   0863 03150000
*           DARGILP=LENGTH(GROVVGRP);/*                      @Z40LB30*/ 03151000
         MVC   DARGILP(2,@08),@CH00181                             0864 03152000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB30*/ 03153000
         L     @08,@PC00001                                        0865 03154000
         ST    @08,@AL00001                                        0865 03155000
         LA    @06,@CF00116                                        0865 03156000
         ST    @06,@AL00001+4                                      0865 03157000
         LA    @06,DDSTRU                                          0865 03158000
         ST    @06,@AL00001+8                                      0865 03159000
         MVI   @AL00001+8,X'80'                                    0865 03160000
         L     @15,GDTPRT(,@08)                                    0865 03161000
         LA    @01,@AL00001                                        0865 03162000
         BALR  @14,@15                                             0865 03163000
*           NOVOLS=ON;              /*                       @Z40LB30*/ 03164000
         OI    NOVOLS,B'00010000'                                  0866 03165000
*         END;                      /*                       @Z40LB30*/ 03166000
*                                                                  0867 03167000
*       /*************************************************************/ 03168000
*       /*                                                           */ 03169000
*       /* IF THERE ARE SOME VOLUMES IN THE GROUP, SET       @Z40LB30*/ 03170000
*       /* FIELDS IN THE IEZRVVI ARGUMENT LIST TO READ       @Z40LB30*/ 03171000
*       /* VOLUME RECORDS IN THE GROUP.                      @Z40LB30*/ 03172000
*       /*                                                           */ 03173000
*       /*************************************************************/ 03174000
*                                                                  0868 03175000
*       IF NOVOLS=OFF THEN          /*                       @Z40LB30*/ 03176000
@RF00858 TM    NOVOLS,B'00010000'                                  0868 03177000
         BNZ   @RF00868                                            0868 03178000
*         DO;                       /*                       @Z40LB30*/ 03179000
*           VOLRVVI=''B;            /*                       @Z40LB30*/ 03180000
         XC    VOLRVVI(68),VOLRVVI                                 0870 03181000
*           RVVIPTR=ADDR(VOLRVVI);  /*                       @Z40LB30*/ 03182000
         LA    @08,VOLRVVI                                         0871 03183000
         ST    @08,RVVIPTR                                         0871 03184000
*           RVVLNGTH=RVVLEN;        /*                       @Z40LB30*/ 03185000
         LH    @06,RVVLEN                                          0872 03186000
         ST    @06,RVVLNGTH(,@08)                                  0872 03187000
*           RVVCODE=RVVOP;          /*                       @Z40LB30*/ 03188000
         MVI   RVVCODE(@08),X'87'                                  0873 03189000
*           RVVGROUP=GROVVGRP;      /* GROUP NAME            @Z40LB30*/ 03190000
         L     @06,GROUPPTR                                        0874 03191000
         MVC   RVVGROUP(8,@08),GROVVGRP(@06)                       0874 03192000
*           RVVBUFLN=LENGTH(VOLREC);/*                       @Z40LB30*/ 03193000
         MVC   RVVBUFLN(2,@08),@CH01625                            0875 03194000
*           RVVRTBUF=ADDR(VOLREC);  /* ADDRESS OF BUFFER     @Z40LB30*/ 03195000
         LA    @15,VOLREC                                          0876 03196000
         ST    @15,RVVRTBUF(,@08)                                  0876 03197000
*           RVVRDCH=ON;             /* READ CHAIN            @Z40LB30*/ 03198000
         OI    RVVRDCH(@08),B'00100000'                            0877 03199000
*           RVVBVRCD=ON;            /* BASE VOLUME           @Z40LB30*/ 03200000
         OI    RVVBVRCD(@08),B'10000000'                           0878 03201000
*           RVVGPVOL=ON;            /* GROUPED CHAIN         @Z40LB30*/ 03202000
         OI    RVVGPVOL(@08),B'10000000'                           0879 03203000
*           RVVACTV=ON;             /* ONLY ACTIVE VOLUMES   @Z40LB30*/ 03204000
         OI    RVVACTV(@08),B'00000100'                            0880 03205000
*           RVVSGRP=ON;             /* GROUP NAME SPECIFIED  @Z40LB30*/ 03206000
*           RVVSVOL=ON;             /* VOLUME SPECIFIED      @Z40LB30*/ 03207000
         OI    RVVSGRP(@08),B'10000001'                            0882 03208000
*           RVVOLUME=GROFSN;        /* FIRST VOLUME IN CHAIN @Z40LB30*/ 03209000
*                                                                  0883 03210000
         MVC   RVVOLUME(6,@08),GROFSN(@06)                         0883 03211000
*           /*********************************************************/ 03212000
*           /*                                                       */ 03213000
*           /* IF ONLY GENERAL VOLUMES REQUESTED ON THE      @Z40LB30*/ 03214000
*           /* COMMAND, SPECIFY THAT.                        @Z40LB30*/ 03215000
*           /*                                                       */ 03216000
*           /*********************************************************/ 03217000
*                                                                  0884 03218000
*           IF ADDR(GENER)^=NULLPTR THEN/*                   @Z40LB30*/ 03219000
         L     @06,@PC00001+4                                      0884 03220000
         L     @06,FDTPTR+60(,@06)                                 0884 03221000
         LTR   @06,@06                                             0884 03222000
         BZ    @RF00884                                            0884 03223000
*             RVVGSVOL=ON;          /*                       @Z40LB30*/ 03224000
         OI    RVVGSVOL(@08),B'00100000'                           0885 03225000
*         END;                      /*                       @Z40LB30*/ 03226000
*                                                                  0886 03227000
@RF00884 DS    0H                                                  0887 03228000
*       /*************************************************************/ 03229000
*       /*                                                           */ 03230000
*       /* IF THERE ARE NO VOLUMES TO BE PROCESSED IN        @Z40LB30*/ 03231000
*       /* THIS GROUP, SET AN INDICATOR SO THE FINAL         @Z40LB30*/ 03232000
*       /* CONDITION CODE CAN BE SET TO REFLECT ONE          @Z40LB30*/ 03233000
*       /* GROUP WAS PROCESSED.                              @Z40LB30*/ 03234000
*       /*                                                           */ 03235000
*       /*************************************************************/ 03236000
*                                                                  0887 03237000
*       IF NOVOLS=ON THEN           /*                       @Z40LB30*/ 03238000
@RF00868 TM    NOVOLS,B'00010000'                                  0887 03239000
         BNO   @RF00887                                            0887 03240000
*         EMPTYGRP=ON;              /*                       @Z40LB30*/ 03241000
         OI    EMPTYGRP,B'00001000'                                0888 03242000
*     END;                          /*                       @Z40LB30*/ 03243000
*                                                                  0890 03244000
*   /*****************************************************************/ 03245000
*   /*                                                               */ 03246000
*   /* IF A BASE VOLUME RECORD IN THIS GROUP HAS BEEN READ   @Z40LB30*/ 03247000
*   /* PREVIOUSLY, CHECK IF THERE ARE ANY MORE VOLUMES IN    @Z40LB30*/ 03248000
*   /* THE GROUP.                                            @Z40LB30*/ 03249000
*   /*                                                               */ 03250000
*   /*****************************************************************/ 03251000
*                                                                  0890 03252000
*   ELSE                            /*                       @Z40LB30*/ 03253000
*                                                                  0890 03254000
*     /***************************************************************/ 03255000
*     /*                                                             */ 03256000
*     /* NO MORE VOLUMES                                     @Z40LB30*/ 03257000
*     /*                                                             */ 03258000
*     /***************************************************************/ 03259000
*                                                                  0890 03260000
*     IF BASLAST=ON THEN            /*                       @Z40LB30*/ 03261000
*                                                                  0890 03262000
         B     @RC00846                                            0890 03263000
@RF00846 TM    BASLAST(BASEVPTR),B'00001000'                       0890 03264000
         BNO   @RF00890                                            0890 03265000
*       /*************************************************************/ 03266000
*       /*                                                           */ 03267000
*       /* SET INDICATOR AND ZERO OUT THE POINTER TO THE     @Z40LB30*/ 03268000
*       /* VOLUME RECORD.                                    @Z40LB30*/ 03269000
*       /*                                                           */ 03270000
*       /*************************************************************/ 03271000
*                                                                  0891 03272000
*       DO;                         /*                       @Z40LB30*/ 03273000
*         NOVOLS=ON;                /*                       @Z40LB30*/ 03274000
         OI    NOVOLS,B'00010000'                                  0892 03275000
*         VOLPTR=NULLPTR;           /*                       @Z40LB30*/ 03276000
         SLR   @08,@08                                             0893 03277000
         ST    @08,VOLPTR                                          0893 03278000
*       END;                        /*                       @Z40LB30*/ 03279000
*                                                                  0894 03280000
*   /*****************************************************************/ 03281000
*   /*                                                               */ 03282000
*   /* MORE VOLUMES                                          @Z40LB30*/ 03283000
*   /*                                                               */ 03284000
*   /*****************************************************************/ 03285000
*                                                                  0895 03286000
*     ELSE                          /*                       @Z40LB30*/ 03287000
*                                                                  0895 03288000
*       /*************************************************************/ 03289000
*       /*                                                           */ 03290000
*       /* PUT THE NEXT VOLUME SERIAL INTO THE IEZRVVI       @Z40LB30*/ 03291000
*       /* ARGUMENT LIST                                     @Z40LB30*/ 03292000
*       /*                                                           */ 03293000
*       /*************************************************************/ 03294000
*                                                                  0895 03295000
*       DO;                         /*                       @Z40LB30*/ 03296000
         B     @RC00890                                            0895 03297000
@RF00890 DS    0H                                                  0896 03298000
*         RVVIPTR=ADDR(VOLRVVI);    /*                       @Z40LB30*/ 03299000
         LA    @08,VOLRVVI                                         0896 03300000
         ST    @08,RVVIPTR                                         0896 03301000
*         RVVSVOL=ON;               /*                       @Z40LB30*/ 03302000
         OI    RVVSVOL(@08),B'00000001'                            0897 03303000
*         RVVOLUME=BASNEXTV;        /*                       @Z40LB30*/ 03304000
         MVC   RVVOLUME(6,@08),BASNEXTV(BASEVPTR)                  0898 03305000
*       END;                        /*                       @Z40LB30*/ 03306000
*                                                                  0900 03307000
*   /*****************************************************************/ 03308000
*   /*                                                               */ 03309000
*   /* IF THERE ARE MORE VOLUMES IN THE GROUP, READ ONE.     @Z40LB30*/ 03310000
*   /*                                                               */ 03311000
*   /*****************************************************************/ 03312000
*                                                                  0900 03313000
*   IF NOVOLS=OFF THEN              /*                       @Z40LB30*/ 03314000
@RC00890 DS    0H                                                  0900 03315000
@RC00846 TM    NOVOLS,B'00010000'                                  0900 03316000
         BNZ   @RF00900                                            0900 03317000
*     DO;                           /*                       @Z40LB30*/ 03318000
*                                                                  0901 03319000
*       /*************************************************************/ 03320000
*       /*                                                           */ 03321000
*       /* ISSUE USSC TO READ THE NEXT RECORD. SAVE THE      @Z40LB30*/ 03322000
*       /* RETURN CODE.                                      @Z40LB30*/ 03323000
*       /*                                                           */ 03324000
*       /*************************************************************/ 03325000
*                                                                  0902 03326000
*       CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,VVICODE2);/*       @Z40LB30*/ 03327000
         L     @08,@PC00001                                        0902 03328000
         ST    @08,@AL00001                                        0902 03329000
         LA    @06,VVIC                                            0902 03330000
         ST    @06,@AL00001+4                                      0902 03331000
         LA    @06,RVVIPTR                                         0902 03332000
         ST    @06,@AL00001+8                                      0902 03333000
         LA    @06,VVICODE2                                        0902 03334000
         ST    @06,@AL00001+12                                     0902 03335000
         MVI   @AL00001+12,X'80'                                   0902 03336000
         L     @15,GDTSSC(,@08)                                    0902 03337000
         LA    @01,@AL00001                                        0902 03338000
         BALR  @14,@15                                             0902 03339000
*       RESPECIFY                                                  0903 03340000
*         RTNREG RSTD;                                             0903 03341000
*       TESTRC=RTNREG;                                             0904 03342000
         LR    TESTRC,RTNREG                                       0904 03343000
*       RESPECIFY                                                  0905 03344000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 03345000
*                                                                  0905 03346000
*       /*************************************************************/ 03347000
*       /*                                                           */ 03348000
*       /* IF NO ERROR, PUT ADDRESS OF RECORD IN POINTER     @Z40LB30*/ 03349000
*       /* AREA FOR CALLER.                                  @Z40LB30*/ 03350000
*       /*                                                           */ 03351000
*       /*************************************************************/ 03352000
*                                                                  0906 03353000
*       IF TESTRC=0 THEN            /*                       @Z40LB30*/ 03354000
         LTR   TESTRC,TESTRC                                       0906 03355000
         BNZ   @RF00906                                            0906 03356000
*         VOLPTR=ADDR(VOLREC);      /*                       @Z40LB30*/ 03357000
         LA    @08,VOLREC                                          0907 03358000
         ST    @08,VOLPTR                                          0907 03359000
*                                                                  0908 03360000
*       /*************************************************************/ 03361000
*       /*                                                           */ 03362000
*       /* IF NO RECORD WAS READ, CHECK FOR ERRORS.          @Z40LB30*/ 03363000
*       /*                                                           */ 03364000
*       /*************************************************************/ 03365000
*                                                                  0908 03366000
*       ELSE                        /*                       @Z40LB30*/ 03367000
*         DO;                       /*                       @Z40LB30*/ 03368000
*                                                                  0908 03369000
         B     @RC00906                                            0908 03370000
@RF00906 DS    0H                                                  0909 03371000
*           /*********************************************************/ 03372000
*           /*                                                       */ 03373000
*           /* SET VOLUME RECORD POINTER TO ZERO.            @Z40LB30*/ 03374000
*           /*                                                       */ 03375000
*           /*********************************************************/ 03376000
*                                                                  0909 03377000
*           VOLPTR=NULLPTR;         /*                       @Z40LB30*/ 03378000
*                                                                  0909 03379000
         SLR   @08,@08                                             0909 03380000
         ST    @08,VOLPTR                                          0909 03381000
*           /*********************************************************/ 03382000
*           /*                                                       */ 03383000
*           /* IF A REAL ERROR OCCURRED, PROCESS IT.         @Z40LB30*/ 03384000
*           /* NO MORE ACTIVE VOLUMES IS NOT AN ERROR.       @Z40LB30*/ 03385000
*           /*                                                       */ 03386000
*           /*********************************************************/ 03387000
*                                                                  0910 03388000
*           IF VVICODE2^=NOACTIVE THEN/*                     @Z40LB30*/ 03389000
         L     @08,VVICODE2                                        0910 03390000
         C     @08,@CF01475                                        0910 03391000
         BE    @RF00910                                            0910 03392000
*             DO;                   /*                       @Z40LB30*/ 03393000
*                                                                  0911 03394000
*               /*****************************************************/ 03395000
*               /*                                                   */ 03396000
*               /* IF CHAINING ERROR, ISSUE MESSAGE IDC2103I @Z40LB30*/ 03397000
*               /*                                                   */ 03398000
*               /*****************************************************/ 03399000
*                                                                  0912 03400000
*               IF VVICODE2=NORECORD|VVICODE2=WRONGCHN/*     @Z40LB30*/ 03401000
*                 THEN              /*                       @Z40LB30*/ 03402000
         C     @08,@CF01473                                        0912 03403000
         BE    @RT00912                                            0912 03404000
         C     @08,@CF01477                                        0912 03405000
         BNE   @RF00912                                            0912 03406000
@RT00912 DS    0H                                                  0913 03407000
*                 DO;               /*                       @Z40LB30*/ 03408000
*                   DARGAREA=''B;   /*                       @Z40LB30*/ 03409000
         XC    DARGAREA(28),DARGAREA                               0914 03410000
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/ 03411000
         L     @08,DDSTRU                                          0915 03412000
         MVC   DARGSMOD(3,@08),@CC01418                            0915 03413000
*                   DARGSENT=MSG2103I;/*                     @Z40LB30*/ 03414000
         MVI   DARGSENT(@08),X'3B'                                 0916 03415000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/ 03416000
         L     @08,@PC00001                                        0917 03417000
         ST    @08,@AL00001                                        0917 03418000
         LA    @15,@CF00116                                        0917 03419000
         ST    @15,@AL00001+4                                      0917 03420000
         LA    @15,DDSTRU                                          0917 03421000
         ST    @15,@AL00001+8                                      0917 03422000
         MVI   @AL00001+8,X'80'                                    0917 03423000
         L     @15,GDTPRT(,@08)                                    0917 03424000
         LA    @01,@AL00001                                        0917 03425000
         BALR  @14,@15                                             0917 03426000
*                 END;              /*                       @Z40LB30*/ 03427000
*                                                                  0918 03428000
*               /*****************************************************/ 03429000
*               /*                                                   */ 03430000
*               /* IF ANOTHER ERROR, CALL SSCMSG TO PRINT    @Z40LB30*/ 03431000
*               /* REASON CODE.                              @Z40LB30*/ 03432000
*               /*                                                   */ 03433000
*               /*****************************************************/ 03434000
*                                                                  0919 03435000
*               ELSE                /*                       @Z40LB30*/ 03436000
*                 CALL SSCMSG(VVICODE2);/*                   @Z40LB30*/ 03437000
*                                                                  0919 03438000
         B     @RC00912                                            0919 03439000
@RF00912 LA    @08,VVICODE2                                        0919 03440000
         ST    @08,@AL00001                                        0919 03441000
         LA    @01,@AL00001                                        0919 03442000
         BAL   @14,SSCMSG                                          0919 03443000
*               /*****************************************************/ 03444000
*               /*                                                   */ 03445000
*               /* FOLLOW WITH MESSAGE IDC2110I TO SAY NO    @Z40LB30*/ 03446000
*               /* MORE VOLUMES IN THE GROUP CAN BE          @Z40LB30*/ 03447000
*               /* PROCESSED.                                @Z40LB30*/ 03448000
*               /*                                                   */ 03449000
*               /*****************************************************/ 03450000
*                                                                  0920 03451000
*               DARGAREA=''B;       /*                       @Z40LB30*/ 03452000
@RC00912 XC    DARGAREA(28),DARGAREA                               0920 03453000
*               DARGSMOD=CM0MSG;    /*                       @Z40LB30*/ 03454000
         L     @08,DDSTRU                                          0921 03455000
         MVC   DARGSMOD(3,@08),@CC01418                            0921 03456000
*               DARGSENT=MSG2110I;  /*                       @Z40LB30*/ 03457000
         MVI   DARGSENT(@08),X'42'                                 0922 03458000
*               DARGDBP=ADDR(GROVVGRP);/*                    @Z40LB30*/ 03459000
         L     @06,GROUPPTR                                        0923 03460000
         LA    @06,GROVVGRP(,@06)                                  0923 03461000
         ST    @06,DARGDBP(,@08)                                   0923 03462000
*               DARGILP=LENGTH(GROVVGRP);/*                  @Z40LB30*/ 03463000
         MVC   DARGILP(2,@08),@CH00181                             0924 03464000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB30*/ 03465000
*                                                                  0925 03466000
         L     @08,@PC00001                                        0925 03467000
         ST    @08,@AL00001                                        0925 03468000
         LA    @06,@CF00116                                        0925 03469000
         ST    @06,@AL00001+4                                      0925 03470000
         LA    @06,DDSTRU                                          0925 03471000
         ST    @06,@AL00001+8                                      0925 03472000
         MVI   @AL00001+8,X'80'                                    0925 03473000
         L     @15,GDTPRT(,@08)                                    0925 03474000
         LA    @01,@AL00001                                        0925 03475000
         BALR  @14,@15                                             0925 03476000
*               /*****************************************************/ 03477000
*               /*                                                   */ 03478000
*               /* SET CONDITION CODE                        @Z40LB30*/ 03479000
*               /*                                                   */ 03480000
*               /*****************************************************/ 03481000
*                                                                  0926 03482000
*               CC02=4;             /*                       @Z40LB30*/ 03483000
         LA    CC02,4                                              0926 03484000
*             END;                  /*                       @Z40LB30*/ 03485000
*         END;                      /*                       @Z40LB30*/ 03486000
@RF00910 DS    0H                                                  0929 03487000
*     END;                          /*                       @Z40LB30*/ 03488000
*                                                                  0929 03489000
@RC00906 DS    0H                                                  0930 03490000
*   /*****************************************************************/ 03491000
*   /*                                                               */ 03492000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 03493000
*   /*                                                               */ 03494000
*   /*****************************************************************/ 03495000
*                                                                  0930 03496000
*   RETURN CODE(CC02);              /*                       @Z40LB30*/ 03497000
@RF00900 LR    @15,CC02                                            0930 03498000
@EL00007 DS    0H                                                  0930 03499000
@EF00007 DS    0H                                                  0930 03500000
@ER00007 L     @14,@SA00007                                        0930 03501000
         BR    @14                                                 0930 03502000
*   END RDGRPCHN;                   /*                       @Z40LB30*/ 03503000
*                                                                  0932 03504000
*/*********************************************************  @Z40LB30*/ 03505000
*/*                                                          @Z40LB30*/ 03506000
*/* PROCEDURE NAME - CKRECEXC                                @Z40LB30*/ 03507000
*/*                                                          @Z40LB30*/ 03508000
*/* FUNCTION - CHECK THE INVENTORY VOLUME RECORD TO DETERMINE@Z40LB30*/ 03509000
*/*            IF ANY RECOVERY FLAGS ARE SET AND CHECK TO    @Z40LB30*/ 03510000
*/*            SEE IF THE SCRDSET COMMAND INDICATED THE      @Z40LB30*/ 03511000
*/*            VOLUME IS TO BE EXCLUDED.                     @Z40LB30*/ 03512000
*/*                                                          @Z40LB30*/ 03513000
*/* INPUT - FUNCTIONAL DATA TABLE, INVENTORY VOLUME RECORD.  @Z40LB30*/ 03514000
*/*                                                          @Z40LB30*/ 03515000
*/* OUTPUT - REGISTER 15 - 0, NO ERRORS                      @Z40LB30*/ 03516000
*/*                        4, VOLUME EXCLUDED BY COMMAND     @Z40LB30*/ 03517000
*/*                       12, VOLUME CANNOT BE PROCESSED     @Z40LB30*/ 03518000
*/*                           BECAUSE RECOVERY FLAGS ARE SET @Z40LB30*/ 03519000
*/*                                                          @Z40LB30*/ 03520000
*/***********************************************************@Z40LB30*/ 03521000
*                                                                  0932 03522000
*CKRECEXC:                                                         0932 03523000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 03524000
CKRECEXC ST    @14,@SA00008                                        0932 03525000
*                                                                  0933 03526000
*   /*****************************************************************/ 03527000
*   /*                                                               */ 03528000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 03529000
*   /*                                                               */ 03530000
*   /*****************************************************************/ 03531000
*                                                                  0933 03532000
*   OLDERID2=NEWERID2;                                             0933 03533000
         L     @08,@PC00001                                        0933 03534000
         L     @08,GDTTR2(,@08)                                    0933 03535000
         MVC   @TS00001(95),NEWERID2(@08)                          0933 03536000
         MVC   OLDERID2(95,@08),@TS00001                           0933 03537000
*   NEWID2='SDCK';                  /*                       @Z40LB30*/ 03538000
*                                                                  0934 03539000
         MVC   NEWID2(4,@08),@CC01532                              0934 03540000
*   /*****************************************************************/ 03541000
*   /*                                                               */ 03542000
*   /* SET THE INTERNAL CONDITION CODE TO 0                  @Z40LB30*/ 03543000
*   /*                                                               */ 03544000
*   /*****************************************************************/ 03545000
*                                                                  0935 03546000
*   CC02=LASTCC00;                  /*                       @Z40LB30*/ 03547000
*                                                                  0935 03548000
         SLR   @08,@08                                             0935 03549000
         LR    CC02,@08                                            0935 03550000
*   /*****************************************************************/ 03551000
*   /*                                                               */ 03552000
*   /* CHECK IF VOLUME WAS SPECIFIED ON THE EXCLUDEVOLUME    @Z40LB30*/ 03553000
*   /* PARAMETER                                             @Z40LB30*/ 03554000
*   /*                                                               */ 03555000
*   /*****************************************************************/ 03556000
*                                                                  0936 03557000
*   IF ADDR(EXVOL)^=NULLPTR THEN    /*                       @Z40LB30*/ 03558000
         L     @06,@PC00001+4                                      0936 03559000
         C     @08,FDTPTR+52(,@06)                                 0936 03560000
         BE    @RF00936                                            0936 03561000
*     DO;                           /*                       @Z40LB30*/ 03562000
*       DO INDEX1=1 TO EXVOLCNT WHILE EXVOLVAL(INDEX1)/*     @Z40LB30*/ 03563000
*             ^=BASSERNO;           /*                       @Z40LB30*/ 03564000
         LA    INDEX1,1                                            0938 03565000
         B     @DE00938                                            0938 03566000
@DL00938 LR    @08,INDEX1                                          0938 03567000
         SLA   @08,3                                               0938 03568000
         L     @06,@PC00001+4                                      0938 03569000
         L     @06,FDTPTR+52(,@06)                                 0938 03570000
         ALR   @06,@08                                             0938 03571000
         AL    @06,@CF01643                                        0938 03572000
         CLC   EXVOLVAL-3(6,@06),BASSERNO(BASEVPTR)                0938 03573000
         BE    @DC00938                                            0938 03574000
*       END;                        /*                       @Z40LB30*/ 03575000
*                                                                  0939 03576000
         AL    INDEX1,@CF00221                                     0939 03577000
@DE00938 L     @08,@PC00001+4                                      0939 03578000
         L     @08,FDTPTR+52(,@08)                                 0939 03579000
         CH    INDEX1,EXVOLCNT(,@08)                               0939 03580000
         BNH   @DL00938                                            0939 03581000
@DC00938 DS    0H                                                  0940 03582000
*       /*************************************************************/ 03583000
*       /*                                                           */ 03584000
*       /* IF THE VOLUME SERIAL WAS FOUND ON THE EXCLUDE     @Z40LB30*/ 03585000
*       /* LIST, SET THE RETURN CODE                         @Z40LB30*/ 03586000
*       /*                                                           */ 03587000
*       /*************************************************************/ 03588000
*                                                                  0940 03589000
*       IF INDEX1<=EXVOLCNT THEN    /*                       @Z40LB30*/ 03590000
         L     @08,@PC00001+4                                      0940 03591000
         L     @08,FDTPTR+52(,@08)                                 0940 03592000
         CH    INDEX1,EXVOLCNT(,@08)                               0940 03593000
         BH    @RF00940                                            0940 03594000
*         CC02=LASTCC04;            /*                       @Z40LB30*/ 03595000
         LA    CC02,4                                              0941 03596000
*     END;                          /*                       @Z40LB30*/ 03597000
@RF00940 DS    0H                                                  0943 03598000
*                                                                  0943 03599000
*   /*****************************************************************/ 03600000
*   /*                                                               */ 03601000
*   /* IF THE VOLUME WAS NOT EXCLUDED, CHECK THE VOLUME      @Z40LB30*/ 03602000
*   /* RECORD TO SEE IF ANY UTILITY RECOVERY FLAGS ARE ON.   @Z40LB30*/ 03603000
*   /*                                                               */ 03604000
*   /*****************************************************************/ 03605000
*                                                                  0943 03606000
*   IF CC02=LASTCC00&BASSATIA^=0 THEN/*                      @Z40LB30*/ 03607000
@RF00936 LTR   CC02,CC02                                           0943 03608000
         BNZ   @RF00943                                            0943 03609000
         LH    @08,BASSATIA(,BASEVPTR)                             0943 03610000
         N     @08,@CF01648                                        0943 03611000
         LTR   @08,@08                                             0943 03612000
         BZ    @RF00943                                            0943 03613000
*     DO;                           /*                       @Z40LB30*/ 03614000
*                                                                  0944 03615000
*       /*************************************************************/ 03616000
*       /*                                                           */ 03617000
*       /* SET UP TO ISSUE A MESSAGE SAYING WHICH RECOVERY   @Z40LB30*/ 03618000
*       /* FLAG IS SET                                       @Z40LB30*/ 03619000
*       /*                                                           */ 03620000
*       /*************************************************************/ 03621000
*                                                                  0945 03622000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 03623000
         XC    DARGAREA(28),DARGAREA                               0945 03624000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/ 03625000
         L     @08,DDSTRU                                          0946 03626000
         MVC   DARGSMOD(3,@08),@CC01418                            0946 03627000
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB30*/ 03628000
         LA    @15,BASSERNO(,BASEVPTR)                             0947 03629000
         ST    @15,DARGDBP(,@08)                                   0947 03630000
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB30*/ 03631000
*                                                                  0948 03632000
         MVC   DARGILP(2,@08),@CH00158                             0948 03633000
*       /*************************************************************/ 03634000
*       /*                                                           */ 03635000
*       /* IF THE VOLUME WAS INCOMPLETELY RENAMED, ISSUE     @Z40LB30*/ 03636000
*       /* MESSAGE IDC2095I                                  @Z40LB30*/ 03637000
*       /*                                                           */ 03638000
*       /*************************************************************/ 03639000
*                                                                  0949 03640000
*       IF BASVSMIS=ON THEN         /*                       @Z40LB30*/ 03641000
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0949 03642000
         BNO   @RF00949                                            0949 03643000
*         DARGSENT=MSG2095I;        /*                       @Z40LB30*/ 03644000
*                                                                  0950 03645000
         MVI   DARGSENT(@08),X'09'                                 0950 03646000
*       /*************************************************************/ 03647000
*       /*                                                           */ 03648000
*       /* IF THE VOLUME WAS INCOMPLETELY COPIED, ISSUE      @Z40LB30*/ 03649000
*       /* MESSAGE IDC2096I                                  @Z40LB30*/ 03650000
*       /*                                                           */ 03651000
*       /*************************************************************/ 03652000
*                                                                  0951 03653000
*       ELSE                        /*                       @Z40LB30*/ 03654000
*         IF BASIVCPY=ON THEN       /*                       @Z40LB30*/ 03655000
         B     @RC00949                                            0951 03656000
@RF00949 TM    BASIVCPY(BASEVPTR),B'01000000'                      0951 03657000
         BNO   @RF00951                                            0951 03658000
*           DARGSENT=MSG2096I;      /*                       @Z40LB30*/ 03659000
*                                                                  0952 03660000
         L     @08,DDSTRU                                          0952 03661000
         MVI   DARGSENT(@08),X'06'                                 0952 03662000
*       /*************************************************************/ 03663000
*       /*                                                           */ 03664000
*       /* THE VOLUME MUST BE INCOMPLETELY CREATED,          @Z40LB30*/ 03665000
*       /* SO ISSUE MESSAGE IDC2097I                         @Z40LB30*/ 03666000
*       /*                                                           */ 03667000
*       /*************************************************************/ 03668000
*                                                                  0953 03669000
*         ELSE                      /*                       @Z40LB30*/ 03670000
*           DARGSENT=MSG2097I;      /*                       @Z40LB30*/ 03671000
*                                                                  0953 03672000
         B     @RC00951                                            0953 03673000
@RF00951 L     @08,DDSTRU                                          0953 03674000
         MVI   DARGSENT(@08),X'03'                                 0953 03675000
*       /*************************************************************/ 03676000
*       /*                                                           */ 03677000
*       /* ISSUE UPRINT                                      @Z40LB30*/ 03678000
*       /*                                                           */ 03679000
*       /*************************************************************/ 03680000
*                                                                  0954 03681000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 03682000
*                                                                  0954 03683000
@RC00951 DS    0H                                                  0954 03684000
@RC00949 L     @08,@PC00001                                        0954 03685000
         ST    @08,@AL00001                                        0954 03686000
         LA    @06,@CF00116                                        0954 03687000
         ST    @06,@AL00001+4                                      0954 03688000
         LA    @06,DDSTRU                                          0954 03689000
         ST    @06,@AL00001+8                                      0954 03690000
         MVI   @AL00001+8,X'80'                                    0954 03691000
         L     @15,GDTPRT(,@08)                                    0954 03692000
         LA    @01,@AL00001                                        0954 03693000
         BALR  @14,@15                                             0954 03694000
*       /*************************************************************/ 03695000
*       /*                                                           */ 03696000
*       /* FOLLOW WITH SECONDARY MESSAGE IDC2108I            @Z40LB30*/ 03697000
*       /* TO INDICATE THE VOLUME WAS NOT PROCESSED          @Z40LB30*/ 03698000
*       /*                                                           */ 03699000
*       /*************************************************************/ 03700000
*                                                                  0955 03701000
*       DARGSENT=MSG2108I;          /*                       @Z40LB30*/ 03702000
         L     @08,DDSTRU                                          0955 03703000
         MVI   DARGSENT(@08),X'40'                                 0955 03704000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 03705000
*                                                                  0956 03706000
         L     @08,@PC00001                                        0956 03707000
         ST    @08,@AL00001                                        0956 03708000
         LA    @06,@CF00116                                        0956 03709000
         ST    @06,@AL00001+4                                      0956 03710000
         LA    @06,DDSTRU                                          0956 03711000
         ST    @06,@AL00001+8                                      0956 03712000
         MVI   @AL00001+8,X'80'                                    0956 03713000
         L     @15,GDTPRT(,@08)                                    0956 03714000
         LA    @01,@AL00001                                        0956 03715000
         BALR  @14,@15                                             0956 03716000
*       /*************************************************************/ 03717000
*       /*                                                           */ 03718000
*       /* SET CONDITION CODE                                @Z40LB30*/ 03719000
*       /*                                                           */ 03720000
*       /*************************************************************/ 03721000
*                                                                  0957 03722000
*       CC02=LASTCC12;              /*                       @Z40LB30*/ 03723000
         LA    CC02,12                                             0957 03724000
*     END;                          /*                       @Z40LB30*/ 03725000
*                                                                  0958 03726000
*   /*****************************************************************/ 03727000
*   /*                                                               */ 03728000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 03729000
*   /*                                                               */ 03730000
*   /*****************************************************************/ 03731000
*                                                                  0959 03732000
*   RETURN CODE(CC02);              /*                       @Z40LB30*/ 03733000
@RF00943 LR    @15,CC02                                            0959 03734000
@EL00008 DS    0H                                                  0959 03735000
@EF00008 DS    0H                                                  0959 03736000
@ER00008 L     @14,@SA00008                                        0959 03737000
         BR    @14                                                 0959 03738000
*   END CKRECEXC;                   /*                       @Z40LB30*/ 03739000
*                                                                  0961 03740000
*/********************************************************** @Z40LB30*/ 03741000
*/*                                                          @Z40LB30*/ 03742000
*/* PROCEDURE NAME - PROCVOL                                 @Z40LB30*/ 03743000
*/*                                                          @Z40LB30*/ 03744000
*/* FUNCTION - CONTROLS THE SCRATCH AND UNCATALOG OF ELIGI-  @Z40LB30*/ 03745000
*/*            BLE DATA SETS FROM A PARTICULAR VOLUME. CALLS @Z40LB30*/ 03746000
*/*            PROCEDURES TO ALLOCATE A UNIT, SELECT ELIGI-  @Z40LB30*/ 03747000
*/*            BLE DATA SETS, AND SCRATCH AND UNCATALOG THE  @Z40LB30*/ 03748000
*/*            DATA SETS.  THIS PROCEDURE THEN FREES STORAGE @Z40LB30*/ 03749000
*/*            AND DEALLOCATES THE UNIT IF NECESSARY.  AT    @Z40LB30*/ 03750000
*/*            START, ISSUES MESSAGE IDC0810I OR IDC0815I    @Z40LB30*/ 03751000
*/*            TO INDICATE WHICH VOLUME IS BEING PROCESSED.  @Z40LB30*/ 03752000
*/*                                                          @Z40LB30*/ 03753000
*/* INPUT - INVENTORY VOLUME RECORD, GROUP RECORD            @Z40LB30*/ 03754000
*/*                                                          @Z40LB30*/ 03755000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/ 03756000
*/*                        4, DEALLOCATION OR VTOC CLOSE     @Z40LB30*/ 03757000
*/*                           ERROR                          @Z40LB30*/ 03758000
*/*                        8, ERROR PREVENTED SOME DATA SETS @Z40LB30*/ 03759000
*/*                           FROM BEING SCRATCHED BUT SOME  @Z40LB30*/ 03760000
*/*                           DATA SETS WERE SCRATCHED       @Z40LB30*/ 03761000
*/*                       12, THE ENTIRE VOLUME COULD NOT    @Z40LB30*/ 03762000
*/*                           BE PROCESSED DUE TO ERRORS     @Z40LB30*/ 03763000
*/*                                                          @Z40LB30*/ 03764000
*/********************************************************** @Z40LB30*/ 03765000
*                                                                  0961 03766000
*PROCVOL:                                                          0961 03767000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 03768000
PROCVOL  ST    @14,@SA00009                                        0961 03769000
*                                                                  0962 03770000
*   /*****************************************************************/ 03771000
*   /*                                                               */ 03772000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 03773000
*   /*                                                               */ 03774000
*   /*****************************************************************/ 03775000
*                                                                  0962 03776000
*   OLDERID2=NEWERID2;                                             0962 03777000
         L     @08,@PC00001                                        0962 03778000
         L     @08,GDTTR2(,@08)                                    0962 03779000
         MVC   @TS00001(95),NEWERID2(@08)                          0962 03780000
         MVC   OLDERID2(95,@08),@TS00001                           0962 03781000
*   NEWID2='SDPV';                  /*                       @Z40LB30*/ 03782000
*                                                                  0963 03783000
         MVC   NEWID2(4,@08),@CC01536                              0963 03784000
*   /*****************************************************************/ 03785000
*   /*                                                               */ 03786000
*   /* INITIALIZE INTERNAL CONDITION CODE TO 0               @Z40LB30*/ 03787000
*   /*                                                               */ 03788000
*   /*****************************************************************/ 03789000
*                                                                  0964 03790000
*   CC02=LASTCC00;                  /*                       @Z40LB30*/ 03791000
*                                                                  0964 03792000
         SLR   @08,@08                                             0964 03793000
         LR    CC02,@08                                            0964 03794000
*   /*****************************************************************/ 03795000
*   /*                                                               */ 03796000
*   /* SET UP TO ISSUE A MESSAGE TO INDICATE WHICH VOLUME    @Z40LB30*/ 03797000
*   /* IS BEING PROCESSED. GET THE VOLUME SERIAL FROM THE    @Z40LB30*/ 03798000
*   /* INVENTORY VOLUME RECORD.                              @Z40LB30*/ 03799000
*   /*                                                               */ 03800000
*   /*****************************************************************/ 03801000
*                                                                  0965 03802000
*   DARGAREA=''B;                   /*                       @Z40LB30*/ 03803000
         XC    DARGAREA(28),DARGAREA                               0965 03804000
*   DARGSMOD=SD01MSG;               /*                       @Z40LB30*/ 03805000
         L     @15,DDSTRU                                          0966 03806000
         MVC   DARGSMOD(3,@15),@CC01420                            0966 03807000
*   DARGDBP=ADDR(BASSERNO);         /*                       @Z40LB30*/ 03808000
         LA    @14,BASSERNO(,BASEVPTR)                             0967 03809000
         ST    @14,DARGDBP(,@15)                                   0967 03810000
*   DARGILP=LENGTH(BASSERNO);       /*                       @Z40LB30*/ 03811000
*                                                                  0968 03812000
         MVC   DARGILP(2,@15),@CH00158                             0968 03813000
*   /*****************************************************************/ 03814000
*   /*                                                               */ 03815000
*   /* IF A GROUP IS BEING PROCESSED, ISSUE MESSAGE          @Z40LB30*/ 03816000
*   /* IDC0815I, INSERTING THE GROUP NAME FROM THE           @Z40LB30*/ 03817000
*   /* INVENTORY GROUP RECORD                                @Z40LB30*/ 03818000
*   /*                                                               */ 03819000
*   /*****************************************************************/ 03820000
*                                                                  0969 03821000
*   IF ADDR(GRP)^=NULLPTR|ADDR(AGRP)^=NULLPTR THEN/*         @Z40LB30*/ 03822000
         L     @15,@PC00001+4                                      0969 03823000
         C     @08,FDTPTR+4(,@15)                                  0969 03824000
         BNE   @RT00969                                            0969 03825000
         C     @08,FDTPTR+12(,@15)                                 0969 03826000
         BE    @RF00969                                            0969 03827000
@RT00969 DS    0H                                                  0970 03828000
*     DO;                           /*                       @Z40LB30*/ 03829000
*       DARGSENT=MSG0815I;          /*                       @Z40LB30*/ 03830000
         L     @08,DDSTRU                                          0971 03831000
         MVI   DARGSENT(@08),X'07'                                 0971 03832000
*       DARGCNT=1;                  /*                       @Z40LB30*/ 03833000
         LA    @15,1                                               0972 03834000
         STH   @15,DARGCNT(,@08)                                   0972 03835000
*       DARGINS(1)=1;               /*                       @Z40LB30*/ 03836000
         STH   @15,DARGINS(,@08)                                   0973 03837000
*       DARGINL(1)=LENGTH(GROVVGRP);/*                       @Z40LB30*/ 03838000
         MVC   DARGINL(2,@08),@CH00181                             0974 03839000
*       DARGDTM(1)=ADDR(GROVVGRP);  /*                       @Z40LB30*/ 03840000
         L     @01,GROUPPTR                                        0975 03841000
         LA    @15,GROVVGRP(,@01)                                  0975 03842000
         ST    @15,DARGDTM(,@08)                                   0975 03843000
*     END;                          /*                       @Z40LB30*/ 03844000
*                                                                  0976 03845000
*   /*****************************************************************/ 03846000
*   /*                                                               */ 03847000
*   /* IF A GROUP IS NOT BEING PROCESSED, ISSUE MESSAGE      @Z40LB30*/ 03848000
*   /* IDC0810I                                              @Z40LB30*/ 03849000
*   /*                                                               */ 03850000
*   /*****************************************************************/ 03851000
*                                                                  0977 03852000
*   ELSE                            /*                       @Z40LB30*/ 03853000
*     DARGSENT=MSG0810I;            /*                       @Z40LB30*/ 03854000
         B     @RC00969                                            0977 03855000
@RF00969 L     @08,DDSTRU                                          0977 03856000
         MVI   DARGSENT(@08),X'01'                                 0977 03857000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB30*/ 03858000
@RC00969 L     @08,@PC00001                                        0978 03859000
         ST    @08,@AL00001                                        0978 03860000
         LA    @15,@CF00116                                        0978 03861000
         ST    @15,@AL00001+4                                      0978 03862000
         LA    @15,DDSTRU                                          0978 03863000
         ST    @15,@AL00001+8                                      0978 03864000
         MVI   @AL00001+8,X'80'                                    0978 03865000
         L     @15,GDTPRT(,@08)                                    0978 03866000
         LA    @01,@AL00001                                        0978 03867000
         BALR  @14,@15                                             0978 03868000
*                                                                  0979 03869000
*   /*****************************************************************/ 03870000
*   /*                                                               */ 03871000
*   /* CALL THE ALLOCATE PROCEDURE TO DETERMINE THE DD       @Z40LB30*/ 03872000
*   /* TO USE TO MOUNT THE VOLUME. SAVE THE RETURN CODE      @Z40LB30*/ 03873000
*   /*                                                               */ 03874000
*   /*****************************************************************/ 03875000
*                                                                  0979 03876000
*   CALL ALLOCATE;                  /*                       @Z40LB30*/ 03877000
         BAL   @14,ALLOCATE                                        0979 03878000
*   RESPECIFY                                                      0980 03879000
*     RTNREG RSTD;                                                 0980 03880000
*   TESTRC=RTNREG;                                                 0981 03881000
         LR    TESTRC,RTNREG                                       0981 03882000
*   RESPECIFY                                                      0982 03883000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 03884000
*   CC02=TESTRC;                    /*                       @Z40LB30*/ 03885000
         LR    CC02,TESTRC                                         0983 03886000
*                                                                  0984 03887000
*   /*****************************************************************/ 03888000
*   /*                                                               */ 03889000
*   /* IF ALLOCATE WAS SUCCESSFUL, CONTINUE.                 @Z40LB30*/ 03890000
*   /*                                                               */ 03891000
*   /*****************************************************************/ 03892000
*                                                                  0984 03893000
*   IF CC02=LASTCC00 THEN           /*                       @Z40LB30*/ 03894000
         LTR   CC02,CC02                                           0984 03895000
         BNZ   @RF00984                                            0984 03896000
*     DO;                           /*                       @Z40LB30*/ 03897000
*                                                                  0985 03898000
*       /*************************************************************/ 03899000
*       /*                                                           */ 03900000
*       /* CALL SELECTOR TO SELECT ELIGIBLE DATA SETS.       @Z40LB30*/ 03901000
*       /* SAVE THE RETURN CODE.                             @Z40LB30*/ 03902000
*       /*                                                           */ 03903000
*       /*************************************************************/ 03904000
*                                                                  0986 03905000
*       CALL SELECTOR;              /*                       @Z40LB30*/ 03906000
         BAL   @14,SELECTOR                                        0986 03907000
*       RESPECIFY                                                  0987 03908000
*         RTNREG RSTD;                                             0987 03909000
*       TESTRC=RTNREG;                                             0988 03910000
         LR    TESTRC,RTNREG                                       0988 03911000
*       RESPECIFY                                                  0989 03912000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 03913000
*       CC02=TESTRC;                /*                       @Z40LB30*/ 03914000
*                                                                  0990 03915000
         LR    CC02,TESTRC                                         0990 03916000
*       /*************************************************************/ 03917000
*       /*                                                           */ 03918000
*       /* IF THE RETURN CODE INDICATES A LIST OF ELIGIBLE   @Z40LB30*/ 03919000
*       /* DATA SETS WAS RETURNED, CONTINUE.                 @Z40LB30*/ 03920000
*       /*                                                           */ 03921000
*       /*************************************************************/ 03922000
*                                                                  0991 03923000
*       IF CC02<LASTCC12 THEN       /*                       @Z40LB30*/ 03924000
         C     CC02,@CF00035                                       0991 03925000
         BNL   @RF00991                                            0991 03926000
*         DO;                       /*                       @Z40LB30*/ 03927000
*                                                                  0992 03928000
*           /*********************************************************/ 03929000
*           /*                                                       */ 03930000
*           /* CALL SCRUNCAT PROCEDURE TO SCRATCH AND        @Z40LB30*/ 03931000
*           /* UNCATALOG THE DATA SETS. SAVE THE RETURN      @Z40LB30*/ 03932000
*           /* CODE.                                         @Z40LB30*/ 03933000
*           /*                                                       */ 03934000
*           /*********************************************************/ 03935000
*                                                                  0993 03936000
*           CALL SCRUNCAT;          /*                       @Z40LB30*/ 03937000
         BAL   @14,SCRUNCAT                                        0993 03938000
*           RESPECIFY                                              0994 03939000
*             RTNREG RSTD;                                         0994 03940000
*           TESTRC=RTNREG;                                         0995 03941000
         LR    TESTRC,RTNREG                                       0995 03942000
*           RESPECIFY                                              0996 03943000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 03944000
*                                                                  0996 03945000
*           /*********************************************************/ 03946000
*           /*                                                       */ 03947000
*           /* SET THE INTERNAL CONDITION CODE TO THE RETURN @Z40LB30*/ 03948000
*           /* CODE FROM SCRUNCAT IF IT IS HIGHER.           @Z40LB30*/ 03949000
*           /*                                                       */ 03950000
*           /*********************************************************/ 03951000
*                                                                  0997 03952000
*           CC02=MAX(CC02,TESTRC);  /*                       @Z40LB30*/ 03953000
*                                                                  0997 03954000
         CR    CC02,TESTRC                                         0997 03955000
         BNL   *+6                                                      03956000
         LR    CC02,TESTRC                                         0997 03957000
*           /*********************************************************/ 03958000
*           /*                                                       */ 03959000
*           /* IF THE INTERNAL CODE IS 8, INDICATING DATA    @Z40LB30*/ 03960000
*           /* SET ERRORS, AND NO DATA SETS COULD BE         @Z40LB30*/ 03961000
*           /* SELECTED, INCREASE THE INTERNAL CONDITION     @Z40LB30*/ 03962000
*           /* CODE TO 12.                                   @Z40LB30*/ 03963000
*           /*                                                       */ 03964000
*           /*********************************************************/ 03965000
*                                                                  0998 03966000
*           RESPECIFY                                              0998 03967000
*             VSDBLOCK BASED(LISTADDR);/*                    @Z40LB30*/ 03968000
*           IF CC02=LASTCC08&VSDELEM=0 THEN/*                @Z40LB30*/ 03969000
         C     CC02,@CF00181                                       0999 03970000
         BNE   @RF00999                                            0999 03971000
         L     @08,LISTADDR                                        0999 03972000
         L     @08,VSDELEM(,@08)                                   0999 03973000
         LTR   @08,@08                                             0999 03974000
         BNZ   @RF00999                                            0999 03975000
*             CC02=LASTCC12;        /*                       @Z40LB30*/ 03976000
         LA    CC02,12                                             1000 03977000
*         END;                      /*                       @Z40LB30*/ 03978000
*                                                                  1001 03979000
@RF00999 DS    0H                                                  1002 03980000
*       /*************************************************************/ 03981000
*       /*                                                           */ 03982000
*       /* IF SELECTOR CAUSED STORAGE TO BE OBTAINED,        @Z40LB30*/ 03983000
*       /* ISSUE UFPOOL MACRO TO FREE IT.                    @Z40LB30*/ 03984000
*       /*                                                           */ 03985000
*       /*************************************************************/ 03986000
*                                                                  1002 03987000
*       IF LISTADDR^=NULLPTR THEN   /*                       @Z40LB30*/ 03988000
@RF00991 L     @08,LISTADDR                                        1002 03989000
         LTR   @08,@08                                             1002 03990000
         BZ    @RF01002                                            1002 03991000
*         CALL IDCSAFP0(GDTTBL,POOLID);/*                    @Z40LB30*/ 03992000
*                                                                  1003 03993000
         L     @08,@PC00001                                        1003 03994000
         ST    @08,@AL00001                                        1003 03995000
         LA    @06,@CC01467                                        1003 03996000
         ST    @06,@AL00001+4                                      1003 03997000
         MVI   @AL00001+4,X'80'                                    1003 03998000
         L     @15,GDTFPL(,@08)                                    1003 03999000
         LA    @01,@AL00001                                        1003 04000000
         BALR  @14,@15                                             1003 04001000
*       /*************************************************************/ 04002000
*       /*                                                           */ 04003000
*       /* IF THE ALLOCATE PROCEDURE DYNAMICALLY ALLOCATED   @Z40LB30*/ 04004000
*       /* A UNIT, ISSUE UDEALLOC MACRO TO DEALLOCATE IT.    @Z40LB30*/ 04005000
*       /* SAVE THE RETURN CODE.                             @Z40LB30*/ 04006000
*       /*                                                           */ 04007000
*       /*************************************************************/ 04008000
*                                                                  1004 04009000
*       IF ALOCFLAG=ON THEN         /*                       @Z40LB30*/ 04010000
@RF01002 TM    ALOCFLAG,B'10000000'                                1004 04011000
         BNO   @RF01004                                            1004 04012000
*         DO;                       /*                       @Z40LB30*/ 04013000
*           RESPECIFY                                              1006 04014000
*             ALLAGL BASED(ADDR(ALOCAREA));/*                @Z40LB30*/ 04015000
*           CALL IDCSADL0(GDTTBL,ALLAGL);/*                  @Z40LB30*/ 04016000
         L     @08,@PC00001                                        1007 04017000
         ST    @08,@AL00001                                        1007 04018000
         LA    @06,ALOCAREA                                        1007 04019000
         ST    @06,@AL00001+4                                      1007 04020000
         MVI   @AL00001+4,X'80'                                    1007 04021000
         L     @15,GDTDLC(,@08)                                    1007 04022000
         LA    @01,@AL00001                                        1007 04023000
         BALR  @14,@15                                             1007 04024000
*           RESPECIFY                                              1008 04025000
*             RTNREG RSTD;                                         1008 04026000
*           TESTRC=RTNREG;                                         1009 04027000
         LR    TESTRC,RTNREG                                       1009 04028000
*           RESPECIFY                                              1010 04029000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 04030000
*                                                                  1010 04031000
*           /*********************************************************/ 04032000
*           /*                                                       */ 04033000
*           /* IF UDEALLOC FAILED, SET THE INTERNAL          @Z40LB30*/ 04034000
*           /* CONDITION CODE.                               @Z40LB30*/ 04035000
*           /*                                                       */ 04036000
*           /*********************************************************/ 04037000
*                                                                  1011 04038000
*           IF TESTRC^=0 THEN       /*                       @Z40LB30*/ 04039000
         LTR   TESTRC,TESTRC                                       1011 04040000
         BZ    @RF01011                                            1011 04041000
*             CC02=MAX(LASTCC04,CC02);/*                     @Z40LB30*/ 04042000
         LA    @08,4                                               1012 04043000
         CR    CC02,@08                                            1012 04044000
         BNL   *+6                                                      04045000
         LR    CC02,@08                                            1012 04046000
*         END;                      /*                       @Z40LB30*/ 04047000
@RF01011 DS    0H                                                  1014 04048000
*     END;                          /*                       @Z40LB30*/ 04049000
@RF01004 DS    0H                                                  1015 04050000
*                                                                  1015 04051000
*   /*****************************************************************/ 04052000
*   /*                                                               */ 04053000
*   /* RETURN TO THE CALLER                                  @Z40LB30*/ 04054000
*   /*                                                               */ 04055000
*   /*****************************************************************/ 04056000
*                                                                  1015 04057000
*   RETURN CODE(CC02);              /*                       @Z40LB30*/ 04058000
@RF00984 LR    @15,CC02                                            1015 04059000
@EL00009 DS    0H                                                  1015 04060000
@EF00009 DS    0H                                                  1015 04061000
@ER00009 L     @14,@SA00009                                        1015 04062000
         BR    @14                                                 1015 04063000
*   END PROCVOL;                    /*                       @Z40LB30*/ 04064000
*                                                                  1017 04065000
*/********************************************************** @Z40LB30*/ 04066000
*/*                                                          @Z40LB30*/ 04067000
*/* PROCEDURE - ALLOCATE                                     @Z40LB30*/ 04068000
*/*                                                          @Z40LB30*/ 04069000
*/* FUNCTION - DETERMINE THE DD TO USE TO MOUNT THE VOLUME   @Z40LB30*/ 04070000
*/*            ON.  CHECK THE DD TO DETERMINE IF THE UNIT IS @Z40LB30*/ 04071000
*/*            VIRTUAL.  DYNAMICALLY ALLOCATE THE VOLUME IF  @Z40LB30*/ 04072000
*/*            NECESSARY.  ISSUE MESSAGE IDC2108I IF THE     @Z40LB30*/ 04073000
*/*            VOLUME CAN NOT BE PROCESSED.                  @Z40LB30*/ 04074000
*/*                                                          @Z40LB30*/ 04075000
*/* INPUT - INVENTORY BASE RECORD                            @Z40LB30*/ 04076000
*/*                                                          @Z40LB30*/ 04077000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/ 04078000
*/*                       12, EITHER THE UNIT ALLOCATED TO   @Z40LB30*/ 04079000
*/*                           THE VOLUME IS NOT VIRTUAL OR   @Z40LB30*/ 04080000
*/*                           DYNAMIC ALLOCATION FAILED      @Z40LB30*/ 04081000
*/*                                                          @Z40LB30*/ 04082000
*/*         ALOCFLAG SET ON IF VOLUME WAS DYNAMICALLY        @Z40LB30*/ 04083000
*/*          ALLOCATED, OTHERWISE, SET OFF.                  @Z40LB30*/ 04084000
*/*          DDNAME FIELD SET WITH DD NAME IF RETURN CODE    @Z40LB30*/ 04085000
*/*          IS 0.                                           @Z40LB30*/ 04086000
*/*                                                          @Z40LB30*/ 04087000
*/*          ADDRUCB SET TO ZERO OR SET WITH THE ADDRESS OF  @Z40LB30*/ 04088000
*/*          THE UCB OF A UNIT SELECTED FOR USE              @Z40LB30*/ 04089000
*/*                                                          @Z40LB30*/ 04090000
*/********************************************************** @Z40LB30*/ 04091000
*                                                                  1017 04092000
*ALLOCATE:                                                         1017 04093000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 04094000
ALLOCATE ST    @14,@SA00010                                        1017 04095000
*                                                                  1018 04096000
*   /*****************************************************************/ 04097000
*   /*                                                               */ 04098000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 04099000
*   /*                                                               */ 04100000
*   /*****************************************************************/ 04101000
*                                                                  1018 04102000
*   OLDERID2=NEWERID2;                                             1018 04103000
         L     @02,@PC00001                                        1018 04104000
         L     @15,GDTTR2(,@02)                                    1018 04105000
         MVC   @TS00001(95),NEWERID2(@15)                          1018 04106000
         MVC   OLDERID2(95,@15),@TS00001                           1018 04107000
*   NEWID2='SDAL';                  /*                       @Z40LB30*/ 04108000
*                                                                  1019 04109000
         MVC   NEWID2(4,@15),@CC01546                              1019 04110000
*   /*****************************************************************/ 04111000
*   /*                                                               */ 04112000
*   /* SET INTERNAL CONDITION CODE TO 0                      @Z40LB30*/ 04113000
*   /*                                                               */ 04114000
*   /*****************************************************************/ 04115000
*                                                                  1020 04116000
*   CC03=LASTCC00;                  /*                       @Z40LB30*/ 04117000
*                                                                  1020 04118000
         SLR   @15,@15                                             1020 04119000
         LR    CC03,@15                                            1020 04120000
*   /*****************************************************************/ 04121000
*   /*                                                               */ 04122000
*   /* SET FLAG TO INDICATE NO DYNAMIC ALLOCATION            @Z40LB30*/ 04123000
*   /*                                                               */ 04124000
*   /*****************************************************************/ 04125000
*                                                                  1021 04126000
*   ALOCFLAG=OFF;                   /*                       @Z40LB30*/ 04127000
*                                                                  1021 04128000
         NI    ALOCFLAG,B'01111111'                                1021 04129000
*   /*****************************************************************/ 04130000
*   /*                                                               */ 04131000
*   /* ISSUE UMSSUNIT MACRO TO DETERMINE IF THE VOLUME IS    @Z40LB30*/ 04132000
*   /* MOUNTED. SAVE THE RETURN CODE.                        @Z40LB30*/ 04133000
*   /*                                                               */ 04134000
*   /*****************************************************************/ 04135000
*                                                                  1022 04136000
*   RESPECIFY                                                      1022 04137000
*     SELAGL BASED(ADDR(SLTAREA));  /*                       @Z40LB30*/ 04138000
*   SELAGL=''B;                     /* SET TO ZERO           @Z40LB30*/ 04139000
         LA    @14,SLTAREA                                         1023 04140000
         XC    SELAGL(23,@14),SELAGL(@14)                          1023 04141000
*   SELUCBP=ADDR(ADDRUCB);          /* UCB TO BE RETURNED    @Z40LB30*/ 04142000
         LA    @07,ADDRUCB                                         1024 04143000
         ST    @07,SELUCBP(,@14)                                   1024 04144000
*   ADDRUCB=NULLPTR;                /*                       @Z40LB30*/ 04145000
         ST    @15,ADDRUCB                                         1025 04146000
*   SELDDNP=ADDR(DDNAME);           /* DD TO BE RETURNED     @Z40LB30*/ 04147000
         LA    @15,DDNAME                                          1026 04148000
         ST    @15,SELDDNP(,@14)                                   1026 04149000
*   SELVOL=BASSERNO;                /* VOLUME SERIAL         @Z40LB30*/ 04150000
         MVC   SELVOL(6,@14),BASSERNO(BASEVPTR)                    1027 04151000
*   CALL IDCSA060(GDTTBL,SELECTDD,SELAGL);/*                 @Z40LB30*/ 04152000
         ST    @02,@AL00001                                        1028 04153000
         LA    @15,SELECTDD                                        1028 04154000
         ST    @15,@AL00001+4                                      1028 04155000
         ST    @14,@AL00001+8                                      1028 04156000
         MVI   @AL00001+8,X'80'                                    1028 04157000
         L     @15,GDTUNT(,@02)                                    1028 04158000
         LA    @01,@AL00001                                        1028 04159000
         BALR  @14,@15                                             1028 04160000
*   RESPECIFY                                                      1029 04161000
*     RTNREG RSTD;                                                 1029 04162000
*   TESTRC=RTNREG;                                                 1030 04163000
         LR    TESTRC,RTNREG                                       1030 04164000
*   RESPECIFY                                                      1031 04165000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 04166000
*                                                                  1031 04167000
*   /*****************************************************************/ 04168000
*   /*                                                               */ 04169000
*   /* IF A DD WAS FOUND BY UMSSUNIT, ISSUE UMSSUNIT MACRO   @Z40LB30*/ 04170000
*   /* TO CHECK THAT THE UNIT IS VIRTUAL. SAVE THE RETURN    @Z40LB30*/ 04171000
*   /* CODE.                                                 @Z40LB30*/ 04172000
*   /*                                                               */ 04173000
*   /*****************************************************************/ 04174000
*                                                                  1032 04175000
*   IF TESTRC=0 THEN                /*                       @Z40LB30*/ 04176000
         LTR   TESTRC,TESTRC                                       1032 04177000
         BNZ   @RF01032                                            1032 04178000
*     DO;                           /*                       @Z40LB30*/ 04179000
*       RESPECIFY                                                  1034 04180000
*         CKAGL BASED(ADDR(CHKAREA));/*                      @Z40LB30*/ 04181000
*       CKAGL=''B;                  /*                       @Z40LB30*/ 04182000
         LA    @02,CHKAREA                                         1035 04183000
         XC    CKAGL(29,@02),CKAGL(@02)                            1035 04184000
*       CKUCBPTR=ADDR(ADDRUCB);     /*                       @Z40LB30*/ 04185000
         LA    @15,ADDRUCB                                         1036 04186000
         ST    @15,CKUCBPTR(,@02)                                  1036 04187000
*       CKDDNAME=DDNAME;            /*                       @Z40LB30*/ 04188000
         MVC   CKDDNAME(8,@02),DDNAME                              1037 04189000
*       CKTESTVT=ON;                /*                       @Z40LB30*/ 04190000
         OI    CKTESTVT(@02),B'10000000'                           1038 04191000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Z40LB30*/ 04192000
         L     @15,@PC00001                                        1039 04193000
         ST    @15,@AL00001                                        1039 04194000
         LA    @14,CHECK                                           1039 04195000
         ST    @14,@AL00001+4                                      1039 04196000
         ST    @02,@AL00001+8                                      1039 04197000
         MVI   @AL00001+8,X'80'                                    1039 04198000
         L     @15,GDTUNT(,@15)                                    1039 04199000
         LA    @01,@AL00001                                        1039 04200000
         BALR  @14,@15                                             1039 04201000
*       RESPECIFY                                                  1040 04202000
*         RTNREG RSTD;                                             1040 04203000
*       TESTRC=RTNREG;                                             1041 04204000
         LR    TESTRC,RTNREG                                       1041 04205000
*       RESPECIFY                                                  1042 04206000
*         RTNREG UNRSTD;            /*                       @Z40LB30*/ 04207000
*                                                                  1042 04208000
*       /*************************************************************/ 04209000
*       /*                                                           */ 04210000
*       /* IF AN ERROR WAS FOUND, SET THE INTERNAL           @Z40LB30*/ 04211000
*       /* CONDITION CODE.                                   @Z40LB30*/ 04212000
*       /*                                                           */ 04213000
*       /*************************************************************/ 04214000
*                                                                  1043 04215000
*       IF TESTRC^=0 THEN           /*                       @Z40LB30*/ 04216000
         LTR   TESTRC,TESTRC                                       1043 04217000
         BZ    @RF01043                                            1043 04218000
*         CC03=LASTCC12;            /*                       @Z40LB30*/ 04219000
         LA    CC03,12                                             1044 04220000
*     END;                          /*                       @Z40LB30*/ 04221000
*                                                                  1046 04222000
*   /*****************************************************************/ 04223000
*   /*                                                               */ 04224000
*   /* IF NO DD WAS FOUND, CONTINUE                          @Z40LB30*/ 04225000
*   /*                                                               */ 04226000
*   /*****************************************************************/ 04227000
*                                                                  1046 04228000
*   ELSE                            /*                       @Z40LB30*/ 04229000
*     DO;                           /*                       @Z40LB30*/ 04230000
*                                                                  1046 04231000
         B     @RC01032                                            1046 04232000
@RF01032 DS    0H                                                  1047 04233000
*       /*************************************************************/ 04234000
*       /*                                                           */ 04235000
*       /* IF THE FILE PARAMETER WAS SPECIFIED ON THE        @Z40LB30*/ 04236000
*       /* COMMAND, RETURN IT TO THE CALLER.                 @Z40LB30*/ 04237000
*       /*                                                           */ 04238000
*       /*************************************************************/ 04239000
*                                                                  1047 04240000
*       IF ADDR(FILE)^=NULLPTR THEN /*                       @Z40LB30*/ 04241000
         L     @15,@PC00001+4                                      1047 04242000
         L     @15,FDTPTR+44(,@15)                                 1047 04243000
         LTR   @15,@15                                             1047 04244000
         BZ    @RF01047                                            1047 04245000
*         DDNAME=FILEVAL;           /*                       @Z40LB30*/ 04246000
*                                                                  1048 04247000
         MVC   DDNAME(8),FILEVAL(@15)                              1048 04248000
*       /*************************************************************/ 04249000
*       /*                                                           */ 04250000
*       /* IF THE FILE PARAMETER WAS NOT SPECIFIED, ISSUE    @Z40LB30*/ 04251000
*       /* THE UALLOC MACRO TO DYNAMICALLY ALLOCATE A UNIT.  @Z40LB30*/ 04252000
*       /* SAVE THE RETURN CODE.                             @Z40LB30*/ 04253000
*       /*                                                           */ 04254000
*       /*************************************************************/ 04255000
*                                                                  1049 04256000
*       ELSE                        /*                       @Z40LB30*/ 04257000
*         DO;                       /*                       @Z40LB30*/ 04258000
         B     @RC01047                                            1049 04259000
@RF01047 DS    0H                                                  1050 04260000
*           RESPECIFY                                              1050 04261000
*             ALLAGL BASED(ADDR(ALOCAREA));/*                @Z40LB30*/ 04262000
*           ALLAGL=''B;             /*                       @Z40LB30*/ 04263000
         LA    @02,ALOCAREA                                        1051 04264000
         XC    ALLAGL(31,@02),ALLAGL(@02)                          1051 04265000
*           UNITCNT=1;              /*                       @Z40LB30*/ 04266000
         LA    @15,1                                               1052 04267000
         STH   @15,UNITCNT                                         1052 04268000
*           UNITLNG=LENGTH(V3330);  /*                       @Z40LB30*/ 04269000
         MVC   UNITLNG(2),@CH00297                                 1053 04270000
*           UNITNAME=V3330;         /* UNIT TYPE             @Z40LB30*/ 04271000
         MVI   UNITNAME+5,C' '                                     1054 04272000
         MVC   UNITNAME+6(2),UNITNAME+5                            1054 04273000
         MVC   UNITNAME(5),@CC01469                                1054 04274000
*           VOLCOUNT=1;             /*                       @Z40LB30*/ 04275000
         STH   @15,VOLCOUNT                                        1055 04276000
*           VOLLNG=LENGTH(BASSERNO);/*                       @Z40LB30*/ 04277000
         MVC   VOLLNG(2),@CH00158                                  1056 04278000
*           VOLNAME=BASSERNO;       /* VOLUME SERIAL         @Z40LB30*/ 04279000
         MVC   VOLNAME(6),BASSERNO(BASEVPTR)                       1057 04280000
*           ALLULP=ADDR(UNITLIST);  /* UNIT TYPE LIST        @Z40LB30*/ 04281000
         LA    @15,UNITLIST                                        1058 04282000
         ST    @15,ALLULP(,@02)                                    1058 04283000
*           ALLVLP=ADDR(VOLLIST);   /* VOLUME SERIAL LIST    @Z40LB30*/ 04284000
         LA    @15,VOLLIST                                         1059 04285000
         ST    @15,ALLVLP(,@02)                                    1059 04286000
*           ALLOPTVL=ON;            /* VOLUME ALLOCATION     @Z40LB30*/ 04287000
*           ALLOPTPV=ON;            /* PRIVATE VOLUME        @Z40LB30*/ 04288000
         OI    ALLOPTVL(@02),B'10100000'                           1061 04289000
*           ALOCFLAG=ON;            /* INDICATES DYNAMIC     @Z40LB30   04290000
*                                      ALLOCATION WAS DONE   @Z40LB30*/ 04291000
         OI    ALOCFLAG,B'10000000'                                1062 04292000
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @Z40LB30*/ 04293000
         L     @15,@PC00001                                        1063 04294000
         ST    @15,@AL00001                                        1063 04295000
         ST    @02,@AL00001+4                                      1063 04296000
         MVI   @AL00001+4,X'80'                                    1063 04297000
         L     @15,GDTALC(,@15)                                    1063 04298000
         LA    @01,@AL00001                                        1063 04299000
         BALR  @14,@15                                             1063 04300000
*           RESPECIFY                                              1064 04301000
*             RTNREG RSTD;                                         1064 04302000
*           TESTRC=RTNREG;                                         1065 04303000
         LR    TESTRC,RTNREG                                       1065 04304000
*           RESPECIFY                                              1066 04305000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 04306000
*                                                                  1066 04307000
*           /*********************************************************/ 04308000
*           /*                                                       */ 04309000
*           /* IF AN ERROR OCCURRED, SET THE CONDITION CODE  @Z40LB30*/ 04310000
*           /* OTHERWISE, RETURN DDNAME.                     @Z40LB30*/ 04311000
*           /*                                                       */ 04312000
*           /*********************************************************/ 04313000
*                                                                  1067 04314000
*           IF TESTRC^=0 THEN       /*                       @Z40LB30*/ 04315000
         LTR   TESTRC,TESTRC                                       1067 04316000
         BZ    @RF01067                                            1067 04317000
*             CC03=LASTCC12;        /*                       @Z40LB30*/ 04318000
         LA    CC03,12                                             1068 04319000
*           ELSE                    /*                       @Z40LB30*/ 04320000
*             DDNAME=ALLDDN;        /*                       @Z40LB30*/ 04321000
         B     @RC01067                                            1069 04322000
@RF01067 LA    @15,ALOCAREA                                        1069 04323000
         MVC   DDNAME(8),ALLDDN(@15)                               1069 04324000
*         END;                      /*                       @Z40LB30*/ 04325000
@RC01067 DS    0H                                                  1071 04326000
*     END;                          /*                       @Z40LB30*/ 04327000
@RC01047 DS    0H                                                  1072 04328000
*                                                                  1072 04329000
*   /*****************************************************************/ 04330000
*   /*                                                               */ 04331000
*   /* IF AN ERROR OCCURRED, ISSUE MESSAGE IDC2108I TO SAY   @Z40LB30*/ 04332000
*   /* THE VOLUME WAS NOT PROCESSED.                         @Z40LB30*/ 04333000
*   /*                                                               */ 04334000
*   /*****************************************************************/ 04335000
*                                                                  1072 04336000
*   IF CC03=LASTCC12 THEN           /*                       @Z40LB30*/ 04337000
@RC01032 C     CC03,@CF00035                                       1072 04338000
         BNE   @RF01072                                            1072 04339000
*     DO;                           /*                       @Z40LB30*/ 04340000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 04341000
         XC    DARGAREA(28),DARGAREA                               1074 04342000
*       DARGSMOD=CM0MSG;            /*                       @Z40LB30*/ 04343000
         L     @15,DDSTRU                                          1075 04344000
         MVC   DARGSMOD(3,@15),@CC01418                            1075 04345000
*       DARGSENT=MSG2108I;          /*                       @Z40LB30*/ 04346000
         MVI   DARGSENT(@15),X'40'                                 1076 04347000
*       DARGDBP=ADDR(BASSERNO);     /*                       @Z40LB30*/ 04348000
         LA    @14,BASSERNO(,BASEVPTR)                             1077 04349000
         ST    @14,DARGDBP(,@15)                                   1077 04350000
*       DARGILP=LENGTH(BASSERNO);   /*                       @Z40LB30*/ 04351000
         MVC   DARGILP(2,@15),@CH00158                             1078 04352000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 04353000
         L     @15,@PC00001                                        1079 04354000
         ST    @15,@AL00001                                        1079 04355000
         LA    @14,@CF00116                                        1079 04356000
         ST    @14,@AL00001+4                                      1079 04357000
         LA    @14,DDSTRU                                          1079 04358000
         ST    @14,@AL00001+8                                      1079 04359000
         MVI   @AL00001+8,X'80'                                    1079 04360000
         L     @15,GDTPRT(,@15)                                    1079 04361000
         LA    @01,@AL00001                                        1079 04362000
         BALR  @14,@15                                             1079 04363000
*     END;                          /*                       @Z40LB30*/ 04364000
*                                                                  1080 04365000
*   /*****************************************************************/ 04366000
*   /*                                                               */ 04367000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 04368000
*   /*                                                               */ 04369000
*   /*****************************************************************/ 04370000
*                                                                  1081 04371000
*   RETURN CODE(CC03);              /*                       @Z40LB30*/ 04372000
@RF01072 LR    @15,CC03                                            1081 04373000
@EL00010 DS    0H                                                  1081 04374000
@EF00010 DS    0H                                                  1081 04375000
@ER00010 L     @14,@SA00010                                        1081 04376000
         BR    @14                                                 1081 04377000
*   END ALLOCATE;                   /*                       @Z40LB30*/ 04378000
*                                                                  1083 04379000
*/********************************************************** @Z40LB30*/ 04380000
*/*                                                          @Z40LB30*/ 04381000
*/* PROCEDURE NAME - SELECTOR                                @Z40LB30*/ 04382000
*/*                                                          @Z40LB30*/ 04383000
*/* FUNCTION - CONTROLS SELECTION OF DATA SETS ELIGIBLE FOR  @Z40LB30*/ 04384000
*/*            SCRATCH AND UNCATALOG ON A PARTICULAR VOLUME. @Z40LB30*/ 04385000
*/*            IF THERE ARE NO DATA SETS ELIGIBLE FOR SELEC  @Z40LB30*/ 04386000
*/*            TION, ISSUES MESSAGE IDC0107I. IF THE VOLUME  @Z40LB30*/ 04387000
*/*            CAN NOT BE PROCESSED, ISSUES MESSAGE IDC2108I @Z40LB30*/ 04388000
*/*                                                          @Z40LB30*/ 04389000
*/* INPUT - FUNCTIONAL DATA TABLE, BASE VOLUME RECORD,       @Z40LB30*/ 04390000
*/*         EXPIRATION AND CREATION DATES IN FORMAT REQUIRED @Z40LB30*/ 04391000
*/*         BY IDCVS03, DD NAME TO BE USED TO MOUNT THE      @Z40LB30*/ 04392000
*/*         VOLUME, UCB ADDRESS FOR EITHER A UNIQUE DD CARD  @Z40LB30*/ 04393000
*/*         TO BE USED OR FOR THE FILE PARAMETER DD CARD     @Z40LB30*/ 04394000
*/*                                                          @Z40LB30*/ 04395000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/ 04396000
*/*                        4, VTOC CLOSE ERROR, BUT LIST     @Z40LB30*/ 04397000
*/*                           OF ELIGIBLE DATA SETS          @Z40LB30*/ 04398000
*/*                           CAN BE PROCESSED               @Z40LB30*/ 04399000
*/*                        8, SOME ERRORS DETECTED, BUT THE  @Z40LB30*/ 04400000
*/*                           LIST OF ELIGIBLE DATA SETS CAN @Z40LB30*/ 04401000
*/*                           BE PROCESSED                   @Z40LB30*/ 04402000
*/*                       12, SEVERE ERROR - NO LIST OF DATA @Z40LB30*/ 04403000
*/*                           SETS CAN BE PROCESSED          @Z40LB30*/ 04404000
*/*                                                          @Z40LB30*/ 04405000
*/*        - LISTADDR SET WITH 0 OR ADDRESS OF LIST OF       @Z40LB30*/ 04406000
*/*                   ELIGIBLE DATA SETS.                    @Z40LB30*/ 04407000
*/*                                                          @Z40LB30*/ 04408000
*/********************************************************** @Z40LB30*/ 04409000
*                                                                  1083 04410000
*SELECTOR:                                                         1083 04411000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 04412000
SELECTOR ST    @14,@SA00011                                        1083 04413000
*                                                                  1084 04414000
*   /*****************************************************************/ 04415000
*   /*                                                               */ 04416000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 04417000
*   /*                                                               */ 04418000
*   /*****************************************************************/ 04419000
*                                                                  1084 04420000
*   OLDERID2=NEWERID2;                                             1084 04421000
         L     @15,@PC00001                                        1084 04422000
         L     @15,GDTTR2(,@15)                                    1084 04423000
         MVC   @TS00001(95),NEWERID2(@15)                          1084 04424000
         MVC   OLDERID2(95,@15),@TS00001                           1084 04425000
*   NEWID2='SDSL';                  /*                       @Z40LB30*/ 04426000
*                                                                  1085 04427000
         MVC   NEWID2(4,@15),@CC01556                              1085 04428000
*   /*****************************************************************/ 04429000
*   /*                                                               */ 04430000
*   /* INITIALIZE INTERNAL CONDITION CODE TO 0               @Z40LB30*/ 04431000
*   /*                                                               */ 04432000
*   /*****************************************************************/ 04433000
*                                                                  1086 04434000
*   CC03=LASTCC00;                  /*                       @Z40LB30*/ 04435000
         SLR   @15,@15                                             1086 04436000
         LR    CC03,@15                                            1086 04437000
*                                                                  1087 04438000
*   /*****************************************************************/ 04439000
*   /*                                                               */ 04440000
*   /* INITIALIZE ARGUMENT LIST FOR IDCVS03                  @Z40LB30*/ 04441000
*   /* IF NOT ALREADY INITIALIZED                            @Z40LB30*/ 04442000
*   /*                                                               */ 04443000
*   /*****************************************************************/ 04444000
*                                                                  1087 04445000
*   RESPECIFY                                                      1087 04446000
*     VS3AGL BASED(ADDR(VSAREA3));  /*                       @Z40LB30*/ 04447000
*   RESPECIFY                                                      1088 04448000
*     VSDBLOCK BASED(LISTADDR);     /*                       @Z40LB30*/ 04449000
*   IF INITVS3=OFF THEN             /*                       @Z40LB30*/ 04450000
         TM    INITVS3,B'01000000'                                 1089 04451000
         BNZ   @RF01089                                            1089 04452000
*     DO;                           /*                       @Z40LB30*/ 04453000
*       INITVS3=ON;                 /*                       @Z40LB30*/ 04454000
         OI    INITVS3,B'01000000'                                 1091 04455000
*       VS3AGL=''B;                 /* SET TO 0              @Z40LB30*/ 04456000
         LA    @14,VSAREA3                                         1092 04457000
         XC    VS3AGL(59,@14),VS3AGL(@14)                          1092 04458000
*       VS3LISTP=ADDR(LISTADDR);    /* ADDR OF LIST PTR      @Z40LB30*/ 04459000
         LA    @07,LISTADDR                                        1093 04460000
         ST    @07,VS3LISTP(,@14)                                  1093 04461000
*       VS3EXDSP=ADDR(EXDS);        /* ADDR OF DATA SETS TO  @Z40LB30   04462000
*                                      EXCLUDE               @Z40LB30*/ 04463000
         L     @07,@PC00001+4                                      1094 04464000
         L     @06,FDTPTR+56(,@07)                                 1094 04465000
         ST    @06,VS3EXDSP(,@14)                                  1094 04466000
*       VS3POOL=POOLID;             /* POOL ID FOR STORAGE   @Z40LB30*/ 04467000
         MVC   VS3POOL(4,@14),@CC01467                             1095 04468000
*       VS3DEV=DEV3330V;            /* VIRTUAL DEVICE TYPE   @Z40LB30*/ 04469000
         MVC   VS3DEV(4,@14),@CB01471                              1096 04470000
*       VS3SCR=ON;                  /* SELECT FOR SCRATCH    @Z40LB30   04471000
*                                      FUNCTION              @Z40LB30*/ 04472000
*                                                                  1097 04473000
         OI    VS3SCR(@14),B'00100000'                             1097 04474000
*       /*************************************************************/ 04475000
*       /*                                                           */ 04476000
*       /* IF THE LEVEL KEYWORD WAS SPECIFIED ON THE COMMAND @Z40LB30*/ 04477000
*       /* SET THE NECESSARY VALUES IN THE VS3AGL            @Z40LB30*/ 04478000
*       /*                                                           */ 04479000
*       /*************************************************************/ 04480000
*                                                                  1098 04481000
*       IF ADDR(LEVEL)^=NULLPTR THEN/*                       @Z40LB30*/ 04482000
         L     @07,FDTPTR+20(,@07)                                 1098 04483000
         CR    @07,@15                                             1098 04484000
         BE    @RF01098                                            1098 04485000
*         DO;                       /*                       @Z40LB30*/ 04486000
*           VS3LEVP=ADDR(LEVELVAL); /* ADDRESS OF LEVEL      @Z40LB30*/ 04487000
         LA    @15,LEVELVAL(,@07)                                  1100 04488000
         ST    @15,VS3LEVP(,@14)                                   1100 04489000
*           VS3LEVLN=LEVELLEN;      /* LENGTH OF LEVEL       @Z40LB30*/ 04490000
         SLR   @06,@06                                             1101 04491000
         IC    @06,LEVELLEN(,@07)                                  1101 04492000
         STH   @06,VS3LEVLN(,@14)                                  1101 04493000
*           VS3AST=LEVELPOS;        /* OFFSET OF ASTERISK    @Z40LB30*/ 04494000
         SLR   @06,@06                                             1102 04495000
         IC    @06,LEVELPOS(,@07)                                  1102 04496000
         STH   @06,VS3AST(,@14)                                    1102 04497000
*         END;                      /*                       @Z40LB30*/ 04498000
*                                                                  1103 04499000
*       /*************************************************************/ 04500000
*       /*                                                           */ 04501000
*       /* IF EXPIRATION OR CREATION KEYWORDS WERE SPECIFIED @Z40LB30*/ 04502000
*       /* SET THE ADDRESS OF THE DATES IN VS3AGL            @Z40LB30*/ 04503000
*       /*                                                           */ 04504000
*       /*************************************************************/ 04505000
*                                                                  1104 04506000
*       IF ADDR(EXPIR)^=NULLPTR|ADDR(EXPDT)^=NULLPTR/*       @Z40LB30*/ 04507000
*         THEN                      /*                       @Z40LB30*/ 04508000
@RF01098 SLR   @15,@15                                             1104 04509000
         L     @14,@PC00001+4                                      1104 04510000
         C     @15,FDTPTR+32(,@14)                                 1104 04511000
         BNE   @RT01104                                            1104 04512000
         C     @15,FDTPTR+28(,@14)                                 1104 04513000
         BE    @RF01104                                            1104 04514000
@RT01104 DS    0H                                                  1105 04515000
*         VS3EXPIR=ADDR(EXPDATE);   /*                       @Z40LB30*/ 04516000
         LA    @15,VSAREA3                                         1105 04517000
         LA    @14,EXPDATE                                         1105 04518000
         ST    @14,VS3EXPIR(,@15)                                  1105 04519000
*       IF ADDR(CREAT)^=NULLPTR|ADDR(CREDT)^=NULLPTR/*       @Z40LB30*/ 04520000
*         THEN                      /*                       @Z40LB30*/ 04521000
@RF01104 SLR   @15,@15                                             1106 04522000
         L     @14,@PC00001+4                                      1106 04523000
         C     @15,FDTPTR+40(,@14)                                 1106 04524000
         BNE   @RT01106                                            1106 04525000
         C     @15,FDTPTR+36(,@14)                                 1106 04526000
         BE    @RF01106                                            1106 04527000
@RT01106 DS    0H                                                  1107 04528000
*         VS3CREAT=ADDR(CREDATE);   /*                       @Z40LB30*/ 04529000
*                                                                  1107 04530000
         LA    @15,VSAREA3                                         1107 04531000
         LA    @14,CREDATE                                         1107 04532000
         ST    @14,VS3CREAT(,@15)                                  1107 04533000
*       /*************************************************************/ 04534000
*       /*                                                           */ 04535000
*       /* IF UNCATALOGED OR SYSTEMNAMES KEYWORDS WERE       @Z40LB30*/ 04536000
*       /* SPECIFIED ON THE COMMAND, SET BITS IN VS3AGL      @Z40LB30*/ 04537000
*       /*                                                           */ 04538000
*       /*************************************************************/ 04539000
*                                                                  1108 04540000
*       IF ADDR(UNCAT)^=NULLPTR THEN/*                       @Z40LB30*/ 04541000
@RF01106 L     @15,@PC00001+4                                      1108 04542000
         L     @15,FDTPTR+24(,@15)                                 1108 04543000
         LTR   @15,@15                                             1108 04544000
         BZ    @RF01108                                            1108 04545000
*         VS3UNCAT=ON;              /*                       @Z40LB30*/ 04546000
         LA    @15,VSAREA3                                         1109 04547000
         OI    VS3UNCAT(@15),B'00010000'                           1109 04548000
*       IF ADDR(SYSN)^=NULLPTR THEN /*                       @Z40LB30*/ 04549000
@RF01108 L     @15,@PC00001+4                                      1110 04550000
         L     @15,FDTPTR+48(,@15)                                 1110 04551000
         LTR   @15,@15                                             1110 04552000
         BZ    @RF01110                                            1110 04553000
*         VS3SYSNM=ON;              /*                       @Z40LB30*/ 04554000
         LA    @15,VSAREA3                                         1111 04555000
         OI    VS3SYSNM(@15),B'00001000'                           1111 04556000
*     END;                          /*                       @Z40LB30*/ 04557000
@RF01110 DS    0H                                                  1113 04558000
*                                                                  1113 04559000
*   /*****************************************************************/ 04560000
*   /*                                                               */ 04561000
*   /* SET THE VOLUME SERIAL AND DD NAME IN VS3AGL. THEN     @Z40LB30*/ 04562000
*   /* SET THE ADDRESS OF THE LIST TO BE RETURNED BY         @Z40LB30*/ 04563000
*   /* IDCVS03 TO ZERO                                       @Z40LB30*/ 04564000
*   /*                                                               */ 04565000
*   /*****************************************************************/ 04566000
*                                                                  1113 04567000
*   VS3VOL=BASSERNO;                /*                       @Z40LB30*/ 04568000
@RF01089 LA    @15,VSAREA3                                         1113 04569000
         MVC   VS3VOL(6,@15),BASSERNO(BASEVPTR)                    1113 04570000
*   VS3DD=DDNAME;                   /*                       @Z40LB30*/ 04571000
         MVC   VS3DD(8,@15),DDNAME                                 1114 04572000
*   LISTADDR=NULLPTR;               /*                       @Z40LB30*/ 04573000
*                                                                  1115 04574000
         SLR   @14,@14                                             1115 04575000
         ST    @14,LISTADDR                                        1115 04576000
*   /*****************************************************************/ 04577000
*   /*                                                               */ 04578000
*   /* IF THE UCB ADDRESS WAS RETURNED BY THE UMSSUNIT       @Z40LB30*/ 04579000
*   /* SELECTDD FUNCTION, SET IT IN THE VS3AGL. IF NOT AND   @Z40LB30*/ 04580000
*   /* THE FILE PARAMETER IS SPECIFIED, SET THAT UCB ADDRESS @Z40LB30*/ 04581000
*   /* IN VS3AGL. IF THE FILE PARAMETER WAS NOT SPECIFIED    @Z40LB30*/ 04582000
*   /* EITHER, SET THE UCB ADDRESS IN VS3AGL TO ZERO.        @Z40LB30*/ 04583000
*   /*                                                               */ 04584000
*   /*****************************************************************/ 04585000
*                                                                  1116 04586000
*   IF ADDRUCB^=NULLPTR THEN        /*                       @Z40LB30*/ 04587000
         L     @07,ADDRUCB                                         1116 04588000
         CR    @07,@14                                             1116 04589000
         BE    @RF01116                                            1116 04590000
*     VS3UCBP=ADDRUCB;              /*                       @Z40LB30*/ 04591000
         ST    @07,VS3UCBP(,@15)                                   1117 04592000
*   ELSE                            /*                       @Z40LB30*/ 04593000
*     IF ADDR(FILE)^=NULLPTR THEN   /*                       @Z40LB30*/ 04594000
         B     @RC01116                                            1118 04595000
@RF01116 L     @15,@PC00001+4                                      1118 04596000
         L     @15,FDTPTR+44(,@15)                                 1118 04597000
         LTR   @15,@15                                             1118 04598000
         BZ    @RF01118                                            1118 04599000
*       VS3UCBP=FILEUCB;            /*                       @Z40LB30*/ 04600000
         LA    @15,VSAREA3                                         1119 04601000
         L     @14,FILEUCB                                         1119 04602000
         ST    @14,VS3UCBP(,@15)                                   1119 04603000
*     ELSE                          /*                       @Z40LB30*/ 04604000
*       VS3UCBP=NULLPTR;            /*                       @Z40LB30*/ 04605000
*                                                                  1120 04606000
         B     @RC01118                                            1120 04607000
@RF01118 LA    @15,VSAREA3                                         1120 04608000
         SLR   @14,@14                                             1120 04609000
         ST    @14,VS3UCBP(,@15)                                   1120 04610000
*   /*****************************************************************/ 04611000
*   /*                                                               */ 04612000
*   /* CALL IDCVS03 TO SELECT DATA SETS AND SAVE THE         @Z40LB30*/ 04613000
*   /* RETURN CODE                                           @Z40LB30*/ 04614000
*   /*                                                               */ 04615000
*   /*****************************************************************/ 04616000
*                                                                  1121 04617000
*   CALL IDCSACL0(GDTTBL,'IDCVS03 ',SELECTDS,VS3AGL);/*      @Z40LB30*/ 04618000
@RC01118 DS    0H                                                  1121 04619000
@RC01116 L     @02,@PC00001                                        1121 04620000
         ST    @02,@AL00001                                        1121 04621000
         LA    @15,@CC01560                                        1121 04622000
         ST    @15,@AL00001+4                                      1121 04623000
         LA    @15,SELECTDS                                        1121 04624000
         ST    @15,@AL00001+8                                      1121 04625000
         LA    @15,VSAREA3                                         1121 04626000
         ST    @15,@AL00001+12                                     1121 04627000
         MVI   @AL00001+12,X'80'                                   1121 04628000
         L     @15,GDTCAL(,@02)                                    1121 04629000
         LA    @01,@AL00001                                        1121 04630000
         BALR  @14,@15                                             1121 04631000
*   RESPECIFY                                                      1122 04632000
*     RTNREG RSTD;                                                 1122 04633000
*   TESTRC=RTNREG;                                                 1123 04634000
         LR    TESTRC,RTNREG                                       1123 04635000
*   RESPECIFY                                                      1124 04636000
*     RTNREG UNRSTD;                /*                       @Z40LB30*/ 04637000
*                                                                  1124 04638000
*   /*****************************************************************/ 04639000
*   /*                                                               */ 04640000
*   /* IF AN ERROR OCCURRED, SET RETURN CODES PROPERLY.      @Z40LB30*/ 04641000
*   /* IF THE VOLUME WAS NOT PROCESSED AT ALL, ISSUE         @Z40LB30*/ 04642000
*   /* MESSAGE IDC2108I                                      @Z40LB30*/ 04643000
*   /*                                                               */ 04644000
*   /*****************************************************************/ 04645000
*                                                                  1125 04646000
*   IF TESTRC^=0 THEN               /*                       @Z40LB30*/ 04647000
         LTR   TESTRC,TESTRC                                       1125 04648000
         BZ    @RF01125                                            1125 04649000
*     DO;                           /*                       @Z40LB30*/ 04650000
*       IF TESTRC=12 THEN           /* VTOC CLOSE ERROR      @Z40LB30*/ 04651000
         C     TESTRC,@CF00035                                     1127 04652000
         BNE   @RF01127                                            1127 04653000
*         CC03=LASTCC04;            /*                       @Z40LB30*/ 04654000
         LA    CC03,4                                              1128 04655000
*       ELSE                        /*                       @Z40LB30*/ 04656000
*         IF TESTRC=8 THEN          /* DATA SET ERRORS       @Z40LB30*/ 04657000
         B     @RC01127                                            1129 04658000
@RF01127 LA    @08,8                                               1129 04659000
         CR    TESTRC,@08                                          1129 04660000
         BNE   @RF01129                                            1129 04661000
*           CC03=LASTCC08;          /*                       @Z40LB30*/ 04662000
         LA    @15,8                                               1130 04663000
         LR    CC03,@15                                            1130 04664000
*         ELSE                      /* MAJOR VOLUME ERROR    @Z40LB30*/ 04665000
*           DO;                     /*                       @Z40LB30*/ 04666000
         B     @RC01129                                            1131 04667000
@RF01129 DS    0H                                                  1132 04668000
*             CC03=LASTCC12;        /*                       @Z40LB30*/ 04669000
         LA    CC03,12                                             1132 04670000
*             DARGAREA=''B;         /*                       @Z40LB30*/ 04671000
         XC    DARGAREA(28),DARGAREA                               1133 04672000
*             DARGSMOD=CM0MSG;      /*                       @Z40LB30*/ 04673000
         L     @15,DDSTRU                                          1134 04674000
         MVC   DARGSMOD(3,@15),@CC01418                            1134 04675000
*             DARGSENT=MSG2108I;    /*                       @Z40LB30*/ 04676000
         MVI   DARGSENT(@15),X'40'                                 1135 04677000
*             DARGDBP=ADDR(BASSERNO);/*                      @Z40LB30*/ 04678000
         LA    @14,BASSERNO(,BASEVPTR)                             1136 04679000
         ST    @14,DARGDBP(,@15)                                   1136 04680000
*             DARGILP=LENGTH(BASSERNO);/*                    @Z40LB30*/ 04681000
         MVC   DARGILP(2,@15),@CH00158                             1137 04682000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Z40LB30*/ 04683000
         L     @15,@PC00001                                        1138 04684000
         ST    @15,@AL00001                                        1138 04685000
         LA    @14,@CF00116                                        1138 04686000
         ST    @14,@AL00001+4                                      1138 04687000
         LA    @14,DDSTRU                                          1138 04688000
         ST    @14,@AL00001+8                                      1138 04689000
         MVI   @AL00001+8,X'80'                                    1138 04690000
         L     @15,GDTPRT(,@15)                                    1138 04691000
         LA    @01,@AL00001                                        1138 04692000
         BALR  @14,@15                                             1138 04693000
*           END;                    /*                       @Z40LB30*/ 04694000
*     END;                          /*                       @Z40LB30*/ 04695000
*                                                                  1140 04696000
*   /*****************************************************************/ 04697000
*   /*                                                               */ 04698000
*   /* IF NO ERROR OCCURRED BUT NO DATA SETS ARE ELIGIBLE    @Z40LB30*/ 04699000
*   /* FOR SELECTION, PRINT MESSAGE IDC0107I.                @Z40LB30*/ 04700000
*   /*                                                               */ 04701000
*   /*****************************************************************/ 04702000
*                                                                  1141 04703000
*   ELSE                            /*                       @Z40LB30*/ 04704000
*     IF VSDELEM=0 THEN             /*                       @Z40LB30*/ 04705000
         B     @RC01125                                            1141 04706000
@RF01125 L     @01,LISTADDR                                        1141 04707000
         L     @15,VSDELEM(,@01)                                   1141 04708000
         LTR   @15,@15                                             1141 04709000
         BNZ   @RF01141                                            1141 04710000
*       DO;                         /*                       @Z40LB30*/ 04711000
*         DARGAREA=''B;             /*                       @Z40LB30*/ 04712000
         XC    DARGAREA(28),DARGAREA                               1143 04713000
*         DARGSMOD=CM0MSG;          /*                       @Z40LB30*/ 04714000
         L     @15,DDSTRU                                          1144 04715000
         MVC   DARGSMOD(3,@15),@CC01418                            1144 04716000
*         DARGSENT=MSG0107I;        /*                       @Z40LB30*/ 04717000
         MVI   DARGSENT(@15),X'3F'                                 1145 04718000
*         DARGDBP=ADDR(BASSERNO);   /*                       @Z40LB30*/ 04719000
         LA    @14,BASSERNO(,BASEVPTR)                             1146 04720000
         ST    @14,DARGDBP(,@15)                                   1146 04721000
*         DARGILP=LENGTH(BASSERNO); /*                       @Z40LB30*/ 04722000
         MVC   DARGILP(2,@15),@CH00158                             1147 04723000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Z40LB30*/ 04724000
         L     @15,@PC00001                                        1148 04725000
         ST    @15,@AL00001                                        1148 04726000
         LA    @14,@CF00116                                        1148 04727000
         ST    @14,@AL00001+4                                      1148 04728000
         LA    @14,DDSTRU                                          1148 04729000
         ST    @14,@AL00001+8                                      1148 04730000
         MVI   @AL00001+8,X'80'                                    1148 04731000
         L     @15,GDTPRT(,@15)                                    1148 04732000
         LA    @01,@AL00001                                        1148 04733000
         BALR  @14,@15                                             1148 04734000
*       END;                        /*                       @Z40LB30*/ 04735000
*                                                                  1149 04736000
*   /*****************************************************************/ 04737000
*   /*                                                               */ 04738000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 04739000
*   /*                                                               */ 04740000
*   /*****************************************************************/ 04741000
*                                                                  1150 04742000
*   RETURN CODE(CC03);              /*                       @Z40LB30*/ 04743000
@RF01141 DS    0H                                                  1150 04744000
@RC01125 LR    @15,CC03                                            1150 04745000
@EL00011 DS    0H                                                  1150 04746000
@EF00011 DS    0H                                                  1150 04747000
@ER00011 L     @14,@SA00011                                        1150 04748000
         BR    @14                                                 1150 04749000
*   END SELECTOR;                   /*                       @Z40LB30*/ 04750000
*                                                                  1152 04751000
*/********************************************************** @Z40LB30*/ 04752000
*/*                                                          @Z40LB30*/ 04753000
*/* PROCEDURE NAME - SCRUNCAT                                @Z40LB30*/ 04754000
*/*                                                          @Z40LB30*/ 04755000
*/* FUNCTION - SCRATCHES AND UNCATALOGS THE DATA SETS THAT   @Z40LB30*/ 04756000
*/*            HAVE BEEN SELECTED FROM THE VTOC.  CHECKS     @Z40LB30*/ 04757000
*/*            FOR CATALOGED GDG TYPE DATA SETS AND FOR      @Z40LB30*/ 04758000
*/*            CATALOGED MULTI-VOLUME DATA SETS AND DOES NOT @Z40LB30*/ 04759000
*/*            SCRATCH OR UNCATALOG THEM.  CHECKS FOR A      @Z40LB30*/ 04760000
*/*            SYSCTLG DATA SET AND DOES NOT SCRATCH IT      @Z40LB30*/ 04761000
*/*            UNLESS THE PURGE PARAMETER WAS SPECIFIED.     @Z40LB30*/ 04762000
*/*            ISSUES MESSAGE IDC0112I WHEN A DATA SET IS    @Z40LB30*/ 04763000
*/*            SUCCESSFULLY SCRATCHED.  ISSUES MESSAGE       @Z40LB30*/ 04764000
*/*            IDC0811I WHEN A DATA SET IS SUCCESSFULLY      @Z40LB30*/ 04765000
*/*            UNCATALOGED.  AT END, ISSUES MESSAGE          @Z40LB30*/ 04766000
*/*            IDC0812I TO INDICATE HOW MANY  DATA SETS      @Z40LB30*/ 04767000
*/*            WERE SUCCESSFULLY SCRATCHED AND ISSUES        @Z40LB30*/ 04768000
*/*            MESSAGES IDC0813I AND IDC0814I TO             @Z40LB30*/ 04769000
*/*            SAY HOW MANY GDG AND MULTI-VOLUME DATA SETS   @Z40LB30*/ 04770000
*/*            WERE NOT SCRATCHED.  ISSUES MSG IDC0816I      @Z40LB30*/ 04771000
*/*            IF A SYSCTLG DATA SET WAS NOT SCRATCHED.      @Z40LB30*/ 04772000
*/*                                                          @Z40LB30*/ 04773000
*/* INPUT -  LIST OF ELIGIBLE DATA SETS RETURNED BY IDCVS03. @Z40LB30*/ 04774000
*/*          VOLUME SERIAL FROM INVENTORY VOLUME RECORD. DD  @Z40LB30*/ 04775000
*/*          NAME USED TO MOUNT VOLUME IN FIELD DDNAME.      @Z40LB30*/ 04776000
*/*                                                          @Z40LB30*/ 04777000
*/* OUTPUT - REGISTER 15 = 0, NO ERRORS                      @Z40LB30*/ 04778000
*/*                        8, AN ERROR OCCURRED BUT SOME     @Z40LB30*/ 04779000
*/*                           DATA SETS HAVE BEEN SCRATCHED  @Z40LB30*/ 04780000
*/*                       12, NO DATA SETS HAVE BEEN         @Z40LB30*/ 04781000
*/*                           SCRATCHED DUE TO ERRORS        @Z40LB30*/ 04782000
*/*                                                          @Z40LB30*/ 04783000
*/********************************************************** @Z40LB30*/ 04784000
*                                                                  1152 04785000
*SCRUNCAT:                                                         1152 04786000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Z40LB30*/ 04787000
SCRUNCAT ST    @14,@SA00012                                        1152 04788000
*                                                                  1153 04789000
*   /*****************************************************************/ 04790000
*   /*                                                               */ 04791000
*   /* ESTABLISH A TRACE POINT AT BEGINNING OF PROCEDURE     @Z40LB30*/ 04792000
*   /*                                                               */ 04793000
*   /*****************************************************************/ 04794000
*                                                                  1153 04795000
*   OLDERID2=NEWERID2;                                             1153 04796000
         L     @06,@PC00001                                        1153 04797000
         L     @06,GDTTR2(,@06)                                    1153 04798000
         MVC   @TS00001(95),NEWERID2(@06)                          1153 04799000
         MVC   OLDERID2(95,@06),@TS00001                           1153 04800000
*   NEWID2='SDSC';                  /*                       @Z40LB30*/ 04801000
*                                                                  1154 04802000
         MVC   NEWID2(4,@06),@CC01564                              1154 04803000
*   /*****************************************************************/ 04804000
*   /*                                                               */ 04805000
*   /* INITIALIZE INTERNAL CONDITION CODE TO ZERO            @Z40LB30*/ 04806000
*   /*                                                               */ 04807000
*   /*****************************************************************/ 04808000
*                                                                  1155 04809000
*   CC03=LASTCC00;                  /*                       @Z40LB30*/ 04810000
*                                                                  1155 04811000
         SLR   @06,@06                                             1155 04812000
         LR    CC03,@06                                            1155 04813000
*   /*****************************************************************/ 04814000
*   /*                                                               */ 04815000
*   /* INITIALIZE USCRATCH ARGUMENT LIST                     @Z40LB30*/ 04816000
*   /*                                                               */ 04817000
*   /*****************************************************************/ 04818000
*                                                                  1156 04819000
*   RESPECIFY                                                      1156 04820000
*     UVOLLIST BASED(ADDR(SCRAREA));/*                       @Z40LB30*/ 04821000
*   UVOLCNT=1;                      /*                       @Z40LB30*/ 04822000
         LA    @15,1                                               1157 04823000
         LA    @14,SCRAREA                                         1157 04824000
         STH   @15,UVOLCNT(,@14)                                   1157 04825000
*   UVOLDEV(1)=DEV3330V;            /*                       @Z40LB30*/ 04826000
         MVC   UVOLDEV(4,@14),@CB01471                             1158 04827000
*   UVOLVOL(1)=BASSERNO;            /*                       @Z40LB30*/ 04828000
*                                                                  1159 04829000
         MVC   UVOLVOL(6,@14),BASSERNO(BASEVPTR)                   1159 04830000
*   /*****************************************************************/ 04831000
*   /*                                                               */ 04832000
*   /* INITIALIZE UUNCATLG ARGUMENT LIST                     @Z40LB30*/ 04833000
*   /*                                                               */ 04834000
*   /*****************************************************************/ 04835000
*                                                                  1160 04836000
*   RESPECIFY                                                      1160 04837000
*     UCTAGL BASED(ADDR(CATAREA));  /*                       @Z40LB30*/ 04838000
*   UCTAGL=''B;                     /*                       @Z40LB30*/ 04839000
         LA    @03,CATAREA                                         1161 04840000
         XC    UCTAGL(69,@03),UCTAGL(@03)                          1161 04841000
*   UCTVOLP=ADDR(UVOLLIST);         /*                       @Z40LB30*/ 04842000
         ST    @14,UCTVOLP(,@03)                                   1162 04843000
*   UCTDD=DDNAME;                   /*                       @Z40LB30*/ 04844000
*                                                                  1163 04845000
         MVC   UCTDD(8,@03),DDNAME                                 1163 04846000
*   /*****************************************************************/ 04847000
*   /*                                                               */ 04848000
*   /* INITIALIZE COUNTERS FOR VOLUME TO ZERO                @Z40LB30*/ 04849000
*   /*                                                               */ 04850000
*   /*****************************************************************/ 04851000
*                                                                  1164 04852000
*   SCRATCNT=0;                     /*                       @Z40LB30*/ 04853000
         STH   @06,SCRATCNT                                        1164 04854000
*   GDGCNT=0;                       /*                       @Z40LB30*/ 04855000
         STH   @06,GDGCNT                                          1165 04856000
*   MULTICNT=0;                     /*                       @Z40LB30*/ 04857000
         STH   @06,MULTICNT                                        1166 04858000
*   SYSCTCNT=0;                     /*                       @Z40LB30*/ 04859000
         STH   @06,SYSCTCNT                                        1167 04860000
*                                                                  1168 04861000
*   /*****************************************************************/ 04862000
*   /*                                                               */ 04863000
*   /* INCREMENT THROUGH LIST OF ELIGIBLE DATA SETS          @Z40LB30*/ 04864000
*   /*                                                               */ 04865000
*   /*****************************************************************/ 04866000
*                                                                  1168 04867000
*   DO ELEMENT=1 TO VSDELEM;        /*                       @Z40LB30*/ 04868000
*                                                                  1168 04869000
         LR    ELEMENT,@15                                         1168 04870000
         B     @DE01168                                            1168 04871000
@DL01168 DS    0H                                                  1169 04872000
*     /***************************************************************/ 04873000
*     /*                                                             */ 04874000
*     /* IF THE DATA SET IS NOT CATALOGED, SCRATCH IT        @Z40LB30*/ 04875000
*     /*                                                             */ 04876000
*     /***************************************************************/ 04877000
*                                                                  1169 04878000
*     IF VSDCATLC=OFF THEN          /*                       @Z40LB30*/ 04879000
         L     @15,LISTADDR                                        1169 04880000
         LR    @14,ELEMENT                                         1169 04881000
         MH    @14,@CH01628                                        1169 04882000
         LA    @01,0(@14,@15)                                      1169 04883000
         AL    @01,@CF01650                                        1169 04884000
         TM    VSDCATLC(@01),B'10000000'                           1169 04885000
         BNZ   @RF01169                                            1169 04886000
*       DO;                         /*                       @Z40LB30*/ 04887000
*                                                                  1170 04888000
*         /***********************************************************/ 04889000
*         /*                                                         */ 04890000
*         /* FIRST CHECK IF THE DATA SET NAME IS SYSCTLG.    @Z40LB30*/ 04891000
*         /* IF IT IS, DO NOT SCRATCH THE DATA SET UNTIL     @Z40LB30*/ 04892000
*         /* THE REST OF THE DATA SET HAVE BEEN SCRATCHED    @Z40LB30*/ 04893000
*         /* AND UNCATALOGUED TO AVOID UNCATALOG ERRORS.     @Z40LB30*/ 04894000
*         /* HOWEVER, INCREMENT THE SYSCTLG NOT SCRATCHED    @Z40LB30*/ 04895000
*         /* COUNTER. OTHERWISE, CONTINUE WITH SCRATCH.      @Z40LB30*/ 04896000
*         /*                                                         */ 04897000
*         /***********************************************************/ 04898000
*                                                                  1171 04899000
*         IF VSDDSN(ELEMENT,1:LENGTH(SYSCTLG))=SYSCTLG/*     @Z40LB30*/ 04900000
*           THEN                    /*                       @Z40LB30*/ 04901000
         ALR   @15,@14                                             1171 04902000
         AL    @15,@CF01651                                        1171 04903000
         CLC   VSDDSN-20(44,@15),@CC01479                          1171 04904000
         BNE   @RF01171                                            1171 04905000
*           SYSCTCNT=SYSCTCNT+1;    /*                       @Z40LB30*/ 04906000
         LA    @15,1                                               1172 04907000
         AH    @15,SYSCTCNT                                        1172 04908000
         STH   @15,SYSCTCNT                                        1172 04909000
*         ELSE                      /*                       @Z40LB30*/ 04910000
*           DO;                     /*                       @Z40LB30*/ 04911000
*                                                                  1173 04912000
         B     @RC01171                                            1173 04913000
@RF01171 DS    0H                                                  1174 04914000
*             /*******************************************************/ 04915000
*             /*                                                     */ 04916000
*             /* ISSUE USCRATCH MACRO, OVERRIDING THE        @Z40LB30*/ 04917000
*             /* EXPIRATION DATE, AND SAVE RETURN CODE       @Z40LB30*/ 04918000
*             /*                                                     */ 04919000
*             /*******************************************************/ 04920000
*                                                                  1174 04921000
*             CALL IDCSASC0(GDTTBL,VSDDSN(ELEMENT),ADDR(UVOLLIST),/*    04922000
*                                                            @Z40LB30*/ 04923000
*                 OVERRIDE);        /*                       @Z40LB30*/ 04924000
         L     @02,@PC00001                                        1174 04925000
         ST    @02,@AL00001                                        1174 04926000
         LR    @15,ELEMENT                                         1174 04927000
         MH    @15,@CH01628                                        1174 04928000
         L     @01,LISTADDR                                        1174 04929000
         AL    @01,@CF01651                                        1174 04930000
         LA    @15,VSDDSN-20(@15,@01)                              1174 04931000
         ST    @15,@AL00001+4                                      1174 04932000
         LA    @15,SCRAREA                                         1174 04933000
         ST    @15,@AFTEMPS                                        1174 04934000
         LA    @15,@AFTEMPS                                        1174 04935000
         ST    @15,@AL00001+8                                      1174 04936000
         LA    @15,OVERRIDE                                        1174 04937000
         ST    @15,@AL00001+12                                     1174 04938000
         MVI   @AL00001+12,X'80'                                   1174 04939000
         L     @15,GDTSCR(,@02)                                    1174 04940000
         LA    @01,@AL00001                                        1174 04941000
         BALR  @14,@15                                             1174 04942000
*             RESPECIFY                                            1175 04943000
*               RTNREG RSTD;                                       1175 04944000
*             TESTRC=RTNREG;                                       1176 04945000
         LR    TESTRC,RTNREG                                       1176 04946000
*             RESPECIFY                                            1177 04947000
*               RTNREG UNRSTD;      /*                       @Z40LB30*/ 04948000
*                                                                  1177 04949000
*             /*******************************************************/ 04950000
*             /*                                                     */ 04951000
*             /* IF USCRATCH IS SUCCESSFUL, ISSUE MSG IDC0112I       */ 04952000
*             /*                                             @Z40LB30*/ 04953000
*             /* INSERTING DATA SET NAME AND THEN INCREMENT  @Z40LB30*/ 04954000
*             /* COUNTER                                     @Z40LB30*/ 04955000
*             /*                                                     */ 04956000
*             /*******************************************************/ 04957000
*                                                                  1178 04958000
*             IF TESTRC=0 THEN      /*                       @Z40LB30*/ 04959000
         LTR   TESTRC,TESTRC                                       1178 04960000
         BNZ   @RF01178                                            1178 04961000
*               DO;                 /*                       @Z40LB30*/ 04962000
*                 DARGAREA=''B;     /*                       @Z40LB30*/ 04963000
         XC    DARGAREA(28),DARGAREA                               1180 04964000
*                 DARGSMOD=CM0MSG;  /*                       @Z40LB30*/ 04965000
         L     @15,DDSTRU                                          1181 04966000
         MVC   DARGSMOD(3,@15),@CC01418                            1181 04967000
*                 DARGSENT=MSG0112I;/*                       @Z40LB30*/ 04968000
         MVI   DARGSENT(@15),X'44'                                 1182 04969000
*                 DARGDBP=ADDR(VSDDSN(ELEMENT));/*           @Z40LB30*/ 04970000
         LR    @14,ELEMENT                                         1183 04971000
         MH    @14,@CH01628                                        1183 04972000
         L     @01,LISTADDR                                        1183 04973000
         AL    @01,@CF01651                                        1183 04974000
         LA    @14,VSDDSN-20(@14,@01)                              1183 04975000
         ST    @14,DARGDBP(,@15)                                   1183 04976000
*                 DARGILP=LENGTH(VSDDSN(1));/*               @Z40LB30*/ 04977000
         MVC   DARGILP(2,@15),@CH00848                             1184 04978000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Z40LB30*/ 04979000
         L     @15,@PC00001                                        1185 04980000
         ST    @15,@AL00001                                        1185 04981000
         LA    @14,@CF00116                                        1185 04982000
         ST    @14,@AL00001+4                                      1185 04983000
         LA    @14,DDSTRU                                          1185 04984000
         ST    @14,@AL00001+8                                      1185 04985000
         MVI   @AL00001+8,X'80'                                    1185 04986000
         L     @15,GDTPRT(,@15)                                    1185 04987000
         LA    @01,@AL00001                                        1185 04988000
         BALR  @14,@15                                             1185 04989000
*                 SCRATCNT=SCRATCNT+1;/*                     @Z40LB30*/ 04990000
         LA    @15,1                                               1186 04991000
         AH    @15,SCRATCNT                                        1186 04992000
         STH   @15,SCRATCNT                                        1186 04993000
*               END;                /*                       @Z40LB30*/ 04994000
*                                                                  1187 04995000
*             /*******************************************************/ 04996000
*             /*                                                     */ 04997000
*             /* IF USCRATCH IS NOT SUCCESSFUL, SET INTERNAL @Z40LB30*/ 04998000
*             /* CONDITION CODE                              @Z40LB30*/ 04999000
*             /*                                                     */ 05000000
*             /*******************************************************/ 05001000
*                                                                  1188 05002000
*             ELSE                  /*                       @Z40LB30*/ 05003000
*               CC03=LASTCC08;      /*                       @Z40LB30*/ 05004000
         B     @RC01178                                            1188 05005000
@RF01178 LA    CC03,8                                              1188 05006000
*           END;                    /*                       @Z40LB30*/ 05007000
*       END;                        /*                       @Z40LB30*/ 05008000
*                                                                  1191 05009000
*     /***************************************************************/ 05010000
*     /*                                                             */ 05011000
*     /* IF THE DATA SET IS CATALOGED, SCRATCH AND           @Z40LB30*/ 05012000
*     /* UNCATALOG IT                                        @Z40LB30*/ 05013000
*     /*                                                             */ 05014000
*     /***************************************************************/ 05015000
*                                                                  1191 05016000
*     ELSE                          /*                       @Z40LB30*/ 05017000
*       DO;                         /*                       @Z40LB30*/ 05018000
*                                                                  1191 05019000
         B     @RC01169                                            1191 05020000
@RF01169 DS    0H                                                  1192 05021000
*         /***********************************************************/ 05022000
*         /*                                                         */ 05023000
*         /* CHECK THE DATA SET NAME TO SEE IF IT LOOKS      @Z40LB30*/ 05024000
*         /* LIKE A GDG, THAT IS, HAS LAST 10 CHARACTERS     @Z40LB30*/ 05025000
*         /* X.GNNNNVNN WHERE N IS A NUMBER FROM 0 - 9       @Z40LB30*/ 05026000
*         /*                                                 @Z40LB30*/ 05027000
*         /* FIND THE NUMBER OF THE FIRST BLANK CHARACTER    @Z40LB30*/ 05028000
*         /* IN THE DATA SET NAME                            @Z40LB30*/ 05029000
*         /*                                                         */ 05030000
*         /***********************************************************/ 05031000
*                                                                  1192 05032000
*         GDGTYPE=OFF;              /*                       @Z40LB30*/ 05033000
         NI    GDGTYPE,B'11011111'                                 1192 05034000
*         DO LASTCHAR=2 TO LENGTH(VSDDSN(1)) WHILE/*         @Z40LB30*/ 05035000
*               VSDDSN(ELEMENT,LASTCHAR:LASTCHAR)^=' ';/*    @Z40LB30*/ 05036000
         LA    LASTCHAR,2                                          1193 05037000
@DL01193 LR    @03,ELEMENT                                         1193 05038000
         MH    @03,@CH01628                                        1193 05039000
         ALR   @03,LASTCHAR                                        1193 05040000
         L     @01,LISTADDR                                        1193 05041000
         ALR   @01,@03                                             1193 05042000
         AL    @01,@CF01653                                        1193 05043000
         CLI   VSDDSN-20(@01),C' '                                 1193 05044000
         BE    @DC01193                                            1193 05045000
*         END;                      /*                       @Z40LB30*/ 05046000
*                                                                  1194 05047000
         AL    LASTCHAR,@CF00221                                   1194 05048000
         C     LASTCHAR,@CF00848                                   1194 05049000
         BNH   @DL01193                                            1194 05050000
@DC01193 DS    0H                                                  1195 05051000
*         /***********************************************************/ 05052000
*         /*                                                         */ 05053000
*         /* DECREMENT TO GET THE NUMBER OF THE LAST NON-    @Z40LB30*/ 05054000
*         /* BLANK CHARACTER                                 @Z40LB30*/ 05055000
*         /*                                                         */ 05056000
*         /***********************************************************/ 05057000
*                                                                  1195 05058000
*         LASTCHAR=LASTCHAR-1;      /*                       @Z40LB30*/ 05059000
*                                                                  1195 05060000
         BCTR  LASTCHAR,0                                          1195 05061000
*         /***********************************************************/ 05062000
*         /*                                                         */ 05063000
*         /* IF THERE ARE AT LEAST 10 CHARACTERS IN THE      @Z40LB30*/ 05064000
*         /* NAME AND THE LAST 8 CHARACTERS CONTAIN A 'G'    @Z40LB30*/ 05065000
*         /* AND 'V' IN THE CORRECT POSITIONS, THIS COULD    @Z40LB30*/ 05066000
*         /* BE A GDG, SO CONTINUE CHECKS                    @Z40LB30*/ 05067000
*         /*                                                         */ 05068000
*         /***********************************************************/ 05069000
*                                                                  1196 05070000
*         IF LASTCHAR>=10&VSDDSN(ELEMENT,LASTCHAR-7:/*       @Z40LB30*/ 05071000
*             LASTCHAR-7)='G'&VSDDSN(ELEMENT,LASTCHAR-2:/*   @Z40LB30*/ 05072000
*             LASTCHAR-2)='V'       /*                       @Z40LB30*/ 05073000
*           THEN                    /*                       @Z40LB30*/ 05074000
         C     LASTCHAR,@CF00037                                   1196 05075000
         BL    @RF01196                                            1196 05076000
         L     @03,LISTADDR                                        1196 05077000
         LR    @15,ELEMENT                                         1196 05078000
         MH    @15,@CH01628                                        1196 05079000
         ALR   @15,LASTCHAR                                        1196 05080000
         ST    @15,@TF00001                                        1196 05081000
         ALR   @15,@03                                             1196 05082000
         AL    @15,@CF01654                                        1196 05083000
         CLI   VSDDSN-20(@15),C'G'                                 1196 05084000
         BNE   @RF01196                                            1196 05085000
         AL    @03,@TF00001                                        1196 05086000
         AL    @03,@CF01655                                        1196 05087000
         CLI   VSDDSN-20(@03),C'V'                                 1196 05088000
         BNE   @RF01196                                            1196 05089000
*           DO;                     /*                       @Z40LB30*/ 05090000
*                                                                  1197 05091000
*             /*******************************************************/ 05092000
*             /*                                                     */ 05093000
*             /* CHECK IF THE CHARACTERS BETWEEN THE 'G'     @Z40LB30*/ 05094000
*             /* AND 'V' IN THE LAST 8 CHARACTERS OF THE     @Z40LB30*/ 05095000
*             /* DATA SET NAME ARE NUMERIC                   @Z40LB30*/ 05096000
*             /*                                                     */ 05097000
*             /*******************************************************/ 05098000
*                                                                  1198 05099000
*             DO NUMCHAR=(LASTCHAR-6) TO(LASTCHAR-3)/*       @Z40LB30*/ 05100000
*                   WHILE VSDDSN(ELEMENT,NUMCHAR:NUMCHAR)>='0'/*   1198 05101000
*                                                            @Z40LB30*/ 05102000
*                   &VSDDSN(ELEMENT,NUMCHAR:NUMCHAR)<='9';/* @Z40LB30*/ 05103000
         LR    NUMCHAR,LASTCHAR                                    1198 05104000
         SL    NUMCHAR,@CF00158                                    1198 05105000
         B     @DE01198                                            1198 05106000
@DL01198 L     @15,LISTADDR                                        1198 05107000
         LR    @14,ELEMENT                                         1198 05108000
         MH    @14,@CH01628                                        1198 05109000
         ALR   @14,NUMCHAR                                         1198 05110000
         ST    @14,@TF00001                                        1198 05111000
         ALR   @14,@15                                             1198 05112000
         AL    @14,@CF01653                                        1198 05113000
         CLI   VSDDSN-20(@14),C'0'                                 1198 05114000
         BL    @DC01198                                            1198 05115000
         AL    @15,@TF00001                                        1198 05116000
         AL    @15,@CF01653                                        1198 05117000
         CLI   VSDDSN-20(@15),C'9'                                 1198 05118000
         BH    @DC01198                                            1198 05119000
*             END;                  /*                       @Z40LB30*/ 05120000
*                                                                  1199 05121000
         AL    NUMCHAR,@CF00221                                    1199 05122000
@DE01198 LR    @15,LASTCHAR                                        1199 05123000
         SL    @15,@CF00164                                        1199 05124000
         CR    NUMCHAR,@15                                         1199 05125000
         BNH   @DL01198                                            1199 05126000
@DC01198 DS    0H                                                  1200 05127000
*             /*******************************************************/ 05128000
*             /*                                                     */ 05129000
*             /* IF ALL THE CHARACTERS WERE NUMERIC, CHECK   @Z40LB30*/ 05130000
*             /* IF THE TWO CHARACTERS AFTER THE 'V' ARE     @Z40LB30*/ 05131000
*             /* NUMERIC                                     @Z40LB30*/ 05132000
*             /*                                                     */ 05133000
*             /*******************************************************/ 05134000
*                                                                  1200 05135000
*             IF NUMCHAR>(LASTCHAR-3) THEN/*                 @Z40LB30*/ 05136000
         LR    @15,LASTCHAR                                        1200 05137000
         SL    @15,@CF00164                                        1200 05138000
         CR    NUMCHAR,@15                                         1200 05139000
         BNH   @RF01200                                            1200 05140000
*               DO;                 /*                       @Z40LB30*/ 05141000
*                 DO NUMCHAR=(LASTCHAR-1) TO LASTCHAR/*      @Z40LB30*/ 05142000
*                       WHILE VSDDSN(ELEMENT,NUMCHAR:NUMCHAR)/*    1202 05143000
*                                                            @Z40LB30*/ 05144000
*                       >='0'&VSDDSN(ELEMENT,NUMCHAR:NUMCHAR)/*    1202 05145000
*                                                            @Z40LB30*/ 05146000
*                       <='9';      /*                       @Z40LB30*/ 05147000
         LR    NUMCHAR,LASTCHAR                                    1202 05148000
         BCTR  NUMCHAR,0                                           1202 05149000
         B     @DE01202                                            1202 05150000
@DL01202 L     @15,LISTADDR                                        1202 05151000
         LR    @14,ELEMENT                                         1202 05152000
         MH    @14,@CH01628                                        1202 05153000
         ALR   @14,NUMCHAR                                         1202 05154000
         ST    @14,@TF00001                                        1202 05155000
         ALR   @14,@15                                             1202 05156000
         AL    @14,@CF01653                                        1202 05157000
         CLI   VSDDSN-20(@14),C'0'                                 1202 05158000
         BL    @DC01202                                            1202 05159000
         AL    @15,@TF00001                                        1202 05160000
         AL    @15,@CF01653                                        1202 05161000
         CLI   VSDDSN-20(@15),C'9'                                 1202 05162000
         BH    @DC01202                                            1202 05163000
*                 END;              /*                       @Z40LB30*/ 05164000
*                                                                  1203 05165000
         AL    NUMCHAR,@CF00221                                    1203 05166000
@DE01202 CR    NUMCHAR,LASTCHAR                                    1203 05167000
         BNH   @DL01202                                            1203 05168000
@DC01202 DS    0H                                                  1204 05169000
*                 /***************************************************/ 05170000
*                 /*                                                 */ 05171000
*                 /* IF ALL THE CHARACTERS WERE NUMERIC,     @Z40LB30*/ 05172000
*                 /* INDICATE THE DATA SET NAME LOOKS LIKE   @Z40LB30*/ 05173000
*                 /* A GDG                                   @Z40LB30*/ 05174000
*                 /*                                                 */ 05175000
*                 /***************************************************/ 05176000
*                                                                  1204 05177000
*                 IF NUMCHAR>LASTCHAR THEN/*                 @Z40LB30*/ 05178000
         CR    NUMCHAR,LASTCHAR                                    1204 05179000
         BNH   @RF01204                                            1204 05180000
*                   GDGTYPE=ON;     /*                       @Z40LB30*/ 05181000
         OI    GDGTYPE,B'00100000'                                 1205 05182000
*               END;                /*                       @Z40LB30*/ 05183000
@RF01204 DS    0H                                                  1207 05184000
*           END;                    /*                       @Z40LB30*/ 05185000
*                                                                  1207 05186000
@RF01200 DS    0H                                                  1208 05187000
*         /***********************************************************/ 05188000
*         /*                                                         */ 05189000
*         /* IF THE DATA SET IS A GDG OR RESIDES ON MORE     @Z40LB30*/ 05190000
*         /* THAN ONE VOLUME, INCREMENT THE COUNTER BUT      @Z40LB30*/ 05191000
*         /* DON'T SCRATCH THE DATA SET                      @Z40LB30*/ 05192000
*         /*                                                         */ 05193000
*         /***********************************************************/ 05194000
*                                                                  1208 05195000
*         IF GDGTYPE=ON THEN        /*                       @Z40LB30*/ 05196000
@RF01196 TM    GDGTYPE,B'00100000'                                 1208 05197000
         BNO   @RF01208                                            1208 05198000
*           GDGCNT=GDGCNT+1;        /*                       @Z40LB30*/ 05199000
         LA    @15,1                                               1209 05200000
         AH    @15,GDGCNT                                          1209 05201000
         STH   @15,GDGCNT                                          1209 05202000
*         ELSE                      /*                       @Z40LB30*/ 05203000
*           IF VSDVOLCT(ELEMENT)>1 THEN/*                    @Z40LB30*/ 05204000
         B     @RC01208                                            1210 05205000
@RF01208 LA    @15,1                                               1210 05206000
         LR    @14,ELEMENT                                         1210 05207000
         MH    @14,@CH01628                                        1210 05208000
         L     @01,LISTADDR                                        1210 05209000
         AL    @01,@CF01656                                        1210 05210000
         C     @15,VSDVOLCT-16(@14,@01)                            1210 05211000
         BNL   @RF01210                                            1210 05212000
*             MULTICNT=MULTICNT+1;  /*                       @Z40LB30*/ 05213000
*                                                                  1211 05214000
         AH    @15,MULTICNT                                        1211 05215000
         STH   @15,MULTICNT                                        1211 05216000
*         /***********************************************************/ 05217000
*         /*                                                         */ 05218000
*         /* IF THE DATA SET IS NOT GDG OR MULTI-VOLUME      @Z40LB30*/ 05219000
*         /* ISSUE UUNCATLG MACRO TO SCRATCH & UNCATALOG     @Z40LB30*/ 05220000
*         /* THE DATA SET. SAVE THE RETURN CODE              @Z40LB30*/ 05221000
*         /*                                                         */ 05222000
*         /***********************************************************/ 05223000
*                                                                  1212 05224000
*           ELSE                    /*                       @Z40LB30*/ 05225000
*             DO;                   /*                       @Z40LB30*/ 05226000
         B     @RC01210                                            1212 05227000
@RF01210 DS    0H                                                  1213 05228000
*               UCTDSN=VSDDSN(ELEMENT);/*                    @Z40LB30*/ 05229000
*                                                                  1213 05230000
         LA    @15,CATAREA                                         1213 05231000
         L     @14,LISTADDR                                        1213 05232000
         LR    @03,ELEMENT                                         1213 05233000
         MH    @03,@CH01628                                        1213 05234000
         ST    @03,@TF00001                                        1213 05235000
         ALR   @03,@14                                             1213 05236000
         AL    @03,@CF01651                                        1213 05237000
         MVC   UCTDSN(44,@15),VSDDSN-20(@03)                       1213 05238000
*               /*****************************************************/ 05239000
*               /*                                                   */ 05240000
*               /* IF THE DATA SET WAS LOCATED IN A          @Z40LB30*/ 05241000
*               /* VSAM CATALOG, INDICATE THAT AND           @Z40LB30*/ 05242000
*               /* SET THE CATALOG ACB POINTER IN            @Z40LB30*/ 05243000
*               /* THE UUNCATLG ARGUMENT LIST.               @Z40LB30*/ 05244000
*               /*                                                   */ 05245000
*               /*****************************************************/ 05246000
*                                                                  1214 05247000
*               IF VSDVSAM=ON THEN  /*                       @Z40LB30*/ 05248000
         L     @01,@TF00001                                        1214 05249000
         AL    @14,@CF01650                                        1214 05250000
         LA    @14,VSDVARY-64(@01,@14)                             1214 05251000
         TM    VSDVSAM(@14),B'01000000'                            1214 05252000
         BNO   @RF01214                                            1214 05253000
*                 DO;               /*                       @Z40LB30*/ 05254000
*                   UCTVSCAT=ON;    /*                       @Z40LB30*/ 05255000
         OI    UCTVSCAT(@15),B'10000000'                           1216 05256000
*                   UCTACBP=VSDACBPT;/*                      @Z40LB30*/ 05257000
         L     @14,VSDACBPT(,@14)                                  1217 05258000
         ST    @14,UCTACBP(,@15)                                   1217 05259000
*                 END;              /*                       @Z40LB30*/ 05260000
*               ELSE                /*                       @Z40LB30*/ 05261000
*                 UCTVSCAT=OFF;     /*                       @Z40LB30*/ 05262000
         B     @RC01214                                            1219 05263000
@RF01214 LA    @15,CATAREA                                         1219 05264000
         NI    UCTVSCAT(@15),B'01111111'                           1219 05265000
*               CALL IDCSAUC0(GDTTBL,UCTAGL);/*              @Z40LB30*/ 05266000
@RC01214 L     @02,@PC00001                                        1220 05267000
         ST    @02,@AL00001                                        1220 05268000
         LA    @15,CATAREA                                         1220 05269000
         ST    @15,@AL00001+4                                      1220 05270000
         MVI   @AL00001+4,X'80'                                    1220 05271000
         L     @15,GDTUNC(,@02)                                    1220 05272000
         LA    @01,@AL00001                                        1220 05273000
         BALR  @14,@15                                             1220 05274000
*               RESPECIFY                                          1221 05275000
*                 RTNREG RSTD;                                     1221 05276000
*               TESTRC=RTNREG;                                     1222 05277000
         LR    TESTRC,RTNREG                                       1222 05278000
*               RESPECIFY                                          1223 05279000
*                 RTNREG UNRSTD;    /*                       @Z40LB30*/ 05280000
*                                                                  1223 05281000
*               /*****************************************************/ 05282000
*               /*                                                   */ 05283000
*               /* IF UUNCATLG IS SUCCESSFUL, ISSUE MESSAGE  @Z40LB30*/ 05284000
*               /* IDC0112I TO SAY THE DATA SET WAS          @Z40LB30*/ 05285000
*               /* SCRATCHED. THEN ISSUE MESSAGE             @Z40LB30*/ 05286000
*               /* IDC0811I TO SAY THE DATA SET WAS          @Z40LB30*/ 05287000
*               /* UNCATALOGED. INCREMENT COUNTER            @Z40LB30*/ 05288000
*               /* OF SCRATCHED DATA SETS.                   @Z40LB30*/ 05289000
*               /*                                                   */ 05290000
*               /*****************************************************/ 05291000
*                                                                  1224 05292000
*               IF TESTRC=0 THEN    /*                       @Z40LB30*/ 05293000
         LTR   TESTRC,TESTRC                                       1224 05294000
         BNZ   @RF01224                                            1224 05295000
*                 DO;               /*                       @Z40LB30*/ 05296000
*                   DARGAREA=''B;   /*                       @Z40LB30*/ 05297000
         XC    DARGAREA(28),DARGAREA                               1226 05298000
*                   DARGSMOD=CM0MSG;/*                       @Z40LB30*/ 05299000
         L     @15,DDSTRU                                          1227 05300000
         MVC   DARGSMOD(3,@15),@CC01418                            1227 05301000
*                   DARGSENT=MSG0112I;/*                     @Z40LB30*/ 05302000
         MVI   DARGSENT(@15),X'44'                                 1228 05303000
*                   DARGDBP=ADDR(VSDDSN(ELEMENT));/*         @Z40LB30*/ 05304000
         LR    @14,ELEMENT                                         1229 05305000
         MH    @14,@CH01628                                        1229 05306000
         L     @01,LISTADDR                                        1229 05307000
         AL    @01,@CF01651                                        1229 05308000
         LA    @14,VSDDSN-20(@14,@01)                              1229 05309000
         ST    @14,DARGDBP(,@15)                                   1229 05310000
*                   DARGILP=LENGTH(VSDDSN(ELEMENT));/*       @Z40LB30*/ 05311000
         MVC   DARGILP(2,@15),@CH00848                             1230 05312000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/ 05313000
         L     @15,@PC00001                                        1231 05314000
         ST    @15,@AL00001                                        1231 05315000
         LA    @14,@CF00116                                        1231 05316000
         ST    @14,@AL00001+4                                      1231 05317000
         LA    @14,DDSTRU                                          1231 05318000
         ST    @14,@AL00001+8                                      1231 05319000
         MVI   @AL00001+8,X'80'                                    1231 05320000
         L     @15,GDTPRT(,@15)                                    1231 05321000
         LA    @01,@AL00001                                        1231 05322000
         BALR  @14,@15                                             1231 05323000
*                   DARGSMOD=SD01MSG;/*                      @Z40LB30*/ 05324000
         L     @15,DDSTRU                                          1232 05325000
         MVC   DARGSMOD(3,@15),@CC01420                            1232 05326000
*                   DARGSENT=MSG0811I;/*                     @Z40LB30*/ 05327000
         MVI   DARGSENT(@15),X'02'                                 1233 05328000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*  @Z40LB30*/ 05329000
         L     @15,@PC00001                                        1234 05330000
         ST    @15,@AL00001                                        1234 05331000
         LA    @14,@CF00116                                        1234 05332000
         ST    @14,@AL00001+4                                      1234 05333000
         LA    @14,DDSTRU                                          1234 05334000
         ST    @14,@AL00001+8                                      1234 05335000
         MVI   @AL00001+8,X'80'                                    1234 05336000
         L     @15,GDTPRT(,@15)                                    1234 05337000
         LA    @01,@AL00001                                        1234 05338000
         BALR  @14,@15                                             1234 05339000
*                   SCRATCNT=SCRATCNT+1;/*                   @Z40LB30*/ 05340000
         LA    @15,1                                               1235 05341000
         AH    @15,SCRATCNT                                        1235 05342000
         STH   @15,SCRATCNT                                        1235 05343000
*                 END;              /*                       @Z40LB30*/ 05344000
*                                                                  1236 05345000
*               /*****************************************************/ 05346000
*               /*                                                   */ 05347000
*               /* IF UUNCATLG IS NOT SUCCESSFUL SET         @Z40LB30*/ 05348000
*               /* INTERNAL CONDITION CODE                   @Z40LB30*/ 05349000
*               /*                                                   */ 05350000
*               /*****************************************************/ 05351000
*                                                                  1237 05352000
*               ELSE                /*                       @Z40LB30*/ 05353000
*                 CC03=LASTCC08;    /*                       @Z40LB30*/ 05354000
         B     @RC01224                                            1237 05355000
@RF01224 LA    CC03,8                                              1237 05356000
*             END;                  /*                       @Z40LB30*/ 05357000
@RC01224 DS    0H                                                  1239 05358000
*       END;                        /*                       @Z40LB30*/ 05359000
@RC01210 DS    0H                                                  1239 05360000
@RC01208 DS    0H                                                  1240 05361000
*   END;                            /*                       @Z40LB30*/ 05362000
@RC01169 AL    ELEMENT,@CF00221                                    1240 05363000
@DE01168 L     @01,LISTADDR                                        1240 05364000
         C     ELEMENT,VSDELEM(,@01)                               1240 05365000
         BNH   @DL01168                                            1240 05366000
*                                                                  1241 05367000
*   /*****************************************************************/ 05368000
*   /*                                                               */ 05369000
*   /* IF A SYSCTLG DATA SET HAS BEEN FOUND, DETERMINE       @Z40LB30*/ 05370000
*   /* WHETHER TO SCRATCH IT OR NOT.                         @Z40LB30*/ 05371000
*   /*                                                               */ 05372000
*   /*****************************************************************/ 05373000
*                                                                  1241 05374000
*   IF SYSCTCNT>0 THEN              /*                       @Z40LB30*/ 05375000
         SLR   @06,@06                                             1241 05376000
         CH    @06,SYSCTCNT                                        1241 05377000
         BNL   @RF01241                                            1241 05378000
*     DO;                           /*                       @Z40LB30*/ 05379000
*                                                                  1242 05380000
*       /*************************************************************/ 05381000
*       /*                                                           */ 05382000
*       /* IF THE PURGE PARAMETER WAS SPECIFIED, SCRATCH     @Z40LB30*/ 05383000
*       /* THE DATA SET                                      @Z40LB30*/ 05384000
*       /*                                                           */ 05385000
*       /*************************************************************/ 05386000
*                                                                  1243 05387000
*       IF ADDR(PURGE)^=NULLPTR THEN/*                       @Z40LB30*/ 05388000
         L     @15,@PC00001+4                                      1243 05389000
         C     @06,FDTPTR+64(,@15)                                 1243 05390000
         BE    @RF01243                                            1243 05391000
*         DO;                       /*                       @Z40LB30*/ 05392000
*                                                                  1244 05393000
*           /*********************************************************/ 05394000
*           /*                                                       */ 05395000
*           /* ISSUE USCRATCH MACRO AND SAVE THE RETURN      @Z40LB30*/ 05396000
*           /* CODE. ALSO RESET SYSCTLG COUNTER.             @Z40LB30*/ 05397000
*           /*                                                       */ 05398000
*           /*********************************************************/ 05399000
*                                                                  1245 05400000
*           CALL IDCSASC0(GDTTBL,SYSCTLG,ADDR(UVOLLIST),/*   @Z40LB30*/ 05401000
*               OVERRIDE);          /*                       @Z40LB30*/ 05402000
         L     @06,@PC00001                                        1245 05403000
         ST    @06,@AL00001                                        1245 05404000
         LA    @02,@CC01479                                        1245 05405000
         ST    @02,@AL00001+4                                      1245 05406000
         LA    @02,SCRAREA                                         1245 05407000
         ST    @02,@AFTEMPS                                        1245 05408000
         LA    @02,@AFTEMPS                                        1245 05409000
         ST    @02,@AL00001+8                                      1245 05410000
         LA    @02,OVERRIDE                                        1245 05411000
         ST    @02,@AL00001+12                                     1245 05412000
         MVI   @AL00001+12,X'80'                                   1245 05413000
         L     @15,GDTSCR(,@06)                                    1245 05414000
         LA    @01,@AL00001                                        1245 05415000
         BALR  @14,@15                                             1245 05416000
*           RESPECIFY                                              1246 05417000
*             RTNREG RSTD;                                         1246 05418000
*           TESTRC=RTNREG;                                         1247 05419000
         LR    TESTRC,RTNREG                                       1247 05420000
*           RESPECIFY                                              1248 05421000
*             RTNREG UNRSTD;        /*                       @Z40LB30*/ 05422000
*           SYSCTCNT=0;             /*                       @Z40LB30*/ 05423000
*                                                                  1249 05424000
         SLR   @06,@06                                             1249 05425000
         STH   @06,SYSCTCNT                                        1249 05426000
*           /*********************************************************/ 05427000
*           /*                                                       */ 05428000
*           /* IF USCRATCH IS SUCCESSFUL, ISSUE MSG IDC0112I @Z40LB30*/ 05429000
*           /* AND INCREMENT COUNTE OF SCRATCHED DATA        @Z40LB30*/ 05430000
*           /* SETS.                                         @Z40LB30*/ 05431000
*           /*                                                       */ 05432000
*           /*********************************************************/ 05433000
*                                                                  1250 05434000
*           IF TESTRC=0 THEN        /*                       @Z40LB30*/ 05435000
         CR    TESTRC,@06                                          1250 05436000
         BNE   @RF01250                                            1250 05437000
*             DO;                   /*                       @Z40LB30*/ 05438000
*               DARGAREA=''B;       /*                       @Z40LB30*/ 05439000
         XC    DARGAREA(28),DARGAREA                               1252 05440000
*               DARGSMOD=CM0MSG;    /*                       @Z40LB30*/ 05441000
         L     @06,DDSTRU                                          1253 05442000
         MVC   DARGSMOD(3,@06),@CC01418                            1253 05443000
*               DARGSENT=MSG0112I;  /*                       @Z40LB30*/ 05444000
         MVI   DARGSENT(@06),X'44'                                 1254 05445000
*               DARGDBP=ADDR(SYSCTLG);/*                     @Z40LB30*/ 05446000
         LA    @15,@CC01479                                        1255 05447000
         ST    @15,DARGDBP(,@06)                                   1255 05448000
*               DARGILP=LENGTH(SYSCTLG);/*                   @Z40LB30*/ 05449000
         MVC   DARGILP(2,@06),@CH00848                             1256 05450000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB30*/ 05451000
         L     @06,@PC00001                                        1257 05452000
         ST    @06,@AL00001                                        1257 05453000
         LA    @15,@CF00116                                        1257 05454000
         ST    @15,@AL00001+4                                      1257 05455000
         LA    @15,DDSTRU                                          1257 05456000
         ST    @15,@AL00001+8                                      1257 05457000
         MVI   @AL00001+8,X'80'                                    1257 05458000
         L     @15,GDTPRT(,@06)                                    1257 05459000
         LA    @01,@AL00001                                        1257 05460000
         BALR  @14,@15                                             1257 05461000
*               SCRATCNT=SCRATCNT+1;/*                       @Z40LB30*/ 05462000
         LA    @06,1                                               1258 05463000
         AH    @06,SCRATCNT                                        1258 05464000
         STH   @06,SCRATCNT                                        1258 05465000
*             END;                  /*                       @Z40LB30*/ 05466000
*                                                                  1259 05467000
*           /*********************************************************/ 05468000
*           /*                                                       */ 05469000
*           /* IF USCRATCH IS NOT SUCCESSFUL, SET INTERNAL   @Z40LB30*/ 05470000
*           /* CONDITION CODE                                @Z40LB30*/ 05471000
*           /*                                                       */ 05472000
*           /*********************************************************/ 05473000
*                                                                  1260 05474000
*           ELSE                    /*                       @Z40LB30*/ 05475000
*             CC03=LASTCC08;        /*                       @Z40LB30*/ 05476000
         B     @RC01250                                            1260 05477000
@RF01250 LA    CC03,8                                              1260 05478000
*         END;                      /*                       @Z40LB30*/ 05479000
@RC01250 DS    0H                                                  1262 05480000
*     END;                          /*                       @Z40LB30*/ 05481000
@RF01243 DS    0H                                                  1263 05482000
*                                                                  1263 05483000
*   /*****************************************************************/ 05484000
*   /*                                                               */ 05485000
*   /* PRINT MESSAGE IDC0812I TO SUMMARIZE THE NUMBER OF     @Z40LB30*/ 05486000
*   /* DATA SETS SCRATCHED                                   @Z40LB30*/ 05487000
*   /*                                                               */ 05488000
*   /*****************************************************************/ 05489000
*                                                                  1263 05490000
*   DARGAREA=''B;                   /*                       @Z40LB30*/ 05491000
@RF01241 XC    DARGAREA(28),DARGAREA                               1263 05492000
*   DARGSMOD=SD01MSG;               /*                       @Z40LB30*/ 05493000
         L     @06,DDSTRU                                          1264 05494000
         MVC   DARGSMOD(3,@06),@CC01420                            1264 05495000
*   DARGSENT=MSG0812I;              /*                       @Z40LB30*/ 05496000
         MVI   DARGSENT(@06),X'03'                                 1265 05497000
*   DARGCNT=2;                      /*                       @Z40LB30*/ 05498000
         LA    @15,2                                               1266 05499000
         STH   @15,DARGCNT(,@06)                                   1266 05500000
*   DARGINS(1)=1;                   /*                       @Z40LB30*/ 05501000
         MVC   DARGINS(2,@06),@CH00221                             1267 05502000
*   DARGINL(1)=LENGTH(SCRATCNT);    /*                       @Z40LB30*/ 05503000
         STH   @15,DARGINL(,@06)                                   1268 05504000
*   DARGDTM(1)=ADDR(SCRATCNT);      /*                       @Z40LB30*/ 05505000
         LA    @14,SCRATCNT                                        1269 05506000
         ST    @14,DARGDTM(,@06)                                   1269 05507000
*   DARGINS(2)=2;                   /*                       @Z40LB30*/ 05508000
         STH   @15,DARGINS+8(,@06)                                 1270 05509000
*   DARGINL(2)=LENGTH(BASSERNO);    /*                       @Z40LB30*/ 05510000
         MVC   DARGINL+8(2,@06),@CH00158                           1271 05511000
*   DARGDTM(2)=ADDR(BASSERNO);      /*                       @Z40LB30*/ 05512000
         LA    @15,BASSERNO(,BASEVPTR)                             1272 05513000
         ST    @15,DARGDTM+8(,@06)                                 1272 05514000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Z40LB30*/ 05515000
*                                                                  1273 05516000
         L     @06,@PC00001                                        1273 05517000
         ST    @06,@AL00001                                        1273 05518000
         LA    @15,@CF00116                                        1273 05519000
         ST    @15,@AL00001+4                                      1273 05520000
         LA    @15,DDSTRU                                          1273 05521000
         ST    @15,@AL00001+8                                      1273 05522000
         MVI   @AL00001+8,X'80'                                    1273 05523000
         L     @15,GDTPRT(,@06)                                    1273 05524000
         LA    @01,@AL00001                                        1273 05525000
         BALR  @14,@15                                             1273 05526000
*   /*****************************************************************/ 05527000
*   /*                                                               */ 05528000
*   /* IF THE SYSCTLG DATA SET WAS NOT SCRATCHED, PRINT      @Z40LB30*/ 05529000
*   /* MESSAGE IDC0816I TO SAY IT WAS NOT SCRATCHED.         @Z40LB30*/ 05530000
*   /*                                                               */ 05531000
*   /*****************************************************************/ 05532000
*                                                                  1274 05533000
*   IF SYSCTCNT>0 THEN              /*                       @Z40LB30*/ 05534000
         LH    @06,SYSCTCNT                                        1274 05535000
         LTR   @06,@06                                             1274 05536000
         BNP   @RF01274                                            1274 05537000
*     DO;                           /*                       @Z40LB30*/ 05538000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 05539000
         XC    DARGAREA(28),DARGAREA                               1276 05540000
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/ 05541000
         L     @06,DDSTRU                                          1277 05542000
         MVC   DARGSMOD(3,@06),@CC01420                            1277 05543000
*       DARGSENT=MSG0816I;          /*                       @Z40LB30*/ 05544000
         MVI   DARGSENT(@06),X'08'                                 1278 05545000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 05546000
         L     @06,@PC00001                                        1279 05547000
         ST    @06,@AL00001                                        1279 05548000
         LA    @15,@CF00116                                        1279 05549000
         ST    @15,@AL00001+4                                      1279 05550000
         LA    @15,DDSTRU                                          1279 05551000
         ST    @15,@AL00001+8                                      1279 05552000
         MVI   @AL00001+8,X'80'                                    1279 05553000
         L     @15,GDTPRT(,@06)                                    1279 05554000
         LA    @01,@AL00001                                        1279 05555000
         BALR  @14,@15                                             1279 05556000
*     END;                          /*                       @Z40LB30*/ 05557000
*                                                                  1280 05558000
*   /*****************************************************************/ 05559000
*   /*                                                               */ 05560000
*   /* IF ANY GDGS WERE NOT SCRATCHED, PRINT MESSAGE         @Z40LB30*/ 05561000
*   /* IDC0813I TO SAY HOW MANY GDGS WERE NOT SCRATCHED      @Z40LB30*/ 05562000
*   /*                                                               */ 05563000
*   /*****************************************************************/ 05564000
*                                                                  1281 05565000
*   IF GDGCNT>0 THEN                /*                       @Z40LB30*/ 05566000
@RF01274 LH    @06,GDGCNT                                          1281 05567000
         LTR   @06,@06                                             1281 05568000
         BNP   @RF01281                                            1281 05569000
*     DO;                           /*                       @Z40LB30*/ 05570000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 05571000
         XC    DARGAREA(28),DARGAREA                               1283 05572000
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/ 05573000
         L     @06,DDSTRU                                          1284 05574000
         MVC   DARGSMOD(3,@06),@CC01420                            1284 05575000
*       DARGSENT=MSG0813I;          /*                       @Z40LB30*/ 05576000
         MVI   DARGSENT(@06),X'04'                                 1285 05577000
*       DARGDBP=ADDR(GDGCNT);       /*                       @Z40LB30*/ 05578000
         LA    @15,GDGCNT                                          1286 05579000
         ST    @15,DARGDBP(,@06)                                   1286 05580000
*       DARGILP=LENGTH(GDGCNT);     /*                       @Z40LB30*/ 05581000
         MVC   DARGILP(2,@06),@CH00155                             1287 05582000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 05583000
         L     @06,@PC00001                                        1288 05584000
         ST    @06,@AL00001                                        1288 05585000
         LA    @15,@CF00116                                        1288 05586000
         ST    @15,@AL00001+4                                      1288 05587000
         LA    @15,DDSTRU                                          1288 05588000
         ST    @15,@AL00001+8                                      1288 05589000
         MVI   @AL00001+8,X'80'                                    1288 05590000
         L     @15,GDTPRT(,@06)                                    1288 05591000
         LA    @01,@AL00001                                        1288 05592000
         BALR  @14,@15                                             1288 05593000
*     END;                          /*                       @Z40LB30*/ 05594000
*                                                                  1289 05595000
*   /*****************************************************************/ 05596000
*   /*                                                               */ 05597000
*   /* IF ANY MULTI-VOLUME DATA SETS WERE NOT SCRATCHED      @Z40LB30*/ 05598000
*   /* PRINT MESSAGE IDC0814I TO SAY HOW MANY MULTI-VOLUME   @Z40LB30*/ 05599000
*   /* DATA SETS WERE NOT SCRATCHED                          @Z40LB30*/ 05600000
*   /*                                                               */ 05601000
*   /*****************************************************************/ 05602000
*                                                                  1290 05603000
*   IF MULTICNT>0 THEN              /*                       @Z40LB30*/ 05604000
@RF01281 LH    @06,MULTICNT                                        1290 05605000
         LTR   @06,@06                                             1290 05606000
         BNP   @RF01290                                            1290 05607000
*     DO;                           /*                       @Z40LB30*/ 05608000
*       DARGAREA=''B;               /*                       @Z40LB30*/ 05609000
         XC    DARGAREA(28),DARGAREA                               1292 05610000
*       DARGSMOD=SD01MSG;           /*                       @Z40LB30*/ 05611000
         L     @06,DDSTRU                                          1293 05612000
         MVC   DARGSMOD(3,@06),@CC01420                            1293 05613000
*       DARGSENT=MSG0814I;          /*                       @Z40LB30*/ 05614000
         MVI   DARGSENT(@06),X'05'                                 1294 05615000
*       DARGDBP=ADDR(MULTICNT);     /*                       @Z40LB30*/ 05616000
         LA    @15,MULTICNT                                        1295 05617000
         ST    @15,DARGDBP(,@06)                                   1295 05618000
*       DARGILP=LENGTH(MULTICNT);   /*                       @Z40LB30*/ 05619000
         MVC   DARGILP(2,@06),@CH00155                             1296 05620000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB30*/ 05621000
         L     @06,@PC00001                                        1297 05622000
         ST    @06,@AL00001                                        1297 05623000
         LA    @15,@CF00116                                        1297 05624000
         ST    @15,@AL00001+4                                      1297 05625000
         LA    @15,DDSTRU                                          1297 05626000
         ST    @15,@AL00001+8                                      1297 05627000
         MVI   @AL00001+8,X'80'                                    1297 05628000
         L     @15,GDTPRT(,@06)                                    1297 05629000
         LA    @01,@AL00001                                        1297 05630000
         BALR  @14,@15                                             1297 05631000
*     END;                          /*                       @Z40LB30*/ 05632000
*                                                                  1298 05633000
*   /*****************************************************************/ 05634000
*   /*                                                               */ 05635000
*   /* IF SOME ERRORS OCCURRED AND NO DATA SETS WERE         @Z40LB30*/ 05636000
*   /* SCRATCHED, INCREASE THE CONDITION CODE                @Z40LB30*/ 05637000
*   /*                                                               */ 05638000
*   /*****************************************************************/ 05639000
*                                                                  1299 05640000
*   IF CC03=LASTCC08&SCRATCNT=0 THEN/*                       @Z40LB30*/ 05641000
@RF01290 C     CC03,@CF00181                                       1299 05642000
         BNE   @RF01299                                            1299 05643000
         LH    @06,SCRATCNT                                        1299 05644000
         LTR   @06,@06                                             1299 05645000
         BNZ   @RF01299                                            1299 05646000
*     CC03=LASTCC12;                /*                       @Z40LB30*/ 05647000
*                                                                  1300 05648000
         LA    CC03,12                                             1300 05649000
*   /*****************************************************************/ 05650000
*   /*                                                               */ 05651000
*   /* RETURN TO CALLER                                      @Z40LB30*/ 05652000
*   /*                                                               */ 05653000
*   /*****************************************************************/ 05654000
*                                                                  1301 05655000
*   RETURN CODE(CC03);              /*                       @Z40LB30*/ 05656000
@RF01299 LR    @15,CC03                                            1301 05657000
@EL00012 DS    0H                                                  1301 05658000
@EF00012 DS    0H                                                  1301 05659000
@ER00012 L     @14,@SA00012                                        1301 05660000
         BR    @14                                                 1301 05661000
*   END SCRUNCAT;                   /*                       @Z40LB30*/ 05662000
*                                                                  1303 05663000
*/********************************************************************/ 05664000
*/*                                                          @Z40LB35*/ 05665000
*/* PROCEDURE NAME - DATES  (ACCESS METHOD SERVICES)         @Z40LB35*/ 05666000
*/*                                                          @Z40LB35*/ 05667000
*/* FUNCTION - THIS COMMON INCLUDED PROCEDURE PROVIDES       @Z40LB35*/ 05668000
*/*            THE AMS SERVICES WITH THE BASIC FUNCTION OF   @Z40LB35*/ 05669000
*/*            CONVERTING A ONE VALUE DATE SUCH AS 99999 TO  @Z40LB35*/ 05670000
*/*            '00 99 0999' OR OBTAINING THE CURRENT DATE AND@Z40LB35*/ 05671000
*/*            ADJUSTING IT BY EITHER ADDING OR SUBTRACTING  @Z40LB35*/ 05672000
*/*            DAYS TO THAT DATE.  THE DATE WILL BE ADJUSTED @Z40LB35*/ 05673000
*/*            FOR ANY LEAP YEARS.  THE DATE WILL ALSO BE    @Z40LB35*/ 05674000
*/*            ADJUSTED TO FIT WITHIN THE RANGE 0 TO 99999.  @Z40LB35*/ 05675000
*/*                                                          @Z40LB35*/ 05676000
*/* ENTRY POINT - DATES                                      @Z40LB35*/ 05677000
*/*                                                          @Z40LB35*/ 05678000
*/*      LINKAGE - 'CALL DATES (DATESAGL)'                   @Z40LB35*/ 05679000
*/*                '%INCLUDE SYSLIB(IDCDF55)'                @Z40LB35*/ 05680000
*/*                                                          @Z40LB35*/ 05681000
*/* INPUT  - ADDRESS OF ARGUMENT LIST (DATESAGL)             @Z40LB35*/ 05682000
*/*                                                          @Z40LB35*/ 05683000
*/* OUTPUT - A RETURN CODE IN REGISTER 15                    @Z40LB35*/ 05684000
*/*          (0) - DATES SUCCESSFUL                          @Z40LB35*/ 05685000
*/*                                                          @Z40LB35*/ 05686000
*/*        - A CONVERTED DATE (00 YY DDDD) IN BINARY         @Z40LB35*/ 05687000
*/*                                                          @Z40LB35*/ 05688000
*/* EXIT NORMAL - RETURNS TO CALLER WITH CONDITION           @Z40LB35*/ 05689000
*/*               CODE ZERO                                  @Z40LB35*/ 05690000
*/*                                                          @Z40LB35*/ 05691000
*/* EXIT ERROR  - NONE                                       @Z40LB35*/ 05692000
*/*                                                          @Z40LB35*/ 05693000
*/* CHANGE ACTIVITY - NONE                                   @Z40LB35*/ 05694000
*/*                                                          @Z40LB35*/ 05695000
*/********************************************************************/ 05696000
*                                                                  1303 05697000
*DATES:                                                            1303 05698000
*   PROC;                           /*                       @Z40LB35*/ 05699000
*                                                                  1303 05700000
DATES    STM   @14,@12,@SA00013                                    1303 05701000
*   /*****************************************************************/ 05702000
*   /*                                                               */ 05703000
*   /* DECLARATION FOR DATES PROCEDURE                       @Z40LB35*/ 05704000
*   /*                                                               */ 05705000
*   /*****************************************************************/ 05706000
*                                                                  1304 05707000
*   DCL                                                            1304 05708000
*     TIMEVAR CHAR(8);              /* TIME VARIABLE - UTIME @Z40LB35   05709000
*                                      USED IN UTIME CALL    @Z40LB35*/ 05710000
*   DCL                                                            1305 05711000
*     1 DATEVAR CHAR(4),            /* DATE VARIABLE - UTIME @Z40LB35*/ 05712000
*      2 * CHAR(1),                 /* FILLER - RESERVED     @Z40LB35*/ 05713000
*      2 DATEPACK CHAR(3);          /* DATE RETURN - PACKED  @Z40LB35   05714000
*                                      DECIMAL FORMAT        @Z40LB35*/ 05715000
*                                                                  1305 05716000
*   /*****************************************************************/ 05717000
*   /*                                                               */ 05718000
*   /* THE FOLLOWING STRUCTURE IS THE DATE RETURNED          @Z40LB35*/ 05719000
*   /*                                                               */ 05720000
*   /*****************************************************************/ 05721000
*                                                                  1306 05722000
*   DCL                                                            1306 05723000
*     1 CONVDATE BDY(WORD) BASED(DATRETRN),                        1306 05724000
*      2 CONVYEAR FIXED(15),        /* YEAR - RANGE 0 - 99   @Z40LB35*/ 05725000
*      2 CONVDAYS FIXED(15);        /* DAYS - RANGE 0 - 999  @Z40LB35*/ 05726000
*                                                                  1306 05727000
*   /*****************************************************************/ 05728000
*   /*                                                               */ 05729000
*   /* THE FOLLOWING DECLARES ARE INTERNAL FIELDS            @Z40LB35*/ 05730000
*   /*                                                               */ 05731000
*   /*****************************************************************/ 05732000
*                                                                  1307 05733000
*   DCL                                                            1307 05734000
*     DATEBIN FIXED(31);            /* USED TO UNPACK DATE   @Z40LB35*/ 05735000
*   DCL                                                            1308 05736000
*     QUITSW BIT(1);                /* USED TO CONTROL LOOPS @Z40LB35*/ 05737000
*   DCL                                                            1309 05738000
*     ADJDAYS FIXED(31);            /* USED TO ADJUST DAYS   @Z40LB35*/ 05739000
*                                                                  1309 05740000
*   /*****************************************************************/ 05741000
*   /*                                                               */ 05742000
*   /* THE FOLLOWING ARE STATIC CONSTANTS                    @Z40LB35*/ 05743000
*   /*                                                               */ 05744000
*   /*****************************************************************/ 05745000
*                                                                  1310 05746000
*   DCL                                                            1310 05747000
*     REGYEAR FIXED(15) INIT(365);  /*                       @Z40LB35   05748000
*                                      NUM DAYS IN REG YEAR  @Z40LB35*/ 05749000
*   DCL                                                            1311 05750000
*     LEAPYEAR FIXED(15) INIT(366); /*                       @Z40LB35   05751000
*                                      NUM DAYS IN LEAP YEAR @Z40LB35*/ 05752000
*   DCL                                                            1312 05753000
*     MAXYEAR FIXED(15) INIT(99);   /*                       @Z40LB35   05754000
*                                      HIGHEST YEAR          @Z40LB35*/ 05755000
*   DCL                                                            1313 05756000
*     MAXDAYS FIXED(15) INIT(999);  /*                       @Z40LB35   05757000
*                                      HIGHEST DAYS          @Z40LB35*/ 05758000
*   DCL                                                            1314 05759000
*     MINYEAR FIXED(15) INIT(0);    /*                       @Z40LB35   05760000
*                                      LOWEST YEAR           @Z40LB35*/ 05761000
*   DCL                                                            1315 05762000
*     MINDAYS FIXED(15) INIT(0);    /*                       @Z40LB35   05763000
*                                      LOWEST DAYS           @Z40LB35*/ 05764000
*   DCL                                                            1316 05765000
*     NOREMAIN FIXED(15) INIT(0);   /*                       @Z40LB35   05766000
*                                      NO REMAINDER AFTER DIV      1316 05767000
*                                                            @Z40LB35*/ 05768000
*                                                                  1317 05769000
*   /*****************************************************************/ 05770000
*   /*                                                               */ 05771000
*   /* THIS IS THE START OF THIS PROCEDURE                   @Z40LB35*/ 05772000
*   /* HERE INITIALIZATION TAKES PLACE.                      @Z40LB35*/ 05773000
*   /* THE PARM LIST HEADER IS INITIALIZED,                  @Z40LB35*/ 05774000
*   /* THE TRACE POINT 'DTST' IS RECORDED, AND               @Z40LB35*/ 05775000
*   /* THE DATE IS SET TO ZERO.                              @Z40LB35*/ 05776000
*   /*                                                               */ 05777000
*   /*****************************************************************/ 05778000
*                                                                  1317 05779000
*   OLDERID2=NEWERID2;                                             1317 05780000
         L     @08,@PC00001                                        1317 05781000
         L     @15,GDTTR2(,@08)                                    1317 05782000
         MVC   @TS00001(95),NEWERID2(@15)                          1317 05783000
         MVC   OLDERID2(95,@15),@TS00001                           1317 05784000
*   NEWID2='DTST';                  /*                       @Z40LB35*/ 05785000
         MVC   NEWID2(4,@15),@CC01598                              1318 05786000
*   DATHEAD='DATESAGL';             /*                       @Z40LB35*/ 05787000
         LA    @15,DTSAREA                                         1319 05788000
         MVC   DATHEAD(8,@15),@CC01599                             1319 05789000
*   CONVDATE=0;                     /*                       @Z40LB35*/ 05790000
*                                                                  1320 05791000
         L     @01,DATRETRN(,@15)                                  1320 05792000
         SLR   @00,@00                                             1320 05793000
         ST    @00,CONVDATE(,@01)                                  1320 05794000
*   /*****************************************************************/ 05795000
*   /*                                                               */ 05796000
*   /* DETERMINE IF CALLER WANTS THE CURRENT DATE            @Z40LB35*/ 05797000
*   /* ADJUSTED WITH DAYS ADD OR SUBTRACTED.                 @Z40LB35*/ 05798000
*   /*                                                               */ 05799000
*   /*****************************************************************/ 05800000
*                                                                  1321 05801000
*   IF DATDAYOP=ON THEN                                            1321 05802000
         TM    DATDAYOP(@15),B'00010000'                           1321 05803000
         BNO   @RF01321                                            1321 05804000
*     DO;                           /*                       @Z40LB35*/ 05805000
*                                                                  1322 05806000
*       /*************************************************************/ 05807000
*       /*                                                           */ 05808000
*       /* IF CALLER WANTS TO ADJUST CURRENT DATE,           @Z40LB35*/ 05809000
*       /* ISSUE UTIME TO RETRIEVE CURRENT DATE,             @Z40LB35*/ 05810000
*       /* CONVERT THE DATE FROM PACKED DECIMAL TO           @Z40LB35*/ 05811000
*       /* BINARY, AND SEPARATE THE YEARS FROM THE           @Z40LB35*/ 05812000
*       /* DAYS.                                             @Z40LB35*/ 05813000
*       /*                                                           */ 05814000
*       /*************************************************************/ 05815000
*                                                                  1323 05816000
*       ADJDAYS=DATDAYS;            /*                       @Z40LB35*/ 05817000
         L     ADJDAYS,DATDAYS(,@15)                               1323 05818000
*       CALL IDCSATI0(GDTTBL,TIMEVAR,DATEVAR);/*             @Z40LB35*/ 05819000
         ST    @08,@AL00001                                        1324 05820000
         LA    @15,TIMEVAR                                         1324 05821000
         ST    @15,@AL00001+4                                      1324 05822000
         LA    @15,DATEVAR                                         1324 05823000
         ST    @15,@AL00001+8                                      1324 05824000
         MVI   @AL00001+8,X'80'                                    1324 05825000
         L     @15,GDTTIM(,@08)                                    1324 05826000
         LA    @01,@AL00001                                        1324 05827000
         BALR  @14,@15                                             1324 05828000
*       CVB(DATEBIN,DATEPACK);      /*                       @Z40LB35*/ 05829000
         XC    @TS00001(8),@TS00001                                1325 05830000
         MVC   @TS00001+5(3),DATEPACK                              1325 05831000
         CVB   DATEBIN,@TS00001                                    1325 05832000
*       CONVYEAR=DATEBIN/1000;      /*                       @Z40LB35*/ 05833000
         LA    @08,DTSAREA                                         1326 05834000
         L     @15,DATRETRN(,@08)                                  1326 05835000
         LA    @14,1000                                            1326 05836000
         LR    @00,DATEBIN                                         1326 05837000
         SRDA  @00,32                                              1326 05838000
         DR    @00,@14                                             1326 05839000
         STH   @01,CONVYEAR(,@15)                                  1326 05840000
*       CONVDAYS=DATEBIN-(CONVYEAR*1000);/*                  @Z40LB35*/ 05841000
*                                                                  1327 05842000
         MR    @00,@14                                             1327 05843000
         LCR   @01,@01                                             1327 05844000
         ALR   @01,DATEBIN                                         1327 05845000
         STH   @01,CONVDAYS(,@15)                                  1327 05846000
*       /*************************************************************/ 05847000
*       /*                                                           */ 05848000
*       /* INITIALIZE QUITSW OFF FOR LOOP CONTROL            @Z40LB35*/ 05849000
*       /*                                                           */ 05850000
*       /*************************************************************/ 05851000
*                                                                  1328 05852000
*       QUITSW=OFF;                 /*                       @Z40LB35*/ 05853000
*                                                                  1328 05854000
         NI    QUITSW,B'01111111'                                  1328 05855000
*       /*************************************************************/ 05856000
*       /*                                                           */ 05857000
*       /* DETERMINE IF CALLER WANTS DAYS ADDED TO           @Z40LB35*/ 05858000
*       /* CURRENT DATE.                                     @Z40LB35*/ 05859000
*       /*                                                           */ 05860000
*       /*************************************************************/ 05861000
*                                                                  1329 05862000
*       IF DATADD=ON THEN                                          1329 05863000
*                                                                  1329 05864000
         TM    DATADD(@08),B'10000000'                             1329 05865000
         BNO   @RF01329                                            1329 05866000
*         /***********************************************************/ 05867000
*         /*                                                         */ 05868000
*         /* IF CALLER WANTS DAYS ADDED, LOOP THOUGH         @Z40LB35*/ 05869000
*         /* THE FOLLOWING DO LOOP UNTIL QUITSW IS SET       @Z40LB35*/ 05870000
*         /*                                                         */ 05871000
*         /***********************************************************/ 05872000
*                                                                  1330 05873000
*         DO WHILE QUITSW=OFF;      /*                       @Z40LB35*/ 05874000
*                                                                  1330 05875000
         B     @DE01330                                            1330 05876000
@DL01330 DS    0H                                                  1331 05877000
*           /*********************************************************/ 05878000
*           /*                                                       */ 05879000
*           /* TEST FOR LEAP YEAR - EVERY FOUTH YEAR IS LEAP @Z40LB35*/ 05880000
*           /* YEAR. IF NO REMAINDER AFTER DIVIDING BY FOUR  @Z40LB35*/ 05881000
*           /* THEN THE YEAR BEING PROCESSED IS A LEAP YEAR  @Z40LB35*/ 05882000
*           /*                                                       */ 05883000
*           /*********************************************************/ 05884000
*                                                                  1331 05885000
*           IF CONVYEAR//4=NOREMAIN THEN                           1331 05886000
*                                                                  1331 05887000
         LA    @08,DTSAREA                                         1331 05888000
         L     @08,DATRETRN(,@08)                                  1331 05889000
         LH    @03,CONVYEAR(,@08)                                  1331 05890000
         LR    @00,@03                                             1331 05891000
         SRDA  @00,32                                              1331 05892000
         D     @00,@CF00042                                        1331 05893000
         CH    @00,NOREMAIN                                        1331 05894000
         BNE   @RF01331                                            1331 05895000
*             /*******************************************************/ 05896000
*             /*                                                     */ 05897000
*             /* DETERMINE IF THE DAYS BEING ADDED CAN BE    @Z40LB35*/ 05898000
*             /* ADDED TO CURRENT YEAR BEING PROCESSED WITHOUT       */ 05899000
*             /*                                             @Z40LB35*/ 05900000
*             /* AN OVERFLOW INTO THE NEXT YEAR.             @Z40LB35*/ 05901000
*             /*                                                     */ 05902000
*             /*******************************************************/ 05903000
*                                                                  1332 05904000
*             IF(ADJDAYS+CONVDAYS)>LEAPYEAR THEN                   1332 05905000
*                                                                  1332 05906000
         LH    @15,LEAPYEAR                                        1332 05907000
         LR    @14,ADJDAYS                                         1332 05908000
         AH    @14,CONVDAYS(,@08)                                  1332 05909000
         CR    @14,@15                                             1332 05910000
         BNH   @RF01332                                            1332 05911000
*               /*****************************************************/ 05912000
*               /*                                                   */ 05913000
*               /* SUBTRACT LEAP YEAR DAYS (366) FROM DAYS   @Z40LB35*/ 05914000
*               /* AND INCREMENT YEAR BY ONE                 @Z40LB35*/ 05915000
*               /*                                                   */ 05916000
*               /*****************************************************/ 05917000
*                                                                  1333 05918000
*               DO;                 /*                       @Z40LB35*/ 05919000
*                 ADJDAYS=ADJDAYS-LEAPYEAR;/*                @Z40LB35*/ 05920000
         SLR   ADJDAYS,@15                                         1334 05921000
*                 CONVYEAR=CONVYEAR+1;/*                     @Z40LB35*/ 05922000
         AL    @03,@CF00221                                        1335 05923000
         STH   @03,CONVYEAR(,@08)                                  1335 05924000
*               END;                /*                       @Z40LB35*/ 05925000
*             ELSE                                                 1337 05926000
*                                                                  1337 05927000
*               /*****************************************************/ 05928000
*               /*                                                   */ 05929000
*               /* INCREMENT DAYS AND SET QUITSW TO FALL OUT @Z40LB35*/ 05930000
*               /* OF DO LOOP                                @Z40LB35*/ 05931000
*               /*                                                   */ 05932000
*               /*****************************************************/ 05933000
*                                                                  1337 05934000
*               DO;                 /*                       @Z40LB35*/ 05935000
         B     @RC01332                                            1337 05936000
@RF01332 DS    0H                                                  1338 05937000
*                 CONVDAYS=ADJDAYS+CONVDAYS;/*               @Z40LB35*/ 05938000
         LA    @08,DTSAREA                                         1338 05939000
         L     @08,DATRETRN(,@08)                                  1338 05940000
         LR    @03,ADJDAYS                                         1338 05941000
         AH    @03,CONVDAYS(,@08)                                  1338 05942000
         STH   @03,CONVDAYS(,@08)                                  1338 05943000
*                 QUITSW=ON;        /*                       @Z40LB35*/ 05944000
         OI    QUITSW,B'10000000'                                  1339 05945000
*               END;                /*                       @Z40LB35*/ 05946000
*           ELSE                                                   1341 05947000
*                                                                  1341 05948000
*             /*******************************************************/ 05949000
*             /*                                                     */ 05950000
*             /* DETERMINE IF THE DAYS BEING ADDED CAN BE    @Z40LB35*/ 05951000
*             /* ADDED TO CURRENT YEAR BEING PROCESSED WITHOUT       */ 05952000
*             /*                                             @Z40LB35*/ 05953000
*             /* AN OVERFLOW INTO THE NEXT YEAR.             @Z40LB35*/ 05954000
*             /*                                                     */ 05955000
*             /*******************************************************/ 05956000
*                                                                  1341 05957000
*             IF(ADJDAYS+CONVDAYS)>REGYEAR THEN                    1341 05958000
*                                                                  1341 05959000
         B     @RC01331                                            1341 05960000
@RF01331 LH    @08,REGYEAR                                         1341 05961000
         LA    @03,DTSAREA                                         1341 05962000
         L     @03,DATRETRN(,@03)                                  1341 05963000
         LR    @15,ADJDAYS                                         1341 05964000
         AH    @15,CONVDAYS(,@03)                                  1341 05965000
         CR    @15,@08                                             1341 05966000
         BNH   @RF01341                                            1341 05967000
*               /*****************************************************/ 05968000
*               /*                                                   */ 05969000
*               /* SUBTRACT REG YEAR DAYS (365) FROM DAYS    @Z40LB35*/ 05970000
*               /* AND INCREMENT YEAR BY ONE                 @Z40LB35*/ 05971000
*               /*                                                   */ 05972000
*               /*****************************************************/ 05973000
*                                                                  1342 05974000
*               DO;                 /*                       @Z40LB35*/ 05975000
*                 ADJDAYS=ADJDAYS-REGYEAR;/*                 @Z40LB35*/ 05976000
         SLR   ADJDAYS,@08                                         1343 05977000
*                 CONVYEAR=CONVYEAR+1;/*                     @Z40LB35*/ 05978000
         LA    @08,1                                               1344 05979000
         AH    @08,CONVYEAR(,@03)                                  1344 05980000
         STH   @08,CONVYEAR(,@03)                                  1344 05981000
*               END;                /*                       @Z40LB35*/ 05982000
*             ELSE                                                 1346 05983000
*                                                                  1346 05984000
*               /*****************************************************/ 05985000
*               /*                                                   */ 05986000
*               /* INCREMENT DAYS AND SET QUITSW TO FALL OUT @Z40LB35*/ 05987000
*               /* OF DO LOOP                                @Z40LB35*/ 05988000
*               /*                                                   */ 05989000
*               /*****************************************************/ 05990000
*                                                                  1346 05991000
*               DO;                 /*                       @Z40LB35*/ 05992000
         B     @RC01341                                            1346 05993000
@RF01341 DS    0H                                                  1347 05994000
*                 CONVDAYS=CONVDAYS+ADJDAYS;/*               @Z40LB35*/ 05995000
         LA    @08,DTSAREA                                         1347 05996000
         L     @08,DATRETRN(,@08)                                  1347 05997000
         LR    @03,ADJDAYS                                         1347 05998000
         AH    @03,CONVDAYS(,@08)                                  1347 05999000
         STH   @03,CONVDAYS(,@08)                                  1347 06000000
*                 QUITSW=ON;        /*                       @Z40LB35*/ 06001000
         OI    QUITSW,B'10000000'                                  1348 06002000
*               END;                /*                       @Z40LB35*/ 06003000
*         END;                      /*                       @Z40LB35*/ 06004000
@RC01341 DS    0H                                                  1350 06005000
@RC01331 DS    0H                                                  1350 06006000
@DE01330 TM    QUITSW,B'10000000'                                  1350 06007000
         BZ    @DL01330                                            1350 06008000
*                                                                  1351 06009000
*       /*************************************************************/ 06010000
*       /*                                                           */ 06011000
*       /* IF DAYS ARE TO BE SUBTRACTED FROM CURRENT,        @Z40LB35*/ 06012000
*       /* DO THE FOLLOWING DO GROUP                         @Z40LB35*/ 06013000
*       /*                                                           */ 06014000
*       /*************************************************************/ 06015000
*                                                                  1351 06016000
*       ELSE                                                       1351 06017000
*                                                                  1351 06018000
*         /***********************************************************/ 06019000
*         /*                                                         */ 06020000
*         /* DO THE FOLLOWING WHILE THE QUITSW IS NOT SET    @Z40LB35*/ 06021000
*         /*                                                         */ 06022000
*         /***********************************************************/ 06023000
*                                                                  1351 06024000
*         DO WHILE QUITSW=OFF;      /*                       @Z40LB35*/ 06025000
*                                                                  1351 06026000
         B     @RC01329                                            1351 06027000
@RF01329 B     @DE01351                                            1351 06028000
@DL01351 DS    0H                                                  1352 06029000
*           /*********************************************************/ 06030000
*           /*                                                       */ 06031000
*           /* TEST FOR LEAP YEAR - EVERY FOUTH YEAR IS LEAP @Z40LB35*/ 06032000
*           /* YEAR. IF NO REMAINDER AFTER DIVIDING BY FOUR  @Z40LB35*/ 06033000
*           /* THEN THE YEAR BEING PROCESSED IS A LEAP YEAR  @Z40LB35*/ 06034000
*           /*                                                       */ 06035000
*           /*********************************************************/ 06036000
*                                                                  1352 06037000
*           IF(CONVYEAR-1)//4=NOREMAIN THEN                        1352 06038000
*                                                                  1352 06039000
         LA    @08,DTSAREA                                         1352 06040000
         L     @08,DATRETRN(,@08)                                  1352 06041000
         LH    @03,CONVYEAR(,@08)                                  1352 06042000
         BCTR  @03,0                                               1352 06043000
         LR    @00,@03                                             1352 06044000
         SRDA  @00,32                                              1352 06045000
         D     @00,@CF00042                                        1352 06046000
         CH    @00,NOREMAIN                                        1352 06047000
         BNE   @RF01352                                            1352 06048000
*             /*******************************************************/ 06049000
*             /*                                                     */ 06050000
*             /* TEST TO SEE IF THE YEAR CAN BE DECREMENTED  @Z40LB35*/ 06051000
*             /*                                                     */ 06052000
*             /*******************************************************/ 06053000
*                                                                  1353 06054000
*             IF ADJDAYS>=LEAPYEAR THEN                            1353 06055000
*                                                                  1353 06056000
         LH    @15,LEAPYEAR                                        1353 06057000
         CR    ADJDAYS,@15                                         1353 06058000
         BL    @RF01353                                            1353 06059000
*               /*****************************************************/ 06060000
*               /*                                                   */ 06061000
*               /* SUBTRACT LEAP YEAR DAYS (366) FROM DAYS   @Z40LB35*/ 06062000
*               /* AND DECREMENT YEAR BY ONE                 @Z40LB35*/ 06063000
*               /*                                                   */ 06064000
*               /*****************************************************/ 06065000
*                                                                  1354 06066000
*               DO;                 /*                       @Z40LB35*/ 06067000
*                 ADJDAYS=ADJDAYS-LEAPYEAR;/*                @Z40LB35*/ 06068000
         SLR   ADJDAYS,@15                                         1355 06069000
*                 CONVYEAR=CONVYEAR-1;/*                     @Z40LB35*/ 06070000
         STH   @03,CONVYEAR(,@08)                                  1356 06071000
*               END;                /*                       @Z40LB35*/ 06072000
*             ELSE                                                 1358 06073000
*                                                                  1358 06074000
*               /*****************************************************/ 06075000
*               /*                                                   */ 06076000
*               /* IF NO FULL YEAR, TEST FOR OVERFLOW        @Z40LB35*/ 06077000
*               /*                                                   */ 06078000
*               /*****************************************************/ 06079000
*                                                                  1358 06080000
*               IF(CONVDAYS-ADJDAYS)<=0 THEN                       1358 06081000
*                                                                  1358 06082000
         B     @RC01353                                            1358 06083000
@RF01353 LA    @08,DTSAREA                                         1358 06084000
         L     @08,DATRETRN(,@08)                                  1358 06085000
         LH    @03,CONVDAYS(,@08)                                  1358 06086000
         LR    @15,@03                                             1358 06087000
         SLR   @15,ADJDAYS                                         1358 06088000
         LTR   @15,@15                                             1358 06089000
         BP    @RF01358                                            1358 06090000
*                 /***************************************************/ 06091000
*                 /*                                                 */ 06092000
*                 /* IF YEAR RUNS BACK INTO LAST YEAR,       @Z40LB35*/ 06093000
*                 /* ADJUST DAYS, SUBTRACT YEAR AND SET QUITSW       */ 06094000
*                 /*                                         @Z40LB35*/ 06095000
*                 /*                                                 */ 06096000
*                 /***************************************************/ 06097000
*                                                                  1359 06098000
*                 DO;               /*                       @Z40LB35*/ 06099000
*                   CONVDAYS=CONVDAYS+LEAPYEAR-ADJDAYS;            1360 06100000
         AH    @03,LEAPYEAR                                        1360 06101000
         SLR   @03,ADJDAYS                                         1360 06102000
         STH   @03,CONVDAYS(,@08)                                  1360 06103000
*                   CONVYEAR=CONVYEAR-1;/*                   @Z40LB35*/ 06104000
         LH    @03,CONVYEAR(,@08)                                  1361 06105000
         BCTR  @03,0                                               1361 06106000
         STH   @03,CONVYEAR(,@08)                                  1361 06107000
*                   QUITSW=ON;      /*                       @Z40LB35*/ 06108000
         OI    QUITSW,B'10000000'                                  1362 06109000
*                 END;              /*                       @Z40LB35*/ 06110000
*               ELSE                                               1364 06111000
*                                                                  1364 06112000
*                 /***************************************************/ 06113000
*                 /*                                                 */ 06114000
*                 /* IF YEAR DOES NOT RUNS BACK INTO LAST YEAR,      */ 06115000
*                 /*                                         @Z40LB35*/ 06116000
*                 /* ADJUST DAYS AND SET QUITSW              @Z40LB35*/ 06117000
*                 /*                                                 */ 06118000
*                 /***************************************************/ 06119000
*                                                                  1364 06120000
*                 DO;               /*                       @Z40LB35*/ 06121000
         B     @RC01358                                            1364 06122000
@RF01358 DS    0H                                                  1365 06123000
*                   CONVDAYS=CONVDAYS-ADJDAYS;/*             @Z40LB35*/ 06124000
         LA    @08,DTSAREA                                         1365 06125000
         L     @08,DATRETRN(,@08)                                  1365 06126000
         LH    @03,CONVDAYS(,@08)                                  1365 06127000
         SLR   @03,ADJDAYS                                         1365 06128000
         STH   @03,CONVDAYS(,@08)                                  1365 06129000
*                   QUITSW=ON;      /*                       @Z40LB35*/ 06130000
         OI    QUITSW,B'10000000'                                  1366 06131000
*                 END;              /*                       @Z40LB35*/ 06132000
*                                                                  1367 06133000
*           /*********************************************************/ 06134000
*           /*                                                       */ 06135000
*           /* ELSE THIS IS A NORMAL YEAR(NON-LEAP YEAR)     @Z40LB35*/ 06136000
*           /*                                                       */ 06137000
*           /*********************************************************/ 06138000
*                                                                  1368 06139000
*           ELSE                                                   1368 06140000
*                                                                  1368 06141000
*             /*******************************************************/ 06142000
*             /*                                                     */ 06143000
*             /* TEST TO SEE IF THE YEAR CAN BE DECREMENTED  @Z40LB35*/ 06144000
*             /*                                                     */ 06145000
*             /*******************************************************/ 06146000
*                                                                  1368 06147000
*             IF ADJDAYS>=REGYEAR THEN                             1368 06148000
*                                                                  1368 06149000
         B     @RC01352                                            1368 06150000
@RF01352 LH    @08,REGYEAR                                         1368 06151000
         CR    ADJDAYS,@08                                         1368 06152000
         BL    @RF01368                                            1368 06153000
*               /*****************************************************/ 06154000
*               /*                                                   */ 06155000
*               /* SUBTRACT REG YEAR DAYS (365) FROM DAYS    @Z40LB35*/ 06156000
*               /* AND DECREMENT YEAR BY ONE                 @Z40LB35*/ 06157000
*               /*                                                   */ 06158000
*               /*****************************************************/ 06159000
*                                                                  1369 06160000
*               DO;                 /*                       @Z40LB35*/ 06161000
*                 ADJDAYS=ADJDAYS-REGYEAR;/*                 @Z40LB35*/ 06162000
         SLR   ADJDAYS,@08                                         1370 06163000
*                 CONVYEAR=CONVYEAR-1;/*                     @Z40LB35*/ 06164000
         LA    @08,DTSAREA                                         1371 06165000
         L     @08,DATRETRN(,@08)                                  1371 06166000
         LH    @03,CONVYEAR(,@08)                                  1371 06167000
         BCTR  @03,0                                               1371 06168000
         STH   @03,CONVYEAR(,@08)                                  1371 06169000
*               END;                /*                       @Z40LB35*/ 06170000
*             ELSE                                                 1373 06171000
*                                                                  1373 06172000
*               /*****************************************************/ 06173000
*               /*                                                   */ 06174000
*               /* IF NO FULL YEAR, TEST FOR OVERFLOW        @Z40LB35*/ 06175000
*               /*                                                   */ 06176000
*               /*****************************************************/ 06177000
*                                                                  1373 06178000
*               IF(CONVDAYS-ADJDAYS)<=0 THEN                       1373 06179000
*                                                                  1373 06180000
         B     @RC01368                                            1373 06181000
@RF01368 LA    @08,DTSAREA                                         1373 06182000
         L     @08,DATRETRN(,@08)                                  1373 06183000
         LH    @03,CONVDAYS(,@08)                                  1373 06184000
         LR    @15,@03                                             1373 06185000
         SLR   @15,ADJDAYS                                         1373 06186000
         LTR   @15,@15                                             1373 06187000
         BP    @RF01373                                            1373 06188000
*                 /***************************************************/ 06189000
*                 /*                                                 */ 06190000
*                 /* IF YEAR RUNS BACK INTO LAST YEAR,       @Z40LB35*/ 06191000
*                 /* ADJUST DAYS, SUBTRACT YEAR AND SET QUITSW       */ 06192000
*                 /*                                         @Z40LB35*/ 06193000
*                 /*                                                 */ 06194000
*                 /***************************************************/ 06195000
*                                                                  1374 06196000
*                 DO;               /*                       @Z40LB35*/ 06197000
*                   CONVDAYS=CONVDAYS+REGYEAR-ADJDAYS;             1375 06198000
         AH    @03,REGYEAR                                         1375 06199000
         SLR   @03,ADJDAYS                                         1375 06200000
         STH   @03,CONVDAYS(,@08)                                  1375 06201000
*                   CONVYEAR=CONVYEAR-1;/*                   @Z40LB35*/ 06202000
         LH    @03,CONVYEAR(,@08)                                  1376 06203000
         BCTR  @03,0                                               1376 06204000
         STH   @03,CONVYEAR(,@08)                                  1376 06205000
*                   QUITSW=ON;      /*                       @Z40LB35*/ 06206000
         OI    QUITSW,B'10000000'                                  1377 06207000
*                 END;              /*                       @Z40LB35*/ 06208000
*               ELSE                                               1379 06209000
*                                                                  1379 06210000
*                 /***************************************************/ 06211000
*                 /*                                                 */ 06212000
*                 /* IF YEAR DOES NOT RUNS BACK INTO LAST YEAR,      */ 06213000
*                 /*                                         @Z40LB35*/ 06214000
*                 /* ADJUST DAYS AND SET QUITSW              @Z40LB35*/ 06215000
*                 /*                                                 */ 06216000
*                 /***************************************************/ 06217000
*                                                                  1379 06218000
*                 DO;               /*                       @Z40LB35*/ 06219000
         B     @RC01373                                            1379 06220000
@RF01373 DS    0H                                                  1380 06221000
*                   CONVDAYS=CONVDAYS-ADJDAYS;/*             @Z40LB35*/ 06222000
         LA    @08,DTSAREA                                         1380 06223000
         L     @08,DATRETRN(,@08)                                  1380 06224000
         LH    @03,CONVDAYS(,@08)                                  1380 06225000
         SLR   @03,ADJDAYS                                         1380 06226000
         STH   @03,CONVDAYS(,@08)                                  1380 06227000
*                   QUITSW=ON;      /*                       @Z40LB35*/ 06228000
         OI    QUITSW,B'10000000'                                  1381 06229000
*                 END;              /*                       @Z40LB35*/ 06230000
*         END;                      /*                       @Z40LB35*/ 06231000
@RC01373 DS    0H                                                  1383 06232000
@RC01368 DS    0H                                                  1383 06233000
@RC01352 DS    0H                                                  1383 06234000
@DE01351 TM    QUITSW,B'10000000'                                  1383 06235000
         BZ    @DL01351                                            1383 06236000
*     END;                          /*                       @Z40LB35*/ 06237000
@RC01329 DS    0H                                                  1385 06238000
*                                                                  1385 06239000
*   /*****************************************************************/ 06240000
*   /*                                                               */ 06241000
*   /* DETERMINE IF THE CALLER WANTS THE DATE                @Z40LB35*/ 06242000
*   /* CONVERTED                                             @Z40LB35*/ 06243000
*   /*                                                               */ 06244000
*   /*****************************************************************/ 06245000
*                                                                  1385 06246000
*   IF DATDTEOP=ON THEN                                            1385 06247000
*                                                                  1385 06248000
@RF01321 LA    @08,DTSAREA                                         1385 06249000
         TM    DATDTEOP(@08),B'00100000'                           1385 06250000
         BNO   @RF01385                                            1385 06251000
*     /***************************************************************/ 06252000
*     /*                                                             */ 06253000
*     /* IF CALLER WANTS DATE CONVERTED, CONVERT THE         @Z40LB35*/ 06254000
*     /* DATE BY SEPARATING THE YEARS FROM THE DAYS          @Z40LB35*/ 06255000
*     /*                                                             */ 06256000
*     /***************************************************************/ 06257000
*                                                                  1386 06258000
*     DO;                           /*                       @Z40LB35*/ 06259000
*       CONVYEAR=DATDATE/1000;      /*                       @Z40LB35*/ 06260000
         L     @15,DATRETRN(,@08)                                  1387 06261000
         LA    @14,1000                                            1387 06262000
         L     @08,DATDATE(,@08)                                   1387 06263000
         LR    @00,@08                                             1387 06264000
         SRDA  @00,32                                              1387 06265000
         DR    @00,@14                                             1387 06266000
         STH   @01,CONVYEAR(,@15)                                  1387 06267000
*       CONVDAYS=DATDATE-(CONVYEAR*1000);/*                  @Z40LB35*/ 06268000
         MR    @00,@14                                             1388 06269000
         SLR   @08,@01                                             1388 06270000
         STH   @08,CONVDAYS(,@15)                                  1388 06271000
*     END;                          /*                       @Z40LB35*/ 06272000
*                                                                  1389 06273000
*   /*****************************************************************/ 06274000
*   /*                                                               */ 06275000
*   /* HERE THE DETERMINATION WILL BE MADE TO SEE            @Z40LB35*/ 06276000
*   /* IF THE LIMITS ARE VIOLATED                            @Z40LB35*/ 06277000
*   /* IF SO, FORCE THE DATE TO FALL WITHIN THE              @Z40LB35*/ 06278000
*   /* LIMITS (0 99999)                                      @Z40LB35*/ 06279000
*   /*                                                               */ 06280000
*   /*****************************************************************/ 06281000
*                                                                  1390 06282000
*   IF CONVYEAR>MAXYEAR THEN                                       1390 06283000
@RF01385 LH    @08,MAXYEAR                                         1390 06284000
         LA    @15,DTSAREA                                         1390 06285000
         L     @15,DATRETRN(,@15)                                  1390 06286000
         CH    @08,CONVYEAR(,@15)                                  1390 06287000
         BNL   @RF01390                                            1390 06288000
*     DO;                           /*                       @Z40LB35*/ 06289000
*       CONVYEAR=MAXYEAR;           /*                       @Z40LB35*/ 06290000
         STH   @08,CONVYEAR(,@15)                                  1392 06291000
*       CONVDAYS=MAXDAYS;           /*                       @Z40LB35*/ 06292000
         LH    @08,MAXDAYS                                         1393 06293000
         STH   @08,CONVDAYS(,@15)                                  1393 06294000
*     END;                          /*                       @Z40LB35*/ 06295000
*   ELSE                                                           1395 06296000
*     IF CONVYEAR<MINYEAR|CONVDAYS<MINDAYS THEN                    1395 06297000
         B     @RC01390                                            1395 06298000
@RF01390 LA    @08,DTSAREA                                         1395 06299000
         L     @08,DATRETRN(,@08)                                  1395 06300000
         LH    @15,CONVYEAR(,@08)                                  1395 06301000
         CH    @15,MINYEAR                                         1395 06302000
         BL    @RT01395                                            1395 06303000
         LH    @08,CONVDAYS(,@08)                                  1395 06304000
         CH    @08,MINDAYS                                         1395 06305000
         BNL   @RF01395                                            1395 06306000
@RT01395 DS    0H                                                  1396 06307000
*       DO;                         /*                       @Z40LB35*/ 06308000
*         CONVYEAR=MINYEAR;         /*                       @Z40LB35*/ 06309000
         LA    @08,DTSAREA                                         1397 06310000
         L     @08,DATRETRN(,@08)                                  1397 06311000
         LH    @15,MINYEAR                                         1397 06312000
         STH   @15,CONVYEAR(,@08)                                  1397 06313000
*         CONVDAYS=MINDAYS;         /*                       @Z40LB35*/ 06314000
         LH    @15,MINDAYS                                         1398 06315000
         STH   @15,CONVDAYS(,@08)                                  1398 06316000
*       END;                        /*                       @Z40LB35*/ 06317000
*                                                                  1399 06318000
*   /*****************************************************************/ 06319000
*   /*                                                               */ 06320000
*   /* RETURN TO CALLER WITH RETURN CODE ZERO                @Z40LB35*/ 06321000
*   /*                                                               */ 06322000
*   /*****************************************************************/ 06323000
*                                                                  1400 06324000
*   IF GDTDBG=NULLPTR THEN                                         1400 06325000
@RF01395 DS    0H                                                  1400 06326000
@RC01390 L     @08,@PC00001                                        1400 06327000
         L     @08,GDTDBG(,@08)                                    1400 06328000
         LTR   @08,@08                                             1400 06329000
         BZ    @RT01400                                            1400 06330000
*     ;                                                            1401 06331000
*   ELSE                                                           1402 06332000
*     CALL IDCDB010(GDTTBL,'DTND'); /*                       @Z40LB35*/ 06333000
         L     @08,@PC00001                                        1402 06334000
         ST    @08,@AL00001                                        1402 06335000
         LA    @15,@CC01602                                        1402 06336000
         ST    @15,@AL00001+4                                      1402 06337000
         MVI   @AL00001+4,X'80'                                    1402 06338000
         L     @15,GDTDBG(,@08)                                    1402 06339000
         LA    @01,@AL00001                                        1402 06340000
         BALR  @14,@15                                             1402 06341000
*   RETURN CODE(0);                 /*                       @Z40LB35*/ 06342000
@RT01400 SLR   @15,@15                                             1403 06343000
         L     @14,@SA00013                                        1403 06344000
         LM    @00,@12,@SA00013+8                                  1403 06345000
         BR    @14                                                 1403 06346000
*   END DATES;                      /*                       @Z40LB35*/ 06347000
*                                                                  1405 06348000
*/***********************************************************@Y30LB39*/ 06349000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 06350000
*/*                                                          @Y30LB39*/ 06351000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 06352000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 06353000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 06354000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 06355000
*/*                                                          @Y30LB39*/ 06356000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 06357000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 06358000
*/*   IN SSECBCD.                                            @Y30LB39*/ 06359000
*/*                                                          @Y30LB39*/ 06360000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 06361000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 06362000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 06363000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 06364000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 06365000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 06366000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 06367000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 06368000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 06369000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 06370000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 06371000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 06372000
*/*                                                          @Y30LB39*/ 06373000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 06374000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 06375000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 06376000
*/*                                                          @Y30LB39*/ 06377000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 06378000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 06379000
*/*                                                          @Y30LB39*/ 06380000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 06381000
*/*                                                          @Y30LB39*/ 06382000
*/***********************************************************@Y30LB39*/ 06383000
*                                                                  1405 06384000
*                                   /*                       @Y30LB39*/ 06385000
*SSCMSG:                                                           1405 06386000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 06387000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   06388000
*                                                            @Y30LB39*/ 06389000
SSCMSG   STM   @14,@12,@SA00014                                    1405 06390000
         MVC   @PC00014(8),0(@01)                                  1405 06391000
*                                   /*                       @Y30LB39*/ 06392000
*                                                                  1406 06393000
*   /*****************************************************************/ 06394000
*   /*                                                               */ 06395000
*   /*                                                       @Y30LB39*/ 06396000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 06397000
*   /*                                                       @Y30LB39*/ 06398000
*   /*                                                               */ 06399000
*   /*****************************************************************/ 06400000
*                                                                  1406 06401000
*                                   /*                       @Y30LB39   06402000
*                                                            @Y30LB39*/ 06403000
*                                                                  1406 06404000
*   /*****************************************************************/ 06405000
*   /*                                                               */ 06406000
*   /*                                                       @Y30LB39*/ 06407000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 06408000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 06409000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 06410000
*   /*                                                       @Y30LB39*/ 06411000
*   /*                                                               */ 06412000
*   /*****************************************************************/ 06413000
*                                                                  1406 06414000
*                                   /*                       @Y30LB39*/ 06415000
*   DCL                                                            1406 06416000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 06417000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 06418000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 06419000
*   DCL                                                            1407 06420000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   06421000
*                                                            @Y30LB39   06422000
*                                                            @Y30LB39*/ 06423000
*                                                                  1407 06424000
*   /*****************************************************************/ 06425000
*   /*                                                               */ 06426000
*   /*                                                       @Y30LB39*/ 06427000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 06428000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 06429000
*   /*                                                       @Y30LB39*/ 06430000
*   /*                                                               */ 06431000
*   /*****************************************************************/ 06432000
*                                                                  1408 06433000
*                                   /*                       @Y30LB39*/ 06434000
*   DCL                                                            1408 06435000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 06436000
*   DCL                                                            1409 06437000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   06438000
*                                                            @Y30LB39*/ 06439000
*                                                                  1409 06440000
*   /*****************************************************************/ 06441000
*   /*                                                               */ 06442000
*   /*                                                       @Y30LB39*/ 06443000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 06444000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 06445000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 06446000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 06447000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 06448000
*   /*                                                       @Y30LB39*/ 06449000
*   /*                                                               */ 06450000
*   /*****************************************************************/ 06451000
*                                                                  1410 06452000
*                                   /*                       @Y30LB39*/ 06453000
*   DECLARE                                                        1410 06454000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   06455000
*                                                            @Y30LB39*/ 06456000
*                                                                  1410 06457000
*   /*****************************************************************/ 06458000
*   /*                                                               */ 06459000
*   /*                                                       @Y30LB39*/ 06460000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 06461000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 06462000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 06463000
*   /* IDCTSCM0.                                             @Y30LB39*/ 06464000
*   /*                                                       @Y30LB39*/ 06465000
*   /*                                                               */ 06466000
*   /*****************************************************************/ 06467000
*                                                                  1411 06468000
*                                   /*                       @Y30LB39*/ 06469000
*   DECLARE                                                        1411 06470000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   06471000
*                                                            @Y30LB39*/ 06472000
*                                                                  1411 06473000
*   /*****************************************************************/ 06474000
*   /*                                                               */ 06475000
*   /*                                                       @Y30LB39*/ 06476000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 06477000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 06478000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 06479000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 06480000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 06481000
*   /*                                                       @Y30LB39*/ 06482000
*   /*                                                               */ 06483000
*   /*****************************************************************/ 06484000
*                                                                  1412 06485000
*                                   /*                       @Y30LB39*/ 06486000
*   DECLARE                                                        1412 06487000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 06488000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   06489000
*                                                            @Y30LB39*/ 06490000
*                                                                  1412 06491000
*   /*****************************************************************/ 06492000
*   /*                                                               */ 06493000
*   /*                                                       @Y30LB39*/ 06494000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 06495000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 06496000
*   /*                                                       @Y30LB39*/ 06497000
*   /*                                                               */ 06498000
*   /*****************************************************************/ 06499000
*                                                                  1413 06500000
*                                   /*                       @Y30LB39*/ 06501000
*   DECLARE                                                        1413 06502000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   06503000
*                                                            @Y30LB39*/ 06504000
*                                                                  1413 06505000
*   /*****************************************************************/ 06506000
*   /*                                                               */ 06507000
*   /*                                                       @Y30LB39*/ 06508000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 06509000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 06510000
*   /*                                                       @Y30LB39*/ 06511000
*   /*                                                               */ 06512000
*   /*****************************************************************/ 06513000
*                                                                  1414 06514000
*                                   /*                       @Y30LB39*/ 06515000
*   DECLARE                                                        1414 06516000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   06517000
*                                                            @Y30LB39*/ 06518000
*                                   /*                       @Y30LB39*/ 06519000
*                                                                  1415 06520000
*   /*****************************************************************/ 06521000
*   /*                                                               */ 06522000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 06523000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 06524000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 06525000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 06526000
*   /*                                                       @Y30LB39*/ 06527000
*   /*                                                               */ 06528000
*   /*****************************************************************/ 06529000
*                                                                  1415 06530000
*                                   /*                       @Y30LB39*/ 06531000
*   OLDERID2=NEWERID2;                                             1415 06532000
         L     @08,@PC00001                                        1415 06533000
         L     @15,GDTTR2(,@08)                                    1415 06534000
         MVC   @TS00001(95),NEWERID2(@15)                          1415 06535000
         MVC   OLDERID2(95,@15),@TS00001                           1415 06536000
*   NEWID2='SSAA';                  /*                       @Y30LB39   06537000
*                                                            @Y30LB39*/ 06538000
*                                                                  1416 06539000
         MVC   NEWID2(4,@15),@CC01622                              1416 06540000
*   /*****************************************************************/ 06541000
*   /*                                                               */ 06542000
*   /*                                                       @Y30LB39*/ 06543000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 06544000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 06545000
*   /*                                                       @Y30LB39*/ 06546000
*   /*                                                               */ 06547000
*   /*****************************************************************/ 06548000
*                                                                  1417 06549000
*                                   /*                       @Y30LB39*/ 06550000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   06551000
*                                                            @Y30LB39*/ 06552000
*                                                                  1417 06553000
         LA    @15,SSDRGLT                                         1417 06554000
         ST    @15,SSDLPTR                                         1417 06555000
*   /*****************************************************************/ 06556000
*   /*                                                               */ 06557000
*   /*                                                       @Y30LB39*/ 06558000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 06559000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 06560000
*   /*                                                       @Y30LB39*/ 06561000
*   /*                                                               */ 06562000
*   /*****************************************************************/ 06563000
*                                                                  1418 06564000
*                                   /*                       @Y30LB39*/ 06565000
*   IF SSRCODE>0 THEN                                              1418 06566000
         L     @14,@PC00014                                        1418 06567000
         L     @14,SSRCODE(,@14)                                   1418 06568000
         LTR   @14,@14                                             1418 06569000
         BNP   @RF01418                                            1418 06570000
*     DO;                           /*                       @Y30LB39   06571000
*                                                            @Y30LB39*/ 06572000
*                                                                  1419 06573000
*       /*************************************************************/ 06574000
*       /*                                                           */ 06575000
*       /*                                                   @Y30LB39*/ 06576000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 06577000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 06578000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 06579000
*       /* CODES.                                            @Y30LB39*/ 06580000
*       /*                                                   @Y30LB39*/ 06581000
*       /*                                                           */ 06582000
*       /*************************************************************/ 06583000
*                                                                  1420 06584000
*                                   /*                       @Y30LB39*/ 06585000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 06586000
         XC    SSDRGLT(20),SSDRGLT                                 1420 06587000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 06588000
         LA    @03,SSINXLST                                        1421 06589000
         ST    @03,DARGRETP(,@15)                                  1421 06590000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 06591000
         MVC   DARGSMOD(3,@15),SSMODSS0                            1422 06592000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 06593000
         MVI   DARGSENT(@15),X'01'                                 1423 06594000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   06595000
*                                                            @Y30LB39*/ 06596000
*                                                                  1424 06597000
         MVC   DARGRETL(2,@15),@CH01632                            1424 06598000
*       /*************************************************************/ 06599000
*       /*                                                           */ 06600000
*       /*                                                   @Y30LB39*/ 06601000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 06602000
*       /* ARRAY.                                            @Y30LB39*/ 06603000
*       /*                                                   @Y30LB39*/ 06604000
*       /*                                                           */ 06605000
*       /*************************************************************/ 06606000
*                                                                  1425 06607000
*                                   /*                       @Y30LB39*/ 06608000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   06609000
*                                                            @Y30LB39*/ 06610000
*                                                                  1425 06611000
         ST    @08,@AL00001                                        1425 06612000
         LA    @03,@CF00116                                        1425 06613000
         ST    @03,@AL00001+4                                      1425 06614000
         LA    @03,SSDLPTR                                         1425 06615000
         ST    @03,@AL00001+8                                      1425 06616000
         MVI   @AL00001+8,X'80'                                    1425 06617000
         L     @15,GDTPRT(,@08)                                    1425 06618000
         LA    @01,@AL00001                                        1425 06619000
         BALR  @14,@15                                             1425 06620000
*       /*************************************************************/ 06621000
*       /*                                                           */ 06622000
*       /*                                                   @Y30LB39*/ 06623000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 06624000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 06625000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 06626000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 06627000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 06628000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 06629000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 06630000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 06631000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 06632000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 06633000
*       /* REASON CODE.                                      @Y30LB39*/ 06634000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 06635000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 06636000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 06637000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 06638000
*       /*                                                   @Y30LB39*/ 06639000
*       /*                                                           */ 06640000
*       /*************************************************************/ 06641000
*                                                                  1426 06642000
*                                   /*                       @Y30LB39*/ 06643000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 06644000
         LA    ENTRYNUM,1                                          1426 06645000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1427 06646000
@DL01427 DS    0H                                                  1428 06647000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 06648000
         AL    ENTRYNUM,@CF00221                                   1428 06649000
*       END;                        /*                       @Y30LB39   06650000
*                                                            @Y30LB39*/ 06651000
*                                                                  1429 06652000
@DE01427 L     @08,@PC00014                                        1429 06653000
         LR    @03,ENTRYNUM                                        1429 06654000
         ALR   @03,@03                                             1429 06655000
         LH    @03,SSARRAY-2(@03)                                  1429 06656000
         CH    @03,SSRHALF(,@08)                                   1429 06657000
         BE    @DC01427                                            1429 06658000
         SLR   @15,@15                                             1429 06659000
         CR    @03,@15                                             1429 06660000
         BNE   @DL01427                                            1429 06661000
@DC01427 DS    0H                                                  1430 06662000
*       /*************************************************************/ 06663000
*       /*                                                           */ 06664000
*       /*                                                   @Y30LB39*/ 06665000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 06666000
*       /*                                                   @Y30LB39*/ 06667000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 06668000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 06669000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 06670000
*       /* CODE OR                                           @Y30LB39*/ 06671000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 06672000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 06673000
*       /*                                                   @Y30LB39*/ 06674000
*       /*                                                           */ 06675000
*       /*************************************************************/ 06676000
*                                                                  1430 06677000
*                                   /*                       @Y30LB39*/ 06678000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 06679000
         XC    SSDRGLT(20),SSDRGLT                                 1430 06680000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 06681000
         L     @14,SSDLPTR                                         1431 06682000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1431 06683000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 06684000
         STC   ENTRYNUM,DARGSENT(,@14)                             1432 06685000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 06686000
         CR    @03,@15                                             1433 06687000
         BNE   @RF01433                                            1433 06688000
*         DO;                       /*                       @Y30LB39*/ 06689000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 06690000
         ST    @08,DARGDBP(,@14)                                   1435 06691000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 06692000
         MVC   DARGILP(2,@14),@CH00042                             1436 06693000
*         END;                      /*                       @Y30LB39*/ 06694000
*     END;                          /*                       @Y30LB39*/ 06695000
*                                   /*                       @Y30LB39*/ 06696000
*                                                                  1439 06697000
*   /*****************************************************************/ 06698000
*   /*                                                               */ 06699000
*   /*                                                       @Y30LB39*/ 06700000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 06701000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 06702000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 06703000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 06704000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 06705000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 06706000
*   /* POST CODE.                                            @Y30LB39*/ 06707000
*   /*                                                       @Y30LB39*/ 06708000
*   /*                                                               */ 06709000
*   /*****************************************************************/ 06710000
*                                                                  1439 06711000
*                                   /*                       @Y30LB39*/ 06712000
*   ELSE                            /*                       @Y30LB39*/ 06713000
*     DO;                           /*                       @Y30LB39*/ 06714000
         B     @RC01418                                            1439 06715000
@RF01418 DS    0H                                                  1440 06716000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 06717000
         XC    SSDRGLT(20),SSDRGLT                                 1440 06718000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 06719000
         L     @08,SSDLPTR                                         1441 06720000
         MVC   DARGSMOD(3,@08),SSMODCM0                            1441 06721000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 06722000
         MVC   DARGSENT(1,@08),SSMSGNUM                            1442 06723000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 06724000
         L     @15,@PC00014+4                                      1443 06725000
         ST    @15,DARGDBP(,@08)                                   1443 06726000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 06727000
         MVC   DARGILP(2,@08),@CH00221                             1444 06728000
*     END;                          /*                       @Y30LB39   06729000
*                                                            @Y30LB39*/ 06730000
*                                                                  1445 06731000
*   /*****************************************************************/ 06732000
*   /*                                                               */ 06733000
*   /*                                                       @Y30LB39*/ 06734000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 06735000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 06736000
*   /*                                                       @Y30LB39*/ 06737000
*   /*                                                               */ 06738000
*   /*****************************************************************/ 06739000
*                                                                  1446 06740000
*                                   /*                       @Y30LB39*/ 06741000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   06742000
*                                                            @Y30LB39*/ 06743000
*                                                                  1446 06744000
@RC01418 L     @08,@PC00001                                        1446 06745000
         ST    @08,@AL00001                                        1446 06746000
         LA    @15,@CF00116                                        1446 06747000
         ST    @15,@AL00001+4                                      1446 06748000
         LA    @15,SSDLPTR                                         1446 06749000
         ST    @15,@AL00001+8                                      1446 06750000
         MVI   @AL00001+8,X'80'                                    1446 06751000
         L     @15,GDTPRT(,@08)                                    1446 06752000
         LA    @01,@AL00001                                        1446 06753000
         BALR  @14,@15                                             1446 06754000
*   /*****************************************************************/ 06755000
*   /*                                                               */ 06756000
*   /*                                                       @Y30LB39*/ 06757000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 06758000
*   /*                                                       @Y30LB39*/ 06759000
*   /*                                                               */ 06760000
*   /*****************************************************************/ 06761000
*                                                                  1447 06762000
*                                   /*                       @Y30LB39   06763000
*                                                            @Y30LB39*/ 06764000
*   RETURN CODE(0);                 /*                       @Y30LB39   06765000
*                                                            @Y30LB39*/ 06766000
         SLR   @15,@15                                             1447 06767000
         L     @14,@SA00014                                        1447 06768000
         LM    @00,@12,@SA00014+8                                  1447 06769000
         BR    @14                                                 1447 06770000
*   END SSCMSG;                     /*                       @Y30LB39*/ 06771000
*   END IDCSD01                     /*                       @Z40LB30*/ 06772000
*                                                                  1449 06773000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06774000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 06775000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 06776000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 06777000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 06778000
*/*%INCLUDE SYSLIB  (IDCCSSD )                                       */ 06779000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 06780000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 06781000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 06782000
*/*%INCLUDE SYSLIB  (IDCDF55 )                                       */ 06783000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 06784000
*                                                                  1449 06785000
*       ;                                                          1449 06786000
@DATA    DS    0H                                                       06787000
@CH00155 DC    H'2'                                                     06788000
@CH00297 DC    H'5'                                                     06789000
@CH01628 DC    H'80'                                                    06790000
@CH01632 DC    H'120'                                                   06791000
@CH01626 DC    H'164'                                                   06792000
@CH01625 DC    H'224'                                                   06793000
@DATD    DSECT                                                          06794000
         DS    0F                                                       06795000
@SA00001 DS    18F                                                      06796000
@PC00001 DS    3F                                                       06797000
@SA00013 DS    15F                                                      06798000
@SA00002 DS    1F                                                       06799000
@SA00003 DS    1F                                                       06800000
@SA00004 DS    1F                                                       06801000
@SA00005 DS    1F                                                       06802000
@SA00006 DS    1F                                                       06803000
@SA00008 DS    1F                                                       06804000
@SA00009 DS    1F                                                       06805000
@SA00014 DS    15F                                                      06806000
@PC00014 DS    2F                                                       06807000
@SA00007 DS    1F                                                       06808000
@SA00010 DS    1F                                                       06809000
@SA00011 DS    1F                                                       06810000
@SA00012 DS    1F                                                       06811000
@AL00001 DS    4A                                                       06812000
@TF00001 DS    F                                                        06813000
@AFTEMPS DS    1F                                                       06814000
IDCSD01  CSECT                                                          06815000
         DS    0F                                                       06816000
@CF00116 DC    F'0'                                                     06817000
@CF00221 DC    F'1'                                                     06818000
@CH00221 EQU   @CF00221+2                                               06819000
@CF00164 DC    F'3'                                                     06820000
@CF00042 DC    F'4'                                                     06821000
@CH00042 EQU   @CF00042+2                                               06822000
@CF00158 DC    F'6'                                                     06823000
@CH00158 EQU   @CF00158+2                                               06824000
@CF00181 DC    F'8'                                                     06825000
@CH00181 EQU   @CF00181+2                                               06826000
@CF00037 DC    F'10'                                                    06827000
@CH00037 EQU   @CF00037+2                                               06828000
@CF00035 DC    F'12'                                                    06829000
@CH00035 EQU   @CF00035+2                                               06830000
@CF00848 DC    F'44'                                                    06831000
@CH00848 EQU   @CF00848+2                                               06832000
@CF01654 DC    F'-68'                                                   06833000
@CF01656 DC    F'-64'                                                   06834000
@CF01655 DC    F'-63'                                                   06835000
@CF01653 DC    F'-61'                                                   06836000
@CF01651 DC    F'-60'                                                   06837000
@CF01650 DC    F'-16'                                                   06838000
@CF01645 DC    F'-7'                                                    06839000
@CF01643 DC    F'-5'                                                    06840000
@CF01648 DC    XL4'0000FFFF'                                            06841000
@CF01473 DC    XL4'0208'                                                06842000
@CF01475 DC    XL4'0223'                                                06843000
@CF01477 DC    XL4'0224'                                                06844000
@DATD    DSECT                                                          06845000
         DS    0D                                                       06846000
LISTSCAN DS    A                                                        06847000
IOCSPTR  DS    A                                                        06848000
OPNPTR   DS    A                                                        06849000
DDSTRU   DS    A                                                        06850000
FSADDR   DS    A                                                        06851000
ERCNVADR DS    A                                                        06852000
DMPINDEX DS    A                                                        06853000
CCMSGPTR DS    A                                                        06854000
CMMSGPTR DS    A                                                        06855000
CTMSGPTR DS    A                                                        06856000
RVVIPTR  DS    A                                                        06857000
GROUPPTR DS    A                                                        06858000
LISTADDR DS    A                                                        06859000
EXPDATE  DS    F                                                        06860000
CREDATE  DS    F                                                        06861000
ADDRUCB  DS    A                                                        06862000
FILEUCB  DS    A                                                        06863000
VVICODE  DS    F                                                        06864000
VVICODE2 DS    F                                                        06865000
VOLPTR   DS    A                                                        06866000
SSDLPTR  DS    A                                                        06867000
LISTPTR  DS    A                                                        06868000
SCRATCNT DS    H                                                        06869000
GDGCNT   DS    H                                                        06870000
MULTICNT DS    H                                                        06871000
VOLRDCNT DS    H                                                        06872000
EXCLCNT  DS    H                                                        06873000
SYSCTCNT DS    H                                                        06874000
INDEX    DS    H                                                        06875000
SETRC    DS    H                                                        06876000
LISTLN   DS    FL1                                                      06877000
         DS    0D                                                       06878000
@TS00001 DS    CL95                                                     06879000
         DS    CL1                                                      06880000
ALOCAREA DS    CL31                                                     06881000
         DS    CL1                                                      06882000
DARGAREA DS    CL28                                                     06883000
SCRAREA  DS    CL12                                                     06884000
CATAREA  DS    CL69                                                     06885000
         DS    CL3                                                      06886000
VSAREA3  DS    CL59                                                     06887000
         DS    CL1                                                      06888000
SLTAREA  DS    CL23                                                     06889000
         DS    CL1                                                      06890000
CHKAREA  DS    CL29                                                     06891000
         DS    CL3                                                      06892000
DTSAREA  DS    CL21                                                     06893000
         DS    CL3                                                      06894000
VOLRVVI  DS    CL68                                                     06895000
GRPRVVI  DS    CL68                                                     06896000
VOLREC   DS    CL224                                                    06897000
GRPREC   DS    CL164                                                    06898000
FLAGS    DS    BL1                                                      06899000
         ORG   FLAGS                                                    06900000
ALOCFLAG DS    BL1                                                      06901000
INITVS3  EQU   FLAGS+0                                                  06902000
GDGTYPE  EQU   FLAGS+0                                                  06903000
EXCVOL   EQU   FLAGS+0                                                  06904000
@NM00109 EQU   FLAGS+0                                                  06905000
         ORG   FLAGS+1                                                  06906000
COMFLAGS DS    BL1                                                      06907000
         ORG   COMFLAGS                                                 06908000
ONEDONE  DS    BL1                                                      06909000
RDERROR  EQU   COMFLAGS+0                                               06910000
EOFILE   EQU   COMFLAGS+0                                               06911000
NOVOLS   EQU   COMFLAGS+0                                               06912000
EMPTYGRP EQU   COMFLAGS+0                                               06913000
@NM00110 EQU   COMFLAGS+0                                               06914000
         ORG   COMFLAGS+1                                               06915000
DDNAME   DS    CL8                                                      06916000
UNITLIST DS    CL12                                                     06917000
         ORG   UNITLIST                                                 06918000
UNITCNT  DS    FL2                                                      06919000
UNITLNG  DS    FL2                                                      06920000
UNITNAME DS    CL8                                                      06921000
         ORG   UNITLIST+12                                              06922000
VOLLIST  DS    CL10                                                     06923000
         ORG   VOLLIST                                                  06924000
VOLCOUNT DS    FL2                                                      06925000
VOLLNG   DS    FL2                                                      06926000
VOLNAME  DS    CL6                                                      06927000
         ORG   VOLLIST+10                                               06928000
TIMEVAR  DS    CL8                                                      06929000
DATEVAR  DS    CL4                                                      06930000
         ORG   DATEVAR                                                  06931000
@NM00113 DS    CL1                                                      06932000
DATEPACK DS    CL3                                                      06933000
         ORG   DATEVAR+4                                                06934000
QUITSW   DS    BL1                                                      06935000
SSDRGLT  DS    CL20                                                     06936000
         DS    CL3                                                      06937000
SSINXLST DS    CL120                                                    06938000
         ORG   SSINXLST                                                 06939000
SSARRAY  DS    60H                                                      06940000
         ORG   SSINXLST+120                                             06941000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                06942000
@ENDDATD EQU   *                                                        06943000
IDCSD01  CSECT                                                          06944000
         DS    0F                                                       06945000
@SIZDATD DC    AL1(0)                                                   06946000
         DC    AL3(@ENDDATD-@DATD)                                      06947000
         DS    0D                                                       06948000
RVVLEN   DC    AL2(68)                                                  06949000
REGYEAR  DC    H'365'                                                   06950000
LEAPYEAR DC    H'366'                                                   06951000
MAXYEAR  DC    H'99'                                                    06952000
MAXDAYS  DC    H'999'                                                   06953000
MINYEAR  DC    H'0'                                                     06954000
MINDAYS  DC    H'0'                                                     06955000
NOREMAIN DC    H'0'                                                     06956000
SSMSGNUM DC    AL1(56)                                                  06957000
@CC01479 DC    C'SYSCTLG                                     '          06958000
@CC01560 DC    C'IDCVS03 '                                              06959000
@CC01599 DC    C'DATESAGL'                                              06960000
@CC01469 DC    C'3330V'                                                 06961000
@CC01361 DC    C'SD01'                                                  06962000
@CC01467 DC    C'SD00'                                                  06963000
@CC01488 DC    C'SDST'                                                  06964000
@CC01500 DC    C'SDED'                                                  06965000
@CC01504 DC    C'SDSV'                                                  06966000
@CC01511 DC    C'SDSG'                                                  06967000
@CC01516 DC    C'SDNG'                                                  06968000
@CC01520 DC    C'SDAG'                                                  06969000
@CC01524 DC    C'SDAV'                                                  06970000
@CC01528 DC    C'SDRG'                                                  06971000
@CC01532 DC    C'SDCK'                                                  06972000
@CC01536 DC    C'SDPV'                                                  06973000
@CC01546 DC    C'SDAL'                                                  06974000
@CC01556 DC    C'SDSL'                                                  06975000
@CC01564 DC    C'SDSC'                                                  06976000
@CC01598 DC    C'DTST'                                                  06977000
@CC01602 DC    C'DTND'                                                  06978000
@CC01622 DC    C'SSAA'                                                  06979000
@CC01418 DC    C'CM0'                                                   06980000
@CC01420 EQU   @CC01361                                                 06981000
@CC01422 DC    C'UV0'                                                   06982000
@CB01471 DC    X'30582009'                                              06983000
ALL      DC    CL3'ALL'                                                 06984000
FORMAT   DC    CL4'FORM'                                                06985000
HSECOND  DC    CL4'HSEC'                                                06986000
CLOCK    DC    CL4'KLOK'                                                06987000
SETZERO  DC    CL4'ZERO'                                                06988000
SETBLANK DC    CL4'BLNK'                                                06989000
NOSET    DC    CL4'NSET'                                                06990000
OVERRIDE DC    CL4'OVRD'                                                06991000
ACQUIRE  DC    CL8'ACQUIRE '                                            06992000
RELINQ   DC    CL8'RELINQ  '                                            06993000
MOUNT    DC    CL8'MOUNT   '                                            06994000
DEMOUNT  DC    CL8'DEMOUNT '                                            06995000
DEFINE   DC    CL8'DEFINE  '                                            06996000
MOVE     DC    CL8'MOVE    '                                            06997000
TRACEQ   DC    CL8'TRACEQ  '                                            06998000
COPYTABL DC    CL8'COPYTABL'                                            06999000
COPYCRTG DC    CL8'COPYCRTG'                                            07000000
COPYVOL  DC    CL8'COPYVOL '                                            07001000
VVIC     DC    CL8'VVIC    '                                            07002000
TUNE     DC    CL8'TUNE    '                                            07003000
NAMES    DC    CL4'NAME'                                                07004000
UNIT     DC    CL4'UNIT'                                                07005000
SHR      DC    CL4'SHR '                                                07006000
EXCL     DC    CL4'EXCL'                                                07007000
NOWAIT   DC    CL4'NWAI'                                                07008000
WAIT     DC    CL4'WAIT'                                                07009000
SECCHECK DC    CL8'SECCHECK'                                            07010000
SCRVTOC  DC    CL8'SCRVTOC '                                            07011000
GETVTOC  DC    CL8'GETVTOC '                                            07012000
PUTVTOC  DC    CL8'PUTVTOC '                                            07013000
RECATLG  DC    CL8'RECATLG '                                            07014000
INITVOL  DC    CL8'INITVOL '                                            07015000
CHECK    DC    CL8'CHECK   '                                            07016000
POSTUCB  DC    CL8'POSTUCB '                                            07017000
GET      DC    CL8'GET     '                                            07018000
PUT      DC    CL8'PUT     '                                            07019000
CLOSE    DC    CL8'CLOSE   '                                            07020000
OPEN     DC    CL8'OPEN    '                                            07021000
RVOPENR  DC    CL8'OPENR   '                                            07022000
RVRDCNT  DC    CL8'READCNT '                                            07023000
RVREADKD DC    CL8'READKD  '                                            07024000
RVSPACCR DC    CL8'SPACCR  '                                            07025000
RVFWRITE DC    CL8'FWRITE  '                                            07026000
RVWRITER DC    CL8'WRITEREC'                                            07027000
PUTLABEL DC    CL8'PUTLABEL'                                            07028000
GETLABEL DC    CL8'GETLABEL'                                            07029000
CANCEL   DC    CL8'CANCEL  '                                            07030000
SET      DC    CL8'SET     '                                            07031000
SELECTX  DC    CL8'SELECTX '                                            07032000
CHANGEX  DC    CL8'CHANGEX '                                            07033000
SELECTDD DC    CL8'SELECTDD'                                            07034000
SELECTDS DC    CL8'SELECTDS'                                            07035000
TBLREST  DC    CL8'TBLREST '                                            07036000
NULLIFYC DC    CL8'NULLIFYC'                                            07037000
RDMSC    DC    CL8'RDMSC   '                                            07038000
RDMSCTBL DC    CL8'RDMSCTBL'                                            07039000
RDCARTLB DC    CL8'RDCARTLB'                                            07040000
AUDITCEL DC    CL8'AUDITCEL'                                            07041000
RDSTGAD  DC    CL8'RDSTGAD '                                            07042000
MODIFYC  DC    CL8'MODIFYC '                                            07043000
MODID    DC    CL4'SD01'                                                07044000
FIXAREA  DS    CL500                                                    07045000
         ORG   FIXAREA                                                  07046000
@NM00111 DC    250X'00'                                                 07047000
@NM00112 DC    250X'00'                                                 07048000
         ORG   FIXAREA+500                                              07049000
SSMODSS0 DC    CL3'SS0'                                                 07050000
SSMODCM0 DC    CL3'CM0'                                                 07051000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07052000
@01      EQU   01                                                       07053000
@02      EQU   02                                                       07054000
@03      EQU   03                                                       07055000
@04      EQU   04                                                       07056000
@05      EQU   05                                                       07057000
@06      EQU   06                                                       07058000
@07      EQU   07                                                       07059000
@08      EQU   08                                                       07060000
@09      EQU   09                                                       07061000
@10      EQU   10                                                       07062000
@11      EQU   11                                                       07063000
@12      EQU   12                                                       07064000
@13      EQU   13                                                       07065000
@14      EQU   14                                                       07066000
@15      EQU   15                                                       07067000
ENTRYNUM EQU   @02                                                      07068000
ADJDAYS  EQU   @02                                                      07069000
DATEBIN  EQU   @03                                                      07070000
INDEX1   EQU   @02                                                      07071000
NUMCHAR  EQU   @03                                                      07072000
LASTCHAR EQU   @02                                                      07073000
CC03     EQU   @08                                                      07074000
CC02     EQU   @07                                                      07075000
CC01     EQU   @04                                                      07076000
BASEVPTR EQU   @05                                                      07077000
ELEMENT  EQU   @06                                                      07078000
TESTRC   EQU   @03                                                      07079000
RTNREG   EQU   @15                                                      07080000
REG0     EQU   @00                                                      07081000
REG1     EQU   @01                                                      07082000
REG10    EQU   @10                                                      07083000
REG11    EQU   @11                                                      07084000
REG12    EQU   @12                                                      07085000
REG13    EQU   @13                                                      07086000
REG14    EQU   @14                                                      07087000
REG15    EQU   @15                                                      07088000
REG2     EQU   @02                                                      07089000
REG3     EQU   @03                                                      07090000
REG4     EQU   @04                                                      07091000
REG5     EQU   @05                                                      07092000
REG6     EQU   @06                                                      07093000
REG7     EQU   @07                                                      07094000
REG8     EQU   @08                                                      07095000
REG9     EQU   @09                                                      07096000
IDCSACL0 EQU   0                                                        07097000
IDCSAEP0 EQU   0                                                        07098000
IDCSAFP0 EQU   0                                                        07099000
IDCSATI0 EQU   0                                                        07100000
IDCSAAL0 EQU   0                                                        07101000
IDCSADL0 EQU   0                                                        07102000
IDCSASS0 EQU   0                                                        07103000
IDCSASC0 EQU   0                                                        07104000
IDCSA060 EQU   0                                                        07105000
IDCSAUC0 EQU   0                                                        07106000
TRACE1   EQU   0                                                        07107000
OLDERID1 EQU   TRACE1                                                   07108000
TRACE2   EQU   0                                                        07109000
OLDERID2 EQU   TRACE2                                                   07110000
NEWID2   EQU   TRACE2+95                                                07111000
NEWERID2 EQU   5                                                        07112000
CIRAGL   EQU   0                                                        07113000
CIRTYPE  EQU   CIRAGL                                                   07114000
ALLAGL   EQU   0                                                        07115000
ALLDDN   EQU   ALLAGL+4                                                 07116000
ALLULP   EQU   ALLAGL+12                                                07117000
ALLVLP   EQU   ALLAGL+16                                                07118000
ALLSTS   EQU   ALLAGL+24                                                07119000
ALLDSP   EQU   ALLAGL+25                                                07120000
ALLORG   EQU   ALLAGL+26                                                07121000
ALLOPT   EQU   ALLAGL+28                                                07122000
ALLOPTVL EQU   ALLOPT                                                   07123000
ALLOPTPV EQU   ALLOPT                                                   07124000
RACFAGL  EQU   0                                                        07125000
RACFFLG1 EQU   RACFAGL                                                  07126000
RACFFLG2 EQU   RACFAGL+1                                                07127000
RACFFLG3 EQU   RACFAGL+2                                                07128000
RACFFLG4 EQU   RACFAGL+3                                                07129000
UNITABL  EQU   0                                                        07130000
UNITADR  EQU   UNITABL+4                                                07131000
@NM00017 EQU   UNITADR                                                  07132000
UNITSTAT EQU   UNITABL+6                                                07133000
IOCSTR   EQU   0                                                        07134000
IOCDSO   EQU   IOCSTR+16                                                07135000
IOCRFM   EQU   IOCSTR+17                                                07136000
IOCMAC   EQU   IOCSTR+18                                                07137000
IOCMAC2  EQU   IOCSTR+19                                                07138000
IOCCHP   EQU   IOCSTR+20                                                07139000
IOCMSG   EQU   IOCSTR+21                                                07140000
IOCRBA   EQU   IOCSTR+40                                                07141000
IOCTTR   EQU   IOCRBA                                                   07142000
IOCMEM   EQU   IOCSTR+44                                                07143000
IOCNWM   EQU   IOCSTR+48                                                07144000
IOCREL   EQU   IOCSTR+60                                                07145000
OPNAGL   EQU   0                                                        07146000
OPNOPT   EQU   OPNAGL                                                   07147000
OPNRFM   EQU   OPNAGL+1                                                 07148000
OPNTYP   EQU   OPNAGL+2                                                 07149000
OPNMOD   EQU   OPNAGL+3                                                 07150000
OPNDEV   EQU   OPNAGL+24                                                07151000
OPNDSO   EQU   OPNAGL+41                                                07152000
OPNOPT2  EQU   OPNAGL+42                                                07153000
IOINFOPT EQU   0                                                        07154000
UVOLLIST EQU   0                                                        07155000
UVOLCNT  EQU   UVOLLIST                                                 07156000
UVOLENT  EQU   UVOLLIST+2                                               07157000
UVOLDEV  EQU   UVOLENT                                                  07158000
UVOLVOL  EQU   UVOLENT+4                                                07159000
AMSTP011 EQU   0                                                        07160000
DARGLIST EQU   0                                                        07161000
DARGDBP  EQU   DARGLIST                                                 07162000
DARGRETP EQU   DARGLIST+4                                               07163000
DARGSTID EQU   DARGLIST+8                                               07164000
DARGSMOD EQU   DARGSTID                                                 07165000
DARGSENT EQU   DARGSTID+3                                               07166000
DARGILP  EQU   DARGLIST+12                                              07167000
DARGCNT  EQU   DARGLIST+14                                              07168000
DARGRETL EQU   DARGLIST+16                                              07169000
DARGARY  EQU   DARGLIST+20                                              07170000
DARGINS  EQU   DARGARY                                                  07171000
DARGINL  EQU   DARGARY+2                                                07172000
DARGDTM  EQU   DARGARY+4                                                07173000
FMTLIST  EQU   0                                                        07174000
FMTFLGS  EQU   FMTLIST                                                  07175000
FMTSPF   EQU   FMTLIST+2                                                07176000
FMTRFNO  EQU   FMTSPF                                                   07177000
FMTILEN  EQU   FMTRFNO                                                  07178000
FMTIOFF  EQU   FMTLIST+4                                                07179000
FMTTRBC  EQU   FMTIOFF                                                  07180000
FMTSTO   EQU   FMTTRBC                                                  07181000
FMTOCOL  EQU   FMTLIST+6                                                07182000
FMTCNVF  EQU   FMTLIST+10                                               07183000
ERCNVTAB EQU   0                                                        07184000
ERTYPE   EQU   ERCNVTAB                                                 07185000
EROPER   EQU   ERCNVTAB+1                                               07186000
EROSOPER EQU   ERCNVTAB+2                                               07187000
ERCATRC  EQU   ERCNVTAB+16                                              07188000
ERCPLPT  EQU   ERCNVTAB+20                                              07189000
IDCDB010 EQU   0                                                        07190000
DMPITM   EQU   0                                                        07191000
DMPARY   EQU   0                                                        07192000
CCMSG    EQU   0                                                        07193000
CMMSG    EQU   0                                                        07194000
CMVOLFLG EQU   CMMSG+6                                                  07195000
CTMSG    EQU   0                                                        07196000
CTARRAY  EQU   CTMSG+4                                                  07197000
MDAGL    EQU   0                                                        07198000
MDFLAGS  EQU   MDAGL+30                                                 07199000
MDVTOC   EQU   MDAGL+32                                                 07200000
PUAGL    EQU   0                                                        07201000
CKAGL    EQU   0                                                        07202000
CKUCBPTR EQU   CKAGL+8                                                  07203000
CKDDNAME EQU   CKAGL+12                                                 07204000
CKFLAGS  EQU   CKAGL+28                                                 07205000
CKTESTVT EQU   CKFLAGS                                                  07206000
CKDMTABL EQU   CKFLAGS                                                  07207000
EXCLAGL  EQU   0                                                        07208000
EXCLFLAG EQU   EXCLAGL+22                                               07209000
EXOARG   EQU   0                                                        07210000
EXOPT    EQU   EXOARG+32                                                07211000
EXFLG    EQU   EXOARG+33                                                07212000
EXGARG   EQU   0                                                        07213000
EXWRARG  EQU   0                                                        07214000
EXRWCHR  EQU   EXWRARG+26                                               07215000
EXSPACE  EQU   EXWRARG+36                                               07216000
EXPARG   EQU   0                                                        07217000
EXPDATA  EQU   EXPARG+12                                                07218000
EXPDATAB EQU   0                                                        07219000
EXPARRAY EQU   EXPDATAB+4                                               07220000
VS2AGL   EQU   0                                                        07221000
VSLABOPT EQU   VS2AGL+28                                                07222000
VS2MSG   EQU   VS2AGL+35                                                07223000
VS2RESOP EQU   VS2AGL+36                                                07224000
VS1AGL   EQU   0                                                        07225000
VSSECOPT EQU   VS1AGL+68                                                07226000
VSVTOPT  EQU   VS1AGL+69                                                07227000
VSCATOPT EQU   VS1AGL+70                                                07228000
VSRETURN EQU   VS1AGL+71                                                07229000
VSMSG    EQU   VS1AGL+72                                                07230000
VSRESOPT EQU   VS1AGL+73                                                07231000
RCTAGL   EQU   0                                                        07232000
RCTOPT   EQU   RCTAGL+8                                                 07233000
STAEPARM EQU   0                                                        07234000
STARCVY  EQU   STAEPARM+52                                              07235000
STARETRY EQU   STAEPARM+53                                              07236000
VOLLABEL EQU   0                                                        07237000
SV82LIST EQU   0                                                        07238000
@NM00074 EQU   SV82LIST+4                                               07239000
SV82DCBP EQU   @NM00074                                                 07240000
@NM00075 EQU   SV82LIST+12                                              07241000
SV82WRKP EQU   @NM00075                                                 07242000
SRTAGL   EQU   0                                                        07243000
LCTINFO  EQU   0                                                        07244000
LCTFLAGS EQU   LCTINFO+32                                               07245000
UCTAGL   EQU   0                                                        07246000
UCTDSN   EQU   UCTAGL+8                                                 07247000
UCTACBP  EQU   UCTAGL+52                                                07248000
UCTVOLP  EQU   UCTAGL+56                                                07249000
UCTDD    EQU   UCTAGL+60                                                07250000
UCTFLAGS EQU   UCTAGL+68                                                07251000
UCTVSCAT EQU   UCTFLAGS                                                 07252000
SELAGL   EQU   0                                                        07253000
SELUCBP  EQU   SELAGL+8                                                 07254000
SELDDNP  EQU   SELAGL+12                                                07255000
SELVOL   EQU   SELAGL+16                                                07256000
SELFLAGS EQU   SELAGL+22                                                07257000
DATESAGL EQU   0                                                        07258000
DATHEAD  EQU   DATESAGL                                                 07259000
DATDATE  EQU   DATESAGL+8                                               07260000
DATDAYS  EQU   DATESAGL+12                                              07261000
DATRETRN EQU   DATESAGL+16                                              07262000
DATESOPT EQU   DATESAGL+20                                              07263000
DATADD   EQU   DATESOPT                                                 07264000
DATSUB   EQU   DATESOPT                                                 07265000
DATDTEOP EQU   DATESOPT                                                 07266000
DATDAYOP EQU   DATESOPT                                                 07267000
VS3AGL   EQU   0                                                        07268000
VS3LISTP EQU   VS3AGL+8                                                 07269000
VS3EXDSP EQU   VS3AGL+12                                                07270000
VS3LEVP  EQU   VS3AGL+16                                                07271000
VS3LEVLN EQU   VS3AGL+20                                                07272000
VS3AST   EQU   VS3AGL+22                                                07273000
VS3EXPIR EQU   VS3AGL+24                                                07274000
VS3CREAT EQU   VS3AGL+28                                                07275000
VS3UCBP  EQU   VS3AGL+32                                                07276000
VS3DEV   EQU   VS3AGL+36                                                07277000
VS3POOL  EQU   VS3AGL+40                                                07278000
VS3VOL   EQU   VS3AGL+44                                                07279000
VS3DD    EQU   VS3AGL+50                                                07280000
VS3FLAGS EQU   VS3AGL+58                                                07281000
VS3SCR   EQU   VS3FLAGS                                                 07282000
VS3UNCAT EQU   VS3FLAGS                                                 07283000
VS3SYSNM EQU   VS3FLAGS                                                 07284000
VSDVTOC  EQU   0                                                        07285000
VSDSTAT  EQU   0                                                        07286000
VSDSFLG1 EQU   VSDSTAT+16                                               07287000
VSDFLG2  EQU   VSDSTAT+17                                               07288000
VSDSCR   EQU   0                                                        07289000
VSDACBPT EQU   VSDSCR                                                   07290000
VSDSCRFL EQU   VSDSCR+4                                                 07291000
VSDCATLC EQU   VSDSCRFL                                                 07292000
VSDVSAM  EQU   VSDSCRFL                                                 07293000
VSDUSAGE EQU   0                                                        07294000
VSDDORG  EQU   VSDUSAGE+9                                               07295000
VSDALLOC EQU   VSDUSAGE+10                                              07296000
VSDUSEF  EQU   VSDUSAGE+11                                              07297000
VSDDSORG EQU   VSDUSAGE+16                                              07298000
VSDBLOCK EQU   0                                                        07299000
VSDELEM  EQU   VSDBLOCK                                                 07300000
VSDSPACE EQU   VSDBLOCK+12                                              07301000
VSDARRAY EQU   VSDBLOCK+16                                              07302000
VSDVOLCT EQU   VSDARRAY                                                 07303000
VSDDSN   EQU   VSDARRAY+4                                               07304000
VSDVARY  EQU   VSDARRAY+48                                              07305000
VOL      EQU   0                                                        07306000
VOLCNT   EQU   VOL                                                      07307000
@NM00094 EQU   VOL+2                                                    07308000
VOLVAL   EQU   @NM00094+1                                               07309000
GRP      EQU   0                                                        07310000
GRPCNT   EQU   GRP                                                      07311000
@NM00095 EQU   GRP+2                                                    07312000
GRPVAL   EQU   @NM00095+1                                               07313000
AVOL     EQU   0                                                        07314000
AGRP     EQU   0                                                        07315000
NGRPD    EQU   0                                                        07316000
GENER    EQU   0                                                        07317000
LEVEL    EQU   0                                                        07318000
LEVELPOS EQU   LEVEL+9                                                  07319000
LEVELFLG EQU   LEVEL+10                                                 07320000
LEVELLEN EQU   LEVEL+20                                                 07321000
LEVELVAL EQU   LEVEL+21                                                 07322000
UNCAT    EQU   0                                                        07323000
EXPDT    EQU   0                                                        07324000
EXPDTVAL EQU   EXPDT                                                    07325000
EXPIR    EQU   0                                                        07326000
EXPIRVAL EQU   EXPIR                                                    07327000
CREDT    EQU   0                                                        07328000
CREDTVAL EQU   CREDT                                                    07329000
CREAT    EQU   0                                                        07330000
CREATVAL EQU   CREAT                                                    07331000
FILE     EQU   0                                                        07332000
FILEVAL  EQU   FILE+1                                                   07333000
SYSN     EQU   0                                                        07334000
PURGE    EQU   0                                                        07335000
EXVOL    EQU   0                                                        07336000
EXVOLCNT EQU   EXVOL                                                    07337000
@NM00096 EQU   EXVOL+2                                                  07338000
EXVOLVAL EQU   @NM00096+1                                               07339000
EXDS     EQU   0                                                        07340000
@NM00097 EQU   EXDS+2                                                   07341000
EXDSFLG  EQU   @NM00097+10                                              07342000
RVVI     EQU   0                                                        07343000
RVVLNGTH EQU   RVVI                                                     07344000
RVVOPCOD EQU   RVVI+4                                                   07345000
RVVCODE  EQU   RVVOPCOD                                                 07346000
RVVOLUME EQU   RVVI+8                                                   07347000
RVVGROUP EQU   RVVI+14                                                  07348000
RVVBUFLN EQU   RVVI+30                                                  07349000
RVVRTBUF EQU   RVVI+32                                                  07350000
RVVFLAGA EQU   RVVI+58                                                  07351000
RVVRMODE EQU   RVVFLAGA                                                 07352000
RVVRDR   EQU   RVVRMODE                                                 07353000
RVVRDNR  EQU   RVVRMODE                                                 07354000
RVVRDCH  EQU   RVVRMODE                                                 07355000
RVVCHAIN EQU   RVVFLAGA+1                                               07356000
RVVGPVOL EQU   RVVCHAIN                                                 07357000
RVVNGVOL EQU   RVVCHAIN                                                 07358000
RVVRDRCD EQU   RVVFLAGA+2                                               07359000
RVVBVRCD EQU   RVVRDRCD                                                 07360000
RVVGRPRC EQU   RVVRDRCD                                                 07361000
RVVRTEST EQU   RVVFLAGA+3                                               07362000
RVVGSVOL EQU   RVVRTEST                                                 07363000
RVVACTV  EQU   RVVRTEST                                                 07364000
RVVCPYTP EQU   RVVFLAGA+4                                               07365000
RVVSPEC  EQU   RVVFLAGA+5                                               07366000
RVVSGRP  EQU   RVVSPEC                                                  07367000
RVVSVOL  EQU   RVVSPEC                                                  07368000
GROUP    EQU   0                                                        07369000
GRONAME  EQU   GROUP                                                    07370000
GROVVGRP EQU   GRONAME+3                                                07371000
GROID    EQU   GRONAME+11                                               07372000
GROFLAGA EQU   GROUP+13                                                 07373000
GROTYPE  EQU   GROFLAGA                                                 07374000
GROFSN   EQU   GROUP+17                                                 07375000
GRONGEN  EQU   GROUP+30                                                 07376000
GRONRSTD EQU   GROUP+32                                                 07377000
GROERRTS EQU   GROUP+56                                                 07378000
BASEV    EQU   0                                                        07379000
BASNAME  EQU   BASEV                                                    07380000
BASSERNO EQU   BASNAME+5                                                07381000
BASID    EQU   BASNAME+11                                               07382000
BASFLAGA EQU   BASEV+14                                                 07383000
BASTYPE  EQU   BASFLAGA                                                 07384000
BASLAST  EQU   BASFLAGA+3                                               07385000
BASRCVYF EQU   BASEV+20                                                 07386000
BASSATIA EQU   BASRCVYF                                                 07387000
BASIVCPY EQU   BASSATIA                                                 07388000
BASVSMIS EQU   BASSATIA                                                 07389000
BASMISCF EQU   BASRCVYF+2                                               07390000
BASLIB1  EQU   BASEV+36                                                 07391000
BASLID1  EQU   BASLIB1                                                  07392000
BASLIB2  EQU   BASEV+49                                                 07393000
BASLID2  EQU   BASLIB2                                                  07394000
BASNEXTV EQU   BASEV+56                                                 07395000
BASKLCPY EQU   BASEV+76                                                 07396000
BASCOPID EQU   BASKLCPY+11                                              07397000
CONVDATE EQU   0                                                        07398000
CONVYEAR EQU   CONVDATE                                                 07399000
CONVDAYS EQU   CONVDATE+2                                               07400000
AMSTP041 EQU   0                                                        07401000
AMSTP042 EQU   0                                                        07402000
AMSTP043 EQU   0                                                        07403000
AMSTP044 EQU   0                                                        07404000
DMPTRM   EQU   0                                                        07405000
IDCIOCL0 EQU   0                                                        07406000
IDCIOCO0 EQU   0                                                        07407000
IDCIOGT0 EQU   0                                                        07408000
IDCIOIT0 EQU   0                                                        07409000
IDCIOOP0 EQU   0                                                        07410000
IDCIOPO0 EQU   0                                                        07411000
IDCIOPT0 EQU   0                                                        07412000
IDCIOSI0 EQU   0                                                        07413000
IDCIOST0 EQU   0                                                        07414000
IDCIOTM0 EQU   0                                                        07415000
IDCIOVY0 EQU   0                                                        07416000
IDCIO050 EQU   0                                                        07417000
IDCSACA0 EQU   0                                                        07418000
IDCSACR0 EQU   0                                                        07419000
IDCSADE0 EQU   0                                                        07420000
IDCSADQ0 EQU   0                                                        07421000
IDCSAFS0 EQU   0                                                        07422000
IDCSAGP0 EQU   0                                                        07423000
IDCSAGS0 EQU   0                                                        07424000
IDCSAID0 EQU   0                                                        07425000
IDCSALC0 EQU   0                                                        07426000
IDCSALD0 EQU   0                                                        07427000
IDCSALK0 EQU   0                                                        07428000
IDCSANQ0 EQU   0                                                        07429000
IDCSAPR0 EQU   0                                                        07430000
IDCSAPT0 EQU   0                                                        07431000
IDCSAQL0 EQU   0                                                        07432000
IDCSARC0 EQU   0                                                        07433000
IDCSARK0 EQU   0                                                        07434000
IDCSARV0 EQU   0                                                        07435000
IDCSASI0 EQU   0                                                        07436000
IDCSASN0 EQU   0                                                        07437000
IDCSAST0 EQU   0                                                        07438000
IDCSAWO0 EQU   0                                                        07439000
IDCST010 EQU   0                                                        07440000
IDCTPER0 EQU   0                                                        07441000
LISTTEST EQU   0                                                        07442000
NEWERID1 EQU   5                                                        07443000
GDTTBL   EQU   0                                                        07444000
GDTTR1   EQU   GDTTBL+8                                                 07445000
GDTTR2   EQU   GDTTBL+12                                                07446000
GDTDBG   EQU   GDTTBL+40                                                07447000
GDTSTC   EQU   GDTTBL+44                                                07448000
GDTPRT   EQU   GDTTBL+48                                                07449000
GDTESS   EQU   GDTTBL+52                                                07450000
GDTESA   EQU   GDTTBL+56                                                07451000
GDTRST   EQU   GDTTBL+60                                                07452000
GDTRES   EQU   GDTTBL+64                                                07453000
GDTCAL   EQU   GDTTBL+68                                                07454000
GDTGSP   EQU   GDTTBL+72                                                07455000
GDTFSP   EQU   GDTTBL+76                                                07456000
GDTGPL   EQU   GDTTBL+80                                                07457000
GDTFPL   EQU   GDTTBL+84                                                07458000
GDTLOD   EQU   GDTTBL+88                                                07459000
GDTDEL   EQU   GDTTBL+92                                                07460000
GDTPRL   EQU   GDTTBL+96                                                07461000
GDTEPL   EQU   GDTTBL+100                                               07462000
GDTTIM   EQU   GDTTBL+104                                               07463000
GDTIIO   EQU   GDTTBL+108                                               07464000
GDTTIO   EQU   GDTTBL+112                                               07465000
GDTOPN   EQU   GDTTBL+124                                               07466000
GDTCLS   EQU   GDTTBL+128                                               07467000
GDTGET   EQU   GDTTBL+132                                               07468000
GDTPUT   EQU   GDTTBL+136                                               07469000
GDTPOS   EQU   GDTTBL+140                                               07470000
GDTCPY   EQU   GDTTBL+144                                               07471000
GDTCAT   EQU   GDTTBL+148                                               07472000
GDTSNP   EQU   GDTTBL+164                                               07473000
GDTVFY   EQU   GDTTBL+172                                               07474000
GDTUID   EQU   GDTTBL+192                                               07475000
GDTPMT   EQU   GDTTBL+196                                               07476000
GDTCIR   EQU   GDTTBL+200                                               07477000
GDTLNK   EQU   GDTTBL+204                                               07478000
GDTALC   EQU   GDTTBL+208                                               07479000
GDTDLC   EQU   GDTTBL+212                                               07480000
GDTQAL   EQU   GDTTBL+216                                               07481000
GDTSTW   EQU   GDTTBL+220                                               07482000
GDTSSC   EQU   GDTTBL+224                                               07483000
GDTENQ   EQU   GDTTBL+228                                               07484000
GDTRSV   EQU   GDTTBL+232                                               07485000
GDTDEQ   EQU   GDTTBL+236                                               07486000
GDTSFO   EQU   GDTTBL+240                                               07487000
GDTWTO   EQU   GDTTBL+244                                               07488000
GDTSCR   EQU   GDTTBL+248                                               07489000
GDTUNT   EQU   GDTTBL+252                                               07490000
GDTRCT   EQU   GDTTBL+256                                               07491000
GDTIFO   EQU   GDTTBL+260                                               07492000
GDTEXP   EQU   GDTTBL+264                                               07493000
GDTSTA   EQU   GDTTBL+268                                               07494000
GDTERR   EQU   GDTTBL+272                                               07495000
GDTUNC   EQU   GDTTBL+276                                               07496000
GDTLOC   EQU   GDTTBL+280                                               07497000
GDTRCK   EQU   GDTTBL+284                                               07498000
FDTTBL   EQU   0                                                        07499000
FDTPTR   EQU   FDTTBL+8                                                 07500000
LASTCOND EQU   0                                                        07501000
SSRCODE  EQU   0                                                        07502000
SSRHALF  EQU   SSRCODE+2                                                07503000
SSECBCD  EQU   0                                                        07504000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    07505000
@NM00114 EQU   SSRCODE                                                  07506000
FDTVERB  EQU   FDTTBL                                                   07507000
GDTECT   EQU   GDTTBL+188                                               07508000
GDTPSB   EQU   GDTTBL+184                                               07509000
GDTUPT   EQU   GDTTBL+180                                               07510000
GDTCMB   EQU   GDTTBL+176                                               07511000
GDTSPR   EQU   GDTTBL+168                                               07512000
@NM00001 EQU   GDTTBL+160                                               07513000
GDTABH   EQU   GDTTBL+156                                               07514000
GDTABT   EQU   GDTTBL+152                                               07515000
GDTTOH   EQU   GDTTBL+120                                               07516000
GDTRIP   EQU   GDTTBL+116                                               07517000
GDTIOH   EQU   GDTTBL+36                                                07518000
GDTSAH   EQU   GDTTBL+32                                                07519000
GDTTPH   EQU   GDTTBL+28                                                07520000
GDTRIH   EQU   GDTTBL+24                                                07521000
GDTSTH   EQU   GDTTBL+20                                                07522000
GDTDBH   EQU   GDTTBL+16                                                07523000
GDTPRM   EQU   GDTTBL+4                                                 07524000
GDTHDR   EQU   GDTTBL                                                   07525000
@NM00108 EQU   BASEV+192                                                07526000
BASXPDT2 EQU   BASEV+188                                                07527000
BASGROUP EQU   BASEV+180                                                07528000
BASRECOV EQU   BASEV+174                                                07529000
BASDEST  EQU   BASEV+144                                                07530000
BASOWNER EQU   BASEV+134                                                07531000
BASDESCR EQU   BASEV+104                                                07532000
BASDTREM EQU   BASEV+100                                                07533000
BASEXPDT EQU   BASEV+96                                                 07534000
BASDLMTD EQU   BASEV+92                                                 07535000
BASRES6  EQU   BASEV+89                                                 07536000
BASCOPNO EQU   BASCOPID+1                                               07537000
BASCOPBK EQU   BASCOPID                                                 07538000
BASCOPSN EQU   BASKLCPY+5                                               07539000
BASCOPV  EQU   BASKLCPY                                                 07540000
BASFREXT EQU   BASEV+72                                                 07541000
BASLEXT  EQU   BASEV+70                                                 07542000
BASFRESP EQU   BASEV+68                                                 07543000
@NM00107 EQU   BASEV+65                                                 07544000
BASBKLMT EQU   BASEV+64                                                 07545000
BASNBKUP EQU   BASEV+63                                                 07546000
BASNCOPY EQU   BASEV+62                                                 07547000
BASPREV  EQU   BASEV+50                                                 07548000
BAS2BIT2 EQU   BASLID2                                                  07549000
BAS2BIT1 EQU   BASLID2                                                  07550000
BASRES5  EQU   BASLIB2                                                  07551000
BASCSN2  EQU   BASEV+37                                                 07552000
BAS1BIT2 EQU   BASLID1                                                  07553000
BAS1BIT1 EQU   BASLID1                                                  07554000
BASRES4  EQU   BASLIB1                                                  07555000
BASCSN1  EQU   BASEV+24                                                 07556000
BASRES3  EQU   BASMISCF                                                 07557000
BASHOLD  EQU   BASMISCF                                                 07558000
BASRES8  EQU   BASSATIA                                                 07559000
BASIVCRE EQU   BASSATIA                                                 07560000
BASCPUID EQU   BASEV+18                                                 07561000
@NM00106 EQU   BASFLAGA+3                                               07562000
BASFIRST EQU   BASFLAGA+3                                               07563000
BASREASS EQU   BASFLAGA+3                                               07564000
BASRONLY EQU   BASFLAGA+3                                               07565000
BASDAERA EQU   BASFLAGA+3                                               07566000
BASEXCL  EQU   BASFLAGA+2                                               07567000
BASBIND  EQU   BASFLAGA+2                                               07568000
BASINAC  EQU   BASFLAGA+2                                               07569000
BASRSTD  EQU   BASFLAGA+2                                               07570000
BASGENUS EQU   BASFLAGA+2                                               07571000
BASGRPV  EQU   BASFLAGA+2                                               07572000
BASNOCPY EQU   BASFLAGA+2                                               07573000
BASDLSF  EQU   BASFLAGA+2                                               07574000
BASRES2  EQU   BASTYPE                                                  07575000
BASBASVR EQU   BASTYPE                                                  07576000
BASRES1  EQU   BASTYPE                                                  07577000
BASRES7  EQU   BASEV+13                                                 07578000
BASZERO  EQU   BASID+1                                                  07579000
BASBLANK EQU   BASID                                                    07580000
BASEVKEY EQU   BASNAME                                                  07581000
@NM00105 EQU   GROUP+136                                                07582000
GROADDR  EQU   GROUP+106                                                07583000
GROOWNER EQU   GROUP+96                                                 07584000
GRORESSP EQU   GROUP+95                                                 07585000
GROCONUS EQU   GROUP+94                                                 07586000
GRODESCR EQU   GROUP+64                                                 07587000
GROERRTM EQU   GROERRTS+4                                               07588000
GROERRDT EQU   GROERRTS                                                 07589000
GRORETPD EQU   GROUP+52                                                 07590000
GROFREXT EQU   GROUP+48                                                 07591000
GROFRESP EQU   GROUP+44                                                 07592000
GROSTRSH EQU   GROUP+40                                                 07593000
GROSSPD  EQU   GROUP+38                                                 07594000
GROPSPD  EQU   GROUP+36                                                 07595000
GRONINAC EQU   GROUP+34                                                 07596000
GROPCENT EQU   GROUP+29                                                 07597000
GROLSN   EQU   GROUP+23                                                 07598000
@NM00104 EQU   GROFLAGA+2                                               07599000
GROMSG1  EQU   GROFLAGA+2                                               07600000
GRORETN  EQU   GROFLAGA+2                                               07601000
GRORLSE  EQU   GROFLAGA+2                                               07602000
GRORONLY EQU   GROFLAGA+2                                               07603000
GRODAERA EQU   GROFLAGA+2                                               07604000
GROEXCL  EQU   GROFLAGA+2                                               07605000
GROBIND  EQU   GROFLAGA+2                                               07606000
GRORES1  EQU   GROTYPE                                                  07607000
GROGVR   EQU   GROTYPE                                                  07608000
GROZERO  EQU   GROID+1                                                  07609000
GROBLANK EQU   GROID                                                    07610000
GROG     EQU   GRONAME                                                  07611000
@NM00103 EQU   RVVI+64                                                  07612000
RVVSDUP  EQU   RVVSPEC                                                  07613000
RVVSCPY  EQU   RVVSPEC                                                  07614000
RVVSCSN  EQU   RVVSPEC                                                  07615000
RVVSSEQ  EQU   RVVSPEC                                                  07616000
RVVSDTE  EQU   RVVSPEC                                                  07617000
RVVSEXP  EQU   RVVSPEC                                                  07618000
@NM00102 EQU   RVVCPYTP                                                 07619000
RVVCPLHD EQU   RVVCPYTP                                                 07620000
RVVLCOPY EQU   RVVCPYTP                                                 07621000
RVVOBKUP EQU   RVVCPYTP                                                 07622000
RVVLBKUP EQU   RVVCPYTP                                                 07623000
RVVBPLHD EQU   RVVRTEST                                                 07624000
RVVDVOL  EQU   RVVRTEST                                                 07625000
RVVINACT EQU   RVVRTEST                                                 07626000
RVVRSTD  EQU   RVVRTEST                                                 07627000
RVVTHOLD EQU   RVVRTEST                                                 07628000
RVVEXPDT EQU   RVVRTEST                                                 07629000
RVVALL   EQU   RVVRDRCD                                                 07630000
RVVCPURC EQU   RVVRDRCD                                                 07631000
RVVCIRCD EQU   RVVRDRCD                                                 07632000
RVVRUNKN EQU   RVVRDRCD                                                 07633000
RVVDUPRC EQU   RVVRDRCD                                                 07634000
RVVCPYRC EQU   RVVRDRCD                                                 07635000
@NM00101 EQU   RVVCHAIN                                                 07636000
@NM00100 EQU   RVVRMODE                                                 07637000
RVVDUPID EQU   RVVI+57                                                  07638000
RVVCPYID EQU   RVVI+56                                                  07639000
RVVRDCSN EQU   RVVI+44                                                  07640000
RVVRDSEQ EQU   RVVI+43                                                  07641000
RVVBLNK1 EQU   RVVI+42                                                  07642000
RVVCDATE EQU   RVVI+38                                                  07643000
RVVEXPIR EQU   RVVI+36                                                  07644000
@NM00099 EQU   RVVI+28                                                  07645000
RVVAREA  EQU   RVVI+24                                                  07646000
RVVARLN  EQU   RVVI+22                                                  07647000
@NM00098 EQU   RVVOPCOD+1                                               07648000
EXDSVAL  EQU   @NM00097+21                                              07649000
EXDSLEN  EQU   @NM00097+20                                              07650000
EXDSMEM  EQU   @NM00097+12                                              07651000
EXDSMLN  EQU   @NM00097+11                                              07652000
EXDSFUQ  EQU   EXDSFLG                                                  07653000
EXDSPOS  EQU   @NM00097+9                                               07654000
EXDSPAS  EQU   @NM00097+1                                               07655000
EXDSPLN  EQU   @NM00097                                                 07656000
EXDSCNT  EQU   EXDS                                                     07657000
EXVOLLEN EQU   @NM00096                                                 07658000
FILELEN  EQU   FILE                                                     07659000
LEVELMEM EQU   LEVEL+12                                                 07660000
LEVELMLN EQU   LEVEL+11                                                 07661000
LEVELFUQ EQU   LEVELFLG                                                 07662000
LEVELPAS EQU   LEVEL+1                                                  07663000
LEVELPLN EQU   LEVEL                                                    07664000
GRPLEN   EQU   @NM00095                                                 07665000
VOLLEN   EQU   @NM00094                                                 07666000
VSDFMT0  EQU   VSDBLOCK+8                                               07667000
VSDVTOCS EQU   VSDBLOCK+4                                               07668000
VSDFREE  EQU   VSDUSAGE+24                                              07669000
VSDALLC  EQU   VSDUSAGE+19                                              07670000
VSDDSOR3 EQU   VSDDSORG+2                                               07671000
@NM00093 EQU   VSDDSORG                                                 07672000
VSDSCAL  EQU   VSDUSAGE+12                                              07673000
@NM00092 EQU   VSDUSEF                                                  07674000
VSDCALFR EQU   VSDUSEF                                                  07675000
@NM00091 EQU   VSDALLOC                                                 07676000
VSDABSTR EQU   VSDALLOC                                                 07677000
VSDABLK  EQU   VSDALLOC                                                 07678000
VSDATRK  EQU   VSDALLOC                                                 07679000
VSDACYL  EQU   VSDALLOC                                                 07680000
@NM00090 EQU   VSDDORG                                                  07681000
VSDOU    EQU   VSDDORG                                                  07682000
VSDOIS   EQU   VSDDORG                                                  07683000
VSDODA   EQU   VSDDORG                                                  07684000
VSDOUN   EQU   VSDDORG                                                  07685000
VSDOPS   EQU   VSDDORG                                                  07686000
VSDOPO   EQU   VSDDORG                                                  07687000
VSDEXTS  EQU   VSDUSAGE+8                                               07688000
VSDSECAL EQU   VSDUSAGE+4                                               07689000
VSDFTRK  EQU   VSDUSAGE+2                                               07690000
VSDTRKS  EQU   VSDUSAGE                                                 07691000
@NM00089 EQU   VSDSCR+5                                                 07692000
@NM00088 EQU   VSDSCRFL                                                 07693000
@NM00087 EQU   VSDSTAT+29                                               07694000
VSDPRTC  EQU   VSDSTAT+25                                               07695000
VSDCAT   EQU   VSDSTAT+22                                               07696000
VSDEXP   EQU   VSDSTAT+20                                               07697000
VSDCRE   EQU   VSDSTAT+18                                               07698000
@NM00086 EQU   VSDFLG2                                                  07699000
VSDRACF  EQU   VSDFLG2                                                  07700000
VSDERROR EQU   VSDFLG2                                                  07701000
VSDPROT  EQU   VSDFLG2                                                  07702000
VSDPWW   EQU   VSDFLG2                                                  07703000
VSDPWR   EQU   VSDFLG2                                                  07704000
@NM00085 EQU   VSDSFLG1                                                 07705000
VSDCVSAM EQU   VSDSFLG1                                                 07706000
VSDCATLG EQU   VSDSFLG1                                                 07707000
VSDVSAME EQU   VSDSFLG1                                                 07708000
VSDVSAMC EQU   VSDSFLG1                                                 07709000
VSDVTOCE EQU   VSDSFLG1                                                 07710000
VSDVTOCC EQU   VSDSFLG1                                                 07711000
VSDOWNER EQU   VSDSTAT+8                                                07712000
VSDEXPIR EQU   VSDSTAT+4                                                07713000
VSDCREAT EQU   VSDSTAT                                                  07714000
VSDFRCCL EQU   VSDVTOC+21                                               07715000
@NM00084 EQU   VSDVTOC+20                                               07716000
VSDFREXT EQU   VSDVTOC+16                                               07717000
@NM00083 EQU   VSDVTOC+15                                               07718000
VSDFRTRK EQU   VSDVTOC+11                                               07719000
@NM00082 EQU   VSDVTOC+10                                               07720000
VSDFRCYL EQU   VSDVTOC+6                                                07721000
@NM00081 EQU   VSDVTOC                                                  07722000
@NM00080 EQU   VS3FLAGS                                                 07723000
VS3USAGE EQU   VS3FLAGS                                                 07724000
VS3STAT  EQU   VS3FLAGS                                                 07725000
VS3HEAD  EQU   VS3AGL                                                   07726000
@NM00079 EQU   DATESOPT                                                 07727000
@NM00078 EQU   SELFLAGS                                                 07728000
SELHEAD  EQU   SELAGL                                                   07729000
@NM00077 EQU   UCTFLAGS                                                 07730000
UCTHEAD  EQU   UCTAGL                                                   07731000
@NM00076 EQU   LCTFLAGS                                                 07732000
LCTVSCAT EQU   LCTFLAGS                                                 07733000
LCTOWNER EQU   LCTINFO+24                                               07734000
LCTEXPIR EQU   LCTINFO+20                                               07735000
LCTCREAT EQU   LCTINFO+16                                               07736000
LCTACBP  EQU   LCTINFO+12                                               07737000
LCTMULVC EQU   LCTINFO+8                                                07738000
LCTHEAD  EQU   LCTINFO                                                  07739000
SRTWORKP EQU   SRTAGL+28                                                07740000
SRTFLDLN EQU   SRTAGL+24                                                07741000
SRTPOSIT EQU   SRTAGL+20                                                07742000
SRTLEN   EQU   SRTAGL+16                                                07743000
SRTNUM   EQU   SRTAGL+12                                                07744000
SRTADDR  EQU   SRTAGL+8                                                 07745000
SRTHEAD  EQU   SRTAGL                                                   07746000
SV82DEBP EQU   SV82WRKP                                                 07747000
SV82TTRP EQU   SV82LIST+8                                               07748000
SV82VOLP EQU   SV82DCBP                                                 07749000
SV82UCBP EQU   SV82LIST+1                                               07750000
SV82CODE EQU   SV82LIST                                                 07751000
VOLRESV3 EQU   VOLLABEL+55                                              07752000
VOLOWNER EQU   VOLLABEL+45                                              07753000
VOLRESV1 EQU   VOLLABEL+20                                              07754000
VOLVTOC  EQU   VOLLABEL+15                                              07755000
VOLSECTY EQU   VOLLABEL+14                                              07756000
VOLSERNO EQU   VOLLABEL+8                                               07757000
VOLNO    EQU   VOLLABEL+7                                               07758000
VOLLABI  EQU   VOLLABEL+4                                               07759000
VOLKEY   EQU   VOLLABEL                                                 07760000
STAVTTR  EQU   STAEPARM+54                                              07761000
@NM00073 EQU   STARETRY                                                 07762000
STAVTOC  EQU   STARETRY                                                 07763000
STAOFF   EQU   STARETRY                                                 07764000
STAIO05  EQU   STARETRY                                                 07765000
@NM00072 EQU   STARCVY                                                  07766000
STACLEAR EQU   STARCVY                                                  07767000
STAVPOST EQU   STARCVY                                                  07768000
STAVENQ  EQU   STARCVY                                                  07769000
STAVDMNT EQU   STARCVY                                                  07770000
STAVMNT  EQU   STARCVY                                                  07771000
STATCB   EQU   STAEPARM+48                                              07772000
STARTADD EQU   STAEPARM+44                                              07773000
STAEXSAV EQU   STAEPARM+40                                              07774000
STARTSAV EQU   STAEPARM+36                                              07775000
STARTTR  EQU   STAEPARM+32                                              07776000
@NM00071 EQU   STAEPARM+30                                              07777000
STARVOL  EQU   STAEPARM+24                                              07778000
STARUCB  EQU   STAEPARM+20                                              07779000
@NM00070 EQU   STAEPARM+18                                              07780000
STAVVOL  EQU   STAEPARM+12                                              07781000
STAVUCB  EQU   STAEPARM+8                                               07782000
STAHEAD  EQU   STAEPARM                                                 07783000
RCTDSET  EQU   RCTAGL+32                                                07784000
RCTNVOL  EQU   RCTAGL+26                                                07785000
RCTOVOL  EQU   RCTAGL+20                                                07786000
RCTNDEV  EQU   RCTAGL+16                                                07787000
RCTODEV  EQU   RCTAGL+12                                                07788000
@NM00069 EQU   RCTAGL+10                                                07789000
@NM00068 EQU   RCTOPT                                                   07790000
RCTVOL   EQU   RCTOPT                                                   07791000
RCTDEV   EQU   RCTOPT                                                   07792000
RCTHEAD  EQU   RCTAGL                                                   07793000
@NM00067 EQU   VSRESOPT                                                 07794000
VSREAL   EQU   VSRESOPT                                                 07795000
VSRES    EQU   VSRESOPT                                                 07796000
@NM00066 EQU   VSMSG                                                    07797000
VSTOV    EQU   VSMSG                                                    07798000
VSFROMV  EQU   VSMSG                                                    07799000
@NM00065 EQU   VSRETURN                                                 07800000
VSUCAT   EQU   VSRETURN                                                 07801000
VSVSAM   EQU   VSRETURN                                                 07802000
@NM00064 EQU   VSCATOPT                                                 07803000
VSLIST   EQU   VSCATOPT                                                 07804000
VSSERIAL EQU   VSCATOPT                                                 07805000
VSDEVICE EQU   VSCATOPT                                                 07806000
@NM00063 EQU   VSVTOPT                                                  07807000
VSVSFLAG EQU   VSVTOPT                                                  07808000
VSALTTRK EQU   VSVTOPT                                                  07809000
VSTIME   EQU   VSVTOPT                                                  07810000
VSUCMAST EQU   VSSECOPT                                                 07811000
VSOPCAT  EQU   VSSECOPT                                                 07812000
VSUCTEST EQU   VSSECOPT                                                 07813000
VSWRITE  EQU   VSSECOPT                                                 07814000
VSREAD   EQU   VSSECOPT                                                 07815000
VSNONONV EQU   VSSECOPT                                                 07816000
VSMASTER EQU   VSSECOPT                                                 07817000
VSNOVSAM EQU   VSSECOPT                                                 07818000
VSODEVP  EQU   VS1AGL+64                                                07819000
VSOSERP  EQU   VS1AGL+60                                                07820000
VSDEVP   EQU   VS1AGL+56                                                07821000
VSSERP   EQU   VS1AGL+52                                                07822000
VSPFILEP EQU   VS1AGL+48                                                07823000
VSPSWDP  EQU   VS1AGL+44                                                07824000
VSCATDDP EQU   VS1AGL+40                                                07825000
VSACBP   EQU   VS1AGL+36                                                07826000
VSCATP   EQU   VS1AGL+32                                                07827000
VSNXTATP EQU   VS1AGL+28                                                07828000
VSNUMATP EQU   VS1AGL+24                                                07829000
VSIOP    EQU   VS1AGL+20                                                07830000
VSFILEP  EQU   VS1AGL+16                                                07831000
VSVOLP   EQU   VS1AGL+12                                                07832000
VSUCBP   EQU   VS1AGL+8                                                 07833000
VSHEAD   EQU   VS1AGL                                                   07834000
VSVTOCPT EQU   VS2AGL+48                                                07835000
@NM00062 EQU   VS2AGL+45                                                07836000
VSDDNAME EQU   VS2AGL+37                                                07837000
@NM00061 EQU   VS2RESOP                                                 07838000
VS2REAL  EQU   VS2RESOP                                                 07839000
VS2RES   EQU   VS2RESOP                                                 07840000
@NM00060 EQU   VS2MSG                                                   07841000
VS2TOV   EQU   VS2MSG                                                   07842000
VSVOLUME EQU   VS2AGL+29                                                07843000
@NM00059 EQU   VSLABOPT                                                 07844000
VSNOVTOC EQU   VSLABOPT                                                 07845000
VSVOLSER EQU   VSLABOPT                                                 07846000
VSOWNER  EQU   VSLABOPT                                                 07847000
VSIOBKPT EQU   VS2AGL+24                                                07848000
VSVOLPTR EQU   VS2AGL+20                                                07849000
VSOWNPTR EQU   VS2AGL+16                                                07850000
VSVTOCSZ EQU   VS2AGL+12                                                07851000
VSUCBPTR EQU   VS2AGL+8                                                 07852000
VS2HEAD  EQU   VS2AGL                                                   07853000
EXPDATAL EQU   EXPARRAY+6                                               07854000
@NM00058 EQU   EXPARRAY+5                                               07855000
EXPKEYLN EQU   EXPARRAY+4                                               07856000
EXPDATAP EQU   EXPARRAY                                                 07857000
EXPRECNO EQU   EXPDATAB                                                 07858000
EXPCCHHR EQU   EXPARG+16                                                07859000
EXPCTLBK EQU   EXPARG+8                                                 07860000
EXPHEAD  EQU   EXPARG                                                   07861000
EXRWFUN  EQU   EXWRARG+46                                               07862000
@NM00057 EQU   EXSPACE+8                                                07863000
@NM00056 EQU   EXSPACE+6                                                07864000
@NM00055 EQU   EXSPACE+4                                                07865000
@NM00054 EQU   EXSPACE+1                                                07866000
@NM00053 EQU   EXSPACE                                                  07867000
EXRWKDLN EQU   EXWRARG+32                                               07868000
@NM00052 EQU   EXWRARG+31                                               07869000
EXRECNUM EQU   EXRWCHR+4                                                07870000
EXHH     EQU   EXRWCHR+2                                                07871000
EXCC     EQU   EXRWCHR                                                  07872000
EXCCWCNT EQU   EXWRARG+24                                               07873000
EXLOCPTR EQU   EXWRARG+20                                               07874000
EXRWDARE EQU   EXWRARG+16                                               07875000
EXRWIOAR EQU   EXWRARG+12                                               07876000
EXRWCTBL EQU   EXWRARG+8                                                07877000
EXRWRES  EQU   EXWRARG                                                  07878000
EXGDATAL EQU   EXGARG+30                                                07879000
@NM00051 EQU   EXGARG+29                                                07880000
EXGKEYLN EQU   EXGARG+28                                                07881000
EXGDATAP EQU   EXGARG+24                                                07882000
EXGRECNO EQU   EXGARG+20                                                07883000
EXGCCHH2 EQU   EXGARG+16                                                07884000
EXGCCHH1 EQU   EXGARG+12                                                07885000
EXGCTLBK EQU   EXGARG+8                                                 07886000
EXGHEAD  EQU   EXGARG                                                   07887000
EXOVTH   EQU   EXFLG                                                    07888000
EXORVT   EQU   EXFLG                                                    07889000
EXORDS   EQU   EXFLG                                                    07890000
EXOSPK   EQU   EXFLG                                                    07891000
EXORVS   EQU   EXFLG                                                    07892000
@NM00050 EQU   EXFLG                                                    07893000
EXOREAD  EQU   EXFLG                                                    07894000
@NM00049 EQU   EXOPT                                                    07895000
EXOREP   EQU   EXOPT                                                    07896000
EXOVTOC  EQU   EXOPT                                                    07897000
EXONEW   EQU   EXOPT                                                    07898000
EXOPASS  EQU   EXOPT                                                    07899000
EXOLAB   EQU   EXOPT                                                    07900000
EXOTAB   EQU   EXOPT                                                    07901000
EXOCTLBK EQU   EXOARG+28                                                07902000
EXOEXT   EQU   EXOARG+24                                                07903000
EXOUCB   EQU   EXOARG+20                                                07904000
EXOVSN   EQU   EXOARG+16                                                07905000
EXODSN   EQU   EXOARG+12                                                07906000
EXODDN   EQU   EXOARG+8                                                 07907000
EXOHEAD  EQU   EXOARG                                                   07908000
@NM00048 EQU   EXCLFLAG                                                 07909000
EXCLMNT  EQU   EXCLFLAG                                                 07910000
EXCLVOL  EQU   EXCLAGL+16                                               07911000
EXCLDDP  EQU   EXCLAGL+12                                               07912000
EXCLUCBP EQU   EXCLAGL+8                                                07913000
EXCLHEAD EQU   EXCLAGL                                                  07914000
@NM00047 EQU   CKFLAGS                                                  07915000
CKRETTYP EQU   CKFLAGS                                                  07916000
CKLABELP EQU   CKAGL+24                                                 07917000
CKDATYPE EQU   CKAGL+20                                                 07918000
CKHEAD   EQU   CKAGL                                                    07919000
PULABELP EQU   PUAGL+16                                                 07920000
PUTTRPTR EQU   PUAGL+12                                                 07921000
PUUCBPTR EQU   PUAGL+8                                                  07922000
PUHEAD   EQU   PUAGL                                                    07923000
MDR      EQU   MDVTOC+4                                                 07924000
MDHH     EQU   MDVTOC+2                                                 07925000
MDCC     EQU   MDVTOC                                                   07926000
@NM00046 EQU   MDAGL+31                                                 07927000
MDVTOCTR EQU   MDFLAGS                                                  07928000
MDFORCE  EQU   MDFLAGS                                                  07929000
MDDEQ    EQU   MDFLAGS                                                  07930000
MDENQ    EQU   MDFLAGS                                                  07931000
MDWAIT   EQU   MDFLAGS                                                  07932000
MDPOST   EQU   MDFLAGS                                                  07933000
MDCLEAR  EQU   MDFLAGS                                                  07934000
MDNEWVOL EQU   MDFLAGS                                                  07935000
MDLABEL  EQU   MDAGL+24                                                 07936000
MDPUAGL  EQU   MDAGL+20                                                 07937000
MDDDNAME EQU   MDAGL+12                                                 07938000
MDUCBPTR EQU   MDAGL+8                                                  07939000
MDHEAD   EQU   MDAGL                                                    07940000
CTTBLRR  EQU   CTARRAY+3                                                07941000
CTTBLHH  EQU   CTARRAY+2                                                07942000
CTTBLCC  EQU   CTARRAY+1                                                07943000
CTTBLID  EQU   CTARRAY                                                  07944000
CTREALH  EQU   CTMSG+3                                                  07945000
CTREALCC EQU   CTMSG+1                                                  07946000
@NM00045 EQU   CTMSG                                                    07947000
CMCSN2   EQU   CMMSG+28                                                 07948000
CMCSN1   EQU   CMMSG+16                                                 07949000
CMNUMCRT EQU   CMMSG+15                                                 07950000
@NM00044 EQU   CMMSG+14                                                 07951000
CMNEWVOL EQU   CMMSG+8                                                  07952000
@NM00043 EQU   CMMSG+7                                                  07953000
@NM00042 EQU   CMVOLFLG                                                 07954000
CMRONLY  EQU   CMVOLFLG                                                 07955000
CMBIND   EQU   CMVOLFLG                                                 07956000
CMSCRCRT EQU   CMVOLFLG                                                 07957000
CMEXCL   EQU   CMVOLFLG                                                 07958000
CMDERAS  EQU   CMVOLFLG                                                 07959000
CMSCRVOL EQU   CMVOLFLG                                                 07960000
CMCECART EQU   CMVOLFLG                                                 07961000
CMOLDVOL EQU   CMMSG                                                    07962000
CCOLDCSN EQU   CCMSG+24                                                 07963000
CCNEWCSN EQU   CCMSG+12                                                 07964000
@NM00041 EQU   CCMSG+10                                                 07965000
CCVOL    EQU   CCMSG+4                                                  07966000
@NM00040 EQU   CCMSG+2                                                  07967000
CCEJCODE EQU   CCMSG+1                                                  07968000
CCPSTCDE EQU   CCMSG                                                    07969000
@NM00039 EQU   DMPARY+15                                                07970000
DMPARYTP EQU   DMPARY+14                                                07971000
DMPARYEX EQU   DMPARY+12                                                07972000
DMPARYIC EQU   DMPARY+10                                                07973000
DMPARYSZ EQU   DMPARY+8                                                 07974000
DMPARYNM EQU   DMPARY                                                   07975000
@NM00038 EQU   DMPITM+15                                                07976000
DMPITMTP EQU   DMPITM+14                                                07977000
DMPITMLN EQU   DMPITM+12                                                07978000
DMPITMPT EQU   DMPITM+8                                                 07979000
DMPITMNM EQU   DMPITM                                                   07980000
@NM00037 EQU   ERCNVTAB+24                                              07981000
ERDARBPT EQU   ERCPLPT                                                  07982000
ERDYNRC  EQU   ERCATRC                                                  07983000
ERDSNM   EQU   ERCNVTAB+12                                              07984000
@NM00036 EQU   ERCNVTAB+4                                               07985000
@NM00035 EQU   ERCNVTAB+3                                               07986000
@NM00034 EQU   EROSOPER                                                 07987000
EROSUCDX EQU   EROSOPER                                                 07988000
EROSCATL EQU   EROSOPER                                                 07989000
@NM00033 EQU   EROPER                                                   07990000
ERCATAL  EQU   EROPER                                                   07991000
ERCATDL  EQU   EROPER                                                   07992000
ERCATDE  EQU   EROPER                                                   07993000
ERCATLC  EQU   EROPER                                                   07994000
@NM00032 EQU   ERTYPE                                                   07995000
ERDYNAL  EQU   ERTYPE                                                   07996000
EROSCAT  EQU   ERTYPE                                                   07997000
ERCATLG  EQU   ERTYPE                                                   07998000
@NM00031 EQU   FMTCNVF+1                                                07999000
FMTAR    EQU   FMTCNVF+1                                                08000000
FMTBS    EQU   FMTCNVF+1                                                08001000
FMTSS    EQU   FMTCNVF+1                                                08002000
FMTAL    EQU   FMTCNVF+1                                                08003000
FMTZS    EQU   FMTCNVF+1                                                08004000
@NM00030 EQU   FMTCNVF                                                  08005000
FMTPU    EQU   FMTCNVF                                                  08006000
FMTBD    EQU   FMTCNVF                                                  08007000
FMTBHD   EQU   FMTCNVF                                                  08008000
FMTBHA   EQU   FMTCNVF                                                  08009000
FMTBH    EQU   FMTCNVF                                                  08010000
FMTOLEN  EQU   FMTLIST+8                                                08011000
FMTRIO   EQU   FMTOCOL                                                  08012000
FMTSPT   EQU   FMTSTO                                                   08013000
FMTSTL   EQU   FMTILEN                                                  08014000
@NM00029 EQU   FMTFLGS+1                                                08015000
FMTSMSG  EQU   FMTFLGS+1                                                08016000
FMTHDF   EQU   FMTFLGS                                                  08017000
FMTDFF   EQU   FMTFLGS                                                  08018000
FMTSTF   EQU   FMTFLGS                                                  08019000
FMTREPF  EQU   FMTFLGS                                                  08020000
FMTBDF   EQU   FMTFLGS                                                  08021000
FMTIDF   EQU   FMTFLGS                                                  08022000
FMTSCF   EQU   FMTFLGS                                                  08023000
FMTEOLF  EQU   FMTFLGS                                                  08024000
DARGPCT  EQU   DARGINL                                                  08025000
DARGREP  EQU   DARGINS                                                  08026000
@NM00028 EQU   DARGLIST+19                                              08027000
DARGIND  EQU   DARGLIST+18                                              08028000
@NM00027 EQU   IOINFOPT                                                 08029000
IOINFLUB EQU   IOINFOPT                                                 08030000
IOINFTMS EQU   IOINFOPT                                                 08031000
IOINFSUP EQU   IOINFOPT                                                 08032000
IOINFDSN EQU   IOINFOPT                                                 08033000
IOINFVOL EQU   IOINFOPT                                                 08034000
IOINFDVT EQU   IOINFOPT                                                 08035000
OPNVOL   EQU   OPNAGL+44                                                08036000
OPNSTRNO EQU   OPNAGL+43                                                08037000
@NM00026 EQU   OPNOPT2                                                  08038000
OPNOPTJM EQU   OPNOPT2                                                  08039000
@NM00025 EQU   OPNOPT2                                                  08040000
OPNOPTAS EQU   OPNOPT2                                                  08041000
@NM00024 EQU   OPNDSO                                                   08042000
OPNDSOPO EQU   OPNDSO                                                   08043000
OPNDSOIS EQU   OPNDSO                                                   08044000
OPNDSOPS EQU   OPNDSO                                                   08045000
OPNDSOAM EQU   OPNDSO                                                   08046000
OPNKYL   EQU   OPNAGL+40                                                08047000
OPNBLK   EQU   OPNAGL+36                                                08048000
OPNREC   EQU   OPNAGL+32                                                08049000
OPNDEVIX EQU   OPNDEV+4                                                 08050000
OPNDEVDT EQU   OPNDEV                                                   08051000
OPNCBP   EQU   OPNAGL+20                                                08052000
OPNDSN   EQU   OPNAGL+16                                                08053000
OPNPWA   EQU   OPNAGL+12                                                08054000
OPNDDN   EQU   OPNAGL+8                                                 08055000
OPNIOC   EQU   OPNAGL+4                                                 08056000
OPNMODRP EQU   OPNMOD                                                   08057000
OPNMODUB EQU   OPNMOD                                                   08058000
OPNMODRS EQU   OPNMOD                                                   08059000
OPNMODAX EQU   OPNMOD                                                   08060000
OPNMODRR EQU   OPNMOD                                                   08061000
OPNMODRC EQU   OPNMOD                                                   08062000
OPNMODAC EQU   OPNMOD                                                   08063000
OPNMODPD EQU   OPNMOD                                                   08064000
OPNTYPSY EQU   OPNTYP                                                   08065000
OPNTYPRV EQU   OPNTYP                                                   08066000
OPNTYPEX EQU   OPNTYP                                                   08067000
OPNTYPRA EQU   OPNTYP                                                   08068000
OPNTYPXM EQU   OPNTYP                                                   08069000
OPNTYPCI EQU   OPNTYP                                                   08070000
OPNTYPSO EQU   OPNTYP                                                   08071000
OPNTYPSI EQU   OPNTYP                                                   08072000
@NM00023 EQU   OPNRFM                                                   08073000
OPNRFMBK EQU   OPNRFM                                                   08074000
OPNRFMSF EQU   OPNRFM                                                   08075000
OPNRFMUN EQU   OPNRFM                                                   08076000
OPNRFMVR EQU   OPNRFM                                                   08077000
OPNRFMFX EQU   OPNRFM                                                   08078000
OPNOPTSK EQU   OPNOPT                                                   08079000
OPNOPTDR EQU   OPNOPT                                                   08080000
OPNOPTCR EQU   OPNOPT                                                   08081000
OPNOPTKS EQU   OPNOPT                                                   08082000
OPNOPTBK EQU   OPNOPT                                                   08083000
OPNOPTUP EQU   OPNOPT                                                   08084000
OPNOPTOT EQU   OPNOPT                                                   08085000
OPNOPTIN EQU   OPNOPT                                                   08086000
IOCEXT   EQU   IOCSTR+64                                                08087000
IOCTSML  EQU   IOCREL+2                                                 08088000
IOCTPML  EQU   IOCREL                                                   08089000
IOCWORK  EQU   IOCSTR+56                                                08090000
IOCRRN   EQU   IOCSTR+52                                                08091000
IOCPNM   EQU   IOCNWM+2                                                 08092000
IOCPTL   EQU   IOCNWM                                                   08093000
IOCKYA   EQU   IOCMEM                                                   08094000
IOCVRC   EQU   IOCTTR                                                   08095000
IOCCBP   EQU   IOCSTR+36                                                08096000
IOCDSN   EQU   IOCSTR+32                                                08097000
IOCHURBA EQU   IOCSTR+28                                                08098000
IOCVOLSR EQU   IOCSTR+22                                                08099000
@NM00022 EQU   IOCMSG                                                   08100000
IOCMSGSM EQU   IOCMSG                                                   08101000
IOCMSGAE EQU   IOCMSG                                                   08102000
IOCMSGCE EQU   IOCMSG                                                   08103000
IOCMSGOE EQU   IOCMSG                                                   08104000
IOCMSGOP EQU   IOCMSG                                                   08105000
IOCCHPKG EQU   IOCMSG                                                   08106000
IOCCHPKE EQU   IOCMSG                                                   08107000
IOCCHPNU EQU   IOCCHP                                                   08108000
IOCCHPUP EQU   IOCCHP                                                   08109000
IOCCHPBK EQU   IOCCHP                                                   08110000
IOCCHPCR EQU   IOCCHP                                                   08111000
IOCCHPKS EQU   IOCCHP                                                   08112000
IOCCHPSK EQU   IOCCHP                                                   08113000
IOCCHPDR EQU   IOCCHP                                                   08114000
IOCCHPSQ EQU   IOCCHP                                                   08115000
IOCMACNT EQU   IOCMAC2                                                  08116000
IOCMACER EQU   IOCMAC2                                                  08117000
IOCMACPA EQU   IOCMAC2                                                  08118000
IOCMACEN EQU   IOCMAC2                                                  08119000
IOCMACCP EQU   IOCMAC2                                                  08120000
IOCMACRR EQU   IOCMAC2                                                  08121000
IOCMACAS EQU   IOCMAC2                                                  08122000
IOCMACSK EQU   IOCMAC2                                                  08123000
@NM00021 EQU   IOCMAC                                                   08124000
IOCMACCC EQU   IOCMAC                                                   08125000
IOCMACDR EQU   IOCMAC                                                   08126000
IOCMACBK EQU   IOCMAC                                                   08127000
IOCMACCR EQU   IOCMAC                                                   08128000
IOCMACUP EQU   IOCMAC                                                   08129000
IOCMACOT EQU   IOCMAC                                                   08130000
IOCMACIN EQU   IOCMAC                                                   08131000
@NM00020 EQU   IOCRFM                                                   08132000
IOCRFMBK EQU   IOCRFM                                                   08133000
IOCRFMSF EQU   IOCRFM                                                   08134000
IOCRFMUN EQU   IOCRFM                                                   08135000
IOCRFMVR EQU   IOCRFM                                                   08136000
IOCRFMFX EQU   IOCRFM                                                   08137000
@NM00019 EQU   IOCDSO                                                   08138000
IOCDSOPO EQU   IOCDSO                                                   08139000
IOCDSOIS EQU   IOCDSO                                                   08140000
IOCDSOPS EQU   IOCDSO                                                   08141000
IOCDSOAM EQU   IOCDSO                                                   08142000
IOCRKP   EQU   IOCSTR+13                                                08143000
IOCKYL   EQU   IOCSTR+12                                                08144000
IOCTRN   EQU   IOCSTR+8                                                 08145000
IOCDLN   EQU   IOCSTR+4                                                 08146000
IOCDAD   EQU   IOCSTR                                                   08147000
UNITVTOC EQU   UNITABL+7                                                08148000
@NM00018 EQU   UNITSTAT                                                 08149000
UNITUSHR EQU   UNITSTAT                                                 08150000
UNITXSHR EQU   UNITSTAT                                                 08151000
UNITISHR EQU   UNITSTAT                                                 08152000
UNITUA   EQU   @NM00017+1                                               08153000
UNITCHA  EQU   @NM00017                                                 08154000
UNITUCB  EQU   UNITABL                                                  08155000
RACFVOLS EQU   RACFAGL+16                                               08156000
RACFCLN  EQU   RACFAGL+12                                               08157000
RACFPROF EQU   RACFAGL+8                                                08158000
RACFENT  EQU   RACFAGL+4                                                08159000
@NM00016 EQU   RACFFLG4                                                 08160000
@NM00015 EQU   RACFFLG3                                                 08161000
RACFPRF  EQU   RACFFLG3                                                 08162000
@NM00014 EQU   RACFFLG3                                                 08163000
@NM00013 EQU   RACFFLG2                                                 08164000
RACFTRD  EQU   RACFFLG2                                                 08165000
RACFTUPD EQU   RACFFLG2                                                 08166000
RACFTCTL EQU   RACFFLG2                                                 08167000
@NM00012 EQU   RACFFLG2                                                 08168000
RACFTALT EQU   RACFFLG2                                                 08169000
RACFCSA  EQU   RACFFLG1                                                 08170000
RACFLOGN EQU   RACFFLG1                                                 08171000
RACFLOGF EQU   RACFFLG1                                                 08172000
@NM00011 EQU   RACFFLG1                                                 08173000
RACFDSTV EQU   RACFFLG1                                                 08174000
@NM00010 EQU   RACFFLG1                                                 08175000
ALLUNCNT EQU   ALLAGL+30                                                08176000
ALLVLCNT EQU   ALLAGL+29                                                08177000
@NM00009 EQU   ALLOPT                                                   08178000
ALLOPTUN EQU   ALLOPT                                                   08179000
ALLOPTDS EQU   ALLOPT                                                   08180000
@NM00008 EQU   ALLORG+1                                                 08181000
ALLORGVS EQU   ALLORG+1                                                 08182000
@NM00007 EQU   ALLORG+1                                                 08183000
ALLORGGS EQU   ALLORG+1                                                 08184000
ALLORGUN EQU   ALLORG                                                   08185000
ALLORGPO EQU   ALLORG                                                   08186000
ALLORGMQ EQU   ALLORG                                                   08187000
ALLORGCQ EQU   ALLORG                                                   08188000
ALLORGCX EQU   ALLORG                                                   08189000
ALLORGDA EQU   ALLORG                                                   08190000
ALLORGPS EQU   ALLORG                                                   08191000
ALLORGIS EQU   ALLORG                                                   08192000
ALLDSPUN EQU   ALLDSP                                                   08193000
ALLDSPCG EQU   ALLDSP                                                   08194000
ALLDSPDE EQU   ALLDSP                                                   08195000
ALLDSPKP EQU   ALLDSP                                                   08196000
@NM00006 EQU   ALLDSP                                                   08197000
ALLSTSOD EQU   ALLSTS                                                   08198000
ALLSTSMD EQU   ALLSTS                                                   08199000
ALLSTSNW EQU   ALLSTS                                                   08200000
ALLSTSSR EQU   ALLSTS                                                   08201000
@NM00005 EQU   ALLSTS                                                   08202000
ALLPWD   EQU   ALLAGL+20                                                08203000
ALLDSN   EQU   ALLAGL                                                   08204000
CIRPID   EQU   CIRAGL+28                                                08205000
CIRPWD   EQU   CIRAGL+24                                                08206000
CIRCAT   EQU   CIRAGL+20                                                08207000
CIRWKP   EQU   CIRAGL+16                                                08208000
CIRTLR   EQU   CIRAGL+12                                                08209000
CIRHDR   EQU   CIRAGL+8                                                 08210000
CIRTLN   EQU   CIRAGL+6                                                 08211000
CIRHLN   EQU   CIRAGL+4                                                 08212000
@NM00004 EQU   CIRAGL+1                                                 08213000
@NM00003 EQU   CIRTYPE                                                  08214000
CIRTYPAQ EQU   CIRTYPE                                                  08215000
CIRTYP1Q EQU   CIRTYPE                                                  08216000
NEWID1   EQU   TRACE1+95                                                08217000
CALLID   EQU   OLDERID1+90                                              08218000
@NM00002 EQU   OLDERID1                                                 08219000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08220000
@RF00438 EQU   @RC00431                                                 08221000
@RF00445 EQU   @RC00431                                                 08222000
@RC00513 EQU   @RC00512                                                 08223000
@RC00599 EQU   @RC00598                                                 08224000
@RC00639 EQU   @RC00631                                                 08225000
@RC00701 EQU   @RC00700                                                 08226000
@RF00887 EQU   @RC00846                                                 08227000
@RF01043 EQU   @RC01032                                                 08228000
@RC01129 EQU   @RC01125                                                 08229000
@RC01127 EQU   @RC01125                                                 08230000
@RC01171 EQU   @RC01169                                                 08231000
@RC01178 EQU   @RC01169                                                 08232000
@RC01332 EQU   @RC01331                                                 08233000
@RC01358 EQU   @RC01352                                                 08234000
@RC01353 EQU   @RC01352                                                 08235000
@RF01433 EQU   @RC01418                                                 08236000
@PB00014 EQU   @EL00001                                                 08237000
@RC00522 EQU   @RC00513                                                 08238000
@RC00520 EQU   @RC00513                                                 08239000
@RC00642 EQU   @RC00639                                                 08240000
@RC00640 EQU   @RC00639                                                 08241000
@RC00710 EQU   @RC00701                                                 08242000
@RC00708 EQU   @RC00701                                                 08243000
@PB00013 EQU   @PB00014                                                 08244000
@RF00529 EQU   @RC00522                                                 08245000
@RF00717 EQU   @RC00710                                                 08246000
@PB00012 EQU   @PB00013                                                 08247000
@PB00011 EQU   @PB00012                                                 08248000
@PB00010 EQU   @PB00011                                                 08249000
@PB00009 EQU   @PB00010                                                 08250000
@PB00008 EQU   @PB00009                                                 08251000
@PB00007 EQU   @PB00008                                                 08252000
@PB00006 EQU   @PB00007                                                 08253000
@PB00005 EQU   @PB00006                                                 08254000
@PB00004 EQU   @PB00005                                                 08255000
@PB00003 EQU   @PB00004                                                 08256000
@PB00002 EQU   @PB00003                                                 08257000
@ENDDATA EQU   *                                                        08258000
         END   IDCSD01,(C'PLS1913',0603,76306)                          08259000
