         TITLE '******* IDCSR01: STOREV FUNCTION SUPPORT ROUTINE ****  *00001000
                        '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCSR01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCSR01   76.100'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @08,0                                               0002 00021000
@PSTART  LA    @09,4095(,@08)                                      0002 00022000
         LA    @10,4095(,@09)                                      0002 00023000
         USING @PSTART,@08                                         0002 00024000
         USING @PSTART+4095,@09                                    0002 00025000
         USING @PSTART+8190,@10                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @12,@01                                             0002 00029000
         USING @DATD,@12                                           0002 00030000
         ST    @13,@SA00001+4                                      0002 00031000
         LM    @00,@01,20(@13)                                     0002 00032000
         ST    @12,8(,@13)                                         0002 00033000
         LR    @13,@12                                             0002 00034000
         MVC   @PC00001(12),0(@01)                                 0002 00035000
*   OLDERID2=NEWERID2;                                             0273 00036000
         L     @11,@PC00001                                        0273 00037000
         L     @15,GDTTR2(,@11)                                    0273 00038000
         MVC   @TS00001(95),NEWERID2(@15)                          0273 00039000
         MVC   OLDERID2(95,@15),@TS00001                           0273 00040000
*   NEWID2='SR01';                  /*                       @Y30LB31*/ 00041000
*                                                                  0274 00042000
         MVC   NEWID2(4,@15),@CC01332                              0274 00043000
*   /*****************************************************************/ 00044000
*   /*                                                               */ 00045000
*   /* TAKE A FULL REGION DUMP UPON ENTRY TO MODULE          @Y30LB31*/ 00046000
*   /*                                                               */ 00047000
*   /*****************************************************************/ 00048000
*                                                                  0275 00049000
*   IF GDTDBG=NULLPTR THEN                                         0275 00050000
         L     @11,GDTDBG(,@11)                                    0275 00051000
         LTR   @11,@11                                             0275 00052000
         BZ    @RT00275                                            0275 00053000
*     ;                                                            0276 00054000
*   ELSE                                                           0277 00055000
*     CALL IDCDB010(GDTTBL,'SRBG'); /*                       @Y30LB31*/ 00056000
*                                                                  0277 00057000
         L     @11,@PC00001                                        0277 00058000
         ST    @11,@AL00001                                        0277 00059000
         LA    @15,@CC01421                                        0277 00060000
         ST    @15,@AL00001+4                                      0277 00061000
         MVI   @AL00001+4,X'80'                                    0277 00062000
         L     @15,GDTDBG(,@11)                                    0277 00063000
         LA    @01,@AL00001                                        0277 00064000
         BALR  @14,@15                                             0277 00065000
*   /*****************************************************************/ 00066000
*   /*                                                               */ 00067000
*   /* SETUP ADDRESSABILITY TO THE ARGUMENT LISTS CONSTRUCTED BY     */ 00068000
*   /* STOREV. ZERO OUT THESE LISTS AND INITIALIZE THE HEADERS USED  */ 00069000
*   /* FOR DEBUGGING.                                        @Y30LB31*/ 00070000
*   /*                                                               */ 00071000
*   /*****************************************************************/ 00072000
*                                                                  0278 00073000
*   STORETBL=''B;                   /* INTERNAL TABLE        @Y30LB31*/ 00074000
@RT00275 XC    STORETBL(45),STORETBL                               0278 00075000
*   STOREHDR='STORETBL';            /*                       @Y30LB31*/ 00076000
         MVC   STOREHDR(8),@CC01423                                0279 00077000
*   MSVIVOL#=VOLVAL;                /*                       @Y30LB31*/ 00078000
         L     @11,@PC00001+4                                      0280 00079000
         L     @11,FDTPTR(,@11)                                    0280 00080000
         MVC   MSVIVOL#(6),VOLVAL(@11)                             0280 00081000
*   DDSTRU=ADDR(PRINTTBL);          /* PRINT ARGUMENT LIST   @Y30LB31*/ 00082000
         LA    @04,PRINTTBL                                        0281 00083000
         ST    @04,DDSTRU                                          0281 00084000
*   PRINTTBL=''B;                   /* ZERO PRINT ARG LIST   @Y30LB31*/ 00085000
         XC    PRINTTBL(20),PRINTTBL                               0282 00086000
*   PRINTHDR='DARGLIST';            /* PRINT ARG LIST ID     @Y30LB31*/ 00087000
         MVC   PRINTHDR(8),@CC01424                                0283 00088000
*   SVOLHDR='VOLREC';               /* VOL REC BUFFER ID     @Y30LB31*/ 00089000
         MVI   SVOLHDR+6,C' '                                      0284 00090000
         MVI   SVOLHDR+7,C' '                                      0284 00091000
         MVC   SVOLHDR(6),@CC01425                                 0284 00092000
*   SVOLREC=''B;                    /* ZERO OUT BUFFER       @Y30LB31*/ 00093000
         XC    SVOLREC(224),SVOLREC                                0285 00094000
*   BASEVPTR=ADDR(SVOLREC);         /* BASE VOL REC FORMAT   @Y30LB31*/ 00095000
         LA    BASEVPTR,SVOLREC                                    0286 00096000
*   SRALLTBL=''B;                   /* ZERO OUT ALLAGL       @Y30LB31*/ 00097000
         XC    SRALLTBL(31),SRALLTBL                               0287 00098000
*   SRALLHDR='ALLAGL';              /* ARG LIST IDENTIFIER   @Y30LB31*/ 00099000
         MVI   SRALLHDR+6,C' '                                     0288 00100000
         MVI   SRALLHDR+7,C' '                                     0288 00101000
         MVC   SRALLHDR(6),@CC01426                                0288 00102000
*   RESPECIFY                                                      0289 00103000
*     ALLAGL BASED(ADDR(SRALLTBL)); /*                       @Y30LB31*/ 00104000
*   RESPECIFY                                                      0290 00105000
*     MDAGL BASED(ADDR(SRMDAGL));   /*                       @Y30LB31*/ 00106000
*   SRMDAGL=''B;                    /* ZERO OUT MDAGL        @Y30LB31*/ 00107000
         XC    SRMDAGL(31),SRMDAGL                                 0291 00108000
*   RFY                                                            0292 00109000
*     EXCLAGL BASED(ADDR(SREXCLST));/*                       @YD00175*/ 00110000
*                                                                  0293 00111000
*   /*****************************************************************/ 00112000
*   /*                                                               */ 00113000
*   /* ENQUEUE ON THE VOLUME SERIAL NO. TO INSURE THE VOLUME RECORD  */ 00114000
*   /* IS NOT UPDATED DURING STOREV PROCESSING.              @Y30LB31*/ 00115000
*   /*                                                               */ 00116000
*   /*****************************************************************/ 00117000
*                                                                  0293 00118000
*   RNMLEN=LENGTH(RNAME);           /*                       @Y30LB31*/ 00119000
         MVI   RNMLEN,X'16'                                        0293 00120000
*   RNMTRAIL='.VIRTUAL.ENQUEUE';    /*                       @Y30LB31*/ 00121000
         MVC   RNMTRAIL(16),@CC01433                               0294 00122000
*   RNMSERNO=VOLVAL;                /*                       @Y30LB31*/ 00123000
         MVC   RNMSERNO(6),VOLVAL(@11)                             0295 00124000
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,MAJORNM,MINORNM);/*       @Y30LB31*/ 00125000
*                                                                  0296 00126000
         MVC   @AL00001+4(12),@AL00296                             0296 00127000
         L     @11,@PC00001                                        0296 00128000
         ST    @11,@AL00001                                        0296 00129000
         LA    @04,MINORNM                                         0296 00130000
         ST    @04,@AL00001+16                                     0296 00131000
         MVI   @AL00001+16,X'80'                                   0296 00132000
         L     @15,GDTENQ(,@11)                                    0296 00133000
         LA    @01,@AL00001                                        0296 00134000
         BALR  @14,@15                                             0296 00135000
*   /*****************************************************************/ 00136000
*   /*                                                               */ 00137000
*   /* CHECK OUT THE VOLUME TO BE DEACTIVATED.               @Y30LB31*/ 00138000
*   /*                                                               */ 00139000
*   /*****************************************************************/ 00140000
*                                                                  0297 00141000
*   CALL SETUPRTN;                  /*                       @Y30LB31*/ 00142000
         BAL   @14,SETUPRTN                                        0297 00143000
*   RESPECIFY                                                      0298 00144000
*     RTNREG RSTD;                                                 0298 00145000
*   TESTRC=RTNREG;                                                 0299 00146000
         LR    TESTRC,RTNREG                                       0299 00147000
*   RESPECIFY                                                      0300 00148000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 00149000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 00150000
         LTR   TESTRC,TESTRC                                       0301 00151000
         BZ    @RF00301                                            0301 00152000
*     LASTCOND=LASTCC12;            /*                       @Y30LB31*/ 00153000
*                                                                  0302 00154000
         L     @11,@PC00001+8                                      0302 00155000
         MVC   LASTCOND(2,@11),@CH00565                            0302 00156000
*   /*****************************************************************/ 00157000
*   /*                                                               */ 00158000
*   /* PROCEED WITH DEACTIVATE REQUEST IF NO CONFLICTS EXIST @Y30LB31*/ 00159000
*   /*                                                               */ 00160000
*   /*****************************************************************/ 00161000
*                                                                  0303 00162000
*   ELSE                            /*                       @Y30LB31*/ 00163000
*     DO;                           /*                       @Y30LB31*/ 00164000
         B     @RC00301                                            0303 00165000
@RF00301 DS    0H                                                  0304 00166000
*       CALL WORKRTN;               /*                       @Y30LB31*/ 00167000
         BAL   @14,WORKRTN                                         0304 00168000
*       RESPECIFY                                                  0305 00169000
*         RTNREG RSTD;                                             0305 00170000
*       TESTRC=RTNREG;                                             0306 00171000
         LR    TESTRC,RTNREG                                       0306 00172000
*       RESPECIFY                                                  0307 00173000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 00174000
*                                                                  0307 00175000
*       /*************************************************************/ 00176000
*       /*                                                           */ 00177000
*       /* SET THE FINAL CONDITION CODE TO 8 IF THE VOLUME WAS DEACT-*/ 00178000
*       /* IVATED BUT COULD NOT BE EJECTED. IF THE VOL COULD NOT BE  */ 00179000
*       /* DEACTIVATED, THE FINAL CODE IS 12.                @Y30LB31*/ 00180000
*       /*                                                           */ 00181000
*       /*************************************************************/ 00182000
*                                                                  0308 00183000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 00184000
         LTR   TESTRC,TESTRC                                       0308 00185000
         BZ    @RF00308                                            0308 00186000
*         IF TESTRC=LASTCC08 THEN   /*                       @Y30LB31*/ 00187000
         LA    @11,8                                               0309 00188000
         CR    TESTRC,@11                                          0309 00189000
         BNE   @RF00309                                            0309 00190000
*           LASTCOND=LASTCC08;      /*                       @Y30LB31*/ 00191000
         L     @15,@PC00001+8                                      0310 00192000
         STH   @11,LASTCOND(,@15)                                  0310 00193000
*         ELSE                      /*                       @Y30LB31*/ 00194000
*           LASTCOND=LASTCC12;      /*                       @Y30LB31*/ 00195000
         B     @RC00309                                            0311 00196000
@RF00309 L     @11,@PC00001+8                                      0311 00197000
         MVC   LASTCOND(2,@11),@CH00565                            0311 00198000
*     END;                          /*                       @Y30LB31*/ 00199000
*                                                                  0312 00200000
@RC00309 DS    0H                                                  0312 00201000
@RF00308 DS    0H                                                  0313 00202000
*   /*****************************************************************/ 00203000
*   /*                                                               */ 00204000
*   /* IF A UNIT WAS DYNAMICALLY ALLOCATED DURING PROCESSING         */ 00205000
*   /* DEALLOCATE IT.                                        @Y30LB31*/ 00206000
*   /*                                                               */ 00207000
*   /*****************************************************************/ 00208000
*                                                                  0313 00209000
*   IF ALLOCFLG=ON THEN             /*                       @Y30LB31*/ 00210000
@RC00301 TM    ALLOCFLG,B'00100000'                                0313 00211000
         BNO   @RF00313                                            0313 00212000
*     DO;                           /*                       @Y30LB31*/ 00213000
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Y30LB31*/ 00214000
         L     @11,@PC00001                                        0315 00215000
         ST    @11,@AL00001                                        0315 00216000
         LA    @02,SRALLTBL                                        0315 00217000
         ST    @02,@AL00001+4                                      0315 00218000
         MVI   @AL00001+4,X'80'                                    0315 00219000
         L     @15,GDTDLC(,@11)                                    0315 00220000
         LA    @01,@AL00001                                        0315 00221000
         BALR  @14,@15                                             0315 00222000
*       RESPECIFY                                                  0316 00223000
*         RTNREG RSTD;                                             0316 00224000
*       TESTRC=RTNREG;                                             0317 00225000
         LR    TESTRC,RTNREG                                       0317 00226000
*       RESPECIFY                                                  0318 00227000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 00228000
*                                                                  0318 00229000
*       /*************************************************************/ 00230000
*       /*                                                           */ 00231000
*       /* UPDATE THE FINAL CONDITION CODE ONLY IF UDEALLOC RETURN   */ 00232000
*       /* CODE IS HIGHER. IF UDEALLOC FAILED, THE RETURN CODE IS 4. */ 00233000
*       /*                                                   @Y30LB31*/ 00234000
*       /*                                                           */ 00235000
*       /*************************************************************/ 00236000
*                                                                  0319 00237000
*       LASTCOND=MAX(LASTCOND,TESTRC);/*                     @Y30LB31*/ 00238000
         L     @11,@PC00001+8                                      0319 00239000
         LH    @02,LASTCOND(,@11)                                  0319 00240000
         CR    @02,TESTRC                                          0319 00241000
         BNL   *+6                                                      00242000
         LR    @02,TESTRC                                          0319 00243000
         STH   @02,LASTCOND(,@11)                                  0319 00244000
*     END;                          /*                       @Y30LB31*/ 00245000
*                                                                  0320 00246000
*   /*****************************************************************/ 00247000
*   /*                                                               */ 00248000
*   /* IF A MINOR ERROR OCCURRED DURING PROCESSING BUT THE VOLUME WAS*/ 00249000
*   /* SUCESSFULLY ACTIVATED AND RELABELED, INSURE THE FINAL         */ 00250000
*   /* CONDITION CODE IS AT LEAST 4.                         @Y30LB31*/ 00251000
*   /*                                                               */ 00252000
*   /*****************************************************************/ 00253000
*                                                                  0321 00254000
*   IF CC04FLG=ON THEN              /*                       @Y30LB31*/ 00255000
@RF00313 TM    CC04FLG,B'10000000'                                 0321 00256000
         BNO   @RF00321                                            0321 00257000
*     LASTCOND=MAX(LASTCOND,LASTCC04);/*                     @Y30LB31*/ 00258000
*                                                                  0322 00259000
         L     @11,@PC00001+8                                      0322 00260000
         LH    @15,LASTCOND(,@11)                                  0322 00261000
         LA    @14,4                                               0322 00262000
         CR    @15,@14                                             0322 00263000
         BNL   *+6                                                      00264000
         LR    @15,@14                                             0322 00265000
         STH   @15,LASTCOND(,@11)                                  0322 00266000
*   /*****************************************************************/ 00267000
*   /*                                                               */ 00268000
*   /* RELEASE THE ENQUEUE ESTABLISHED AT THE START OF THE PROGRAM.  */ 00269000
*   /*                                                       @Y30LB31*/ 00270000
*   /*                                                               */ 00271000
*   /*****************************************************************/ 00272000
*                                                                  0323 00273000
*   RNMSERNO=VOLVAL;                /*                       @Y30LB31*/ 00274000
@RF00321 L     @11,@PC00001+4                                      0323 00275000
         L     @11,FDTPTR(,@11)                                    0323 00276000
         MVC   RNMSERNO(6),VOLVAL(@11)                             0323 00277000
*   RNMTRAIL='.VIRTUAL.ENQUEUE';    /*                       @ZA05138*/ 00278000
         MVC   RNMTRAIL(16),@CC01433                               0324 00279000
*   CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*                 @Y30LB31*/ 00280000
*                                                                  0325 00281000
         L     @11,@PC00001                                        0325 00282000
         ST    @11,@AL00001                                        0325 00283000
         LA    @15,@CC01366                                        0325 00284000
         ST    @15,@AL00001+4                                      0325 00285000
         LA    @15,MINORNM                                         0325 00286000
         ST    @15,@AL00001+8                                      0325 00287000
         MVI   @AL00001+8,X'80'                                    0325 00288000
         L     @15,GDTDEQ(,@11)                                    0325 00289000
         LA    @01,@AL00001                                        0325 00290000
         BALR  @14,@15                                             0325 00291000
*   /*****************************************************************/ 00292000
*   /*                                                               */ 00293000
*   /* ISSUE APPROPRIATE EOJ MESSAGE                         @Y30LB31*/ 00294000
*   /*                                                               */ 00295000
*   /*****************************************************************/ 00296000
*                                                                  0326 00297000
*   PRINTTBL=''B;                   /*                       @Y30LB31*/ 00298000
         XC    PRINTTBL(20),PRINTTBL                               0326 00299000
*   DARGSMOD=UNIVMSGS;              /*                       @Y30LB31*/ 00300000
         L     @11,DDSTRU                                          0327 00301000
         MVC   DARGSMOD(3,@11),@CC01402                            0327 00302000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB31*/ 00303000
         L     @15,@PC00001+8                                      0328 00304000
         ST    @15,DARGDBP(,@11)                                   0328 00305000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB31*/ 00306000
         MVC   DARGILP(2,@11),@CH00153                             0329 00307000
*   IF LASTCOND>LASTCC08 THEN       /*                       @Y30LB31*/ 00308000
         LH    @15,LASTCOND(,@15)                                  0330 00309000
         C     @15,@CF00179                                        0330 00310000
         BNH   @RF00330                                            0330 00311000
*     DARGSENT=MSG3003I;            /*                       @Y30LB31*/ 00312000
         MVI   DARGSENT(@11),X'03'                                 0331 00313000
*   ELSE                            /*                       @Y30LB31*/ 00314000
*     DARGSENT=MSG0001I;            /*                       @Y30LB31*/ 00315000
         B     @RC00330                                            0332 00316000
@RF00330 L     @11,DDSTRU                                          0332 00317000
         MVI   DARGSENT(@11),X'01'                                 0332 00318000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB31*/ 00319000
@RC00330 L     @11,@PC00001                                        0333 00320000
         ST    @11,@AL00001                                        0333 00321000
         LA    @15,@CF00115                                        0333 00322000
         ST    @15,@AL00001+4                                      0333 00323000
         LA    @15,DDSTRU                                          0333 00324000
         ST    @15,@AL00001+8                                      0333 00325000
         MVI   @AL00001+8,X'80'                                    0333 00326000
         L     @15,GDTPRT(,@11)                                    0333 00327000
         LA    @01,@AL00001                                        0333 00328000
         BALR  @14,@15                                             0333 00329000
*                                                                  0334 00330000
*   /*****************************************************************/ 00331000
*   /*                                                               */ 00332000
*   /* TAKE A FULL REGION DUMP UPON EXIT FROM MODULE.        @Y30LB31*/ 00333000
*   /*                                                               */ 00334000
*   /*****************************************************************/ 00335000
*                                                                  0334 00336000
*   IF GDTDBG=NULLPTR THEN                                         0334 00337000
         L     @11,@PC00001                                        0334 00338000
         L     @11,GDTDBG(,@11)                                    0334 00339000
         LTR   @11,@11                                             0334 00340000
         BZ    @RT00334                                            0334 00341000
*     ;                                                            0335 00342000
*   ELSE                                                           0336 00343000
*     CALL IDCDB010(GDTTBL,'SRND'); /*                       @Y30LB31*/ 00344000
*                                                                  0336 00345000
         L     @11,@PC00001                                        0336 00346000
         ST    @11,@AL00001                                        0336 00347000
         LA    @15,@CC01437                                        0336 00348000
         ST    @15,@AL00001+4                                      0336 00349000
         MVI   @AL00001+4,X'80'                                    0336 00350000
         L     @15,GDTDBG(,@11)                                    0336 00351000
         LA    @01,@AL00001                                        0336 00352000
         BALR  @14,@15                                             0336 00353000
*   /*****************************************************************/ 00354000
*   /*                                                               */ 00355000
*   /* RETURN TO THE AMS EXECUTIVE, PASSING THE FINAL CODE FROM      */ 00356000
*   /* STOREV.                                               @Y30LB31*/ 00357000
*   /*                                                               */ 00358000
*   /*****************************************************************/ 00359000
*                                                                  0337 00360000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0337 00361000
*                                                                  0337 00362000
@RT00334 L     @11,@PC00001                                        0337 00363000
         ST    @11,@AL00001                                        0337 00364000
         LA    @15,MODID                                           0337 00365000
         ST    @15,@AL00001+4                                      0337 00366000
         L     @15,@PC00001+8                                      0337 00367000
         ST    @15,@AL00001+8                                      0337 00368000
         MVI   @AL00001+8,X'80'                                    0337 00369000
         L     @15,GDTEPL(,@11)                                    0337 00370000
         LA    @01,@AL00001                                        0337 00371000
         BALR  @14,@15                                             0337 00372000
*   /*****************************************************************/ 00373000
*   /*                                                               */ 00374000
*   /*                                                       @Y30LB31*/ 00375000
*   /*                                                               */ 00376000
*   /*****************************************************************/ 00377000
*                                                                  0338 00378000
*                                                                  0338 00379000
*/********************************************************** @Y30LB31*/ 00380000
*/*                                                          @Y30LB31*/ 00381000
*/* PROCEDURE NAME - SETUPRTN                                @Y30LB31*/ 00382000
*/*                                                          @Y30LB31*/ 00383000
*/* FUNCTION - DIRECTS THE CHECKOUT OF USER SPECIFICATIONS   @Y30LB31*/ 00384000
*/*            FROM THE COMMAND STATEMENT AGAINST THE        @Y30LB31*/ 00385000
*/*            PRESENT STATUS OF THE VOL BEING DEACTIVATED.  @Y30LB31*/ 00386000
*/*            CALLS RVVIRTN TO RETRIEVE THE BASE VOLUME     @Y30LB31*/ 00387000
*/*            RECORD FROM THE INVENTORY.  CALLS VOLCKRTN    @Y30LB31*/ 00388000
*/*            TO CHECK THE RECORD FOR CONFLICTS WHICH       @Y30LB31*/ 00389000
*/*            PREVENT THE DEACTIVATE.  CALLS ALLOCRTN TO    @Y30LB31*/ 00390000
*/*            CHECK OUT THE UNIT REQUIREMENTS.  CALLS       @Y30LB31*/ 00391000
*/*            SECCKRTN TO HANDLE THE SECURITY CHECK OUT     @Y30LB31*/ 00392000
*/*            REQUIRED TO DEACTIVATE THE VOLUME.  NO        @Y30LB31*/ 00393000
*/*            MESSAGES ARE ISSUED BY THE PROC.              @Y30LB31*/ 00394000
*/*                                                          @Y30LB31*/ 00395000
*/* INPUT - NONE                                             @ZM32529*/ 00396000
*/*                                                          @Y30LB31*/ 00397000
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFULL VOLUME   @Y30LB31*/ 00398000
*/*          CHECKOUT.                                       @Y30LB31*/ 00399000
*/*          RETURN CODE OF 4 IF CHECKOUT FAILED AND         @Y30LB31*/ 00400000
*/*          CANNOT BE DEACTIVATED.                          @Y30LB31*/ 00401000
*/*                                                          @Y30LB31*/ 00402000
*/********************************************************** @Y30LB31*/ 00403000
*                                                                  0338 00404000
*SETUPRTN:                                                         0338 00405000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 00406000
*                                                                  0338 00407000
@EL00001 L     @13,4(,@13)                                         0338 00408000
@EF00001 L     @00,@SIZDATD                                        0338 00409000
         LR    @01,@12                                             0338 00410000
         FREEMAIN R,LV=(0),A=(1)                                        00411000
@ER00001 LM    @14,@12,12(@13)                                     0338 00412000
         BR    @14                                                 0338 00413000
SETUPRTN DS    0H                                                  0339 00414000
*   /*****************************************************************/ 00415000
*   /*                                                               */ 00416000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 00417000
*   /*                                                               */ 00418000
*   /*****************************************************************/ 00419000
*                                                                  0339 00420000
*   DCL                                                            0339 00421000
*     SETUPRC FIXED(15);            /*                       @Y30LB31*/ 00422000
*                                                                  0339 00423000
*   /*****************************************************************/ 00424000
*   /*                                                               */ 00425000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO SAVEAREA. */ 00426000
*   /* REG 14 WILL BE RESTORED UPON EXIT.                    @Y30LB31*/ 00427000
*   /*                                                               */ 00428000
*   /*****************************************************************/ 00429000
*                                                                  0340 00430000
*   RETADDR1=REG14;                 /*                       @Y30LB31*/ 00431000
         ST    REG14,RETADDR1                                      0340 00432000
*   OLDERID2=NEWERID2;                                             0341 00433000
         L     @11,@PC00001                                        0341 00434000
         L     @11,GDTTR2(,@11)                                    0341 00435000
         MVC   @TS00001(95),NEWERID2(@11)                          0341 00436000
         MVC   OLDERID2(95,@11),@TS00001                           0341 00437000
*   NEWID2='SRUP';                  /*                       @Y30LB31*/ 00438000
*                                                                  0342 00439000
         MVC   NEWID2(4,@11),@CC01442                              0342 00440000
*   /*****************************************************************/ 00441000
*   /*                                                               */ 00442000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN THIS        */ 00443000
*   /* PROCEDURE.                                            @Y30LB31*/ 00444000
*   /*                                                               */ 00445000
*   /*****************************************************************/ 00446000
*                                                                  0343 00447000
*   SETUPRC=LASTCC00;               /*                       @Y30LB31*/ 00448000
*                                                                  0343 00449000
         SLR   @11,@11                                             0343 00450000
         STH   @11,SETUPRC                                         0343 00451000
*   /*****************************************************************/ 00452000
*   /*                                                               */ 00453000
*   /* RETRIEVE THE BASE VOL RECORD FROM THE MSVI FOR THE VOLUME     */ 00454000
*   /* BEING DEACTIVATED.                                    @Y30LB31*/ 00455000
*   /*                                                               */ 00456000
*   /*****************************************************************/ 00457000
*                                                                  0344 00458000
*   CALL RVVIRTN;                   /*                       @Y30LB31*/ 00459000
         BAL   @14,RVVIRTN                                         0344 00460000
*   RESPECIFY                                                      0345 00461000
*     RTNREG RSTD;                                                 0345 00462000
*   TESTRC=RTNREG;                                                 0346 00463000
         LR    TESTRC,RTNREG                                       0346 00464000
*   RESPECIFY                                                      0347 00465000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 00466000
*                                                                  0347 00467000
*   /*****************************************************************/ 00468000
*   /*                                                               */ 00469000
*   /* EXIT FROM THIS PROC IF THE READ FAILED.               @Y30LB31*/ 00470000
*   /*                                                               */ 00471000
*   /*****************************************************************/ 00472000
*                                                                  0348 00473000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 00474000
         LTR   TESTRC,TESTRC                                       0348 00475000
         BZ    @RF00348                                            0348 00476000
*     SETUPRC=4;                    /*                       @Y30LB31*/ 00477000
*                                                                  0349 00478000
         MVC   SETUPRC(2),@CH00042                                 0349 00479000
*   /*****************************************************************/ 00480000
*   /*                                                               */ 00481000
*   /* CHECK THE VOL RECORD FOR CONFLICTS PROHIBITING THE DEACTIVATE.*/ 00482000
*   /*                                                       @Y30LB31*/ 00483000
*   /*                                                               */ 00484000
*   /*****************************************************************/ 00485000
*                                                                  0350 00486000
*   ELSE                            /*                       @Y30LB31*/ 00487000
*     DO;                           /*                       @Y30LB31*/ 00488000
         B     @RC00348                                            0350 00489000
@RF00348 DS    0H                                                  0351 00490000
*       CALL VOLCKRTN;              /*                       @Y30LB31*/ 00491000
         BAL   @14,VOLCKRTN                                        0351 00492000
*       RESPECIFY                                                  0352 00493000
*         RTNREG RSTD;                                             0352 00494000
*       TESTRC=RTNREG;                                             0353 00495000
         LR    TESTRC,RTNREG                                       0353 00496000
*       RESPECIFY                                                  0354 00497000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 00498000
*                                                                  0354 00499000
*       /*************************************************************/ 00500000
*       /*                                                           */ 00501000
*       /* EXIT FROM THIS PROC IF A CONFLICT EXISTS WHICH PROHIBITS  */ 00502000
*       /* THE DEACTIVATE.                                   @Y30LB31*/ 00503000
*       /*                                                           */ 00504000
*       /*************************************************************/ 00505000
*                                                                  0355 00506000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 00507000
         LTR   TESTRC,TESTRC                                       0355 00508000
         BZ    @RF00355                                            0355 00509000
*         SETUPRC=4;                /*                       @Y30LB31*/ 00510000
*                                                                  0356 00511000
         MVC   SETUPRC(2),@CH00042                                 0356 00512000
*       /*************************************************************/ 00513000
*       /*                                                           */ 00514000
*       /* VERIFY THAT UNIT ALLOCATION REQUIREMENTS HAVE BEEN MET.   */ 00515000
*       /*                                                   @Y30LB31*/ 00516000
*       /*                                                           */ 00517000
*       /*************************************************************/ 00518000
*                                                                  0357 00519000
*       ELSE                        /*                       @Y30LB31*/ 00520000
*         DO;                       /*                       @Y30LB31*/ 00521000
         B     @RC00355                                            0357 00522000
@RF00355 DS    0H                                                  0358 00523000
*           CALL ALLOCRTN;          /*                       @Y30LB31*/ 00524000
         BAL   @14,ALLOCRTN                                        0358 00525000
*           RESPECIFY                                              0359 00526000
*             RTNREG RSTD;                                         0359 00527000
*           TESTRC=RTNREG;                                         0360 00528000
         LR    TESTRC,RTNREG                                       0360 00529000
*           RESPECIFY                                              0361 00530000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 00531000
*                                                                  0361 00532000
*           /*********************************************************/ 00533000
*           /*                                                       */ 00534000
*           /* EXIT FROM THIS PROC IF THE UNIT ALLOCATION            */ 00535000
*           /* REQUIREMENTS WERE NOT MET.                    @Y30LB31*/ 00536000
*           /*                                                       */ 00537000
*           /*********************************************************/ 00538000
*                                                                  0362 00539000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 00540000
         LTR   TESTRC,TESTRC                                       0362 00541000
         BZ    @RF00362                                            0362 00542000
*             SETUPRC=4;            /*                       @Y30LB31*/ 00543000
*                                                                  0363 00544000
         MVC   SETUPRC(2),@CH00042                                 0363 00545000
*           /*********************************************************/ 00546000
*           /*                                                       */ 00547000
*           /* PERFORM THE APPROPRIATE SECURITY CHECKS REQUIRED TO   */ 00548000
*           /* DEACTIVATE THE VOLUME.                        @Y30LB31*/ 00549000
*           /*                                                       */ 00550000
*           /*********************************************************/ 00551000
*                                                                  0364 00552000
*           ELSE                    /*                       @Y30LB31*/ 00553000
*             DO;                   /*                       @Y30LB31*/ 00554000
         B     @RC00362                                            0364 00555000
@RF00362 DS    0H                                                  0365 00556000
*               CALL SECCKRTN;      /*                       @Y30LB31*/ 00557000
         BAL   @14,SECCKRTN                                        0365 00558000
*               RESPECIFY                                          0366 00559000
*                 RTNREG RSTD;                                     0366 00560000
*               TESTRC=RTNREG;                                     0367 00561000
         LR    TESTRC,RTNREG                                       0367 00562000
*               RESPECIFY                                          0368 00563000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 00564000
*                                                                  0368 00565000
*               /*****************************************************/ 00566000
*               /*                                                   */ 00567000
*               /* EXIT WITH AN ERROR RETURN CODE IF THE SECURITY    */ 00568000
*               /* CHECKS FAILED.                            @Y30LB31*/ 00569000
*               /*                                                   */ 00570000
*               /*****************************************************/ 00571000
*                                                                  0369 00572000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 00573000
         LTR   TESTRC,TESTRC                                       0369 00574000
         BZ    @RF00369                                            0369 00575000
*                 SETUPRC=4;        /*                       @Y30LB31*/ 00576000
         MVC   SETUPRC(2),@CH00042                                 0370 00577000
*             END;                  /*                       @Y30LB31*/ 00578000
@RF00369 DS    0H                                                  0372 00579000
*         END;                      /*                       @Y30LB31*/ 00580000
@RC00362 DS    0H                                                  0373 00581000
*     END;                          /*                       @Y30LB31*/ 00582000
*                                                                  0373 00583000
@RC00355 DS    0H                                                  0374 00584000
*   /*****************************************************************/ 00585000
*   /*                                                               */ 00586000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF CALLER AND EXIT FROM*/ 00587000
*   /* SETUPRTN, PASSING THE CONDITION CODE IN REG 15.       @Y30LB31*/ 00588000
*   /*                                                               */ 00589000
*   /*****************************************************************/ 00590000
*                                                                  0374 00591000
*   REG14=RETADDR1;                 /*                       @Y30LB31*/ 00592000
@RC00348 L     REG14,RETADDR1                                      0374 00593000
*   RETURN CODE(SETUPRC);           /*                       @Y30LB31*/ 00594000
         LH    @15,SETUPRC                                         0375 00595000
@EL00002 DS    0H                                                  0375 00596000
@EF00002 DS    0H                                                  0375 00597000
@ER00002 BR    @14                                                 0375 00598000
*   END SETUPRTN;                   /*                       @Y30LB31*/ 00599000
*                                                                  0377 00600000
*/*********************************************************  @Y30LB31*/ 00601000
*/*                                                          @Y30LB31*/ 00602000
*/* PROCEDURE NAME - RVVIRTN                                 @Y30LB31*/ 00603000
*/*                                                          @Y30LB31*/ 00604000
*/* FUNCTION - READS A BASE VOLUME RECORD.  CALLS SSCMSG     @Y30LB31*/ 00605000
*/*            TO OUTPUT ANY MSSC ERROR MESSAGES.            @Y30LB31*/ 00606000
*/*            MESSAGE IDC2080I MAY BE ISSUED.               @Y30LB31*/ 00607000
*/*                                                          @Y30LB31*/ 00608000
*/* INPUT - FDTTBL, VOLUME RECORD BUFFER, AND PRINTTBL       @Y30LB31*/ 00609000
*/*         FOR MESSAGE.                                     @ZM32529*/ 00610000
*/*                                                          @Y30LB31*/ 00611000
*/* OUTPUT - RETURN CODE OF 4 IF READ FAILED.  RETURN        @Y30LB31*/ 00612000
*/*          CODE OF 0 INDICATES SUCCESSFUL READ AND         @Y30LB31*/ 00613000
*/*          BUFFER CONTAINS THE RECORD.                     @Y30LB31*/ 00614000
*/*                                                          @Y30LB31*/ 00615000
*/*********************************************************  @Y30LB31*/ 00616000
*                                                                  0377 00617000
*RVVIRTN:                                                          0377 00618000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 00619000
*                                                                  0377 00620000
RVVIRTN  DS    0H                                                  0378 00621000
*   /*****************************************************************/ 00622000
*   /*                                                               */ 00623000
*   /* LOCAL CONDITION CODE.                                 @ZM32529*/ 00624000
*   /*                                                               */ 00625000
*   /*****************************************************************/ 00626000
*                                                                  0378 00627000
*   DCL                                                            0378 00628000
*     RVRTNRC FIXED(15);            /*                       @Y30LB31*/ 00629000
*                                                                  0378 00630000
*   /*****************************************************************/ 00631000
*   /*                                                               */ 00632000
*   /* SETUP LOCAL STORAGE AREA TO BUILD MSVC RVVI PARAMETER LIST TO */ 00633000
*   /* READ A RECORD FROM MSVI.                              @Y30LB31*/ 00634000
*   /*                                                               */ 00635000
*   /*****************************************************************/ 00636000
*                                                                  0379 00637000
*   DCL                                                            0379 00638000
*     1 SR01RVVI BDY(WORD),         /*                       @Y30LB31*/ 00639000
*      2 SRVVIHDR CHAR(8),          /* RVVI ARG LIST ID      @Y30LB31*/ 00640000
*      2 SRVVITBL CHAR(LENGTH(RVVI)) BDY(WORD);/*            @Y30LB31*/ 00641000
*                                                                  0380 00642000
*   /*****************************************************************/ 00643000
*   /*                                                               */ 00644000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO SAVEAREA. */ 00645000
*   /* REG 14 WILL BE RESTORED UPON EXIT.                    @Y30LB31*/ 00646000
*   /*                                                               */ 00647000
*   /*****************************************************************/ 00648000
*                                                                  0380 00649000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 00650000
         LR    RETADDR2,REG14                                      0380 00651000
*   OLDERID2=NEWERID2;                                             0381 00652000
         L     @11,@PC00001                                        0381 00653000
         L     @06,GDTTR2(,@11)                                    0381 00654000
         MVC   @TS00001(95),NEWERID2(@06)                          0381 00655000
         MVC   OLDERID2(95,@06),@TS00001                           0381 00656000
*   NEWID2='SRRV';                  /*                       @Y30LB31*/ 00657000
*                                                                  0382 00658000
         MVC   NEWID2(4,@06),@CC01454                              0382 00659000
*   /*****************************************************************/ 00660000
*   /*                                                               */ 00661000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN THIS        */ 00662000
*   /* PROCEDURE.                                            @Y30LB31*/ 00663000
*   /*                                                               */ 00664000
*   /*****************************************************************/ 00665000
*                                                                  0383 00666000
*   RVRTNRC=LASTCC00;               /*                       @Y30LB31*/ 00667000
*                                                                  0383 00668000
         SLR   @06,@06                                             0383 00669000
         LR    RVRTNRC,@06                                         0383 00670000
*   /*****************************************************************/ 00671000
*   /*                                                               */ 00672000
*   /* INITIALIZE MSVC READ PARM LIST.                       @Y30LB31*/ 00673000
*   /*                                                               */ 00674000
*   /*****************************************************************/ 00675000
*                                                                  0384 00676000
*   SRVVIHDR='RVVI';                /*                       @Y30LB31*/ 00677000
         MVI   SRVVIHDR+4,C' '                                     0384 00678000
         MVC   SRVVIHDR+5(3),SRVVIHDR+4                            0384 00679000
         MVC   SRVVIHDR(4),@CC01455                                0384 00680000
*   RVVIPTR=ADDR(SRVVITBL);         /*                       @Y30LB31*/ 00681000
         LA    @15,SRVVITBL                                        0385 00682000
         ST    @15,RVVIPTR                                         0385 00683000
*   RVVI=''B;                       /*                       @Y30LB31*/ 00684000
         XC    RVVI(68,@15),RVVI(@15)                              0386 00685000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB31*/ 00686000
         LH    @14,RVVLEN                                          0387 00687000
         ST    @14,RVVLNGTH(,@15)                                  0387 00688000
*   RVVCODE=RVVOP;                  /*                       @Y30LB31*/ 00689000
         MVI   RVVCODE(@15),X'87'                                  0388 00690000
*   RVVRDR=ON;                      /*                       @Y30LB31*/ 00691000
         OI    RVVRDR(@15),B'10000000'                             0389 00692000
*   RVVBVRCD=ON;                    /*                       @Y30LB31*/ 00693000
         OI    RVVBVRCD(@15),B'10000000'                           0390 00694000
*   RVVOLUME=VOLVAL;                /*                       @Y30LB31*/ 00695000
         L     @14,@PC00001+4                                      0391 00696000
         L     @01,FDTPTR(,@14)                                    0391 00697000
         MVC   RVVOLUME(6,@15),VOLVAL(@01)                         0391 00698000
*   RVVSVOL=ON;                     /*                       @Y30LB31*/ 00699000
         OI    RVVSVOL(@15),B'00000001'                            0392 00700000
*   RVVRTBUF=ADDR(SVOLREC);         /*                       @Y30LB31*/ 00701000
         LA    @14,SVOLREC                                         0393 00702000
         ST    @14,RVVRTBUF(,@15)                                  0393 00703000
*   RVVBUFLN=LENGTH(SVOLREC);       /*                       @Y30LB31*/ 00704000
*                                                                  0394 00705000
         MVC   RVVBUFLN(2,@15),@CH01699                            0394 00706000
*   /*****************************************************************/ 00707000
*   /*                                                               */ 00708000
*   /* TAKE A SYMBOLIC DUMP OF THE RVVI PARM LIST BEFORE THE READ.   */ 00709000
*   /*                                                       @Y30LB31*/ 00710000
*   /*                                                               */ 00711000
*   /*****************************************************************/ 00712000
*                                                                  0395 00713000
*   IF GDTDBG=NULLPTR THEN                                         0395 00714000
         C     @06,GDTDBG(,@11)                                    0395 00715000
         BE    @RT00395                                            0395 00716000
*     ;                                                            0396 00717000
*   ELSE                                                           0397 00718000
*     DO;                                                          0397 00719000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/ 00720000
         LA    DMPINDEX,DUMPLIST                                   0398 00721000
*       DMPITMNM='SR01RVVI';                                       0399 00722000
         MVC   DMPITMNM(8,DMPINDEX),@CC01456                       0399 00723000
*       DMPITMPT=ADDR(SR01RVVI);                                   0400 00724000
         LA    @11,SR01RVVI                                        0400 00725000
         ST    @11,DMPITMPT(,DMPINDEX)                             0400 00726000
*       DMPITMLN=LENGTH(SR01RVVI);                                 0401 00727000
         MVC   DMPITMLN(2,DMPINDEX),@CH01700                       0401 00728000
*       DMPITMTP='H';                                              0402 00729000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0402 00730000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0403 00731000
         AL    DMPINDEX,@CF00473                                   0403 00732000
*       DMPTRM=DMPTRMVL;                                           0404 00733000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0404 00734000
*     END;                          /*                       @Y30LB31*/ 00735000
*   IF GDTDBG=NULLPTR THEN                                         0406 00736000
@RT00395 L     @11,@PC00001                                        0406 00737000
         L     @11,GDTDBG(,@11)                                    0406 00738000
         LTR   @11,@11                                             0406 00739000
         BZ    @RT00406                                            0406 00740000
*     ;                                                            0407 00741000
*   ELSE                                                           0408 00742000
*     CALL IDCDB010(GDTTBL,'SRRD',ADDR(DUMPLIST));/*         @Y30LB31*/ 00743000
*                                                                  0408 00744000
         L     @11,@PC00001                                        0408 00745000
         ST    @11,@AL00001                                        0408 00746000
         LA    @06,@CC01458                                        0408 00747000
         ST    @06,@AL00001+4                                      0408 00748000
         LA    @06,DUMPLIST                                        0408 00749000
         ST    @06,@AFTEMPS                                        0408 00750000
         LA    @06,@AFTEMPS                                        0408 00751000
         ST    @06,@AL00001+8                                      0408 00752000
         MVI   @AL00001+8,X'80'                                    0408 00753000
         L     @15,GDTDBG(,@11)                                    0408 00754000
         LA    @01,@AL00001                                        0408 00755000
         BALR  @14,@15                                             0408 00756000
*   /*****************************************************************/ 00757000
*   /*                                                               */ 00758000
*   /* READ THE RECORD SPECIFIED IN THE RVVI PARM LIST.      @Y30LB31*/ 00759000
*   /*                                                               */ 00760000
*   /*****************************************************************/ 00761000
*                                                                  0409 00762000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASON);/*             @Y30LB31*/ 00763000
@RT00406 L     @11,@PC00001                                        0409 00764000
         ST    @11,@AL00001                                        0409 00765000
         LA    @06,VVIC                                            0409 00766000
         ST    @06,@AL00001+4                                      0409 00767000
         LA    @06,RVVIPTR                                         0409 00768000
         ST    @06,@AL00001+8                                      0409 00769000
         LA    @06,REASON                                          0409 00770000
         ST    @06,@AL00001+12                                     0409 00771000
         MVI   @AL00001+12,X'80'                                   0409 00772000
         L     @15,GDTSSC(,@11)                                    0409 00773000
         LA    @01,@AL00001                                        0409 00774000
         BALR  @14,@15                                             0409 00775000
*   RESPECIFY                                                      0410 00776000
*     RTNREG RSTD;                                                 0410 00777000
*   TESTRC=RTNREG;                                                 0411 00778000
         LR    TESTRC,RTNREG                                       0411 00779000
*   RESPECIFY                                                      0412 00780000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 00781000
*                                                                  0413 00782000
*   /*****************************************************************/ 00783000
*   /*                                                               */ 00784000
*   /* IF THE READ FAILED, PRINT A MESSAGE WITH THE MSVC REASON CODE.*/ 00785000
*   /* THEN PRINT AN ACCOMPANYING SECONDARY MSG IDC2080I INDICATING  */ 00786000
*   /* THE RECORD COULD NOT BE RETRIEVED.                    @Y30LB31*/ 00787000
*   /*                                                               */ 00788000
*   /*****************************************************************/ 00789000
*                                                                  0413 00790000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 00791000
         LTR   TESTRC,TESTRC                                       0413 00792000
         BZ    @RF00413                                            0413 00793000
*     DO;                           /*                       @Y30LB31*/ 00794000
*       RVRTNRC=4;                  /*                       @Y30LB31*/ 00795000
         LA    RVRTNRC,4                                           0415 00796000
*       CALL SSCMSG(REASON);        /* PRINT MSVC MSG        @Y30LB31*/ 00797000
         LA    @11,REASON                                          0416 00798000
         ST    @11,@AL00001                                        0416 00799000
         LA    @01,@AL00001                                        0416 00800000
         BAL   @14,SSCMSG                                          0416 00801000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 00802000
         XC    PRINTTBL(20),PRINTTBL                               0417 00803000
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/ 00804000
         L     @11,DDSTRU                                          0418 00805000
         MVC   DARGSMOD(3,@11),@CC01387                            0418 00806000
*       DARGSENT=MSG2080I;          /* STID = CM026          @Y30LB31*/ 00807000
         MVI   DARGSENT(@11),X'1A'                                 0419 00808000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB31*/ 00809000
         L     @06,@PC00001+4                                      0420 00810000
         L     @06,FDTPTR(,@06)                                    0420 00811000
         LA    @15,VOLVAL(,@06)                                    0420 00812000
         ST    @15,DARGDBP(,@11)                                   0420 00813000
*       DARGILP=VOLLEN;             /*                       @Y30LB31*/ 00814000
         SLR   @15,@15                                             0421 00815000
         IC    @15,VOLLEN(,@06)                                    0421 00816000
         STH   @15,DARGILP(,@11)                                   0421 00817000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 00818000
*                                                                  0422 00819000
         L     @11,@PC00001                                        0422 00820000
         ST    @11,@AL00001                                        0422 00821000
         LA    @06,@CF00115                                        0422 00822000
         ST    @06,@AL00001+4                                      0422 00823000
         LA    @06,DDSTRU                                          0422 00824000
         ST    @06,@AL00001+8                                      0422 00825000
         MVI   @AL00001+8,X'80'                                    0422 00826000
         L     @15,GDTPRT(,@11)                                    0422 00827000
         LA    @01,@AL00001                                        0422 00828000
         BALR  @14,@15                                             0422 00829000
*       /*************************************************************/ 00830000
*       /*                                                           */ 00831000
*       /* CLOSE DO GROUP THAT HANDLES READ FAILURE.         @Y30LB31*/ 00832000
*       /*                                                           */ 00833000
*       /*************************************************************/ 00834000
*                                                                  0423 00835000
*     END;                          /*                       @Y30LB31*/ 00836000
*                                                                  0423 00837000
*   /*****************************************************************/ 00838000
*   /*                                                               */ 00839000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF CALLER, VTYPERTN.   */ 00840000
*   /* EXIT FROM RVVIRTN PASSING CONDITION CODE IN REG 15.   @Y30LB31*/ 00841000
*   /*                                                               */ 00842000
*   /*****************************************************************/ 00843000
*                                                                  0424 00844000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 00845000
@RF00413 LR    REG14,RETADDR2                                      0424 00846000
*   RETURN CODE(RVRTNRC);           /*                       @Y30LB31*/ 00847000
         LR    @15,RVRTNRC                                         0425 00848000
@EL00003 DS    0H                                                  0425 00849000
@EF00003 DS    0H                                                  0425 00850000
@ER00003 BR    @14                                                 0425 00851000
*   END RVVIRTN;                    /*                       @Y30LB31*/ 00852000
*                                                                  0427 00853000
*/*********************************************************  @Y30LB31*/ 00854000
*/*                                                          @Y30LB31*/ 00855000
*/* PROCEDURE NAME - VOLCKRTN                                @Y30LB31*/ 00856000
*/*                                                          @Y30LB31*/ 00857000
*/* FUNCTION - CHECKS THE VOLUME RECORD FOR CONFLICTS THAT   @Y30LB31*/ 00858000
*/*            PROHIBIT DEACTIVATING THE VOLUME.  ISSUES     @Y30LB31*/ 00859000
*/*            MESSAGES IDC3730I, IDC3074I, IDC3097I,        @Y30LB31*/ 00860000
*/*            IDC3096I, IDC3095I, AND IDC3090I FOR THE      @Y30LB31*/ 00861000
*/*            PARTICULAR ERROR THAT EXISTS.                 @Y30LB31*/ 00862000
*/*                                                          @Y30LB31*/ 00863000
*/* INPUT - FDTTBL, DARGLIST, BASEV.                         @Y30LB31*/ 00864000
*/*                                                          @Y30LB31*/ 00865000
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL CHECKOUT  @Y30LB31*/ 00866000
*/*          RETURN CODE OF 4 INDICATES A CONFLICT EXISTS.   @Y30LB31*/ 00867000
*/*          VOLUME CANNOT BE DEACTIVATED.  APPROPRIATE MSGS @Y30LB31*/ 00868000
*/*          WERE ISSUED.                                    @Y30LB31*/ 00869000
*/*                                                          @Y30LB31*/ 00870000
*/*********************************************************  @Y30LB31*/ 00871000
*                                                                  0427 00872000
*VOLCKRTN:                                                         0427 00873000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 00874000
*                                                                  0427 00875000
VOLCKRTN DS    0H                                                  0428 00876000
*   /*****************************************************************/ 00877000
*   /*                                                               */ 00878000
*   /* LOCAL DECLARATIONS.                                   @Y30LB31*/ 00879000
*   /*                                                               */ 00880000
*   /*****************************************************************/ 00881000
*                                                                  0428 00882000
*   DCL                                                            0428 00883000
*     VOLCKRC FIXED(15);            /* LOCAL CONDITION CODE  @Y30LB31*/ 00884000
*   DCL                                                            0429 00885000
*     ZEROES BIT(16) CONSTANT('0000'X);/*                    @Y30LB31*/ 00886000
*                                                                  0429 00887000
*   /*****************************************************************/ 00888000
*   /*                                                               */ 00889000
*   /* SAVE CALLERS RETURN ADDR SINCE THERE IS NO SAVE AREA. REG 14  */ 00890000
*   /* WILL BE RESTORED UPON EXIT FROM THIS PROC.            @Y30LB31*/ 00891000
*   /*                                                               */ 00892000
*   /*****************************************************************/ 00893000
*                                                                  0430 00894000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 00895000
         LR    RETADDR2,REG14                                      0430 00896000
*   OLDERID2=NEWERID2;                                             0431 00897000
         L     @11,@PC00001                                        0431 00898000
         L     @06,GDTTR2(,@11)                                    0431 00899000
         MVC   @TS00001(95),NEWERID2(@06)                          0431 00900000
         MVC   OLDERID2(95,@06),@TS00001                           0431 00901000
*   NEWID2='SRVO';                  /*                       @Y30LB31*/ 00902000
*                                                                  0432 00903000
         MVC   NEWID2(4,@06),@CC01466                              0432 00904000
*   /*****************************************************************/ 00905000
*   /*                                                               */ 00906000
*   /* INITIALIZE TO ZERO THE COND CODE SET BY THIS PROC.    @Y30LB31*/ 00907000
*   /*                                                               */ 00908000
*   /*****************************************************************/ 00909000
*                                                                  0433 00910000
*   VOLCKRC=LASTCC00;               /*                       @Y30LB31*/ 00911000
*                                                                  0433 00912000
         SLR   VOLCKRC,VOLCKRC                                     0433 00913000
*   /*****************************************************************/ 00914000
*   /*                                                               */ 00915000
*   /* ISSUE AN ERROR MESSAGE AND EXIT FROM THIS PROCEDURE IF THE    */ 00916000
*   /* VOLUME TO BE ACTIVATED IS ALREADY INACTIVE.           @Y30LB31*/ 00917000
*   /*                                                               */ 00918000
*   /*****************************************************************/ 00919000
*                                                                  0434 00920000
*   IF BASINAC=ON THEN              /*                       @Y30LB31*/ 00921000
         TM    BASINAC(BASEVPTR),B'00000100'                       0434 00922000
         BNO   @RF00434                                            0434 00923000
*     DO;                           /*                       @Y30LB31*/ 00924000
*       VOLCKRC=4;                  /*                       @Y30LB31*/ 00925000
         LA    VOLCKRC,4                                           0436 00926000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 00927000
         XC    PRINTTBL(20),PRINTTBL                               0437 00928000
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/ 00929000
         L     @06,DDSTRU                                          0438 00930000
         MVC   DARGSMOD(3,@06),@CC01387                            0438 00931000
*       DARGSENT=MSG3074I;          /* STID = CM032          @Y30LB31*/ 00932000
         MVI   DARGSENT(@06),X'20'                                 0439 00933000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB31*/ 00934000
         L     @04,@PC00001+4                                      0440 00935000
         L     @04,FDTPTR(,@04)                                    0440 00936000
         LA    @02,VOLVAL(,@04)                                    0440 00937000
         ST    @02,DARGDBP(,@06)                                   0440 00938000
*       DARGILP=VOLLEN;             /*                       @Y30LB31*/ 00939000
         SLR   @02,@02                                             0441 00940000
         IC    @02,VOLLEN(,@04)                                    0441 00941000
         STH   @02,DARGILP(,@06)                                   0441 00942000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 00943000
         ST    @11,@AL00001                                        0442 00944000
         LA    @06,@CF00115                                        0442 00945000
         ST    @06,@AL00001+4                                      0442 00946000
         LA    @06,DDSTRU                                          0442 00947000
         ST    @06,@AL00001+8                                      0442 00948000
         MVI   @AL00001+8,X'80'                                    0442 00949000
         L     @15,GDTPRT(,@11)                                    0442 00950000
         LA    @01,@AL00001                                        0442 00951000
         BALR  @14,@15                                             0442 00952000
*     END;                          /*                       @Y30LB31*/ 00953000
*                                                                  0443 00954000
*   /*****************************************************************/ 00955000
*   /*                                                               */ 00956000
*   /* ISSUE AN ERROR MSG IF THE VOLUME IS FLAGGED FOR RECOVERY      */ 00957000
*   /* REASONS AS UNUSABLE. THEN EXIT FROM THIS PROCEDURE.   @Y30LB31*/ 00958000
*   /*                                                               */ 00959000
*   /*****************************************************************/ 00960000
*                                                                  0444 00961000
*   ELSE                            /*                       @Y30LB31*/ 00962000
*     IF BASSATIA^=ZEROES THEN      /*                       @Y30LB31*/ 00963000
         B     @RC00434                                            0444 00964000
@RF00434 CLC   BASSATIA(2,BASEVPTR),@CB01465                       0444 00965000
         BE    @RF00444                                            0444 00966000
*       DO;                         /*                       @Y30LB31*/ 00967000
*         PRINTTBL=''B;             /*                       @Y30LB31*/ 00968000
         XC    PRINTTBL(20),PRINTTBL                               0446 00969000
*         DARGSMOD=COMMSGS;         /*                       @Y30LB31*/ 00970000
         L     @11,DDSTRU                                          0447 00971000
         MVC   DARGSMOD(3,@11),@CC01387                            0447 00972000
*         DARGDBP=ADDR(VOLVAL);     /*                       @Y30LB31*/ 00973000
         L     @06,@PC00001+4                                      0448 00974000
         L     @06,FDTPTR(,@06)                                    0448 00975000
         LA    @04,VOLVAL(,@06)                                    0448 00976000
         ST    @04,DARGDBP(,@11)                                   0448 00977000
*         DARGILP=VOLLEN;           /*                       @Y30LB31*/ 00978000
*                                                                  0449 00979000
         SLR   @04,@04                                             0449 00980000
         IC    @04,VOLLEN(,@06)                                    0449 00981000
         STH   @04,DARGILP(,@11)                                   0449 00982000
*         /***********************************************************/ 00983000
*         /*                                                         */ 00984000
*         /* ISSUE MSG IDC3097I IF THE VOLUME IS INCOMPLETELY        */ 00985000
*         /* CREATED.                                        @Y30LB31*/ 00986000
*         /*                                                         */ 00987000
*         /***********************************************************/ 00988000
*                                                                  0450 00989000
*         IF BASIVCRE=ON THEN       /*                       @Y30LB31*/ 00990000
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0450 00991000
         BNO   @RF00450                                            0450 00992000
*           DO;                     /*                       @Y30LB31*/ 00993000
*             VOLCKRC=4;            /*                       @Y30LB31*/ 00994000
         LA    VOLCKRC,4                                           0452 00995000
*             DARGSENT=MSG3097I;    /* STID=CM03             @Y30LB31*/ 00996000
         MVI   DARGSENT(@11),X'03'                                 0453 00997000
*           END;                    /*                       @Y30LB31*/ 00998000
*                                                                  0454 00999000
*         /***********************************************************/ 01000000
*         /*                                                         */ 01001000
*         /* ISSUE MSG IDC3096I IF THE VOLUME IS AN INCOMPLETE COPY. */ 01002000
*         /*                                                 @Y30LB31*/ 01003000
*         /*                                                         */ 01004000
*         /***********************************************************/ 01005000
*                                                                  0455 01006000
*         ELSE                      /*                       @Y30LB31*/ 01007000
*           IF BASIVCPY=ON THEN     /*                       @Y30LB31*/ 01008000
         B     @RC00450                                            0455 01009000
@RF00450 TM    BASIVCPY(BASEVPTR),B'01000000'                      0455 01010000
         BNO   @RF00455                                            0455 01011000
*             DO;                   /*                       @Y30LB31*/ 01012000
*               VOLCKRC=4;          /*                       @Y30LB31*/ 01013000
         LA    VOLCKRC,4                                           0457 01014000
*               DARGSENT=MSG3096I;  /* STID=CM06             @Y30LB31*/ 01015000
         L     @11,DDSTRU                                          0458 01016000
         MVI   DARGSENT(@11),X'06'                                 0458 01017000
*             END;                  /*                       @Y30LB31*/ 01018000
*                                                                  0459 01019000
*         /***********************************************************/ 01020000
*         /*                                                         */ 01021000
*         /* ISSUE MSG IDC3095I IF THE VOLUME HAS A SERIAL MISMATCH  */ 01022000
*         /* AND A NEW SERIAL WAS NOT SPECIFIED.             @Y30LB31*/ 01023000
*         /*                                                         */ 01024000
*         /***********************************************************/ 01025000
*                                                                  0460 01026000
*           ELSE                    /*                       @Y30LB31*/ 01027000
*             IF BASVSMIS=ON&ADDR(NSER)=NULLPTR THEN/*       @Y30LB31*/ 01028000
         B     @RC00455                                            0460 01029000
@RF00455 TM    BASVSMIS(BASEVPTR),B'00100000'                      0460 01030000
         BNO   @RF00460                                            0460 01031000
         L     @11,@PC00001+4                                      0460 01032000
         L     @11,FDTPTR+4(,@11)                                  0460 01033000
         LTR   @11,@11                                             0460 01034000
         BNZ   @RF00460                                            0460 01035000
*               DO;                 /*                       @Y30LB31*/ 01036000
*                 VOLCKRC=4;        /*                       @Y30LB31*/ 01037000
         LA    VOLCKRC,4                                           0462 01038000
*                 DARGSENT=MSG3095I;/* STID=CM09             @Y30LB31*/ 01039000
         L     @11,DDSTRU                                          0463 01040000
         MVI   DARGSENT(@11),X'09'                                 0463 01041000
*               END;                /*                       @Y30LB31*/ 01042000
*                                                                  0464 01043000
*         /***********************************************************/ 01044000
*         /*                                                         */ 01045000
*         /* PRINT THE APPROPRIATE MESSAGE IF THE VOLUME IS FLAGGED  */ 01046000
*         /* FOR A CONDITION FROM WHICH ADDV CANNOT RECOVER. @Y30LB31*/ 01047000
*         /*                                                         */ 01048000
*         /***********************************************************/ 01049000
*                                                                  0465 01050000
*         IF DARGSENT^=0 THEN       /*                       @Y30LB31*/ 01051000
@RF00460 DS    0H                                                  0465 01052000
@RC00455 DS    0H                                                  0465 01053000
@RC00450 L     @11,DDSTRU                                          0465 01054000
         CLI   DARGSENT(@11),0                                     0465 01055000
         BE    @RF00465                                            0465 01056000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 01057000
         L     @11,@PC00001                                        0466 01058000
         ST    @11,@AL00001                                        0466 01059000
         LA    @06,@CF00115                                        0466 01060000
         ST    @06,@AL00001+4                                      0466 01061000
         LA    @06,DDSTRU                                          0466 01062000
         ST    @06,@AL00001+8                                      0466 01063000
         MVI   @AL00001+8,X'80'                                    0466 01064000
         L     @15,GDTPRT(,@11)                                    0466 01065000
         LA    @01,@AL00001                                        0466 01066000
         BALR  @14,@15                                             0466 01067000
*       END;                        /*                       @Y30LB31*/ 01068000
*     ELSE                          /*                       @Y30LB31*/ 01069000
*       DO;                         /*                       @Y30LB31*/ 01070000
*                                                                  0468 01071000
         B     @RC00444                                            0468 01072000
@RF00444 DS    0H                                                  0469 01073000
*         /***********************************************************/ 01074000
*         /*                                                         */ 01075000
*         /* ISSUE AN ERROR MSG IF A NEW VOLUME SERIAL NO. IS        */ 01076000
*         /* REQUESTED BUT THE VOLUME HAS COPIES.            @Y30LB31*/ 01077000
*         /*                                                         */ 01078000
*         /***********************************************************/ 01079000
*                                                                  0469 01080000
*         IF BASNCOPY^=0&           /*                       @Y30LB31*/ 01081000
*             ADDR(NSER)^=NULLPTR THEN/*                     @Y30LB31*/ 01082000
         CLI   BASNCOPY(BASEVPTR),0                                0469 01083000
         BE    @RF00469                                            0469 01084000
         L     @11,@PC00001+4                                      0469 01085000
         L     @06,FDTPTR+4(,@11)                                  0469 01086000
         LTR   @06,@06                                             0469 01087000
         BZ    @RF00469                                            0469 01088000
*           DO;                     /*                       @Y30LB31*/ 01089000
*             VOLCKRC=4;            /*                       @Y30LB31*/ 01090000
         LA    VOLCKRC,4                                           0471 01091000
*             PRINTTBL=''B;         /*                       @Y30LB31*/ 01092000
         XC    PRINTTBL(20),PRINTTBL                               0472 01093000
*             DARGSMOD=STORMSGS;    /*                       @Y30LB31*/ 01094000
         L     @06,DDSTRU                                          0473 01095000
         MVC   DARGSMOD(3,@06),@CC01378                            0473 01096000
*             DARGSENT=MSG3730I;    /* STID=SR01             @Y30LB31*/ 01097000
         MVI   DARGSENT(@06),X'01'                                 0474 01098000
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB31*/ 01099000
         L     @11,FDTPTR(,@11)                                    0475 01100000
         LA    @04,VOLVAL(,@11)                                    0475 01101000
         ST    @04,DARGDBP(,@06)                                   0475 01102000
*             DARGILP=VOLLEN;       /*                       @Y30LB31*/ 01103000
         SLR   @04,@04                                             0476 01104000
         IC    @04,VOLLEN(,@11)                                    0476 01105000
         STH   @04,DARGILP(,@06)                                   0476 01106000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB31*/ 01107000
         L     @11,@PC00001                                        0477 01108000
         ST    @11,@AL00001                                        0477 01109000
         LA    @06,@CF00115                                        0477 01110000
         ST    @06,@AL00001+4                                      0477 01111000
         LA    @06,DDSTRU                                          0477 01112000
         ST    @06,@AL00001+8                                      0477 01113000
         MVI   @AL00001+8,X'80'                                    0477 01114000
         L     @15,GDTPRT(,@11)                                    0477 01115000
         LA    @01,@AL00001                                        0477 01116000
         BALR  @14,@15                                             0477 01117000
*           END;                    /*                       @Y30LB31*/ 01118000
*                                                                  0478 01119000
*         /***********************************************************/ 01120000
*         /*                                                         */ 01121000
*         /* ISSUE AN ERROR MSG IF A NEW VOLUME SERIAL NO. IS        */ 01122000
*         /* REQUESTED BUT THE VOLUME IS READONLY.           @Y30LB31*/ 01123000
*         /*                                                         */ 01124000
*         /***********************************************************/ 01125000
*                                                                  0479 01126000
*         IF BASRONLY=ON&           /*                       @Y30LB31*/ 01127000
*             ADDR(NSER)^=NULLPTR THEN/*                     @Y30LB31*/ 01128000
@RF00469 TM    BASRONLY(BASEVPTR),B'01000000'                      0479 01129000
         BNO   @RF00479                                            0479 01130000
         L     @11,@PC00001+4                                      0479 01131000
         L     @06,FDTPTR+4(,@11)                                  0479 01132000
         LTR   @06,@06                                             0479 01133000
         BZ    @RF00479                                            0479 01134000
*           DO;                     /*                       @Y30LB31*/ 01135000
*             VOLCKRC=4;            /*                       @Y30LB31*/ 01136000
         LA    VOLCKRC,4                                           0481 01137000
*             PRINTTBL=''B;         /*                       @Y30LB31*/ 01138000
         XC    PRINTTBL(20),PRINTTBL                               0482 01139000
*             DARGSMOD=COMMSGS;     /*                       @Y30LB31*/ 01140000
         L     @06,DDSTRU                                          0483 01141000
         MVC   DARGSMOD(3,@06),@CC01387                            0483 01142000
*             DARGSENT=MSG3090I;    /* STID=CM016            @Y30LB31*/ 01143000
         MVI   DARGSENT(@06),X'10'                                 0484 01144000
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB31*/ 01145000
         L     @11,FDTPTR(,@11)                                    0485 01146000
         LA    @04,VOLVAL(,@11)                                    0485 01147000
         ST    @04,DARGDBP(,@06)                                   0485 01148000
*             DARGILP=VOLLEN;       /*                       @Y30LB31*/ 01149000
         SLR   @04,@04                                             0486 01150000
         IC    @04,VOLLEN(,@11)                                    0486 01151000
         STH   @04,DARGILP(,@06)                                   0486 01152000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB31*/ 01153000
         L     @11,@PC00001                                        0487 01154000
         ST    @11,@AL00001                                        0487 01155000
         LA    @06,@CF00115                                        0487 01156000
         ST    @06,@AL00001+4                                      0487 01157000
         LA    @06,DDSTRU                                          0487 01158000
         ST    @06,@AL00001+8                                      0487 01159000
         MVI   @AL00001+8,X'80'                                    0487 01160000
         L     @15,GDTPRT(,@11)                                    0487 01161000
         LA    @01,@AL00001                                        0487 01162000
         BALR  @14,@15                                             0487 01163000
*           END;                    /*                       @Y30LB31*/ 01164000
*       END;                        /*                       @Y30LB31*/ 01165000
*                                                                  0489 01166000
@RF00479 DS    0H                                                  0490 01167000
*   /*****************************************************************/ 01168000
*   /*                                                               */ 01169000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT */ 01170000
*   /* FROM VOLCKRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/ 01171000
*   /*                                                               */ 01172000
*   /*****************************************************************/ 01173000
*                                                                  0490 01174000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 01175000
@RC00444 DS    0H                                                  0490 01176000
@RC00434 LR    REG14,RETADDR2                                      0490 01177000
*   RETURN CODE(VOLCKRC);           /*                       @Y30LB31*/ 01178000
         LR    @15,VOLCKRC                                         0491 01179000
@EL00004 DS    0H                                                  0491 01180000
@EF00004 DS    0H                                                  0491 01181000
@ER00004 BR    @14                                                 0491 01182000
*   END VOLCKRTN;                   /*                       @Y30LB31*/ 01183000
*                                                                  0493 01184000
*/*********************************************************  @Y30LB31*/ 01185000
*/*                                                          @Y30LB31*/ 01186000
*/* PROCEDURE NAME - ALLOCRTN                                @Y30LB31*/ 01187000
*/*                                                          @Y30LB31*/ 01188000
*/* FUNCTION - IF FILE IS NOT SPECIFIED EITHER SELECTS       @YD00175*/ 01189000
*/*            AN EXCLUSIVE UNIT TO USE OR DYNAMICALLY       @YD00175*/ 01190000
*/*            ALLOCATES A UNIT. VERIFIES THAT THE UNIT IN   @YD00175*/ 01191000
*/*            THE FILE PARAMETER IS VIRTUAL.                @YD00175*/ 01192000
*/*            MESSAGE IDC3092I IS ISSUED BY THIS ROUTINE.   @Y30LB31*/ 01193000
*/*                                                          @Y30LB31*/ 01194000
*/* INPUT - FDTTBL, BASEV.                                   @Y30LB31*/ 01195000
*/*                                                          @Y30LB31*/ 01196000
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL ALLOC-    @Y30LB31*/ 01197000
*/*          TION AND CHECK OUT AND UPDATED STORETBL. RETURN @Y30LB31*/ 01198000
*/*          CODE OF 4 INDICATES DYNAMIC ALLOCATION FAILED   @Y30LB31*/ 01199000
*/*          OR THE UNIT NOT VIRTUAL OR UNIT COULD NOT       @YD00175*/ 01200000
*/*          BE OBTAINED FOR EXCLUSIVE USE                   @YD00175*/ 01201000
*/*                                                          @Y30LB31*/ 01202000
*/*********************************************************  @Y30LB31*/ 01203000
*                                                                  0493 01204000
*ALLOCRTN:                                                         0493 01205000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 01206000
*                                                                  0493 01207000
ALLOCRTN DS    0H                                                  0494 01208000
*   /*****************************************************************/ 01209000
*   /*                                                               */ 01210000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 01211000
*   /*                                                               */ 01212000
*   /*****************************************************************/ 01213000
*                                                                  0494 01214000
*   DCL                                                            0494 01215000
*     ALLOCRC FIXED(15);            /*                       @Y30LB31*/ 01216000
*                                                                  0494 01217000
*   /*****************************************************************/ 01218000
*   /*                                                               */ 01219000
*   /* SETUP STORAGE AREA TO BUILD CKAGL FOR UNIT CHECKOUT.  @Y30LB31*/ 01220000
*   /*                                                               */ 01221000
*   /*****************************************************************/ 01222000
*                                                                  0495 01223000
*   DCL                                                            0495 01224000
*     SRCKAGL CHAR(LENGTH(CKAGL)) BDY(WORD);/*               @Y30LB31*/ 01225000
*                                                                  0495 01226000
*   /*****************************************************************/ 01227000
*   /*                                                               */ 01228000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO SAVEAREA. */ 01229000
*   /* REG 14 WILL BE RESTORED UPON EXIT.                    @Y30LB31*/ 01230000
*   /*                                                               */ 01231000
*   /*****************************************************************/ 01232000
*                                                                  0496 01233000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 01234000
         LR    RETADDR2,REG14                                      0496 01235000
*   OLDERID2=NEWERID2;                                             0497 01236000
         L     @11,@PC00001                                        0497 01237000
         L     @06,GDTTR2(,@11)                                    0497 01238000
         MVC   @TS00001(95),NEWERID2(@06)                          0497 01239000
         MVC   OLDERID2(95,@06),@TS00001                           0497 01240000
*   NEWID2='SRAL';                  /*                       @Y30LB31*/ 01241000
*                                                                  0498 01242000
         MVC   NEWID2(4,@06),@CC01472                              0498 01243000
*   /*****************************************************************/ 01244000
*   /*                                                               */ 01245000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS PROCEDURE. */ 01246000
*   /*                                                       @Y30LB31*/ 01247000
*   /*                                                               */ 01248000
*   /*****************************************************************/ 01249000
*                                                                  0499 01250000
*   ALLOCRC=LASTCC00;               /*                       @Y30LB31*/ 01251000
*                                                                  0499 01252000
         SLR   @06,@06                                             0499 01253000
         LR    ALLOCRC,@06                                         0499 01254000
*   /*****************************************************************/ 01255000
*   /*                                                               */ 01256000
*   /* IF FILE IS NOT SPECIFIED, A UNIT CAN BE DYNAMICALLY ALLOCATED */ 01257000
*   /* IF THE VOLUME BEING DEACTIVATED IS NOT CURRENTLY FLAGGED DUE  */ 01258000
*   /* TO A PREVIOUS RENAME FAILURE. ISSUE ERROR MSG IDC3092I AND    */ 01259000
*   /* EXIT FROM THIS PROC IF THE UNIT CANNOT BE DYNAMICALLY         */ 01260000
*   /* ALLOCATED BECAUSE DEFERRED MOUNT IS REQUIRED FOR A VOL WITH A */ 01261000
*   /* LABEL MISMATCH.                                       @Y30LB31*/ 01262000
*   /*                                                               */ 01263000
*   /*****************************************************************/ 01264000
*                                                                  0500 01265000
*   IF ADDR(FILE)=NULLPTR&BASVSMIS=ON THEN/*                 @Y30LB31*/ 01266000
         L     @15,@PC00001+4                                      0500 01267000
         C     @06,FDTPTR+40(,@15)                                 0500 01268000
         BNE   @RF00500                                            0500 01269000
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0500 01270000
         BNO   @RF00500                                            0500 01271000
*     DO;                           /*                       @Y30LB31*/ 01272000
*       ALLOCRC=4;                  /*                       @Y30LB31*/ 01273000
         LA    ALLOCRC,4                                           0502 01274000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 01275000
         XC    PRINTTBL(20),PRINTTBL                               0503 01276000
*       DARGSMOD=COMMSGS;           /*                       @Y30LB31*/ 01277000
         L     @06,DDSTRU                                          0504 01278000
         MVC   DARGSMOD(3,@06),@CC01387                            0504 01279000
*       DARGSENT=MSG3092I;          /* STID=CM014            @Y30LB31*/ 01280000
         MVI   DARGSENT(@06),X'0E'                                 0505 01281000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 01282000
         ST    @11,@AL00001                                        0506 01283000
         LA    @06,@CF00115                                        0506 01284000
         ST    @06,@AL00001+4                                      0506 01285000
         LA    @06,DDSTRU                                          0506 01286000
         ST    @06,@AL00001+8                                      0506 01287000
         MVI   @AL00001+8,X'80'                                    0506 01288000
         L     @15,GDTPRT(,@11)                                    0506 01289000
         LA    @01,@AL00001                                        0506 01290000
         BALR  @14,@15                                             0506 01291000
*     END;                          /*                       @Y30LB31*/ 01292000
*   ELSE                            /*                       @Y30LB31*/ 01293000
*                                                                  0508 01294000
*     /***************************************************************/ 01295000
*     /*                                                             */ 01296000
*     /* IF THE FILE PARAMETER IS NOT SPECIFIED, TRY TO OBTAIN A UNIT*/ 01297000
*     /* FOR EXCLUSIVE USE. IF THAT FAILS, DYNAMICALLY ALLOCATE A    */ 01298000
*     /* UNIT.                                               @YD00175*/ 01299000
*     /*                                                             */ 01300000
*     /***************************************************************/ 01301000
*                                                                  0508 01302000
*     IF ADDR(FILE)=NULLPTR THEN    /*                       @Y30LB31*/ 01303000
         B     @RC00500                                            0508 01304000
@RF00500 L     @11,@PC00001+4                                      0508 01305000
         L     @06,FDTPTR+40(,@11)                                 0508 01306000
         LTR   @06,@06                                             0508 01307000
         BNZ   @RF00508                                            0508 01308000
*       DO;                         /*                       @Y30LB31*/ 01309000
*                                                                  0509 01310000
*         /***********************************************************/ 01311000
*         /*                                                         */ 01312000
*         /* SET UP THE PARAMETER LIST FOR UMSSUNIT          @YD00175*/ 01313000
*         /*                                                         */ 01314000
*         /***********************************************************/ 01315000
*                                                                  0510 01316000
*         EXCLAGL=''B;              /*                       @YD00175*/ 01317000
         LA    @06,SREXCLST                                        0510 01318000
         XC    EXCLAGL(23,@06),EXCLAGL(@06)                        0510 01319000
*         EXCLDDP=ADDR(SUNITDDN);   /*                       @YD00175*/ 01320000
         LA    @02,SUNITDDN                                        0511 01321000
         ST    @02,EXCLDDP(,@06)                                   0511 01322000
*         EXCLUCBP=ADDR(SUNITUCB);  /*                       @YD00175*/ 01323000
         LA    @02,SUNITUCB                                        0512 01324000
         ST    @02,EXCLUCBP(,@06)                                  0512 01325000
*         EXCLVOL=VOLVAL;           /*                       @YD00175*/ 01326000
*                                                                  0513 01327000
         L     @11,FDTPTR(,@11)                                    0513 01328000
         MVC   EXCLVOL(6,@06),VOLVAL(@11)                          0513 01329000
*         /***********************************************************/ 01330000
*         /*                                                         */ 01331000
*         /* ISSUE UMSSUNIT TO SELECT A UNIT FOR REUSE IF THE VOLUME */ 01332000
*         /* IS ALREADY ALLOCATED EXCLUSIVELY.               @YD00175*/ 01333000
*         /*                                                         */ 01334000
*         /***********************************************************/ 01335000
*                                                                  0514 01336000
*         CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*           @YD00175*/ 01337000
         L     @11,@PC00001                                        0514 01338000
         ST    @11,@AL00001                                        0514 01339000
         LA    @02,SELECTX                                         0514 01340000
         ST    @02,@AL00001+4                                      0514 01341000
         ST    @06,@AL00001+8                                      0514 01342000
         MVI   @AL00001+8,X'80'                                    0514 01343000
         L     @15,GDTUNT(,@11)                                    0514 01344000
         LA    @01,@AL00001                                        0514 01345000
         BALR  @14,@15                                             0514 01346000
*         RESPECIFY                                                0515 01347000
*           RTNREG RSTD;                                           0515 01348000
*         TESTRC=RTNREG;                                           0516 01349000
         LR    TESTRC,RTNREG                                       0516 01350000
*         RESPECIFY                                                0517 01351000
*           RTNREG UNRSTD;          /*                       @YD00175*/ 01352000
*                                                                  0517 01353000
*         /***********************************************************/ 01354000
*         /*                                                         */ 01355000
*         /* IF THE RETURN CODE IS NOT ZERO, EXIT PROC       @YD00175*/ 01356000
*         /*                                                         */ 01357000
*         /***********************************************************/ 01358000
*                                                                  0518 01359000
*         IF TESTRC>0 THEN                                         0518 01360000
         LTR   TESTRC,TESTRC                                       0518 01361000
         BNP   @RF00518                                            0518 01362000
*           ALLOCRC=LASTCC04;       /*                       @YD00175*/ 01363000
*                                                                  0519 01364000
         LA    ALLOCRC,4                                           0519 01365000
*         /***********************************************************/ 01366000
*         /*                                                         */ 01367000
*         /* IF NO ERROR BUT NO UCB RETURNED, DO DYNAMIC ALLOCATION. */ 01368000
*         /*                                                 @YD00175*/ 01369000
*         /*                                                         */ 01370000
*         /***********************************************************/ 01371000
*                                                                  0520 01372000
*         ELSE                      /*                       @YD00175*/ 01373000
*           IF SUNITUCB=0 THEN      /*                       @YD00175*/ 01374000
         B     @RC00518                                            0520 01375000
@RF00518 L     @11,SUNITUCB                                        0520 01376000
         LTR   @11,@11                                             0520 01377000
         BNZ   @RF00520                                            0520 01378000
*             DO;                   /*                       @YD00175*/ 01379000
*               ALLOPTVL=ON;        /*                       @Y30LB31*/ 01380000
         LA    @11,SRALLTBL                                        0522 01381000
         OI    ALLOPTVL(@11),B'10000000'                           0522 01382000
*               ALLVLCNT=1;         /*                       @YD00175*/ 01383000
         MVI   ALLVLCNT(@11),X'01'                                 0523 01384000
*               ALLUNCNT=1;         /*                       @Y30LB31*/ 01385000
         MVI   ALLUNCNT(@11),X'01'                                 0524 01386000
*               ALLOPTPV=ON;        /*                       @Y30LB31*/ 01387000
         OI    ALLOPTPV(@11),B'00100000'                           0525 01388000
*               ALLULP=ADDR(SUNITLST);/*                     @Y30LB31*/ 01389000
         LA    @06,SUNITLST                                        0526 01390000
         ST    @06,ALLULP(,@11)                                    0526 01391000
*               SUNITCNT=1;         /*                       @Y30LB31*/ 01392000
         LA    @06,1                                               0527 01393000
         STH   @06,SUNITCNT                                        0527 01394000
*               SUNITLEN=LENGTH(DEV3330V);/*                 @Y30LB31*/ 01395000
         MVC   SUNITLEN(2),@CH00430                                0528 01396000
*               SUNITVAL=DEV3330V;  /*                       @Y30LB31*/ 01397000
         MVI   SUNITVAL+5,C' '                                     0529 01398000
         MVC   SUNITVAL+6(2),SUNITVAL+5                            0529 01399000
         MVC   SUNITVAL(5),@CC01354                                0529 01400000
*               ALLVLP=ADDR(SVOLLST);/*                      @Y30LB31*/ 01401000
         LA    @02,SVOLLST                                         0530 01402000
         ST    @02,ALLVLP(,@11)                                    0530 01403000
*               SERCNT=1;           /*                       @Y30LB31*/ 01404000
         STH   @06,SERCNT                                          0531 01405000
*               SERLEN=VOLLEN;      /*                       @Y30LB31*/ 01406000
         L     @06,@PC00001+4                                      0532 01407000
         L     @06,FDTPTR(,@06)                                    0532 01408000
         SLR   @02,@02                                             0532 01409000
         IC    @02,VOLLEN(,@06)                                    0532 01410000
         STH   @02,SERLEN                                          0532 01411000
*               SERNO=VOLVAL;       /*                       @Y30LB31*/ 01412000
         MVC   SERNO(6),VOLVAL(@06)                                0533 01413000
*               CALL IDCSAAL0(GDTTBL,ALLAGL);/*              @Y30LB31*/ 01414000
         L     @06,@PC00001                                        0534 01415000
         ST    @06,@AL00001                                        0534 01416000
         ST    @11,@AL00001+4                                      0534 01417000
         MVI   @AL00001+4,X'80'                                    0534 01418000
         L     @15,GDTALC(,@06)                                    0534 01419000
         LA    @01,@AL00001                                        0534 01420000
         BALR  @14,@15                                             0534 01421000
*               RESPECIFY                                          0535 01422000
*                 RTNREG RSTD;                                     0535 01423000
*               TESTRC=RTNREG;                                     0536 01424000
         LR    TESTRC,RTNREG                                       0536 01425000
*               RESPECIFY                                          0537 01426000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 01427000
*                                                                  0537 01428000
*               /*****************************************************/ 01429000
*               /*                                                   */ 01430000
*               /* TEST RETURN CODE FROM DYNAMIC ALLOCATION REQUEST  */ 01431000
*               /* AND EXIT FROM THIS PROC IF DYNAMIC ALLOCATION     */ 01432000
*               /* FAILED.                                   @Y30LB31*/ 01433000
*               /*                                                   */ 01434000
*               /*****************************************************/ 01435000
*                                                                  0538 01436000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 01437000
         LTR   TESTRC,TESTRC                                       0538 01438000
         BZ    @RF00538                                            0538 01439000
*                 ALLOCRC=4;        /*                       @Y30LB31*/ 01440000
*                                                                  0539 01441000
         LA    ALLOCRC,4                                           0539 01442000
*               /*****************************************************/ 01443000
*               /*                                                   */ 01444000
*               /* SAVE THE DDNAME OF THE DYNAMICALLY ALLOCATED UNIT */ 01445000
*               /* AND SET AN INDICATOR FOR UDEALLOC AT EOJ. @Y30LB31*/ 01446000
*               /*                                                   */ 01447000
*               /*****************************************************/ 01448000
*                                                                  0540 01449000
*               ELSE                /*                       @Y30LB31*/ 01450000
*                 DO;               /*                       @Y30LB31*/ 01451000
         B     @RC00538                                            0540 01452000
@RF00538 DS    0H                                                  0541 01453000
*                   ALLOCFLG=ON;    /*                       @Y30LB31*/ 01454000
         OI    ALLOCFLG,B'00100000'                                0541 01455000
*                   SUNITDDN=ALLDDN;/*                       @Y30LB31*/ 01456000
         LA    @11,SRALLTBL                                        0542 01457000
         MVC   SUNITDDN(8),ALLDDN(@11)                             0542 01458000
*                 END;              /*                       @Y30LB31*/ 01459000
*                                                                  0543 01460000
*               /*****************************************************/ 01461000
*               /*                                                   */ 01462000
*               /* CLOSE DO GROUP FOR DYNAMIC ALLOCATION.    @Y30LB31*/ 01463000
*               /*                                                   */ 01464000
*               /*****************************************************/ 01465000
*                                                                  0544 01466000
*             END;                  /*                       @Y30LB31*/ 01467000
*       END;                        /*                       @YD00175*/ 01468000
*                                                                  0545 01469000
*   /*****************************************************************/ 01470000
*   /*                                                               */ 01471000
*   /* DYNAMIC ALLOCATION IS NOT REQUIRED. SAVE THE DDNAME OF THE    */ 01472000
*   /* UNIT OBTAINED VIA THE FILE PARM.                      @Y30LB31*/ 01473000
*   /*                                                               */ 01474000
*   /*****************************************************************/ 01475000
*                                                                  0546 01476000
*     ELSE                          /*                       @Y30LB31*/ 01477000
*       SUNITDDN=FILEVAL;           /*                       @Y30LB31*/ 01478000
         B     @RC00508                                            0546 01479000
@RF00508 L     @11,@PC00001+4                                      0546 01480000
         L     @11,FDTPTR+40(,@11)                                 0546 01481000
         MVC   SUNITDDN(8),FILEVAL(@11)                            0546 01482000
*                                                                  0547 01483000
*   /*****************************************************************/ 01484000
*   /*                                                               */ 01485000
*   /* IF FILE KEYWORD WAS SPECIFIED, SETUP CKAGL TO VERIFY THAT THE */ 01486000
*   /* DEVICE IS VIRTUAL.                                    @YD00175*/ 01487000
*   /*                                                               */ 01488000
*   /*****************************************************************/ 01489000
*                                                                  0547 01490000
*   IF ALLOCRC=0&ADDR(FILE)>NULLPTR THEN/*                   @YD00175*/ 01491000
@RC00508 DS    0H                                                  0547 01492000
@RC00500 SLR   @11,@11                                             0547 01493000
         CR    ALLOCRC,@11                                         0547 01494000
         BNE   @RF00547                                            0547 01495000
         L     @06,@PC00001+4                                      0547 01496000
         C     @11,FDTPTR+40(,@06)                                 0547 01497000
         BNL   @RF00547                                            0547 01498000
*     DO;                           /*                       @YD00175*/ 01499000
*       RESPECIFY                                                  0549 01500000
*         CKAGL BASED(ADDR(SRCKAGL));/*                      @Y30LB31*/ 01501000
*       CKAGL=''B;                  /*                       @Y30LB31*/ 01502000
         LA    @06,SRCKAGL                                         0550 01503000
         XC    CKAGL(29,@06),CKAGL(@06)                            0550 01504000
*       CKTESTVT=ON;                /*                       @Y30LB31*/ 01505000
         OI    CKTESTVT(@06),B'10000000'                           0551 01506000
*       CKDDNAME=SUNITDDN;          /*                       @Y30LB31*/ 01507000
         MVC   CKDDNAME(8,@06),SUNITDDN                            0552 01508000
*       CKUCBPTR=ADDR(SUNITUCB);    /* RETURNED BY UMSSUNIT  @Y30LB31*/ 01509000
*                                                                  0553 01510000
         LA    @15,SUNITUCB                                        0553 01511000
         ST    @15,CKUCBPTR(,@06)                                  0553 01512000
*       /*************************************************************/ 01513000
*       /*                                                           */ 01514000
*       /* TAKE A SYMBOLIC DUMP OF CKAGL BEFORE CHECKING OUT THE     */ 01515000
*       /* UNIT.                                             @Y30LB31*/ 01516000
*       /*                                                           */ 01517000
*       /*************************************************************/ 01518000
*                                                                  0554 01519000
*       IF GDTDBG=NULLPTR THEN                                     0554 01520000
         L     @06,@PC00001                                        0554 01521000
         C     @11,GDTDBG(,@06)                                    0554 01522000
         BE    @RT00554                                            0554 01523000
*         ;                                                        0555 01524000
*       ELSE                                                       0556 01525000
*         DO;                                                      0556 01526000
*           DMPINDEX=ADDR(DUMPLIST);/*                       @Y30LB31*/ 01527000
         LA    DMPINDEX,DUMPLIST                                   0557 01528000
*           DMPITMNM='SRCKAGL';                                    0558 01529000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0558 01530000
         MVC   DMPITMNM(7,DMPINDEX),@CC01475                       0558 01531000
*           DMPITMPT=ADDR(SRCKAGL);                                0559 01532000
         LA    @11,SRCKAGL                                         0559 01533000
         ST    @11,DMPITMPT(,DMPINDEX)                             0559 01534000
*           DMPITMLN=LENGTH(CKAGL);                                0560 01535000
         MVC   DMPITMLN(2,DMPINDEX),@CH00810                       0560 01536000
*           DMPITMTP='H';                                          0561 01537000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0561 01538000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0562 01539000
*                                                                  0562 01540000
         AL    DMPINDEX,@CF00473                                   0562 01541000
*           /*********************************************************/ 01542000
*           /*                                                       */ 01543000
*           /*                                               @Y30LB31*/ 01544000
*           /*                                                       */ 01545000
*           /*********************************************************/ 01546000
*                                                                  0563 01547000
*           DMPTRM=DMPTRMVL;                                       0563 01548000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0563 01549000
*         END;                      /*                       @Y30LB31*/ 01550000
*       IF GDTDBG=NULLPTR THEN                                     0565 01551000
@RT00554 L     @11,@PC00001                                        0565 01552000
         L     @11,GDTDBG(,@11)                                    0565 01553000
         LTR   @11,@11                                             0565 01554000
         BZ    @RT00565                                            0565 01555000
*         ;                                                        0566 01556000
*       ELSE                                                       0567 01557000
*         CALL IDCDB010(GDTTBL,'SRCK',ADDR(DUMPLIST));/*     @Y30LB31*/ 01558000
*                                                                  0567 01559000
         L     @11,@PC00001                                        0567 01560000
         ST    @11,@AL00001                                        0567 01561000
         LA    @06,@CC01476                                        0567 01562000
         ST    @06,@AL00001+4                                      0567 01563000
         LA    @06,DUMPLIST                                        0567 01564000
         ST    @06,@AFTEMPS+4                                      0567 01565000
         LA    @06,@AFTEMPS+4                                      0567 01566000
         ST    @06,@AL00001+8                                      0567 01567000
         MVI   @AL00001+8,X'80'                                    0567 01568000
         L     @15,GDTDBG(,@11)                                    0567 01569000
         LA    @01,@AL00001                                        0567 01570000
         BALR  @14,@15                                             0567 01571000
*       /*************************************************************/ 01572000
*       /*                                                           */ 01573000
*       /* PERFORM THE UNIT CHECK OUT.                       @Y30LB31*/ 01574000
*       /*                                                           */ 01575000
*       /*************************************************************/ 01576000
*                                                                  0568 01577000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB31*/ 01578000
@RT00565 L     @11,@PC00001                                        0568 01579000
         ST    @11,@AL00001                                        0568 01580000
         LA    @06,CHECK                                           0568 01581000
         ST    @06,@AL00001+4                                      0568 01582000
         LA    @06,SRCKAGL                                         0568 01583000
         ST    @06,@AL00001+8                                      0568 01584000
         MVI   @AL00001+8,X'80'                                    0568 01585000
         L     @15,GDTUNT(,@11)                                    0568 01586000
         LA    @01,@AL00001                                        0568 01587000
         BALR  @14,@15                                             0568 01588000
*       RESPECIFY                                                  0569 01589000
*         RTNREG RSTD;                                             0569 01590000
*       TESTRC=RTNREG;                                             0570 01591000
         LR    TESTRC,RTNREG                                       0570 01592000
*       RESPECIFY                                                  0571 01593000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 01594000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 01595000
         LTR   TESTRC,TESTRC                                       0572 01596000
         BZ    @RF00572                                            0572 01597000
*         ALLOCRC=4;                /*                       @Y30LB31*/ 01598000
         LA    ALLOCRC,4                                           0573 01599000
*     END;                          /*                       @Y30LB31*/ 01600000
*                                                                  0574 01601000
@RF00572 DS    0H                                                  0575 01602000
*   /*****************************************************************/ 01603000
*   /*                                                               */ 01604000
*   /* RESTORE REG 14 WITH THE RETURN ADDR OF CALLER. EXIT FROM      */ 01605000
*   /* ALLOCRTN PASSING THE COND CODE IN REG 15.             @Y30LB31*/ 01606000
*   /*                                                               */ 01607000
*   /*****************************************************************/ 01608000
*                                                                  0575 01609000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 01610000
@RF00547 LR    REG14,RETADDR2                                      0575 01611000
*   RETURN CODE(ALLOCRC);           /*                       @Y30LB31*/ 01612000
         LR    @15,ALLOCRC                                         0576 01613000
@EL00005 DS    0H                                                  0576 01614000
@EF00005 DS    0H                                                  0576 01615000
@ER00005 BR    @14                                                 0576 01616000
*   END ALLOCRTN;                   /*                       @Y30LB31*/ 01617000
*                                                                  0578 01618000
*/*********************************************************  @Y30LB31*/ 01619000
*/*                                                          @Y30LB31*/ 01620000
*/* PROCEDURE NAME - SECCKRTN                                @Y30LB31*/ 01621000
*/*                                                          @Y30LB31*/ 01622000
*/* FUNCTION - DIRECTS THE VSAM AND SECURITY CHECK REQUIRED  @Y30LB31*/ 01623000
*/*            BEFORE DEACTIVATING THE VOLUME AND            @Y30LB31*/ 01624000
*/*            OPTIONALLY CHANGING THE VOL SERIAL NUMBER.    @YD00175*/ 01625000
*/*            OBTAINS EXCLUSIVE USE OF THE VOLUME AND CALLS @YD00175*/ 01626000
*/*            VPREPRTN TO MOUNT THE VOL IF THE VOL ALREADY  @Y30LB31*/ 01627000
*/*            HAS A VOL SERIAL MISMATCH.  CALLS VTOCKRTN TO @Y30LB31*/ 01628000
*/*            PERFORM THE VTOC SECURITY AND VSAM CHECKS     @Y30LB31*/ 01629000
*/*            UNLESS THE SECURITY CHECK MUST BE BYPASSED    @Y30LB31*/ 01630000
*/*            BECAUSE THE ORIGINAL VOL SERIAL NO. IS BEING  @Y30LB31*/ 01631000
*/*            RESTORED DUE TO A PREVIOUS RENAME FAILURE.    @Y30LB31*/ 01632000
*/*            OBTAINS EXCLUSIVE CONTROL OF THE VOLUME       @YD00175*/ 01633000
*/*            AFTER THE SECURITY CHECK.                     @YD00175*/ 01634000
*/*            NO MSGS ARE ISSUED BY THIS PROC.              @Y30LB31*/ 01635000
*/*                                                          @Y30LB31*/ 01636000
*/* INPUT - FDTTBL, STOREVTBL, BASEV VOLUME RECORD.          @ZM32529*/ 01637000
*/*                                                          @Y30LB31*/ 01638000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES THE SECURITY CHECK @Y30LB31*/ 01639000
*/*          FOR A BASE VOL WAS SUCCESSFUL.                  @Y30LB31*/ 01640000
*/*          A RETURN CODE OF 4 INDICATES THE VOL COULD NOT  @Y30LB31*/ 01641000
*/*          BE MOUNTED FOR THE VTOC CHECK OR THAT THE VTOC  @Y30LB31*/ 01642000
*/*          CHECK WAS UNSUCCESSFUL, OR THE VOLUME COULD     @YD00175*/ 01643000
*/*          NOT BE OBTAINED FOR EXCLUSIVE CONTROL           @YD00175*/ 01644000
*/*                                                          @Y30LB31*/ 01645000
*/*********************************************************  @Y30LB31*/ 01646000
*                                                                  0578 01647000
*SECCKRTN:                                                         0578 01648000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 01649000
*                                                                  0578 01650000
SECCKRTN DS    0H                                                  0579 01651000
*   /*****************************************************************/ 01652000
*   /*                                                               */ 01653000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 01654000
*   /*                                                               */ 01655000
*   /*****************************************************************/ 01656000
*                                                                  0579 01657000
*   DCL                                                            0579 01658000
*     SECCKRC FIXED(15);            /*                       @Y30LB31*/ 01659000
*                                                                  0579 01660000
*   /*****************************************************************/ 01661000
*   /*                                                               */ 01662000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE UPON EXIT @Y30LB31*/ 01663000
*   /*                                                               */ 01664000
*   /*****************************************************************/ 01665000
*                                                                  0580 01666000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 01667000
         LR    RETADDR2,REG14                                      0580 01668000
*   OLDERID2=NEWERID2;                                             0581 01669000
         L     @11,@PC00001                                        0581 01670000
         L     @11,GDTTR2(,@11)                                    0581 01671000
         MVC   @TS00001(95),NEWERID2(@11)                          0581 01672000
         MVC   OLDERID2(95,@11),@TS00001                           0581 01673000
*   NEWID2='SRSE';                  /*                       @Y30LB31*/ 01674000
*                                                                  0582 01675000
         MVC   NEWID2(4,@11),@CC01481                              0582 01676000
*   /*****************************************************************/ 01677000
*   /*                                                               */ 01678000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN THIS PROC.  */ 01679000
*   /*                                                       @Y30LB31*/ 01680000
*   /*                                                               */ 01681000
*   /*****************************************************************/ 01682000
*                                                                  0583 01683000
*   SECCKRC=LASTCC00;               /*                       @Y30LB31*/ 01684000
*                                                                  0583 01685000
         SLR   @11,@11                                             0583 01686000
         LR    SECCKRC,@11                                         0583 01687000
*   /*****************************************************************/ 01688000
*   /*                                                               */ 01689000
*   /* BYPASS THE ACTIVATE AND SECURITY CHECK IF A PREVIOUS RENAME   */ 01690000
*   /* JOB FAILED AND NOW THE ORIGINAL VOLUME SERIAL NO. IS BEING    */ 01691000
*   /* RESTORED.                                             @Y30LB31*/ 01692000
*   /*                                                               */ 01693000
*   /*****************************************************************/ 01694000
*                                                                  0584 01695000
*   IF ADDR(NSER)^=NULLPTR&BASVSMIS=ON&/*                    @Y30LB31*/ 01696000
*       NSERVAL=BASRECOV THEN       /*                       @Y30LB31*/ 01697000
         L     @04,@PC00001+4                                      0584 01698000
         L     @04,FDTPTR+4(,@04)                                  0584 01699000
         CR    @04,@11                                             0584 01700000
         BE    @RF00584                                            0584 01701000
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0584 01702000
         BNO   @RF00584                                            0584 01703000
         CLC   NSERVAL(6,@04),BASRECOV(BASEVPTR)                   0584 01704000
         BNE   @RF00584                                            0584 01705000
*     RECOVFLG=ON;                  /*                       @Y30LB31*/ 01706000
*                                                                  0585 01707000
         OI    RECOVFLG,B'00010000'                                0585 01708000
*   /*****************************************************************/ 01709000
*   /*                                                               */ 01710000
*   /* IF THE VOLUME HAS A LABEL MISMATCH, GET EXCLUSIVE CONTROL OF  */ 01711000
*   /* THE UNIT.                                             @YD00175*/ 01712000
*   /*                                                               */ 01713000
*   /*****************************************************************/ 01714000
*                                                                  0586 01715000
*   IF BASVSMIS=ON THEN             /*                       @Y30LB31*/ 01716000
@RF00584 TM    BASVSMIS(BASEVPTR),B'00100000'                      0586 01717000
         BNO   @RF00586                                            0586 01718000
*     DO;                           /*                       @Y30LB31*/ 01719000
*       EXCLAGL=''B;                /*                       @YD00175*/ 01720000
         LA    @11,SREXCLST                                        0588 01721000
         XC    EXCLAGL(23,@11),EXCLAGL(@11)                        0588 01722000
*       EXCLDDP=ADDR(SUNITDDN);     /*                       @YD00175*/ 01723000
         LA    @04,SUNITDDN                                        0589 01724000
         ST    @04,EXCLDDP(,@11)                                   0589 01725000
*       EXCLUCBP=ADDR(SUNITUCB);    /*                       @YD00175*/ 01726000
*                                                                  0590 01727000
         LA    @04,SUNITUCB                                        0590 01728000
         ST    @04,EXCLUCBP(,@11)                                  0590 01729000
*       /*************************************************************/ 01730000
*       /*                                                           */ 01731000
*       /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL           @YD00175*/ 01732000
*       /*                                                           */ 01733000
*       /*************************************************************/ 01734000
*                                                                  0591 01735000
*       CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*             @YD00175*/ 01736000
         L     @04,@PC00001                                        0591 01737000
         ST    @04,@AL00001                                        0591 01738000
         LA    @02,CHANGEX                                         0591 01739000
         ST    @02,@AL00001+4                                      0591 01740000
         ST    @11,@AL00001+8                                      0591 01741000
         MVI   @AL00001+8,X'80'                                    0591 01742000
         L     @15,GDTUNT(,@04)                                    0591 01743000
         LA    @01,@AL00001                                        0591 01744000
         BALR  @14,@15                                             0591 01745000
*       RESPECIFY                                                  0592 01746000
*         RTNREG RSTD;                                             0592 01747000
*       TESTRC=RTNREG;                                             0593 01748000
         LR    TESTRC,RTNREG                                       0593 01749000
*       RESPECIFY                                                  0594 01750000
*         RTNREG UNRSTD;            /*                       @YD00175*/ 01751000
*                                                                  0594 01752000
*       /*************************************************************/ 01753000
*       /*                                                           */ 01754000
*       /* IF WE DO NOT GET EXCLUSIVE CONTROL, EXIT FROM THE         */ 01755000
*       /* PROCEDURE.                                        @YD00175*/ 01756000
*       /*                                                           */ 01757000
*       /*************************************************************/ 01758000
*                                                                  0595 01759000
*       IF TESTRC>0 THEN            /*                       @YD00175*/ 01760000
         LTR   TESTRC,TESTRC                                       0595 01761000
         BNP   @RF00595                                            0595 01762000
*         SECCKRC=LASTCC04;         /*                       @YD00175*/ 01763000
         LA    SECCKRC,4                                           0596 01764000
*       ELSE                        /*                       @YD00175*/ 01765000
*         DO;                       /*                       @YD00175*/ 01766000
*                                                                  0597 01767000
         B     @RC00595                                            0597 01768000
@RF00595 DS    0H                                                  0598 01769000
*           /*********************************************************/ 01770000
*           /*                                                       */ 01771000
*           /* CALL AN AMS SYSTEM ADAPTER ROUTINE TO MOUNT THE VOLUME*/ 01772000
*           /* IF A VOLUME SERIAL MISMATCH EXISTS BETWEEN THE CART   */ 01773000
*           /* AND VOL LABELS. OTHERWISE, AN OPEN VTOC EXECUTED BY   */ 01774000
*           /* EITHER VOLUME SERVICES ROUTINE WILL CAUSE THE VOL TO  */ 01775000
*           /* BE MOUNTED.                                   @YD00175*/ 01776000
*           /*                                                       */ 01777000
*           /*********************************************************/ 01778000
*                                                                  0598 01779000
*           MOUNTFLG=ON;            /* VOL MOUNT REQUESTED   @Y30LB31*/ 01780000
         OI    MOUNTFLG,B'01000000'                                0598 01781000
*           VPREPVOL=MSVIVOL#;      /*                       @Y30LB31*/ 01782000
         MVC   VPREPVOL(6),MSVIVOL#                                0599 01783000
*           CALL VPREPRTN;          /*                       @Y30LB31*/ 01784000
         BAL   @14,VPREPRTN                                        0600 01785000
*           RESPECIFY                                              0601 01786000
*             RTNREG RSTD;                                         0601 01787000
*           TESTRC=RTNREG;                                         0602 01788000
         LR    TESTRC,RTNREG                                       0602 01789000
*           RESPECIFY                                              0603 01790000
*             RTNREG UNRSTD;        /*                       @Y30LB31*/ 01791000
*                                                                  0603 01792000
*           /*********************************************************/ 01793000
*           /*                                                       */ 01794000
*           /* EXIT FROM THIS PROC IF THE SPECIAL MOUNT FAILED FOR   */ 01795000
*           /* THE VOL WITH A SERIAL MISMATCH.               @Y30LB31*/ 01796000
*           /*                                                       */ 01797000
*           /*********************************************************/ 01798000
*                                                                  0604 01799000
*           IF TESTRC^=0 THEN       /*                       @Y30LB31*/ 01800000
         LTR   TESTRC,TESTRC                                       0604 01801000
         BZ    @RF00604                                            0604 01802000
*             SECCKRC=4;            /*                       @Y30LB31*/ 01803000
         LA    SECCKRC,4                                           0605 01804000
*         END;                      /*                       @Y30LB31*/ 01805000
@RF00604 DS    0H                                                  0607 01806000
*     END;                          /*                       @YD00175*/ 01807000
@RC00595 DS    0H                                                  0608 01808000
*                                                                  0608 01809000
*   /*****************************************************************/ 01810000
*   /*                                                               */ 01811000
*   /* IF THERE IS NO PROBLEM MOUNTING THE VOLUME FOR THE SECURITY   */ 01812000
*   /* AND VSAM CHECK OUT, CALL VTOCKRTN TO PERFORM THIS VTOC        */ 01813000
*   /* FUNCTION UNLESS THE SECURITY CHECK IS TO BE BYPASSED. @Y30LB31*/ 01814000
*   /*                                                               */ 01815000
*   /*****************************************************************/ 01816000
*                                                                  0608 01817000
*   IF SECCKRC=0&RECOVFLG=OFF THEN  /*                       @Y30LB31*/ 01818000
@RF00586 LTR   SECCKRC,SECCKRC                                     0608 01819000
         BNZ   @RF00608                                            0608 01820000
         TM    RECOVFLG,B'00010000'                                0608 01821000
         BNZ   @RF00608                                            0608 01822000
*     DO;                           /*                       @Y30LB31*/ 01823000
*       CALL VTOCKRTN;              /*                       @Y30LB31*/ 01824000
         BAL   @14,VTOCKRTN                                        0610 01825000
*       RESPECIFY                                                  0611 01826000
*         RTNREG RSTD;                                             0611 01827000
*       TESTRC=RTNREG;                                             0612 01828000
         LR    TESTRC,RTNREG                                       0612 01829000
*       RESPECIFY                                                  0613 01830000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 01831000
*                                                                  0613 01832000
*       /*************************************************************/ 01833000
*       /*                                                           */ 01834000
*       /* SET AN UNSUCCESSFUL CONDITION CODE IF THE VSAM AND        */ 01835000
*       /* SECURITY CHECK COULD NOT BE PERFORMED.            @Y30LB31*/ 01836000
*       /*                                                           */ 01837000
*       /*************************************************************/ 01838000
*                                                                  0614 01839000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 01840000
         LTR   TESTRC,TESTRC                                       0614 01841000
         BZ    @RF00614                                            0614 01842000
*         SECCKRC=4;                /*                       @Y30LB31*/ 01843000
*                                                                  0615 01844000
         LA    SECCKRC,4                                           0615 01845000
*       /*************************************************************/ 01846000
*       /*                                                           */ 01847000
*       /* IF SECURITY CHECK SUCCESSFUL, GET EXCLUSIVE CONTROL OF THE*/ 01848000
*       /* VOLUME IF NOT ALREADY OBTAINED. EXCLUSIVE CONTROL HAS     */ 01849000
*       /* ALREADY BEEN OBTAINED IF THERE IS A VOLUME SERIAL         */ 01850000
*       /* MISMATCH.                                         @YD00175*/ 01851000
*       /*                                                           */ 01852000
*       /*************************************************************/ 01853000
*                                                                  0616 01854000
*       ELSE                                                       0616 01855000
*         IF BASVSMIS=OFF THEN      /*                       @YD00175*/ 01856000
         B     @RC00614                                            0616 01857000
@RF00614 TM    BASVSMIS(BASEVPTR),B'00100000'                      0616 01858000
         BNZ   @RF00616                                            0616 01859000
*           DO;                     /*                       @YD00175*/ 01860000
*             EXCLAGL=''B;          /*                       @YD00175*/ 01861000
         LA    @11,SREXCLST                                        0618 01862000
         XC    EXCLAGL(23,@11),EXCLAGL(@11)                        0618 01863000
*             EXCLDDP=ADDR(SUNITDDN);/*                      @YD00175*/ 01864000
         LA    @04,SUNITDDN                                        0619 01865000
         ST    @04,EXCLDDP(,@11)                                   0619 01866000
*             EXCLUCBP=ADDR(SUNITUCB);/*                     @YD00175*/ 01867000
*                                                                  0620 01868000
         LA    @04,SUNITUCB                                        0620 01869000
         ST    @04,EXCLUCBP(,@11)                                  0620 01870000
*             /*******************************************************/ 01871000
*             /*                                                     */ 01872000
*             /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL     @YD00175*/ 01873000
*             /*                                                     */ 01874000
*             /*******************************************************/ 01875000
*                                                                  0621 01876000
*             CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*       @YD00175*/ 01877000
         L     @04,@PC00001                                        0621 01878000
         ST    @04,@AL00001                                        0621 01879000
         LA    @02,CHANGEX                                         0621 01880000
         ST    @02,@AL00001+4                                      0621 01881000
         ST    @11,@AL00001+8                                      0621 01882000
         MVI   @AL00001+8,X'80'                                    0621 01883000
         L     @15,GDTUNT(,@04)                                    0621 01884000
         LA    @01,@AL00001                                        0621 01885000
         BALR  @14,@15                                             0621 01886000
*             RESPECIFY                                            0622 01887000
*               RTNREG RSTD;                                       0622 01888000
*             TESTRC=RTNREG;                                       0623 01889000
         LR    TESTRC,RTNREG                                       0623 01890000
*             RESPECIFY                                            0624 01891000
*               RTNREG UNRSTD;      /*                       @YD00175*/ 01892000
*                                                                  0624 01893000
*             /*******************************************************/ 01894000
*             /*                                                     */ 01895000
*             /* IF RETURN CODE NOT ZERO, SET INTERNAL CODE TO 4     */ 01896000
*             /*                                             @YD00175*/ 01897000
*             /*                                                     */ 01898000
*             /*******************************************************/ 01899000
*                                                                  0625 01900000
*             IF TESTRC>0 THEN      /*                       @YD00175*/ 01901000
         LTR   TESTRC,TESTRC                                       0625 01902000
         BNP   @RF00625                                            0625 01903000
*               SECCKRC=LASTCC04;   /*                       @YD00175*/ 01904000
         LA    SECCKRC,4                                           0626 01905000
*           END;                    /*                       @YD00175*/ 01906000
@RF00625 DS    0H                                                  0628 01907000
*     END;                          /*                       @Y30LB31*/ 01908000
*                                                                  0628 01909000
@RF00616 DS    0H                                                  0628 01910000
@RC00614 DS    0H                                                  0629 01911000
*   /*****************************************************************/ 01912000
*   /*                                                               */ 01913000
*   /* RESTORE REG 14 TO THE RETURN ADDRESS OF THE CALLER AND EXIT   */ 01914000
*   /* FROM SECCKRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/ 01915000
*   /*                                                               */ 01916000
*   /*****************************************************************/ 01917000
*                                                                  0629 01918000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 01919000
@RF00608 LR    REG14,RETADDR2                                      0629 01920000
*   RETURN CODE(SECCKRC);           /*                       @Y30LB31*/ 01921000
         LR    @15,SECCKRC                                         0630 01922000
@EL00006 DS    0H                                                  0630 01923000
@EF00006 DS    0H                                                  0630 01924000
@ER00006 BR    @14                                                 0630 01925000
*   END SECCKRTN;                   /*                       @Y30LB31*/ 01926000
*                                                                  0632 01927000
*/*********************************************************  @Y30LB31*/ 01928000
*/*                                                          @Y30LB31*/ 01929000
*/* PROCEDURE NAME - VPREPRTN                                @Y30LB31*/ 01930000
*/*                                                          @Y30LB31*/ 01931000
*/* FUNCTION - MOUNTS AND DEMOUNTS THE VOLUME AND FOLLOWING  @Y30LB31*/ 01932000
*/*            A DEMOUNT RELEASES THE RESERVE SET BY THE VOL @Y30LB31*/ 01933000
*/*            SERVICES ROUTINES.  NO MESSAGES ARE ISSUED BY @Y30LB31*/ 01934000
*/*            THIS PROC.                                    @Y30LB31*/ 01935000
*/*                                                          @Y30LB31*/ 01936000
*/* INPUT - FDTTBL, STORETBL, MDAGL.                         @Y30LB31*/ 01937000
*/*                                                          @Y30LB31*/ 01938000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES VOL SUCCESSFULLY   @Y30LB31*/ 01939000
*/*          MOUNTED OR DEMOUNTED.  A RETURN CODE OF 4       @Y30LB31*/ 01940000
*/*          INDICATES A MOUNT OR DEMOUNT FAILURE.           @Y30LB31*/ 01941000
*/*                                                          @Y30LB31*/ 01942000
*/*********************************************************  @Y30LB31*/ 01943000
*                                                                  0632 01944000
*VPREPRTN:                                                         0632 01945000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 01946000
*                                                                  0632 01947000
VPREPRTN DS    0H                                                  0633 01948000
*   /*****************************************************************/ 01949000
*   /*                                                               */ 01950000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 01951000
*   /*                                                               */ 01952000
*   /*****************************************************************/ 01953000
*                                                                  0633 01954000
*   DCL                                                            0633 01955000
*     VPREPRC FIXED(15);            /*                       @Y30LB31*/ 01956000
*                                                                  0633 01957000
*   /*****************************************************************/ 01958000
*   /*                                                               */ 01959000
*   /* SETUP AN AREA USED WITH THE UMSSUNIT MACRO. IT DESCRIBES      */ 01960000
*   /* WHETHER THE REQUEST IF A MOUNT OR DEMOUNT.            @Y30LB31*/ 01961000
*   /*                                                               */ 01962000
*   /*****************************************************************/ 01963000
*                                                                  0634 01964000
*   DCL                                                            0634 01965000
*     SRMDTYPE CHAR(8);             /*                       @Y30LB31*/ 01966000
*   DCL                                                            0635 01967000
*     NODDNAME BIT(64) CONSTANT('0000000000000000'X);/*      @Y30LB31*/ 01968000
*                                                                  0635 01969000
*   /*****************************************************************/ 01970000
*   /*                                                               */ 01971000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */ 01972000
*   /*                                                       @Y30LB31*/ 01973000
*   /*                                                               */ 01974000
*   /*****************************************************************/ 01975000
*                                                                  0636 01976000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 01977000
         LR    RETADDR3,REG14                                      0636 01978000
*   OLDERID2=NEWERID2;                                             0637 01979000
         L     @15,@PC00001                                        0637 01980000
         L     @15,GDTTR2(,@15)                                    0637 01981000
         MVC   @TS00001(95),NEWERID2(@15)                          0637 01982000
         MVC   OLDERID2(95,@15),@TS00001                           0637 01983000
*   NEWID2='SRVP';                  /*                       @Y30LB31*/ 01984000
*                                                                  0638 01985000
         MVC   NEWID2(4,@15),@CC01493                              0638 01986000
*   /*****************************************************************/ 01987000
*   /*                                                               */ 01988000
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/ 01989000
*   /*                                                               */ 01990000
*   /*****************************************************************/ 01991000
*                                                                  0639 01992000
*   VPREPRC=LASTCC00;               /*                       @Y30LB31*/ 01993000
*                                                                  0639 01994000
         SLR   VPREPRC,VPREPRC                                     0639 01995000
*   /*****************************************************************/ 01996000
*   /*                                                               */ 01997000
*   /* IF THE MOUNT-DEMOUNT ARGUMENT LIST HAS NOT BEEN INITIALIZED,  */ 01998000
*   /* DO SO. THEN REUSE THE LIST FOR EACH SUBSEQUENT REQUEST IN     */ 01999000
*   /* ORDER NOT TO DESTROY THE ENQUEUE FLAG SET BY THE MOUNT ROUTINE*/ 02000000
*   /* AND USED BY THE DEMOUNT ROUTINE THAT IS INVOKED.      @Y30LB31*/ 02001000
*   /*                                                               */ 02002000
*   /*****************************************************************/ 02003000
*                                                                  0640 02004000
*   IF MDDDNAME=NODDNAME THEN       /*                       @Y30LB31*/ 02005000
         LA    @15,SRMDAGL                                         0640 02006000
         CLC   MDDDNAME(8,@15),@CB01491                            0640 02007000
         BNE   @RF00640                                            0640 02008000
*     DO;                           /*                       @Y30LB31*/ 02009000
*       MDDDNAME=SUNITDDN;          /*                       @Y30LB31*/ 02010000
         MVC   MDDDNAME(8,@15),SUNITDDN                            0642 02011000
*       MDUCBPTR=ADDR(SUNITUCB);    /*                       @Y30LB31*/ 02012000
         LA    @14,SUNITUCB                                        0643 02013000
         ST    @14,MDUCBPTR(,@15)                                  0643 02014000
*     END;                          /*                       @Y30LB31*/ 02015000
*   MDLABEL=VPREPVOL;               /*                       @Y30LB31*/ 02016000
@RF00640 LA    @15,SRMDAGL                                         0645 02017000
         MVC   MDLABEL(6,@15),VPREPVOL                             0645 02018000
*   IF MOUNTFLG=OFF THEN            /*                       @Y30LB31*/ 02019000
         TM    MOUNTFLG,B'01000000'                                0646 02020000
         BNZ   @RF00646                                            0646 02021000
*     DO;                           /*                       @Y30LB31*/ 02022000
*       MDWAIT=ON;                  /*                       @Y30LB31*/ 02023000
         OI    MDWAIT(@15),B'00010000'                             0648 02024000
*       SRMDTYPE=DEMOUNT;           /*                       @Y30LB31*/ 02025000
         MVC   SRMDTYPE(8),DEMOUNT                                 0649 02026000
*     END;                          /*                       @Y30LB31*/ 02027000
*   ELSE                            /*                       @Y30LB31*/ 02028000
*     DO;                           /*                       @Y30LB31*/ 02029000
         B     @RC00646                                            0651 02030000
@RF00646 DS    0H                                                  0652 02031000
*       MDWAIT=OFF;                 /*                       @Y30LB31*/ 02032000
         LA    @15,SRMDAGL                                         0652 02033000
         NI    MDWAIT(@15),B'11101111'                             0652 02034000
*       SRMDTYPE=MOUNT;             /*                       @Y30LB31*/ 02035000
         MVC   SRMDTYPE(8),MOUNT                                   0653 02036000
*     END;                          /*                       @Y30LB31*/ 02037000
*                                                                  0654 02038000
*   /*****************************************************************/ 02039000
*   /*                                                               */ 02040000
*   /* TAKE A SYMBOLIC DUMP OF THE MOUNT-DEMOUNT PARM LIST BEFORE    */ 02041000
*   /* INVOKING THE MOUNT-DEMOUNT ROUTINE.                   @Y30LB31*/ 02042000
*   /*                                                               */ 02043000
*   /*****************************************************************/ 02044000
*                                                                  0655 02045000
*   IF GDTDBG=NULLPTR THEN                                         0655 02046000
@RC00646 L     @15,@PC00001                                        0655 02047000
         L     @15,GDTDBG(,@15)                                    0655 02048000
         LTR   @15,@15                                             0655 02049000
         BZ    @RT00655                                            0655 02050000
*     ;                                                            0656 02051000
*   ELSE                                                           0657 02052000
*     DO;                                                          0657 02053000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/ 02054000
         LA    DMPINDEX,DUMPLIST                                   0658 02055000
*       DMPITMNM='SRMDAGL';                                        0659 02056000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0659 02057000
         MVC   DMPITMNM(7,DMPINDEX),@CC01494                       0659 02058000
*       DMPITMPT=ADDR(SRMDAGL);                                    0660 02059000
         LA    @03,SRMDAGL                                         0660 02060000
         ST    @03,DMPITMPT(,DMPINDEX)                             0660 02061000
*       DMPITMLN=LENGTH(SRMDAGL);                                  0661 02062000
         MVC   DMPITMLN(2,DMPINDEX),@CH00044                       0661 02063000
*       DMPITMTP='H';                                              0662 02064000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0662 02065000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0663 02066000
*                                                                  0663 02067000
         LA    @03,16                                              0663 02068000
         ALR   DMPINDEX,@03                                        0663 02069000
*       /*************************************************************/ 02070000
*       /*                                                           */ 02071000
*       /*                                                   @Y30LB31*/ 02072000
*       /*                                                           */ 02073000
*       /*************************************************************/ 02074000
*                                                                  0664 02075000
*       DMPITMNM='STORETBL';                                       0664 02076000
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       0664 02077000
*       DMPITMPT=ADDR(STORETBL);                                   0665 02078000
         LA    @15,STORETBL                                        0665 02079000
         ST    @15,DMPITMPT(,DMPINDEX)                             0665 02080000
*       DMPITMLN=LENGTH(STORETBL);                                 0666 02081000
         MVC   DMPITMLN(2,DMPINDEX),@CH01398                       0666 02082000
*       DMPITMTP='H';                                              0667 02083000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0667 02084000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0668 02085000
*                                                                  0668 02086000
         ALR   DMPINDEX,@03                                        0668 02087000
*       /*************************************************************/ 02088000
*       /*                                                           */ 02089000
*       /*                                                   @Y30LB31*/ 02090000
*       /*                                                           */ 02091000
*       /*************************************************************/ 02092000
*                                                                  0669 02093000
*       DMPTRM=DMPTRMVL;                                           0669 02094000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0669 02095000
*     END;                          /*                       @Y30LB31*/ 02096000
*   IF GDTDBG=NULLPTR THEN                                         0671 02097000
@RT00655 L     @15,@PC00001                                        0671 02098000
         L     @15,GDTDBG(,@15)                                    0671 02099000
         LTR   @15,@15                                             0671 02100000
         BZ    @RT00671                                            0671 02101000
*     ;                                                            0672 02102000
*   ELSE                                                           0673 02103000
*     CALL IDCDB010(GDTTBL,'SRMD',ADDR(DUMPLIST));/*         @Y30LB31*/ 02104000
         L     @15,@PC00001                                        0673 02105000
         ST    @15,@AL00001                                        0673 02106000
         LA    @14,@CC01495                                        0673 02107000
         ST    @14,@AL00001+4                                      0673 02108000
         LA    @14,DUMPLIST                                        0673 02109000
         ST    @14,@AFTEMPS+8                                      0673 02110000
         LA    @14,@AFTEMPS+8                                      0673 02111000
         ST    @14,@AL00001+8                                      0673 02112000
         MVI   @AL00001+8,X'80'                                    0673 02113000
         L     @15,GDTDBG(,@15)                                    0673 02114000
         LA    @01,@AL00001                                        0673 02115000
         BALR  @14,@15                                             0673 02116000
*                                                                  0674 02117000
*   /*****************************************************************/ 02118000
*   /*                                                               */ 02119000
*   /* IF A VOLUME DEMOUNT WAS REQUESTED, RELEASE THE RESERVE SET BY */ 02120000
*   /* EITHER IDCVS01 WHEN CHECKING THE VTOC OR BY IDCVS02 WHEN      */ 02121000
*   /* UPDATING THE VOL LABEL.                               @ZA05125*/ 02122000
*   /*                                                               */ 02123000
*   /*****************************************************************/ 02124000
*                                                                  0674 02125000
*   IF MOUNTFLG=OFF THEN            /*                       @ZA05125*/ 02126000
@RT00671 TM    MOUNTFLG,B'01000000'                                0674 02127000
         BNZ   @RF00674                                            0674 02128000
*     DO;                           /*                       @ZA05125*/ 02129000
*       RNMSERNO=VPREPVOL;          /*                       @ZA05125*/ 02130000
         MVC   RNMSERNO(6),VPREPVOL                                0676 02131000
*       RNMTRAIL='.VIRTUAL.RESERVE';/*                       @ZA05138*/ 02132000
         MVC   RNMTRAIL(16),@CC01496                               0677 02133000
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @ZA05125*/ 02134000
         L     @15,@PC00001                                        0678 02135000
         ST    @15,@AL00001                                        0678 02136000
         LA    @14,@CC01366                                        0678 02137000
         ST    @14,@AL00001+4                                      0678 02138000
         LA    @14,MINORNM                                         0678 02139000
         ST    @14,@AL00001+8                                      0678 02140000
         MVI   @AL00001+8,X'80'                                    0678 02141000
         L     @15,GDTDEQ(,@15)                                    0678 02142000
         LA    @01,@AL00001                                        0678 02143000
         BALR  @14,@15                                             0678 02144000
*     END;                          /*                       @ZA05125*/ 02145000
*                                                                  0679 02146000
*   /*****************************************************************/ 02147000
*   /*                                                               */ 02148000
*   /* MOUNT OR DEMOUNT THE VOLUME AS REQUESTED.             @Y30LB31*/ 02149000
*   /*                                                               */ 02150000
*   /*****************************************************************/ 02151000
*                                                                  0680 02152000
*   CALL IDCSA060(GDTTBL,SRMDTYPE,MDAGL);/*                  @Y30LB31*/ 02153000
@RF00674 L     @02,@PC00001                                        0680 02154000
         ST    @02,@AL00001                                        0680 02155000
         LA    @15,SRMDTYPE                                        0680 02156000
         ST    @15,@AL00001+4                                      0680 02157000
         LA    @15,SRMDAGL                                         0680 02158000
         ST    @15,@AL00001+8                                      0680 02159000
         MVI   @AL00001+8,X'80'                                    0680 02160000
         L     @15,GDTUNT(,@02)                                    0680 02161000
         LA    @01,@AL00001                                        0680 02162000
         BALR  @14,@15                                             0680 02163000
*   RESPECIFY                                                      0681 02164000
*     RTNREG RSTD;                                                 0681 02165000
*   TESTRC=RTNREG;                                                 0682 02166000
         LR    TESTRC,RTNREG                                       0682 02167000
*   RESPECIFY                                                      0683 02168000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 02169000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 02170000
         LTR   TESTRC,TESTRC                                       0684 02171000
         BZ    @RF00684                                            0684 02172000
*     VPREPRC=4;                    /*                       @Y30LB31*/ 02173000
*                                                                  0685 02174000
         LA    VPREPRC,4                                           0685 02175000
*   /*****************************************************************/ 02176000
*   /*                                                               */ 02177000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT */ 02178000
*   /* FROM VPREPRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/ 02179000
*   /*                                                               */ 02180000
*   /*****************************************************************/ 02181000
*                                                                  0686 02182000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 02183000
@RF00684 LR    REG14,RETADDR3                                      0686 02184000
*   RETURN CODE(VPREPRC);           /*                       @Y30LB31*/ 02185000
         LR    @15,VPREPRC                                         0687 02186000
@EL00007 DS    0H                                                  0687 02187000
@EF00007 DS    0H                                                  0687 02188000
@ER00007 BR    @14                                                 0687 02189000
*   END VPREPRTN;                   /*                       @Y30LB31*/ 02190000
*                                                                  0689 02191000
*/*********************************************************  @Y30LB31*/ 02192000
*/*                                                          @Y30LB31*/ 02193000
*/* PROCEDURE NAME - VTOCKRTN                                @Y30LB31*/ 02194000
*/*                                                          @Y30LB31*/ 02195000
*/* FUNCTION - CHECKS FOR NON-VSAM WRITE-LEVEL PROTECTED     @Y30LB31*/ 02196000
*/*            DATA SETS AND UNEXPIRED DATA SETS.            @Y30LB31*/ 02197000
*/*            VERIFIES THAT THE VOL IS NOT OWNED BY VSAM    @Y30LB31*/ 02198000
*/*            IF THE VOL IS BEING RELABELED.  IF THE VOL IS @Y30LB31*/ 02199000
*/*            ONLY BEING DEACTIVATED, CHECKS FOR VSAM       @Y30LB31*/ 02200000
*/*            WRITE-LEVEL PROTECTED DATA SETS.              @ZM32529*/ 02201000
*/*            MESSAGES IDC3744I AND IDC3745I ARE ISSUED BY  @ZM32529*/ 02202000
*/*            THIS ROUTINE.                                 @ZM32529*/ 02203000
*/*                                                          @Y30LB31*/ 02204000
*/* INPUT - FDTTBL, STORETBL                                 @Y30LB31*/ 02205000
*/*                                                          @Y30LB31*/ 02206000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES A SUCCESSFUL       @Y30LB31*/ 02207000
*/*          SECURITY CHECK.  A RETURN CODE OF 4 INDICATES   @Y30LB31*/ 02208000
*/*          AN UNSUCCESSFUL SECURITY CHECK OR THE VOL IS    @Y30LB31*/ 02209000
*/*          VSAM AND MUST NOT BE RELABELED OR THAT EITHER   @ZM32529*/ 02210000
*/*          NO DD CARD WAS SPECIFIED FOR A VSAM CATALOG ON  @ZM32529*/ 02211000
*/*          THE STORED VOLUME OR A JOBCAT OR STEPCAT DD WAS @ZM32529*/ 02212000
*/*          SPECIFIED FOR THE CATALOG BEING OPENED.         @ZM32529*/ 02213000
*/*                                                          @Y30LB31*/ 02214000
*/*********************************************************  @Y30LB31*/ 02215000
*                                                                  0689 02216000
*VTOCKRTN:                                                         0689 02217000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 02218000
*                                                                  0689 02219000
VTOCKRTN DS    0H                                                  0690 02220000
*   /*****************************************************************/ 02221000
*   /*                                                               */ 02222000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 02223000
*   /*                                                               */ 02224000
*   /*****************************************************************/ 02225000
*                                                                  0690 02226000
*   DCL                                                            0690 02227000
*     VTOCKRC FIXED(15);            /*                       @Y30LB31*/ 02228000
*                                                                  0690 02229000
*   /*****************************************************************/ 02230000
*   /*                                                               */ 02231000
*   /* CATALOG DD NAME HOLD AREA                             @ZM01185*/ 02232000
*   /*                                                               */ 02233000
*   /*****************************************************************/ 02234000
*                                                                  0691 02235000
*   DCL                                                            0691 02236000
*     CATDDHLD CHAR(8);             /*                       @ZM01185*/ 02237000
*                                                                  0691 02238000
*   /*****************************************************************/ 02239000
*   /*                                                               */ 02240000
*   /* SETUP STORAGE AREA TO BUILD THE VOLUME SERVICES ARGUMENT LIST */ 02241000
*   /* USED TO CHECK THE VTOC.                               @Y30LB31*/ 02242000
*   /*                                                               */ 02243000
*   /*****************************************************************/ 02244000
*                                                                  0692 02245000
*   DCL                                                            0692 02246000
*     SRVS1LST CHAR(LENGTH(VS1AGL)) BDY(WORD);/*             @Y30LB31*/ 02247000
*   DCL                                                            0693 02248000
*     IDCVS01 CHAR(8) CONSTANT('IDCVS01 ');/*                @Y30LB31*/ 02249000
*                                                                  0693 02250000
*   /*****************************************************************/ 02251000
*   /*                                                               */ 02252000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */ 02253000
*   /*                                                       @Y30LB31*/ 02254000
*   /*                                                               */ 02255000
*   /*****************************************************************/ 02256000
*                                                                  0694 02257000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 02258000
         LR    RETADDR3,REG14                                      0694 02259000
*   OLDERID2=NEWERID2;                                             0695 02260000
         L     @15,@PC00001                                        0695 02261000
         L     @15,GDTTR2(,@15)                                    0695 02262000
         MVC   @TS00001(95),NEWERID2(@15)                          0695 02263000
         MVC   OLDERID2(95,@15),@TS00001                           0695 02264000
*   NEWID2='SRVT';                  /*                       @Y30LB31*/ 02265000
*                                                                  0696 02266000
         MVC   NEWID2(4,@15),@CC01506                              0696 02267000
*   /*****************************************************************/ 02268000
*   /*                                                               */ 02269000
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/ 02270000
*   /*                                                               */ 02271000
*   /*****************************************************************/ 02272000
*                                                                  0697 02273000
*   VTOCKRC=LASTCC00;               /*                       @Y30LB31*/ 02274000
*                                                                  0697 02275000
         SLR   @15,@15                                             0697 02276000
         LR    VTOCKRC,@15                                         0697 02277000
*   /*****************************************************************/ 02278000
*   /*                                                               */ 02279000
*   /* SETUP THE ARG LIST TO BE PASSED TO THE VOLUME SERVICES ROUTINE*/ 02280000
*   /* FOR THE VTOC CHECK.                                   @Y30LB31*/ 02281000
*   /*                                                               */ 02282000
*   /*****************************************************************/ 02283000
*                                                                  0698 02284000
*   RESPECIFY                                                      0698 02285000
*     VS1AGL BASED(ADDR(SRVS1LST)); /*                       @Y30LB31*/ 02286000
*   VS1AGL=''B;                     /*                       @Y30LB31*/ 02287000
         LA    @14,SRVS1LST                                        0699 02288000
         XC    VS1AGL(74,@14),VS1AGL(@14)                          0699 02289000
*   VSRES=ON;                       /*                       @Y30LB31*/ 02290000
         OI    VSRES(@14),B'10000000'                              0700 02291000
*   VSUCBP=ADDR(SUNITUCB);          /*                       @Y30LB31*/ 02292000
         LA    @03,SUNITUCB                                        0701 02293000
         ST    @03,VSUCBP(,@14)                                    0701 02294000
*   VSVOLP=ADDR(MSVIVOL#);          /*                       @Y30LB31*/ 02295000
         LA    @03,MSVIVOL#                                        0702 02296000
         ST    @03,VSVOLP(,@14)                                    0702 02297000
*   VSFILEP=ADDR(SUNITDDN);         /*                       @Y30LB31*/ 02298000
         LA    @03,SUNITDDN                                        0703 02299000
         ST    @03,VSFILEP(,@14)                                   0703 02300000
*   VSWRITE=ON;                     /*                       @Y30LB31*/ 02301000
         OI    VSWRITE(@14),B'00001000'                            0704 02302000
*   IF ADDR(PFILE)^=NULLPTR THEN    /*                       @Y30LB31*/ 02303000
         L     @03,@PC00001+4                                      0705 02304000
         L     @03,FDTPTR+44(,@03)                                 0705 02305000
         CR    @03,@15                                             0705 02306000
         BE    @RF00705                                            0705 02307000
*     VSPFILEP=ADDR(PFILE);         /*                       @Y30LB31*/ 02308000
*                                                                  0706 02309000
         ST    @03,VSPFILEP(,@14)                                  0706 02310000
*   /*****************************************************************/ 02311000
*   /*                                                               */ 02312000
*   /* IF THE VOL IS TO BE RELABELED AS WELL AS DEACTIVATED, IT      */ 02313000
*   /* CANNOT BE OWNED BY VSAM. VERIFY THAT THE VOL IS NOT VSAM.     */ 02314000
*   /*                                                       @Y30LB31*/ 02315000
*   /*                                                               */ 02316000
*   /*****************************************************************/ 02317000
*                                                                  0707 02318000
*   IF ADDR(NSER)^=NULLPTR THEN     /*                       @Y30LB31*/ 02319000
@RF00705 L     @15,@PC00001+4                                      0707 02320000
         L     @15,FDTPTR+4(,@15)                                  0707 02321000
         LTR   @15,@15                                             0707 02322000
         BZ    @RF00707                                            0707 02323000
*     VSNOVSAM=ON;                  /*                       @Y30LB31*/ 02324000
*                                                                  0708 02325000
         LA    @15,SRVS1LST                                        0708 02326000
         OI    VSNOVSAM(@15),B'10000000'                           0708 02327000
*   /*****************************************************************/ 02328000
*   /*                                                               */ 02329000
*   /* IF THE VOL IS TO BE DEACTIVATED ONLY, CHECK FOR VSAM          */ 02330000
*   /* WRITE-LEVEL PASSWORD PROTECTED DATA SETS.             @Y30LB31*/ 02331000
*   /*                                                               */ 02332000
*   /*****************************************************************/ 02333000
*                                                                  0709 02334000
*   ELSE                            /*                       @Y30LB31*/ 02335000
*     DO;                           /*                       @Y30LB31*/ 02336000
         B     @RC00707                                            0709 02337000
@RF00707 DS    0H                                                  0710 02338000
*       VSUCTEST=ON;                /*                       @ZM32529*/ 02339000
*       VSMASTER=ON;                /*                       @Y30LB31*/ 02340000
         LA    @15,SRVS1LST                                        0711 02341000
         OI    VSUCTEST(@15),B'01000100'                           0711 02342000
*       IF ADDR(CAT)^=NULLPTR THEN  /*                       @Y30LB31*/ 02343000
         L     @14,@PC00001+4                                      0712 02344000
         L     @03,FDTPTR+28(,@14)                                 0712 02345000
         LTR   @03,@03                                             0712 02346000
         BZ    @RF00712                                            0712 02347000
*         DO;                       /*                       @Y30LB31*/ 02348000
*           VSCATP=ADDR(CATNMVAL);  /*                       @Y30LB31*/ 02349000
         L     @14,FDTPTR+32(,@14)                                 0714 02350000
         LA    @03,CATNMVAL(,@14)                                  0714 02351000
         ST    @03,VSCATP(,@15)                                    0714 02352000
*           IF CATNMPLN^=0 THEN     /*                       @Y30LB31*/ 02353000
         CLI   CATNMPLN(@14),0                                     0715 02354000
         BE    @RF00715                                            0715 02355000
*             VSPSWDP=ADDR(CATNMPAS);/*                      @Y30LB31*/ 02356000
         LA    @14,CATNMPAS(,@14)                                  0716 02357000
         ST    @14,VSPSWDP(,@15)                                   0716 02358000
*         END;                      /*                       @Y30LB31*/ 02359000
@RF00715 DS    0H                                                  0718 02360000
*       IF ADDR(CATDN)^=NULLPTR THEN/*                       @Y30LB31*/ 02361000
@RF00712 L     @15,@PC00001+4                                      0718 02362000
         L     @15,FDTPTR+36(,@15)                                 0718 02363000
         LTR   @15,@15                                             0718 02364000
         BZ    @RF00718                                            0718 02365000
*         CATDDHLD=CATDNVAL;        /*                       @ZM01185*/ 02366000
         MVC   CATDDHLD(8),CATDNVAL(@15)                           0719 02367000
*       ELSE                                                       0720 02368000
*         CATDDHLD=' ';             /*                       @ZM01185*/ 02369000
         B     @RC00718                                            0720 02370000
@RF00718 MVI   CATDDHLD+1,C' '                                     0720 02371000
         MVC   CATDDHLD+2(6),CATDDHLD+1                            0720 02372000
         MVI   CATDDHLD,C' '                                       0720 02373000
*       VSCATDDP=ADDR(CATDDHLD);    /*                       @ZM01185*/ 02374000
@RC00718 LA    @15,SRVS1LST                                        0721 02375000
         LA    @14,CATDDHLD                                        0721 02376000
         ST    @14,VSCATDDP(,@15)                                  0721 02377000
*       VSOPCAT=ON;                 /*                       @ZM01185*/ 02378000
         OI    VSOPCAT(@15),B'00000010'                            0722 02379000
*     END;                          /*                       @Y30LB31*/ 02380000
*                                                                  0723 02381000
*   /*****************************************************************/ 02382000
*   /*                                                               */ 02383000
*   /* TAKE A SYMBOLIC DUMP OF THE VOL SERVICES PARM LIST BEFORE     */ 02384000
*   /* CHECKING THE VTOC.                                    @Y30LB31*/ 02385000
*   /*                                                               */ 02386000
*   /*****************************************************************/ 02387000
*                                                                  0724 02388000
*   IF GDTDBG=NULLPTR THEN                                         0724 02389000
@RC00707 L     @15,@PC00001                                        0724 02390000
         L     @15,GDTDBG(,@15)                                    0724 02391000
         LTR   @15,@15                                             0724 02392000
         BZ    @RT00724                                            0724 02393000
*     ;                                                            0725 02394000
*   ELSE                                                           0726 02395000
*     DO;                                                          0726 02396000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/ 02397000
         LA    DMPINDEX,DUMPLIST                                   0727 02398000
*       DMPITMNM='SRVS1LST';                                       0728 02399000
         MVC   DMPITMNM(8,DMPINDEX),@CC01509                       0728 02400000
*       DMPITMPT=ADDR(SRVS1LST);                                   0729 02401000
         LA    @03,SRVS1LST                                        0729 02402000
         ST    @03,DMPITMPT(,DMPINDEX)                             0729 02403000
*       DMPITMLN=LENGTH(SRVS1LST);                                 0730 02404000
         MVC   DMPITMLN(2,DMPINDEX),@CH01702                       0730 02405000
*       DMPITMTP='H';                                              0731 02406000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0731 02407000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0732 02408000
*                                                                  0732 02409000
         LA    @03,16                                              0732 02410000
         ALR   DMPINDEX,@03                                        0732 02411000
*       /*************************************************************/ 02412000
*       /*                                                           */ 02413000
*       /*                                                   @Y30LB31*/ 02414000
*       /*                                                           */ 02415000
*       /*************************************************************/ 02416000
*                                                                  0733 02417000
*       DMPITMNM='STORETBL';                                       0733 02418000
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       0733 02419000
*       DMPITMPT=ADDR(STORETBL);                                   0734 02420000
         LA    @15,STORETBL                                        0734 02421000
         ST    @15,DMPITMPT(,DMPINDEX)                             0734 02422000
*       DMPITMLN=LENGTH(STORETBL);                                 0735 02423000
         MVC   DMPITMLN(2,DMPINDEX),@CH01398                       0735 02424000
*       DMPITMTP='H';                                              0736 02425000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0736 02426000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0737 02427000
*                                                                  0737 02428000
         ALR   DMPINDEX,@03                                        0737 02429000
*       /*************************************************************/ 02430000
*       /*                                                           */ 02431000
*       /*                                                   @Y30LB31*/ 02432000
*       /*                                                           */ 02433000
*       /*************************************************************/ 02434000
*                                                                  0738 02435000
*       DMPTRM=DMPTRMVL;                                           0738 02436000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0738 02437000
*     END;                          /*                       @Y30LB31*/ 02438000
*   IF GDTDBG=NULLPTR THEN                                         0740 02439000
@RT00724 L     @15,@PC00001                                        0740 02440000
         L     @15,GDTDBG(,@15)                                    0740 02441000
         LTR   @15,@15                                             0740 02442000
         BZ    @RT00740                                            0740 02443000
*     ;                                                            0741 02444000
*   ELSE                                                           0742 02445000
*     CALL IDCDB010(GDTTBL,'SRS1',ADDR(DUMPLIST));/*         @Y30LB31*/ 02446000
         L     @15,@PC00001                                        0742 02447000
         ST    @15,@AL00001                                        0742 02448000
         LA    @14,@CC01510                                        0742 02449000
         ST    @14,@AL00001+4                                      0742 02450000
         LA    @14,DUMPLIST                                        0742 02451000
         ST    @14,@AFTEMPS+12                                     0742 02452000
         LA    @14,@AFTEMPS+12                                     0742 02453000
         ST    @14,@AL00001+8                                      0742 02454000
         MVI   @AL00001+8,X'80'                                    0742 02455000
         L     @15,GDTDBG(,@15)                                    0742 02456000
         LA    @01,@AL00001                                        0742 02457000
         BALR  @14,@15                                             0742 02458000
*                                                                  0743 02459000
*   /*****************************************************************/ 02460000
*   /*                                                               */ 02461000
*   /* CALL THE VOLUME SERVICE ROUTINE WHICH PERFORMS THE VTOC CHECK.*/ 02462000
*   /*                                                       @Y30LB31*/ 02463000
*   /*                                                               */ 02464000
*   /*****************************************************************/ 02465000
*                                                                  0743 02466000
*   CALL IDCSACL0(GDTTBL,IDCVS01,SECCHECK,VS1AGL);/*         @Y30LB31*/ 02467000
@RT00740 L     @02,@PC00001                                        0743 02468000
         ST    @02,@AL00001                                        0743 02469000
         LA    @15,@CC01505                                        0743 02470000
         ST    @15,@AL00001+4                                      0743 02471000
         LA    @15,SECCHECK                                        0743 02472000
         ST    @15,@AL00001+8                                      0743 02473000
         LA    @15,SRVS1LST                                        0743 02474000
         ST    @15,@AL00001+12                                     0743 02475000
         MVI   @AL00001+12,X'80'                                   0743 02476000
         L     @15,GDTCAL(,@02)                                    0743 02477000
         LA    @01,@AL00001                                        0743 02478000
         BALR  @14,@15                                             0743 02479000
*   RESPECIFY                                                      0744 02480000
*     RTNREG RSTD;                                                 0744 02481000
*   TESTRC=RTNREG;                                                 0745 02482000
         LR    TESTRC,RTNREG                                       0745 02483000
*   RESPECIFY                                                      0746 02484000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 02485000
*                                                                  0746 02486000
*   /*****************************************************************/ 02487000
*   /*                                                               */ 02488000
*   /* PROCESS THE RETURN CODE FROM THE VOL SERVICE ROUTINE. @Y30LB31*/ 02489000
*   /*                                                               */ 02490000
*   /*****************************************************************/ 02491000
*                                                                  0747 02492000
*   IF TESTRC=4 THEN                /*                       @Y30LB31*/ 02493000
         LA    @02,4                                               0747 02494000
         CR    TESTRC,@02                                          0747 02495000
         BNE   @RF00747                                            0747 02496000
*     VTOCKRC=4;                    /* SECURITY CHECK FAILED OR VSAM    02497000
*                                      STATUS NOT RETRIEVED. @Y30LB31*/ 02498000
         LR    VTOCKRC,@02                                         0748 02499000
*   ELSE                            /*                       @Y30LB31*/ 02500000
*     IF TESTRC=LASTCC08 THEN       /*                       @Y30LB31*/ 02501000
         B     @RC00747                                            0749 02502000
@RF00747 C     TESTRC,@CF00179                                     0749 02503000
         BNE   @RF00749                                            0749 02504000
*       CC04FLG=ON;                 /* A PASSWORD PROTECTED DATA SET    02505000
*                                      NOT CLOSED.           @Y30LB31*/ 02506000
*                                                                  0750 02507000
         OI    CC04FLG,B'10000000'                                 0750 02508000
*   /*****************************************************************/ 02509000
*   /*                                                               */ 02510000
*   /* CLOSE THE VTOC IF NOT CLOSED BY THE VOL SERVICES ROUTINE.     */ 02511000
*   /*                                                       @Y30LB31*/ 02512000
*   /*                                                               */ 02513000
*   /*****************************************************************/ 02514000
*                                                                  0751 02515000
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB31*/ 02516000
@RF00749 DS    0H                                                  0751 02517000
@RC00747 LA    @15,SRVS1LST                                        0751 02518000
         L     @14,VSIOP(,@15)                                     0751 02519000
         LTR   @14,@14                                             0751 02520000
         BZ    @RF00751                                            0751 02521000
*     DO;                           /*                       @Y30LB31*/ 02522000
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB31*/ 02523000
         L     @02,@PC00001                                        0753 02524000
         ST    @02,@AL00001                                        0753 02525000
         LA    @15,VSIOP(,@15)                                     0753 02526000
         ST    @15,@AL00001+4                                      0753 02527000
         MVI   @AL00001+4,X'80'                                    0753 02528000
         L     @15,GDTCLS(,@02)                                    0753 02529000
         LA    @01,@AL00001                                        0753 02530000
         BALR  @14,@15                                             0753 02531000
*       RESPECIFY                                                  0754 02532000
*         RTNREG RSTD;                                             0754 02533000
*       TESTRC=RTNREG;                                             0755 02534000
         LR    TESTRC,RTNREG                                       0755 02535000
*       RESPECIFY                                                  0756 02536000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 02537000
*                                                                  0756 02538000
*       /*************************************************************/ 02539000
*       /*                                                           */ 02540000
*       /* SET THE EOJ COND CODE FLAG IF THE CLOSE FAILED.   @Y30LB31*/ 02541000
*       /*                                                           */ 02542000
*       /*************************************************************/ 02543000
*                                                                  0757 02544000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 02545000
         LTR   TESTRC,TESTRC                                       0757 02546000
         BZ    @RF00757                                            0757 02547000
*         CC04FLG=ON;               /*                       @Y30LB31*/ 02548000
         OI    CC04FLG,B'10000000'                                 0758 02549000
*     END;                          /*                       @Y30LB31*/ 02550000
*                                                                  0759 02551000
@RF00757 DS    0H                                                  0760 02552000
*   /*****************************************************************/ 02553000
*   /*                                                               */ 02554000
*   /* RELEASE THE RESERVE SET BY THE VOL SERVICES ROUTINE IF THE    */ 02555000
*   /* DEACTIVATE PROCESSING MUST TERMINATE.                 @Y30LB31*/ 02556000
*   /*                                                               */ 02557000
*   /*****************************************************************/ 02558000
*                                                                  0760 02559000
*   IF VTOCKRC^=0 THEN              /*                       @Y30LB31*/ 02560000
@RF00751 LTR   VTOCKRC,VTOCKRC                                     0760 02561000
         BZ    @RF00760                                            0760 02562000
*     DO;                           /*                       @Y30LB31*/ 02563000
*       RNMSERNO=MSVIVOL#;          /*                       @Y30LB31*/ 02564000
         MVC   RNMSERNO(6),MSVIVOL#                                0762 02565000
*       RNMTRAIL='.VIRTUAL.RESERVE';/*                       @ZA05138*/ 02566000
         MVC   RNMTRAIL(16),@CC01496                               0763 02567000
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @Y30LB31*/ 02568000
         L     @15,@PC00001                                        0764 02569000
         ST    @15,@AL00001                                        0764 02570000
         LA    @14,@CC01366                                        0764 02571000
         ST    @14,@AL00001+4                                      0764 02572000
         LA    @14,MINORNM                                         0764 02573000
         ST    @14,@AL00001+8                                      0764 02574000
         MVI   @AL00001+8,X'80'                                    0764 02575000
         L     @15,GDTDEQ(,@15)                                    0764 02576000
         LA    @01,@AL00001                                        0764 02577000
         BALR  @14,@15                                             0764 02578000
*     END;                          /*                       @Y30LB31*/ 02579000
*                                                                  0765 02580000
*   /*****************************************************************/ 02581000
*   /*                                                               */ 02582000
*   /* WAS A USER CATALOG SPECIFIED? IF IT WAS AND AND IF THE DDNAME */ 02583000
*   /* WAS NOT SPECIFIED OR WAS SPECIFIED AS JOBCAT OR STEPCAT THEN  */ 02584000
*   /* IT IS AN ERROR. TERMINATION FOLLOWS.                  @ZM32529*/ 02585000
*   /*                                                               */ 02586000
*   /*****************************************************************/ 02587000
*                                                                  0766 02588000
*   IF VSUCAT=ON THEN               /*                       @ZM32529*/ 02589000
@RF00760 LA    @15,SRVS1LST                                        0766 02590000
         TM    VSUCAT(@15),B'01000000'                             0766 02591000
         BNO   @RF00766                                            0766 02592000
*     DO;                           /*                       @ZM32529*/ 02593000
*       IF VSCATDDP=NULLPTR|CATDDHLD=' ' THEN/*              @ZA09518*/ 02594000
         L     @15,VSCATDDP(,@15)                                  0768 02595000
         LTR   @15,@15                                             0768 02596000
         BZ    @RT00768                                            0768 02597000
         CLI   CATDDHLD,C' '                                       0768 02598000
         BNE   @RF00768                                            0768 02599000
@RT00768 DS    0H                                                  0769 02600000
*         DO;                       /*                       @ZM32529*/ 02601000
*           VTOCKRC=4;              /*                       @ZM32529*/ 02602000
         LA    VTOCKRC,4                                           0770 02603000
*           PRINTTBL=''B;           /*                       @ZM32529*/ 02604000
         XC    PRINTTBL(20),PRINTTBL                               0771 02605000
*           DARGSMOD=STORMSGS;      /*                       @ZM32529*/ 02606000
         L     @15,DDSTRU                                          0772 02607000
         MVC   DARGSMOD(3,@15),@CC01378                            0772 02608000
*           DARGSENT=MSG3745I;      /*                       @ZM32529*/ 02609000
         MVI   DARGSENT(@15),X'07'                                 0773 02610000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @ZM32529*/ 02611000
         L     @15,@PC00001                                        0774 02612000
         ST    @15,@AL00001                                        0774 02613000
         LA    @14,@CF00115                                        0774 02614000
         ST    @14,@AL00001+4                                      0774 02615000
         LA    @14,DDSTRU                                          0774 02616000
         ST    @14,@AL00001+8                                      0774 02617000
         MVI   @AL00001+8,X'80'                                    0774 02618000
         L     @15,GDTPRT(,@15)                                    0774 02619000
         LA    @01,@AL00001                                        0774 02620000
         BALR  @14,@15                                             0774 02621000
*         END;                      /*                       @ZM32529*/ 02622000
*       ELSE                        /*                       @ZM32529*/ 02623000
*         IF CATDDHLD='JOBCAT  '|CATDDHLD='STEPCAT ' THEN          0776 02624000
         B     @RC00768                                            0776 02625000
@RF00768 CLC   CATDDHLD(8),@CC01511                                0776 02626000
         BE    @RT00776                                            0776 02627000
         CLC   CATDDHLD(8),@CC01512                                0776 02628000
         BNE   @RF00776                                            0776 02629000
@RT00776 DS    0H                                                  0777 02630000
*           DO;                     /*                       @ZM32529*/ 02631000
*             VTOCKRC=4;            /*                       @ZM32529*/ 02632000
         LA    VTOCKRC,4                                           0778 02633000
*             PRINTTBL=''B;         /*                       @ZM32529*/ 02634000
         XC    PRINTTBL(20),PRINTTBL                               0779 02635000
*             DARGSMOD=STORMSGS;    /*                       @ZM32529*/ 02636000
         L     @15,DDSTRU                                          0780 02637000
         MVC   DARGSMOD(3,@15),@CC01378                            0780 02638000
*             DARGSENT=MSG3744I;    /*                       @ZM32529*/ 02639000
         MVI   DARGSENT(@15),X'06'                                 0781 02640000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @ZM32529*/ 02641000
         L     @15,@PC00001                                        0782 02642000
         ST    @15,@AL00001                                        0782 02643000
         LA    @14,@CF00115                                        0782 02644000
         ST    @14,@AL00001+4                                      0782 02645000
         LA    @14,DDSTRU                                          0782 02646000
         ST    @14,@AL00001+8                                      0782 02647000
         MVI   @AL00001+8,X'80'                                    0782 02648000
         L     @15,GDTPRT(,@15)                                    0782 02649000
         LA    @01,@AL00001                                        0782 02650000
         BALR  @14,@15                                             0782 02651000
*           END;                    /*                       @ZM32529*/ 02652000
*     END;                          /*                       @ZM32529*/ 02653000
*                                                                  0784 02654000
@RF00776 DS    0H                                                  0784 02655000
@RC00768 DS    0H                                                  0785 02656000
*   /*****************************************************************/ 02657000
*   /*                                                               */ 02658000
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT  */ 02659000
*   /* FROM VTOCKRTN. PASS THE CONDITION CODE IN REG 15.     @ZM32529*/ 02660000
*   /*                                                               */ 02661000
*   /*****************************************************************/ 02662000
*                                                                  0785 02663000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 02664000
@RF00766 LR    REG14,RETADDR3                                      0785 02665000
*   RETURN CODE(VTOCKRC);           /*                       @Y30LB31*/ 02666000
         LR    @15,VTOCKRC                                         0786 02667000
@EL00008 DS    0H                                                  0786 02668000
@EF00008 DS    0H                                                  0786 02669000
@ER00008 BR    @14                                                 0786 02670000
*   END VTOCKRTN;                   /*                       @Y30LB31*/ 02671000
*                                                                  0788 02672000
*/*********************************************************  @Y30LB31*/ 02673000
*/*                                                          @Y30LB31*/ 02674000
*/* PROCEDURE NAME - WORKRTN                                 @Y30LB31*/ 02675000
*/*                                                          @Y30LB31*/ 02676000
*/* FUNCTION - DIRECTS THE VOLUME AND CARTRIDGE LABEL UPDATE @Y30LB31*/ 02677000
*/*            FOR A NEW VOLUME SERIAL NO., THE DEACTIVATE,  @Y30LB31*/ 02678000
*/*            OPTIONAL VOLUME EJECT, AND RENAME BACKOUT DUE @Y30LB31*/ 02679000
*/*            TO ERRORS.  CALLS VLABLRTN, STORERTN, AND     @Y30LB31*/ 02680000
*/*            BKOUTRTN.  NO MESSAGES ARE ISSUED BY THIS     @Y30LB31*/ 02681000
*/*            PROC.                                         @Y30LB31*/ 02682000
*/*                                                          @Y30LB31*/ 02683000
*/* INPUT - FDTTBL                                           @Y30LB31*/ 02684000
*/*                                                          @Y30LB31*/ 02685000
*/* OUTPUT - RETURN CODE OF 0 INDICATES VOLUME SUCCESSFULLY  @Y30LB31*/ 02686000
*/*          DEACTIVATED AND, IF SPECIFIED, RENAMED AND/OR   @Y30LB31*/ 02687000
*/*          EJECTED.                                        @Y30LB31*/ 02688000
*/*          RETURN CODE OF 8 INDICATES VOLUME DEACTIVATED   @Y30LB31*/ 02689000
*/*          BUT COULD NOT BE EJECTED.  RETURN CODE OF 12    @Y30LB31*/ 02690000
*/*          INDICATES THE VOLUME COULD NOT BE DEACTIVATED   @Y30LB31*/ 02691000
*/*          OR RELABELED.                                   @Y30LB31*/ 02692000
*/*                                                          @Y30LB31*/ 02693000
*/*********************************************************  @Y30LB31*/ 02694000
*                                                                  0788 02695000
*WORKRTN:                                                          0788 02696000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 02697000
*                                                                  0788 02698000
WORKRTN  DS    0H                                                  0789 02699000
*   /*****************************************************************/ 02700000
*   /*                                                               */ 02701000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 02702000
*   /*                                                               */ 02703000
*   /*****************************************************************/ 02704000
*                                                                  0789 02705000
*   DCL                                                            0789 02706000
*     WORKRC FIXED(15);             /*                       @Y30LB31*/ 02707000
*                                                                  0789 02708000
*   /*****************************************************************/ 02709000
*   /*                                                               */ 02710000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */ 02711000
*   /*                                                       @Y30LB31*/ 02712000
*   /*                                                               */ 02713000
*   /*****************************************************************/ 02714000
*                                                                  0790 02715000
*   RETADDR1=REG14;                 /*                       @Y30LB31*/ 02716000
         ST    REG14,RETADDR1                                      0790 02717000
*   OLDERID2=NEWERID2;                                             0791 02718000
         L     @11,@PC00001                                        0791 02719000
         L     @11,GDTTR2(,@11)                                    0791 02720000
         MVC   @TS00001(95),NEWERID2(@11)                          0791 02721000
         MVC   OLDERID2(95,@11),@TS00001                           0791 02722000
*   NEWID2='SRWK';                  /*                       @Y30LB31*/ 02723000
*                                                                  0792 02724000
         MVC   NEWID2(4,@11),@CC01517                              0792 02725000
*   /*****************************************************************/ 02726000
*   /*                                                               */ 02727000
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/ 02728000
*   /*                                                               */ 02729000
*   /*****************************************************************/ 02730000
*                                                                  0793 02731000
*   WORKRC=LASTCC00;                /*                       @Y30LB31*/ 02732000
*                                                                  0793 02733000
         SLR   @11,@11                                             0793 02734000
         STH   @11,WORKRC                                          0793 02735000
*   /*****************************************************************/ 02736000
*   /*                                                               */ 02737000
*   /* IF THE VOL IS BEING RENAMED AS WELL AS DEACTIVATED, CALL      */ 02738000
*   /* VLABLRTN TO SET THE SERIAL MISMATCH FLAG IN THE MSVI AND TO   */ 02739000
*   /* UPDATE THE VOL LABEL WITH THE NEW VOL SER NO.         @Y30LB31*/ 02740000
*   /*                                                               */ 02741000
*   /*****************************************************************/ 02742000
*                                                                  0794 02743000
*   IF ADDR(NSER)^=NULLPTR THEN     /*                       @Y30LB31*/ 02744000
         L     @04,@PC00001+4                                      0794 02745000
         C     @11,FDTPTR+4(,@04)                                  0794 02746000
         BE    @RF00794                                            0794 02747000
*     DO;                           /*                       @Y30LB31*/ 02748000
*       CALL VLABLRTN;              /*                       @Y30LB31*/ 02749000
         BAL   @14,VLABLRTN                                        0796 02750000
*       RESPECIFY                                                  0797 02751000
*         RTNREG RSTD;                                             0797 02752000
*       TESTRC=RTNREG;                                             0798 02753000
         LR    TESTRC,RTNREG                                       0798 02754000
*       RESPECIFY                                                  0799 02755000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 02756000
*                                                                  0799 02757000
*       /*************************************************************/ 02758000
*       /*                                                           */ 02759000
*       /* EXIT FROM THIS PROC IF THE VOL LABEL COULD NOT BE UPDATED.*/ 02760000
*       /*                                                   @Y30LB31*/ 02761000
*       /*                                                           */ 02762000
*       /*************************************************************/ 02763000
*                                                                  0800 02764000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 02765000
         LTR   TESTRC,TESTRC                                       0800 02766000
         BZ    @RF00800                                            0800 02767000
*         WORKRC=4;                 /*                       @Y30LB31*/ 02768000
         MVC   WORKRC(2),@CH00042                                  0801 02769000
*     END;                          /*                       @Y30LB31*/ 02770000
@RF00800 DS    0H                                                  0803 02771000
*                                                                  0803 02772000
*   /*****************************************************************/ 02773000
*   /*                                                               */ 02774000
*   /* PROCEED TO DEACTIVATE THE VOLUME.                     @Y30LB31*/ 02775000
*   /*                                                               */ 02776000
*   /*****************************************************************/ 02777000
*                                                                  0803 02778000
*   IF WORKRC=0 THEN                /*                       @Y30LB31*/ 02779000
@RF00794 LH    @11,WORKRC                                          0803 02780000
         LTR   @11,@11                                             0803 02781000
         BNZ   @RF00803                                            0803 02782000
*     DO;                           /*                       @Y30LB31*/ 02783000
*       CALL STORERTN;              /*                       @Y30LB31*/ 02784000
         BAL   @14,STORERTN                                        0805 02785000
*       RESPECIFY                                                  0806 02786000
*         RTNREG RSTD;                                             0806 02787000
*       TESTRC=RTNREG;                                             0807 02788000
         LR    TESTRC,RTNREG                                       0807 02789000
*       RESPECIFY                                                  0808 02790000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 02791000
*                                                                  0808 02792000
*       /*************************************************************/ 02793000
*       /*                                                           */ 02794000
*       /* DETERMINE WHETHER AN ERROR OCCURRED STORING THE VOLUME.   */ 02795000
*       /* EXIT FROM THIS PROC IF THE VOLUME WAS DEACTIVATED ALTHOUGH*/ 02796000
*       /* NOT EJECTED AS REQUESTED.                         @Y30LB31*/ 02797000
*       /*                                                           */ 02798000
*       /*************************************************************/ 02799000
*                                                                  0809 02800000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 02801000
         LTR   TESTRC,TESTRC                                       0809 02802000
         BZ    @RF00809                                            0809 02803000
*         IF TESTRC=LASTCC08 THEN   /*                       @Y30LB31*/ 02804000
         LA    @11,8                                               0810 02805000
         CR    TESTRC,@11                                          0810 02806000
         BNE   @RF00810                                            0810 02807000
*           WORKRC=LASTCC08;        /*                       @Y30LB31*/ 02808000
*                                                                  0811 02809000
         STH   @11,WORKRC                                          0811 02810000
*       /*************************************************************/ 02811000
*       /*                                                           */ 02812000
*       /* EXIT FROM THIS PROC WITH A TERMINATING ERROR CODE AFTER   */ 02813000
*       /* RESTORING THE VOLUME LABEL TO ITS ORIGINAL STATUS, IF     */ 02814000
*       /* NECESSARY.                                        @Y30LB31*/ 02815000
*       /*                                                           */ 02816000
*       /*************************************************************/ 02817000
*                                                                  0812 02818000
*         ELSE                      /*                       @Y30LB31*/ 02819000
*           DO;                     /*                       @Y30LB31*/ 02820000
         B     @RC00810                                            0812 02821000
@RF00810 DS    0H                                                  0813 02822000
*             WORKRC=4;             /*                       @Y30LB31*/ 02823000
         MVC   WORKRC(2),@CH00042                                  0813 02824000
*             IF ADDR(NSER)^=NULLPTR THEN/*                  @Y30LB31*/ 02825000
         L     @11,@PC00001+4                                      0814 02826000
         L     @11,FDTPTR+4(,@11)                                  0814 02827000
         LTR   @11,@11                                             0814 02828000
         BZ    @RF00814                                            0814 02829000
*               CALL BKOUTRTN;      /*                       @Y30LB31*/ 02830000
         BAL   @14,BKOUTRTN                                        0815 02831000
*           END;                    /*                       @Y30LB31*/ 02832000
*                                                                  0816 02833000
@RF00814 DS    0H                                                  0817 02834000
*       /*************************************************************/ 02835000
*       /*                                                           */ 02836000
*       /* CLOSE DO GROUP THAT DEACTIVATED THE VOLUME.       @Y30LB31*/ 02837000
*       /*                                                           */ 02838000
*       /*************************************************************/ 02839000
*                                                                  0817 02840000
*     END;                          /*                       @Y30LB31*/ 02841000
*                                                                  0817 02842000
@RC00810 DS    0H                                                  0817 02843000
@RF00809 DS    0H                                                  0818 02844000
*   /*****************************************************************/ 02845000
*   /*                                                               */ 02846000
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT. */ 02847000
*   /* PASS THE CONDITION CODE IN REG 15.                    @Y30LB31*/ 02848000
*   /*                                                               */ 02849000
*   /*****************************************************************/ 02850000
*                                                                  0818 02851000
*   REG14=RETADDR1;                 /*                       @Y30LB31*/ 02852000
@RF00803 L     REG14,RETADDR1                                      0818 02853000
*   RETURN CODE(WORKRC);            /*                       @Y30LB31*/ 02854000
         LH    @15,WORKRC                                          0819 02855000
@EL00009 DS    0H                                                  0819 02856000
@EF00009 DS    0H                                                  0819 02857000
@ER00009 BR    @14                                                 0819 02858000
*   END WORKRTN;                    /*                       @Y30LB31*/ 02859000
*                                                                  0821 02860000
*/*********************************************************  @Y30LB31*/ 02861000
*/*                                                          @Y30LB31*/ 02862000
*/* PROCEDURE NAME - VLABLRTN                                @Y30LB31*/ 02863000
*/*                                                          @Y30LB31*/ 02864000
*/* FUNCTION - DIRECT THE VOLUME LABEL UPDATE FOR THE NEW    @Y30LB31*/ 02865000
*/*            VOL SER NO. AND SETTING OF THE SERIAL MIS-    @Y30LB31*/ 02866000
*/*            MATCH FLAG IN THE MSVI.  CALLS VS2RTN AND     @Y30LB31*/ 02867000
*/*            MVRRTN, TO PERFORM THESE FUNCTIONS.           @Y30LB31*/ 02868000
*/*            MESSAGE IDC0086I IS ISSUED IN THIS PROC.      @Y30LB31*/ 02869000
*/*                                                          @Y30LB31*/ 02870000
*/* INPUT - STORETBL, PRINTTBL FOR MSGS, BASEV FOR           @Y30LB31*/ 02871000
*/*         VOL RECORD.                                      @Y30LB31*/ 02872000
*/*                                                          @Y30LB31*/ 02873000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES VOL LABEL UPDATED  @Y30LB31*/ 02874000
*/*          WITH NEW VOL SER NO. AND SERIAL MISMATCH        @Y30LB31*/ 02875000
*/*          FLAG SET IN MSVI.  A RETURN CODE OF 4 INDICATES @Y30LB31*/ 02876000
*/*          THAT THE MISMATCH FLAG COULD NOT BE SET BEFORE  @Y30LB31*/ 02877000
*/*          UPDATING THE VOL LABEL OR THE VOL LABEL UPDATE  @Y30LB31*/ 02878000
*/*          FAILED.                                         @Y30LB31*/ 02879000
*/*                                                          @Y30LB31*/ 02880000
*/*********************************************************  @Y30LB31*/ 02881000
*                                                                  0821 02882000
*VLABLRTN:                                                         0821 02883000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 02884000
*                                                                  0821 02885000
VLABLRTN DS    0H                                                  0822 02886000
*   /*****************************************************************/ 02887000
*   /*                                                               */ 02888000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 02889000
*   /*                                                               */ 02890000
*   /*****************************************************************/ 02891000
*                                                                  0822 02892000
*   DCL                                                            0822 02893000
*     VLABLRC FIXED(15);            /*                       @Y30LB31*/ 02894000
*                                                                  0822 02895000
*   /*****************************************************************/ 02896000
*   /*                                                               */ 02897000
*   /* SAVE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT FOR THIS */ 02898000
*   /* PROC. INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS PROC.*/ 02899000
*   /*                                                       @Y30LB31*/ 02900000
*   /*                                                               */ 02901000
*   /*****************************************************************/ 02902000
*                                                                  0823 02903000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 02904000
         LR    RETADDR2,REG14                                      0823 02905000
*   OLDERID2=NEWERID2;                                             0824 02906000
         L     @11,@PC00001                                        0824 02907000
         L     @11,GDTTR2(,@11)                                    0824 02908000
         MVC   @TS00001(95),NEWERID2(@11)                          0824 02909000
         MVC   OLDERID2(95,@11),@TS00001                           0824 02910000
*   NEWID2='SRVL';                  /*                       @Y30LB31*/ 02911000
         MVC   NEWID2(4,@11),@CC01525                              0825 02912000
*   VLABLRC=LASTCC00;               /*                       @Y30LB31*/ 02913000
*                                                                  0826 02914000
         SLR   VLABLRC,VLABLRC                                     0826 02915000
*   /*****************************************************************/ 02916000
*   /*                                                               */ 02917000
*   /* SET THE MISMATCH FLAG AND UPDATE THE RECOVERY DATA IN THE MSVI*/ 02918000
*   /* IF 1) THE VOLUME IS NOT ALREADY FLAGGED DUE TO A PREVIOUS     */ 02919000
*   /* RENAME FAILURE OR 2) THE VOLUME IS FLAGGED BUT THE RECOVERY   */ 02920000
*   /* LABEL IN THE MSVI IS NOT THE SAME AS THE NEW SERIAL NO.       */ 02921000
*   /* SPECIFIED.                                            @Y30LB31*/ 02922000
*   /*                                                               */ 02923000
*   /*****************************************************************/ 02924000
*                                                                  0827 02925000
*   IF BASVSMIS=OFF|RECOVFLG=OFF THEN/*                      @Y30LB31*/ 02926000
         TM    BASVSMIS(BASEVPTR),B'00100000'                      0827 02927000
         BZ    @RT00827                                            0827 02928000
         TM    RECOVFLG,B'00010000'                                0827 02929000
         BNZ   @RF00827                                            0827 02930000
@RT00827 DS    0H                                                  0828 02931000
*     DO;                           /*                       @Y30LB31*/ 02932000
*       SETVSFLG=ON;                /*                       @Y30LB31*/ 02933000
         OI    SETVSFLG,B'00000010'                                0829 02934000
*       CALL MVRRTN;                /*                       @Y30LB31*/ 02935000
         BAL   @14,MVRRTN                                          0830 02936000
*       RESPECIFY                                                  0831 02937000
*         RTNREG RSTD;                                             0831 02938000
*       TESTRC=RTNREG;                                             0832 02939000
         LR    TESTRC,RTNREG                                       0832 02940000
*       RESPECIFY                                                  0833 02941000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 02942000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 02943000
         LTR   TESTRC,TESTRC                                       0834 02944000
         BZ    @RF00834                                            0834 02945000
*         VLABLRC=4;                /*                       @Y30LB31*/ 02946000
         LA    VLABLRC,4                                           0835 02947000
*     END;                          /*                       @Y30LB31*/ 02948000
@RF00834 DS    0H                                                  0837 02949000
*                                                                  0837 02950000
*   /*****************************************************************/ 02951000
*   /*                                                               */ 02952000
*   /* AFTER SETTING THE MISMATCH FLAG IN THE MSVI, UPDATE THE VOLUME*/ 02953000
*   /* LABEL WITH THE NEW VOL SER NO.                        @Y30LB31*/ 02954000
*   /*                                                               */ 02955000
*   /*****************************************************************/ 02956000
*                                                                  0837 02957000
*   IF VLABLRC=0 THEN               /*                       @Y30LB31*/ 02958000
@RF00827 LTR   VLABLRC,VLABLRC                                     0837 02959000
         BNZ   @RF00837                                            0837 02960000
*     DO;                           /*                       @Y30LB31*/ 02961000
*       CALL VS2RTN;                /*                       @Y30LB31*/ 02962000
         BAL   @14,VS2RTN                                          0839 02963000
*       RESPECIFY                                                  0840 02964000
*         RTNREG RSTD;                                             0840 02965000
*       TESTRC=RTNREG;                                             0841 02966000
         LR    TESTRC,RTNREG                                       0841 02967000
*       RESPECIFY                                                  0842 02968000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 02969000
*                                                                  0842 02970000
*       /*************************************************************/ 02971000
*       /*                                                           */ 02972000
*       /* IF THE VOL LABEL UPDATE FAILED, CLEAR THE MISMATCH FLAG   */ 02973000
*       /* FROM THE MSVI BEFORE TERMINATING UNLESS IT WAS SET BY A   */ 02974000
*       /* PREVIOUS JOB. IF SO, RESET THE RECOVERY DATA TO ITS       */ 02975000
*       /* ORIGINAL STATUS AT THE START OF THE JOB.          @Y30LB31*/ 02976000
*       /*                                                           */ 02977000
*       /*************************************************************/ 02978000
*                                                                  0843 02979000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 02980000
         LTR   TESTRC,TESTRC                                       0843 02981000
         BZ    @RF00843                                            0843 02982000
*         DO;                       /*                       @Y30LB31*/ 02983000
*           VLABLRC=4;              /*                       @Y30LB31*/ 02984000
         LA    VLABLRC,4                                           0845 02985000
*           IF VSMISFLG=ON THEN     /*                       @Y30LB31*/ 02986000
         TM    VSMISFLG,B'00000100'                                0846 02987000
         BNO   @RF00846                                            0846 02988000
*             DO;                   /*                       @Y30LB31*/ 02989000
*               SETVSFLG=OFF;       /*                       @Y30LB31*/ 02990000
         NI    SETVSFLG,B'11111101'                                0848 02991000
*               CALL MVRRTN;        /*                       @Y30LB31*/ 02992000
         BAL   @14,MVRRTN                                          0849 02993000
*             END;                  /*                       @Y30LB31*/ 02994000
*         END;                      /*                       @Y30LB31*/ 02995000
*                                                                  0851 02996000
*       /*************************************************************/ 02997000
*       /*                                                           */ 02998000
*       /* ISSUE MSG IDC0086I TO INDICATE THE VOLUME LABEL HAS BEEN  */ 02999000
*       /* UPDATED.                                          @Y30LB31*/ 03000000
*       /*                                                           */ 03001000
*       /*************************************************************/ 03002000
*                                                                  0852 03003000
*       ELSE                        /*                       @Y30LB31*/ 03004000
*         DO;                       /*                       @Y30LB31*/ 03005000
         B     @RC00843                                            0852 03006000
@RF00843 DS    0H                                                  0853 03007000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 03008000
         XC    PRINTTBL(20),PRINTTBL                               0853 03009000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 03010000
         L     @11,DDSTRU                                          0854 03011000
         MVC   DARGSMOD(3,@11),@CC01387                            0854 03012000
*           DARGSENT=MSG0086I;      /* STID=CM020            @Y30LB31*/ 03013000
         MVI   DARGSENT(@11),X'14'                                 0855 03014000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 03015000
         L     @11,@PC00001                                        0856 03016000
         ST    @11,@AL00001                                        0856 03017000
         LA    @06,@CF00115                                        0856 03018000
         ST    @06,@AL00001+4                                      0856 03019000
         LA    @06,DDSTRU                                          0856 03020000
         ST    @06,@AL00001+8                                      0856 03021000
         MVI   @AL00001+8,X'80'                                    0856 03022000
         L     @15,GDTPRT(,@11)                                    0856 03023000
         LA    @01,@AL00001                                        0856 03024000
         BALR  @14,@15                                             0856 03025000
*         END;                      /*                       @Y30LB31*/ 03026000
*                                                                  0857 03027000
*       /*************************************************************/ 03028000
*       /*                                                           */ 03029000
*       /* CLOSE DO GROUP WHICH UPDATED THE VOLUME LABEL.    @Y30LB31*/ 03030000
*       /*                                                           */ 03031000
*       /*************************************************************/ 03032000
*                                                                  0858 03033000
*     END;                          /*                       @Y30LB31*/ 03034000
*                                                                  0858 03035000
@RC00843 DS    0H                                                  0859 03036000
*   /*****************************************************************/ 03037000
*   /*                                                               */ 03038000
*   /* RELEASE THE RESERVE SET BY IDCVS01 OR IDCVS02 IF ERRORS WERE  */ 03039000
*   /* ENCOUNTERED UPDATING THE VOL LABEL.                   @Y30LB31*/ 03040000
*   /*                                                               */ 03041000
*   /*****************************************************************/ 03042000
*                                                                  0859 03043000
*   IF VLABLRC^=0 THEN              /*                       @Y30LB31*/ 03044000
@RF00837 LTR   VLABLRC,VLABLRC                                     0859 03045000
         BZ    @RF00859                                            0859 03046000
*     DO;                           /*                       @Y30LB31*/ 03047000
*       RNMSERNO=MSVIVOL#;          /*                       @Y30LB31*/ 03048000
         MVC   RNMSERNO(6),MSVIVOL#                                0861 03049000
*       RNMTRAIL='.VIRTUAL.RESERVE';/*                       @ZA05138*/ 03050000
         MVC   RNMTRAIL(16),@CC01496                               0862 03051000
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @Y30LB31*/ 03052000
         L     @11,@PC00001                                        0863 03053000
         ST    @11,@AL00001                                        0863 03054000
         LA    @06,@CC01366                                        0863 03055000
         ST    @06,@AL00001+4                                      0863 03056000
         LA    @06,MINORNM                                         0863 03057000
         ST    @06,@AL00001+8                                      0863 03058000
         MVI   @AL00001+8,X'80'                                    0863 03059000
         L     @15,GDTDEQ(,@11)                                    0863 03060000
         LA    @01,@AL00001                                        0863 03061000
         BALR  @14,@15                                             0863 03062000
*     END;                          /*                       @Y30LB31*/ 03063000
*                                                                  0864 03064000
*   /*****************************************************************/ 03065000
*   /*                                                               */ 03066000
*   /* RESTORE REG 14 TO THE RETURN ADDRESS OF THE CALLER AND EXIT   */ 03067000
*   /* FROM VLABLRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/ 03068000
*   /*                                                               */ 03069000
*   /*****************************************************************/ 03070000
*                                                                  0865 03071000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 03072000
@RF00859 LR    REG14,RETADDR2                                      0865 03073000
*   RETURN CODE(VLABLRC);           /*                       @Y30LB31*/ 03074000
         LR    @15,VLABLRC                                         0866 03075000
@EL00010 DS    0H                                                  0866 03076000
@EF00010 DS    0H                                                  0866 03077000
@ER00010 BR    @14                                                 0866 03078000
*   END VLABLRTN;                   /*                       @Y30LB31*/ 03079000
*                                                                  0868 03080000
*/*********************************************************  @Y30LB31*/ 03081000
*/*                                                          @Y30LB31*/ 03082000
*/* PROCEDURE NAME - MVRRTN                                  @Y30LB31*/ 03083000
*/*                                                          @Y30LB31*/ 03084000
*/* FUNCTION - SETS AND CLEARS THE VOLUME SERIAL MISMATCH    @Y30LB31*/ 03085000
*/*            FLAG FROM THE VOL RECORD IN THE MSVI.  CALLS  @Y30LB31*/ 03086000
*/*            SSCMSG TO OUTPUT A MSSC REASON CODE MESSAGE   @Y30LB31*/ 03087000
*/*            IF THE UPDATE FAILS.  ALSO ISSUES A SECONDARY @Y30LB31*/ 03088000
*/*            ERROR MSG IDC2065I.                           @Y30LB31*/ 03089000
*/*                                                          @Y30LB31*/ 03090000
*/* INPUT - FDTTBL, STORETBL, BASEV, PRINTTBL FOR MESSAGES   @Y30LB31*/ 03091000
*/*                                                          @Y30LB31*/ 03092000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES THE MISMATCH FLAG  @Y30LB31*/ 03093000
*/*          WAS SET CLEARED.  STORETBL MAY BE UPDATED.  A   @Y30LB31*/ 03094000
*/*          RETURN CODE OF 4 INDICATES THE MISMATCH FLAG    @Y30LB31*/ 03095000
*/*          WAS NOT SET OR CLEARED.                         @Y30LB31*/ 03096000
*/*                                                          @Y30LB31*/ 03097000
*/*********************************************************  @Y30LB31*/ 03098000
*                                                                  0868 03099000
*MVRRTN:                                                           0868 03100000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 03101000
*                                                                  0868 03102000
MVRRTN   DS    0H                                                  0869 03103000
*   /*****************************************************************/ 03104000
*   /*                                                               */ 03105000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 03106000
*   /*                                                               */ 03107000
*   /*****************************************************************/ 03108000
*                                                                  0869 03109000
*   DCL                                                            0869 03110000
*     MVRRTNRC FIXED(15);           /*                       @Y30LB31*/ 03111000
*                                                                  0869 03112000
*   /*****************************************************************/ 03113000
*   /*                                                               */ 03114000
*   /* SETUP A LOCAL STORAGE AREA TO BUILD THE MSVC MODIFY-VOL-RECORD*/ 03115000
*   /* PARM LIST.                                            @Y30LB31*/ 03116000
*   /*                                                               */ 03117000
*   /*****************************************************************/ 03118000
*                                                                  0870 03119000
*   DCL                                                            0870 03120000
*     1 SR01MVR BDY(WORD),          /*                       @Y30LB31*/ 03121000
*      2 SRMVRHDR CHAR(8),          /* MVR ARG LIST ID       @Y30LB31*/ 03122000
*      2 SRMVRTBL CHAR(LENGTH(MVR));/*                       @Y30LB31*/ 03123000
*                                                                  0870 03124000
*   /*****************************************************************/ 03125000
*   /*                                                               */ 03126000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE UPON EXIT FROM    */ 03127000
*   /* THIS PROC. INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS */ 03128000
*   /* PROC.                                                 @Y30LB31*/ 03129000
*   /*                                                               */ 03130000
*   /*****************************************************************/ 03131000
*                                                                  0871 03132000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 03133000
         LR    RETADDR3,REG14                                      0871 03134000
*   OLDERID2=NEWERID2;                                             0872 03135000
         L     @15,@PC00001                                        0872 03136000
         L     @15,GDTTR2(,@15)                                    0872 03137000
         MVC   @TS00001(95),NEWERID2(@15)                          0872 03138000
         MVC   OLDERID2(95,@15),@TS00001                           0872 03139000
*   NEWID2='SRMV';                  /*                       @Y30LB31*/ 03140000
         MVC   NEWID2(4,@15),@CC01535                              0873 03141000
*   MVRRTNRC=LASTCC00;              /*                       @Y30LB31*/ 03142000
*                                                                  0874 03143000
         SLR   MVRRTNRC,MVRRTNRC                                   0874 03144000
*   /*****************************************************************/ 03145000
*   /*                                                               */ 03146000
*   /* INITIALIZE THE MVR PARM LIST TO UPDATE THE SERIAL MISMATCH    */ 03147000
*   /* RECOVERY DATA IN THE MSVI.                            @Y30LB31*/ 03148000
*   /*                                                               */ 03149000
*   /*****************************************************************/ 03150000
*                                                                  0875 03151000
*   SRMVRHDR='MVR';                 /*                       @Y30LB31*/ 03152000
         MVI   SRMVRHDR+3,C' '                                     0875 03153000
         MVC   SRMVRHDR+4(4),SRMVRHDR+3                            0875 03154000
         MVC   SRMVRHDR(3),@CC01536                                0875 03155000
*   SRMVRTBL=''B;                   /*                       @Y30LB31*/ 03156000
         XC    SRMVRTBL(88),SRMVRTBL                               0876 03157000
*   MVRPTR=ADDR(SRMVRTBL);          /*                       @Y30LB31*/ 03158000
         LA    @15,SRMVRTBL                                        0877 03159000
         ST    @15,MVRPTR                                          0877 03160000
*   MVRLNGTH=MVRLEN;                /*                       @Y30LB31*/ 03161000
         LH    @14,MVRLEN                                          0878 03162000
         ST    @14,MVRLNGTH(,@15)                                  0878 03163000
*   MVRCODE=MVROP;                  /*                       @Y30LB31*/ 03164000
         XC    MVRCODE+1(3,@15),MVRCODE+1(@15)                     0879 03165000
         MVI   MVRCODE(@15),X'85'                                  0879 03166000
*   MVRBVOL=MSVIVOL#;               /*                       @Y30LB31*/ 03167000
         MVC   MVRBVOL(6,@15),MSVIVOL#                             0880 03168000
*   MVRFLBAS=ON;                    /*                       @Y30LB31*/ 03169000
*   MVRFLLAB=ON;                    /*                       @Y30LB31*/ 03170000
*                                                                  0882 03171000
         OI    MVRFLBAS(@15),B'00100001'                           0882 03172000
*   /*****************************************************************/ 03173000
*   /*                                                               */ 03174000
*   /* SET OR UPDATE THE MISMATCH RECOVERY DATA IN THE MSVI. @Y30LB31*/ 03175000
*   /*                                                               */ 03176000
*   /*****************************************************************/ 03177000
*                                                                  0883 03178000
*   IF SETVSFLG=ON THEN             /*                       @Y30LB31*/ 03179000
         TM    SETVSFLG,B'00000010'                                0883 03180000
         BNO   @RF00883                                            0883 03181000
*     DO;                           /*                       @Y30LB31*/ 03182000
*       MVRSLMIS=ON;                /* SET MISMATCH FLAG ON  @Y30LB31*/ 03183000
         OI    MVRSLMIS(@15),B'00000010'                           0885 03184000
*       MVRLABEL=NSERVAL;           /*                       @Y30LB31*/ 03185000
         L     @14,@PC00001+4                                      0886 03186000
         L     @01,FDTPTR+4(,@14)                                  0886 03187000
         MVC   MVRLABEL(6,@15),NSERVAL(@01)                        0886 03188000
*     END;                          /*                       @Y30LB31*/ 03189000
*                                                                  0887 03190000
*   /*****************************************************************/ 03191000
*   /*                                                               */ 03192000
*   /* CLEAR THE MISMATCH RECOVERY DATA FROM THE MSVI ONLY IF THE    */ 03193000
*   /* VOLUME WAS NOT FLAGGED DUE TO A PREVIOUS RENAME FAILURE.      */ 03194000
*   /*                                                       @Y30LB31*/ 03195000
*   /*                                                               */ 03196000
*   /*****************************************************************/ 03197000
*                                                                  0888 03198000
*   ELSE                            /*                       @Y30LB31*/ 03199000
*     IF BASVSMIS=OFF THEN          /*                       @Y30LB31*/ 03200000
         B     @RC00883                                            0888 03201000
@RF00883 TM    BASVSMIS(BASEVPTR),B'00100000'                      0888 03202000
         BNZ   @RF00888                                            0888 03203000
*       DO;                         /*                       @Y30LB31*/ 03204000
*         MVRCLMIS=ON;              /* CLEAR MISMATCH FLAG   @Y30LB31*/ 03205000
         L     @15,MVRPTR                                          0890 03206000
         OI    MVRCLMIS(@15),B'00000001'                           0890 03207000
*         MVRLABEL=BLANKIT;         /*                       @Y30LB31*/ 03208000
         MVI   MVRLABEL+1(@15),C' '                                0891 03209000
         MVC   MVRLABEL+2(4,@15),MVRLABEL+1(@15)                   0891 03210000
         MVI   MVRLABEL(@15),C' '                                  0891 03211000
*       END;                        /*                       @Y30LB31*/ 03212000
*                                                                  0892 03213000
*   /*****************************************************************/ 03214000
*   /*                                                               */ 03215000
*   /* RESET THE MISMATCH RECOVERY DATA TO ITS ORIGINAL STATUS AT THE*/ 03216000
*   /* START OF THE JOB IF THE VOLUME WAS FLAGGED DUE TO A PREVIOUS  */ 03217000
*   /* RENAME FAILURE.                                       @Y30LB31*/ 03218000
*   /*                                                               */ 03219000
*   /*****************************************************************/ 03220000
*                                                                  0893 03221000
*     ELSE                          /*                       @Y30LB31*/ 03222000
*       DO;                         /*                       @Y30LB31*/ 03223000
         B     @RC00888                                            0893 03224000
@RF00888 DS    0H                                                  0894 03225000
*         MVRSLMIS=ON;              /* RESET MISMATCH DATA   @Y30LB31*/ 03226000
         L     @15,MVRPTR                                          0894 03227000
         OI    MVRSLMIS(@15),B'00000010'                           0894 03228000
*         MVRLABEL=BASRECOV;        /*                       @Y30LB31*/ 03229000
         MVC   MVRLABEL(6,@15),BASRECOV(BASEVPTR)                  0895 03230000
*       END;                        /*                       @Y30LB31*/ 03231000
*                                                                  0896 03232000
*   /*****************************************************************/ 03233000
*   /*                                                               */ 03234000
*   /* TAKE A SYMBOLIC DUMP OF THE MOFIFY-VOL-REC PARM LIST BEFORE   */ 03235000
*   /* INVOKING MSVC TO UPDATE THE MISMATCH FLAG IN THE VOLUME       */ 03236000
*   /* RECORD.                                               @Y30LB31*/ 03237000
*   /*                                                               */ 03238000
*   /*****************************************************************/ 03239000
*                                                                  0897 03240000
*   IF GDTDBG=NULLPTR THEN                                         0897 03241000
@RC00888 DS    0H                                                  0897 03242000
@RC00883 L     @15,@PC00001                                        0897 03243000
         L     @15,GDTDBG(,@15)                                    0897 03244000
         LTR   @15,@15                                             0897 03245000
         BZ    @RT00897                                            0897 03246000
*     ;                                                            0898 03247000
*   ELSE                                                           0899 03248000
*     DO;                                                          0899 03249000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/ 03250000
         LA    DMPINDEX,DUMPLIST                                   0900 03251000
*       DMPITMNM='SR01MVR';                                        0901 03252000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0901 03253000
         MVC   DMPITMNM(7,DMPINDEX),@CC01537                       0901 03254000
*       DMPITMPT=ADDR(SR01MVR);                                    0902 03255000
         LA    @03,SR01MVR                                         0902 03256000
         ST    @03,DMPITMPT(,DMPINDEX)                             0902 03257000
*       DMPITMLN=LENGTH(SR01MVR);                                  0903 03258000
         MVC   DMPITMLN(2,DMPINDEX),@CH01703                       0903 03259000
*       DMPITMTP='H';                                              0904 03260000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0904 03261000
*       DMPINDEX=DMPINDEX+DMPELEMT; /*                       @Y30LB31*/ 03262000
         LA    @03,16                                              0905 03263000
         ALR   DMPINDEX,@03                                        0905 03264000
*       DMPITMNM='STORETBL';                                       0906 03265000
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       0906 03266000
*       DMPITMPT=ADDR(STORETBL);                                   0907 03267000
         LA    @15,STORETBL                                        0907 03268000
         ST    @15,DMPITMPT(,DMPINDEX)                             0907 03269000
*       DMPITMLN=LENGTH(STORETBL);                                 0908 03270000
         MVC   DMPITMLN(2,DMPINDEX),@CH01398                       0908 03271000
*       DMPITMTP='H';                                              0909 03272000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0909 03273000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0910 03274000
*                                                                  0910 03275000
         ALR   DMPINDEX,@03                                        0910 03276000
*       /*************************************************************/ 03277000
*       /*                                                           */ 03278000
*       /*                                                   @Y30LB31*/ 03279000
*       /*                                                           */ 03280000
*       /*************************************************************/ 03281000
*                                                                  0911 03282000
*       DMPTRM=DMPTRMVL;                                           0911 03283000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0911 03284000
*     END;                          /*                       @Y30LB31*/ 03285000
*   IF GDTDBG=NULLPTR THEN                                         0913 03286000
@RT00897 L     @15,@PC00001                                        0913 03287000
         L     @15,GDTDBG(,@15)                                    0913 03288000
         LTR   @15,@15                                             0913 03289000
         BZ    @RT00913                                            0913 03290000
*     ;                                                            0914 03291000
*   ELSE                                                           0915 03292000
*     CALL IDCDB010(GDTTBL,'SRSM',ADDR(DUMPLIST));/*         @Y30LB31*/ 03293000
*                                                                  0915 03294000
         L     @15,@PC00001                                        0915 03295000
         ST    @15,@AL00001                                        0915 03296000
         LA    @14,@CC01538                                        0915 03297000
         ST    @14,@AL00001+4                                      0915 03298000
         LA    @14,DUMPLIST                                        0915 03299000
         ST    @14,@AFTEMPS+16                                     0915 03300000
         LA    @14,@AFTEMPS+16                                     0915 03301000
         ST    @14,@AL00001+8                                      0915 03302000
         MVI   @AL00001+8,X'80'                                    0915 03303000
         L     @15,GDTDBG(,@15)                                    0915 03304000
         LA    @01,@AL00001                                        0915 03305000
         BALR  @14,@15                                             0915 03306000
*   /*****************************************************************/ 03307000
*   /*                                                               */ 03308000
*   /* INVOKE MSVC TO UPDATE THE SERIAL MISMATCH FLAG IN THE         */ 03309000
*   /* INVENTORY RECORD.                                     @Y30LB31*/ 03310000
*   /*                                                               */ 03311000
*   /*****************************************************************/ 03312000
*                                                                  0916 03313000
*   CALL IDCSASS0(GDTTBL,VVIC,MVRPTR,REASON);/*              @Y30LB31*/ 03314000
@RT00913 L     @02,@PC00001                                        0916 03315000
         ST    @02,@AL00001                                        0916 03316000
         LA    @15,VVIC                                            0916 03317000
         ST    @15,@AL00001+4                                      0916 03318000
         LA    @15,MVRPTR                                          0916 03319000
         ST    @15,@AL00001+8                                      0916 03320000
         LA    @15,REASON                                          0916 03321000
         ST    @15,@AL00001+12                                     0916 03322000
         MVI   @AL00001+12,X'80'                                   0916 03323000
         L     @15,GDTSSC(,@02)                                    0916 03324000
         LA    @01,@AL00001                                        0916 03325000
         BALR  @14,@15                                             0916 03326000
*   RESPECIFY                                                      0917 03327000
*     RTNREG RSTD;                                                 0917 03328000
*   TESTRC=RTNREG;                                                 0918 03329000
         LR    TESTRC,RTNREG                                       0918 03330000
*   RESPECIFY                                                      0919 03331000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 03332000
*                                                                  0919 03333000
*   /*****************************************************************/ 03334000
*   /*                                                               */ 03335000
*   /* IF MSVC ENCOUNTERED AN I/O ERROR UPDATING THE INVENTORY, TREAT*/ 03336000
*   /* THIS AS A MINOR ERROR REQUIRING AN EOJ FINAL CONDITION CODE OF*/ 03337000
*   /* AT LEAST 4.                                           @Y30LB31*/ 03338000
*   /*                                                               */ 03339000
*   /*****************************************************************/ 03340000
*                                                                  0920 03341000
*   IF TESTRC=12 THEN               /*                       @Y30LB31*/ 03342000
         C     TESTRC,@CF00565                                     0920 03343000
         BNE   @RF00920                                            0920 03344000
*     DO;                           /*                       @Y30LB31*/ 03345000
*       TESTRC=LASTCC00;            /*                       @Y30LB31*/ 03346000
         SLR   TESTRC,TESTRC                                       0922 03347000
*       CC04FLG=ON;                 /*                       @Y30LB31*/ 03348000
         OI    CC04FLG,B'10000000'                                 0923 03349000
*     END;                          /*                       @Y30LB31*/ 03350000
*                                                                  0925 03351000
*   /*****************************************************************/ 03352000
*   /*                                                               */ 03353000
*   /* IF THE MISMATCH FLAG COULD NOT BE UPDATED IN THE VOLUME       */ 03354000
*   /* RECORD, ISSUE THE APPROPRIATE MESSAGE CONTAINING THE MSSC     */ 03355000
*   /* REASON CODE.                                          @Y30LB31*/ 03356000
*   /*                                                               */ 03357000
*   /*****************************************************************/ 03358000
*                                                                  0925 03359000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 03360000
@RF00920 LTR   TESTRC,TESTRC                                       0925 03361000
         BZ    @RF00925                                            0925 03362000
*     DO;                           /*                       @Y30LB31*/ 03363000
*       MVRRTNRC=4;                 /*                       @Y30LB31*/ 03364000
         LA    MVRRTNRC,4                                          0927 03365000
*       CALL SSCMSG(REASON);        /*                       @Y30LB31*/ 03366000
*                                                                  0928 03367000
         LA    @15,REASON                                          0928 03368000
         ST    @15,@AL00001                                        0928 03369000
         LA    @01,@AL00001                                        0928 03370000
         BAL   @14,SSCMSG                                          0928 03371000
*       /*************************************************************/ 03372000
*       /*                                                           */ 03373000
*       /* OUTPUT SECONDARY ERROR MSG IDC2065I, IF THE MISMATCH FLAG */ 03374000
*       /* COULD NOT BE CLEARED.                             @Y30LB31*/ 03375000
*       /*                                                           */ 03376000
*       /*************************************************************/ 03377000
*                                                                  0929 03378000
*       IF SETVSFLG=OFF THEN        /*                       @Y30LB31*/ 03379000
         TM    SETVSFLG,B'00000010'                                0929 03380000
         BNZ   @RF00929                                            0929 03381000
*         DO;                       /*                       @Y30LB31*/ 03382000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 03383000
         XC    PRINTTBL(20),PRINTTBL                               0931 03384000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 03385000
         L     @15,DDSTRU                                          0932 03386000
         MVC   DARGSMOD(3,@15),@CC01387                            0932 03387000
*           DARGSENT=MSG2065I;      /* STID=CM045            @Y30LB31*/ 03388000
         MVI   DARGSENT(@15),X'2D'                                 0933 03389000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 03390000
         L     @15,@PC00001                                        0934 03391000
         ST    @15,@AL00001                                        0934 03392000
         LA    @14,@CF00115                                        0934 03393000
         ST    @14,@AL00001+4                                      0934 03394000
         LA    @14,DDSTRU                                          0934 03395000
         ST    @14,@AL00001+8                                      0934 03396000
         MVI   @AL00001+8,X'80'                                    0934 03397000
         L     @15,GDTPRT(,@15)                                    0934 03398000
         LA    @01,@AL00001                                        0934 03399000
         BALR  @14,@15                                             0934 03400000
*         END;                      /*                       @Y30LB31*/ 03401000
*     END;                          /*                       @Y30LB31*/ 03402000
*                                                                  0936 03403000
*   /*****************************************************************/ 03404000
*   /*                                                               */ 03405000
*   /* SET AN INDICATOR THAT THE MISMATCH FLAG MUST BE CLEARED BEFORE*/ 03406000
*   /* EOJ OR HAS BEEN CLEARED.                              @Y30LB31*/ 03407000
*   /*                                                               */ 03408000
*   /*****************************************************************/ 03409000
*                                                                  0937 03410000
*   ELSE                            /*                       @Y30LB31*/ 03411000
*     IF SETVSFLG=ON THEN           /*                       @Y30LB31*/ 03412000
         B     @RC00925                                            0937 03413000
@RF00925 TM    SETVSFLG,B'00000010'                                0937 03414000
         BNO   @RF00937                                            0937 03415000
*       VSMISFLG=ON;                /*                       @Y30LB31*/ 03416000
         OI    VSMISFLG,B'00000100'                                0938 03417000
*     ELSE                          /*                       @Y30LB31*/ 03418000
*       VSMISFLG=OFF;               /*                       @Y30LB31*/ 03419000
*                                                                  0939 03420000
         B     @RC00937                                            0939 03421000
@RF00937 NI    VSMISFLG,B'11111011'                                0939 03422000
*   /*****************************************************************/ 03423000
*   /*                                                               */ 03424000
*   /* RESTORE REG 14 WITH CALLERS RETURN ADDRESS AND EXIT FROM      */ 03425000
*   /* MVRRTN. PASS THE CONDITION CODE IN REG 15.            @Y30LB31*/ 03426000
*   /*                                                               */ 03427000
*   /*****************************************************************/ 03428000
*                                                                  0940 03429000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 03430000
@RC00937 DS    0H                                                  0940 03431000
@RC00925 LR    REG14,RETADDR3                                      0940 03432000
*   RETURN CODE(MVRRTNRC);          /*                       @Y30LB31*/ 03433000
         LR    @15,MVRRTNRC                                        0941 03434000
@EL00011 DS    0H                                                  0941 03435000
@EF00011 DS    0H                                                  0941 03436000
@ER00011 BR    @14                                                 0941 03437000
*   END MVRRTN;                     /*                       @Y30LB31*/ 03438000
*                                                                  0943 03439000
*/*********************************************************  @Y30LB31*/ 03440000
*/*                                                          @Y30LB31*/ 03441000
*/* PROCEDURE NAME - VS2RTN                                  @Y30LB31*/ 03442000
*/*                                                          @Y30LB31*/ 03443000
*/* FUNCTION - UPDATES THE VOLUME LABEL WITH THE NEW VOLUME  @Y30LB31*/ 03444000
*/*            SERIAL NO.  NO MESSAGES ARE ISSUED BY THIS    @Y30LB31*/ 03445000
*/*            PROC.                                         @Y30LB31*/ 03446000
*/*                                                          @Y30LB31*/ 03447000
*/* INPUT - FDTTBL, STORETBL, BASEV                          @Y30LB31*/ 03448000
*/*                                                          @Y30LB31*/ 03449000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES A SUCCESSFUL VOL   @Y30LB31*/ 03450000
*/*          LABEL UDPATE.  ADDVTBL MAY BE UPDATED.          @Y30LB31*/ 03451000
*/*          A RETURN CODE OF 4 INDICATES THE VOL LABEL      @Y30LB31*/ 03452000
*/*          UPDATE FAILED.                                  @Y30LB31*/ 03453000
*/*                                                          @Y30LB31*/ 03454000
*/*********************************************************  @Y30LB31*/ 03455000
*                                                                  0943 03456000
*VS2RTN:                                                           0943 03457000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 03458000
*                                                                  0943 03459000
VS2RTN   DS    0H                                                  0944 03460000
*   /*****************************************************************/ 03461000
*   /*                                                               */ 03462000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 03463000
*   /*                                                               */ 03464000
*   /*****************************************************************/ 03465000
*                                                                  0944 03466000
*   DCL                                                            0944 03467000
*     VS2RTNRC FIXED(15);           /*                       @Y30LB31*/ 03468000
*                                                                  0944 03469000
*   /*****************************************************************/ 03470000
*   /*                                                               */ 03471000
*   /* SETUP LOCAL STORAGE AREA TO BUILD THE PARM LIST FOR THE SECOND*/ 03472000
*   /* VOLUME SERVICES ROUTINE WHICH READS AND UPDATES VOLUME LABELS.*/ 03473000
*   /*                                                       @Y30LB31*/ 03474000
*   /*                                                               */ 03475000
*   /*****************************************************************/ 03476000
*                                                                  0945 03477000
*   DCL                                                            0945 03478000
*     SRVS2LST CHAR(LENGTH(VS2AGL)) BDY(WORD);/*             @Y30LB31*/ 03479000
*   DCL                                                            0946 03480000
*     IDCVS02 CHAR(8) CONSTANT('IDCVS02 ');/*                @Y30LB31*/ 03481000
*                                                                  0946 03482000
*   /*****************************************************************/ 03483000
*   /*                                                               */ 03484000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT FROM */ 03485000
*   /* THIS PROC. INITIALIZE TO ZERO THE CONDITION CODE USED BY THIS */ 03486000
*   /* PROC.                                                 @Y30LB31*/ 03487000
*   /*                                                               */ 03488000
*   /*****************************************************************/ 03489000
*                                                                  0947 03490000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 03491000
         LR    RETADDR3,REG14                                      0947 03492000
*   OLDERID2=NEWERID2;                                             0948 03493000
         L     @15,@PC00001                                        0948 03494000
         L     @15,GDTTR2(,@15)                                    0948 03495000
         MVC   @TS00001(95),NEWERID2(@15)                          0948 03496000
         MVC   OLDERID2(95,@15),@TS00001                           0948 03497000
*   NEWID2='SRS2';                  /*                       @Y30LB31*/ 03498000
         MVC   NEWID2(4,@15),@CC01546                              0949 03499000
*   VS2RTNRC=LASTCC00;              /*                       @Y30LB31*/ 03500000
*                                                                  0950 03501000
         SLR   VS2RTNRC,VS2RTNRC                                   0950 03502000
*   /*****************************************************************/ 03503000
*   /*                                                               */ 03504000
*   /* ZERO OUT AND INITIALIZE THE VS2 ARGUMENT LIST IF THE VOLUME   */ 03505000
*   /* LABEL IS BEING UPDATED WITH THE NEW SERIAL NO.        @Y30LB31*/ 03506000
*   /*                                                               */ 03507000
*   /*****************************************************************/ 03508000
*                                                                  0951 03509000
*   IF BKOUTFLG=OFF THEN            /*                       @Y30LB31*/ 03510000
         TM    BKOUTFLG,B'00001000'                                0951 03511000
         BNZ   @RF00951                                            0951 03512000
*     DO;                           /*                       @Y30LB31*/ 03513000
*       RESPECIFY                                                  0953 03514000
*         VS2AGL BASED(ADDR(SRVS2LST));/*                    @Y30LB31*/ 03515000
*       SRVS2LST=''B;               /*                       @Y30LB31*/ 03516000
         XC    SRVS2LST(45),SRVS2LST                               0954 03517000
*       VSVOLSER=ON;                /* UPDATE VOL SER FLAG   @Y30LB31*/ 03518000
         LA    @15,SRVS2LST                                        0955 03519000
         OI    VSVOLSER(@15),B'01000000'                           0955 03520000
*       VSDDNAME=SUNITDDN;          /*                       @Y30LB31*/ 03521000
         MVC   VSDDNAME(8,@15),SUNITDDN                            0956 03522000
*       VSVOLUME=MSVIVOL#;          /*                       @Y30LB31*/ 03523000
         MVC   VSVOLUME(6,@15),MSVIVOL#                            0957 03524000
*       VSUCBPTR=ADDR(SUNITUCB);    /*                       @Y30LB31*/ 03525000
         LA    @14,SUNITUCB                                        0958 03526000
         ST    @14,VSUCBPTR(,@15)                                  0958 03527000
*       VSVOLPTR=ADDR(NSERVAL);     /*                       @Y30LB31*/ 03528000
         L     @14,@PC00001+4                                      0959 03529000
         L     @01,FDTPTR+4(,@14)                                  0959 03530000
         LA    @14,NSERVAL(,@01)                                   0959 03531000
         ST    @14,VSVOLPTR(,@15)                                  0959 03532000
*     END;                          /*                       @Y30LB31*/ 03533000
*                                                                  0960 03534000
*   /*****************************************************************/ 03535000
*   /*                                                               */ 03536000
*   /* RESTORE THE VOL LABEL TO ITS ORIGINAL STATUS IF THE DEACTIVATE*/ 03537000
*   /* FAILED. USE THE RECOVERY DATA FROM THE MSVI RECORD RETRIEVED  */ 03538000
*   /* AT THE START OF THE PROGRAM IF THE VOLUME IS FLAGGED DUE TO A */ 03539000
*   /* PREVIOUS RENAME FAILURE. THE RECOVERY DATA REFLECTS THE VOL   */ 03540000
*   /* SERIAL NO. ACTUALLY RECORDED IN THE VOLUME LABEL.     @Y30LB31*/ 03541000
*   /*                                                               */ 03542000
*   /*****************************************************************/ 03543000
*                                                                  0961 03544000
*   ELSE                            /*                       @Y30LB31*/ 03545000
*     IF BASVSMIS=OFF THEN          /*                       @Y30LB31*/ 03546000
         B     @RC00951                                            0961 03547000
@RF00951 TM    BASVSMIS(BASEVPTR),B'00100000'                      0961 03548000
         BNZ   @RF00961                                            0961 03549000
*       VSVOLPTR=ADDR(VOLVAL);      /*                       @Y30LB31*/ 03550000
         LA    @15,SRVS2LST                                        0962 03551000
         L     @14,@PC00001+4                                      0962 03552000
         L     @01,FDTPTR(,@14)                                    0962 03553000
         LA    @14,VOLVAL(,@01)                                    0962 03554000
         ST    @14,VSVOLPTR(,@15)                                  0962 03555000
*     ELSE                          /*                       @Y30LB31*/ 03556000
*       VSVOLPTR=ADDR(BASRECOV);    /*                       @Y30LB31*/ 03557000
*                                                                  0963 03558000
         B     @RC00961                                            0963 03559000
@RF00961 LA    @15,SRVS2LST                                        0963 03560000
         LA    @14,BASRECOV(,BASEVPTR)                             0963 03561000
         ST    @14,VSVOLPTR(,@15)                                  0963 03562000
*   /*****************************************************************/ 03563000
*   /*                                                               */ 03564000
*   /* REQUEST A RESERVE BE SET DURING THE VOLUME LABEL UPDATE UNLESS*/ 03565000
*   /* A PREVIOUS RESERVE SET BY THE VTOC VOLUME SERVICES ROUTINE IS */ 03566000
*   /* STILL IN EFFECT.                                      @Y30LB31*/ 03567000
*   /*                                                               */ 03568000
*   /*****************************************************************/ 03569000
*                                                                  0964 03570000
*   IF RECOVFLG=ON|BKOUTFLG=ON THEN /*                       @Y30LB31*/ 03571000
@RC00961 DS    0H                                                  0964 03572000
@RC00951 TM    RECOVFLG,B'00011000'                                0964 03573000
         BZ    @RF00964                                            0964 03574000
*     VS2RES=ON;                    /*                       @Y30LB31*/ 03575000
         LA    @15,SRVS2LST                                        0965 03576000
         OI    VS2RES(@15),B'10000000'                             0965 03577000
*   ELSE                            /*                       @Y30LB31*/ 03578000
*     VS2RES=OFF;                   /*                       @Y30LB31*/ 03579000
*                                                                  0966 03580000
         B     @RC00964                                            0966 03581000
@RF00964 LA    @15,SRVS2LST                                        0966 03582000
         NI    VS2RES(@15),B'01111111'                             0966 03583000
*   /*****************************************************************/ 03584000
*   /*                                                               */ 03585000
*   /* TAKE A SYMBOLIC DUMP OF THE VS2 PARM LIST BEFORE INVOKING THE */ 03586000
*   /* VOLUME SERIVCES ROUTINE THAT UPDATE THE VOLUME LABEL. @Y30LB31*/ 03587000
*   /*                                                               */ 03588000
*   /*****************************************************************/ 03589000
*                                                                  0967 03590000
*   IF GDTDBG=NULLPTR THEN                                         0967 03591000
@RC00964 L     @15,@PC00001                                        0967 03592000
         L     @15,GDTDBG(,@15)                                    0967 03593000
         LTR   @15,@15                                             0967 03594000
         BZ    @RT00967                                            0967 03595000
*     ;                                                            0968 03596000
*   ELSE                                                           0969 03597000
*     DO;                                                          0969 03598000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/ 03599000
         LA    DMPINDEX,DUMPLIST                                   0970 03600000
*       DMPITMNM='SRVS2LST';                                       0971 03601000
         MVC   DMPITMNM(8,DMPINDEX),@CC01549                       0971 03602000
*       DMPITMPT=ADDR(SRVS2LST);                                   0972 03603000
         LA    @03,SRVS2LST                                        0972 03604000
         ST    @03,DMPITMPT(,DMPINDEX)                             0972 03605000
*       DMPITMLN=LENGTH(SRVS2LST);                                 0973 03606000
         LA    @03,45                                              0973 03607000
         STH   @03,DMPITMLN(,DMPINDEX)                             0973 03608000
*       DMPITMTP='H';                                              0974 03609000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0974 03610000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0975 03611000
*                                                                  0975 03612000
         LA    @15,16                                              0975 03613000
         ALR   DMPINDEX,@15                                        0975 03614000
*       /*************************************************************/ 03615000
*       /*                                                           */ 03616000
*       /*                                                   @Y30LB31*/ 03617000
*       /*                                                           */ 03618000
*       /*************************************************************/ 03619000
*                                                                  0976 03620000
*       DMPITMNM='STORETBL';                                       0976 03621000
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       0976 03622000
*       DMPITMPT=ADDR(STORETBL);                                   0977 03623000
         LA    @14,STORETBL                                        0977 03624000
         ST    @14,DMPITMPT(,DMPINDEX)                             0977 03625000
*       DMPITMLN=LENGTH(STORETBL);                                 0978 03626000
         STH   @03,DMPITMLN(,DMPINDEX)                             0978 03627000
*       DMPITMTP='H';                                              0979 03628000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0979 03629000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0980 03630000
*                                                                  0980 03631000
         ALR   DMPINDEX,@15                                        0980 03632000
*       /*************************************************************/ 03633000
*       /*                                                           */ 03634000
*       /*                                                   @Y30LB31*/ 03635000
*       /*                                                           */ 03636000
*       /*************************************************************/ 03637000
*                                                                  0981 03638000
*       DMPTRM=DMPTRMVL;                                           0981 03639000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0981 03640000
*     END;                          /*                       @Y30LB31*/ 03641000
*   IF GDTDBG=NULLPTR THEN                                         0983 03642000
@RT00967 L     @15,@PC00001                                        0983 03643000
         L     @15,GDTDBG(,@15)                                    0983 03644000
         LTR   @15,@15                                             0983 03645000
         BZ    @RT00983                                            0983 03646000
*     ;                                                            0984 03647000
*   ELSE                                                           0985 03648000
*     CALL IDCDB010(GDTTBL,'SRNS',ADDR(DUMPLIST));/*         @Y30LB31*/ 03649000
*                                                                  0985 03650000
         L     @15,@PC00001                                        0985 03651000
         ST    @15,@AL00001                                        0985 03652000
         LA    @14,@CC01550                                        0985 03653000
         ST    @14,@AL00001+4                                      0985 03654000
         LA    @14,DUMPLIST                                        0985 03655000
         ST    @14,@AFTEMPS+20                                     0985 03656000
         LA    @14,@AFTEMPS+20                                     0985 03657000
         ST    @14,@AL00001+8                                      0985 03658000
         MVI   @AL00001+8,X'80'                                    0985 03659000
         L     @15,GDTDBG(,@15)                                    0985 03660000
         LA    @01,@AL00001                                        0985 03661000
         BALR  @14,@15                                             0985 03662000
*   /*****************************************************************/ 03663000
*   /*                                                               */ 03664000
*   /* INVOKE THE SECOND VOLUME SERVICES ROUTINE TO PERFORM THE      */ 03665000
*   /* VOLUME LABEL UPDATE FOR THE NEW VOLUME SERIAL NO.     @Y30LB31*/ 03666000
*   /*                                                               */ 03667000
*   /*****************************************************************/ 03668000
*                                                                  0986 03669000
*   CALL IDCSACL0(GDTTBL,IDCVS02,PUTLABEL,VS2AGL);/*         @Y30LB31*/ 03670000
@RT00983 L     @02,@PC00001                                        0986 03671000
         ST    @02,@AL00001                                        0986 03672000
         LA    @15,@CC01545                                        0986 03673000
         ST    @15,@AL00001+4                                      0986 03674000
         LA    @15,PUTLABEL                                        0986 03675000
         ST    @15,@AL00001+8                                      0986 03676000
         LA    @15,SRVS2LST                                        0986 03677000
         ST    @15,@AL00001+12                                     0986 03678000
         MVI   @AL00001+12,X'80'                                   0986 03679000
         L     @15,GDTCAL(,@02)                                    0986 03680000
         LA    @01,@AL00001                                        0986 03681000
         BALR  @14,@15                                             0986 03682000
*   RESPECIFY                                                      0987 03683000
*     RTNREG RSTD;                                                 0987 03684000
*   TESTRC=RTNREG;                                                 0988 03685000
         LR    TESTRC,RTNREG                                       0988 03686000
*   RESPECIFY                                                      0989 03687000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 03688000
*                                                                  0990 03689000
*   /*****************************************************************/ 03690000
*   /*                                                               */ 03691000
*   /* TEST THE RETURN CODE FROM THE REQUEST TO UPDATE THE VOLUME    */ 03692000
*   /* LABEL. IF THE UPDATE WAS SUCCESSFUL BUT THE VTOC COULD NOT BE */ 03693000
*   /* CLOSED BY THE VOL SERV ROUTINE, TREAT THIS AS A MINOR ERROR   */ 03694000
*   /* REQUIRING AN EOJ FINAL CONDITION CODE OF AT LEAST 4.  @Y30LB31*/ 03695000
*   /*                                                               */ 03696000
*   /*****************************************************************/ 03697000
*                                                                  0990 03698000
*   IF TESTRC=8 THEN                /*                       @Y30LB31*/ 03699000
         C     TESTRC,@CF00179                                     0990 03700000
         BNE   @RF00990                                            0990 03701000
*     CC04FLG=ON;                   /*                       @Y30LB31*/ 03702000
*                                                                  0991 03703000
         OI    CC04FLG,B'10000000'                                 0991 03704000
*   /*****************************************************************/ 03705000
*   /*                                                               */ 03706000
*   /* EXIT WITH AN UNSUCCESSFUL CONDITION CODE IF THE VOLUME UPDATE */ 03707000
*   /* FAILED.                                               @Y30LB31*/ 03708000
*   /*                                                               */ 03709000
*   /*****************************************************************/ 03710000
*                                                                  0992 03711000
*   ELSE                            /*                       @Y30LB31*/ 03712000
*     IF TESTRC=4 THEN              /*                       @Y30LB31*/ 03713000
         B     @RC00990                                            0992 03714000
@RF00990 LA    @02,4                                               0992 03715000
         CR    TESTRC,@02                                          0992 03716000
         BNE   @RF00992                                            0992 03717000
*       VS2RTNRC=4;                 /*                       @Y30LB31*/ 03718000
*                                                                  0993 03719000
         LR    VS2RTNRC,@02                                        0993 03720000
*   /*****************************************************************/ 03721000
*   /*                                                               */ 03722000
*   /* RESTORE REG 14 WITH THE CALLERS RETURN ADDRESS AND EXIT FROM  */ 03723000
*   /* THIS PROC. PASS THE CONDITION CODE TO THE CALLER IN REG 15.   */ 03724000
*   /*                                                       @Y30LB31*/ 03725000
*   /*                                                               */ 03726000
*   /*****************************************************************/ 03727000
*                                                                  0994 03728000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 03729000
@RF00992 DS    0H                                                  0994 03730000
@RC00990 LR    REG14,RETADDR3                                      0994 03731000
*   RETURN CODE(VS2RTNRC);          /*                       @Y30LB31*/ 03732000
         LR    @15,VS2RTNRC                                        0995 03733000
@EL00012 DS    0H                                                  0995 03734000
@EF00012 DS    0H                                                  0995 03735000
@ER00012 BR    @14                                                 0995 03736000
*   END VS2RTN;                     /*                       @Y30LB31*/ 03737000
*                                                                  0997 03738000
*/*********************************************************  @Y30LB31*/ 03739000
*/*                                                          @Y30LB31*/ 03740000
*/* PROCEDURE NAME - STORERTN                                @Y30LB31*/ 03741000
*/*                                                          @Y30LB31*/ 03742000
*/* FUNCTION - DIRECTS THE VOLUME DEMOUNT, DEACTIVATE,       @Y30LB31*/ 03743000
*/*            AND OPTIONAL VOLUME EJECT.  CALLS VPREPRTN,   @Y30LB31*/ 03744000
*/*            DEACTRTN, AND VOLEXIT TO EPRFORM THESE        @Y30LB31*/ 03745000
*/*            FUNCTIONS.  NO MESSAGES ARE ISSUED BY THIS    @Y30LB31*/ 03746000
*/*            PROC.                                         @Y30LB31*/ 03747000
*/*                                                          @Y30LB31*/ 03748000
*/* INPUT - FDTTBL, STORETBL                                 @Y30LB31*/ 03749000
*/*                                                          @Y30LB31*/ 03750000
*/* OUTPUT - A RETURN CODE OF 0 INDICATES                    @Y30LB31*/ 03751000
*/*          VOL DEACTIVATED AND OPTIONALLY EJECTED.         @Y30LB31*/ 03752000
*/*          A RETURN CODE OF 4 INDICATES VOL NOT DEACTI-    @Y30LB31*/ 03753000
*/*          VATED.  A RETURN CODE OF 8 INDICATES VOL        @Y30LB31*/ 03754000
*/*          DEACTIVATED BUT NOT EJECTED.                    @Y30LB31*/ 03755000
*/*                                                          @Y30LB31*/ 03756000
*/*********************************************************  @Y30LB31*/ 03757000
*                                                                  0997 03758000
*STORERTN:                                                         0997 03759000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 03760000
*                                                                  0997 03761000
STORERTN DS    0H                                                  0998 03762000
*   /*****************************************************************/ 03763000
*   /*                                                               */ 03764000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 03765000
*   /*                                                               */ 03766000
*   /*****************************************************************/ 03767000
*                                                                  0998 03768000
*   DCL                                                            0998 03769000
*     STORERC FIXED(15);            /*                       @Y30LB31*/ 03770000
*                                                                  0998 03771000
*   /*****************************************************************/ 03772000
*   /*                                                               */ 03773000
*   /* LOCAL DECLARATIONS REQUIRED TO INVOKE VOLEXIT TO EJECT THE    */ 03774000
*   /* DEACTIVATED VOLUME.                                   @Y30LB31*/ 03775000
*   /*                                                               */ 03776000
*   /*****************************************************************/ 03777000
*                                                                  0999 03778000
*   DCL                                                            0999 03779000
*     RECDISP BIT(8);               /* SAVE OR DELETE PARM   @Y30LB31*/ 03780000
*   DCL                                                            1000 03781000
*     SAVEREC BIT(8) CONSTANT('80'X);/* SAVE MSVI RECORD     @Y30LB31*/ 03782000
*   DCL                                                            1001 03783000
*     ERASEREC BIT(8) CONSTANT('00'X);/* DELETE MSVI RECORD  @Y30LB31*/ 03784000
*   DCL                                                            1002 03785000
*     LOCDATA CHAR(30);             /* DESTINATION INFO      @Y30LB31*/ 03786000
*   DCL                                                            1003 03787000
*     1 IOERRFLG BIT(8),            /*                       @Y30LB31*/ 03788000
*      2 ERRORBIT BIT(1);           /* MSVC I/O ERROR FLAG   @Y30LB31*/ 03789000
*                                                                  1003 03790000
*   /*****************************************************************/ 03791000
*   /*                                                               */ 03792000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */ 03793000
*   /*                                                       @Y30LB31*/ 03794000
*   /*                                                               */ 03795000
*   /*****************************************************************/ 03796000
*                                                                  1004 03797000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 03798000
         LR    RETADDR2,REG14                                      1004 03799000
*   OLDERID2=NEWERID2;                                             1005 03800000
         L     @11,@PC00001                                        1005 03801000
         L     @11,GDTTR2(,@11)                                    1005 03802000
         MVC   @TS00001(95),NEWERID2(@11)                          1005 03803000
         MVC   OLDERID2(95,@11),@TS00001                           1005 03804000
*   NEWID2='SRSR';                  /*                       @Y30LB31*/ 03805000
*                                                                  1006 03806000
         MVC   NEWID2(4,@11),@CC01562                              1006 03807000
*   /*****************************************************************/ 03808000
*   /*                                                               */ 03809000
*   /* ZERO OUT THE CONDITION CODE SET BY THIS PROC.         @Y30LB31*/ 03810000
*   /*                                                               */ 03811000
*   /*****************************************************************/ 03812000
*                                                                  1007 03813000
*   STORERC=LASTCC00;               /*                       @Y30LB31*/ 03814000
*                                                                  1007 03815000
         SLR   @11,@11                                             1007 03816000
         STH   @11,STORERC                                         1007 03817000
*   /*****************************************************************/ 03818000
*   /*                                                               */ 03819000
*   /* DEMOUNT THE VOLUME IN ORDER TO DEACTIVATE IT.         @Y30LB31*/ 03820000
*   /*                                                               */ 03821000
*   /*****************************************************************/ 03822000
*                                                                  1008 03823000
*   MOUNTFLG=OFF;                   /*                       @Y30LB31*/ 03824000
         NI    MOUNTFLG,B'10111111'                                1008 03825000
*   VPREPVOL=MSVIVOL#;              /*                       @Y30LB31*/ 03826000
         MVC   VPREPVOL(6),MSVIVOL#                                1009 03827000
*   CALL VPREPRTN;                  /*                       @Y30LB31*/ 03828000
         BAL   @14,VPREPRTN                                        1010 03829000
*   RESPECIFY                                                      1011 03830000
*     RTNREG RSTD;                                                 1011 03831000
*   TESTRC=RTNREG;                                                 1012 03832000
         LR    TESTRC,RTNREG                                       1012 03833000
*   RESPECIFY                                                      1013 03834000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 03835000
*                                                                  1013 03836000
*   /*****************************************************************/ 03837000
*   /*                                                               */ 03838000
*   /* EXIT FROM THIS PROC. IF THE DEMOUNT FAILED.           @Y30LB31*/ 03839000
*   /*                                                               */ 03840000
*   /*****************************************************************/ 03841000
*                                                                  1014 03842000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 03843000
         LTR   TESTRC,TESTRC                                       1014 03844000
         BZ    @RF01014                                            1014 03845000
*     STORERC=4;                    /*                       @Y30LB31*/ 03846000
         MVC   STORERC(2),@CH00042                                 1015 03847000
*                                                                  1016 03848000
*   /*****************************************************************/ 03849000
*   /*                                                               */ 03850000
*   /* DEACTIVATE THE VOLUME AND IF THE VOLUME IS BEING RENAMED,     */ 03851000
*   /* CHANGE THE VOLUME SERIAL NO. IN THE CARTRIDGE LABELS AND CLEAR*/ 03852000
*   /* THE MISMATCH FLAG FROM THE MSVI.                      @Y30LB31*/ 03853000
*   /*                                                               */ 03854000
*   /*****************************************************************/ 03855000
*                                                                  1016 03856000
*   ELSE                            /*                       @Y30LB31*/ 03857000
*     DO;                           /*                       @Y30LB31*/ 03858000
         B     @RC01014                                            1016 03859000
@RF01014 DS    0H                                                  1017 03860000
*       CALL DEACTRTN;              /*                       @Y30LB31*/ 03861000
         BAL   @14,DEACTRTN                                        1017 03862000
*       RESPECIFY                                                  1018 03863000
*         RTNREG RSTD;                                             1018 03864000
*       TESTRC=RTNREG;                                             1019 03865000
         LR    TESTRC,RTNREG                                       1019 03866000
*       RESPECIFY                                                  1020 03867000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 03868000
*                                                                  1020 03869000
*       /*************************************************************/ 03870000
*       /*                                                           */ 03871000
*       /* EXIT FROM THIS PROC. IF THE DEACTIVATE FAILED.    @Y30LB31*/ 03872000
*       /*                                                           */ 03873000
*       /*************************************************************/ 03874000
*                                                                  1021 03875000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 03876000
         LTR   TESTRC,TESTRC                                       1021 03877000
         BZ    @RF01021                                            1021 03878000
*         STORERC=4;                /*                       @Y30LB31*/ 03879000
*                                                                  1022 03880000
         MVC   STORERC(2),@CH00042                                 1022 03881000
*       /*************************************************************/ 03882000
*       /*                                                           */ 03883000
*       /* EJECT THE DEACTIVATED VOLUME IF REQUESTED.        @Y30LB31*/ 03884000
*       /*                                                           */ 03885000
*       /*************************************************************/ 03886000
*                                                                  1023 03887000
*       ELSE                        /*                       @Y30LB31*/ 03888000
*         IF ADDR(EJECT)^=NULLPTR THEN/*                     @Y30LB31*/ 03889000
         B     @RC01021                                            1023 03890000
@RF01021 SLR   @11,@11                                             1023 03891000
         L     @06,@PC00001+4                                      1023 03892000
         C     @11,FDTPTR+8(,@06)                                  1023 03893000
         BE    @RF01023                                            1023 03894000
*           DO;                     /*                       @Y30LB31*/ 03895000
*             IF ADDR(REC)^=NULLPTR THEN/*                   @Y30LB31*/ 03896000
         C     @11,FDTPTR+16(,@06)                                 1025 03897000
         BE    @RF01025                                            1025 03898000
*               RECDISP=SAVEREC;    /*                       @Y30LB31*/ 03899000
         MVI   RECDISP,X'80'                                       1026 03900000
*             ELSE                  /*                       @Y30LB31*/ 03901000
*               RECDISP=ERASEREC;   /*                       @Y30LB31*/ 03902000
         B     @RC01025                                            1027 03903000
@RF01025 MVI   RECDISP,X'00'                                       1027 03904000
*             IF ADDR(LOC)^=NULLPTR THEN/*                   @Y30LB31*/ 03905000
@RC01025 L     @11,@PC00001+4                                      1028 03906000
         L     @11,FDTPTR+24(,@11)                                 1028 03907000
         LTR   @11,@11                                             1028 03908000
         BZ    @RF01028                                            1028 03909000
*               LOCDATA=LOCVAL;     /*                       @Y30LB31*/ 03910000
         MVC   LOCDATA(30),LOCVAL(@11)                             1029 03911000
*             ELSE                  /*                       @Y30LB31*/ 03912000
*               LOCDATA=BLANKIT;    /*                       @Y30LB31*/ 03913000
         B     @RC01028                                            1030 03914000
@RF01028 MVI   LOCDATA+1,C' '                                      1030 03915000
         MVC   LOCDATA+2(28),LOCDATA+1                             1030 03916000
         MVI   LOCDATA,C' '                                        1030 03917000
*             ERRORBIT=OFF;         /*                       @Y30LB31*/ 03918000
@RC01028 NI    ERRORBIT,B'01111111'                                1031 03919000
*             CALL VOLEXIT(CSN1,MSVIVOL#,IOERRFLG,/*         @Y30LB31*/ 03920000
*                 RECDISP,LOCDATA); /*                       @Y30LB31*/ 03921000
         LA    @11,CSN1                                            1032 03922000
         ST    @11,@AL00001                                        1032 03923000
         LA    @11,MSVIVOL#                                        1032 03924000
         ST    @11,@AL00001+4                                      1032 03925000
         LA    @11,IOERRFLG                                        1032 03926000
         ST    @11,@AL00001+8                                      1032 03927000
         LA    @11,RECDISP                                         1032 03928000
         ST    @11,@AL00001+12                                     1032 03929000
         LA    @11,LOCDATA                                         1032 03930000
         ST    @11,@AL00001+16                                     1032 03931000
         LA    @01,@AL00001                                        1032 03932000
         BAL   @14,VOLEXIT                                         1032 03933000
*             RESPECIFY                                            1033 03934000
*               RTNREG RSTD;                                       1033 03935000
*             TESTRC=RTNREG;                                       1034 03936000
         LR    TESTRC,RTNREG                                       1034 03937000
*             RESPECIFY                                            1035 03938000
*               RTNREG UNRSTD;      /*                       @Y30LB31*/ 03939000
*             IF TESTRC^=0 THEN     /*                       @Y30LB31*/ 03940000
         LTR   TESTRC,TESTRC                                       1036 03941000
         BZ    @RF01036                                            1036 03942000
*               STORERC=LASTCC08;   /*                       @Y30LB31*/ 03943000
*                                                                  1037 03944000
         MVC   STORERC(2),@CH00179                                 1037 03945000
*             /*******************************************************/ 03946000
*             /*                                                     */ 03947000
*             /* CHECK WHETHER MSVC HAD AN I/O ERROR UPDATING THE    */ 03948000
*             /* MSVI DURING THE EJECT OPERATION.            @Y30LB31*/ 03949000
*             /*                                                     */ 03950000
*             /*******************************************************/ 03951000
*                                                                  1038 03952000
*             IF ERRORBIT=ON THEN   /*                       @Y30LB31*/ 03953000
@RF01036 TM    ERRORBIT,B'10000000'                                1038 03954000
         BNO   @RF01038                                            1038 03955000
*               CC04FLG=ON;         /*                       @Y30LB31*/ 03956000
         OI    CC04FLG,B'10000000'                                 1039 03957000
*           END;                    /*                       @Y30LB31*/ 03958000
@RF01038 DS    0H                                                  1041 03959000
*     END;                          /*                       @Y30LB31*/ 03960000
*                                                                  1041 03961000
@RF01023 DS    0H                                                  1041 03962000
@RC01021 DS    0H                                                  1042 03963000
*   /*****************************************************************/ 03964000
*   /*                                                               */ 03965000
*   /* RESTORE REG14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT. */ 03966000
*   /* PASS THE CONDITION CODE IN REG 15.                    @Y30LB31*/ 03967000
*   /*                                                               */ 03968000
*   /*****************************************************************/ 03969000
*                                                                  1042 03970000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 03971000
@RC01014 LR    REG14,RETADDR2                                      1042 03972000
*   RETURN CODE(STORERC);           /*                       @Y30LB31*/ 03973000
         LH    @15,STORERC                                         1043 03974000
@EL00013 DS    0H                                                  1043 03975000
@EF00013 DS    0H                                                  1043 03976000
@ER00013 BR    @14                                                 1043 03977000
*   END STORERTN;                   /*                       @Y30LB31*/ 03978000
*                                                                  1045 03979000
*/*********************************************************  @Y30LB31*/ 03980000
*/*                                                          @Y30LB31*/ 03981000
*/* PROCEDURE NAME - DEACTRTN                                @Y30LB31*/ 03982000
*/*                                                          @Y30LB31*/ 03983000
*/* FUNCTION - DEACTIVATES THE VOLUME AND OPTIONALLY CHANGES @Y30LB31*/ 03984000
*/*            THE VOLUME SERIAL NO. IN THE CART LABELS      @Y30LB31*/ 03985000
*/*            AND IN THE INVENTORY.  CALLS SSCMSG TO PRINT  @Y30LB31*/ 03986000
*/*            A MESSAGE WITH MSSC REASON CODE IF THE MSC    @Y30LB31*/ 03987000
*/*            AND DEACTIVATE RENAME ORDER FAILED.  MSGS     @Y30LB31*/ 03988000
*/*            IDC0731I, IDC3732I, AND IDC0064I ARE ISSUED.  @Y30LB31*/ 03989000
*/*                                                          @Y30LB31*/ 03990000
*/* INPUT - FDTTBL, STORETBL, DARGLIST FOR MSGS, CMMSG.      @Y30LB31*/ 03991000
*/*                                                          @Y30LB31*/ 03992000
*/* OUTPUT - RETURN CODE OF 0 INDICATES SUCCESSFUL           @Y30LB31*/ 03993000
*/*          DEACTIVATE WITH OPTIONAL RENAME RETURN CODE OF  @Y30LB31*/ 03994000
*/*          4 INDICATES DEACTIVATE FAILED.                  @Y30LB31*/ 03995000
*/*                                                          @Y30LB31*/ 03996000
*/*********************************************************  @Y30LB31*/ 03997000
*                                                                  1045 03998000
*DEACTRTN:                                                         1045 03999000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 04000000
*                                                                  1045 04001000
DEACTRTN DS    0H                                                  1046 04002000
*   /*****************************************************************/ 04003000
*   /*                                                               */ 04004000
*   /* LOCAL DECLARATIONS.                                   @Y30LB31*/ 04005000
*   /*                                                               */ 04006000
*   /*****************************************************************/ 04007000
*                                                                  1046 04008000
*   DCL                                                            1046 04009000
*     DEACTRC FIXED(15);            /* LOCAL CONDITION CODE  @Y30LB31*/ 04010000
*   DCL                                                            1047 04011000
*     NOCHANGE BIT(8) CONSTANT('FF'X);/*                     @Y30LB31*/ 04012000
*                                                                  1047 04013000
*   /*****************************************************************/ 04014000
*   /*                                                               */ 04015000
*   /* SETUP STORAGE AREA TO BUILD THE MSSC AND MSIC DEFINE PARAMETER*/ 04016000
*   /* LISTS.                                                @Y30LB31*/ 04017000
*   /*                                                               */ 04018000
*   /*****************************************************************/ 04019000
*                                                                  1048 04020000
*   DECLARE                         /*                       @Y30LB31*/ 04021000
*     1 SR01DEFV BDY(WORD),         /*                       @Y30LB31*/ 04022000
*      2 SDEFVHDR CHAR(8),          /* DEFLIST IDENTIFIER    @Y30LB31*/ 04023000
*      2 SDEFVLST CHAR(LENGTH(DEFLIST)),/*                   @Y30LB31*/ 04024000
*      2 SDEFVEHD CHAR(8),          /* DEFVE IDENTIFIER      @Y30LB31*/ 04025000
*      2 SDEFVEXT CHAR(LENGTH(DEFVE));/*                     @Y30LB31*/ 04026000
*                                                                  1048 04027000
*   /*****************************************************************/ 04028000
*   /*                                                               */ 04029000
*   /* SAVE THE RETURN ADDRESS OF CALLER SINCE THERE IS NO SAVEAREA. */ 04030000
*   /* REG 14 WILL BE RESTORED UPON EXIT.                    @Y30LB31*/ 04031000
*   /*                                                               */ 04032000
*   /*****************************************************************/ 04033000
*                                                                  1049 04034000
*   RETADDR3=REG14;                 /*                       @Y30LB31*/ 04035000
         LR    RETADDR3,REG14                                      1049 04036000
*   OLDERID2=NEWERID2;                                             1050 04037000
         L     @06,@PC00001                                        1050 04038000
         L     @06,GDTTR2(,@06)                                    1050 04039000
         MVC   @TS00001(95),NEWERID2(@06)                          1050 04040000
         MVC   OLDERID2(95,@06),@TS00001                           1050 04041000
*   NEWID2='SRDE';                  /*                       @Y30LB31*/ 04042000
*                                                                  1051 04043000
         MVC   NEWID2(4,@06),@CC01575                              1051 04044000
*   /*****************************************************************/ 04045000
*   /*                                                               */ 04046000
*   /* INITIALIZE TO ZERO THE CONDITION CODE USED WITHIN THIS        */ 04047000
*   /* PROCEDURE. ZERO THE PARM LISTS BEFORE INITIALIZING.   @Y30LB31*/ 04048000
*   /*                                                               */ 04049000
*   /*****************************************************************/ 04050000
*                                                                  1052 04051000
*   DEACTRC=LASTCC00;               /*                       @Y30LB31*/ 04052000
         SLR   @06,@06                                             1052 04053000
         LR    DEACTRC,@06                                         1052 04054000
*   SR01DEFV=''B;                   /* ZERO DEF TBL + EXTS   @Y30LB31*/ 04055000
         XC    SR01DEFV(212),SR01DEFV                              1053 04056000
*   SDEFVHDR='DEFLIST';             /* DEFINE TBL IDENTIFIER @Y30LB31*/ 04057000
         MVI   SDEFVHDR+7,C' '                                     1054 04058000
         MVC   SDEFVHDR(7),@CC01576                                1054 04059000
*   SDEFVEHD='DEFVE';               /* DEF TBL EXTENSIONS ID @Y30LB31*/ 04060000
         MVI   SDEFVEHD+5,C' '                                     1055 04061000
         MVC   SDEFVEHD+6(2),SDEFVEHD+5                            1055 04062000
         MVC   SDEFVEHD(5),@CC01577                                1055 04063000
*   DEFVEPTR=ADDR(SDEFVEXT);        /* MSIC DEFINE ARG LIST  @Y30LB31*/ 04064000
         LA    DEFVEPTR,SDEFVEXT                                   1056 04065000
*   DEFVPTR=ADDR(SDEFVLST);         /* MSS DEFINE ARG LIST   @Y30LB31*/ 04066000
         LA    @02,SDEFVLST                                        1057 04067000
         ST    @02,DEFVPTR                                         1057 04068000
*   DEFVOLD=MSVIVOL#;               /*                       @Y30LB31*/ 04069000
         MVC   DEFVOLD(6,@02),MSVIVOL#                             1058 04070000
*   DEFVVFLG=NOCHANGE;              /*                       @Y30LB31*/ 04071000
*                                                                  1059 04072000
         MVI   DEFVVFLG(@02),X'FF'                                 1059 04073000
*   /*****************************************************************/ 04074000
*   /*                                                               */ 04075000
*   /* SET THE APPROPRIATE REQUEST OPTION DETERMINED BY WHETHER THE  */ 04076000
*   /* VOLUME IS ONLY BEING DEACTIVATED OR DEACTIVATED PLUS RENAMED. */ 04077000
*   /*                                                       @Y30LB31*/ 04078000
*   /*                                                               */ 04079000
*   /*****************************************************************/ 04080000
*                                                                  1060 04081000
*   IF ADDR(NSER)=NULLPTR THEN      /*                       @Y30LB31*/ 04082000
         L     @15,@PC00001+4                                      1060 04083000
         C     @06,FDTPTR+4(,@15)                                  1060 04084000
         BNE   @RF01060                                            1060 04085000
*     DEFVDACT=ON;                  /*                       @Y30LB31*/ 04086000
         OI    DEFVDACT(@02),B'00000001'                           1061 04087000
*   ELSE                            /*                       @Y30LB31*/ 04088000
*     DO;                           /*                       @Y30LB31*/ 04089000
         B     @RC01060                                            1062 04090000
@RF01060 DS    0H                                                  1063 04091000
*       DEFVRNM=ON;                 /*                       @Y30LB31*/ 04092000
         L     @06,DEFVPTR                                         1063 04093000
         OI    DEFVRNM(@06),B'00100000'                            1063 04094000
*       DEFVNVOL=NSERVAL;           /*                       @Y30LB31*/ 04095000
         L     @02,@PC00001+4                                      1064 04096000
         L     @01,FDTPTR+4(,@02)                                  1064 04097000
         MVC   DEFVNVOL(6,@06),NSERVAL(@01)                        1064 04098000
*       DEFVVEXT=DEFVEPTR;          /*                       @Y30LB31*/ 04099000
*                                                                  1065 04100000
         ST    DEFVEPTR,DEFVVEXT(,@06)                             1065 04101000
*       /*************************************************************/ 04102000
*       /*                                                           */ 04103000
*       /* INITIALIZE DEFVE PARM LIST TO CLEAR THE MISMATCH FLAG. IF */ 04104000
*       /* NO RECORD AND EJECT ARE SPECIFIED, SET THE DUPLICATE VOL  */ 04105000
*       /* INDICATOR TO ALLOW FOR A DUPLICATE WHEN RENAMING. @Y30LB31*/ 04106000
*       /*                                                           */ 04107000
*       /*************************************************************/ 04108000
*                                                                  1066 04109000
*       DEFLABEL=BLANKIT;           /*                       @Y30LB31*/ 04110000
         MVI   DEFLABEL+1(DEFVEPTR),C' '                           1066 04111000
         MVC   DEFLABEL+2(4,DEFVEPTR),DEFLABEL+1(DEFVEPTR)         1066 04112000
         MVI   DEFLABEL(DEFVEPTR),C' '                             1066 04113000
*       DEFPVLAB=ON;                /*                       @Y30LB31*/ 04114000
         OI    DEFPVLAB(DEFVEPTR),B'01000000'                      1067 04115000
*       DEFCRCVY=ON;                /*                       @Y30LB31*/ 04116000
         OI    DEFCRCVY(DEFVEPTR),B'01000000'                      1068 04117000
*       DEFLAMIS=ON;                /*                       @Y30LB31*/ 04118000
         OI    DEFLAMIS(DEFVEPTR),B'00100000'                      1069 04119000
*       DEFLNGTH=DEFLEN;            /*                       @Y30LB31*/ 04120000
         LH    @06,DEFLEN                                          1070 04121000
         ST    @06,DEFLNGTH(,DEFVEPTR)                             1070 04122000
*       IF ADDR(EJECT)^=NULLPTR&ADDR(NREC)^=NULLPTR THEN/*   @Y30LB31*/ 04123000
         SLR   @06,@06                                             1071 04124000
         C     @06,FDTPTR+8(,@02)                                  1071 04125000
         BE    @RF01071                                            1071 04126000
         C     @06,FDTPTR+20(,@02)                                 1071 04127000
         BE    @RF01071                                            1071 04128000
*         DEFDUP=ON;                /*                       @Y30LB31*/ 04129000
         OI    DEFDUP(DEFVEPTR),B'00100000'                        1072 04130000
*     END;                          /*                       @Y30LB31*/ 04131000
*                                                                  1073 04132000
@RF01071 DS    0H                                                  1074 04133000
*   /*****************************************************************/ 04134000
*   /*                                                               */ 04135000
*   /* TAKE A SYMBOLIC DUMP OF THE DEFINE ORDER PARM LIST BEFORE THE */ 04136000
*   /* DEACTIVATE OR RENAME REQUEST IS EXECUTED.             @Y30LB31*/ 04137000
*   /*                                                               */ 04138000
*   /*****************************************************************/ 04139000
*                                                                  1074 04140000
*   IF GDTDBG=NULLPTR THEN                                         1074 04141000
@RC01060 L     @06,@PC00001                                        1074 04142000
         L     @06,GDTDBG(,@06)                                    1074 04143000
         LTR   @06,@06                                             1074 04144000
         BZ    @RT01074                                            1074 04145000
*     ;                                                            1075 04146000
*   ELSE                                                           1076 04147000
*     DO;                                                          1076 04148000
*       DMPINDEX=ADDR(DUMPLIST);    /*                       @Y30LB31*/ 04149000
         LA    DMPINDEX,DUMPLIST                                   1077 04150000
*       DMPITMNM='SR01DEFV';                                       1078 04151000
         MVC   DMPITMNM(8,DMPINDEX),@CC01578                       1078 04152000
*       DMPITMPT=ADDR(SR01DEFV);                                   1079 04153000
         LA    @06,SR01DEFV                                        1079 04154000
         ST    @06,DMPITMPT(,DMPINDEX)                             1079 04155000
*       DMPITMLN=LENGTH(SR01DEFV);                                 1080 04156000
         MVC   DMPITMLN(2,DMPINDEX),@CH01704                       1080 04157000
*       DMPITMTP='H';                                              1081 04158000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1081 04159000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1082 04160000
*                                                                  1082 04161000
         LA    @06,16                                              1082 04162000
         ALR   DMPINDEX,@06                                        1082 04163000
*       /*************************************************************/ 04164000
*       /*                                                           */ 04165000
*       /*                                                   @Y30LB31*/ 04166000
*       /*                                                           */ 04167000
*       /*************************************************************/ 04168000
*                                                                  1083 04169000
*       DMPITMNM='STORETBL';                                       1083 04170000
         MVC   DMPITMNM(8,DMPINDEX),@CC01423                       1083 04171000
*       DMPITMPT=ADDR(STORETBL);                                   1084 04172000
         LA    @03,STORETBL                                        1084 04173000
         ST    @03,DMPITMPT(,DMPINDEX)                             1084 04174000
*       DMPITMLN=LENGTH(STORETBL);                                 1085 04175000
         MVC   DMPITMLN(2,DMPINDEX),@CH01398                       1085 04176000
*       DMPITMTP='H';                                              1086 04177000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1086 04178000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1087 04179000
*                                                                  1087 04180000
         ALR   DMPINDEX,@06                                        1087 04181000
*       /*************************************************************/ 04182000
*       /*                                                           */ 04183000
*       /*                                                   @Y30LB31*/ 04184000
*       /*                                                           */ 04185000
*       /*************************************************************/ 04186000
*                                                                  1088 04187000
*       DMPTRM=DMPTRMVL;                                           1088 04188000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1088 04189000
*     END;                          /*                       @Y30LB31*/ 04190000
*   IF GDTDBG=NULLPTR THEN                                         1090 04191000
@RT01074 L     @06,@PC00001                                        1090 04192000
         L     @06,GDTDBG(,@06)                                    1090 04193000
         LTR   @06,@06                                             1090 04194000
         BZ    @RT01090                                            1090 04195000
*     ;                                                            1091 04196000
*   ELSE                                                           1092 04197000
*     CALL IDCDB010(GDTTBL,'SRBD',ADDR(DUMPLIST));/*         @Y30LB31*/ 04198000
*                                                                  1092 04199000
         L     @06,@PC00001                                        1092 04200000
         ST    @06,@AL00001                                        1092 04201000
         LA    @15,@CC01579                                        1092 04202000
         ST    @15,@AL00001+4                                      1092 04203000
         LA    @15,DUMPLIST                                        1092 04204000
         ST    @15,@AFTEMPS+24                                     1092 04205000
         LA    @15,@AFTEMPS+24                                     1092 04206000
         ST    @15,@AL00001+8                                      1092 04207000
         MVI   @AL00001+8,X'80'                                    1092 04208000
         L     @15,GDTDBG(,@06)                                    1092 04209000
         LA    @01,@AL00001                                        1092 04210000
         BALR  @14,@15                                             1092 04211000
*   /*****************************************************************/ 04212000
*   /*                                                               */ 04213000
*   /* CHANGE THE VOLUME SERIAL NO. IN THE CART LABELS AND MSVI.     */ 04214000
*   /*                                                       @Y30LB31*/ 04215000
*   /*                                                               */ 04216000
*   /*****************************************************************/ 04217000
*                                                                  1093 04218000
*   CALL IDCSASS0(GDTTBL,DEFINE,DEFVPTR,REASON,ECBCODE,ECBMSPTR);/*     04219000
*                                                            @Y30LB31*/ 04220000
@RT01090 L     @06,@PC00001                                        1093 04221000
         ST    @06,@AL00001                                        1093 04222000
         LA    @02,DEFINE                                          1093 04223000
         ST    @02,@AL00001+4                                      1093 04224000
         LA    @02,DEFVPTR                                         1093 04225000
         ST    @02,@AL00001+8                                      1093 04226000
         LA    @02,REASON                                          1093 04227000
         ST    @02,@AL00001+12                                     1093 04228000
         LA    @02,ECBCODE                                         1093 04229000
         ST    @02,@AL00001+16                                     1093 04230000
         LA    @02,ECBMSPTR                                        1093 04231000
         ST    @02,@AL00001+20                                     1093 04232000
         MVI   @AL00001+20,X'80'                                   1093 04233000
         L     @15,GDTSSC(,@06)                                    1093 04234000
         LA    @01,@AL00001                                        1093 04235000
         BALR  @14,@15                                             1093 04236000
*   RESPECIFY                                                      1094 04237000
*     RTNREG RSTD;                                                 1094 04238000
*   TESTRC=RTNREG;                                                 1095 04239000
         LR    TESTRC,RTNREG                                       1095 04240000
*   RESPECIFY                                                      1096 04241000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 04242000
*                                                                  1097 04243000
*   /*****************************************************************/ 04244000
*   /*                                                               */ 04245000
*   /* TEST RETURN CODE FROM MSC DEFINE ORDER. TREAT A MSVI I/O ERROR*/ 04246000
*   /* AS A MINOR ERROR.                                     @Y30LB31*/ 04247000
*   /*                                                               */ 04248000
*   /*****************************************************************/ 04249000
*                                                                  1097 04250000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 04251000
         LTR   TESTRC,TESTRC                                       1097 04252000
         BZ    @RF01097                                            1097 04253000
*     IF TESTRC=12 THEN             /*                       @Y30LB31*/ 04254000
         C     TESTRC,@CF00565                                     1098 04255000
         BNE   @RF01098                                            1098 04256000
*       CC04FLG=ON;                 /*                       @Y30LB31*/ 04257000
*                                                                  1099 04258000
         OI    CC04FLG,B'10000000'                                 1099 04259000
*   /*****************************************************************/ 04260000
*   /*                                                               */ 04261000
*   /* IF THE MSC DEACTIVATE OR RENAME FAILED, UPDATE THE COND CODE. */ 04262000
*   /* PRINT A MESSAGE WITH THE MSSC REASON CODE AND A SECONDARY     */ 04263000
*   /* ERROR MSG. AND EXIT FROM THIS PROCEDURE.              @Y30LB31*/ 04264000
*   /*                                                               */ 04265000
*   /*****************************************************************/ 04266000
*                                                                  1100 04267000
*     ELSE                          /*                       @Y30LB31*/ 04268000
*       DO;                         /*                       @Y30LB31*/ 04269000
         B     @RC01098                                            1100 04270000
@RF01098 DS    0H                                                  1101 04271000
*         DEACTRC=4;                /*                       @Y30LB31*/ 04272000
         LA    @06,4                                               1101 04273000
         LR    DEACTRC,@06                                         1101 04274000
*         IF TESTRC=4 THEN          /*                       @Y30LB31*/ 04275000
         CR    TESTRC,@06                                          1102 04276000
         BNE   @RF01102                                            1102 04277000
*           CALL SSCMSG(REASON,ECBCODE);/*                   @Y30LB31*/ 04278000
         LA    @06,REASON                                          1103 04279000
         ST    @06,@AL00001                                        1103 04280000
         LA    @06,ECBCODE                                         1103 04281000
         ST    @06,@AL00001+4                                      1103 04282000
         LA    @01,@AL00001                                        1103 04283000
         BAL   @14,SSCMSG                                          1103 04284000
*         PRINTTBL=''B;             /*                       @Y30LB31*/ 04285000
@RF01102 XC    PRINTTBL(20),PRINTTBL                               1104 04286000
*         DARGSMOD=STORMSGS;        /*                       @Y30LB31*/ 04287000
         L     @06,DDSTRU                                          1105 04288000
         MVC   DARGSMOD(3,@06),@CC01378                            1105 04289000
*         DARGSENT=MSG3732I;        /* STID=SR03             @Y30LB31*/ 04290000
         MVI   DARGSENT(@06),X'03'                                 1106 04291000
*         DARGDBP=ADDR(MSVIVOL#);   /*                       @Y30LB31*/ 04292000
         LA    @15,MSVIVOL#                                        1107 04293000
         ST    @15,DARGDBP(,@06)                                   1107 04294000
*         DARGILP=LENGTH(MSVIVOL#); /*                       @Y30LB31*/ 04295000
         MVC   DARGILP(2,@06),@CH00156                             1108 04296000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Y30LB31*/ 04297000
         L     @06,@PC00001                                        1109 04298000
         ST    @06,@AL00001                                        1109 04299000
         LA    @15,@CF00115                                        1109 04300000
         ST    @15,@AL00001+4                                      1109 04301000
         LA    @15,DDSTRU                                          1109 04302000
         ST    @15,@AL00001+8                                      1109 04303000
         MVI   @AL00001+8,X'80'                                    1109 04304000
         L     @15,GDTPRT(,@06)                                    1109 04305000
         LA    @01,@AL00001                                        1109 04306000
         BALR  @14,@15                                             1109 04307000
*       END;                        /*                       @Y30LB31*/ 04308000
*                                                                  1110 04309000
*   /*****************************************************************/ 04310000
*   /*                                                               */ 04311000
*   /* FOLLOWING THE SUCCESSFUL DEACTIVATE WITH OPTIONAL RENAME, SAVE*/ 04312000
*   /* THE VOL SER NO. OF THE DEACTIVATED VOLUME. ALSO SAVE CSN1     */ 04313000
*   /* NEEDED TO EJECT IT. ISSUE THE APPROPRIATE INFORMATIVE MESSAGES*/ 04314000
*   /* AND THEN FREE THE MSC MESSAGE STORAGE AREA.           @Y30LB31*/ 04315000
*   /*                                                               */ 04316000
*   /*****************************************************************/ 04317000
*                                                                  1111 04318000
*   ELSE                            /*                       @Y30LB31*/ 04319000
*     DO;                           /*                       @Y30LB31*/ 04320000
         B     @RC01097                                            1111 04321000
@RF01097 DS    0H                                                  1112 04322000
*       CMMSGPTR=ECBMSPTR+ECBLENN;  /*                       @Y30LB31*/ 04323000
         LA    CMMSGPTR,4                                          1112 04324000
         AL    CMMSGPTR,ECBMSPTR                                   1112 04325000
*       IF ADDR(NSER)^=NULLPTR THEN /*                       @Y30LB31*/ 04326000
         L     @06,@PC00001+4                                      1113 04327000
         L     @06,FDTPTR+4(,@06)                                  1113 04328000
         LTR   @06,@06                                             1113 04329000
         BZ    @RF01113                                            1113 04330000
*         MSVIVOL#=CMNEWVOL;        /*                       @Y30LB31*/ 04331000
         MVC   MSVIVOL#(6),CMNEWVOL(CMMSGPTR)                      1114 04332000
*       CSN1=CMCSN1;                /*                       @Y30LB31*/ 04333000
*                                                                  1115 04334000
@RF01113 MVC   CSN1(12),CMCSN1(CMMSGPTR)                           1115 04335000
*       /*************************************************************/ 04336000
*       /*                                                           */ 04337000
*       /* IF THE VOL WAS RENAMED, ISSUE MESSAGE IDC0064I INDICATING */ 04338000
*       /* THE VOL SER NO. WAS CHANGED IN THE CART LABELS AND MSVI.  */ 04339000
*       /*                                                   @Y30LB31*/ 04340000
*       /*                                                           */ 04341000
*       /*************************************************************/ 04342000
*                                                                  1116 04343000
*       IF ADDR(NSER)^=NULLPTR THEN /*                       @Y30LB31*/ 04344000
         L     @06,@PC00001+4                                      1116 04345000
         L     @06,FDTPTR+4(,@06)                                  1116 04346000
         LTR   @06,@06                                             1116 04347000
         BZ    @RF01116                                            1116 04348000
*         DO;                       /*                       @Y30LB31*/ 04349000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 04350000
         XC    PRINTTBL(20),PRINTTBL                               1118 04351000
*           DARGSMOD=COMMSGS;       /*                       @Y30LB31*/ 04352000
         L     @06,DDSTRU                                          1119 04353000
         MVC   DARGSMOD(3,@06),@CC01387                            1119 04354000
*           DARGSENT=MSG0064I;      /* STID=CM046            @Y30LB31*/ 04355000
         MVI   DARGSENT(@06),X'2E'                                 1120 04356000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 04357000
         L     @06,@PC00001                                        1121 04358000
         ST    @06,@AL00001                                        1121 04359000
         LA    @15,@CF00115                                        1121 04360000
         ST    @15,@AL00001+4                                      1121 04361000
         LA    @15,DDSTRU                                          1121 04362000
         ST    @15,@AL00001+8                                      1121 04363000
         MVI   @AL00001+8,X'80'                                    1121 04364000
         L     @15,GDTPRT(,@06)                                    1121 04365000
         LA    @01,@AL00001                                        1121 04366000
         BALR  @14,@15                                             1121 04367000
*         END;                      /*                       @Y30LB31*/ 04368000
*                                                                  1122 04369000
*       /*************************************************************/ 04370000
*       /*                                                           */ 04371000
*       /* ISSUE MSG IDC0731I INDICATING THAT THE VOL HAS BEEN       */ 04372000
*       /* DEACTIVATED.                                      @Y30LB31*/ 04373000
*       /*                                                           */ 04374000
*       /*************************************************************/ 04375000
*                                                                  1123 04376000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 04377000
@RF01116 XC    PRINTTBL(20),PRINTTBL                               1123 04378000
*       DARGSMOD=STORMSGS;          /*                       @Y30LB31*/ 04379000
         L     @06,DDSTRU                                          1124 04380000
         MVC   DARGSMOD(3,@06),@CC01378                            1124 04381000
*       DARGSENT=MSG0731I;          /* STID=SR02             @Y30LB31*/ 04382000
         MVI   DARGSENT(@06),X'02'                                 1125 04383000
*       DARGDBP=ADDR(MSVIVOL#);     /*                       @Y30LB31*/ 04384000
         LA    @15,MSVIVOL#                                        1126 04385000
         ST    @15,DARGDBP(,@06)                                   1126 04386000
*       DARGILP=LENGTH(MSVIVOL#);   /*                       @Y30LB31*/ 04387000
         MVC   DARGILP(2,@06),@CH00156                             1127 04388000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 04389000
*                                                                  1128 04390000
         L     @06,@PC00001                                        1128 04391000
         ST    @06,@AL00001                                        1128 04392000
         LA    @15,@CF00115                                        1128 04393000
         ST    @15,@AL00001+4                                      1128 04394000
         LA    @15,DDSTRU                                          1128 04395000
         ST    @15,@AL00001+8                                      1128 04396000
         MVI   @AL00001+8,X'80'                                    1128 04397000
         L     @15,GDTPRT(,@06)                                    1128 04398000
         LA    @01,@AL00001                                        1128 04399000
         BALR  @14,@15                                             1128 04400000
*       /*************************************************************/ 04401000
*       /*                                                           */ 04402000
*       /* FREE THE MSSC MESSAGE STORAGE AREA.               @Y30LB31*/ 04403000
*       /*                                                           */ 04404000
*       /*************************************************************/ 04405000
*                                                                  1129 04406000
*       CALL IDCSAFS0(GDTTBL,ECBMSPTR);/*                    @Y30LB31*/ 04407000
         L     @06,@PC00001                                        1129 04408000
         ST    @06,@AL00001                                        1129 04409000
         LA    @15,ECBMSPTR                                        1129 04410000
         ST    @15,@AL00001+4                                      1129 04411000
         L     @15,GDTFSP(,@06)                                    1129 04412000
         LA    @01,@AL00001                                        1129 04413000
         BALR  @14,@15                                             1129 04414000
*     END;                          /*                       @Y30LB31*/ 04415000
*                                                                  1130 04416000
*   /*****************************************************************/ 04417000
*   /*                                                               */ 04418000
*   /* RESTORE THE RETURN ADDRESS OF THE CALLER TO REG 14 AND RETURN */ 04419000
*   /* TO CALLER, PASSING THE CONDITION CODE IN REG 15.      @Y30LB31*/ 04420000
*   /*                                                               */ 04421000
*   /*****************************************************************/ 04422000
*                                                                  1131 04423000
*   REG14=RETADDR3;                 /*                       @Y30LB31*/ 04424000
@RC01097 LR    REG14,RETADDR3                                      1131 04425000
*   RETURN CODE(DEACTRC);           /*                       @Y30LB31*/ 04426000
         LR    @15,DEACTRC                                         1132 04427000
@EL00014 DS    0H                                                  1132 04428000
@EF00014 DS    0H                                                  1132 04429000
@ER00014 BR    @14                                                 1132 04430000
*   END DEACTRTN;                   /*                       @Y30LB31*/ 04431000
*                                                                  1134 04432000
*/*********************************************************  @Y30LB31*/ 04433000
*/*                                                          @Y30LB31*/ 04434000
*/* PROCEDURE NAME - BKOUTRTN                                @Y30LB31*/ 04435000
*/*                                                          @Y30LB31*/ 04436000
*/* FUCNTION - CALLS VPREPRTN TO MOUNT THE VOLUME THAT       @Y30LB31*/ 04437000
*/*            CANNOT BE DEACTIVATED AND CALLS VS2RTN        @Y30LB31*/ 04438000
*/*            TO RESTORE THE VOL LABEL TO ITS ORIGINAL      @Y30LB31*/ 04439000
*/*            STATUS.  ISSUES MESSAGES IDC07338 AND         @Y30LB31*/ 04440000
*/*            IDC3734I.                                     @Y30LB31*/ 04441000
*/*                                                          @Y30LB31*/ 04442000
*/* INPUT - FDTTBL, PRINTTBL FOR MESSAGES, STORETBL          @Y30LB31*/ 04443000
*/*                                                          @Y30LB31*/ 04444000
*/* OUTPUT - RETURN CODE OF 0 INDICATES VOLUME LABEL         @Y30LB31*/ 04445000
*/*          RESTORED.  RETURN CODE OF 4 INDICATES EITHER    @Y30LB31*/ 04446000
*/*          THE MOUNT FAILED THAT IS REQUIRED FOR THE       @Y30LB31*/ 04447000
*/*          BACKOUT OPERATIONS, OR THE VOL LABEL COULD NOT  @Y30LB31*/ 04448000
*/*          BE RESTORED.                                    @Y30LB31*/ 04449000
*/*                                                          @Y30LB31*/ 04450000
*/*********************************************************  @Y30LB31*/ 04451000
*                                                                  1134 04452000
*BKOUTRTN:                                                         1134 04453000
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE);/*                  @Y30LB31*/ 04454000
*                                                                  1134 04455000
BKOUTRTN DS    0H                                                  1135 04456000
*   /*****************************************************************/ 04457000
*   /*                                                               */ 04458000
*   /* LOCAL CONDITION CODE.                                 @Y30LB31*/ 04459000
*   /*                                                               */ 04460000
*   /*****************************************************************/ 04461000
*                                                                  1135 04462000
*   DCL                                                            1135 04463000
*     BKOUTRC FIXED(15);            /*                       @Y30LB31*/ 04464000
*                                                                  1135 04465000
*   /*****************************************************************/ 04466000
*   /*                                                               */ 04467000
*   /* SAVE THE CALLERS RETURN ADDRESS AND RESTORE IT UPON EXIT.     */ 04468000
*   /*                                                       @Y30LB31*/ 04469000
*   /*                                                               */ 04470000
*   /*****************************************************************/ 04471000
*                                                                  1136 04472000
*   RETADDR2=REG14;                 /*                       @Y30LB31*/ 04473000
         LR    RETADDR2,REG14                                      1136 04474000
*   OLDERID2=NEWERID2;                                             1137 04475000
         L     @11,@PC00001                                        1137 04476000
         L     @11,GDTTR2(,@11)                                    1137 04477000
         MVC   @TS00001(95),NEWERID2(@11)                          1137 04478000
         MVC   OLDERID2(95,@11),@TS00001                           1137 04479000
*   NEWID2='SRBK';                  /*                       @Y30LB31*/ 04480000
*                                                                  1138 04481000
         MVC   NEWID2(4,@11),@CC01584                              1138 04482000
*   /*****************************************************************/ 04483000
*   /*                                                               */ 04484000
*   /* ZERO OUT CONDITION CODE SET BY THIS PROC.             @Y30LB31*/ 04485000
*   /*                                                               */ 04486000
*   /*****************************************************************/ 04487000
*                                                                  1139 04488000
*   BKOUTRC=LASTCC00;               /*                       @Y30LB31*/ 04489000
*                                                                  1139 04490000
         SLR   @11,@11                                             1139 04491000
         STH   @11,BKOUTRC                                         1139 04492000
*   /*****************************************************************/ 04493000
*   /*                                                               */ 04494000
*   /* MOUNT THE VOLUME IN ORDER TO RESTORE THE VOLUME LABEL.        */ 04495000
*   /*                                                       @Y30LB31*/ 04496000
*   /*                                                               */ 04497000
*   /*****************************************************************/ 04498000
*                                                                  1140 04499000
*   MOUNTFLG=ON;                    /* MOUNT REQUIRED        @Y30LB31*/ 04500000
         OI    MOUNTFLG,B'01000000'                                1140 04501000
*   VPREPVOL=MSVIVOL#;              /*                       @Y30LB31*/ 04502000
         MVC   VPREPVOL(6),MSVIVOL#                                1141 04503000
*   CALL VPREPRTN;                  /*                       @Y30LB31*/ 04504000
         BAL   @14,VPREPRTN                                        1142 04505000
*   RESPECIFY                                                      1143 04506000
*     RTNREG RSTD;                                                 1143 04507000
*   TESTRC=RTNREG;                                                 1144 04508000
         LR    TESTRC,RTNREG                                       1144 04509000
*   RESPECIFY                                                      1145 04510000
*     RTNREG UNRSTD;                /*                       @Y30LB31*/ 04511000
*                                                                  1145 04512000
*   /*****************************************************************/ 04513000
*   /*                                                               */ 04514000
*   /* IF THE MOUNT FAILED, ISSUE MSG IDC3734I BEFORE EXITING FROM   */ 04515000
*   /* THIS PROC.                                            @Y30LB31*/ 04516000
*   /*                                                               */ 04517000
*   /*****************************************************************/ 04518000
*                                                                  1146 04519000
*   IF TESTRC^=0 THEN               /*                       @Y30LB31*/ 04520000
         LTR   TESTRC,TESTRC                                       1146 04521000
         BZ    @RF01146                                            1146 04522000
*     DO;                           /*                       @Y30LB31*/ 04523000
*       BKOUTRC=4;                  /*                       @Y30LB31*/ 04524000
         MVC   BKOUTRC(2),@CH00042                                 1148 04525000
*       PRINTTBL=''B;               /*                       @Y30LB31*/ 04526000
         XC    PRINTTBL(20),PRINTTBL                               1149 04527000
*       DARGSMOD=STORMSGS;          /*                       @Y30LB31*/ 04528000
         L     @11,DDSTRU                                          1150 04529000
         MVC   DARGSMOD(3,@11),@CC01378                            1150 04530000
*       DARGSENT=MSG3734I;          /* STID=SR05             @Y30LB31*/ 04531000
         MVI   DARGSENT(@11),X'05'                                 1151 04532000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB31*/ 04533000
         L     @11,@PC00001                                        1152 04534000
         ST    @11,@AL00001                                        1152 04535000
         LA    @06,@CF00115                                        1152 04536000
         ST    @06,@AL00001+4                                      1152 04537000
         LA    @06,DDSTRU                                          1152 04538000
         ST    @06,@AL00001+8                                      1152 04539000
         MVI   @AL00001+8,X'80'                                    1152 04540000
         L     @15,GDTPRT(,@11)                                    1152 04541000
         LA    @01,@AL00001                                        1152 04542000
         BALR  @14,@15                                             1152 04543000
*     END;                          /*                       @Y30LB31*/ 04544000
*                                                                  1153 04545000
*   /*****************************************************************/ 04546000
*   /*                                                               */ 04547000
*   /* AFTER MOUNTING THE VOL, RESTORE THE VOL LABEL TO ITS ORIGINAL */ 04548000
*   /* STATUS.                                               @Y30LB31*/ 04549000
*   /*                                                               */ 04550000
*   /*****************************************************************/ 04551000
*                                                                  1154 04552000
*   ELSE                            /*                       @Y30LB31*/ 04553000
*     DO;                           /*                       @Y30LB31*/ 04554000
         B     @RC01146                                            1154 04555000
@RF01146 DS    0H                                                  1155 04556000
*       BKOUTFLG=ON;                /*                       @Y30LB31*/ 04557000
         OI    BKOUTFLG,B'00001000'                                1155 04558000
*       CALL VS2RTN;                /*                       @Y30LB31*/ 04559000
         BAL   @14,VS2RTN                                          1156 04560000
*       RESPECIFY                                                  1157 04561000
*         RTNREG RSTD;                                             1157 04562000
*       TESTRC=RTNREG;                                             1158 04563000
         LR    TESTRC,RTNREG                                       1158 04564000
*       RESPECIFY                                                  1159 04565000
*         RTNREG UNRSTD;            /*                       @Y30LB31*/ 04566000
*                                                                  1159 04567000
*       /*************************************************************/ 04568000
*       /*                                                           */ 04569000
*       /* IF THE VOL LABEL COULD NOT BE RESTORED, ISSUE MSG IDC3734I*/ 04570000
*       /* AND PROCEED TO RELEASE THE RESERVE BEFORE EXITING FROM    */ 04571000
*       /* THIS PROC.                                        @Y30LB31*/ 04572000
*       /*                                                           */ 04573000
*       /*************************************************************/ 04574000
*                                                                  1160 04575000
*       IF TESTRC^=0 THEN           /*                       @Y30LB31*/ 04576000
         LTR   TESTRC,TESTRC                                       1160 04577000
         BZ    @RF01160                                            1160 04578000
*         DO;                       /*                       @Y30LB31*/ 04579000
*           BKOUTRC=4;              /*                       @Y30LB31*/ 04580000
         MVC   BKOUTRC(2),@CH00042                                 1162 04581000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 04582000
         XC    PRINTTBL(20),PRINTTBL                               1163 04583000
*           DARGSMOD=STORMSGS;      /*                       @Y30LB31*/ 04584000
         L     @11,DDSTRU                                          1164 04585000
         MVC   DARGSMOD(3,@11),@CC01378                            1164 04586000
*           DARGSENT=MSG3734I;      /* STID=SR05             @Y30LB31*/ 04587000
         MVI   DARGSENT(@11),X'05'                                 1165 04588000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 04589000
         L     @11,@PC00001                                        1166 04590000
         ST    @11,@AL00001                                        1166 04591000
         LA    @06,@CF00115                                        1166 04592000
         ST    @06,@AL00001+4                                      1166 04593000
         LA    @06,DDSTRU                                          1166 04594000
         ST    @06,@AL00001+8                                      1166 04595000
         MVI   @AL00001+8,X'80'                                    1166 04596000
         L     @15,GDTPRT(,@11)                                    1166 04597000
         LA    @01,@AL00001                                        1166 04598000
         BALR  @14,@15                                             1166 04599000
*         END;                      /*                       @Y30LB31*/ 04600000
*                                                                  1168 04601000
*       /*************************************************************/ 04602000
*       /*                                                           */ 04603000
*       /* ISSUE MSG IDC0733I INDICATING THE VOLUME LABEL WAS        */ 04604000
*       /* RESTORED.                                         @Y30LB31*/ 04605000
*       /*                                                           */ 04606000
*       /*************************************************************/ 04607000
*                                                                  1168 04608000
*       ELSE                        /*                       @Y30LB31*/ 04609000
*         DO;                       /*                       @Y30LB31*/ 04610000
         B     @RC01160                                            1168 04611000
@RF01160 DS    0H                                                  1169 04612000
*           PRINTTBL=''B;           /*                       @Y30LB31*/ 04613000
         XC    PRINTTBL(20),PRINTTBL                               1169 04614000
*           DARGSMOD=STORMSGS;      /*                       @Y30LB31*/ 04615000
         L     @11,DDSTRU                                          1170 04616000
         MVC   DARGSMOD(3,@11),@CC01378                            1170 04617000
*           DARGSENT=MSG0733I;      /* STID=SR04             @Y30LB31*/ 04618000
         MVI   DARGSENT(@11),X'04'                                 1171 04619000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB31*/ 04620000
*                                                                  1172 04621000
         L     @11,@PC00001                                        1172 04622000
         ST    @11,@AL00001                                        1172 04623000
         LA    @06,@CF00115                                        1172 04624000
         ST    @06,@AL00001+4                                      1172 04625000
         LA    @06,DDSTRU                                          1172 04626000
         ST    @06,@AL00001+8                                      1172 04627000
         MVI   @AL00001+8,X'80'                                    1172 04628000
         L     @15,GDTPRT(,@11)                                    1172 04629000
         LA    @01,@AL00001                                        1172 04630000
         BALR  @14,@15                                             1172 04631000
*           /*********************************************************/ 04632000
*           /*                                                       */ 04633000
*           /* IF THE MISMATCH FLAG AND RECOVERY DATA WAS UPDATED BY */ 04634000
*           /* THIS STOREV REQUEST, CLEAR THE MISMATCH FLAG FROM THE */ 04635000
*           /* MSVI OR RESET THE RECOVERY DATA TO ITS ORIGINAL STATUS*/ 04636000
*           /* IF THE VOLUME WAS FLAGGED DUE TO A PREVIOUS RENAME    */ 04637000
*           /* FAILURE.                                      @Y30LB31*/ 04638000
*           /*                                                       */ 04639000
*           /*********************************************************/ 04640000
*                                                                  1173 04641000
*           IF VSMISFLG=ON THEN     /*                       @Y30LB31*/ 04642000
         TM    VSMISFLG,B'00000100'                                1173 04643000
         BNO   @RF01173                                            1173 04644000
*             DO;                   /*                       @Y30LB31*/ 04645000
*               SETVSFLG=OFF;       /*                       @Y30LB31*/ 04646000
         NI    SETVSFLG,B'11111101'                                1175 04647000
*               CALL MVRRTN;        /*                       @Y30LB31*/ 04648000
         BAL   @14,MVRRTN                                          1176 04649000
*               RESPECIFY                                          1177 04650000
*                 RTNREG RSTD;                                     1177 04651000
*               TESTRC=RTNREG;                                     1178 04652000
         LR    TESTRC,RTNREG                                       1178 04653000
*               RESPECIFY                                          1179 04654000
*                 RTNREG UNRSTD;    /*                       @Y30LB31*/ 04655000
*               IF TESTRC^=0 THEN   /*                       @Y30LB31*/ 04656000
         LTR   TESTRC,TESTRC                                       1180 04657000
         BZ    @RF01180                                            1180 04658000
*                 BKOUTRC=4;        /*                       @Y30LB31*/ 04659000
         MVC   BKOUTRC(2),@CH00042                                 1181 04660000
*             END;                  /*                       @Y30LB31*/ 04661000
@RF01180 DS    0H                                                  1183 04662000
*         END;                      /*                       @Y30LB31*/ 04663000
*                                                                  1183 04664000
@RF01173 DS    0H                                                  1184 04665000
*       /*************************************************************/ 04666000
*       /*                                                           */ 04667000
*       /* RELEASE THE RESERVE SET BY IDCVS02 WHEN RESTORING THE     */ 04668000
*       /* VOLUME LABEL.                                     @Y30LB31*/ 04669000
*       /*                                                           */ 04670000
*       /*************************************************************/ 04671000
*                                                                  1184 04672000
*       RNMSERNO=MSVIVOL#;          /*                       @Y30LB31*/ 04673000
@RC01160 MVC   RNMSERNO(6),MSVIVOL#                                1184 04674000
*       RNMTRAIL='.VIRTUAL.RESERVE';/*                       @ZA05138*/ 04675000
         MVC   RNMTRAIL(16),@CC01496                               1185 04676000
*       CALL IDCSADQ0(GDTTBL,MAJORNM,MINORNM);/*             @Y30LB31*/ 04677000
*                                                                  1186 04678000
         L     @11,@PC00001                                        1186 04679000
         ST    @11,@AL00001                                        1186 04680000
         LA    @06,@CC01366                                        1186 04681000
         ST    @06,@AL00001+4                                      1186 04682000
         LA    @06,MINORNM                                         1186 04683000
         ST    @06,@AL00001+8                                      1186 04684000
         MVI   @AL00001+8,X'80'                                    1186 04685000
         L     @15,GDTDEQ(,@11)                                    1186 04686000
         LA    @01,@AL00001                                        1186 04687000
         BALR  @14,@15                                             1186 04688000
*       /*************************************************************/ 04689000
*       /*                                                           */ 04690000
*       /* CLOSE DO GROUP WHICH RESTORED THE VOL LABEL AND CLEARED   */ 04691000
*       /* THE MISMATCH FLAG.                                @Y30LB31*/ 04692000
*       /*                                                           */ 04693000
*       /*************************************************************/ 04694000
*                                                                  1187 04695000
*     END;                          /*                       @Y30LB31*/ 04696000
*                                                                  1187 04697000
*   /*****************************************************************/ 04698000
*   /*                                                               */ 04699000
*   /* RESTORE REG 14 WITH THE RETURN ADDRESS OF THE CALLER AND EXIT */ 04700000
*   /* FROM BKOUTRTN. PASS THE CONDITION CODE IN REG 15.     @Y30LB31*/ 04701000
*   /*                                                               */ 04702000
*   /*****************************************************************/ 04703000
*                                                                  1188 04704000
*   REG14=RETADDR2;                 /*                       @Y30LB31*/ 04705000
@RC01146 LR    REG14,RETADDR2                                      1188 04706000
*   RETURN CODE(BKOUTRC);           /*                       @Y30LB31*/ 04707000
         LH    @15,BKOUTRC                                         1189 04708000
@EL00015 DS    0H                                                  1189 04709000
@EF00015 DS    0H                                                  1189 04710000
@ER00015 BR    @14                                                 1189 04711000
*   END BKOUTRTN;                   /*                       @Y30LB31*/ 04712000
*                                                                  1191 04713000
*/********************************************************************/ 04714000
*/*                                                          @Y30LB38*/ 04715000
*/*     PROCEDURE NAME - VOLEXIT                             @Y30LB38*/ 04716000
*/*                                                          @Y30LB38*/ 04717000
*/*     FUNCTION - REMOVES A VOLUME FROM THE MSF.            @Y30LB38*/ 04718000
*/*                IF THE VOLUME IS EJECTED SUCCESSFULLY,    @Y30LB38*/ 04719000
*/*                ISSUES MESSAGE IDC0085I TO SYSPRINT AND   @Y30LB38*/ 04720000
*/*                MESSAGE IDC083E TO THE OPERATOR.  IF THE  @Y30LB38*/ 04721000
*/*                VOLUME IS NOT EJECTED SUCCESSFULLY, AN    @Y30LB38*/ 04722000
*/*                ERROR MESSAGE IS ISSUED VIA SSCMSG        @Y30LB38*/ 04723000
*/*                PROCEDURE AND MESSAGE IDC2084I IS ISSUED  @Y30LB38*/ 04724000
*/*                TO SYSPRINT.                              @Y30LB38*/ 04725000
*/*                                                          @Y30LB38*/ 04726000
*/*     INPUT - THE FOLLOWING POSITIONAL PARAMETERS ARE      @Y30LB38*/ 04727000
*/*             PASSED AS INPUT:                             @Y30LB38*/ 04728000
*/*             ARG1 = CSN OF FIRST VOLUME CARTRIDGE         @Y30LB38*/ 04729000
*/*             ARG2 = VOLUME SERIAL NUMBER                  @Y30LB38*/ 04730000
*/*             ARG3 = VVI ERROR FLAG                        @Y30LB38*/ 04731000
*/*             ARG4 = RETAIN RECORD FLAG                    @Y30LB38*/ 04732000
*/*             ARG5 = VOLUME STORAGE LOCATION               @Y30LB38*/ 04733000
*/*                                                          @Y30LB38*/ 04734000
*/*     OUTPUT - RETURN CODE IN REG15                        @Y30LB38*/ 04735000
*/*              REG15 = 00 CARTRIDGES EJECTED SUCCESSFULLY  @Y30LB38*/ 04736000
*/*              REG15 = 04 CARTRIDGES NOT EJECTED           @Y30LB38*/ 04737000
*/*                         SUCCESSFULLY                     @Y30LB38*/ 04738000
*/*              REG15 = 08 SECOND CARTRIDGE NOT EJECTED     @Y30LB38*/ 04739000
*/*                         SUCCESSFULLY                     @Y30LB38*/ 04740000
*/*                                                          @Y30LB38*/ 04741000
*/********************************************************************/ 04742000
*                                                                  1191 04743000
*VOLEXIT:                                                          1191 04744000
*   PROCEDURE(VECSN1,               /* CART SERIAL NUMBER    @Y30LB38*/ 04745000
*       VEVOLUME,                   /* VOL SERIAL NUMBER     @Y30LB38*/ 04746000
*       VEVVIERR,                   /* VVI ERROR FLAG        @Y30LB38*/ 04747000
*       VERECFLG,                   /* RETAIN RECORD FLAG    @Y30LB38*/ 04748000
*       VEVOLLOC)                   /* VOL STORAGE LOC       @Y30LB38*/ 04749000
*       OPTIONS(NOSAVE,NOSAVEAREA); /*                       @Y30LB38*/ 04750000
VOLEXIT  MVC   @PC00016(20),0(@01)                                 1191 04751000
*                                                                  1192 04752000
*/********************************************************************/ 04753000
*/*          MACCOMP  Y30LB22          SC1DR/BL0019          @Y30LB22*/ 04754000
*/*          MACSTAT  Y30LB22          74/170/341040         @Y30LB22*/ 04755000
*/*                                                                  */ 04756000
*/*          NAME: IEZMCRTE                                  @Y30LB22*/ 04757000
*/*                                                                  */ 04758000
*/*          FUNCTION:                                       @Y30LB22*/ 04759000
*/*                  MAPS THE REQUEST BLOCK                  @Y30LB22*/ 04760000
*/*                  EXTENSION WHICH IS USED TO PASS         @Y30LB22*/ 04761000
*/*                  ADDITIONAL INFORMATION TO MASS          @Y30LB22*/ 04762000
*/*                  STORAGE VOLUME  CONTROL DURING          @Y30LB22*/ 04763000
*/*                  AN MOVE CARTRIDGE REQUEST.              @Y30LB22*/ 04764000
*/*                                                                  */ 04765000
*/*          STATUS:  CHANGE LEVEL = 0                       #Y30LB22*/ 04766000
*/*                                                          @Y30LB22*/ 04767000
*/********************************************************************/ 04768000
*                                                                  1192 04769000
*   /*****************************************************************/ 04770000
*   /*                                                               */ 04771000
*   /* CONSTANTS FOR IEZMCRTE                                @Y30LB22*/ 04772000
*   /*                                                               */ 04773000
*   /*****************************************************************/ 04774000
*                                                                  1192 04775000
*   DCL                                                            1192 04776000
*     MCRLEN FIXED(15) INIT(LENGTH(MCRTE));/* LENGTH         @Y30LB22   04777000
*                                      OF EXTENSION          @Y30LB22*/ 04778000
*                                                                  1192 04779000
*   /*****************************************************************/ 04780000
*   /*                                                               */ 04781000
*   /* MAPPING MACRO DECLARES                                @Y30LB22*/ 04782000
*   /*                                                               */ 04783000
*   /*****************************************************************/ 04784000
*                                                                  1193 04785000
*   DCL                                                            1193 04786000
*     1 MCRTE BASED(MCRTEPTR) BDY(WORD),                           1193 04787000
*      2 MCRLNGTH FIXED(31),        /* LENGTH OF EXTENSION   @Y30LB22*/ 04788000
*      2 MCRLOC CHAR(30),           /* LOCATION/DESTINATION OF VOL 1193 04789000
*                                      AFTER EJECTION        @Y30LB22*/ 04790000
*      2 MCRFLAGA BIT(8),           /* SPECIFICATION FLAGS   @Y30LB22*/ 04791000
*       3 MCRSPLOC BIT(1),          /* MCRLOC IS SPECIFIED   @Y30LB22*/ 04792000
*       3 * BIT(7),                 /* UNUSED                @Y30LB22*/ 04793000
*      2 MCRBLNK1 CHAR(1),          /* BLANK                 @Y30LB22*/ 04794000
*      2 MCRFLAGB BIT(32),          /* INDICATOR FLAGS       @Y30LB22*/ 04795000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 04796000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 04797000
*       3 MCRTYPE BIT(8),           /* MOVE CART. TYPE FLAG  @Y30LB22*/ 04798000
*        4 MCRREC BIT(1),           /* BIT 0=1, REC RETAIN   @Y30LB22   04799000
*                                      BIT 0=0, REC DELETE   @Y30LB22*/ 04800000
*        4 * BIT(7),                /* UNUSED                @Y30LB22*/ 04801000
*       3 * BIT(8),                 /* UNUSED                @Y30LB22*/ 04802000
*      2 * CHAR(4);                 /* UNUSED                @Y30LB22*/ 04803000
*                                                                  1194 04804000
*   /*****************************************************************/ 04805000
*   /*                                                               */ 04806000
*   /* DECLARATIONS FOR VOLEXIT                              @Y30LB38*/ 04807000
*   /*                                                               */ 04808000
*   /*****************************************************************/ 04809000
*                                                                  1194 04810000
*   DCL                                                            1194 04811000
*     VEDDSTRU POINTER(31);         /* DARGLIST POINTER      @Y30LB38*/ 04812000
*   DCL                                                            1195 04813000
*     MCLSTPTR POINTER(31);         /* BASE PTR FOR MCLIST@Y30LB38   */ 04814000
*   DCL                                                            1196 04815000
*     MCRTEPTR POINTER(31);         /* PTR FOR MCLIST EXT    @Y30LB38*/ 04816000
*   DCL                                                            1197 04817000
*     VERETADR POINTER(31);         /* RETURN ADDR           @Y30LB38*/ 04818000
*   DCL                                                            1198 04819000
*     VEMSGPTR POINTER(31);         /* MESSAGE PTR AREA      @Y30LB38*/ 04820000
*   DCL                                                            1199 04821000
*     VEWTOPTR POINTER(31);         /* WTO MSG POINTER       @Y30LB38*/ 04822000
*   DCL                                                            1200 04823000
*     VECOND FIXED(15);             /* CONDITION CODE        @Y30LB38*/ 04824000
*   DCL                                                            1201 04825000
*     VEWTOLEN FIXED(15);           /* LENGTH OF WTO MSG     @Y30LB38*/ 04826000
*   DCL                                                            1202 04827000
*     VERESNCD FIXED(31);           /* RSN CODE FOR USSC     @Y30LB38*/ 04828000
*   DCL                                                            1203 04829000
*     VEECB CHAR(1);                /* ECB RETURN AREA       @Y30LB38*/ 04830000
*                                                                  1203 04831000
*   /*****************************************************************/ 04832000
*   /*                                                               */ 04833000
*   /* PARM LIST FOR UPRINT MACRO WITH MULTIPLE INSERTS      @Y30LB38*/ 04834000
*   /*                                                               */ 04835000
*   /*****************************************************************/ 04836000
*                                                                  1204 04837000
*   DCL                                                            1204 04838000
*     VELIST CHAR(LENGTH(DARGLIST)+(4*LENGTH(DARGARY)));/*   @Y30LB38*/ 04839000
*                                                                  1204 04840000
*   /*****************************************************************/ 04841000
*   /*                                                               */ 04842000
*   /* POSITIONAL PARMS FOR INPUT PARMAMETERS                @Y30LB38*/ 04843000
*   /*                                                               */ 04844000
*   /*****************************************************************/ 04845000
*                                                                  1205 04846000
*   DCL                                                            1205 04847000
*     VECSN1 CHAR(12);              /* CART SERIAL NUM       @Y30LB38*/ 04848000
*   DCL                                                            1206 04849000
*     VEVOLUME CHAR(6);             /* VOL SER NUMBER        @Y30LB38*/ 04850000
*   DCL                                                            1207 04851000
*     VEVVIERR BIT(1);              /* VVI ERROR FLAG        @Y30LB38*/ 04852000
*   DCL                                                            1208 04853000
*     VERECFLG BIT(1);              /* RETAIN REC FLAG       @Y30LB38*/ 04854000
*   DCL                                                            1209 04855000
*     VEVOLLOC CHAR(30);            /* VOL LOCATION          @Y30LB38*/ 04856000
*   DCL                                                            1210 04857000
*     VEWTOMSG CHAR(72);            /* UWTO MSG AREA         @Y30LB38*/ 04858000
*                                                                  1210 04859000
*   /*****************************************************************/ 04860000
*   /*                                                               */ 04861000
*   /* INVOKE LIST FORM OF MCLIST MACRO                      @Y30LB38*/ 04862000
*   /*                                                               */ 04863000
*   /*****************************************************************/ 04864000
*                                                                  1211 04865000
*   DCL                                                            1211 04866000
*     MCR1 REG(1) PTR;              /* ADDRESS OF REQUEST BLOCK    1211 04867000
*                                                            @Y30LB02*/ 04868000
*                                                                  1211 04869000
*   /*****************************************************************/ 04870000
*   /*                                                               */ 04871000
*   /* ********************************************************      */ 04872000
*   /*                                                       @Y30LB02*/ 04873000
*   /* MACMEAN MSSC MOVE CARTRIDGE MACRO                     @Y30LB02*/ 04874000
*   /* VS1-4/VS2-3 VERSION--06/09/74 LEVEL 00                @Y30LB02*/ 04875000
*   /* THIS IS THE UNINITIALIZED LIST FORM                   @Y30LB02*/ 04876000
*   /* ********************************************************      */ 04877000
*   /*                                                       @Y30LB02*/ 04878000
*   /*                                                               */ 04879000
*   /*****************************************************************/ 04880000
*                                                                  1212 04881000
*   DCL                                                            1212 04882000
*     1 MCLIST BASED(MCLSTPTR),     /* MOVE CARTRIDGE REQUEST BLOCK     04883000
*                                                            @Y30LB02*/ 04884000
*      2 MCRTLEN FIXED(31),         /* LENGTH OF MOVE CARTRIDGE    1212 04885000
*                                      REQUEST BLK = 30 HEX  @Y30LB02*/ 04886000
*      2 MCRTOPCD FIXED(8),         /* MOVE CARTRIDGE OPCODE = 0E HEX   04887000
*                                                            @Y30LB02*/ 04888000
*      2 MCRTRES1 CHAR(1),          /* RESERVED AND ZERO     @Y30LB02*/ 04889000
*      2 MCRTFLG BIT(8),            /* ONE BYTE FLAGS AREA   @Y30LB02*/ 04890000
*       3 * BIT(2),                 /* RESERVED AND MUST BE ZERO   1212 04891000
*                                                            @Y30LB02*/ 04892000
*       3 MCRTTRAN BIT(1),          /* SOURCE WITH TRANSIENT CSN1  1212 04893000
*                                      SPECD                 @Y30LB02*/ 04894000
*       3 MCRTSCT BIT(1),           /* SOURCE WITH SCRATCH ATTRIBUTE    04895000
*                                                            @Y30LB02*/ 04896000
*       3 * BIT(4),                 /* RESERVED AND MUST BE ZERO   1212 04897000
*                                                            @Y30LB02*/ 04898000
*      2 MCRTLIB BIT(8),            /* BYTE-LIBID            @Y30LB02*/ 04899000
*       3 * BIT(6),                 /* RESERVED AND MUST BE ZERO   1212 04900000
*                                                            @Y30LB02*/ 04901000
*       3 MCRTLD BIT(2),            /* BINARY NUMBER ZERO TO THREE 1212 04902000
*                                                            @Y30LB02*/ 04903000
*      2 MCRTRES2 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/ 04904000
*      2 MCRTRES3 CHAR(8),          /* 8-BYTE RES            @Y30LB02*/ 04905000
*      2 MCRTCSN CHAR(12),          /* CART SER NO           @Y30LB02*/ 04906000
*      2 MCRTRES4 CHAR(2),          /* RESERVED              @Y30LB02*/ 04907000
*      2 MCRTASID CHAR(2),          /* ASID AREA             @Y30LB02*/ 04908000
*      2 MCRTECB FIXED(31),         /* EVENT CONTROL BLOCK ADDRESS 1212 04909000
*                                                            @Y30LB02*/ 04910000
*      2 MCRTVEXT FIXED(31);        /* MSVC EXTENSION AREA   @Y30LB02*/ 04911000
*                                                                  1212 04912000
*   /*****************************************************************/ 04913000
*   /*                                                               */ 04914000
*   /*                                                       @Y30LB38*/ 04915000
*   /*                                                               */ 04916000
*   /*****************************************************************/ 04917000
*                                                                  1213 04918000
*                                                                  1213 04919000
*   /*****************************************************************/ 04920000
*   /*                                                               */ 04921000
*   /* DECLARE WORK AREA FOR MC LIST AND EXTENSION LIST      @Y30LB38*/ 04922000
*   /*                                                               */ 04923000
*   /*****************************************************************/ 04924000
*                                                                  1213 04925000
*   DCL                                                            1213 04926000
*     VEMCLIST CHAR(LENGTH(MCLIST));/*                       @Y30LB38*/ 04927000
*   DCL                                                            1214 04928000
*     VEEXLIST CHAR(LENGTH(MCRTE)); /*                       @Y30LB38*/ 04929000
*                                                                  1214 04930000
*   /*****************************************************************/ 04931000
*   /*                                                               */ 04932000
*   /* DECLARE WORK AREA FOR JOBNAME AND STEPNAME USED BY    @Y30LB38*/ 04933000
*   /* USYSINFO MACRO                                        @Y30LB38*/ 04934000
*   /*                                                               */ 04935000
*   /*****************************************************************/ 04936000
*                                                                  1215 04937000
*   DCL                                                            1215 04938000
*     1 VESYSIN CHAR(16),                                          1215 04939000
*      2 VEJOBNAM CHAR(8),                                         1215 04940000
*      2 VESTEPNM CHAR(8);          /*                       @Y30LB38*/ 04941000
*                                                                  1215 04942000
*   /*****************************************************************/ 04943000
*   /*                                                               */ 04944000
*   /* DECLARE ROUTING AND DESCRIPTOR CODE AREAS FOR UWTO    @Y30LB38*/ 04945000
*   /*                                                               */ 04946000
*   /*****************************************************************/ 04947000
*                                                                  1216 04948000
*   DCL                                                            1216 04949000
*     1 VEROUTCD BIT(16),                                          1216 04950000
*      2 VECD1 BIT(1),                                             1216 04951000
*      2 * BIT(15);                 /*                       @Y30LB38*/ 04952000
*   DCL                                                            1217 04953000
*     1 VEDESCCD BIT(16),                                          1217 04954000
*      2 * BIT(2),                                                 1217 04955000
*      2 VEDESC3 BIT(1),                                           1217 04956000
*      2 * BIT(12);                 /*                       @Y30LB38*/ 04957000
*                                                                  1217 04958000
*   /*****************************************************************/ 04959000
*   /*                                                               */ 04960000
*   /* DECLARE WORK AREA FOR UDUMP MACRO                     @Y30LB38*/ 04961000
*   /*                                                               */ 04962000
*   /*****************************************************************/ 04963000
*                                                                  1218 04964000
*   DCL                                                            1218 04965000
*     VEDMPSTG CHAR(17);            /*                       @Y30LB38*/ 04966000
*                                                                  1218 04967000
*   /*****************************************************************/ 04968000
*   /*                                                               */ 04969000
*   /* DECLARE STATIC MODULE ID FOR MESSAGES USED BY         @Y30LB38*/ 04970000
*   /* COMMON FSR'S                                          @Y30LB38*/ 04971000
*   /*                                                               */ 04972000
*   /*****************************************************************/ 04973000
*                                                                  1219 04974000
*   DCL                                                            1219 04975000
*     VECMOMSG CHAR(3) CONSTANT('CM0');/*                    @Y30LB38*/ 04976000
*   DCL                                                            1220 04977000
*     MSG0085I PTR(8) CONSTANT(21); /* MSG ENTRY NUMBER      @Y30LB38*/ 04978000
*   DCL                                                            1221 04979000
*     MSG2084I PTR(8) CONSTANT(22); /* MSG ENTRY NUMBER      @Y30LB38*/ 04980000
*   DCL                                                            1222 04981000
*     MSG083E PTR(8) CONSTANT(23);  /* MSG ENTRY NUMBER      @Y30LB38*/ 04982000
*                                                                  1222 04983000
*   /*****************************************************************/ 04984000
*   /*                                                               */ 04985000
*   /* VOLEXIT CONSTANTS                                     @Y30LB38*/ 04986000
*   /*                                                               */ 04987000
*   /*****************************************************************/ 04988000
*                                                                  1223 04989000
*   DCL                                                            1223 04990000
*     VEECBLEN FIXED(31) CONSTANT(4);/* LENGTH OF ECB        @Y30LB38*/ 04991000
*                                                                  1224 04992000
*   /*****************************************************************/ 04993000
*   /*                                                               */ 04994000
*   /* SAVE RETURN ADDRESS AND INITIALIZE PARAMETER LISTS    @Y30LB38*/ 04995000
*   /*                                                               */ 04996000
*   /*****************************************************************/ 04997000
*                                                                  1224 04998000
*   VERETADR=REG14;                 /*                       @Y30LB38*/ 04999000
         LR    VERETADR,REG14                                      1224 05000000
*   OLDERID2=NEWERID2;                                             1225 05001000
         L     @11,@PC00001                                        1225 05002000
         L     @11,GDTTR2(,@11)                                    1225 05003000
         MVC   @TS00001(95),NEWERID2(@11)                          1225 05004000
         MVC   OLDERID2(95,@11),@TS00001                           1225 05005000
*   NEWID2='VESR';                  /*                       @Y30LB38*/ 05006000
         MVC   NEWID2(4,@11),@CC01668                              1226 05007000
*   VELIST=''B;                     /*                       @Y30LB38*/ 05008000
         XC    VELIST(52),VELIST                                   1227 05009000
*   VEDDSTRU=ADDR(VELIST);          /*                       @Y30LB38*/ 05010000
         LA    @11,VELIST                                          1228 05011000
         ST    @11,VEDDSTRU                                        1228 05012000
*   MCLSTPTR=ADDR(VEMCLIST);        /*                       @Y30LB38*/ 05013000
         LA    @11,VEMCLIST                                        1229 05014000
         ST    @11,MCLSTPTR                                        1229 05015000
*   MCRTEPTR=ADDR(VEEXLIST);        /*                       @Y30LB38*/ 05016000
         LA    MCRTEPTR,VEEXLIST                                   1230 05017000
*   VEWTOPTR=ADDR(VEWTOMSG);        /*                       @Y30LB38*/ 05018000
         LA    @02,VEWTOMSG                                        1231 05019000
         ST    @02,VEWTOPTR                                        1231 05020000
*   MCLIST=''B;                     /*                       @Y30LB38*/ 05021000
         XC    MCLIST(48,@11),MCLIST(@11)                          1232 05022000
*   MCRTE=''B;                      /*                       @Y30LB38*/ 05023000
         XC    MCRTE(44,MCRTEPTR),MCRTE(MCRTEPTR)                  1233 05024000
*   VECOND='0'X;                    /*                       @Y30LB38*/ 05025000
*                                                                  1234 05026000
         SLR   VECOND,VECOND                                       1234 05027000
*   /*****************************************************************/ 05028000
*   /*                                                               */ 05029000
*   /* INITIALIZE MCLIST FOR USSC MACRO                      @Y30LB38*/ 05030000
*   /*                                                               */ 05031000
*   /*****************************************************************/ 05032000
*                                                                  1235 05033000
*   MCRLNGTH=MCRLEN;                /*                       @Y30LB38*/ 05034000
         LH    @02,MCRLEN                                          1235 05035000
         ST    @02,MCRLNGTH(,MCRTEPTR)                             1235 05036000
*   MCRTCSN=VECSN1;                 /*                       @Y30LB38*/ 05037000
         L     @02,@PC00016                                        1236 05038000
         MVC   MCRTCSN(12,@11),VECSN1(@02)                         1236 05039000
*   MCRTTRAN=ON;                    /*                       @Y30LB38*/ 05040000
         OI    MCRTTRAN(@11),B'00100000'                           1237 05041000
*   IF VERECFLG=ON THEN                                            1238 05042000
         L     @11,@PC00016+12                                     1238 05043000
         TM    VERECFLG(@11),B'10000000'                           1238 05044000
         BNO   @RF01238                                            1238 05045000
*     MCRREC=ON;                    /*                       @Y30LB38*/ 05046000
         OI    MCRREC(MCRTEPTR),B'10000000'                        1239 05047000
*   MCRLOC=VEVOLLOC;                /*                       @Y30LB38*/ 05048000
@RF01238 L     @11,@PC00016+16                                     1240 05049000
         MVC   MCRLOC(30,MCRTEPTR),VEVOLLOC(@11)                   1240 05050000
*   MCRTVEXT=MCRTEPTR;              /*                       @Y30LB38*/ 05051000
         L     @11,MCLSTPTR                                        1241 05052000
         ST    MCRTEPTR,MCRTVEXT(,@11)                             1241 05053000
*   MCRSPLOC=ON;                    /*                       @Y30LB38*/ 05054000
*                                                                  1242 05055000
         OI    MCRSPLOC(MCRTEPTR),B'10000000'                      1242 05056000
*   /*****************************************************************/ 05057000
*   /*                                                               */ 05058000
*   /* TAKE UDUMP OF MOVE VOLUME PARAMETER LIST (MCLIST)     @Y30LB38*/ 05059000
*   /*                                                               */ 05060000
*   /*****************************************************************/ 05061000
*                                                                  1243 05062000
*   IF GDTDBG=NULLPTR THEN                                         1243 05063000
         L     @11,@PC00001                                        1243 05064000
         L     @11,GDTDBG(,@11)                                    1243 05065000
         LTR   @11,@11                                             1243 05066000
         BZ    @RT01243                                            1243 05067000
*     ;                                                            1244 05068000
*   ELSE                                                           1245 05069000
*     DO;                                                          1245 05070000
*       DMPINDEX=ADDR(VEDMPSTG);    /*                       @Y30LB38*/ 05071000
         LA    DMPINDEX,VEDMPSTG                                   1246 05072000
*       DMPITMNM='MCLIST';                                         1247 05073000
         MVI   DMPITMNM+6(DMPINDEX),C' '                           1247 05074000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           1247 05075000
         MVC   DMPITMNM(6,DMPINDEX),@CC01670                       1247 05076000
*       DMPITMPT=ADDR(MCLSTPTR);                                   1248 05077000
         LA    @11,MCLSTPTR                                        1248 05078000
         ST    @11,DMPITMPT(,DMPINDEX)                             1248 05079000
*       DMPITMLN=LENGTH(MCLIST);                                   1249 05080000
         MVC   DMPITMLN(2,DMPINDEX),@CH01161                       1249 05081000
*       DMPITMTP='H';                                              1250 05082000
         MVI   DMPITMTP(DMPINDEX),C'H'                             1250 05083000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                1251 05084000
*                                                                  1251 05085000
         AL    DMPINDEX,@CF00473                                   1251 05086000
*       /*************************************************************/ 05087000
*       /*                                                           */ 05088000
*       /*                                                   @Y30LB38*/ 05089000
*       /*                                                           */ 05090000
*       /*************************************************************/ 05091000
*                                                                  1252 05092000
*       DMPTRM=DMPTRMVL;                                           1252 05093000
         MVI   DMPTRM(DMPINDEX),X'FF'                              1252 05094000
*     END;                          /*                       @Y30LB38*/ 05095000
*   IF GDTDBG=NULLPTR THEN                                         1254 05096000
@RT01243 L     @11,@PC00001                                        1254 05097000
         L     @11,GDTDBG(,@11)                                    1254 05098000
         LTR   @11,@11                                             1254 05099000
         BZ    @RT01254                                            1254 05100000
*     ;                                                            1255 05101000
*   ELSE                                                           1256 05102000
*     CALL IDCDB010(GDTTBL,'VEBM',ADDR(VEDMPSTG));/*         @Y30LB38*/ 05103000
*                                                                  1256 05104000
         L     @11,@PC00001                                        1256 05105000
         ST    @11,@AL00001                                        1256 05106000
         LA    @15,@CC01671                                        1256 05107000
         ST    @15,@AL00001+4                                      1256 05108000
         LA    @15,VEDMPSTG                                        1256 05109000
         ST    @15,@AFTEMPS+28                                     1256 05110000
         LA    @15,@AFTEMPS+28                                     1256 05111000
         ST    @15,@AL00001+8                                      1256 05112000
         MVI   @AL00001+8,X'80'                                    1256 05113000
         L     @15,GDTDBG(,@11)                                    1256 05114000
         LA    @01,@AL00001                                        1256 05115000
         BALR  @14,@15                                             1256 05116000
*   /*****************************************************************/ 05117000
*   /*                                                               */ 05118000
*   /* ISSUE USSC MACRO TO EJECT THE VOLUME                  @Y30LB38*/ 05119000
*   /*                                                               */ 05120000
*   /*****************************************************************/ 05121000
*                                                                  1257 05122000
*   CALL IDCSASS0(GDTTBL,MOVE,MCLSTPTR,VERESNCD,VEECB,VEMSGPTR);/* 1257 05123000
*                                                            @Y30LB38*/ 05124000
@RT01254 L     @11,@PC00001                                        1257 05125000
         ST    @11,@AL00001                                        1257 05126000
         LA    @02,MOVE                                            1257 05127000
         ST    @02,@AL00001+4                                      1257 05128000
         LA    @02,MCLSTPTR                                        1257 05129000
         ST    @02,@AL00001+8                                      1257 05130000
         LA    @02,VERESNCD                                        1257 05131000
         ST    @02,@AL00001+12                                     1257 05132000
         LA    @02,VEECB                                           1257 05133000
         ST    @02,@AL00001+16                                     1257 05134000
         LA    @02,VEMSGPTR                                        1257 05135000
         ST    @02,@AL00001+20                                     1257 05136000
         MVI   @AL00001+20,X'80'                                   1257 05137000
         L     @15,GDTSSC(,@11)                                    1257 05138000
         LA    @01,@AL00001                                        1257 05139000
         BALR  @14,@15                                             1257 05140000
*   RESPECIFY                                                      1258 05141000
*     RTNREG RSTD;                                                 1258 05142000
*   TESTRC=RTNREG;                                                 1259 05143000
         LR    TESTRC,RTNREG                                       1259 05144000
*   RESPECIFY                                                      1260 05145000
*     RTNREG UNRSTD;                /*                       @Y30LB38*/ 05146000
*                                                                  1260 05147000
*   /*****************************************************************/ 05148000
*   /*                                                               */ 05149000
*   /* SET UP ADDRESSABILITY TO MESSAGE AREA FROM USSC       @Y30LB38*/ 05150000
*   /*                                                               */ 05151000
*   /*****************************************************************/ 05152000
*                                                                  1261 05153000
*   VEMSGPTR=VEMSGPTR+VEECBLEN;     /*                       @Y30LB38*/ 05154000
         LA    @11,4                                               1261 05155000
         AL    @11,VEMSGPTR                                        1261 05156000
         ST    @11,VEMSGPTR                                        1261 05157000
*                                                                  1262 05158000
*   /*****************************************************************/ 05159000
*   /*                                                               */ 05160000
*   /* IF CARTRIDGE WERE SUCCESSFULLY EJECTED; ISSUE THE     @Y30LB38*/ 05161000
*   /* APPROPRIATE MESSAGE                                   @Y30LB38*/ 05162000
*   /*                                                               */ 05163000
*   /*****************************************************************/ 05164000
*                                                                  1262 05165000
*   IF TESTRC=LASTCC00|TESTRC=LASTCC12 THEN                        1262 05166000
         LTR   TESTRC,TESTRC                                       1262 05167000
         BZ    @RT01262                                            1262 05168000
         C     TESTRC,@CF00565                                     1262 05169000
         BNE   @RF01262                                            1262 05170000
@RT01262 DS    0H                                                  1263 05171000
*     DO;                           /*                       @Y30LB38*/ 05172000
*                                                                  1263 05173000
*       /*************************************************************/ 05174000
*       /*                                                           */ 05175000
*       /* IF AN ERROR OCCURRES UPDATING INVENTORY, SET A    @Y30LB38*/ 05176000
*       /* FLAG ON FOR THE CALLER                            @Y30LB38*/ 05177000
*       /*                                                           */ 05178000
*       /*************************************************************/ 05179000
*                                                                  1264 05180000
*       IF TESTRC=LASTCC12 THEN                                    1264 05181000
         C     TESTRC,@CF00565                                     1264 05182000
         BNE   @RF01264                                            1264 05183000
*         VEVVIERR=ON;              /*                       @Y30LB38*/ 05184000
*                                                                  1265 05185000
         L     @11,@PC00016+8                                      1265 05186000
         OI    VEVVIERR(@11),B'10000000'                           1265 05187000
*       /*************************************************************/ 05188000
*       /*                                                           */ 05189000
*       /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME       */ 05190000
*       /*                                                   @Y30LB38*/ 05191000
*       /* TO BE USED IN MESSAGE IDC083E                     @Y30LB38*/ 05192000
*       /*                                                           */ 05193000
*       /*************************************************************/ 05194000
*                                                                  1266 05195000
*       CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/*         @Y30LB38*/ 05196000
*                                                                  1266 05197000
@RF01264 L     @11,@PC00001                                        1266 05198000
         ST    @11,@AL00001                                        1266 05199000
         LA    @15,NAMES                                           1266 05200000
         ST    @15,@AL00001+4                                      1266 05201000
         LA    @15,VESYSIN                                         1266 05202000
         ST    @15,@AFTEMPS+28                                     1266 05203000
         LA    @15,@AFTEMPS+28                                     1266 05204000
         ST    @15,@AL00001+8                                      1266 05205000
         MVI   @AL00001+8,X'80'                                    1266 05206000
         L     @15,GDTSFO(,@11)                                    1266 05207000
         LA    @01,@AL00001                                        1266 05208000
         BALR  @14,@15                                             1266 05209000
*       /*************************************************************/ 05210000
*       /*                                                           */ 05211000
*       /* INITIIALIZE DARGLIST WITH MULTIPLE INSERTS        @Y30LB38*/ 05212000
*       /* FOR MESSAGE IDC083E                               @Y30LB38*/ 05213000
*       /*                                                           */ 05214000
*       /*************************************************************/ 05215000
*                                                                  1267 05216000
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/ 05217000
         L     @11,VEDDSTRU                                        1267 05218000
         MVC   DARGSMOD(3,@11),@CC01387                            1267 05219000
*       VEDDSTRU->DARGSENT=MSG083E; /*                       @Y30LB38*/ 05220000
         MVI   DARGSENT(@11),X'17'                                 1268 05221000
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/ 05222000
         L     @15,VEMSGPTR                                        1269 05223000
         LA    @14,CMCSN1(,@15)                                    1269 05224000
         ST    @14,DARGDBP(,@11)                                   1269 05225000
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/ 05226000
         LA    @14,12                                              1270 05227000
         STH   @14,DARGILP(,@11)                                   1270 05228000
*       VEDDSTRU->DARGRETP=VEWTOPTR;/*                       @Y30LB38*/ 05229000
         L     @03,VEWTOPTR                                        1271 05230000
         ST    @03,DARGRETP(,@11)                                  1271 05231000
*       VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*               @Y30LB38*/ 05232000
*                                                                  1272 05233000
         MVC   DARGRETL(2,@11),@CH01281                            1272 05234000
*       /*************************************************************/ 05235000
*       /*                                                           */ 05236000
*       /* IF BOTH CARTRIDGES WERE EJECTED, SET DARGLIST     @Y30LB38*/ 05237000
*       /* FOR FIVE INSERTS. IF NOT USE FOUR INSERTS.        @Y30LB38*/ 05238000
*       /* IF FIVE INSERTS ARE USED, THEY WILL BE CSN1, CSN2,        */ 05239000
*       /*                                                   @Y30LB38*/ 05240000
*       /* VOLUME SERIAL NUMBER, JOB NAME AND STEP NAME.     @Y30LB38*/ 05241000
*       /* IF FOUR INSERTS ARE USED CSN2 WILL BE OMMITTED.   @Y30LB38*/ 05242000
*       /*                                                           */ 05243000
*       /*************************************************************/ 05244000
*                                                                  1273 05245000
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/ 05246000
         CLI   CMNUMCRT(@15),X'F2'                                 1273 05247000
         BNE   @RF01273                                            1273 05248000
*         DO;                       /*                       @Y30LB38*/ 05249000
*           VEDDSTRU->DARGCNT='4'X; /*                       @Y30LB38*/ 05250000
         LA    @03,4                                               1275 05251000
         STH   @03,DARGCNT(,@11)                                   1275 05252000
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/ 05253000
         LA    @02,1                                               1276 05254000
         STH   @02,DARGINS(,@11)                                   1276 05255000
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/ 05256000
         STH   @14,DARGINL(,@11)                                   1277 05257000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/ 05258000
         LA    @02,CMCSN2(,@15)                                    1278 05259000
         ST    @02,DARGDTM(,@11)                                   1278 05260000
*           VEDDSTRU->DARGINS(2)='2'X;/*                     @Y30LB38*/ 05261000
         LA    @02,2                                               1279 05262000
         STH   @02,DARGINS+8(,@11)                                 1279 05263000
*           VEDDSTRU->DARGINL(2)=LENGTH(VEVOLUME);/*         @Y30LB38*/ 05264000
         MVC   DARGINL+8(2,@11),@CH00156                           1280 05265000
*           VEDDSTRU->DARGDTM(2)=ADDR(VEVOLUME);/*           @Y30LB38*/ 05266000
         L     @02,@PC00016+4                                      1281 05267000
         ST    @02,DARGDTM+8(,@11)                                 1281 05268000
*           VEDDSTRU->DARGINS(3)='3'X;/*                     @Y30LB38*/ 05269000
         LA    @02,3                                               1282 05270000
         STH   @02,DARGINS+16(,@11)                                1282 05271000
*           VEDDSTRU->DARGINL(3)=LENGTH(VEJOBNAM);/*         @Y30LB38*/ 05272000
         LA    @02,8                                               1283 05273000
         STH   @02,DARGINL+16(,@11)                                1283 05274000
*           VEDDSTRU->DARGDTM(3)=ADDR(VEJOBNAM);/*           @Y30LB38*/ 05275000
         LA    @15,VEJOBNAM                                        1284 05276000
         ST    @15,DARGDTM+16(,@11)                                1284 05277000
*           VEDDSTRU->DARGINS(4)='4'X;/*                     @Y30LB38*/ 05278000
         STH   @03,DARGINS+24(,@11)                                1285 05279000
*           VEDDSTRU->DARGINL(4)=LENGTH(VESTEPNM);/*         @Y30LB38*/ 05280000
         STH   @02,DARGINL+24(,@11)                                1286 05281000
*           VEDDSTRU->DARGDTM(4)=ADDR(VESTEPNM);/*           @Y30LB38*/ 05282000
         LA    @15,VESTEPNM                                        1287 05283000
         ST    @15,DARGDTM+24(,@11)                                1287 05284000
*         END;                      /*                       @Y30LB38*/ 05285000
*       ELSE                                                       1289 05286000
*         DO;                       /*                       @Y30LB38*/ 05287000
         B     @RC01273                                            1289 05288000
@RF01273 DS    0H                                                  1290 05289000
*           VEDDSTRU->DARGCNT='3'X; /*                       @Y30LB38*/ 05290000
         LA    @11,3                                               1290 05291000
         L     @15,VEDDSTRU                                        1290 05292000
         STH   @11,DARGCNT(,@15)                                   1290 05293000
*           VEDDSTRU->DARGINS(1)='2'X;/*                     @Y30LB38*/ 05294000
         LA    @14,2                                               1291 05295000
         STH   @14,DARGINS(,@15)                                   1291 05296000
*           VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*         @Y30LB38*/ 05297000
         MVC   DARGINL(2,@15),@CH00156                             1292 05298000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*           @Y30LB38*/ 05299000
         L     @14,@PC00016+4                                      1293 05300000
         ST    @14,DARGDTM(,@15)                                   1293 05301000
*           VEDDSTRU->DARGINS(2)='3'X;/*                     @Y30LB38*/ 05302000
         STH   @11,DARGINS+8(,@15)                                 1294 05303000
*           VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*         @Y30LB38*/ 05304000
         LA    @11,8                                               1295 05305000
         STH   @11,DARGINL+8(,@15)                                 1295 05306000
*           VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*           @Y30LB38*/ 05307000
         LA    @14,VEJOBNAM                                        1296 05308000
         ST    @14,DARGDTM+8(,@15)                                 1296 05309000
*           VEDDSTRU->DARGINS(3)='4'X;/*                     @Y30LB38*/ 05310000
         LA    @14,4                                               1297 05311000
         STH   @14,DARGINS+16(,@15)                                1297 05312000
*           VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*         @Y30LB38*/ 05313000
         STH   @11,DARGINL+16(,@15)                                1298 05314000
*           VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*           @Y30LB38*/ 05315000
         LA    @11,VESTEPNM                                        1299 05316000
         ST    @11,DARGDTM+16(,@15)                                1299 05317000
*         END;                      /*                       @Y30LB38*/ 05318000
*                                                                  1300 05319000
*       /*************************************************************/ 05320000
*       /*                                                           */ 05321000
*       /* ISSUE UPRINT MACRO TO RETRIEVE MESSAGE IDC0083I   @Y30LB38*/ 05322000
*       /*                                                           */ 05323000
*       /*************************************************************/ 05324000
*                                                                  1301 05325000
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/ 05326000
*                                                                  1301 05327000
@RC01273 L     @11,@PC00001                                        1301 05328000
         ST    @11,@AL00001                                        1301 05329000
         LA    @15,@CF00115                                        1301 05330000
         ST    @15,@AL00001+4                                      1301 05331000
         LA    @15,VEDDSTRU                                        1301 05332000
         ST    @15,@AL00001+8                                      1301 05333000
         MVI   @AL00001+8,X'80'                                    1301 05334000
         L     @15,GDTPRT(,@11)                                    1301 05335000
         LA    @01,@AL00001                                        1301 05336000
         BALR  @14,@15                                             1301 05337000
*       /*************************************************************/ 05338000
*       /*                                                           */ 05339000
*       /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR CODES       */ 05340000
*       /*                                                   @Y30LB38*/ 05341000
*       /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE IDC2083E*/ 05342000
*       /* TO THE SYSTEM OPERATOR.                           @Y30LB38*/ 05343000
*       /*                                                           */ 05344000
*       /*************************************************************/ 05345000
*                                                                  1302 05346000
*       VEWTOLEN=LENGTH(VEWTOMSG);  /*                       @Y30LB38*/ 05347000
         MVC   VEWTOLEN(2),@CH01281                                1302 05348000
*       VEROUTCD=''B;               /*                       @Y30LB38*/ 05349000
         XC    VEROUTCD(2),VEROUTCD                                1303 05350000
*       VECD1=ON;                   /*                       @Y30LB38*/ 05351000
         OI    VECD1,B'10000000'                                   1304 05352000
*       VEDESCCD=''B;               /*                       @Y30LB38*/ 05353000
         XC    VEDESCCD(2),VEDESCCD                                1305 05354000
*       VEDESC3=ON;                 /*                       @Y30LB38*/ 05355000
         OI    VEDESC3,B'00100000'                                 1306 05356000
*       CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,VEDESCCD);/*    05357000
*                                                            @Y30LB38*/ 05358000
         L     @11,@PC00001                                        1307 05359000
         ST    @11,@AL00001                                        1307 05360000
         LA    @15,VEWTOLEN                                        1307 05361000
         ST    @15,@AL00001+4                                      1307 05362000
         LA    @15,VEWTOPTR                                        1307 05363000
         ST    @15,@AL00001+8                                      1307 05364000
         LA    @15,VEROUTCD                                        1307 05365000
         ST    @15,@AL00001+12                                     1307 05366000
         LA    @15,VEDESCCD                                        1307 05367000
         ST    @15,@AL00001+16                                     1307 05368000
         MVI   @AL00001+16,X'80'                                   1307 05369000
         L     @15,GDTWTO(,@11)                                    1307 05370000
         LA    @01,@AL00001                                        1307 05371000
         BALR  @14,@15                                             1307 05372000
*                                                                  1308 05373000
*       /*************************************************************/ 05374000
*       /*                                                           */ 05375000
*       /* TEST IF BOTH SERIAL NUMBERS WERE SPECIFIED? IF    @Y30LB38*/ 05376000
*       /* YES, PUT BOTH CSN'S IN MESSAGE IDC0085I AND PRINT THE     */ 05377000
*       /* MESSAGE. IF NO, USE ONLY THE FIRST CSN.           @Y30LB38*/ 05378000
*       /*                                                           */ 05379000
*       /*************************************************************/ 05380000
*                                                                  1308 05381000
*       VELIST=''B;                 /*                       @Y30LB38*/ 05382000
         XC    VELIST(52),VELIST                                   1308 05383000
*       VEDDSTRU->DARGSMOD=VECMOMSG;/*                       @Y30LB38*/ 05384000
         L     @11,VEDDSTRU                                        1309 05385000
         MVC   DARGSMOD(3,@11),@CC01387                            1309 05386000
*       VEDDSTRU->DARGSENT=MSG0085I;/*                       @Y30LB38*/ 05387000
         MVI   DARGSENT(@11),X'15'                                 1310 05388000
*       VEDDSTRU->DARGDBP=ADDR(VEMSGPTR->CMCSN1);/*          @Y30LB38*/ 05389000
         L     @15,VEMSGPTR                                        1311 05390000
         LA    @14,CMCSN1(,@15)                                    1311 05391000
         ST    @14,DARGDBP(,@11)                                   1311 05392000
*       VEDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB38*/ 05393000
         LA    @14,12                                              1312 05394000
         STH   @14,DARGILP(,@11)                                   1312 05395000
*       IF VEMSGPTR->CMNUMCRT='F2'X THEN/*                   @Y30LB38*/ 05396000
         CLI   CMNUMCRT(@15),X'F2'                                 1313 05397000
         BNE   @RF01313                                            1313 05398000
*         DO;                       /*                       @Y30LB38*/ 05399000
*           VEDDSTRU->DARGCNT='1'X; /*                       @Y30LB38*/ 05400000
         LA    @03,1                                               1315 05401000
         STH   @03,DARGCNT(,@11)                                   1315 05402000
*           VEDDSTRU->DARGINS(1)='1'X;/*                     @Y30LB38*/ 05403000
         STH   @03,DARGINS(,@11)                                   1316 05404000
*           VEDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*           @Y30LB38*/ 05405000
         STH   @14,DARGINL(,@11)                                   1317 05406000
*           VEDDSTRU->DARGDTM(1)=ADDR(VEMSGPTR->CMCSN2);/*   @Y30LB38*/ 05407000
         LA    @15,CMCSN2(,@15)                                    1318 05408000
         ST    @15,DARGDTM(,@11)                                   1318 05409000
*         END;                      /*                       @Y30LB38*/ 05410000
*       CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*            @Y30LB38*/ 05411000
*                                                                  1320 05412000
@RF01313 L     @11,@PC00001                                        1320 05413000
         ST    @11,@AL00001                                        1320 05414000
         LA    @15,@CF00115                                        1320 05415000
         ST    @15,@AL00001+4                                      1320 05416000
         LA    @15,VEDDSTRU                                        1320 05417000
         ST    @15,@AL00001+8                                      1320 05418000
         MVI   @AL00001+8,X'80'                                    1320 05419000
         L     @15,GDTPRT(,@11)                                    1320 05420000
         LA    @01,@AL00001                                        1320 05421000
         BALR  @14,@15                                             1320 05422000
*       /*************************************************************/ 05423000
*       /*                                                           */ 05424000
*       /* ISSUE UFSPACE MACRO TO FREE MESSAGE AREA SPACE    @Y30LB38*/ 05425000
*       /* FROM THE USSC MACRO                               @Y30LB38*/ 05426000
*       /*                                                           */ 05427000
*       /*************************************************************/ 05428000
*                                                                  1321 05429000
*       VEMSGPTR=VEMSGPTR-VEECBLEN; /*                       @Y30LB38*/ 05430000
         L     @11,VEMSGPTR                                        1321 05431000
         SL    @11,@CF00042                                        1321 05432000
         ST    @11,VEMSGPTR                                        1321 05433000
*       CALL IDCSAFS0(GDTTBL,VEMSGPTR);/*                    @Y30LB38*/ 05434000
         L     @11,@PC00001                                        1322 05435000
         ST    @11,@AL00001                                        1322 05436000
         LA    @15,VEMSGPTR                                        1322 05437000
         ST    @15,@AL00001+4                                      1322 05438000
         L     @15,GDTFSP(,@11)                                    1322 05439000
         LA    @01,@AL00001                                        1322 05440000
         BALR  @14,@15                                             1322 05441000
*     END;                          /*                       @Y30LB38*/ 05442000
*   ELSE                                                           1324 05443000
*     DO;                           /*                       @Y30LB38*/ 05444000
*                                                                  1324 05445000
         B     @RC01262                                            1324 05446000
@RF01262 DS    0H                                                  1325 05447000
*       /*************************************************************/ 05448000
*       /*                                                           */ 05449000
*       /* THE RETURN CODE FROM THE USSC MACRO WAS NOT 0 OR 12.      */ 05450000
*       /*                                                   @Y30LB38*/ 05451000
*       /* A RETURN CODE OF 8 IS CHECKED TO DETERMINE IF USSC COULD  */ 05452000
*       /* NOT GET STORAGE. IF YES, MESSAGE IDC2084I IS WRITTEN AND  */ 05453000
*       /* RETURN TO CALLER WITH CONDITION CODE 4.           @Y30LB38*/ 05454000
*       /*                                                           */ 05455000
*       /*************************************************************/ 05456000
*                                                                  1325 05457000
*       IF TESTRC=LASTCC08 THEN                                    1325 05458000
         C     TESTRC,@CF00179                                     1325 05459000
         BNE   @RF01325                                            1325 05460000
*         DO;                       /*                       @Y30LB38*/ 05461000
*           VELIST=''B;             /*                       @Y30LB38*/ 05462000
         XC    VELIST(52),VELIST                                   1327 05463000
*           VEDDSTRU->DARGSMOD=VECMOMSG;/*                   @Y30LB38*/ 05464000
         L     @11,VEDDSTRU                                        1328 05465000
         MVC   DARGSMOD(3,@11),@CC01387                            1328 05466000
*           VEDDSTRU->DARGSENT=MSG2084I;/*                   @Y30LB38*/ 05467000
         MVI   DARGSENT(@11),X'16'                                 1329 05468000
*           CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*        @Y30LB38*/ 05469000
         L     @11,@PC00001                                        1330 05470000
         ST    @11,@AL00001                                        1330 05471000
         LA    @15,@CF00115                                        1330 05472000
         ST    @15,@AL00001+4                                      1330 05473000
         LA    @15,VEDDSTRU                                        1330 05474000
         ST    @15,@AL00001+8                                      1330 05475000
         MVI   @AL00001+8,X'80'                                    1330 05476000
         L     @15,GDTPRT(,@11)                                    1330 05477000
         LA    @01,@AL00001                                        1330 05478000
         BALR  @14,@15                                             1330 05479000
*           VECOND=LASTCC04;        /*                       @Y30LB38*/ 05480000
         LA    VECOND,4                                            1331 05481000
*         END;                      /*                       @Y30LB38*/ 05482000
*       ELSE                                                       1333 05483000
*         DO;                       /*                       @Y30LB38*/ 05484000
*                                                                  1333 05485000
         B     @RC01325                                            1333 05486000
@RF01325 DS    0H                                                  1334 05487000
*           /*********************************************************/ 05488000
*           /*                                                       */ 05489000
*           /* IF THE RETURN CODE WAS NOT 8, TEST IF THE REASON      */ 05490000
*           /*                                               @Y30LB38*/ 05491000
*           /* CODE WAS '4C'X INDICATING THAT THE FIRST CARTRIDGE WAS*/ 05492000
*           /* EJECTED BUT THE SECOND WAS NOT. IF YES, ISSUE UPRINT  */ 05493000
*           /* AND UWTO MACROS TO WRITE MESSAGE IDC083E TO THE SYSTEM*/ 05494000
*           /* OPERATOR AND ISSUE UPRINT MACRO TO WRITE MESSAGE      */ 05495000
*           /* IDC0085I TO THE USER.                         @Y30LB38*/ 05496000
*           /* ISSUE USYSINFO MACRO TO OBTAIN JOBNAME AND STEPNAME   */ 05497000
*           /*                                               @Y30LB38*/ 05498000
*           /* TO BE USED IN MESSAGE IDC083E                 @Y30LB38*/ 05499000
*           /*                                                       */ 05500000
*           /*********************************************************/ 05501000
*                                                                  1334 05502000
*           IF VERESNCD='4C'X THEN                                 1334 05503000
         CLC   VERESNCD(4),@CF01677                                1334 05504000
         BNE   @RF01334                                            1334 05505000
*             DO;                   /*                       @Y30LB38*/ 05506000
*               CALL IDCSASI0(GDTTBL,NAMES,ADDR(VESYSIN));/* @Y30LB38*/ 05507000
         L     @11,@PC00001                                        1336 05508000
         ST    @11,@AL00001                                        1336 05509000
         LA    @04,NAMES                                           1336 05510000
         ST    @04,@AL00001+4                                      1336 05511000
         LA    @04,VESYSIN                                         1336 05512000
         ST    @04,@AFTEMPS+28                                     1336 05513000
         LA    @04,@AFTEMPS+28                                     1336 05514000
         ST    @04,@AL00001+8                                      1336 05515000
         MVI   @AL00001+8,X'80'                                    1336 05516000
         L     @15,GDTSFO(,@11)                                    1336 05517000
         LA    @01,@AL00001                                        1336 05518000
         BALR  @14,@15                                             1336 05519000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 05520000
         L     @11,VEDDSTRU                                        1337 05521000
         MVC   DARGSMOD(3,@11),@CC01387                            1337 05522000
*               VEDDSTRU->DARGSENT=MSG083E;/*                @Y30LB38*/ 05523000
         MVI   DARGSENT(@11),X'17'                                 1338 05524000
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/ 05525000
         L     @04,@PC00016                                        1339 05526000
         ST    @04,DARGDBP(,@11)                                   1339 05527000
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/ 05528000
         MVC   DARGILP(2,@11),@CH00565                             1340 05529000
*               VEDDSTRU->DARGRETP=VEWTOPTR;/*               @Y30LB38*/ 05530000
         L     @04,VEWTOPTR                                        1341 05531000
         ST    @04,DARGRETP(,@11)                                  1341 05532000
*               VEDDSTRU->DARGRETL=LENGTH(VEWTOMSG);/*       @Y30LB38*/ 05533000
         MVC   DARGRETL(2,@11),@CH01281                            1342 05534000
*               VEDDSTRU->DARGCNT='3'X;/*                    @Y30LB38*/ 05535000
         LA    @04,3                                               1343 05536000
         STH   @04,DARGCNT(,@11)                                   1343 05537000
*               VEDDSTRU->DARGINS(1)='2'X;/*                 @Y30LB38*/ 05538000
         LA    @15,2                                               1344 05539000
         STH   @15,DARGINS(,@11)                                   1344 05540000
*               VEDDSTRU->DARGINL(1)=LENGTH(VEVOLUME);/*     @Y30LB38*/ 05541000
         MVC   DARGINL(2,@11),@CH00156                             1345 05542000
*               VEDDSTRU->DARGDTM(1)=ADDR(VEVOLUME);/*       @Y30LB38*/ 05543000
         L     @15,@PC00016+4                                      1346 05544000
         ST    @15,DARGDTM(,@11)                                   1346 05545000
*               VEDDSTRU->DARGINS(2)='3'X;/*                 @Y30LB38*/ 05546000
         STH   @04,DARGINS+8(,@11)                                 1347 05547000
*               VEDDSTRU->DARGINL(2)=LENGTH(VEJOBNAM);/*     @Y30LB38*/ 05548000
         LA    @04,8                                               1348 05549000
         STH   @04,DARGINL+8(,@11)                                 1348 05550000
*               VEDDSTRU->DARGDTM(2)=ADDR(VEJOBNAM);/*       @Y30LB38*/ 05551000
         LA    @15,VEJOBNAM                                        1349 05552000
         ST    @15,DARGDTM+8(,@11)                                 1349 05553000
*               VEDDSTRU->DARGINS(3)='4'X;/*                 @Y30LB38*/ 05554000
         LA    @15,4                                               1350 05555000
         STH   @15,DARGINS+16(,@11)                                1350 05556000
*               VEDDSTRU->DARGINL(3)=LENGTH(VESTEPNM);/*     @Y30LB38*/ 05557000
         STH   @04,DARGINL+16(,@11)                                1351 05558000
*               VEDDSTRU->DARGDTM(3)=ADDR(VESTEPNM);/*       @Y30LB38*/ 05559000
         LA    @04,VESTEPNM                                        1352 05560000
         ST    @04,DARGDTM+16(,@11)                                1352 05561000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 05562000
*                                                                  1353 05563000
         L     @11,@PC00001                                        1353 05564000
         ST    @11,@AL00001                                        1353 05565000
         LA    @04,@CF00115                                        1353 05566000
         ST    @04,@AL00001+4                                      1353 05567000
         LA    @04,VEDDSTRU                                        1353 05568000
         ST    @04,@AL00001+8                                      1353 05569000
         MVI   @AL00001+8,X'80'                                    1353 05570000
         L     @15,GDTPRT(,@11)                                    1353 05571000
         LA    @01,@AL00001                                        1353 05572000
         BALR  @14,@15                                             1353 05573000
*               /*****************************************************/ 05574000
*               /*                                                   */ 05575000
*               /* SET MESSAGE LENGTH AND ROUTING AND DESCRIPTOR     */ 05576000
*               /* CODES                                     @Y30LB38*/ 05577000
*               /* FOR UWTO MACRO. ISSUE UWTO MACRO TO WRITE MESSAGE */ 05578000
*               /* IDC083E TO THE SYSTEM OPERATOR.           @Y30LB38*/ 05579000
*               /*                                                   */ 05580000
*               /*****************************************************/ 05581000
*                                                                  1354 05582000
*               VEWTOLEN=LENGTH(VEWTOMSG);/*                 @Y30LB38*/ 05583000
         MVC   VEWTOLEN(2),@CH01281                                1354 05584000
*               VEROUTCD=''B;       /*                       @Y30LB38*/ 05585000
         XC    VEROUTCD(2),VEROUTCD                                1355 05586000
*               VECD1=ON;           /*                       @Y30LB38*/ 05587000
         OI    VECD1,B'10000000'                                   1356 05588000
*               VEDESCCD=''B;       /*                       @Y30LB38*/ 05589000
         XC    VEDESCCD(2),VEDESCCD                                1357 05590000
*               VEDESC3=ON;         /*                       @Y30LB38*/ 05591000
         OI    VEDESC3,B'00100000'                                 1358 05592000
*               CALL IDCSAWO0(GDTTBL,VEWTOLEN,VEWTOPTR,VEROUTCD,   1359 05593000
*                   VEDESCCD);      /*                       @Y30LB38*/ 05594000
*                                                                  1359 05595000
         L     @11,@PC00001                                        1359 05596000
         ST    @11,@AL00001                                        1359 05597000
         LA    @04,VEWTOLEN                                        1359 05598000
         ST    @04,@AL00001+4                                      1359 05599000
         LA    @04,VEWTOPTR                                        1359 05600000
         ST    @04,@AL00001+8                                      1359 05601000
         LA    @04,VEROUTCD                                        1359 05602000
         ST    @04,@AL00001+12                                     1359 05603000
         LA    @04,VEDESCCD                                        1359 05604000
         ST    @04,@AL00001+16                                     1359 05605000
         MVI   @AL00001+16,X'80'                                   1359 05606000
         L     @15,GDTWTO(,@11)                                    1359 05607000
         LA    @01,@AL00001                                        1359 05608000
         BALR  @14,@15                                             1359 05609000
*               /*****************************************************/ 05610000
*               /*                                                   */ 05611000
*               /* ISSUE UPRINT MACRO TO PRINT MESSAGE IDC0085I      */ 05612000
*               /*                                           @Y30LB38*/ 05613000
*               /*                                                   */ 05614000
*               /*****************************************************/ 05615000
*                                                                  1360 05616000
*               VELIST=''B;         /*                       @Y30LB38*/ 05617000
         XC    VELIST(52),VELIST                                   1360 05618000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 05619000
         L     @11,VEDDSTRU                                        1361 05620000
         MVC   DARGSMOD(3,@11),@CC01387                            1361 05621000
*               VEDDSTRU->DARGSENT=MSG0085I;/*               @Y30LB38*/ 05622000
         MVI   DARGSENT(@11),X'15'                                 1362 05623000
*               VEDDSTRU->DARGDBP=ADDR(VECSN1);/*            @Y30LB38*/ 05624000
         L     @04,@PC00016                                        1363 05625000
         ST    @04,DARGDBP(,@11)                                   1363 05626000
*               VEDDSTRU->DARGILP=LENGTH(VECSN1);/*          @Y30LB38*/ 05627000
         MVC   DARGILP(2,@11),@CH00565                             1364 05628000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 05629000
*                                                                  1365 05630000
         L     @11,@PC00001                                        1365 05631000
         ST    @11,@AL00001                                        1365 05632000
         LA    @04,@CF00115                                        1365 05633000
         ST    @04,@AL00001+4                                      1365 05634000
         LA    @04,VEDDSTRU                                        1365 05635000
         ST    @04,@AL00001+8                                      1365 05636000
         MVI   @AL00001+8,X'80'                                    1365 05637000
         L     @15,GDTPRT(,@11)                                    1365 05638000
         LA    @01,@AL00001                                        1365 05639000
         BALR  @14,@15                                             1365 05640000
*               /*****************************************************/ 05641000
*               /*                                                   */ 05642000
*               /* THE SSCMSG ROUTINE IS CALLED TO WRITE THE MSS     */ 05643000
*               /*                                           @Y30LB38*/ 05644000
*               /* MESSAGE EXPLAINING THE SECOND CARTRIDGE WAS NOT   */ 05645000
*               /* EJECTED.                                  @Y30LB38*/ 05646000
*               /*                                                   */ 05647000
*               /*****************************************************/ 05648000
*                                                                  1366 05649000
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/ 05650000
         LA    @11,VERESNCD                                        1366 05651000
         ST    @11,@AL00001                                        1366 05652000
         LA    @01,@AL00001                                        1366 05653000
         BAL   @14,SSCMSG                                          1366 05654000
*               VECOND=LASTCC08;    /*                       @Y30LB38*/ 05655000
         LA    VECOND,8                                            1367 05656000
*             END;                  /*                       @Y30LB38*/ 05657000
*           ELSE                                                   1369 05658000
*             DO;                   /*                       @Y30LB38*/ 05659000
*                                                                  1369 05660000
         B     @RC01334                                            1369 05661000
@RF01334 DS    0H                                                  1370 05662000
*               /*****************************************************/ 05663000
*               /*                                                   */ 05664000
*               /* RETURN CODE FROM USSC IS 4 INDICATING THAT        */ 05665000
*               /*                                           @Y30LB38*/ 05666000
*               /* THE CARTRIDGES WERE NOT EJECTED. THE SSCMSG       */ 05667000
*               /* ROUTINE IS CALLED TO WRITE THE MSS MESSAGE        */ 05668000
*               /* EXPLAINING THE ERROR. MESSAGE IDC2048I IS WRITTEN */ 05669000
*               /* TO THE USER WITH THE UPRINT MACRO.        @Y30LB38*/ 05670000
*               /*                                                   */ 05671000
*               /*****************************************************/ 05672000
*                                                                  1370 05673000
*               CALL SSCMSG(VERESNCD);/*                     @Y30LB38*/ 05674000
         LA    @11,VERESNCD                                        1370 05675000
         ST    @11,@AL00001                                        1370 05676000
         LA    @01,@AL00001                                        1370 05677000
         BAL   @14,SSCMSG                                          1370 05678000
*               VEDDSTRU->DARGSMOD=VECMOMSG;/*               @Y30LB38*/ 05679000
         L     @11,VEDDSTRU                                        1371 05680000
         MVC   DARGSMOD(3,@11),@CC01387                            1371 05681000
*               VEDDSTRU->DARGSENT=MSG2084I;/*               @Y30LB38*/ 05682000
         MVI   DARGSENT(@11),X'16'                                 1372 05683000
*               CALL AMSTP011(GDTTBL,PRTFILE,VEDDSTRU);/*    @Y30LB38*/ 05684000
         L     @11,@PC00001                                        1373 05685000
         ST    @11,@AL00001                                        1373 05686000
         LA    @15,@CF00115                                        1373 05687000
         ST    @15,@AL00001+4                                      1373 05688000
         LA    @15,VEDDSTRU                                        1373 05689000
         ST    @15,@AL00001+8                                      1373 05690000
         MVI   @AL00001+8,X'80'                                    1373 05691000
         L     @15,GDTPRT(,@11)                                    1373 05692000
         LA    @01,@AL00001                                        1373 05693000
         BALR  @14,@15                                             1373 05694000
*               VECOND=LASTCC04;    /*                       @Y30LB38*/ 05695000
         LA    VECOND,4                                            1374 05696000
*             END;                  /*                       @Y30LB38*/ 05697000
*         END;                      /*                       @Y30LB38*/ 05698000
@RC01334 DS    0H                                                  1377 05699000
*     END;                          /*                       @Y30LB38*/ 05700000
*                                                                  1377 05701000
@RC01325 DS    0H                                                  1378 05702000
*   /*****************************************************************/ 05703000
*   /*                                                               */ 05704000
*   /* RESTORE RETURN ADDRESS AND RETURN TO CALLER           @Y30LB38*/ 05705000
*   /*                                                               */ 05706000
*   /*****************************************************************/ 05707000
*                                                                  1378 05708000
*   REG14=VERETADR;                 /*                       @Y30LB38*/ 05709000
@RC01262 LR    REG14,VERETADR                                      1378 05710000
*   RETURN CODE(VECOND);            /*                       @Y30LB38*/ 05711000
         LR    @15,VECOND                                          1379 05712000
@EL00016 DS    0H                                                  1379 05713000
@EF00016 DS    0H                                                  1379 05714000
@ER00016 BR    @14                                                 1379 05715000
*   END VOLEXIT;                    /*                       @Y30LB38*/ 05716000
*                                                                  1381 05717000
*/***********************************************************@Y30LB39*/ 05718000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 05719000
*/*                                                          @Y30LB39*/ 05720000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 05721000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 05722000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 05723000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 05724000
*/*                                                          @Y30LB39*/ 05725000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 05726000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 05727000
*/*   IN SSECBCD.                                            @Y30LB39*/ 05728000
*/*                                                          @Y30LB39*/ 05729000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 05730000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 05731000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 05732000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 05733000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 05734000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 05735000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 05736000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 05737000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 05738000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 05739000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 05740000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 05741000
*/*                                                          @Y30LB39*/ 05742000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 05743000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 05744000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 05745000
*/*                                                          @Y30LB39*/ 05746000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 05747000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 05748000
*/*                                                          @Y30LB39*/ 05749000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 05750000
*/*                                                          @Y30LB39*/ 05751000
*/***********************************************************@Y30LB39*/ 05752000
*                                                                  1381 05753000
*                                   /*                       @Y30LB39*/ 05754000
*SSCMSG:                                                           1381 05755000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 05756000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   05757000
*                                                            @Y30LB39*/ 05758000
SSCMSG   STM   @14,@12,@SA00017                                    1381 05759000
         MVC   @PC00017(8),0(@01)                                  1381 05760000
*                                   /*                       @Y30LB39*/ 05761000
*                                                                  1382 05762000
*   /*****************************************************************/ 05763000
*   /*                                                               */ 05764000
*   /*                                                       @Y30LB39*/ 05765000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 05766000
*   /*                                                       @Y30LB39*/ 05767000
*   /*                                                               */ 05768000
*   /*****************************************************************/ 05769000
*                                                                  1382 05770000
*                                   /*                       @Y30LB39   05771000
*                                                            @Y30LB39*/ 05772000
*                                                                  1382 05773000
*   /*****************************************************************/ 05774000
*   /*                                                               */ 05775000
*   /*                                                       @Y30LB39*/ 05776000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 05777000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 05778000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 05779000
*   /*                                                       @Y30LB39*/ 05780000
*   /*                                                               */ 05781000
*   /*****************************************************************/ 05782000
*                                                                  1382 05783000
*                                   /*                       @Y30LB39*/ 05784000
*   DCL                                                            1382 05785000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 05786000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 05787000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 05788000
*   DCL                                                            1383 05789000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   05790000
*                                                            @Y30LB39   05791000
*                                                            @Y30LB39*/ 05792000
*                                                                  1383 05793000
*   /*****************************************************************/ 05794000
*   /*                                                               */ 05795000
*   /*                                                       @Y30LB39*/ 05796000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 05797000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 05798000
*   /*                                                       @Y30LB39*/ 05799000
*   /*                                                               */ 05800000
*   /*****************************************************************/ 05801000
*                                                                  1384 05802000
*                                   /*                       @Y30LB39*/ 05803000
*   DCL                                                            1384 05804000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 05805000
*   DCL                                                            1385 05806000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   05807000
*                                                            @Y30LB39*/ 05808000
*                                                                  1385 05809000
*   /*****************************************************************/ 05810000
*   /*                                                               */ 05811000
*   /*                                                       @Y30LB39*/ 05812000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 05813000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 05814000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 05815000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 05816000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 05817000
*   /*                                                       @Y30LB39*/ 05818000
*   /*                                                               */ 05819000
*   /*****************************************************************/ 05820000
*                                                                  1386 05821000
*                                   /*                       @Y30LB39*/ 05822000
*   DECLARE                                                        1386 05823000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   05824000
*                                                            @Y30LB39*/ 05825000
*                                                                  1386 05826000
*   /*****************************************************************/ 05827000
*   /*                                                               */ 05828000
*   /*                                                       @Y30LB39*/ 05829000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 05830000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 05831000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 05832000
*   /* IDCTSCM0.                                             @Y30LB39*/ 05833000
*   /*                                                       @Y30LB39*/ 05834000
*   /*                                                               */ 05835000
*   /*****************************************************************/ 05836000
*                                                                  1387 05837000
*                                   /*                       @Y30LB39*/ 05838000
*   DECLARE                                                        1387 05839000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   05840000
*                                                            @Y30LB39*/ 05841000
*                                                                  1387 05842000
*   /*****************************************************************/ 05843000
*   /*                                                               */ 05844000
*   /*                                                       @Y30LB39*/ 05845000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 05846000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 05847000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 05848000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 05849000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 05850000
*   /*                                                       @Y30LB39*/ 05851000
*   /*                                                               */ 05852000
*   /*****************************************************************/ 05853000
*                                                                  1388 05854000
*                                   /*                       @Y30LB39*/ 05855000
*   DECLARE                                                        1388 05856000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 05857000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   05858000
*                                                            @Y30LB39*/ 05859000
*                                                                  1388 05860000
*   /*****************************************************************/ 05861000
*   /*                                                               */ 05862000
*   /*                                                       @Y30LB39*/ 05863000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 05864000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 05865000
*   /*                                                       @Y30LB39*/ 05866000
*   /*                                                               */ 05867000
*   /*****************************************************************/ 05868000
*                                                                  1389 05869000
*                                   /*                       @Y30LB39*/ 05870000
*   DECLARE                                                        1389 05871000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   05872000
*                                                            @Y30LB39*/ 05873000
*                                                                  1389 05874000
*   /*****************************************************************/ 05875000
*   /*                                                               */ 05876000
*   /*                                                       @Y30LB39*/ 05877000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 05878000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 05879000
*   /*                                                       @Y30LB39*/ 05880000
*   /*                                                               */ 05881000
*   /*****************************************************************/ 05882000
*                                                                  1390 05883000
*                                   /*                       @Y30LB39*/ 05884000
*   DECLARE                                                        1390 05885000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   05886000
*                                                            @Y30LB39*/ 05887000
*                                   /*                       @Y30LB39*/ 05888000
*                                                                  1391 05889000
*   /*****************************************************************/ 05890000
*   /*                                                               */ 05891000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 05892000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 05893000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 05894000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 05895000
*   /*                                                       @Y30LB39*/ 05896000
*   /*                                                               */ 05897000
*   /*****************************************************************/ 05898000
*                                                                  1391 05899000
*                                   /*                       @Y30LB39*/ 05900000
*   OLDERID2=NEWERID2;                                             1391 05901000
         L     @11,@PC00001                                        1391 05902000
         L     @15,GDTTR2(,@11)                                    1391 05903000
         MVC   @TS00001(95),NEWERID2(@15)                          1391 05904000
         MVC   OLDERID2(95,@15),@TS00001                           1391 05905000
*   NEWID2='SSAA';                  /*                       @Y30LB39   05906000
*                                                            @Y30LB39*/ 05907000
*                                                                  1392 05908000
         MVC   NEWID2(4,@15),@CC01698                              1392 05909000
*   /*****************************************************************/ 05910000
*   /*                                                               */ 05911000
*   /*                                                       @Y30LB39*/ 05912000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 05913000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 05914000
*   /*                                                       @Y30LB39*/ 05915000
*   /*                                                               */ 05916000
*   /*****************************************************************/ 05917000
*                                                                  1393 05918000
*                                   /*                       @Y30LB39*/ 05919000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   05920000
*                                                            @Y30LB39*/ 05921000
*                                                                  1393 05922000
         LA    @15,SSDRGLT                                         1393 05923000
         ST    @15,SSDLPTR                                         1393 05924000
*   /*****************************************************************/ 05925000
*   /*                                                               */ 05926000
*   /*                                                       @Y30LB39*/ 05927000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 05928000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 05929000
*   /*                                                       @Y30LB39*/ 05930000
*   /*                                                               */ 05931000
*   /*****************************************************************/ 05932000
*                                                                  1394 05933000
*                                   /*                       @Y30LB39*/ 05934000
*   IF SSRCODE>0 THEN                                              1394 05935000
         L     @14,@PC00017                                        1394 05936000
         L     @14,SSRCODE(,@14)                                   1394 05937000
         LTR   @14,@14                                             1394 05938000
         BNP   @RF01394                                            1394 05939000
*     DO;                           /*                       @Y30LB39   05940000
*                                                            @Y30LB39*/ 05941000
*                                                                  1395 05942000
*       /*************************************************************/ 05943000
*       /*                                                           */ 05944000
*       /*                                                   @Y30LB39*/ 05945000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 05946000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 05947000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 05948000
*       /* CODES.                                            @Y30LB39*/ 05949000
*       /*                                                   @Y30LB39*/ 05950000
*       /*                                                           */ 05951000
*       /*************************************************************/ 05952000
*                                                                  1396 05953000
*                                   /*                       @Y30LB39*/ 05954000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 05955000
         XC    SSDRGLT(20),SSDRGLT                                 1396 05956000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 05957000
         LA    @03,SSINXLST                                        1397 05958000
         ST    @03,DARGRETP(,@15)                                  1397 05959000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 05960000
         MVC   DARGSMOD(3,@15),SSMODSS0                            1398 05961000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 05962000
         MVI   DARGSENT(@15),X'01'                                 1399 05963000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   05964000
*                                                            @Y30LB39*/ 05965000
*                                                                  1400 05966000
         MVC   DARGRETL(2,@15),@CH01705                            1400 05967000
*       /*************************************************************/ 05968000
*       /*                                                           */ 05969000
*       /*                                                   @Y30LB39*/ 05970000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 05971000
*       /* ARRAY.                                            @Y30LB39*/ 05972000
*       /*                                                   @Y30LB39*/ 05973000
*       /*                                                           */ 05974000
*       /*************************************************************/ 05975000
*                                                                  1401 05976000
*                                   /*                       @Y30LB39*/ 05977000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   05978000
*                                                            @Y30LB39*/ 05979000
*                                                                  1401 05980000
         ST    @11,@AL00001                                        1401 05981000
         LA    @03,@CF00115                                        1401 05982000
         ST    @03,@AL00001+4                                      1401 05983000
         LA    @03,SSDLPTR                                         1401 05984000
         ST    @03,@AL00001+8                                      1401 05985000
         MVI   @AL00001+8,X'80'                                    1401 05986000
         L     @15,GDTPRT(,@11)                                    1401 05987000
         LA    @01,@AL00001                                        1401 05988000
         BALR  @14,@15                                             1401 05989000
*       /*************************************************************/ 05990000
*       /*                                                           */ 05991000
*       /*                                                   @Y30LB39*/ 05992000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 05993000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 05994000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 05995000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 05996000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 05997000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 05998000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 05999000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 06000000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 06001000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 06002000
*       /* REASON CODE.                                      @Y30LB39*/ 06003000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 06004000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 06005000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 06006000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 06007000
*       /*                                                   @Y30LB39*/ 06008000
*       /*                                                           */ 06009000
*       /*************************************************************/ 06010000
*                                                                  1402 06011000
*                                   /*                       @Y30LB39*/ 06012000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 06013000
         LA    ENTRYNUM,1                                          1402 06014000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   1403 06015000
@DL01403 DS    0H                                                  1404 06016000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 06017000
         AL    ENTRYNUM,@CF00219                                   1404 06018000
*       END;                        /*                       @Y30LB39   06019000
*                                                            @Y30LB39*/ 06020000
*                                                                  1405 06021000
@DE01403 L     @11,@PC00017                                        1405 06022000
         LR    @03,ENTRYNUM                                        1405 06023000
         ALR   @03,@03                                             1405 06024000
         LH    @03,SSARRAY-2(@03)                                  1405 06025000
         CH    @03,SSRHALF(,@11)                                   1405 06026000
         BE    @DC01403                                            1405 06027000
         SLR   @15,@15                                             1405 06028000
         CR    @03,@15                                             1405 06029000
         BNE   @DL01403                                            1405 06030000
@DC01403 DS    0H                                                  1406 06031000
*       /*************************************************************/ 06032000
*       /*                                                           */ 06033000
*       /*                                                   @Y30LB39*/ 06034000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 06035000
*       /*                                                   @Y30LB39*/ 06036000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 06037000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 06038000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 06039000
*       /* CODE OR                                           @Y30LB39*/ 06040000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 06041000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 06042000
*       /*                                                   @Y30LB39*/ 06043000
*       /*                                                           */ 06044000
*       /*************************************************************/ 06045000
*                                                                  1406 06046000
*                                   /*                       @Y30LB39*/ 06047000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 06048000
         XC    SSDRGLT(20),SSDRGLT                                 1406 06049000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 06050000
         L     @14,SSDLPTR                                         1407 06051000
         MVC   DARGSMOD(3,@14),SSMODSS0                            1407 06052000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 06053000
         STC   ENTRYNUM,DARGSENT(,@14)                             1408 06054000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 06055000
         CR    @03,@15                                             1409 06056000
         BNE   @RF01409                                            1409 06057000
*         DO;                       /*                       @Y30LB39*/ 06058000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 06059000
         ST    @11,DARGDBP(,@14)                                   1411 06060000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 06061000
         MVC   DARGILP(2,@14),@CH00042                             1412 06062000
*         END;                      /*                       @Y30LB39*/ 06063000
*     END;                          /*                       @Y30LB39*/ 06064000
*                                   /*                       @Y30LB39*/ 06065000
*                                                                  1415 06066000
*   /*****************************************************************/ 06067000
*   /*                                                               */ 06068000
*   /*                                                       @Y30LB39*/ 06069000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 06070000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 06071000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 06072000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 06073000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 06074000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 06075000
*   /* POST CODE.                                            @Y30LB39*/ 06076000
*   /*                                                       @Y30LB39*/ 06077000
*   /*                                                               */ 06078000
*   /*****************************************************************/ 06079000
*                                                                  1415 06080000
*                                   /*                       @Y30LB39*/ 06081000
*   ELSE                            /*                       @Y30LB39*/ 06082000
*     DO;                           /*                       @Y30LB39*/ 06083000
         B     @RC01394                                            1415 06084000
@RF01394 DS    0H                                                  1416 06085000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 06086000
         XC    SSDRGLT(20),SSDRGLT                                 1416 06087000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 06088000
         L     @11,SSDLPTR                                         1417 06089000
         MVC   DARGSMOD(3,@11),SSMODCM0                            1417 06090000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 06091000
         MVC   DARGSENT(1,@11),SSMSGNUM                            1418 06092000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 06093000
         L     @15,@PC00017+4                                      1419 06094000
         ST    @15,DARGDBP(,@11)                                   1419 06095000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 06096000
         MVC   DARGILP(2,@11),@CH00219                             1420 06097000
*     END;                          /*                       @Y30LB39   06098000
*                                                            @Y30LB39*/ 06099000
*                                                                  1421 06100000
*   /*****************************************************************/ 06101000
*   /*                                                               */ 06102000
*   /*                                                       @Y30LB39*/ 06103000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 06104000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 06105000
*   /*                                                       @Y30LB39*/ 06106000
*   /*                                                               */ 06107000
*   /*****************************************************************/ 06108000
*                                                                  1422 06109000
*                                   /*                       @Y30LB39*/ 06110000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   06111000
*                                                            @Y30LB39*/ 06112000
*                                                                  1422 06113000
@RC01394 L     @11,@PC00001                                        1422 06114000
         ST    @11,@AL00001                                        1422 06115000
         LA    @15,@CF00115                                        1422 06116000
         ST    @15,@AL00001+4                                      1422 06117000
         LA    @15,SSDLPTR                                         1422 06118000
         ST    @15,@AL00001+8                                      1422 06119000
         MVI   @AL00001+8,X'80'                                    1422 06120000
         L     @15,GDTPRT(,@11)                                    1422 06121000
         LA    @01,@AL00001                                        1422 06122000
         BALR  @14,@15                                             1422 06123000
*   /*****************************************************************/ 06124000
*   /*                                                               */ 06125000
*   /*                                                       @Y30LB39*/ 06126000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 06127000
*   /*                                                       @Y30LB39*/ 06128000
*   /*                                                               */ 06129000
*   /*****************************************************************/ 06130000
*                                                                  1423 06131000
*                                   /*                       @Y30LB39   06132000
*                                                            @Y30LB39*/ 06133000
*   RETURN CODE(0);                 /*                       @Y30LB39   06134000
*                                                            @Y30LB39*/ 06135000
         SLR   @15,@15                                             1423 06136000
         L     @14,@SA00017                                        1423 06137000
         LM    @00,@12,@SA00017+8                                  1423 06138000
         BR    @14                                                 1423 06139000
*   END SSCMSG;                     /*                       @Y30LB39*/ 06140000
*   END IDCSR01                     /*                       @Y30LB31*/ 06141000
*                                                                  1425 06142000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 06143000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 06144000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 06145000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 06146000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 06147000
*/*%INCLUDE SYSLIB  (IDCCSSR )                                       */ 06148000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 06149000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 06150000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 06151000
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */ 06152000
*/*%INCLUDE SYSLIB  (IDCDF51 )                                       */ 06153000
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */ 06154000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 06155000
*                                                                  1425 06156000
*       ;                                                          1425 06157000
@DATA    DS    0H                                                       06158000
@CH00153 DC    H'2'                                                     06159000
@CH00430 DC    H'5'                                                     06160000
@CH00156 DC    H'6'                                                     06161000
@CH00810 DC    H'29'                                                    06162000
@CH00044 DC    H'31'                                                    06163000
@CH01398 DC    H'45'                                                    06164000
@CH01161 DC    H'48'                                                    06165000
@CH01281 DC    H'72'                                                    06166000
@CH01702 DC    H'74'                                                    06167000
@CH01700 DC    H'76'                                                    06168000
@CH01703 DC    H'96'                                                    06169000
@CH01705 DC    H'120'                                                   06170000
@CH01704 DC    H'212'                                                   06171000
@CH01699 DC    H'224'                                                   06172000
         DS    0F                                                       06173000
@AL00296 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)        06174000
         DC    A(WAIT)                                                  06175000
         DC    A(@CC01366)                                              06176000
@DATD    DSECT                                                          06177000
         DS    0F                                                       06178000
@SA00001 DS    18F                                                      06179000
@PC00001 DS    3F                                                       06180000
@SA00017 DS    15F                                                      06181000
@PC00017 DS    2F                                                       06182000
@PC00016 DS    5F                                                       06183000
@AL00001 DS    6A                                                       06184000
@AFTEMPS DS    8F                                                       06185000
IDCSR01  CSECT                                                          06186000
         DS    0F                                                       06187000
@CF00115 DC    F'0'                                                     06188000
@CF00219 DC    F'1'                                                     06189000
@CH00219 EQU   @CF00219+2                                               06190000
@CF00042 DC    F'4'                                                     06191000
@CH00042 EQU   @CF00042+2                                               06192000
@CF00179 DC    F'8'                                                     06193000
@CH00179 EQU   @CF00179+2                                               06194000
@CF00565 DC    F'12'                                                    06195000
@CH00565 EQU   @CF00565+2                                               06196000
@CF00473 DC    F'16'                                                    06197000
@CF01677 DC    XL4'4C'                                                  06198000
@DATD    DSECT                                                          06199000
         DS    0D                                                       06200000
LISTSCAN DS    A                                                        06201000
IOCSPTR  DS    A                                                        06202000
OPNPTR   DS    A                                                        06203000
DDSTRU   DS    A                                                        06204000
FSADDR   DS    A                                                        06205000
ERCNVADR DS    A                                                        06206000
CCMSGPTR DS    A                                                        06207000
CTMSGPTR DS    A                                                        06208000
ELEMENT  DS    F                                                        06209000
RVVIPTR  DS    A                                                        06210000
MVRPTR   DS    A                                                        06211000
DEFVPTR  DS    A                                                        06212000
REASON   DS    F                                                        06213000
ECBMSPTR DS    A                                                        06214000
RETADDR1 DS    F                                                        06215000
VEDDSTRU DS    A                                                        06216000
MCLSTPTR DS    A                                                        06217000
VEMSGPTR DS    A                                                        06218000
VEWTOPTR DS    A                                                        06219000
VERESNCD DS    F                                                        06220000
SSDLPTR  DS    A                                                        06221000
LISTPTR  DS    A                                                        06222000
SETUPRC  DS    H                                                        06223000
WORKRC   DS    H                                                        06224000
STORERC  DS    H                                                        06225000
BKOUTRC  DS    H                                                        06226000
VEWTOLEN DS    H                                                        06227000
SETRC    DS    H                                                        06228000
LISTLN   DS    FL1                                                      06229000
@TS00001 DS    CL95                                                     06230000
ECBCODE  DS    CL1                                                      06231000
         DS    CL3                                                      06232000
MSGPARMS DS    CL28                                                     06233000
         ORG   MSGPARMS                                                 06234000
PRINTHDR DS    CL8                                                      06235000
PRINTTBL DS    CL20                                                     06236000
         ORG   MSGPARMS+28                                              06237000
SRALLOC  DS    CL39                                                     06238000
         ORG   SRALLOC                                                  06239000
SRALLHDR DS    CL8                                                      06240000
SRALLTBL DS    CL31                                                     06241000
         ORG   SRALLOC+39                                               06242000
         DS    CL1                                                      06243000
SUNITLST DS    CL12                                                     06244000
         ORG   SUNITLST                                                 06245000
SUNITCNT DS    FL2                                                      06246000
SUNITLEN DS    FL2                                                      06247000
SUNITVAL DS    CL8                                                      06248000
         ORG   SUNITLST+12                                              06249000
SVOLLST  DS    CL10                                                     06250000
         ORG   SVOLLST                                                  06251000
SERCNT   DS    FL2                                                      06252000
SERLEN   DS    FL2                                                      06253000
SERNO    DS    CL6                                                      06254000
         ORG   SVOLLST+10                                               06255000
         DS    CL2                                                      06256000
SRMDAGL  DS    CL31                                                     06257000
         DS    CL1                                                      06258000
SREXCLST DS    CL23                                                     06259000
         DS    CL1                                                      06260000
SVOLBUFF DS    CL232                                                    06261000
         ORG   SVOLBUFF                                                 06262000
SVOLHDR  DS    CL8                                                      06263000
SVOLREC  DS    CL224                                                    06264000
         ORG   SVOLBUFF+232                                             06265000
DUMPLIST DS    CL33                                                     06266000
MINORNM  DS    CL23                                                     06267000
         ORG   MINORNM                                                  06268000
RNMLEN   DS    FL1                                                      06269000
RNAME    DS    CL22                                                     06270000
         ORG   RNAME                                                    06271000
RNMSERNO DS    CL6                                                      06272000
RNMTRAIL DS    CL16                                                     06273000
         ORG   MINORNM+23                                               06274000
STORETBL DS    CL45                                                     06275000
         ORG   STORETBL                                                 06276000
STOREHDR DS    CL8                                                      06277000
SUNITDDN DS    CL8                                                      06278000
SUNITUCB DS    AL4                                                      06279000
CSN1     DS    CL12                                                     06280000
VPREPVOL DS    CL6                                                      06281000
MSVIVOL# DS    CL6                                                      06282000
@NM00115 DS    BL1                                                      06283000
         ORG   @NM00115                                                 06284000
CC04FLG  DS    BL1                                                      06285000
MOUNTFLG EQU   @NM00115+0                                               06286000
ALLOCFLG EQU   @NM00115+0                                               06287000
RECOVFLG EQU   @NM00115+0                                               06288000
BKOUTFLG EQU   @NM00115+0                                               06289000
VSMISFLG EQU   @NM00115+0                                               06290000
SETVSFLG EQU   @NM00115+0                                               06291000
@NM00116 EQU   @NM00115+0                                               06292000
         ORG   STORETBL+45                                              06293000
         DS    CL3                                                      06294000
SR01RVVI DS    CL76                                                     06295000
         ORG   SR01RVVI                                                 06296000
SRVVIHDR DS    CL8                                                      06297000
SRVVITBL DS    CL68                                                     06298000
         ORG   SR01RVVI+76                                              06299000
SRCKAGL  DS    CL29                                                     06300000
SRMDTYPE DS    CL8                                                      06301000
CATDDHLD DS    CL8                                                      06302000
         DS    CL3                                                      06303000
SRVS1LST DS    CL74                                                     06304000
         DS    CL2                                                      06305000
SR01MVR  DS    CL96                                                     06306000
         ORG   SR01MVR                                                  06307000
SRMVRHDR DS    CL8                                                      06308000
SRMVRTBL DS    CL88                                                     06309000
         ORG   SR01MVR+96                                               06310000
SRVS2LST DS    CL45                                                     06311000
RECDISP  DS    BL1                                                      06312000
LOCDATA  DS    CL30                                                     06313000
IOERRFLG DS    BL1                                                      06314000
         ORG   IOERRFLG                                                 06315000
ERRORBIT DS    BL1                                                      06316000
         ORG   IOERRFLG+1                                               06317000
         DS    CL3                                                      06318000
SR01DEFV DS    CL212                                                    06319000
         ORG   SR01DEFV                                                 06320000
SDEFVHDR DS    CL8                                                      06321000
SDEFVLST DS    CL132                                                    06322000
SDEFVEHD DS    CL8                                                      06323000
SDEFVEXT DS    CL64                                                     06324000
         ORG   SR01DEFV+212                                             06325000
VEECB    DS    CL1                                                      06326000
VELIST   DS    CL52                                                     06327000
VEWTOMSG DS    CL72                                                     06328000
VEMCLIST DS    CL48                                                     06329000
VEEXLIST DS    CL44                                                     06330000
VESYSIN  DS    CL16                                                     06331000
         ORG   VESYSIN                                                  06332000
VEJOBNAM DS    CL8                                                      06333000
VESTEPNM DS    CL8                                                      06334000
         ORG   VESYSIN+16                                               06335000
VEROUTCD DS    BL2                                                      06336000
         ORG   VEROUTCD                                                 06337000
VECD1    DS    BL1                                                      06338000
@NM00126 EQU   VEROUTCD+0                                               06339000
         ORG   VEROUTCD+2                                               06340000
VEDESCCD DS    BL2                                                      06341000
         ORG   VEDESCCD                                                 06342000
@NM00127 DS    BL1                                                      06343000
VEDESC3  EQU   VEDESCCD+0                                               06344000
@NM00128 EQU   VEDESCCD+0                                               06345000
         ORG   VEDESCCD+2                                               06346000
VEDMPSTG DS    CL17                                                     06347000
SSDRGLT  DS    CL20                                                     06348000
         DS    CL2                                                      06349000
SSINXLST DS    CL120                                                    06350000
         ORG   SSINXLST                                                 06351000
SSARRAY  DS    60H                                                      06352000
         ORG   SSINXLST+120                                             06353000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                06354000
@ENDDATD EQU   *                                                        06355000
IDCSR01  CSECT                                                          06356000
         DS    0F                                                       06357000
@SIZDATD DC    AL1(0)                                                   06358000
         DC    AL3(@ENDDATD-@DATD)                                      06359000
         DS    0D                                                       06360000
RVVLEN   DC    AL2(68)                                                  06361000
MVRLEN   DC    AL2(88)                                                  06362000
DEFLEN   DC    AL2(64)                                                  06363000
MCRLEN   DC    AL2(44)                                                  06364000
SSMSGNUM DC    AL1(56)                                                  06365000
@CC01433 DC    C'.VIRTUAL.ENQUEUE'                                      06366000
@CC01496 DC    C'.VIRTUAL.RESERVE'                                      06367000
@CC01366 DC    C'SYSZAMS '                                              06368000
@CC01423 DC    C'STORETBL'                                              06369000
@CC01424 DC    C'DARGLIST'                                              06370000
@CC01456 DC    C'SR01RVVI'                                              06371000
@CC01505 DC    C'IDCVS01 '                                              06372000
@CC01509 DC    C'SRVS1LST'                                              06373000
@CC01511 DC    C'JOBCAT  '                                              06374000
@CC01512 DC    C'STEPCAT '                                              06375000
@CC01545 DC    C'IDCVS02 '                                              06376000
@CC01549 DC    C'SRVS2LST'                                              06377000
@CC01578 DC    C'SR01DEFV'                                              06378000
@CC01475 DC    C'SRCKAGL'                                               06379000
@CC01494 DC    C'SRMDAGL'                                               06380000
@CC01537 DC    C'SR01MVR'                                               06381000
@CC01576 DC    C'DEFLIST'                                               06382000
@CC01425 DC    C'VOLREC'                                                06383000
@CC01426 DC    C'ALLAGL'                                                06384000
@CC01670 DC    C'MCLIST'                                                06385000
@CC01354 DC    C'3330V'                                                 06386000
@CC01577 DC    C'DEFVE'                                                 06387000
@CC01332 EQU   @CC01456                                                 06388000
@CC01421 DC    C'SRBG'                                                  06389000
@CC01437 DC    C'SRND'                                                  06390000
@CC01442 DC    C'SRUP'                                                  06391000
@CC01454 DC    C'SRRV'                                                  06392000
@CC01455 DC    C'RVVI'                                                  06393000
@CC01458 DC    C'SRRD'                                                  06394000
@CC01466 DC    C'SRVO'                                                  06395000
@CC01472 DC    C'SRAL'                                                  06396000
@CC01476 EQU   @CC01475                                                 06397000
@CC01481 DC    C'SRSE'                                                  06398000
@CC01493 DC    C'SRVP'                                                  06399000
@CC01495 EQU   @CC01494                                                 06400000
@CC01506 DC    C'SRVT'                                                  06401000
@CC01510 DC    C'SRS1'                                                  06402000
@CC01517 DC    C'SRWK'                                                  06403000
@CC01525 DC    C'SRVL'                                                  06404000
@CC01535 DC    C'SRMV'                                                  06405000
@CC01538 DC    C'SRSM'                                                  06406000
@CC01546 DC    C'SRS2'                                                  06407000
@CC01550 DC    C'SRNS'                                                  06408000
@CC01562 DC    C'SRSR'                                                  06409000
@CC01575 DC    C'SRDE'                                                  06410000
@CC01579 DC    C'SRBD'                                                  06411000
@CC01584 DC    C'SRBK'                                                  06412000
@CC01668 DC    C'VESR'                                                  06413000
@CC01671 DC    C'VEBM'                                                  06414000
@CC01698 DC    C'SSAA'                                                  06415000
@CC01378 EQU   @CC01456                                                 06416000
@CC01387 DC    C'CM0'                                                   06417000
@CC01402 DC    C'UV0'                                                   06418000
@CC01536 DC    C'MVR'                                                   06419000
@CB01491 DC    X'0000000000000000'                                      06420000
@CB01465 EQU   @CB01491                                                 06421000
ALL      DC    CL3'ALL'                                                 06422000
FORMAT   DC    CL4'FORM'                                                06423000
HSECOND  DC    CL4'HSEC'                                                06424000
CLOCK    DC    CL4'KLOK'                                                06425000
SETZERO  DC    CL4'ZERO'                                                06426000
SETBLANK DC    CL4'BLNK'                                                06427000
NOSET    DC    CL4'NSET'                                                06428000
OVERRIDE DC    CL4'OVRD'                                                06429000
ACQUIRE  DC    CL8'ACQUIRE '                                            06430000
RELINQ   DC    CL8'RELINQ  '                                            06431000
MOUNT    DC    CL8'MOUNT   '                                            06432000
DEMOUNT  DC    CL8'DEMOUNT '                                            06433000
DEFINE   DC    CL8'DEFINE  '                                            06434000
MOVE     DC    CL8'MOVE    '                                            06435000
TRACEQ   DC    CL8'TRACEQ  '                                            06436000
COPYTABL DC    CL8'COPYTABL'                                            06437000
COPYCRTG DC    CL8'COPYCRTG'                                            06438000
COPYVOL  DC    CL8'COPYVOL '                                            06439000
VVIC     DC    CL8'VVIC    '                                            06440000
TUNE     DC    CL8'TUNE    '                                            06441000
NAMES    DC    CL4'NAME'                                                06442000
UNIT     DC    CL4'UNIT'                                                06443000
SHR      DC    CL4'SHR '                                                06444000
EXCL     DC    CL4'EXCL'                                                06445000
NOWAIT   DC    CL4'NWAI'                                                06446000
WAIT     DC    CL4'WAIT'                                                06447000
SECCHECK DC    CL8'SECCHECK'                                            06448000
SCRVTOC  DC    CL8'SCRVTOC '                                            06449000
GETVTOC  DC    CL8'GETVTOC '                                            06450000
PUTVTOC  DC    CL8'PUTVTOC '                                            06451000
RECATLG  DC    CL8'RECATLG '                                            06452000
INITVOL  DC    CL8'INITVOL '                                            06453000
CHECK    DC    CL8'CHECK   '                                            06454000
POSTUCB  DC    CL8'POSTUCB '                                            06455000
GET      DC    CL8'GET     '                                            06456000
PUT      DC    CL8'PUT     '                                            06457000
CLOSE    DC    CL8'CLOSE   '                                            06458000
OPEN     DC    CL8'OPEN    '                                            06459000
PUTLABEL DC    CL8'PUTLABEL'                                            06460000
GETLABEL DC    CL8'GETLABEL'                                            06461000
CANCEL   DC    CL8'CANCEL  '                                            06462000
SET      DC    CL8'SET     '                                            06463000
SELECTX  DC    CL8'SELECTX '                                            06464000
CHANGEX  DC    CL8'CHANGEX '                                            06465000
SELECTDD DC    CL8'SELECTDD'                                            06466000
SELECTDS DC    CL8'SELECTDS'                                            06467000
TBLREST  DC    CL8'TBLREST '                                            06468000
NULLIFYC DC    CL8'NULLIFYC'                                            06469000
RDMSC    DC    CL8'RDMSC   '                                            06470000
RDMSCTBL DC    CL8'RDMSCTBL'                                            06471000
RDCARTLB DC    CL8'RDCARTLB'                                            06472000
AUDITCEL DC    CL8'AUDITCEL'                                            06473000
RDSTGAD  DC    CL8'RDSTGAD '                                            06474000
MODID    DC    CL4'SR01'                                                06475000
FIXAREA  DS    CL456                                                    06476000
         ORG   FIXAREA                                                  06477000
@NM00113 DC    256X'00'                                                 06478000
@NM00114 DC    200X'00'                                                 06479000
         ORG   FIXAREA+456                                              06480000
SSMODSS0 DC    CL3'SS0'                                                 06481000
SSMODCM0 DC    CL3'CM0'                                                 06482000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06483000
@01      EQU   01                                                       06484000
@02      EQU   02                                                       06485000
@03      EQU   03                                                       06486000
@04      EQU   04                                                       06487000
@05      EQU   05                                                       06488000
@06      EQU   06                                                       06489000
@07      EQU   07                                                       06490000
@08      EQU   08                                                       06491000
@09      EQU   09                                                       06492000
@10      EQU   10                                                       06493000
@11      EQU   11                                                       06494000
@12      EQU   12                                                       06495000
@13      EQU   13                                                       06496000
@14      EQU   14                                                       06497000
@15      EQU   15                                                       06498000
ENTRYNUM EQU   @02                                                      06499000
VECOND   EQU   @04                                                      06500000
VERETADR EQU   @06                                                      06501000
MCRTEPTR EQU   @03                                                      06502000
DEACTRC  EQU   @04                                                      06503000
VS2RTNRC EQU   @06                                                      06504000
MVRRTNRC EQU   @06                                                      06505000
VLABLRC  EQU   @04                                                      06506000
VTOCKRC  EQU   @04                                                      06507000
VPREPRC  EQU   @04                                                      06508000
SECCKRC  EQU   @06                                                      06509000
ALLOCRC  EQU   @04                                                      06510000
VOLCKRC  EQU   @03                                                      06511000
RVRTNRC  EQU   @04                                                      06512000
RETADDR3 EQU   @11                                                      06513000
RETADDR2 EQU   @07                                                      06514000
DEFVEPTR EQU   @03                                                      06515000
BASEVPTR EQU   @05                                                      06516000
CMMSGPTR EQU   @02                                                      06517000
DMPINDEX EQU   @02                                                      06518000
TESTRC   EQU   @03                                                      06519000
REG8     EQU   @08                                                      06520000
REG9     EQU   @09                                                      06521000
REG10    EQU   @10                                                      06522000
RTNREG   EQU   @15                                                      06523000
REG14    EQU   @14                                                      06524000
DEFVR1   EQU   @01                                                      06525000
MCR1     EQU   @01                                                      06526000
REG0     EQU   @00                                                      06527000
REG1     EQU   @01                                                      06528000
REG11    EQU   @11                                                      06529000
REG12    EQU   @12                                                      06530000
REG13    EQU   @13                                                      06531000
REG15    EQU   @15                                                      06532000
REG2     EQU   @02                                                      06533000
REG3     EQU   @03                                                      06534000
REG4     EQU   @04                                                      06535000
REG5     EQU   @05                                                      06536000
REG6     EQU   @06                                                      06537000
REG7     EQU   @07                                                      06538000
IDCSACL0 EQU   0                                                        06539000
IDCSAEP0 EQU   0                                                        06540000
IDCSAFS0 EQU   0                                                        06541000
IDCSAAL0 EQU   0                                                        06542000
IDCSADL0 EQU   0                                                        06543000
IDCSASS0 EQU   0                                                        06544000
IDCSANQ0 EQU   0                                                        06545000
IDCSADQ0 EQU   0                                                        06546000
IDCSASI0 EQU   0                                                        06547000
IDCSAWO0 EQU   0                                                        06548000
IDCSA060 EQU   0                                                        06549000
TRACE1   EQU   0                                                        06550000
OLDERID1 EQU   TRACE1                                                   06551000
TRACE2   EQU   0                                                        06552000
OLDERID2 EQU   TRACE2                                                   06553000
NEWID2   EQU   TRACE2+95                                                06554000
NEWERID2 EQU   5                                                        06555000
CIRAGL   EQU   0                                                        06556000
CIRTYPE  EQU   CIRAGL                                                   06557000
ALLAGL   EQU   0                                                        06558000
ALLDDN   EQU   ALLAGL+4                                                 06559000
ALLULP   EQU   ALLAGL+12                                                06560000
ALLVLP   EQU   ALLAGL+16                                                06561000
ALLSTS   EQU   ALLAGL+24                                                06562000
ALLDSP   EQU   ALLAGL+25                                                06563000
ALLORG   EQU   ALLAGL+26                                                06564000
ALLOPT   EQU   ALLAGL+28                                                06565000
ALLOPTVL EQU   ALLOPT                                                   06566000
ALLOPTPV EQU   ALLOPT                                                   06567000
ALLVLCNT EQU   ALLAGL+29                                                06568000
ALLUNCNT EQU   ALLAGL+30                                                06569000
UNITABL  EQU   0                                                        06570000
UNITADR  EQU   UNITABL+4                                                06571000
@NM00010 EQU   UNITADR                                                  06572000
UNITSTAT EQU   UNITABL+6                                                06573000
IDCIOCL0 EQU   0                                                        06574000
IOCSTR   EQU   0                                                        06575000
IOCDSO   EQU   IOCSTR+16                                                06576000
IOCRFM   EQU   IOCSTR+17                                                06577000
IOCMAC   EQU   IOCSTR+18                                                06578000
IOCMAC2  EQU   IOCSTR+19                                                06579000
IOCCHP   EQU   IOCSTR+20                                                06580000
IOCMSG   EQU   IOCSTR+21                                                06581000
IOCRBA   EQU   IOCSTR+40                                                06582000
IOCTTR   EQU   IOCRBA                                                   06583000
IOCMEM   EQU   IOCSTR+44                                                06584000
IOCNWM   EQU   IOCSTR+48                                                06585000
OPNAGL   EQU   0                                                        06586000
OPNOPT   EQU   OPNAGL                                                   06587000
OPNRFM   EQU   OPNAGL+1                                                 06588000
OPNTYP   EQU   OPNAGL+2                                                 06589000
OPNMOD   EQU   OPNAGL+3                                                 06590000
OPNDEV   EQU   OPNAGL+24                                                06591000
OPNDSO   EQU   OPNAGL+41                                                06592000
OPNOPT2  EQU   OPNAGL+42                                                06593000
IOINFOPT EQU   0                                                        06594000
UVOLLIST EQU   0                                                        06595000
UVOLENT  EQU   UVOLLIST+2                                               06596000
AMSTP011 EQU   0                                                        06597000
DARGLIST EQU   0                                                        06598000
DARGDBP  EQU   DARGLIST                                                 06599000
DARGRETP EQU   DARGLIST+4                                               06600000
DARGSTID EQU   DARGLIST+8                                               06601000
DARGSMOD EQU   DARGSTID                                                 06602000
DARGSENT EQU   DARGSTID+3                                               06603000
DARGILP  EQU   DARGLIST+12                                              06604000
DARGCNT  EQU   DARGLIST+14                                              06605000
DARGRETL EQU   DARGLIST+16                                              06606000
DARGARY  EQU   DARGLIST+20                                              06607000
DARGINS  EQU   DARGARY                                                  06608000
DARGINL  EQU   DARGARY+2                                                06609000
DARGDTM  EQU   DARGARY+4                                                06610000
FMTLIST  EQU   0                                                        06611000
FMTFLGS  EQU   FMTLIST                                                  06612000
FMTSPF   EQU   FMTLIST+2                                                06613000
FMTRFNO  EQU   FMTSPF                                                   06614000
FMTILEN  EQU   FMTRFNO                                                  06615000
FMTIOFF  EQU   FMTLIST+4                                                06616000
FMTTRBC  EQU   FMTIOFF                                                  06617000
FMTSTO   EQU   FMTTRBC                                                  06618000
FMTOCOL  EQU   FMTLIST+6                                                06619000
FMTCNVF  EQU   FMTLIST+10                                               06620000
ERCNVTAB EQU   0                                                        06621000
ERTYPE   EQU   ERCNVTAB                                                 06622000
EROPER   EQU   ERCNVTAB+1                                               06623000
EROSOPER EQU   ERCNVTAB+2                                               06624000
IDCDB010 EQU   0                                                        06625000
DMPITM   EQU   0                                                        06626000
DMPITMNM EQU   DMPITM                                                   06627000
DMPITMPT EQU   DMPITM+8                                                 06628000
DMPITMLN EQU   DMPITM+12                                                06629000
DMPITMTP EQU   DMPITM+14                                                06630000
DMPARY   EQU   0                                                        06631000
DMPTRM   EQU   0                                                        06632000
CCMSG    EQU   0                                                        06633000
CMMSG    EQU   0                                                        06634000
CMVOLFLG EQU   CMMSG+6                                                  06635000
CMNEWVOL EQU   CMMSG+8                                                  06636000
CMNUMCRT EQU   CMMSG+15                                                 06637000
CMCSN1   EQU   CMMSG+16                                                 06638000
CMCSN2   EQU   CMMSG+28                                                 06639000
CTMSG    EQU   0                                                        06640000
CTARRAY  EQU   CTMSG+4                                                  06641000
MDAGL    EQU   0                                                        06642000
MDUCBPTR EQU   MDAGL+8                                                  06643000
MDDDNAME EQU   MDAGL+12                                                 06644000
MDLABEL  EQU   MDAGL+24                                                 06645000
MDFLAGS  EQU   MDAGL+30                                                 06646000
MDWAIT   EQU   MDFLAGS                                                  06647000
PUAGL    EQU   0                                                        06648000
CKAGL    EQU   0                                                        06649000
CKUCBPTR EQU   CKAGL+8                                                  06650000
CKDDNAME EQU   CKAGL+12                                                 06651000
CKFLAGS  EQU   CKAGL+28                                                 06652000
CKTESTVT EQU   CKFLAGS                                                  06653000
EXCLAGL  EQU   0                                                        06654000
EXCLUCBP EQU   EXCLAGL+8                                                06655000
EXCLDDP  EQU   EXCLAGL+12                                               06656000
EXCLVOL  EQU   EXCLAGL+16                                               06657000
EXCLFLAG EQU   EXCLAGL+22                                               06658000
EXOARG   EQU   0                                                        06659000
EXOPT    EQU   EXOARG+32                                                06660000
EXFLG    EQU   EXOARG+33                                                06661000
EXGARG   EQU   0                                                        06662000
EXPARG   EQU   0                                                        06663000
EXPDATA  EQU   EXPARG+12                                                06664000
EXPDATAB EQU   0                                                        06665000
EXPARRAY EQU   EXPDATAB+4                                               06666000
VS2AGL   EQU   0                                                        06667000
VSUCBPTR EQU   VS2AGL+8                                                 06668000
VSVOLPTR EQU   VS2AGL+20                                                06669000
VSLABOPT EQU   VS2AGL+28                                                06670000
VSVOLSER EQU   VSLABOPT                                                 06671000
VSVOLUME EQU   VS2AGL+29                                                06672000
VS2MSG   EQU   VS2AGL+35                                                06673000
VS2RESOP EQU   VS2AGL+36                                                06674000
VS2RES   EQU   VS2RESOP                                                 06675000
VSDDNAME EQU   VS2AGL+37                                                06676000
VS1AGL   EQU   0                                                        06677000
VSUCBP   EQU   VS1AGL+8                                                 06678000
VSVOLP   EQU   VS1AGL+12                                                06679000
VSFILEP  EQU   VS1AGL+16                                                06680000
VSIOP    EQU   VS1AGL+20                                                06681000
VSCATP   EQU   VS1AGL+32                                                06682000
VSCATDDP EQU   VS1AGL+40                                                06683000
VSPSWDP  EQU   VS1AGL+44                                                06684000
VSPFILEP EQU   VS1AGL+48                                                06685000
VSSECOPT EQU   VS1AGL+68                                                06686000
VSNOVSAM EQU   VSSECOPT                                                 06687000
VSMASTER EQU   VSSECOPT                                                 06688000
VSWRITE  EQU   VSSECOPT                                                 06689000
VSUCTEST EQU   VSSECOPT                                                 06690000
VSOPCAT  EQU   VSSECOPT                                                 06691000
VSVTOPT  EQU   VS1AGL+69                                                06692000
VSCATOPT EQU   VS1AGL+70                                                06693000
VSRETURN EQU   VS1AGL+71                                                06694000
VSUCAT   EQU   VSRETURN                                                 06695000
VSMSG    EQU   VS1AGL+72                                                06696000
VSRESOPT EQU   VS1AGL+73                                                06697000
VSRES    EQU   VSRESOPT                                                 06698000
RCTAGL   EQU   0                                                        06699000
RCTOPT   EQU   RCTAGL+8                                                 06700000
STAEPARM EQU   0                                                        06701000
STARCVY  EQU   STAEPARM+52                                              06702000
STARETRY EQU   STAEPARM+53                                              06703000
VOLLABEL EQU   0                                                        06704000
SV82LIST EQU   0                                                        06705000
@NM00065 EQU   SV82LIST+4                                               06706000
SV82DCBP EQU   @NM00065                                                 06707000
@NM00066 EQU   SV82LIST+12                                              06708000
SV82WRKP EQU   @NM00066                                                 06709000
SRTAGL   EQU   0                                                        06710000
LCTINFO  EQU   0                                                        06711000
LCTFLAGS EQU   LCTINFO+32                                               06712000
UCTAGL   EQU   0                                                        06713000
UCTFLAGS EQU   UCTAGL+68                                                06714000
SELAGL   EQU   0                                                        06715000
SELFLAGS EQU   SELAGL+22                                                06716000
DATESAGL EQU   0                                                        06717000
DATESOPT EQU   DATESAGL+20                                              06718000
VS3AGL   EQU   0                                                        06719000
VS3FLAGS EQU   VS3AGL+58                                                06720000
VSDVTOC  EQU   0                                                        06721000
VSDSTAT  EQU   0                                                        06722000
VSDSFLG1 EQU   VSDSTAT+16                                               06723000
VSDFLG2  EQU   VSDSTAT+17                                               06724000
VSDSCR   EQU   0                                                        06725000
VSDSCRFL EQU   VSDSCR+4                                                 06726000
VSDUSAGE EQU   0                                                        06727000
VSDDORG  EQU   VSDUSAGE+9                                               06728000
VSDALLOC EQU   VSDUSAGE+10                                              06729000
VSDUSEF  EQU   VSDUSAGE+11                                              06730000
VSDDSORG EQU   VSDUSAGE+16                                              06731000
VSDBLOCK EQU   0                                                        06732000
VSDSPACE EQU   VSDBLOCK+12                                              06733000
VSDARRAY EQU   VSDBLOCK+16                                              06734000
VSDVARY  EQU   VSDARRAY+48                                              06735000
VOL      EQU   0                                                        06736000
VOLLEN   EQU   VOL                                                      06737000
VOLVAL   EQU   VOL+1                                                    06738000
NSER     EQU   0                                                        06739000
NSERVAL  EQU   NSER+1                                                   06740000
EJECT    EQU   0                                                        06741000
REC      EQU   0                                                        06742000
NREC     EQU   0                                                        06743000
LOC      EQU   0                                                        06744000
LOCVAL   EQU   LOC+1                                                    06745000
CAT      EQU   0                                                        06746000
CATNM    EQU   0                                                        06747000
CATNMPLN EQU   CATNM                                                    06748000
CATNMPAS EQU   CATNM+1                                                  06749000
CATNMFLG EQU   CATNM+10                                                 06750000
CATNMVAL EQU   CATNM+21                                                 06751000
CATDN    EQU   0                                                        06752000
CATDNVAL EQU   CATDN+1                                                  06753000
FILE     EQU   0                                                        06754000
FILEVAL  EQU   FILE+1                                                   06755000
PFILE    EQU   0                                                        06756000
@NM00084 EQU   PFILE+2                                                  06757000
BASEV    EQU   0                                                        06758000
BASNAME  EQU   BASEV                                                    06759000
BASID    EQU   BASNAME+11                                               06760000
BASFLAGA EQU   BASEV+14                                                 06761000
BASTYPE  EQU   BASFLAGA                                                 06762000
BASINAC  EQU   BASFLAGA+2                                               06763000
BASRONLY EQU   BASFLAGA+3                                               06764000
BASRCVYF EQU   BASEV+20                                                 06765000
BASSATIA EQU   BASRCVYF                                                 06766000
BASIVCRE EQU   BASSATIA                                                 06767000
BASIVCPY EQU   BASSATIA                                                 06768000
BASVSMIS EQU   BASSATIA                                                 06769000
BASMISCF EQU   BASRCVYF+2                                               06770000
BASLIB1  EQU   BASEV+36                                                 06771000
BASLID1  EQU   BASLIB1                                                  06772000
BASLIB2  EQU   BASEV+49                                                 06773000
BASLID2  EQU   BASLIB2                                                  06774000
BASNCOPY EQU   BASEV+62                                                 06775000
BASKLCPY EQU   BASEV+76                                                 06776000
BASCOPID EQU   BASKLCPY+11                                              06777000
BASRECOV EQU   BASEV+174                                                06778000
RVVI     EQU   0                                                        06779000
RVVLNGTH EQU   RVVI                                                     06780000
RVVOPCOD EQU   RVVI+4                                                   06781000
RVVCODE  EQU   RVVOPCOD                                                 06782000
RVVOLUME EQU   RVVI+8                                                   06783000
RVVBUFLN EQU   RVVI+30                                                  06784000
RVVRTBUF EQU   RVVI+32                                                  06785000
RVVFLAGA EQU   RVVI+58                                                  06786000
RVVRMODE EQU   RVVFLAGA                                                 06787000
RVVRDR   EQU   RVVRMODE                                                 06788000
RVVCHAIN EQU   RVVFLAGA+1                                               06789000
RVVRDRCD EQU   RVVFLAGA+2                                               06790000
RVVBVRCD EQU   RVVRDRCD                                                 06791000
RVVRTEST EQU   RVVFLAGA+3                                               06792000
RVVCPYTP EQU   RVVFLAGA+4                                               06793000
RVVSPEC  EQU   RVVFLAGA+5                                               06794000
RVVSVOL  EQU   RVVSPEC                                                  06795000
MVR      EQU   0                                                        06796000
MVRLNGTH EQU   MVR                                                      06797000
MVRCODE  EQU   MVR+4                                                    06798000
MVRFLAGA EQU   MVR+8                                                    06799000
MVRFLBAS EQU   MVRFLAGA                                                 06800000
MVRFLLAB EQU   MVRFLAGA                                                 06801000
MVRSLMIS EQU   MVRFLAGA+1                                               06802000
MVRCLMIS EQU   MVRFLAGA+1                                               06803000
MVRBVOL  EQU   MVR+12                                                   06804000
MVRLABEL EQU   MVR+76                                                   06805000
DEFLIST  EQU   0                                                        06806000
DEFVFLG  EQU   DEFLIST+6                                                06807000
DEFVRNM  EQU   DEFVFLG                                                  06808000
DEFVDACT EQU   DEFVFLG                                                  06809000
DEFVLIB  EQU   DEFLIST+7                                                06810000
DEFVOLD  EQU   DEFLIST+8                                                06811000
DEFVVFLG EQU   DEFLIST+14                                               06812000
DEFVNVOL EQU   DEFLIST+16                                               06813000
DEFVDATA EQU   DEFLIST+56                                               06814000
DEFVVEXT EQU   DEFLIST+128                                              06815000
DEFVE    EQU   0                                                        06816000
DEFLNGTH EQU   DEFVE                                                    06817000
DEFLABEL EQU   DEFVE+49                                                 06818000
DEFFLAGA EQU   DEFVE+55                                                 06819000
DEFPVLAB EQU   DEFFLAGA                                                 06820000
DEFFLAGB EQU   DEFVE+56                                                 06821000
DEFSETFL EQU   DEFFLAGB                                                 06822000
DEFCRCVY EQU   DEFSETFL                                                 06823000
DEFRECFL EQU   DEFFLAGB+1                                               06824000
DEFLAMIS EQU   DEFRECFL                                                 06825000
DEFTYPFL EQU   DEFFLAGB+2                                               06826000
DEFDUP   EQU   DEFTYPFL                                                 06827000
DEFNULFL EQU   DEFFLAGB+3                                               06828000
MCRTE    EQU   0                                                        06829000
MCRLNGTH EQU   MCRTE                                                    06830000
MCRLOC   EQU   MCRTE+4                                                  06831000
MCRFLAGA EQU   MCRTE+34                                                 06832000
MCRSPLOC EQU   MCRFLAGA                                                 06833000
MCRFLAGB EQU   MCRTE+36                                                 06834000
MCRTYPE  EQU   MCRFLAGB+2                                               06835000
MCRREC   EQU   MCRTYPE                                                  06836000
MCLIST   EQU   0                                                        06837000
MCRTFLG  EQU   MCLIST+6                                                 06838000
MCRTTRAN EQU   MCRTFLG                                                  06839000
MCRTLIB  EQU   MCLIST+7                                                 06840000
MCRTCSN  EQU   MCLIST+24                                                06841000
MCRTVEXT EQU   MCLIST+44                                                06842000
AMSTP041 EQU   0                                                        06843000
AMSTP042 EQU   0                                                        06844000
AMSTP043 EQU   0                                                        06845000
AMSTP044 EQU   0                                                        06846000
IDCIOCO0 EQU   0                                                        06847000
IDCIOGT0 EQU   0                                                        06848000
IDCIOIT0 EQU   0                                                        06849000
IDCIOOP0 EQU   0                                                        06850000
IDCIOPO0 EQU   0                                                        06851000
IDCIOPT0 EQU   0                                                        06852000
IDCIOSI0 EQU   0                                                        06853000
IDCIOST0 EQU   0                                                        06854000
IDCIOTM0 EQU   0                                                        06855000
IDCIOVY0 EQU   0                                                        06856000
IDCIO050 EQU   0                                                        06857000
IDCSACA0 EQU   0                                                        06858000
IDCSACR0 EQU   0                                                        06859000
IDCSADE0 EQU   0                                                        06860000
IDCSAFP0 EQU   0                                                        06861000
IDCSAGP0 EQU   0                                                        06862000
IDCSAGS0 EQU   0                                                        06863000
IDCSAID0 EQU   0                                                        06864000
IDCSALC0 EQU   0                                                        06865000
IDCSALD0 EQU   0                                                        06866000
IDCSALK0 EQU   0                                                        06867000
IDCSAPR0 EQU   0                                                        06868000
IDCSAPT0 EQU   0                                                        06869000
IDCSAQL0 EQU   0                                                        06870000
IDCSARC0 EQU   0                                                        06871000
IDCSARV0 EQU   0                                                        06872000
IDCSASC0 EQU   0                                                        06873000
IDCSASN0 EQU   0                                                        06874000
IDCSAST0 EQU   0                                                        06875000
IDCSATI0 EQU   0                                                        06876000
IDCSAUC0 EQU   0                                                        06877000
IDCST010 EQU   0                                                        06878000
IDCTPER0 EQU   0                                                        06879000
LISTTEST EQU   0                                                        06880000
NEJEC    EQU   0                                                        06881000
NEWERID1 EQU   5                                                        06882000
GDTTBL   EQU   0                                                        06883000
GDTTR1   EQU   GDTTBL+8                                                 06884000
GDTTR2   EQU   GDTTBL+12                                                06885000
GDTDBG   EQU   GDTTBL+40                                                06886000
GDTSTC   EQU   GDTTBL+44                                                06887000
GDTPRT   EQU   GDTTBL+48                                                06888000
GDTESS   EQU   GDTTBL+52                                                06889000
GDTESA   EQU   GDTTBL+56                                                06890000
GDTRST   EQU   GDTTBL+60                                                06891000
GDTRES   EQU   GDTTBL+64                                                06892000
GDTCAL   EQU   GDTTBL+68                                                06893000
GDTGSP   EQU   GDTTBL+72                                                06894000
GDTFSP   EQU   GDTTBL+76                                                06895000
GDTGPL   EQU   GDTTBL+80                                                06896000
GDTFPL   EQU   GDTTBL+84                                                06897000
GDTLOD   EQU   GDTTBL+88                                                06898000
GDTDEL   EQU   GDTTBL+92                                                06899000
GDTPRL   EQU   GDTTBL+96                                                06900000
GDTEPL   EQU   GDTTBL+100                                               06901000
GDTTIM   EQU   GDTTBL+104                                               06902000
GDTIIO   EQU   GDTTBL+108                                               06903000
GDTTIO   EQU   GDTTBL+112                                               06904000
GDTOPN   EQU   GDTTBL+124                                               06905000
GDTCLS   EQU   GDTTBL+128                                               06906000
GDTGET   EQU   GDTTBL+132                                               06907000
GDTPUT   EQU   GDTTBL+136                                               06908000
GDTPOS   EQU   GDTTBL+140                                               06909000
GDTCPY   EQU   GDTTBL+144                                               06910000
GDTCAT   EQU   GDTTBL+148                                               06911000
GDTSNP   EQU   GDTTBL+164                                               06912000
GDTVFY   EQU   GDTTBL+172                                               06913000
GDTUID   EQU   GDTTBL+192                                               06914000
GDTPMT   EQU   GDTTBL+196                                               06915000
GDTCIR   EQU   GDTTBL+200                                               06916000
GDTLNK   EQU   GDTTBL+204                                               06917000
GDTALC   EQU   GDTTBL+208                                               06918000
GDTDLC   EQU   GDTTBL+212                                               06919000
GDTQAL   EQU   GDTTBL+216                                               06920000
GDTSTW   EQU   GDTTBL+220                                               06921000
GDTSSC   EQU   GDTTBL+224                                               06922000
GDTENQ   EQU   GDTTBL+228                                               06923000
GDTRSV   EQU   GDTTBL+232                                               06924000
GDTDEQ   EQU   GDTTBL+236                                               06925000
GDTSFO   EQU   GDTTBL+240                                               06926000
GDTWTO   EQU   GDTTBL+244                                               06927000
GDTSCR   EQU   GDTTBL+248                                               06928000
GDTUNT   EQU   GDTTBL+252                                               06929000
GDTRCT   EQU   GDTTBL+256                                               06930000
GDTIFO   EQU   GDTTBL+260                                               06931000
GDTEXP   EQU   GDTTBL+264                                               06932000
GDTSTA   EQU   GDTTBL+268                                               06933000
GDTERR   EQU   GDTTBL+272                                               06934000
GDTUNC   EQU   GDTTBL+276                                               06935000
GDTLOC   EQU   GDTTBL+280                                               06936000
FDTTBL   EQU   0                                                        06937000
FDTPTR   EQU   FDTTBL+8                                                 06938000
LASTCOND EQU   0                                                        06939000
VECSN1   EQU   0                                                        06940000
VEVOLUME EQU   0                                                        06941000
VEVVIERR EQU   0                                                        06942000
VERECFLG EQU   0                                                        06943000
VEVOLLOC EQU   0                                                        06944000
SSRCODE  EQU   0                                                        06945000
SSRHALF  EQU   SSRCODE+2                                                06946000
SSECBCD  EQU   0                                                        06947000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    06948000
@NM00129 EQU   SSRCODE                                                  06949000
FDTVERB  EQU   FDTTBL                                                   06950000
GDTECT   EQU   GDTTBL+188                                               06951000
GDTPSB   EQU   GDTTBL+184                                               06952000
GDTUPT   EQU   GDTTBL+180                                               06953000
GDTCMB   EQU   GDTTBL+176                                               06954000
GDTSPR   EQU   GDTTBL+168                                               06955000
@NM00001 EQU   GDTTBL+160                                               06956000
GDTABH   EQU   GDTTBL+156                                               06957000
GDTABT   EQU   GDTTBL+152                                               06958000
GDTTOH   EQU   GDTTBL+120                                               06959000
GDTRIP   EQU   GDTTBL+116                                               06960000
GDTIOH   EQU   GDTTBL+36                                                06961000
GDTSAH   EQU   GDTTBL+32                                                06962000
GDTTPH   EQU   GDTTBL+28                                                06963000
GDTRIH   EQU   GDTTBL+24                                                06964000
GDTSTH   EQU   GDTTBL+20                                                06965000
GDTDBH   EQU   GDTTBL+16                                                06966000
GDTPRM   EQU   GDTTBL+4                                                 06967000
GDTHDR   EQU   GDTTBL                                                   06968000
MCRTECB  EQU   MCLIST+40                                                06969000
MCRTASID EQU   MCLIST+38                                                06970000
MCRTRES4 EQU   MCLIST+36                                                06971000
MCRTRES3 EQU   MCLIST+16                                                06972000
MCRTRES2 EQU   MCLIST+8                                                 06973000
MCRTLD   EQU   MCRTLIB                                                  06974000
@NM00125 EQU   MCRTLIB                                                  06975000
@NM00124 EQU   MCRTFLG                                                  06976000
MCRTSCT  EQU   MCRTFLG                                                  06977000
@NM00123 EQU   MCRTFLG                                                  06978000
MCRTRES1 EQU   MCLIST+5                                                 06979000
MCRTOPCD EQU   MCLIST+4                                                 06980000
MCRTLEN  EQU   MCLIST                                                   06981000
@NM00122 EQU   MCRTE+40                                                 06982000
@NM00121 EQU   MCRFLAGB+3                                               06983000
@NM00120 EQU   MCRTYPE                                                  06984000
@NM00119 EQU   MCRFLAGB+1                                               06985000
@NM00118 EQU   MCRFLAGB                                                 06986000
MCRBLNK1 EQU   MCRTE+35                                                 06987000
@NM00117 EQU   MCRFLAGA                                                 06988000
@NM00112 EQU   DEFVE+60                                                 06989000
@NM00111 EQU   DEFNULFL                                                 06990000
DEFNEXPD EQU   DEFNULFL                                                 06991000
DEFNDESC EQU   DEFNULFL                                                 06992000
DEFNGRP  EQU   DEFNULFL                                                 06993000
@NM00110 EQU   DEFTYPFL                                                 06994000
DEFCOPY  EQU   DEFTYPFL                                                 06995000
DEFRSTD  EQU   DEFTYPFL                                                 06996000
DEFGENUS EQU   DEFTYPFL                                                 06997000
@NM00109 EQU   DEFRECFL                                                 06998000
DEFCREAT EQU   DEFRECFL                                                 06999000
DEFICOPY EQU   DEFRECFL                                                 07000000
@NM00108 EQU   DEFSETFL                                                 07001000
DEFSRCVY EQU   DEFSETFL                                                 07002000
@NM00107 EQU   DEFFLAGA                                                 07003000
DEFPBKUP EQU   DEFFLAGA                                                 07004000
DEFPTO   EQU   DEFFLAGA                                                 07005000
DEFPDESC EQU   DEFFLAGA                                                 07006000
DEFPGRO  EQU   DEFFLAGA                                                 07007000
DEFPFOR  EQU   DEFFLAGA                                                 07008000
DEFBKUPN EQU   DEFVE+48                                                 07009000
DEFFOR   EQU   DEFVE+46                                                 07010000
DEFTO    EQU   DEFVE+42                                                 07011000
DEFDESCR EQU   DEFVE+12                                                 07012000
DEFGROUP EQU   DEFVE+4                                                  07013000
DEFTLAB  EQU   DEFVDATA+71                                              07014000
DEFR60   EQU   DEFVDATA+43                                              07015000
DEFOWNID EQU   DEFVDATA+29                                              07016000
DEFR55   EQU   DEFVDATA+3                                               07017000
DEFACSEC EQU   DEFVDATA+2                                               07018000
DEFR50   EQU   DEFVDATA                                                 07019000
DEFVECB  EQU   DEFLIST+52                                               07020000
DEFVASID EQU   DEFLIST+50                                               07021000
@NM00106 EQU   DEFLIST+48                                               07022000
DEFVCSN2 EQU   DEFLIST+36                                               07023000
DEFVCSN1 EQU   DEFLIST+24                                               07024000
@NM00105 EQU   DEFLIST+22                                               07025000
@NM00104 EQU   DEFLIST+15                                               07026000
@NM00103 EQU   DEFVVFLG                                                 07027000
DEFVWINH EQU   DEFVVFLG                                                 07028000
DEFVBIND EQU   DEFVVFLG                                                 07029000
@NM00102 EQU   DEFVVFLG                                                 07030000
DEFVEXCL EQU   DEFVVFLG                                                 07031000
DEFVSEC  EQU   DEFVVFLG                                                 07032000
@NM00101 EQU   DEFVVFLG                                                 07033000
DEFVCECT EQU   DEFVVFLG                                                 07034000
DEFVLID  EQU   DEFVLIB                                                  07035000
@NM00100 EQU   DEFVLIB                                                  07036000
DEFVACT  EQU   DEFVFLG                                                  07037000
DEFVRNTR EQU   DEFVFLG                                                  07038000
DEFVELTR EQU   DEFVFLG                                                  07039000
DEFVREP  EQU   DEFVFLG                                                  07040000
DEFVELM  EQU   DEFVFLG                                                  07041000
DEFVCR   EQU   DEFVFLG                                                  07042000
@NM00099 EQU   DEFLIST+5                                                07043000
DEFVOPCD EQU   DEFLIST+4                                                07044000
DEFVLEN  EQU   DEFLIST                                                  07045000
@NM00098 EQU   MVR+82                                                   07046000
MVRBLNK1 EQU   MVR+75                                                   07047000
MVRBKUPN EQU   MVR+74                                                   07048000
MVRCSN   EQU   MVR+62                                                   07049000
MVRTO    EQU   MVR+58                                                   07050000
MVRDES   EQU   MVR+28                                                   07051000
MVRGROUP EQU   MVR+20                                                   07052000
MVRFOR   EQU   MVR+18                                                   07053000
@NM00097 EQU   MVRFLAGA+2                                               07054000
MVRCICPY EQU   MVRFLAGA+2                                               07055000
MVRCIVCF EQU   MVRFLAGA+2                                               07056000
MVRNEXPD EQU   MVRFLAGA+1                                               07057000
MVRNDESC EQU   MVRFLAGA+1                                               07058000
MVRBKUP  EQU   MVRFLAGA+1                                               07059000
MVRNGRP  EQU   MVRFLAGA+1                                               07060000
MVRRSTD  EQU   MVRFLAGA+1                                               07061000
MVRGEN   EQU   MVRFLAGA+1                                               07062000
MVRFLBK  EQU   MVRFLAGA                                                 07063000
MVRFLCSN EQU   MVRFLAGA                                                 07064000
MVRFLTO  EQU   MVRFLAGA                                                 07065000
MVRFLDES EQU   MVRFLAGA                                                 07066000
MVRFLGRO EQU   MVRFLAGA                                                 07067000
MVRFLFOR EQU   MVRFLAGA                                                 07068000
@NM00096 EQU   MVRCODE+1                                                07069000
MVROPCD  EQU   MVRCODE                                                  07070000
@NM00095 EQU   RVVI+64                                                  07071000
RVVSDUP  EQU   RVVSPEC                                                  07072000
RVVSCPY  EQU   RVVSPEC                                                  07073000
RVVSCSN  EQU   RVVSPEC                                                  07074000
RVVSSEQ  EQU   RVVSPEC                                                  07075000
RVVSDTE  EQU   RVVSPEC                                                  07076000
RVVSEXP  EQU   RVVSPEC                                                  07077000
RVVSGRP  EQU   RVVSPEC                                                  07078000
@NM00094 EQU   RVVCPYTP                                                 07079000
RVVLCOPY EQU   RVVCPYTP                                                 07080000
RVVOBKUP EQU   RVVCPYTP                                                 07081000
RVVLBKUP EQU   RVVCPYTP                                                 07082000
@NM00093 EQU   RVVRTEST                                                 07083000
RVVDVOL  EQU   RVVRTEST                                                 07084000
RVVACTV  EQU   RVVRTEST                                                 07085000
RVVINACT EQU   RVVRTEST                                                 07086000
RVVRSTD  EQU   RVVRTEST                                                 07087000
RVVGSVOL EQU   RVVRTEST                                                 07088000
RVVTHOLD EQU   RVVRTEST                                                 07089000
RVVEXPDT EQU   RVVRTEST                                                 07090000
@NM00092 EQU   RVVRDRCD                                                 07091000
RVVCPURC EQU   RVVRDRCD                                                 07092000
RVVCIRCD EQU   RVVRDRCD                                                 07093000
RVVRUNKN EQU   RVVRDRCD                                                 07094000
RVVDUPRC EQU   RVVRDRCD                                                 07095000
RVVCPYRC EQU   RVVRDRCD                                                 07096000
RVVGRPRC EQU   RVVRDRCD                                                 07097000
@NM00091 EQU   RVVCHAIN                                                 07098000
RVVNGVOL EQU   RVVCHAIN                                                 07099000
RVVGPVOL EQU   RVVCHAIN                                                 07100000
@NM00090 EQU   RVVRMODE                                                 07101000
RVVRDCH  EQU   RVVRMODE                                                 07102000
RVVRDNR  EQU   RVVRMODE                                                 07103000
RVVDUPID EQU   RVVI+57                                                  07104000
RVVCPYID EQU   RVVI+56                                                  07105000
RVVRDCSN EQU   RVVI+44                                                  07106000
RVVRDSEQ EQU   RVVI+43                                                  07107000
RVVBLNK1 EQU   RVVI+42                                                  07108000
RVVCDATE EQU   RVVI+38                                                  07109000
RVVEXPIR EQU   RVVI+36                                                  07110000
@NM00089 EQU   RVVI+28                                                  07111000
RVVAREA  EQU   RVVI+24                                                  07112000
RVVARLN  EQU   RVVI+22                                                  07113000
RVVGROUP EQU   RVVI+14                                                  07114000
@NM00088 EQU   RVVOPCOD+1                                               07115000
@NM00087 EQU   BASEV+188                                                07116000
BASGROUP EQU   BASEV+180                                                07117000
BASDEST  EQU   BASEV+144                                                07118000
BASOWNER EQU   BASEV+134                                                07119000
BASDESCR EQU   BASEV+104                                                07120000
BASDTREM EQU   BASEV+100                                                07121000
BASEXPDT EQU   BASEV+96                                                 07122000
BASDLMTD EQU   BASEV+92                                                 07123000
BASRES6  EQU   BASEV+89                                                 07124000
BASCOPNO EQU   BASCOPID+1                                               07125000
BASCOPBK EQU   BASCOPID                                                 07126000
BASCOPSN EQU   BASKLCPY+5                                               07127000
BASCOPV  EQU   BASKLCPY                                                 07128000
BASFREXT EQU   BASEV+72                                                 07129000
BASLEXT  EQU   BASEV+70                                                 07130000
BASFRESP EQU   BASEV+68                                                 07131000
@NM00086 EQU   BASEV+65                                                 07132000
BASBKLMT EQU   BASEV+64                                                 07133000
BASNBKUP EQU   BASEV+63                                                 07134000
BASNEXTV EQU   BASEV+56                                                 07135000
BASPREV  EQU   BASEV+50                                                 07136000
BAS2BIT2 EQU   BASLID2                                                  07137000
BAS2BIT1 EQU   BASLID2                                                  07138000
BASRES5  EQU   BASLIB2                                                  07139000
BASCSN2  EQU   BASEV+37                                                 07140000
BAS1BIT2 EQU   BASLID1                                                  07141000
BAS1BIT1 EQU   BASLID1                                                  07142000
BASRES4  EQU   BASLIB1                                                  07143000
BASCSN1  EQU   BASEV+24                                                 07144000
BASRES3  EQU   BASMISCF                                                 07145000
BASHOLD  EQU   BASMISCF                                                 07146000
BASRES8  EQU   BASSATIA                                                 07147000
BASCPUID EQU   BASEV+18                                                 07148000
@NM00085 EQU   BASFLAGA+3                                               07149000
BASLAST  EQU   BASFLAGA+3                                               07150000
BASFIRST EQU   BASFLAGA+3                                               07151000
BASREASS EQU   BASFLAGA+3                                               07152000
BASDAERA EQU   BASFLAGA+3                                               07153000
BASEXCL  EQU   BASFLAGA+2                                               07154000
BASBIND  EQU   BASFLAGA+2                                               07155000
BASRSTD  EQU   BASFLAGA+2                                               07156000
BASGENUS EQU   BASFLAGA+2                                               07157000
BASGRPV  EQU   BASFLAGA+2                                               07158000
BASNOCPY EQU   BASFLAGA+2                                               07159000
BASDLSF  EQU   BASFLAGA+2                                               07160000
BASRES2  EQU   BASTYPE                                                  07161000
BASBASVR EQU   BASTYPE                                                  07162000
BASRES1  EQU   BASTYPE                                                  07163000
BASRES7  EQU   BASEV+13                                                 07164000
BASZERO  EQU   BASID+1                                                  07165000
BASBLANK EQU   BASID                                                    07166000
BASSERNO EQU   BASNAME+5                                                07167000
BASEVKEY EQU   BASNAME                                                  07168000
PFILEVAL EQU   @NM00084+1                                               07169000
PFILELEN EQU   @NM00084                                                 07170000
PFILECNT EQU   PFILE                                                    07171000
FILELEN  EQU   FILE                                                     07172000
CATDNLEN EQU   CATDN                                                    07173000
CATNMLEN EQU   CATNM+20                                                 07174000
CATNMMEM EQU   CATNM+12                                                 07175000
CATNMMLN EQU   CATNM+11                                                 07176000
CATNMFUQ EQU   CATNMFLG                                                 07177000
CATNMPOS EQU   CATNM+9                                                  07178000
LOCLEN   EQU   LOC                                                      07179000
NSERLEN  EQU   NSER                                                     07180000
VSDDSN   EQU   VSDARRAY+4                                               07181000
VSDVOLCT EQU   VSDARRAY                                                 07182000
VSDFMT0  EQU   VSDBLOCK+8                                               07183000
VSDVTOCS EQU   VSDBLOCK+4                                               07184000
VSDELEM  EQU   VSDBLOCK                                                 07185000
VSDFREE  EQU   VSDUSAGE+24                                              07186000
VSDALLC  EQU   VSDUSAGE+19                                              07187000
VSDDSOR3 EQU   VSDDSORG+2                                               07188000
@NM00083 EQU   VSDDSORG                                                 07189000
VSDSCAL  EQU   VSDUSAGE+12                                              07190000
@NM00082 EQU   VSDUSEF                                                  07191000
VSDCALFR EQU   VSDUSEF                                                  07192000
@NM00081 EQU   VSDALLOC                                                 07193000
VSDABSTR EQU   VSDALLOC                                                 07194000
VSDABLK  EQU   VSDALLOC                                                 07195000
VSDATRK  EQU   VSDALLOC                                                 07196000
VSDACYL  EQU   VSDALLOC                                                 07197000
@NM00080 EQU   VSDDORG                                                  07198000
VSDOU    EQU   VSDDORG                                                  07199000
VSDOIS   EQU   VSDDORG                                                  07200000
VSDODA   EQU   VSDDORG                                                  07201000
VSDOUN   EQU   VSDDORG                                                  07202000
VSDOPS   EQU   VSDDORG                                                  07203000
VSDOPO   EQU   VSDDORG                                                  07204000
VSDEXTS  EQU   VSDUSAGE+8                                               07205000
VSDSECAL EQU   VSDUSAGE+4                                               07206000
VSDFTRK  EQU   VSDUSAGE+2                                               07207000
VSDTRKS  EQU   VSDUSAGE                                                 07208000
@NM00079 EQU   VSDSCR+5                                                 07209000
@NM00078 EQU   VSDSCRFL                                                 07210000
VSDVSAM  EQU   VSDSCRFL                                                 07211000
VSDCATLC EQU   VSDSCRFL                                                 07212000
VSDACBPT EQU   VSDSCR                                                   07213000
VSDPRTC  EQU   VSDSTAT+25                                               07214000
VSDCAT   EQU   VSDSTAT+22                                               07215000
VSDEXP   EQU   VSDSTAT+20                                               07216000
VSDCRE   EQU   VSDSTAT+18                                               07217000
@NM00077 EQU   VSDFLG2                                                  07218000
VSDERROR EQU   VSDFLG2                                                  07219000
VSDPROT  EQU   VSDFLG2                                                  07220000
VSDPWW   EQU   VSDFLG2                                                  07221000
VSDPWR   EQU   VSDFLG2                                                  07222000
@NM00076 EQU   VSDSFLG1                                                 07223000
VSDCVSAM EQU   VSDSFLG1                                                 07224000
VSDCATLG EQU   VSDSFLG1                                                 07225000
VSDVSAME EQU   VSDSFLG1                                                 07226000
VSDVSAMC EQU   VSDSFLG1                                                 07227000
VSDVTOCE EQU   VSDSFLG1                                                 07228000
VSDVTOCC EQU   VSDSFLG1                                                 07229000
VSDOWNER EQU   VSDSTAT+8                                                07230000
VSDEXPIR EQU   VSDSTAT+4                                                07231000
VSDCREAT EQU   VSDSTAT                                                  07232000
VSDFRCCL EQU   VSDVTOC+21                                               07233000
@NM00075 EQU   VSDVTOC+20                                               07234000
VSDFREXT EQU   VSDVTOC+16                                               07235000
@NM00074 EQU   VSDVTOC+15                                               07236000
VSDFRTRK EQU   VSDVTOC+11                                               07237000
@NM00073 EQU   VSDVTOC+10                                               07238000
VSDFRCYL EQU   VSDVTOC+6                                                07239000
@NM00072 EQU   VSDVTOC                                                  07240000
@NM00071 EQU   VS3FLAGS                                                 07241000
VS3SYSNM EQU   VS3FLAGS                                                 07242000
VS3UNCAT EQU   VS3FLAGS                                                 07243000
VS3SCR   EQU   VS3FLAGS                                                 07244000
VS3USAGE EQU   VS3FLAGS                                                 07245000
VS3STAT  EQU   VS3FLAGS                                                 07246000
VS3DD    EQU   VS3AGL+50                                                07247000
VS3VOL   EQU   VS3AGL+44                                                07248000
VS3POOL  EQU   VS3AGL+40                                                07249000
VS3DEV   EQU   VS3AGL+36                                                07250000
VS3UCBP  EQU   VS3AGL+32                                                07251000
VS3CREAT EQU   VS3AGL+28                                                07252000
VS3EXPIR EQU   VS3AGL+24                                                07253000
VS3AST   EQU   VS3AGL+22                                                07254000
VS3LEVLN EQU   VS3AGL+20                                                07255000
VS3LEVP  EQU   VS3AGL+16                                                07256000
VS3EXDSP EQU   VS3AGL+12                                                07257000
VS3LISTP EQU   VS3AGL+8                                                 07258000
VS3HEAD  EQU   VS3AGL                                                   07259000
@NM00070 EQU   DATESOPT                                                 07260000
DATDAYOP EQU   DATESOPT                                                 07261000
DATDTEOP EQU   DATESOPT                                                 07262000
DATSUB   EQU   DATESOPT                                                 07263000
DATADD   EQU   DATESOPT                                                 07264000
DATRETRN EQU   DATESAGL+16                                              07265000
DATDAYS  EQU   DATESAGL+12                                              07266000
DATDATE  EQU   DATESAGL+8                                               07267000
DATHEAD  EQU   DATESAGL                                                 07268000
@NM00069 EQU   SELFLAGS                                                 07269000
SELVOL   EQU   SELAGL+16                                                07270000
SELDDNP  EQU   SELAGL+12                                                07271000
SELUCBP  EQU   SELAGL+8                                                 07272000
SELHEAD  EQU   SELAGL                                                   07273000
@NM00068 EQU   UCTFLAGS                                                 07274000
UCTVSCAT EQU   UCTFLAGS                                                 07275000
UCTDD    EQU   UCTAGL+60                                                07276000
UCTVOLP  EQU   UCTAGL+56                                                07277000
UCTACBP  EQU   UCTAGL+52                                                07278000
UCTDSN   EQU   UCTAGL+8                                                 07279000
UCTHEAD  EQU   UCTAGL                                                   07280000
@NM00067 EQU   LCTFLAGS                                                 07281000
LCTVSCAT EQU   LCTFLAGS                                                 07282000
LCTOWNER EQU   LCTINFO+24                                               07283000
LCTEXPIR EQU   LCTINFO+20                                               07284000
LCTCREAT EQU   LCTINFO+16                                               07285000
LCTACBP  EQU   LCTINFO+12                                               07286000
LCTMULVC EQU   LCTINFO+8                                                07287000
LCTHEAD  EQU   LCTINFO                                                  07288000
SRTWORKP EQU   SRTAGL+28                                                07289000
SRTFLDLN EQU   SRTAGL+24                                                07290000
SRTPOSIT EQU   SRTAGL+20                                                07291000
SRTLEN   EQU   SRTAGL+16                                                07292000
SRTNUM   EQU   SRTAGL+12                                                07293000
SRTADDR  EQU   SRTAGL+8                                                 07294000
SRTHEAD  EQU   SRTAGL                                                   07295000
SV82DEBP EQU   SV82WRKP                                                 07296000
SV82TTRP EQU   SV82LIST+8                                               07297000
SV82VOLP EQU   SV82DCBP                                                 07298000
SV82UCBP EQU   SV82LIST+1                                               07299000
SV82CODE EQU   SV82LIST                                                 07300000
VOLRESV3 EQU   VOLLABEL+55                                              07301000
VOLOWNER EQU   VOLLABEL+45                                              07302000
VOLRESV1 EQU   VOLLABEL+20                                              07303000
VOLVTOC  EQU   VOLLABEL+15                                              07304000
VOLSECTY EQU   VOLLABEL+14                                              07305000
VOLSERNO EQU   VOLLABEL+8                                               07306000
VOLNO    EQU   VOLLABEL+7                                               07307000
VOLLABI  EQU   VOLLABEL+4                                               07308000
VOLKEY   EQU   VOLLABEL                                                 07309000
STAVTTR  EQU   STAEPARM+54                                              07310000
@NM00064 EQU   STARETRY                                                 07311000
STAVTOC  EQU   STARETRY                                                 07312000
STAOFF   EQU   STARETRY                                                 07313000
STAIO05  EQU   STARETRY                                                 07314000
@NM00063 EQU   STARCVY                                                  07315000
STACLEAR EQU   STARCVY                                                  07316000
STAVPOST EQU   STARCVY                                                  07317000
STAVENQ  EQU   STARCVY                                                  07318000
STAVDMNT EQU   STARCVY                                                  07319000
STAVMNT  EQU   STARCVY                                                  07320000
STATCB   EQU   STAEPARM+48                                              07321000
STARTADD EQU   STAEPARM+44                                              07322000
STAEXSAV EQU   STAEPARM+40                                              07323000
STARTSAV EQU   STAEPARM+36                                              07324000
STARTTR  EQU   STAEPARM+32                                              07325000
@NM00062 EQU   STAEPARM+30                                              07326000
STARVOL  EQU   STAEPARM+24                                              07327000
STARUCB  EQU   STAEPARM+20                                              07328000
@NM00061 EQU   STAEPARM+18                                              07329000
STAVVOL  EQU   STAEPARM+12                                              07330000
STAVUCB  EQU   STAEPARM+8                                               07331000
STAHEAD  EQU   STAEPARM                                                 07332000
RCTDSET  EQU   RCTAGL+32                                                07333000
RCTNVOL  EQU   RCTAGL+26                                                07334000
RCTOVOL  EQU   RCTAGL+20                                                07335000
RCTNDEV  EQU   RCTAGL+16                                                07336000
RCTODEV  EQU   RCTAGL+12                                                07337000
@NM00060 EQU   RCTAGL+10                                                07338000
@NM00059 EQU   RCTOPT                                                   07339000
RCTVOL   EQU   RCTOPT                                                   07340000
RCTDEV   EQU   RCTOPT                                                   07341000
RCTHEAD  EQU   RCTAGL                                                   07342000
@NM00058 EQU   VSRESOPT                                                 07343000
VSREAL   EQU   VSRESOPT                                                 07344000
@NM00057 EQU   VSMSG                                                    07345000
VSTOV    EQU   VSMSG                                                    07346000
VSFROMV  EQU   VSMSG                                                    07347000
@NM00056 EQU   VSRETURN                                                 07348000
VSVSAM   EQU   VSRETURN                                                 07349000
@NM00055 EQU   VSCATOPT                                                 07350000
VSLIST   EQU   VSCATOPT                                                 07351000
VSSERIAL EQU   VSCATOPT                                                 07352000
VSDEVICE EQU   VSCATOPT                                                 07353000
@NM00054 EQU   VSVTOPT                                                  07354000
VSVSFLAG EQU   VSVTOPT                                                  07355000
VSALTTRK EQU   VSVTOPT                                                  07356000
VSTIME   EQU   VSVTOPT                                                  07357000
VSUCMAST EQU   VSSECOPT                                                 07358000
VSREAD   EQU   VSSECOPT                                                 07359000
VSNONONV EQU   VSSECOPT                                                 07360000
VSODEVP  EQU   VS1AGL+64                                                07361000
VSOSERP  EQU   VS1AGL+60                                                07362000
VSDEVP   EQU   VS1AGL+56                                                07363000
VSSERP   EQU   VS1AGL+52                                                07364000
VSACBP   EQU   VS1AGL+36                                                07365000
VSNXTATP EQU   VS1AGL+28                                                07366000
VSNUMATP EQU   VS1AGL+24                                                07367000
VSHEAD   EQU   VS1AGL                                                   07368000
@NM00053 EQU   VS2RESOP                                                 07369000
VS2REAL  EQU   VS2RESOP                                                 07370000
@NM00052 EQU   VS2MSG                                                   07371000
VS2TOV   EQU   VS2MSG                                                   07372000
@NM00051 EQU   VSLABOPT                                                 07373000
VSOWNER  EQU   VSLABOPT                                                 07374000
VSIOBKPT EQU   VS2AGL+24                                                07375000
VSOWNPTR EQU   VS2AGL+16                                                07376000
VSVTOCSZ EQU   VS2AGL+12                                                07377000
VS2HEAD  EQU   VS2AGL                                                   07378000
EXPDATAL EQU   EXPARRAY+6                                               07379000
@NM00050 EQU   EXPARRAY+5                                               07380000
EXPKEYLN EQU   EXPARRAY+4                                               07381000
EXPDATAP EQU   EXPARRAY                                                 07382000
EXPRECNO EQU   EXPDATAB                                                 07383000
EXPCCHHR EQU   EXPARG+16                                                07384000
EXPCTLBK EQU   EXPARG+8                                                 07385000
EXPHEAD  EQU   EXPARG                                                   07386000
EXGDATAL EQU   EXGARG+30                                                07387000
@NM00049 EQU   EXGARG+29                                                07388000
EXGKEYLN EQU   EXGARG+28                                                07389000
EXGDATAP EQU   EXGARG+24                                                07390000
EXGRECNO EQU   EXGARG+20                                                07391000
EXGCCHH2 EQU   EXGARG+16                                                07392000
EXGCCHH1 EQU   EXGARG+12                                                07393000
EXGCTLBK EQU   EXGARG+8                                                 07394000
EXGHEAD  EQU   EXGARG                                                   07395000
@NM00048 EQU   EXFLG                                                    07396000
EXOREAD  EQU   EXFLG                                                    07397000
@NM00047 EQU   EXOPT                                                    07398000
EXOVTOC  EQU   EXOPT                                                    07399000
EXONEW   EQU   EXOPT                                                    07400000
EXOPASS  EQU   EXOPT                                                    07401000
EXOLAB   EQU   EXOPT                                                    07402000
EXOTAB   EQU   EXOPT                                                    07403000
EXOCTLBK EQU   EXOARG+28                                                07404000
EXOEXT   EQU   EXOARG+24                                                07405000
EXOUCB   EQU   EXOARG+20                                                07406000
EXOVSN   EQU   EXOARG+16                                                07407000
EXODSN   EQU   EXOARG+12                                                07408000
EXODDN   EQU   EXOARG+8                                                 07409000
EXOHEAD  EQU   EXOARG                                                   07410000
@NM00046 EQU   EXCLFLAG                                                 07411000
EXCLMNT  EQU   EXCLFLAG                                                 07412000
EXCLHEAD EQU   EXCLAGL                                                  07413000
@NM00045 EQU   CKFLAGS                                                  07414000
CKDMTABL EQU   CKFLAGS                                                  07415000
CKRETTYP EQU   CKFLAGS                                                  07416000
CKLABELP EQU   CKAGL+24                                                 07417000
CKDATYPE EQU   CKAGL+20                                                 07418000
CKHEAD   EQU   CKAGL                                                    07419000
PULABELP EQU   PUAGL+16                                                 07420000
PUTTRPTR EQU   PUAGL+12                                                 07421000
PUUCBPTR EQU   PUAGL+8                                                  07422000
PUHEAD   EQU   PUAGL                                                    07423000
@NM00044 EQU   MDFLAGS                                                  07424000
MDDEQ    EQU   MDFLAGS                                                  07425000
MDENQ    EQU   MDFLAGS                                                  07426000
MDPOST   EQU   MDFLAGS                                                  07427000
MDCLEAR  EQU   MDFLAGS                                                  07428000
MDNEWVOL EQU   MDFLAGS                                                  07429000
MDPUAGL  EQU   MDAGL+20                                                 07430000
MDHEAD   EQU   MDAGL                                                    07431000
CTTBLRR  EQU   CTARRAY+3                                                07432000
CTTBLHH  EQU   CTARRAY+2                                                07433000
CTTBLCC  EQU   CTARRAY+1                                                07434000
CTTBLID  EQU   CTARRAY                                                  07435000
CTREALH  EQU   CTMSG+3                                                  07436000
CTREALCC EQU   CTMSG+1                                                  07437000
@NM00043 EQU   CTMSG                                                    07438000
@NM00042 EQU   CMMSG+14                                                 07439000
@NM00041 EQU   CMMSG+7                                                  07440000
@NM00040 EQU   CMVOLFLG                                                 07441000
CMRONLY  EQU   CMVOLFLG                                                 07442000
CMBIND   EQU   CMVOLFLG                                                 07443000
CMSCRCRT EQU   CMVOLFLG                                                 07444000
CMEXCL   EQU   CMVOLFLG                                                 07445000
CMDERAS  EQU   CMVOLFLG                                                 07446000
CMSCRVOL EQU   CMVOLFLG                                                 07447000
CMCECART EQU   CMVOLFLG                                                 07448000
CMOLDVOL EQU   CMMSG                                                    07449000
CCOLDCSN EQU   CCMSG+24                                                 07450000
CCNEWCSN EQU   CCMSG+12                                                 07451000
@NM00039 EQU   CCMSG+10                                                 07452000
CCVOL    EQU   CCMSG+4                                                  07453000
@NM00038 EQU   CCMSG+2                                                  07454000
CCEJCODE EQU   CCMSG+1                                                  07455000
CCPSTCDE EQU   CCMSG                                                    07456000
@NM00037 EQU   DMPARY+15                                                07457000
DMPARYTP EQU   DMPARY+14                                                07458000
DMPARYEX EQU   DMPARY+12                                                07459000
DMPARYIC EQU   DMPARY+10                                                07460000
DMPARYSZ EQU   DMPARY+8                                                 07461000
DMPARYNM EQU   DMPARY                                                   07462000
@NM00036 EQU   DMPITM+15                                                07463000
@NM00035 EQU   ERCNVTAB+24                                              07464000
ERCPLPT  EQU   ERCNVTAB+20                                              07465000
ERCATRC  EQU   ERCNVTAB+16                                              07466000
ERDSNM   EQU   ERCNVTAB+12                                              07467000
@NM00034 EQU   ERCNVTAB+4                                               07468000
@NM00033 EQU   ERCNVTAB+3                                               07469000
@NM00032 EQU   EROSOPER                                                 07470000
EROSUCDX EQU   EROSOPER                                                 07471000
EROSCATL EQU   EROSOPER                                                 07472000
@NM00031 EQU   EROPER                                                   07473000
ERCATAL  EQU   EROPER                                                   07474000
ERCATDL  EQU   EROPER                                                   07475000
ERCATDE  EQU   EROPER                                                   07476000
ERCATLC  EQU   EROPER                                                   07477000
@NM00030 EQU   ERTYPE                                                   07478000
EROSCAT  EQU   ERTYPE                                                   07479000
ERCATLG  EQU   ERTYPE                                                   07480000
@NM00029 EQU   FMTCNVF+1                                                07481000
FMTBS    EQU   FMTCNVF+1                                                07482000
FMTSS    EQU   FMTCNVF+1                                                07483000
FMTAL    EQU   FMTCNVF+1                                                07484000
FMTZS    EQU   FMTCNVF+1                                                07485000
@NM00028 EQU   FMTCNVF                                                  07486000
FMTPU    EQU   FMTCNVF                                                  07487000
FMTBD    EQU   FMTCNVF                                                  07488000
FMTBHD   EQU   FMTCNVF                                                  07489000
FMTBHA   EQU   FMTCNVF                                                  07490000
FMTBH    EQU   FMTCNVF                                                  07491000
FMTOLEN  EQU   FMTLIST+8                                                07492000
FMTRIO   EQU   FMTOCOL                                                  07493000
FMTSPT   EQU   FMTSTO                                                   07494000
FMTSTL   EQU   FMTILEN                                                  07495000
@NM00027 EQU   FMTFLGS+1                                                07496000
FMTHDF   EQU   FMTFLGS                                                  07497000
FMTDFF   EQU   FMTFLGS                                                  07498000
FMTSTF   EQU   FMTFLGS                                                  07499000
FMTREPF  EQU   FMTFLGS                                                  07500000
FMTBDF   EQU   FMTFLGS                                                  07501000
FMTIDF   EQU   FMTFLGS                                                  07502000
FMTSCF   EQU   FMTFLGS                                                  07503000
FMTEOLF  EQU   FMTFLGS                                                  07504000
DARGPCT  EQU   DARGINL                                                  07505000
DARGREP  EQU   DARGINS                                                  07506000
@NM00026 EQU   DARGLIST+19                                              07507000
DARGIND  EQU   DARGLIST+18                                              07508000
UVOLVOL  EQU   UVOLENT+4                                                07509000
UVOLDEV  EQU   UVOLENT                                                  07510000
UVOLCNT  EQU   UVOLLIST                                                 07511000
@NM00025 EQU   IOINFOPT                                                 07512000
IOINFTMS EQU   IOINFOPT                                                 07513000
IOINFSUP EQU   IOINFOPT                                                 07514000
IOINFDSN EQU   IOINFOPT                                                 07515000
IOINFVOL EQU   IOINFOPT                                                 07516000
IOINFDVT EQU   IOINFOPT                                                 07517000
OPNVOL   EQU   OPNAGL+44                                                07518000
@NM00024 EQU   OPNAGL+43                                                07519000
@NM00023 EQU   OPNOPT2                                                  07520000
OPNOPTJM EQU   OPNOPT2                                                  07521000
@NM00022 EQU   OPNOPT2                                                  07522000
OPNOPTAS EQU   OPNOPT2                                                  07523000
@NM00021 EQU   OPNDSO                                                   07524000
OPNDSOPO EQU   OPNDSO                                                   07525000
OPNDSOIS EQU   OPNDSO                                                   07526000
OPNDSOPS EQU   OPNDSO                                                   07527000
OPNDSOAM EQU   OPNDSO                                                   07528000
OPNKYL   EQU   OPNAGL+40                                                07529000
OPNBLK   EQU   OPNAGL+36                                                07530000
OPNREC   EQU   OPNAGL+32                                                07531000
OPNDEVIX EQU   OPNDEV+4                                                 07532000
OPNDEVDT EQU   OPNDEV                                                   07533000
OPNCBP   EQU   OPNAGL+20                                                07534000
OPNDSN   EQU   OPNAGL+16                                                07535000
OPNPWA   EQU   OPNAGL+12                                                07536000
OPNDDN   EQU   OPNAGL+8                                                 07537000
OPNIOC   EQU   OPNAGL+4                                                 07538000
OPNMODRP EQU   OPNMOD                                                   07539000
OPNMODUB EQU   OPNMOD                                                   07540000
OPNMODRS EQU   OPNMOD                                                   07541000
OPNMODAX EQU   OPNMOD                                                   07542000
OPNMODRR EQU   OPNMOD                                                   07543000
OPNMODRC EQU   OPNMOD                                                   07544000
OPNMODAC EQU   OPNMOD                                                   07545000
OPNMODPD EQU   OPNMOD                                                   07546000
@NM00020 EQU   OPNTYP                                                   07547000
OPNTYPRV EQU   OPNTYP                                                   07548000
OPNTYPEX EQU   OPNTYP                                                   07549000
OPNTYPRA EQU   OPNTYP                                                   07550000
OPNTYPXM EQU   OPNTYP                                                   07551000
OPNTYPCI EQU   OPNTYP                                                   07552000
OPNTYPSO EQU   OPNTYP                                                   07553000
OPNTYPSI EQU   OPNTYP                                                   07554000
@NM00019 EQU   OPNRFM                                                   07555000
OPNRFMBK EQU   OPNRFM                                                   07556000
OPNRFMSF EQU   OPNRFM                                                   07557000
OPNRFMUN EQU   OPNRFM                                                   07558000
OPNRFMVR EQU   OPNRFM                                                   07559000
OPNRFMFX EQU   OPNRFM                                                   07560000
OPNOPTSK EQU   OPNOPT                                                   07561000
OPNOPTDR EQU   OPNOPT                                                   07562000
OPNOPTCR EQU   OPNOPT                                                   07563000
OPNOPTKS EQU   OPNOPT                                                   07564000
OPNOPTBK EQU   OPNOPT                                                   07565000
OPNOPTUP EQU   OPNOPT                                                   07566000
OPNOPTOT EQU   OPNOPT                                                   07567000
OPNOPTIN EQU   OPNOPT                                                   07568000
IOCEXT   EQU   IOCSTR+64                                                07569000
IOCREL   EQU   IOCSTR+60                                                07570000
IOCWORK  EQU   IOCSTR+56                                                07571000
IOCRRN   EQU   IOCSTR+52                                                07572000
IOCPNM   EQU   IOCNWM+2                                                 07573000
IOCPTL   EQU   IOCNWM                                                   07574000
IOCKYA   EQU   IOCMEM                                                   07575000
IOCVRC   EQU   IOCTTR                                                   07576000
IOCCBP   EQU   IOCSTR+36                                                07577000
IOCDSN   EQU   IOCSTR+32                                                07578000
IOCHURBA EQU   IOCSTR+28                                                07579000
IOCVOLSR EQU   IOCSTR+22                                                07580000
@NM00018 EQU   IOCMSG                                                   07581000
IOCMSGAE EQU   IOCMSG                                                   07582000
IOCMSGCE EQU   IOCMSG                                                   07583000
IOCMSGOE EQU   IOCMSG                                                   07584000
IOCMSGOP EQU   IOCMSG                                                   07585000
@NM00017 EQU   IOCMSG                                                   07586000
IOCCHPSY EQU   IOCCHP                                                   07587000
IOCCHPAS EQU   IOCCHP                                                   07588000
IOCCHPBK EQU   IOCCHP                                                   07589000
IOCCHPCR EQU   IOCCHP                                                   07590000
IOCCHPKS EQU   IOCCHP                                                   07591000
IOCCHPSK EQU   IOCCHP                                                   07592000
IOCCHPDR EQU   IOCCHP                                                   07593000
IOCCHPSQ EQU   IOCCHP                                                   07594000
@NM00016 EQU   IOCMAC2                                                  07595000
IOCMACPA EQU   IOCMAC2                                                  07596000
@NM00015 EQU   IOCMAC2                                                  07597000
IOCMACCP EQU   IOCMAC2                                                  07598000
IOCMACRR EQU   IOCMAC2                                                  07599000
IOCMACAS EQU   IOCMAC2                                                  07600000
IOCMACSK EQU   IOCMAC2                                                  07601000
@NM00014 EQU   IOCMAC                                                   07602000
IOCMACCC EQU   IOCMAC                                                   07603000
IOCMACDR EQU   IOCMAC                                                   07604000
IOCMACBK EQU   IOCMAC                                                   07605000
IOCMACCR EQU   IOCMAC                                                   07606000
IOCMACUP EQU   IOCMAC                                                   07607000
IOCMACOT EQU   IOCMAC                                                   07608000
IOCMACIN EQU   IOCMAC                                                   07609000
@NM00013 EQU   IOCRFM                                                   07610000
IOCRFMBK EQU   IOCRFM                                                   07611000
IOCRFMSF EQU   IOCRFM                                                   07612000
IOCRFMUN EQU   IOCRFM                                                   07613000
IOCRFMVR EQU   IOCRFM                                                   07614000
IOCRFMFX EQU   IOCRFM                                                   07615000
@NM00012 EQU   IOCDSO                                                   07616000
IOCDSOPO EQU   IOCDSO                                                   07617000
IOCDSOIS EQU   IOCDSO                                                   07618000
IOCDSOPS EQU   IOCDSO                                                   07619000
IOCDSOAM EQU   IOCDSO                                                   07620000
IOCRKP   EQU   IOCSTR+13                                                07621000
IOCKYL   EQU   IOCSTR+12                                                07622000
IOCTRN   EQU   IOCSTR+8                                                 07623000
IOCDLN   EQU   IOCSTR+4                                                 07624000
IOCDAD   EQU   IOCSTR                                                   07625000
UNITVTOC EQU   UNITABL+7                                                07626000
@NM00011 EQU   UNITSTAT                                                 07627000
UNITXSHR EQU   UNITSTAT                                                 07628000
UNITISHR EQU   UNITSTAT                                                 07629000
UNITUA   EQU   @NM00010+1                                               07630000
UNITCHA  EQU   @NM00010                                                 07631000
UNITUCB  EQU   UNITABL                                                  07632000
@NM00009 EQU   ALLOPT                                                   07633000
ALLOPTUN EQU   ALLOPT                                                   07634000
ALLOPTDS EQU   ALLOPT                                                   07635000
@NM00008 EQU   ALLORG+1                                                 07636000
ALLORGVS EQU   ALLORG+1                                                 07637000
@NM00007 EQU   ALLORG+1                                                 07638000
ALLORGGS EQU   ALLORG+1                                                 07639000
ALLORGUN EQU   ALLORG                                                   07640000
ALLORGPO EQU   ALLORG                                                   07641000
ALLORGMQ EQU   ALLORG                                                   07642000
ALLORGCQ EQU   ALLORG                                                   07643000
ALLORGCX EQU   ALLORG                                                   07644000
ALLORGDA EQU   ALLORG                                                   07645000
ALLORGPS EQU   ALLORG                                                   07646000
ALLORGIS EQU   ALLORG                                                   07647000
ALLDSPUN EQU   ALLDSP                                                   07648000
ALLDSPCG EQU   ALLDSP                                                   07649000
ALLDSPDE EQU   ALLDSP                                                   07650000
ALLDSPKP EQU   ALLDSP                                                   07651000
@NM00006 EQU   ALLDSP                                                   07652000
ALLSTSOD EQU   ALLSTS                                                   07653000
ALLSTSMD EQU   ALLSTS                                                   07654000
ALLSTSNW EQU   ALLSTS                                                   07655000
ALLSTSSR EQU   ALLSTS                                                   07656000
@NM00005 EQU   ALLSTS                                                   07657000
ALLPWD   EQU   ALLAGL+20                                                07658000
ALLDSN   EQU   ALLAGL                                                   07659000
CIRPID   EQU   CIRAGL+28                                                07660000
CIRPWD   EQU   CIRAGL+24                                                07661000
CIRCAT   EQU   CIRAGL+20                                                07662000
CIRWKP   EQU   CIRAGL+16                                                07663000
CIRTLR   EQU   CIRAGL+12                                                07664000
CIRHDR   EQU   CIRAGL+8                                                 07665000
CIRTLN   EQU   CIRAGL+6                                                 07666000
CIRHLN   EQU   CIRAGL+4                                                 07667000
@NM00004 EQU   CIRAGL+1                                                 07668000
@NM00003 EQU   CIRTYPE                                                  07669000
CIRTYPAQ EQU   CIRTYPE                                                  07670000
CIRTYP1Q EQU   CIRTYPE                                                  07671000
NEWID1   EQU   TRACE1+95                                                07672000
CALLID   EQU   OLDERID1+90                                              07673000
@NM00002 EQU   OLDERID1                                                 07674000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      07675000
@RF00465 EQU   @RC00444                                                 07676000
@RF00520 EQU   @RC00508                                                 07677000
@RC00518 EQU   @RC00508                                                 07678000
@RC00538 EQU   @RC00508                                                 07679000
@RF00846 EQU   @RC00843                                                 07680000
@RF00929 EQU   @RC00925                                                 07681000
@RC01098 EQU   @RC01097                                                 07682000
@RF01409 EQU   @RC01394                                                 07683000
@PB00017 EQU   @EL00001                                                 07684000
@PB00016 EQU   @PB00017                                                 07685000
@PB00015 EQU   @PB00016                                                 07686000
@PB00014 EQU   @PB00015                                                 07687000
@PB00013 EQU   @PB00014                                                 07688000
@PB00012 EQU   @PB00013                                                 07689000
@PB00011 EQU   @PB00012                                                 07690000
@PB00010 EQU   @PB00011                                                 07691000
@PB00009 EQU   @PB00010                                                 07692000
@PB00008 EQU   @PB00009                                                 07693000
@PB00007 EQU   @PB00008                                                 07694000
@PB00006 EQU   @PB00007                                                 07695000
@PB00005 EQU   @PB00006                                                 07696000
@PB00004 EQU   @PB00005                                                 07697000
@PB00003 EQU   @PB00004                                                 07698000
@PB00002 EQU   @PB00003                                                 07699000
@ENDDATA EQU   *                                                        07700000
         END   IDCSR01,(C'PLS1729',0603,76100)                          07701000
