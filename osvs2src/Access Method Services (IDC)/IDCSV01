         TITLE '********** IDCSV01: SCRATCHV FUNCTION SUPPORT ROUTINE **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCSV01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCSV01   75.091'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @10,4095(,@12)                                      0002 00022000
         USING @PSTART,@12                                         0002 00023000
         USING @PSTART+4095,@10                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @11,@01                                             0002 00027000
         USING @DATD,@11                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @11,8(,@13)                                         0002 00031000
         LR    @13,@11                                             0002 00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*   BASEVPTR=ADDR(BASEAREA);        /*                       @Y30LB11*/ 00034000
         LA    BASEVPTR,BASEAREA                                   0240 00035000
*   COPYVPTR=ADDR(COPYAREA);        /*                       @Y30LB11*/ 00036000
         LA    COPYVPTR,COPYAREA                                   0241 00037000
*   DDSTRU=ADDR(DARGAREA);          /*                       @Y30LB11*/ 00038000
         LA    @15,DARGAREA                                        0242 00039000
         ST    @15,DDSTRU                                          0242 00040000
*   DEFLPTR=ADDR(DEFAREA);          /*                       @Y30LB11*/ 00041000
         LA    @15,DEFAREA                                         0243 00042000
         ST    @15,DEFLPTR                                         0243 00043000
*   RVVIPTR=ADDR(RVVIAREA);         /*                       @Y30LB11*/ 00044000
*                                                                  0244 00045000
         LA    @15,RVVIAREA                                        0244 00046000
         ST    @15,RVVIPTR                                         0244 00047000
*   /*****************************************************************/ 00048000
*   /*                                                               */ 00049000
*   /* TRACE AT ENTRY TO SCRATCHV PROCEDURE                  @Y30LB11*/ 00050000
*   /*                                                               */ 00051000
*   /*****************************************************************/ 00052000
*                                                                  0245 00053000
*   OLDERID2=NEWERID2;                                             0245 00054000
         L     @15,@PC00001                                        0245 00055000
         L     @14,GDTTR2(,@15)                                    0245 00056000
         MVC   @TS00001(95),NEWERID2(@14)                          0245 00057000
         MVC   OLDERID2(95,@14),@TS00001                           0245 00058000
*   NEWID2='SVSC';                  /*                       @Y30LB11*/ 00059000
*                                                                  0246 00060000
         MVC   NEWID2(4,@14),@CC01174                              0246 00061000
*   /*****************************************************************/ 00062000
*   /*                                                               */ 00063000
*   /* FULL REGION DUMP BEFORE PROCESSING SCRATCH VOLUME REQUEST     */ 00064000
*   /*                                                               */ 00065000
*   /*****************************************************************/ 00066000
*                                                                  0247 00067000
*                                   /*                       @Y30LB11*/ 00068000
*   IF GDTDBG=NULLPTR THEN                                         0247 00069000
         L     @15,GDTDBG(,@15)                                    0247 00070000
         LTR   @15,@15                                             0247 00071000
         BZ    @RT00247                                            0247 00072000
*     ;                                                            0248 00073000
*   ELSE                                                           0249 00074000
*     CALL IDCDB010(GDTTBL,'SVSV'); /*                       @Y30LB11*/ 00075000
*                                                                  0249 00076000
         L     @15,@PC00001                                        0249 00077000
         ST    @15,@AL00001                                        0249 00078000
         LA    @14,@CC01175                                        0249 00079000
         ST    @14,@AL00001+4                                      0249 00080000
         MVI   @AL00001+4,X'80'                                    0249 00081000
         L     @15,GDTDBG(,@15)                                    0249 00082000
         LA    @01,@AL00001                                        0249 00083000
         BALR  @14,@15                                             0249 00084000
*   /*****************************************************************/ 00085000
*   /*                                                               */ 00086000
*   /* INITIALIZE DATA AREAS TO ZERO                         @Y30LB11*/ 00087000
*   /*                                                               */ 00088000
*   /*****************************************************************/ 00089000
*                                                                  0250 00090000
*   ALLAGL=''B;                     /*                       @Y30LB11*/ 00091000
@RT00247 LA    @15,ALLGAREA                                        0250 00092000
         XC    ALLAGL(31,@15),ALLAGL(@15)                          0250 00093000
*   EXCLAGL=''B;                    /*                       @YD00175*/ 00094000
         LA    @15,EXCLAREA                                        0251 00095000
         XC    EXCLAGL(23,@15),EXCLAGL(@15)                        0251 00096000
*   BASEV=''B;                      /*                       @Y30LB11*/ 00097000
         XC    BASEV(224,BASEVPTR),BASEV(BASEVPTR)                 0252 00098000
*   CKAGL=''B;                      /*                       @Y30LB11*/ 00099000
         LA    @15,CKAGAREA                                        0253 00100000
         XC    CKAGL(29,@15),CKAGL(@15)                            0253 00101000
*   COMTBL=''B;                     /*                       @Y30LB11*/ 00102000
         MVI   COMTBL,X'00'                                        0254 00103000
*   COPYV=''B;                      /*                       @Y30LB11*/ 00104000
         XC    COPYV(164,COPYVPTR),COPYV(COPYVPTR)                 0255 00105000
*   DEFLIST=''B;                    /*                       @Y30LB11*/ 00106000
         L     @15,DEFLPTR                                         0256 00107000
         XC    DEFLIST(132,@15),DEFLIST(@15)                       0256 00108000
*   DARGLIST=''B;                   /*                       @Y30LB11*/ 00109000
         L     @01,DDSTRU                                          0257 00110000
         XC    DARGLIST(20,@01),DARGLIST(@01)                      0257 00111000
*   MDAGL=''B;                      /*                       @Y30LB11*/ 00112000
         LA    @14,MDAGAREA                                        0258 00113000
         XC    MDAGL(31,@14),MDAGL(@14)                            0258 00114000
*   RVVI=''B;                       /*                       @Y30LB11*/ 00115000
         L     @14,RVVIPTR                                         0259 00116000
         XC    RVVI(68,@14),RVVI(@14)                              0259 00117000
*   VS1AGL=''B;                     /*                       @Y30LB11*/ 00118000
         LA    @09,VSAGAREA                                        0260 00119000
         XC    VS1AGL(74,@09),VS1AGL(@09)                          0260 00120000
*   Z8=''B;                         /*                       @Y30LB11*/ 00121000
*                                                                  0261 00122000
         XC    Z8(8),Z8                                            0261 00123000
*   /*****************************************************************/ 00124000
*   /*                                                               */ 00125000
*   /* INITIALIZE DEFLIST AND RVVI PARAMETER LISTS           @Y30LB11*/ 00126000
*   /*                                                               */ 00127000
*   /*****************************************************************/ 00128000
*                                                                  0262 00129000
*   DEFVOLD=VOLVAL;                 /*                       @Y30LB11*/ 00130000
         L     @09,@PC00001+4                                      0262 00131000
         L     @09,FDTPTR(,@09)                                    0262 00132000
         MVC   DEFVOLD(6,@15),VOLVAL(@09)                          0262 00133000
*   RVVLNGTH=RVVLEN;                /*                       @Y30LB11*/ 00134000
         LH    @15,RVVLEN                                          0263 00135000
         ST    @15,RVVLNGTH(,@14)                                  0263 00136000
*   RVVOLUME=VOLVAL;                /*                       @Y30LB11*/ 00137000
         MVC   RVVOLUME(6,@14),VOLVAL(@09)                         0264 00138000
*   RVVCODE=RVVOP;                  /*                       @Y30LB11*/ 00139000
*                                                                  0265 00140000
         MVI   RVVCODE(@14),X'87'                                  0265 00141000
*   /*****************************************************************/ 00142000
*   /*                                                               */ 00143000
*   /* ENQUE TO GET EXCLUSIVE USE OF THE VOLUME SPECIFIED BY @Y30LB11*/ 00144000
*   /* THE USER.                                             @Y30LB11*/ 00145000
*   /*                                                               */ 00146000
*   /*****************************************************************/ 00147000
*                                                                  0266 00148000
*   RNAME=RN1;                      /*                       @Y30LB11*/ 00149000
         MVC   RNAME(16),@CC01125                                  0266 00150000
*   RVOLVAL=VOLVAL;                 /*                       @Y30LB11*/ 00151000
         MVC   RVOLVAL(6),VOLVAL(@09)                              0267 00152000
*   RLENGTH=LENGTH(NAMELNG);        /*                       @Y30LB11*/ 00153000
         MVI   RLENGTH,X'16'                                       0268 00154000
*   CALL IDCSANQ0(GDTTBL,EXCL,WAIT,MAJNAME,UQUENAME);/*      @Y30LB11*/ 00155000
         MVC   @AL00001+4(12),@AL00269                             0269 00156000
         L     @15,@PC00001                                        0269 00157000
         ST    @15,@AL00001                                        0269 00158000
         LA    @14,UQUENAME                                        0269 00159000
         ST    @14,@AL00001+16                                     0269 00160000
         MVI   @AL00001+16,X'80'                                   0269 00161000
         L     @15,GDTENQ(,@15)                                    0269 00162000
         LA    @01,@AL00001                                        0269 00163000
         BALR  @14,@15                                             0269 00164000
*                                                                  0270 00165000
*   /*****************************************************************/ 00166000
*   /*                                                               */ 00167000
*   /* IF COPYDATE WAS SPECIFIED THEN CALL COPYPROC TO SCRATCH THE   */ 00168000
*   /* SPECIFIED COPY.                                       @Y30LB11*/ 00169000
*   /*                                                               */ 00170000
*   /*****************************************************************/ 00171000
*                                                                  0270 00172000
*   IF ADDR(CDATE)^=NULLPTR THEN    /*                       @Y30LB11*/ 00173000
         L     @15,@PC00001+4                                      0270 00174000
         L     @15,FDTPTR+8(,@15)                                  0270 00175000
         LTR   @15,@15                                             0270 00176000
         BZ    @RF00270                                            0270 00177000
*     DO;                           /*                       @Y30LB11*/ 00178000
*       CALL COPYPROC;              /*                       @Y30LB11*/ 00179000
         BAL   @14,COPYPROC                                        0272 00180000
*       RESPECIFY                                                  0273 00181000
*         RTNREG RSTD;                                             0273 00182000
*       TESTRC=RTNREG;                                             0274 00183000
         LR    TESTRC,RTNREG                                       0274 00184000
*       RESPECIFY                                                  0275 00185000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 00186000
*                                                                  0275 00187000
*       /*************************************************************/ 00188000
*       /*                                                           */ 00189000
*       /* IF COPYPROC WAS UNSUCCESSFUL, THEN SET RETURN CODE TO     */ 00190000
*       /* INDICATE FAILURE.                                 @Y30LB11*/ 00191000
*       /*                                                           */ 00192000
*       /*************************************************************/ 00193000
*                                                                  0276 00194000
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/ 00195000
         C     TESTRC,@CF00041                                     0276 00196000
         BNE   @RF00276                                            0276 00197000
*         LASTCOND=LASTCC08;        /*                       @Y30LB11*/ 00198000
         L     @15,@PC00001+8                                      0277 00199000
         MVC   LASTCOND(2,@15),@CH00173                            0277 00200000
*     END;                          /*                       @Y30LB11*/ 00201000
*                                                                  0279 00202000
*   /*****************************************************************/ 00203000
*   /*                                                               */ 00204000
*   /* IF COPYDATE WAS NOT SPECIFIED, CHECK OUT THE BASE VOLUME,     */ 00205000
*   /* SCRATCH ALL COPIES, IF NECESSARY, AND SCRATCH THE BASE VOLUME.*/ 00206000
*   /*                                                       @Y30LB11*/ 00207000
*   /*                                                               */ 00208000
*   /*****************************************************************/ 00209000
*                                                                  0279 00210000
*   ELSE                            /*                       @Y30LB11*/ 00211000
*     DO;                           /*                       @Y30LB11*/ 00212000
*                                                                  0279 00213000
         B     @RC00270                                            0279 00214000
@RF00270 DS    0H                                                  0280 00215000
*       /*************************************************************/ 00216000
*       /*                                                           */ 00217000
*       /* CALL BASECHK TO CHECK THE VOLUME RECORD AND THE VTOC OF   */ 00218000
*       /* THE BASE VOLUME.                                  @Y30LB11*/ 00219000
*       /*                                                           */ 00220000
*       /*************************************************************/ 00221000
*                                                                  0280 00222000
*       CALL BASECHK;               /*                       @Y30LB11*/ 00223000
         BAL   @14,BASECHK                                         0280 00224000
*       RESPECIFY                                                  0281 00225000
*         RTNREG RSTD;                                             0281 00226000
*       TESTRC=RTNREG;                                             0282 00227000
         LR    TESTRC,RTNREG                                       0282 00228000
*       RESPECIFY                                                  0283 00229000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 00230000
*                                                                  0283 00231000
*       /*************************************************************/ 00232000
*       /*                                                           */ 00233000
*       /* IF BASECHK WAS UNSUCCESSFUL, THEN SET RETURN CODE @Y30LB11*/ 00234000
*       /* TO INDICATE FAILURE.                              @Y30LB11*/ 00235000
*       /*                                                           */ 00236000
*       /*************************************************************/ 00237000
*                                                                  0284 00238000
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/ 00239000
         C     TESTRC,@CF00041                                     0284 00240000
         BNE   @RF00284                                            0284 00241000
*         LASTCOND=LASTCC08;        /*                       @Y30LB11*/ 00242000
         L     @15,@PC00001+8                                      0285 00243000
         MVC   LASTCOND(2,@15),@CH00173                            0285 00244000
*       ELSE                        /*                       @Y30LB11*/ 00245000
*         DO;                       /*                       @Y30LB11*/ 00246000
*                                                                  0286 00247000
         B     @RC00284                                            0286 00248000
@RF00284 DS    0H                                                  0287 00249000
*           /*********************************************************/ 00250000
*           /*                                                       */ 00251000
*           /* IF THE PARAMETER 'ALL' WAS SPECIFIED, THEN CALL THE   */ 00252000
*           /* ALLCOPY ROUTINE TO SCRATCH ALL COPIES FOR THE BASE    */ 00253000
*           /* VOLUME.                                       @Y30LB11*/ 00254000
*           /*                                                       */ 00255000
*           /*********************************************************/ 00256000
*                                                                  0287 00257000
*           IF ADDR(ALLC)^=NULLPTR THEN/*                    @Y30LB11*/ 00258000
         L     @15,@PC00001+4                                      0287 00259000
         L     @15,FDTPTR+4(,@15)                                  0287 00260000
         LTR   @15,@15                                             0287 00261000
         BZ    @RF00287                                            0287 00262000
*             DO;                   /*                       @Y30LB11*/ 00263000
*               CALL ALLCOPY;       /*                       @Y30LB11*/ 00264000
         BAL   @14,ALLCOPY                                         0289 00265000
*               RESPECIFY                                          0290 00266000
*                 RTNREG RSTD;                                     0290 00267000
*               TESTRC=RTNREG;                                     0291 00268000
         LR    TESTRC,RTNREG                                       0291 00269000
*               RESPECIFY                                          0292 00270000
*                 RTNREG UNRSTD;    /*                       @Y30LB11*/ 00271000
*                                                                  0292 00272000
*               /*****************************************************/ 00273000
*               /*                                                   */ 00274000
*               /* IF ALLCOPY WAS UNSUCCESSFUL, THEN SET THE RETURN  */ 00275000
*               /* CODE.                                     @Y30LB11*/ 00276000
*               /*                                                   */ 00277000
*               /*****************************************************/ 00278000
*                                                                  0293 00279000
*               IF TESTRC=4 THEN    /*                       @Y30LB11*/ 00280000
         C     TESTRC,@CF00041                                     0293 00281000
         BNE   @RF00293                                            0293 00282000
*                 LASTCOND=LASTCC08;/*                       @Y30LB11*/ 00283000
         L     @04,@PC00001+8                                      0294 00284000
         MVC   LASTCOND(2,@04),@CH00173                            0294 00285000
*             END;                  /*                       @Y30LB11*/ 00286000
*                                                                  0295 00287000
@RF00293 DS    0H                                                  0296 00288000
*           /*********************************************************/ 00289000
*           /*                                                       */ 00290000
*           /* IF THE THE ALLCOPY ROUTINE FAILED, PRINT THE MESSAGE: */ 00291000
*           /* VOLUME (VOLSER) NOT SCRATCHED, COPIES EXIST.  @Y30LB11*/ 00292000
*           /*                                                       */ 00293000
*           /*********************************************************/ 00294000
*                                                                  0296 00295000
*           IF LASTCOND=LASTCC08 THEN/*                      @Y30LB11*/ 00296000
@RF00287 L     @04,@PC00001+8                                      0296 00297000
         CLC   LASTCOND(2,@04),@CH00173                            0296 00298000
         BNE   @RF00296                                            0296 00299000
*             DO;                   /*                       @Y30LB11*/ 00300000
*               DARGAREA=''B;       /*                       @Y30LB11*/ 00301000
         XC    DARGAREA(36),DARGAREA                               0298 00302000
*               DARGSMOD=SCRTCHMG;  /*                       @Y30LB11*/ 00303000
         L     @15,DDSTRU                                          0299 00304000
         MVC   DARGSMOD(3,@15),@CC01131                            0299 00305000
*               DARGSENT=MSG2753I;  /*                       @Y30LB11*/ 00306000
         MVI   DARGSENT(@15),X'01'                                 0300 00307000
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB11*/ 00308000
         L     @14,@PC00001+4                                      0301 00309000
         L     @01,FDTPTR(,@14)                                    0301 00310000
         LA    @14,VOLVAL(,@01)                                    0301 00311000
         ST    @14,DARGDBP(,@15)                                   0301 00312000
*               DARGILP=LENGTH(VOLVAL);/*                    @Y30LB11*/ 00313000
         MVC   DARGILP(2,@15),@CH00150                             0302 00314000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB11*/ 00315000
         L     @15,@PC00001                                        0303 00316000
         ST    @15,@AL00001                                        0303 00317000
         LA    @14,@CF00111                                        0303 00318000
         ST    @14,@AL00001+4                                      0303 00319000
         LA    @14,DDSTRU                                          0303 00320000
         ST    @14,@AL00001+8                                      0303 00321000
         MVI   @AL00001+8,X'80'                                    0303 00322000
         L     @15,GDTPRT(,@15)                                    0303 00323000
         LA    @01,@AL00001                                        0303 00324000
         BALR  @14,@15                                             0303 00325000
*             END;                  /*                       @Y30LB11*/ 00326000
*                                                                  0304 00327000
*           /*********************************************************/ 00328000
*           /*                                                       */ 00329000
*           /* IF ALLCOPY WAS SUCCESSFUL OR WAS NOT CALLED, CALL     */ 00330000
*           /* BASEPROC TO SCRATCH THE BASE VOLUME.          @Y30LB11*/ 00331000
*           /*                                                       */ 00332000
*           /*********************************************************/ 00333000
*                                                                  0305 00334000
*           ELSE                    /*                       @Y30LB11*/ 00335000
*             DO;                   /*                       @Y30LB11*/ 00336000
         B     @RC00296                                            0305 00337000
@RF00296 DS    0H                                                  0306 00338000
*               CALL BASEPROC;      /*                       @Y30LB11*/ 00339000
         BAL   @14,BASEPROC                                        0306 00340000
*               RESPECIFY                                          0307 00341000
*                 RTNREG RSTD;                                     0307 00342000
*               TESTRC=RTNREG;                                     0308 00343000
         LR    TESTRC,RTNREG                                       0308 00344000
*               RESPECIFY                                          0309 00345000
*                 RTNREG UNRSTD;    /*                       @Y30LB11*/ 00346000
*                                                                  0309 00347000
*               /*****************************************************/ 00348000
*               /*                                                   */ 00349000
*               /* IF BASEPROC WAS UNSUCCESSFUL, THEN SET THE RETURN */ 00350000
*               /* CODE.                                     @Y30LB11*/ 00351000
*               /*                                                   */ 00352000
*               /*****************************************************/ 00353000
*                                                                  0310 00354000
*               IF TESTRC=4 THEN    /*                       @Y30LB11*/ 00355000
         C     TESTRC,@CF00041                                     0310 00356000
         BNE   @RF00310                                            0310 00357000
*                 LASTCOND=LASTCC08;/*                       @Y30LB11*/ 00358000
         L     @15,@PC00001+8                                      0311 00359000
         MVC   LASTCOND(2,@15),@CH00173                            0311 00360000
*             END;                  /*                       @Y30LB11*/ 00361000
@RF00310 DS    0H                                                  0313 00362000
*         END;                      /*                       @Y30LB11*/ 00363000
*                                                                  0313 00364000
@RC00296 DS    0H                                                  0314 00365000
*       /*************************************************************/ 00366000
*       /*                                                           */ 00367000
*       /* IF A UNIT WAS ALLOCATED, THE UDEALLOC MACRO IS ISSUED TO  */ 00368000
*       /* DEALLOCATE THE UNIT BEFORE EXITING SCRATCHV.      @Y30LB11*/ 00369000
*       /*                                                           */ 00370000
*       /*************************************************************/ 00371000
*                                                                  0314 00372000
*       IF ALLOCFLG=ON THEN         /*                       @Y30LB11*/ 00373000
@RC00284 TM    ALLOCFLG,B'00010000'                                0314 00374000
         BNO   @RF00314                                            0314 00375000
*         DO;                       /*                       @Y30LB11*/ 00376000
*           CALL IDCSADL0(GDTTBL,ALLAGL);/*                  @Y30LB11*/ 00377000
         L     @02,@PC00001                                        0316 00378000
         ST    @02,@AL00001                                        0316 00379000
         LA    @15,ALLGAREA                                        0316 00380000
         ST    @15,@AL00001+4                                      0316 00381000
         MVI   @AL00001+4,X'80'                                    0316 00382000
         L     @15,GDTDLC(,@02)                                    0316 00383000
         LA    @01,@AL00001                                        0316 00384000
         BALR  @14,@15                                             0316 00385000
*           RESPECIFY                                              0317 00386000
*             RTNREG RSTD;                                         0317 00387000
*           TESTRC=RTNREG;                                         0318 00388000
         LR    TESTRC,RTNREG                                       0318 00389000
*           RESPECIFY                                              0319 00390000
*             RTNREG UNRSTD;        /*                       @Y30LB11*/ 00391000
*                                                                  0319 00392000
*           /*********************************************************/ 00393000
*           /*                                                       */ 00394000
*           /* IF THE UDEALOC MACRO FAILED, SET THE RETURN CODE.     */ 00395000
*           /*                                               @Y30LB11*/ 00396000
*           /*                                                       */ 00397000
*           /*********************************************************/ 00398000
*                                                                  0320 00399000
*           IF TESTRC>0 THEN        /*                       @Y30LB11*/ 00400000
         LTR   TESTRC,TESTRC                                       0320 00401000
         BNP   @RF00320                                            0320 00402000
*             LASTCOND=MAX(LASTCC04,LASTCOND);/*             @Y30LB11*/ 00403000
         L     @15,@PC00001+8                                      0321 00404000
         LH    @14,LASTCOND(,@15)                                  0321 00405000
         LA    @09,4                                               0321 00406000
         CR    @14,@09                                             0321 00407000
         BNL   *+6                                                      00408000
         LR    @14,@09                                             0321 00409000
         STH   @14,LASTCOND(,@15)                                  0321 00410000
*         END;                      /*                       @Y30LB11*/ 00411000
*                                                                  0322 00412000
@RF00320 DS    0H                                                  0323 00413000
*       /*************************************************************/ 00414000
*       /*                                                           */ 00415000
*       /* IF A RESERVE WAS DONE THEN THE UDEQ IS ISSUED TO          */ 00416000
*       /* UNRESERVE.                                        @Y30LB11*/ 00417000
*       /*                                                           */ 00418000
*       /*************************************************************/ 00419000
*                                                                  0323 00420000
*       IF VSRES=ON THEN            /*                       @Y30LB11*/ 00421000
@RF00314 LA    @15,VSAGAREA                                        0323 00422000
         TM    VSRES(@15),B'10000000'                              0323 00423000
         BNO   @RF00323                                            0323 00424000
*         DO;                       /*                       @Y30LB11*/ 00425000
*           RNAME=RN2;              /*                       @Y30LB11*/ 00426000
         MVC   RNAME(16),@CC01128                                  0325 00427000
*           CALL IDCSADQ0(GDTTBL,MAJNAME,UQUENAME);/*        @Y30LB11*/ 00428000
         L     @15,@PC00001                                        0326 00429000
         ST    @15,@AL00001                                        0326 00430000
         LA    @14,@CC01113                                        0326 00431000
         ST    @14,@AL00001+4                                      0326 00432000
         LA    @14,UQUENAME                                        0326 00433000
         ST    @14,@AL00001+8                                      0326 00434000
         MVI   @AL00001+8,X'80'                                    0326 00435000
         L     @15,GDTDEQ(,@15)                                    0326 00436000
         LA    @01,@AL00001                                        0326 00437000
         BALR  @14,@15                                             0326 00438000
*         END;                      /*                       @Y30LB11*/ 00439000
*     END;                          /*                       @Y30LB11*/ 00440000
@RF00323 DS    0H                                                  0329 00441000
*                                                                  0329 00442000
*   /*****************************************************************/ 00443000
*   /*                                                               */ 00444000
*   /* FINALLY, THE UDEQ MACRO IS USSUED TO DEQUE THE UENQ ISSUED    */ 00445000
*   /* EARLIER.                                              @Y30LB11*/ 00446000
*   /*                                                               */ 00447000
*   /*****************************************************************/ 00448000
*                                                                  0329 00449000
*   RNAME=RN1;                      /*                       @Y30LB11*/ 00450000
@RC00270 MVC   RNAME(16),@CC01125                                  0329 00451000
*   CALL IDCSADQ0(GDTTBL,MAJNAME,UQUENAME);/*                @Y30LB11*/ 00452000
*                                                                  0330 00453000
         L     @15,@PC00001                                        0330 00454000
         ST    @15,@AL00001                                        0330 00455000
         LA    @14,@CC01113                                        0330 00456000
         ST    @14,@AL00001+4                                      0330 00457000
         LA    @14,UQUENAME                                        0330 00458000
         ST    @14,@AL00001+8                                      0330 00459000
         MVI   @AL00001+8,X'80'                                    0330 00460000
         L     @15,GDTDEQ(,@15)                                    0330 00461000
         LA    @01,@AL00001                                        0330 00462000
         BALR  @14,@15                                             0330 00463000
*   /*****************************************************************/ 00464000
*   /*                                                               */ 00465000
*   /* IF THE RETURN CODE HAS BEEN SET TO 8 AND NO COPIES WERE       */ 00466000
*   /* SCRATCHED AT ALL, THE FINAL RETURN CODE IS SET TO 12. @Y30LB11*/ 00467000
*   /*                                                               */ 00468000
*   /*****************************************************************/ 00469000
*                                                                  0331 00470000
*   IF LASTCOND=LASTCC08 THEN       /*                       @Y30LB11*/ 00471000
         L     @15,@PC00001+8                                      0331 00472000
         CLC   LASTCOND(2,@15),@CH00173                            0331 00473000
         BNE   @RF00331                                            0331 00474000
*     IF SCRDFLG=OFF THEN           /*                       @Y30LB11*/ 00475000
         TM    SCRDFLG,B'01000000'                                 0332 00476000
         BNZ   @RF00332                                            0332 00477000
*       LASTCOND=LASTCC12;          /*                       @Y30LB11*/ 00478000
         MVC   LASTCOND(2,@15),@CH00035                            0333 00479000
*     ELSE                                                         0334 00480000
*       ;                           /*                       @Y30LB11*/ 00481000
*                                                                  0334 00482000
@RF00332 DS    0H                                                  0335 00483000
*   /*****************************************************************/ 00484000
*   /*                                                               */ 00485000
*   /* IF THE RETURN CODE IS 0 OR 4 AND EITHER THE INVENTORY RECORD  */ 00486000
*   /* WAS NOT UPDATED OR THE UCLOSE MACRO FAILED THEN THE FINAL     */ 00487000
*   /* RETURN CODE IS SET TO 4.                              @Y30LB11*/ 00488000
*   /*                                                               */ 00489000
*   /*****************************************************************/ 00490000
*                                                                  0335 00491000
*   ELSE                            /*                       @Y30LB11*/ 00492000
*     IF(VIERRFLG=ON|UCLOSERR=ON) THEN/*                     @Y30LB11*/ 00493000
         B     @RC00331                                            0335 00494000
@RF00331 TM    VIERRFLG,B'10100000'                                0335 00495000
         BZ    @RF00335                                            0335 00496000
*       LASTCOND=LASTCC04;          /*                       @Y30LB11*/ 00497000
*                                                                  0336 00498000
         L     @15,@PC00001+8                                      0336 00499000
         MVC   LASTCOND(2,@15),@CH00041                            0336 00500000
*   /*****************************************************************/ 00501000
*   /*                                                               */ 00502000
*   /* ISSUE THE FINAL COMPLETION MESSAGE                    @Y30LB11*/ 00503000
*   /*                                                               */ 00504000
*   /*****************************************************************/ 00505000
*                                                                  0337 00506000
*   DARGAREA=''B;                   /*                       @Y30LB11*/ 00507000
@RF00335 DS    0H                                                  0337 00508000
@RC00331 XC    DARGAREA(36),DARGAREA                               0337 00509000
*   DARGSMOD=UNIVMSG;               /*                       @Y30LB11*/ 00510000
         L     @15,DDSTRU                                          0338 00511000
         MVC   DARGSMOD(3,@15),@CC01133                            0338 00512000
*   DARGDBP=ADDR(LASTCOND);         /*                       @Y30LB11*/ 00513000
         L     @14,@PC00001+8                                      0339 00514000
         ST    @14,DARGDBP(,@15)                                   0339 00515000
*   DARGILP=LENGTH(LASTCOND);       /*                       @Y30LB11*/ 00516000
*                                                                  0340 00517000
         MVC   DARGILP(2,@15),@CH00147                             0340 00518000
*   /*****************************************************************/ 00519000
*   /*                                                               */ 00520000
*   /* IF THE FINAL RETURN CODE IS 12 THEN THE MESSAGE: FUNCTION     */ 00521000
*   /* TERMINATED, CONDITION CODE IS (NN), IS WRITTEN.       @Y30LB11*/ 00522000
*   /*                                                               */ 00523000
*   /*****************************************************************/ 00524000
*                                                                  0341 00525000
*   IF LASTCOND=LASTCC12 THEN       /*                       @Y30LB11*/ 00526000
         CLC   LASTCOND(2,@14),@CH00035                            0341 00527000
         BNE   @RF00341                                            0341 00528000
*     DARGSENT=MSG3003I;            /*                       @Y30LB11*/ 00529000
         MVI   DARGSENT(@15),X'03'                                 0342 00530000
*   ELSE                            /*                       @Y30LB11*/ 00531000
*                                                                  0343 00532000
*     /***************************************************************/ 00533000
*     /*                                                             */ 00534000
*     /* OTHERWISE, THE MESSAGE: FUNCTION COMPLETED, HIGHEST         */ 00535000
*     /* CONDITION CODE WAS (NN), IS WRITTEN.                @Y30LB11*/ 00536000
*     /*                                                             */ 00537000
*     /***************************************************************/ 00538000
*                                                                  0343 00539000
*     DARGSENT=MSG0001I;            /*                       @Y30LB11*/ 00540000
         B     @RC00341                                            0343 00541000
@RF00341 L     @01,DDSTRU                                          0343 00542000
         MVI   DARGSENT(@01),X'01'                                 0343 00543000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*                  @Y30LB11*/ 00544000
*                                                                  0344 00545000
@RC00341 L     @15,@PC00001                                        0344 00546000
         ST    @15,@AL00001                                        0344 00547000
         LA    @14,@CF00111                                        0344 00548000
         ST    @14,@AL00001+4                                      0344 00549000
         LA    @14,DDSTRU                                          0344 00550000
         ST    @14,@AL00001+8                                      0344 00551000
         MVI   @AL00001+8,X'80'                                    0344 00552000
         L     @15,GDTPRT(,@15)                                    0344 00553000
         LA    @01,@AL00001                                        0344 00554000
         BALR  @14,@15                                             0344 00555000
*   /*****************************************************************/ 00556000
*   /*                                                               */ 00557000
*   /* FULL REGION DUMP BEFORE EXITING SCRATCHV              @Y30LB11*/ 00558000
*   /*                                                               */ 00559000
*   /*****************************************************************/ 00560000
*                                                                  0345 00561000
*   IF GDTDBG=NULLPTR THEN                                         0345 00562000
         L     @15,@PC00001                                        0345 00563000
         L     @15,GDTDBG(,@15)                                    0345 00564000
         LTR   @15,@15                                             0345 00565000
         BZ    @RT00345                                            0345 00566000
*     ;                                                            0346 00567000
*   ELSE                                                           0347 00568000
*     CALL IDCDB010(GDTTBL,'SVRC'); /*                       @Y30LB11*/ 00569000
*                                                                  0347 00570000
         L     @15,@PC00001                                        0347 00571000
         ST    @15,@AL00001                                        0347 00572000
         LA    @14,@CC01182                                        0347 00573000
         ST    @14,@AL00001+4                                      0347 00574000
         MVI   @AL00001+4,X'80'                                    0347 00575000
         L     @15,GDTDBG(,@15)                                    0347 00576000
         LA    @01,@AL00001                                        0347 00577000
         BALR  @14,@15                                             0347 00578000
*   /*****************************************************************/ 00579000
*   /*                                                               */ 00580000
*   /* RETURN TO AMS EXECUTIVE                               @Y30LB11*/ 00581000
*   /*                                                               */ 00582000
*   /*****************************************************************/ 00583000
*                                                                  0348 00584000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);                          0348 00585000
*                                                                  0348 00586000
@RT00345 L     @15,@PC00001                                        0348 00587000
         ST    @15,@AL00001                                        0348 00588000
         LA    @14,MODID                                           0348 00589000
         ST    @14,@AL00001+4                                      0348 00590000
         L     @14,@PC00001+8                                      0348 00591000
         ST    @14,@AL00001+8                                      0348 00592000
         MVI   @AL00001+8,X'80'                                    0348 00593000
         L     @15,GDTEPL(,@15)                                    0348 00594000
         LA    @01,@AL00001                                        0348 00595000
         BALR  @14,@15                                             0348 00596000
*   /*****************************************************************/ 00597000
*   /*                                                               */ 00598000
*   /*                                                       @Y30LB11*/ 00599000
*   /*                                                               */ 00600000
*   /*****************************************************************/ 00601000
*                                                                  0349 00602000
*                                                                  0349 00603000
*/********************************************************************/ 00604000
*/*                                                          @Y30LB11*/ 00605000
*/* PROCEDURE NAME - ALLCOPY                                 @Y30LB11*/ 00606000
*/*                                                          @Y30LB11*/ 00607000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO CALL       @Y30LB11*/ 00608000
*/*            THE SCRCOPY ROUTINE TO SCRATCH ALL COPIES     @Y30LB11*/ 00609000
*/*            OF A VIRTUAL VOLUME.                          @Y30LB11*/ 00610000
*/*                                                          @Y30LB11*/ 00611000
*/*            IDC2078I ** COPY RECORDS FOR VOLUME (VOLSER)  @Y30LB11*/ 00612000
*/*            CANNOT BE RETRIEVED.                          @Y30LB11*/ 00613000
*/*                                                          @Y30LB11*/ 00614000
*/* INPUT - THE RVVI MAPPING MACRO IS INITIALIZED AND USED   @Y30LB11*/ 00615000
*/*         AS INPUT TO READ THE COPYV RECORDS TO BE         @Y30LB11*/ 00616000
*/*         SCRATCHED.                                       @Y30LB11*/ 00617000
*/*                                                          @Y30LB11*/ 00618000
*/* OUTPUT - OUTPUT CONSISTS RETURN CODE IN REGISTER 15.     @Y30LB11*/ 00619000
*/*          SCRDFLG IS SET ON IF SCRCOPY IS SUCCESSFUL.     @Y30LB11*/ 00620000
*/*                                                          @Y30LB11*/ 00621000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 00622000
*/*                                                          @Y30LB11*/ 00623000
*/*          4 - COPY RECORD COULD NOT BE READ OR COPY NOT   @Y30LB11*/ 00624000
*/*              SCRATCHED.                                  @Y30LB11*/ 00625000
*/*                                                          @Y30LB11*/ 00626000
*/********************************************************************/ 00627000
*                                                                  0349 00628000
*ALLCOPY:                           /*                       @Y30LB11*/ 00629000
*   PROC;                           /*                       @Y30LB11*/ 00630000
@EL00001 L     @13,4(,@13)                                         0349 00631000
@EF00001 L     @00,@SIZDATD                                        0349 00632000
         LR    @01,@11                                             0349 00633000
         FREEMAIN R,LV=(0),A=(1)                                        00634000
@ER00001 LM    @14,@12,12(@13)                                     0349 00635000
         BR    @14                                                 0349 00636000
ALLCOPY  STM   @14,@12,@SA00002                                    0349 00637000
*   DCL                                                            0350 00638000
*     ALLCOND FIXED(15);            /*                       @Y30LB11*/ 00639000
*                                                                  0351 00640000
*   /*****************************************************************/ 00641000
*   /*                                                               */ 00642000
*   /* ALLCOPY RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/ 00643000
*   /*                                                               */ 00644000
*   /*****************************************************************/ 00645000
*                                                                  0351 00646000
*   ALLCOND=0;                      /*                       @Y30LB11*/ 00647000
*                                                                  0351 00648000
         SLR   @15,@15                                             0351 00649000
         LR    ALLCOND,@15                                         0351 00650000
*   /*****************************************************************/ 00651000
*   /*                                                               */ 00652000
*   /* TRACE AT ENTRY TO ALLCOPY PROCEDURE                   @Y30LB11*/ 00653000
*   /*                                                               */ 00654000
*   /*****************************************************************/ 00655000
*                                                                  0352 00656000
*   OLDERID2=NEWERID2;                                             0352 00657000
         L     @14,@PC00001                                        0352 00658000
         L     @09,GDTTR2(,@14)                                    0352 00659000
         MVC   @TS00001(95),NEWERID2(@09)                          0352 00660000
         MVC   OLDERID2(95,@09),@TS00001                           0352 00661000
*   NEWID2='SVAC';                  /*                       @Y30LB11*/ 00662000
*                                                                  0353 00663000
         MVC   NEWID2(4,@09),@CC01187                              0353 00664000
*   /*****************************************************************/ 00665000
*   /*                                                               */ 00666000
*   /* INITIALIZE RVVI VARIABLES FOR READING ALL COPIES      @Y30LB11*/ 00667000
*   /*                                                               */ 00668000
*   /*****************************************************************/ 00669000
*                                                                  0354 00670000
*   RVVRDR=OFF;                     /*                       @Y30LB11*/ 00671000
         L     @09,RVVIPTR                                         0354 00672000
         NI    RVVRDR(@09),B'01111111'                             0354 00673000
*   RVVBVRCD=OFF;                   /*                       @Y30LB11*/ 00674000
         NI    RVVBVRCD(@09),B'01111111'                           0355 00675000
*   RVVCPYID=0;                     /*                       @Y30LB11*/ 00676000
         MVI   RVVCPYID(@09),X'00'                                 0356 00677000
*   RVVSCPY=ON;                     /*                       @Y30LB11*/ 00678000
         OI    RVVSCPY(@09),B'00000100'                            0357 00679000
*   RVVRDNR=ON;                     /*                       @Y30LB11*/ 00680000
         OI    RVVRDNR(@09),B'01000000'                            0358 00681000
*   RVVCPYRC=ON;                    /*                       @Y30LB11*/ 00682000
         OI    RVVCPYRC(@09),B'00100000'                           0359 00683000
*   RVVBUFLN=LENGTH(COPYAREA);      /*                       @Y30LB11*/ 00684000
         MVC   RVVBUFLN(2,@09),@CH01285                            0360 00685000
*   RVVRTBUF=COPYVPTR;              /*                       @Y30LB11*/ 00686000
*                                                                  0361 00687000
         ST    COPYVPTR,RVVRTBUF(,@09)                             0361 00688000
*   /*****************************************************************/ 00689000
*   /*                                                               */ 00690000
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/ 00691000
*   /*                                                               */ 00692000
*   /*****************************************************************/ 00693000
*                                                                  0362 00694000
*   IF GDTDBG=NULLPTR THEN                                         0362 00695000
         C     @15,GDTDBG(,@14)                                    0362 00696000
         BE    @RT00362                                            0362 00697000
*     ;                                                            0363 00698000
*   ELSE                                                           0364 00699000
*     DO;                                                          0364 00700000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/ 00701000
         LA    DMPINDEX,DUMPAREA                                   0365 00702000
*       DMPITMNM='RVVI';                                           0366 00703000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0366 00704000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0366 00705000
         MVC   DMPITMNM(4,DMPINDEX),@CC01188                       0366 00706000
*       DMPITMPT=ADDR(RVVI);                                       0367 00707000
         L     @03,RVVIPTR                                         0367 00708000
         ST    @03,DMPITMPT(,DMPINDEX)                             0367 00709000
*       DMPITMLN=LENGTH(RVVI);                                     0368 00710000
         MVC   DMPITMLN(2,DMPINDEX),@CH01286                       0368 00711000
*       DMPITMTP='H';                                              0369 00712000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0369 00713000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0370 00714000
*                                                                  0370 00715000
         AL    DMPINDEX,@CF00464                                   0370 00716000
*       /*************************************************************/ 00717000
*       /*                                                           */ 00718000
*       /*                                                   @Y30LB11*/ 00719000
*       /*                                                           */ 00720000
*       /*************************************************************/ 00721000
*                                                                  0371 00722000
*       DMPTRM=DMPTRMVL;                                           0371 00723000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0371 00724000
*     END;                          /*                       @Y30LB11*/ 00725000
*   IF GDTDBG=NULLPTR THEN                                         0373 00726000
@RT00362 L     @15,@PC00001                                        0373 00727000
         L     @15,GDTDBG(,@15)                                    0373 00728000
         LTR   @15,@15                                             0373 00729000
         BZ    @RT00373                                            0373 00730000
*     ;                                                            0374 00731000
*   ELSE                                                           0375 00732000
*     CALL IDCDB010(GDTTBL,'SVRA',ADDR(DUMPAREA));/*         @Y30LB11*/ 00733000
         L     @15,@PC00001                                        0375 00734000
         ST    @15,@AL00001                                        0375 00735000
         LA    @14,@CC01190                                        0375 00736000
         ST    @14,@AL00001+4                                      0375 00737000
         LA    @14,DUMPAREA                                        0375 00738000
         ST    @14,@AFTEMPS                                        0375 00739000
         LA    @14,@AFTEMPS                                        0375 00740000
         ST    @14,@AL00001+8                                      0375 00741000
         MVI   @AL00001+8,X'80'                                    0375 00742000
         L     @15,GDTDBG(,@15)                                    0375 00743000
         LA    @01,@AL00001                                        0375 00744000
         BALR  @14,@15                                             0375 00745000
*                                                                  0376 00746000
*/*   REASONCD IS INITIALIZED TO 0 FOR THE FIRST READ        @Y30LB11*/ 00747000
*                                                                  0376 00748000
*   REASONCD=0;                     /*                       @Y30LB11*/ 00749000
*                                                                  0376 00750000
@RT00373 SLR   @15,@15                                             0376 00751000
         ST    @15,REASONCD                                        0376 00752000
*   /*****************************************************************/ 00753000
*   /*                                                               */ 00754000
*   /* THIS CODE IS EXECUTED REPEATEDLY UNTIL EITHER THE RETURN CODE */ 00755000
*   /* IS SET TO 4 OR UNTIL END OF FILE IS REACHED.          @Y30LB11*/ 00756000
*   /*                                                               */ 00757000
*   /*****************************************************************/ 00758000
*                                                                  0377 00759000
*   DO WHILE ALLCOND^=4&REASONCD^=EOFILE;/*                  @Y30LB11*/ 00760000
*                                                                  0377 00761000
         B     @DE00377                                            0377 00762000
@DL00377 DS    0H                                                  0378 00763000
*     /***************************************************************/ 00764000
*     /*                                                             */ 00765000
*     /* ISSUE THE USSC MACRO TO READ THE NEXT COPY RECORD.  @Y30LB11*/ 00766000
*     /*                                                             */ 00767000
*     /***************************************************************/ 00768000
*                                                                  0378 00769000
*     CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*         @Y30LB11*/ 00770000
         L     @02,@PC00001                                        0378 00771000
         ST    @02,@AL00001                                        0378 00772000
         LA    @15,VVIC                                            0378 00773000
         ST    @15,@AL00001+4                                      0378 00774000
         LA    @15,RVVIPTR                                         0378 00775000
         ST    @15,@AL00001+8                                      0378 00776000
         LA    @15,REASONCD                                        0378 00777000
         ST    @15,@AL00001+12                                     0378 00778000
         MVI   @AL00001+12,X'80'                                   0378 00779000
         L     @15,GDTSSC(,@02)                                    0378 00780000
         LA    @01,@AL00001                                        0378 00781000
         BALR  @14,@15                                             0378 00782000
*     RESPECIFY                                                    0379 00783000
*       RTNREG RSTD;                                               0379 00784000
*     TESTRC=RTNREG;                                               0380 00785000
         LR    TESTRC,RTNREG                                       0380 00786000
*     RESPECIFY                                                    0381 00787000
*       RTNREG UNRSTD;              /*                       @Y30LB11*/ 00788000
*                                                                  0381 00789000
*     /***************************************************************/ 00790000
*     /*                                                             */ 00791000
*     /* IF THE COPY RECORD WAS READ SUCCESSFULLY, THE SCRCOPY       */ 00792000
*     /* PROCEDURE IS CALLED TO SCRATCH EACH COPY REQUESTED. @Y30LB11*/ 00793000
*     /*                                                             */ 00794000
*     /***************************************************************/ 00795000
*                                                                  0382 00796000
*     IF TESTRC=0 THEN              /*                       @Y30LB11*/ 00797000
         LTR   TESTRC,TESTRC                                       0382 00798000
         BNZ   @RF00382                                            0382 00799000
*       DO;                         /*                       @Y30LB11*/ 00800000
*         CALL SCRCOPY(COMTBL);     /*                       @Y30LB11*/ 00801000
         LA    @15,COMTBL                                          0384 00802000
         ST    @15,@AL00001                                        0384 00803000
         LA    @01,@AL00001                                        0384 00804000
         BAL   @14,SCRCOPY                                         0384 00805000
*         RESPECIFY                                                0385 00806000
*           RTNREG RSTD;                                           0385 00807000
*         TESTRC=RTNREG;                                           0386 00808000
         LR    TESTRC,RTNREG                                       0386 00809000
*         RESPECIFY                                                0387 00810000
*           RTNREG UNRSTD;          /*                       @Y30LB11*/ 00811000
*                                                                  0387 00812000
*         /***********************************************************/ 00813000
*         /*                                                         */ 00814000
*         /* IF THE SCRCOPY PROC EXECUTED SUCCESSFULLY THE SCRDFLG IS*/ 00815000
*         /* SET ON INDICATING THAT AT LEAST ONE COPY WAS SCRATCHED. */ 00816000
*         /*                                                 @Y30LB11*/ 00817000
*         /*                                                         */ 00818000
*         /***********************************************************/ 00819000
*                                                                  0388 00820000
*         IF TESTRC=0 THEN          /*                       @Y30LB11*/ 00821000
         LTR   TESTRC,TESTRC                                       0388 00822000
         BNZ   @RF00388                                            0388 00823000
*           SCRDFLG=ON;             /*                       @Y30LB11*/ 00824000
*                                                                  0389 00825000
         OI    SCRDFLG,B'01000000'                                 0389 00826000
*         /***********************************************************/ 00827000
*         /*                                                         */ 00828000
*         /* IF THE SCRATCH FAILED, THE CONDITION CODE IS SET TO 8 TO*/ 00829000
*         /* INDICATE THAT THE REST OF THE COPIES CAN STILL BE       */ 00830000
*         /* SCRATCHED. OTHERWISE, STORAGE IS NOT AVAILABLE TO ISSUE */ 00831000
*         /* FURTHER MSC MACROS, SO SET THE CONDITION CODE TO 4 TO   */ 00832000
*         /* TERMINATEINATE THE LOOP OF SCRATCHING COPIES.   @Y30LB11*/ 00833000
*         /*                                                         */ 00834000
*         /***********************************************************/ 00835000
*                                                                  0390 00836000
*         ELSE                      /*                       @Y30LB11*/ 00837000
*           IF TESTRC=4 THEN        /*                       @Y30LB11*/ 00838000
         B     @RC00388                                            0390 00839000
@RF00388 C     TESTRC,@CF00041                                     0390 00840000
         BNE   @RF00390                                            0390 00841000
*             ALLCOND=8;            /*                       @Y30LB11*/ 00842000
         LA    ALLCOND,8                                           0391 00843000
*           ELSE                    /*                       @Y30LB11*/ 00844000
*             ALLCOND=4;            /*                       @Y30LB11*/ 00845000
*                                                                  0392 00846000
         B     @RC00390                                            0392 00847000
@RF00390 LA    ALLCOND,4                                           0392 00848000
*         /***********************************************************/ 00849000
*         /*                                                         */ 00850000
*         /* THE NEXT COPY ID IS SET FOR THE NEXT ICBDEFV MACRO      */ 00851000
*         /* EXECUTION.                                      @Y30LB11*/ 00852000
*         /*                                                         */ 00853000
*         /***********************************************************/ 00854000
*                                                                  0393 00855000
*         RVVCPYID=COPNO;           /*                       @Y30LB11*/ 00856000
@RC00390 DS    0H                                                  0393 00857000
@RC00388 L     @01,RVVIPTR                                         0393 00858000
         MVC   RVVCPYID(1,@01),COPNO(COPYVPTR)                     0393 00859000
*       END;                        /*                       @Y30LB11*/ 00860000
*     ELSE                          /*                       @Y30LB11*/ 00861000
*                                                                  0395 00862000
*       /*************************************************************/ 00863000
*       /*                                                           */ 00864000
*       /* IF END OF FILE IS NOT REACHED, THE SSCMSG PROCEDURE IS    */ 00865000
*       /* CALLED TO ISSUE AN ERROR MSG CORRESPONDING TO THE REASON  */ 00866000
*       /* CODE THEN THE MESSAGE: ** COPY RECORDS FOR VOLUME (VOLSER)*/ 00867000
*       /* CANNOT BE RETRIEVED, IS WRITTEN.                  @Y30LB11*/ 00868000
*       /*                                                           */ 00869000
*       /*************************************************************/ 00870000
*                                                                  0395 00871000
*       IF REASONCD^=EOFILE THEN    /*                       @Y30LB11*/ 00872000
         B     @RC00382                                            0395 00873000
@RF00382 CLC   REASONCD(4),@CF01111                                0395 00874000
         BE    @RF00395                                            0395 00875000
*         DO;                       /*                       @Y30LB11*/ 00876000
*           CALL SSCMSG(REASONCD);  /*                       @Y30LB11*/ 00877000
         LA    @05,REASONCD                                        0397 00878000
         ST    @05,@AL00001                                        0397 00879000
         LA    @01,@AL00001                                        0397 00880000
         BAL   @14,SSCMSG                                          0397 00881000
*           DARGAREA=''B;           /*                       @Y30LB11*/ 00882000
         XC    DARGAREA(36),DARGAREA                               0398 00883000
*           DARGSMOD=COMMSG;        /*                       @Y30LB11*/ 00884000
         L     @15,DDSTRU                                          0399 00885000
         MVC   DARGSMOD(3,@15),@CC01105                            0399 00886000
*           DARGSENT=MSG2078I;      /*                       @Y30LB11*/ 00887000
         MVI   DARGSENT(@15),X'1C'                                 0400 00888000
*           DARGDBP=ADDR(RVVOLUME); /*                       @Y30LB11*/ 00889000
         L     @01,RVVIPTR                                         0401 00890000
         LA    @14,RVVOLUME(,@01)                                  0401 00891000
         ST    @14,DARGDBP(,@15)                                   0401 00892000
*           DARGILP=LENGTH(RVVOLUME);/*                      @Y30LB11*/ 00893000
         MVC   DARGILP(2,@15),@CH00150                             0402 00894000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/ 00895000
*                                                                  0403 00896000
         L     @15,@PC00001                                        0403 00897000
         ST    @15,@AL00001                                        0403 00898000
         LA    @14,@CF00111                                        0403 00899000
         ST    @14,@AL00001+4                                      0403 00900000
         LA    @14,DDSTRU                                          0403 00901000
         ST    @14,@AL00001+8                                      0403 00902000
         MVI   @AL00001+8,X'80'                                    0403 00903000
         L     @15,GDTPRT(,@15)                                    0403 00904000
         LA    @01,@AL00001                                        0403 00905000
         BALR  @14,@15                                             0403 00906000
*           /*********************************************************/ 00907000
*           /*                                                       */ 00908000
*           /* SET THE CONDITION CODE TO RCFAIL TO TERMINATE THE LOOP*/ 00909000
*           /* OF SCRATCHING COPIES.                         @Y30LB11*/ 00910000
*           /*                                                       */ 00911000
*           /*********************************************************/ 00912000
*                                                                  0404 00913000
*           ALLCOND=4;              /*                       @Y30LB11*/ 00914000
         LA    ALLCOND,4                                           0404 00915000
*         END;                      /*                       @Y30LB11*/ 00916000
*   END;                            /*                       @Y30LB11*/ 00917000
@RF00395 DS    0H                                                  0406 00918000
@RC00382 DS    0H                                                  0406 00919000
@DE00377 C     ALLCOND,@CF00041                                    0406 00920000
         BE    @DC00377                                            0406 00921000
         CLC   REASONCD(4),@CF01111                                0406 00922000
         BNE   @DL00377                                            0406 00923000
@DC00377 DS    0H                                                  0407 00924000
*                                                                  0407 00925000
*   /*****************************************************************/ 00926000
*   /*                                                               */ 00927000
*   /* FINALLY, IF THE RETURN CODE IS NOT 0 THEN THE FINAL RETURN    */ 00928000
*   /* CODE IS SET TO 4.                                     @Y30LB11*/ 00929000
*   /*                                                               */ 00930000
*   /*****************************************************************/ 00931000
*                                                                  0407 00932000
*   IF ALLCOND^=0 THEN              /*                       @Y30LB11*/ 00933000
         LTR   ALLCOND,ALLCOND                                     0407 00934000
         BZ    @RF00407                                            0407 00935000
*     ALLCOND=4;                    /*                       @Y30LB11*/ 00936000
*                                                                  0408 00937000
         LA    ALLCOND,4                                           0408 00938000
*   /*****************************************************************/ 00939000
*   /*                                                               */ 00940000
*   /* RETURN IS MADE TO IDCSV01.                            @Y30LB11*/ 00941000
*   /*                                                               */ 00942000
*   /*****************************************************************/ 00943000
*                                                                  0409 00944000
*   RETURN CODE(ALLCOND);           /*                       @Y30LB11*/ 00945000
@RF00407 LR    @15,ALLCOND                                         0409 00946000
         L     @14,@SA00002                                        0409 00947000
         LM    @00,@12,@SA00002+8                                  0409 00948000
         BR    @14                                                 0409 00949000
*   END ALLCOPY;                    /*                       @Y30LB11*/ 00950000
*                                                                  0411 00951000
*/********************************************************************/ 00952000
*/*                                                          @Y30LB11*/ 00953000
*/* PROCEDURE NAME - BASECHK                                 @Y30LB11*/ 00954000
*/*                                                          @Y30LB11*/ 00955000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO READ       @Y30LB11*/ 00956000
*/*            THE BASE VOLUME RECORD AND TO CALL THE        @Y30LB11*/ 00957000
*/*            CHKVTOC AND UNITCHK ROUTINES.                 @Y30LB11*/ 00958000
*/*                                                          @Y30LB11*/ 00959000
*/*            IDC3095I VOLUME (VOLSER) WAS INCOMPLETELY     @Y30LB11*/ 00960000
*/*            RENAMED IN A PRIOR OPERATION.                 @Y30LB11*/ 00961000
*/*                                                          @Y30LB11*/ 00962000
*/*            IDC2080I ** RECORD FOR VOL (VOLSER) CANNOT    @Y30LB11*/ 00963000
*/*            BE RETRIEVED FROM INVENTORY.                  @Y30LB11*/ 00964000
*/*                                                          @Y30LB11*/ 00965000
*/*            IDC3074I VOLUME (VOLSER) NOT ACTIVE           @Y30LB11*/ 00966000
*/*                                                          @Y30LB11*/ 00967000
*/* INPUT - THE RVVI MAPPING MACRO IS INITIALIZED AND USED   @Y30LB11*/ 00968000
*/*         AS INPUT TO READ THE BASEV RECORD.               @Y30LB11*/ 00969000
*/*                                                          @Y30LB11*/ 00970000
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15          @Y30LB11*/ 00971000
*/*                                                          @Y30LB11*/ 00972000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 00973000
*/*                                                          @Y30LB11*/ 00974000
*/*              MISMATCH FLAG WAS SET, OR UNIT CHECK        @Y30LB11*/ 00975000
*/*              FAILED, OR VTOC WAS NOT EMPTY, OR BASE      @Y30LB11*/ 00976000
*/*              VOLUME IS INACTIVE AND NOT INCOMPLETELY     @Y30LB11*/ 00977000
*/*              CREATED.                                    @Y30LB11*/ 00978000
*/*                                                          @Y30LB11*/ 00979000
*/********************************************************************/ 00980000
*                                                                  0411 00981000
*BASECHK:                           /*                       @Y30LB11*/ 00982000
*   PROC;                           /*                       @Y30LB11*/ 00983000
BASECHK  STM   @14,@12,@SA00003                                    0411 00984000
*   DCL                                                            0412 00985000
*     BCHKCOND FIXED(15);           /*                       @Y30LB11*/ 00986000
*                                                                  0413 00987000
*   /*****************************************************************/ 00988000
*   /*                                                               */ 00989000
*   /* BASECHK RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/ 00990000
*   /*                                                               */ 00991000
*   /*****************************************************************/ 00992000
*                                                                  0413 00993000
*   BCHKCOND=0;                     /*                       @Y30LB11*/ 00994000
*                                                                  0413 00995000
         SLR   @15,@15                                             0413 00996000
         LR    BCHKCOND,@15                                        0413 00997000
*   /*****************************************************************/ 00998000
*   /*                                                               */ 00999000
*   /* TRACE AT ENTRY TO BASECHK PROCEDURE                   @Y30LB11*/ 01000000
*   /*                                                               */ 01001000
*   /*****************************************************************/ 01002000
*                                                                  0414 01003000
*   OLDERID2=NEWERID2;                                             0414 01004000
         L     @14,@PC00001                                        0414 01005000
         L     @09,GDTTR2(,@14)                                    0414 01006000
         MVC   @TS00001(95),NEWERID2(@09)                          0414 01007000
         MVC   OLDERID2(95,@09),@TS00001                           0414 01008000
*   NEWID2='SVBC';                  /*                       @Y30LB11*/ 01009000
*                                                                  0415 01010000
         MVC   NEWID2(4,@09),@CC01197                              0415 01011000
*   /*****************************************************************/ 01012000
*   /*                                                               */ 01013000
*   /* INITIALIZE RVVI VARIABLES FOR READING BASEV RECORD    @Y30LB11*/ 01014000
*   /*                                                               */ 01015000
*   /*****************************************************************/ 01016000
*                                                                  0416 01017000
*   RVVBVRCD=ON;                    /*                       @Y30LB11*/ 01018000
         L     @09,RVVIPTR                                         0416 01019000
         OI    RVVBVRCD(@09),B'10000000'                           0416 01020000
*   RVVRDR=ON;                      /*                       @Y30LB11*/ 01021000
         OI    RVVRDR(@09),B'10000000'                             0417 01022000
*   RVVRTBUF=BASEVPTR;              /*                       @Y30LB11*/ 01023000
         ST    BASEVPTR,RVVRTBUF(,@09)                             0418 01024000
*   RVVBUFLN=LENGTH(BASEAREA);      /*                       @Y30LB11*/ 01025000
*                                                                  0419 01026000
         MVC   RVVBUFLN(2,@09),@CH01287                            0419 01027000
*   /*****************************************************************/ 01028000
*   /*                                                               */ 01029000
*   /* DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO     @Y30LB11*/ 01030000
*   /*                                                               */ 01031000
*   /*****************************************************************/ 01032000
*                                                                  0420 01033000
*   IF GDTDBG=NULLPTR THEN                                         0420 01034000
         C     @15,GDTDBG(,@14)                                    0420 01035000
         BE    @RT00420                                            0420 01036000
*     ;                                                            0421 01037000
*   ELSE                                                           0422 01038000
*     DO;                                                          0422 01039000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/ 01040000
         LA    DMPINDEX,DUMPAREA                                   0423 01041000
*       DMPITMNM='RVVI';                                           0424 01042000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0424 01043000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0424 01044000
         MVC   DMPITMNM(4,DMPINDEX),@CC01188                       0424 01045000
*       DMPITMPT=ADDR(RVVI);                                       0425 01046000
         L     @03,RVVIPTR                                         0425 01047000
         ST    @03,DMPITMPT(,DMPINDEX)                             0425 01048000
*       DMPITMLN=LENGTH(RVVI);                                     0426 01049000
         MVC   DMPITMLN(2,DMPINDEX),@CH01286                       0426 01050000
*       DMPITMTP='H';                                              0427 01051000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0427 01052000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0428 01053000
*                                                                  0428 01054000
         AL    DMPINDEX,@CF00464                                   0428 01055000
*       /*************************************************************/ 01056000
*       /*                                                           */ 01057000
*       /*                                                   @Y30LB11*/ 01058000
*       /*                                                           */ 01059000
*       /*************************************************************/ 01060000
*                                                                  0429 01061000
*       DMPTRM=DMPTRMVL;                                           0429 01062000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0429 01063000
*     END;                          /*                       @Y30LB11*/ 01064000
*   IF GDTDBG=NULLPTR THEN                                         0431 01065000
@RT00420 L     @15,@PC00001                                        0431 01066000
         L     @15,GDTDBG(,@15)                                    0431 01067000
         LTR   @15,@15                                             0431 01068000
         BZ    @RT00431                                            0431 01069000
*     ;                                                            0432 01070000
*   ELSE                                                           0433 01071000
*     CALL IDCDB010(GDTTBL,'SVRB',ADDR(DUMPAREA));/*         @Y30LB11*/ 01072000
*                                                                  0433 01073000
         L     @15,@PC00001                                        0433 01074000
         ST    @15,@AL00001                                        0433 01075000
         LA    @14,@CC01198                                        0433 01076000
         ST    @14,@AL00001+4                                      0433 01077000
         LA    @14,DUMPAREA                                        0433 01078000
         ST    @14,@AFTEMPS+4                                      0433 01079000
         LA    @14,@AFTEMPS+4                                      0433 01080000
         ST    @14,@AL00001+8                                      0433 01081000
         MVI   @AL00001+8,X'80'                                    0433 01082000
         L     @15,GDTDBG(,@15)                                    0433 01083000
         LA    @01,@AL00001                                        0433 01084000
         BALR  @14,@15                                             0433 01085000
*   /*****************************************************************/ 01086000
*   /*                                                               */ 01087000
*   /* USSC MACRO TO GET BASEV RECORD                        @Y30LB11*/ 01088000
*   /*                                                               */ 01089000
*   /*****************************************************************/ 01090000
*                                                                  0434 01091000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB11*/ 01092000
@RT00431 L     @02,@PC00001                                        0434 01093000
         ST    @02,@AL00001                                        0434 01094000
         LA    @15,VVIC                                            0434 01095000
         ST    @15,@AL00001+4                                      0434 01096000
         LA    @15,RVVIPTR                                         0434 01097000
         ST    @15,@AL00001+8                                      0434 01098000
         LA    @15,REASONCD                                        0434 01099000
         ST    @15,@AL00001+12                                     0434 01100000
         MVI   @AL00001+12,X'80'                                   0434 01101000
         L     @15,GDTSSC(,@02)                                    0434 01102000
         LA    @01,@AL00001                                        0434 01103000
         BALR  @14,@15                                             0434 01104000
*   RESPECIFY                                                      0435 01105000
*     RTNREG RSTD;                                                 0435 01106000
*   TESTRC=RTNREG;                                                 0436 01107000
         LR    TESTRC,RTNREG                                       0436 01108000
*   RESPECIFY                                                      0437 01109000
*     RTNREG UNRSTD;                /*                       @Y30LB11*/ 01110000
*                                                                  0438 01111000
*   /*****************************************************************/ 01112000
*   /*                                                               */ 01113000
*   /* IF THE READ WAS SUCCESSFUL FIELDS WITHIN THE BASE     @Y30LB11*/ 01114000
*   /* VOLUME RECORD ARE CHECKED IN ORDER TO CALL THE        @Y30LB11*/ 01115000
*   /* UNITCHK PROCEDURE.                                    @Y30LB11*/ 01116000
*   /*                                                               */ 01117000
*   /*****************************************************************/ 01118000
*                                                                  0438 01119000
*   IF TESTRC=0 THEN                /*                       @Y30LB11*/ 01120000
         LTR   TESTRC,TESTRC                                       0438 01121000
         BNZ   @RF00438                                            0438 01122000
*     DO;                           /*                       @Y30LB11*/ 01123000
*                                                                  0439 01124000
*       /*************************************************************/ 01125000
*       /*                                                           */ 01126000
*       /* IF THE VOLUME IS ACTIVE, THE RECOVERY AND MISMATCH FLAGS  */ 01127000
*       /* ARE TESTED AND THE UNIT AND VTOC ARE CHECKED.     @Y30LB11*/ 01128000
*       /*                                                           */ 01129000
*       /*************************************************************/ 01130000
*                                                                  0440 01131000
*       IF BASINAC=OFF THEN         /*                       @Y30LB11*/ 01132000
         TM    BASINAC(BASEVPTR),B'00000100'                       0440 01133000
         BNZ   @RF00440                                            0440 01134000
*         DO;                       /*                       @Y30LB11*/ 01135000
*                                                                  0441 01136000
*           /*********************************************************/ 01137000
*           /*                                                       */ 01138000
*           /* IF ANY RECOVERY FLAGS ARE ON, THE NOVTOCCK FLAG IS SET*/ 01139000
*           /* FOR USE BY THE UNITCHK PROCEDURE.             @Y30LB11*/ 01140000
*           /*                                                       */ 01141000
*           /*********************************************************/ 01142000
*                                                                  0442 01143000
*           IF BASSATIA^=ZERO THEN  /*                       @Y30LB11*/ 01144000
         CLC   BASSATIA(2,BASEVPTR),ZERO                           0442 01145000
         BE    @RF00442                                            0442 01146000
*             NOVTOCCK=ON;          /*                       @Y30LB11*/ 01147000
*                                                                  0443 01148000
         OI    NOVTOCCK,B'00001000'                                0443 01149000
*           /*********************************************************/ 01150000
*           /*                                                       */ 01151000
*           /* IF THE MISMATCH FLAG IS ON, THE RETURN CODE IS SET TO */ 01152000
*           /* 4 AND THE MESSAGE: VOLUME (VOLSER) WAS INCOMPLETELY   */ 01153000
*           /* RENAMED IN A PRIOR OPERATION, IS WRITTEN.     @Y30LB11*/ 01154000
*           /*                                                       */ 01155000
*           /*********************************************************/ 01156000
*                                                                  0444 01157000
*           IF BASVSMIS=ON THEN     /*                       @Y30LB11*/ 01158000
@RF00442 TM    BASVSMIS(BASEVPTR),B'00100000'                      0444 01159000
         BNO   @RF00444                                            0444 01160000
*             DO;                   /*                       @Y30LB11*/ 01161000
*               BCHKCOND=4;         /*                       @Y30LB11*/ 01162000
         LA    BCHKCOND,4                                          0446 01163000
*               DARGAREA=''B;       /*                       @Y30LB11*/ 01164000
         XC    DARGAREA(36),DARGAREA                               0447 01165000
*               DARGSMOD=COMMSG;    /*                       @Y30LB11*/ 01166000
         L     @15,DDSTRU                                          0448 01167000
         MVC   DARGSMOD(3,@15),@CC01105                            0448 01168000
*               DARGDBP=ADDR(VOLVAL);/*                      @Y30LB11*/ 01169000
         L     @14,@PC00001+4                                      0449 01170000
         L     @01,FDTPTR(,@14)                                    0449 01171000
         LA    @14,VOLVAL(,@01)                                    0449 01172000
         ST    @14,DARGDBP(,@15)                                   0449 01173000
*               DARGILP=LENGTH(VOLVAL);/*                    @Y30LB11*/ 01174000
         MVC   DARGILP(2,@15),@CH00150                             0450 01175000
*               DARGSENT=MSG3095I;  /*                       @Y30LB11*/ 01176000
         MVI   DARGSENT(@15),X'09'                                 0451 01177000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB11*/ 01178000
         L     @15,@PC00001                                        0452 01179000
         ST    @15,@AL00001                                        0452 01180000
         LA    @14,@CF00111                                        0452 01181000
         ST    @14,@AL00001+4                                      0452 01182000
         LA    @14,DDSTRU                                          0452 01183000
         ST    @14,@AL00001+8                                      0452 01184000
         MVI   @AL00001+8,X'80'                                    0452 01185000
         L     @15,GDTPRT(,@15)                                    0452 01186000
         LA    @01,@AL00001                                        0452 01187000
         BALR  @14,@15                                             0452 01188000
*             END;                  /*                       @Y30LB11*/ 01189000
*                                                                  0453 01190000
*           /*********************************************************/ 01191000
*           /*                                                       */ 01192000
*           /* IF THE PREVIOUS STEP GAVE A GOOD CONDITION CODE       */ 01193000
*           /*                                               @Y30LB11*/ 01194000
*           /* THE UNITCHK PROCEDURE IS CALLED TO CHECK OR ASSIGN A  */ 01195000
*           /* UNIT.                                         @Y30LB11*/ 01196000
*           /*                                                       */ 01197000
*           /*********************************************************/ 01198000
*                                                                  0454 01199000
*           IF BCHKCOND=0 THEN      /*                       @Y30LB11*/ 01200000
@RF00444 LTR   BCHKCOND,BCHKCOND                                   0454 01201000
         BNZ   @RF00454                                            0454 01202000
*             DO;                   /*                       @Y30LB11*/ 01203000
*               CALL UNITCHK;       /*                       @Y30LB11*/ 01204000
         BAL   @14,UNITCHK                                         0456 01205000
*               RESPECIFY                                          0457 01206000
*                 RTNREG RSTD;                                     0457 01207000
*               TESTRC=RTNREG;                                     0458 01208000
         LR    TESTRC,RTNREG                                       0458 01209000
*               RESPECIFY                                          0459 01210000
*                 RTNREG UNRSTD;    /*                       @Y30LB11*/ 01211000
*                                                                  0459 01212000
*               /*****************************************************/ 01213000
*               /*                                                   */ 01214000
*               /* IF THE UNITCHK PROCEDURE WAS SUCCESSFUL THE       */ 01215000
*               /*                                           @Y30LB11*/ 01216000
*               /* NOVTOCCK FLAG IS INTERROGATED.            @Y30LB11*/ 01217000
*               /*                                                   */ 01218000
*               /*****************************************************/ 01219000
*                                                                  0460 01220000
*               IF TESTRC=0 THEN    /*                       @Y30LB11*/ 01221000
*                                                                  0460 01222000
         LTR   TESTRC,TESTRC                                       0460 01223000
         BNZ   @RF00460                                            0460 01224000
*                 /***************************************************/ 01225000
*                 /*                                                 */ 01226000
*                 /* IF THE NOVTOCCK FLAG IS OFF CHKVTOC IS CALLED TO*/ 01227000
*                 /* CHECK FOR AN EMPTY VTOC.                @Y30LB11*/ 01228000
*                 /*                                                 */ 01229000
*                 /***************************************************/ 01230000
*                                                                  0461 01231000
*                 IF NOVTOCCK=OFF THEN/*                     @Y30LB11*/ 01232000
         TM    NOVTOCCK,B'00001000'                                0461 01233000
         BNZ   @RF00461                                            0461 01234000
*                   DO;             /*                       @Y30LB11*/ 01235000
*                     CALL CHKVTOC; /*                       @Y30LB11*/ 01236000
         BAL   @14,CHKVTOC                                         0463 01237000
*                     RESPECIFY                                    0464 01238000
*                       RTNREG RSTD;                               0464 01239000
*                     TESTRC=RTNREG;                               0465 01240000
         LR    TESTRC,RTNREG                                       0465 01241000
*                     RESPECIFY                                    0466 01242000
*                       RTNREG UNRSTD;/*                     @Y30LB11*/ 01243000
*                                                                  0466 01244000
*                     /***********************************************/ 01245000
*                     /*                                             */ 01246000
*                     /* IF CHKVTOC FAILS, A FAILING RETURN CODE IS  */ 01247000
*                     /* SET.                                @Y30LB11*/ 01248000
*                     /*                                             */ 01249000
*                     /***********************************************/ 01250000
*                                                                  0467 01251000
*                     IF TESTRC=4 THEN/*                     @Y30LB11*/ 01252000
         LA    @02,4                                               0467 01253000
         CR    TESTRC,@02                                          0467 01254000
         BNE   @RF00467                                            0467 01255000
*                       BCHKCOND=4; /*                       @Y30LB11*/ 01256000
         LR    BCHKCOND,@02                                        0468 01257000
*                   END;            /*                       @Y30LB11*/ 01258000
*                 ELSE                                             0470 01259000
*                   ;               /*                       @Y30LB11*/ 01260000
*                                                                  0470 01261000
@RF00461 DS    0H                                                  0471 01262000
*               /*****************************************************/ 01263000
*               /*                                                   */ 01264000
*               /* IF THE UNITCHK PROC WAS NOT SUCCESSFUL, SET A     */ 01265000
*               /* FAILING CONDITION CODE.                   @Y30LB11*/ 01266000
*               /*                                                   */ 01267000
*               /*****************************************************/ 01268000
*                                                                  0471 01269000
*               ELSE                /*                       @Y30LB11*/ 01270000
*                 BCHKCOND=4;       /*                       @Y30LB11*/ 01271000
         B     @RC00460                                            0471 01272000
@RF00460 LA    BCHKCOND,4                                          0471 01273000
*             END;                  /*                       @Y30LB11*/ 01274000
*         END;                      /*                       @Y30LB11*/ 01275000
*                                                                  0473 01276000
*       /*************************************************************/ 01277000
*       /*                                                           */ 01278000
*       /* IF THE VOLUME IS INACTIVE WHILE THE INCOMPLETE CREATE FLAG*/ 01279000
*       /* IS OFF, THE MESSAGE: VOLUME (VOLSER) NOT ACTIVE, IS       */ 01280000
*       /* WRITTEN AND THE RETURN CODE IS SET TO 4.          @Y30LB11*/ 01281000
*       /*                                                           */ 01282000
*       /*************************************************************/ 01283000
*                                                                  0474 01284000
*       ELSE                        /*                       @Y30LB11*/ 01285000
*         IF BASIVCRE=OFF THEN      /*                       @Y30LB11*/ 01286000
         B     @RC00440                                            0474 01287000
@RF00440 TM    BASIVCRE(BASEVPTR),B'10000000'                      0474 01288000
         BNZ   @RF00474                                            0474 01289000
*           DO;                     /*                       @Y30LB11*/ 01290000
*             DARGAREA=''B;         /*                       @Y30LB11*/ 01291000
         XC    DARGAREA(36),DARGAREA                               0476 01292000
*             DARGSMOD=COMMSG;      /*                       @Y30LB11*/ 01293000
         L     @15,DDSTRU                                          0477 01294000
         MVC   DARGSMOD(3,@15),@CC01105                            0477 01295000
*             DARGDBP=ADDR(VOLVAL); /*                       @Y30LB11*/ 01296000
         L     @14,@PC00001+4                                      0478 01297000
         L     @01,FDTPTR(,@14)                                    0478 01298000
         LA    @14,VOLVAL(,@01)                                    0478 01299000
         ST    @14,DARGDBP(,@15)                                   0478 01300000
*             DARGILP=LENGTH(VOLVAL);/*                      @Y30LB11*/ 01301000
         MVC   DARGILP(2,@15),@CH00150                             0479 01302000
*             DARGSENT=MSG3074I;    /*                       @Y30LB11*/ 01303000
         MVI   DARGSENT(@15),X'20'                                 0480 01304000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB11*/ 01305000
         L     @15,@PC00001                                        0481 01306000
         ST    @15,@AL00001                                        0481 01307000
         LA    @14,@CF00111                                        0481 01308000
         ST    @14,@AL00001+4                                      0481 01309000
         LA    @14,DDSTRU                                          0481 01310000
         ST    @14,@AL00001+8                                      0481 01311000
         MVI   @AL00001+8,X'80'                                    0481 01312000
         L     @15,GDTPRT(,@15)                                    0481 01313000
         LA    @01,@AL00001                                        0481 01314000
         BALR  @14,@15                                             0481 01315000
*             BCHKCOND=4;           /*                       @Y30LB11*/ 01316000
         LA    BCHKCOND,4                                          0482 01317000
*           END;                    /*                       @Y30LB11*/ 01318000
*     END;                          /*                       @Y30LB11*/ 01319000
*                                                                  0485 01320000
*   /*****************************************************************/ 01321000
*   /*                                                               */ 01322000
*   /* IF THE VVIC READ WAS UNSUCCESSFUL, THE SSCMSG         @Y30LB11*/ 01323000
*   /* ROUTINE IS CALLED TO WRITE AN ERROR CORRESPONDING     @Y30LB11*/ 01324000
*   /* TO THE REASON CODE. THEN THE MESSAGE : **             @Y30LB11*/ 01325000
*   /* RECORD FOR VOL (VOLSER) CANNOT BE RETRIEVED           @Y30LB11*/ 01326000
*   /* FROM INVENTORY, IS WRITTEN TO THE SYSPRINT DATA       @Y30LB11*/ 01327000
*   /* SET AND A RETURN CODE OF 4 IS SET.                    @Y30LB11*/ 01328000
*   /*                                                               */ 01329000
*   /*****************************************************************/ 01330000
*                                                                  0485 01331000
*   ELSE                            /*                       @Y30LB11*/ 01332000
*     DO;                           /*                       @Y30LB11*/ 01333000
         B     @RC00438                                            0485 01334000
@RF00438 DS    0H                                                  0486 01335000
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB11*/ 01336000
         LA    @04,REASONCD                                        0486 01337000
         ST    @04,@AL00001                                        0486 01338000
         LA    @01,@AL00001                                        0486 01339000
         BAL   @14,SSCMSG                                          0486 01340000
*       DARGAREA=''B;               /*                       @Y30LB11*/ 01341000
         XC    DARGAREA(36),DARGAREA                               0487 01342000
*       DARGSMOD=COMMSG;            /*                       @Y30LB11*/ 01343000
         L     @15,DDSTRU                                          0488 01344000
         MVC   DARGSMOD(3,@15),@CC01105                            0488 01345000
*       DARGSENT=MSG2080I;          /*                       @Y30LB11*/ 01346000
         MVI   DARGSENT(@15),X'1A'                                 0489 01347000
*       DARGDBP=ADDR(VOLVAL);       /*                       @Y30LB11*/ 01348000
         L     @14,@PC00001+4                                      0490 01349000
         L     @01,FDTPTR(,@14)                                    0490 01350000
         LA    @14,VOLVAL(,@01)                                    0490 01351000
         ST    @14,DARGDBP(,@15)                                   0490 01352000
*       DARGILP=LENGTH(VOLVAL);     /*                       @Y30LB11*/ 01353000
         MVC   DARGILP(2,@15),@CH00150                             0491 01354000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB11*/ 01355000
         L     @15,@PC00001                                        0492 01356000
         ST    @15,@AL00001                                        0492 01357000
         LA    @14,@CF00111                                        0492 01358000
         ST    @14,@AL00001+4                                      0492 01359000
         LA    @14,DDSTRU                                          0492 01360000
         ST    @14,@AL00001+8                                      0492 01361000
         MVI   @AL00001+8,X'80'                                    0492 01362000
         L     @15,GDTPRT(,@15)                                    0492 01363000
         LA    @01,@AL00001                                        0492 01364000
         BALR  @14,@15                                             0492 01365000
*       BCHKCOND=4;                 /*                       @Y30LB11*/ 01366000
         LA    BCHKCOND,4                                          0493 01367000
*     END;                          /*                       @Y30LB11*/ 01368000
*                                                                  0494 01369000
*   /*****************************************************************/ 01370000
*   /*                                                               */ 01371000
*   /* RETURN TO IDCSV01                                     @Y30LB11*/ 01372000
*   /*                                                               */ 01373000
*   /*****************************************************************/ 01374000
*                                                                  0495 01375000
*   RETURN CODE(BCHKCOND);          /*                       @Y30LB11*/ 01376000
@RC00438 LR    @15,BCHKCOND                                        0495 01377000
         L     @14,@SA00003                                        0495 01378000
         LM    @00,@12,@SA00003+8                                  0495 01379000
         BR    @14                                                 0495 01380000
*   END BASECHK;                    /*                       @Y30LB11*/ 01381000
*                                                                  0497 01382000
*/********************************************************************/ 01383000
*/*                                                          @Y30LB11*/ 01384000
*/* PROCEDURE NAME - BASEPROC                                @Y30LB11*/ 01385000
*/*                                                          @Y30LB11*/ 01386000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO SCRATCH    @Y30LB11*/ 01387000
*/*            THE BASE VOLUME AND ITS INVENTORY RECORD.     @Y30LB11*/ 01388000
*/*                                                          @Y30LB11*/ 01389000
*/*            IDC2752I ** CARTS CSN (CSN) NOT SCRATCHED FOR @Y30LB11*/ 01390000
*/*            (VOLSER).                                     @Y30LB11*/ 01391000
*/*                                                          @Y30LB11*/ 01392000
*/*            IDC0751I CARTS CSN (CSN) SCRATCHED FOR VOLUME @Y30LB11*/ 01393000
*/*            (VOLSER).                                     @Y30LB11*/ 01394000
*/*                                                          @Y30LB11*/ 01395000
*/* INPUT - THE MDAGL MAPPING MACRO IS INITIALIZED WITH      @Y30LB11*/ 01396000
*/*         THE DDNAME.  THE ARGUMENT LIST FOR ICBDEFV IS    @Y30LB11*/ 01397000
*/*         INITIALIZED WITH VOLUME SERIAL NUMBER.  THE BASE @Y30LB11*/ 01398000
*/*         VOLUME RECORD HAS BEEN READ.                     @Y30LB11*/ 01399000
*/*                                                          @Y30LB11*/ 01400000
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15          @Y30LB11*/ 01401000
*/*                                                          @Y30LB11*/ 01402000
*/*                                                          @Y30LB11*/ 01403000
*/*          4 - VOLUME WAS NOT SCRATCHED SUCCESSFULLY,      @Y30LB11*/ 01404000
*/*              VOLUME COULD NOT BE DEMOUNTED, OR VOLUME    @Y30LB11*/ 01405000
*/*              COULD NOT BE SCRATCHED, OR USSC UMACRO      @Y30LB11*/ 01406000
*/*              COULD NOT OBTAIN STORAGE FOR ECB/MESSAGE    @Y30LB11*/ 01407000
*/********************************************************************/ 01408000
*                                                                  0497 01409000
*BASEPROC:                                                         0497 01410000
*   PROC;                           /*                       @Y30LB11*/ 01411000
BASEPROC STM   @14,@12,@SA00004                                    0497 01412000
*   DCL                                                            0498 01413000
*     BPROCOND FIXED(15);           /*                       @Y30LB11*/ 01414000
*                                                                  0499 01415000
*   /*****************************************************************/ 01416000
*   /*                                                               */ 01417000
*   /* TRACE AT ENTRY TO BASEPROC PROCEDURE                  @Y30LB11*/ 01418000
*   /*                                                               */ 01419000
*   /*****************************************************************/ 01420000
*                                                                  0499 01421000
*   OLDERID2=NEWERID2;                                             0499 01422000
         L     @15,@PC00001                                        0499 01423000
         L     @14,GDTTR2(,@15)                                    0499 01424000
         MVC   @TS00001(95),NEWERID2(@14)                          0499 01425000
         MVC   OLDERID2(95,@14),@TS00001                           0499 01426000
*   NEWID2='SVBP';                  /*                       @Y30LB11*/ 01427000
*                                                                  0500 01428000
         MVC   NEWID2(4,@14),@CC01205                              0500 01429000
*   /*****************************************************************/ 01430000
*   /*                                                               */ 01431000
*   /* BASEPROC RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/ 01432000
*   /*                                                               */ 01433000
*   /*****************************************************************/ 01434000
*                                                                  0501 01435000
*   BPROCOND=0;                     /*                       @Y30LB11*/ 01436000
         SLR   BPROCOND,BPROCOND                                   0501 01437000
*                                                                  0502 01438000
*   /*****************************************************************/ 01439000
*   /*                                                               */ 01440000
*   /* CHECK IF DDNAME ALLOCATED IN MDAGL. IF SO, ISSUE      @Y30LB11*/ 01441000
*   /* THE UMSSUNIT MACRO TO DEMOUNT THE VOLUME ON THAT UNIT.@Y30LB11*/ 01442000
*   /*                                                               */ 01443000
*   /*****************************************************************/ 01444000
*                                                                  0502 01445000
*   IF MDDDNAME^=Z8 THEN            /*                       @Y30LB11*/ 01446000
         LA    @14,MDAGAREA                                        0502 01447000
         CLC   MDDDNAME(8,@14),Z8                                  0502 01448000
         BE    @RF00502                                            0502 01449000
*     DO;                           /*                       @Y30LB11*/ 01450000
*       MDLABEL=VOLVAL;             /*                       @Y30LB11*/ 01451000
         L     @02,@PC00001+4                                      0504 01452000
         L     @02,FDTPTR(,@02)                                    0504 01453000
         MVC   MDLABEL(6,@14),VOLVAL(@02)                          0504 01454000
*       MDUCBPTR=ADDR(UCBPTR);      /*                       @Y30LB11*/ 01455000
         LA    @02,UCBPTR                                          0505 01456000
         ST    @02,MDUCBPTR(,@14)                                  0505 01457000
*       MDWAIT=ON;                  /*                       @Y30LB11*/ 01458000
*       MDDEQ=ON;                   /*                       @YD00175*/ 01459000
         OI    MDWAIT(@14),B'00010100'                             0507 01460000
*       CALL IDCSA060(GDTTBL,DEMOUNT,MDAGL);/*               @Y30LB11*/ 01461000
         ST    @15,@AL00001                                        0508 01462000
         LA    @02,DEMOUNT                                         0508 01463000
         ST    @02,@AL00001+4                                      0508 01464000
         ST    @14,@AL00001+8                                      0508 01465000
         MVI   @AL00001+8,X'80'                                    0508 01466000
         L     @15,GDTUNT(,@15)                                    0508 01467000
         LA    @01,@AL00001                                        0508 01468000
         BALR  @14,@15                                             0508 01469000
*       RESPECIFY                                                  0509 01470000
*         RTNREG RSTD;                                             0509 01471000
*       TESTRC=RTNREG;                                             0510 01472000
         LR    TESTRC,RTNREG                                       0510 01473000
*       RESPECIFY                                                  0511 01474000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 01475000
*                                                                  0511 01476000
*       /*************************************************************/ 01477000
*       /*                                                           */ 01478000
*       /* IF DEMOUNT WAS NOT SUCCESSFUL, THE MESSAGE:       @Y30LB11*/ 01479000
*       /* ** CARTS CSN (CSN) NOT SCRATCHED FOR (VOLSER),    @Y30LB11*/ 01480000
*       /* IS WRITTEN TO THE SYSPRINT DATA SET.              @Y30LB11*/ 01481000
*       /*                                                           */ 01482000
*       /*************************************************************/ 01483000
*                                                                  0512 01484000
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/ 01485000
         C     TESTRC,@CF00041                                     0512 01486000
         BNE   @RF00512                                            0512 01487000
*         DO;                       /*                       @Y30LB11*/ 01488000
*           DARGAREA=''B;           /*                       @Y30LB11*/ 01489000
         XC    DARGAREA(36),DARGAREA                               0514 01490000
*           DARGSMOD=SCRTCHMG;      /*                       @Y30LB11*/ 01491000
         L     @15,DDSTRU                                          0515 01492000
         MVC   DARGSMOD(3,@15),@CC01131                            0515 01493000
*           DARGSENT=MSG2752I;      /*                       @Y30LB11*/ 01494000
         MVI   DARGSENT(@15),X'03'                                 0516 01495000
*           DARGDBP=ADDR(BASCSN1);  /*                       @Y30LB11*/ 01496000
         LA    @14,BASCSN1(,BASEVPTR)                              0517 01497000
         ST    @14,DARGDBP(,@15)                                   0517 01498000
*           DARGILP=LENGTH(BASCSN1);/*                       @Y30LB11*/ 01499000
         LA    @14,12                                              0518 01500000
         STH   @14,DARGILP(,@15)                                   0518 01501000
*           DARGCNT=2;              /*                       @Y30LB11*/ 01502000
         LA    @09,2                                               0519 01503000
         STH   @09,DARGCNT(,@15)                                   0519 01504000
*           DARGINS(1)=CSN2INS#;    /*                       @Y30LB11*/ 01505000
         MVC   DARGINS(2,@15),@CH00213                             0520 01506000
*           DARGINL(1)=LENGTH(BASCSN2);/*                    @Y30LB11*/ 01507000
         STH   @14,DARGINL(,@15)                                   0521 01508000
*           DARGDTM(1)=ADDR(BASCSN2);/*                      @Y30LB11*/ 01509000
         LA    @14,BASCSN2(,BASEVPTR)                              0522 01510000
         ST    @14,DARGDTM(,@15)                                   0522 01511000
*           DARGINS(2)=VOLINS#;     /*                       @Y30LB11*/ 01512000
         STH   @09,DARGINS+8(,@15)                                 0523 01513000
*           DARGINL(2)=LENGTH(VOLVAL);/*                     @Y30LB11*/ 01514000
         MVC   DARGINL+8(2,@15),@CH00150                           0524 01515000
*           DARGDTM(2)=ADDR(VOLVAL);/*                       @Y30LB11*/ 01516000
         L     @14,@PC00001+4                                      0525 01517000
         L     @01,FDTPTR(,@14)                                    0525 01518000
         LA    @14,VOLVAL(,@01)                                    0525 01519000
         ST    @14,DARGDTM+8(,@15)                                 0525 01520000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/ 01521000
*                                                                  0526 01522000
         L     @15,@PC00001                                        0526 01523000
         ST    @15,@AL00001                                        0526 01524000
         LA    @14,@CF00111                                        0526 01525000
         ST    @14,@AL00001+4                                      0526 01526000
         LA    @14,DDSTRU                                          0526 01527000
         ST    @14,@AL00001+8                                      0526 01528000
         MVI   @AL00001+8,X'80'                                    0526 01529000
         L     @15,GDTPRT(,@15)                                    0526 01530000
         LA    @01,@AL00001                                        0526 01531000
         BALR  @14,@15                                             0526 01532000
*           /*********************************************************/ 01533000
*           /*                                                       */ 01534000
*           /* SET RETURN CODE TO RCFAIL                     @Y30LB11*/ 01535000
*           /*                                                       */ 01536000
*           /*********************************************************/ 01537000
*                                                                  0527 01538000
*           BPROCOND=4;             /*                       @Y30LB11*/ 01539000
         LA    BPROCOND,4                                          0527 01540000
*         END;                      /*                       @Y30LB11*/ 01541000
*     END;                          /*                       @Y30LB11*/ 01542000
@RF00512 DS    0H                                                  0530 01543000
*                                                                  0530 01544000
*   /*****************************************************************/ 01545000
*   /*                                                               */ 01546000
*   /* CHECK THE RETURN CODE. IF RCOK, SCRATCH THE VOLUME.   @Y30LB11*/ 01547000
*   /*                                                               */ 01548000
*   /*****************************************************************/ 01549000
*                                                                  0530 01550000
*   IF BPROCOND=0 THEN              /*                       @Y30LB11*/ 01551000
@RF00502 LTR   BPROCOND,BPROCOND                                   0530 01552000
         BNZ   @RF00530                                            0530 01553000
*     DO;                           /*                       @Y30LB11*/ 01554000
*                                                                  0531 01555000
*       /*************************************************************/ 01556000
*       /*                                                           */ 01557000
*       /* IF THE VOLUME IS ACTIVE, DEFVELM IS SET TO SCRATCH AN     */ 01558000
*       /* ACTIVE VOLUME. OTHERWISE, DEFLIST IS SET TO SCRATCH A     */ 01559000
*       /* TRANSIENT VOLUME.                                 @Y30LB11*/ 01560000
*       /*                                                           */ 01561000
*       /*************************************************************/ 01562000
*                                                                  0532 01563000
*       IF BASINAC=OFF THEN         /*                       @Y30LB11*/ 01564000
         TM    BASINAC(BASEVPTR),B'00000100'                       0532 01565000
         BNZ   @RF00532                                            0532 01566000
*         DEFVELM=ON;               /*                       @Y30LB11*/ 01567000
         L     @01,DEFLPTR                                         0533 01568000
         OI    DEFVELM(@01),B'01000000'                            0533 01569000
*       ELSE                        /*                       @Y30LB11*/ 01570000
*         DO;                       /*                       @Y30LB11*/ 01571000
         B     @RC00532                                            0534 01572000
@RF00532 DS    0H                                                  0535 01573000
*           DEFVCSN1=BASCSN1;       /*                       @Y30LB11*/ 01574000
         L     @15,DEFLPTR                                         0535 01575000
         MVC   DEFVCSN1(12,@15),BASCSN1(BASEVPTR)                  0535 01576000
*           DEFVELTR=ON;            /*                       @Y30LB11*/ 01577000
         OI    DEFVELTR(@15),B'00001000'                           0536 01578000
*         END;                      /*                       @Y30LB11*/ 01579000
*                                                                  0537 01580000
*       /*************************************************************/ 01581000
*       /*                                                           */ 01582000
*       /* SYMBOLIC DUMP OF INITIALIZED PARM LIST FOR        @Y30LB11*/ 01583000
*       /* DEFINE MACRO.                                     @Y30LB11*/ 01584000
*       /*                                                           */ 01585000
*       /*************************************************************/ 01586000
*                                                                  0538 01587000
*       IF GDTDBG=NULLPTR THEN                                     0538 01588000
@RC00532 L     @15,@PC00001                                        0538 01589000
         L     @15,GDTDBG(,@15)                                    0538 01590000
         LTR   @15,@15                                             0538 01591000
         BZ    @RT00538                                            0538 01592000
*         ;                                                        0539 01593000
*       ELSE                                                       0540 01594000
*         DO;                                                      0540 01595000
*           DMPINDEX=ADDR(DUMPAREA);/*                       @Y30LB11*/ 01596000
         LA    DMPINDEX,DUMPAREA                                   0541 01597000
*           DMPITMNM='DEFLIST';                                    0542 01598000
         MVI   DMPITMNM+7(DMPINDEX),C' '                           0542 01599000
         MVC   DMPITMNM(7,DMPINDEX),@CC01206                       0542 01600000
*           DMPITMPT=ADDR(DEFLIST);                                0543 01601000
         L     @03,DEFLPTR                                         0543 01602000
         ST    @03,DMPITMPT(,DMPINDEX)                             0543 01603000
*           DMPITMLN=LENGTH(DEFLIST);                              0544 01604000
         MVC   DMPITMLN(2,DMPINDEX),@CH01288                       0544 01605000
*           DMPITMTP='H';                                          0545 01606000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0545 01607000
*           DMPINDEX=DMPINDEX+DMPELEMT;                            0546 01608000
*                                                                  0546 01609000
         AL    DMPINDEX,@CF00464                                   0546 01610000
*           /*********************************************************/ 01611000
*           /*                                                       */ 01612000
*           /*                                               @Y30LB11*/ 01613000
*           /*                                                       */ 01614000
*           /*********************************************************/ 01615000
*                                                                  0547 01616000
*           DMPTRM=DMPTRMVL;                                       0547 01617000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0547 01618000
*         END;                      /*                       @Y30LB11*/ 01619000
*       IF GDTDBG=NULLPTR THEN                                     0549 01620000
@RT00538 L     @15,@PC00001                                        0549 01621000
         L     @15,GDTDBG(,@15)                                    0549 01622000
         LTR   @15,@15                                             0549 01623000
         BZ    @RT00549                                            0549 01624000
*         ;                                                        0550 01625000
*       ELSE                                                       0551 01626000
*         CALL IDCDB010(GDTTBL,'SVSB',ADDR(DUMPAREA));/*     @Y30LB11*/ 01627000
*                                                                  0551 01628000
         L     @15,@PC00001                                        0551 01629000
         ST    @15,@AL00001                                        0551 01630000
         LA    @14,@CC01207                                        0551 01631000
         ST    @14,@AL00001+4                                      0551 01632000
         LA    @14,DUMPAREA                                        0551 01633000
         ST    @14,@AFTEMPS+8                                      0551 01634000
         LA    @14,@AFTEMPS+8                                      0551 01635000
         ST    @14,@AL00001+8                                      0551 01636000
         MVI   @AL00001+8,X'80'                                    0551 01637000
         L     @15,GDTDBG(,@15)                                    0551 01638000
         LA    @01,@AL00001                                        0551 01639000
         BALR  @14,@15                                             0551 01640000
*       /*************************************************************/ 01641000
*       /*                                                           */ 01642000
*       /* INVOKE THE ICBDEFV MACRO                          @Y30LB11*/ 01643000
*       /*                                                           */ 01644000
*       /*************************************************************/ 01645000
*                                                                  0552 01646000
*       CALL IDCSASS0(GDTTBL,DEFINE,DEFLPTR,REASONCD,ECBCODE,MSGPTR);   01647000
@RT00549 L     @02,@PC00001                                        0552 01648000
         ST    @02,@AL00001                                        0552 01649000
         LA    @15,DEFINE                                          0552 01650000
         ST    @15,@AL00001+4                                      0552 01651000
         LA    @15,DEFLPTR                                         0552 01652000
         ST    @15,@AL00001+8                                      0552 01653000
         LA    @15,REASONCD                                        0552 01654000
         ST    @15,@AL00001+12                                     0552 01655000
         LA    @15,ECBCODE                                         0552 01656000
         ST    @15,@AL00001+16                                     0552 01657000
         LA    @15,MSGPTR                                          0552 01658000
         ST    @15,@AL00001+20                                     0552 01659000
         MVI   @AL00001+20,X'80'                                   0552 01660000
         L     @15,GDTSSC(,@02)                                    0552 01661000
         LA    @01,@AL00001                                        0552 01662000
         BALR  @14,@15                                             0552 01663000
*       RESPECIFY                                                  0553 01664000
*         RTNREG RSTD;                                             0553 01665000
*       TESTRC=RTNREG;                                             0554 01666000
         LR    TESTRC,RTNREG                                       0554 01667000
*       RESPECIFY                                                  0555 01668000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 01669000
*                                                                  0555 01670000
*       /*************************************************************/ 01671000
*       /*                                                           */ 01672000
*       /* IF CARTRIDGES WERE SCRATCHED (RC=0 OR 12), HANDLE IT.     */ 01673000
*       /*                                                   @Y30LB11*/ 01674000
*       /*                                                           */ 01675000
*       /*************************************************************/ 01676000
*                                                                  0556 01677000
*       IF TESTRC=0|TESTRC=12 THEN  /*                       @Y30LB11*/ 01678000
         LTR   TESTRC,TESTRC                                       0556 01679000
         BZ    @RT00556                                            0556 01680000
         C     TESTRC,@CF00035                                     0556 01681000
         BNE   @RF00556                                            0556 01682000
@RT00556 DS    0H                                                  0557 01683000
*         DO;                       /*                       @Y30LB11*/ 01684000
*                                                                  0557 01685000
*           /*********************************************************/ 01686000
*           /*                                                       */ 01687000
*           /* IF THE RETURN CODE IS 12, THE VIERRFLG IS     @Y30LB11*/ 01688000
*           /* SET, THE MESSAGE: CARTS CSN (CSN) SCRATCHED FOR VOLUME*/ 01689000
*           /* (VOLSER), IS WRITTEN AND THE                  @Y30LB11*/ 01690000
*           /* UFSPACE UMACRO IS ISSUED TO FREE THE AREA     @Y30LB11*/ 01691000
*           /* OBTAINED FOR THE ECB/MESSAGE AREA.            @Y30LB11*/ 01692000
*           /*                                                       */ 01693000
*           /*********************************************************/ 01694000
*                                                                  0558 01695000
*           IF TESTRC=12 THEN       /*                       @Y30LB11*/ 01696000
         C     TESTRC,@CF00035                                     0558 01697000
         BNE   @RF00558                                            0558 01698000
*             VIERRFLG=ON;          /*                       @Y30LB11*/ 01699000
*                                                                  0559 01700000
         OI    VIERRFLG,B'10000000'                                0559 01701000
*           /*********************************************************/ 01702000
*           /*                                                       */ 01703000
*           /* SET UP DARGLIST TO PRINT MESSAGE: CARTS CSN (CSN)     */ 01704000
*           /* SCRATCHED FOR VOLUME (VOLSER).                @Y30LB11*/ 01705000
*           /*                                                       */ 01706000
*           /*********************************************************/ 01707000
*                                                                  0560 01708000
*           CMMSGPTR=MSGPTR+ECBLEN; /* ADDRESSABILITY TO USSC MSG  0560 01709000
*                                      AREA                  @Y30LB11*/ 01710000
@RF00558 LA    CMMSGPTR,4                                          0560 01711000
         AL    CMMSGPTR,MSGPTR                                     0560 01712000
*           DARGAREA=''B;           /*                       @Y30LB11*/ 01713000
         XC    DARGAREA(36),DARGAREA                               0561 01714000
*           DARGSMOD=SCRTCHMG;      /*                       @Y30LB11*/ 01715000
         L     @05,DDSTRU                                          0562 01716000
         MVC   DARGSMOD(3,@05),@CC01131                            0562 01717000
*           DARGSENT=MSG0751I;      /*                       @Y30LB11*/ 01718000
         MVI   DARGSENT(@05),X'02'                                 0563 01719000
*           DARGDBP=ADDR(CMCSN1);   /*                       @Y30LB11*/ 01720000
         LA    @03,CMCSN1(,CMMSGPTR)                               0564 01721000
         ST    @03,DARGDBP(,@05)                                   0564 01722000
*           DARGILP=LENGTH(CMCSN1); /*                       @Y30LB11*/ 01723000
         LA    @03,12                                              0565 01724000
         STH   @03,DARGILP(,@05)                                   0565 01725000
*           DARGCNT=2;              /*                       @Y30LB11*/ 01726000
         LA    @15,2                                               0566 01727000
         STH   @15,DARGCNT(,@05)                                   0566 01728000
*           DARGINS(1)=CSN2INS#;    /*                       @Y30LB11*/ 01729000
         MVC   DARGINS(2,@05),@CH00213                             0567 01730000
*           DARGINL(1)=LENGTH(CMCSN2);/*                     @Y30LB11*/ 01731000
         STH   @03,DARGINL(,@05)                                   0568 01732000
*           DARGDTM(1)=ADDR(CMCSN2);/*                       @Y30LB11*/ 01733000
         LA    @03,CMCSN2(,CMMSGPTR)                               0569 01734000
         ST    @03,DARGDTM(,@05)                                   0569 01735000
*           DARGINS(2)=VOLINS#;     /*                       @Y30LB11*/ 01736000
         STH   @15,DARGINS+8(,@05)                                 0570 01737000
*           DARGINL(2)=LENGTH(VOLVAL);/*                     @Y30LB11*/ 01738000
         MVC   DARGINL+8(2,@05),@CH00150                           0571 01739000
*           DARGDTM(2)=ADDR(VOLVAL);/*                       @Y30LB11*/ 01740000
         L     @15,@PC00001+4                                      0572 01741000
         L     @01,FDTPTR(,@15)                                    0572 01742000
         LA    @15,VOLVAL(,@01)                                    0572 01743000
         ST    @15,DARGDTM+8(,@05)                                 0572 01744000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/ 01745000
         L     @05,@PC00001                                        0573 01746000
         ST    @05,@AL00001                                        0573 01747000
         LA    @15,@CF00111                                        0573 01748000
         ST    @15,@AL00001+4                                      0573 01749000
         LA    @15,DDSTRU                                          0573 01750000
         ST    @15,@AL00001+8                                      0573 01751000
         MVI   @AL00001+8,X'80'                                    0573 01752000
         L     @15,GDTPRT(,@05)                                    0573 01753000
         LA    @01,@AL00001                                        0573 01754000
         BALR  @14,@15                                             0573 01755000
*           CALL IDCSAFS0(GDTTBL,MSGPTR);/*                  @Y30LB11*/ 01756000
         L     @05,@PC00001                                        0574 01757000
         ST    @05,@AL00001                                        0574 01758000
         LA    @15,MSGPTR                                          0574 01759000
         ST    @15,@AL00001+4                                      0574 01760000
         L     @15,GDTFSP(,@05)                                    0574 01761000
         LA    @01,@AL00001                                        0574 01762000
         BALR  @14,@15                                             0574 01763000
*         END;                      /*                       @Y30LB11*/ 01764000
*                                                                  0575 01765000
*       /*************************************************************/ 01766000
*       /*                                                           */ 01767000
*       /* IF CARTRIDGES WERE NOT SCRATCHED SUCCESSFULLY, HANDLE IT. */ 01768000
*       /*                                                   @Y30LB11*/ 01769000
*       /*                                                           */ 01770000
*       /*************************************************************/ 01771000
*                                                                  0576 01772000
*       ELSE                        /*                       @Y30LB11*/ 01773000
*         DO;                       /*                       @Y30LB11*/ 01774000
*                                                                  0576 01775000
         B     @RC00556                                            0576 01776000
@RF00556 DS    0H                                                  0577 01777000
*           /*********************************************************/ 01778000
*           /*                                                       */ 01779000
*           /* IF MSC FAILED, SSCMSG IS CALLED TO PRINT THE MESSAGE  */ 01780000
*           /* CORRESPONDING TO THE REASON CODE.             @Y30LB11*/ 01781000
*           /*                                                       */ 01782000
*           /*********************************************************/ 01783000
*                                                                  0577 01784000
*           IF TESTRC=4 THEN        /*                       @Y30LB11*/ 01785000
         C     TESTRC,@CF00041                                     0577 01786000
         BNE   @RF00577                                            0577 01787000
*             CALL SSCMSG(REASONCD);/*                       @Y30LB11*/ 01788000
*                                                                  0578 01789000
         LA    @04,REASONCD                                        0578 01790000
         ST    @04,@AL00001                                        0578 01791000
         LA    @01,@AL00001                                        0578 01792000
         BAL   @14,SSCMSG                                          0578 01793000
*           /*********************************************************/ 01794000
*           /*                                                       */ 01795000
*           /* PRINT THE MESSAGE: ** CARTS CSN (CSN)         @Y30LB11*/ 01796000
*           /* NOT SCRATCHED FOR (VOLSER).                   @Y30LB11*/ 01797000
*           /*                                                       */ 01798000
*           /*********************************************************/ 01799000
*                                                                  0579 01800000
*           DARGAREA=''B;           /*                       @Y30LB11*/ 01801000
@RF00577 XC    DARGAREA(36),DARGAREA                               0579 01802000
*           DARGSMOD=SCRTCHMG;      /*                       @Y30LB11*/ 01803000
         L     @15,DDSTRU                                          0580 01804000
         MVC   DARGSMOD(3,@15),@CC01131                            0580 01805000
*           DARGSENT=MSG2752I;      /*                       @Y30LB11*/ 01806000
         MVI   DARGSENT(@15),X'03'                                 0581 01807000
*           DARGDBP=ADDR(BASCSN1);  /*                       @Y30LB11*/ 01808000
         LA    @14,BASCSN1(,BASEVPTR)                              0582 01809000
         ST    @14,DARGDBP(,@15)                                   0582 01810000
*           DARGILP=LENGTH(BASCSN1);/*                       @Y30LB11*/ 01811000
         LA    @14,12                                              0583 01812000
         STH   @14,DARGILP(,@15)                                   0583 01813000
*           DARGCNT=2;              /*                       @Y30LB11*/ 01814000
         LA    @09,2                                               0584 01815000
         STH   @09,DARGCNT(,@15)                                   0584 01816000
*           DARGINS(1)=CSN2INS#;    /*                       @Y30LB11*/ 01817000
         MVC   DARGINS(2,@15),@CH00213                             0585 01818000
*           DARGINL(1)=LENGTH(BASCSN2);/*                    @Y30LB11*/ 01819000
         STH   @14,DARGINL(,@15)                                   0586 01820000
*           DARGDTM(1)=ADDR(BASCSN2);/*                      @Y30LB11*/ 01821000
         LA    @14,BASCSN2(,BASEVPTR)                              0587 01822000
         ST    @14,DARGDTM(,@15)                                   0587 01823000
*           DARGINS(2)=VOLINS#;     /*                       @Y30LB11*/ 01824000
         STH   @09,DARGINS+8(,@15)                                 0588 01825000
*           DARGINL(2)=LENGTH(VOLVAL);/*                     @Y30LB11*/ 01826000
         MVC   DARGINL+8(2,@15),@CH00150                           0589 01827000
*           DARGDTM(2)=ADDR(VOLVAL);/*                       @Y30LB11*/ 01828000
         L     @05,@PC00001+4                                      0590 01829000
         L     @05,FDTPTR(,@05)                                    0590 01830000
         LA    @05,VOLVAL(,@05)                                    0590 01831000
         ST    @05,DARGDTM+8(,@15)                                 0590 01832000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB11*/ 01833000
*                                                                  0591 01834000
         L     @05,@PC00001                                        0591 01835000
         ST    @05,@AL00001                                        0591 01836000
         LA    @15,@CF00111                                        0591 01837000
         ST    @15,@AL00001+4                                      0591 01838000
         LA    @15,DDSTRU                                          0591 01839000
         ST    @15,@AL00001+8                                      0591 01840000
         MVI   @AL00001+8,X'80'                                    0591 01841000
         L     @15,GDTPRT(,@05)                                    0591 01842000
         LA    @01,@AL00001                                        0591 01843000
         BALR  @14,@15                                             0591 01844000
*           /*********************************************************/ 01845000
*           /*                                                       */ 01846000
*           /* SET THE RETURN CODE TO 4.                     @Y30LB11*/ 01847000
*           /*                                                       */ 01848000
*           /*********************************************************/ 01849000
*                                                                  0592 01850000
*           BPROCOND=4;             /*                       @Y30LB11*/ 01851000
         LA    BPROCOND,4                                          0592 01852000
*         END;                      /*                       @Y30LB11*/ 01853000
*     END;                          /*                       @Y30LB11*/ 01854000
*                                                                  0594 01855000
@RC00556 DS    0H                                                  0595 01856000
*   /*****************************************************************/ 01857000
*   /*                                                               */ 01858000
*   /* RETURN TO IDCSV01.                                    @Y30LB11*/ 01859000
*   /*                                                               */ 01860000
*   /*****************************************************************/ 01861000
*                                                                  0595 01862000
*   RETURN CODE(BPROCOND);          /*                       @Y30LB11*/ 01863000
@RF00530 LR    @15,BPROCOND                                        0595 01864000
         L     @14,@SA00004                                        0595 01865000
         LM    @00,@12,@SA00004+8                                  0595 01866000
         BR    @14                                                 0595 01867000
*   END BASEPROC;                   /*                       @Y30LB11*/ 01868000
*                                                                  0597 01869000
*/********************************************************************/ 01870000
*/*                                                          @Y30LB11*/ 01871000
*/* PROCEDURE NAME - CHKVTOC                                 @Y30LB11*/ 01872000
*/*                                                          @Y30LB11*/ 01873000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO CHECK      @Y30LB11*/ 01874000
*/*            FOR AN EMPTY VTOC.                            @Y30LB11*/ 01875000
*/*                                                          @Y30LB11*/ 01876000
*/* INPUT - THE VS1AGL MAPPING MACRO IS INITIALIZED.         @Y30LB11*/ 01877000
*/*                                                          @Y30LB11*/ 01878000
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15          @Y30LB11*/ 01879000
*/*          UCLOSERR IS SET ON IF ERROR CLOSING VTOC        @Y30LB11*/ 01880000
*/*                                                          @Y30LB11*/ 01881000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 01882000
*/*          4 - VTOC WAS NOT EMPTY                          @Y30LB11*/ 01883000
*/*                                                          @Y30LB11*/ 01884000
*/********************************************************************/ 01885000
*                                                                  0597 01886000
*CHKVTOC:                                                          0597 01887000
*   PROC;                           /*                       @Y30LB11*/ 01888000
CHKVTOC  STM   @14,@12,@SA00005                                    0597 01889000
*   DCL                                                            0598 01890000
*     CHKCOND FIXED(15);            /*                       @Y30LB11*/ 01891000
*                                                                  0599 01892000
*   /*****************************************************************/ 01893000
*   /*                                                               */ 01894000
*   /* TRACE AT ENTRY TO CHKVTOC PROCEDURE                   @Y30LB11*/ 01895000
*   /*                                                               */ 01896000
*   /*****************************************************************/ 01897000
*                                                                  0599 01898000
*   OLDERID2=NEWERID2;                                             0599 01899000
         L     @05,@PC00001                                        0599 01900000
         L     @02,GDTTR2(,@05)                                    0599 01901000
         MVC   @TS00001(95),NEWERID2(@02)                          0599 01902000
         MVC   OLDERID2(95,@02),@TS00001                           0599 01903000
*   NEWID2='SVCV';                  /*                       @Y30LB11*/ 01904000
*                                                                  0600 01905000
         MVC   NEWID2(4,@02),@CC01212                              0600 01906000
*   /*****************************************************************/ 01907000
*   /*                                                               */ 01908000
*   /* CHKVTOC RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/ 01909000
*   /*                                                               */ 01910000
*   /*****************************************************************/ 01911000
*                                                                  0601 01912000
*   CHKCOND=0;                      /*                       @Y30LB11*/ 01913000
*                                                                  0601 01914000
         SLR   CHKCOND,CHKCOND                                     0601 01915000
*   /*****************************************************************/ 01916000
*   /*                                                               */ 01917000
*   /* INITIALIZE VS1AGL MAPPING MACRO FOR CALL TO IDCVS01. NO VSAM  */ 01918000
*   /* NOR NON-VSAM DATA SETS SHOULD BE FOUND AND THE VOLUME SHOULD  */ 01919000
*   /* BE RESERVED PRIOR TO CHECKING THE VTOC.               @Y30LB11*/ 01920000
*   /*                                                               */ 01921000
*   /*****************************************************************/ 01922000
*                                                                  0602 01923000
*   VSNOVSAM=ON;                    /*                       @Y30LB11*/ 01924000
*   VSNONONV=ON;                    /*                       @Y30LB11*/ 01925000
         LA    @02,VSAGAREA                                        0603 01926000
         OI    VSNOVSAM(@02),B'10100000'                           0603 01927000
*   VSVOLP=ADDR(VOLVAL);            /*                       @Y30LB11*/ 01928000
         L     @15,@PC00001+4                                      0604 01929000
         L     @01,FDTPTR(,@15)                                    0604 01930000
         LA    @15,VOLVAL(,@01)                                    0604 01931000
         ST    @15,VSVOLP(,@02)                                    0604 01932000
*   VSRES=ON;                       /*                       @Y30LB11*/ 01933000
         OI    VSRES(@02),B'10000000'                              0605 01934000
*   VSUCBP=ADDR(UCBPTR);            /*                       @Y30LB11*/ 01935000
*                                                                  0606 01936000
         LA    @15,UCBPTR                                          0606 01937000
         ST    @15,VSUCBP(,@02)                                    0606 01938000
*   /*****************************************************************/ 01939000
*   /*                                                               */ 01940000
*   /* SECURITY CHECK                                        @Y30LB11*/ 01941000
*   /*                                                               */ 01942000
*   /*****************************************************************/ 01943000
*                                                                  0607 01944000
*   CALL IDCSACL0(GDTTBL,'IDCVS01 ',SECCHECK,VS1AGL);/*      @Y30LB11*/ 01945000
         ST    @05,@AL00001                                        0607 01946000
         LA    @15,@CC01213                                        0607 01947000
         ST    @15,@AL00001+4                                      0607 01948000
         LA    @15,SECCHECK                                        0607 01949000
         ST    @15,@AL00001+8                                      0607 01950000
         ST    @02,@AL00001+12                                     0607 01951000
         MVI   @AL00001+12,X'80'                                   0607 01952000
         L     @15,GDTCAL(,@05)                                    0607 01953000
         LA    @01,@AL00001                                        0607 01954000
         BALR  @14,@15                                             0607 01955000
*   RESPECIFY                                                      0608 01956000
*     RTNREG RSTD;                                                 0608 01957000
*   TESTRC=RTNREG;                                                 0609 01958000
         LR    TESTRC,RTNREG                                       0609 01959000
*   RESPECIFY                                                      0610 01960000
*     RTNREG UNRSTD;                /*                       @Y30LB11*/ 01961000
*                                                                  0611 01962000
*   /*****************************************************************/ 01963000
*   /*                                                               */ 01964000
*   /* IF THE RETURN CODE IS 4, THE VTOC IS NOT EMPTY AND    @Y30LB11*/ 01965000
*   /* A BAD RETURN CODE IS SET.                             @Y30LB11*/ 01966000
*   /*                                                               */ 01967000
*   /*****************************************************************/ 01968000
*                                                                  0611 01969000
*   IF TESTRC=4 THEN                /*                       @Y30LB11*/ 01970000
         LA    @05,4                                               0611 01971000
         CR    TESTRC,@05                                          0611 01972000
         BNE   @RF00611                                            0611 01973000
*     CHKCOND=4;                    /*                       @Y30LB11*/ 01974000
*                                                                  0612 01975000
         LR    CHKCOND,@05                                         0612 01976000
*   /*****************************************************************/ 01977000
*   /*                                                               */ 01978000
*   /* IF THE VSIOP FIELD IS NOT ZERO THEN THE VTOC NEEDS TO @Y30LB11*/ 01979000
*   /* BE CLOSED. THE UCLOSE UMACRO IS ISSUED.               @Y30LB11*/ 01980000
*   /*                                                               */ 01981000
*   /*****************************************************************/ 01982000
*                                                                  0613 01983000
*   IF VSIOP^=NULLPTR THEN          /*                       @Y30LB11*/ 01984000
@RF00611 LA    @05,VSAGAREA                                        0613 01985000
         L     @15,VSIOP(,@05)                                     0613 01986000
         LTR   @15,@15                                             0613 01987000
         BZ    @RF00613                                            0613 01988000
*     DO;                           /*                       @Y30LB11*/ 01989000
*       CALL IDCIOCL0(GDTTBL,VSIOP);/*                       @Y30LB11*/ 01990000
         L     @02,@PC00001                                        0615 01991000
         ST    @02,@AL00001                                        0615 01992000
         LA    @05,VSIOP(,@05)                                     0615 01993000
         ST    @05,@AL00001+4                                      0615 01994000
         MVI   @AL00001+4,X'80'                                    0615 01995000
         L     @15,GDTCLS(,@02)                                    0615 01996000
         LA    @01,@AL00001                                        0615 01997000
         BALR  @14,@15                                             0615 01998000
*       RESPECIFY                                                  0616 01999000
*         RTNREG RSTD;                                             0616 02000000
*       TESTRC=RTNREG;                                             0617 02001000
         LR    TESTRC,RTNREG                                       0617 02002000
*       RESPECIFY                                                  0618 02003000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 02004000
*                                                                  0618 02005000
*       /*************************************************************/ 02006000
*       /*                                                           */ 02007000
*       /* IF THE CLOSE FAILED, THE UCLOSERR FLAG IS SET ON. @Y30LB11*/ 02008000
*       /*                                                           */ 02009000
*       /*************************************************************/ 02010000
*                                                                  0619 02011000
*       IF TESTRC=4 THEN            /*                       @Y30LB11*/ 02012000
         C     TESTRC,@CF00041                                     0619 02013000
         BNE   @RF00619                                            0619 02014000
*         UCLOSERR=ON;              /*                       @Y30LB11*/ 02015000
         OI    UCLOSERR,B'00100000'                                0620 02016000
*     END;                          /*                       @Y30LB11*/ 02017000
*                                                                  0621 02018000
@RF00619 DS    0H                                                  0622 02019000
*   /*****************************************************************/ 02020000
*   /*                                                               */ 02021000
*   /* RETURN TO BASECHK.                                    @Y30LB11*/ 02022000
*   /*                                                               */ 02023000
*   /*****************************************************************/ 02024000
*                                                                  0622 02025000
*   RETURN CODE(CHKCOND);           /*                       @Y30LB11*/ 02026000
@RF00613 LR    @15,CHKCOND                                         0622 02027000
         L     @14,@SA00005                                        0622 02028000
         LM    @00,@12,@SA00005+8                                  0622 02029000
         BR    @14                                                 0622 02030000
*   END CHKVTOC;                    /*                       @Y30LB11*/ 02031000
*                                                                  0624 02032000
*/********************************************************************/ 02033000
*/*                                                          @Y30LB11*/ 02034000
*/* PROCEDURE NAME - COPYPROC                                @Y30LB11*/ 02035000
*/*                                                          @Y30LB11*/ 02036000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO SCRATCH    @Y30LB11*/ 02037000
*/*            A SPECIFIC COPY VOLUME.                       @Y30LB11*/ 02038000
*/*                                                          @Y30LB11*/ 02039000
*/* INPUT - THE RVVI MAPPING MACRO IS INITIALIZED AND USED   @Y30LB11*/ 02040000
*/*         TO READ THE SPECIFIED COPY VOLUME RECORD.        @Y30LB11*/ 02041000
*/*                                                          @Y30LB11*/ 02042000
*/* OUTPUT - RETURN CODE IS RETURNED IN REGISTER 15.         @Y30LB11*/ 02043000
*/*          SCRDFLG IS SET ON IF THE COPY WAS SCRATCHED.    @Y30LB11*/ 02044000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 02045000
*/*                                                          @Y30LB11*/ 02046000
*/*          4 - COPYPROC WAS UNSUCCESSFUL, COPY RECORD      @Y30LB11*/ 02047000
*/*              COULD NOT BE READ, OR COPY WAS NOT          @Y30LB11*/ 02048000
*/*              SCRATCHED.                                  @Y30LB11*/ 02049000
*/*                                                          @Y30LB11*/ 02050000
*/********************************************************************/ 02051000
*                                                                  0624 02052000
*COPYPROC:                                                         0624 02053000
*   PROC;                           /*                       @Y30LB11*/ 02054000
COPYPROC STM   @14,@12,@SA00006                                    0624 02055000
*   DCL                                                            0625 02056000
*     COPYCOND FIXED(15);           /*                       @Y30LB11*/ 02057000
*                                                                  0626 02058000
*   /*****************************************************************/ 02059000
*   /*                                                               */ 02060000
*   /* TRACE AT ENTRY TO COPYPROC PROCEDURE                  @Y30LB11*/ 02061000
*   /*                                                               */ 02062000
*   /*****************************************************************/ 02063000
*                                                                  0626 02064000
*   OLDERID2=NEWERID2;                                             0626 02065000
         L     @15,@PC00001                                        0626 02066000
         L     @15,GDTTR2(,@15)                                    0626 02067000
         MVC   @TS00001(95),NEWERID2(@15)                          0626 02068000
         MVC   OLDERID2(95,@15),@TS00001                           0626 02069000
*   NEWID2='SVCP';                  /*                       @Y30LB11*/ 02070000
*                                                                  0627 02071000
         MVC   NEWID2(4,@15),@CC01218                              0627 02072000
*   /*****************************************************************/ 02073000
*   /*                                                               */ 02074000
*   /* COPYPROC RETURN CODE IS INITIALIZED TO ZERO.          @Y30LB11*/ 02075000
*   /*                                                               */ 02076000
*   /*****************************************************************/ 02077000
*                                                                  0628 02078000
*   COPYCOND=0;                     /*                       @Y30LB11*/ 02079000
*                                                                  0628 02080000
         SLR   @15,@15                                             0628 02081000
         LR    COPYCOND,@15                                        0628 02082000
*   /*****************************************************************/ 02083000
*   /*                                                               */ 02084000
*   /* INITIALIZATION TO GET COPYV RECORD                    @Y30LB11*/ 02085000
*   /*                                                               */ 02086000
*   /*****************************************************************/ 02087000
*                                                                  0629 02088000
*   RVVCPYRC=ON;                    /*                       @Y30LB11*/ 02089000
         L     @14,RVVIPTR                                         0629 02090000
         OI    RVVCPYRC(@14),B'00100000'                           0629 02091000
*   RVVRDR=ON;                      /*                       @Y30LB11*/ 02092000
         OI    RVVRDR(@14),B'10000000'                             0630 02093000
*   RVVSDTE=ON;                     /*                       @Y30LB11*/ 02094000
         OI    RVVSDTE(@14),B'00100000'                            0631 02095000
*   CVD(DATEVAL,RVVCDATE);          /*                       @Y30LB11*/ 02096000
         L     @09,@PC00001+4                                      0632 02097000
         L     @01,FDTPTR+12(,@09)                                 0632 02098000
         L     @08,DATEVAL(,@01)                                   0632 02099000
         CVD   @08,@TS00001                                        0632 02100000
         MVC   RVVCDATE(4,@14),@TS00001+4                          0632 02101000
*   RVVRTBUF=COPYVPTR;              /*                       @Y30LB11*/ 02102000
         ST    COPYVPTR,RVVRTBUF(,@14)                             0633 02103000
*   RVVBUFLN=LENGTH(COPYAREA);      /*                       @Y30LB11*/ 02104000
*                                                                  0634 02105000
         MVC   RVVBUFLN(2,@14),@CH01285                            0634 02106000
*   /*****************************************************************/ 02107000
*   /*                                                               */ 02108000
*   /* IF A COPY NUMBER IS SPECIFIED, THE SEQUENCE SWITCH AND        */ 02109000
*   /* SEQUENCE NUMBER ARE SET.                              @Y30LB11*/ 02110000
*   /*                                                               */ 02111000
*   /*****************************************************************/ 02112000
*                                                                  0635 02113000
*   IF ADDR(SEQ)^=NULLPTR THEN      /*                       @Y30LB11*/ 02114000
         L     @09,FDTPTR+16(,@09)                                 0635 02115000
         CR    @09,@15                                             0635 02116000
         BE    @RF00635                                            0635 02117000
*     DO;                           /*                       #Y30LB11*/ 02118000
*       RVVSSEQ=ON;                 /*                       #Y30LB11*/ 02119000
         OI    RVVSSEQ(@14),B'00010000'                            0637 02120000
*       RVVRDSEQ=SEQVAL;            /*                       #Y30LB11*/ 02121000
         MVC   RVVRDSEQ(1,@14),SEQVAL+3(@09)                       0638 02122000
*     END;                          /*                       @Y30LB11*/ 02123000
*                                                                  0639 02124000
*   /*****************************************************************/ 02125000
*   /*                                                               */ 02126000
*   /* SYMBOLIC DUMP OF INITIALIZED PARM LIST FOR MSVC READ MACRO.   */ 02127000
*   /*                                                       @Y30LB11*/ 02128000
*   /*                                                               */ 02129000
*   /*****************************************************************/ 02130000
*                                                                  0640 02131000
*   IF GDTDBG=NULLPTR THEN                                         0640 02132000
@RF00635 L     @15,@PC00001                                        0640 02133000
         L     @15,GDTDBG(,@15)                                    0640 02134000
         LTR   @15,@15                                             0640 02135000
         BZ    @RT00640                                            0640 02136000
*     ;                                                            0641 02137000
*   ELSE                                                           0642 02138000
*     DO;                                                          0642 02139000
*       DMPINDEX=ADDR(DUMPAREA);    /*                       @Y30LB11*/ 02140000
         LA    DMPINDEX,DUMPAREA                                   0643 02141000
*       DMPITMNM='RVVI';                                           0644 02142000
         MVI   DMPITMNM+4(DMPINDEX),C' '                           0644 02143000
         MVC   DMPITMNM+5(3,DMPINDEX),DMPITMNM+4(DMPINDEX)         0644 02144000
         MVC   DMPITMNM(4,DMPINDEX),@CC01188                       0644 02145000
*       DMPITMPT=ADDR(RVVI);                                       0645 02146000
         L     @03,RVVIPTR                                         0645 02147000
         ST    @03,DMPITMPT(,DMPINDEX)                             0645 02148000
*       DMPITMLN=LENGTH(RVVI);                                     0646 02149000
         MVC   DMPITMLN(2,DMPINDEX),@CH01286                       0646 02150000
*       DMPITMTP='H';                                              0647 02151000
         MVI   DMPITMTP(DMPINDEX),C'H'                             0647 02152000
*       DMPINDEX=DMPINDEX+DMPELEMT;                                0648 02153000
*                                                                  0648 02154000
         AL    DMPINDEX,@CF00464                                   0648 02155000
*       /*************************************************************/ 02156000
*       /*                                                           */ 02157000
*       /*                                                   @Y30LB11*/ 02158000
*       /*                                                           */ 02159000
*       /*************************************************************/ 02160000
*                                                                  0649 02161000
*       DMPTRM=DMPTRMVL;                                           0649 02162000
         MVI   DMPTRM(DMPINDEX),X'FF'                              0649 02163000
*     END;                          /*                       @Y30LB11*/ 02164000
*   IF GDTDBG=NULLPTR THEN                                         0651 02165000
@RT00640 L     @15,@PC00001                                        0651 02166000
         L     @15,GDTDBG(,@15)                                    0651 02167000
         LTR   @15,@15                                             0651 02168000
         BZ    @RT00651                                            0651 02169000
*     ;                                                            0652 02170000
*   ELSE                                                           0653 02171000
*     CALL IDCDB010(GDTTBL,'SVRV',ADDR(DUMPAREA));/*         @Y30LB11*/ 02172000
         L     @15,@PC00001                                        0653 02173000
         ST    @15,@AL00001                                        0653 02174000
         LA    @14,@CC01220                                        0653 02175000
         ST    @14,@AL00001+4                                      0653 02176000
         LA    @14,DUMPAREA                                        0653 02177000
         ST    @14,@AFTEMPS+12                                     0653 02178000
         LA    @14,@AFTEMPS+12                                     0653 02179000
         ST    @14,@AL00001+8                                      0653 02180000
         MVI   @AL00001+8,X'80'                                    0653 02181000
         L     @15,GDTDBG(,@15)                                    0653 02182000
         LA    @01,@AL00001                                        0653 02183000
         BALR  @14,@15                                             0653 02184000
*                                                                  0654 02185000
*   /*****************************************************************/ 02186000
*   /*                                                               */ 02187000
*   /* USSC MACRO TO GET COPYV RECORD                        @Y30LB11*/ 02188000
*   /*                                                               */ 02189000
*   /*****************************************************************/ 02190000
*                                                                  0654 02191000
*   CALL IDCSASS0(GDTTBL,VVIC,RVVIPTR,REASONCD);/*           @Y30LB11*/ 02192000
@RT00651 L     @02,@PC00001                                        0654 02193000
         ST    @02,@AL00001                                        0654 02194000
         LA    @15,VVIC                                            0654 02195000
         ST    @15,@AL00001+4                                      0654 02196000
         LA    @15,RVVIPTR                                         0654 02197000
         ST    @15,@AL00001+8                                      0654 02198000
         LA    @15,REASONCD                                        0654 02199000
         ST    @15,@AL00001+12                                     0654 02200000
         MVI   @AL00001+12,X'80'                                   0654 02201000
         L     @15,GDTSSC(,@02)                                    0654 02202000
         LA    @01,@AL00001                                        0654 02203000
         BALR  @14,@15                                             0654 02204000
*   RESPECIFY                                                      0655 02205000
*     RTNREG RSTD;                                                 0655 02206000
*   TESTRC=RTNREG;                                                 0656 02207000
         LR    TESTRC,RTNREG                                       0656 02208000
*   RESPECIFY                                                      0657 02209000
*     RTNREG UNRSTD;                /*                       @Y30LB11*/ 02210000
*                                                                  0657 02211000
*   /*****************************************************************/ 02212000
*   /*                                                               */ 02213000
*   /* IF READ OF THE RECORD FAILED, INVOKE SSCMSG TO PRINT AN ERROR */ 02214000
*   /* MESSAGE CORRESPONDING TO THE REASON CODE.             @Y30LB11*/ 02215000
*   /*                                                               */ 02216000
*   /*****************************************************************/ 02217000
*                                                                  0658 02218000
*   IF TESTRC=4 THEN                /*                       @Y30LB11*/ 02219000
         C     TESTRC,@CF00041                                     0658 02220000
         BNE   @RF00658                                            0658 02221000
*     DO;                           /*                       @Y30LB11*/ 02222000
*       CALL SSCMSG(REASONCD);      /*                       @Y30LB11*/ 02223000
         LA    @15,REASONCD                                        0660 02224000
         ST    @15,@AL00001                                        0660 02225000
         LA    @01,@AL00001                                        0660 02226000
         BAL   @14,SSCMSG                                          0660 02227000
*       RESPECIFY                                                  0661 02228000
*         RTNREG RSTD;                                             0661 02229000
*       TESTRC=RTNREG;                                             0662 02230000
         LR    TESTRC,RTNREG                                       0662 02231000
*       RESPECIFY                                                  0663 02232000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 02233000
*       COPYCOND=4;                 /*                       @Y30LB11*/ 02234000
         LA    COPYCOND,4                                          0664 02235000
*     END;                          /*                       @Y30LB11*/ 02236000
*                                                                  0665 02237000
*   /*****************************************************************/ 02238000
*   /*                                                               */ 02239000
*   /* IF THE READ OF THE RECORD WAS SUCCESSFUL, CALL SCRCOPY TO     */ 02240000
*   /* SCRATCH THE COPY AND ITS VOLUME RECORD.               @Y30LB11*/ 02241000
*   /*                                                               */ 02242000
*   /*****************************************************************/ 02243000
*                                                                  0666 02244000
*   ELSE                            /*                       @Y30LB11*/ 02245000
*     DO;                           /*                       @Y30LB11*/ 02246000
         B     @RC00658                                            0666 02247000
@RF00658 DS    0H                                                  0667 02248000
*       CALL SCRCOPY(COMTBL);       /*                       @Y30LB11*/ 02249000
         LA    @15,COMTBL                                          0667 02250000
         ST    @15,@AL00001                                        0667 02251000
         LA    @01,@AL00001                                        0667 02252000
         BAL   @14,SCRCOPY                                         0667 02253000
*       RESPECIFY                                                  0668 02254000
*         RTNREG RSTD;                                             0668 02255000
*       TESTRC=RTNREG;                                             0669 02256000
         LR    TESTRC,RTNREG                                       0669 02257000
*       RESPECIFY                                                  0670 02258000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 02259000
*                                                                  0670 02260000
*       /*************************************************************/ 02261000
*       /*                                                           */ 02262000
*       /* IF SCRCOPY WAS SUCCESSFUL, SET THE SCRDFLG ON,    @Y30LB11*/ 02263000
*       /* OTHERWISE SET THE RETURN CODE TO 4.               @Y30LB11*/ 02264000
*       /*                                                           */ 02265000
*       /*************************************************************/ 02266000
*                                                                  0671 02267000
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/ 02268000
         LTR   TESTRC,TESTRC                                       0671 02269000
         BNZ   @RF00671                                            0671 02270000
*         SCRDFLG=ON;               /*                       @Y30LB11*/ 02271000
         OI    SCRDFLG,B'01000000'                                 0672 02272000
*       ELSE                        /*                       @Y30LB11*/ 02273000
*         COPYCOND=4;               /*                       @Y30LB11*/ 02274000
         B     @RC00671                                            0673 02275000
@RF00671 LA    COPYCOND,4                                          0673 02276000
*     END;                          /*                       @Y30LB11*/ 02277000
*                                                                  0674 02278000
@RC00671 DS    0H                                                  0675 02279000
*   /*****************************************************************/ 02280000
*   /*                                                               */ 02281000
*   /* RETURN TO IDCSV01.                                    @Y30LB11*/ 02282000
*   /*                                                               */ 02283000
*   /*****************************************************************/ 02284000
*                                                                  0675 02285000
*   RETURN CODE(COPYCOND);          /*                       @Y30LB11*/ 02286000
@RC00658 LR    @15,COPYCOND                                        0675 02287000
         L     @14,@SA00006                                        0675 02288000
         LM    @00,@12,@SA00006+8                                  0675 02289000
         BR    @14                                                 0675 02290000
*   END COPYPROC;                   /*                       @Y30LB11*/ 02291000
*                                                                  0677 02292000
*/***********************************************************@Y30LB39*/ 02293000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 02294000
*/*                                                          @Y30LB39*/ 02295000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 02296000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 02297000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 02298000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 02299000
*/*                                                          @Y30LB39*/ 02300000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 02301000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 02302000
*/*   IN SSECBCD.                                            @Y30LB39*/ 02303000
*/*                                                          @Y30LB39*/ 02304000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 02305000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 02306000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 02307000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 02308000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 02309000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 02310000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 02311000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 02312000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 02313000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 02314000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 02315000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 02316000
*/*                                                          @Y30LB39*/ 02317000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 02318000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 02319000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 02320000
*/*                                                          @Y30LB39*/ 02321000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 02322000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 02323000
*/*                                                          @Y30LB39*/ 02324000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 02325000
*/*                                                          @Y30LB39*/ 02326000
*/***********************************************************@Y30LB39*/ 02327000
*                                                                  0677 02328000
*                                   /*                       @Y30LB39*/ 02329000
*SSCMSG:                                                           0677 02330000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 02331000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   02332000
*                                                            @Y30LB39*/ 02333000
SSCMSG   STM   @14,@12,@SA00007                                    0677 02334000
         MVC   @PC00007(8),0(@01)                                  0677 02335000
*                                   /*                       @Y30LB39*/ 02336000
*                                                                  0678 02337000
*   /*****************************************************************/ 02338000
*   /*                                                               */ 02339000
*   /*                                                       @Y30LB39*/ 02340000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 02341000
*   /*                                                       @Y30LB39*/ 02342000
*   /*                                                               */ 02343000
*   /*****************************************************************/ 02344000
*                                                                  0678 02345000
*                                   /*                       @Y30LB39   02346000
*                                                            @Y30LB39*/ 02347000
*                                                                  0678 02348000
*   /*****************************************************************/ 02349000
*   /*                                                               */ 02350000
*   /*                                                       @Y30LB39*/ 02351000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 02352000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 02353000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 02354000
*   /*                                                       @Y30LB39*/ 02355000
*   /*                                                               */ 02356000
*   /*****************************************************************/ 02357000
*                                                                  0678 02358000
*                                   /*                       @Y30LB39*/ 02359000
*   DCL                                                            0678 02360000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 02361000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 02362000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 02363000
*   DCL                                                            0679 02364000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   02365000
*                                                            @Y30LB39   02366000
*                                                            @Y30LB39*/ 02367000
*                                                                  0679 02368000
*   /*****************************************************************/ 02369000
*   /*                                                               */ 02370000
*   /*                                                       @Y30LB39*/ 02371000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 02372000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 02373000
*   /*                                                       @Y30LB39*/ 02374000
*   /*                                                               */ 02375000
*   /*****************************************************************/ 02376000
*                                                                  0680 02377000
*                                   /*                       @Y30LB39*/ 02378000
*   DCL                                                            0680 02379000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 02380000
*   DCL                                                            0681 02381000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   02382000
*                                                            @Y30LB39*/ 02383000
*                                                                  0681 02384000
*   /*****************************************************************/ 02385000
*   /*                                                               */ 02386000
*   /*                                                       @Y30LB39*/ 02387000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 02388000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 02389000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 02390000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 02391000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 02392000
*   /*                                                       @Y30LB39*/ 02393000
*   /*                                                               */ 02394000
*   /*****************************************************************/ 02395000
*                                                                  0682 02396000
*                                   /*                       @Y30LB39*/ 02397000
*   DECLARE                                                        0682 02398000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   02399000
*                                                            @Y30LB39*/ 02400000
*                                                                  0682 02401000
*   /*****************************************************************/ 02402000
*   /*                                                               */ 02403000
*   /*                                                       @Y30LB39*/ 02404000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 02405000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 02406000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 02407000
*   /* IDCTSCM0.                                             @Y30LB39*/ 02408000
*   /*                                                       @Y30LB39*/ 02409000
*   /*                                                               */ 02410000
*   /*****************************************************************/ 02411000
*                                                                  0683 02412000
*                                   /*                       @Y30LB39*/ 02413000
*   DECLARE                                                        0683 02414000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   02415000
*                                                            @Y30LB39*/ 02416000
*                                                                  0683 02417000
*   /*****************************************************************/ 02418000
*   /*                                                               */ 02419000
*   /*                                                       @Y30LB39*/ 02420000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 02421000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 02422000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 02423000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 02424000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 02425000
*   /*                                                       @Y30LB39*/ 02426000
*   /*                                                               */ 02427000
*   /*****************************************************************/ 02428000
*                                                                  0684 02429000
*                                   /*                       @Y30LB39*/ 02430000
*   DECLARE                                                        0684 02431000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 02432000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   02433000
*                                                            @Y30LB39*/ 02434000
*                                                                  0684 02435000
*   /*****************************************************************/ 02436000
*   /*                                                               */ 02437000
*   /*                                                       @Y30LB39*/ 02438000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 02439000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 02440000
*   /*                                                       @Y30LB39*/ 02441000
*   /*                                                               */ 02442000
*   /*****************************************************************/ 02443000
*                                                                  0685 02444000
*                                   /*                       @Y30LB39*/ 02445000
*   DECLARE                                                        0685 02446000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   02447000
*                                                            @Y30LB39*/ 02448000
*                                                                  0685 02449000
*   /*****************************************************************/ 02450000
*   /*                                                               */ 02451000
*   /*                                                       @Y30LB39*/ 02452000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 02453000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 02454000
*   /*                                                       @Y30LB39*/ 02455000
*   /*                                                               */ 02456000
*   /*****************************************************************/ 02457000
*                                                                  0686 02458000
*                                   /*                       @Y30LB39*/ 02459000
*   DECLARE                                                        0686 02460000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   02461000
*                                                            @Y30LB39*/ 02462000
*                                   /*                       @Y30LB39*/ 02463000
*                                                                  0687 02464000
*   /*****************************************************************/ 02465000
*   /*                                                               */ 02466000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 02467000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 02468000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 02469000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 02470000
*   /*                                                       @Y30LB39*/ 02471000
*   /*                                                               */ 02472000
*   /*****************************************************************/ 02473000
*                                                                  0687 02474000
*                                   /*                       @Y30LB39*/ 02475000
*   OLDERID2=NEWERID2;                                             0687 02476000
         L     @15,@PC00001                                        0687 02477000
         L     @14,GDTTR2(,@15)                                    0687 02478000
         MVC   @TS00001(95),NEWERID2(@14)                          0687 02479000
         MVC   OLDERID2(95,@14),@TS00001                           0687 02480000
*   NEWID2='SSAA';                  /*                       @Y30LB39   02481000
*                                                            @Y30LB39*/ 02482000
*                                                                  0688 02483000
         MVC   NEWID2(4,@14),@CC01241                              0688 02484000
*   /*****************************************************************/ 02485000
*   /*                                                               */ 02486000
*   /*                                                       @Y30LB39*/ 02487000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 02488000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 02489000
*   /*                                                       @Y30LB39*/ 02490000
*   /*                                                               */ 02491000
*   /*****************************************************************/ 02492000
*                                                                  0689 02493000
*                                   /*                       @Y30LB39*/ 02494000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   02495000
*                                                            @Y30LB39*/ 02496000
*                                                                  0689 02497000
         LA    @14,SSDRGLT                                         0689 02498000
         ST    @14,SSDLPTR                                         0689 02499000
*   /*****************************************************************/ 02500000
*   /*                                                               */ 02501000
*   /*                                                       @Y30LB39*/ 02502000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 02503000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 02504000
*   /*                                                       @Y30LB39*/ 02505000
*   /*                                                               */ 02506000
*   /*****************************************************************/ 02507000
*                                                                  0690 02508000
*                                   /*                       @Y30LB39*/ 02509000
*   IF SSRCODE>0 THEN                                              0690 02510000
         L     @09,@PC00007                                        0690 02511000
         L     @09,SSRCODE(,@09)                                   0690 02512000
         LTR   @09,@09                                             0690 02513000
         BNP   @RF00690                                            0690 02514000
*     DO;                           /*                       @Y30LB39   02515000
*                                                            @Y30LB39*/ 02516000
*                                                                  0691 02517000
*       /*************************************************************/ 02518000
*       /*                                                           */ 02519000
*       /*                                                   @Y30LB39*/ 02520000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 02521000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 02522000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 02523000
*       /* CODES.                                            @Y30LB39*/ 02524000
*       /*                                                   @Y30LB39*/ 02525000
*       /*                                                           */ 02526000
*       /*************************************************************/ 02527000
*                                                                  0692 02528000
*                                   /*                       @Y30LB39*/ 02529000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02530000
         XC    SSDRGLT(20),SSDRGLT                                 0692 02531000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 02532000
         LA    @03,SSINXLST                                        0693 02533000
         ST    @03,DARGRETP(,@14)                                  0693 02534000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 02535000
         MVC   DARGSMOD(3,@14),SSMODSS0                            0694 02536000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 02537000
         MVI   DARGSENT(@14),X'01'                                 0695 02538000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   02539000
*                                                            @Y30LB39*/ 02540000
*                                                                  0696 02541000
         MVC   DARGRETL(2,@14),@CH01289                            0696 02542000
*       /*************************************************************/ 02543000
*       /*                                                           */ 02544000
*       /*                                                   @Y30LB39*/ 02545000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 02546000
*       /* ARRAY.                                            @Y30LB39*/ 02547000
*       /*                                                   @Y30LB39*/ 02548000
*       /*                                                           */ 02549000
*       /*************************************************************/ 02550000
*                                                                  0697 02551000
*                                   /*                       @Y30LB39*/ 02552000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   02553000
*                                                            @Y30LB39*/ 02554000
*                                                                  0697 02555000
         ST    @15,@AL00001                                        0697 02556000
         LA    @03,@CF00111                                        0697 02557000
         ST    @03,@AL00001+4                                      0697 02558000
         LA    @03,SSDLPTR                                         0697 02559000
         ST    @03,@AL00001+8                                      0697 02560000
         MVI   @AL00001+8,X'80'                                    0697 02561000
         L     @15,GDTPRT(,@15)                                    0697 02562000
         LA    @01,@AL00001                                        0697 02563000
         BALR  @14,@15                                             0697 02564000
*       /*************************************************************/ 02565000
*       /*                                                           */ 02566000
*       /*                                                   @Y30LB39*/ 02567000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 02568000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 02569000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 02570000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 02571000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 02572000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 02573000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 02574000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 02575000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 02576000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 02577000
*       /* REASON CODE.                                      @Y30LB39*/ 02578000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 02579000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 02580000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 02581000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 02582000
*       /*                                                   @Y30LB39*/ 02583000
*       /*                                                           */ 02584000
*       /*************************************************************/ 02585000
*                                                                  0698 02586000
*                                   /*                       @Y30LB39*/ 02587000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 02588000
         LA    ENTRYNUM,1                                          0698 02589000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   0699 02590000
@DL00699 DS    0H                                                  0700 02591000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 02592000
         AL    ENTRYNUM,@CF00213                                   0700 02593000
*       END;                        /*                       @Y30LB39   02594000
*                                                            @Y30LB39*/ 02595000
*                                                                  0701 02596000
@DE00699 L     @03,@PC00007                                        0701 02597000
         LR    @15,ENTRYNUM                                        0701 02598000
         ALR   @15,@15                                             0701 02599000
         LH    @15,SSARRAY-2(@15)                                  0701 02600000
         CH    @15,SSRHALF(,@03)                                   0701 02601000
         BE    @DC00699                                            0701 02602000
         SLR   @14,@14                                             0701 02603000
         CR    @15,@14                                             0701 02604000
         BNE   @DL00699                                            0701 02605000
@DC00699 DS    0H                                                  0702 02606000
*       /*************************************************************/ 02607000
*       /*                                                           */ 02608000
*       /*                                                   @Y30LB39*/ 02609000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 02610000
*       /*                                                   @Y30LB39*/ 02611000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 02612000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 02613000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 02614000
*       /* CODE OR                                           @Y30LB39*/ 02615000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 02616000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 02617000
*       /*                                                   @Y30LB39*/ 02618000
*       /*                                                           */ 02619000
*       /*************************************************************/ 02620000
*                                                                  0702 02621000
*                                   /*                       @Y30LB39*/ 02622000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02623000
         XC    SSDRGLT(20),SSDRGLT                                 0702 02624000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 02625000
         L     @09,SSDLPTR                                         0703 02626000
         MVC   DARGSMOD(3,@09),SSMODSS0                            0703 02627000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 02628000
         STC   ENTRYNUM,DARGSENT(,@09)                             0704 02629000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 02630000
         CR    @15,@14                                             0705 02631000
         BNE   @RF00705                                            0705 02632000
*         DO;                       /*                       @Y30LB39*/ 02633000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 02634000
         ST    @03,DARGDBP(,@09)                                   0707 02635000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 02636000
         MVC   DARGILP(2,@09),@CH00041                             0708 02637000
*         END;                      /*                       @Y30LB39*/ 02638000
*     END;                          /*                       @Y30LB39*/ 02639000
*                                   /*                       @Y30LB39*/ 02640000
*                                                                  0711 02641000
*   /*****************************************************************/ 02642000
*   /*                                                               */ 02643000
*   /*                                                       @Y30LB39*/ 02644000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 02645000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 02646000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 02647000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 02648000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 02649000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 02650000
*   /* POST CODE.                                            @Y30LB39*/ 02651000
*   /*                                                       @Y30LB39*/ 02652000
*   /*                                                               */ 02653000
*   /*****************************************************************/ 02654000
*                                                                  0711 02655000
*                                   /*                       @Y30LB39*/ 02656000
*   ELSE                            /*                       @Y30LB39*/ 02657000
*     DO;                           /*                       @Y30LB39*/ 02658000
         B     @RC00690                                            0711 02659000
@RF00690 DS    0H                                                  0712 02660000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 02661000
         XC    SSDRGLT(20),SSDRGLT                                 0712 02662000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 02663000
         L     @15,SSDLPTR                                         0713 02664000
         MVC   DARGSMOD(3,@15),SSMODCM0                            0713 02665000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 02666000
         MVC   DARGSENT(1,@15),SSMSGNUM                            0714 02667000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 02668000
         L     @14,@PC00007+4                                      0715 02669000
         ST    @14,DARGDBP(,@15)                                   0715 02670000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 02671000
         MVC   DARGILP(2,@15),@CH00213                             0716 02672000
*     END;                          /*                       @Y30LB39   02673000
*                                                            @Y30LB39*/ 02674000
*                                                                  0717 02675000
*   /*****************************************************************/ 02676000
*   /*                                                               */ 02677000
*   /*                                                       @Y30LB39*/ 02678000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 02679000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 02680000
*   /*                                                       @Y30LB39*/ 02681000
*   /*                                                               */ 02682000
*   /*****************************************************************/ 02683000
*                                                                  0718 02684000
*                                   /*                       @Y30LB39*/ 02685000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   02686000
*                                                            @Y30LB39*/ 02687000
*                                                                  0718 02688000
@RC00690 L     @15,@PC00001                                        0718 02689000
         ST    @15,@AL00001                                        0718 02690000
         LA    @14,@CF00111                                        0718 02691000
         ST    @14,@AL00001+4                                      0718 02692000
         LA    @14,SSDLPTR                                         0718 02693000
         ST    @14,@AL00001+8                                      0718 02694000
         MVI   @AL00001+8,X'80'                                    0718 02695000
         L     @15,GDTPRT(,@15)                                    0718 02696000
         LA    @01,@AL00001                                        0718 02697000
         BALR  @14,@15                                             0718 02698000
*   /*****************************************************************/ 02699000
*   /*                                                               */ 02700000
*   /*                                                       @Y30LB39*/ 02701000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 02702000
*   /*                                                       @Y30LB39*/ 02703000
*   /*                                                               */ 02704000
*   /*****************************************************************/ 02705000
*                                                                  0719 02706000
*                                   /*                       @Y30LB39   02707000
*                                                            @Y30LB39*/ 02708000
*   RETURN CODE(0);                 /*                       @Y30LB39   02709000
*                                                            @Y30LB39*/ 02710000
         SLR   @15,@15                                             0719 02711000
         L     @14,@SA00007                                        0719 02712000
         LM    @00,@12,@SA00007+8                                  0719 02713000
         BR    @14                                                 0719 02714000
*   END SSCMSG;                     /*                       @Y30LB39*/ 02715000
*                                                                  0721 02716000
*/********************************************************************/ 02717000
*/*                                                          @Y30LB11*/ 02718000
*/* PROCEDURE NAME - SCRCOPY                                 @Y30LB11*/ 02719000
*/*                                                          @Y30LB11*/ 02720000
*/* FUNCTION - THE PRINCIPLE FUNCTION OF THIS ROUTINE IS TO  @Y30LB11*/ 02721000
*/*            SCRATCH AN MSS COPY VOLUME.                   @Y30LB11*/ 02722000
*/*                                                          @Y30LB11*/ 02723000
*/*            IDC0088I CARTRIDGES CSN (CSN) SCRATCHED FOR   @Y30LB11*/ 02724000
*/*            COPY YYDDD.                                   @Y30LB11*/ 02725000
*/*                                                          @Y30LB11*/ 02726000
*/*            IDC0098I ** LOCATION OF VOLUME: (LOCATION)    @Y30LB11*/ 02727000
*/*                                                          @Y30LB11*/ 02728000
*/*            IDC2076I ** CART CSN (CSN) NOT IN MSF FOR     @Y30LB11*/ 02729000
*/*            COPY YYDDD.                                   @Y30LB11*/ 02730000
*/*                                                          @Y30LB11*/ 02731000
*/*            IDC2087I ** CART CSN (CSN) NOT SCRATCHED FOR  @Y30LB11*/ 02732000
*/*            COPY YYDDD.                                   @Y30LB11*/ 02733000
*/*                                                          @Y30LB11*/ 02734000
*/* INPUT - A PARAMETER CONSISTING OF A SINGLE BYTE.  THE    @Y30LB11*/ 02735000
*/*         FIRST BIT OF THE BYTE IS SET TO '1' BY SCRCOPY   @Y30LB11*/ 02736000
*/*         AN ERROR OCCURS UPDATING THE INVENTORY.          @Y30LB11*/ 02737000
*/*                                                          @Y30LB11*/ 02738000
*/*         THE COPY RECORD MUST HAVE BEEN READ AND THE      @Y30LB11*/ 02739000
*/*         COPYV MAPPING MACRO BASED ON THE RECORD PRIOR TO @Y30LB11*/ 02740000
*/*         THE CALL TO SCRCOPY.   FURTHER, THE DEFLIST      @Y30LB11*/ 02741000
*/*         MUST HAVE BEEN INCLUDED PRIOR TO THE CALL TO     @Y30LB11*/ 02742000
*/*         SCRCOPY.                                         @Y30LB11*/ 02743000
*/*                                                          @Y30LB11*/ 02744000
*/* OUTPUT - FIRST BIT OF INPUT BYTE SET IF INVENTORY ERROR. @Y30LB11*/ 02745000
*/*          RETURN CODE IN REGISTER 15                      @Y30LB11*/ 02746000
*/*                                                          @Y30LB11*/ 02747000
*/*          0 - CARTRIDGE OR CARTRIDGES FOR COPY VOLUME     @Y30LB11*/ 02748000
*/*              SCRATCHED SUCCESSFULLY.                     @Y30LB11*/ 02749000
*/*                                                          @Y30LB11*/ 02750000
*/*          4 - CARTRIDGES NOT IN LIBRARY, OR DSM FAILURE   @Y30LB11*/ 02751000
*/*              OCCURRED.                                   @Y30LB11*/ 02752000
*/*                                                          @Y30LB11*/ 02753000
*/*          8 - USSC UMACRO COULD NOT OBTAIN STORAGE        @Y30LB11*/ 02754000
*/*              FOR ECB/MESSAGE AREA.                       @Y30LB11*/ 02755000
*/*                                                          @Y30LB11*/ 02756000
*/********************************************************************/ 02757000
*                                                                  0721 02758000
*SCRCOPY:                           /*                       @Y30LB11*/ 02759000
*   PROCEDURE(SCINPUT);             /*                       @Y30LB11*/ 02760000
SCRCOPY  STM   @14,@12,@SA00008                                    0721 02761000
         MVC   @PC00008(4),0(@01)                                  0721 02762000
*   DCL                                                            0722 02763000
*     SCCMPTR PTR(31);              /* PTR TO ECB/MSG AREA   @Y30LB11*/ 02764000
*   DCL                                                            0723 02765000
*     SCECBCD FIXED(8);             /* SCRCOPY ECB CODE      @Y30LB11*/ 02766000
*   DCL                                                            0724 02767000
*     SCRCOND FIXED(15);            /* SCRCOPY COND CODE     @Y30LB11*/ 02768000
*   DCL                                                            0725 02769000
*     SCMSGCD PTR(31);              /* SSCMSG REASON CODE    @Y30LB11*/ 02770000
*   DCL                                                            0726 02771000
*     SCMSGPTR PTR(31);             /* MESSAGE AREA POINTER  @Y30LB11*/ 02772000
*   DCL                                                            0727 02773000
*     SCDEFLST CHAR(LENGTH(DEFLIST));/* SCRCOPY DEFLIST      @Y30LB11*/ 02774000
*   DCL                                                            0728 02775000
*     SCDEFPTR PTR(31);             /* DEFLIST POINTER       @Y30LB11*/ 02776000
*   DCL                                                            0729 02777000
*     SCDDSTRU PTR(31);             /* DARGLIST POINTER      @Y30LB11*/ 02778000
*                                                                  0729 02779000
*   /*****************************************************************/ 02780000
*   /*                                                               */ 02781000
*   /* DARGLIST WITH UP TO 3 INSERTS                         @Y30LB11*/ 02782000
*   /*                                                               */ 02783000
*   /*****************************************************************/ 02784000
*                                                                  0730 02785000
*   DCL                                                            0730 02786000
*     SCDARG CHAR(LENGTH(DARGLIST)+2*(LENGTH(DARGARY)));/*   @Y30LB11*/ 02787000
*   DCL                                                            0731 02788000
*     1 SCINPUT BIT(8),             /* PARAMETER LIST        @Y30LB11*/ 02789000
*      2 SCERRFLG BIT(1),           /* RETURNED FLAG         @Y30LB11*/ 02790000
*      2 * BIT(7);                  /* UNUSED                @Y30LB11*/ 02791000
*                                                                  0731 02792000
*   /*****************************************************************/ 02793000
*   /*                                                               */ 02794000
*   /* CONSTANT SECTION DECLARATIONS FOR SCRCOPY             @Y30LB11*/ 02795000
*   /*                                                               */ 02796000
*   /*****************************************************************/ 02797000
*                                                                  0732 02798000
*   DCL                                                            0732 02799000
*     1 SCBLANKS CHAR(30) STATIC LOCAL,/* BLANK FIELD        @Y30LB11*/ 02800000
*      2 *(30) CHAR(1) INIT((30)'40'X);/*                    @Y30LB11*/ 02801000
*   DCL                                                            0733 02802000
*     SCCSN2# FIXED(15) CONSTANT(1);/* CSN2 INSERT           @Y30LB11*/ 02803000
*   DCL                                                            0734 02804000
*     SCDATE# FIXED(15) CONSTANT(2);/* DATE INSERT           @Y30LB11*/ 02805000
*   DCL                                                            0735 02806000
*     SCECBLEN FIXED(15) CONSTANT(4);/* ECB LENGTH           @Y30LB11*/ 02807000
*   DCL                                                            0736 02808000
*     SCNOCSNS BIT(8) CONSTANT('23'X);/* NEITHER CSN FOUND   @Y30LB11*/ 02809000
*   DCL                                                            0737 02810000
*     SCNOCSN1 BIT(8) CONSTANT('26'X);/* CSN1 NOT FOUND      @Y30LB11*/ 02811000
*   DCL                                                            0738 02812000
*     SCNOCSN2 BIT(8) CONSTANT('2A'X);/* CSN2 NOT FOUND      @Y30LB11*/ 02813000
*   DCL                                                            0739 02814000
*     SCCOMMSG CHAR(3) CONSTANT('CM0');/* STATIC TEST MOD    @Y30LB11*/ 02815000
*   DCL                                                            0740 02816000
*     SCM0088I PTR(8) CONSTANT(18); /* CARTS SCRATCHED       @Y30LB11*/ 02817000
*   DCL                                                            0741 02818000
*     SCM0098I PTR(8) CONSTANT(2);  /* LOCATION OF VOLUME    @Y30LB11*/ 02819000
*   DCL                                                            0742 02820000
*     SCM2076I PTR(8) CONSTANT(30); /* CART NOT SCRATCHED    @Y30LB11*/ 02821000
*   DCL                                                            0743 02822000
*     SCM2087I PTR(8) CONSTANT(19); /* CARTS NOT IN LIBRARY  @Y30LB11*/ 02823000
*                                                                  0744 02824000
*   /*****************************************************************/ 02825000
*   /*                                                               */ 02826000
*   /* TRACE AT ENTRY TO SCRCOPY PROCEDURE                   @Y30LB11*/ 02827000
*   /*                                                               */ 02828000
*   /*****************************************************************/ 02829000
*                                                                  0744 02830000
*   OLDERID2=NEWERID2;                                             0744 02831000
         L     @15,@PC00001                                        0744 02832000
         L     @14,GDTTR2(,@15)                                    0744 02833000
         MVC   @TS00001(95),NEWERID2(@14)                          0744 02834000
         MVC   OLDERID2(95,@14),@TS00001                           0744 02835000
*   NEWID2='SCSC';                  /*                       @Y30LB11*/ 02836000
*                                                                  0745 02837000
         MVC   NEWID2(4,@14),@CC01277                              0745 02838000
*   /*****************************************************************/ 02839000
*   /*                                                               */ 02840000
*   /* INITIALIZATION CONSISTS OF ZEROING THE RETURN CODE, ZEROING   */ 02841000
*   /* THE DEFLIST, AND THE PRINT ARGUMENT LIST.             @Y30LB11*/ 02842000
*   /*                                                               */ 02843000
*   /*****************************************************************/ 02844000
*                                                                  0746 02845000
*   SCRCOND=0;                      /*                       @Y30LB11*/ 02846000
         SLR   @14,@14                                             0746 02847000
         LR    SCRCOND,@14                                         0746 02848000
*   SCDDSTRU=ADDR(SCDARG);          /*                       @Y30LB11*/ 02849000
         LA    @09,SCDARG                                          0747 02850000
         ST    @09,SCDDSTRU                                        0747 02851000
*   SCDEFPTR=ADDR(SCDEFLST);        /*                       @Y30LB11*/ 02852000
         LA    @08,SCDEFLST                                        0748 02853000
         ST    @08,SCDEFPTR                                        0748 02854000
*   SCDEFLST=''B;                   /*                       @Y30LB11*/ 02855000
         XC    SCDEFLST(132),SCDEFLST                              0749 02856000
*   SCDARG=''B;                     /*                       @Y30LB11*/ 02857000
         XC    SCDARG(36),SCDARG                                   0750 02858000
*   SCDDSTRU->DARGSMOD=SCCOMMSG;    /* COMMON MESSAGE MODULE @Y30LB11*/ 02859000
*                                                                  0751 02860000
         MVC   DARGSMOD(3,@09),@CC01105                            0751 02861000
*   /*****************************************************************/ 02862000
*   /*                                                               */ 02863000
*   /* INDICATE AN INACTIVE VOLUME IS TO BE SCRATCHED AND PICK UP THE*/ 02864000
*   /* CSN1 FROM THE COPY RECORD.                            @Y30LB11*/ 02865000
*   /*                                                               */ 02866000
*   /*****************************************************************/ 02867000
*                                                                  0752 02868000
*   SCDEFPTR->DEFVELTR=ON;          /*                       @Y30LB11*/ 02869000
         OI    DEFVELTR(@08),B'00001000'                           0752 02870000
*   SCDEFPTR->DEFVCSN1=COPCSN1;     /*                       @Y30LB11*/ 02871000
*                                                                  0753 02872000
         MVC   DEFVCSN1(12,@08),COPCSN1(COPYVPTR)                  0753 02873000
*   /*****************************************************************/ 02874000
*   /*                                                               */ 02875000
*   /* FULL REGION DUMP BEFORE EXECUTING THE ICBDEFV MACRO.  @Y30LB11*/ 02876000
*   /*                                                               */ 02877000
*   /*****************************************************************/ 02878000
*                                                                  0754 02879000
*   IF GDTDBG=NULLPTR THEN                                         0754 02880000
         C     @14,GDTDBG(,@15)                                    0754 02881000
         BE    @RT00754                                            0754 02882000
*     ;                                                            0755 02883000
*   ELSE                                                           0756 02884000
*     CALL IDCDB010(GDTTBL,'SCDF'); /*                       @Y30LB11*/ 02885000
*                                                                  0756 02886000
         L     @15,@PC00001                                        0756 02887000
         ST    @15,@AL00001                                        0756 02888000
         LA    @14,@CC01278                                        0756 02889000
         ST    @14,@AL00001+4                                      0756 02890000
         MVI   @AL00001+4,X'80'                                    0756 02891000
         L     @15,GDTDBG(,@15)                                    0756 02892000
         LA    @01,@AL00001                                        0756 02893000
         BALR  @14,@15                                             0756 02894000
*   /*****************************************************************/ 02895000
*   /*                                                               */ 02896000
*   /* THE USSC MACRO IS ISSUED TO EXECUTE THE ICBDEFV MACRO @Y30LB11*/ 02897000
*   /* TO SCRATCH THE COPY.                                  @Y30LB11*/ 02898000
*   /*                                                               */ 02899000
*   /*****************************************************************/ 02900000
*                                                                  0757 02901000
*   CALL IDCSASS0(GDTTBL,DEFINE,SCDEFPTR,SCMSGCD,SCECBCD,SCMSGPTR);/*   02902000
*                                                            @Y30LB11*/ 02903000
@RT00754 L     @02,@PC00001                                        0757 02904000
         ST    @02,@AL00001                                        0757 02905000
         LA    @15,DEFINE                                          0757 02906000
         ST    @15,@AL00001+4                                      0757 02907000
         LA    @15,SCDEFPTR                                        0757 02908000
         ST    @15,@AL00001+8                                      0757 02909000
         LA    @15,SCMSGCD                                         0757 02910000
         ST    @15,@AL00001+12                                     0757 02911000
         LA    @15,SCECBCD                                         0757 02912000
         ST    @15,@AL00001+16                                     0757 02913000
         LA    @15,SCMSGPTR                                        0757 02914000
         ST    @15,@AL00001+20                                     0757 02915000
         MVI   @AL00001+20,X'80'                                   0757 02916000
         L     @15,GDTSSC(,@02)                                    0757 02917000
         LA    @01,@AL00001                                        0757 02918000
         BALR  @14,@15                                             0757 02919000
*   RESPECIFY                                                      0758 02920000
*     RTNREG RSTD;                                                 0758 02921000
*   TESTRC=RTNREG;                                                 0759 02922000
         LR    TESTRC,RTNREG                                       0759 02923000
*   RESPECIFY                                                      0760 02924000
*     RTNREG UNRSTD;                /*                       @Y30LB11*/ 02925000
*                                                                  0761 02926000
*   /*****************************************************************/ 02927000
*   /*                                                               */ 02928000
*   /* A RETURN CODE OF 0 OR 12 INDICATES THAT THE MACRO WAS EXECUTED*/ 02929000
*   /* SUCCESSFULLY.                                         @Y30LB11*/ 02930000
*   /*                                                               */ 02931000
*   /*****************************************************************/ 02932000
*                                                                  0761 02933000
*   IF TESTRC=0|TESTRC=12 THEN      /*                       @Y30LB11*/ 02934000
         LTR   TESTRC,TESTRC                                       0761 02935000
         BZ    @RT00761                                            0761 02936000
         C     TESTRC,@CF00035                                     0761 02937000
         BNE   @RF00761                                            0761 02938000
@RT00761 DS    0H                                                  0762 02939000
*     DO;                           /*                       @Y30LB11*/ 02940000
*                                                                  0762 02941000
*       /*************************************************************/ 02942000
*       /*                                                           */ 02943000
*       /* IF A RETURN CODE OF 12 IS PASSED, SCERRFLG IS SET ON TO   */ 02944000
*       /* INDICATE THAT THE INVENTORY RECORD WAS NOT UPDATED.       */ 02945000
*       /*                                                   @Y30LB11*/ 02946000
*       /*                                                           */ 02947000
*       /*************************************************************/ 02948000
*                                                                  0763 02949000
*       IF TESTRC=12 THEN           /*                       @Y30LB11*/ 02950000
         C     TESTRC,@CF00035                                     0763 02951000
         BNE   @RF00763                                            0763 02952000
*         SCERRFLG=ON;              /*                       @Y30LB11*/ 02953000
*                                                                  0764 02954000
         L     @15,@PC00008                                        0764 02955000
         OI    SCERRFLG(@15),B'10000000'                           0764 02956000
*       /*************************************************************/ 02957000
*       /*                                                           */ 02958000
*       /* THE MESSAGE: CARTRIDGES CSN (CSN) SCRATCHED FOR COPY      */ 02959000
*       /* YYDDD, IS ISSUED.                                 @Y30LB11*/ 02960000
*       /*                                                           */ 02961000
*       /*************************************************************/ 02962000
*                                                                  0765 02963000
*       SCCMPTR=SCMSGPTR+SCECBLEN;  /*                       @Y30LB11*/ 02964000
@RF00763 LA    @15,4                                               0765 02965000
         L     SCCMPTR,SCMSGPTR                                    0765 02966000
         ALR   SCCMPTR,@15                                         0765 02967000
*       SCDDSTRU->DARGSENT=SCM0088I;/*                       @Y30LB11*/ 02968000
         L     @03,SCDDSTRU                                        0766 02969000
         MVI   DARGSENT(@03),X'12'                                 0766 02970000
*       SCDDSTRU->DARGDBP=ADDR(SCCMPTR->CMCSN1);/*           @Y30LB11*/ 02971000
         LA    @14,CMCSN1(,SCCMPTR)                                0767 02972000
         ST    @14,DARGDBP(,@03)                                   0767 02973000
*       SCDDSTRU->DARGILP=LENGTH(CMCSN1);/*                  @Y30LB11*/ 02974000
         LA    @14,12                                              0768 02975000
         STH   @14,DARGILP(,@03)                                   0768 02976000
*       SCDDSTRU->DARGCNT=2;        /*                       @Y30LB11*/ 02977000
         LA    @09,2                                               0769 02978000
         STH   @09,DARGCNT(,@03)                                   0769 02979000
*       SCDDSTRU->DARGINS(1)=SCCSN2#;/*                      @Y30LB11*/ 02980000
         MVC   DARGINS(2,@03),@CH00213                             0770 02981000
*       SCDDSTRU->DARGINL(1)=LENGTH(CMCSN2);/*               @Y30LB11*/ 02982000
         STH   @14,DARGINL(,@03)                                   0771 02983000
*       SCDDSTRU->DARGDTM(1)=ADDR(SCCMPTR->CMCSN2);/*        @Y30LB11*/ 02984000
         LA    @14,CMCSN2(,SCCMPTR)                                0772 02985000
         ST    @14,DARGDTM(,@03)                                   0772 02986000
*       SCDDSTRU->DARGINS(2)=SCDATE#;/*                      @Y30LB11*/ 02987000
         STH   @09,DARGINS+8(,@03)                                 0773 02988000
*       SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*              @Y30LB11*/ 02989000
         STH   @15,DARGINL+8(,@03)                                 0774 02990000
*       SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*                @Y30LB11*/ 02991000
         LA    @02,COPDATE(,COPYVPTR)                              0775 02992000
         ST    @02,DARGDTM+8(,@03)                                 0775 02993000
*       CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*            @Y30LB11*/ 02994000
*                                                                  0776 02995000
         L     @15,@PC00001                                        0776 02996000
         ST    @15,@AL00001                                        0776 02997000
         LA    @14,@CF00111                                        0776 02998000
         ST    @14,@AL00001+4                                      0776 02999000
         LA    @14,SCDDSTRU                                        0776 03000000
         ST    @14,@AL00001+8                                      0776 03001000
         MVI   @AL00001+8,X'80'                                    0776 03002000
         L     @15,GDTPRT(,@15)                                    0776 03003000
         LA    @01,@AL00001                                        0776 03004000
         BALR  @14,@15                                             0776 03005000
*       /*************************************************************/ 03006000
*       /*                                                           */ 03007000
*       /* BECAUSE THE MESSAGE AREA POINTER IS SET, AND THE ICBDEFV  */ 03008000
*       /* MACRO IS SUCCESSFUL, THE UFSPACE IS ISSUED TO FREE THE    */ 03009000
*       /* ECB/MESSAGE AREA GOTTEN BY THE ICBDEFV MACRO.     @Y30LB11*/ 03010000
*       /*                                                           */ 03011000
*       /*************************************************************/ 03012000
*                                                                  0777 03013000
*       CALL IDCSAFS0(GDTTBL,SCMSGPTR);/*                    @Y30LB11*/ 03014000
         L     @15,@PC00001                                        0777 03015000
         ST    @15,@AL00001                                        0777 03016000
         LA    @14,SCMSGPTR                                        0777 03017000
         ST    @14,@AL00001+4                                      0777 03018000
         L     @15,GDTFSP(,@15)                                    0777 03019000
         LA    @01,@AL00001                                        0777 03020000
         BALR  @14,@15                                             0777 03021000
*     END;                          /*                       @Y30LB11*/ 03022000
*                                                                  0779 03023000
*   /*****************************************************************/ 03024000
*   /*                                                               */ 03025000
*   /* A RETURN CODE OF 4 OR 8 INDICATES THAT THE MACRO WAS NOT      */ 03026000
*   /* EXECUTED SUCCESSFULLY.                                @Y30LB11*/ 03027000
*   /*                                                               */ 03028000
*   /*****************************************************************/ 03029000
*                                                                  0779 03030000
*   ELSE                            /*                       @Y30LB11*/ 03031000
*     DO;                           /*                       @Y30LB11*/ 03032000
*                                                                  0779 03033000
         B     @RC00761                                            0779 03034000
@RF00761 DS    0H                                                  0780 03035000
*       /*************************************************************/ 03036000
*       /*                                                           */ 03037000
*       /* A RETURN CODE OF 8 FROM THE ICBDEFV MACRO INDICATES THAT  */ 03038000
*       /* NO CORE WAS AVAILABLE FOR THE ECB/MESSAGE AREA. THE       */ 03039000
*       /* MESSAGE: ** CART CSN (CSN) NOT SCRATCHED COPY YYDDD, IS   */ 03040000
*       /* ISSUED AND THE RETURN CODE IS SET TO 8.           @Y30LB11*/ 03041000
*       /*                                                           */ 03042000
*       /*************************************************************/ 03043000
*                                                                  0780 03044000
*       IF TESTRC=8 THEN            /*                       @Y30LB11*/ 03045000
         C     TESTRC,@CF00173                                     0780 03046000
         BNE   @RF00780                                            0780 03047000
*         DO;                       /*                       @Y30LB11*/ 03048000
*           SCDDSTRU->DARGSENT=SCM2087I;/*                   @Y30LB11*/ 03049000
         L     @15,SCDDSTRU                                        0782 03050000
         MVI   DARGSENT(@15),X'13'                                 0782 03051000
*           SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*               @Y30LB11*/ 03052000
         LA    @14,COPCSN1(,COPYVPTR)                              0783 03053000
         ST    @14,DARGDBP(,@15)                                   0783 03054000
*           SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*             @Y30LB11*/ 03055000
         LA    @14,12                                              0784 03056000
         STH   @14,DARGILP(,@15)                                   0784 03057000
*           SCDDSTRU->DARGCNT=2;    /*                       @Y30LB11*/ 03058000
         LA    @09,2                                               0785 03059000
         STH   @09,DARGCNT(,@15)                                   0785 03060000
*           SCDDSTRU->DARGINS(1)=SCCSN2#;/*                  @Y30LB11*/ 03061000
         MVC   DARGINS(2,@15),@CH00213                             0786 03062000
*           SCDDSTRU->DARGINL(1)=LENGTH(COPCSN2);/*          @Y30LB11*/ 03063000
         STH   @14,DARGINL(,@15)                                   0787 03064000
*           SCDDSTRU->DARGDTM(1)=ADDR(COPCSN2);/*            @Y30LB11*/ 03065000
         LA    @14,COPCSN2(,COPYVPTR)                              0788 03066000
         ST    @14,DARGDTM(,@15)                                   0788 03067000
*           SCDDSTRU->DARGINS(2)=SCDATE#;/*                  @Y30LB11*/ 03068000
         STH   @09,DARGINS+8(,@15)                                 0789 03069000
*           SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*          @Y30LB11*/ 03070000
         MVC   DARGINL+8(2,@15),@CH00041                           0790 03071000
*           SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*            @Y30LB11*/ 03072000
         LA    @14,COPDATE(,COPYVPTR)                              0791 03073000
         ST    @14,DARGDTM+8(,@15)                                 0791 03074000
*           CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*        @Y30LB11*/ 03075000
*                                                                  0792 03076000
         L     @15,@PC00001                                        0792 03077000
         ST    @15,@AL00001                                        0792 03078000
         LA    @14,@CF00111                                        0792 03079000
         ST    @14,@AL00001+4                                      0792 03080000
         LA    @14,SCDDSTRU                                        0792 03081000
         ST    @14,@AL00001+8                                      0792 03082000
         MVI   @AL00001+8,X'80'                                    0792 03083000
         L     @15,GDTPRT(,@15)                                    0792 03084000
         LA    @01,@AL00001                                        0792 03085000
         BALR  @14,@15                                             0792 03086000
*           /*********************************************************/ 03087000
*           /*                                                       */ 03088000
*           /* SET THE RETURN CODE TO 8 INDICATING THAT THE USSC     */ 03089000
*           /* UMACRO COULD NOT OBTAIN STORAGE FOR THE ECB/MESSAGE   */ 03090000
*           /* AREA.                                         @Y30LB11*/ 03091000
*           /*                                                       */ 03092000
*           /*********************************************************/ 03093000
*                                                                  0793 03094000
*           SCRCOND=8;              /*                       @Y30LB11*/ 03095000
         LA    SCRCOND,8                                           0793 03096000
*         END;                      /*                       @Y30LB11*/ 03097000
*                                                                  0794 03098000
*       /*************************************************************/ 03099000
*       /*                                                           */ 03100000
*       /* A RETURN CODE OF 4 INDICATES THAT THE ICBDEFV MACRO WAS   */ 03101000
*       /* EXECUTED, BUT FAILED.                             @Y30LB11*/ 03102000
*       /*                                                           */ 03103000
*       /*************************************************************/ 03104000
*                                                                  0795 03105000
*       ELSE                        /*                       @Y30LB11*/ 03106000
*         DO;                       /*                       @Y30LB11*/ 03107000
*                                                                  0795 03108000
         B     @RC00780                                            0795 03109000
@RF00780 DS    0H                                                  0796 03110000
*           /*********************************************************/ 03111000
*           /*                                                       */ 03112000
*           /* THE SSCMSG ROUTINE IS CALLED TO PRINT COMMON MESSAGES */ 03113000
*           /* FROM IDCTSSS0 AND IDCTSSS1 AS DIRECTED BY THE REASON  */ 03114000
*           /* CODE PASSED BACK FROM THE ICBDEFV MACRO.      @Y30LB11*/ 03115000
*           /*                                                       */ 03116000
*           /*********************************************************/ 03117000
*                                                                  0796 03118000
*           CALL SSCMSG(SCMSGCD);   /*                       @Y30LB11*/ 03119000
*                                                                  0796 03120000
         LA    @05,SCMSGCD                                         0796 03121000
         ST    @05,@AL00001                                        0796 03122000
         LA    @01,@AL00001                                        0796 03123000
         BAL   @14,SSCMSG                                          0796 03124000
*           /*********************************************************/ 03125000
*           /*                                                       */ 03126000
*           /* IF EITHER OR BOTH CARTRIDGES ARE NOT IN THE MSF A     */ 03127000
*           /* MESSAGE INDICATING THAT SITUATION IS PRINTED. @Y30LB11*/ 03128000
*           /*                                                       */ 03129000
*           /*********************************************************/ 03130000
*                                                                  0797 03131000
*           IF SCMSGCD=SCNOCSN1|    /*                       @Y30LB11*/ 03132000
*               SCMSGCD=SCNOCSN2|   /*                       @Y30LB11*/ 03133000
*               SCMSGCD=SCNOCSNS THEN/*                      @Y30LB11*/ 03134000
         L     @05,SCMSGCD                                         0797 03135000
         C     @05,@CF01267                                        0797 03136000
         BE    @RT00797                                            0797 03137000
         C     @05,@CF01269                                        0797 03138000
         BE    @RT00797                                            0797 03139000
         C     @05,@CF01265                                        0797 03140000
         BNE   @RF00797                                            0797 03141000
@RT00797 DS    0H                                                  0798 03142000
*             DO;                   /*                       @Y30LB11*/ 03143000
*                                                                  0798 03144000
*               /*****************************************************/ 03145000
*               /*                                                   */ 03146000
*               /* SET UP TO ISSUE MESSAGE THAT CARTS ARE OUT OF THE */ 03147000
*               /* MSF.                                      @Y30LB11*/ 03148000
*               /*                                                   */ 03149000
*               /*****************************************************/ 03150000
*                                                                  0799 03151000
*               SCDDSTRU->DARGSENT=SCM2076I;/*               @Y30LB11*/ 03152000
*                                                                  0799 03153000
         L     @05,SCDDSTRU                                        0799 03154000
         MVI   DARGSENT(@05),X'1E'                                 0799 03155000
*               /*****************************************************/ 03156000
*               /*                                                   */ 03157000
*               /* INSERT COPYDATE FROM COPY RECORD          @Y30LB11*/ 03158000
*               /*                                                   */ 03159000
*               /*****************************************************/ 03160000
*                                                                  0800 03161000
*               SCDDSTRU->DARGINS(1)=SCDATE#;/*              @Y30LB11*/ 03162000
         LA    @15,2                                               0800 03163000
         STH   @15,DARGINS(,@05)                                   0800 03164000
*               SCDDSTRU->DARGINL(1)=LENGTH(COPDATE);/*      @Y30LB11*/ 03165000
         MVC   DARGINL(2,@05),@CH00041                             0801 03166000
*               SCDDSTRU->DARGDTM(1)=ADDR(COPDATE);/*        @Y30LB11*/ 03167000
*                                                                  0802 03168000
         LA    @14,COPDATE(,COPYVPTR)                              0802 03169000
         ST    @14,DARGDTM(,@05)                                   0802 03170000
*               /*****************************************************/ 03171000
*               /*                                                   */ 03172000
*               /* IF 2 CARTS OUT OF LIBRARY, INSERT 2 CSNS  @Y30LB11*/ 03173000
*               /*                                                   */ 03174000
*               /*****************************************************/ 03175000
*                                                                  0803 03176000
*               IF SCMSGCD=SCNOCSNS THEN                           0803 03177000
         CLC   SCMSGCD(4),@CF01265                                 0803 03178000
         BNE   @RF00803                                            0803 03179000
*                 DO;               /*                       @Y30LB11*/ 03180000
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*       @Y30LB11*/ 03181000
         LA    @14,COPCSN1(,COPYVPTR)                              0805 03182000
         ST    @14,DARGDBP(,@05)                                   0805 03183000
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*     @Y30LB11*/ 03184000
         LA    @14,12                                              0806 03185000
         STH   @14,DARGILP(,@05)                                   0806 03186000
*                   SCDDSTRU->DARGCNT=2;/*                   @Y30LB11*/ 03187000
         STH   @15,DARGCNT(,@05)                                   0807 03188000
*                   SCDDSTRU->DARGINS(2)=SCCSN2#;/*          @Y30LB11*/ 03189000
         MVC   DARGINS+8(2,@05),@CH00213                           0808 03190000
*                   SCDDSTRU->DARGINL(2)=LENGTH(COPCSN2);/*  @Y30LB11*/ 03191000
         STH   @14,DARGINL+8(,@05)                                 0809 03192000
*                   SCDDSTRU->DARGDTM(2)=ADDR(COPCSN2);/*    @Y30LB11*/ 03193000
         LA    @15,COPCSN2(,COPYVPTR)                              0810 03194000
         ST    @15,DARGDTM+8(,@05)                                 0810 03195000
*                 END;              /*                       @Y30LB11*/ 03196000
*                                                                  0811 03197000
*               /*****************************************************/ 03198000
*               /*                                                   */ 03199000
*               /* IF CSN1 OUT OF LIBRARY, INSERT CSN1       @Y30LB11*/ 03200000
*               /*                                                   */ 03201000
*               /*****************************************************/ 03202000
*                                                                  0812 03203000
*               IF SCMSGCD=SCNOCSN1 THEN                           0812 03204000
@RF00803 CLC   SCMSGCD(4),@CF01267                                 0812 03205000
         BNE   @RF00812                                            0812 03206000
*                 DO;               /*                       @Y30LB11*/ 03207000
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*       @Y30LB11*/ 03208000
         L     @05,SCDDSTRU                                        0814 03209000
         LA    @15,COPCSN1(,COPYVPTR)                              0814 03210000
         ST    @15,DARGDBP(,@05)                                   0814 03211000
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*     @Y30LB11*/ 03212000
         MVC   DARGILP(2,@05),@CH00035                             0815 03213000
*                   SCDDSTRU->DARGCNT=1;/*                   @Y30LB11*/ 03214000
         MVC   DARGCNT(2,@05),@CH00213                             0816 03215000
*                 END;              /*                       @Y30LB11*/ 03216000
*                                                                  0817 03217000
*               /*****************************************************/ 03218000
*               /*                                                   */ 03219000
*               /* IF CSN2 OUT OF LIBRARY, INSERT CSN2       @Y30LB11*/ 03220000
*               /*                                                   */ 03221000
*               /*****************************************************/ 03222000
*                                                                  0818 03223000
*               IF SCMSGCD=SCNOCSN2 THEN                           0818 03224000
@RF00812 CLC   SCMSGCD(4),@CF01269                                 0818 03225000
         BNE   @RF00818                                            0818 03226000
*                 DO;               /*                       @Y30LB11*/ 03227000
*                   SCDDSTRU->DARGDBP=ADDR(COPCSN2);/*       @Y30LB11*/ 03228000
         L     @05,SCDDSTRU                                        0820 03229000
         LA    @15,COPCSN2(,COPYVPTR)                              0820 03230000
         ST    @15,DARGDBP(,@05)                                   0820 03231000
*                   SCDDSTRU->DARGILP=LENGTH(COPCSN2);/*     @Y30LB11*/ 03232000
         MVC   DARGILP(2,@05),@CH00035                             0821 03233000
*                   SCDDSTRU->DARGCNT=1;/*                   @Y30LB11*/ 03234000
         MVC   DARGCNT(2,@05),@CH00213                             0822 03235000
*                 END;              /*                       @Y30LB11*/ 03236000
*                                                                  0823 03237000
*               /*****************************************************/ 03238000
*               /*                                                   */ 03239000
*               /* ISSUE THE UPRINT MACRO TO PRINT THE MESSAGE       */ 03240000
*               /*                                                   */ 03241000
*               /*****************************************************/ 03242000
*                                                                  0824 03243000
*                                   /*                       @Y30LB11*/ 03244000
*               CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*    @Y30LB11*/ 03245000
*                                                                  0824 03246000
@RF00818 L     @05,@PC00001                                        0824 03247000
         ST    @05,@AL00001                                        0824 03248000
         LA    @15,@CF00111                                        0824 03249000
         ST    @15,@AL00001+4                                      0824 03250000
         LA    @15,SCDDSTRU                                        0824 03251000
         ST    @15,@AL00001+8                                      0824 03252000
         MVI   @AL00001+8,X'80'                                    0824 03253000
         L     @15,GDTPRT(,@05)                                    0824 03254000
         LA    @01,@AL00001                                        0824 03255000
         BALR  @14,@15                                             0824 03256000
*               /*****************************************************/ 03257000
*               /*                                                   */ 03258000
*               /* IF THE LOCATION OF THE VOLUME HAS BEEN DETERMINED */ 03259000
*               /* THE MESSAGE: ** LOCATION OF VOLUME: (LOCATION), IS*/ 03260000
*               /* ISSUED.                                   @Y30LB11*/ 03261000
*               /*                                                   */ 03262000
*               /*****************************************************/ 03263000
*                                                                  0825 03264000
*               IF COPDEST^=SCBLANKS THEN/*                  @Y30LB11*/ 03265000
         CLC   COPDEST(30,COPYVPTR),SCBLANKS                       0825 03266000
         BE    @RF00825                                            0825 03267000
*                 DO;               /*                       @Y30LB11*/ 03268000
*                   SCDARG=''B;     /*                       @Y30LB11*/ 03269000
         XC    SCDARG(36),SCDARG                                   0827 03270000
*                   SCDDSTRU->DARGSENT=SCM0098I;/*           @Y30LB11*/ 03271000
         L     @05,SCDDSTRU                                        0828 03272000
         MVI   DARGSENT(@05),X'02'                                 0828 03273000
*                   SCDDSTRU->DARGSMOD=SCCOMMSG;/*           @Y30LB11*/ 03274000
         MVC   DARGSMOD(3,@05),@CC01105                            0829 03275000
*                   SCDDSTRU->DARGDBP=ADDR(COPDEST);/*       @Y30LB11*/ 03276000
         LA    @15,COPDEST(,COPYVPTR)                              0830 03277000
         ST    @15,DARGDBP(,@05)                                   0830 03278000
*                   SCDDSTRU->DARGILP=LENGTH(COPDEST);/*     @Y30LB11*/ 03279000
         MVC   DARGILP(2,@05),@CH00909                             0831 03280000
*                   CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*      0832 03281000
*                                                            @Y30LB11*/ 03282000
         L     @05,@PC00001                                        0832 03283000
         ST    @05,@AL00001                                        0832 03284000
         LA    @15,@CF00111                                        0832 03285000
         ST    @15,@AL00001+4                                      0832 03286000
         LA    @15,SCDDSTRU                                        0832 03287000
         ST    @15,@AL00001+8                                      0832 03288000
         MVI   @AL00001+8,X'80'                                    0832 03289000
         L     @15,GDTPRT(,@05)                                    0832 03290000
         LA    @01,@AL00001                                        0832 03291000
         BALR  @14,@15                                             0832 03292000
*                 END;              /*                       @Y30LB11*/ 03293000
*             END;                  /*                       @Y30LB11*/ 03294000
*                                                                  0834 03295000
*           /*********************************************************/ 03296000
*           /*                                                       */ 03297000
*           /* A RETURN CODE OF 4 FROM THE ICBDEFV MACRO INDICATES   */ 03298000
*           /* THAT THE ICBDEFV MACRO FAILED. A MESSAGE INDICATING   */ 03299000
*           /* THAT COPY VOLUMES WERE NOT SCRATCHED, IS PRINTED.     */ 03300000
*           /*                                               @Y30LB11*/ 03301000
*           /*                                                       */ 03302000
*           /*********************************************************/ 03303000
*                                                                  0835 03304000
*           ELSE                                                   0835 03305000
*             DO;                   /*                       @Y30LB11*/ 03306000
         B     @RC00797                                            0835 03307000
@RF00797 DS    0H                                                  0836 03308000
*               SCDDSTRU->DARGSENT=SCM2087I;/*               @Y30LB11*/ 03309000
         L     @05,SCDDSTRU                                        0836 03310000
         MVI   DARGSENT(@05),X'13'                                 0836 03311000
*               SCDDSTRU->DARGDBP=ADDR(COPCSN1);/*           @Y30LB11*/ 03312000
         LA    @15,COPCSN1(,COPYVPTR)                              0837 03313000
         ST    @15,DARGDBP(,@05)                                   0837 03314000
*               SCDDSTRU->DARGILP=LENGTH(COPCSN1);/*         @Y30LB11*/ 03315000
         LA    @15,12                                              0838 03316000
         STH   @15,DARGILP(,@05)                                   0838 03317000
*               SCDDSTRU->DARGCNT=2;/*                       @Y30LB11*/ 03318000
         LA    @14,2                                               0839 03319000
         STH   @14,DARGCNT(,@05)                                   0839 03320000
*               SCDDSTRU->DARGINS(1)=SCCSN2#;/*              @Y30LB11*/ 03321000
         MVC   DARGINS(2,@05),@CH00213                             0840 03322000
*               SCDDSTRU->DARGINL(1)=LENGTH(COPCSN2);/*      @Y30LB11*/ 03323000
         STH   @15,DARGINL(,@05)                                   0841 03324000
*               SCDDSTRU->DARGDTM(1)=ADDR(COPCSN2);/*        @Y30LB11*/ 03325000
         LA    @15,COPCSN2(,COPYVPTR)                              0842 03326000
         ST    @15,DARGDTM(,@05)                                   0842 03327000
*               SCDDSTRU->DARGINS(2)=SCDATE#;/*              @Y30LB11*/ 03328000
         STH   @14,DARGINS+8(,@05)                                 0843 03329000
*               SCDDSTRU->DARGINL(2)=LENGTH(COPDATE);/*      @Y30LB11*/ 03330000
         MVC   DARGINL+8(2,@05),@CH00041                           0844 03331000
*               SCDDSTRU->DARGDTM(2)=ADDR(COPDATE);/*        @Y30LB11*/ 03332000
         LA    @15,COPDATE(,COPYVPTR)                              0845 03333000
         ST    @15,DARGDTM+8(,@05)                                 0845 03334000
*               CALL AMSTP011(GDTTBL,PRTFILE,SCDDSTRU);/*    @Y30LB11*/ 03335000
         L     @05,@PC00001                                        0846 03336000
         ST    @05,@AL00001                                        0846 03337000
         LA    @15,@CF00111                                        0846 03338000
         ST    @15,@AL00001+4                                      0846 03339000
         LA    @15,SCDDSTRU                                        0846 03340000
         ST    @15,@AL00001+8                                      0846 03341000
         MVI   @AL00001+8,X'80'                                    0846 03342000
         L     @15,GDTPRT(,@05)                                    0846 03343000
         LA    @01,@AL00001                                        0846 03344000
         BALR  @14,@15                                             0846 03345000
*             END;                  /*                       @Y30LB11*/ 03346000
*                                                                  0847 03347000
*           /*********************************************************/ 03348000
*           /*                                                       */ 03349000
*           /* INDICATE THAT SCRCOPY FAILED WITH A RETURN CODE OF 4. */ 03350000
*           /*                                                       */ 03351000
*           /*********************************************************/ 03352000
*                                                                  0848 03353000
*                                   /*                       @Y30LB11*/ 03354000
*           SCRCOND=4;              /*                       @Y30LB11*/ 03355000
@RC00797 LA    SCRCOND,4                                           0848 03356000
*         END;                      /*                       @Y30LB11*/ 03357000
*     END;                          /*                       @Y30LB11*/ 03358000
*                                                                  0850 03359000
@RC00780 DS    0H                                                  0851 03360000
*   /*****************************************************************/ 03361000
*   /*                                                               */ 03362000
*   /* RETURN TO SCRCOPY CALLER                              @Y30LB11*/ 03363000
*   /*                                                               */ 03364000
*   /*****************************************************************/ 03365000
*                                                                  0851 03366000
*   RETURN CODE(SCRCOND);           /*                       @Y30LB11*/ 03367000
@RC00761 LR    @15,SCRCOND                                         0851 03368000
         L     @14,@SA00008                                        0851 03369000
         LM    @00,@12,@SA00008+8                                  0851 03370000
         BR    @14                                                 0851 03371000
*   END SCRCOPY;                    /*                       @Y30LB11*/ 03372000
*                                                                  0853 03373000
*/********************************************************************/ 03374000
*/*                                                          @Y30LB11*/ 03375000
*/* PROCEDURE NAME - UNITCHK                                 @Y30LB11*/ 03376000
*/*                                                          @Y30LB11*/ 03377000
*/* FUNCTION - THE FUNCTION OF THIS ROUTINE IS TO CHECK      @Y30LB11*/ 03378000
*/*            OR ASSIGN A UNIT.                             @Y30LB11*/ 03379000
*/*                                                          @Y30LB11*/ 03380000
*/* INPUT - THE FDT, CKAGL, VS1AGL, MDAGL, AND ALLAGL        @Y30LB11*/ 03381000
*/*         MACROS ARE USED AS INPUT TO THE UNITCHK ROUTINE. @Y30LB11*/ 03382000
*/*         NOVTOCCK IS ON IF THE VTOC NEEDS TO BE CHECKED.  @Y30LB11*/ 03383000
*/*         IF IT IS ON, UNITCHK ASSIGNS A UNIT FOR MOUNTING @Y30LB11*/ 03384000
*/*         THE VOLUME.                                      @Y30LB11*/ 03385000
*/*                                                          @Y30LB11*/ 03386000
*/* OUTPUT - RETURN CODE IS PASSED IN REGISTER 15.           @Y30LB11*/ 03387000
*/*          VS1AGL AND MDAGL ARE INITIALIZED WITH DDNAME    @Y30LB11*/ 03388000
*/*          ALLOCFLG SET IF UNIT WAS DYNAMICALLY ALLOCATED. @Y30LB11*/ 03389000
*/*                                                          @Y30LB11*/ 03390000
*/*          0 - ALL FUNCTIONS WERE COMPLETED SUCCESSFULLY   @Y30LB11*/ 03391000
*/*                                                          @Y30LB11*/ 03392000
*/*          4 - UNIT SPECIFIED WAS NOT A VIRTUAL UNIT,      @Y30LB11*/ 03393000
*/*              OR DID NOT HAVE EXCLUSIVE CONTROL, OR       @Y30LB11*/ 03394000
*/*              UNIT COULD NOT BE OBTAINED.                 @Y30LB11*/ 03395000
*/*                                                          @Y30LB11*/ 03396000
*/********************************************************************/ 03397000
*                                                                  0853 03398000
*UNITCHK:                                                          0853 03399000
*   PROC;                           /*                       @Y30LB11*/ 03400000
UNITCHK  STM   @14,@12,@SA00009                                    0853 03401000
*   DCL                                                            0854 03402000
*     UNITCOND FIXED(15);           /*                       @Y30LB11*/ 03403000
*                                                                  0855 03404000
*   /*****************************************************************/ 03405000
*   /*                                                               */ 03406000
*   /* TRACE AT ENTRY TO UNITCHK PROCEDURE                   @Y30LB11*/ 03407000
*   /*                                                               */ 03408000
*   /*****************************************************************/ 03409000
*                                                                  0855 03410000
*   OLDERID2=NEWERID2;                                             0855 03411000
         L     @15,@PC00001                                        0855 03412000
         L     @14,GDTTR2(,@15)                                    0855 03413000
         MVC   @TS00001(95),NEWERID2(@14)                          0855 03414000
         MVC   OLDERID2(95,@14),@TS00001                           0855 03415000
*   NEWID2='SVUC';                  /*                       @Y30LB11*/ 03416000
*                                                                  0856 03417000
         MVC   NEWID2(4,@14),@CC01283                              0856 03418000
*   /*****************************************************************/ 03419000
*   /*                                                               */ 03420000
*   /* UNITCHK RETURN CODE IS INITIALIZED TO ZERO.           @Y30LB11*/ 03421000
*   /*                                                               */ 03422000
*   /*****************************************************************/ 03423000
*                                                                  0857 03424000
*   UNITCOND=0;                     /*                       @Y30LB11*/ 03425000
         SLR   @14,@14                                             0857 03426000
         LR    UNITCOND,@14                                        0857 03427000
*   UCBPTR=NULLPTR;                 /*                       @YD00175*/ 03428000
         ST    @14,UCBPTR                                          0858 03429000
*                                                                  0859 03430000
*   /*****************************************************************/ 03431000
*   /*                                                               */ 03432000
*   /* CHECK IF THERE IS A FILE PARAMETER SPECIFIED. IF SO,  @Y30LB11*/ 03433000
*   /* INITIALIZE THE CKAGL MAPPING MACRO TO CHECK THE UNIT  @Y30LB11*/ 03434000
*   /* FOR VIRTUAL DEVICE TYPE                               @YD00175*/ 03435000
*   /*                                                               */ 03436000
*   /*****************************************************************/ 03437000
*                                                                  0859 03438000
*   IF ADDR(FILE)^=NULLPTR THEN     /*                       @Y30LB11*/ 03439000
         L     @09,@PC00001+4                                      0859 03440000
         L     @09,FDTPTR+20(,@09)                                 0859 03441000
         CR    @09,@14                                             0859 03442000
         BE    @RF00859                                            0859 03443000
*     DO;                           /*                       @Y30LB11*/ 03444000
*       UCBPTR=NULLPTR;             /*                       @Y30LB11*/ 03445000
         ST    @14,UCBPTR                                          0861 03446000
*       CKUCBPTR=ADDR(UCBPTR);      /*                       @Y30LB11*/ 03447000
         LA    @02,CKAGAREA                                        0862 03448000
         LA    @08,UCBPTR                                          0862 03449000
         ST    @08,CKUCBPTR(,@02)                                  0862 03450000
*       CKDDNAME=FILEVAL;           /*                       @Y30LB11*/ 03451000
         MVC   CKDDNAME(8,@02),FILEVAL(@09)                        0863 03452000
*       CKTESTVT=ON;                /*                       @Y30LB11*/ 03453000
*                                                                  0864 03454000
         OI    CKTESTVT(@02),B'10000000'                           0864 03455000
*       /*************************************************************/ 03456000
*       /*                                                           */ 03457000
*       /* ISSUE THE UMSSUNIT UMACRO.                        @Y30LB11*/ 03458000
*       /*                                                           */ 03459000
*       /*************************************************************/ 03460000
*                                                                  0865 03461000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/*                 @Y30LB11*/ 03462000
         ST    @15,@AL00001                                        0865 03463000
         LA    @14,CHECK                                           0865 03464000
         ST    @14,@AL00001+4                                      0865 03465000
         ST    @02,@AL00001+8                                      0865 03466000
         MVI   @AL00001+8,X'80'                                    0865 03467000
         L     @15,GDTUNT(,@15)                                    0865 03468000
         LA    @01,@AL00001                                        0865 03469000
         BALR  @14,@15                                             0865 03470000
*       RESPECIFY                                                  0866 03471000
*         RTNREG RSTD;                                             0866 03472000
*       TESTRC=RTNREG;                                             0867 03473000
         LR    TESTRC,RTNREG                                       0867 03474000
*       RESPECIFY                                                  0868 03475000
*         RTNREG UNRSTD;            /*                       @Y30LB11*/ 03476000
*                                                                  0868 03477000
*       /*************************************************************/ 03478000
*       /*                                                           */ 03479000
*       /* IF THE CHECK WAS SUCCESSFUL, SET THE DDNAME IN THE        */ 03480000
*       /* ARGUMENT LIST FOR IDCVS01(SECURITY CHECK) AND             */ 03481000
*       /* UMSSUNIT(DEMOUNT).                                @Y30LB11*/ 03482000
*       /*                                                           */ 03483000
*       /*************************************************************/ 03484000
*                                                                  0869 03485000
*       IF TESTRC=0 THEN            /*                       @Y30LB11*/ 03486000
         LTR   TESTRC,TESTRC                                       0869 03487000
         BNZ   @RF00869                                            0869 03488000
*         DO;                       /*                       @Y30LB11*/ 03489000
*           VSFILEP=ADDR(FILEVAL);  /*                       @Y30LB11*/ 03490000
         LA    @15,VSAGAREA                                        0871 03491000
         L     @14,@PC00001+4                                      0871 03492000
         L     @09,FDTPTR+20(,@14)                                 0871 03493000
         LA    @08,FILEVAL(,@09)                                   0871 03494000
         ST    @08,VSFILEP(,@15)                                   0871 03495000
*           MDDDNAME=FILEVAL;       /*                       @Y30LB11*/ 03496000
*                                                                  0872 03497000
         LA    @15,MDAGAREA                                        0872 03498000
         MVC   MDDDNAME(8,@15),FILEVAL(@09)                        0872 03499000
*           /*********************************************************/ 03500000
*           /*                                                       */ 03501000
*           /* SET UP TO GET EXCLUSIVE CONTROL               @YD00175*/ 03502000
*           /*                                                       */ 03503000
*           /*********************************************************/ 03504000
*                                                                  0873 03505000
*           EXCLUCBP=ADDR(UCBPTR);  /*                       @YD00175*/ 03506000
         LA    @09,EXCLAREA                                        0873 03507000
         LA    @15,UCBPTR                                          0873 03508000
         ST    @15,EXCLUCBP(,@09)                                  0873 03509000
*           EXCLDDP=ADDR(FILEVAL);  /*                       @YD00175*/ 03510000
         ST    @08,EXCLDDP(,@09)                                   0874 03511000
*           EXCLVOL=VOLVAL;         /*                       @YD00175*/ 03512000
*                                                                  0875 03513000
         L     @01,FDTPTR(,@14)                                    0875 03514000
         MVC   EXCLVOL(6,@09),VOLVAL(@01)                          0875 03515000
*           /*********************************************************/ 03516000
*           /*                                                       */ 03517000
*           /* IF VOLUME WAS INCOMPLETELY CREATED, GET       @YD00175*/ 03518000
*           /* EXCLUSIVE CONTROL ONLY IF THE VOLUME IS       @YD00175*/ 03519000
*           /* MOUNTED                                       @YD00175*/ 03520000
*           /*                                                       */ 03521000
*           /*********************************************************/ 03522000
*                                                                  0876 03523000
*           IF BASIVCRE=ON THEN                                    0876 03524000
         TM    BASIVCRE(BASEVPTR),B'10000000'                      0876 03525000
         BNO   @RF00876                                            0876 03526000
*             EXCLMNT=ON;           /*                       @YD00175*/ 03527000
*                                                                  0877 03528000
         OI    EXCLMNT(@09),B'10000000'                            0877 03529000
*           /*********************************************************/ 03530000
*           /*                                                       */ 03531000
*           /* ISSUE UMSSUNIT TO GET EXCLUSIVE CONTROL       @YD00175*/ 03532000
*           /*                                                       */ 03533000
*           /*********************************************************/ 03534000
*                                                                  0878 03535000
*           CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*         @YD00175*/ 03536000
@RF00876 L     @02,@PC00001                                        0878 03537000
         ST    @02,@AL00001                                        0878 03538000
         LA    @15,CHANGEX                                         0878 03539000
         ST    @15,@AL00001+4                                      0878 03540000
         LA    @15,EXCLAREA                                        0878 03541000
         ST    @15,@AL00001+8                                      0878 03542000
         MVI   @AL00001+8,X'80'                                    0878 03543000
         L     @15,GDTUNT(,@02)                                    0878 03544000
         LA    @01,@AL00001                                        0878 03545000
         BALR  @14,@15                                             0878 03546000
*           RESPECIFY                                              0879 03547000
*             RTNREG RSTD;                                         0879 03548000
*           TESTRC=RTNREG;                                         0880 03549000
         LR    TESTRC,RTNREG                                       0880 03550000
*           RESPECIFY                                              0881 03551000
*             RTNREG UNRSTD;        /*                       @YD00175*/ 03552000
*                                                                  0881 03553000
*           /*********************************************************/ 03554000
*           /*                                                       */ 03555000
*           /* IF EXCLUSIVE CONTROL NOT OBTAINED,            @YD00175*/ 03556000
*           /* SET RETURN CODE TO 4                          @YD00175*/ 03557000
*           /*                                                       */ 03558000
*           /*********************************************************/ 03559000
*                                                                  0882 03560000
*           IF TESTRC>0 THEN                                       0882 03561000
         LTR   TESTRC,TESTRC                                       0882 03562000
         BNP   @RF00882                                            0882 03563000
*             UNITCOND=4;           /*                       @YD00175*/ 03564000
         LA    UNITCOND,4                                          0883 03565000
*         END;                      /*                       #Y30LB11*/ 03566000
*                                                                  0884 03567000
*       /*************************************************************/ 03568000
*       /*                                                           */ 03569000
*       /* IF CHECK WAS NOT SUCCESSFUL, SET THE RETURN CODE TO 4.    */ 03570000
*       /*                                                   @Y30LB11*/ 03571000
*       /*                                                           */ 03572000
*       /*************************************************************/ 03573000
*                                                                  0885 03574000
*       ELSE                                                       0885 03575000
*         UNITCOND=4;               /*                       @Y30LB11*/ 03576000
         B     @RC00869                                            0885 03577000
@RF00869 LA    UNITCOND,4                                          0885 03578000
*     END;                          /*                       @Y30LB11*/ 03579000
*                                                                  0887 03580000
*   /*****************************************************************/ 03581000
*   /*                                                               */ 03582000
*   /* IF FILE WAS NOT SPECIFIED, CHECK IF NOVTOCCK IS OFF.  @YD00175*/ 03583000
*   /* IF IT IS OFF, TRY TO FIND A UCB WITH EXCLUSIVE        @YD00175*/ 03584000
*   /* CONTROL WITH THE VOLUME ON IT.                        @YD00175*/ 03585000
*   /*                                                               */ 03586000
*   /*****************************************************************/ 03587000
*                                                                  0887 03588000
*   ELSE                            /*                       @Y30LB11*/ 03589000
*     IF NOVTOCCK=OFF THEN          /*                       @Y30LB11*/ 03590000
         B     @RC00859                                            0887 03591000
@RF00859 TM    NOVTOCCK,B'00001000'                                0887 03592000
         BNZ   @RF00887                                            0887 03593000
*       DO;                         /*                       @Y30LB11*/ 03594000
*                                                                  0888 03595000
*         /***********************************************************/ 03596000
*         /*                                                         */ 03597000
*         /* SET UP FOR UMSSUNIT(SELECTX)                    @YD00175*/ 03598000
*         /*                                                         */ 03599000
*         /***********************************************************/ 03600000
*                                                                  0889 03601000
*         EXCLUCBP=ADDR(UCBPTR);    /*                       @YD00175*/ 03602000
         LA    @02,EXCLAREA                                        0889 03603000
         LA    @15,UCBPTR                                          0889 03604000
         ST    @15,EXCLUCBP(,@02)                                  0889 03605000
*         EXCLDDP=ADDR(SVFILE);     /*                       @YD00175*/ 03606000
         LA    @15,SVFILE                                          0890 03607000
         ST    @15,EXCLDDP(,@02)                                   0890 03608000
*         EXCLVOL=VOLVAL;           /*                       @YD00175*/ 03609000
*                                                                  0891 03610000
         L     @15,@PC00001+4                                      0891 03611000
         L     @01,FDTPTR(,@15)                                    0891 03612000
         MVC   EXCLVOL(6,@02),VOLVAL(@01)                          0891 03613000
*         /***********************************************************/ 03614000
*         /*                                                         */ 03615000
*         /* ISSUE UMSSUNIT(SELECTX) TO FIND UNIT            @YD00175*/ 03616000
*         /*                                                         */ 03617000
*         /***********************************************************/ 03618000
*                                                                  0892 03619000
*         CALL IDCSA060(GDTTBL,SELECTX,EXCLAGL);/*           @YD00175*/ 03620000
         L     @15,@PC00001                                        0892 03621000
         ST    @15,@AL00001                                        0892 03622000
         LA    @14,SELECTX                                         0892 03623000
         ST    @14,@AL00001+4                                      0892 03624000
         ST    @02,@AL00001+8                                      0892 03625000
         MVI   @AL00001+8,X'80'                                    0892 03626000
         L     @15,GDTUNT(,@15)                                    0892 03627000
         LA    @01,@AL00001                                        0892 03628000
         BALR  @14,@15                                             0892 03629000
*         RESPECIFY                                                0893 03630000
*           RTNREG RSTD;                                           0893 03631000
*         TESTRC=RTNREG;                                           0894 03632000
         LR    TESTRC,RTNREG                                       0894 03633000
*         RESPECIFY                                                0895 03634000
*           RTNREG UNRSTD;          /*                       @YD00175*/ 03635000
*                                                                  0895 03636000
*         /***********************************************************/ 03637000
*         /*                                                         */ 03638000
*         /* TEST RETURN CODE FOR FAILURE                    @YD00175*/ 03639000
*         /*                                                         */ 03640000
*         /***********************************************************/ 03641000
*                                                                  0896 03642000
*         IF TESTRC>0 THEN                                         0896 03643000
         LTR   TESTRC,TESTRC                                       0896 03644000
         BNP   @RF00896                                            0896 03645000
*           UNITCOND=4;             /*                       @YD00175*/ 03646000
*                                                                  0897 03647000
         LA    UNITCOND,4                                          0897 03648000
*         /***********************************************************/ 03649000
*         /*                                                         */ 03650000
*         /* OTHERWISE, TEST FOR NO UNIT FOUND. IF NOT       @YD00175*/ 03651000
*         /* FOUND, ALLOCATE A UNIT                          @YD00175*/ 03652000
*         /*                                                         */ 03653000
*         /***********************************************************/ 03654000
*                                                                  0898 03655000
*         ELSE                                                     0898 03656000
*           DO;                     /*                       @YD00175*/ 03657000
         B     @RC00896                                            0898 03658000
@RF00896 DS    0H                                                  0899 03659000
*             IF UCBPTR=NULLPTR THEN                               0899 03660000
         L     @15,UCBPTR                                          0899 03661000
         LTR   @15,@15                                             0899 03662000
         BNZ   @RF00899                                            0899 03663000
*               DO;                 /*                       @YD00175*/ 03664000
*                 ALLOPTVL=ON;      /*                       #Y30LB11*/ 03665000
         LA    @02,ALLGAREA                                        0901 03666000
         OI    ALLOPTVL(@02),B'10000000'                           0901 03667000
*                 ULP1=1;           /*                       @Y30LB11*/ 03668000
         LA    @15,1                                               0902 03669000
         STH   @15,ULP1                                            0902 03670000
*                 ULP2=LENGTH(DEVTYPE);/*                    @Y30LB11*/ 03671000
         MVC   ULP2(2),@CH00266                                    0903 03672000
*                 ULP3=DEVTYPE;     /*                       @Y30LB11*/ 03673000
         MVI   ULP3+5,C' '                                         0904 03674000
         MVC   ULP3+6(2),ULP3+5                                    0904 03675000
         MVC   ULP3(5),@CC01108                                    0904 03676000
*                 ALLULP=ADDR(ULP); /*                       @Y30LB11*/ 03677000
         LA    @14,ULP                                             0905 03678000
         ST    @14,ALLULP(,@02)                                    0905 03679000
*                 VLP1=1;           /*                       @Y30LB11*/ 03680000
         STH   @15,VLP1                                            0906 03681000
*                 VLP2=VOLLEN;      /*                       @Y30LB11*/ 03682000
         L     @15,@PC00001+4                                      0907 03683000
         L     @15,FDTPTR(,@15)                                    0907 03684000
         SLR   @14,@14                                             0907 03685000
         IC    @14,VOLLEN(,@15)                                    0907 03686000
         STH   @14,VLP2                                            0907 03687000
*                 VLP3=VOLVAL;      /*                       @Y30LB11*/ 03688000
         MVC   VLP3(6),VOLVAL(@15)                                 0908 03689000
*                 ALLVLP=ADDR(VLP); /*                       @Y30LB11*/ 03690000
         LA    @15,VLP                                             0909 03691000
         ST    @15,ALLVLP(,@02)                                    0909 03692000
*                 ALLOPTPV=ON;      /*                       @Y30LB11*/ 03693000
         OI    ALLOPTPV(@02),B'00100000'                           0910 03694000
*                 ALLVLCNT=1;       /*                       @YD00175*/ 03695000
         MVI   ALLVLCNT(@02),X'01'                                 0911 03696000
*                 ALLUNCNT=1;       /*                       @Y30LB11*/ 03697000
*                                                                  0912 03698000
         MVI   ALLUNCNT(@02),X'01'                                 0912 03699000
*                 /***************************************************/ 03700000
*                 /*                                                 */ 03701000
*                 /* ISSUE THE UALLOC UMACRO.                @Y30LB11*/ 03702000
*                 /*                                                 */ 03703000
*                 /***************************************************/ 03704000
*                                                                  0913 03705000
*                 CALL IDCSAAL0(GDTTBL,ALLAGL);/*            @Y30LB11*/ 03706000
         L     @15,@PC00001                                        0913 03707000
         ST    @15,@AL00001                                        0913 03708000
         ST    @02,@AL00001+4                                      0913 03709000
         MVI   @AL00001+4,X'80'                                    0913 03710000
         L     @15,GDTALC(,@15)                                    0913 03711000
         LA    @01,@AL00001                                        0913 03712000
         BALR  @14,@15                                             0913 03713000
*                 RESPECIFY                                        0914 03714000
*                   RTNREG RSTD;                                   0914 03715000
*                 TESTRC=RTNREG;                                   0915 03716000
         LR    TESTRC,RTNREG                                       0915 03717000
*                 RESPECIFY                                        0916 03718000
*                   RTNREG UNRSTD;  /*                       @Y30LB11*/ 03719000
*                                                                  0916 03720000
*                 /***************************************************/ 03721000
*                 /*                                                 */ 03722000
*                 /* IF ALLOCATION FAILED, SET THE CONDITION CODE TO */ 03723000
*                 /* 4.                                      @Y30LB11*/ 03724000
*                 /*                                                 */ 03725000
*                 /***************************************************/ 03726000
*                                                                  0917 03727000
*                 IF TESTRC=4 THEN  /*                       @Y30LB11*/ 03728000
         LA    @02,4                                               0917 03729000
         CR    TESTRC,@02                                          0917 03730000
         BNE   @RF00917                                            0917 03731000
*                   UNITCOND=4;     /*                       @Y30LB11*/ 03732000
*                                                                  0918 03733000
         LR    UNITCOND,@02                                        0918 03734000
*                 /***************************************************/ 03735000
*                 /*                                                 */ 03736000
*                 /* IF ALLOCATION WAS SUCCESSFUL,           @YD00175*/ 03737000
*                 /* GET EXCLUSIVE CONTROL OF THE VOLUME     @YD00175*/ 03738000
*                 /*                                                 */ 03739000
*                 /***************************************************/ 03740000
*                                                                  0919 03741000
*                 ELSE              /*                       @Y30LB11*/ 03742000
*                   DO;             /*                       @Y30LB11*/ 03743000
         B     @RC00917                                            0919 03744000
@RF00917 DS    0H                                                  0920 03745000
*                     ALLOCFLG=ON;  /*                       @Y30LB11*/ 03746000
*                                                                  0920 03747000
         OI    ALLOCFLG,B'00010000'                                0920 03748000
*                     /***********************************************/ 03749000
*                     /*                                             */ 03750000
*                     /* SET UP TO GET EXCLUSIVE CONTROL     @YD00175*/ 03751000
*                     /*                                             */ 03752000
*                     /***********************************************/ 03753000
*                                                                  0921 03754000
*                     EXCLAGL=EXCLAGL&&EXCLAGL;/*            @YD00175*/ 03755000
         LA    @02,EXCLAREA                                        0921 03756000
         XC    EXCLAGL(23,@02),EXCLAGL(@02)                        0921 03757000
*                     EXCLUCBP=ADDR(UCBPTR);/*               @YD00175*/ 03758000
         LA    @15,UCBPTR                                          0922 03759000
         ST    @15,EXCLUCBP(,@02)                                  0922 03760000
*                     EXCLDDP=ADDR(ALLDDN);/*                @YD00175*/ 03761000
         LA    @15,ALLGAREA                                        0923 03762000
         LA    @15,ALLDDN(,@15)                                    0923 03763000
         ST    @15,EXCLDDP(,@02)                                   0923 03764000
*                     EXCLVOL=VOLVAL;/*                      @YD00175*/ 03765000
*                                                                  0924 03766000
         L     @15,@PC00001+4                                      0924 03767000
         L     @01,FDTPTR(,@15)                                    0924 03768000
         MVC   EXCLVOL(6,@02),VOLVAL(@01)                          0924 03769000
*                     /***********************************************/ 03770000
*                     /*                                             */ 03771000
*                     /* ISSUE UMSSUNIT FOR EXCLUSIVE CONTROL        */ 03772000
*                     /*                                     @YD00175*/ 03773000
*                     /*                                             */ 03774000
*                     /***********************************************/ 03775000
*                                                                  0925 03776000
*                     CALL IDCSA060(GDTTBL,CHANGEX,EXCLAGL);/*     0925 03777000
*                                                            @YD00175*/ 03778000
         L     @15,@PC00001                                        0925 03779000
         ST    @15,@AL00001                                        0925 03780000
         LA    @14,CHANGEX                                         0925 03781000
         ST    @14,@AL00001+4                                      0925 03782000
         ST    @02,@AL00001+8                                      0925 03783000
         MVI   @AL00001+8,X'80'                                    0925 03784000
         L     @15,GDTUNT(,@15)                                    0925 03785000
         LA    @01,@AL00001                                        0925 03786000
         BALR  @14,@15                                             0925 03787000
*                     RESPECIFY                                    0926 03788000
*                       RTNREG RSTD;                               0926 03789000
*                     TESTRC=RTNREG;                               0927 03790000
         LR    TESTRC,RTNREG                                       0927 03791000
*                     RESPECIFY                                    0928 03792000
*                       RTNREG UNRSTD;/*                     @Y30LB11*/ 03793000
*                                                                  0928 03794000
*                     /***********************************************/ 03795000
*                     /*                                             */ 03796000
*                     /* IF THE THE CHANGE WAS SUCCESSFUL, SET THE   */ 03797000
*                     /* DDNAME IN THE ARGUMENT LIST FOR IDCVS01     */ 03798000
*                     /* (SECURITY CHECK) AND USSUNIT(DEMOUNT).      */ 03799000
*                     /*                                     @Y30LB11*/ 03800000
*                     /*                                             */ 03801000
*                     /***********************************************/ 03802000
*                                                                  0929 03803000
*                     IF TESTRC=0 THEN/*                     @Y30LB11*/ 03804000
         LTR   TESTRC,TESTRC                                       0929 03805000
         BNZ   @RF00929                                            0929 03806000
*                       DO;         /*                       @Y30LB11*/ 03807000
*                         VSFILEP=ADDR(ALLDDN);/*            @Y30LB11*/ 03808000
         LA    @15,VSAGAREA                                        0931 03809000
         LA    @14,ALLGAREA                                        0931 03810000
         LA    @09,ALLDDN(,@14)                                    0931 03811000
         ST    @09,VSFILEP(,@15)                                   0931 03812000
*                         MDDDNAME=ALLDDN;/*                 @Y30LB11*/ 03813000
         LA    @15,MDAGAREA                                        0932 03814000
         MVC   MDDDNAME(8,@15),ALLDDN(@14)                         0932 03815000
*                       END;        /*                       @Y30LB11*/ 03816000
*                                                                  0933 03817000
*                     /***********************************************/ 03818000
*                     /*                                             */ 03819000
*                     /* IF THE UNIT CHECK WAS NOT SUCCESSFUL, SET   */ 03820000
*                     /* THE CONDITION CODE TO 4.            @Y30LB11*/ 03821000
*                     /*                                             */ 03822000
*                     /***********************************************/ 03823000
*                                                                  0934 03824000
*                     ELSE          /*                       @Y30LB11*/ 03825000
*                       UNITCOND=4; /*                       @Y30LB11*/ 03826000
         B     @RC00929                                            0934 03827000
@RF00929 LA    UNITCOND,4                                          0934 03828000
*                   END;            /*                       @Y30LB11*/ 03829000
*               END;                /*                       @YD00175*/ 03830000
*                                                                  0936 03831000
*             /*******************************************************/ 03832000
*             /*                                                     */ 03833000
*             /* IF SELECTX FOUND A UNIT, SET THE DDNAME IN THE      */ 03834000
*             /*                                             @YD00175*/ 03835000
*             /* ARGUMENT LIST FOR IDCVS01 AND UMSSUNIT      @YD00175*/ 03836000
*             /*                                                     */ 03837000
*             /*******************************************************/ 03838000
*                                                                  0937 03839000
*             ELSE                                                 0937 03840000
*               DO;                 /*                       @YD00175*/ 03841000
         B     @RC00899                                            0937 03842000
@RF00899 DS    0H                                                  0938 03843000
*                 VSFILEP=EXCLDDP;  /*                       @YD00175*/ 03844000
         LA    @15,VSAGAREA                                        0938 03845000
         LA    @14,EXCLAREA                                        0938 03846000
         L     @14,EXCLDDP(,@14)                                   0938 03847000
         ST    @14,VSFILEP(,@15)                                   0938 03848000
*                 MDDDNAME=SVFILE;  /*                       @YD00175*/ 03849000
         LA    @15,MDAGAREA                                        0939 03850000
         MVC   MDDDNAME(8,@15),SVFILE                              0939 03851000
*               END;                /*                       @YD00175*/ 03852000
*           END;                    /*                       @Y30LB11*/ 03853000
@RC00899 DS    0H                                                  0942 03854000
*       END;                        /*                       @YD00175*/ 03855000
*                                                                  0942 03856000
@RC00896 DS    0H                                                  0943 03857000
*   /*****************************************************************/ 03858000
*   /*                                                               */ 03859000
*   /* RETURN TO BASECHK.                                    @Y30LB11*/ 03860000
*   /*                                                               */ 03861000
*   /*****************************************************************/ 03862000
*                                                                  0943 03863000
*   RETURN CODE(UNITCOND);          /*                       @Y30LB11*/ 03864000
@RF00887 DS    0H                                                  0943 03865000
@RC00859 LR    @15,UNITCOND                                        0943 03866000
         L     @14,@SA00009                                        0943 03867000
         LM    @00,@12,@SA00009+8                                  0943 03868000
         BR    @14                                                 0943 03869000
*   END UNITCHK;                    /*                       @Y30LB11*/ 03870000
*   END IDCSV01                     /*                       @Y30LB11*/ 03871000
*                                                                  0945 03872000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03873000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 03874000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 03875000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 03876000
*/*%INCLUDE SYSLIB  (IDCCSSV )                                       */ 03877000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 03878000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 03879000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 03880000
*/*%INCLUDE SYSLIB  (IEZRVVI )                                       */ 03881000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 03882000
*/*%INCLUDE SYSLIB  (IDCDF53 )                                       */ 03883000
*                                                                  0945 03884000
*       ;                                                          0945 03885000
@DATA    DS    0H                                                       03886000
@CH00147 DC    H'2'                                                     03887000
@CH00266 DC    H'5'                                                     03888000
@CH00150 DC    H'6'                                                     03889000
@CH00909 DC    H'30'                                                    03890000
@CH01286 DC    H'68'                                                    03891000
@CH01289 DC    H'120'                                                   03892000
@CH01288 DC    H'132'                                                   03893000
@CH01285 DC    H'164'                                                   03894000
@CH01287 DC    H'224'                                                   03895000
         DS    0F                                                       03896000
@AL00269 DC    A(EXCL)                 LIST WITH   3 ARGUMENT(S)        03897000
         DC    A(WAIT)                                                  03898000
         DC    A(@CC01113)                                              03899000
@DATD    DSECT                                                          03900000
         DS    0F                                                       03901000
@SA00001 DS    18F                                                      03902000
@PC00001 DS    3F                                                       03903000
@SA00006 DS    15F                                                      03904000
@SA00003 DS    15F                                                      03905000
@SA00002 DS    15F                                                      03906000
@SA00004 DS    15F                                                      03907000
@SA00008 DS    15F                                                      03908000
@PC00008 DS    1F                                                       03909000
@SA00007 DS    15F                                                      03910000
@PC00007 DS    2F                                                       03911000
@SA00009 DS    15F                                                      03912000
@SA00005 DS    15F                                                      03913000
@AL00001 DS    6A                                                       03914000
@AFTEMPS DS    4F                                                       03915000
IDCSV01  CSECT                                                          03916000
         DS    0F                                                       03917000
@CF00111 DC    F'0'                                                     03918000
@CF00213 DC    F'1'                                                     03919000
@CH00213 EQU   @CF00213+2                                               03920000
@CF00041 DC    F'4'                                                     03921000
@CH00041 EQU   @CF00041+2                                               03922000
@CF00173 DC    F'8'                                                     03923000
@CH00173 EQU   @CF00173+2                                               03924000
@CF00035 DC    F'12'                                                    03925000
@CH00035 EQU   @CF00035+2                                               03926000
@CF00464 DC    F'16'                                                    03927000
@CF01111 DC    XL4'0208'                                                03928000
@CF01265 DC    XL4'23'                                                  03929000
@CF01267 DC    XL4'26'                                                  03930000
@CF01269 DC    XL4'2A'                                                  03931000
@DATD    DSECT                                                          03932000
         DS    0D                                                       03933000
LISTSCAN DS    A                                                        03934000
IOCSPTR  DS    A                                                        03935000
OPNPTR   DS    A                                                        03936000
DDSTRU   DS    A                                                        03937000
FSADDR   DS    A                                                        03938000
CCMSGPTR DS    A                                                        03939000
CTMSGPTR DS    A                                                        03940000
RVVIPTR  DS    A                                                        03941000
DEFLPTR  DS    A                                                        03942000
MSGPTR   DS    A                                                        03943000
REASONCD DS    F                                                        03944000
UCBPTR   DS    A                                                        03945000
SSDLPTR  DS    A                                                        03946000
SCMSGCD  DS    A                                                        03947000
SCMSGPTR DS    A                                                        03948000
SCDEFPTR DS    A                                                        03949000
SCDDSTRU DS    A                                                        03950000
LISTPTR  DS    A                                                        03951000
SETRC    DS    H                                                        03952000
ECBCODE  DS    FL1                                                      03953000
SCECBCD  DS    FL1                                                      03954000
LISTLN   DS    FL1                                                      03955000
         DS    0D                                                       03956000
@TS00001 DS    CL95                                                     03957000
         DS    CL1                                                      03958000
ALLGAREA DS    CL31                                                     03959000
BASEAREA DS    CL224                                                    03960000
         DS    CL1                                                      03961000
CKAGAREA DS    CL29                                                     03962000
COPYAREA DS    CL164                                                    03963000
DARGAREA DS    CL36                                                     03964000
         DS    CL3                                                      03965000
EXCLAREA DS    CL23                                                     03966000
DEFAREA  DS    CL132                                                    03967000
DUMPAREA DS    CL17                                                     03968000
MDAGAREA DS    CL31                                                     03969000
RVVIAREA DS    CL68                                                     03970000
         DS    CL1                                                      03971000
VSAGAREA DS    CL74                                                     03972000
SVFILE   DS    CL8                                                      03973000
COMTBL   DS    BL1                                                      03974000
         ORG   COMTBL                                                   03975000
VIERRFLG DS    BL1                                                      03976000
SCRDFLG  EQU   COMTBL+0                                                 03977000
UCLOSERR EQU   COMTBL+0                                                 03978000
ALLOCFLG EQU   COMTBL+0                                                 03979000
NOVTOCCK EQU   COMTBL+0                                                 03980000
@NM00082 EQU   COMTBL+0                                                 03981000
         ORG   COMTBL+1                                                 03982000
UQUENAME DS    CL23                                                     03983000
         ORG   UQUENAME                                                 03984000
RLENGTH  DS    FL1                                                      03985000
NAMELNG  DS    CL22                                                     03986000
         ORG   NAMELNG                                                  03987000
RVOLVAL  DS    CL6                                                      03988000
RNAME    DS    CL16                                                     03989000
         ORG   UQUENAME+23                                              03990000
ULP      DS    CL12                                                     03991000
         ORG   ULP                                                      03992000
ULP1     DS    FL2                                                      03993000
ULP2     DS    FL2                                                      03994000
ULP3     DS    CL8                                                      03995000
         ORG   ULP+12                                                   03996000
VLP      DS    CL10                                                     03997000
         ORG   VLP                                                      03998000
VLP1     DS    FL2                                                      03999000
VLP2     DS    FL2                                                      04000000
VLP3     DS    CL6                                                      04001000
         ORG   VLP+10                                                   04002000
Z8       DS    CL8                                                      04003000
         ORG   Z8                                                       04004000
ZERO     DS    BL2                                                      04005000
@NM00084 DS    BL2                                                      04006000
@NM00085 DS    BL4                                                      04007000
         ORG   Z8+8                                                     04008000
SSDRGLT  DS    CL20                                                     04009000
SSINXLST DS    CL120                                                    04010000
         ORG   SSINXLST                                                 04011000
SSARRAY  DS    60H                                                      04012000
         ORG   SSINXLST+120                                             04013000
SCDEFLST DS    CL132                                                    04014000
SCDARG   DS    CL36                                                     04015000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04016000
@ENDDATD EQU   *                                                        04017000
IDCSV01  CSECT                                                          04018000
         DS    0F                                                       04019000
@SIZDATD DC    AL1(0)                                                   04020000
         DC    AL3(@ENDDATD-@DATD)                                      04021000
         DS    0D                                                       04022000
RVVLEN   DC    AL2(68)                                                  04023000
SSMSGNUM DC    AL1(56)                                                  04024000
@CC01125 DC    C'.VIRTUAL.ENQUEUE'                                      04025000
@CC01128 DC    C'.VIRTUAL.RESERVE'                                      04026000
@CC01113 DC    C'SYSZAMS '                                              04027000
@CC01213 DC    C'IDCVS01 '                                              04028000
@CC01206 DC    C'DEFLIST'                                               04029000
@CC01108 DC    C'3330V'                                                 04030000
@CC01174 DC    C'SVSC'                                                  04031000
@CC01175 DC    C'SVSV'                                                  04032000
@CC01182 DC    C'SVRC'                                                  04033000
@CC01187 DC    C'SVAC'                                                  04034000
@CC01188 DC    C'RVVI'                                                  04035000
@CC01190 DC    C'SVRA'                                                  04036000
@CC01197 DC    C'SVBC'                                                  04037000
@CC01198 DC    C'SVRB'                                                  04038000
@CC01205 DC    C'SVBP'                                                  04039000
@CC01207 DC    C'SVSB'                                                  04040000
@CC01212 DC    C'SVCV'                                                  04041000
@CC01218 DC    C'SVCP'                                                  04042000
@CC01220 DC    C'SVRV'                                                  04043000
@CC01241 DC    C'SSAA'                                                  04044000
@CC01277 DC    C'SCSC'                                                  04045000
@CC01278 DC    C'SCDF'                                                  04046000
@CC01283 DC    C'SVUC'                                                  04047000
@CC01105 DC    C'CM0'                                                   04048000
@CC01131 DC    C'SV0'                                                   04049000
@CC01133 DC    C'UV0'                                                   04050000
ALL      DC    CL3'ALL'                                                 04051000
FORMAT   DC    CL4'FORM'                                                04052000
HSECOND  DC    CL4'HSEC'                                                04053000
CLOCK    DC    CL4'KLOK'                                                04054000
SETZERO  DC    CL4'ZERO'                                                04055000
SETBLANK DC    CL4'BLNK'                                                04056000
NOSET    DC    CL4'NSET'                                                04057000
OVERRIDE DC    CL4'OVRD'                                                04058000
ACQUIRE  DC    CL8'ACQUIRE '                                            04059000
RELINQ   DC    CL8'RELINQ  '                                            04060000
MOUNT    DC    CL8'MOUNT   '                                            04061000
DEMOUNT  DC    CL8'DEMOUNT '                                            04062000
DEFINE   DC    CL8'DEFINE  '                                            04063000
MOVE     DC    CL8'MOVE    '                                            04064000
TRACEQ   DC    CL8'TRACEQ  '                                            04065000
COPYTABL DC    CL8'COPYTABL'                                            04066000
COPYCRTG DC    CL8'COPYCRTG'                                            04067000
COPYVOL  DC    CL8'COPYVOL '                                            04068000
VVIC     DC    CL8'VVIC    '                                            04069000
TUNE     DC    CL8'TUNE    '                                            04070000
NAMES    DC    CL4'NAME'                                                04071000
UNIT     DC    CL4'UNIT'                                                04072000
SHR      DC    CL4'SHR '                                                04073000
EXCL     DC    CL4'EXCL'                                                04074000
NOWAIT   DC    CL4'NWAI'                                                04075000
WAIT     DC    CL4'WAIT'                                                04076000
SECCHECK DC    CL8'SECCHECK'                                            04077000
SCRVTOC  DC    CL8'SCRVTOC '                                            04078000
GETVTOC  DC    CL8'GETVTOC '                                            04079000
PUTVTOC  DC    CL8'PUTVTOC '                                            04080000
RECATLG  DC    CL8'RECATLG '                                            04081000
INITVOL  DC    CL8'INITVOL '                                            04082000
CHECK    DC    CL8'CHECK   '                                            04083000
POSTUCB  DC    CL8'POSTUCB '                                            04084000
GET      DC    CL8'GET     '                                            04085000
PUT      DC    CL8'PUT     '                                            04086000
CLOSE    DC    CL8'CLOSE   '                                            04087000
OPEN     DC    CL8'OPEN    '                                            04088000
PUTLABEL DC    CL8'PUTLABEL'                                            04089000
GETLABEL DC    CL8'GETLABEL'                                            04090000
CANCEL   DC    CL8'CANCEL  '                                            04091000
SET      DC    CL8'SET     '                                            04092000
SELECTX  DC    CL8'SELECTX '                                            04093000
CHANGEX  DC    CL8'CHANGEX '                                            04094000
MODID    DC    CL4'SV01'                                                04095000
FIXAREA  DS    CL300                                                    04096000
         ORG   FIXAREA                                                  04097000
@NM00083 DC    300X'00'                                                 04098000
         ORG   FIXAREA+300                                              04099000
SSMODSS0 DC    CL3'SS0'                                                 04100000
SSMODCM0 DC    CL3'CM0'                                                 04101000
SCBLANKS DS    CL30                                                     04102000
         ORG   SCBLANKS                                                 04103000
@NM00088 DC    30X'40'                                                  04104000
         ORG   SCBLANKS+30                                              04105000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04106000
@01      EQU   01                                                       04107000
@02      EQU   02                                                       04108000
@03      EQU   03                                                       04109000
@04      EQU   04                                                       04110000
@05      EQU   05                                                       04111000
@06      EQU   06                                                       04112000
@07      EQU   07                                                       04113000
@08      EQU   08                                                       04114000
@09      EQU   09                                                       04115000
@10      EQU   10                                                       04116000
@11      EQU   11                                                       04117000
@12      EQU   12                                                       04118000
@13      EQU   13                                                       04119000
@14      EQU   14                                                       04120000
@15      EQU   15                                                       04121000
UNITCOND EQU   @04                                                      04122000
SCRCOND  EQU   @05                                                      04123000
SCCMPTR  EQU   @02                                                      04124000
ENTRYNUM EQU   @02                                                      04125000
COPYCOND EQU   @05                                                      04126000
CHKCOND  EQU   @04                                                      04127000
BPROCOND EQU   @04                                                      04128000
BCHKCOND EQU   @04                                                      04129000
ALLCOND  EQU   @05                                                      04130000
COPYVPTR EQU   @04                                                      04131000
BASEVPTR EQU   @05                                                      04132000
CMMSGPTR EQU   @02                                                      04133000
DMPINDEX EQU   @02                                                      04134000
TESTRC   EQU   @03                                                      04135000
RTNREG   EQU   @15                                                      04136000
DEFVR1   EQU   @01                                                      04137000
REG0     EQU   @00                                                      04138000
REG1     EQU   @01                                                      04139000
REG10    EQU   @10                                                      04140000
REG11    EQU   @11                                                      04141000
REG12    EQU   @12                                                      04142000
REG13    EQU   @13                                                      04143000
REG14    EQU   @14                                                      04144000
REG15    EQU   @15                                                      04145000
REG2     EQU   @02                                                      04146000
REG3     EQU   @03                                                      04147000
REG4     EQU   @04                                                      04148000
REG5     EQU   @05                                                      04149000
REG6     EQU   @06                                                      04150000
REG7     EQU   @07                                                      04151000
REG8     EQU   @08                                                      04152000
REG9     EQU   @09                                                      04153000
IDCSACL0 EQU   0                                                        04154000
IDCSAEP0 EQU   0                                                        04155000
IDCSAFS0 EQU   0                                                        04156000
IDCSAAL0 EQU   0                                                        04157000
IDCSADL0 EQU   0                                                        04158000
IDCSASS0 EQU   0                                                        04159000
IDCSANQ0 EQU   0                                                        04160000
IDCSADQ0 EQU   0                                                        04161000
IDCSA060 EQU   0                                                        04162000
TRACE1   EQU   0                                                        04163000
OLDERID1 EQU   TRACE1                                                   04164000
TRACE2   EQU   0                                                        04165000
OLDERID2 EQU   TRACE2                                                   04166000
NEWID2   EQU   TRACE2+95                                                04167000
NEWERID2 EQU   5                                                        04168000
CIRAGL   EQU   0                                                        04169000
CIRTYPE  EQU   CIRAGL                                                   04170000
ALLAGL   EQU   0                                                        04171000
ALLDDN   EQU   ALLAGL+4                                                 04172000
ALLULP   EQU   ALLAGL+12                                                04173000
ALLVLP   EQU   ALLAGL+16                                                04174000
ALLSTS   EQU   ALLAGL+24                                                04175000
ALLDSP   EQU   ALLAGL+25                                                04176000
ALLORG   EQU   ALLAGL+26                                                04177000
ALLOPT   EQU   ALLAGL+28                                                04178000
ALLOPTVL EQU   ALLOPT                                                   04179000
ALLOPTPV EQU   ALLOPT                                                   04180000
ALLVLCNT EQU   ALLAGL+29                                                04181000
ALLUNCNT EQU   ALLAGL+30                                                04182000
UNITABL  EQU   0                                                        04183000
UNITADR  EQU   UNITABL+4                                                04184000
@NM00010 EQU   UNITADR                                                  04185000
UNITSTAT EQU   UNITABL+6                                                04186000
IDCIOCL0 EQU   0                                                        04187000
IOCSTR   EQU   0                                                        04188000
IOCDSO   EQU   IOCSTR+16                                                04189000
IOCRFM   EQU   IOCSTR+17                                                04190000
IOCMAC   EQU   IOCSTR+18                                                04191000
IOCMAC2  EQU   IOCSTR+19                                                04192000
IOCCHP   EQU   IOCSTR+20                                                04193000
IOCMSG   EQU   IOCSTR+21                                                04194000
IOCRBA   EQU   IOCSTR+40                                                04195000
IOCTTR   EQU   IOCRBA                                                   04196000
IOCMEM   EQU   IOCSTR+44                                                04197000
IOCNWM   EQU   IOCSTR+48                                                04198000
OPNAGL   EQU   0                                                        04199000
OPNOPT   EQU   OPNAGL                                                   04200000
OPNRFM   EQU   OPNAGL+1                                                 04201000
OPNTYP   EQU   OPNAGL+2                                                 04202000
OPNMOD   EQU   OPNAGL+3                                                 04203000
OPNDEV   EQU   OPNAGL+24                                                04204000
OPNDSO   EQU   OPNAGL+41                                                04205000
OPNOPT2  EQU   OPNAGL+42                                                04206000
IOINFOPT EQU   0                                                        04207000
UVOLLIST EQU   0                                                        04208000
UVOLENT  EQU   UVOLLIST+2                                               04209000
AMSTP011 EQU   0                                                        04210000
DARGLIST EQU   0                                                        04211000
DARGDBP  EQU   DARGLIST                                                 04212000
DARGRETP EQU   DARGLIST+4                                               04213000
DARGSTID EQU   DARGLIST+8                                               04214000
DARGSMOD EQU   DARGSTID                                                 04215000
DARGSENT EQU   DARGSTID+3                                               04216000
DARGILP  EQU   DARGLIST+12                                              04217000
DARGCNT  EQU   DARGLIST+14                                              04218000
DARGRETL EQU   DARGLIST+16                                              04219000
DARGARY  EQU   DARGLIST+20                                              04220000
DARGINS  EQU   DARGARY                                                  04221000
DARGINL  EQU   DARGARY+2                                                04222000
DARGDTM  EQU   DARGARY+4                                                04223000
FMTLIST  EQU   0                                                        04224000
FMTFLGS  EQU   FMTLIST                                                  04225000
FMTSPF   EQU   FMTLIST+2                                                04226000
FMTRFNO  EQU   FMTSPF                                                   04227000
FMTILEN  EQU   FMTRFNO                                                  04228000
FMTIOFF  EQU   FMTLIST+4                                                04229000
FMTTRBC  EQU   FMTIOFF                                                  04230000
FMTSTO   EQU   FMTTRBC                                                  04231000
FMTOCOL  EQU   FMTLIST+6                                                04232000
FMTCNVF  EQU   FMTLIST+10                                               04233000
IDCDB010 EQU   0                                                        04234000
DMPITM   EQU   0                                                        04235000
DMPITMNM EQU   DMPITM                                                   04236000
DMPITMPT EQU   DMPITM+8                                                 04237000
DMPITMLN EQU   DMPITM+12                                                04238000
DMPITMTP EQU   DMPITM+14                                                04239000
DMPARY   EQU   0                                                        04240000
DMPTRM   EQU   0                                                        04241000
VOL      EQU   0                                                        04242000
VOLLEN   EQU   VOL                                                      04243000
VOLVAL   EQU   VOL+1                                                    04244000
ALLC     EQU   0                                                        04245000
CDATE    EQU   0                                                        04246000
DATE     EQU   0                                                        04247000
DATEVAL  EQU   DATE                                                     04248000
SEQ      EQU   0                                                        04249000
SEQVAL   EQU   SEQ                                                      04250000
FILE     EQU   0                                                        04251000
FILEVAL  EQU   FILE+1                                                   04252000
CCMSG    EQU   0                                                        04253000
CMMSG    EQU   0                                                        04254000
CMVOLFLG EQU   CMMSG+6                                                  04255000
CMCSN1   EQU   CMMSG+16                                                 04256000
CMCSN2   EQU   CMMSG+28                                                 04257000
CTMSG    EQU   0                                                        04258000
CTARRAY  EQU   CTMSG+4                                                  04259000
MDAGL    EQU   0                                                        04260000
MDUCBPTR EQU   MDAGL+8                                                  04261000
MDDDNAME EQU   MDAGL+12                                                 04262000
MDLABEL  EQU   MDAGL+24                                                 04263000
MDFLAGS  EQU   MDAGL+30                                                 04264000
MDWAIT   EQU   MDFLAGS                                                  04265000
MDDEQ    EQU   MDFLAGS                                                  04266000
PUAGL    EQU   0                                                        04267000
CKAGL    EQU   0                                                        04268000
CKUCBPTR EQU   CKAGL+8                                                  04269000
CKDDNAME EQU   CKAGL+12                                                 04270000
CKFLAGS  EQU   CKAGL+28                                                 04271000
CKTESTVT EQU   CKFLAGS                                                  04272000
EXCLAGL  EQU   0                                                        04273000
EXCLUCBP EQU   EXCLAGL+8                                                04274000
EXCLDDP  EQU   EXCLAGL+12                                               04275000
EXCLVOL  EQU   EXCLAGL+16                                               04276000
EXCLFLAG EQU   EXCLAGL+22                                               04277000
EXCLMNT  EQU   EXCLFLAG                                                 04278000
EXOARG   EQU   0                                                        04279000
EXOPT    EQU   EXOARG+32                                                04280000
EXFLG    EQU   EXOARG+33                                                04281000
EXGARG   EQU   0                                                        04282000
EXPARG   EQU   0                                                        04283000
EXPDATA  EQU   EXPARG+12                                                04284000
EXPDATAB EQU   0                                                        04285000
EXPARRAY EQU   EXPDATAB+4                                               04286000
VS2AGL   EQU   0                                                        04287000
VSLABOPT EQU   VS2AGL+28                                                04288000
VS2MSG   EQU   VS2AGL+35                                                04289000
VS2RESOP EQU   VS2AGL+36                                                04290000
VS1AGL   EQU   0                                                        04291000
VSUCBP   EQU   VS1AGL+8                                                 04292000
VSVOLP   EQU   VS1AGL+12                                                04293000
VSFILEP  EQU   VS1AGL+16                                                04294000
VSIOP    EQU   VS1AGL+20                                                04295000
VSSECOPT EQU   VS1AGL+68                                                04296000
VSNOVSAM EQU   VSSECOPT                                                 04297000
VSNONONV EQU   VSSECOPT                                                 04298000
VSVTOPT  EQU   VS1AGL+69                                                04299000
VSCATOPT EQU   VS1AGL+70                                                04300000
VSRETURN EQU   VS1AGL+71                                                04301000
VSMSG    EQU   VS1AGL+72                                                04302000
VSRESOPT EQU   VS1AGL+73                                                04303000
VSRES    EQU   VSRESOPT                                                 04304000
RCTAGL   EQU   0                                                        04305000
RCTOPT   EQU   RCTAGL+8                                                 04306000
STAEPARM EQU   0                                                        04307000
STARCVY  EQU   STAEPARM+52                                              04308000
STARETRY EQU   STAEPARM+53                                              04309000
VOLLABEL EQU   0                                                        04310000
SV82LIST EQU   0                                                        04311000
@NM00057 EQU   SV82LIST+4                                               04312000
SV82DCBP EQU   @NM00057                                                 04313000
@NM00058 EQU   SV82LIST+12                                              04314000
SV82WRKP EQU   @NM00058                                                 04315000
BASEV    EQU   0                                                        04316000
BASNAME  EQU   BASEV                                                    04317000
BASID    EQU   BASNAME+11                                               04318000
BASFLAGA EQU   BASEV+14                                                 04319000
BASTYPE  EQU   BASFLAGA                                                 04320000
BASINAC  EQU   BASFLAGA+2                                               04321000
BASRCVYF EQU   BASEV+20                                                 04322000
BASSATIA EQU   BASRCVYF                                                 04323000
BASIVCRE EQU   BASSATIA                                                 04324000
BASVSMIS EQU   BASSATIA                                                 04325000
BASMISCF EQU   BASRCVYF+2                                               04326000
BASCSN1  EQU   BASEV+24                                                 04327000
BASLIB1  EQU   BASEV+36                                                 04328000
BASLID1  EQU   BASLIB1                                                  04329000
BASCSN2  EQU   BASEV+37                                                 04330000
BASLIB2  EQU   BASEV+49                                                 04331000
BASLID2  EQU   BASLIB2                                                  04332000
BASKLCPY EQU   BASEV+76                                                 04333000
BASCOPID EQU   BASKLCPY+11                                              04334000
COPYV    EQU   0                                                        04335000
COPNAME  EQU   COPYV                                                    04336000
COPID    EQU   COPNAME+11                                               04337000
COPNO    EQU   COPID+1                                                  04338000
COPFLAGA EQU   COPYV+14                                                 04339000
COPTYPE  EQU   COPFLAGA                                                 04340000
COPRCVYF EQU   COPYV+20                                                 04341000
COPSATIA EQU   COPRCVYF                                                 04342000
COPMISCF EQU   COPRCVYF+2                                               04343000
COPCSN1  EQU   COPYV+24                                                 04344000
COPLIB1  EQU   COPYV+36                                                 04345000
COPLID1  EQU   COPLIB1                                                  04346000
COPCSN2  EQU   COPYV+37                                                 04347000
COPLIB2  EQU   COPYV+49                                                 04348000
COPLID2  EQU   COPLIB2                                                  04349000
COPDATE  EQU   COPYV+50                                                 04350000
COPDEST  EQU   COPYV+88                                                 04351000
RVVI     EQU   0                                                        04352000
RVVLNGTH EQU   RVVI                                                     04353000
RVVOPCOD EQU   RVVI+4                                                   04354000
RVVCODE  EQU   RVVOPCOD                                                 04355000
RVVOLUME EQU   RVVI+8                                                   04356000
RVVBUFLN EQU   RVVI+30                                                  04357000
RVVRTBUF EQU   RVVI+32                                                  04358000
RVVCDATE EQU   RVVI+38                                                  04359000
RVVRDSEQ EQU   RVVI+43                                                  04360000
RVVCPYID EQU   RVVI+56                                                  04361000
RVVFLAGA EQU   RVVI+58                                                  04362000
RVVRMODE EQU   RVVFLAGA                                                 04363000
RVVRDR   EQU   RVVRMODE                                                 04364000
RVVRDNR  EQU   RVVRMODE                                                 04365000
RVVCHAIN EQU   RVVFLAGA+1                                               04366000
RVVRDRCD EQU   RVVFLAGA+2                                               04367000
RVVBVRCD EQU   RVVRDRCD                                                 04368000
RVVCPYRC EQU   RVVRDRCD                                                 04369000
RVVRTEST EQU   RVVFLAGA+3                                               04370000
RVVCPYTP EQU   RVVFLAGA+4                                               04371000
RVVSPEC  EQU   RVVFLAGA+5                                               04372000
RVVSDTE  EQU   RVVSPEC                                                  04373000
RVVSSEQ  EQU   RVVSPEC                                                  04374000
RVVSCPY  EQU   RVVSPEC                                                  04375000
DEFLIST  EQU   0                                                        04376000
DEFVFLG  EQU   DEFLIST+6                                                04377000
DEFVELM  EQU   DEFVFLG                                                  04378000
DEFVELTR EQU   DEFVFLG                                                  04379000
DEFVLIB  EQU   DEFLIST+7                                                04380000
DEFVOLD  EQU   DEFLIST+8                                                04381000
DEFVVFLG EQU   DEFLIST+14                                               04382000
DEFVCSN1 EQU   DEFLIST+24                                               04383000
DEFVDATA EQU   DEFLIST+56                                               04384000
AMSTP041 EQU   0                                                        04385000
AMSTP042 EQU   0                                                        04386000
AMSTP043 EQU   0                                                        04387000
AMSTP044 EQU   0                                                        04388000
IDCIOCO0 EQU   0                                                        04389000
IDCIOGT0 EQU   0                                                        04390000
IDCIOIT0 EQU   0                                                        04391000
IDCIOOP0 EQU   0                                                        04392000
IDCIOPO0 EQU   0                                                        04393000
IDCIOPT0 EQU   0                                                        04394000
IDCIOSI0 EQU   0                                                        04395000
IDCIOST0 EQU   0                                                        04396000
IDCIOTM0 EQU   0                                                        04397000
IDCIOVY0 EQU   0                                                        04398000
IDCIO050 EQU   0                                                        04399000
IDCSACA0 EQU   0                                                        04400000
IDCSACR0 EQU   0                                                        04401000
IDCSADE0 EQU   0                                                        04402000
IDCSAFP0 EQU   0                                                        04403000
IDCSAGP0 EQU   0                                                        04404000
IDCSAGS0 EQU   0                                                        04405000
IDCSAID0 EQU   0                                                        04406000
IDCSALD0 EQU   0                                                        04407000
IDCSALK0 EQU   0                                                        04408000
IDCSAPR0 EQU   0                                                        04409000
IDCSAPT0 EQU   0                                                        04410000
IDCSAQL0 EQU   0                                                        04411000
IDCSARC0 EQU   0                                                        04412000
IDCSARV0 EQU   0                                                        04413000
IDCSASC0 EQU   0                                                        04414000
IDCSASI0 EQU   0                                                        04415000
IDCSASN0 EQU   0                                                        04416000
IDCSAST0 EQU   0                                                        04417000
IDCSATI0 EQU   0                                                        04418000
IDCSAWO0 EQU   0                                                        04419000
IDCST010 EQU   0                                                        04420000
LISTTEST EQU   0                                                        04421000
NEWERID1 EQU   5                                                        04422000
GDTTBL   EQU   0                                                        04423000
GDTTR1   EQU   GDTTBL+8                                                 04424000
GDTTR2   EQU   GDTTBL+12                                                04425000
GDTDBG   EQU   GDTTBL+40                                                04426000
GDTSTC   EQU   GDTTBL+44                                                04427000
GDTPRT   EQU   GDTTBL+48                                                04428000
GDTESS   EQU   GDTTBL+52                                                04429000
GDTESA   EQU   GDTTBL+56                                                04430000
GDTRST   EQU   GDTTBL+60                                                04431000
GDTRES   EQU   GDTTBL+64                                                04432000
GDTCAL   EQU   GDTTBL+68                                                04433000
GDTGSP   EQU   GDTTBL+72                                                04434000
GDTFSP   EQU   GDTTBL+76                                                04435000
GDTGPL   EQU   GDTTBL+80                                                04436000
GDTFPL   EQU   GDTTBL+84                                                04437000
GDTLOD   EQU   GDTTBL+88                                                04438000
GDTDEL   EQU   GDTTBL+92                                                04439000
GDTPRL   EQU   GDTTBL+96                                                04440000
GDTEPL   EQU   GDTTBL+100                                               04441000
GDTTIM   EQU   GDTTBL+104                                               04442000
GDTIIO   EQU   GDTTBL+108                                               04443000
GDTTIO   EQU   GDTTBL+112                                               04444000
GDTOPN   EQU   GDTTBL+124                                               04445000
GDTCLS   EQU   GDTTBL+128                                               04446000
GDTGET   EQU   GDTTBL+132                                               04447000
GDTPUT   EQU   GDTTBL+136                                               04448000
GDTPOS   EQU   GDTTBL+140                                               04449000
GDTCPY   EQU   GDTTBL+144                                               04450000
GDTCAT   EQU   GDTTBL+148                                               04451000
GDTSNP   EQU   GDTTBL+164                                               04452000
GDTVFY   EQU   GDTTBL+172                                               04453000
GDTUID   EQU   GDTTBL+192                                               04454000
GDTPMT   EQU   GDTTBL+196                                               04455000
GDTCIR   EQU   GDTTBL+200                                               04456000
GDTLNK   EQU   GDTTBL+204                                               04457000
GDTALC   EQU   GDTTBL+208                                               04458000
GDTDLC   EQU   GDTTBL+212                                               04459000
GDTQAL   EQU   GDTTBL+216                                               04460000
GDTSTW   EQU   GDTTBL+220                                               04461000
GDTSSC   EQU   GDTTBL+224                                               04462000
GDTENQ   EQU   GDTTBL+228                                               04463000
GDTRSV   EQU   GDTTBL+232                                               04464000
GDTDEQ   EQU   GDTTBL+236                                               04465000
GDTSFO   EQU   GDTTBL+240                                               04466000
GDTWTO   EQU   GDTTBL+244                                               04467000
GDTSCR   EQU   GDTTBL+248                                               04468000
GDTUNT   EQU   GDTTBL+252                                               04469000
GDTRCT   EQU   GDTTBL+256                                               04470000
GDTIFO   EQU   GDTTBL+260                                               04471000
GDTEXP   EQU   GDTTBL+264                                               04472000
GDTSTA   EQU   GDTTBL+268                                               04473000
FDTTBL   EQU   0                                                        04474000
FDTPTR   EQU   FDTTBL+8                                                 04475000
LASTCOND EQU   0                                                        04476000
SSRCODE  EQU   0                                                        04477000
SSRHALF  EQU   SSRCODE+2                                                04478000
SSECBCD  EQU   0                                                        04479000
SCINPUT  EQU   0                                                        04480000
SCERRFLG EQU   SCINPUT                                                  04481000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04482000
@NM00087 EQU   SCINPUT                                                  04483000
@NM00086 EQU   SSRCODE                                                  04484000
FDTVERB  EQU   FDTTBL                                                   04485000
GDTECT   EQU   GDTTBL+188                                               04486000
GDTPSB   EQU   GDTTBL+184                                               04487000
GDTUPT   EQU   GDTTBL+180                                               04488000
GDTCMB   EQU   GDTTBL+176                                               04489000
GDTSPR   EQU   GDTTBL+168                                               04490000
@NM00001 EQU   GDTTBL+160                                               04491000
GDTABH   EQU   GDTTBL+156                                               04492000
GDTABT   EQU   GDTTBL+152                                               04493000
GDTTOH   EQU   GDTTBL+120                                               04494000
GDTRIP   EQU   GDTTBL+116                                               04495000
GDTIOH   EQU   GDTTBL+36                                                04496000
GDTSAH   EQU   GDTTBL+32                                                04497000
GDTTPH   EQU   GDTTBL+28                                                04498000
GDTRIH   EQU   GDTTBL+24                                                04499000
GDTSTH   EQU   GDTTBL+20                                                04500000
GDTDBH   EQU   GDTTBL+16                                                04501000
GDTPRM   EQU   GDTTBL+4                                                 04502000
GDTHDR   EQU   GDTTBL                                                   04503000
DEFVVEXT EQU   DEFLIST+128                                              04504000
DEFTLAB  EQU   DEFVDATA+71                                              04505000
DEFR60   EQU   DEFVDATA+43                                              04506000
DEFOWNID EQU   DEFVDATA+29                                              04507000
DEFR55   EQU   DEFVDATA+3                                               04508000
DEFACSEC EQU   DEFVDATA+2                                               04509000
DEFR50   EQU   DEFVDATA                                                 04510000
DEFVECB  EQU   DEFLIST+52                                               04511000
DEFVASID EQU   DEFLIST+50                                               04512000
@NM00081 EQU   DEFLIST+48                                               04513000
DEFVCSN2 EQU   DEFLIST+36                                               04514000
@NM00080 EQU   DEFLIST+22                                               04515000
DEFVNVOL EQU   DEFLIST+16                                               04516000
@NM00079 EQU   DEFLIST+15                                               04517000
@NM00078 EQU   DEFVVFLG                                                 04518000
DEFVWINH EQU   DEFVVFLG                                                 04519000
DEFVBIND EQU   DEFVVFLG                                                 04520000
@NM00077 EQU   DEFVVFLG                                                 04521000
DEFVEXCL EQU   DEFVVFLG                                                 04522000
DEFVSEC  EQU   DEFVVFLG                                                 04523000
@NM00076 EQU   DEFVVFLG                                                 04524000
DEFVCECT EQU   DEFVVFLG                                                 04525000
DEFVLID  EQU   DEFVLIB                                                  04526000
@NM00075 EQU   DEFVLIB                                                  04527000
DEFVDACT EQU   DEFVFLG                                                  04528000
DEFVACT  EQU   DEFVFLG                                                  04529000
DEFVRNTR EQU   DEFVFLG                                                  04530000
DEFVREP  EQU   DEFVFLG                                                  04531000
DEFVRNM  EQU   DEFVFLG                                                  04532000
DEFVCR   EQU   DEFVFLG                                                  04533000
@NM00074 EQU   DEFLIST+5                                                04534000
DEFVOPCD EQU   DEFLIST+4                                                04535000
DEFVLEN  EQU   DEFLIST                                                  04536000
@NM00073 EQU   RVVI+64                                                  04537000
RVVSVOL  EQU   RVVSPEC                                                  04538000
RVVSDUP  EQU   RVVSPEC                                                  04539000
RVVSCSN  EQU   RVVSPEC                                                  04540000
RVVSEXP  EQU   RVVSPEC                                                  04541000
RVVSGRP  EQU   RVVSPEC                                                  04542000
@NM00072 EQU   RVVCPYTP                                                 04543000
RVVLCOPY EQU   RVVCPYTP                                                 04544000
RVVOBKUP EQU   RVVCPYTP                                                 04545000
RVVLBKUP EQU   RVVCPYTP                                                 04546000
@NM00071 EQU   RVVRTEST                                                 04547000
RVVDVOL  EQU   RVVRTEST                                                 04548000
RVVACTV  EQU   RVVRTEST                                                 04549000
RVVINACT EQU   RVVRTEST                                                 04550000
RVVRSTD  EQU   RVVRTEST                                                 04551000
RVVGSVOL EQU   RVVRTEST                                                 04552000
RVVTHOLD EQU   RVVRTEST                                                 04553000
RVVEXPDT EQU   RVVRTEST                                                 04554000
@NM00070 EQU   RVVRDRCD                                                 04555000
RVVRUNKN EQU   RVVRDRCD                                                 04556000
RVVDUPRC EQU   RVVRDRCD                                                 04557000
RVVGRPRC EQU   RVVRDRCD                                                 04558000
@NM00069 EQU   RVVCHAIN                                                 04559000
RVVNGVOL EQU   RVVCHAIN                                                 04560000
RVVGPVOL EQU   RVVCHAIN                                                 04561000
@NM00068 EQU   RVVRMODE                                                 04562000
RVVRDCH  EQU   RVVRMODE                                                 04563000
RVVDUPID EQU   RVVI+57                                                  04564000
RVVRDCSN EQU   RVVI+44                                                  04565000
RVVBLNK1 EQU   RVVI+42                                                  04566000
RVVEXPIR EQU   RVVI+36                                                  04567000
@NM00067 EQU   RVVI+28                                                  04568000
RVVAREA  EQU   RVVI+24                                                  04569000
RVVARLN  EQU   RVVI+22                                                  04570000
RVVGROUP EQU   RVVI+14                                                  04571000
@NM00066 EQU   RVVOPCOD+1                                               04572000
@NM00065 EQU   COPYV+136                                                04573000
COPFREXT EQU   COPYV+132                                                04574000
COPLEXT  EQU   COPYV+130                                                04575000
COPFRESP EQU   COPYV+128                                                04576000
COPOWNER EQU   COPYV+118                                                04577000
COPDESCR EQU   COPYV+58                                                 04578000
COPDTREM EQU   COPYV+54                                                 04579000
COP2BIT2 EQU   COPLID2                                                  04580000
COP2BIT1 EQU   COPLID2                                                  04581000
COPRES5  EQU   COPLIB2                                                  04582000
COP1BIT2 EQU   COPLID1                                                  04583000
COP1BIT1 EQU   COPLID1                                                  04584000
COPRES4  EQU   COPLIB1                                                  04585000
@NM00064 EQU   COPMISCF                                                 04586000
COPHOLD  EQU   COPMISCF                                                 04587000
COPRES3  EQU   COPSATIA                                                 04588000
COPVSMIS EQU   COPSATIA                                                 04589000
COPIVCPY EQU   COPSATIA                                                 04590000
COPIVCRE EQU   COPSATIA                                                 04591000
@NM00063 EQU   COPYV+18                                                 04592000
@NM00062 EQU   COPFLAGA+3                                               04593000
COPDLSPF EQU   COPFLAGA+3                                               04594000
COPRONLY EQU   COPFLAGA+3                                               04595000
COPDAERA EQU   COPFLAGA+2                                               04596000
COPEXCL  EQU   COPFLAGA+2                                               04597000
COPBIND  EQU   COPFLAGA+2                                               04598000
COPBKUP  EQU   COPFLAGA+2                                               04599000
COPRSTD  EQU   COPFLAGA+2                                               04600000
COPGENUS EQU   COPFLAGA+2                                               04601000
COPVSAM  EQU   COPFLAGA+2                                               04602000
COPGROUP EQU   COPFLAGA+2                                               04603000
COPRES2  EQU   COPTYPE                                                  04604000
COPCOPYV EQU   COPTYPE                                                  04605000
COPRES1  EQU   COPTYPE                                                  04606000
COPRES6  EQU   COPYV+13                                                 04607000
COPBLANK EQU   COPID                                                    04608000
COPSERNO EQU   COPNAME+5                                                04609000
COPV     EQU   COPNAME                                                  04610000
@NM00061 EQU   BASEV+188                                                04611000
BASGROUP EQU   BASEV+180                                                04612000
BASRECOV EQU   BASEV+174                                                04613000
BASDEST  EQU   BASEV+144                                                04614000
BASOWNER EQU   BASEV+134                                                04615000
BASDESCR EQU   BASEV+104                                                04616000
BASDTREM EQU   BASEV+100                                                04617000
BASEXPDT EQU   BASEV+96                                                 04618000
BASDLMTD EQU   BASEV+92                                                 04619000
BASRES6  EQU   BASEV+89                                                 04620000
BASCOPNO EQU   BASCOPID+1                                               04621000
BASCOPBK EQU   BASCOPID                                                 04622000
BASCOPSN EQU   BASKLCPY+5                                               04623000
BASCOPV  EQU   BASKLCPY                                                 04624000
BASFREXT EQU   BASEV+72                                                 04625000
BASLEXT  EQU   BASEV+70                                                 04626000
BASFRESP EQU   BASEV+68                                                 04627000
@NM00060 EQU   BASEV+65                                                 04628000
BASBKLMT EQU   BASEV+64                                                 04629000
BASNBKUP EQU   BASEV+63                                                 04630000
BASNCOPY EQU   BASEV+62                                                 04631000
BASNEXTV EQU   BASEV+56                                                 04632000
BASPREV  EQU   BASEV+50                                                 04633000
BAS2BIT2 EQU   BASLID2                                                  04634000
BAS2BIT1 EQU   BASLID2                                                  04635000
BASRES5  EQU   BASLIB2                                                  04636000
BAS1BIT2 EQU   BASLID1                                                  04637000
BAS1BIT1 EQU   BASLID1                                                  04638000
BASRES4  EQU   BASLIB1                                                  04639000
BASRES3  EQU   BASMISCF                                                 04640000
BASHOLD  EQU   BASMISCF                                                 04641000
BASRES8  EQU   BASSATIA                                                 04642000
BASIVCPY EQU   BASSATIA                                                 04643000
BASCPUID EQU   BASEV+18                                                 04644000
@NM00059 EQU   BASFLAGA+3                                               04645000
BASLAST  EQU   BASFLAGA+3                                               04646000
BASFIRST EQU   BASFLAGA+3                                               04647000
BASREASS EQU   BASFLAGA+3                                               04648000
BASRONLY EQU   BASFLAGA+3                                               04649000
BASDAERA EQU   BASFLAGA+3                                               04650000
BASEXCL  EQU   BASFLAGA+2                                               04651000
BASBIND  EQU   BASFLAGA+2                                               04652000
BASRSTD  EQU   BASFLAGA+2                                               04653000
BASGENUS EQU   BASFLAGA+2                                               04654000
BASGRPV  EQU   BASFLAGA+2                                               04655000
BASNOCPY EQU   BASFLAGA+2                                               04656000
BASDLSF  EQU   BASFLAGA+2                                               04657000
BASRES2  EQU   BASTYPE                                                  04658000
BASBASVR EQU   BASTYPE                                                  04659000
BASRES1  EQU   BASTYPE                                                  04660000
BASRES7  EQU   BASEV+13                                                 04661000
BASZERO  EQU   BASID+1                                                  04662000
BASBLANK EQU   BASID                                                    04663000
BASSERNO EQU   BASNAME+5                                                04664000
BASEVKEY EQU   BASNAME                                                  04665000
SV82DEBP EQU   SV82WRKP                                                 04666000
SV82TTRP EQU   SV82LIST+8                                               04667000
SV82VOLP EQU   SV82DCBP                                                 04668000
SV82UCBP EQU   SV82LIST+1                                               04669000
SV82CODE EQU   SV82LIST                                                 04670000
VOLRESV3 EQU   VOLLABEL+55                                              04671000
VOLOWNER EQU   VOLLABEL+45                                              04672000
VOLRESV1 EQU   VOLLABEL+20                                              04673000
VOLVTOC  EQU   VOLLABEL+15                                              04674000
VOLSECTY EQU   VOLLABEL+14                                              04675000
VOLSERNO EQU   VOLLABEL+8                                               04676000
VOLNO    EQU   VOLLABEL+7                                               04677000
VOLLABI  EQU   VOLLABEL+4                                               04678000
VOLKEY   EQU   VOLLABEL                                                 04679000
@NM00056 EQU   STARETRY                                                 04680000
STAOFF   EQU   STARETRY                                                 04681000
STAIO05  EQU   STARETRY                                                 04682000
@NM00055 EQU   STARCVY                                                  04683000
STACLEAR EQU   STARCVY                                                  04684000
STAVPOST EQU   STARCVY                                                  04685000
STAVENQ  EQU   STARCVY                                                  04686000
STAVDMNT EQU   STARCVY                                                  04687000
STAVMNT  EQU   STARCVY                                                  04688000
STATCB   EQU   STAEPARM+48                                              04689000
STARTADD EQU   STAEPARM+44                                              04690000
STAEXSAV EQU   STAEPARM+40                                              04691000
STARTSAV EQU   STAEPARM+36                                              04692000
STARTTR  EQU   STAEPARM+32                                              04693000
@NM00054 EQU   STAEPARM+30                                              04694000
STARVOL  EQU   STAEPARM+24                                              04695000
STARUCB  EQU   STAEPARM+20                                              04696000
@NM00053 EQU   STAEPARM+18                                              04697000
STAVVOL  EQU   STAEPARM+12                                              04698000
STAVUCB  EQU   STAEPARM+8                                               04699000
STAHEAD  EQU   STAEPARM                                                 04700000
RCTDSET  EQU   RCTAGL+32                                                04701000
RCTNVOL  EQU   RCTAGL+26                                                04702000
RCTOVOL  EQU   RCTAGL+20                                                04703000
RCTNDEV  EQU   RCTAGL+16                                                04704000
RCTODEV  EQU   RCTAGL+12                                                04705000
@NM00052 EQU   RCTAGL+10                                                04706000
@NM00051 EQU   RCTOPT                                                   04707000
RCTVOL   EQU   RCTOPT                                                   04708000
RCTDEV   EQU   RCTOPT                                                   04709000
RCTHEAD  EQU   RCTAGL                                                   04710000
@NM00050 EQU   VSRESOPT                                                 04711000
VSREAL   EQU   VSRESOPT                                                 04712000
@NM00049 EQU   VSMSG                                                    04713000
VSTOV    EQU   VSMSG                                                    04714000
VSFROMV  EQU   VSMSG                                                    04715000
@NM00048 EQU   VSRETURN                                                 04716000
VSUCAT   EQU   VSRETURN                                                 04717000
VSVSAM   EQU   VSRETURN                                                 04718000
@NM00047 EQU   VSCATOPT                                                 04719000
VSLIST   EQU   VSCATOPT                                                 04720000
VSSERIAL EQU   VSCATOPT                                                 04721000
VSDEVICE EQU   VSCATOPT                                                 04722000
@NM00046 EQU   VSVTOPT                                                  04723000
VSVSFLAG EQU   VSVTOPT                                                  04724000
VSALTTRK EQU   VSVTOPT                                                  04725000
VSTIME   EQU   VSVTOPT                                                  04726000
VSUCMAST EQU   VSSECOPT                                                 04727000
VSOPCAT  EQU   VSSECOPT                                                 04728000
VSUCTEST EQU   VSSECOPT                                                 04729000
VSWRITE  EQU   VSSECOPT                                                 04730000
VSREAD   EQU   VSSECOPT                                                 04731000
VSMASTER EQU   VSSECOPT                                                 04732000
VSODEVP  EQU   VS1AGL+64                                                04733000
VSOSERP  EQU   VS1AGL+60                                                04734000
VSDEVP   EQU   VS1AGL+56                                                04735000
VSSERP   EQU   VS1AGL+52                                                04736000
VSPFILEP EQU   VS1AGL+48                                                04737000
VSPSWDP  EQU   VS1AGL+44                                                04738000
VSCATDDP EQU   VS1AGL+40                                                04739000
VSACBP   EQU   VS1AGL+36                                                04740000
VSCATP   EQU   VS1AGL+32                                                04741000
VSNXTATP EQU   VS1AGL+28                                                04742000
VSNUMATP EQU   VS1AGL+24                                                04743000
VSHEAD   EQU   VS1AGL                                                   04744000
VSDDNAME EQU   VS2AGL+37                                                04745000
@NM00045 EQU   VS2RESOP                                                 04746000
VS2REAL  EQU   VS2RESOP                                                 04747000
VS2RES   EQU   VS2RESOP                                                 04748000
@NM00044 EQU   VS2MSG                                                   04749000
VS2TOV   EQU   VS2MSG                                                   04750000
VSVOLUME EQU   VS2AGL+29                                                04751000
@NM00043 EQU   VSLABOPT                                                 04752000
VSVOLSER EQU   VSLABOPT                                                 04753000
VSOWNER  EQU   VSLABOPT                                                 04754000
VSIOBKPT EQU   VS2AGL+24                                                04755000
VSVOLPTR EQU   VS2AGL+20                                                04756000
VSOWNPTR EQU   VS2AGL+16                                                04757000
VSVTOCSZ EQU   VS2AGL+12                                                04758000
VSUCBPTR EQU   VS2AGL+8                                                 04759000
VS2HEAD  EQU   VS2AGL                                                   04760000
EXPDATAL EQU   EXPARRAY+6                                               04761000
@NM00042 EQU   EXPARRAY+5                                               04762000
EXPKEYLN EQU   EXPARRAY+4                                               04763000
EXPDATAP EQU   EXPARRAY                                                 04764000
EXPRECNO EQU   EXPDATAB                                                 04765000
EXPCCHHR EQU   EXPARG+16                                                04766000
EXPCTLBK EQU   EXPARG+8                                                 04767000
EXPHEAD  EQU   EXPARG                                                   04768000
EXGDATAL EQU   EXGARG+30                                                04769000
@NM00041 EQU   EXGARG+29                                                04770000
EXGKEYLN EQU   EXGARG+28                                                04771000
EXGDATAP EQU   EXGARG+24                                                04772000
EXGRECNO EQU   EXGARG+20                                                04773000
EXGCCHH2 EQU   EXGARG+16                                                04774000
EXGCCHH1 EQU   EXGARG+12                                                04775000
EXGCTLBK EQU   EXGARG+8                                                 04776000
EXGHEAD  EQU   EXGARG                                                   04777000
@NM00040 EQU   EXFLG                                                    04778000
EXOREAD  EQU   EXFLG                                                    04779000
@NM00039 EQU   EXOPT                                                    04780000
EXONEW   EQU   EXOPT                                                    04781000
EXOPASS  EQU   EXOPT                                                    04782000
EXOLAB   EQU   EXOPT                                                    04783000
EXOTAB   EQU   EXOPT                                                    04784000
EXOCTLBK EQU   EXOARG+28                                                04785000
EXOEXT   EQU   EXOARG+24                                                04786000
EXOUCB   EQU   EXOARG+20                                                04787000
EXOVSN   EQU   EXOARG+16                                                04788000
EXODSN   EQU   EXOARG+12                                                04789000
EXODDN   EQU   EXOARG+8                                                 04790000
EXOHEAD  EQU   EXOARG                                                   04791000
@NM00038 EQU   EXCLFLAG                                                 04792000
EXCLHEAD EQU   EXCLAGL                                                  04793000
@NM00037 EQU   CKFLAGS                                                  04794000
CKRETTYP EQU   CKFLAGS                                                  04795000
CKLABELP EQU   CKAGL+24                                                 04796000
CKDATYPE EQU   CKAGL+20                                                 04797000
CKHEAD   EQU   CKAGL                                                    04798000
PULABELP EQU   PUAGL+16                                                 04799000
PUTTRPTR EQU   PUAGL+12                                                 04800000
PUUCBPTR EQU   PUAGL+8                                                  04801000
PUHEAD   EQU   PUAGL                                                    04802000
@NM00036 EQU   MDFLAGS                                                  04803000
MDENQ    EQU   MDFLAGS                                                  04804000
MDPOST   EQU   MDFLAGS                                                  04805000
MDCLEAR  EQU   MDFLAGS                                                  04806000
MDNEWVOL EQU   MDFLAGS                                                  04807000
MDPUAGL  EQU   MDAGL+20                                                 04808000
MDHEAD   EQU   MDAGL                                                    04809000
CTTBLRR  EQU   CTARRAY+3                                                04810000
CTTBLHH  EQU   CTARRAY+2                                                04811000
CTTBLCC  EQU   CTARRAY+1                                                04812000
CTTBLID  EQU   CTARRAY                                                  04813000
CTREALH  EQU   CTMSG+3                                                  04814000
CTREALCC EQU   CTMSG+1                                                  04815000
@NM00035 EQU   CTMSG                                                    04816000
CMNUMCRT EQU   CMMSG+15                                                 04817000
@NM00034 EQU   CMMSG+14                                                 04818000
CMNEWVOL EQU   CMMSG+8                                                  04819000
@NM00033 EQU   CMMSG+7                                                  04820000
@NM00032 EQU   CMVOLFLG                                                 04821000
CMRONLY  EQU   CMVOLFLG                                                 04822000
CMBIND   EQU   CMVOLFLG                                                 04823000
CMSCRCRT EQU   CMVOLFLG                                                 04824000
CMEXCL   EQU   CMVOLFLG                                                 04825000
CMDERAS  EQU   CMVOLFLG                                                 04826000
CMSCRVOL EQU   CMVOLFLG                                                 04827000
CMCECART EQU   CMVOLFLG                                                 04828000
CMOLDVOL EQU   CMMSG                                                    04829000
CCOLDCSN EQU   CCMSG+24                                                 04830000
CCNEWCSN EQU   CCMSG+12                                                 04831000
@NM00031 EQU   CCMSG+10                                                 04832000
CCVOL    EQU   CCMSG+4                                                  04833000
@NM00030 EQU   CCMSG+2                                                  04834000
CCEJCODE EQU   CCMSG+1                                                  04835000
CCPSTCDE EQU   CCMSG                                                    04836000
FILELEN  EQU   FILE                                                     04837000
@NM00029 EQU   DMPARY+15                                                04838000
DMPARYTP EQU   DMPARY+14                                                04839000
DMPARYEX EQU   DMPARY+12                                                04840000
DMPARYIC EQU   DMPARY+10                                                04841000
DMPARYSZ EQU   DMPARY+8                                                 04842000
DMPARYNM EQU   DMPARY                                                   04843000
@NM00028 EQU   DMPITM+15                                                04844000
@NM00027 EQU   FMTCNVF+1                                                04845000
FMTBS    EQU   FMTCNVF+1                                                04846000
FMTSS    EQU   FMTCNVF+1                                                04847000
FMTAL    EQU   FMTCNVF+1                                                04848000
FMTZS    EQU   FMTCNVF+1                                                04849000
@NM00026 EQU   FMTCNVF                                                  04850000
FMTPU    EQU   FMTCNVF                                                  04851000
FMTBD    EQU   FMTCNVF                                                  04852000
FMTBHD   EQU   FMTCNVF                                                  04853000
FMTBHA   EQU   FMTCNVF                                                  04854000
FMTBH    EQU   FMTCNVF                                                  04855000
FMTOLEN  EQU   FMTLIST+8                                                04856000
FMTRIO   EQU   FMTOCOL                                                  04857000
FMTSPT   EQU   FMTSTO                                                   04858000
FMTSTL   EQU   FMTILEN                                                  04859000
@NM00025 EQU   FMTFLGS+1                                                04860000
FMTHDF   EQU   FMTFLGS                                                  04861000
FMTDFF   EQU   FMTFLGS                                                  04862000
FMTSTF   EQU   FMTFLGS                                                  04863000
FMTREPF  EQU   FMTFLGS                                                  04864000
FMTBDF   EQU   FMTFLGS                                                  04865000
FMTIDF   EQU   FMTFLGS                                                  04866000
FMTSCF   EQU   FMTFLGS                                                  04867000
FMTEOLF  EQU   FMTFLGS                                                  04868000
DARGPCT  EQU   DARGINL                                                  04869000
DARGREP  EQU   DARGINS                                                  04870000
@NM00024 EQU   DARGLIST+19                                              04871000
DARGIND  EQU   DARGLIST+18                                              04872000
UVOLVOL  EQU   UVOLENT+4                                                04873000
UVOLDEV  EQU   UVOLENT                                                  04874000
UVOLCNT  EQU   UVOLLIST                                                 04875000
@NM00023 EQU   IOINFOPT                                                 04876000
IOINFTMS EQU   IOINFOPT                                                 04877000
IOINFSUP EQU   IOINFOPT                                                 04878000
IOINFDSN EQU   IOINFOPT                                                 04879000
IOINFVOL EQU   IOINFOPT                                                 04880000
IOINFDVT EQU   IOINFOPT                                                 04881000
OPNVOL   EQU   OPNAGL+44                                                04882000
@NM00022 EQU   OPNAGL+43                                                04883000
@NM00021 EQU   OPNOPT2                                                  04884000
OPNOPTJM EQU   OPNOPT2                                                  04885000
OPNOPTNF EQU   OPNOPT2                                                  04886000
OPNOPTAS EQU   OPNOPT2                                                  04887000
@NM00020 EQU   OPNDSO                                                   04888000
OPNDSOPO EQU   OPNDSO                                                   04889000
OPNDSOIS EQU   OPNDSO                                                   04890000
OPNDSOPS EQU   OPNDSO                                                   04891000
OPNDSOAM EQU   OPNDSO                                                   04892000
OPNKYL   EQU   OPNAGL+40                                                04893000
OPNBLK   EQU   OPNAGL+36                                                04894000
OPNREC   EQU   OPNAGL+32                                                04895000
OPNDEVIX EQU   OPNDEV+4                                                 04896000
OPNDEVDT EQU   OPNDEV                                                   04897000
OPNCBP   EQU   OPNAGL+20                                                04898000
OPNDSN   EQU   OPNAGL+16                                                04899000
OPNPWA   EQU   OPNAGL+12                                                04900000
OPNDDN   EQU   OPNAGL+8                                                 04901000
OPNIOC   EQU   OPNAGL+4                                                 04902000
OPNMODRP EQU   OPNMOD                                                   04903000
OPNMODUB EQU   OPNMOD                                                   04904000
OPNMODRS EQU   OPNMOD                                                   04905000
OPNMODAX EQU   OPNMOD                                                   04906000
OPNMODRR EQU   OPNMOD                                                   04907000
OPNMODRC EQU   OPNMOD                                                   04908000
OPNMODAC EQU   OPNMOD                                                   04909000
OPNMODPD EQU   OPNMOD                                                   04910000
@NM00019 EQU   OPNTYP                                                   04911000
OPNTYPRV EQU   OPNTYP                                                   04912000
OPNTYPEX EQU   OPNTYP                                                   04913000
OPNTYPRA EQU   OPNTYP                                                   04914000
OPNTYPXM EQU   OPNTYP                                                   04915000
OPNTYPCI EQU   OPNTYP                                                   04916000
OPNTYPSO EQU   OPNTYP                                                   04917000
OPNTYPSI EQU   OPNTYP                                                   04918000
@NM00018 EQU   OPNRFM                                                   04919000
OPNRFMBK EQU   OPNRFM                                                   04920000
OPNRFMSF EQU   OPNRFM                                                   04921000
OPNRFMUN EQU   OPNRFM                                                   04922000
OPNRFMVR EQU   OPNRFM                                                   04923000
OPNRFMFX EQU   OPNRFM                                                   04924000
OPNOPTSK EQU   OPNOPT                                                   04925000
OPNOPTDR EQU   OPNOPT                                                   04926000
OPNOPTCR EQU   OPNOPT                                                   04927000
OPNOPTKS EQU   OPNOPT                                                   04928000
OPNOPTBK EQU   OPNOPT                                                   04929000
OPNOPTUP EQU   OPNOPT                                                   04930000
OPNOPTOT EQU   OPNOPT                                                   04931000
OPNOPTIN EQU   OPNOPT                                                   04932000
IOCEXT   EQU   IOCSTR+64                                                04933000
IOCREL   EQU   IOCSTR+60                                                04934000
IOCWORK  EQU   IOCSTR+56                                                04935000
IOCRRN   EQU   IOCSTR+52                                                04936000
IOCPNM   EQU   IOCNWM+2                                                 04937000
IOCPTL   EQU   IOCNWM                                                   04938000
IOCKYA   EQU   IOCMEM                                                   04939000
IOCVRC   EQU   IOCTTR                                                   04940000
IOCCBP   EQU   IOCSTR+36                                                04941000
IOCDSN   EQU   IOCSTR+32                                                04942000
IOCHURBA EQU   IOCSTR+28                                                04943000
IOCVOLSR EQU   IOCSTR+22                                                04944000
@NM00017 EQU   IOCMSG                                                   04945000
IOCMSGAE EQU   IOCMSG                                                   04946000
IOCMSGCE EQU   IOCMSG                                                   04947000
IOCMSGOE EQU   IOCMSG                                                   04948000
IOCMSGOP EQU   IOCMSG                                                   04949000
@NM00016 EQU   IOCMSG                                                   04950000
IOCCHPSY EQU   IOCCHP                                                   04951000
IOCCHPAS EQU   IOCCHP                                                   04952000
IOCCHPBK EQU   IOCCHP                                                   04953000
IOCCHPCR EQU   IOCCHP                                                   04954000
IOCCHPKS EQU   IOCCHP                                                   04955000
IOCCHPSK EQU   IOCCHP                                                   04956000
IOCCHPDR EQU   IOCCHP                                                   04957000
IOCCHPSQ EQU   IOCCHP                                                   04958000
@NM00015 EQU   IOCMAC2                                                  04959000
IOCMACPA EQU   IOCMAC2                                                  04960000
IOCMACNF EQU   IOCMAC2                                                  04961000
IOCMACCP EQU   IOCMAC2                                                  04962000
IOCMACRR EQU   IOCMAC2                                                  04963000
IOCMACAS EQU   IOCMAC2                                                  04964000
IOCMACSK EQU   IOCMAC2                                                  04965000
@NM00014 EQU   IOCMAC                                                   04966000
IOCMACCC EQU   IOCMAC                                                   04967000
IOCMACDR EQU   IOCMAC                                                   04968000
IOCMACBK EQU   IOCMAC                                                   04969000
IOCMACCR EQU   IOCMAC                                                   04970000
IOCMACUP EQU   IOCMAC                                                   04971000
IOCMACOT EQU   IOCMAC                                                   04972000
IOCMACIN EQU   IOCMAC                                                   04973000
@NM00013 EQU   IOCRFM                                                   04974000
IOCRFMBK EQU   IOCRFM                                                   04975000
IOCRFMSF EQU   IOCRFM                                                   04976000
IOCRFMUN EQU   IOCRFM                                                   04977000
IOCRFMVR EQU   IOCRFM                                                   04978000
IOCRFMFX EQU   IOCRFM                                                   04979000
@NM00012 EQU   IOCDSO                                                   04980000
IOCDSOPO EQU   IOCDSO                                                   04981000
IOCDSOIS EQU   IOCDSO                                                   04982000
IOCDSOPS EQU   IOCDSO                                                   04983000
IOCDSOAM EQU   IOCDSO                                                   04984000
IOCRKP   EQU   IOCSTR+13                                                04985000
IOCKYL   EQU   IOCSTR+12                                                04986000
IOCTRN   EQU   IOCSTR+8                                                 04987000
IOCDLN   EQU   IOCSTR+4                                                 04988000
IOCDAD   EQU   IOCSTR                                                   04989000
UNITVTOC EQU   UNITABL+7                                                04990000
@NM00011 EQU   UNITSTAT                                                 04991000
UNITXSHR EQU   UNITSTAT                                                 04992000
UNITISHR EQU   UNITSTAT                                                 04993000
UNITUA   EQU   @NM00010+1                                               04994000
UNITCHA  EQU   @NM00010                                                 04995000
UNITUCB  EQU   UNITABL                                                  04996000
@NM00009 EQU   ALLOPT                                                   04997000
ALLOPTDS EQU   ALLOPT                                                   04998000
@NM00008 EQU   ALLORG+1                                                 04999000
ALLORGVS EQU   ALLORG+1                                                 05000000
@NM00007 EQU   ALLORG+1                                                 05001000
ALLORGGS EQU   ALLORG+1                                                 05002000
ALLORGUN EQU   ALLORG                                                   05003000
ALLORGPO EQU   ALLORG                                                   05004000
ALLORGMQ EQU   ALLORG                                                   05005000
ALLORGCQ EQU   ALLORG                                                   05006000
ALLORGCX EQU   ALLORG                                                   05007000
ALLORGDA EQU   ALLORG                                                   05008000
ALLORGPS EQU   ALLORG                                                   05009000
ALLORGIS EQU   ALLORG                                                   05010000
ALLDSPUN EQU   ALLDSP                                                   05011000
ALLDSPCG EQU   ALLDSP                                                   05012000
ALLDSPDE EQU   ALLDSP                                                   05013000
ALLDSPKP EQU   ALLDSP                                                   05014000
@NM00006 EQU   ALLDSP                                                   05015000
ALLSTSOD EQU   ALLSTS                                                   05016000
ALLSTSMD EQU   ALLSTS                                                   05017000
ALLSTSNW EQU   ALLSTS                                                   05018000
ALLSTSSR EQU   ALLSTS                                                   05019000
@NM00005 EQU   ALLSTS                                                   05020000
ALLPWD   EQU   ALLAGL+20                                                05021000
ALLDSN   EQU   ALLAGL                                                   05022000
CIRPID   EQU   CIRAGL+28                                                05023000
CIRPWD   EQU   CIRAGL+24                                                05024000
CIRCAT   EQU   CIRAGL+20                                                05025000
CIRWKP   EQU   CIRAGL+16                                                05026000
CIRTLR   EQU   CIRAGL+12                                                05027000
CIRHDR   EQU   CIRAGL+8                                                 05028000
CIRTLN   EQU   CIRAGL+6                                                 05029000
CIRHLN   EQU   CIRAGL+4                                                 05030000
@NM00004 EQU   CIRAGL+1                                                 05031000
@NM00003 EQU   CIRTYPE                                                  05032000
CIRTYPAQ EQU   CIRTYPE                                                  05033000
CIRTYP1Q EQU   CIRTYPE                                                  05034000
NEWID1   EQU   TRACE1+95                                                05035000
CALLID   EQU   OLDERID1+90                                              05036000
@NM00002 EQU   OLDERID1                                                 05037000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05038000
@RF00276 EQU   @RC00270                                                 05039000
@RF00474 EQU   @RC00438                                                 05040000
@RC00440 EQU   @RC00438                                                 05041000
@RF00705 EQU   @RC00690                                                 05042000
@RF00825 EQU   @RC00797                                                 05043000
@RC00869 EQU   @RC00859                                                 05044000
@RC00917 EQU   @RC00899                                                 05045000
@RC00929 EQU   @RC00899                                                 05046000
@PB00009 EQU   @EL00001                                                 05047000
@RF00454 EQU   @RC00440                                                 05048000
@RC00460 EQU   @RC00440                                                 05049000
@PB00008 EQU   @PB00009                                                 05050000
@RF00882 EQU   @RC00869                                                 05051000
@RC00461 EQU   @RC00460                                                 05052000
@PB00007 EQU   @PB00008                                                 05053000
@RF00467 EQU   @RC00461                                                 05054000
@PB00006 EQU   @PB00007                                                 05055000
@PB00005 EQU   @PB00006                                                 05056000
@PB00004 EQU   @PB00005                                                 05057000
@PB00003 EQU   @PB00004                                                 05058000
@PB00002 EQU   @PB00003                                                 05059000
@ENDDATA EQU   *                                                        05060000
         END   IDCSV01,(C'PLS0752',0603,75091)                          05061000
