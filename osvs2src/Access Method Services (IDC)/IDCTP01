         TITLE '          **********  IDCTP01 - FORMAT MODULE  *********00001000
               ***      '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCTP01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL2(@EP00002-@MAINENT)                                   00017000
         DC    AL1(16)                                             0002 00018000
         DC    C'IDCTP01   77.341'                                 0002 00019000
IDCTPPR  DS    0H                                                  0002 00020000
         USING *,@15                                               0002 00021000
         B     @PROLOG                                             0002 00022000
         DC    AL2(@EP00250-IDCTPPR)                                    00023000
         ENTRY IDCTPPR                                                  00024000
         DROP  @15                                                      00025000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00026000
         BALR  @10,0                                               0002 00027000
@PSTART  LA    @11,4095(,@10)                                      0002 00028000
         LA    @12,4095(,@11)                                      0002 00029000
         USING @PSTART,@10                                         0002 00030000
         USING @PSTART+4095,@11                                    0002 00031000
         USING @PSTART+8190,@12                                    0002 00032000
         L     @00,@SIZDATD                                        0002 00033000
         GETMAIN  R,LV=(0)                                              00034000
         LR    @08,@01                                             0002 00035000
         USING @DATD,@08                                           0002 00036000
         ST    @13,@SA00001+4                                      0002 00037000
         LM    @15,@01,16(@13)                                     0002 00038000
         ST    @08,8(,@13)                                         0002 00039000
         LR    @13,@08                                             0002 00040000
         AH    @15,4(,@15)                                         0002 00041000
         BR    @15                                                 0002 00042000
@EP00002 DS    0H                                                  0003 00043000
*         /***********************************************************/ 00044000
*         /*                                                         */ 00045000
*         /* THE RUNNING CODE BEGINS HERE.  FIRST, WE MUST SET UP    */ 00046000
*         /* WORKING STORAGE.                                        */ 00047000
*         /*                                                         */ 00048000
*         /***********************************************************/ 00049000
*                                                                  0250 00050000
*IDCTPPR: ENTRY (GDTTBLX,FILENAME,DDPTR,FMPTR);                    0250 00051000
*                                                                  0250 00052000
*                                                                  0250 00053000
         B     @EC00250                                            0250 00054000
@EP00250 MVC   @PC00001(16),0(@01)                                 0250 00055000
@EC00250 DS    0H                                                  0251 00056000
*                                                                  0251 00057000
*        /************************************************************/ 00058000
*        /*                                                          */ 00059000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 00060000
*        /*                                                          */ 00061000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 00062000
*        /*              TO THIS ROUTINE                             */ 00063000
*        /*                                                          */ 00064000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 00065000
*        /*               ADDRESS LIST                               */ 00066000
*        /*                                                          */ 00067000
*        /************************************************************/ 00068000
*                                                                  0251 00069000
*        GEN;                                                      0251 00070000
        ST    1,LISTPTR                                                 00071000
        ST    1,LISTSCAN                                                00072000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0252 00073000
         LA    @03,1                                               0252 00074000
         STC   @03,LISTLN                                          0252 00075000
@DL00252 L     @15,LISTSCAN                                        0252 00076000
         TM    LISTTEST(@15),B'10000000'                           0252 00077000
         BNZ   @DC00252                                            0252 00078000
*          LISTSCAN = LISTSCAN + 4;                                0253 00079000
         AL    @15,@CF00036                                        0253 00080000
         ST    @15,LISTSCAN                                        0253 00081000
*        END;                                                      0254 00082000
*                                                                  0254 00083000
*                                                                  0254 00084000
         AL    @03,@CF00216                                        0254 00085000
         STC   @03,LISTLN                                          0254 00086000
         C     @03,@CF00894                                        0254 00087000
         BNH   @DL00252                                            0254 00088000
@DC00252 DS    0H                                                  0255 00089000
*         GDTPR = ADDR(GDTTBLX);                                   0255 00090000
         L     GDTPR,@PC00001                                      0255 00091000
*         IF GDTTPH = NULLPTR                                      0256 00092000
*           THEN                                                   0256 00093000
         L     @03,GDTTPH(,GDTPR)                                  0256 00094000
         LTR   @03,@03                                             0256 00095000
         BNZ   @RF00256                                            0256 00096000
*             /*******************************************************/ 00097000
*             /*                                                     */ 00098000
*             /* AN ENTRY AT THIS POINT WITHOUT A PCT POINTER IS     */ 00099000
*             /* A CATASTROPHE.                                      */ 00100000
*             /*                                                     */ 00101000
*             /*******************************************************/ 00102000
*                                                                  0257 00103000
*                                                                  0257 00104000
*             DO;                                                  0257 00105000
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0258 00106000
*               REG15 = 24;                                        0259 00107000
         LA    REG15,24                                            0259 00108000
*               REG14 = GDTABT;                                    0260 00109000
         L     REG14,GDTABT(,GDTPR)                                0260 00110000
*               REG13 = GDTABH;                                    0261 00111000
         L     REG13,GDTABH(,GDTPR)                                0261 00112000
*               GEN(BR    REG14);                                  0262 00113000
         BR    REG14                                                    00114000
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0263 00115000
*             END;                                                 0264 00116000
*                                                                  0264 00117000
*         DDSTRU = DDPTR;                                          0265 00118000
@RF00256 L     @04,@PC00001+8                                      0265 00119000
         L     DDSTRU,DDPTR(,@04)                                  0265 00120000
*         PCTPTR = GDTTPH;              /* SET LOCAL PCT PTR.        */ 00121000
         L     PCTPTR,GDTTPH(,GDTPR)                               0266 00122000
*        PRTBUFPT = ADDR(PRTBUFF1);    /* PRIMARY PRINT BUFFER       */ 00123000
         LA    @04,PRTBUFF1                                        0267 00124000
         ST    @04,PRTBUFPT                                        0267 00125000
*         IF PCTSPP ^= NULLPTR                                     0268 00126000
*           THEN                                                   0268 00127000
         L     @04,PCTSPP(,PCTPTR)                                 0268 00128000
         LTR   @04,@04                                             0268 00129000
         BZ    @RF00268                                            0268 00130000
*             PCTPTR = PCTSPP;          /* SET SECONDARY PCT PTR     */ 00131000
         LR    PCTPTR,@04                                          0269 00132000
*         FFMFLAG = ''B;                /* CLEAR THE CONTROL FLAGS   */ 00133000
@RF00268 XC    FFMFLAG(2),FFMFLAG                                  0270 00134000
*         FFM2FLG = ''B;                /* CLEAR CONTROL FLAG@OZ18517*/ 00135000
         XC    FFM2FLG(2),FFM2FLG                                  0271 00136000
*         FFMREDOS = 0;                 /* CLEAR REDO START.         */ 00137000
         SLR   @04,@04                                             0272 00138000
         ST    @04,FFMREDOS                                        0272 00139000
*         FFMREDOC = 0;                 /* INITIALIZE REDO COUNT.    */ 00140000
         STH   @04,FFMREDOC                                        0273 00141000
*         FFMBDP = DARGDBP;             /* SET DATA BLOCK POINTER.   */ 00142000
         L     @15,DARGDBP(,DDSTRU)                                0274 00143000
         ST    @15,FFMBDP                                          0274 00144000
*         FFMRBOFF = 0;                 /* INITIALIZE REDO OFFSET.   */ 00145000
         ST    @04,FFMRBOFF                                        0275 00146000
*         IF DARGFULL = ON                                 /*@OZ14818*/ 00147000
*           THEN                                           /*@OZ14818*/ 00148000
         TM    DARGFULL(DDSTRU),B'10000000'                        0276 00149000
         BNO   @RF00276                                            0276 00150000
*             CVPRETP = NULLPTR;                           /*@OZ14818*/ 00151000
         ST    @04,CVPRETP                                         0277 00152000
*           ELSE                                           /*@OZ14818*/ 00153000
*             CVPRETP = DARGRETP;                          /*@OZ14818*/ 00154000
         B     @RC00276                                            0278 00155000
@RF00276 L     @04,DARGRETP(,DDSTRU)                               0278 00156000
         ST    @04,CVPRETP                                         0278 00157000
*         DARGILP1 = NULLPTR;                              /*@OZ14818*/ 00158000
@RC00276 SLR   @04,@04                                             0279 00159000
         ST    @04,DARGILP1                                        0279 00160000
*         CVPRETC = DARGRETL;           /* SET RETURN AREA LENGTH.   */ 00161000
         LH    @15,DARGRETL(,DDSTRU)                               0280 00162000
         STH   @15,CVPRETC                                         0280 00163000
*         FFMPASS = ON;                 /* TURN ON THE FIRST PASS SW */ 00164000
         OI    FFMPASS,B'00010000'                                 0281 00165000
*         PRTBUFF1 = ' ';               /* PRIME FORMAT BUFF.@Y30SSJK*/ 00166000
         MVI   PRTBUFF1+1,C' '                                     0282 00167000
         MVC   PRTBUFF1+2(133),PRTBUFF1+1                          0282 00168000
         MVI   PRTBUFF1,C' '                                       0282 00169000
*         PRTBUFF2 = ' ';               /* 2ND LEVEL BUFF.   @Y30SSJK*/ 00170000
         MVI   PRTBUFF2+1,C' '                                     0283 00171000
         MVC   PRTBUFF2+2(133),PRTBUFF2+1                          0283 00172000
         MVI   PRTBUFF2,C' '                                       0283 00173000
*         SAVERC = 0;                   /* INITIALIZE RETURN CODE.   */ 00174000
         STH   @04,SAVERC                                          0284 00175000
*         PCTAPC = 0;                   /* CLEAR NEXT PRINT POSITION */ 00176000
         STH   @04,PCTAPC(,PCTPTR)                                 0285 00177000
*         PCTIOP = FILENAME;            /* SET ALTERNATE IOCS PTR    */ 00178000
         L     @15,@PC00001+4                                      0286 00179000
         L     @15,FILENAME(,@15)                                  0286 00180000
         ST    @15,PCTIOP(,PCTPTR)                                 0286 00181000
*         PCTPMN =''B;                  /*RESET PUT MSG NBR          */ 00182000
*                                                                  0287 00183000
         SLR   @15,@15                                             0287 00184000
         STH   @15,PCTPMN(,PCTPTR)                                 0287 00185000
*         /***********************************************************/ 00186000
*         /*                                                         */ 00187000
*         /* SET UP THE FORMAT STRUCTURED ARGUMENT LIST ADDRESSING.  */ 00188000
*         /* IF AN STID EXISTS IN THE DYNAMIC DATA STRUCTURE,        */ 00189000
*         /* SEARCH THE QUEUED LIST FOR IT AND IF NOT FOUND, GET     */ 00190000
*         /* IT WITH A CALL TO IDCTP05. (GET STATIC TEXT)            */ 00191000
*         /* IF NO STID EXISTS, THEN SET UP THE ADDRESSING FROM THE  */ 00192000
*         /* POINTER PASSED WITH THE CALL.                           */ 00193000
*         /*                                                         */ 00194000
*         /***********************************************************/ 00195000
*                                                                  0288 00196000
*         IF GDTDBG = NULLPTR                                      0288 00197000
*           THEN;                                                  0288 00198000
         C     @04,GDTDBG(,GDTPR)                                  0288 00199000
         BE    @RT00288                                            0288 00200000
*           ELSE                                                   0290 00201000
*             CALL IDCDB010 (GDTTBL,'TPSI');                       0290 00202000
*                                                                  0290 00203000
         ST    GDTPR,@AL00001                                      0290 00204000
         LA    @04,@CC00898                                        0290 00205000
         ST    @04,@AL00001+4                                      0290 00206000
         MVI   @AL00001+4,X'80'                                    0290 00207000
         L     @15,GDTDBG(,GDTPR)                                  0290 00208000
         LA    @01,@AL00001                                        0290 00209000
         BALR  @14,@15                                             0290 00210000
*         IF DARGSTID ^= NULLPTR                                   0291 00211000
*           THEN                                                   0291 00212000
@RT00288 L     @04,DARGSTID(,DDSTRU)                               0291 00213000
         LTR   @04,@04                                             0291 00214000
         BZ    @RF00291                                            0291 00215000
*             DO;                                                  0292 00216000
*             /*******************************************************/ 00217000
*             /*                                                     */ 00218000
*             /* SEARCH THE STATIC TEXT QUEUE FOR THIS STID.         */ 00219000
*             /*  THIS QUEUE IS KEPT DURING EACH FSR EXECUTION.      */ 00220000
*             /*                                                     */ 00221000
*             /*******************************************************/ 00222000
*                                                                  0293 00223000
*               QENTP = PCTSQP;                                    0293 00224000
         L     @06,PCTSQP(,PCTPTR)                                 0293 00225000
         ST    @06,QENTP                                           0293 00226000
*               DO WHILE QENTP ^= NULLPTR & QSTID ^= DARGSTID;     0294 00227000
         B     @DE00294                                            0294 00228000
@DL00294 DS    0H                                                  0295 00229000
*                 QENTP = QCHAIN;                                  0295 00230000
         L     @06,QENTP                                           0295 00231000
         L     @06,QCHAIN(,@06)                                    0295 00232000
         ST    @06,QENTP                                           0295 00233000
*               END;                                               0296 00234000
@DE00294 L     @06,QENTP                                           0296 00235000
         LTR   @06,@06                                             0296 00236000
         BZ    @DC00294                                            0296 00237000
         CLC   QSTID(4,@06),DARGSTID(DDSTRU)                       0296 00238000
         BNE   @DL00294                                            0296 00239000
@DC00294 DS    0H                                                  0297 00240000
*               IF QENTP = NULLPTR                                 0297 00241000
*                 THEN                                             0297 00242000
         L     @06,QENTP                                           0297 00243000
         LTR   @06,@06                                             0297 00244000
         BNZ   @RF00297                                            0297 00245000
*                   DO;                                            0298 00246000
*                                                                  0298 00247000
*                   /*************************************************/ 00248000
*                   /*                                               */ 00249000
*                   /* MAKE THE CALL TO GET STATIC TEXT (IDCTP05)    */ 00250000
*                   /* THE ADDRESSING TO THE FORMAT LIST IS SET BY   */ 00251000
*                   /* THE ADDRESS RETURNED FROM GET STATIC TEXT.    */ 00252000
*                   /*                                               */ 00253000
*                   /*************************************************/ 00254000
*                                                                  0299 00255000
*                       CALL  IDCTP05(GDTTBL,                      0299 00256000
*                       DARGSTID,SBPOOL,QENTP);                    0299 00257000
*                                                                  0299 00258000
         ST    GDTPR,@AL00001                                      0299 00259000
         LA    @06,DARGSTID(,DDSTRU)                               0299 00260000
         ST    @06,@AL00001+4                                      0299 00261000
         LA    @06,SBPOOL                                          0299 00262000
         ST    @06,@AL00001+8                                      0299 00263000
         LA    @06,QENTP                                           0299 00264000
         ST    @06,@AL00001+12                                     0299 00265000
         L     @15,@CV00881                                        0299 00266000
         LA    @01,@AL00001                                        0299 00267000
         BALR  @14,@15                                             0299 00268000
*                       RESPECIFY RTNREG RSTD;                     0300 00269000
*                       TESTRC = RTNREG;                           0301 00270000
         STH   RTNREG,TESTRC                                       0301 00271000
*                       RESPECIFY RTNREG UNRSTD;                   0302 00272000
*                       IF TESTRC ^= 0                             0303 00273000
*                         THEN                                     0303 00274000
         LH    @06,TESTRC                                          0303 00275000
         LTR   @06,@06                                             0303 00276000
         BZ    @RF00303                                            0303 00277000
*                           DO;                                    0304 00278000
*                             CALL ERROR(6);                       0305 00279000
         LA    @01,@AL00305                                        0305 00280000
         BAL   @14,ERROR                                           0305 00281000
*                             CALL IDCSAEP0(GDTTBL,MODID,TESTRC);  0306 00282000
         ST    GDTPR,@AL00001                                      0306 00283000
         LA    @06,MODID                                           0306 00284000
         ST    @06,@AL00001+4                                      0306 00285000
         LA    @06,TESTRC                                          0306 00286000
         ST    @06,@AL00001+8                                      0306 00287000
         MVI   @AL00001+8,X'80'                                    0306 00288000
         L     @15,GDTEPL(,GDTPR)                                  0306 00289000
         LA    @01,@AL00001                                        0306 00290000
         BALR  @14,@15                                             0306 00291000
*                           END;                                   0307 00292000
*                   END;                                           0308 00293000
*                                                                  0308 00294000
@RF00303 DS    0H                                                  0309 00295000
*               /*****************************************************/ 00296000
*               /*                                                   */ 00297000
*               /* IF THIS STATIC TEXT STRUCTURE IS FOR A HEADER,    */ 00298000
*               /* SET UP THE HEADING INFORMATION IN THE PCT.        */ 00299000
*               /*                                                   */ 00300000
*               /*****************************************************/ 00301000
*                                                                  0309 00302000
*               IF QHEADF = ON                                     0309 00303000
*                 THEN                                             0309 00304000
@RF00297 L     @06,QENTP                                           0309 00305000
         TM    QHEADF(@06),B'01000000'                             0309 00306000
         BNO   @RF00309                                            0309 00307000
*                   DO;                                            0310 00308000
*                     PCTHLC = QHLC;                               0311 00309000
         IC    @04,QHLC(,@06)                                      0311 00310000
         STC   @04,PCTHLC(,PCTPTR)                                 0311 00311000
*                     PCTHSC = QHSC;                               0312 00312000
         IC    @04,QHSC(,@06)                                      0312 00313000
         STC   @04,PCTHSC(,PCTPTR)                                 0312 00314000
*                     PCTH1F = ON;                                 0313 00315000
*                     PCTH2F = OFF;                                0314 00316000
         OI    PCTH1F(PCTPTR),B'10000000'                          0314 00317000
         NI    PCTH2F(PCTPTR),B'10111111'                          0314 00318000
*                   END;                                           0315 00319000
*               IF QMSGF = ON                                      0316 00320000
*                 THEN                                             0316 00321000
@RF00309 L     @06,QENTP                                           0316 00322000
         TM    QMSGF(@06),B'10000000'                              0316 00323000
         BNO   @RF00316                                            0316 00324000
*                   DO;                                            0317 00325000
*                     FFMPMSF = ON;                                0318 00326000
         OI    FFMPMSF,B'00010000'                                 0318 00327000
*                     PCTPMN = -1;                                 0319 00328000
*                                                                  0319 00329000
         MVC   PCTPMN(2,PCTPTR),@CH00900                           0319 00330000
*                     IF QSECMF = ON & Q2LMSG = ON                 0320 00331000
*                       THEN                                       0320 00332000
         TM    QSECMF(@06),B'00101000'                             0320 00333000
         BNO   @RF00320                                            0320 00334000
*                        FFMPSMS = ON; /* 2ND MESSAGE FLAG  @Y30SSJK*/  00335000
*                                                                  0321 00336000
         OI    FFMPSMS,B'00001000'                                 0321 00337000
*                   END;                                           0322 00338000
@RF00320 DS    0H                                                  0323 00339000
*               FSADDR = ADDR(QTEXT);                              0323 00340000
@RF00316 L     FSADDR,QENTP                                        0323 00341000
         LA    FSADDR,QTEXT(,FSADDR)                               0323 00342000
*             END;                                                 0324 00343000
*                                                                  0324 00344000
*             /*******************************************************/ 00345000
*             /*                                                     */ 00346000
*             /* SET THE ADDRESSING TO THE FORMAT LIST WHEN NO STID  */ 00347000
*             /* IS PASSED IN THE DYNAMIC ARGUMENT LIST.             */ 00348000
*             /*                                                     */ 00349000
*             /*******************************************************/ 00350000
*                                                                  0325 00351000
*           ELSE                                                   0325 00352000
*             DO;                                                  0325 00353000
         B     @RC00291                                            0325 00354000
@RF00291 DS    0H                                                  0326 00355000
*               IF LISTLN = 4                                      0326 00356000
*                 THEN                                             0326 00357000
         CLI   LISTLN,4                                            0326 00358000
         BNE   @RF00326                                            0326 00359000
*                   FSADDR = FMPTR;                                0327 00360000
         L     @04,@PC00001+12                                     0327 00361000
         L     FSADDR,FMPTR(,@04)                                  0327 00362000
*                 ELSE                                             0328 00363000
*                   DO;                                            0328 00364000
         B     @RC00326                                            0328 00365000
@RF00326 DS    0H                                                  0329 00366000
*                     CALL ERROR (1);                              0329 00367000
         LA    @01,@AL00329                                        0329 00368000
         BAL   @14,ERROR                                           0329 00369000
*                     CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);          0330 00370000
         MVC   @AL00001+4(8),@AL00330                              0330 00371000
         ST    GDTPR,@AL00001                                      0330 00372000
         L     @15,GDTEPL(,GDTPR)                                  0330 00373000
         LA    @01,@AL00001                                        0330 00374000
         BALR  @14,@15                                             0330 00375000
*                   END;                                           0331 00376000
*             END;                                                 0332 00377000
@RC00326 DS    0H                                                  0333 00378000
*         FFMSTRS = FSADDR;                                        0333 00379000
*                                                                  0333 00380000
@RC00291 ST    FSADDR,FFMSTRS                                      0333 00381000
*         /***********************************************************/ 00382000
*         /*                                                         */ 00383000
*         /* IF NO INITIAL SPACING SUB-STRUCTURE EXISTS, SET DEFAULT.*/ 00384000
*         /* SPACING FOR THE FIRST LINE.                             */ 00385000
*         /* DEFAULT SPACING IS SET FROM THE DEFAULT SPACE CHARACTER */ 00386000
*         /* IN THE PRINT CONTROL TABLE SET UP BY THE UEST OR UREST  */ 00387000
*         /* MACROS.                                                 */ 00388000
*         /* SPACE TYPE IS SET TO 'R'. (RELATIVE)                    */ 00389000
*         /*                                                         */ 00390000
*         /***********************************************************/ 00391000
*                                                                  0334 00392000
*         IF FMTSCF = OFF                                          0334 00393000
*           THEN                                                   0334 00394000
         TM    FMTSCF(FSADDR),B'01000000'                          0334 00395000
         BNZ   @RF00334                                            0334 00396000
*             DO;                                                  0335 00397000
*               PRTSPF = PCTDSC;        /* SET DEFAULT SPACE FACTOR  */ 00398000
         LH    @04,PCTDSC(,PCTPTR)                                 0336 00399000
         STH   @04,PRTSPF                                          0336 00400000
*               PRTSPT = 'R';           /* SET RELATIVE SPACING.     */ 00401000
         MVI   PRTSPT,C'R'                                         0337 00402000
*             END;                                                 0338 00403000
*                                                                  0338 00404000
*         /***********************************************************/ 00405000
*         /*                                                         */ 00406000
*         /* THIS IS THE BASE DO LOOP FOR EXECUTION OF THE FORMAT    */ 00407000
*         /* STRUCTURES.                                             */ 00408000
*         /* THIS LOOP SCANS THROUGH THE FORMAT LIST SUB-STRUCTURES  */ 00409000
*         /* SETTING UP PARAMETERS FOR THE CALL TO THE CONVERSION    */ 00410000
*         /* PROCEDURE(CONVERT) AND CALLING THAT PROC ONCE FOR EACH  */ 00411000
*         /* FORMAT SUB-STRUCTURE THAT DEFINES DATA.  (BLOCK, INSERT,*/ 00412000
*         /* STATIC TEXT OR DEFAULT SUB-STRUCTURES)                  */ 00413000
*         /* SPACE AND REDO SUB-STRUCTURES ARE HANDLED ENTIRELY      */ 00414000
*         /* WITHIN THIS PROCEDURE                                   */ 00415000
*         /* THE END OF THIS DO LOOP IS AFTER THE REDO LOOPING       */ 00416000
*         /* CONTROLS NEAR THE END OF THIS MAIN PROCEDURE.           */ 00417000
*         /* CONTROL FLAGS USED IN THIS ROUTINE ARE AS FOLLOWS       */ 00418000
*         /*    FFMEOS - END OF THE SUB-STRUCTURES.                  */ 00419000
*         /*    FFMVS - A VALID SUB-STRUCTURE FOUND.                 */ 00420000
*         /*    FFMDATA - A DATA SUB-STRUCTURE HAS BEEN FOUND.       */ 00421000
*         /*                                                         */ 00422000
*         /***********************************************************/ 00423000
*                                                                  0339 00424000
*STRLOOP: DO WHILE FFMEOS = OFF;        /* END OF STRUCT LIST FLAG   */ 00425000
*                                                                  0339 00426000
@RF00334 DS    0H                                                  0339 00427000
STRLOOP  B     @DE00339                                            0339 00428000
@DL00339 DS    0H                                                  0340 00429000
*          IF FMTSMSG = ON  &                                      0340 00430000
*             FFMPSMS = ON                                         0340 00431000
*            THEN                                                  0340 00432000
         TM    FMTSMSG(FSADDR),B'10000000'                         0340 00433000
         BNO   @RF00340                                            0340 00434000
         TM    FFMPSMS,B'00001000'                                 0340 00435000
         BNO   @RF00340                                            0340 00436000
*              PRTBUFPT = ADDR(PRTBUFF2);                  /*@Y30SSJK*/ 00437000
*                                                                  0341 00438000
         LA    @04,PRTBUFF2                                        0341 00439000
         ST    @04,PRTBUFPT                                        0341 00440000
*           IF FMTSCF = ON              /* SPACE CONTROL FLAG.       */ 00441000
*             THEN                                                 0342 00442000
@RF00340 TM    FMTSCF(FSADDR),B'01000000'                          0342 00443000
         BNO   @RF00342                                            0342 00444000
*               DO;                                                0343 00445000
*                 /***************************************************/ 00446000
*                 /*                                                 */ 00447000
*                 /* HANDLE A SPACING SUB-STRUCTURE.                 */ 00448000
*                 /*                                                 */ 00449000
*                 /***************************************************/ 00450000
*                                                                  0344 00451000
*                 FFMVS = ON;                                      0344 00452000
*                                                                  0344 00453000
         OI    FFMVS,B'01000000'                                   0344 00454000
*                 CALL SPACE;                                      0345 00455000
*                                                                  0345 00456000
         BAL   @14,SPACE                                           0345 00457000
*                 RESPECIFY RTNREG RSTD;                           0346 00458000
*                 TESTRC = RTNREG;                                 0347 00459000
         STH   RTNREG,TESTRC                                       0347 00460000
*                 RESPECIFY RTNREG UNRSTD;                         0348 00461000
*                 IF TESTRC ^= 0                                   0349 00462000
*                   THEN                                           0349 00463000
         LH    @04,TESTRC                                          0349 00464000
         LTR   @04,@04                                             0349 00465000
         BZ    @RF00349                                            0349 00466000
*                     CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);          0350 00467000
*                                                                  0350 00468000
         MVC   @AL00001+4(8),@AL00350                              0350 00469000
         ST    GDTPR,@AL00001                                      0350 00470000
         L     @15,GDTEPL(,GDTPR)                                  0350 00471000
         LA    @01,@AL00001                                        0350 00472000
         BALR  @14,@15                                             0350 00473000
*               END;                                               0351 00474000
*             ELSE                                                 0352 00475000
*               IF FMTREPF = ON         /* REDO FLAG.                */ 00476000
*                 THEN                                             0352 00477000
         B     @RC00342                                            0352 00478000
@RF00342 TM    FMTREPF(FSADDR),B'00001000'                         0352 00479000
         BNO   @RF00352                                            0352 00480000
*                   DO;                                            0353 00481000
*                   /*************************************************/ 00482000
*                   /*                                               */ 00483000
*                   /* HANDLE A REDO OR REPLICATION SUB-STRUCTURE.   */ 00484000
*                   /*                                               */ 00485000
*                   /*************************************************/ 00486000
*                     FFMVS = ON;                                  0354 00487000
*                                                                  0354 00488000
         OI    FFMVS,B'01000000'                                   0354 00489000
*                     CALL REDO;                                   0355 00490000
*                                                                  0355 00491000
         BAL   @14,REDO                                            0355 00492000
*                   END;                                           0356 00493000
*                 ELSE                                             0357 00494000
*                   IF FMTSTF = ON      /* STATIC TEXT FLAG.         */ 00495000
*                     THEN                                         0357 00496000
         B     @RC00352                                            0357 00497000
@RF00352 TM    FMTSTF(FSADDR),B'00000100'                          0357 00498000
         BNO   @RF00357                                            0357 00499000
*                       DO;                                        0358 00500000
*                       /*********************************************/ 00501000
*                       /*                                           */ 00502000
*                       /* HANDLE A STATIC TEXT SUB-STRUCTURE.       */ 00503000
*                       /*                                           */ 00504000
*                       /*********************************************/ 00505000
*                         FFMDATA = ON;                            0359 00506000
         OI    FFMDATA,B'00000010'                                 0359 00507000
*                         FFMVS = ON;                              0360 00508000
*                                                                  0360 00509000
         OI    FFMVS,B'01000000'                                   0360 00510000
*                         CALL STATIC;                             0361 00511000
*                                                                  0361 00512000
         BAL   @14,STATIC                                          0361 00513000
*                       END;                                       0362 00514000
*                     ELSE                                         0363 00515000
*                       IF FMTBDF = ON  /* BLOCK DATA FLAG.          */ 00516000
*                         THEN                                     0363 00517000
         B     @RC00357                                            0363 00518000
@RF00357 TM    FMTBDF(FSADDR),B'00010000'                          0363 00519000
         BNO   @RF00363                                            0363 00520000
*                           DO;                                    0364 00521000
*                           /*****************************************/ 00522000
*                           /*                                       */ 00523000
*                           /* HANDLE A BLOCK DATA SUB-STRUCTURE.    */ 00524000
*                           /*                                       */ 00525000
*                           /*****************************************/ 00526000
*                             FFMDATA = ON;                        0365 00527000
         OI    FFMDATA,B'00000010'                                 0365 00528000
*                             FFMVS = ON;                          0366 00529000
*                                                                  0366 00530000
         OI    FFMVS,B'01000000'                                   0366 00531000
*                             CALL BLOCK;                          0367 00532000
*                                                                  0367 00533000
         BAL   @14,BLOCK                                           0367 00534000
*                           END;                                   0368 00535000
*                         ELSE                                     0369 00536000
*                           IF FMTIDF = ON                         0369 00537000
*                                       /* INSERT DATA FLAG.         */ 00538000
*                             THEN                                 0369 00539000
         B     @RC00363                                            0369 00540000
@RF00363 TM    FMTIDF(FSADDR),B'00100000'                          0369 00541000
         BNO   @RF00369                                            0369 00542000
*                               DO;                                0370 00543000
*                               /*************************************/ 00544000
*                               /*                                   */ 00545000
*                               /* HANDLE A DATA INSERT  DATA        */ 00546000
*                               /* SUB-STRUCTURE.                    */ 00547000
*                               /*                                   */ 00548000
*                               /*************************************/ 00549000
*                                 FFMDATA = ON;                    0371 00550000
         OI    FFMDATA,B'00000010'                                 0371 00551000
*                                 FFMVS = ON;                      0372 00552000
*                                                                  0372 00553000
         OI    FFMVS,B'01000000'                                   0372 00554000
*                                 CALL INSERT;                     0373 00555000
*                                                                  0373 00556000
         BAL   @14,INSERT                                          0373 00557000
*                               END;                               0374 00558000
*                       ELSE                                       0375 00559000
*                         IF FMTDFF = ON                           0375 00560000
*                                       /* DEFAULT DATA FLAG.        */ 00561000
*                           THEN                                   0375 00562000
         B     @RC00369                                            0375 00563000
@RF00369 TM    FMTDFF(FSADDR),B'00000010'                          0375 00564000
         BNO   @RF00375                                            0375 00565000
*                             DO;                                  0376 00566000
*                             /***************************************/ 00567000
*                             /*                                     */ 00568000
*                             /* BYPASS A DEFAULT DATA SUB-STRUCTURE */ 00569000
*                             /* IF A DEFAULT DATA SUB-STRUCTURE     */ 00570000
*                             /* IS USED, IT IS USED IN THE INSERT   */ 00571000
*                             /* HANDLING CODE BECAUSE THE REFERENCE */ 00572000
*                             /* NUMBER WAS NOT FOUND IN THE USERS   */ 00573000
*                             /* DYNAMIC ARGUMENT LIST.  THERE FORE, */ 00574000
*                             /* IT IS NEVER USED IN LINE.           */ 00575000
*                             /*                                     */ 00576000
*                             /***************************************/ 00577000
*                               STRSTP = 12;                       0377 00578000
         MVC   STRSTP(2),@CH00034                                  0377 00579000
*                               FFMVS = ON;                        0378 00580000
         OI    FFMVS,B'01000000'                                   0378 00581000
*                             END;                                 0379 00582000
*           /*********************************************************/ 00583000
*           /*                                                       */ 00584000
*           /* CHECK TO INSURE THAT A VALID SUB-STRUCTURE WAS FOUND. */ 00585000
*           /* IF NONE WAS FOUND, ISSUE ERROR MESSAGE AND RETURN.    */ 00586000
*           /*                                                       */ 00587000
*           /*********************************************************/ 00588000
*           IF FFMVS = OFF                                         0380 00589000
*             THEN                                                 0380 00590000
@RF00375 DS    0H                                                  0380 00591000
@RC00369 DS    0H                                                  0380 00592000
@RC00363 DS    0H                                                  0380 00593000
@RC00357 DS    0H                                                  0380 00594000
@RC00352 DS    0H                                                  0380 00595000
@RC00342 TM    FFMVS,B'01000000'                                   0380 00596000
         BNZ   @RF00380                                            0380 00597000
*               DO;                                                0381 00598000
*                                                                  0381 00599000
*                 CALL ERROR(1);                                   0382 00600000
*                                                                  0382 00601000
         LA    @01,@AL00382                                        0382 00602000
         BAL   @14,ERROR                                           0382 00603000
*                 CALL IDCSAEP0(GDTTBL,MODID,RCERR);               0383 00604000
*                                                                  0383 00605000
         MVC   @AL00001+4(8),@AL00383                              0383 00606000
         ST    GDTPR,@AL00001                                      0383 00607000
         L     @15,GDTEPL(,GDTPR)                                  0383 00608000
         LA    @01,@AL00001                                        0383 00609000
         BALR  @14,@15                                             0383 00610000
*               END;                                               0384 00611000
*         /***********************************************************/ 00612000
*         /*                                                         */ 00613000
*         /* IF THE SUB STRUCTURE WAS A DATA HANDLING  STRUCTURE     */ 00614000
*         /* (A STATIC TEXT, BLOCK DATA OR INSERT DATA SUB-STRUCTURE)*/ 00615000
*         /* CONTINUE HERE WITH THE HANDLING OF THAT STRUCTURE.      */ 00616000
*         /* VERIFY AND SET UP THE OUTPUT COLUMN AND LENGTH FOR THE  */ 00617000
*         /* DATA TYPE TO BE HANDLED.                                */ 00618000
*         /*                                                         */ 00619000
*         /***********************************************************/ 00620000
*                                                                  0385 00621000
*           IF FFMDATA = ON & FFMPINH = OFF                        0385 00622000
*             THEN                                                 0385 00623000
@RF00380 TM    FFMDATA,B'00000010'                                 0385 00624000
         BNO   @RF00385                                            0385 00625000
         TM    FFMPINH,B'10000000'                                 0385 00626000
         BNZ   @RF00385                                            0385 00627000
*DATALOOP:      DO;                                                0386 00628000
*                                                                  0386 00629000
DATALOOP DS    0H                                                  0387 00630000
*                 /***************************************************/ 00631000
*                 /*                                                 */ 00632000
*                 /* SET UP THE CONVERSION FLAGS IN THE PRINT AND    */ 00633000
*                 /* CONVERSION ARGUMENT LIST.                       */ 00634000
*                 /*                                                 */ 00635000
*                 /***************************************************/ 00636000
*                                                                  0387 00637000
*                 CVPTYF = FMTCNVF;                                0387 00638000
         MVC   CVPTYF(2),FMTCNVF(FSADDR)                           0387 00639000
*                 /***************************************************/ 00640000
*                 /*                                                 */ 00641000
*                 /* SET THE PARAMETERS FOR THE CONVERSION CALL.     */ 00642000
*                 /* THE PARAMETERS SET ARE-                         */ 00643000
*                 /*    CVPIADD - THE INPUT STRING ADDRESS.          */ 00644000
*                 /*    CVPPADD - THE PRINT LINE POSITION ADDRESS.   */ 00645000
*                 /*    CVPIL - THE INPUT STRING LENGTH.             */ 00646000
*                 /*        SET IN INPUT SUB-STRUCTURE HANDLING      */ 00647000
*                 /*    CVPOL THE OUTPUT STRING LENGTH.              */ 00648000
*                 /*    CVPRETC = THE RETURN AREA LENGTH.            */ 00649000
*                 /*    CVPRETP - THE RETURN AREA POINTER.           */ 00650000
*                 /*                                                 */ 00651000
*                 /***************************************************/ 00652000
*                                                                  0388 00653000
*                 IF FMTBS = ON         /* IF BLANK SUPPRESSION.     */ 00654000
*                   THEN                /* ADD OFFSET IN FMTOCOL TO  */ 00655000
         TM    FMTBS(FSADDR),B'00010000'                           0388 00656000
         BNO   @RF00388                                            0388 00657000
*                                       /* LAST AVAILABLE POSITION.  */ 00658000
*                     CVPPADD = ADDR(PRTBUFF) + FMTOCOL + PCTAPC;  0389 00659000
         LH    @04,FMTOCOL(,FSADDR)                                0389 00660000
         AL    @04,PRTBUFPT                                        0389 00661000
         AH    @04,PCTAPC(,PCTPTR)                                 0389 00662000
         ST    @04,CVPPADD                                         0389 00663000
*                   ELSE                /* PRINT COLUMN IN FMTOCOL   */ 00664000
*                                       /* TO A POSSIBLE INDENT.     */ 00665000
*                     CVPPADD = ADDR(PRTBUFF) + FMTOCOL - 1 + DARGIND;  00666000
         B     @RC00388                                            0390 00667000
@RF00388 LH    @04,FMTOCOL(,FSADDR)                                0390 00668000
         AL    @04,PRTBUFPT                                        0390 00669000
         BCTR  @04,0                                               0390 00670000
         SLR   @15,@15                                             0390 00671000
         IC    @15,DARGIND(,DDSTRU)                                0390 00672000
         ALR   @04,@15                                             0390 00673000
         ST    @04,CVPPADD                                         0390 00674000
*                 CVPOL = FMTOLEN;      /* SET OUTPUT LENGTH.        */ 00675000
*                                                                  0391 00676000
@RC00388 LH    @04,FMTOLEN(,FSADDR)                                0391 00677000
         ST    @04,CVPOL                                           0391 00678000
*                 /***************************************************/ 00679000
*                 /*                                                 */ 00680000
*                 /* ASSURE PRINT COLUMN IS WITHIN THE PRINT LINE.   */ 00681000
*                 /*                                                 */ 00682000
*                 /***************************************************/ 00683000
*                                                                  0392 00684000
*                 IF CVPPADD > (ADDR(PRTBUFF) + PCTPLW - 1)        0392 00685000
*                   THEN                                           0392 00686000
         L     @04,PRTBUFPT                                        0392 00687000
         AL    @04,PCTPLW(,PCTPTR)                                 0392 00688000
         BCTR  @04,0                                               0392 00689000
         C     @04,CVPPADD                                         0392 00690000
         BNL   @RF00392                                            0392 00691000
*                     DO;                                          0393 00692000
*                                                                  0393 00693000
*                       CALL ERROR(2);                             0394 00694000
*                                                                  0394 00695000
         LA    @01,@AL00394                                        0394 00696000
         BAL   @14,ERROR                                           0394 00697000
*                       FFMPINH = ON;                              0395 00698000
         OI    FFMPINH,B'10000000'                                 0395 00699000
*                     END;                                         0396 00700000
*                                                                  0396 00701000
*         /***********************************************************/ 00702000
*         /*                                                         */ 00703000
*         /* COMPUTE THE CONVERTED LENGTH FOR THE VARIOUS DATA TYPES */ 00704000
*         /* CONVL IS USED IN THIS SECTION OF CODE TO HOLD THE       */ 00705000
*         /* COMPUTED OUTPUT LENGTH FOR THE SELECTED DATA TYPE.      */ 00706000
*         /*                                                         */ 00707000
*         /***********************************************************/ 00708000
*                                                                  0397 00709000
*           CONVL = 0;                                             0397 00710000
*                                                                  0397 00711000
@RF00392 SLR   @04,@04                                             0397 00712000
         ST    @04,CONVL                                           0397 00713000
*           /* SET BINARY TO HEXIDECIMAL OR PACKED TO UNPACKED.      */ 00714000
*           /*  OR BINARY TO HEXADECIMAL APOSTROPHE.         #Y30LSJK*/ 00715000
*                                                                  0398 00716000
*           IF CVPBH = ON | CVPPU = ON | CVPBHA = ON               0398 00717000
*             THEN                                                 0398 00718000
         TM    CVPBH,B'11001000'                                   0398 00719000
         BZ    @RF00398                                            0398 00720000
*               CONVL = CVPIL + CVPIL;                             0399 00721000
*                                                                  0399 00722000
         L     @04,CVPIL                                           0399 00723000
         LR    @15,@04                                             0399 00724000
         ALR   @15,@04                                             0399 00725000
         ST    @15,CONVL                                           0399 00726000
*           /* CHECK FOR MAXIMUM PACKED TO UNPACKED OUTPUT LENGTH.   */ 00727000
*                                                                  0400 00728000
*           IF CVPPU = ON                                          0400 00729000
*             THEN                                                 0400 00730000
@RF00398 TM    CVPPU,B'00001000'                                   0400 00731000
         BNO   @RF00400                                            0400 00732000
*               DO;                                                0401 00733000
*                 IF CVPOL > 16 | CVPIL > 8                        0402 00734000
*                   THEN                                           0402 00735000
         L     @04,CVPOL                                           0402 00736000
         C     @04,@CF00479                                        0402 00737000
         BH    @RT00402                                            0402 00738000
         L     @04,CVPIL                                           0402 00739000
         C     @04,@CF00176                                        0402 00740000
         BNH   @RF00402                                            0402 00741000
@RT00402 DS    0H                                                  0403 00742000
*                     DO;                                          0403 00743000
*                                                                  0403 00744000
*                       CALL ERROR(3);                             0404 00745000
*                                                                  0404 00746000
         LA    @01,@AL00404                                        0404 00747000
         BAL   @14,ERROR                                           0404 00748000
*                       IF CVPIL > 8                               0405 00749000
*                         THEN                                     0405 00750000
         LA    @04,8                                               0405 00751000
         C     @04,CVPIL                                           0405 00752000
         BNL   @RF00405                                            0405 00753000
*                           CVPIL = 8;                             0406 00754000
         ST    @04,CVPIL                                           0406 00755000
*                     END;                                         0407 00756000
@RF00405 DS    0H                                                  0408 00757000
*                CONVL = 16;                                       0408 00758000
@RF00402 MVC   CONVL(4),@CF00479                                   0408 00759000
*               END;                                               0409 00760000
*                                                                  0409 00761000
*           /* CHECK FOR MAXIMUM BINARY TO DECIMAL LENGTHS.          */ 00762000
*                                                                  0410 00763000
*          IF CVPBD = ON                                           0410 00764000
*            THEN                                                  0410 00765000
@RF00400 TM    CVPBD,B'00010000'                                   0410 00766000
         BNO   @RF00410                                            0410 00767000
*              DO;                                                 0411 00768000
*                IF CVPIL > 4 | CVPOL > 16                         0412 00769000
*                  THEN                                            0412 00770000
         L     @04,CVPIL                                           0412 00771000
         C     @04,@CF00036                                        0412 00772000
         BH    @RT00412                                            0412 00773000
         L     @04,CVPOL                                           0412 00774000
         C     @04,@CF00479                                        0412 00775000
         BNH   @RF00412                                            0412 00776000
@RT00412 DS    0H                                                  0413 00777000
*                    DO;                                           0413 00778000
*                                                                  0413 00779000
*                      CALL ERROR(3);                              0414 00780000
*                                                                  0414 00781000
         LA    @01,@AL00414                                        0414 00782000
         BAL   @14,ERROR                                           0414 00783000
*                      IF CVPIL > 4                                0415 00784000
*                        THEN                                      0415 00785000
         LA    @04,4                                               0415 00786000
         C     @04,CVPIL                                           0415 00787000
         BNL   @RF00415                                            0415 00788000
*                          CVPIL = 4;                              0416 00789000
         ST    @04,CVPIL                                           0416 00790000
*                    END;                                          0417 00791000
@RF00415 DS    0H                                                  0418 00792000
*                CONVL = 16;                                       0418 00793000
@RF00412 MVC   CONVL(4),@CF00479                                   0418 00794000
*              END;                                                0419 00795000
*                                                                  0419 00796000
*           /* IF NONE OF THE ABOVE, THEN SET TO THE INPUT LENGTH.   */ 00797000
*                                                                  0420 00798000
*           IF CONVL = 0                                           0420 00799000
*             THEN                                                 0420 00800000
@RF00410 L     @04,CONVL                                           0420 00801000
         LTR   @04,@04                                             0420 00802000
         BNZ   @RF00420                                            0420 00803000
*               CONVL = CVPIL;                                     0421 00804000
*                                                                  0421 00805000
         L     @04,CVPIL                                           0421 00806000
         ST    @04,CONVL                                           0421 00807000
*         /***********************************************************/ 00808000
*         /*                                                         */ 00809000
*         /*  SET OUTPUT LENGTH FOR ANY DEFAULTED LENGTH FIELD.      */ 00810000
*         /* CALLER SPECIFIED NO LENGTH IN THE FORMAT STRUCTURE.     */ 00811000
*         /* OR SPECIFIED LENGTH WAS LESS THAN DATA LENGTH.          */ 00812000
*         /*                                                         */ 00813000
*         /***********************************************************/ 00814000
*                                                                  0422 00815000
*           IF CVPOL = 0 | CONVL < CVPOL                           0422 00816000
*             THEN                                                 0422 00817000
@RF00420 L     @04,CVPOL                                           0422 00818000
         LTR   @04,@04                                             0422 00819000
         BZ    @RT00422                                            0422 00820000
         C     @04,CONVL                                           0422 00821000
         BNH   @RF00422                                            0422 00822000
@RT00422 DS    0H                                                  0423 00823000
*               CVPOL = CONVL;                                     0423 00824000
*                                                                  0423 00825000
         L     @04,CONVL                                           0423 00826000
         ST    @04,CVPOL                                           0423 00827000
*           /*********************************************************/ 00828000
*           /*                                                       */ 00829000
*           /* IF INPUT OR OUTPUT LENGTH IS LESS THAN ONE, THEN      */ 00830000
*           /* PUT OUT AN ERROR MESSAGE HERE AND TERMINATE.          */ 00831000
*           /*                                                       */ 00832000
*           /*********************************************************/ 00833000
*                                                                  0424 00834000
*           IF CVPOL < 1 | CVPIL < 1                               0424 00835000
*             THEN                                                 0424 00836000
@RF00422 LA    @04,1                                               0424 00837000
         C     @04,CVPOL                                           0424 00838000
         BH    @RT00424                                            0424 00839000
         C     @04,CVPIL                                           0424 00840000
         BNH   @RF00424                                            0424 00841000
@RT00424 DS    0H                                                  0425 00842000
*               DO;                                                0425 00843000
*                                                                  0425 00844000
*                 CALL ERROR(1);                                   0426 00845000
*                                                                  0426 00846000
         LA    @01,@AL00426                                        0426 00847000
         BAL   @14,ERROR                                           0426 00848000
*                 CALL IDCSAEP0(GDTTBL,MODID,RCERR);               0427 00849000
*                                                                  0427 00850000
         MVC   @AL00001+4(8),@AL00427                              0427 00851000
         ST    GDTPR,@AL00001                                      0427 00852000
         L     @15,GDTEPL(,GDTPR)                                  0427 00853000
         LA    @01,@AL00001                                        0427 00854000
         BALR  @14,@15                                             0427 00855000
*               END;                                               0428 00856000
*         /************************************************************ 00857000
*         /*                                                 #Y30LSJK*/ 00858000
*         /* ADJUST OUTPUT LENGTH FOR BINARY TO HEXADECIMAL. #Y30LSJK*/ 00859000
*         /*                                                 @Y30LSJK*/ 00860000
*         /************************************************************ 00861000
*         IF CVPBH = ON | CVPBHA = ON                              0429 00862000
*           THEN                                                   0429 00863000
@RF00424 TM    CVPBH,B'11000000'                                   0429 00864000
         BZ    @RF00429                                            0429 00865000
*             DO;                                          /*@Y30LSJK*/ 00866000
*             IF CVPOL // 2 ^= 0                                   0431 00867000
*               THEN                                               0431 00868000
         L     @04,CVPOL                                           0431 00869000
         LR    @00,@04                                             0431 00870000
         SRDA  @00,32                                              0431 00871000
         D     @00,@CF00150                                        0431 00872000
         LTR   @00,@00                                             0431 00873000
         BZ    @RF00431                                            0431 00874000
*                 CVPOL = CVPOL + 1;                       /*@Y30LSJK*/ 00875000
         AL    @04,@CF00216                                        0432 00876000
         ST    @04,CVPOL                                           0432 00877000
*             END;                                         /*@Y30LSJK*/ 00878000
*                                                                  0433 00879000
@RF00431 DS    0H                                                  0434 00880000
*         IF CVPBHA = ON                                           0434 00881000
*           THEN                                                   0434 00882000
@RF00429 TM    CVPBHA,B'01000000'                                  0434 00883000
         BNO   @RF00434                                            0434 00884000
*             CVPOL = CVPOL + 3;                           /*@Y30LSJK*/ 00885000
*                                                                  0435 00886000
         LA    @04,3                                               0435 00887000
         AL    @04,CVPOL                                           0435 00888000
         ST    @04,CVPOL                                           0435 00889000
*         /***********************************************************/ 00890000
*         /*                                                         */ 00891000
*         /* IF THE SUB-STRUCTURE IS FOR A BINARY TO HEXIDECIMAL     */ 00892000
*         /* DUMP, CHECK FOR ANY PREVIOUS FORMATTING AS THAT LINE    */ 00893000
*         /* MUST BE PRINTED PRIOR TO CONVERTING THE DUMP.           */ 00894000
*         /*                                                         */ 00895000
*         /***********************************************************/ 00896000
*                                                                  0436 00897000
*           IF CVPBHD = ON                                         0436 00898000
*             THEN                                                 0436 00899000
@RF00434 TM    CVPBHD,B'00100000'                                  0436 00900000
         BNO   @RF00436                                            0436 00901000
*               DO;                                                0437 00902000
*                                                                  0437 00903000
*                 IF FFMFMTF = ON                                  0438 00904000
*                   THEN                                           0438 00905000
         TM    FFMFMTF,B'00000001'                                 0438 00906000
         BNO   @RF00438                                            0438 00907000
*                     DO;                                          0439 00908000
*                                                                  0439 00909000
*                       CALL LINEPRT;                              0440 00910000
*                                                                  0440 00911000
         BAL   @14,LINEPRT                                         0440 00912000
*                       RESPECIFY RTNREG RSTD;                     0441 00913000
*                       TESTRC = RTNREG;                           0442 00914000
         STH   RTNREG,TESTRC                                       0442 00915000
*                       RESPECIFY RTNREG UNRSTD;                   0443 00916000
*                       IF TESTRC >0                               0444 00917000
*                         THEN                                     0444 00918000
         LH    @04,TESTRC                                          0444 00919000
         LTR   @04,@04                                             0444 00920000
         BNP   @RF00444                                            0444 00921000
*                           CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);    0445 00922000
         MVC   @AL00001+4(8),@AL00445                              0445 00923000
         ST    GDTPR,@AL00001                                      0445 00924000
         L     @15,GDTEPL(,GDTPR)                                  0445 00925000
         LA    @01,@AL00001                                        0445 00926000
         BALR  @14,@15                                             0445 00927000
*                     END;                                         0446 00928000
*                                                                  0446 00929000
@RF00444 DS    0H                                                  0447 00930000
*                 /* SET THE PRINT ADDRESS FOR BINARY TO HEX DUMP.   */ 00931000
*                                                                  0447 00932000
*                 CVPPADD = ADDR(PRTBUFF);                         0447 00933000
@RF00438 L     @04,PRTBUFPT                                        0447 00934000
         ST    @04,CVPPADD                                         0447 00935000
*               END;                                               0448 00936000
*         /***********************************************************/ 00937000
*         /*                                                         */ 00938000
*         /* SET UP IS COMPLETE AND WE ARE NOW READY TO CALL THE     */ 00939000
*         /* CONVERSION PROCEDURE(CONVERT) FOR THE CONVERSION OF THIS*/ 00940000
*         /* SEGMENT.                                                */ 00941000
*         /* RETURN CODES ARE                                        */ 00942000
*         /*    0 - GOOD RETURN                                      */ 00943000
*         /*    4 - GOOD RETURN BUT LINE OVERFLOW OCCURED AND ALL    */ 00944000
*         /*        PREVIOUSLY FORMATTED DATA HAS BEEN PRINTED.      */ 00945000
*         /*    8 - PACKED DECIMAL INPUT IS INVALID.                 */ 00946000
*         /*    OTHER - ERROR IN CONVERSION OR PRINTING.             */ 00947000
*         /*        GREATER THAN 8 IS TERMINATING.                   */ 00948000
*         /*                                                         */ 00949000
*         /***********************************************************/ 00950000
*                                                                  0449 00951000
*           IF FFMPINH = OFF                                       0449 00952000
*             THEN                                                 0449 00953000
@RF00436 TM    FFMPINH,B'10000000'                                 0449 00954000
         BNZ   @RF00449                                            0449 00955000
*               DO;                                                0450 00956000
*                                                                  0450 00957000
*                 OLDERID2 = NEWERID2;                             0451 00958000
         L     @04,GDTTR2(,GDTPR)                                  0451 00959000
         MVC   @TS00001(95),NEWERID2(@04)                          0451 00960000
         MVC   OLDERID2(95,@04),@TS00001                           0451 00961000
*                 NEWID2 = 'TPCC';                                 0452 00962000
*                                                                  0452 00963000
         MVC   NEWID2(4,@04),@CC00912                              0452 00964000
*                 CALL CONVERT;                                    0453 00965000
*                                                                  0453 00966000
         BAL   @14,CONVERT                                         0453 00967000
*                 RESPECIFY RTNREG RSTD;                           0454 00968000
*                 TESTRC = RTNREG;                                 0455 00969000
         STH   RTNREG,TESTRC                                       0455 00970000
*                 RESPECIFY RTNREG UNRSTD;                         0456 00971000
*                 IF TESTRC > 8                                    0457 00972000
*                   THEN                                           0457 00973000
*                                                                  0457 00974000
         LH    @04,TESTRC                                          0457 00975000
         C     @04,@CF00176                                        0457 00976000
         BNH   @RF00457                                            0457 00977000
*                     CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);          0458 00978000
*                                                                  0458 00979000
         MVC   @AL00001+4(8),@AL00458                              0458 00980000
         ST    GDTPR,@AL00001                                      0458 00981000
         L     @15,GDTEPL(,GDTPR)                                  0458 00982000
         LA    @01,@AL00001                                        0458 00983000
         BALR  @14,@15                                             0458 00984000
*                 IF TESTRC = 8                                    0459 00985000
*                   THEN                                           0459 00986000
@RF00457 CLC   TESTRC(2),@CH00176                                  0459 00987000
         BNE   @RF00459                                            0459 00988000
*                     DO;                                          0460 00989000
*                                                                  0460 00990000
*                       CALL ERROR (7);                            0461 00991000
*                                                                  0461 00992000
         LA    @01,@AL00461                                        0461 00993000
         BAL   @14,ERROR                                           0461 00994000
*                     END;                                         0462 00995000
*                 IF TESTRC = 0                                    0463 00996000
*                   THEN                                           0463 00997000
@RF00459 LH    @04,TESTRC                                          0463 00998000
         LTR   @04,@04                                             0463 00999000
         BNZ   @RF00463                                            0463 01000000
*                     FFMFMTF = ON;                                0464 01001000
         OI    FFMFMTF,B'00000001'                                 0464 01002000
*               END;                                               0465 01003000
@RF00463 DS    0H                                                  0466 01004000
*         /***********************************************************/ 01005000
*         /*                                                         */ 01006000
*         /* IF THE REDO FLAG (FFMREDOF) IS ON, HANDLE THE LOOPING   */ 01007000
*         /* CONTROLS FOR REDO HERE.                                 */ 01008000
*         /*                                                         */ 01009000
*         /* PARAMETERS CONTROLING REPLICATION ARE AS FOLLOWS:       */ 01010000
*         /*                                                         */ 01011000
*         /* FFMREDOF - FLAG INDICATING A REPLICATION IS OPERATING.  */ 01012000
*         /* FFMREDOC - COUNT OF REDO STRUCTURES IN THE FORMAT LIST  */ 01013000
*         /* FFMREDOL - COUNT OF THE NUMBER OF REPLICATIONS.         */ 01014000
*         /* FFMREDOO - OFFSET IN BLOCK DATA FOR EACH REPLICATION.   */ 01015000
*         /* FFMRBOFF - CURRENT INPUT BLOCK OFFSET.                  */ 01016000
*         /* REDOCSAV - AREA FOR SAVING COUNT OF REDO FORMAT         */ 01017000
*         /*            SUB-STRUCTURES.                              */ 01018000
*         /* FFMREDOS - AREA FOR SAVING START OF REDO FORMAT         */ 01019000
*         /*            SUB-STRUCTURES.                              */ 01020000
*         /*                                                         */ 01021000
*         /***********************************************************/ 01022000
*                                                                  0466 01023000
*            END DATALOOP;                                         0466 01024000
@RF00449 DS    0H                                                  0467 01025000
*           IF FFMREDOF = ON & FFMDATA = ON                        0467 01026000
*             THEN                                                 0467 01027000
@RF00385 TM    FFMREDOF,B'10000010'                                0467 01028000
         BNO   @RF00467                                            0467 01029000
*               DO;                                                0468 01030000
*                                                                  0468 01031000
*                 /***************************************************/ 01032000
*                 /*                                                 */ 01033000
*                 /* REDUCE SUB-STRUCTURE COUNT BY ONE.              */ 01034000
*                 /*                                                 */ 01035000
*                 /***************************************************/ 01036000
*                                                                  0469 01037000
*                 FFMREDOC = FFMREDOC - 1;                         0469 01038000
*                                                                  0469 01039000
         LH    @04,FFMREDOC                                        0469 01040000
         BCTR  @04,0                                               0469 01041000
         STH   @04,FFMREDOC                                        0469 01042000
*                 /***************************************************/ 01043000
*                 /*                                                 */ 01044000
*                 /* IF THE REDO COUNT IS ZERO, THIS IS THE LAST     */ 01045000
*                 /* SUB-STRUCTURE OF THE LOOP SO PRINT              */ 01046000
*                 /* THE LINE.                                       */ 01047000
*                 /*                                                 */ 01048000
*                 /***************************************************/ 01049000
*                                                                  0470 01050000
*                 IF FFMREDOC = 0        /* IS THIS THE LAST STRUCT  */ 01051000
*                   THEN                                           0470 01052000
         LTR   @04,@04                                             0470 01053000
         BNZ   @RF00470                                            0470 01054000
*                     DO;                                          0471 01055000
*                                                                  0471 01056000
*                       /*********************************************/ 01057000
*                       /*                                           */ 01058000
*                       /* PRINT THIS COMPLETE LINE                  */ 01059000
*                       /*                                           */ 01060000
*                       /*********************************************/ 01061000
*                                                                  0472 01062000
*                       IF FFMFMTF = ON                            0472 01063000
*                         THEN                                     0472 01064000
         TM    FFMFMTF,B'00000001'                                 0472 01065000
         BNO   @RF00472                                            0472 01066000
*                           DO;                                    0473 01067000
*                                                                  0473 01068000
*                             CALL LINEPRT;                        0474 01069000
*                                                                  0474 01070000
         BAL   @14,LINEPRT                                         0474 01071000
*                             RESPECIFY RTNREG RSTD;               0475 01072000
*                             TESTRC = RTNREG;                     0476 01073000
         STH   RTNREG,TESTRC                                       0476 01074000
*                             RESPECIFY RTNREG UNRSTD;             0477 01075000
*                             IF TESTRC ^= 0                       0478 01076000
*                               THEN                               0478 01077000
         LH    @04,TESTRC                                          0478 01078000
         LTR   @04,@04                                             0478 01079000
         BZ    @RF00478                                            0478 01080000
*                                 CALL IDCSAEP0(GDTTBL,MODID,RCQUIT);   01081000
         MVC   @AL00001+4(8),@AL00479                              0479 01082000
         ST    GDTPR,@AL00001                                      0479 01083000
         L     @15,GDTEPL(,GDTPR)                                  0479 01084000
         LA    @01,@AL00001                                        0479 01085000
         BALR  @14,@15                                             0479 01086000
*                             IF FFMPMSF = ON     /* REDO A MESSAGE */  01087000
*                               THEN                               0480 01088000
@RF00478 TM    FFMPMSF,B'00010000'                                 0480 01089000
         BNO   @RF00480                                            0480 01090000
*                                 PCTPMN = -1;                     0481 01091000
         MVC   PCTPMN(2,PCTPTR),@CH00900                           0481 01092000
*                           END;                                   0482 01093000
*                                                                  0482 01094000
@RF00480 DS    0H                                                  0483 01095000
*                       /*********************************************/ 01096000
*                       /*                                           */ 01097000
*                       /* REDUCE THE LOOPING COUNT BY ONE.          */ 01098000
*                       /*                                           */ 01099000
*                       /*********************************************/ 01100000
*                                                                  0483 01101000
*                       FFMREDOL = FFMREDOL - 1;                   0483 01102000
*                                                                  0483 01103000
@RF00472 LH    @04,FFMREDOL                                        0483 01104000
         BCTR  @04,0                                               0483 01105000
         STH   @04,FFMREDOL                                        0483 01106000
*                       /*********************************************/ 01107000
*                       /*                                           */ 01108000
*                       /* IF THE LOOP COUNT IS ZERO, THIS IS THE    */ 01109000
*                       /* LAST REPLICATION SO CLEAN UP AND END.     */ 01110000
*                       /*                                           */ 01111000
*                       /*********************************************/ 01112000
*                       IF FFMREDOL = 0 /* IS THIS THE LAST TIME     */ 01113000
*                         THEN                                     0484 01114000
         SLR   @15,@15                                             0484 01115000
         CR    @04,@15                                             0484 01116000
         BNE   @RF00484                                            0484 01117000
*                           DO;                                    0485 01118000
*                                                                  0485 01119000
*                             /* IF YES, CLEAR THE REDO FIELDS       */ 01120000
*                                                                  0486 01121000
*                             FFMREDOF = OFF;                      0486 01122000
*                             FFMIDINH = OFF;                      0487 01123000
         NI    FFMREDOF,B'01110111'                                0487 01124000
*                             FFMREDOS = 0;                        0488 01125000
         ST    @15,FFMREDOS                                        0488 01126000
*                             FFMRBOFF = 0;                        0489 01127000
         ST    @15,FFMRBOFF                                        0489 01128000
*                           END;                                   0490 01129000
*                         ELSE                                     0491 01130000
*                           DO;                                    0491 01131000
*                                                                  0491 01132000
         B     @RC00484                                            0491 01133000
@RF00484 DS    0H                                                  0492 01134000
*                             /***************************************/ 01135000
*                             /*                                     */ 01136000
*                             /* IF NOT, RESTORE TO START OF STRUCT  */ 01137000
*                             /* STEP THE INPUT OFFSET AND DO AGAIN  */ 01138000
*                             /*                                     */ 01139000
*                             /***************************************/ 01140000
*                                                                  0492 01141000
*                             FFMREDOC = REDOCSAV;                 0492 01142000
         LH    @04,REDOCSAV                                        0492 01143000
         STH   @04,FFMREDOC                                        0492 01144000
*                             FSADDR = FFMREDOS;                   0493 01145000
         L     FSADDR,FFMREDOS                                     0493 01146000
*                             STRSTP = 0;                          0494 01147000
         SLR   @04,@04                                             0494 01148000
         STH   @04,STRSTP                                          0494 01149000
*                             FFMRBOFF = FFMRBOFF + FFMREDOO;      0495 01150000
         LH    @04,FFMREDOO                                        0495 01151000
         AL    @04,FFMRBOFF                                        0495 01152000
         ST    @04,FFMRBOFF                                        0495 01153000
*                             FFMIDINH = ON;                       0496 01154000
         OI    FFMIDINH,B'00001000'                                0496 01155000
*                           END;                                   0497 01156000
*                     END;                                         0498 01157000
@RC00484 DS    0H                                                  0499 01158000
*               END;                                               0499 01159000
@RF00470 DS    0H                                                  0500 01160000
*             FFMPASS = OFF;                                       0500 01161000
@RF00467 DS    0H                                                  0501 01162000
*             FFMDATA = OFF;                                       0501 01163000
*                                                                  0501 01164000
         NI    FFMPASS,B'11101101'                                 0501 01165000
*         /***********************************************************/ 01166000
*         /*                                                         */ 01167000
*         /* CHECK FOR END OF THE SUB-STRUCTURE LIST AND SET END     */ 01168000
*         /* FLAG IF IT IS FINISHED.                                 */ 01169000
*         /* TO BE AT THE END OF THE STRUCTURE, REDO FLAG MUST BE    */ 01170000
*         /* OFF                                                     */ 01171000
*         /*                                                         */ 01172000
*         /***********************************************************/ 01173000
*                                                                  0502 01174000
*           IF FMTEOLF = ON & FFMREDOF = OFF                       0502 01175000
*             THEN                                                 0502 01176000
         TM    FMTEOLF(FSADDR),B'10000000'                         0502 01177000
         BNO   @RF00502                                            0502 01178000
         TM    FFMREDOF,B'10000000'                                0502 01179000
         BNZ   @RF00502                                            0502 01180000
*               FFMEOS = ON;                                       0503 01181000
*                                                                  0503 01182000
         OI    FFMEOS,B'01000000'                                  0503 01183000
*         /***********************************************************/ 01184000
*         /*                                                         */ 01185000
*         /* STEP TO THE NEXT SUB-STRUCTURE.                         */ 01186000
*         /* STRSTP CONTAINS THE INCREMENT TO STEP THE STRUCTURE     */ 01187000
*         /* BASE ADDRESS FOR ADDRESSING THE NEXT SUB-STRUCTURE.     */ 01188000
*         /*                                                         */ 01189000
*         /***********************************************************/ 01190000
*                                                                  0504 01191000
*           FSADDR = FSADDR + STRSTP;                              0504 01192000
@RF00502 AH    FSADDR,STRSTP                                       0504 01193000
*           FFMVS = OFF;                                           0505 01194000
*           FFMPINH = OFF;                                         0506 01195000
*                                                                  0506 01196000
         NI    FFMVS,B'00111111'                                   0506 01197000
*         /***********************************************************/ 01198000
*         /*                                                         */ 01199000
*         /* THE SUB-STRUCTURE HANDLING LOOP ENDS HERE.              */ 01200000
*         /*                                                         */ 01201000
*         /***********************************************************/ 01202000
*                                                                  0507 01203000
*         END STRLOOP;                                             0507 01204000
@DE00339 TM    FFMEOS,B'01000000'                                  0507 01205000
         BZ    @DL00339                                            0507 01206000
*         /***********************************************************/ 01207000
*         /*                                                         */ 01208000
*         /* THE SUB-STRUCTURE LOOP IS COMPLETED.  CLEAN UP          */ 01209000
*         /* AND RETURN TO THE CALLER.                               */ 01210000
*         /*                                                         */ 01211000
*         /***********************************************************/ 01212000
*                                                                  0508 01213000
*         IF FFMFMTF = ON                                          0508 01214000
*           THEN                                                   0508 01215000
         TM    FFMFMTF,B'00000001'                                 0508 01216000
         BNO   @RF00508                                            0508 01217000
*             DO;                                                  0509 01218000
*                                                                  0509 01219000
*             IF FFMPSMS = ON                                      0510 01220000
*              THEN                                                0510 01221000
         TM    FFMPSMS,B'00001000'                                 0510 01222000
         BNO   @RF00510                                            0510 01223000
*                PRTBUFPT = ADDR(PRTBUFF1);                /*@Y30SSJK*/ 01224000
         LA    @06,PRTBUFF1                                        0511 01225000
         ST    @06,PRTBUFPT                                        0511 01226000
*               CALL LINEPRT;                                      0512 01227000
*                                                                  0512 01228000
@RF00510 BAL   @14,LINEPRT                                         0512 01229000
*               RESPECIFY RTNREG RSTD;                             0513 01230000
*               TESTRC = RTNREG;                                   0514 01231000
         STH   RTNREG,TESTRC                                       0514 01232000
*               RESPECIFY RTNREG UNRSTD;                           0515 01233000
*               SAVERC = TESTRC;                                   0516 01234000
         LH    @03,TESTRC                                          0516 01235000
         STH   @03,SAVERC                                          0516 01236000
*             END;                                                 0517 01237000
*         IF GDTDBG = NULLPTR                                      0518 01238000
*           THEN;                                                  0518 01239000
@RF00508 L     @03,GDTDBG(,GDTPR)                                  0518 01240000
         LTR   @03,@03                                             0518 01241000
         BZ    @RT00518                                            0518 01242000
*           ELSE                                                   0520 01243000
*             CALL IDCDB010 (GDTTBL,'TP1N');                       0520 01244000
*                                                                  0520 01245000
         ST    GDTPR,@AL00001                                      0520 01246000
         LA    @03,@CC00914                                        0520 01247000
         ST    @03,@AL00001+4                                      0520 01248000
         MVI   @AL00001+4,X'80'                                    0520 01249000
         L     @15,GDTDBG(,GDTPR)                                  0520 01250000
         LA    @01,@AL00001                                        0520 01251000
         BALR  @14,@15                                             0520 01252000
*         CALL IDCSAEP0(GDTTBL,MODID,SAVERC);                      0521 01253000
@RT00518 ST    GDTPR,@AL00001                                      0521 01254000
         LA    @03,MODID                                           0521 01255000
         ST    @03,@AL00001+4                                      0521 01256000
         LA    @03,SAVERC                                          0521 01257000
         ST    @03,@AL00001+8                                      0521 01258000
         MVI   @AL00001+8,X'80'                                    0521 01259000
         L     @15,GDTEPL(,GDTPR)                                  0521 01260000
         LA    @01,@AL00001                                        0521 01261000
         BALR  @14,@15                                             0521 01262000
*         /***********************************************************/ 01263000
*         /*                                                         */ 01264000
*         /*  PROCEDURE NAME - SPACE CONTROL PROCEDURE.              */ 01265000
*         /*                                                         */ 01266000
*         /* FUNCTION - THIS PROCEDURE SETS UP SPACING DICTATED BY   */ 01267000
*         /* SPACE SUB-STRUCTURE IN THE FORMAT LIST.  IN ADDITION,   */ 01268000
*         /* IT CAUSES THE PRINTING OF A LINE EACH TIME THIS ITEM    */ 01269000
*         /* IS ENCOUNTERED AFTER ANY DATA IS FORMATTED.             */ 01270000
*         /*                                                         */ 01271000
*         /* INPUT - INPUT IS THE SPACING SUB-STRUCTURE AS DEFINED   */ 01272000
*         /* BY THE FORMAT STRUCTURED ARGUMENT LIST IN THE GLOBAL    */ 01273000
*         /* INCLUDE.                                                */ 01274000
*         /*                                                         */ 01275000
*         /* OUTPUT - THE SPACING SET UP IN THE PRINT ARGUMENT LIST  */ 01276000
*         /* PASSED TO THE LINE PRINT PROCEDURE.(LINEPRT)            */ 01277000
*         /* SEE CVPSTRU IN THIS LISTING.                            */ 01278000
*         /*                                                         */ 01279000
*         /***********************************************************/ 01280000
*                                                                  0522 01281000
*SPACE:   PROC;                                                    0522 01282000
*                                                                  0522 01283000
*                                                                  0522 01284000
         B     @PB00002                                            0522 01285000
SPACE    STM   @14,@06,@SA00002                                    0522 01286000
         STM   @08,@12,@SA00002+36                                 0522 01287000
*         /***********************************************************/ 01288000
*         /*                                                         */ 01289000
*         /* IF THIS IS NOT THE FIRST PASS, PRINT THE LINE.          */ 01290000
*         /* FFMPASS IS TURNED ON BY THE FIRST ENTRY TO THE          */ 01291000
*         /* CONVERSION ROUTINE.                                     */ 01292000
*         /*                                                         */ 01293000
*         /***********************************************************/ 01294000
*                                                                  0523 01295000
*         IF FFMPASS = OFF                                         0523 01296000
*           THEN                                                   0523 01297000
         TM    FFMPASS,B'00010000'                                 0523 01298000
         BNZ   @RF00523                                            0523 01299000
*             DO;                                                  0524 01300000
*               IF FFMFMTF = ON                                    0525 01301000
*                 THEN                                             0525 01302000
         TM    FFMFMTF,B'00000001'                                 0525 01303000
         BNO   @RF00525                                            0525 01304000
*                   DO;                                            0526 01305000
*                                                                  0526 01306000
*                     CALL LINEPRT;                                0527 01307000
*                                                                  0527 01308000
         BAL   @14,LINEPRT                                         0527 01309000
*                     RESPECIFY RTNREG RSTD;                       0528 01310000
*                     TESTRC = RTNREG;                             0529 01311000
         STH   RTNREG,TESTRC                                       0529 01312000
*                     RESPECIFY RTNREG UNRSTD;                     0530 01313000
*                     IF TESTRC > 0                                0531 01314000
*                       THEN                                       0531 01315000
         LH    @03,TESTRC                                          0531 01316000
         LTR   @03,@03                                             0531 01317000
         BNP   @RF00531                                            0531 01318000
*                         RETURN CODE (RCQUIT);                    0532 01319000
         LH    @15,RCQUIT                                          0532 01320000
         L     @14,@SA00002                                        0532 01321000
         LM    @00,@06,@SA00002+8                                  0532 01322000
         LM    @08,@12,@SA00002+36                                 0532 01323000
         BR    @14                                                 0532 01324000
*                     /**************************************@OZ18517*/ 01325000
*                     /*                                     @OZ18517*/ 01326000
*                     /* IF A MESSAGE, THIS IS AN EMBEDDED   @OZ18517*/ 01327000
*                     /* SPACING SUBSTRUCTURE. THE SEGMENT   @OZ18517*/ 01328000
*                     /* ROUTINE ASSUMES THAT USER HAS DONE  @OZ18517*/ 01329000
*                     /* HIS OWN SEGMENTING. SUPPRESS MESSAGE@OZ18517*/ 01330000
*                     /* NUMBER PROCESSING IN SEGMENT ROUTINE@OZ18517*/ 01331000
*                     /*                                     @OZ18517*/ 01332000
*                     /**************************************@OZ18517*/ 01333000
*                     IF FFMPMSF = ON                      /*@OZ18517*/ 01334000
*                       THEN                               /*@OZ18517*/ 01335000
@RF00531 TM    FFMPMSF,B'00010000'                                 0533 01336000
         BNO   @RF00533                                            0533 01337000
*                         FFM2SMN = ON;                    /*@OZ18517*/ 01338000
         OI    FFM2SMN,B'10000000'                                 0534 01339000
*                   END;                                           0535 01340000
@RF00533 DS    0H                                                  0536 01341000
*             END;                                                 0536 01342000
*                                                                  0536 01343000
@RF00525 DS    0H                                                  0537 01344000
*         /***********************************************************/ 01345000
*         /*                                                         */ 01346000
*         /* SET UP THE SPACING ARGUMENTS FOR THIS SUB-STRUCTURE.    */ 01347000
*         /*                                                         */ 01348000
*         /***********************************************************/ 01349000
*                                                                  0537 01350000
*         PRTSPF = FMTSPF;              /* SET SPACING FACTOR.       */ 01351000
@RF00523 LH    @03,FMTSPF(,FSADDR)                                 0537 01352000
         STH   @03,PRTSPF                                          0537 01353000
*         PRTSPT = FMTSPT;              /* SET SPACING TYPE.         */ 01354000
         MVC   PRTSPT(1),FMTSPT(FSADDR)                            0538 01355000
*         STRSTP = 6;                   /* SET FORMAT LIST STEPPING  */ 01356000
         MVC   STRSTP(2),@CH00153                                  0539 01357000
*         FFMPASS = OFF;                /* ASSURE 1ST PASS SWITCH OFF*/ 01358000
*                                                                  0540 01359000
         NI    FFMPASS,B'11101111'                                 0540 01360000
*         /***********************************************************/ 01361000
*         /*                                                         */ 01362000
*         /* END OF THE SPACE PROCEDURE.                             */ 01363000
*         /*                                                         */ 01364000
*         /***********************************************************/ 01365000
*                                                                  0541 01366000
*         RETURN CODE (0);                                         0541 01367000
         SLR   @15,@15                                             0541 01368000
         L     @14,@SA00002                                        0541 01369000
         LM    @00,@06,@SA00002+8                                  0541 01370000
         LM    @08,@12,@SA00002+36                                 0541 01371000
         BR    @14                                                 0541 01372000
*         END SPACE;                                               0542 01373000
*         /***********************************************************/ 01374000
*         /*                                                         */ 01375000
*         /* PROCEDURE NAME - REPLICATION INITIALIZATION             */ 01376000
*         /*                                                         */ 01377000
*         /* FUNCTION - INITIALIZES PARAMETERS TO CONTROL THE REDO   */ 01378000
*         /* OPERATION.                                              */ 01379000
*         /*                                                         */ 01380000
*         /* INPUT - THE REDO SUB-STRUCTURE OF THE FORMAT ARGUMENT   */ 01381000
*         /* AS DESCRIBED IN THE GLOBAL INCLUDE.  (FMTLIST)          */ 01382000
*         /*                                                         */ 01383000
*         /* OUTPUT - THE PARAMETERS CONTROLLING THE REPLICATION AS  */ 01384000
*         /* FOLLOWS.                                                */ 01385000
*         /*                                                         */ 01386000
*         /* FFMREDOF - A FLAG INDICATING REDO IS IN PROCESS.        */ 01387000
*         /* FFMREDOC - THE COUNT OF THE NUMBER OF SUB-STRUCTURES    */ 01388000
*         /*            REDO IS TO SPAN.                             */ 01389000
*         /* REDOCSAV - A SAVE AREA FOR THE COUNT.                   */ 01390000
*         /* FFMREDOL - THE COUNT OF THE NUMBER OF TIMES TO REDO.    */ 01391000
*         /* FFMREDOO - THE INPUT DATA BLOCK OFFSET FOR EACH REDO.   */ 01392000
*         /* FFMREDOS - THE ADDRESS OF THE FIRST SUB-STRUCTURE OF    */ 01393000
*         /*            THE SET.                                     */ 01394000
*         /*                                                         */ 01395000
*         /***********************************************************/ 01396000
*                                                                  0543 01397000
*REDO:    PROC;                                                    0543 01398000
*                                                                  0543 01399000
REDO     STM   @14,@06,@SA00003                                    0543 01400000
         STM   @08,@12,@SA00003+36                                 0543 01401000
*         /***********************************************************/ 01402000
*         /*                                                         */ 01403000
*         /* ASSURE THAT THIS IS NOT A NESTED REDO SUB-STRUCTURE.    */ 01404000
*         /*                                                         */ 01405000
*         /***********************************************************/ 01406000
*                                                                  0544 01407000
*         IF FFMREDOF = ON                                         0544 01408000
*           THEN                                                   0544 01409000
         TM    FFMREDOF,B'10000000'                                0544 01410000
         BNO   @RF00544                                            0544 01411000
*             DO;                                                  0545 01412000
*                                                                  0545 01413000
*               CALL ERROR (4);                                    0546 01414000
*                                                                  0546 01415000
         LA    @01,@AL00546                                        0546 01416000
         BAL   @14,ERROR                                           0546 01417000
*               FFMREDOC = 0;             /* ZERO CURR STRU COUNT.   */ 01418000
         SLR   @15,@15                                             0547 01419000
         STH   @15,FFMREDOC                                        0547 01420000
*               FFMREDOL = 0;             /* ZERO CURRENT LOOP COUNT */ 01421000
         STH   @15,FFMREDOL                                        0548 01422000
*               STRSTP = 8;               /* SET FMT LIST STEP COUNT */ 01423000
         MVC   STRSTP(2),@CH00176                                  0549 01424000
*               RETURN ;                                           0550 01425000
@EL00003 DS    0H                                                  0550 01426000
@EF00003 DS    0H                                                  0550 01427000
@ER00003 LM    @14,@06,@SA00003                                    0550 01428000
         LM    @08,@12,@SA00003+36                                 0550 01429000
         BR    @14                                                 0550 01430000
*             END;                                                 0551 01431000
*                                                                  0551 01432000
*         /***********************************************************/ 01433000
*         /*                                                         */ 01434000
*         /* LOCATE THE DYNAMIC DATA ARGUMENT LIST TO OBTAIN THE     */ 01435000
*         /* DYNAMIC DATA FOR THE REDO.  THIS INCLUDES THE NUMBER    */ 01436000
*         /* OF TIMES TO LOOP THROUGH THE STRUCTURES                 */ 01437000
*         /*                                                         */ 01438000
*         /***********************************************************/ 01439000
*                                                                  0552 01440000
*           DO DSINDX = 1 TO DARGCNT BY 1 WHILE DARGREP(DSINDX) ^= 0552 01441000
*               FMTRFNO;                                           0552 01442000
@RF00544 LA    @15,1                                               0552 01443000
         ST    @15,DSINDX                                          0552 01444000
         B     @DE00552                                            0552 01445000
@DL00552 LR    @14,@15                                             0552 01446000
         SLA   @14,3                                               0552 01447000
         LH    @14,DARGREP-8(@14,DDSTRU)                           0552 01448000
         CH    @14,FMTRFNO(,FSADDR)                                0552 01449000
         BE    @DC00552                                            0552 01450000
*           END;                                                   0553 01451000
*                                                                  0553 01452000
         AL    @15,@CF00216                                        0553 01453000
         ST    @15,DSINDX                                          0553 01454000
@DE00552 CH    @15,DARGCNT(,DDSTRU)                                0553 01455000
         BNH   @DL00552                                            0553 01456000
@DC00552 DS    0H                                                  0554 01457000
*         /***********************************************************/ 01458000
*         /*                                                         */ 01459000
*         /* SET THE REDO PARAMETERS IF DYNAMIC ARGUMENT FOUND.      */ 01460000
*         /*                                                         */ 01461000
*         /***********************************************************/ 01462000
*                                                                  0554 01463000
*         IF DSINDX <= DARGCNT                                     0554 01464000
*           THEN                                                   0554 01465000
         L     @15,DSINDX                                          0554 01466000
         CH    @15,DARGCNT(,DDSTRU)                                0554 01467000
         BH    @RF00554                                            0554 01468000
*             DO;                                                  0555 01469000
*               FFMREDOL = DARGPCT(DSINDX);                        0556 01470000
         SLA   @15,3                                               0556 01471000
         LH    @15,DARGPCT-8(@15,DDSTRU)                           0556 01472000
         STH   @15,FFMREDOL                                        0556 01473000
*               FFMREDOF = ON;          /* TURN REDO FLAG ON.        */ 01474000
         OI    FFMREDOF,B'10000000'                                0557 01475000
*               FFMREDOS = FSADDR + 8;  /* REDO START SUB-STRU       */ 01476000
         LA    @15,8                                               0558 01477000
         ALR   @15,FSADDR                                          0558 01478000
         ST    @15,FFMREDOS                                        0558 01479000
*               FFMREDOC = FMTTRBC;     /* REDO SUB-STRUC COUNT.     */ 01480000
         LH    @15,FMTTRBC(,FSADDR)                                0559 01481000
         STH   @15,FFMREDOC                                        0559 01482000
*               REDOCSAV = FFMREDOC;    /* SAVE IT.                  */ 01483000
         STH   @15,REDOCSAV                                        0560 01484000
*               FFMREDOO = FMTRIO;      /* REDO INPUT OFFSET.        */ 01485000
         LH    @15,FMTRIO(,FSADDR)                                 0561 01486000
         STH   @15,FFMREDOO                                        0561 01487000
*             END;                                                 0562 01488000
*         STRSTP = 8;                   /* STRUCTURE STEP = 8.       */ 01489000
*                                                                  0563 01490000
@RF00554 MVC   STRSTP(2),@CH00176                                  0563 01491000
*         /***********************************************************/ 01492000
*         /*                                                         */ 01493000
*         /* IF DYNAMIC ARGUMENT SUB-STRUCTURE NOT FOUND IGNORE THE  */ 01494000
*         /* REPLICATION BLOCK AND CONTINUE ON.                      */ 01495000
*         /*                                                         */ 01496000
*         /***********************************************************/ 01497000
*                                                                  0564 01498000
*         RETURN;                                                  0564 01499000
         B     @EL00003                                            0564 01500000
*         END REDO;                                                0565 01501000
*         /***********************************************************/ 01502000
*         /*                                                         */ 01503000
*         /* PROCEDURE NAME - STATIC TEXT SET UP.                    */ 01504000
*         /*                                                         */ 01505000
*         /* FUNCTION - SETS UP THE CONVERSION ARGUMENT LIST FOR A   */ 01506000
*         /* STATIC TEXT SUB-STRUCTURE.                              */ 01507000
*         /*                                                         */ 01508000
*         /* INPUT - THE STATIC TEXT SUB-STRUCTURE OF THE FORMAT     */ 01509000
*         /*         LIST.  (FMTLIST)                                */ 01510000
*         /*                                                         */ 01511000
*         /* OUTPUT - ARGUMENTS IN THE CONVERSION CALL. (CVPSTRU)    */ 01512000
*         /*                                                         */ 01513000
*         /***********************************************************/ 01514000
*                                                                  0566 01515000
*STATIC:  PROC;                                                    0566 01516000
*                                                                  0566 01517000
STATIC   STM   @14,@12,12(@13)                                     0566 01518000
*         CVPIADD = FFMSTRS + FMTSTO;   /* INPUT DATA ADDRESS.       */ 01519000
         LH    @07,FMTSTO(,FSADDR)                                 0567 01520000
         AL    @07,FFMSTRS                                         0567 01521000
         ST    @07,CVPIADD                                         0567 01522000
*         CVPIL = FMTSTL;               /* INPUT DATA LENGTH.        */ 01523000
         LH    @07,FMTSTL(,FSADDR)                                 0568 01524000
         ST    @07,CVPIL                                           0568 01525000
*         STRSTP = 12;                  /* FMT STRUCTURE STEP COUNT  */ 01526000
         MVC   STRSTP(2),@CH00034                                  0569 01527000
*         RETURN;                                                  0570 01528000
*                                                                  0570 01529000
@EL00004 DS    0H                                                  0570 01530000
@EF00004 DS    0H                                                  0570 01531000
@ER00004 LM    @14,@12,12(@13)                                     0570 01532000
         BR    @14                                                 0570 01533000
*         END STATIC;                                              0571 01534000
*         /***********************************************************/ 01535000
*         /*                                                         */ 01536000
*         /* PROCEDURE NAME - BLOCK DATA SET UP.                     */ 01537000
*         /*                                                         */ 01538000
*         /* FUNCTION - SET UP CONVERSION ARGUMENTS FOR BLOCK DATA.  */ 01539000
*         /*                                                         */ 01540000
*         /* INPUT - THE BLOCK DATA SUB-STRUCTURE OF THE FORMAT      */ 01541000
*         /*         LIST.  (FMTLIST)                                */ 01542000
*         /*                                                         */ 01543000
*         /* OUTPUT - ARGUMENTS IN THE CONVERSION CALL.  (CVPSTRU)   */ 01544000
*         /*                                                         */ 01545000
*         /***********************************************************/ 01546000
*                                                                  0572 01547000
*BLOCK:   PROC;                                                    0572 01548000
*                                                                  0572 01549000
BLOCK    STM   @14,@12,12(@13)                                     0572 01550000
*         IF DARGFULL = ON                                 /*@OZ14818*/ 01551000
*           THEN                                           /*@OZ14818*/ 01552000
         TM    DARGFULL(DDSTRU),B'10000000'                        0573 01553000
         BNO   @RF00573                                            0573 01554000
*             DARGILP1 = DARGRETP;                         /*@OZ14818*/ 01555000
         L     @07,DARGRETP(,DDSTRU)                               0574 01556000
         ST    @07,DARGILP1                                        0574 01557000
*           ELSE                                           /*@OZ14818*/ 01558000
*             DARGILP2 = DARGILP;                          /*@OZ14818*/ 01559000
*                                                                  0575 01560000
         B     @RC00573                                            0575 01561000
@RF00573 LH    @07,DARGILP(,DDSTRU)                                0575 01562000
         STH   @07,DARGILP2                                        0575 01563000
*         CVPIADD = FFMBDP + FFMRBOFF + FMTIOFF;                   0576 01564000
@RC00573 L     @07,FFMBDP                                          0576 01565000
         AL    @07,FFMRBOFF                                        0576 01566000
         LH    @15,FMTIOFF(,FSADDR)                                0576 01567000
         ALR   @07,@15                                             0576 01568000
         ST    @07,CVPIADD                                         0576 01569000
*         IF FMTILEN > (DARGILP1-FMTIOFF) | FMTILEN = 0    /*@OZ14818*/ 01570000
*           THEN                                                   0577 01571000
         LH    @07,FMTILEN(,FSADDR)                                0577 01572000
         LCR   @15,@15                                             0577 01573000
         AL    @15,DARGILP1                                        0577 01574000
         CR    @07,@15                                             0577 01575000
         BH    @RT00577                                            0577 01576000
         LTR   @07,@07                                             0577 01577000
         BNZ   @RF00577                                            0577 01578000
@RT00577 DS    0H                                                  0578 01579000
*             CVPIL = (DARGILP1-FMTIOFF);                  /*@OZ14818*/ 01580000
         L     @07,DARGILP1                                        0578 01581000
         SH    @07,FMTIOFF(,FSADDR)                                0578 01582000
         ST    @07,CVPIL                                           0578 01583000
*           ELSE                                                   0579 01584000
*             CVPIL = FMTILEN;                                     0579 01585000
         B     @RC00577                                            0579 01586000
@RF00577 LH    @07,FMTILEN(,FSADDR)                                0579 01587000
         ST    @07,CVPIL                                           0579 01588000
*         STRSTP = 12;                                             0580 01589000
*                                                                  0580 01590000
@RC00577 MVC   STRSTP(2),@CH00034                                  0580 01591000
*         RETURN;                                                  0581 01592000
*                                                                  0581 01593000
@EL00005 DS    0H                                                  0581 01594000
@EF00005 DS    0H                                                  0581 01595000
@ER00005 LM    @14,@12,12(@13)                                     0581 01596000
         BR    @14                                                 0581 01597000
*         END BLOCK;                                               0582 01598000
*         /***********************************************************/ 01599000
*         /*                                                         */ 01600000
*         /* PROCEDURE NAME - INSERT DATA HANDLER.                   */ 01601000
*         /*                                                         */ 01602000
*         /* FUNCTION - THIS PROCEDURE SETS UP THE CONVERSION        */ 01603000
*         /* ARGUMENT LISTS FOR INSERT DATA FORMAT SUB-STRUCTURES.   */ 01604000
*         /* (SEE FMTLIST). IT SEARCHES THE DYNAMIC DATA STRUCTURE   */ 01605000
*         /* FOR THE GIVEN REFERENCE NUMBER AND IF FOUND, SETS UP    */ 01606000
*         /* THE DATA ARGUMENTS FROM IT.  IF NO FIND IS MADE, IT WILL*/ 01607000
*         /* EXAMINE THE NEXT SUB-STRUCTURE IN THE LIST TO SEE IF IT */ 01608000
*         /* IS A DEFAULT DATA SUB-STRUCTURE.  IF IT IS, IT WILL SET */ 01609000
*         /* UP THE STATIC TEXT ASSOCIATED WITH IT.  IF IT IS NOT,   */ 01610000
*         /* THIS STRUCTURE WILL BE IGNORED BY TURNING ON THE PRINT  */ 01611000
*         /* INHIBIT FLAG. (FFMPINH)                                 */ 01612000
*         /*                                                         */ 01613000
*         /* INPUT - THE INSERT DATA SUB-STRUCTURE AND DYNAMIC DATA  */ 01614000
*         /* SUB-STRUCTURE AS DEFINED IN FMTLIST AND DARGLIST        */ 01615000
*         /*                                                         */ 01616000
*         /* OUTPUT - THE DATA ARGUMENTS IN THE PRINT ARGUMENT LIST. */ 01617000
*         /* (CVPSTRU)                                               */ 01618000
*         /*                                                         */ 01619000
*         /***********************************************************/ 01620000
*                                                                  0583 01621000
*INSERT:  PROC;                                                    0583 01622000
*                                                                  0583 01623000
INSERT   STM   @14,@05,12(@13)                                     0583 01624000
         STM   @07,@12,48(@13)                                     0583 01625000
*         IF FFMIDINH = OFF             /* INSERT INHIBITED IN REDO  */ 01626000
*           THEN                                                   0584 01627000
         TM    FFMIDINH,B'00001000'                                0584 01628000
         BNZ   @RF00584                                            0584 01629000
*             DO;                                                  0585 01630000
*                                                                  0585 01631000
*             /*******************************************************/ 01632000
*             /*                                                     */ 01633000
*             /* SEARCH THE DYNAMIC LIST (DARGLIST) FOR THE          */ 01634000
*             /* REFERENCE NUMBER GIVEN.                             */ 01635000
*             /*                                                     */ 01636000
*             /*******************************************************/ 01637000
*                                                                  0586 01638000
*               DO DSINDX = 1 TO DARGCNT BY 1 WHILE DARGINS(DSINDX) ^=  01639000
*                   FMTRFNO;                                       0586 01640000
         LA    @07,1                                               0586 01641000
         ST    @07,DSINDX                                          0586 01642000
         B     @DE00586                                            0586 01643000
@DL00586 LR    @15,@07                                             0586 01644000
         SLA   @15,3                                               0586 01645000
         LH    @15,DARGINS-8(@15,DDSTRU)                           0586 01646000
         CH    @15,FMTRFNO(,FSADDR)                                0586 01647000
         BE    @DC00586                                            0586 01648000
*               END;                                               0587 01649000
         AL    @07,@CF00216                                        0587 01650000
         ST    @07,DSINDX                                          0587 01651000
@DE00586 CH    @07,DARGCNT(,DDSTRU)                                0587 01652000
         BNH   @DL00586                                            0587 01653000
@DC00586 DS    0H                                                  0588 01654000
*               IF DSINDX <= DARGCNT                               0588 01655000
*                 THEN                                             0588 01656000
         L     @07,DSINDX                                          0588 01657000
         CH    @07,DARGCNT(,DDSTRU)                                0588 01658000
         BH    @RF00588                                            0588 01659000
*                   DO;                                            0589 01660000
*                                                                  0589 01661000
*                   /*************************************************/ 01662000
*                   /*                                               */ 01663000
*                   /* THE REFERENCE NUMBER IS FOUND.  SET UP THE    */ 01664000
*                   /* ARGUMENTS FROM THE FOUND LIST.                */ 01665000
*                   /*                                               */ 01666000
*                   /*************************************************/ 01667000
*                                                                  0590 01668000
*                     CVPIADD = DARGDTM(DSINDX);                   0590 01669000
         SLA   @07,3                                               0590 01670000
         L     @15,DARGDTM-8(@07,DDSTRU)                           0590 01671000
         ST    @15,CVPIADD                                         0590 01672000
*                     CVPIL = DARGINL(DSINDX);                     0591 01673000
         LH    @07,DARGINL-8(@07,DDSTRU)                           0591 01674000
         ST    @07,CVPIL                                           0591 01675000
*                   END;                                           0592 01676000
*                 ELSE                                             0593 01677000
*                   DO;                                            0593 01678000
*                                                                  0593 01679000
         B     @RC00588                                            0593 01680000
@RF00588 DS    0H                                                  0594 01681000
*                 /***************************************************/ 01682000
*                 /*                                                 */ 01683000
*                 /* STEP FORMAT STRUCTURE ADDRESS TO CHECK FOR A    */ 01684000
*                 /* POSSIBLE DEFAULT DATA STRUCTURE AS THE INSERT   */ 01685000
*                 /* ITEM WAS NOT FOUND IN THE DYNAMIC STRUCTURE.    */ 01686000
*                 /*                                                 */ 01687000
*                 /***************************************************/ 01688000
*                                                                  0594 01689000
*                     IF FMTEOLF = OFF                             0594 01690000
*                       THEN                                       0594 01691000
         TM    FMTEOLF(FSADDR),B'10000000'                         0594 01692000
         BNZ   @RF00594                                            0594 01693000
*                         DO;                                      0595 01694000
*                         FSADDR = FSADDR +12;                     0596 01695000
         AL    FSADDR,@CF00034                                     0596 01696000
*                         IF FMTDFF = ON                           0597 01697000
*                           THEN                                   0597 01698000
         TM    FMTDFF(FSADDR),B'00000010'                          0597 01699000
         BNO   @RF00597                                            0597 01700000
*                             DO;                                  0598 01701000
*                                                                  0598 01702000
*                         /*******************************************/ 01703000
*                         /*                                         */ 01704000
*                         /* A DEFAULT DATA SUB-STRUCTURE IS FOUND.  */ 01705000
*                         /* SET UP THE ARGUMENTS FROM IT.           */ 01706000
*                         /*                                         */ 01707000
*                         /*******************************************/ 01708000
*                                                                  0599 01709000
*                               CVPIADD = FFMSTRS + FMTSTO;        0599 01710000
         LH    @07,FMTSTO(,FSADDR)                                 0599 01711000
         AL    @07,FFMSTRS                                         0599 01712000
         ST    @07,CVPIADD                                         0599 01713000
*                               CVPIL = FMTSTL;                    0600 01714000
         LH    @07,FMTSTL(,FSADDR)                                 0600 01715000
         ST    @07,CVPIL                                           0600 01716000
*                             END;                                 0601 01717000
*                           ELSE                                   0602 01718000
*                             DO;                                  0602 01719000
*                                                                  0602 01720000
         B     @RC00597                                            0602 01721000
@RF00597 DS    0H                                                  0603 01722000
*                 /***************************************************/ 01723000
*                 /*                                                 */ 01724000
*                 /* NO DEFAULT DATA STRUCTURE WAS FOUND SO RESTORE  */ 01725000
*                 /* THE FORMAT STRUCTURE ADDRESS TO ITS ORIGINAL    */ 01726000
*                 /* SETTING AND SUPPRESS CONVERSION AND PRINTING    */ 01727000
*                 /* FOR THIS SUB-STRUCTURE.                         */ 01728000
*                 /*                                                 */ 01729000
*                 /***************************************************/ 01730000
*                                                                  0603 01731000
*                               FFMPINH = ON;                      0603 01732000
         OI    FFMPINH,B'10000000'                                 0603 01733000
*                               FSADDR = FSADDR - 12;              0604 01734000
         SL    FSADDR,@CF00034                                     0604 01735000
*                             END;                                 0605 01736000
*                         END;                                     0606 01737000
*                       ELSE                                       0607 01738000
*                         FFMPINH = ON;                            0607 01739000
         B     @RC00594                                            0607 01740000
@RF00594 OI    FFMPINH,B'10000000'                                 0607 01741000
*                   END;                                           0608 01742000
*             END;                                                 0609 01743000
*           ELSE                                                   0610 01744000
*             FFMPINH = ON;             /* INHIBIT INSERT ON A REDO. */ 01745000
         B     @RC00584                                            0610 01746000
@RF00584 OI    FFMPINH,B'10000000'                                 0610 01747000
*           STRSTP = 12;                                           0611 01748000
@RC00584 MVC   STRSTP(2),@CH00034                                  0611 01749000
*         END INSERT;                                              0612 01750000
@EL00006 DS    0H                                                  0612 01751000
@EF00006 DS    0H                                                  0612 01752000
@ER00006 LM    @14,@05,12(@13)                                     0612 01753000
         LM    @07,@12,48(@13)                                     0612 01754000
         BR    @14                                                 0612 01755000
*/********************************************************************/ 01756000
*/*                                                                  */ 01757000
*/* PROCEDURE NAME - DATA CONVERSION PROCEDURE.                      */ 01758000
*/*                                                                  */ 01759000
*/* FUNCTION - CONVERTS DATA TO A PRINTABLE FORM.  CONVERSIONS       */ 01760000
*/*      PROVIDED ARE:                                               */ 01761000
*/*        EBCDIC TO CHARACTER.                                      */ 01762000
*/*        BINARY TO HEXIDECIMAL.                                    */ 01763000
*/*        BINARY TO HEXIDECIMAL ENCLOSED AS X'NNNN'         #Y30LSJK*/ 01764000
*/*        BINARY TO HEXIDECIMAL DUMP FORMAT.                        */ 01765000
*/*        PACKED DECIMAL TO UNPACKED DECIMAL.                       */ 01766000
*/*        BINARY TO UNPACKED DECIMAL.                               */ 01767000
*/*                                                                  */ 01768000
*/* INPUT - THE CONVERSION ARGUMENT LIST CVPSTRU.                    */ 01769000
*/*                                                                  */ 01770000
*/* OUTPUT - THE CONVERTED DATA IN THE PRINT BUFFER (PRTBUFF)        */ 01771000
*/*      OR MORE THAN ONE PRINTED LINE IF PRINT LINE OVERFLOW        */ 01772000
*/*      OCCURS AS A RESULT OF THE DATA BEING MORE THAN THE LENGTH   */ 01773000
*/*      OF THE PRINT BUFFER.                                        */ 01774000
*/*                                                                  */ 01775000
*/********************************************************************/ 01776000
*                                                                  0613 01777000
*CONVERT: PROCEDURE;                                               0613 01778000
CONVERT  STM   @14,@06,@SA00007                                    0613 01779000
         STM   @08,@12,@SA00007+36                                 0613 01780000
*         OLDERID2 = NEWERID2;                                     0614 01781000
         L     @04,GDTTR2(,GDTPR)                                  0614 01782000
         MVC   @TS00001(95),NEWERID2(@04)                          0614 01783000
         MVC   OLDERID2(95,@04),@TS00001                           0614 01784000
*         NEWID2 = 'TP2I';                                         0615 01785000
         MVC   NEWID2(4,@04),@CC00933                              0615 01786000
*         CVFLAG = '0000'X;             /* CLEAR THE FLAG BYTES.     */ 01787000
         MVC   CVFLAG(2),@CB00934                                  0616 01788000
*         /***********************************************************/ 01789000
*         /*                                                         */ 01790000
*         /* INSURE EVEN NUMBER OF OUTPUT BYTES FOR BINARY TO HEX    */ 01791000
*         /* CONVERSION.                                             */ 01792000
*         /*                                                         */ 01793000
*         /***********************************************************/ 01794000
*                                                                  0617 01795000
*         IF GDTDBG = NULLPTR                                      0617 01796000
*           THEN;                                                  0617 01797000
         L     @04,GDTDBG(,GDTPR)                                  0617 01798000
         LTR   @04,@04                                             0617 01799000
         BZ    @RT00617                                            0617 01800000
*           ELSE                                                   0619 01801000
*             CALL IDCDB010 (GDTTBL,'TP2I');                       0619 01802000
         ST    GDTPR,@AL00001                                      0619 01803000
         LA    @04,@CC00933                                        0619 01804000
         ST    @04,@AL00001+4                                      0619 01805000
         MVI   @AL00001+4,X'80'                                    0619 01806000
         L     @15,GDTDBG(,GDTPR)                                  0619 01807000
         LA    @01,@AL00001                                        0619 01808000
         BALR  @14,@15                                             0619 01809000
*         IF CVPBH = ON | CVPBHA = ON                              0620 01810000
*           THEN                                                   0620 01811000
@RT00617 TM    CVPBH,B'11000000'                                   0620 01812000
         BZ    @RF00620                                            0620 01813000
*             DO;                                                  0621 01814000
*               IF CVPOL//2 ^= 0                                   0622 01815000
*                 THEN                                             0622 01816000
         L     @04,CVPOL                                           0622 01817000
         LR    @00,@04                                             0622 01818000
         SRDA  @00,32                                              0622 01819000
         D     @00,@CF00150                                        0622 01820000
         LTR   @00,@00                                             0622 01821000
         BZ    @RF00622                                            0622 01822000
*                   CVPOL = CVPOL + 1;                             0623 01823000
         AL    @04,@CF00216                                        0623 01824000
         ST    @04,CVPOL                                           0623 01825000
*             END;                                                 0624 01826000
*                                                                  0624 01827000
@RF00622 DS    0H                                                  0625 01828000
*         /***********************************************************/ 01829000
*         /*                                                         */ 01830000
*         /* CHECK FOR POSSIBLE PRINT LINE OVERFLOW AND SET UP TO    */ 01831000
*         /* HANDLE IT. THE LINE PRINT ROUTINE WILL HANDLE MESSAGES  */ 01832000
*         /* THAT EXCEED THE PAGE LINE WIDTH.                        */ 01833000
*         /*                                                         */ 01834000
*         /***********************************************************/ 01835000
*                                                                  0625 01836000
*         IF ((CVPPADD - ADDR(PRTBUFF) + CVPOL) > PCTPLW)  /*@Z40GSJG*/ 01837000
*               & FFMPMSF = OFF & FFMPSMS = OFF            /*@Z40GSJG*/ 01838000
*           THEN                                                   0625 01839000
@RF00620 L     @04,CVPPADD                                         0625 01840000
         SL    @04,PRTBUFPT                                        0625 01841000
         LR    @03,@04                                             0625 01842000
         AL    @03,CVPOL                                           0625 01843000
         L     @15,PCTPLW(,PCTPTR)                                 0625 01844000
         CR    @03,@15                                             0625 01845000
         BNH   @RF00625                                            0625 01846000
         TM    FFMPMSF,B'00011000'                                 0625 01847000
         BNZ   @RF00625                                            0625 01848000
*             DO;                                                  0626 01849000
*               FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)))/2;    0627 01850000
         LR    @00,@15                                             0627 01851000
         SLR   @00,@04                                             0627 01852000
         SRDA  @00,32                                              0627 01853000
         D     @00,@CF00150                                        0627 01854000
         LR    FMSIL,@01                                           0627 01855000
*               PLOVF = ON;                                        0628 01856000
         OI    PLOVF,B'10000000'                                   0628 01857000
*             END;                                                 0629 01858000
*           ELSE                                                   0630 01859000
*             FMSIL = CVPOL/2;                                     0630 01860000
*                                                                  0630 01861000
         B     @RC00625                                            0630 01862000
@RF00625 L     @00,CVPOL                                           0630 01863000
         SRDA  @00,32                                              0630 01864000
         D     @00,@CF00150                                        0630 01865000
         LR    FMSIL,@01                                           0630 01866000
*         /***********************************************************/ 01867000
*         /*                                                         */ 01868000
*         /* SET UP REMAINING PARAMETERS FOR THE INITIAL SEGMENT.    */ 01869000
*         /*                                                         */ 01870000
*         /***********************************************************/ 01871000
*                                                                  0631 01872000
*         CVSL = CVPOL;                 /* SET COMPLET OUTPUT LENGTH */ 01873000
@RC00625 L     @04,CVPOL                                           0631 01874000
         ST    @04,CVSL                                            0631 01875000
*         CVSTA = CVPPADD;              /* SET PRINT START.          */ 01876000
         L     @04,CVPPADD                                         0632 01877000
         ST    @04,CVSTA                                           0632 01878000
*         FMRIL = CVPIL;                /* SET REMAINING INPUT LEN.  */ 01879000
         L     @04,CVPIL                                           0633 01880000
         ST    @04,FMRIL                                           0633 01881000
*         FMRIP = CVPIADD;              /* SET REMAINING INPUT LOC.  */ 01882000
         L     @04,CVPIADD                                         0634 01883000
         ST    @04,FMRIP                                           0634 01884000
*         /***********************************************************/ 01885000
*         /*                                                         */ 01886000
*         /* TEST FOR EITHER BYTE TO HEXIDECIMAL OR HEXIDECIMAL      */ 01887000
*         /* APOSTROPHE CONVERSION AND CALL BHCONV PROCEDURE IF ON.  */ 01888000
*         /*                                                         */ 01889000
*         /***********************************************************/ 01890000
*                                                                  0635 01891000
*         IF CVPBH = ON | CVPBHA = ON                              0635 01892000
*           THEN                                                   0635 01893000
*                                                                  0635 01894000
         TM    CVPBH,B'11000000'                                   0635 01895000
         BZ    @RF00635                                            0635 01896000
*             CALL BHCONV;                                         0636 01897000
*                                                                  0636 01898000
         BAL   @14,BHCONV                                          0636 01899000
*         /***********************************************************/ 01900000
*         /*                                                         */ 01901000
*         /* IF BYTE TO HEXIDECIMAL DUMP CONVERSION IS ON            */ 01902000
*         /* THEN CALL BHDCONV PROCEDURE.                            */ 01903000
*         /*                                                         */ 01904000
*         /***********************************************************/ 01905000
*                                                                  0637 01906000
*         IF CVPBHD = ON                                           0637 01907000
*           THEN                                                   0637 01908000
*                                                                  0637 01909000
@RF00635 TM    CVPBHD,B'00100000'                                  0637 01910000
         BNO   @RF00637                                            0637 01911000
*             CALL BHDCONV;                                        0638 01912000
*                                                                  0638 01913000
         BAL   @14,BHDCONV                                         0638 01914000
*         /***********************************************************/ 01915000
*         /*                                                         */ 01916000
*         /* IF PACKED TO UNPACKED CONVERSION IS ON THEN CALL        */ 01917000
*         /* PUPCONV PROCEDURE.                                      */ 01918000
*         /*                                                         */ 01919000
*         /***********************************************************/ 01920000
*                                                                  0639 01921000
*         IF CVPPU = ON                                            0639 01922000
*           THEN                                                   0639 01923000
@RF00637 TM    CVPPU,B'00001000'                                   0639 01924000
         BNO   @RF00639                                            0639 01925000
*             DO;                                                  0640 01926000
*                                                                  0640 01927000
*               CALL PUPCONV;                                      0641 01928000
*                                                                  0641 01929000
         BAL   @14,PUPCONV                                         0641 01930000
*               RESPECIFY RTNREG RSTD;                             0642 01931000
*               TESTRC = RTNREG;                                   0643 01932000
         STH   RTNREG,TESTRC                                       0643 01933000
*               RESPECIFY RTNREG UNRSTD;                           0644 01934000
*               IF TESTRC > 0                                      0645 01935000
*                 THEN                                             0645 01936000
         LH    @04,TESTRC                                          0645 01937000
         LTR   @04,@04                                             0645 01938000
         BNP   @RF00645                                            0645 01939000
*                   RETURN CODE(TESTRC);                           0646 01940000
         LR    @15,@04                                             0646 01941000
         L     @14,@SA00007                                        0646 01942000
         LM    @00,@06,@SA00007+8                                  0646 01943000
         LM    @08,@12,@SA00007+36                                 0646 01944000
         BR    @14                                                 0646 01945000
*             END;                                                 0647 01946000
*                                                                  0647 01947000
@RF00645 DS    0H                                                  0648 01948000
*         /***********************************************************/ 01949000
*         /*                                                         */ 01950000
*         /* IF BINARY TO DECIMAL CONVERSION FLAG IS ON CALL BDCONV  */ 01951000
*         /*                                                         */ 01952000
*         /***********************************************************/ 01953000
*                                                                  0648 01954000
*         IF CVPBD = ON                                            0648 01955000
*           THEN                                                   0648 01956000
@RF00639 TM    CVPBD,B'00010000'                                   0648 01957000
         BNO   @RF00648                                            0648 01958000
*             DO;                                                  0649 01959000
*                                                                  0649 01960000
*               CALL BDCONV;                                       0650 01961000
*                                                                  0650 01962000
         BAL   @14,BDCONV                                          0650 01963000
*               RESPECIFY RTNREG RSTD;                             0651 01964000
*               TESTRC = RTNREG;                                   0652 01965000
         STH   RTNREG,TESTRC                                       0652 01966000
*               RESPECIFY RTNREG UNRSTD;                           0653 01967000
*               IF TESTRC > 0                                      0654 01968000
*                 THEN                                             0654 01969000
*                                                                  0654 01970000
         LH    @04,TESTRC                                          0654 01971000
         LTR   @04,@04                                             0654 01972000
         BNP   @RF00654                                            0654 01973000
*                   RETURN CODE(TESTRC);                           0655 01974000
*                                                                  0655 01975000
         LR    @15,@04                                             0655 01976000
         L     @14,@SA00007                                        0655 01977000
         LM    @00,@06,@SA00007+8                                  0655 01978000
         LM    @08,@12,@SA00007+36                                 0655 01979000
         BR    @14                                                 0655 01980000
*             END;                                                 0656 01981000
*                                                                  0656 01982000
@RF00654 DS    0H                                                  0657 01983000
*         /***********************************************************/ 01984000
*         /*                                                         */ 01985000
*         /* IF ALL CONVERSION FLAGS ARE OFF, THEN CONVERT THE LINE  */ 01986000
*         /* AS AN EBCDIC LINE BY CALLING EBCDIC.                    */ 01987000
*         /*                                                         */ 01988000
*         /***********************************************************/ 01989000
*                                                                  0657 01990000
*         IF CVPBH = OFF &                                         0657 01991000
*           CVPBHA = OFF &                                         0657 01992000
*           CVPBHD = OFF &                                         0657 01993000
*           CVPBD = OFF &                                          0657 01994000
*           CVPPU = OFF                                            0657 01995000
*           THEN                                                   0657 01996000
@RF00648 TM    CVPBH,B'11111000'                                   0657 01997000
         BNZ   @RF00657                                            0657 01998000
*             DO;                                                  0658 01999000
*                                                                  0658 02000000
*               CALL EBCDIC;                                       0659 02001000
*                                                                  0659 02002000
         BAL   @14,EBCDIC                                          0659 02003000
*               RESPECIFY RTNREG RSTD;                             0660 02004000
*               TESTRC = RTNREG;                                   0661 02005000
         STH   RTNREG,TESTRC                                       0661 02006000
*               RESPECIFY RTNREG UNRSTD;                           0662 02007000
*               IF TESTRC > 0                                      0663 02008000
*                 THEN                                             0663 02009000
         LH    @06,TESTRC                                          0663 02010000
         LTR   @06,@06                                             0663 02011000
         BNP   @RF00663                                            0663 02012000
*                   RETURN CODE(RCQUIT);                           0664 02013000
         LH    @15,RCQUIT                                          0664 02014000
         L     @14,@SA00007                                        0664 02015000
         LM    @00,@06,@SA00007+8                                  0664 02016000
         LM    @08,@12,@SA00007+36                                 0664 02017000
         BR    @14                                                 0664 02018000
*             END;                                                 0665 02019000
@RF00663 DS    0H                                                  0666 02020000
*         OLDERID2 = NEWERID2;                                     0666 02021000
@RF00657 L     @06,GDTTR2(,GDTPR)                                  0666 02022000
         MVC   @TS00001(95),NEWERID2(@06)                          0666 02023000
         MVC   OLDERID2(95,@06),@TS00001                           0666 02024000
*         NEWID2 = 'TP2N';                                         0667 02025000
*                                                                  0667 02026000
         MVC   NEWID2(4,@06),@CC00940                              0667 02027000
*         /***********************************************************/ 02028000
*         /*                                                         */ 02029000
*         /* SET THE RETURN CODE NEEDED AND RETURN TO THE FORMAT     */ 02030000
*         /* ROUTINE.                                                */ 02031000
*         /*                                                         */ 02032000
*         /***********************************************************/ 02033000
*                                                                  0668 02034000
*         IF PLOVF = ON                                            0668 02035000
*           THEN                                                   0668 02036000
         TM    PLOVF,B'10000000'                                   0668 02037000
         BNO   @RF00668                                            0668 02038000
*             SETRC = 4;                /* ADVISE FORMAT OF OVERFLOW */ 02039000
         LA    SETRC,4                                             0669 02040000
*           ELSE                                                   0670 02041000
*             SETRC = 0;                                           0670 02042000
*                                                                  0670 02043000
         B     @RC00668                                            0670 02044000
@RF00668 SLR   SETRC,SETRC                                         0670 02045000
*         IF GDTDBG = NULLPTR                                      0671 02046000
*           THEN;                                                  0671 02047000
@RC00668 L     @06,GDTDBG(,GDTPR)                                  0671 02048000
         LTR   @06,@06                                             0671 02049000
         BZ    @RT00671                                            0671 02050000
*           ELSE                                                   0673 02051000
*             CALL IDCDB010 (GDTTBL,'TP2N');                       0673 02052000
*                                                                  0673 02053000
         ST    GDTPR,@AL00001                                      0673 02054000
         LA    @06,@CC00940                                        0673 02055000
         ST    @06,@AL00001+4                                      0673 02056000
         MVI   @AL00001+4,X'80'                                    0673 02057000
         L     @15,GDTDBG(,GDTPR)                                  0673 02058000
         LA    @01,@AL00001                                        0673 02059000
         BALR  @14,@15                                             0673 02060000
*         RETURN CODE(SETRC);                                      0674 02061000
@RT00671 LR    @15,SETRC                                           0674 02062000
         L     @14,@SA00007                                        0674 02063000
         LM    @00,@06,@SA00007+8                                  0674 02064000
         LM    @08,@12,@SA00007+36                                 0674 02065000
         BR    @14                                                 0674 02066000
*         /***********************************************************/ 02067000
*         /*                                                         */ 02068000
*         /* PROCEDURE NAME - BINARY TO HEXADECIMAL CONVERSION.      */ 02069000
*         /*                                                         */ 02070000
*         /* FUNCTION - CONVERTS BINARY INPUT TO PRINTABLE           */ 02071000
*         /* HEXADECIMAL OUTPUT, PUTTING THE CONVERTED BYTES         */ 02072000
*         /* DIRECTLY INTO THE PRINT LINE.  UP TO 32K BYTES MAY BE   */ 02073000
*         /* TRANSLATED IN ANY ONE SEGMENT.                          */ 02074000
*         /*                                                         */ 02075000
*         /* INPUT - THE DATA INPUT POINTER (CVSTA) AND LENGTH       */ 02076000
*         /* (CVSL) AND THE POINTER TO THE PRINT LINE POSITION       */ 02077000
*         /* WHERE THE CONVERTED OUTPUT IS TO BE PLACED.             */ 02078000
*         /* IF THE INPUT LENGTH IS LARGE ENOUGH TO CAUSE THE PRINT  */ 02079000
*         /* LINE TO OVERFLOW, THEN THAT LINE WILL BE PRINTED AND    */ 02080000
*         /* FURTHER LINES WILL BE CONVERTED AND PRINTED UNTIL ALL OF*/ 02081000
*         /* THE INPUT DATA HAS BEEN CONVERTED.  IF THE PRINT LINE   */ 02082000
*         /* DOES NOT OVERFLOW, THEN NO PRINTING OCCURS HERE.        */ 02083000
*         /* CONVERSION FOR ALL LINES WILL BEGIN AT THE SAME POINT   */ 02084000
*         /* IN THE PRINT LINE AS THE FIRST LINE.                    */ 02085000
*         /*                                                         */ 02086000
*         /* OUTPUT - CONVERTED DATA IN THE PRINT LINE.              */ 02087000
*         /*                                                         */ 02088000
*         /***********************************************************/ 02089000
*                                                                  0675 02090000
*BHCONV:  PROC;                                                    0675 02091000
*                                                                  0675 02092000
BHCONV   STM   @14,@02,@SA00008                                    0675 02093000
         STM   @04,@06,@SA00008+20                                 0675 02094000
         STM   @08,@12,@SA00008+32                                 0675 02095000
*         /***********************************************************/ 02096000
*         /*                                                         */ 02097000
*         /* IF THIS IS A BYTE TO HEX APOST, SET THE LEADING APOST.  */ 02098000
*         /*                                                         */ 02099000
*         /***********************************************************/ 02100000
*                                                                  0676 02101000
*         FMSIL = CONVL/2;                                 /*#Y30LSJK*/ 02102000
*                                                                  0676 02103000
         LA    @06,2                                               0676 02104000
         L     @00,CONVL                                           0676 02105000
         SRDA  @00,32                                              0676 02106000
         DR    @00,@06                                             0676 02107000
         LR    FMSIL,@01                                           0676 02108000
*         IF CVPBHA = ON                                           0677 02109000
*           THEN                                                   0677 02110000
         TM    CVPBHA,B'01000000'                                  0677 02111000
         BNO   @RF00677                                            0677 02112000
*             DO;                                                  0678 02113000
*               CVPB(1:2) = 'X''';                                 0679 02114000
         L     @04,CVSTA                                           0679 02115000
         MVC   CVPB(2,@04),@CC00944                                0679 02116000
*               CVSTA = CVSTA + 2;                                 0680 02117000
         ALR   @04,@06                                             0680 02118000
         ST    @04,CVSTA                                           0680 02119000
*               /*****************************************************/ 02120000
*               /*                                           #Y30LSJK*/ 02121000
*               /* TRUNCATE BHA FORMAT AT END OF LINE        #Y30LSJK*/ 02122000
*               /*                                           @Y30LSJK*/ 02123000
*               /*****************************************************/ 02124000
*                                                                  0681 02125000
*               IF PLOVF = ON                                      0681 02126000
*                 THEN                                             0681 02127000
         TM    PLOVF,B'10000000'                                   0681 02128000
         BNO   @RF00681                                            0681 02129000
*                   FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF))    0682 02130000
*                            - 3) / 2;                     /*@Y30LSJK*/ 02131000
*                                                                  0682 02132000
         L     FMSIL,CVPPADD                                       0682 02133000
         SL    FMSIL,PRTBUFPT                                      0682 02134000
         LR    @00,FMSIL                                           0682 02135000
         LCR   @00,@00                                             0682 02136000
         AL    @00,PCTPLW(,PCTPTR)                                 0682 02137000
         SL    @00,@CF00159                                        0682 02138000
         SRDA  @00,32                                              0682 02139000
         DR    @00,@06                                             0682 02140000
         LR    FMSIL,@01                                           0682 02141000
*               PLOVF = OFF;                                       0683 02142000
@RF00681 NI    PLOVF,B'01111111'                                   0683 02143000
*               CVSL = FMSIL + FMSIL;                      /*@Y30LSJK*/ 02144000
         LR    @06,FMSIL                                           0684 02145000
         ALR   @06,FMSIL                                           0684 02146000
         ST    @06,CVSL                                            0684 02147000
*             END;                                                 0685 02148000
*           ELSE                                                   0686 02149000
*             IF PLOVF = ON                                        0686 02150000
*               THEN                                               0686 02151000
         B     @RC00677                                            0686 02152000
@RF00677 TM    PLOVF,B'10000000'                                   0686 02153000
         BNO   @RF00686                                            0686 02154000
*                 FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)))     0687 02155000
*                         / 2;                             /*@Y30LSJK*/ 02156000
*                                                                  0687 02157000
         L     FMSIL,CVPPADD                                       0687 02158000
         SL    FMSIL,PRTBUFPT                                      0687 02159000
         LR    @00,FMSIL                                           0687 02160000
         LCR   @00,@00                                             0687 02161000
         AL    @00,PCTPLW(,PCTPTR)                                 0687 02162000
         SRDA  @00,32                                              0687 02163000
         D     @00,@CF00150                                        0687 02164000
         LR    FMSIL,@01                                           0687 02165000
*         /***********************************************************/ 02166000
*         /*                                                         */ 02167000
*         /* CONVERT THE BYTE SEGMENT TO PRINTABLE HEXADECIMAL.      */ 02168000
*         /* CONVERSION IS DIRECTLY TO THE PRINT BUFFER.             */ 02169000
*         /*                                                         */ 02170000
*         /***********************************************************/ 02171000
*                                                                  0688 02172000
*         DO WHILE CVSL > 0;                                       0688 02173000
*                                                                  0688 02174000
@RF00686 DS    0H                                                  0688 02175000
@RC00677 B     @DE00688                                            0688 02176000
@DL00688 DS    0H                                                  0689 02177000
*         /***********************************************************/ 02178000
*         /*                                                         */ 02179000
*         /* THE FOLLOWING IS THE ACTUAL CONVERSION DO LOOP.         */ 02180000
*         /* CVCHR HOLDS THE TRANSLATE TABLE OFFSET FOR THE FIRST    */ 02181000
*         /* HALF BYTE.                                              */ 02182000
*         /* TTOFF HOLDS THE TRANSLATE TABLE OFFSET FOR THE SECOND   */ 02183000
*         /* HALF BYTE.                                              */ 02184000
*         /* BHTRTB IS THE TRANSLATE TABLE.                          */ 02185000
*         /* TRBUF HOLDS THE INPUT SOURCE.                           */ 02186000
*         /* CVPB HOLDS THE OUTPUT TRANSLATED DATA.                  */ 02187000
*         /*                                                         */ 02188000
*         /***********************************************************/ 02189000
*                                                                  0689 02190000
*           DO N = 1 TO FMSIL;                                     0689 02191000
         LA    N,1                                                 0689 02192000
         B     @DE00689                                            0689 02193000
@DL00689 DS    0H                                                  0690 02194000
*             CVPB(2*N-1) = BHTRTB(TRBUF(N)/16+1);                 0690 02195000
         L     @06,CVSTA                                           0690 02196000
         LR    @04,N                                               0690 02197000
         ALR   @04,@04                                             0690 02198000
         ST    @04,@TF00001                                        0690 02199000
         ALR   @04,@06                                             0690 02200000
         BCTR  @04,0                                               0690 02201000
         BCTR  @04,0                                               0690 02202000
         L     @01,FMRIP                                           0690 02203000
         BCTR  @01,0                                               0690 02204000
         SLR   @15,@15                                             0690 02205000
         IC    @15,TRBUF(N,@01)                                    0690 02206000
         LR    @14,@15                                             0690 02207000
         SRL   @14,4                                               0690 02208000
         LA    @01,BHTRTB(@14)                                     0690 02209000
         MVC   CVPB(1,@04),0(@01)                                  0690 02210000
*             CVPB(2*N) = BHTRTB((TRBUF(N) & '0F'X) + 1);          0691 02211000
         AL    @06,@TF00001                                        0691 02212000
         BCTR  @06,0                                               0691 02213000
         N     @15,@CF00945                                        0691 02214000
         LA    @04,BHTRTB(@15)                                     0691 02215000
         MVC   CVPB(1,@06),0(@04)                                  0691 02216000
*           END;                                                   0692 02217000
         AL    N,@CF00216                                          0692 02218000
@DE00689 CR    N,FMSIL                                             0692 02219000
         BNH   @DL00689                                            0692 02220000
*           CVSL = CVSL - FMSIL * 2;                               0693 02221000
*                                                                  0693 02222000
         LR    @06,FMSIL                                           0693 02223000
         ALR   @06,@06                                             0693 02224000
         LCR   @06,@06                                             0693 02225000
         AL    @06,CVSL                                            0693 02226000
         ST    @06,CVSL                                            0693 02227000
*         /***********************************************************/ 02228000
*         /*                                                         */ 02229000
*         /* IF NO PRINT LINE OVERFLOW, SET UP THE TRAILING 'X       */ 02230000
*         /*                                                         */ 02231000
*         /***********************************************************/ 02232000
*                                                                  0694 02233000
*           IF PLOVF = OFF & CVPBHA = ON                           0694 02234000
*             THEN                                                 0694 02235000
         TM    PLOVF,B'10000000'                                   0694 02236000
         BNZ   @RF00694                                            0694 02237000
         TM    CVPBHA,B'01000000'                                  0694 02238000
         BNO   @RF00694                                            0694 02239000
*               DO;                                                0695 02240000
*                 IF CVSTA + 2*N <= ADDR(PRTBUFF) + PCTPLW         0696 02241000
*                   THEN                                           0696 02242000
         L     @06,CVSTA                                           0696 02243000
         LR    @04,N                                               0696 02244000
         ALR   @04,@04                                             0696 02245000
         LR    @15,@06                                             0696 02246000
         ALR   @15,@04                                             0696 02247000
         L     @14,PRTBUFPT                                        0696 02248000
         AL    @14,PCTPLW(,PCTPTR)                                 0696 02249000
         CR    @15,@14                                             0696 02250000
         BH    @RF00696                                            0696 02251000
*                     CVPB(2*N-1) = '''';                          0697 02252000
         ALR   @06,@04                                             0697 02253000
         BCTR  @06,0                                               0697 02254000
         BCTR  @06,0                                               0697 02255000
         MVI   CVPB(@06),C''''                                     0697 02256000
*               END;                                               0698 02257000
*                                                                  0698 02258000
@RF00696 DS    0H                                                  0699 02259000
*         /***********************************************************/ 02260000
*         /*                                                 @Y30LSJK*/ 02261000
*         /* SET ACTUAL PRINT COLUMN                         @Y30LSJK*/ 02262000
*         /*                                                 @Y30LSJK*/ 02263000
*         /***********************************************************/ 02264000
*         PCTAPC = CVSTA +FMSIL + FMSIL - ADDR(PRTBUFF);   /*@Y30LSJK*/ 02265000
@RF00694 LR    @06,FMSIL                                           0699 02266000
         AL    @06,CVSTA                                           0699 02267000
         ALR   @06,FMSIL                                           0699 02268000
         SL    @06,PRTBUFPT                                        0699 02269000
         STH   @06,PCTAPC(,PCTPTR)                                 0699 02270000
*         IF CVPBHA = ON                                           0700 02271000
*           THEN                                                   0700 02272000
         TM    CVPBHA,B'01000000'                                  0700 02273000
         BNO   @RF00700                                            0700 02274000
*             PCTAPC = PCTAPC + 3;                         /*@Y30LSJK*/ 02275000
*                                                                  0701 02276000
         AL    @06,@CF00159                                        0701 02277000
         STH   @06,PCTAPC(,PCTPTR)                                 0701 02278000
*         /***********************************************************/ 02279000
*         /*                                                         */ 02280000
*         /* SINCE A PRINT LINE OVER FLOW HAS OCCURRED, PRINT THE    */ 02281000
*         /* LINE JUST CONVERTED.                                    */ 02282000
*         /*                                                         */ 02283000
*         /***********************************************************/ 02284000
*                                                                  0702 02285000
*           IF PLOVF = ON                                          0702 02286000
*             THEN                                                 0702 02287000
@RF00700 TM    PLOVF,B'10000000'                                   0702 02288000
         BNO   @RF00702                                            0702 02289000
*               DO;                                                0703 02290000
*                                                                  0703 02291000
*                 CALL LINEPRT;                                    0704 02292000
*                                                                  0704 02293000
         BAL   @14,LINEPRT                                         0704 02294000
*                 RESPECIFY RTNREG RSTD;                           0705 02295000
*                 TESTRC = RTNREG;                                 0706 02296000
         STH   RTNREG,TESTRC                                       0706 02297000
*                 RESPECIFY RTNREG UNRSTD;                         0707 02298000
*                 IF TESTRC ^= 0                                   0708 02299000
*                   THEN                                           0708 02300000
         LH    @06,TESTRC                                          0708 02301000
         LTR   @06,@06                                             0708 02302000
         BZ    @RF00708                                            0708 02303000
*                     RETURN CODE(RCQUIT);                         0709 02304000
*                                                                  0709 02305000
         LH    @15,RCQUIT                                          0709 02306000
         L     @14,@SA00008                                        0709 02307000
         LM    @00,@02,@SA00008+8                                  0709 02308000
         LM    @04,@06,@SA00008+20                                 0709 02309000
         LM    @08,@12,@SA00008+32                                 0709 02310000
         BR    @14                                                 0709 02311000
*                 PRTSPF = 1;                                      0710 02312000
*                                                                  0710 02313000
@RF00708 MVC   PRTSPF(2),@CH00216                                  0710 02314000
*                 /***************************************************/ 02315000
*                 /*                                                 */ 02316000
*                 /* UPDATE FOR THE REPETITION IF PRINT LINE         */ 02317000
*                 /* OVERFLOW.                                       */ 02318000
*                 /*                                                 */ 02319000
*                 /***************************************************/ 02320000
*                                                                  0711 02321000
*                 FMRIP = FMRIP + FMSIL;                           0711 02322000
         LR    @06,FMSIL                                           0711 02323000
         AL    @06,FMRIP                                           0711 02324000
         ST    @06,FMRIP                                           0711 02325000
*                 CVSTA = CVPPADD;                                 0712 02326000
         L     @06,CVPPADD                                         0712 02327000
         ST    @06,CVSTA                                           0712 02328000
*                 IF CVSL > (ADDR(PRTBUFF) + PCTPLW - CVPPADD)     0713 02329000
*                   THEN                                           0713 02330000
         L     @04,PRTBUFPT                                        0713 02331000
         AL    @04,PCTPLW(,PCTPTR)                                 0713 02332000
         SLR   @04,@06                                             0713 02333000
         C     @04,CVSL                                            0713 02334000
         BNL   @RF00713                                            0713 02335000
*                     FMSIL = (ADDR(PRTBUFF) + PCTPLW - CVPPADD)/2;     02336000
         LR    @00,@04                                             0714 02337000
         SRDA  @00,32                                              0714 02338000
         D     @00,@CF00150                                        0714 02339000
         LR    FMSIL,@01                                           0714 02340000
*                   ELSE                                           0715 02341000
*                     FMSIL = CVSL/2;                              0715 02342000
         B     @RC00713                                            0715 02343000
@RF00713 L     @00,CVSL                                            0715 02344000
         SRDA  @00,32                                              0715 02345000
         D     @00,@CF00150                                        0715 02346000
         LR    FMSIL,@01                                           0715 02347000
*               END;                                               0716 02348000
@RC00713 DS    0H                                                  0717 02349000
*         END;                                                     0717 02350000
*                                                                  0717 02351000
@RF00702 DS    0H                                                  0717 02352000
@DE00688 SLR   @06,@06                                             0717 02353000
         C     @06,CVSL                                            0717 02354000
         BL    @DL00688                                            0717 02355000
*         /***********************************************************/ 02356000
*         /*                                                         */ 02357000
*         /* CLEAN UP AND RETURN TO THE MAIN PROCEDURE.              */ 02358000
*         /*                                                         */ 02359000
*         /***********************************************************/ 02360000
*                                                                  0718 02361000
*         RETURN CODE (0);                                         0718 02362000
         LR    @15,@06                                             0718 02363000
         L     @14,@SA00008                                        0718 02364000
         LM    @00,@02,@SA00008+8                                  0718 02365000
         LM    @04,@06,@SA00008+20                                 0718 02366000
         LM    @08,@12,@SA00008+32                                 0718 02367000
         BR    @14                                                 0718 02368000
*         END BHCONV;                                              0719 02369000
*         /***********************************************************/ 02370000
*         /*                                                         */ 02371000
*         /* PROCEDURE NAME - BINARY TO HEX DUMP CONVERSION.         */ 02372000
*         /*                                                         */ 02373000
*         /* FUNCTION - CONVERTS BINARY INPUT TO DUMP FORMATTED      */ 02374000
*         /* OUTPUT.  CONVERSION ALWAYS BEGINS AT POSITION ONE IN    */ 02375000
*         /* THE PRINT LINE.                                         */ 02376000
*         /*                                                         */ 02377000
*         /* INPUT - THE DATA INPUT POINTER AND LENGTH.              */ 02378000
*         /*                                                         */ 02379000
*         /* OUTPUT - DUMP FORMATTED PRINT LINE(S).                  */ 02380000
*         /*                                                         */ 02381000
*         /***********************************************************/ 02382000
*                                                                  0720 02383000
*BHDCONV: PROC;                                                    0720 02384000
*                                                                  0720 02385000
BHDCONV  STM   @14,@02,@SA00009                                    0720 02386000
         STM   @04,@06,@SA00009+20                                 0720 02387000
         STM   @08,@12,@SA00009+32                                 0720 02388000
*         /***********************************************************/ 02389000
*         /*                                                         */ 02390000
*         /* INITIALIZE THE OUTPUT INDEX COUNT AND SEGMENT LENGTH.   */ 02391000
*         /*                                                         */ 02392000
*         /***********************************************************/ 02393000
*                                                                  0721 02394000
*         OLDERID2 = NEWERID2;                                     0721 02395000
         L     @06,GDTTR2(,GDTPR)                                  0721 02396000
         MVC   @TS00001(95),NEWERID2(@06)                          0721 02397000
         MVC   OLDERID2(95,@06),@TS00001                           0721 02398000
*         NEWID2 = 'TP2M';                                         0722 02399000
         MVC   NEWID2(4,@06),@CC00950                              0722 02400000
*         HDINDEXB = 0;                                            0723 02401000
         SLR   @06,@06                                             0723 02402000
         STH   @06,HDINDEXB                                        0723 02403000
*         SETRC = 0;                                               0724 02404000
         SLR   SETRC,SETRC                                         0724 02405000
*         IF FMRIL > 32                                            0725 02406000
*           THEN                                                   0725 02407000
         LA    @06,32                                              0725 02408000
         C     @06,FMRIL                                           0725 02409000
         BNL   @RF00725                                            0725 02410000
*             FMSIL = 32;                                          0726 02411000
         LR    FMSIL,@06                                           0726 02412000
*           ELSE                                                   0727 02413000
*             FMSIL = FMRIL;                                       0727 02414000
*                                                                  0727 02415000
         B     @RC00725                                            0727 02416000
@RF00725 L     FMSIL,FMRIL                                         0727 02417000
*         /***********************************************************/ 02418000
*         /*                                                         */ 02419000
*         /* THIS CODE BEGINS THE MAJOR CONVERSION LOOP.             */ 02420000
*         /*                                                         */ 02421000
*         /***********************************************************/ 02422000
*                                                                  0728 02423000
*         DO WHILE FMRIL > 0;                                      0728 02424000
@RC00725 B     @DE00728                                            0728 02425000
@DL00728 DS    0H                                                  0729 02426000
*           HDCVB(1:64) = ' ';                                     0729 02427000
*                                                                  0729 02428000
         MVI   HDCVB+1,C' '                                        0729 02429000
         MVC   HDCVB+2(62),HDCVB+1                                 0729 02430000
         MVI   HDCVB,C' '                                          0729 02431000
*         /***********************************************************/ 02432000
*         /*                                                         */ 02433000
*         /* SET THE EBCDIC PORTION OF THE HEX DUMP FORMAT.          */ 02434000
*         /*                                                         */ 02435000
*         /***********************************************************/ 02436000
*                                                                  0730 02437000
*           HDSEG3(1:FMSIL) = TRBUF;                               0730 02438000
         L     @04,CVPPADD                                         0730 02439000
         LR    @15,FMSIL                                           0730 02440000
         BCTR  @15,0                                               0730 02441000
         L     @01,FMRIP                                           0730 02442000
         EX    @15,@SM01042                                        0730 02443000
*           HDST1 = '*';                                           0731 02444000
         MVI   HDST1(@04),C'*'                                     0731 02445000
*           HDST2 = '*';                                           0732 02446000
*                                                                  0732 02447000
         MVI   HDST2(@04),C'*'                                     0732 02448000
*         /***********************************************************/ 02449000
*         /*                                                         */ 02450000
*         /* SET THE INDEX FOR THE FORMAT IN COLS 1 THROUGH 4.       */ 02451000
*         /* HDINDEXC(B) CONTAINS THE UPDATED INDEX TO BE TRANSLATED */ 02452000
*         /* HDINDEX IS THE INDEX LOCATION ON THE PRINT LINE.        */ 02453000
*         /*                                                         */ 02454000
*         /***********************************************************/ 02455000
*                                                                  0733 02456000
*           DO N = 1 TO 2 BY 1;                                    0733 02457000
         LA    N,1                                                 0733 02458000
@DL00733 DS    0H                                                  0734 02459000
*             HDINDEX(2*N-1) = BHTRTB(HDINDEXC(N)/16+1);           0734 02460000
         L     @06,CVPPADD                                         0734 02461000
         LR    @04,N                                               0734 02462000
         ALR   @04,@04                                             0734 02463000
         ST    @04,@TF00001                                        0734 02464000
         ALR   @04,@06                                             0734 02465000
         BCTR  @04,0                                               0734 02466000
         BCTR  @04,0                                               0734 02467000
         SLR   @15,@15                                             0734 02468000
         IC    @15,HDINDEXC-1(N)                                   0734 02469000
         SRL   @15,4                                               0734 02470000
         LA    @14,BHTRTB(@15)                                     0734 02471000
         MVC   HDINDEX(1,@04),0(@14)                               0734 02472000
*             HDINDEX(2*N) = BHTRTB((HDINDEXC(N) & '0F'X) + 1);    0735 02473000
         AL    @06,@TF00001                                        0735 02474000
         BCTR  @06,0                                               0735 02475000
         LA    @04,15                                              0735 02476000
         SLR   @15,@15                                             0735 02477000
         IC    @15,HDINDEXC-1(N)                                   0735 02478000
         NR    @04,@15                                             0735 02479000
         LA    @01,BHTRTB(@04)                                     0735 02480000
         MVC   HDINDEX(1,@06),0(@01)                               0735 02481000
*           END;                                                   0736 02482000
*                                                                  0736 02483000
         AL    N,@CF00216                                          0736 02484000
         C     N,@CF00150                                          0736 02485000
         BNH   @DL00733                                            0736 02486000
*         /***********************************************************/ 02487000
*         /*                                                         */ 02488000
*         /* CONVERT THE DUMP SEGMENTS FROM BYTE TO HEXADECIMAL.     */ 02489000
*         /* TRBUF  CONTAINS THE INPUT BYTE STRING TO BE TRANSLATED  */ 02490000
*         /* HDCVB CONTAINS THE TRANSLATED OUTPUT SEGMENTS.          */ 02491000
*         /*                                                         */ 02492000
*         /***********************************************************/ 02493000
*                                                                  0737 02494000
*           DO N = 1 TO FMSIL BY 1;                                0737 02495000
         LA    N,1                                                 0737 02496000
         B     @DE00737                                            0737 02497000
@DL00737 DS    0H                                                  0738 02498000
*             HDCVB(2*N-1) = BHTRTB(TRBUF(N)/16+1);                0738 02499000
         LR    @06,N                                               0738 02500000
         ALR   @06,@06                                             0738 02501000
         LA    @04,HDCVB-2(@06)                                    0738 02502000
         L     @01,FMRIP                                           0738 02503000
         BCTR  @01,0                                               0738 02504000
         SLR   @15,@15                                             0738 02505000
         IC    @15,TRBUF(N,@01)                                    0738 02506000
         LR    @14,@15                                             0738 02507000
         SRL   @14,4                                               0738 02508000
         LA    @01,BHTRTB(@14)                                     0738 02509000
         MVC   0(1,@04),0(@01)                                     0738 02510000
*             HDCVB(2*N) = BHTRTB((TRBUF(N) & '0F'X) + 1);         0739 02511000
         LA    @04,HDCVB-1(@06)                                    0739 02512000
         N     @15,@CF00945                                        0739 02513000
         LA    @06,BHTRTB(@15)                                     0739 02514000
         MVC   0(1,@04),0(@06)                                     0739 02515000
*           END;                                                   0740 02516000
*                                                                  0740 02517000
         AL    N,@CF00216                                          0740 02518000
@DE00737 CR    N,FMSIL                                             0740 02519000
         BNH   @DL00737                                            0740 02520000
*         /***********************************************************/ 02521000
*         /*                                                         */ 02522000
*         /* MOVE THE CONVERTED SEGMENTS TO THE PRINT BUFFER.        */ 02523000
*         /* HDSEG1 IS THE FIRST HALF (4 - 8 BYTE SEGMENTS) OF THE   */ 02524000
*         /* PRINT LINE.                                             */ 02525000
*         /* HDSEG2 IS THE SECOND HALF (4 - 8 BYTE SEGMENTS) OF THE  */ 02526000
*         /* PRINT LINE.                                             */ 02527000
*         /* HDCVB CONTAINS THE CONVERTED SEGMENTS WITH NO SPACES.   */ 02528000
*         /*                                                         */ 02529000
*         /***********************************************************/ 02530000
*                                                                  0741 02531000
*           J =1;                                                  0741 02532000
         LA    @15,1                                               0741 02533000
         LR    J,@15                                               0741 02534000
*           DO N = 1 TO 28 BY 9;                                   0742 02535000
         LR    N,@15                                               0742 02536000
@DL00742 DS    0H                                                  0743 02537000
*             HDSEG1(N:N+8) = HDCVB(J:J+7);                        0743 02538000
         L     @06,CVPPADD                                         0743 02539000
         LR    @01,@06                                             0743 02540000
         ALR   @01,N                                               0743 02541000
         MVI   HDSEG1+7(@01),C' '                                  0743 02542000
         LA    @15,HDCVB-1(J)                                      0743 02543000
         MVC   HDSEG1-1(8,@01),0(@15)                              0743 02544000
*             HDSEG2(N:N+8) = HDCVB(J+32:J+39);                    0744 02545000
         ALR   @06,N                                               0744 02546000
         MVI   HDSEG2+7(@06),C' '                                  0744 02547000
         LA    @01,HDCVB+31(J)                                     0744 02548000
         MVC   HDSEG2-1(8,@06),0(@01)                              0744 02549000
*             J = J+8;                                             0745 02550000
         AL    J,@CF00176                                          0745 02551000
*           END;                                                   0746 02552000
*                                                                  0746 02553000
         AL    N,@CF00953                                          0746 02554000
         C     N,@CF00952                                          0746 02555000
         BNH   @DL00742                                            0746 02556000
*         /***********************************************************/ 02557000
*         /*                                                         */ 02558000
*         /* CALL THE PRINT CALL SUB-ROUTINE TO PRINT THIS LINE.     */ 02559000
*         /*                                                         */ 02560000
*         /***********************************************************/ 02561000
*                                                                  0747 02562000
*         CALL LINEPRT;                                            0747 02563000
*                                                                  0747 02564000
         BAL   @14,LINEPRT                                         0747 02565000
*         RESPECIFY RTNREG RSTD;                                   0748 02566000
*         TESTRC = RTNREG;                                         0749 02567000
         STH   RTNREG,TESTRC                                       0749 02568000
*         RESPECIFY RTNREG UNRSTD;                                 0750 02569000
*         IF TESTRC ^= 0                                           0751 02570000
*           THEN                                                   0751 02571000
         LH    @06,TESTRC                                          0751 02572000
         LTR   @06,@06                                             0751 02573000
         BZ    @RF00751                                            0751 02574000
*             RETURN CODE(RCQUIT);                                 0752 02575000
*                                                                  0752 02576000
         LH    @15,RCQUIT                                          0752 02577000
         L     @14,@SA00009                                        0752 02578000
         LM    @00,@02,@SA00009+8                                  0752 02579000
         LM    @04,@06,@SA00009+20                                 0752 02580000
         LM    @08,@12,@SA00009+32                                 0752 02581000
         BR    @14                                                 0752 02582000
*         PRTSPF = 1;                                              0753 02583000
*                                                                  0753 02584000
@RF00751 MVC   PRTSPF(2),@CH00216                                  0753 02585000
*         /***********************************************************/ 02586000
*         /*                                                         */ 02587000
*         /* UPDATE THE INPUT POINTERS FOR THE NEXT LINE.            */ 02588000
*         /*                                                         */ 02589000
*         /***********************************************************/ 02590000
*                                                                  0754 02591000
*           HDINDEXB = HDINDEXB + 32;   /* INCREMENT INDEX.          */ 02592000
         LA    @06,32                                              0754 02593000
         LH    @04,HDINDEXB                                        0754 02594000
         ALR   @04,@06                                             0754 02595000
         STH   @04,HDINDEXB                                        0754 02596000
*           FMRIP = FMRIP + FMSIL;      /* INCREMENT INPUT PTR.      */ 02597000
         LR    @04,FMSIL                                           0755 02598000
         AL    @04,FMRIP                                           0755 02599000
         ST    @04,FMRIP                                           0755 02600000
*           FMRIL = FMRIL - FMSIL;      /* DECREMENT INPUT LENGTH.   */ 02601000
         L     @04,FMRIL                                           0756 02602000
         SLR   @04,FMSIL                                           0756 02603000
         ST    @04,FMRIL                                           0756 02604000
*           IF FMRIL > 32                                          0757 02605000
*             THEN                                                 0757 02606000
         CR    @04,@06                                             0757 02607000
         BNH   @RF00757                                            0757 02608000
*               FMSIL = 32;             /* SET SEGMENT LENGTH.       */ 02609000
         LR    FMSIL,@06                                           0758 02610000
*             ELSE                                                 0759 02611000
*               FMSIL = FMRIL;          /* SET SEGMENT LENGTH.       */ 02612000
         B     @RC00757                                            0759 02613000
@RF00757 L     FMSIL,FMRIL                                         0759 02614000
*         END;                                                     0760 02615000
*                                                                  0760 02616000
@RC00757 DS    0H                                                  0760 02617000
@DE00728 SLR   @06,@06                                             0760 02618000
         C     @06,FMRIL                                           0760 02619000
         BL    @DL00728                                            0760 02620000
*         /***********************************************************/ 02621000
*         /*                                                         */ 02622000
*         /* CLEAN UP AND END THE BHD CONVERSION PROCEDURE.          */ 02623000
*         /*                                                         */ 02624000
*         /***********************************************************/ 02625000
*                                                                  0761 02626000
*         RETURN CODE (0);                                         0761 02627000
*                                                                  0761 02628000
         LR    @15,@06                                             0761 02629000
         L     @14,@SA00009                                        0761 02630000
         LM    @00,@02,@SA00009+8                                  0761 02631000
         LM    @04,@06,@SA00009+20                                 0761 02632000
         LM    @08,@12,@SA00009+32                                 0761 02633000
         BR    @14                                                 0761 02634000
*         END BHDCONV;                                             0762 02635000
*         /***********************************************************/ 02636000
*         /*                                                         */ 02637000
*         /* PROCEDURE NAME - EBCDIC CONVERSION PROCEDURE.           */ 02638000
*         /*                                                         */ 02639000
*         /* FUNCTION - MOVES EBCDIC DATA TO BE PRINTED TO THE PRINT */ 02640000
*         /* LINE.                                                   */ 02641000
*         /* IF PRINT LINE OVERFLOW OCCURS, ALL LINES RESULTING FROM */ 02642000
*         /* THE OVERFLOW ARE PRINTED PRIOR TO RETURN TO IDCTP01.    */ 02643000
*         /*                                                         */ 02644000
*         /* INPUT - THE INPUT DATA POINTER AND LENGTH AND THE PRINT */ 02645000
*         /* POSITION ADDRESS.                                       */ 02646000
*         /*                                                         */ 02647000
*         /* OUTPUT - DATA FORMATTED ON THE PRINT LINE.              */ 02648000
*         /*                                                         */ 02649000
*         /***********************************************************/ 02650000
*                                                                  0763 02651000
*EBCDIC:  PROC;                                                    0763 02652000
*                                                                  0763 02653000
EBCDIC   STM   @14,@06,@SA00010                                    0763 02654000
         STM   @08,@12,@SA00010+36                                 0763 02655000
*         ALIGNBUF = ' ';               /* SET BUFFER BLANK  @OZ05939*/ 02656000
*                                                                  0764 02657000
         MVI   ALIGNBUF+1,C' '                                     0764 02658000
         MVC   ALIGNBUF+2(133),ALIGNBUF+1                          0764 02659000
         MVI   ALIGNBUF,C' '                                       0764 02660000
*         IF PLOVF = ON                 /* CHECK PRINT LINE          */ 02661000
*           THEN                        /* OVERFLOW BIT              */ 02662000
         TM    PLOVF,B'10000000'                                   0765 02663000
         BNO   @RF00765                                            0765 02664000
*             DO;                                                  0766 02665000
*                                                                  0766 02666000
*             /*******************************************************/ 02667000
*             /*                                                     */ 02668000
*             /* FOR PRINT LINE OVERFLOW, BREAK THE INPUT DATA INTO  */ 02669000
*             /* SEGMENTS AND PUT IT INTO THE PRINT LINE, INVOKING   */ 02670000
*             /* LINEPRT FOR EACH LINE UNTIL ALL INPUT DATA HAS BEEN */ 02671000
*             /* PRINTED.                                            */ 02672000
*             /*                                                     */ 02673000
*             /*******************************************************/ 02674000
*                                                                  0767 02675000
*               FMSIL = (PCTPLW - (CVPPADD - ADDR(PRTBUFF)));      0767 02676000
         L     FMSIL,CVPPADD                                       0767 02677000
         SL    FMSIL,PRTBUFPT                                      0767 02678000
         LCR   FMSIL,FMSIL                                         0767 02679000
         AL    FMSIL,PCTPLW(,PCTPTR)                               0767 02680000
*               DO WHILE CVSL > 0;                                 0768 02681000
         B     @DE00768                                            0768 02682000
@DL00768 DS    0H                                                  0769 02683000
*                 CVPB(1:FMSIL) = TRBUF;                           0769 02684000
         L     @06,CVSTA                                           0769 02685000
         LR    @04,FMSIL                                           0769 02686000
         BCTR  @04,0                                               0769 02687000
         L     @15,FMRIP                                           0769 02688000
         EX    @04,@SM01044                                        0769 02689000
*                                       /* MOVE THE SEGMENT.         */ 02690000
*                 CVSL = CVSL - FMSIL;                             0770 02691000
         L     @06,CVSL                                            0770 02692000
         SLR   @06,FMSIL                                           0770 02693000
         ST    @06,CVSL                                            0770 02694000
*                                       /* STEP SEGMENT LENGTH.      */ 02695000
*                 FMRIP = FMRIP + FMSIL;                           0771 02696000
         ALR   @15,FMSIL                                           0771 02697000
         ST    @15,FMRIP                                           0771 02698000
*                                       /* STEP THE INPUT POINTER.   */ 02699000
*                                                                  0772 02700000
*                 CALL LINEPRT;                                    0772 02701000
*                                                                  0772 02702000
         BAL   @14,LINEPRT                                         0772 02703000
*                 RESPECIFY RTNREG RSTD;                           0773 02704000
*                 TESTRC = RTNREG;                                 0774 02705000
         STH   RTNREG,TESTRC                                       0774 02706000
*                 RESPECIFY RTNREG UNRSTD;                         0775 02707000
*                   IF TESTRC > 0                                  0776 02708000
*                     THEN                                         0776 02709000
         LH    @06,TESTRC                                          0776 02710000
         LTR   @06,@06                                             0776 02711000
         BNP   @RF00776                                            0776 02712000
*                       RETURN CODE(RCQUIT);                       0777 02713000
*                                                                  0777 02714000
         LH    @15,RCQUIT                                          0777 02715000
         L     @14,@SA00010                                        0777 02716000
         LM    @00,@06,@SA00010+8                                  0777 02717000
         LM    @08,@12,@SA00010+36                                 0777 02718000
         BR    @14                                                 0777 02719000
*                 PRTSPF = 1;                                      0778 02720000
@RF00776 MVC   PRTSPF(2),@CH00216                                  0778 02721000
*                 CVSTA = CVPPADD;      /* RESET THE PRINT START ADDR*/ 02722000
         L     @06,CVPPADD                                         0779 02723000
         ST    @06,CVSTA                                           0779 02724000
*                 IF CVSL > (ADDR(PRTBUFF) + PCTPLW - CVPPADD)     0780 02725000
*                   THEN                /*IF MORE THAN ONE PRINT LINE*/ 02726000
         L     @04,PRTBUFPT                                        0780 02727000
         AL    @04,PCTPLW(,PCTPTR)                                 0780 02728000
         SLR   @04,@06                                             0780 02729000
         C     @04,CVSL                                            0780 02730000
         BNL   @RF00780                                            0780 02731000
*                     FMSIL = (ADDR(PRTBUFF) + PCTPLW - CVPPADD);  0781 02732000
         LR    FMSIL,@04                                           0781 02733000
*                                       /* MOVE A COMPLETE SEGMENT.  */ 02734000
*                   ELSE                /* IF LESS THEN ONE LINE     */ 02735000
*                     DO;                                          0782 02736000
         B     @RC00780                                            0782 02737000
@RF00780 DS    0H                                                  0783 02738000
*                       FMSIL = CVSL;   /* SET LENGTH FOR REMAINDER  */ 02739000
         L     FMSIL,CVSL                                          0783 02740000
*                       PCTAPC = 0;                                0784 02741000
         SLR   @06,@06                                             0784 02742000
         STH   @06,PCTAPC(,PCTPTR)                                 0784 02743000
*                     END;                                         0785 02744000
*               END;                                               0786 02745000
@RC00780 DS    0H                                                  0786 02746000
@DE00768 L     @06,CVSL                                            0786 02747000
         LTR   @06,@06                                             0786 02748000
         BP    @DL00768                                            0786 02749000
*             END;                                                 0787 02750000
*           ELSE                                                   0788 02751000
*             DO;                                                  0788 02752000
*                                                                  0788 02753000
         B     @RC00765                                            0788 02754000
@RF00765 DS    0H                                                  0789 02755000
*             /*******************************************************/ 02756000
*             /*                                                     */ 02757000
*             /* MOVE A PARTIAL LINE SEGMENT.                        */ 02758000
*             /*                                                     */ 02759000
*             /*******************************************************/ 02760000
*                                                                  0789 02761000
*               FMSIL = CVPOL;                                     0789 02762000
         L     FMSIL,CVPOL                                         0789 02763000
*               ALIGNBUF(1:CVSL) = TRBUF;                  /*@OZ05939*/ 02764000
*                                                                  0790 02765000
         L     @07,CVSL                                            0790 02766000
         LR    @04,@07                                             0790 02767000
         BCTR  @04,0                                               0790 02768000
         L     @03,FMRIP                                           0790 02769000
         EX    @04,@SM01046                                        0790 02770000
*               /*****************************************************/ 02771000
*               /*                                                   */ 02772000
*               /* LOCATE THE LAST NON BLANK CHARACTER AND SET THE   */ 02773000
*               /* OFFSET FOR BLANK SUPPRESSION.  IF ENTIRE FIELD    */ 02774000
*               /* IS BLANKS THEN PRINT BLANK FIELD.         @OZ24776*/ 02775000
*               /*                                                   */ 02776000
*               /*****************************************************/ 02777000
*                                                                  0791 02778000
*               DO N = CVSL TO 1 BY -1 WHILE ALIGNBUF(N) = ' ';    0791 02779000
         L     @04,CVSL                                            0791 02780000
         LR    N,@04                                               0791 02781000
         B     @DE00791                                            0791 02782000
@DL00791 LA    @04,ALIGNBUF-1(N)                                   0791 02783000
         CLI   0(@04),C' '                                         0791 02784000
         BNE   @DC00791                                            0791 02785000
*               END;                                       /*@OZ05939*/ 02786000
*                                                                  0792 02787000
         BCTR  N,0                                                 0792 02788000
@DE00791 LTR   N,N                                                 0792 02789000
         BP    @DL00791                                            0792 02790000
@DC00791 DS    0H                                                  0793 02791000
*               IF N = 0 THEN N = CVSL;                    /*@OZ24776*/ 02792000
*                                                                  0793 02793000
*                                                                  0793 02794000
         LTR   N,N                                                 0793 02795000
         BNZ   @RF00793                                            0793 02796000
         L     N,CVSL                                              0794 02797000
*               /*****************************************************/ 02798000
*               /*                                           @OZ05939*/ 02799000
*               /* MOVE LINE SEGMENT INTO PRINT BUFFER AND   @OZ05939*/ 02800000
*               /* UPDATE THE AUTO PRINT COLUMN.             @OZ05939*/ 02801000
*               /*                                           @OZ05939*/ 02802000
*               /*****************************************************/ 02803000
*               IF FMTAR = ON & N ^= CVSL                  /*@OZ05939*/ 02804000
*                 THEN                                     /*@OZ05939*/ 02805000
@RF00793 TM    FMTAR(FSADDR),B'00001000'                           0795 02806000
         BNO   @RF00795                                            0795 02807000
         L     @04,CVSL                                            0795 02808000
         CR    N,@04                                               0795 02809000
         BE    @RF00795                                            0795 02810000
*                   DO;                                    /*@OZ05939*/ 02811000
*                   CVPB(CVSL-(N-1) : CVSL) = ALIGNBUF;    /*@OZ05939*/ 02812000
         L     @06,CVSTA                                           0797 02813000
         LA    @03,1                                               0797 02814000
         SLR   @03,N                                               0797 02815000
         ALR   @03,@04                                             0797 02816000
         ST    @03,@TF00001                                        0797 02817000
         ALR   @03,@06                                             0797 02818000
         BCTR  @03,0                                               0797 02819000
         LR    @15,@04                                             0797 02820000
         SL    @15,@TF00001                                        0797 02821000
         EX    @15,@SM01048                                        0797 02822000
*                   PCTAPC = (CVSTA + CVSL -ADDR(PRTBUFF));/*@OZ05939*/ 02823000
         ALR   @06,@04                                             0798 02824000
         SL    @06,PRTBUFPT                                        0798 02825000
         STH   @06,PCTAPC(,PCTPTR)                                 0798 02826000
*                   END;                                   /*@OZ05939*/ 02827000
*                 ELSE                                     /*@OZ05939*/ 02828000
*                   DO;                                    /*@OZ05939*/ 02829000
         B     @RC00795                                            0800 02830000
@RF00795 DS    0H                                                  0801 02831000
*                   CVPB(1:CVSL) = ALIGNBUF;               /*@OZ05939*/ 02832000
         L     @06,CVSTA                                           0801 02833000
         L     @04,CVSL                                            0801 02834000
         BCTR  @04,0                                               0801 02835000
         EX    @04,@SM01050                                        0801 02836000
*                   PCTAPC = (CVSTA +N) - ADDR(PRTBUFF);   /*@OZ05939*/ 02837000
         ALR   @06,N                                               0802 02838000
         SL    @06,PRTBUFPT                                        0802 02839000
         STH   @06,PCTAPC(,PCTPTR)                                 0802 02840000
*                   END;                                   /*@OZ05939*/ 02841000
*                                                                  0803 02842000
*             END;                                                 0804 02843000
*                                                                  0804 02844000
@RC00795 DS    0H                                                  0805 02845000
*         /***********************************************************/ 02846000
*         /*                                                         */ 02847000
*         /* IF PCTPMN = -1 THEN THIS IS A MESSAGE LINE.  CONVERT    */ 02848000
*         /* THE MESSAGE NUMBER TO BINARY AND PUT IT BACK INTO PCTPMN*/ 02849000
*         /*                                                         */ 02850000
*         /***********************************************************/ 02851000
*                                                                  0805 02852000
*         IF PCTPMN = -1                                           0805 02853000
*           THEN                                                   0805 02854000
@RC00765 CLC   PCTPMN(2,PCTPTR),@CH00900                           0805 02855000
         BNE   @RF00805                                            0805 02856000
*             DO;                                                  0806 02857000
*               MSGNO = PRTBUFF(5:7);                              0807 02858000
         L     @06,PRTBUFPT                                        0807 02859000
         MVC   MSGNO(3),PRTBUFF+4(@06)                             0807 02860000
*               GEN   (PACK  UNPKWD,MSGNO);                        0808 02861000
         PACK  UNPKWD,MSGNO                                             02862000
*               GEN   (CVB   CVDREG,UNPKWD);                       0809 02863000
         CVB   CVDREG,UNPKWD                                            02864000
*               PCTPMN = CVDREG;                                   0810 02865000
         STH   CVDREG,PCTPMN(,PCTPTR)                              0810 02866000
*             END;                                                 0811 02867000
*                                                                  0811 02868000
*         /***********************************************************/ 02869000
*         /*                                                         */ 02870000
*         /* CLEAN UP AND END THE EBCDIC PRINT PROCEDURE.            */ 02871000
*         /*                                                         */ 02872000
*         /***********************************************************/ 02873000
*                                                                  0812 02874000
*         RETURN CODE (0);                                         0812 02875000
*                                                                  0812 02876000
@RF00805 SLR   @15,@15                                             0812 02877000
         L     @14,@SA00010                                        0812 02878000
         LM    @00,@06,@SA00010+8                                  0812 02879000
         LM    @08,@12,@SA00010+36                                 0812 02880000
         BR    @14                                                 0812 02881000
*         END EBCDIC;                                              0813 02882000
*         /***********************************************************/ 02883000
*         /*                                                         */ 02884000
*         /* PROCEDURE NAME - PACKED TO UNPACKED DECIMAL CONVERSION. */ 02885000
*         /*                                                         */ 02886000
*         /* FUNCTION - THIS PROCEDURE CONVERTS PACKED TO UNPACKED   */ 02887000
*         /* DECIMAL DATA. IT IS CALLED BY THE BINARY TO DECIMAL     */ 02888000
*         /* PROCEDURE IN ADDITION TO HANDLING STRAIGHT PACKED TO    */ 02889000
*         /* UNPACKED.  IT IS, THEREFORE USED TO HANDLE ALL SIGN     */ 02890000
*         /* CONTROL, LEFT ALIGNMENT AND ZERO SUPPRESSION.           */ 02891000
*         /*                                                         */ 02892000
*         /* INPUT - THE INPUT DATA POINTER, DATA LENGTH, OUTPUT     */ 02893000
*         /* PRINT POSITION POINTER, ALIGN LEFT FLAG, ZERO SUPPRESS  */ 02894000
*         /* FLAG AND SIGN SUPPRESS FLAG.                            */ 02895000
*         /*                                                         */ 02896000
*         /* OUTPUT - CONVERTED DATA IN THE PRINT LINE.  PRINT LINE  */ 02897000
*         /* OVERFLOW DOES NOT OCCUR ON PACKED TO UNPACKED CONVERTS. */ 02898000
*         /* IF THE CONDITION OCCURS, THE DATA OUT IS TRUNCATED.     */ 02899000
*         /*                                                         */ 02900000
*         /***********************************************************/ 02901000
*                                                                  0814 02902000
*PUPCONV: PROC;                                                    0814 02903000
*                                                                  0814 02904000
PUPCONV  STM   @14,@06,12(@13)                                     0814 02905000
         STM   @08,@12,52(@13)                                     0814 02906000
*         PLOVF = OFF;                  /* OVERFLOW NOT ALLOWED.     */ 02907000
         NI    PLOVF,B'01111111'                                   0815 02908000
*         SETRC = 0;                                               0816 02909000
*                                                                  0816 02910000
         SLR   SETRC,SETRC                                         0816 02911000
*         /***********************************************************/ 02912000
*         /*                                                         */ 02913000
*         /* INITIALIZE COUNTERS USED FOR PACKED TO UNPACKED.        */ 02914000
*         /* INITIALIZE FLAGS TO CONTROL ZERO SUPPRESS & LEFT ALIGN  */ 02915000
*         /*                                                         */ 02916000
*         /***********************************************************/ 02917000
*                                                                  0817 02918000
*         PUPOCT = 1;                                              0817 02919000
         LA    @15,1                                               0817 02920000
         STH   @15,PUPOCT                                          0817 02921000
*         PUPPSC = 1;                                              0818 02922000
         LR    PUPPSC,@15                                          0818 02923000
*         IF CVPZS = OFF                /* IS IT ZERO SUPPRESS.      */ 02924000
*           THEN                                                   0819 02925000
         TM    CVPZS,B'10000000'                                   0819 02926000
         BNZ   @RF00819                                            0819 02927000
*             PUPPSF = ON;              /* SET TO PRINT ZEROS.       */ 02928000
         OI    PUPPSF,B'01000000'                                  0820 02929000
*           ELSE                                                   0821 02930000
*             PUPPSF = OFF;             /* SET TO SUPPRESS ZEROS.    */ 02931000
         B     @RC00819                                            0821 02932000
@RF00819 NI    PUPPSF,B'10111111'                                  0821 02933000
*         IF CVPAL = OFF                /* IS IT ALIGN LEFT.         */ 02934000
*           THEN                                                   0822 02935000
@RC00819 TM    CVPAL,B'01000000'                                   0822 02936000
         BNZ   @RF00822                                            0822 02937000
*             PUPIOF = ON;              /* SUPPRESS OUTPUT POINTER   */ 02938000
         OI    PUPIOF,B'00100000'                                  0823 02939000
*                                       /* STEPPING IF IT IS.        */ 02940000
*           ELSE                                                   0824 02941000
*             PUPIOF = OFF;             /* ALLOW OUTPUT PTR STEPPING */ 02942000
*                                                                  0824 02943000
         B     @RC00822                                            0824 02944000
@RF00822 NI    PUPIOF,B'11011111'                                  0824 02945000
*         /***********************************************************/ 02946000
*         /*                                                         */ 02947000
*         /* BEGIN THE CONVERSION LOOP HERE.                         */ 02948000
*         /*                                                         */ 02949000
*         /***********************************************************/ 02950000
*                                                                  0825 02951000
*         OLDERID2 = NEWERID2;                                     0825 02952000
@RC00822 L     @15,GDTTR2(,GDTPR)                                  0825 02953000
         MVC   @TS00001(95),NEWERID2(@15)                          0825 02954000
         MVC   OLDERID2(95,@15),@TS00001                           0825 02955000
*         NEWID2 = 'TP2D';                                         0826 02956000
         MVC   NEWID2(4,@15),@CC00961                              0826 02957000
*         IF CVPPU = ON                                            0827 02958000
*           THEN                                                   0827 02959000
         TM    CVPPU,B'00001000'                                   0827 02960000
         BNO   @RF00827                                            0827 02961000
*             FMSIL = CVPIL;            /* SET PACKED TO UNPACKED    */ 02962000
         L     FMSIL,CVPIL                                         0828 02963000
*                                       /* LENGTH FIELD.             */ 02964000
*                                                                  0829 02965000
*         /***********************************************************/ 02966000
*         /*                                                         */ 02967000
*         /* SET UP THE SIGN UNDER CONTROL OF THE SIGN SUPPRESS FLAG */ 02968000
*         /* IN THE INPUT PARAMETERS.                                */ 02969000
*         /*                                                         */ 02970000
*         /***********************************************************/ 02971000
*                                                                  0829 02972000
*         IF CVPSS = OFF                /* IS SIGN SUPPRESS OFF.     */ 02973000
*           THEN                                                   0829 02974000
@RF00827 TM    CVPSS,B'00100000'                                   0829 02975000
         BNZ   @RF00829                                            0829 02976000
*             DO;                                                  0830 02977000
*               SIGNT = (TRBUF(FMSIL) & '0F'X);                    0831 02978000
         LA    SIGNT,15                                            0831 02979000
         L     @07,FMRIP                                           0831 02980000
         BCTR  @07,0                                               0831 02981000
         SLR   @15,@15                                             0831 02982000
         IC    @15,TRBUF(FMSIL,@07)                                0831 02983000
         NR    SIGNT,@15                                           0831 02984000
*                                       /* GET THE SIGN.             */ 02985000
*               IF SIGNT = 11 | SIGNT = 13                         0832 02986000
*                                       /* IF IT IS EITHER, MINUS.   */ 02987000
*                 THEN                                             0832 02988000
         C     SIGNT,@CF00033                                      0832 02989000
         BE    @RT00832                                            0832 02990000
         C     SIGNT,@CF00962                                      0832 02991000
         BNE   @RF00832                                            0832 02992000
@RT00832 DS    0H                                                  0833 02993000
*                   SIGN = MINUS;       /* SET THE MINUS SIGN.       */ 02994000
         MVI   SIGN,C'-'                                           0833 02995000
*                 ELSE                                             0834 02996000
*                   SIGN = PLUS;        /* SET THE PLUS SIGN.        */ 02997000
         B     @RC00832                                            0834 02998000
@RF00832 MVI   SIGN,C'+'                                           0834 02999000
*               PUPPSC = PUPPSC + 1;    /* STEP PRINT BUFF PTR.      */ 03000000
@RC00832 AL    PUPPSC,@CF00216                                     0835 03001000
*             END;                                                 0836 03002000
*                                                                  0836 03003000
*         DO N = 1 TO FMSIL BY 1;                                  0837 03004000
*                                                                  0837 03005000
@RF00829 LA    N,1                                                 0837 03006000
         B     @DE00837                                            0837 03007000
@DL00837 DS    0H                                                  0838 03008000
*           /*********************************************************/ 03009000
*           /*                                                       */ 03010000
*           /* GET THE HIGH ORDER HALF BYTE AND CHECK FOR A VALID    */ 03011000
*           /* PACKED DECIMAL DIGIT.                                 */ 03012000
*           /*                                                       */ 03013000
*           /*********************************************************/ 03014000
*                                                                  0838 03015000
*           DECT = TRBUF(N)/16;         /* GET HIGH ORDER HALF CHAR  */ 03016000
         L     @01,FMRIP                                           0838 03017000
         BCTR  @01,0                                               0838 03018000
         SLR   DECT,DECT                                           0838 03019000
         IC    DECT,TRBUF(N,@01)                                   0838 03020000
         SRL   DECT,4                                              0838 03021000
*           IF DECT > 9                 /* COMPARE TO MAXIMUM.       */ 03022000
*             THEN                                                 0839 03023000
*                                                                  0839 03024000
         C     DECT,@CF00953                                       0839 03025000
         BNH   @RF00839                                            0839 03026000
*             /*******************************************************/ 03027000
*             /*                                                     */ 03028000
*             /* RETURN TO THE CALLER ON A NON-VALID PACKED DECIMAL  */ 03029000
*             /* DECIMAL DIGIT.                                      */ 03030000
*             /*                                                     */ 03031000
*             /*******************************************************/ 03032000
*                                                                  0840 03033000
*               DO;                                                0840 03034000
*                 RETURN CODE (8);                                 0841 03035000
         LA    @15,8                                               0841 03036000
         L     @14,12(,@13)                                        0841 03037000
         LM    @00,@06,20(@13)                                     0841 03038000
         LM    @08,@12,52(@13)                                     0841 03039000
         BR    @14                                                 0841 03040000
*               END;                                               0842 03041000
*                                                                  0842 03042000
*             /*******************************************************/ 03043000
*             /*                                                     */ 03044000
*             /* MOVE THIS HALF BYTE TO THE OUTPUT BUFFER.           */ 03045000
*             /* UNDER CONTROL OF THE ALIGN LEFT AND ZERO SUPPRESS   */ 03046000
*             /* CONTROL FLAGS.                                      */ 03047000
*             /*                                                     */ 03048000
*             /*******************************************************/ 03049000
*                                                                  0843 03050000
*             IF DECT ^= 0              /* IS IT NON ZERO            */ 03051000
*               THEN                                               0843 03052000
@RF00839 LTR   DECT,DECT                                           0843 03053000
         BZ    @RF00843                                            0843 03054000
*                 DO;                                              0844 03055000
*                   PUPPSF = ON;        /* TURN PRINT START ON.      */ 03056000
*                   PUPIOF = ON;        /* TURN OUTPUT STEP ON.      */ 03057000
         OI    PUPPSF,B'01100000'                                  0846 03058000
*                 END;                                             0847 03059000
*             IF FMSIL*2 - PUPOCT <=CVPOL                          0848 03060000
*                                      /* CHECK OUTPUT START.        */ 03061000
*               THEN                                               0848 03062000
@RF00843 LR    @15,FMSIL                                           0848 03063000
         ALR   @15,@15                                             0848 03064000
         SH    @15,PUPOCT                                          0848 03065000
         C     @15,CVPOL                                           0848 03066000
         BH    @RF00848                                            0848 03067000
*                 DO;                                              0849 03068000
*                   IF PUPPSF = ON     /* IS PRINT START ON         */  03069000
*                     THEN                                         0850 03070000
         TM    PUPPSF,B'01000000'                                  0850 03071000
         BNO   @RF00850                                            0850 03072000
*                       DO;                                        0851 03073000
*                         CVPB(PUPPSC) = BHTRTB(DECT+1);           0852 03074000
         L     @15,CVSTA                                           0852 03075000
         LR    @14,@15                                             0852 03076000
         ALR   @14,PUPPSC                                          0852 03077000
         BCTR  @14,0                                               0852 03078000
         LA    @01,BHTRTB(DECT)                                    0852 03079000
         MVC   CVPB(1,@14),0(@01)                                  0852 03080000
*                                       /* MOVE CONVERTED DIGIT.     */ 03081000
*                         IF SIGNPOS = OFF & CVPSS = OFF           0853 03082000
*                           THEN                                   0853 03083000
         TM    SIGNPOS,B'00010000'                                 0853 03084000
         BNZ   @RF00853                                            0853 03085000
         TM    CVPSS,B'00100000'                                   0853 03086000
         BNZ   @RF00853                                            0853 03087000
*                             DO;                                  0854 03088000
*                                                                  0854 03089000
*                             /***************************************/ 03090000
*                             /*                                     */ 03091000
*                             /* MOVE SIGN TO BUFFER.                */ 03092000
*                             /*                                     */ 03093000
*                             /***************************************/ 03094000
*                                                                  0855 03095000
*                               PUPPSC=PUPPSC-1;                   0855 03096000
         BCTR  PUPPSC,0                                            0855 03097000
*                               CVPB(PUPPSC) = SIGN;               0856 03098000
         ALR   @15,PUPPSC                                          0856 03099000
         BCTR  @15,0                                               0856 03100000
         MVC   CVPB(1,@15),SIGN                                    0856 03101000
*                               PUPPSC=PUPPSC+1;                   0857 03102000
         AL    PUPPSC,@CF00216                                     0857 03103000
*                               SIGNPOS = ON;                      0858 03104000
         OI    SIGNPOS,B'00010000'                                 0858 03105000
*                             END;                                 0859 03106000
*                       END;                                       0860 03107000
@RF00853 DS    0H                                                  0861 03108000
*                   IF PUPIOF = ON      /* CAN OUTPUT PTR BE STEPPED */ 03109000
*                     THEN                                         0861 03110000
@RF00850 TM    PUPIOF,B'00100000'                                  0861 03111000
         BNO   @RF00861                                            0861 03112000
*                       PUPPSC = PUPPSC + 1;                       0862 03113000
         AL    PUPPSC,@CF00216                                     0862 03114000
*                   IF CVSTA + PUPPSC > ADDR(PRTBUFF) + PCTPLW     0863 03115000
*                                       /* IS IT END OF LINE.        */ 03116000
*                     THEN                                         0863 03117000
@RF00861 LR    @06,PUPPSC                                          0863 03118000
         AL    @06,CVSTA                                           0863 03119000
         L     @15,PRTBUFPT                                        0863 03120000
         AL    @15,PCTPLW(,PCTPTR)                                 0863 03121000
         CR    @06,@15                                             0863 03122000
         BNH   @RF00863                                            0863 03123000
*                       DO;                                        0864 03124000
*                         OLDERID2 = NEWERID2;                     0865 03125000
         L     @06,GDTTR2(,GDTPR)                                  0865 03126000
         MVC   @TS00001(95),NEWERID2(@06)                          0865 03127000
         MVC   OLDERID2(95,@06),@TS00001                           0865 03128000
*                         NEWID2 = 'TP2O';                         0866 03129000
         MVC   NEWID2(4,@06),@CC00963                              0866 03130000
*                         RETURN CODE(0);                          0867 03131000
         SLR   @15,@15                                             0867 03132000
         L     @14,12(,@13)                                        0867 03133000
         LM    @00,@06,20(@13)                                     0867 03134000
         LM    @08,@12,52(@13)                                     0867 03135000
         BR    @14                                                 0867 03136000
*                       END;                                       0868 03137000
*                 END;                                             0869 03138000
@RF00863 DS    0H                                                  0870 03139000
*           PUPOCT = PUPOCT + 1;                                   0870 03140000
*                                                                  0870 03141000
@RF00848 LH    @01,PUPOCT                                          0870 03142000
         LA    @01,1(,@01)                                         0870 03143000
         STH   @01,PUPOCT                                          0870 03144000
*           /*********************************************************/ 03145000
*           /*                                                       */ 03146000
*           /* GET THE LOW ORDER HALF BYTE OF THE INPUT BYTE.        */ 03147000
*           /* IF THIS IS THE LAST BYTE, THIS WILL BE THE SIGN.      */ 03148000
*           /* IF THIS IS THE CASE, IGNORE IT & TERMINATE.           */ 03149000
*           /* IF THIS IS ANY OTHER THAN THE LAST BYTE, CHECK IT FOR */ 03150000
*           /* VALIDITY.                                             */ 03151000
*           /*                                                       */ 03152000
*           /*********************************************************/ 03153000
*                                                                  0871 03154000
*           DECT = TRBUF(N) & '0F'X;                               0871 03155000
         LA    DECT,15                                             0871 03156000
         L     @01,FMRIP                                           0871 03157000
         BCTR  @01,0                                               0871 03158000
         SLR   @00,@00                                             0871 03159000
         IC    @00,TRBUF(N,@01)                                    0871 03160000
         NR    DECT,@00                                            0871 03161000
*           IF DECT > 9                 /* IS IT A VALID PACK DIGIT  */ 03162000
*             THEN                                                 0872 03163000
         C     DECT,@CF00953                                       0872 03164000
         BNH   @RF00872                                            0872 03165000
*               DO;                                                0873 03166000
*                 IF N = FMSIL          /* IF NOT, IS IT A SIGN.     */ 03167000
*                   THEN;                                          0874 03168000
         CR    N,FMSIL                                             0874 03169000
         BE    @RT00874                                            0874 03170000
*                   ELSE                                           0876 03171000
*                     DO;               /* IF NEITHER THEN ERROR RET */ 03172000
*                       OLDERID2 = NEWERID2;                       0877 03173000
         L     @06,GDTTR2(,GDTPR)                                  0877 03174000
         MVC   @TS00001(95),NEWERID2(@06)                          0877 03175000
         MVC   OLDERID2(95,@06),@TS00001                           0877 03176000
*                       NEWID2 = 'TP2I';                           0878 03177000
         MVC   NEWID2(4,@06),@CC00933                              0878 03178000
*                       RETURN CODE (8);                           0879 03179000
         LA    @15,8                                               0879 03180000
         L     @14,12(,@13)                                        0879 03181000
         LM    @00,@06,20(@13)                                     0879 03182000
         LM    @08,@12,52(@13)                                     0879 03183000
         BR    @14                                                 0879 03184000
*                     END;                                         0880 03185000
*               END;                                               0881 03186000
*                                                                  0881 03187000
@RT00874 DS    0H                                                  0882 03188000
*           /*********************************************************/ 03189000
*           /*                                                       */ 03190000
*           /* MOVE THE LOW ORDER HALF BYTE TO THE OUTPUT BUFFER.    */ 03191000
*           /* UNDER CONTROL OF THE ALIGN LEFT AND ZERO SUPPRESS     */ 03192000
*           /* CONTROL FLAGS.                                        */ 03193000
*           /*                                                       */ 03194000
*           /*********************************************************/ 03195000
*                                                                  0882 03196000
*           IF N < FMSIL                /* CHECK FOR SIGN POSITION.  */ 03197000
*             THEN                                                 0882 03198000
@RF00872 CR    N,FMSIL                                             0882 03199000
         BNL   @RF00882                                            0882 03200000
*               DO;                                                0883 03201000
*                 IF DECT ^= 0          /* CHECK FIRST NON-ZERO.     */ 03202000
*                   THEN                                           0884 03203000
         LTR   DECT,DECT                                           0884 03204000
         BZ    @RF00884                                            0884 03205000
*                     DO;                                          0885 03206000
*                       PUPPSF = ON;    /* PRINT START ON.           */ 03207000
*                       PUPIOF = ON;    /* OUTPUT STEP ON.           */ 03208000
         OI    PUPPSF,B'01100000'                                  0887 03209000
*                     END;                                         0888 03210000
*                 IF FMSIL*2 - PUPOCT <= CVPOL                     0889 03211000
*                                      /* CHECK OUTPUT START.        */ 03212000
*                   THEN                                           0889 03213000
@RF00884 LR    @15,FMSIL                                           0889 03214000
         ALR   @15,@15                                             0889 03215000
         SH    @15,PUPOCT                                          0889 03216000
         C     @15,CVPOL                                           0889 03217000
         BH    @RF00889                                            0889 03218000
*                     DO;                                          0890 03219000
*                       IF PUPPSF = ON  /* IS PRINT START ON.        */ 03220000
*                         THEN                                     0891 03221000
         TM    PUPPSF,B'01000000'                                  0891 03222000
         BNO   @RF00891                                            0891 03223000
*                           DO;                                    0892 03224000
*                             CVPB(PUPPSC) = BHTRTB(DECT + 1);     0893 03225000
         L     @15,CVSTA                                           0893 03226000
         LR    @14,@15                                             0893 03227000
         ALR   @14,PUPPSC                                          0893 03228000
         BCTR  @14,0                                               0893 03229000
         LA    @01,BHTRTB(DECT)                                    0893 03230000
         MVC   CVPB(1,@14),0(@01)                                  0893 03231000
*                                       /* MOVE THE CHARACTER.       */ 03232000
*                             IF SIGNPOS = OFF & CVPSS = OFF       0894 03233000
*                               THEN                               0894 03234000
         TM    SIGNPOS,B'00010000'                                 0894 03235000
         BNZ   @RF00894                                            0894 03236000
         TM    CVPSS,B'00100000'                                   0894 03237000
         BNZ   @RF00894                                            0894 03238000
*                                 DO;   /* SET THE SIGN.             */ 03239000
*                                   PUPPSC=PUPPSC-1;               0896 03240000
         BCTR  PUPPSC,0                                            0896 03241000
*                                   CVPB(PUPPSC) = SIGN;           0897 03242000
         ALR   @15,PUPPSC                                          0897 03243000
         BCTR  @15,0                                               0897 03244000
         MVC   CVPB(1,@15),SIGN                                    0897 03245000
*                                   PUPPSC=PUPPSC+1;               0898 03246000
         AL    PUPPSC,@CF00216                                     0898 03247000
*                                   SIGNPOS = ON;                  0899 03248000
         OI    SIGNPOS,B'00010000'                                 0899 03249000
*                                 END;                             0900 03250000
*                           END;                                   0901 03251000
@RF00894 DS    0H                                                  0902 03252000
*                       IF PUPIOF = ON                             0902 03253000
*                         THEN                                     0902 03254000
@RF00891 TM    PUPIOF,B'00100000'                                  0902 03255000
         BNO   @RF00902                                            0902 03256000
*                           PUPPSC = PUPPSC + 1;                   0903 03257000
         AL    PUPPSC,@CF00216                                     0903 03258000
*                       IF CVSTA + PUPPSC > ADDR(PRTBUFF) + PCTPLW + 1  03259000
*                                       /* IS IT END OF PRINT LINE   */ 03260000
*                         THEN                                     0904 03261000
@RF00902 LR    @06,PUPPSC                                          0904 03262000
         AL    @06,CVSTA                                           0904 03263000
         L     @15,PRTBUFPT                                        0904 03264000
         AL    @15,PCTPLW(,PCTPTR)                                 0904 03265000
         AL    @15,@CF00216                                        0904 03266000
         CR    @06,@15                                             0904 03267000
         BNH   @RF00904                                            0904 03268000
*                           DO;                                    0905 03269000
*                             OLDERID2 = NEWERID2;                 0906 03270000
         L     @06,GDTTR2(,GDTPR)                                  0906 03271000
         MVC   @TS00001(95),NEWERID2(@06)                          0906 03272000
         MVC   OLDERID2(95,@06),@TS00001                           0906 03273000
*                             NEWID2 = 'TP2V';                     0907 03274000
         MVC   NEWID2(4,@06),@CC00964                              0907 03275000
*                             RETURN CODE(0);                      0908 03276000
         SLR   @15,@15                                             0908 03277000
         L     @14,12(,@13)                                        0908 03278000
         LM    @00,@06,20(@13)                                     0908 03279000
         LM    @08,@12,52(@13)                                     0908 03280000
         BR    @14                                                 0908 03281000
*                           END;                                   0909 03282000
*                     END;                                         0910 03283000
@RF00904 DS    0H                                                  0911 03284000
*               END;                                               0911 03285000
@RF00889 DS    0H                                                  0912 03286000
*             PUPOCT = PUPOCT + 1;                                 0912 03287000
@RF00882 LH    @06,PUPOCT                                          0912 03288000
         LA    @06,1(,@06)                                         0912 03289000
         STH   @06,PUPOCT                                          0912 03290000
*         END;                                                     0913 03291000
*                                                                  0913 03292000
         AL    N,@CF00216                                          0913 03293000
@DE00837 CR    N,FMSIL                                             0913 03294000
         BNH   @DL00837                                            0913 03295000
*         /***********************************************************/ 03296000
*         /*                                                 @Y30LSJK*/ 03297000
*         /* SET ZERO IN ALL ZERO FIELD. IF ZERO SUPPRESS    @Y30LSJK*/ 03298000
*         /* AND NO NONZERO DIGITS FOUND.                    @Y30LSJK*/ 03299000
*         /*                                                 @Y30LSJK*/ 03300000
*         /***********************************************************/ 03301000
*         IF CVPZS = ON & PUPPSF = OFF                             0914 03302000
*           THEN                                                   0914 03303000
         TM    CVPZS,B'10000000'                                   0914 03304000
         BNO   @RF00914                                            0914 03305000
         TM    PUPPSF,B'01000000'                                  0914 03306000
         BNZ   @RF00914                                            0914 03307000
*             IF CVPAL = OFF                                       0915 03308000
*               THEN                                               0915 03309000
         TM    CVPAL,B'01000000'                                   0915 03310000
         BNZ   @RF00915                                            0915 03311000
*                 CVPB(CVSL) = '0';     /* SET ZERO IN ALL ZERO FIELD*/ 03312000
         L     @04,CVSTA                                           0916 03313000
         AL    @04,CVSL                                            0916 03314000
         BCTR  @04,0                                               0916 03315000
         MVI   CVPB(@04),C'0'                                      0916 03316000
*               ELSE                                               0917 03317000
*                 CVPB(1) = '0';                           /*@Y30LSJK*/ 03318000
*                                                                  0917 03319000
         B     @RC00915                                            0917 03320000
@RF00915 L     @04,CVSTA                                           0917 03321000
         MVI   CVPB(@04),C'0'                                      0917 03322000
*         /***********************************************************/ 03323000
*         /*                                                 @Y30LSJK*/ 03324000
*         /* LOCATE THE LAST NON BLANK CHARACTER AND SET THE @Y30LSJK*/ 03325000
*         /* OFFSET FOR BLANK SUPPRESSION.  IF ENTIRE FIELD  @OZ24776*/ 03326000
*         /* IS BLANKS THEN PRINT A BLANK FIELD.             @OZ24776*/ 03327000
*         /*                                                 @Y30LSJK*/ 03328000
*         /***********************************************************/ 03329000
*                                                                  0918 03330000
*         DO N = CVSL TO 1 BY -1 WHILE CVPB(N) = ' ';      /*@Y30LSJK*/ 03331000
@RC00915 DS    0H                                                  0918 03332000
@RF00914 L     N,CVSL                                              0918 03333000
         B     @DE00918                                            0918 03334000
@DL00918 L     @06,CVSTA                                           0918 03335000
         ALR   @06,N                                               0918 03336000
         BCTR  @06,0                                               0918 03337000
         CLI   CVPB(@06),C' '                                      0918 03338000
         BNE   @DC00918                                            0918 03339000
*         END;                                             /*@Y30LSJK*/ 03340000
*                                                                  0919 03341000
         BCTR  N,0                                                 0919 03342000
@DE00918 LTR   N,N                                                 0919 03343000
         BP    @DL00918                                            0919 03344000
@DC00918 DS    0H                                                  0920 03345000
*         IF N = 0 THEN N = CVSL;                          /*@OZ24776*/ 03346000
*                                                                  0920 03347000
         LTR   N,N                                                 0920 03348000
         BNZ   @RF00920                                            0920 03349000
         L     N,CVSL                                              0921 03350000
*         PCTAPC = (CVSTA + N) - ADDR(PRTBUFF);            /*@Y30LSJK*/ 03351000
*                                                                  0922 03352000
@RF00920 LR    @06,N                                               0922 03353000
         AL    @06,CVSTA                                           0922 03354000
         SL    @06,PRTBUFPT                                        0922 03355000
         STH   @06,PCTAPC(,PCTPTR)                                 0922 03356000
*         /***********************************************************/ 03357000
*         /*                                                         */ 03358000
*         /* END OF THE PACKED TO UNPACKED DECIMAL CONVERSION.       */ 03359000
*         /*                                                         */ 03360000
*         /***********************************************************/ 03361000
*                                                                  0923 03362000
*         OLDERID2 = NEWERID2;                                     0923 03363000
         L     @06,GDTTR2(,GDTPR)                                  0923 03364000
         MVC   @TS00001(95),NEWERID2(@06)                          0923 03365000
         MVC   OLDERID2(95,@06),@TS00001                           0923 03366000
*         NEWID2 = 'TP2U';                                         0924 03367000
         MVC   NEWID2(4,@06),@CC00966                              0924 03368000
*         RETURN CODE (0);                                         0925 03369000
         SLR   @15,@15                                             0925 03370000
         L     @14,12(,@13)                                        0925 03371000
         LM    @00,@06,20(@13)                                     0925 03372000
         LM    @08,@12,52(@13)                                     0925 03373000
         BR    @14                                                 0925 03374000
*         END PUPCONV;                                             0926 03375000
*         /***********************************************************/ 03376000
*         /*                                                         */ 03377000
*         /* PROCEDURE NAME - BINARY TO DECIMAL CONVERSION.          */ 03378000
*         /*                                                         */ 03379000
*         /* FUNCTION - CONVERTS BINARY TO PACKED DECIMAL THEN CALLS */ 03380000
*         /* THE PACKED TO UNPACKED DECIMAL CONVERSION PROCEDURE TO  */ 03381000
*         /* CONVERT THE PACKED DECIMAL TO UNPACKED DECIMAL.         */ 03382000
*         /* THE CONVERT BINARY-TO-DECIMAL INSTRUCTION DOES  @OZ17059*/ 03383000
*         /* NOT HANDLE FOUR BYTE BINARY NUMBERS WITH THE    @OZ17059*/ 03384000
*         /* HIGH-ORDER BIT REPRESENTING DATA. IF THE VALUE  @OZ17059*/ 03385000
*         /* TO BE CONVERTED IS FOUR BYTES IN LENGTH, HAS THE@OZ17059*/ 03386000
*         /* HIGH-ORDER BIT ON AND THE SUPPRESS SIGN FLAG IS @OZ17059*/ 03387000
*         /* ON, THE HIGH-ORDER BIT IS TURNED OFF AND A      @OZ17059*/ 03388000
*         /* A PACKED DECIMAL VALUE IS ADDED TO THE VALUE    @OZ17059*/ 03389000
*         /* RETURNED BY THE CONVERT BINARY-TO-DECIMAL       @OZ17059*/ 03390000
*         /* INSTRUCTION.                                    @OZ17059*/ 03391000
*         /*                                                         */ 03392000
*         /* INPUT - THE INPUT DATA POINTER, DATA LENGTH AND PRINT   */ 03393000
*         /* POSITION ADDRESS.                                       */ 03394000
*         /*                                                         */ 03395000
*         /* OUTPUT - CONVERTED DECIMAL DATA IN THE PRINT LINE.      */ 03396000
*         /*                                                         */ 03397000
*         /***********************************************************/ 03398000
*                                                                  0927 03399000
*BDCONV:  PROC;                                                    0927 03400000
*                                                                  0927 03401000
BDCONV   STM   @14,@06,@SA00012                                    0927 03402000
         STM   @08,@12,@SA00012+36                                 0927 03403000
*         BDLEN = 5 - CVPIL;                                       0928 03404000
         L     @04,CVPIL                                           0928 03405000
         LA    @03,5                                               0928 03406000
         SLR   @03,@04                                             0928 03407000
         ST    @03,BDLEN                                           0928 03408000
*         HIORDRF = OFF;                /* SET THE HI-ORDER  @OZ17059*/ 03409000
         NI    HIORDRF,B'11110111'                                 0929 03410000
*                                       /* DATA FLAG.        @OZ17059*/ 03411000
*         IF CVPIL = 2                  /* IS INPUT HALF WORD.       */ 03412000
*           THEN                                                   0930 03413000
         C     @04,@CF00150                                        0930 03414000
         BNE   @RF00930                                            0930 03415000
*             DO;                       /* SET UP HALF WORD INPUT.   */ 03416000
*               BINHALFC(1:2) = CVPIADD ->TRBUF;                   0932 03417000
         L     @04,CVPIADD                                         0932 03418000
         MVC   BINHALFC(2),TRBUF(@04)                              0932 03419000
*               BINACC = BINHALF;                                  0933 03420000
         LH    @04,BINHALF                                         0933 03421000
         ST    @04,BINACC                                          0933 03422000
*             END;                                                 0934 03423000
*           ELSE                                                   0935 03424000
*             DO;                       /* SET UP OTHER LENGTH INPUT */ 03425000
         B     @RC00930                                            0935 03426000
@RF00930 DS    0H                                                  0936 03427000
*               BINACC = 0;                                        0936 03428000
         SLR   @04,@04                                             0936 03429000
         ST    @04,BINACC                                          0936 03430000
*               BINACCC(BDLEN:4) = CVPIADD ->TRBUF;                0937 03431000
*                                                                  0937 03432000
         L     @04,BDLEN                                           0937 03433000
         LA    @03,BINACCC-1(@04)                                  0937 03434000
         LCR   @04,@04                                             0937 03435000
         AL    @04,@CF00036                                        0937 03436000
         L     @01,CVPIADD                                         0937 03437000
         EX    @04,@SM01056                                        0937 03438000
*               /******************************************* @OZ17059*/ 03439000
*               /*                                           @OZ17059*/ 03440000
*               /* DETERMINE IF THE HIGH-ORDER BIT CONTAINS  @OZ17059*/ 03441000
*               /* DATA. DATA IS ASSUMED IF VALUE IS FOUR    @OZ17059*/ 03442000
*               /* BYTES LONG, THE HIGH-ORDER BIT IS ON AND  @OZ17059*/ 03443000
*               /* THE SUPPRESS SIGN FLAG IS ON.             @OZ17059*/ 03444000
*               /*                                           @OZ17059*/ 03445000
*               /******************************************* @OZ17059*/ 03446000
*                                                                  0938 03447000
*               IF BINACCC(1) > MAXPLUS /* IS HIGH-ORDER     @OZ17059*/ 03448000
*                 THEN                  /* BIT ON ?          @OZ17059*/ 03449000
         CLI   BINACCC,X'7F'                                       0938 03450000
         BNH   @RF00938                                            0938 03451000
*                   IF CVPSS = ON       /* SIGN SUPPRESS?    @OZ17059*/ 03452000
*                     THEN                                 /*@OZ17059*/ 03453000
         TM    CVPSS,B'00100000'                                   0939 03454000
         BNO   @RF00939                                            0939 03455000
*                       DO;                                /*@OZ17059*/ 03456000
*                       HIORDRF = ON;   /* SET HI-ORDER      @OZ17059*/ 03457000
         OI    HIORDRF,B'00001000'                                 0941 03458000
*                                       /* DATA BIT FLAG     @OZ17059*/ 03459000
*                       BINACCC(1) = BINACCC(1) & MAXPLUS; /*@OZ17059*/ 03460000
         NI    BINACCC,X'7F'                                       0942 03461000
*                                       /* CLEAR HIGH-ORDER  @OZ17059*/ 03462000
*                                       /* BIT               @OZ17059*/ 03463000
*                       END;                               /*@OZ17059*/ 03464000
*                     ELSE;                                /*@OZ17059*/ 03465000
@RF00939 DS    0H                                                  0945 03466000
*                 ELSE;                                    /*@OZ17059*/ 03467000
@RF00938 DS    0H                                                  0946 03468000
*             END;                                                 0946 03469000
*                                                                  0946 03470000
*GEN      (L   CVDREG,BINACC);                                     0947 03471000
@RC00930 DS    0H                                                  0947 03472000
         L   CVDREG,BINACC                                              03473000
*GEN      (CVD CVDREG,UNPKWD);                                     0948 03474000
*                                                                  0948 03475000
         CVD CVDREG,UNPKWD                                              03476000
*         /**************************************************@OZ17059*/ 03477000
*         /*                                                 @OZ17059*/ 03478000
*         /* IF THE HIGH-ORDER BIT CONTAINED DATA, IT MUST   @OZ17059*/ 03479000
*         /* BE ADDED TO THE CONVERTED DECIMAL VALUE. THE    @OZ17059*/ 03480000
*         /* DECIMAL EQUIVALENT MUST BE ADDED IN TWO PARTS   @OZ17059*/ 03481000
*         /* EQUAL TO HALF THE REQUIRED VALUE BECAUSE ONE    @OZ17059*/ 03482000
*         /* CONSTANT CANNOT BE DEFINED LARGE ENOUGH.        @OZ17059*/ 03483000
*         /*                                                 @OZ17059*/ 03484000
*         /**************************************************@OZ17059*/ 03485000
*                                                                  0949 03486000
*         IF HIORDRF = ON               /* HIGH-ORDER BIT    @OZ17059*/ 03487000
*           THEN                        /* CONTAINS DATA ?   @OZ17059*/ 03488000
         TM    HIORDRF,B'00001000'                                 0949 03489000
         BNO   @RF00949                                            0949 03490000
*             DO;                                          /*@OZ17059*/ 03491000
*             AP (UNPKWD,PKDECE);       /* ADD PACKED DECIMAL@OZ17059*/ 03492000
         AP    UNPKWD(8),@CB00879(8)                               0951 03493000
*             AP (UNPKWD,PKDECE);       /* EQUIVALEN OF      @OZ17059*/ 03494000
         AP    UNPKWD(8),@CB00879(8)                               0952 03495000
*             END;                      /* X'80000000' BACK  @OZ17059*/ 03496000
*           ELSE;                       /* IN TWO PARTS      @OZ17059*/ 03497000
*                                                                  0954 03498000
@RF00949 DS    0H                                                  0955 03499000
*         /***********************************************************/ 03500000
*         /*                                                         */ 03501000
*         /* SET UP THE PARAMETERS FOR THE CALL TO THE PACKED TO     */ 03502000
*         /* UNPACKED CONVERSION AND MAKE THE CALL TO THAT PROCEDURE */ 03503000
*         /*                                                         */ 03504000
*         /***********************************************************/ 03505000
*                                                                  0955 03506000
*         FMRIP = ADDR(UNPKWD);                                    0955 03507000
         LA    @06,UNPKWD                                          0955 03508000
         ST    @06,FMRIP                                           0955 03509000
*         FMSIL = 8;                                               0956 03510000
*                                                                  0956 03511000
         LA    FMSIL,8                                             0956 03512000
*         CALL PUPCONV;                                            0957 03513000
*                                                                  0957 03514000
         BAL   @14,PUPCONV                                         0957 03515000
*         RESPECIFY RTNREG RSTD;                                   0958 03516000
*         TESTRC = RTNREG;                                         0959 03517000
         STH   RTNREG,TESTRC                                       0959 03518000
*         RESPECIFY RTNREG UNRSTD;                                 0960 03519000
*         RETURN CODE (TESTRC);                                    0961 03520000
         LH    @06,TESTRC                                          0961 03521000
         LR    @15,@06                                             0961 03522000
         L     @14,@SA00012                                        0961 03523000
         LM    @00,@06,@SA00012+8                                  0961 03524000
         LM    @08,@12,@SA00012+36                                 0961 03525000
         BR    @14                                                 0961 03526000
*         END BDCONV;                                              0962 03527000
*         END CONVERT;                                             0963 03528000
*         /***********************************************************/ 03529000
*         /*                                                         */ 03530000
*         /* PROCEDURE NAME - DATA RETURN PROCEDURE.                 */ 03531000
*         /*                                                         */ 03532000
*         /* FUNCTION - THIS PROCEDURE RETURNS DATA TO A CALLER.     */ 03533000
*         /* THE DATA IS RETURNED TO THE AREA POINTED TO BY DARGRETP */ 03534000
*         /* TO THE LENGTH PROVIDED BY DARGRETC.  IF THE DATA LENGTH */ 03535000
*         /* TO BE FORMATTED IS LESS THAN THE COUNT IN DARGRETC THEN */ 03536000
*         /* THE AREA IS NOT PADDED WITH BLANKS.  IF DARGRETC IS LESS*/ 03537000
*         /* THAN THE THE LENGTH OF THE DATA TO BE FORMATTED, THEN   */ 03538000
*         /* FORMATTING IS STOPPED WHEN DARGRETC IS REACHED.  IN     */ 03539000
*         /* EITHER CASE, NO MESSAGE IS PRINTED OR ERROR CONDITION   */ 03540000
*         /* RETURNED.                                               */ 03541000
*         /*                                                         */ 03542000
*         /* INPUT - THE FULLY CONVERTED AND FORMATTED LINE IN THE   */ 03543000
*         /* PRINT ARGUMENT LIST (CVPSTRU).                          */ 03544000
*         /*                                                         */ 03545000
*         /* OUTPUT - THE RETURNED DATA IN THE AREA DESIGNATED BY    */ 03546000
*         /* THE CALLER.                                             */ 03547000
*         /*                                                         */ 03548000
*         /***********************************************************/ 03549000
*                                                                  0964 03550000
*LINERET: PROC;                                                    0964 03551000
*                                                                  0964 03552000
LINERET  STM   @14,@12,12(@13)                                     0964 03553000
*   OLDERID2 = NEWERID2;                                           0965 03554000
         L     @04,GDTTR2(,GDTPR)                                  0965 03555000
         MVC   @TS00001(95),NEWERID2(@04)                          0965 03556000
         MVC   OLDERID2(95,@04),@TS00001                           0965 03557000
*   NEWID2 = 'TPDR';                                               0966 03558000
*                                                                  0966 03559000
         MVC   NEWID2(4,@04),@CC00975                              0966 03560000
*         /***********************************************************/ 03561000
*         /*                                                         */ 03562000
*         /* RETURN THE FORMATTED LINE TO THE CALLER.                */ 03563000
*         /* RETLN IS USED TO CONTAIN THE LENGTH OF THE AREA TO BE   */ 03564000
*         /* MOVED.                                                  */ 03565000
*         /*                                                         */ 03566000
*         /***********************************************************/ 03567000
*                                                                  0967 03568000
*         IF CVPRETC > PCTPLW                                      0967 03569000
*           THEN                                                   0967 03570000
         LH    @04,CVPRETC                                         0967 03571000
         L     @03,PCTPLW(,PCTPTR)                                 0967 03572000
         CR    @04,@03                                             0967 03573000
         BNH   @RF00967                                            0967 03574000
*             DO;                                                  0968 03575000
*                                                                  0968 03576000
*             /*******************************************************/ 03577000
*             /*                                                     */ 03578000
*             /* SET THE SEGMENT LENGTH TO                           */ 03579000
*             /* MOVE AN ENTIRE LINE TO USERS DATA AREA.             */ 03580000
*             /*                                                     */ 03581000
*             /*******************************************************/ 03582000
*                                                                  0969 03583000
*               RETLN = PCTPLW;                                    0969 03584000
         ST    @03,RETLN                                           0969 03585000
*               CVPRETC = CVPRETC - PCTPLW;                        0970 03586000
         SLR   @04,@03                                             0970 03587000
         STH   @04,CVPRETC                                         0970 03588000
*             END;                                                 0971 03589000
*           ELSE                                                   0972 03590000
*             DO;                                                  0972 03591000
*                                                                  0972 03592000
         B     @RC00967                                            0972 03593000
@RF00967 DS    0H                                                  0973 03594000
*             /*******************************************************/ 03595000
*             /*                                                     */ 03596000
*             /* SET THE SEGMENT LENGTH TO                           */ 03597000
*             /* MOVE A PARTIAL LINE.                                */ 03598000
*             /*                                                     */ 03599000
*             /*******************************************************/ 03600000
*                                                                  0973 03601000
*               RETLN = CVPRETC;                                   0973 03602000
         LH    @04,CVPRETC                                         0973 03603000
         ST    @04,RETLN                                           0973 03604000
*               CVPRETC = 0;                                       0974 03605000
         SLR   @04,@04                                             0974 03606000
         STH   @04,CVPRETC                                         0974 03607000
*             END;                                                 0975 03608000
*         IF RETLN > 0                                             0976 03609000
*           THEN                                                   0976 03610000
@RC00967 L     @04,RETLN                                           0976 03611000
         LTR   @04,@04                                             0976 03612000
         BNP   @RF00976                                            0976 03613000
*             DO;                                                  0977 03614000
*                                                                  0977 03615000
*               /*****************************************************/ 03616000
*               /*                                                   */ 03617000
*               /* MOVE THE LINE SEGMENT TO THE USERS AREA.          */ 03618000
*               /*                                                   */ 03619000
*               /*****************************************************/ 03620000
*                                                                  0978 03621000
*               RETAREA(1:RETLN) = PRTBUFF;                        0978 03622000
         L     @03,CVPRETP                                         0978 03623000
         LR    @15,@04                                             0978 03624000
         BCTR  @15,0                                               0978 03625000
         L     @01,PRTBUFPT                                        0978 03626000
         EX    @15,@SM01058                                        0978 03627000
*               CVPRETP = CVPRETP + RETLN;                         0979 03628000
         ALR   @03,@04                                             0979 03629000
         ST    @03,CVPRETP                                         0979 03630000
*             END;                                                 0980 03631000
*             FFMFMTF = OFF;                                       0981 03632000
@RF00976 NI    FFMFMTF,B'11111110'                                 0981 03633000
*             PRTBUFF = ' ';                                       0982 03634000
*                                                                  0982 03635000
         L     @04,PRTBUFPT                                        0982 03636000
         MVI   PRTBUFF+1(@04),C' '                                 0982 03637000
         MVC   PRTBUFF+2(133,@04),PRTBUFF+1(@04)                   0982 03638000
         MVI   PRTBUFF(@04),C' '                                   0982 03639000
*         RETURN;                                                  0983 03640000
@EL00013 DS    0H                                                  0983 03641000
@EF00013 DS    0H                                                  0983 03642000
@ER00013 LM    @14,@12,12(@13)                                     0983 03643000
         BR    @14                                                 0983 03644000
*         END LINERET;                                             0984 03645000
*         /***********************************************************/ 03646000
*         /*                                                         */ 03647000
*         /* PROCEDURE NAME - LINE PRINT PROCEDURE.                  */ 03648000
*         /*                                                         */ 03649000
*         /* FUNCTION - MAINTAINS PAGE FORMATTING INFORMATION,       */ 03650000
*         /* PRINTING TITLE, HEADING AND FOOTING LINES AS REQUIRED   */ 03651000
*         /* AND PRINTS THE LINES REQUESTED.  THIS PROCEDURE IS      */ 03652000
*         /* ALSWAYS CALLED FROM THE MAIN FORMAT PROCEDURE OR FROM   */ 03653000
*         /* THE CONVERSION PROCEDURE.                               */ 03654000
*         /*                                                         */ 03655000
*         /* INPUT - THE CONVERSION/PRINT ARGUMENT LIST. (CVPSTRU)   */ 03656000
*         /*                                                         */ 03657000
*         /* OUTPUT - THE PRINTED PAGE.                              */ 03658000
*         /*                                                         */ 03659000
*         /***********************************************************/ 03660000
*                                                                  0985 03661000
*LINEPRT: PROC;                                                    0985 03662000
*                                                                  0985 03663000
LINEPRT  STM   @14,@06,@SA00014                                    0985 03664000
         STM   @08,@12,@SA00014+36                                 0985 03665000
*         /***********************************************************/ 03666000
*         /*                                                         */ 03667000
*         /* IF THE DATA IS TO BE RETURNED TO THE USER INSTEAD OF    */ 03668000
*         /* BEING PRINTED, CALL THE LINE RETURN PROCEDURE.          */ 03669000
*         /*                                                         */ 03670000
*         /***********************************************************/ 03671000
*                                                                  0986 03672000
*         IF CVPRETP ^= NULLPTR                                    0986 03673000
*           THEN                                                   0986 03674000
         L     @06,CVPRETP                                         0986 03675000
         LTR   @06,@06                                             0986 03676000
         BZ    @RF00986                                            0986 03677000
*             DO;                                                  0987 03678000
*                                                                  0987 03679000
*               CALL LINERET;                                      0988 03680000
*                                                                  0988 03681000
         BAL   @14,LINERET                                         0988 03682000
*               FFMFMTF = OFF;                                     0989 03683000
         NI    FFMFMTF,B'11111110'                                 0989 03684000
*               PRTBUFF = ' ';                                     0990 03685000
         L     @06,PRTBUFPT                                        0990 03686000
         MVI   PRTBUFF+1(@06),C' '                                 0990 03687000
         MVC   PRTBUFF+2(133,@06),PRTBUFF+1(@06)                   0990 03688000
         MVI   PRTBUFF(@06),C' '                                   0990 03689000
*               RETURN CODE(0);                                    0991 03690000
         SLR   @15,@15                                             0991 03691000
         L     @14,@SA00014                                        0991 03692000
         LM    @00,@06,@SA00014+8                                  0991 03693000
         LM    @08,@12,@SA00014+36                                 0991 03694000
         BR    @14                                                 0991 03695000
*             END;                                                 0992 03696000
*                                                                  0992 03697000
*         IF GDTDBG = NULLPTR                                      0993 03698000
*           THEN;                                                  0993 03699000
@RF00986 L     @06,GDTDBG(,GDTPR)                                  0993 03700000
         LTR   @06,@06                                             0993 03701000
         BZ    @RT00993                                            0993 03702000
*           ELSE                                                   0995 03703000
*             CALL IDCDB010 (GDTTBL,'TP3I');                       0995 03704000
*                                                                  0995 03705000
         ST    GDTPR,@AL00001                                      0995 03706000
         LA    @06,@CC00979                                        0995 03707000
         ST    @06,@AL00001+4                                      0995 03708000
         MVI   @AL00001+4,X'80'                                    0995 03709000
         L     @15,GDTDBG(,GDTPR)                                  0995 03710000
         LA    @01,@AL00001                                        0995 03711000
         BALR  @14,@15                                             0995 03712000
*         PRLINE = ' ';                 /* SET BUFFER TO     @Z40GSJG*/ 03713000
@RT00993 MVI   PRLINE+1,C' '                                       0996 03714000
         MVC   PRLINE+2(218),PRLINE+1                              0996 03715000
         MVI   PRLINE,C' '                                         0996 03716000
*         PRLINES = ' ';                /* BLANKS            @Z40GSJG*/ 03717000
         MVI   PRLINES+1,C' '                                      0997 03718000
         MVC   PRLINES+2(218),PRLINES+1                            0997 03719000
         MVI   PRLINES,C' '                                        0997 03720000
*         PRCC = PRCCON(2);             /* CARR CONT = SINGLE SPACE  */ 03721000
         MVC   PRCC(1),PRCCON+1                                    0998 03722000
*         SPFSAV = PRTSPF;              /* SAVE SPACING FACTOR       */ 03723000
*                                                                  0999 03724000
         LH    SPFSAV,PRTSPF                                       0999 03725000
*         /***********************************************************/ 03726000
*         /*                                                         */ 03727000
*         /* IF THE ALTERNATE PRINT FILE POINTER IS NULL AND THE     */ 03728000
*         /* ALTERNATE PRINT FILE FLAG IS ON THEN THE FILES MUST BE  */ 03729000
*         /* SWITCHED TO REFLECT THIS CHANGE.                        */ 03730000
*         /*                                                         */ 03731000
*         /***********************************************************/ 03732000
*                                                                  1000 03733000
*         IOCSPTR=PCTIOC;                                          1000 03734000
         L     IOCSPTR,PCTIOC(,PCTPTR)                             1000 03735000
*         IF PCTIOP = NULLPTR & PCTAPF = ON                        1001 03736000
*           THEN                                                   1001 03737000
         SLR   @04,@04                                             1001 03738000
         C     @04,PCTIOP(,PCTPTR)                                 1001 03739000
         BNE   @RF01001                                            1001 03740000
         TM    PCTAPF(PCTPTR),B'00001000'                          1001 03741000
         BNO   @RF01001                                            1001 03742000
*             DO;                                                  1002 03743000
*                                                                  1002 03744000
*               /*****************************************************/ 03745000
*               /*                                                   */ 03746000
*               /* IF PRINT LINES ARE IN THE BUFFER, FLUSH THE STACK */ 03747000
*               /* PRIOR TO CHANGING THE FILE POINTERS.              */ 03748000
*               /*                                                   */ 03749000
*               /*****************************************************/ 03750000
*                                                                  1003 03751000
*               IF PCTLNM ^= 0                                     1003 03752000
*                 THEN                                             1003 03753000
         CH    @04,PCTLNM(,PCTPTR)                                 1003 03754000
         BE    @RF01003                                            1003 03755000
*                   DO;                                            1004 03756000
*                     FFMPSFF = ON;                                1005 03757000
*                                                                  1005 03758000
         OI    FFMPSFF,B'00100000'                                 1005 03759000
*                     CALL STACKPUT (PRCC);                        1006 03760000
*                                                                  1006 03761000
         LA    @04,PRCC                                            1006 03762000
         ST    @04,@AL00001                                        1006 03763000
         LA    @01,@AL00001                                        1006 03764000
         BAL   @14,STACKPUT                                        1006 03765000
*                     RESPECIFY RTNREG RSTD;                       1007 03766000
*                     TESTRC = RTNREG;                             1008 03767000
         STH   RTNREG,TESTRC                                       1008 03768000
*                     RESPECIFY RTNREG UNRSTD;                     1009 03769000
*                     IF TESTRC ^= 0                               1010 03770000
*                       THEN                                       1010 03771000
         LH    @04,TESTRC                                          1010 03772000
         LTR   @04,@04                                             1010 03773000
         BZ    @RF01010                                            1010 03774000
*                         RETURN CODE(RCQUIT);                     1011 03775000
         LH    @15,RCQUIT                                          1011 03776000
         L     @14,@SA00014                                        1011 03777000
         LM    @00,@06,@SA00014+8                                  1011 03778000
         LM    @08,@12,@SA00014+36                                 1011 03779000
         BR    @14                                                 1011 03780000
*                   END;                                           1012 03781000
*                                                                  1012 03782000
@RF01010 DS    0H                                                  1013 03783000
*               /*****************************************************/ 03784000
*               /*                                                   */ 03785000
*               /* SWITCH THE IOCS PARMS TO THE STANDARD IOCS FILE.  */ 03786000
*               /*                                                   */ 03787000
*               /*****************************************************/ 03788000
*                                                                  1013 03789000
*               PCTLPL = PCTAPL;                                   1013 03790000
@RF01003 MVC   PCTLPL(4,PCTPTR),PCTAPL(PCTPTR)                     1013 03791000
*               PCTACT = PCTSTD;                                   1014 03792000
         MVC   PCTACT(8,PCTPTR),PCTSTD(PCTPTR)                     1014 03793000
*               PCTAPF = OFF;                                      1015 03794000
         NI    PCTAPF(PCTPTR),B'11110111'                          1015 03795000
*             END;                                                 1016 03796000
*                                                                  1016 03797000
*         /***********************************************************/ 03798000
*         /*                                                         */ 03799000
*         /* IF THE ALTERNATE PRINT FILE POINTER IS NOT NULL AND THE */ 03800000
*         /* ALTERNATE PRINT FILE FLAG IS OFF THEN THE FILES MUST BE */ 03801000
*         /* SWITCHED TO REFLECT THIS CHANGE.                        */ 03802000
*         /*                                                         */ 03803000
*         /***********************************************************/ 03804000
*                                                                  1017 03805000
*         IF PCTIOP ^= NULLPTR & PCTAPF = OFF                      1017 03806000
*           THEN                                                   1017 03807000
@RF01001 SLR   @04,@04                                             1017 03808000
         C     @04,PCTIOP(,PCTPTR)                                 1017 03809000
         BE    @RF01017                                            1017 03810000
         TM    PCTAPF(PCTPTR),B'00001000'                          1017 03811000
         BNZ   @RF01017                                            1017 03812000
*             DO;                                                  1018 03813000
*               /*****************************************************/ 03814000
*               /*                                                   */ 03815000
*               /* IF PRINT LINES ARE IN THE BUFFER, FLUSH THE STACK */ 03816000
*               /* PRIOR TO CHANGING THE FILE POINTERS.              */ 03817000
*               /*                                                   */ 03818000
*               /*****************************************************/ 03819000
*                                                                  1019 03820000
*               IF PCTLNM ^= 0                                     1019 03821000
*                 THEN                                             1019 03822000
         CH    @04,PCTLNM(,PCTPTR)                                 1019 03823000
         BE    @RF01019                                            1019 03824000
*                   DO;                                            1020 03825000
*                     FFMPSFF = ON;                                1021 03826000
*                                                                  1021 03827000
         OI    FFMPSFF,B'00100000'                                 1021 03828000
*                     CALL STACKPUT (PRCC);                        1022 03829000
*                                                                  1022 03830000
         LA    @04,PRCC                                            1022 03831000
         ST    @04,@AL00001                                        1022 03832000
         LA    @01,@AL00001                                        1022 03833000
         BAL   @14,STACKPUT                                        1022 03834000
*                     RESPECIFY RTNREG RSTD;                       1023 03835000
*                     TESTRC = RTNREG;                             1024 03836000
         STH   RTNREG,TESTRC                                       1024 03837000
*                     RESPECIFY RTNREG UNRSTD;                     1025 03838000
*                     IF TESTRC ^= 0                               1026 03839000
*                       THEN                                       1026 03840000
         LH    @06,TESTRC                                          1026 03841000
         LTR   @06,@06                                             1026 03842000
         BZ    @RF01026                                            1026 03843000
*                         RETURN CODE(RCQUIT);                     1027 03844000
         LH    @15,RCQUIT                                          1027 03845000
         L     @14,@SA00014                                        1027 03846000
         LM    @00,@06,@SA00014+8                                  1027 03847000
         LM    @08,@12,@SA00014+36                                 1027 03848000
         BR    @14                                                 1027 03849000
*                   END;                                           1028 03850000
*                                                                  1028 03851000
@RF01026 DS    0H                                                  1029 03852000
*               /*****************************************************/ 03853000
*               /*                                                   */ 03854000
*               /* SWITCH THE IOCS PARMS TO THE ALTERNATE IOCS FILE  */ 03855000
*               /*                                                   */ 03856000
*               /*****************************************************/ 03857000
*                                                                  1029 03858000
*               PCTSTD = PCTACT;                                   1029 03859000
@RF01019 MVC   PCTSTD(8,PCTPTR),PCTACT(PCTPTR)                     1029 03860000
*               PCTACT = PCTALT;                                   1030 03861000
         MVC   PCTACT(8,PCTPTR),PCTALT(PCTPTR)                     1030 03862000
*               PCTAPF = ON;                                       1031 03863000
         OI    PCTAPF(PCTPTR),B'00001000'                          1031 03864000
*             END;                                                 1032 03865000
*                                                                  1032 03866000
*         IOCSPTR = PCTIOC;             /* SET THE IOCS POINTER.     */ 03867000
@RF01017 L     IOCSPTR,PCTIOC(,PCTPTR)                             1033 03868000
*         NLISAV = PCTNLI;              /* SAVE THE NEXT LINE NUMBER */ 03869000
*                                                                  1034 03870000
         LH    @04,PCTNLI(,PCTPTR)                                 1034 03871000
         STH   @04,NLISAV                                          1034 03872000
*         /***********************************************************/ 03873000
*         /*                                                         */ 03874000
*         /* IF THE PREVIOUS LINE WAS A MESSAGE, ADD AN EXTRA SPACE  */ 03875000
*         /*                                                         */ 03876000
*         /***********************************************************/ 03877000
*                                                                  1035 03878000
*         IF PRTSPT = 'R' & PCTLLM = ON & PCTPMN = 0 & QSECMF = OFF     03879000
*           THEN                                                   1035 03880000
         CLI   PRTSPT,C'R'                                         1035 03881000
         BNE   @RF01035                                            1035 03882000
         TM    PCTLLM(PCTPTR),B'00010000'                          1035 03883000
         BNO   @RF01035                                            1035 03884000
         LH    @04,PCTPMN(,PCTPTR)                                 1035 03885000
         LTR   @04,@04                                             1035 03886000
         BNZ   @RF01035                                            1035 03887000
         L     @04,QENTP                                           1035 03888000
         TM    QSECMF(@04),B'00100000'                             1035 03889000
         BNZ   @RF01035                                            1035 03890000
*             DO;                                                  1036 03891000
*               SPFSAV = SPFSAV+1;                                 1037 03892000
         AL    SPFSAV,@CF00216                                     1037 03893000
*               PCTLLM = OFF;                                      1038 03894000
         NI    PCTLLM(PCTPTR),B'11101111'                          1038 03895000
*             END;                                                 1039 03896000
*                                                                  1039 03897000
*         /***********************************************************/ 03898000
*         /*                                                         */ 03899000
*         /* IF THIS IS AN INITIAL HEADER CHECK FOR SPACE FOR THE    */ 03900000
*         /* HEADING PLUS 1 PRINT LINE AND IF THIS MUCH SPACE IS     */ 03901000
*         /* NOT LEFT ON THIS PAGE, FORCE A PAGE OVERFLOW.           */ 03902000
*         /*                                                         */ 03903000
*         /***********************************************************/ 03904000
*                                                                  1040 03905000
*         IF PCTH1F = ON & (PCTNLI + PCTHSC) > PCTLDL              1040 03906000
*           THEN                                                   1040 03907000
@RF01035 TM    PCTH1F(PCTPTR),B'10000000'                          1040 03908000
         BNO   @RF01040                                            1040 03909000
         SLR   @04,@04                                             1040 03910000
         IC    @04,PCTHSC(,PCTPTR)                                 1040 03911000
         AH    @04,PCTNLI(,PCTPTR)                                 1040 03912000
         CH    @04,PCTLDL(,PCTPTR)                                 1040 03913000
         BNH   @RF01040                                            1040 03914000
*             PCTNLI = 999;                                        1041 03915000
         MVC   PCTNLI(2,PCTPTR),@CH00981                           1041 03916000
*         /***********************************************************/ 03917000
*         /*                                                         */ 03918000
*         /*  CONVERT ABSOLUTE TO RELATIVE SPACING IF NEEDED         */ 03919000
*         /*                                                         */ 03920000
*         /***********************************************************/ 03921000
*                                                                  1042 03922000
*         IF PRTSPT = 'A'                                          1042 03923000
*           THEN                                                   1042 03924000
@RF01040 CLI   PRTSPT,C'A'                                         1042 03925000
         BNE   @RF01042                                            1042 03926000
*             DO;                                                  1043 03927000
*               IF SPFSAV <= PCTLDL & SPFSAV >= PCTFDL             1044 03928000
*                 THEN                                             1044 03929000
         CH    SPFSAV,PCTLDL(,PCTPTR)                              1044 03930000
         BH    @RF01044                                            1044 03931000
         CH    SPFSAV,PCTFDL(,PCTPTR)                              1044 03932000
         BL    @RF01044                                            1044 03933000
*                   DO;                                            1045 03934000
*                     IF SPFSAV >= PCTNLI                          1046 03935000
*                       THEN                                       1046 03936000
         LH    @04,PCTNLI(,PCTPTR)                                 1046 03937000
         CR    SPFSAV,@04                                          1046 03938000
         BL    @RF01046                                            1046 03939000
*                         SPFSAV = SPFSAV + 1 - PCTNLI;            1047 03940000
         LA    @15,1                                               1047 03941000
         ALR   @15,SPFSAV                                          1047 03942000
         SLR   @15,@04                                             1047 03943000
         LR    SPFSAV,@15                                          1047 03944000
*                       ELSE                                       1048 03945000
*                         DO;                                      1048 03946000
         B     @RC01046                                            1048 03947000
@RF01046 DS    0H                                                  1049 03948000
*                           SPFSAV = 1;                            1049 03949000
         LA    SPFSAV,1                                            1049 03950000
*                           PCTNLI = 999;                          1050 03951000
         MVC   PCTNLI(2,PCTPTR),@CH00981                           1050 03952000
*                         END;                                     1051 03953000
*                   END;                                           1052 03954000
*                                                                  1052 03955000
*         /***********************************************************/ 03956000
*         /*                                                         */ 03957000
*         /*  ABSOLUTE LINE NUMBER IS OUT OF RANGE.                  */ 03958000
*         /*  FORCE AN EJECT AND PRINT ON FIRST LINE OF NEXT PAGE.   */ 03959000
*         /*                                                         */ 03960000
*         /***********************************************************/ 03961000
*                                                                  1053 03962000
*                 ELSE                                             1053 03963000
*                   DO;                                            1053 03964000
         B     @RC01044                                            1053 03965000
@RF01044 DS    0H                                                  1054 03966000
*                     SPFSAV = 1;        /* SET SINGLE SPACE CONTROL  * 03967000
         LA    SPFSAV,1                                            1054 03968000
*                     PCTNLI = 999;     /* FORCE AN EJECT            */ 03969000
         MVC   PCTNLI(2,PCTPTR),@CH00981                           1055 03970000
*                   END;                                           1056 03971000
*             END;                                                 1057 03972000
@RC01044 DS    0H                                                  1058 03973000
*         /***********************************************************/ 03974000
*         /*                                                         */ 03975000
*         /* TEST FOR OVERFLOW OR EJECT AND HANDLE IF NEEDED.        */ 03976000
*         /*                                                         */ 03977000
*         /***********************************************************/ 03978000
*                                                                  1058 03979000
*         IF (PCTNLI + SPFSAV) > PCTLDL | PRTSPT = 'E'             1058 03980000
*           THEN                                                   1058 03981000
@RF01042 LR    @04,SPFSAV                                          1058 03982000
         AH    @04,PCTNLI(,PCTPTR)                                 1058 03983000
         CH    @04,PCTLDL(,PCTPTR)                                 1058 03984000
         BH    @RT01058                                            1058 03985000
         CLI   PRTSPT,C'E'                                         1058 03986000
         BNE   @RF01058                                            1058 03987000
@RT01058 DS    0H                                                  1059 03988000
*OFLOOP:      DO;                                                  1059 03989000
OFLOOP   DS    0H                                                  1060 03990000
*               SPFSAV = 2;                                        1060 03991000
         LA    SPFSAV,2                                            1060 03992000
*               SAVPMN = PCTPMN;       /*SAVE MSG NO.        #YL026UE*/ 03993000
         LH    @04,PCTPMN(,PCTPTR)                                 1061 03994000
         STH   @04,SAVPMN                                          1061 03995000
*               PCTPMN = 0;            /*NO MSG # WITH TITLE #YL026UE*/ 03996000
         SLR   @04,@04                                             1062 03997000
         STH   @04,PCTPMN(,PCTPTR)                                 1062 03998000
*               FFMHDFLN = ON;         /*SET HEAD/FOOT FLAG  @Y30SSJK*/ 03999000
*                                                                  1063 04000000
         OI    FFMHDFLN,B'00000010'                                1063 04001000
*         /***********************************************************/ 04002000
*         /*                                                         */ 04003000
*         /*  WRITE THE FOOTING LINES IF THEY ARE REQUIRED           */ 04004000
*         /* CURLI IS USED TO POINT TO THE CURRENT FOOTING LINE TO   */ 04005000
*         /* BE PRINTED.                                             */ 04006000
*         /* LINCT IS USED AS A LOOP CONTROL CELL AND IS SET         */ 04007000
*         /* INITIALLY TO THE FOOTING LINE COUNT. (PCTFLC)           */ 04008000
*         /*                                                         */ 04009000
*         /***********************************************************/ 04010000
*                                                                  1064 04011000
*               IF PCTFLC ^= 0                                     1064 04012000
*                 THEN                                             1064 04013000
         CH    @04,PCTFLC(,PCTPTR)                                 1064 04014000
         BE    @RF01064                                            1064 04015000
*                   DO;                                            1065 04016000
*                     PRFTSP = PCTFLN + 1 - NLISAV;                1066 04017000
*                                                                  1066 04018000
         LA    PRFTSP,1                                            1066 04019000
         AH    PRFTSP,PCTFLN(,PCTPTR)                              1066 04020000
         SH    PRFTSP,NLISAV                                       1066 04021000
*                     /***********************************************/ 04022000
*                     /*                                             */ 04023000
*                     /* SPACE TO THE FIRST FOOTING LINE.            */ 04024000
*                     /*                                             */ 04025000
*                     /***********************************************/ 04026000
*                                                                  1067 04027000
*                     PRCC = PRCCON(4);                            1067 04028000
         MVC   PRCC(1),PRCCON+3                                    1067 04029000
*                     DO WHILE PRFTSP > 3;                         1068 04030000
         B     @DE01068                                            1068 04031000
@DL01068 DS    0H                                                  1069 04032000
*                       PRFTSP = PRFTSP - 3;                       1069 04033000
*                                                                  1069 04034000
         SL    PRFTSP,@CF00159                                     1069 04035000
*                       CALL STACKPUT (PRCC);                      1070 04036000
*                                                                  1070 04037000
         LA    @15,PRCC                                            1070 04038000
         ST    @15,@AL00001                                        1070 04039000
         LA    @01,@AL00001                                        1070 04040000
         BAL   @14,STACKPUT                                        1070 04041000
*                     END;                                         1071 04042000
*                                                                  1071 04043000
@DE01068 C     PRFTSP,@CF00159                                     1071 04044000
         BH    @DL01068                                            1071 04045000
*                     /***********************************************/ 04046000
*                     /*                                             */ 04047000
*                     /* PRINT THE FOOTING LINES.                    */ 04048000
*                     /*                                             */ 04049000
*                     /***********************************************/ 04050000
*                                                                  1072 04051000
*                     TTLPT = PCTFLP;   /* SET TEMP FOOTING LINE PTR */ 04052000
         L     @15,PCTFLP(,PCTPTR)                                 1072 04053000
         ST    @15,TTLPT                                           1072 04054000
*                     FLCC(1) = PRCCON(PRFTSP+ 1);                 1073 04055000
         LA    @14,PRCCON(PRFTSP)                                  1073 04056000
         MVC   FLCC(1,@15),0(@14)                                  1073 04057000
*                     DO LINCT = PCTFLC BY -1 TO 1;                1074 04058000
*                                                                  1074 04059000
         LH    @04,PCTFLC(,PCTPTR)                                 1074 04060000
         ST    @04,LINCT                                           1074 04061000
         B     @DE01074                                            1074 04062000
@DL01074 DS    0H                                                  1075 04063000
*                       CALL STACKPUT (FTLI);                      1075 04064000
*                                                                  1075 04065000
         L     @04,TTLPT                                           1075 04066000
         ST    @04,@AL00001                                        1075 04067000
         LA    @01,@AL00001                                        1075 04068000
         BAL   @14,STACKPUT                                        1075 04069000
*                       TTLPT = TTLPT + STDLWPS;                   1076 04070000
         LH    @04,STDLWPS                                         1076 04071000
         AL    @04,TTLPT                                           1076 04072000
         ST    @04,TTLPT                                           1076 04073000
*                     END;                                         1077 04074000
         SLR   @04,@04                                             1077 04075000
         BCTR  @04,0                                               1077 04076000
         AL    @04,LINCT                                           1077 04077000
         ST    @04,LINCT                                           1077 04078000
@DE01074 LTR   @04,@04                                             1077 04079000
         BP    @DL01074                                            1077 04080000
*                   END;                                           1078 04081000
*                 /***************************************************/ 04082000
*                 /*                                                 */ 04083000
*                 /*  WRITE THE TITLE LINES REQUIRED BY THE OVER FLOW*/ 04084000
*                 /* LINCT IS USED AS A LOOP CONTROL CELL AND IS SET */ 04085000
*                 /* INITIALLY TO THE TITLE LINE COUNT.(PCTMLC) OR   */ 04086000
*                 /* (PCTSLC)                                        */ 04087000
*                 /*                                                 */ 04088000
*                 /***************************************************/ 04089000
*                 /*                                                 */ 04090000
*                 /* WRITE THE MAIN TITLE LINES FIRST.               */ 04091000
*                 /*                                                 */ 04092000
*                 /***************************************************/ 04093000
*                                                                  1079 04094000
*                   PCTNLI = 2;         /* SET NEXT LINE NUMBER      */ 04095000
@RF01064 MVC   PCTNLI(2,PCTPTR),@CH00150                           1079 04096000
*                   PCTCPN = PCTCPN + PCTPNI;                      1080 04097000
         LH    @07,PCTCPN(,PCTPTR)                                 1080 04098000
         AH    @07,PCTPNI(,PCTPTR)                                 1080 04099000
         STH   @07,PCTCPN(,PCTPTR)                                 1080 04100000
*                                       /* SET NEXT PAGE NUMBER.     */ 04101000
*                                                                  1081 04102000
*                 /***************************************************/ 04103000
*                 /*                                                 */ 04104000
*                 /* SET UP THE PAGE NUMBER IN THE MAIN TITLE LINE   */ 04105000
*                 /*                                                 */ 04106000
*                 /***************************************************/ 04107000
*                                                                  1081 04108000
*                   CVDREG = PCTCPN;    /* CONVERT PAGE NUMBER       */ 04109000
         LR    CVDREG,@07                                          1081 04110000
*                   GEN (CVD   CVDREG,UNPKWD);                     1082 04111000
         CVD   CVDREG,UNPKWD                                            04112000
*                   GEN (UNPK  MTPN,UNPKWD);                       1083 04113000
         UNPK  MTPN,UNPKWD                                              04114000
*                   GEN (OI    MTPN+3,X'F0');                      1084 04115000
*                                                                  1084 04116000
         OI    MTPN+3,X'F0'                                             04117000
*                   MTLINE(PCTPNL:PCTPNL + 4) = MTPN;              1085 04118000
         LH    @07,PCTPNL(,PCTPTR)                                 1085 04119000
         L     @04,PCTMLP(,PCTPTR)                                 1085 04120000
         ALR   @04,@07                                             1085 04121000
         BCTR  @04,0                                               1085 04122000
         MVI   MTLINE+4(@04),C' '                                  1085 04123000
         MVC   MTLINE(4,@04),MTPN                                  1085 04124000
*                                       /* MOVE PAGE NUMBER TO LINE  */ 04125000
*                                                                  1086 04126000
*                   /*************************************************/ 04127000
*                   /*                                               */ 04128000
*                   /* SET LEADING PAGE NUMBER ZEROS TO BLANKS.      */ 04129000
*                   /*                                               */ 04130000
*                   /*************************************************/ 04131000
*                                                                  1086 04132000
*                   LINCT = PCTPNL;                                1086 04133000
         ST    @07,LINCT                                           1086 04134000
*                   DO N = 1 TO 3 BY 1 WHILE MTLINE(LINCT) = '0';  1087 04135000
         LA    N,1                                                 1087 04136000
@DL01087 L     @04,LINCT                                           1087 04137000
         L     @15,PCTMLP(,PCTPTR)                                 1087 04138000
         ALR   @04,@15                                             1087 04139000
         BCTR  @04,0                                               1087 04140000
         CLI   MTLINE(@04),C'0'                                    1087 04141000
         BNE   @DC01087                                            1087 04142000
*                     MTLINE(LINCT) = ' ';                         1088 04143000
         L     @04,LINCT                                           1088 04144000
         ALR   @15,@04                                             1088 04145000
         BCTR  @15,0                                               1088 04146000
         MVI   MTLINE(@15),C' '                                    1088 04147000
*                                       /* SET PRECEDING ZEROS BLANK */ 04148000
*                     LINCT = LINCT +1;                            1089 04149000
         AL    @04,@CF00216                                        1089 04150000
         ST    @04,LINCT                                           1089 04151000
*                   END;                                           1090 04152000
*                                                                  1090 04153000
         AL    N,@CF00216                                          1090 04154000
         C     N,@CF00159                                          1090 04155000
         BNH   @DL01087                                            1090 04156000
@DC01087 DS    0H                                                  1091 04157000
*                   /*************************************************/ 04158000
*                   /*                                               */ 04159000
*                   /* PUT THE MAIN TITLE LINE TO SYSPRINT.          */ 04160000
*                   /*                                               */ 04161000
*                   /*************************************************/ 04162000
*                                                                  1091 04163000
*                                                                  1091 04164000
*                   CALL STACKPUT (MTLINE);                        1091 04165000
*                                                                  1091 04166000
         L     @04,PCTMLP(,PCTPTR)                                 1091 04167000
         ST    @04,@AL00001                                        1091 04168000
         LA    @01,@AL00001                                        1091 04169000
         BAL   @14,STACKPUT                                        1091 04170000
*                   RESPECIFY RTNREG RSTD;                         1092 04171000
*                   TESTRC = RTNREG;                               1093 04172000
         STH   RTNREG,TESTRC                                       1093 04173000
*                   RESPECIFY RTNREG UNRSTD;                       1094 04174000
*                   IF TESTRC ^= 0                                 1095 04175000
*                     THEN                                         1095 04176000
         LH    @04,TESTRC                                          1095 04177000
         LTR   @04,@04                                             1095 04178000
         BZ    @RF01095                                            1095 04179000
*                       RETURN CODE(RCQUIT);                       1096 04180000
*                                                                  1096 04181000
         LH    @15,RCQUIT                                          1096 04182000
         L     @14,@SA00014                                        1096 04183000
         LM    @00,@06,@SA00014+8                                  1096 04184000
         LM    @08,@12,@SA00014+36                                 1096 04185000
         BR    @14                                                 1096 04186000
*                   /*************************************************/ 04187000
*                   /*                                               */ 04188000
*                   /*  WRITE THE SUB TITLE LINES                    */ 04189000
*                   /* THERE MAY BE FROM ONE TO THREE TITLE LINES,   */ 04190000
*                   /* EACH WITH SPACING OF ONE TO THREE LINES.      */ 04191000
*                   /* THIS ROUTINE WRITES THOSE LINES AND KEEPS     */ 04192000
*                   /* TRACK OF THE SPACING TO DETERMINE WHAT WILL   */ 04193000
*                   /* BE THE FIRST DATA LINE.                       */ 04194000
*                   /* PCTSLP POINTS TO THE TITLE LINES.             */ 04195000
*                   /* PCTSLC CONTAINS A COUNT OF THE NUMBER OF LINES*/ 04196000
*                   /*                                               */ 04197000
*                   /*************************************************/ 04198000
*                                                                  1097 04199000
*                   TTLPT = PCTSLP;    /* SET TEMP SUB-TITLE PTR    */  04200000
@RF01095 L     @04,PCTSLP(,PCTPTR)                                 1097 04201000
         ST    @04,TTLPT                                           1097 04202000
*                   IF PCTSLC ^= 0                                 1098 04203000
*                     THEN                                         1098 04204000
         LH    @04,PCTSLC(,PCTPTR)                                 1098 04205000
         LTR   @04,@04                                             1098 04206000
         BZ    @RF01098                                            1098 04207000
*                       /*********************************************/ 04208000
*                       /*                                           */ 04209000
*                       /* COMPUTE THE LINE SPACE FOR EACH           */ 04210000
*                       /* SUB-TITLE LINE FOR LOCATION OF FIRST DATA */ 04211000
*                       /* LINE.                                     */ 04212000
*                       /*                                           */ 04213000
*                       /*********************************************/ 04214000
*                                                                  1099 04215000
*                       DO LINCT = 1 TO PCTSLC;                    1099 04216000
         LA    @04,1                                               1099 04217000
         B     @DE01099                                            1099 04218000
@DL01099 DS    0H                                                  1100 04219000
*                         IF STLCC = ' '                           1100 04220000
*                           THEN       /* FIGURE LINE SPACING.       */ 04221000
         L     @04,TTLPT                                           1100 04222000
         CLI   STLCC(@04),64                                       1100 04223000
         BNE   @RF01100                                            1100 04224000
*                             PCTNLI = PCTNLI + 1;                 1101 04225000
         LA    @04,1                                               1101 04226000
         AH    @04,PCTNLI(,PCTPTR)                                 1101 04227000
         STH   @04,PCTNLI(,PCTPTR)                                 1101 04228000
*                         IF STLCC = '0'                           1102 04229000
*                           THEN                                   1102 04230000
@RF01100 L     @04,TTLPT                                           1102 04231000
         CLI   STLCC(@04),240                                      1102 04232000
         BNE   @RF01102                                            1102 04233000
*                             PCTNLI = PCTNLI + 2;                 1103 04234000
         LA    @04,2                                               1103 04235000
         AH    @04,PCTNLI(,PCTPTR)                                 1103 04236000
         STH   @04,PCTNLI(,PCTPTR)                                 1103 04237000
*                         IF STLCC = '-'                           1104 04238000
*                           THEN                                   1104 04239000
@RF01102 L     @04,TTLPT                                           1104 04240000
         CLI   STLCC(@04),96                                       1104 04241000
         BNE   @RF01104                                            1104 04242000
*                             PCTNLI = PCTNLI + 3;                 1105 04243000
*                                                                  1105 04244000
         LA    @04,3                                               1105 04245000
         AH    @04,PCTNLI(,PCTPTR)                                 1105 04246000
         STH   @04,PCTNLI(,PCTPTR)                                 1105 04247000
*                       /*********************************************/ 04248000
*                       /*                                           */ 04249000
*                       /* PUT THE SUB-TITLE LINE TO SYSPRINT.       */ 04250000
*                       /*                                           */ 04251000
*                       /*********************************************/ 04252000
*                                                                  1106 04253000
*                         CALL STACKPUT (STLINE);                  1106 04254000
*                                                                  1106 04255000
@RF01104 L     @04,TTLPT                                           1106 04256000
         ST    @04,@AL00001                                        1106 04257000
         LA    @01,@AL00001                                        1106 04258000
         BAL   @14,STACKPUT                                        1106 04259000
*                         RESPECIFY RTNREG RSTD;                   1107 04260000
*                         TESTRC = RTNREG;                         1108 04261000
         STH   RTNREG,TESTRC                                       1108 04262000
*                         RESPECIFY RTNREG UNRSTD;                 1109 04263000
*                         IF TESTRC ^= 0                           1110 04264000
*                           THEN                                   1110 04265000
         LH    @04,TESTRC                                          1110 04266000
         LTR   @04,@04                                             1110 04267000
         BZ    @RF01110                                            1110 04268000
*                             RETURN CODE(RCQUIT);                 1111 04269000
         LH    @15,RCQUIT                                          1111 04270000
         L     @14,@SA00014                                        1111 04271000
         LM    @00,@06,@SA00014+8                                  1111 04272000
         LM    @08,@12,@SA00014+36                                 1111 04273000
         BR    @14                                                 1111 04274000
*                         TTLPT = TTLPT + STDLWPS;                 1112 04275000
@RF01110 LH    @04,STDLWPS                                         1112 04276000
         AL    @04,TTLPT                                           1112 04277000
         ST    @04,TTLPT                                           1112 04278000
*                                       /* STEP TO NEXT LINE.        */ 04279000
*                       END;                                       1113 04280000
         LA    @04,1                                               1113 04281000
         AL    @04,LINCT                                           1113 04282000
@DE01099 ST    @04,LINCT                                           1113 04283000
         CH    @04,PCTSLC(,PCTPTR)                                 1113 04284000
         BNH   @DL01099                                            1113 04285000
*                 /***************************************************/ 04286000
*                 /*                                                 */ 04287000
*                 /* IF HEADINGS ARE TO BE PRINTED, DO IT HERE.      */ 04288000
*                 /* HEADING LINES ARE KEPT IN A QUEUE ANCHORED ON   */ 04289000
*                 /* PCTAHP.  IF PCTHAF IS ON AND PCTH1F IS OFF      */ 04290000
*                 /* DURING PAGE OVERFLOW, ALL HEADING LINES IN THE  */ 04291000
*                 /* QUEUE ARE PRINTED.                              */ 04292000
*                 /* PCTHAF INDICATES A HEADING IS ACTIVE.           */ 04293000
*                 /* PCTH1F INDICATES THE CURRENT LINE IS THE FIRST  */ 04294000
*                 /*        LINE OF A NEW HEADING SET.               */ 04295000
*                 /*                                                 */ 04296000
*                 /***************************************************/ 04297000
*                                                                  1114 04298000
*                 IF PCTHAF = ON & PCTH1F = OFF                    1114 04299000
*                   THEN                                           1114 04300000
@RF01098 TM    PCTHAF(PCTPTR),B'00100000'                          1114 04301000
         BNO   @RF01114                                            1114 04302000
         TM    PCTH1F(PCTPTR),B'10000000'                          1114 04303000
         BNZ   @RF01114                                            1114 04304000
*                     DO;                                          1115 04305000
*                       HEADPTR = PCTAHP;                          1116 04306000
         L     @04,PCTAHP(,PCTPTR)                                 1116 04307000
         ST    @04,HEADPTR                                         1116 04308000
*                       DO WHILE HEADPTR > 0;                      1117 04309000
*                                                                  1117 04310000
         B     @DE01117                                            1117 04311000
@DL01117 DS    0H                                                  1118 04312000
*                         /*******************************************/ 04313000
*                         /*                                         */ 04314000
*                         /* COMPUTE THE LINE SPACE FOR EACH         */ 04315000
*                         /* HEADING LINE FOR LOCATION OF THE FIRST  */ 04316000
*                         /* DATA LINE.                              */ 04317000
*                         /*                                         */ 04318000
*                         /*******************************************/ 04319000
*                                                                  1118 04320000
*                         IF HEADCC = ' '                          1118 04321000
*                           THEN                                   1118 04322000
         L     @04,HEADPTR                                         1118 04323000
         CLI   HEADCC(@04),C' '                                    1118 04324000
         BNE   @RF01118                                            1118 04325000
*                             PCTNLI = PCTNLI + 1;                 1119 04326000
         LA    @04,1                                               1119 04327000
         AH    @04,PCTNLI(,PCTPTR)                                 1119 04328000
         STH   @04,PCTNLI(,PCTPTR)                                 1119 04329000
*                         IF HEADCC = '0'                          1120 04330000
*                           THEN                                   1120 04331000
@RF01118 L     @04,HEADPTR                                         1120 04332000
         CLI   HEADCC(@04),C'0'                                    1120 04333000
         BNE   @RF01120                                            1120 04334000
*                             PCTNLI = PCTNLI + 2;                 1121 04335000
         LA    @04,2                                               1121 04336000
         AH    @04,PCTNLI(,PCTPTR)                                 1121 04337000
         STH   @04,PCTNLI(,PCTPTR)                                 1121 04338000
*                         IF HEADCC = '-'                          1122 04339000
*                           THEN                                   1122 04340000
@RF01120 L     @04,HEADPTR                                         1122 04341000
         CLI   HEADCC(@04),C'-'                                    1122 04342000
         BNE   @RF01122                                            1122 04343000
*                             PCTNLI = PCTNLI + 3;                 1123 04344000
*                                                                  1123 04345000
         LA    @04,3                                               1123 04346000
         AH    @04,PCTNLI(,PCTPTR)                                 1123 04347000
         STH   @04,PCTNLI(,PCTPTR)                                 1123 04348000
*                         /*******************************************/ 04349000
*                         /*                                         */ 04350000
*                         /* WRITE THE HEADING LINES.                */ 04351000
*                         /*                                         */ 04352000
*                         /*******************************************/ 04353000
*                                                                  1124 04354000
*                         CALL STACKPUT (HEADCC);                  1124 04355000
*                                                                  1124 04356000
@RF01122 L     @04,HEADPTR                                         1124 04357000
         LA    @04,HEADCC(,@04)                                    1124 04358000
         ST    @04,@AL00001                                        1124 04359000
         LA    @01,@AL00001                                        1124 04360000
         BAL   @14,STACKPUT                                        1124 04361000
*                         RESPECIFY RTNREG RSTD;                   1125 04362000
*                         TESTRC = RTNREG;                         1126 04363000
         STH   RTNREG,TESTRC                                       1126 04364000
*                         RESPECIFY RTNREG UNRSTD;                 1127 04365000
*                         IF TESTRC ^= 0                           1128 04366000
*                           THEN                                   1128 04367000
         LH    @04,TESTRC                                          1128 04368000
         LTR   @04,@04                                             1128 04369000
         BZ    @RF01128                                            1128 04370000
*                             RETURN CODE(RCQUIT);                 1129 04371000
         LH    @15,RCQUIT                                          1129 04372000
         L     @14,@SA00014                                        1129 04373000
         LM    @00,@06,@SA00014+8                                  1129 04374000
         LM    @08,@12,@SA00014+36                                 1129 04375000
         BR    @14                                                 1129 04376000
*                         HEADPTR = HEADQP;                        1130 04377000
@RF01128 L     @04,HEADPTR                                         1130 04378000
         L     @04,HEADQP(,@04)                                    1130 04379000
         ST    @04,HEADPTR                                         1130 04380000
*                                       /* STEP HEADER LINE PTR.     */ 04381000
*                       END;                                       1131 04382000
@DE01117 L     @04,HEADPTR                                         1131 04383000
         LTR   @04,@04                                             1131 04384000
         BP    @DL01117                                            1131 04385000
*                     END;                                         1132 04386000
*                     PCTPMN = SAVPMN; /*RESTORE MSG #       @YL026UE*/ 04387000
*                                                                  1133 04388000
@RF01114 LH    @04,SAVPMN                                          1133 04389000
         STH   @04,PCTPMN(,PCTPTR)                                 1133 04390000
*               FFMHDFLN = OFF;         /*TURN OFF HEAD/FOOT @Y30SSJK*/ 04391000
         NI    FFMHDFLN,B'11111101'                                1134 04392000
*             END OFLOOP;                                          1135 04393000
*         /***********************************************************/ 04394000
*         /*                                                         */ 04395000
*         /*  DO THE REQUIRED SPACING FOR THE LINE TO BE PRINTED     */ 04396000
*         /*  SET UP TRIPLE LINE SPACES TO GET TO THE REQUIRED LINE  */ 04397000
*         /*                                                         */ 04398000
*         /***********************************************************/ 04399000
*                                                                  1136 04400000
*         PRCC = PRCCON(4);             /* SET TRIPLE SPACE CHAR     */ 04401000
@RF01058 MVC   PRCC(1),PRCCON+3                                    1136 04402000
*         DO WHILE SPFSAV > 3;                                     1137 04403000
         B     @DE01137                                            1137 04404000
@DL01137 DS    0H                                                  1138 04405000
*           PCTNLI = PCTNLI + 3;        /* ADVANCE LINE COUNT        */ 04406000
         LA    @04,3                                               1138 04407000
         LH    @15,PCTNLI(,PCTPTR)                                 1138 04408000
         ALR   @15,@04                                             1138 04409000
         STH   @15,PCTNLI(,PCTPTR)                                 1138 04410000
*           SPFSAV = SPFSAV - 3;        /* REDUCE REQUEST COUNT      */ 04411000
*                                                                  1139 04412000
         SLR   SPFSAV,@04                                          1139 04413000
*           CALL STACKPUT (PRCC);                                  1140 04414000
*                                                                  1140 04415000
         LA    @04,PRCC                                            1140 04416000
         ST    @04,@AL00001                                        1140 04417000
         LA    @01,@AL00001                                        1140 04418000
         BAL   @14,STACKPUT                                        1140 04419000
*           RESPECIFY RTNREG RSTD;                                 1141 04420000
*           TESTRC = RTNREG;                                       1142 04421000
         STH   RTNREG,TESTRC                                       1142 04422000
*           RESPECIFY RTNREG UNRSTD;                               1143 04423000
*           IF TESTRC ^= 0                                         1144 04424000
*             THEN                                                 1144 04425000
         LH    @04,TESTRC                                          1144 04426000
         LTR   @04,@04                                             1144 04427000
         BZ    @RF01144                                            1144 04428000
*               RETURN CODE(RCQUIT);                               1145 04429000
         LH    @15,RCQUIT                                          1145 04430000
         L     @14,@SA00014                                        1145 04431000
         LM    @00,@06,@SA00014+8                                  1145 04432000
         LM    @08,@12,@SA00014+36                                 1145 04433000
         BR    @14                                                 1145 04434000
*         END;                                                     1146 04435000
*                                                                  1146 04436000
@RF01144 DS    0H                                                  1146 04437000
@DE01137 C     SPFSAV,@CF00159                                     1146 04438000
         BH    @DL01137                                            1146 04439000
*         /***********************************************************/ 04440000
*         /*                                                         */ 04441000
*         /*  INITIALIZE AND TRANSLATE THIS DATA LINE                */ 04442000
*         /*                                                         */ 04443000
*         /***********************************************************/ 04444000
*                                                                  1147 04445000
*         PRCC = PRCCON(SPFSAV+1);      /* SET PROPER SPACE CHAR     */ 04446000
         LA    @04,PRCCON(SPFSAV)                                  1147 04447000
         MVC   PRCC(1),0(@04)                                      1147 04448000
*         PRLINE = PRTBUFF;             /* MOVE LINE TO PRINT@Z40GSJG*/ 04449000
*                                                                  1148 04450000
         MVI   PRLINE+135,C' '                                     1148 04451000
         MVC   PRLINE+136(84),PRLINE+135                           1148 04452000
         L     @04,PRTBUFPT                                        1148 04453000
         MVC   PRLINE(135),PRTBUFF(@04)                            1148 04454000
*         CVDREG = PCTTRP;              /* GET TRANSLATE TABLE ADDR. */ 04455000
         L     CVDREG,PCTTRP(,PCTPTR)                              1149 04456000
*GENERATE (TR    PRLINE,0(CVDREG));     /* TRANSLATE THE LINE        */ 04457000
*                                                                  1150 04458000
         TR    PRLINE,0(CVDREG)                                         04459000
*        IF FFMPSMS = ON                                           1151 04460000
*          THEN                                                    1151 04461000
         TM    FFMPSMS,B'00001000'                                 1151 04462000
         BNO   @RF01151                                            1151 04463000
*            DO;                                           /*@Y30SSJK*/ 04464000
*              PRLINES = PRTBUFF2;                         /*@Z40GSJG*/ 04465000
         MVI   PRLINES+135,C' '                                    1153 04466000
         MVC   PRLINES+136(84),PRLINES+135                         1153 04467000
         MVC   PRLINES(135),PRTBUFF2                               1153 04468000
*              GEN(TR PRLINES,0(CVDREG));                  /*@Y30SSJK*/ 04469000
         TR PRLINES,0(CVDREG)                                           04470000
*            END;                                          /*@Y30SSJK*/ 04471000
*                                                                  1155 04472000
*        /************************************************************/ 04473000
*        /*                                                          */ 04474000
*        /* MESSAGES MUST BE SEGMENTED BY THE SEGMENT ROUTINE TO     */ 04475000
*        /* INSURE THAT AS MANY LINES AS ARE REQUIRED, TO PRINT      */ 04476000
*        /* THE FULL MESSAGE TEXT, ARE PRINTED.                      */ 04477000
*        /*                                                          */ 04478000
*        /************************************************************/ 04479000
*                                                                  1156 04480000
*         IF FFMPMSF = ON                                 /* @OZ18517*/ 04481000
*           THEN                                          /* @Z40GSJG*/ 04482000
@RF01151 TM    FFMPMSF,B'00010000'                                 1156 04483000
         BNO   @RF01156                                            1156 04484000
*             CALL SEGMENT;                               /* @Z40GSJG*/ 04485000
*                                                                  1157 04486000
         BAL   @14,SEGMENT                                         1157 04487000
*         IF GDTDBG = NULLPTR                                      1158 04488000
*           THEN;                                                  1158 04489000
@RF01156 L     @04,GDTDBG(,GDTPR)                                  1158 04490000
         LTR   @04,@04                                             1158 04491000
         BZ    @RT01158                                            1158 04492000
*           ELSE                                                   1160 04493000
*             CALL IDCDB010(GDTTBL,'TPMS');/*                      1160 04494000
*                                                            @Z40GSJG*/ 04495000
*                                                                  1160 04496000
         ST    GDTPR,@AL00001                                      1160 04497000
         LA    @04,@CC00987                                        1160 04498000
         ST    @04,@AL00001+4                                      1160 04499000
         MVI   @AL00001+4,X'80'                                    1160 04500000
         L     @15,GDTDBG(,GDTPR)                                  1160 04501000
         LA    @01,@AL00001                                        1160 04502000
         BALR  @14,@15                                             1160 04503000
*         /***********************************************************/ 04504000
*         /*                                                         */ 04505000
*         /* SET UP THE ARGUMENTS FOR THE ADAPTER.                   */ 04506000
*         /* THEN PRINT THIS LINE.                                   */ 04507000
*         /*                                                         */ 04508000
*         /***********************************************************/ 04509000
*                                                                  1161 04510000
*         CALL STACKPUT (PRCC);                                    1161 04511000
*                                                                  1161 04512000
@RT01158 LA    @04,PRCC                                            1161 04513000
         ST    @04,@AL00001                                        1161 04514000
         LA    @01,@AL00001                                        1161 04515000
         BAL   @14,STACKPUT                                        1161 04516000
*         RESPECIFY RTNREG RSTD;                                   1162 04517000
*         TESTRC = RTNREG;                                         1163 04518000
         STH   RTNREG,TESTRC                                       1163 04519000
*         RESPECIFY RTNREG UNRSTD;                                 1164 04520000
*     IF GDTDBG = NULLPTR                                          1165 04521000
*       THEN;                                                      1165 04522000
         L     @06,GDTDBG(,GDTPR)                                  1165 04523000
         LTR   @06,@06                                             1165 04524000
         BZ    @RT01165                                            1165 04525000
*       ELSE                                                       1167 04526000
*         CALL IDCDB010(GDTTBL,'TPX1');                            1167 04527000
         ST    GDTPR,@AL00001                                      1167 04528000
         LA    @06,@CC00988                                        1167 04529000
         ST    @06,@AL00001+4                                      1167 04530000
         MVI   @AL00001+4,X'80'                                    1167 04531000
         L     @15,GDTDBG(,GDTPR)                                  1167 04532000
         LA    @01,@AL00001                                        1167 04533000
         BALR  @14,@15                                             1167 04534000
*                                                          /*@Y30SSJK*/ 04535000
*         IF TESTRC ^= 0                                           1168 04536000
*           THEN                                                   1168 04537000
@RT01165 LH    @06,TESTRC                                          1168 04538000
         LTR   @06,@06                                             1168 04539000
         BZ    @RF01168                                            1168 04540000
*             RETURN CODE(RCQUIT);                                 1169 04541000
         LH    @15,RCQUIT                                          1169 04542000
         L     @14,@SA00014                                        1169 04543000
         LM    @00,@06,@SA00014+8                                  1169 04544000
         LM    @08,@12,@SA00014+36                                 1169 04545000
         BR    @14                                                 1169 04546000
*         PCTPMN = 0;                                              1170 04547000
@RF01168 SLR   @06,@06                                             1170 04548000
         STH   @06,PCTPMN(,PCTPTR)                                 1170 04549000
*         PCTNLI = PCTNLI + SPFSAV;                                1171 04550000
*                                                                  1171 04551000
         LR    @06,SPFSAV                                          1171 04552000
         AH    @06,PCTNLI(,PCTPTR)                                 1171 04553000
         STH   @06,PCTNLI(,PCTPTR)                                 1171 04554000
*         /***********************************************************/ 04555000
*         /*                                                         */ 04556000
*         /* IF THE LINE JUST PRINTED WAS A NEW HEADING LINE, SET IT */ 04557000
*         /* UP IN THE HEADER QUEUE HERE.  THE CORE FOR THIS QUEUE   */ 04558000
*         /* IS OBTAINED FROM POOL 'TP03'.  IF THERE WAS A PREVIOUS  */ 04559000
*         /* HEADER, ITS CORE IS FREED PRIOR TO GETTING CORE FOR     */ 04560000
*         /* THIS HEADER.  ALL HEADER CORE IS FREED WHEN A RESET IS  */ 04561000
*         /* ISSUED AT ANY TIME.                                     */ 04562000
*         /* PCTHAF IS A FLAG INDICATING THAT A HEADER IS ACTIVE.    */ 04563000
*         /* PCTH1F IS A FLAG INDICATING THAT THE CURRENT LINE       */ 04564000
*         /*        IS THE FIRST OF A NEW SERIES OF HEADER LINES.    */ 04565000
*         /* PCTH2F IS A FLAG INDICATING THAT THE CURRENT LINE IS A  */ 04566000
*         /*        CONTINUATION LINE OF A SET OF HEADERS BEING      */ 04567000
*         /*        ENTERED.                                         */ 04568000
*         /* PCTAHP IS THE ANCHOR POINT FOR THE HEADER QUEUE IN THE  */ 04569000
*         /*        PRINT CONTROL TABLE.                             */ 04570000
*         /*                                                         */ 04571000
*         /***********************************************************/ 04572000
*                                                                  1172 04573000
*         /***********************************************************/ 04574000
*         /*                                                         */ 04575000
*         /* IF A HEADING EXISTS AND THIS LINE IS A NEW ONE, FREE    */ 04576000
*         /* THE POOL SPACE FOR THE EXISTING HEADER.                 */ 04577000
*         /*                                                         */ 04578000
*         /***********************************************************/ 04579000
*                                                                  1172 04580000
*         IF PCTH1F = ON & PCTHAF = ON                             1172 04581000
*           THEN                                                   1172 04582000
         TM    PCTH1F(PCTPTR),B'10100000'                          1172 04583000
         BNO   @RF01172                                            1172 04584000
*             DO;                                                  1173 04585000
*                                                                  1173 04586000
*               CALL IDCSAFP0 (GDTTBL,HDPOOL);                     1174 04587000
*                                                                  1174 04588000
         ST    GDTPR,@AL00001                                      1174 04589000
         LA    @06,HDPOOL                                          1174 04590000
         ST    @06,@AL00001+4                                      1174 04591000
         MVI   @AL00001+4,X'80'                                    1174 04592000
         L     @15,GDTFPL(,GDTPR)                                  1174 04593000
         LA    @01,@AL00001                                        1174 04594000
         BALR  @14,@15                                             1174 04595000
*               PCTAHP = ''B;                                      1175 04596000
         SLR   @06,@06                                             1175 04597000
         ST    @06,PCTAHP(,PCTPTR)                                 1175 04598000
*             END;                                                 1176 04599000
*                                                                  1176 04600000
*         /***********************************************************/ 04601000
*         /*                                                         */ 04602000
*         /* GET THE POOL STORAGE FOR THE NEW HEADER LINE.           */ 04603000
*         /*                                                         */ 04604000
*         /***********************************************************/ 04605000
*                                                                  1177 04606000
*         IF PCTH1F = ON | PCTH2F = ON                             1177 04607000
*           THEN                                                   1177 04608000
@RF01172 TM    PCTH1F(PCTPTR),B'11000000'                          1177 04609000
         BZ    @RF01177                                            1177 04610000
*             DO;                                                  1178 04611000
*               CURLI = PCTPLW + 4;                                1179 04612000
*                                                                  1179 04613000
         LA    @06,4                                               1179 04614000
         AL    @06,PCTPLW(,PCTPTR)                                 1179 04615000
         ST    @06,CURLI                                           1179 04616000
*               CALL IDCSAGP0 (GDTTBL,CURLI,HEADPTR,HDPOOL,SETZERO);    04617000
         ST    GDTPR,@AL00001                                      1180 04618000
         LA    @06,CURLI                                           1180 04619000
         ST    @06,@AL00001+4                                      1180 04620000
         LA    @06,HEADPTR                                         1180 04621000
         ST    @06,@AL00001+8                                      1180 04622000
         LA    @06,HDPOOL                                          1180 04623000
         ST    @06,@AL00001+12                                     1180 04624000
         LA    @06,SETZERO                                         1180 04625000
         ST    @06,@AL00001+16                                     1180 04626000
         MVI   @AL00001+16,X'80'                                   1180 04627000
         L     @15,GDTGPL(,GDTPR)                                  1180 04628000
         LA    @01,@AL00001                                        1180 04629000
         BALR  @14,@15                                             1180 04630000
*                                       /* GET THE POOL CORE.        */ 04631000
*                                                                  1181 04632000
*               RESPECIFY RTNREG RSTD;                             1181 04633000
*               TESTRC = RTNREG;                                   1182 04634000
         STH   RTNREG,TESTRC                                       1182 04635000
*               RESPECIFY RTNREG UNRSTD;                           1183 04636000
*                 IF TESTRC ^= 0                                   1184 04637000
*                   THEN                                           1184 04638000
*                                                                  1184 04639000
         LH    @06,TESTRC                                          1184 04640000
         LTR   @06,@06                                             1184 04641000
         BZ    @RF01184                                            1184 04642000
*                     DO;                                          1185 04643000
*                       RESPECIFY(REG13,REG14,REG15) RSTD;         1186 04644000
*                       REG15 = 28;                                1187 04645000
         LA    REG15,28                                            1187 04646000
*                       REG14 = GDTABT;                            1188 04647000
         L     REG14,GDTABT(,GDTPR)                                1188 04648000
*                       REG13 = GDTABH;                            1189 04649000
         L     REG13,GDTABH(,GDTPR)                                1189 04650000
*                       GEN(BR    REG14);                          1190 04651000
         BR    REG14                                                    04652000
*                       RESPECIFY(REG13,REG14,REG15)UNRSTD;        1191 04653000
*                     END;                                         1192 04654000
*                                                                  1192 04655000
*               IF PCTH1F = ON                                     1193 04656000
*                 THEN                                             1193 04657000
*                                                                  1193 04658000
@RF01184 TM    PCTH1F(PCTPTR),B'10000000'                          1193 04659000
         BNO   @RF01193                                            1193 04660000
*                 /***************************************************/ 04661000
*                 /*                                                 */ 04662000
*                 /* INITIALIZE A NEW HEADER QUEUE.                  */ 04663000
*                 /*                                                 */ 04664000
*                 /***************************************************/ 04665000
*                                                                  1194 04666000
*                   DO;                                            1194 04667000
*                     PCTAHP = HEADPTR;                            1195 04668000
         L     @06,HEADPTR                                         1195 04669000
         ST    @06,PCTAHP(,PCTPTR)                                 1195 04670000
*                     HEADCC = PRCCON(3);                          1196 04671000
         MVC   HEADCC(1,@06),PRCCON+2                              1196 04672000
*                   END;                                           1197 04673000
*               IF PCTH2F = ON                                     1198 04674000
*                 THEN                                             1198 04675000
@RF01193 TM    PCTH2F(PCTPTR),B'01000000'                          1198 04676000
         BNO   @RF01198                                            1198 04677000
*                 /***************************************************/ 04678000
*                 /*                                                 */ 04679000
*                 /* ADD A NEW LINE TO THE HEADER QUEUE.             */ 04680000
*                 /*                                                 */ 04681000
*                 /***************************************************/ 04682000
*                                                                  1199 04683000
*                   DO;                                            1199 04684000
*                     IF PCTAHP = NULLPTR                          1200 04685000
*                       THEN                                       1200 04686000
         L     @06,PCTAHP(,PCTPTR)                                 1200 04687000
         LTR   @06,@06                                             1200 04688000
         BNZ   @RF01200                                            1200 04689000
*                         DO;                                      1201 04690000
*                           /*****************************************/ 04691000
*                           /*                                       */ 04692000
*                           /* WE ARE PART WAY THROUGH A HEADING     */ 04693000
*                           /* WITH A RESET HAVING BEEN ISSUED.      */ 04694000
*                           /* RETURN WITH CONDITION 12.             */ 04695000
*                           /*                                       */ 04696000
*                           /*****************************************/ 04697000
*                                                                  1202 04698000
*                           PCTH2F = OFF;                          1202 04699000
*                           PCTHAF = OFF;                          1203 04700000
         NI    PCTH2F(PCTPTR),B'10011111'                          1203 04701000
*                           PCTHLC = ''B;                          1204 04702000
         SLR   @06,@06                                             1204 04703000
         STC   @06,PCTHLC(,PCTPTR)                                 1204 04704000
*                           PCTHSC = ''B;                          1205 04705000
         SLR   @06,@06                                             1205 04706000
         STC   @06,PCTHSC(,PCTPTR)                                 1205 04707000
*                           RETURN CODE(RCQUIT);                   1206 04708000
         LH    @15,RCQUIT                                          1206 04709000
         L     @14,@SA00014                                        1206 04710000
         LM    @00,@06,@SA00014+8                                  1206 04711000
         LM    @08,@12,@SA00014+36                                 1206 04712000
         BR    @14                                                 1206 04713000
*                         END;                                     1207 04714000
*                     HDQPTR = PCTAHP;                             1208 04715000
@RF01200 L     @06,PCTAHP(,PCTPTR)                                 1208 04716000
         ST    @06,HDQPTR                                          1208 04717000
*                     DO WHILE HDQPTR->HEADQP ^= NULLPTR;          1209 04718000
         B     @DE01209                                            1209 04719000
@DL01209 DS    0H                                                  1210 04720000
*                       HDQPTR = HDQPTR->HEADQP;                   1210 04721000
         L     @06,HDQPTR                                          1210 04722000
         L     @06,HEADQP(,@06)                                    1210 04723000
         ST    @06,HDQPTR                                          1210 04724000
*                     END;                                         1211 04725000
@DE01209 L     @06,HDQPTR                                          1211 04726000
         L     @04,HEADQP(,@06)                                    1211 04727000
         LTR   @04,@04                                             1211 04728000
         BNZ   @DL01209                                            1211 04729000
*                     HDQPTR->HEADQP = HEADPTR;                    1212 04730000
         L     @04,HEADPTR                                         1212 04731000
         ST    @04,HEADQP(,@06)                                    1212 04732000
*                     HEADCC = PRCC;                               1213 04733000
         MVC   HEADCC(1,@04),PRCC                                  1213 04734000
*                   END;                                           1214 04735000
*                                                                  1214 04736000
*               /*****************************************************/ 04737000
*               /*                                                   */ 04738000
*               /* THIS STATEMENT MOVES ALL HEADING LINES TO THE     */ 04739000
*               /* SPACE AQUIRED FOR THEM.                           */ 04740000
*               /*                                                   */ 04741000
*               /*****************************************************/ 04742000
*                                                                  1215 04743000
*               HEADLI(1:PCTPLW) = PRLINE(1:PCTPLW);               1215 04744000
*                                                                  1215 04745000
@RF01198 L     @06,HEADPTR                                         1215 04746000
         L     @04,PCTPLW(,PCTPTR)                                 1215 04747000
         BCTR  @04,0                                               1215 04748000
         EX    @04,@SM01062                                        1215 04749000
*               /*****************************************************/ 04750000
*               /*                                                   */ 04751000
*               /* CHECK IF THIS IS THE LAST OF THE SET AND SET      */ 04752000
*               /* FLAGS ACCORDINGLY.                                */ 04753000
*               /*                                                   */ 04754000
*               /*****************************************************/ 04755000
*                                                                  1216 04756000
*               PCTHLC = PCTHLC - 1;                               1216 04757000
         SLR   @06,@06                                             1216 04758000
         IC    @06,PCTHLC(,PCTPTR)                                 1216 04759000
         BCTR  @06,0                                               1216 04760000
         STC   @06,PCTHLC(,PCTPTR)                                 1216 04761000
*               PCTH1F = OFF;                                      1217 04762000
         NI    PCTH1F(PCTPTR),B'01111111'                          1217 04763000
*               IF PCTHLC > 0                                      1218 04764000
*                 THEN                                             1218 04765000
         CLI   PCTHLC(PCTPTR),0                                    1218 04766000
         BNH   @RF01218                                            1218 04767000
*                    PCTH2F = ON;                                  1219 04768000
         OI    PCTH2F(PCTPTR),B'01000000'                          1219 04769000
*                  ELSE                                            1220 04770000
*                    PCTH2F = OFF;                                 1220 04771000
         B     @RC01218                                            1220 04772000
@RF01218 NI    PCTH2F(PCTPTR),B'10111111'                          1220 04773000
*               PCTHAF = ON;                                       1221 04774000
@RC01218 OI    PCTHAF(PCTPTR),B'00100000'                          1221 04775000
*             END;                                                 1222 04776000
*                                                                  1222 04777000
*         IF GDTDBG = NULLPTR                                      1223 04778000
*           THEN;                                                  1223 04779000
@RF01177 L     @06,GDTDBG(,GDTPR)                                  1223 04780000
         LTR   @06,@06                                             1223 04781000
         BZ    @RT01223                                            1223 04782000
*           ELSE                                                   1225 04783000
*             CALL IDCDB010 (GDTTBL,'TP3N');                       1225 04784000
*                                                                  1225 04785000
         ST    GDTPR,@AL00001                                      1225 04786000
         LA    @06,@CC00989                                        1225 04787000
         ST    @06,@AL00001+4                                      1225 04788000
         MVI   @AL00001+4,X'80'                                    1225 04789000
         L     @15,GDTDBG(,GDTPR)                                  1225 04790000
         LA    @01,@AL00001                                        1225 04791000
         BALR  @14,@15                                             1225 04792000
*         FFMFMTF = OFF;                                           1226 04793000
@RT01223 NI    FFMFMTF,B'11111110'                                 1226 04794000
*         PRTBUFF = ' ';                                           1227 04795000
         L     @06,PRTBUFPT                                        1227 04796000
         MVI   PRTBUFF+1(@06),C' '                                 1227 04797000
         MVC   PRTBUFF+2(133,@06),PRTBUFF+1(@06)                   1227 04798000
         MVI   PRTBUFF(@06),C' '                                   1227 04799000
*         RETURN CODE(TESTRC);                                     1228 04800000
*                                                                  1228 04801000
         LH    @15,TESTRC                                          1228 04802000
         L     @14,@SA00014                                        1228 04803000
         LM    @00,@06,@SA00014+8                                  1228 04804000
         LM    @08,@12,@SA00014+36                                 1228 04805000
         BR    @14                                                 1228 04806000
*         END LINEPRT;                                             1229 04807000
*         /***********************************************************/ 04808000
*         /*                                                         */ 04809000
*         /* PROCEDURE NAME - LINE STACKING AND UPUT PROCEDURE.      */ 04810000
*         /*                                                         */ 04811000
*         /* FUNCTION - PUT THE PRINT LINES INTO THE OUTPUT BUFFER.  */ 04812000
*         /*     A UPUT IS ISSUED FOR THIS BUFFER WHEN THE BUFFER    */ 04813000
*         /*     IS FULL OR WHEN THE NEXT LINE TO BE PRINTED IS A    */ 04814000
*         /*     MESSAGE.  THIS BUFFER IS NORMALLY 2048 BYTES LONG   */ 04815000
*         /*     BUT MAY BE CHANGED BY ALTERING THE CONSTANT PRBUFL  */ 04816000
*         /*     BOTH HERE AND IN THE MODULE IDCTP04.                */ 04817000
*         /*     IF THE FLAG FFMPSFF IS ON, THERE IS NO LINE TO BE   */ 04818000
*         /*     ADDED BUT THE STACK IS TO BE PRINTED OUT.           */ 04819000
*         /*                                                         */ 04820000
*         /* INPUT - A LINE WIDTH BYTE AREA CONTAINING THE CARRIAGE  */ 04821000
*         /*     CONTROL CHARACTER AND THE DATA LINE.                */ 04822000
*         /*                                                         */ 04823000
*         /* OUTPUT - PRINT LINES TO THE IO ADAPTOR.                 */ 04824000
*         /*     AS LINES ARE PUT INTO THE BUFFER OR IN THE CASE OF  */ 04825000
*         /*     MESSAGES, AS THEY ARE PUT DIRECTLY TO THE IO        */ 04826000
*         /*     ADAPTOR, TRAILING BLANKS ARE STRIPPED TO A MINIMUM  */ 04827000
*         /*     A 1 BYTE DATA LINE PLUS THE CARRIAGE CONTROL        */ 04828000
*         /*     CHARACTER.                                          */ 04829000
*         /*                                                         */ 04830000
*         /***********************************************************/ 04831000
*                                                                  1230 04832000
*STACKPUT: PROC (PUTLINE);                                         1230 04833000
*                                                                  1230 04834000
STACKPUT STM   @14,@06,@SA00015                                    1230 04835000
         STM   @08,@12,@SA00015+36                                 1230 04836000
         MVC   @PC00015(4),0(@01)                                  1230 04837000
*         DCL PUTLINE CHAR(441);       /* INPUT ARGUMENT     @Z40GSJG*/ 04838000
*                                      /* (DATA LINE)        @Z40GSJG*/ 04839000
*                                                                  1232 04840000
*         /***********************************************************/ 04841000
*         /*                                                         */ 04842000
*         /* LOCATE AND STRIP THE TRAILING BLANKS                    */ 04843000
*         /* IF A LINE IS TO BE ADDED OR PRINTED.  (FFMPSFF OFF)     */ 04844000
*         /*                                                         */ 04845000
*         /***********************************************************/ 04846000
*                                                                  1232 04847000
*         IF FFMPSFF = OFF                                         1232 04848000
*           THEN                                                   1232 04849000
         TM    FFMPSFF,B'00100000'                                 1232 04850000
         BNZ   @RF01232                                            1232 04851000
*               DO N = (PCTPLW+1) TO 10 BY -1 WHILE PUTLINE(N) = ' ';   04852000
         LA    N,1                                                 1233 04853000
         AL    N,PCTPLW(,PCTPTR)                                   1233 04854000
         B     @DE01233                                            1233 04855000
@DL01233 L     @04,@PC00015                                        1233 04856000
         ALR   @04,N                                               1233 04857000
         BCTR  @04,0                                               1233 04858000
         CLI   PUTLINE(@04),C' '                                   1233 04859000
         BNE   @DC01233                                            1233 04860000
*               END;                                       /*@OZ07564*/ 04861000
*                                                                  1234 04862000
         BCTR  N,0                                                 1234 04863000
@DE01233 C     N,@CF00032                                          1234 04864000
         BNL   @DL01233                                            1234 04865000
@DC01233 DS    0H                                                  1235 04866000
*         /***********************************************************/ 04867000
*         /*                                                         */ 04868000
*         /* IF LINES ARE IN THE STACK AND IF THE STACK IS FULL OR   */ 04869000
*         /* THE CURRENT LINE IS A MESSAGE, OR THE FLUSH FLAG IS ON  */ 04870000
*         /* PUT THE STACK TO THE IO ADAPTOR.                        */ 04871000
*         /*                                                         */ 04872000
*         /***********************************************************/ 04873000
*                                                                  1235 04874000
*         IF PCTLNM ^= 0 & ((PCTBNL + (N+2) > (PCTBUF + PRBUFL))   1235 04875000
*           | FFMPMSF = ON                                         1235 04876000
*           | FFMPSFF = ON)                                        1235 04877000
*           THEN                                                   1235 04878000
@RF01232 LH    @04,PCTLNM(,PCTPTR)                                 1235 04879000
         LTR   @04,@04                                             1235 04880000
         BZ    @RF01235                                            1235 04881000
         LA    @04,2                                               1235 04882000
         ALR   @04,N                                               1235 04883000
         AL    @04,PCTBNL(,PCTPTR)                                 1235 04884000
         LH    @03,PRBUFL                                          1235 04885000
         AL    @03,PCTBUF(,PCTPTR)                                 1235 04886000
         CR    @04,@03                                             1235 04887000
         BH    @RT01235                                            1235 04888000
         TM    FFMPMSF,B'00110000'                                 1235 04889000
         BZ    @RF01235                                            1235 04890000
@RT01235 DS    0H                                                  1236 04891000
*             DO;                                                  1236 04892000
*               IOCDLN = PCTBNL - PCTBUF;                          1237 04893000
         L     @04,PCTBUF(,PCTPTR)                                 1237 04894000
         L     @03,PCTBNL(,PCTPTR)                                 1237 04895000
         SLR   @03,@04                                             1237 04896000
         ST    @03,IOCDLN(,IOCSPTR)                                1237 04897000
*               IOCDAD = PCTBUF;                                   1238 04898000
         ST    @04,IOCDAD(,IOCSPTR)                                1238 04899000
*               IOCPNM = PCTLNM;                                   1239 04900000
         LH    @03,PCTLNM(,PCTPTR)                                 1239 04901000
         STH   @03,IOCPNM(,IOCSPTR)                                1239 04902000
*               PCTBNL = PCTBUF;                                   1240 04903000
         ST    @04,PCTBNL(,PCTPTR)                                 1240 04904000
*               PCTLNM = 0;                                        1241 04905000
*                                                                  1241 04906000
         SLR   @04,@04                                             1241 04907000
         STH   @04,PCTLNM(,PCTPTR)                                 1241 04908000
*               CALL IDCIOPT0 (GDTTBL,PCTIOC,NULLPMN);             1242 04909000
*                                                                  1242 04910000
         ST    GDTPR,@AL00001                                      1242 04911000
         LA    @04,PCTIOC(,PCTPTR)                                 1242 04912000
         ST    @04,@AL00001+4                                      1242 04913000
         LA    @04,NULLPMN                                         1242 04914000
         ST    @04,@AL00001+8                                      1242 04915000
         MVI   @AL00001+8,X'80'                                    1242 04916000
         L     @15,GDTPUT(,GDTPR)                                  1242 04917000
         LA    @01,@AL00001                                        1242 04918000
         BALR  @14,@15                                             1242 04919000
*               RESPECIFY RTNREG RSTD;                             1243 04920000
*               TESTRC = RTNREG;                                   1244 04921000
         STH   RTNREG,TESTRC                                       1244 04922000
*               RESPECIFY RTNREG UNRSTD;                           1245 04923000
*               IF TESTRC ^= 0                                     1246 04924000
*                 THEN                                             1246 04925000
*                                                                  1246 04926000
         LH    @04,TESTRC                                          1246 04927000
         LTR   @04,@04                                             1246 04928000
         BZ    @RF01246                                            1246 04929000
*                   DO;                                            1247 04930000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           1248 04931000
*                     REG15 = 36;                                  1249 04932000
         LA    REG15,36                                            1249 04933000
*                     REG14 = GDTABT;                              1250 04934000
         L     REG14,GDTABT(,GDTPR)                                1250 04935000
*                     REG13 = GDTABH;                              1251 04936000
         L     REG13,GDTABH(,GDTPR)                                1251 04937000
*                     GEN(BR    REG14);                            1252 04938000
         BR    REG14                                                    04939000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          1253 04940000
*                   END;                                           1254 04941000
*                                                                  1254 04942000
*             END;                                                 1255 04943000
*                                                                  1255 04944000
*                                                                  1255 04945000
@RF01246 DS    0H                                                  1256 04946000
*         /***********************************************************/ 04947000
*         /*                                                         */ 04948000
*         /* IF THE CURRENT LINE IS A MESSAGE, PUT IT DIRECTLY.      */ 04949000
*         /* OR IF TSO USER, PUT IT DIRECTLY.                @OZ01484*/ 04950000
*         /*                                                         */ 04951000
*         /***********************************************************/ 04952000
*                                                                  1256 04953000
*         IF (FFMPMSF = ON | GDTECT ^= 0) & FFMPSFF = OFF  /*@OZ01484*/ 04954000
*           THEN                                                   1256 04955000
@RF01235 TM    FFMPMSF,B'00010000'                                 1256 04956000
         BO    @GL00027                                            1256 04957000
         L     @04,GDTECT(,GDTPR)                                  1256 04958000
         LTR   @04,@04                                             1256 04959000
         BZ    @RF01256                                            1256 04960000
@GL00027 TM    FFMPSFF,B'00100000'                                 1256 04961000
         BNZ   @RF01256                                            1256 04962000
*             DO;                                                  1257 04963000
*               IF QNPMF = ON          /*NO PRINT SEND 2S COMPLIMENT */ 04964000
*                 THEN                                             1258 04965000
         L     @04,QENTP                                           1258 04966000
         TM    QNPMF(@04),B'00010000'                              1258 04967000
         BNO   @RF01258                                            1258 04968000
*                   PCTPMN = -PCTPMN;                      /*#YL026UE*/ 04969000
         LH    @04,PCTPMN(,PCTPTR)                                 1259 04970000
         LCR   @04,@04                                             1259 04971000
         STH   @04,PCTPMN(,PCTPTR)                                 1259 04972000
*               IOCDLN = N;                                        1260 04973000
@RF01258 ST    N,IOCDLN(,IOCSPTR)                                  1260 04974000
*               IOCDAD = ADDR(PUTLINE);                            1261 04975000
         L     @04,@PC00015                                        1261 04976000
         ST    @04,IOCDAD(,IOCSPTR)                                1261 04977000
*               IOCPNM = ''B;                                      1262 04978000
*                                                                  1262 04979000
         SLR   @04,@04                                             1262 04980000
         STH   @04,IOCPNM(,IOCSPTR)                                1262 04981000
*                IF FFMPMSF = ON   &                       /*@Z40GSJG*/ 04982000
*                  FFMHDFLN = OFF                                  1263 04983000
*                  THEN                                            1263 04984000
         TM    FFMPMSF,B'00010000'                                 1263 04985000
         BNO   @RF01263                                            1263 04986000
         TM    FFMHDFLN,B'00000010'                                1263 04987000
         BNZ   @RF01263                                            1263 04988000
*                    DO;                                   /*@Y30SSJK*/ 04989000
*                      IOCDLN = MFTRL;                     /*@Z40GSJG*/ 04990000
*                                                                  1265 04991000
         L     @04,MFTRL                                           1265 04992000
         ST    @04,IOCDLN(,IOCSPTR)                                1265 04993000
*                     /***********************************************/ 04994000
*                     /*                                             */ 04995000
*                     /* IN THE TSO ENVIRONMENT, PASS THE NUMBER OF  */ 04996000
*                     /* PRIMARY AND SECONDARY MESSAGE SEQMENTS.     */ 04997000
*                     /*                                             */ 04998000
*                     /***********************************************/ 04999000
*                                                                  1266 05000000
*                      IF GDTECT ^= 0                      /*@Z40GSJG*/ 05001000
*                        THEN                              /*@Z40GSJG*/ 05002000
         SLR   @04,@04                                             1266 05003000
         C     @04,GDTECT(,GDTPR)                                  1266 05004000
         BE    @RF01266                                            1266 05005000
*                          DO;                             /*@Z40GSJG*/ 05006000
*                          IOCTPML = MFPMRC;               /*@Z40GSJG*/ 05007000
         LH    @03,MFPMRC                                          1268 05008000
         STH   @03,IOCTPML(,IOCSPTR)                               1268 05009000
*                          IOCTSML = MFSMRC;               /*@Z40GSJG*/ 05010000
*                                                                  1269 05011000
         LH    @03,MFSMRC                                          1269 05012000
         STH   @03,IOCTSML(,IOCSPTR)                               1269 05013000
*                          IF MFSMRC = 0                   /*@Z40GSJG*/ 05014000
*                            THEN                          /*@Z40GSJG*/ 05015000
         CR    @03,@04                                             1270 05016000
         BNE   @RF01270                                            1270 05017000
*                              IOCPNM = 1;                 /*@Z40GSJG*/ 05018000
         MVC   IOCPNM(2,IOCSPTR),@CH00216                          1271 05019000
*                            ELSE                          /*@Z40GSJG*/ 05020000
*                              IOCPNM = 2;                 /*@Z40GSJG*/ 05021000
         B     @RC01270                                            1272 05022000
@RF01270 MVC   IOCPNM(2,IOCSPTR),@CH00150                          1272 05023000
*                          END;                            /*@Z40GSJG*/ 05024000
*                        ELSE                              /*@Z40GSJG*/ 05025000
*                          DO;                             /*@Z40GSJG*/ 05026000
         B     @RC01266                                            1274 05027000
@RF01266 DS    0H                                                  1275 05028000
*                          IOCPNM = MFRCNT;                /*@Z40GSJG*/ 05029000
         LH    @04,MFRCNT                                          1275 05030000
         STH   @04,IOCPNM(,IOCSPTR)                                1275 05031000
*                          IOCTPML = 0;                    /*@Z40GSJG*/ 05032000
         SLR   @04,@04                                             1276 05033000
         STH   @04,IOCTPML(,IOCSPTR)                               1276 05034000
*                          IOCTSML = 0;                    /*@Z40GSJG*/ 05035000
         STH   @04,IOCTSML(,IOCSPTR)                               1277 05036000
*                          END;                            /*@Z40GSJG*/ 05037000
*                    END;                                  /*@Y30SSJK*/ 05038000
*                                                                  1279 05039000
@RC01266 DS    0H                                                  1280 05040000
*               CALL IDCIOPT0 (GDTTBL,PCTIOC,PCTPMN);              1280 05041000
*                                                                  1280 05042000
@RF01263 ST    GDTPR,@AL00001                                      1280 05043000
         LA    @04,PCTIOC(,PCTPTR)                                 1280 05044000
         ST    @04,@AL00001+4                                      1280 05045000
         LA    @04,PCTPMN(,PCTPTR)                                 1280 05046000
         ST    @04,@AL00001+8                                      1280 05047000
         MVI   @AL00001+8,X'80'                                    1280 05048000
         L     @15,GDTPUT(,GDTPR)                                  1280 05049000
         LA    @01,@AL00001                                        1280 05050000
         BALR  @14,@15                                             1280 05051000
*               RESPECIFY RTNREG RSTD;                             1281 05052000
*               TESTRC = RTNREG;                                   1282 05053000
         STH   RTNREG,TESTRC                                       1282 05054000
*               RESPECIFY RTNREG UNRSTD;                           1283 05055000
*               IF TESTRC ^= 0                                     1284 05056000
*                 THEN                                             1284 05057000
*                                                                  1284 05058000
         LH    @04,TESTRC                                          1284 05059000
         LTR   @04,@04                                             1284 05060000
         BZ    @RF01284                                            1284 05061000
*                   DO;                                            1285 05062000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           1286 05063000
*                     REG15 = 36;                                  1287 05064000
         LA    REG15,36                                            1287 05065000
*                     REG14 = GDTABT;                              1288 05066000
         L     REG14,GDTABT(,GDTPR)                                1288 05067000
*                     REG13 = GDTABH;                              1289 05068000
         L     REG13,GDTABH(,GDTPR)                                1289 05069000
*                     GEN(BR    REG14);                            1290 05070000
         BR    REG14                                                    05071000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          1291 05072000
*                   END;                                           1292 05073000
*                                                                  1292 05074000
*               PCTPMN = ''B;                                      1293 05075000
@RF01284 SLR   @04,@04                                             1293 05076000
         STH   @04,PCTPMN(,PCTPTR)                                 1293 05077000
*               PCTLLM = ON;                                       1294 05078000
*                                                                  1294 05079000
         OI    PCTLLM(PCTPTR),B'00010000'                          1294 05080000
*               RETURN CODE(0);                                    1295 05081000
*                                                                  1295 05082000
         SLR   @15,@15                                             1295 05083000
         L     @14,@SA00015                                        1295 05084000
         LM    @00,@06,@SA00015+8                                  1295 05085000
         LM    @08,@12,@SA00015+36                                 1295 05086000
         BR    @14                                                 1295 05087000
*             END;                                                 1296 05088000
*         /***********************************************************/ 05089000
*         /*                                                         */ 05090000
*         /* PUT THIS CURRENT LINE IN THE STACK.                     */ 05091000
*         /*                                                         */ 05092000
*         /***********************************************************/ 05093000
*                                                                  1297 05094000
*         IF FFMPSFF = OFF                                         1297 05095000
*           THEN                                                   1297 05096000
@RF01256 TM    FFMPSFF,B'00100000'                                 1297 05097000
         BNZ   @RF01297                                            1297 05098000
*             DO;                                                  1298 05099000
*               STACKLL = N;                                       1299 05100000
         L     @04,PCTBNL(,PCTPTR)                                 1299 05101000
         STCM  N,3,STACKLL(@04)                                    1299 05102000
*               STACKDL(1:N) = PUTLINE(1:N);                       1300 05103000
         LR    @03,N                                               1300 05104000
         BCTR  @03,0                                               1300 05105000
         L     @15,@PC00015                                        1300 05106000
         EX    @03,@SM01064                                        1300 05107000
*               PCTLNM = PCTLNM + 1;                               1301 05108000
         LA    @03,1                                               1301 05109000
         AH    @03,PCTLNM(,PCTPTR)                                 1301 05110000
         STH   @03,PCTLNM(,PCTPTR)                                 1301 05111000
*               PCTBNL = PCTBNL + N + 2;                           1302 05112000
         ALR   @04,N                                               1302 05113000
         AL    @04,@CF00150                                        1302 05114000
         ST    @04,PCTBNL(,PCTPTR)                                 1302 05115000
*             END;                                                 1303 05116000
*         FFMPSFF = OFF;                                           1304 05117000
*                                                                  1304 05118000
@RF01297 NI    FFMPSFF,B'11011111'                                 1304 05119000
*         RETURN CODE(0);                                          1305 05120000
*                                                                  1305 05121000
         SLR   @15,@15                                             1305 05122000
         L     @14,@SA00015                                        1305 05123000
         LM    @00,@06,@SA00015+8                                  1305 05124000
         LM    @08,@12,@SA00015+36                                 1305 05125000
         BR    @14                                                 1305 05126000
*         END STACKPUT;                                            1306 05127000
*         /***********************************************************/ 05128000
*         /*                                                         */ 05129000
*         /* PROCEDURE NAME - ERROR PROCEDURE.                       */ 05130000
*         /*                                                         */ 05131000
*         /* FUNCTION - CAUSE THE PRINTING OF TP ERROR MESSAGES.     */ 05132000
*         /*                                                         */ 05133000
*         /* INPUT - A CODE INDICATING THE ERROR MESSAGE TO BE PUT.  */ 05134000
*         /*                                                         */ 05135000
*         /* OUTPUT - A TEXT PROCESSING ERROR MESSAGE.               */ 05136000
*         /*                                                         */ 05137000
*         /***********************************************************/ 05138000
*                                                                  1307 05139000
*ERROR:   PROC (ERRCODE);                                          1307 05140000
*                                                                  1307 05141000
ERROR    STM   @14,@06,@SA00016                                    1307 05142000
         STM   @08,@12,@SA00016+36                                 1307 05143000
         MVC   @PC00016(4),0(@01)                                  1307 05144000
*         DCL CVPSAVP PTR(31);                                     1308 05145000
*         DCL  1 CVPSAV  BASED(CVPSAVP),                   /*@Y30SSJK*/ 05146000
*          2 CVPSAV1 CHAR(LENGTH(CVPSTRU1)),                       1309 05147000
*          2 CVPSAV2 CHAR(LENGTH(CVPSTRU2));               /*@Y30SSJK*/ 05148000
*                                                                  1309 05149000
*         IF GDTDBG = NULLPTR                                      1310 05150000
*           THEN;                                                  1310 05151000
         L     @06,GDTDBG(,GDTPR)                                  1310 05152000
         LTR   @06,@06                                             1310 05153000
         BZ    @RT01310                                            1310 05154000
*           ELSE                                                   1312 05155000
*             CALL IDCDB010 (GDTTBL,'TPER');                       1312 05156000
*                                                                  1312 05157000
         ST    GDTPR,@AL00001                                      1312 05158000
         LA    @06,@CC01006                                        1312 05159000
         ST    @06,@AL00001+4                                      1312 05160000
         MVI   @AL00001+4,X'80'                                    1312 05161000
         L     @15,GDTDBG(,GDTPR)                                  1312 05162000
         LA    @01,@AL00001                                        1312 05163000
         BALR  @14,@15                                             1312 05164000
*         STIDMOD = STMODID;           /* SET MODULE IDENT           */ 05165000
@RT01310 MVC   STIDMOD(3),STMODID                                  1313 05166000
*         STIDENT = ERRCODE;            /* SET THE ENTRY NUMBER.     */ 05167000
*                                                                  1314 05168000
         L     @06,@PC00016                                        1314 05169000
         L     @06,ERRCODE(,@06)                                   1314 05170000
         STC   @06,STIDENT                                         1314 05171000
*         CALL IDCTP05(GDTTBL,STID,GPOOL,MSGAREA);         /*@YL026UE*/ 05172000
*                                                                  1315 05173000
         ST    GDTPR,@AL00001                                      1315 05174000
         LA    @06,STID                                            1315 05175000
         ST    @06,@AL00001+4                                      1315 05176000
         LA    @06,GPOOL                                           1315 05177000
         ST    @06,@AL00001+8                                      1315 05178000
         LA    @06,MSGAREA                                         1315 05179000
         ST    @06,@AL00001+12                                     1315 05180000
         L     @15,@CV00881                                        1315 05181000
         LA    @01,@AL00001                                        1315 05182000
         BALR  @14,@15                                             1315 05183000
*         RESPECIFY RTNREG RSTD;                                   1316 05184000
*         TESTRC = RTNREG;                                         1317 05185000
         STH   RTNREG,TESTRC                                       1317 05186000
*         RESPECIFY RTNREG UNRSTD;                                 1318 05187000
*         IF TESTRC ^= 0                                           1319 05188000
*           THEN                                                   1319 05189000
         LH    @06,TESTRC                                          1319 05190000
         LTR   @06,@06                                             1319 05191000
         BZ    @RF01319                                            1319 05192000
*             RETURN CODE(RCQUIT);                                 1320 05193000
*                                                                  1320 05194000
         LH    @15,RCQUIT                                          1320 05195000
         L     @14,@SA00016                                        1320 05196000
         LM    @00,@06,@SA00016+8                                  1320 05197000
         LM    @08,@12,@SA00016+36                                 1320 05198000
         BR    @14                                                 1320 05199000
*         CALL IDCSAGS0 (GDTTBL,LENGTH(CVPSTRU),CVPSAVP);          1321 05200000
*                                                                  1321 05201000
@RF01319 ST    GDTPR,@AL00001                                      1321 05202000
         LA    @06,@CF01012                                        1321 05203000
         ST    @06,@AL00001+4                                      1321 05204000
         LA    @06,CVPSAVP                                         1321 05205000
         ST    @06,@AL00001+8                                      1321 05206000
         MVI   @AL00001+8,X'80'                                    1321 05207000
         L     @15,GDTGSP(,GDTPR)                                  1321 05208000
         LA    @01,@AL00001                                        1321 05209000
         BALR  @14,@15                                             1321 05210000
*         RESPECIFY RTNREG RSTD;                                   1322 05211000
*         TESTRC = RTNREG;                                         1323 05212000
         STH   RTNREG,TESTRC                                       1323 05213000
*         RESPECIFY RTNREG UNRSTD;                                 1324 05214000
*         IF TESTRC ^= 0                                           1325 05215000
*           THEN                                                   1325 05216000
*                                                                  1325 05217000
         LH    @06,TESTRC                                          1325 05218000
         LTR   @06,@06                                             1325 05219000
         BZ    @RF01325                                            1325 05220000
*             DO;                                                  1326 05221000
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 1327 05222000
*               REG15 = 28;                                        1328 05223000
         LA    REG15,28                                            1328 05224000
*               REG14 = GDTABT;                                    1329 05225000
         L     REG14,GDTABT(,GDTPR)                                1329 05226000
*               REG13 = GDTABH;                                    1330 05227000
         L     REG13,GDTABH(,GDTPR)                                1330 05228000
*               GEN(BR    REG14);                                  1331 05229000
         BR    REG14                                                    05230000
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                1332 05231000
*             END;                                                 1333 05232000
*                                                                  1333 05233000
*         PCTPMN = ERRCODE + 949;       /* SET MESSAGE NUMBER.       */ 05234000
@RF01325 L     @06,@PC00016                                        1334 05235000
         LA    @04,949                                             1334 05236000
         AL    @04,ERRCODE(,@06)                                   1334 05237000
         STH   @04,PCTPMN(,PCTPTR)                                 1334 05238000
*         CVPSAV1 = CVPSTRU1;           /* SAVE ARGUMENT     @Y30SSJK*/ 05239000
         L     @06,CVPSAVP                                         1335 05240000
         MVC   CVPSAV1(162,@06),CVPSTRU1                           1335 05241000
*         CVPSAV2 = CVPSTRU2;           /* SAVE ARGUMENT     @Y30SSJK*/ 05242000
         MVC   CVPSAV2(137,@06),CVPSTRU2                           1336 05243000
*         PCTLLM = ON;                  /* SET MESSAGE FLAG.         */ 05244000
         OI    PCTLLM(PCTPTR),B'00010000'                          1337 05245000
*         PRTSPF = 2;                   /* SET SPACING FACTOR.       */ 05246000
         MVC   PRTSPF(2),@CH00150                                  1338 05247000
*         PRTSPT = 'R ';                /* SET SPACING TYPE.         */ 05248000
         MVI   PRTSPT,C'R'                                         1339 05249000
*         PRTBUFF = ' ';                /* CLEAR THE BUFFER.         */ 05250000
         L     @06,PRTBUFPT                                        1340 05251000
         MVI   PRTBUFF+1(@06),C' '                                 1340 05252000
         MVC   PRTBUFF+2(133,@06),PRTBUFF+1(@06)                   1340 05253000
         MVI   PRTBUFF(@06),C' '                                   1340 05254000
*         PRTBUFF(1:MSGLEN) = MSGTXT(1:MSGLEN);                    1341 05255000
         L     @04,MSGAREA                                         1341 05256000
         LH    @03,MSGLEN(,@04)                                    1341 05257000
         BCTR  @03,0                                               1341 05258000
         EX    @03,@SM01066                                        1341 05259000
*                                       /* MOVE MESSAGE TO BUFFER.   */ 05260000
*                                                                  1342 05261000
*         CALL LINEPRT;                                            1342 05262000
*                                                                  1342 05263000
         BAL   @14,LINEPRT                                         1342 05264000
*         RESPECIFY RTNREG RSTD;                                   1343 05265000
*         TESTRC = RTNREG;                                         1344 05266000
         STH   RTNREG,TESTRC                                       1344 05267000
*         RESPECIFY RTNREG UNRSTD;                                 1345 05268000
*         CVPSTRU1 = CVPSAV1;           /* RESTORE ARGUMENT  @Y30SSJK*/ 05269000
         L     @06,CVPSAVP                                         1346 05270000
         MVC   CVPSTRU1(162),CVPSAV1(@06)                          1346 05271000
*         CVPSTRU2 = CVPSAV2;           /* RESTORE ARGUMENT  @Y30SSJK*/ 05272000
*                                                                  1347 05273000
         MVC   CVPSTRU2(137),CVPSAV2(@06)                          1347 05274000
*         CALL IDCSAFS0 (GDTTBL,CVPSAVP);/*                        1348 05275000
*                                          FREE PRINT ARGUMENT SPACE */ 05276000
*                                                                  1348 05277000
         ST    GDTPR,@AL00001                                      1348 05278000
         LA    @06,CVPSAVP                                         1348 05279000
         ST    @06,@AL00001+4                                      1348 05280000
         L     @15,GDTFSP(,GDTPR)                                  1348 05281000
         LA    @01,@AL00001                                        1348 05282000
         BALR  @14,@15                                             1348 05283000
*         CALL IDCSAFS0 (GDTTBL,MSGAREA);/*                        1349 05284000
*                                          FREE STATIC TEXT SPACE.   */ 05285000
*                                                                  1349 05286000
         ST    GDTPR,@AL00001                                      1349 05287000
         LA    @06,MSGAREA                                         1349 05288000
         ST    @06,@AL00001+4                                      1349 05289000
         L     @15,GDTFSP(,GDTPR)                                  1349 05290000
         LA    @01,@AL00001                                        1349 05291000
         BALR  @14,@15                                             1349 05292000
*         RETURN CODE (TESTRC);                                    1350 05293000
         LH    @15,TESTRC                                          1350 05294000
         L     @14,@SA00016                                        1350 05295000
         LM    @00,@06,@SA00016+8                                  1350 05296000
         LM    @08,@12,@SA00016+36                                 1350 05297000
         BR    @14                                                 1350 05298000
*         END ERROR;                                               1351 05299000
*         /***********************************************************/ 05300000
*         /*                                                         */ 05301000
*         /* PROCEDURE NAME - MESSAGE FORMAT PROCEDURE.              */ 05302000
*         /*                                                         */ 05303000
*         /* FUNCTION - SEGMENT AND FORMAT MESSAGES INTO ALLOWABLE   */ 05304000
*         /*                                                         */ 05305000
*         /* INPUT - THE MESSAGE TEXT(S) IN THE LINE FORMAT BUBBER.  */ 05306000
*         /*                                                         */ 05307000
*         /* OUTPUT - AS MANY MESSAGE LINES AS REQUIRED TO PRINT     */ 05308000
*         /*          THE COMPLETE MESSAGE.                          */ 05309000
*         /*                                                         */ 05310000
*         /***********************************************************/ 05311000
*                                                                  1352 05312000
*SEGMENT: PROC;                                            /*@Z40GSJG*/ 05313000
SEGMENT  STM   @14,@06,12(@13)                                     1352 05314000
         STM   @08,@12,52(@13)                                     1352 05315000
*         /***********************************************************/ 05316000
*         /*                                                         */ 05317000
*         /* BEGINNING OF THE MESSAGE LINE FORMAT PROCEDURE.         */ 05318000
*         /*                                                         */ 05319000
*         /***********************************************************/ 05320000
*                                                                  1353 05321000
*         MFFLAG = ''B;                                    /*@Z40GSJG*/ 05322000
         MVI   MFFLAG,X'00'                                        1353 05323000
*         MFFGO = ON;                                      /*@Z40GSJG*/ 05324000
*         MFFP1 = ON;                                      /*@Z40GSJG*/ 05325000
         OI    MFFGO,B'11000000'                                   1355 05326000
*         MFRCNT = 0;                                      /*@Z40GSJG*/ 05327000
         SLR   @04,@04                                             1356 05328000
         STH   @04,MFRCNT                                          1356 05329000
*         MFPMRC = 0;                                      /*@Z40GSJG*/ 05330000
         STH   @04,MFPMRC                                          1357 05331000
*         MFSMRC = 0;                                      /*@Z40GSJG*/ 05332000
         STH   @04,MFSMRC                                          1358 05333000
*         MFTRL = 0;                                       /*@Z40GSJG*/ 05334000
         ST    @04,MFTRL                                           1359 05335000
*         PRTLNPTR = ADDR(PRBUFF);                         /*@Z40GSJG*/ 05336000
*                                                                  1360 05337000
         LA    @04,PRBUFF                                          1360 05338000
         ST    @04,PRTLNPTR                                        1360 05339000
*         /***********************************************************/ 05340000
*         /*                                                         */ 05341000
*         /* CALCULATE THE MESSAGE LINE LENGTH. A MESSAGE CANNOT     */ 05342000
*         /* EXCEED SEVENTY-TWO(72) CHARACTERS OR THE PRINT LINE     */ 05343000
*         /* WIDTH, WHICHEVER IS THE SHORTEST.                       */ 05344000
*         /*                                                         */ 05345000
*         /***********************************************************/ 05346000
*                                                                  1361 05347000
*         IF PCTPLW < 72                                   /*@Z40GSJG*/ 05348000
*           THEN                                           /*@Z40GSJG*/ 05349000
*                                                                  1361 05350000
         L     @04,PCTPLW(,PCTPTR)                                 1361 05351000
         C     @04,@CF00794                                        1361 05352000
         BNL   @RF01361                                            1361 05353000
*             MFMLL = PCTPLW;                              /*@Z40GSJG*/ 05354000
*                                                                  1362 05355000
         STH   @04,MFMLL                                           1362 05356000
*           ELSE                                           /*@Z40GSJG*/ 05357000
*                                                                  1363 05358000
*             MFMLL = 72;                                  /*@Z40GSJG*/ 05359000
*                                                                  1363 05360000
         B     @RC01361                                            1363 05361000
@RF01361 MVC   MFMLL(2),@CH00794                                   1363 05362000
*         /***********************************************************/ 05363000
*         /*                                                         */ 05364000
*         /* DETERMINE IF THE PROCESSING IS FOR PRIMARY MESSAGE OR   */ 05365000
*         /* FOR A SECONDARY MESSAGE. SET INPUT BUFFER ACCORDINGLY.  */ 05366000
*         /*                                                         */ 05367000
*         /***********************************************************/ 05368000
*                                                                  1364 05369000
*         DO UNTIL MFFGO = OFF;                            /*@Z40GSJG*/ 05370000
*                                                                  1364 05371000
@RC01361 DS    0H                                                  1364 05372000
@DL01364 DS    0H                                                  1365 05373000
*         IF MFFP1 = ON                                    /*@Z40GSJG*/ 05374000
*           THEN                                           /*@Z40GSJG*/ 05375000
         TM    MFFP1,B'01000000'                                   1365 05376000
         BNO   @RF01365                                            1365 05377000
*             DO;                                          /*@Z40GSJG*/ 05378000
*                                                                  1366 05379000
*             MFINPTR = ADDR(PRLINE);                      /*@OZ12170*/ 05380000
*                                                                  1367 05381000
         LA    MFINPTR,PRLINE                                      1367 05382000
*             MFMRCPT = ADDR(MFPMRC);                      /*@Z40GSJG*/ 05383000
*                                                                  1368 05384000
         LA    @04,MFPMRC                                          1368 05385000
         ST    @04,MFMRCPT                                         1368 05386000
*             MFFP1 = OFF;                                 /*@Z40GSJG*/ 05387000
*                                                                  1369 05388000
         NI    MFFP1,B'10111111'                                   1369 05389000
*             END;                                         /*@Z40GSJG*/ 05390000
*                                                                  1370 05391000
*           ELSE                                           /*@Z40GSJG*/ 05392000
*             DO;                                          /*@Z40GSJG*/ 05393000
*                                                                  1371 05394000
         B     @RC01365                                            1371 05395000
@RF01365 DS    0H                                                  1372 05396000
*             MFINPTR = ADDR(PRLINES);                     /*@OZ12170*/ 05397000
*                                                                  1372 05398000
         LA    MFINPTR,PRLINES                                     1372 05399000
*             MFMRCPT = ADDR(MFSMRC);                      /*@Z40GSJG*/ 05400000
*                                                                  1373 05401000
         LA    @04,MFSMRC                                          1373 05402000
         ST    @04,MFMRCPT                                         1373 05403000
*             MFFGO = OFF;                                 /*@Z40GSJG*/ 05404000
*                                                                  1374 05405000
         NI    MFFGO,B'01111111'                                   1374 05406000
*             END;                                         /*@Z40GSJG*/ 05407000
*                                                                  1375 05408000
*         /***********************************************************/ 05409000
*         /*                                                         */ 05410000
*         /* CLEAR MESSAGE WORK BUFFER AND MOVE MESSAGE TEXT INTO IT.*/ 05411000
*         /*                                                         */ 05412000
*         /***********************************************************/ 05413000
*                                                                  1376 05414000
*          MFMBUF = ' ';                                   /*@Z40GSJG*/ 05415000
*                                                                  1376 05416000
@RC01365 MVI   MFMBUF+1,C' '                                       1376 05417000
         MVC   MFMBUF+2(134),MFMBUF+1                              1376 05418000
         MVI   MFMBUF,C' '                                         1376 05419000
*          MFMBUF = MFINBUF;                               /*@OZ12170*/ 05420000
*                                                                  1377 05421000
         MVC   MFMBUF(136),MFINBUF(MFINPTR)                        1377 05422000
*         /**************************************************@OZ18517*/ 05423000
*         /*                                                 @OZ18517*/ 05424000
*         /* MESSAGE NUMBER PROCESSING IS NOT REQUIRED IF THE@OZ18517*/ 05425000
*         /* USER HAS INCLUDED EMBEDDED SPACING SUBSTRUCTURES@OZ18517*/ 05426000
*         /* IN THE FORMAT LIST. IF MESSAGE NUMBER PROCESSING@OZ18517*/ 05427000
*         /* IS TO BE SUPPRESSED, SET MESSSAGE NUMBER LENGTH @OZ18517*/ 05428000
*         /* TO ZERO, OTHER WISE, CALCULATE MESSAGE NUMBER   @OZ18517*/ 05429000
*         /* LENGTH.                                         @OZ18517*/ 05430000
*         /*                                                 @OZ18517*/ 05431000
*         /**************************************************@OZ18517*/ 05432000
*         IF FFM2SMN = OFF                                 /*@OZ18517*/ 05433000
*           THEN                                           /*@OZ18517*/ 05434000
         TM    FFM2SMN,B'10000000'                                 1378 05435000
         BNZ   @RF01378                                            1378 05436000
*             DO;                                          /*@OZ18517*/ 05437000
*                                                          /*@OZ18517*/ 05438000
*             /**********************************************@OZ18517*/ 05439000
*             /*                                             @OZ18517*/ 05440000
*             /* CALCULATE THE MESSAGE NUMBER LENGTH         @OZ18517*/ 05441000
*             /*                                             @OZ18517*/ 05442000
*             /**********************************************@OZ18517*/ 05443000
*                                                                  1380 05444000
*             DO MFMNL = 1 TO MFMML BY 1                   /*@OZ18517*/ 05445000
*                            WHILE MFMBUF(MFMNL) ^=' ';    /*@OZ18517*/ 05446000
         LA    MFMNL,1                                             1380 05447000
         B     @DE01380                                            1380 05448000
@DL01380 LA    @03,MFMBUF-1(MFMNL)                                 1380 05449000
         CLI   0(@03),C' '                                         1380 05450000
         BE    @DC01380                                            1380 05451000
*             END;                                         /*@OZ18517*/ 05452000
         AL    MFMNL,@CF00216                                      1381 05453000
@DE01380 CH    MFMNL,MFMML                                         1381 05454000
         BNH   @DL01380                                            1381 05455000
@DC01380 DS    0H                                                  1382 05456000
*             MFMNL = MFMNL - 1;                           /*@OZ18517*/ 05457000
         BCTR  MFMNL,0                                             1382 05458000
*             END;                                         /*@Z40GSJG*/ 05459000
*           ELSE                                           /*@OZ18517*/ 05460000
*             MFMNL = 0;                                   /*@OZ18517*/ 05461000
*                                                                  1384 05462000
         B     @RC01378                                            1384 05463000
@RF01378 SLR   MFMNL,MFMNL                                         1384 05464000
*         /***********************************************************/ 05465000
*         /*                                                         */ 05466000
*         /* CALCULATE THE TRANSLATED MESSAGE LENGTH                 */ 05467000
*         /*                                                         */ 05468000
*         /***********************************************************/ 05469000
*                                                                  1385 05470000
*         DO MFML = (LENGTH(MFMBUF)) TO 1 BY - 1           /*@Z40GSJG*/ 05471000
*             WHILE MFMBUF(MFML) = ' ';                    /*@Z40GSJG*/ 05472000
@RC01378 LA    @03,136                                             1385 05473000
         STH   @03,MFML                                            1385 05474000
@DL01385 LA    @01,MFMBUF-1(@03)                                   1385 05475000
         CLI   0(@01),C' '                                         1385 05476000
         BNE   @DC01385                                            1385 05477000
*         END;                                             /*@Z40GSJG*/ 05478000
*                                                                  1386 05479000
         BCTR  @03,0                                               1386 05480000
         STH   @03,MFML                                            1386 05481000
         LTR   @03,@03                                             1386 05482000
         BP    @DL01385                                            1386 05483000
@DC01385 DS    0H                                                  1387 05484000
*         /***********************************************************/ 05485000
*         /*                                                         */ 05486000
*         /* INITIALIZE THE COMMON DATA ELEMENTS FOR THE FORMAT      */ 05487000
*         /* PROCESS.                                                */ 05488000
*         /*                                                         */ 05489000
*         /***********************************************************/ 05490000
*                                                                  1387 05491000
*         MFRC = MFML;                                     /*@Z40GSJG*/ 05492000
*                                                                  1387 05493000
         LH    @03,MFML                                            1387 05494000
         STH   @03,MFRC                                            1387 05495000
*         MFFPASS = ON;                                    /*@Z40GSJG*/ 05496000
*                                                                  1388 05497000
         OI    MFFPASS,B'00100000'                                 1388 05498000
*         /***********************************************************/ 05499000
*         /*                                                         */ 05500000
*         /* THE FOLLOWING LOOP WILL SEGMENT THE MESSAGE TO BE       */ 05501000
*         /* PRINTED INTO THE PRINT LINE WIDTHS REQUIRED. THE MESSAGE*/ 05502000
*         /* NUMBER WILL BE ADDED AT THE FIRST PART OF EACH LINE.    */ 05503000
*         /* THE LINE WILL BE SEGMENTED AT BLANKS WITHIN THE TEXT.   */ 05504000
*         /*                                                         */ 05505000
*         /***********************************************************/ 05506000
*                                                                  1389 05507000
*         DO UNTIL MFRC <= 0;                              /*@Z40GSJG*/ 05508000
*                                                                  1389 05509000
@DL01389 DS    0H                                                  1390 05510000
*         IF MFFPASS = ON                                  /*@Z40GSJG*/ 05511000
*           THEN                                           /*@Z40GSJG*/ 05512000
         TM    MFFPASS,B'00100000'                                 1390 05513000
         BNO   @RF01390                                            1390 05514000
*             DO;                                          /*@Z40GSJG*/ 05515000
*                                                                  1391 05516000
*             IF MFML > MFMLL                              /*@Z40GSJG*/ 05517000
*               THEN                                       /*@Z40GSJG*/ 05518000
*                                                                  1392 05519000
         LH    @03,MFMLL                                           1392 05520000
         CH    @03,MFML                                            1392 05521000
         BNL   @RF01392                                            1392 05522000
*                 MFSL = MFMLL;                            /*@Z40GSJG*/ 05523000
*                                                                  1393 05524000
         LH    @15,MFMLL                                           1393 05525000
         LR    MFSL,@15                                            1393 05526000
*               ELSE                                       /*@Z40GSJG*/ 05527000
*                                                                  1394 05528000
*                 MFSL = MFML + 1;                         /*@Z40GSJG*/ 05529000
*                                                                  1394 05530000
         B     @RC01392                                            1394 05531000
@RF01392 LA    MFSL,1                                              1394 05532000
         AH    MFSL,MFML                                           1394 05533000
*             MFBGNT = MFMNL + 1;                          /*@Z40GSJG*/ 05534000
*                                                                  1395 05535000
@RC01392 LA    @01,1(,MFMNL)                                       1395 05536000
         STH   @01,MFBGNT                                          1395 05537000
*             MFCC = PRCC;                                 /*@Z40GSJG*/ 05538000
*                                                                  1396 05539000
         MVC   MFCC(1),PRCC                                        1396 05540000
*             END;                                         /*@Z40GSJG*/ 05541000
*                                                                  1397 05542000
*           ELSE                                           /*@Z40GSJG*/ 05543000
*             DO;                                          /*@Z40GSJG*/ 05544000
*                                                                  1398 05545000
         B     @RC01390                                            1398 05546000
@RF01390 DS    0H                                                  1399 05547000
*             IF (MFRC + MFMNL) > MFMLL                    /*@Z40GSJG*/ 05548000
*               THEN                                       /*@Z40GSJG*/ 05549000
*                                                                  1399 05550000
         LH    @03,MFMLL                                           1399 05551000
         LR    @15,MFMNL                                           1399 05552000
         AH    @15,MFRC                                            1399 05553000
         CR    @15,@03                                             1399 05554000
         BNH   @RF01399                                            1399 05555000
*                 MFSL = MFMLL;                            /*@Z40GSJG*/ 05556000
*                                                                  1400 05557000
         LH    @15,MFMLL                                           1400 05558000
         LR    MFSL,@15                                            1400 05559000
*               ELSE                                       /*@Z40GSJG*/ 05560000
*                                                                  1401 05561000
*                 MFSL = MFRC + MFMNL + 1;                 /*@Z40GSJG*/ 05562000
*                                                                  1401 05563000
         B     @RC01399                                            1401 05564000
@RF01399 LR    MFSL,MFMNL                                          1401 05565000
         AH    MFSL,MFRC                                           1401 05566000
         AL    MFSL,@CF00216                                       1401 05567000
*             MFCC = PRCCON(2);                            /*@Z40GSJG*/ 05568000
*                                                                  1402 05569000
@RC01399 MVC   MFCC(1),PRCCON+1                                    1402 05570000
*             END;                                         /*@Z40GSJG*/ 05571000
*                                                                  1403 05572000
*         /***********************************************************/ 05573000
*         /*                                                         */ 05574000
*         /* CALCULATE THE MESSAGE SEGMENT LENGTH AND THE MESSAGE    */ 05575000
*         /* SEGMENT END POINT.                                      */ 05576000
*         /*                                                         */ 05577000
*         /***********************************************************/ 05578000
*                                                                  1404 05579000
*         MFMSL = MFSL - MFMNL;                            /*@Z40GSJG*/ 05580000
*                                                                  1404 05581000
@RC01390 LR    MFMSL,MFSL                                          1404 05582000
         SLR   MFMSL,MFMNL                                         1404 05583000
*         MFENDT = MFBGNT + MFMSL - 1;                     /*@Z40GSJG*/ 05584000
*                                                                  1405 05585000
         LR    @07,MFMSL                                           1405 05586000
         AH    @07,MFBGNT                                          1405 05587000
         BCTR  @07,0                                               1405 05588000
         STH   @07,MFENDT                                          1405 05589000
*         /***********************************************************/ 05590000
*         /*                                                         */ 05591000
*         /* FIND THE CLOSEST BLANK CHARACTER TO THE SEGMENT LENGTH  */ 05592000
*         /* AND CALCULATE THE NEW MESSAGE SEGMENT LENGTH, SEGMENT   */ 05593000
*         /* LENGTH AND THE NEW END TEXT POINT.                      */ 05594000
*         /*                                                         */ 05595000
*         /***********************************************************/ 05596000
*                                                                  1406 05597000
*         IF MFSL < MFMLL                                  /*@Z40GSJG*/ 05598000
*           THEN                                           /*@Z40GSJG*/ 05599000
*                                                                  1406 05600000
         CH    MFSL,MFMLL                                          1406 05601000
         BNL   @RF01406                                            1406 05602000
*             DO N = MFENDT TO MFBGNT BY - 1               /*@Z40GSJG*/ 05603000
*                  WHILE MFMBUF(N) = ' ';                  /*@Z40GSJG*/ 05604000
*                                                                  1407 05605000
         LH    @15,MFENDT                                          1407 05606000
         LR    N,@15                                               1407 05607000
         B     @DE01407                                            1407 05608000
@DL01407 LA    @01,MFMBUF-1(N)                                     1407 05609000
         CLI   0(@01),C' '                                         1407 05610000
         BNE   @DC01407                                            1407 05611000
*             MFSL = MFSL - 1;                             /*@Z40GSJG*/ 05612000
         BCTR  MFSL,0                                              1408 05613000
*             MFMSL = MFMSL - 1;                           /*@Z40GSJG*/ 05614000
         BCTR  MFMSL,0                                             1409 05615000
*             MFENDT = MFENDT - 1;                         /*@Z40GSJG*/ 05616000
*                                                                  1410 05617000
         LH    @15,MFENDT                                          1410 05618000
         BCTR  @15,0                                               1410 05619000
         STH   @15,MFENDT                                          1410 05620000
*             END;                                         /*@Z40GSJG*/ 05621000
*                                                                  1411 05622000
         BCTR  N,0                                                 1411 05623000
@DE01407 CH    N,MFBGNT                                            1411 05624000
         BNL   @DL01407                                            1411 05625000
@DC01407 DS    0H                                                  1412 05626000
*           ELSE                                           /*@Z40GSJG*/ 05627000
*                                                                  1412 05628000
*             DO;                                          /*@Z40GSJG*/ 05629000
*                                                                  1412 05630000
         B     @RC01406                                            1412 05631000
@RF01406 DS    0H                                                  1413 05632000
*             DO N = MFENDT TO MFBGNT BY -1                /*@Z40GSJG*/ 05633000
*                  WHILE MFMBUF(N) ^= ' ';                 /*@Z40GSJG*/ 05634000
*                                                                  1413 05635000
         LH    N,MFENDT                                            1413 05636000
         B     @DE01413                                            1413 05637000
@DL01413 LA    @01,MFMBUF-1(N)                                     1413 05638000
         CLI   0(@01),C' '                                         1413 05639000
         BE    @DC01413                                            1413 05640000
*             MFSL = MFSL - 1;                             /*@Z40GSJG*/ 05641000
         BCTR  MFSL,0                                              1414 05642000
*             MFMSL = MFMSL - 1;                           /*@Z40GSJG*/ 05643000
         BCTR  MFMSL,0                                             1415 05644000
*             MFENDT = MFENDT - 1;                         /*@Z40GSJG*/ 05645000
*                                                                  1416 05646000
         LH    @15,MFENDT                                          1416 05647000
         BCTR  @15,0                                               1416 05648000
         STH   @15,MFENDT                                          1416 05649000
*             END;                                         /*@Z40GSJG*/ 05650000
*                                                                  1417 05651000
         BCTR  N,0                                                 1417 05652000
@DE01413 CH    N,MFBGNT                                            1417 05653000
         BNL   @DL01413                                            1417 05654000
@DC01413 DS    0H                                                  1418 05655000
*             MFENDT = MFENDT - 1;                         /*@Z40GSJG*/ 05656000
*                                                                  1418 05657000
         LH    @15,MFENDT                                          1418 05658000
         BCTR  @15,0                                               1418 05659000
         STH   @15,MFENDT                                          1418 05660000
*             MFSL = MFSL - 1;                             /*@Z40GSJG*/ 05661000
*                                                                  1419 05662000
         BCTR  MFSL,0                                              1419 05663000
*             MFMSL = MFMSL - 1;                           /*@Z40GSJG*/ 05664000
*                                                                  1420 05665000
         BCTR  MFMSL,0                                             1420 05666000
*             END;                                         /*@Z40GSJG*/ 05667000
*                                                                  1421 05668000
*         IF MFFPASS = ON                                  /*@Z40GSJG*/ 05669000
*           THEN                                           /*@Z40GSJG*/ 05670000
@RC01406 TM    MFFPASS,B'00100000'                                 1422 05671000
         BNO   @RF01422                                            1422 05672000
*             DO;                                          /*@Z40GSJG*/ 05673000
*                                                                  1423 05674000
*             MFRC = MFRC - MFSL;                          /*@Z40GSJG*/ 05675000
*                                                                  1424 05676000
         LH    @15,MFRC                                            1424 05677000
         SLR   @15,MFSL                                            1424 05678000
         STH   @15,MFRC                                            1424 05679000
*             MFFPASS = OFF;                               /*@Z40GSJG*/ 05680000
*                                                                  1425 05681000
         NI    MFFPASS,B'11011111'                                 1425 05682000
*             END;                                         /*@Z40GSJG*/ 05683000
*                                                                  1426 05684000
*           ELSE                                           /*@Z40GSJG*/ 05685000
*                                                                  1427 05686000
*             MFRC = MFRC - MFMSL;                         /*@Z40GSJG*/ 05687000
*                                                                  1427 05688000
         B     @RC01422                                            1427 05689000
@RF01422 LH    @15,MFRC                                            1427 05690000
         SLR   @15,MFMSL                                           1427 05691000
         STH   @15,MFRC                                            1427 05692000
*         /***********************************************************/ 05693000
*         /*                                                         */ 05694000
*         /* MOVE THE MESSAGE NUMBER AND AS MUCH OF THE MESSAGE TEXT */ 05695000
*         /* AS WILL FIT ON A LINE TO RECORD BUFFER. IF THE  @OZ18517*/ 05696000
*         /* SUPPRESS MESSAGE NUMBER FLAG IS ON AN EMBEDDED  @OZ18517*/ 05697000
*         /* SPACING SUBSTRUCTURE HAS BEEN FOUND AND IT IS   @OZ18517*/ 05698000
*         /* ASSUMED THAT THE USER HAS DONE HIS OWN SEGMENTS.@OZ18517*/ 05699000
*         /* DO NOT MOVE THE MESSGAE NUMBER.                 @OZ18517*/ 05700000
*         /*                                                 @OZ18517*/ 05701000
*         /***********************************************************/ 05702000
*                                                                  1428 05703000
*         IF FFM2SMN = OFF                                 /*@OZ18517*/ 05704000
*           THEN                                           /*@OZ18517*/ 05705000
@RC01422 TM    FFM2SMN,B'10000000'                                 1428 05706000
         BNZ   @RF01428                                            1428 05707000
*             PRTLNTXT = MFMBUF(1:MFMNL);                  /*@OZ18517*/ 05708000
         L     @01,PRTLNPTR                                        1429 05709000
         MVI   PRTLNTXT+1(@01),C' '                                1429 05710000
         MVC   PRTLNTXT+2(70,@01),PRTLNTXT+1(@01)                  1429 05711000
         LR    @15,MFMNL                                           1429 05712000
         BCTR  @15,0                                               1429 05713000
         EX    @15,@SM01068                                        1429 05714000
*           ELSE;                                          /*@OZ18517*/ 05715000
@RF01428 DS    0H                                                  1431 05716000
*         MFPLB = MFMNL + 1;                               /*@Z40GSJG*/ 05717000
*                                                                  1431 05718000
         LR    @15,MFMNL                                           1431 05719000
         AL    @15,@CF00216                                        1431 05720000
         STH   @15,MFPLB                                           1431 05721000
*         MFPLE = MFMNL + MFMSL;                           /*@Z40GSJG*/ 05722000
*                                                                  1432 05723000
         LR    @14,MFMNL                                           1432 05724000
         ALR   @14,MFMSL                                           1432 05725000
         STH   @14,MFPLE                                           1432 05726000
*         PRTLNTXT(MFPLB:MFPLE) = MFMBUF(MFBGNT:MFENDT);   /*@Z40GSJG*/ 05727000
*                                                                  1433 05728000
         L     @01,PRTLNPTR                                        1433 05729000
         ALR   @15,@01                                             1433 05730000
         LH    @00,MFPLB                                           1433 05731000
         LCR   @00,@00                                             1433 05732000
         ALR   @00,@14                                             1433 05733000
         LH    @01,MFBGNT                                          1433 05734000
         LA    @14,MFMBUF-1(@01)                                   1433 05735000
         LR    @01,@00                                             1433 05736000
         EX    @01,@SM01070                                        1433 05737000
*         /***********************************************************/ 05738000
*         /*                                                         */ 05739000
*         /* A '+' CHARACTER MAY BE APPENDED TO A PRIMARY MESSAGE    */ 05740000
*         /* IF A SECONDARY MESSAGE FOLLOWS. THIS '+' IS TO BE       */ 05741000
*         /* REMOVED HERE AND WILL BE REPLACED LATER IF REQUIRED.    */ 05742000
*         /*                                                         */ 05743000
*         /***********************************************************/ 05744000
*                                                                  1434 05745000
*         IF MFRC = 0 & MFFGO = ON                         /*@Z40GSJG*/ 05746000
*           THEN                                           /*@Z40GSJG*/ 05747000
         LH    @15,MFRC                                            1434 05748000
         LTR   @15,@15                                             1434 05749000
         BNZ   @RF01434                                            1434 05750000
         TM    MFFGO,B'10000000'                                   1434 05751000
         BNO   @RF01434                                            1434 05752000
*             DO;                                          /*@Z40GSJG*/ 05753000
*             IF PRTLNTXT(MFPLE) = '+'                     /*@Z40GSJG*/ 05754000
*               THEN                                       /*@Z40GSJG*/ 05755000
         L     @15,PRTLNPTR                                        1436 05756000
         LH    @14,MFPLE                                           1436 05757000
         ALR   @15,@14                                             1436 05758000
         CLI   PRTLNTXT-1(@15),C'+'                                1436 05759000
         BNE   @RF01436                                            1436 05760000
*                 MFSL = MFSL - 1;                         /*@Z40GSJG*/ 05761000
         BCTR  MFSL,0                                              1437 05762000
*               ELSE;                                      /*@Z40GSJG*/ 05763000
@RF01436 DS    0H                                                  1439 05764000
*             END;                                         /*@Z40GSJG*/ 05765000
*           ELSE;                                          /*@Z40GSJG*/ 05766000
*                                                                  1440 05767000
@RF01434 DS    0H                                                  1441 05768000
*         /***********************************************************/ 05769000
*         /*                                                       1441 05770000
*         /* SET CARRIAGE CONTROL AND RECORD LENGTH. THEN INITIALIZE */ 05771000
*         /* FOR NEXT SEGMENT.                                       */ 05772000
*         /*                                                         */ 05773000
*         /***********************************************************/ 05774000
*                                                                  1441 05775000
*         PRTLNLL = MFSL + 1;                              /*@Z40GSJG*/ 05776000
*                                                                  1441 05777000
         L     @15,PRTLNPTR                                        1441 05778000
         LA    @14,1                                               1441 05779000
         LR    @01,MFSL                                            1441 05780000
         ALR   @01,@14                                             1441 05781000
         STH   @01,PRTLNLL(,@15)                                   1441 05782000
*         PRTLNCC = MFCC;                                  /*@Z40GSJG*/ 05783000
*                                                                  1442 05784000
         MVC   PRTLNCC(1,@15),MFCC                                 1442 05785000
*         MFNL = MFNL + 1;                                 /*@Z40GSJG*/ 05786000
*                                                                  1443 05787000
         L     @01,MFMRCPT                                         1443 05788000
         AH    @14,MFNL(,@01)                                      1443 05789000
         STH   @14,MFNL(,@01)                                      1443 05790000
*         MFBGNT = MFBGNT + MFMSL;                         /*@Z40GSJG*/ 05791000
*                                                                  1444 05792000
         LR    @14,MFMSL                                           1444 05793000
         AH    @14,MFBGNT                                          1444 05794000
         STH   @14,MFBGNT                                          1444 05795000
*         MFTRL = MFTRL + MFSL + 3;                        /*@Z40GSJG*/ 05796000
*                                                                  1445 05797000
         LA    @06,3                                               1445 05798000
         LR    @14,MFSL                                            1445 05799000
         AL    @14,MFTRL                                           1445 05800000
         ALR   @14,@06                                             1445 05801000
         ST    @14,MFTRL                                           1445 05802000
*         PRTLNPTR = PRTLNPTR + MFSL + 3;                  /*@Z40GSJG*/ 05803000
*                                                                  1446 05804000
         ALR   @15,MFSL                                            1446 05805000
         ALR   @15,@06                                             1446 05806000
         ST    @15,PRTLNPTR                                        1446 05807000
*         END;                            /* END FORMAT LOOP @Z40GSJG*/ 05808000
*                                                                  1447 05809000
@DE01389 LH    @06,MFRC                                            1447 05810000
         LTR   @06,@06                                             1447 05811000
         BP    @DL01389                                            1447 05812000
*         /***********************************************************/ 05813000
*         /*                                                         */ 05814000
*         /* DETERMINE IF THERE IS A SECONDARY MESSAGE TO PROCESS    */ 05815000
*         /* IF SO TURN OFF THE SUPPRESS MESSAGE NUMBER FLAG.@OZ18517*/ 05816000
*         /*                                                         */ 05817000
*         /***********************************************************/ 05818000
*                                                                  1448 05819000
*         IF FFMPSMS = ON                                  /*@Z40GSJG*/ 05820000
*           THEN                                           /*@OZ18517*/ 05821000
         TM    FFMPSMS,B'00001000'                                 1448 05822000
         BNO   @RF01448                                            1448 05823000
*             FFM2SMN = OFF;                               /*@OZ18517*/ 05824000
         NI    FFM2SMN,B'01111111'                                 1449 05825000
*           ELSE                                           /*@Z40GSJG*/ 05826000
*                                                                  1450 05827000
*             MFFGO = OFF;                                 /*@Z40GSJG*/ 05828000
*                                                                  1450 05829000
         B     @RC01448                                            1450 05830000
@RF01448 NI    MFFGO,B'01111111'                                   1450 05831000
*         END;                           /* END BIG LOOP     @Z40GSJG*/ 05832000
*                                                                  1451 05833000
@RC01448 DS    0H                                                  1451 05834000
@DE01364 TM    MFFGO,B'10000000'                                   1451 05835000
         BNZ   @DL01364                                            1451 05836000
*         MFRCNT = MFPMRC + MFSMRC;                        /*@Z40GSJG*/ 05837000
*                                                                  1452 05838000
         LH    @06,MFPMRC                                          1452 05839000
         AH    @06,MFSMRC                                          1452 05840000
         STH   @06,MFRCNT                                          1452 05841000
*         RETURN CODE(0);                                  /*@Z40GSJG*/ 05842000
         SLR   @15,@15                                             1453 05843000
         L     @14,12(,@13)                                        1453 05844000
         LM    @00,@06,20(@13)                                     1453 05845000
         LM    @08,@12,52(@13)                                     1453 05846000
         BR    @14                                                 1453 05847000
*         END SEGMENT;                                     /*@Z40GSJG*/ 05848000
@PB00017 DS    0H                                                  1455 05849000
*         /***********************************************************/ 05850000
*         /*                                                         */ 05851000
*         /* END OF THE FORMAT PROCEDURE.                            */ 05852000
*         /*                                                         */ 05853000
*         /***********************************************************/ 05854000
*                                                                  1455 05855000
*                                                                  1455 05856000
*         GENERATE DATA;                                           1455 05857000
*         END IDCTP01                                              1456 05858000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 05859000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 05860000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 05861000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 05862000
*/*%INCLUDE SYSLIB  (AMSDF40 )                                        * 05863000
*;                                                                 1456 05864000
@EL00001 L     @13,4(,@13)                                         1456 05865000
@EF00001 L     @00,@SIZDATD                                        1456 05866000
         LR    @01,@08                                             1456 05867000
         FREEMAIN R,LV=(0),A=(1)                                        05868000
@ER00001 LM    @14,@12,12(@13)                                     1456 05869000
         BR    @14                                                 1456 05870000
@DATA    DS    0H                                                       05871000
@CH00981 DC    H'999'                                                   05872000
@CH00900 DC    H'-1'                                                    05873000
@SM01042 MVC   HDSEG3(0,@04),TRBUF(@01)                                 05874000
@SM01044 MVC   CVPB(0,@06),TRBUF(@15)                                   05875000
@SM01046 MVC   ALIGNBUF(0),TRBUF(@03)                                   05876000
@SM01048 MVC   CVPB(0,@03),ALIGNBUF                                     05877000
@SM01050 MVC   CVPB(0,@06),ALIGNBUF                                     05878000
@SM01056 MVC   0(0,@03),TRBUF(@01)                                      05879000
@SM01058 MVC   RETAREA(0,@03),PRTBUFF(@01)                              05880000
@SM01062 MVC   HEADLI(0,@06),PRLINE                                     05881000
@SM01064 MVC   STACKDL(0,@04),PUTLINE(@15)                              05882000
@SM01066 MVC   PRTBUFF(0,@06),MSGTXT(@04)                               05883000
@SM01068 MVC   PRTLNTXT(0,@01),MFMBUF                                   05884000
@SM01070 MVC   PRTLNTXT-1(0,@15),0(@14)                                 05885000
         DS    0F                                                       05886000
@AL00305 DC    A(@CF00153)             LIST WITH   1 ARGUMENT(S)        05887000
@AL00329 EQU   *                       LIST WITH   1 ARGUMENT(S)        05888000
@AL00382 EQU   *                       LIST WITH   1 ARGUMENT(S)        05889000
@AL00426 DC    A(@CF00216)             LIST WITH   1 ARGUMENT(S)        05890000
@AL00330 EQU   *                       LIST WITH   2 ARGUMENT(S)        05891000
@AL00350 EQU   *                       LIST WITH   2 ARGUMENT(S)        05892000
@AL00445 EQU   *                       LIST WITH   2 ARGUMENT(S)        05893000
@AL00458 EQU   *                       LIST WITH   2 ARGUMENT(S)        05894000
@AL00479 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)        05895000
         DC    AL1(X'80')                                               05896000
         DC    AL3(RCQUIT)                                              05897000
@AL00383 EQU   *                       LIST WITH   2 ARGUMENT(S)        05898000
@AL00427 DC    A(MODID)                LIST WITH   2 ARGUMENT(S)        05899000
         DC    AL1(X'80')                                               05900000
         DC    AL3(RCERR)                                               05901000
@AL00394 DC    A(@CF00150)             LIST WITH   1 ARGUMENT(S)        05902000
@AL00404 EQU   *                       LIST WITH   1 ARGUMENT(S)        05903000
@AL00414 DC    A(@CF00159)             LIST WITH   1 ARGUMENT(S)        05904000
@AL00461 DC    A(@CF00469)             LIST WITH   1 ARGUMENT(S)        05905000
@AL00546 DC    A(@CF00036)             LIST WITH   1 ARGUMENT(S)        05906000
@DATD    DSECT                                                          05907000
         DS    0F                                                       05908000
@SA00001 DS    18F                                                      05909000
@PC00001 DS    4F                                                       05910000
@SA00016 DS    14F                                                      05911000
@PC00016 DS    1F                                                       05912000
@SA00002 DS    14F                                                      05913000
@SA00003 DS    14F                                                      05914000
@SA00014 DS    14F                                                      05915000
@SA00007 DS    14F                                                      05916000
@SA00008 DS    13F                                                      05917000
@SA00009 DS    13F                                                      05918000
@SA00012 DS    14F                                                      05919000
@SA00010 DS    14F                                                      05920000
@SA00015 DS    14F                                                      05921000
@PC00015 DS    1F                                                       05922000
@AL00001 DS    5A                                                       05923000
@TF00001 DS    F                                                        05924000
IDCTP01  CSECT                                                          05925000
         DS    0F                                                       05926000
@CF00216 DC    F'1'                                                     05927000
@CH00216 EQU   @CF00216+2                                               05928000
@CF00150 DC    F'2'                                                     05929000
@CH00150 EQU   @CF00150+2                                               05930000
@CF00159 DC    F'3'                                                     05931000
@CF00036 DC    F'4'                                                     05932000
@CF00153 DC    F'6'                                                     05933000
@CH00153 EQU   @CF00153+2                                               05934000
@CF00469 DC    F'7'                                                     05935000
@CF00176 DC    F'8'                                                     05936000
@CH00176 EQU   @CF00176+2                                               05937000
@CF00953 DC    F'9'                                                     05938000
@CF00032 DC    F'10'                                                    05939000
@CF00033 DC    F'11'                                                    05940000
@CF00034 DC    F'12'                                                    05941000
@CH00034 EQU   @CF00034+2                                               05942000
@CF00962 DC    F'13'                                                    05943000
@CF00479 DC    F'16'                                                    05944000
@CF00952 DC    F'28'                                                    05945000
@CF00794 DC    F'72'                                                    05946000
@CH00794 EQU   @CF00794+2                                               05947000
@CF00894 DC    F'255'                                                   05948000
@CF01012 DC    F'299'                                                   05949000
@CF00945 DC    XL4'0F'                                                  05950000
@DATD    DSECT                                                          05951000
         DS    0D                                                       05952000
LISTSCAN DS    A                                                        05953000
OPNPTR   DS    A                                                        05954000
ERCNVADR DS    A                                                        05955000
DMPINDEX DS    A                                                        05956000
DARGILP1 DS    FL4                                                      05957000
         ORG   DARGILP1                                                 05958000
@NM00033 DS    FL2                                                      05959000
DARGILP2 DS    FL2                                                      05960000
         ORG   DARGILP1+4                                               05961000
PRTBUFPT DS    A                                                        05962000
QENTP    DS    A                                                        05963000
CVSTA    DS    A                                                        05964000
FMRIP    DS    A                                                        05965000
TTLPT    DS    A                                                        05966000
HEADPTR  DS    A                                                        05967000
MSGAREA  DS    A                                                        05968000
TEMP1    DS    F                                                        05969000
FFMSTRS  DS    A                                                        05970000
FFMREDOS DS    A                                                        05971000
FFMBDP   DS    A                                                        05972000
FFMRBOFF DS    F                                                        05973000
CVSL     DS    F                                                        05974000
FMRIL    DS    F                                                        05975000
BINACC   DS    F                                                        05976000
PRTLNPTR DS    A                                                        05977000
MFMRCPT  DS    A                                                        05978000
MFTRL    DS    F                                                        05979000
LINCT    DS    F                                                        05980000
TEMP2    DS    F                                                        05981000
CVPSAVP  DS    A                                                        05982000
LISTPTR  DS    A                                                        05983000
TESTRC   DS    H                                                        05984000
SAVERC   DS    H                                                        05985000
STRSTP   DS    H                                                        05986000
FFMREDOL DS    H                                                        05987000
FFMREDOO DS    H                                                        05988000
FFMREDOC DS    H                                                        05989000
REDOCSAV DS    H                                                        05990000
BINHALF  DS    H                                                        05991000
PUPOCT   DS    H                                                        05992000
NLISAV   DS    H                                                        05993000
MFRC     DS    H                                                        05994000
MFML     DS    H                                                        05995000
MFMLL    DS    H                                                        05996000
MFBGNT   DS    H                                                        05997000
MFENDT   DS    H                                                        05998000
MFPLB    DS    H                                                        05999000
MFPLE    DS    H                                                        06000000
MFRCNT   DS    H                                                        06001000
MFPMRC   DS    H                                                        06002000
MFSMRC   DS    H                                                        06003000
SAVPMN   DS    H                                                        06004000
PLLEN    DS    H                                                        06005000
PRSPF    DS    H                                                        06006000
LISTLN   DS    FL1                                                      06007000
@TS00001 DS    CL95                                                     06008000
         DS    CL2                                                      06009000
CVPSTRU  DS    CL299                                                    06010000
         ORG   CVPSTRU                                                  06011000
CVPSTRU1 DS    CL162                                                    06012000
         ORG   CVPSTRU1                                                 06013000
CVPIADD  DS    AL4                                                      06014000
CVPPADD  DS    AL4                                                      06015000
CVPIL    DS    FL4                                                      06016000
CVPOL    DS    FL4                                                      06017000
CVPTYF   DS    BL2                                                      06018000
         ORG   CVPTYF                                                   06019000
CVPBH    DS    BL1                                                      06020000
CVPBHA   EQU   CVPTYF+0                                                 06021000
CVPBHD   EQU   CVPTYF+0                                                 06022000
CVPBD    EQU   CVPTYF+0                                                 06023000
CVPPU    EQU   CVPTYF+0                                                 06024000
@NM00034 EQU   CVPTYF+0                                                 06025000
CVPZS    DS    BL1                                                      06026000
CVPAL    EQU   CVPTYF+1                                                 06027000
CVPSS    EQU   CVPTYF+1                                                 06028000
CVPBS    EQU   CVPTYF+1                                                 06029000
CVPAR    EQU   CVPTYF+1                                                 06030000
@NM00035 EQU   CVPTYF+1                                                 06031000
         ORG   CVPSTRU1+18                                              06032000
CVPRETC  DS    FL2                                                      06033000
CVPRETP  DS    AL4                                                      06034000
PRTSPF   DS    FL2                                                      06035000
PRTSPT   DS    CL1                                                      06036000
PRTBUFF1 DS    CL135                                                    06037000
         ORG   CVPSTRU+162                                              06038000
CVPSTRU2 DS    CL137                                                    06039000
         ORG   CVPSTRU2                                                 06040000
PRTBUFF2 DS    CL135                                                    06041000
PRTBFOVF DS    CL2                                                      06042000
         ORG   CVPSTRU+299                                              06043000
ALIGNBUF DS    CL135                                                    06044000
         DS    CL2                                                      06045000
UNPKWD   DS    CL8                                                      06046000
HDINDEXC DS    CL2                                                      06047000
HDCVB    DS    CL64                                                     06048000
CVFLAG   DS    BL2                                                      06049000
         ORG   CVFLAG                                                   06050000
PLOVF    DS    BL1                                                      06051000
PUPPSF   EQU   CVFLAG+0                                                 06052000
PUPIOF   EQU   CVFLAG+0                                                 06053000
SIGNPOS  EQU   CVFLAG+0                                                 06054000
HIORDRF  EQU   CVFLAG+0                                                 06055000
         ORG   CVFLAG+2                                                 06056000
SIGN     DS    CL1                                                      06057000
MSGNO    DS    CL3                                                      06058000
MTPN     DS    CL4                                                      06059000
PRBUFF   DS    CL441                                                    06060000
         ORG   PRBUFF                                                   06061000
PRCC     DS    CL1                                                      06062000
PRLINE   DS    CL220                                                    06063000
PRLINES  DS    CL220                                                    06064000
         ORG   PRBUFF+441                                               06065000
MFFLAG   DS    BL1                                                      06066000
         ORG   MFFLAG                                                   06067000
MFFGO    DS    BL1                                                      06068000
MFFP1    EQU   MFFLAG+0                                                 06069000
MFFPASS  EQU   MFFLAG+0                                                 06070000
@NM00041 EQU   MFFLAG+0                                                 06071000
         ORG   MFFLAG+1                                                 06072000
MFMBUF   DS    CL136                                                    06073000
MFCC     DS    CL1                                                      06074000
STID     DS    CL4                                                      06075000
         ORG   STID                                                     06076000
STIDMOD  DS    CL3                                                      06077000
STIDENT  DS    AL1                                                      06078000
         ORG   STID+4                                                   06079000
FFMFLAG  DS    BL2                                                      06080000
         ORG   FFMFLAG                                                  06081000
FFMREDOF DS    BL1                                                      06082000
FFMEOS   EQU   FFMFLAG+0                                                06083000
FFMEOS1  EQU   FFMFLAG+0                                                06084000
FFMPASS  EQU   FFMFLAG+0                                                06085000
FFMIDINH EQU   FFMFLAG+0                                                06086000
FFMNOFM  EQU   FFMFLAG+0                                                06087000
FFMDATA  EQU   FFMFLAG+0                                                06088000
FFMFMTF  EQU   FFMFLAG+0                                                06089000
FFMPINH  DS    BL1                                                      06090000
FFMVS    EQU   FFMFLAG+1                                                06091000
FFMPSFF  EQU   FFMFLAG+1                                                06092000
FFMPMSF  EQU   FFMFLAG+1                                                06093000
FFMPSMS  EQU   FFMFLAG+1                                                06094000
FFMNPMF  EQU   FFMFLAG+1                                                06095000
FFMHDFLN EQU   FFMFLAG+1                                                06096000
@NM00042 EQU   FFMFLAG+1                                                06097000
         ORG   FFMFLAG+2                                                06098000
FFM2FLG  DS    BL2                                                      06099000
         ORG   FFM2FLG                                                  06100000
FFM2SMN  DS    BL1                                                      06101000
@NM00043 EQU   FFM2FLG+0                                                06102000
         ORG   FFM2FLG+2                                                06103000
IDCTP01  CSECT                                                          06104000
         DS    0F                                                       06105000
@SIZDATD DC    AL1(0)                                                   06106000
         DC    AL3(@ENDDATD-@DATD)                                      06107000
@CV00881 DC    V(IDCTP05)                                               06108000
         DS    0D                                                       06109000
GPOOL    DC    F'0'                                                     06110000
MFMML    DC    H'11'                                                    06111000
NULLPMN  DC    H'0'                                                     06112000
STDLWPS  DC    H'121'                                                   06113000
RCQUIT   DC    H'12'                                                    06114000
RCERR    DC    H'4'                                                     06115000
PRBUFL   DC    H'2048'                                                  06116000
@CC00898 DC    C'TPSI'                                                  06117000
@CC00912 DC    C'TPCC'                                                  06118000
@CC00914 DC    C'TP1N'                                                  06119000
@CC00933 DC    C'TP2I'                                                  06120000
@CC00940 DC    C'TP2N'                                                  06121000
@CC00950 DC    C'TP2M'                                                  06122000
@CC00961 DC    C'TP2D'                                                  06123000
@CC00963 DC    C'TP2O'                                                  06124000
@CC00964 DC    C'TP2V'                                                  06125000
@CC00966 DC    C'TP2U'                                                  06126000
@CC00975 DC    C'TPDR'                                                  06127000
@CC00979 DC    C'TP3I'                                                  06128000
@CC00987 DC    C'TPMS'                                                  06129000
@CC00988 DC    C'TPX1'                                                  06130000
@CC00989 DC    C'TP3N'                                                  06131000
@CC01006 DC    C'TPER'                                                  06132000
@CC00944 DC    C'X'''                                                   06133000
@CB00879 DC    X'000001073741824C'                                      06134000
@CB00934 EQU   @CB00879                                                 06135000
MODID    DC    CL4'TP01'                                                06136000
ALL      DC    CL3'ALL'                                                 06137000
FORMAT   DC    CL4'FORM'                                                06138000
HSECOND  DC    CL4'HSEC'                                                06139000
CLOCK    DC    CL4'KLOK'                                                06140000
SETZERO  DC    CL4'ZERO'                                                06141000
SETBLANK DC    CL4'BLNK'                                                06142000
NOSET    DC    CL4'NSET'                                                06143000
OVERRIDE DC    CL4'OVRD'                                                06144000
ACQUIRE  DC    CL8'ACQUIRE '                                            06145000
RELINQ   DC    CL8'RELINQ  '                                            06146000
MOUNT    DC    CL8'MOUNT   '                                            06147000
DEMOUNT  DC    CL8'DEMOUNT '                                            06148000
DEFINE   DC    CL8'DEFINE  '                                            06149000
MOVE     DC    CL8'MOVE    '                                            06150000
TRACEQ   DC    CL8'TRACEQ  '                                            06151000
COPYTABL DC    CL8'COPYTABL'                                            06152000
COPYCRTG DC    CL8'COPYCRTG'                                            06153000
COPYVOL  DC    CL8'COPYVOL '                                            06154000
VVIC     DC    CL8'VVIC    '                                            06155000
TUNE     DC    CL8'TUNE    '                                            06156000
NAMES    DC    CL4'NAME'                                                06157000
UNIT     DC    CL4'UNIT'                                                06158000
SHR      DC    CL4'SHR '                                                06159000
EXCL     DC    CL4'EXCL'                                                06160000
NOWAIT   DC    CL4'NWAI'                                                06161000
WAIT     DC    CL4'WAIT'                                                06162000
FIXAREA  DC    X'00'                                                    06163000
         DC    XL255'0'                                                 06164000
SBPOOL   DC    CL4'TP01'                                                06165000
BHTRTB   DC    CL16'0123456789ABCDEF'                                   06166000
PRCCON   DC    CL4'+ 0-'                                                06167000
PRECON   DC    CL1'1'                                                   06168000
HDPOOL   DC    CL4'TP03'                                                06169000
STMODID  DC    CL3'TP1'                                                 06170000
@DATD    DSECT                                                          06171000
IDCTP01  CSECT                                                          06172000
         ENTRY IDCTPS1                                                  06173000
IDCTPS1  DC A(@SIZDATD)                                                 06174000
@DATD    DSECT                                                          06175000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                06176000
@ENDDATD EQU   *                                                        06177000
IDCTP01  CSECT                                                          06178000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       06179000
@01      EQU   01                                                       06180000
@02      EQU   02                                                       06181000
@03      EQU   03                                                       06182000
@04      EQU   04                                                       06183000
@05      EQU   05                                                       06184000
@06      EQU   06                                                       06185000
@07      EQU   07                                                       06186000
@08      EQU   08                                                       06187000
@09      EQU   09                                                       06188000
@10      EQU   10                                                       06189000
@11      EQU   11                                                       06190000
@12      EQU   12                                                       06191000
@13      EQU   13                                                       06192000
@14      EQU   14                                                       06193000
@15      EQU   15                                                       06194000
MFMSL    EQU   @06                                                      06195000
MFSL     EQU   @03                                                      06196000
MFMNL    EQU   @04                                                      06197000
MFINPTR  EQU   @03                                                      06198000
PRFTSP   EQU   @04                                                      06199000
SPFSAV   EQU   @03                                                      06200000
J        EQU   @04                                                      06201000
N        EQU   @07                                                      06202000
SIGNT    EQU   @06                                                      06203000
DECT     EQU   @06                                                      06204000
PUPPSC   EQU   @04                                                      06205000
FMSIL    EQU   @03                                                      06206000
PCTPTR   EQU   @05                                                      06207000
FSADDR   EQU   @06                                                      06208000
DDSTRU   EQU   @03                                                      06209000
IOCSPTR  EQU   @06                                                      06210000
SETRC    EQU   @04                                                      06211000
RTNREG   EQU   @15                                                      06212000
REG13    EQU   @13                                                      06213000
REG14    EQU   @14                                                      06214000
REG15    EQU   @15                                                      06215000
CVDREG   EQU   @02                                                      06216000
GDTPR    EQU   @09                                                      06217000
REG0     EQU   @00                                                      06218000
REG1     EQU   @01                                                      06219000
REG10    EQU   @10                                                      06220000
REG11    EQU   @11                                                      06221000
REG12    EQU   @12                                                      06222000
REG2     EQU   @02                                                      06223000
REG3     EQU   @03                                                      06224000
REG4     EQU   @04                                                      06225000
REG5     EQU   @05                                                      06226000
REG6     EQU   @06                                                      06227000
REG7     EQU   @07                                                      06228000
REG8     EQU   @08                                                      06229000
REG9     EQU   @09                                                      06230000
GDTTBL   EQU   0                                                        06231000
GDTTR1   EQU   GDTTBL+8                                                 06232000
GDTTR2   EQU   GDTTBL+12                                                06233000
GDTTPH   EQU   GDTTBL+28                                                06234000
GDTDBG   EQU   GDTTBL+40                                                06235000
GDTSTC   EQU   GDTTBL+44                                                06236000
GDTPRT   EQU   GDTTBL+48                                                06237000
GDTESS   EQU   GDTTBL+52                                                06238000
GDTESA   EQU   GDTTBL+56                                                06239000
GDTRST   EQU   GDTTBL+60                                                06240000
GDTRES   EQU   GDTTBL+64                                                06241000
GDTCAL   EQU   GDTTBL+68                                                06242000
GDTGSP   EQU   GDTTBL+72                                                06243000
GDTFSP   EQU   GDTTBL+76                                                06244000
GDTGPL   EQU   GDTTBL+80                                                06245000
GDTFPL   EQU   GDTTBL+84                                                06246000
GDTLOD   EQU   GDTTBL+88                                                06247000
GDTDEL   EQU   GDTTBL+92                                                06248000
GDTPRL   EQU   GDTTBL+96                                                06249000
GDTEPL   EQU   GDTTBL+100                                               06250000
GDTTIM   EQU   GDTTBL+104                                               06251000
GDTIIO   EQU   GDTTBL+108                                               06252000
GDTTIO   EQU   GDTTBL+112                                               06253000
GDTOPN   EQU   GDTTBL+124                                               06254000
GDTCLS   EQU   GDTTBL+128                                               06255000
GDTGET   EQU   GDTTBL+132                                               06256000
GDTPUT   EQU   GDTTBL+136                                               06257000
GDTPOS   EQU   GDTTBL+140                                               06258000
GDTCPY   EQU   GDTTBL+144                                               06259000
GDTCAT   EQU   GDTTBL+148                                               06260000
GDTABT   EQU   GDTTBL+152                                               06261000
GDTABH   EQU   GDTTBL+156                                               06262000
GDTSNP   EQU   GDTTBL+164                                               06263000
GDTVFY   EQU   GDTTBL+172                                               06264000
GDTECT   EQU   GDTTBL+188                                               06265000
GDTUID   EQU   GDTTBL+192                                               06266000
GDTPMT   EQU   GDTTBL+196                                               06267000
GDTCIR   EQU   GDTTBL+200                                               06268000
GDTLNK   EQU   GDTTBL+204                                               06269000
GDTALC   EQU   GDTTBL+208                                               06270000
GDTDLC   EQU   GDTTBL+212                                               06271000
GDTQAL   EQU   GDTTBL+216                                               06272000
GDTSTW   EQU   GDTTBL+220                                               06273000
GDTSSC   EQU   GDTTBL+224                                               06274000
GDTENQ   EQU   GDTTBL+228                                               06275000
GDTRSV   EQU   GDTTBL+232                                               06276000
GDTDEQ   EQU   GDTTBL+236                                               06277000
GDTSFO   EQU   GDTTBL+240                                               06278000
GDTWTO   EQU   GDTTBL+244                                               06279000
GDTSCR   EQU   GDTTBL+248                                               06280000
GDTUNT   EQU   GDTTBL+252                                               06281000
GDTRCT   EQU   GDTTBL+256                                               06282000
GDTIFO   EQU   GDTTBL+260                                               06283000
GDTEXP   EQU   GDTTBL+264                                               06284000
GDTSTA   EQU   GDTTBL+268                                               06285000
GDTERR   EQU   GDTTBL+272                                               06286000
GDTUNC   EQU   GDTTBL+276                                               06287000
GDTLOC   EQU   GDTTBL+280                                               06288000
IDCSAEP0 EQU   0                                                        06289000
IDCSAGS0 EQU   0                                                        06290000
IDCSAFS0 EQU   0                                                        06291000
IDCSAGP0 EQU   0                                                        06292000
IDCSAFP0 EQU   0                                                        06293000
TRACE1   EQU   0                                                        06294000
OLDERID1 EQU   TRACE1                                                   06295000
TRACE2   EQU   0                                                        06296000
OLDERID2 EQU   TRACE2                                                   06297000
NEWID2   EQU   TRACE2+95                                                06298000
NEWERID2 EQU   5                                                        06299000
LISTTEST EQU   0                                                        06300000
CIRAGL   EQU   0                                                        06301000
CIRTYPE  EQU   CIRAGL                                                   06302000
ALLAGL   EQU   0                                                        06303000
ALLSTS   EQU   ALLAGL+24                                                06304000
ALLDSP   EQU   ALLAGL+25                                                06305000
ALLORG   EQU   ALLAGL+26                                                06306000
ALLOPT   EQU   ALLAGL+28                                                06307000
UNITABL  EQU   0                                                        06308000
UNITADR  EQU   UNITABL+4                                                06309000
@NM00010 EQU   UNITADR                                                  06310000
UNITSTAT EQU   UNITABL+6                                                06311000
IDCIOPT0 EQU   0                                                        06312000
IOCSTR   EQU   0                                                        06313000
IOCDAD   EQU   IOCSTR                                                   06314000
IOCDLN   EQU   IOCSTR+4                                                 06315000
IOCDSO   EQU   IOCSTR+16                                                06316000
IOCRFM   EQU   IOCSTR+17                                                06317000
IOCMAC   EQU   IOCSTR+18                                                06318000
IOCMAC2  EQU   IOCSTR+19                                                06319000
IOCCHP   EQU   IOCSTR+20                                                06320000
IOCMSG   EQU   IOCSTR+21                                                06321000
IOCRBA   EQU   IOCSTR+40                                                06322000
IOCTTR   EQU   IOCRBA                                                   06323000
IOCMEM   EQU   IOCSTR+44                                                06324000
IOCNWM   EQU   IOCSTR+48                                                06325000
IOCPNM   EQU   IOCNWM+2                                                 06326000
IOCREL   EQU   IOCSTR+60                                                06327000
IOCTPML  EQU   IOCREL                                                   06328000
IOCTSML  EQU   IOCREL+2                                                 06329000
OPNAGL   EQU   0                                                        06330000
OPNOPT   EQU   OPNAGL                                                   06331000
OPNRFM   EQU   OPNAGL+1                                                 06332000
OPNTYP   EQU   OPNAGL+2                                                 06333000
OPNMOD   EQU   OPNAGL+3                                                 06334000
OPNDEV   EQU   OPNAGL+24                                                06335000
OPNDSO   EQU   OPNAGL+41                                                06336000
OPNOPT2  EQU   OPNAGL+42                                                06337000
IOINFOPT EQU   0                                                        06338000
UVOLLIST EQU   0                                                        06339000
UVOLENT  EQU   UVOLLIST+2                                               06340000
DARGLIST EQU   0                                                        06341000
DARGDBP  EQU   DARGLIST                                                 06342000
DARGRETP EQU   DARGLIST+4                                               06343000
DARGSTID EQU   DARGLIST+8                                               06344000
DARGILP  EQU   DARGLIST+12                                              06345000
DARGCNT  EQU   DARGLIST+14                                              06346000
DARGRETL EQU   DARGLIST+16                                              06347000
DARGIND  EQU   DARGLIST+18                                              06348000
DARGFLGS EQU   DARGLIST+19                                              06349000
DARGFULL EQU   DARGFLGS                                                 06350000
DARGARY  EQU   DARGLIST+20                                              06351000
DARGINS  EQU   DARGARY                                                  06352000
DARGREP  EQU   DARGINS                                                  06353000
DARGINL  EQU   DARGARY+2                                                06354000
DARGPCT  EQU   DARGINL                                                  06355000
DARGDTM  EQU   DARGARY+4                                                06356000
FMTLIST  EQU   0                                                        06357000
FMTFLGS  EQU   FMTLIST                                                  06358000
FMTEOLF  EQU   FMTFLGS                                                  06359000
FMTSCF   EQU   FMTFLGS                                                  06360000
FMTIDF   EQU   FMTFLGS                                                  06361000
FMTBDF   EQU   FMTFLGS                                                  06362000
FMTREPF  EQU   FMTFLGS                                                  06363000
FMTSTF   EQU   FMTFLGS                                                  06364000
FMTDFF   EQU   FMTFLGS                                                  06365000
FMTSMSG  EQU   FMTFLGS+1                                                06366000
FMTSPF   EQU   FMTLIST+2                                                06367000
FMTRFNO  EQU   FMTSPF                                                   06368000
FMTILEN  EQU   FMTRFNO                                                  06369000
FMTSTL   EQU   FMTILEN                                                  06370000
FMTIOFF  EQU   FMTLIST+4                                                06371000
FMTTRBC  EQU   FMTIOFF                                                  06372000
FMTSTO   EQU   FMTTRBC                                                  06373000
FMTSPT   EQU   FMTSTO                                                   06374000
FMTOCOL  EQU   FMTLIST+6                                                06375000
FMTRIO   EQU   FMTOCOL                                                  06376000
FMTOLEN  EQU   FMTLIST+8                                                06377000
FMTCNVF  EQU   FMTLIST+10                                               06378000
FMTBS    EQU   FMTCNVF+1                                                06379000
FMTAR    EQU   FMTCNVF+1                                                06380000
ERCNVTAB EQU   0                                                        06381000
ERTYPE   EQU   ERCNVTAB                                                 06382000
EROPER   EQU   ERCNVTAB+1                                               06383000
EROSOPER EQU   ERCNVTAB+2                                               06384000
ERCATRC  EQU   ERCNVTAB+16                                              06385000
ERCPLPT  EQU   ERCNVTAB+20                                              06386000
IDCDB010 EQU   0                                                        06387000
DMPITM   EQU   0                                                        06388000
DMPARY   EQU   0                                                        06389000
PCTTAB   EQU   0                                                        06390000
PCTFLG   EQU   PCTTAB+4                                                 06391000
PCTH1F   EQU   PCTFLG                                                   06392000
PCTH2F   EQU   PCTFLG                                                   06393000
PCTHAF   EQU   PCTFLG                                                   06394000
PCTLLM   EQU   PCTFLG                                                   06395000
PCTAPF   EQU   PCTFLG                                                   06396000
PCTSPP   EQU   PCTTAB+8                                                 06397000
PCTACT   EQU   PCTTAB+12                                                06398000
PCTIOC   EQU   PCTACT                                                   06399000
PCTAPL   EQU   PCTACT+4                                                 06400000
PCTCPN   EQU   PCTAPL                                                   06401000
PCTNLI   EQU   PCTAPL+2                                                 06402000
PCTSTD   EQU   PCTTAB+20                                                06403000
PCTSPL   EQU   PCTSTD+4                                                 06404000
PCTALT   EQU   PCTTAB+28                                                06405000
PCTIOP   EQU   PCTALT                                                   06406000
PCTLPL   EQU   PCTALT+4                                                 06407000
PCTSQP   EQU   PCTTAB+48                                                06408000
PCTAHP   EQU   PCTTAB+52                                                06409000
PCTMLP   EQU   PCTTAB+56                                                06410000
PCTSLP   EQU   PCTTAB+60                                                06411000
PCTTRP   EQU   PCTTAB+64                                                06412000
PCTPLW   EQU   PCTTAB+68                                                06413000
PCTSLC   EQU   PCTTAB+74                                                06414000
PCTFLP   EQU   PCTTAB+76                                                06415000
PCTFLC   EQU   PCTTAB+80                                                06416000
PCTHLC   EQU   PCTTAB+82                                                06417000
PCTHSC   EQU   PCTTAB+83                                                06418000
PCTPNL   EQU   PCTTAB+84                                                06419000
PCTPMN   EQU   PCTTAB+86                                                06420000
PCTAPC   EQU   PCTTAB+88                                                06421000
PCTDSC   EQU   PCTTAB+92                                                06422000
PCTPNI   EQU   PCTTAB+94                                                06423000
PCTFDL   EQU   PCTTAB+96                                                06424000
PCTLDL   EQU   PCTTAB+98                                                06425000
PCTFLN   EQU   PCTTAB+100                                               06426000
PCTLNM   EQU   PCTTAB+102                                               06427000
PCTBUF   EQU   PCTTAB+104                                               06428000
PCTBNL   EQU   PCTTAB+108                                               06429000
PRTBUFF  EQU   0                                                        06430000
RETAREA  EQU   0                                                        06431000
QENTRY   EQU   0                                                        06432000
QSTID    EQU   QENTRY                                                   06433000
QCHAIN   EQU   QENTRY+4                                                 06434000
QFLAGS   EQU   QENTRY+8                                                 06435000
QMSGF    EQU   QFLAGS                                                   06436000
QHEADF   EQU   QFLAGS                                                   06437000
QSECMF   EQU   QFLAGS                                                   06438000
QNPMF    EQU   QFLAGS                                                   06439000
Q2LMSG   EQU   QFLAGS                                                   06440000
QHLC     EQU   QENTRY+10                                                06441000
QHSC     EQU   QENTRY+11                                                06442000
QTEXT    EQU   QENTRY+12                                                06443000
CVPB     EQU   0                                                        06444000
TRBUF    EQU   0                                                        06445000
HDPRLI   EQU   0                                                        06446000
HDINDEX  EQU   HDPRLI                                                   06447000
HDSEG1   EQU   HDPRLI+6                                                 06448000
HDSEG2   EQU   HDPRLI+44                                                06449000
HDST1    EQU   HDPRLI+82                                                06450000
HDSEG3   EQU   HDPRLI+83                                                06451000
HDST2    EQU   HDPRLI+115                                               06452000
FTLI     EQU   0                                                        06453000
FLCC     EQU   FTLI                                                     06454000
MTLINE   EQU   0                                                        06455000
STLINE   EQU   0                                                        06456000
HEADQUE  EQU   0                                                        06457000
HEADQP   EQU   HEADQUE                                                  06458000
HEADCC   EQU   HEADQUE+4                                                06459000
HEADLI   EQU   HEADQUE+5                                                06460000
MESSAGE  EQU   0                                                        06461000
MSGLEN   EQU   MESSAGE+2                                                06462000
MSGTXT   EQU   MESSAGE+12                                               06463000
STACKMAP EQU   0                                                        06464000
STACKLL  EQU   STACKMAP                                                 06465000
STACKDL  EQU   STACKMAP+2                                               06466000
PRTLNSTR EQU   0                                                        06467000
PRTLNLL  EQU   PRTLNSTR                                                 06468000
PRTLNCC  EQU   PRTLNSTR+2                                               06469000
PRTLNTXT EQU   PRTLNSTR+3                                               06470000
MFINBUF  EQU   0                                                        06471000
MFNL     EQU   0                                                        06472000
CVPSAV   EQU   0                                                        06473000
CVPSAV1  EQU   CVPSAV                                                   06474000
CVPSAV2  EQU   CVPSAV+162                                               06475000
AMSTP011 EQU   0                                                        06476000
AMSTP041 EQU   0                                                        06477000
AMSTP042 EQU   0                                                        06478000
AMSTP043 EQU   0                                                        06479000
AMSTP044 EQU   0                                                        06480000
DMPTRM   EQU   0                                                        06481000
IDCIOCL0 EQU   0                                                        06482000
IDCIOCO0 EQU   0                                                        06483000
IDCIOGT0 EQU   0                                                        06484000
IDCIOIT0 EQU   0                                                        06485000
IDCIOOP0 EQU   0                                                        06486000
IDCIOPO0 EQU   0                                                        06487000
IDCIOSI0 EQU   0                                                        06488000
IDCIOST0 EQU   0                                                        06489000
IDCIOTM0 EQU   0                                                        06490000
IDCIOVY0 EQU   0                                                        06491000
IDCIO050 EQU   0                                                        06492000
IDCSAAL0 EQU   0                                                        06493000
IDCSACA0 EQU   0                                                        06494000
IDCSACL0 EQU   0                                                        06495000
IDCSACR0 EQU   0                                                        06496000
IDCSADE0 EQU   0                                                        06497000
IDCSADL0 EQU   0                                                        06498000
IDCSADQ0 EQU   0                                                        06499000
IDCSAID0 EQU   0                                                        06500000
IDCSALC0 EQU   0                                                        06501000
IDCSALD0 EQU   0                                                        06502000
IDCSALK0 EQU   0                                                        06503000
IDCSANQ0 EQU   0                                                        06504000
IDCSAPR0 EQU   0                                                        06505000
IDCSAPT0 EQU   0                                                        06506000
IDCSAQL0 EQU   0                                                        06507000
IDCSARC0 EQU   0                                                        06508000
IDCSARV0 EQU   0                                                        06509000
IDCSASC0 EQU   0                                                        06510000
IDCSASI0 EQU   0                                                        06511000
IDCSASN0 EQU   0                                                        06512000
IDCSASS0 EQU   0                                                        06513000
IDCSAST0 EQU   0                                                        06514000
IDCSATI0 EQU   0                                                        06515000
IDCSAUC0 EQU   0                                                        06516000
IDCSAWO0 EQU   0                                                        06517000
IDCSA060 EQU   0                                                        06518000
IDCST010 EQU   0                                                        06519000
IDCTPER0 EQU   0                                                        06520000
NEWERID1 EQU   5                                                        06521000
PCTTRT   EQU   0                                                        06522000
GDTTBLX  EQU   0                                                        06523000
FILENAME EQU   0                                                        06524000
DDPTR    EQU   0                                                        06525000
FMPTR    EQU   0                                                        06526000
PUTLINE  EQU   0                                                        06527000
ERRCODE  EQU   0                                                        06528000
STLCC    EQU   STLINE                                                   06529000
CONVL    EQU   TEMP1                                                    06530000
DSINDX   EQU   TEMP1                                                    06531000
RETLN    EQU   TEMP1                                                    06532000
BDLEN    EQU   TEMP1                                                    06533000
HDINDEXB EQU   HDINDEXC                                                 06534000
BINHALFC EQU   BINHALF                                                  06535000
BINACCC  EQU   BINACC                                                   06536000
CURLI    EQU   TEMP2                                                    06537000
HDQPTR   EQU   TEMP2                                                    06538000
MTLCC    EQU   MTLINE                                                   06539000
TRBUFB   EQU   TRBUF                                                    06540000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    06541000
@NM00040 EQU   MESSAGE+10                                               06542000
@NM00039 EQU   MESSAGE+8                                                06543000
@NM00038 EQU   MESSAGE+6                                                06544000
MSGOFF   EQU   MESSAGE+4                                                06545000
@NM00037 EQU   MESSAGE                                                  06546000
FL1      EQU   FTLI+1                                                   06547000
HDSP3    EQU   HDPRLI+80                                                06548000
HDSP2    EQU   HDPRLI+42                                                06549000
HDSP1    EQU   HDPRLI+4                                                 06550000
@NM00036 EQU   QFLAGS                                                   06551000
PCTPPD   EQU   PCTTAB+90                                                06552000
PCTMLC   EQU   PCTTAB+72                                                06553000
PCTSME   EQU   PCTTAB+44                                                06554000
PCTSTM   EQU   PCTTAB+36                                                06555000
PCTANL   EQU   PCTLPL+2                                                 06556000
PCTAPN   EQU   PCTLPL                                                   06557000
PCTSNL   EQU   PCTSPL+2                                                 06558000
PCTSPN   EQU   PCTSPL                                                   06559000
PCTIOS   EQU   PCTSTD                                                   06560000
@NM00032 EQU   PCTFLG                                                   06561000
PCTIDN   EQU   PCTTAB                                                   06562000
@NM00031 EQU   DMPARY+15                                                06563000
DMPARYTP EQU   DMPARY+14                                                06564000
DMPARYEX EQU   DMPARY+12                                                06565000
DMPARYIC EQU   DMPARY+10                                                06566000
DMPARYSZ EQU   DMPARY+8                                                 06567000
DMPARYNM EQU   DMPARY                                                   06568000
@NM00030 EQU   DMPITM+15                                                06569000
DMPITMTP EQU   DMPITM+14                                                06570000
DMPITMLN EQU   DMPITM+12                                                06571000
DMPITMPT EQU   DMPITM+8                                                 06572000
DMPITMNM EQU   DMPITM                                                   06573000
@NM00029 EQU   ERCNVTAB+24                                              06574000
ERDARBPT EQU   ERCPLPT                                                  06575000
ERDYNRC  EQU   ERCATRC                                                  06576000
ERDSNM   EQU   ERCNVTAB+12                                              06577000
@NM00028 EQU   ERCNVTAB+4                                               06578000
@NM00027 EQU   ERCNVTAB+3                                               06579000
@NM00026 EQU   EROSOPER                                                 06580000
EROSUCDX EQU   EROSOPER                                                 06581000
EROSCATL EQU   EROSOPER                                                 06582000
@NM00025 EQU   EROPER                                                   06583000
ERCATAL  EQU   EROPER                                                   06584000
ERCATDL  EQU   EROPER                                                   06585000
ERCATDE  EQU   EROPER                                                   06586000
ERCATLC  EQU   EROPER                                                   06587000
@NM00024 EQU   ERTYPE                                                   06588000
ERDYNAL  EQU   ERTYPE                                                   06589000
EROSCAT  EQU   ERTYPE                                                   06590000
ERCATLG  EQU   ERTYPE                                                   06591000
@NM00023 EQU   FMTCNVF+1                                                06592000
FMTSS    EQU   FMTCNVF+1                                                06593000
FMTAL    EQU   FMTCNVF+1                                                06594000
FMTZS    EQU   FMTCNVF+1                                                06595000
@NM00022 EQU   FMTCNVF                                                  06596000
FMTPU    EQU   FMTCNVF                                                  06597000
FMTBD    EQU   FMTCNVF                                                  06598000
FMTBHD   EQU   FMTCNVF                                                  06599000
FMTBHA   EQU   FMTCNVF                                                  06600000
FMTBH    EQU   FMTCNVF                                                  06601000
@NM00021 EQU   FMTFLGS+1                                                06602000
FMTHDF   EQU   FMTFLGS                                                  06603000
@NM00020 EQU   DARGFLGS                                                 06604000
DARGSENT EQU   DARGSTID+3                                               06605000
DARGSMOD EQU   DARGSTID                                                 06606000
UVOLVOL  EQU   UVOLENT+4                                                06607000
UVOLDEV  EQU   UVOLENT                                                  06608000
UVOLCNT  EQU   UVOLLIST                                                 06609000
@NM00019 EQU   IOINFOPT                                                 06610000
IOINFLUB EQU   IOINFOPT                                                 06611000
IOINFTMS EQU   IOINFOPT                                                 06612000
IOINFSUP EQU   IOINFOPT                                                 06613000
IOINFDSN EQU   IOINFOPT                                                 06614000
IOINFVOL EQU   IOINFOPT                                                 06615000
IOINFDVT EQU   IOINFOPT                                                 06616000
OPNVOL   EQU   OPNAGL+44                                                06617000
OPNSTRNO EQU   OPNAGL+43                                                06618000
@NM00018 EQU   OPNOPT2                                                  06619000
OPNOPTJM EQU   OPNOPT2                                                  06620000
OPNOPTNM EQU   OPNOPT2                                                  06621000
OPNOPTAS EQU   OPNOPT2                                                  06622000
@NM00017 EQU   OPNDSO                                                   06623000
OPNDSOPO EQU   OPNDSO                                                   06624000
OPNDSOIS EQU   OPNDSO                                                   06625000
OPNDSOPS EQU   OPNDSO                                                   06626000
OPNDSOAM EQU   OPNDSO                                                   06627000
OPNKYL   EQU   OPNAGL+40                                                06628000
OPNBLK   EQU   OPNAGL+36                                                06629000
OPNREC   EQU   OPNAGL+32                                                06630000
OPNDEVIX EQU   OPNDEV+4                                                 06631000
OPNDEVDT EQU   OPNDEV                                                   06632000
OPNCBP   EQU   OPNAGL+20                                                06633000
OPNDSN   EQU   OPNAGL+16                                                06634000
OPNPWA   EQU   OPNAGL+12                                                06635000
OPNDDN   EQU   OPNAGL+8                                                 06636000
OPNIOC   EQU   OPNAGL+4                                                 06637000
OPNMODRP EQU   OPNMOD                                                   06638000
OPNMODUB EQU   OPNMOD                                                   06639000
OPNMODRS EQU   OPNMOD                                                   06640000
OPNMODAX EQU   OPNMOD                                                   06641000
OPNMODRR EQU   OPNMOD                                                   06642000
OPNMODRC EQU   OPNMOD                                                   06643000
OPNMODAC EQU   OPNMOD                                                   06644000
OPNMODPD EQU   OPNMOD                                                   06645000
OPNTYPSY EQU   OPNTYP                                                   06646000
OPNTYPRV EQU   OPNTYP                                                   06647000
OPNTYPEX EQU   OPNTYP                                                   06648000
OPNTYPRA EQU   OPNTYP                                                   06649000
OPNTYPXM EQU   OPNTYP                                                   06650000
OPNTYPCI EQU   OPNTYP                                                   06651000
OPNTYPSO EQU   OPNTYP                                                   06652000
OPNTYPSI EQU   OPNTYP                                                   06653000
@NM00016 EQU   OPNRFM                                                   06654000
OPNRFMBK EQU   OPNRFM                                                   06655000
OPNRFMSF EQU   OPNRFM                                                   06656000
OPNRFMUN EQU   OPNRFM                                                   06657000
OPNRFMVR EQU   OPNRFM                                                   06658000
OPNRFMFX EQU   OPNRFM                                                   06659000
OPNOPTSK EQU   OPNOPT                                                   06660000
OPNOPTDR EQU   OPNOPT                                                   06661000
OPNOPTCR EQU   OPNOPT                                                   06662000
OPNOPTKS EQU   OPNOPT                                                   06663000
OPNOPTBK EQU   OPNOPT                                                   06664000
OPNOPTUP EQU   OPNOPT                                                   06665000
OPNOPTOT EQU   OPNOPT                                                   06666000
OPNOPTIN EQU   OPNOPT                                                   06667000
IOCEXT   EQU   IOCSTR+64                                                06668000
IOCWORK  EQU   IOCSTR+56                                                06669000
IOCRRN   EQU   IOCSTR+52                                                06670000
IOCPTL   EQU   IOCNWM                                                   06671000
IOCKYA   EQU   IOCMEM                                                   06672000
IOCVRC   EQU   IOCTTR                                                   06673000
IOCCBP   EQU   IOCSTR+36                                                06674000
IOCDSN   EQU   IOCSTR+32                                                06675000
IOCHURBA EQU   IOCSTR+28                                                06676000
IOCVOLSR EQU   IOCSTR+22                                                06677000
@NM00015 EQU   IOCMSG                                                   06678000
IOCMSGSM EQU   IOCMSG                                                   06679000
IOCMSGAE EQU   IOCMSG                                                   06680000
IOCMSGCE EQU   IOCMSG                                                   06681000
IOCMSGOE EQU   IOCMSG                                                   06682000
IOCMSGOP EQU   IOCMSG                                                   06683000
IOCCHPKG EQU   IOCMSG                                                   06684000
IOCCHPKE EQU   IOCMSG                                                   06685000
IOCCHPNU EQU   IOCCHP                                                   06686000
IOCCHPUP EQU   IOCCHP                                                   06687000
IOCCHPBK EQU   IOCCHP                                                   06688000
IOCCHPCR EQU   IOCCHP                                                   06689000
IOCCHPKS EQU   IOCCHP                                                   06690000
IOCCHPSK EQU   IOCCHP                                                   06691000
IOCCHPDR EQU   IOCCHP                                                   06692000
IOCCHPSQ EQU   IOCCHP                                                   06693000
IOCMACNT EQU   IOCMAC2                                                  06694000
IOCMACER EQU   IOCMAC2                                                  06695000
IOCMACPA EQU   IOCMAC2                                                  06696000
IOCMACEN EQU   IOCMAC2                                                  06697000
IOCMACCP EQU   IOCMAC2                                                  06698000
IOCMACRR EQU   IOCMAC2                                                  06699000
IOCMACAS EQU   IOCMAC2                                                  06700000
IOCMACSK EQU   IOCMAC2                                                  06701000
@NM00014 EQU   IOCMAC                                                   06702000
IOCMACCC EQU   IOCMAC                                                   06703000
IOCMACDR EQU   IOCMAC                                                   06704000
IOCMACBK EQU   IOCMAC                                                   06705000
IOCMACCR EQU   IOCMAC                                                   06706000
IOCMACUP EQU   IOCMAC                                                   06707000
IOCMACOT EQU   IOCMAC                                                   06708000
IOCMACIN EQU   IOCMAC                                                   06709000
@NM00013 EQU   IOCRFM                                                   06710000
IOCRFMBK EQU   IOCRFM                                                   06711000
IOCRFMSF EQU   IOCRFM                                                   06712000
IOCRFMUN EQU   IOCRFM                                                   06713000
IOCRFMVR EQU   IOCRFM                                                   06714000
IOCRFMFX EQU   IOCRFM                                                   06715000
@NM00012 EQU   IOCDSO                                                   06716000
IOCDSOPO EQU   IOCDSO                                                   06717000
IOCDSOIS EQU   IOCDSO                                                   06718000
IOCDSOPS EQU   IOCDSO                                                   06719000
IOCDSOAM EQU   IOCDSO                                                   06720000
IOCRKP   EQU   IOCSTR+13                                                06721000
IOCKYL   EQU   IOCSTR+12                                                06722000
IOCTRN   EQU   IOCSTR+8                                                 06723000
UNITVTOC EQU   UNITABL+7                                                06724000
@NM00011 EQU   UNITSTAT                                                 06725000
UNITUSHR EQU   UNITSTAT                                                 06726000
UNITXSHR EQU   UNITSTAT                                                 06727000
UNITISHR EQU   UNITSTAT                                                 06728000
UNITUA   EQU   @NM00010+1                                               06729000
UNITCHA  EQU   @NM00010                                                 06730000
UNITUCB  EQU   UNITABL                                                  06731000
ALLUNCNT EQU   ALLAGL+30                                                06732000
ALLVLCNT EQU   ALLAGL+29                                                06733000
@NM00009 EQU   ALLOPT                                                   06734000
ALLOPTUN EQU   ALLOPT                                                   06735000
ALLOPTPV EQU   ALLOPT                                                   06736000
ALLOPTDS EQU   ALLOPT                                                   06737000
ALLOPTVL EQU   ALLOPT                                                   06738000
@NM00008 EQU   ALLORG+1                                                 06739000
ALLORGVS EQU   ALLORG+1                                                 06740000
@NM00007 EQU   ALLORG+1                                                 06741000
ALLORGGS EQU   ALLORG+1                                                 06742000
ALLORGUN EQU   ALLORG                                                   06743000
ALLORGPO EQU   ALLORG                                                   06744000
ALLORGMQ EQU   ALLORG                                                   06745000
ALLORGCQ EQU   ALLORG                                                   06746000
ALLORGCX EQU   ALLORG                                                   06747000
ALLORGDA EQU   ALLORG                                                   06748000
ALLORGPS EQU   ALLORG                                                   06749000
ALLORGIS EQU   ALLORG                                                   06750000
ALLDSPUN EQU   ALLDSP                                                   06751000
ALLDSPCG EQU   ALLDSP                                                   06752000
ALLDSPDE EQU   ALLDSP                                                   06753000
ALLDSPKP EQU   ALLDSP                                                   06754000
@NM00006 EQU   ALLDSP                                                   06755000
ALLSTSOD EQU   ALLSTS                                                   06756000
ALLSTSMD EQU   ALLSTS                                                   06757000
ALLSTSNW EQU   ALLSTS                                                   06758000
ALLSTSSR EQU   ALLSTS                                                   06759000
@NM00005 EQU   ALLSTS                                                   06760000
ALLPWD   EQU   ALLAGL+20                                                06761000
ALLVLP   EQU   ALLAGL+16                                                06762000
ALLULP   EQU   ALLAGL+12                                                06763000
ALLDDN   EQU   ALLAGL+4                                                 06764000
ALLDSN   EQU   ALLAGL                                                   06765000
CIRPID   EQU   CIRAGL+28                                                06766000
CIRPWD   EQU   CIRAGL+24                                                06767000
CIRCAT   EQU   CIRAGL+20                                                06768000
CIRWKP   EQU   CIRAGL+16                                                06769000
CIRTLR   EQU   CIRAGL+12                                                06770000
CIRHDR   EQU   CIRAGL+8                                                 06771000
CIRTLN   EQU   CIRAGL+6                                                 06772000
CIRHLN   EQU   CIRAGL+4                                                 06773000
@NM00004 EQU   CIRAGL+1                                                 06774000
@NM00003 EQU   CIRTYPE                                                  06775000
CIRTYPAQ EQU   CIRTYPE                                                  06776000
CIRTYP1Q EQU   CIRTYPE                                                  06777000
NEWID1   EQU   TRACE1+95                                                06778000
CALLID   EQU   OLDERID1+90                                              06779000
@NM00002 EQU   OLDERID1                                                 06780000
GDTPSB   EQU   GDTTBL+184                                               06781000
GDTUPT   EQU   GDTTBL+180                                               06782000
GDTCMB   EQU   GDTTBL+176                                               06783000
GDTSPR   EQU   GDTTBL+168                                               06784000
@NM00001 EQU   GDTTBL+160                                               06785000
GDTTOH   EQU   GDTTBL+120                                               06786000
GDTRIP   EQU   GDTTBL+116                                               06787000
GDTIOH   EQU   GDTTBL+36                                                06788000
GDTSAH   EQU   GDTTBL+32                                                06789000
GDTRIH   EQU   GDTTBL+24                                                06790000
GDTSTH   EQU   GDTTBL+20                                                06791000
GDTDBH   EQU   GDTTBL+16                                                06792000
GDTPRM   EQU   GDTTBL+4                                                 06793000
GDTHDR   EQU   GDTTBL                                                   06794000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      06795000
@RF00349 EQU   @RC00342                                                 06796000
@RC00588 EQU   @RC00584                                                 06797000
@RC00594 EQU   @RC00584                                                 06798000
@RC01046 EQU   @RC01044                                                 06799000
@RC01270 EQU   @RC01266                                                 06800000
@PB00016 EQU   @PB00017                                                 06801000
@RC00597 EQU   @RC00594                                                 06802000
@PB00015 EQU   @PB00016                                                 06803000
@PB00014 EQU   @PB00015                                                 06804000
@PB00013 EQU   @PB00014                                                 06805000
@PB00007 EQU   @PB00013                                                 06806000
@PB00006 EQU   @PB00007                                                 06807000
@PB00005 EQU   @PB00006                                                 06808000
@PB00004 EQU   @PB00005                                                 06809000
@PB00003 EQU   @PB00004                                                 06810000
@PB00002 EQU   @PB00003                                                 06811000
@ENDDATA EQU   *                                                        06812000
         END   IDCTP01,(C'PLS1136',0701,77341)                          06813000
