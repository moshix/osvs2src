         TITLE '**********  IDCTP04 -  AMS PAGE CONTROL MODULE  ********00001000
               ****     '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCTP04  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL2(@EP00002-@MAINENT)                                   00017000
         DC    AL1(16)                                             0002 00018000
         DC    C'IDCTP04   76.278'                                 0002 00019000
IDCTPES  DS    0H                                                  0002 00020000
         USING *,@15                                               0002 00021000
         B     @PROLOG                                             0002 00022000
         DC    AL2(@EP00190-IDCTPES)                                    00023000
         ENTRY IDCTPES                                                  00024000
IDCTPEA  DS    0H                                                  0002 00025000
         USING *,@15                                               0002 00026000
         B     @PROLOG                                             0002 00027000
         DC    AL2(@EP00198-IDCTPEA)                                    00028000
         ENTRY IDCTPEA                                                  00029000
IDCTPRS  DS    0H                                                  0002 00030000
         USING *,@15                                               0002 00031000
         B     @PROLOG                                             0002 00032000
         DC    AL2(@EP00206-IDCTPRS)                                    00033000
         ENTRY IDCTPRS                                                  00034000
IDCTPRE  DS    0H                                                  0002 00035000
         USING *,@15                                               0002 00036000
         B     @PROLOG                                             0002 00037000
         DC    AL2(@EP00218-IDCTPRE)                                    00038000
         ENTRY IDCTPRE                                                  00039000
         DROP  @15                                                      00040000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00041000
         BALR  @11,0                                               0002 00042000
@PSTART  LA    @12,4095(,@11)                                      0002 00043000
         USING @PSTART,@11                                         0002 00044000
         USING @PSTART+4095,@12                                    0002 00045000
         L     @00,@SIZDATD                                        0002 00046000
         GETMAIN  R,LV=(0)                                              00047000
         LR    @10,@01                                             0002 00048000
         USING @DATD,@10                                           0002 00049000
         ST    @13,@SA00001+4                                      0002 00050000
         LM    @15,@01,16(@13)                                     0002 00051000
         ST    @10,8(,@13)                                         0002 00052000
         LR    @13,@10                                             0002 00053000
         AH    @15,4(,@15)                                         0002 00054000
         BR    @15                                                 0002 00055000
@EP00002 MVC   @PC00001(36),0(@01)                                 0002 00056000
*                                     /*NEW BASE FOR THE GLOBAL      */ 00057000
*                                      /*DATA TABLE          @YL026UE*/ 00058000
*         /***********************************************************/ 00059000
*         /*                                                         */ 00060000
*         /*  BEGINNING OF THE CODE FOR THE PAGE CONTROL MODULE      */ 00061000
*         /* THIS CODE SORTS OUT THE VARIOUS TYPES OF CALLS AND      */ 00062000
*         /* TRANSFERS CONTROL TO THE PROPER PROCEDURE TO HANDLE IT. */ 00063000
*         /*                                                         */ 00064000
*         /***********************************************************/ 00065000
*                                                                  0190 00066000
*                                                                  0190 00067000
*        /* ENTRY POINT FOR THE ESTS MACRO                   @YL026UE*/ 00068000
*IDCTPES: ENTRY (GDTTBLX,FILENAME,ARG1);                   /*@YL026UE*/ 00069000
*                                                                  0190 00070000
         B     @EC00190                                            0190 00071000
@EP00190 MVC   @PC00001(12),0(@01)                                 0190 00072000
@EC00190 DS    0H                                                  0191 00073000
*         GDTPTR = ADDR(GDTTBLX);                          /*@YL026UE*/ 00074000
         L     GDTPTR,@PC00001                                     0191 00075000
*         CALL ESTSCONT(ARG1);                             /*@YL026UE*/ 00076000
         L     @08,@PC00001+8                                      0192 00077000
         ST    @08,@AL00001                                        0192 00078000
         LA    @01,@AL00001                                        0192 00079000
         BAL   @14,ESTSCONT                                        0192 00080000
*         RESPECIFY RTNREG RSTD;                                   0193 00081000
*         TESTRC = RTNREG;                                         0194 00082000
         LR    TESTRC,RTNREG                                       0194 00083000
*         RESPECIFY RTNREG UNRSTD;                         /*@YL026UE*/ 00084000
*         SETRC = TESTRC;                                  /*@YL026UE*/ 00085000
         STH   TESTRC,SETRC                                        0196 00086000
*         CALL IDCSAEP0(GDTTBL,MODID,SETRC);                       0197 00087000
         ST    GDTPTR,@AL00001                                     0197 00088000
         LA    @08,MODID                                           0197 00089000
         ST    @08,@AL00001+4                                      0197 00090000
         LA    @08,SETRC                                           0197 00091000
         ST    @08,@AL00001+8                                      0197 00092000
         MVI   @AL00001+8,X'80'                                    0197 00093000
         L     @15,GDTEPL(,GDTPTR)                                 0197 00094000
         LA    @01,@AL00001                                        0197 00095000
         BALR  @14,@15                                             0197 00096000
*       /*@YL026UE*/                                               0198 00097000
*                                                                  0198 00098000
*        /* ENTRY POINT FOR THE ESTA MACRO                   @YL026UE*/ 00099000
*IDCTPEA: ENTRY (GDTTBLX,FILENAME,ARG1);                   /*@YL026UE*/ 00100000
*                                                                  0198 00101000
         B     @EC00198                                            0198 00102000
@EP00198 MVC   @PC00001(12),0(@01)                                 0198 00103000
@EC00198 DS    0H                                                  0199 00104000
*         GDTPTR = ADDR(GDTTBLX);                          /*@YL026UE*/ 00105000
         L     GDTPTR,@PC00001                                     0199 00106000
*         CALL ESTACONT(ARG1);                             /*@YL026UE*/ 00107000
         L     @08,@PC00001+8                                      0200 00108000
         ST    @08,@AL00001                                        0200 00109000
         LA    @01,@AL00001                                        0200 00110000
         BAL   @14,ESTACONT                                        0200 00111000
*         RESPECIFY RTNREG RSTD;                                   0201 00112000
*         TESTRC = RTNREG;                                         0202 00113000
         LR    TESTRC,RTNREG                                       0202 00114000
*         RESPECIFY RTNREG UNRSTD;                         /*@YL026UE*/ 00115000
*         SETRC = TESTRC;                                  /*@YL026UE*/ 00116000
         STH   TESTRC,SETRC                                        0204 00117000
*         CALL IDCSAEP0(GDTTBL,MODID,SETRC);                       0205 00118000
         ST    GDTPTR,@AL00001                                     0205 00119000
         LA    @08,MODID                                           0205 00120000
         ST    @08,@AL00001+4                                      0205 00121000
         LA    @08,SETRC                                           0205 00122000
         ST    @08,@AL00001+8                                      0205 00123000
         MVI   @AL00001+8,X'80'                                    0205 00124000
         L     @15,GDTEPL(,GDTPTR)                                 0205 00125000
         LA    @01,@AL00001                                        0205 00126000
         BALR  @14,@15                                             0205 00127000
*       /*@YL026UE*/                                               0206 00128000
*                                                                  0206 00129000
*        /* ENTRY POINT FOR THE REST MACRO                   @YL026UE*/ 00130000
*IDCTPRS: ENTRY (GDTTBLX,FILENAME,ARG1,ARG2,ARG3,ARG4,ARG5,ARG6,ARG7);  00131000
*                                                                  0206 00132000
*                                                                  0206 00133000
         B     @EC00206                                            0206 00134000
@EP00206 MVC   @PC00001(36),0(@01)                                 0206 00135000
@EC00206 DS    0H                                                  0207 00136000
*                                                                  0207 00137000
*        /************************************************************/ 00138000
*        /*                                                          */ 00139000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 00140000
*        /*                                                          */ 00141000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 00142000
*        /*              TO THIS ROUTINE                             */ 00143000
*        /*                                                          */ 00144000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 00145000
*        /*               ADDRESS LIST                               */ 00146000
*        /*                                                          */ 00147000
*        /************************************************************/ 00148000
*                                                                  0207 00149000
*        GEN;                                                      0207 00150000
        ST    1,LISTPTR                                                 00151000
        ST    1,LISTSCAN                                                00152000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0208 00153000
         LA    LISTLN,1                                            0208 00154000
@DL00208 L     @03,LISTSCAN                                        0208 00155000
         TM    LISTTEST(@03),B'10000000'                           0208 00156000
         BNZ   @DC00208                                            0208 00157000
*          LISTSCAN = LISTSCAN + 4;                                0209 00158000
         AL    @03,@CF00053                                        0209 00159000
         ST    @03,LISTSCAN                                        0209 00160000
*        END;                                                      0210 00161000
*                                                                  0210 00162000
         AL    LISTLN,@CF00233                                     0210 00163000
         C     LISTLN,@CF00780                                     0210 00164000
         BNH   @DL00208                                            0210 00165000
@DC00208 DS    0H                                                  0211 00166000
*         GDTPTR = ADDR(GDTTBLX);                          /*@YL026UE*/ 00167000
         L     GDTPTR,@PC00001                                     0211 00168000
*         CALL RESTCONT;                                   /*@YL026UE*/ 00169000
         BAL   @14,RESTCONT                                        0212 00170000
*         RESPECIFY RTNREG RSTD;                                   0213 00171000
*         TESTRC = RTNREG;                                         0214 00172000
         LR    TESTRC,RTNREG                                       0214 00173000
*         RESPECIFY RTNREG UNRSTD;                         /*@YL026UE*/ 00174000
*         SETRC = TESTRC;                                  /*@YL026UE*/ 00175000
         STH   TESTRC,SETRC                                        0216 00176000
*         CALL IDCSAEP0(GDTTBL,MODID,SETRC);                       0217 00177000
         ST    GDTPTR,@AL00001                                     0217 00178000
         LA    @08,MODID                                           0217 00179000
         ST    @08,@AL00001+4                                      0217 00180000
         LA    @08,SETRC                                           0217 00181000
         ST    @08,@AL00001+8                                      0217 00182000
         MVI   @AL00001+8,X'80'                                    0217 00183000
         L     @15,GDTEPL(,GDTPTR)                                 0217 00184000
         LA    @01,@AL00001                                        0217 00185000
         BALR  @14,@15                                             0217 00186000
*       /*@YL026UE*/                                               0218 00187000
*                                                                  0218 00188000
*        /* ENTRY POINT FOR THE RESET MACRO                  @YL026UE*/ 00189000
*IDCTPRE: ENTRY (GDTTBLX,FILENAME,ARG1);                   /*@YL026UE*/ 00190000
*                                                                  0218 00191000
*                                                                  0218 00192000
         B     @EC00218                                            0218 00193000
@EP00218 MVC   @PC00001(12),0(@01)                                 0218 00194000
@EC00218 DS    0H                                                  0219 00195000
*                                                                  0219 00196000
*        /************************************************************/ 00197000
*        /*                                                          */ 00198000
*        /* ULISTLN MACRO INCLUDED CODE                              */ 00199000
*        /*                                                          */ 00200000
*        /*     LISTLN - TO CONTAIN THE NUMBER OF ARGUMENTS PASSED   */ 00201000
*        /*              TO THIS ROUTINE                             */ 00202000
*        /*                                                          */ 00203000
*        /*     LISTPTR - TO CONTAIN THE ADDRESS OF THE CORRESPONDING*/ 00204000
*        /*               ADDRESS LIST                               */ 00205000
*        /*                                                          */ 00206000
*        /************************************************************/ 00207000
*                                                                  0219 00208000
*        GEN;                                                      0219 00209000
        ST    1,LISTPTR                                                 00210000
        ST    1,LISTSCAN                                                00211000
*        DO LISTLN = 1 TO 255 WHILE(LISTTEST = '0'B);              0220 00212000
         LA    LISTLN,1                                            0220 00213000
@DL00220 L     @03,LISTSCAN                                        0220 00214000
         TM    LISTTEST(@03),B'10000000'                           0220 00215000
         BNZ   @DC00220                                            0220 00216000
*          LISTSCAN = LISTSCAN + 4;                                0221 00217000
         AL    @03,@CF00053                                        0221 00218000
         ST    @03,LISTSCAN                                        0221 00219000
*        END;                                                      0222 00220000
*                                                                  0222 00221000
         AL    LISTLN,@CF00233                                     0222 00222000
         C     LISTLN,@CF00780                                     0222 00223000
         BNH   @DL00220                                            0222 00224000
@DC00220 DS    0H                                                  0223 00225000
*         GDTPTR = ADDR(GDTTBLX);                          /*@YL026UE*/ 00226000
         L     GDTPTR,@PC00001                                     0223 00227000
*         IF  ARG1 ^= NULLPTR & LISTLN = 3                         0224 00228000
*           THEN                                                   0224 00229000
         L     @03,@PC00001+8                                      0224 00230000
         L     @03,ARG1(,@03)                                      0224 00231000
         LTR   @03,@03                                             0224 00232000
         BZ    @RF00224                                            0224 00233000
         C     LISTLN,@CF00176                                     0224 00234000
         BNE   @RF00224                                            0224 00235000
*             PGNOF = ON;                                  /*@YL026UE*/ 00236000
         OI    PGNOF,B'01000000'                                   0225 00237000
*           ELSE                                                   0226 00238000
*             PGNOF = OFF;                                 /*@YL026UE*/ 00239000
         B     @RC00224                                            0226 00240000
@RF00224 NI    PGNOF,B'10111111'                                   0226 00241000
*         CALL RESETCON(ARG1);                             /*@YL026UE*/ 00242000
@RC00224 L     @08,@PC00001+8                                      0227 00243000
         ST    @08,@AL00001                                        0227 00244000
         LA    @01,@AL00001                                        0227 00245000
         BAL   @14,RESETCON                                        0227 00246000
*         RESPECIFY RTNREG RSTD;                                   0228 00247000
*         TESTRC = RTNREG;                                         0229 00248000
         LR    TESTRC,RTNREG                                       0229 00249000
*         RESPECIFY RTNREG UNRSTD;                         /*@YL026UE*/ 00250000
*         SETRC = TESTRC;                                  /*@YL026UE*/ 00251000
         STH   TESTRC,SETRC                                        0231 00252000
*         CALL IDCSAEP0(GDTTBL,MODID,SETRC);                       0232 00253000
         ST    GDTPTR,@AL00001                                     0232 00254000
         LA    @08,MODID                                           0232 00255000
         ST    @08,@AL00001+4                                      0232 00256000
         LA    @08,SETRC                                           0232 00257000
         ST    @08,@AL00001+8                                      0232 00258000
         MVI   @AL00001+8,X'80'                                    0232 00259000
         L     @15,GDTEPL(,GDTPTR)                                 0232 00260000
         LA    @01,@AL00001                                        0232 00261000
         BALR  @14,@15                                             0232 00262000
*                                                                  0233 00263000
*         /***********************************************************/ 00264000
*         /*                                                         */ 00265000
*         /* PROCEDURE NAME - ESTS HANDLER                           */ 00266000
*         /*                                                         */ 00267000
*         /* FUNCTION - THIS PROCEDURE CONTROLS THE ESTABLISHMENT    */ 00268000
*         /* OF THE PRINT CONTROL TABLE THRU USE OF THE (UESTS)      */ 00269000
*         /* MACRO.  IT ALSO OPENS THE PRINT DATA SET.               */ 00270000
*         /*                                                         */ 00271000
*         /* INPUT - A STATIC TEXT IDENTIFIER (STID) IDENTIFYING     */ 00272000
*         /* THE NON-DEFAULT DATA TO BE SET IN THAT TABLE.           */ 00273000
*         /*                                                         */ 00274000
*         /* OUTPUT - A PRINT CONTROL TABLE.                         */ 00275000
*         /*                                                         */ 00276000
*         /***********************************************************/ 00277000
*                                                                  0233 00278000
*ESTSCONT: PROC (STIDS);                                           0233 00279000
*                                                                  0233 00280000
@EL00001 L     @13,4(,@13)                                         0233 00281000
@EF00001 L     @00,@SIZDATD                                        0233 00282000
         LR    @01,@10                                             0233 00283000
         FREEMAIN R,LV=(0),A=(1)                                        00284000
@ER00001 LM    @14,@12,12(@13)                                     0233 00285000
         BR    @14                                                 0233 00286000
ESTSCONT STM   @14,@12,@SA00002                                    0233 00287000
         MVC   @PC00002(4),0(@01)                                  0233 00288000
*         /***********************************************************/ 00289000
*         /*                                                         */ 00290000
*         /* GET THE CORE FOR THE PCT AND INITIALIZE IT.             */ 00291000
*         /*                                                         */ 00292000
*         /***********************************************************/ 00293000
*                                                                  0234 00294000
*         SAVERC = 0;                                              0234 00295000
         SLR   SAVERC,SAVERC                                       0234 00296000
*         PCTPTR = GDTTPH;                                         0235 00297000
         L     @08,GDTTPH(,GDTPTR)                                 0235 00298000
         LR    PCTPTR,@08                                          0235 00299000
*         IF GDTTPH = NULLPTR                                      0236 00300000
*           THEN                                                   0236 00301000
         LTR   @08,@08                                             0236 00302000
         BNZ   @RF00236                                            0236 00303000
*             PRIPCT = ON;                                         0237 00304000
         OI    PRIPCT,B'10000000'                                  0237 00305000
*           ELSE                                                   0238 00306000
*             PRIPCT = OFF;                                        0238 00307000
         B     @RC00236                                            0238 00308000
@RF00236 NI    PRIPCT,B'01111111'                                  0238 00309000
*         OLDERID2 = NEWERID2;                                     0239 00310000
@RC00236 L     @08,GDTTR2(,GDTPTR)                                 0239 00311000
         MVC   @TS00001(95),NEWERID2(@08)                          0239 00312000
         MVC   OLDERID2(95,@08),@TS00001                           0239 00313000
*         NEWID2 = 'TP4I';                                         0240 00314000
*                                                                  0240 00315000
         MVC   NEWID2(4,@08),@CC00795                              0240 00316000
*         IF PRIPCT = OFF & PCTSPP ^= NULLPTR                      0241 00317000
*           THEN                                                   0241 00318000
         TM    PRIPCT,B'10000000'                                  0241 00319000
         BNZ   @RF00241                                            0241 00320000
         L     @08,PCTSPP(,PCTPTR)                                 0241 00321000
         LTR   @08,@08                                             0241 00322000
         BZ    @RF00241                                            0241 00323000
*             PCTPTR = PCTSPP;                                     0242 00324000
*                                                                  0242 00325000
         LR    PCTPTR,@08                                          0242 00326000
*         CALL INITPCT;                                            0243 00327000
*                                                                  0243 00328000
@RF00241 BAL   @14,INITPCT                                         0243 00329000
*         /***********************************************************/ 00330000
*         /*                                                         */ 00331000
*         /* IF THE REQUEST IS FOR A PRIMARY PRINT CONTROL TABLE,    */ 00332000
*         /* THEN THE STANDARD SYSPRINT TABLE MUST BE OPENED.        */ 00333000
*         /*                                                         */ 00334000
*         /***********************************************************/ 00335000
*                                                                  0244 00336000
*         IF PRIPCT = ON                                           0244 00337000
*           THEN                                                   0244 00338000
         TM    PRIPCT,B'10000000'                                  0244 00339000
         BNO   @RF00244                                            0244 00340000
*             DO;                                                  0245 00341000
*               OPNPTR = ADDR(PROPEN);  /* SET OPNAGL ADDRESS.       */ 00342000
         LA    OPNPTR,PROPEN                                       0246 00343000
*               OPNAGL = ''B;           /* SET OPEN LIST TO ZEROS.   */ 00344000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0247 00345000
*               OPNTYPSO = ON;          /* SYSTEM OUTPUT FLAG.       */ 00346000
         OI    OPNTYPSO(OPNPTR),B'01000000'                        0248 00347000
*               OPNIOC = ADDR(PCTIOC);  /* IOC ADDRESS PTR.          */ 00348000
         LA    @08,PCTIOC(,PCTPTR)                                 0249 00349000
         ST    @08,OPNIOC(,OPNPTR)                                 0249 00350000
*               OPNMODAC = ON;          /* ASA CARRIAGE CONTROL CHAR */ 00351000
*                                                                  0250 00352000
         OI    OPNMODAC(OPNPTR),B'01000000'                        0250 00353000
*               CALL IDCIOOP0 (GDTTBL,OPNAGL);                     0251 00354000
*                                                                  0251 00355000
         ST    GDTPTR,@AL00001                                     0251 00356000
         ST    OPNPTR,@AL00001+4                                   0251 00357000
         MVI   @AL00001+4,X'80'                                    0251 00358000
         L     @15,GDTOPN(,GDTPTR)                                 0251 00359000
         LA    @01,@AL00001                                        0251 00360000
         BALR  @14,@15                                             0251 00361000
*               OLDERID2 = NEWERID2;                               0252 00362000
         L     @08,GDTTR2(,GDTPTR)                                 0252 00363000
         MVC   @TS00001(95),NEWERID2(@08)                          0252 00364000
         MVC   OLDERID2(95,@08),@TS00001                           0252 00365000
*               NEWID2 = 'TP4A';                                   0253 00366000
*                                                                  0253 00367000
         MVC   NEWID2(4,@08),@CC00798                              0253 00368000
*               /*****************************************************/ 00369000
*               /*                                                   */ 00370000
*               /* GET STORAGE FOR THE PRINT LINE STACK BUFFER.      */ 00371000
*               /*                                                   */ 00372000
*               /*****************************************************/ 00373000
*                                                                  0254 00374000
*               CALL IDCSAGS0 (GDTTBL,PRBUFL,PCTBUF);              0254 00375000
         ST    GDTPTR,@AL00001                                     0254 00376000
         LA    @08,PRBUFL                                          0254 00377000
         ST    @08,@AL00001+4                                      0254 00378000
         LA    @08,PCTBUF(,PCTPTR)                                 0254 00379000
         ST    @08,@AL00001+8                                      0254 00380000
         MVI   @AL00001+8,X'80'                                    0254 00381000
         L     @15,GDTGSP(,GDTPTR)                                 0254 00382000
         LA    @01,@AL00001                                        0254 00383000
         BALR  @14,@15                                             0254 00384000
*               RESPECIFY RTNREG RSTD;                             0255 00385000
*               TESTRC = RTNREG;                                   0256 00386000
         LR    TESTRC,RTNREG                                       0256 00387000
*               RESPECIFY RTNREG UNRSTD;                           0257 00388000
*               IF TESTRC ^= 0                                     0258 00389000
*                 THEN                                             0258 00390000
*                                                                  0258 00391000
         LTR   TESTRC,TESTRC                                       0258 00392000
         BZ    @RF00258                                            0258 00393000
*                   DO;                                            0259 00394000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0260 00395000
*                     REG15 = 28;                                  0261 00396000
         LA    REG15,28                                            0261 00397000
*                     REG14 = GDTABT;                              0262 00398000
         L     REG14,GDTABT(,GDTPTR)                               0262 00399000
*                     REG13 = GDTABH;                              0263 00400000
         L     REG13,GDTABH(,GDTPTR)                               0263 00401000
*                     GEN(BR    REG14);                            0264 00402000
         BR    REG14                                                    00403000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0265 00404000
*                   END;                                           0266 00405000
*               PCTBNL = PCTBUF;                                   0267 00406000
@RF00258 L     @08,PCTBUF(,PCTPTR)                                 0267 00407000
         ST    @08,PCTBNL(,PCTPTR)                                 0267 00408000
*            END;                                                  0268 00409000
*                                                                  0268 00410000
*         /***********************************************************/ 00411000
*         /*                                                         */ 00412000
*         /* GET THE STATIC TEXT ENTRY FOR THE REQUEST.              */ 00413000
*         /*                                                         */ 00414000
*         /***********************************************************/ 00415000
*                                                                  0269 00416000
*         CALL IDCTP05(GDTTBL,STIDS,SUBPZ,PCAADDR);        /*@YL026UE*/ 00417000
*                                                                  0269 00418000
@RF00244 ST    GDTPTR,@AL00001                                     0269 00419000
         L     @08,@PC00002                                        0269 00420000
         ST    @08,@AL00001+4                                      0269 00421000
         LA    @08,SUBPZ                                           0269 00422000
         ST    @08,@AL00001+8                                      0269 00423000
         LA    @08,PCAADDR                                         0269 00424000
         ST    @08,@AL00001+12                                     0269 00425000
         L     @15,@CV00747                                        0269 00426000
         LA    @01,@AL00001                                        0269 00427000
         BALR  @14,@15                                             0269 00428000
*         RESPECIFY RTNREG RSTD;                                   0270 00429000
*         TESTRC = RTNREG;                                         0271 00430000
         LR    TESTRC,RTNREG                                       0271 00431000
*         RESPECIFY RTNREG UNRSTD;                                 0272 00432000
*         IF TESTRC ^= 0                                           0273 00433000
*           THEN                                                   0273 00434000
         LTR   TESTRC,TESTRC                                       0273 00435000
         BZ    @RF00273                                            0273 00436000
*             RETURN CODE(TESTRC);                                 0274 00437000
         LR    @15,TESTRC                                          0274 00438000
         L     @14,@SA00002                                        0274 00439000
         LM    @00,@12,@SA00002+8                                  0274 00440000
         BR    @14                                                 0274 00441000
*         /***********************************************************/ 00442000
*         /*                                                         */ 00443000
*         /*  SET UP THE ADDRESSES FROM THE OFFSETS.                 */ 00444000
*         /*                                                         */ 00445000
*         /***********************************************************/ 00446000
*                                                                  0275 00447000
*         IF PCMTLP ^= NULLPTR                                     0275 00448000
*           THEN                                                   0275 00449000
@RF00273 L     @08,PCAADDR                                         0275 00450000
         L     @06,PCMTLP(,@08)                                    0275 00451000
         LTR   @06,@06                                             0275 00452000
         BZ    @RF00275                                            0275 00453000
*             PCMTLP = PCMTLP + PCAADDR;                           0276 00454000
         ALR   @06,@08                                             0276 00455000
         ST    @06,PCMTLP(,@08)                                    0276 00456000
*         IF PCSTLP ^= NULLPTR                                     0277 00457000
*           THEN                                                   0277 00458000
@RF00275 L     @08,PCAADDR                                         0277 00459000
         L     @06,PCSTLP(,@08)                                    0277 00460000
         LTR   @06,@06                                             0277 00461000
         BZ    @RF00277                                            0277 00462000
*             PCSTLP = PCSTLP + PCAADDR;                           0278 00463000
         ALR   @06,@08                                             0278 00464000
         ST    @06,PCSTLP(,@08)                                    0278 00465000
*         IF PCFLP ^= NULLPTR                                      0279 00466000
*           THEN                                                   0279 00467000
@RF00277 L     @08,PCAADDR                                         0279 00468000
         L     @06,PCFLP(,@08)                                     0279 00469000
         LTR   @06,@06                                             0279 00470000
         BZ    @RF00279                                            0279 00471000
*             PCFLP = PCFLP + PCAADDR;                             0280 00472000
         ALR   @06,@08                                             0280 00473000
         ST    @06,PCFLP(,@08)                                     0280 00474000
*         IF PCPCP ^= NULLPTR                                      0281 00475000
*           THEN                                                   0281 00476000
@RF00279 L     @08,PCAADDR                                         0281 00477000
         L     @06,PCPCP(,@08)                                     0281 00478000
         LTR   @06,@06                                             0281 00479000
         BZ    @RF00281                                            0281 00480000
*             PCPCP = PCPCP + PCAADDR;                             0282 00481000
*                                                                  0282 00482000
         ALR   @06,@08                                             0282 00483000
         ST    @06,PCPCP(,@08)                                     0282 00484000
*         /***********************************************************/ 00485000
*         /*                                                         */ 00486000
*         /*  THE INPUT PARAMETER LIST IS SET UP.  CALL THE PROCEDURE*/ 00487000
*         /*  TO INITIALIZE THE PARAMETERS.                          */ 00488000
*         /*                                                         */ 00489000
*         /***********************************************************/ 00490000
*                                                                  0283 00491000
*         CALL P04SETUP;                                           0283 00492000
*                                                                  0283 00493000
@RF00281 BAL   @14,P04SETUP                                        0283 00494000
*         /***********************************************************/ 00495000
*         /*                                                         */ 00496000
*         /* CALL THE ROUTINE TO SET UP THE PARAMETERS IN THE PCT    */ 00497000
*         /*                                                         */ 00498000
*         /***********************************************************/ 00499000
*                                                                  0284 00500000
*         CALL PCTSETUP;                                           0284 00501000
*                                                                  0284 00502000
         BAL   @14,PCTSETUP                                        0284 00503000
*         RESPECIFY RTNREG RSTD;                                   0285 00504000
*         TESTRC = RTNREG;                                         0286 00505000
         LR    TESTRC,RTNREG                                       0286 00506000
*         RESPECIFY RTNREG UNRSTD;                                 0287 00507000
*         SAVERC = TESTRC;                                         0288 00508000
*                                                                  0288 00509000
         LR    SAVERC,TESTRC                                       0288 00510000
*         IF GDTDBG = NULLPTR                                      0289 00511000
*           THEN;                                                  0289 00512000
         L     @08,GDTDBG(,GDTPTR)                                 0289 00513000
         LTR   @08,@08                                             0289 00514000
         BZ    @RT00289                                            0289 00515000
*           ELSE                                                   0291 00516000
*             CALL IDCDB010  (GDTTBL,'TP4S');                      0291 00517000
*                                                                  0291 00518000
         ST    GDTPTR,@AL00001                                     0291 00519000
         LA    @08,@CC00802                                        0291 00520000
         ST    @08,@AL00001+4                                      0291 00521000
         MVI   @AL00001+4,X'80'                                    0291 00522000
         L     @15,GDTDBG(,GDTPTR)                                 0291 00523000
         LA    @01,@AL00001                                        0291 00524000
         BALR  @14,@15                                             0291 00525000
*         CALL IDCSAFS0 (GDTTBL,PCAADDR);/*                        0292 00526000
*                                          FREE STATIC TEXT CORE.    */ 00527000
*                                                                  0292 00528000
@RT00289 ST    GDTPTR,@AL00001                                     0292 00529000
         LA    @08,PCAADDR                                         0292 00530000
         ST    @08,@AL00001+4                                      0292 00531000
         L     @15,GDTFSP(,GDTPTR)                                 0292 00532000
         LA    @01,@AL00001                                        0292 00533000
         BALR  @14,@15                                             0292 00534000
*         RETURN CODE(SAVERC);                                     0293 00535000
         LR    @15,SAVERC                                          0293 00536000
         L     @14,@SA00002                                        0293 00537000
         LM    @00,@12,@SA00002+8                                  0293 00538000
         BR    @14                                                 0293 00539000
*         END ESTSCONT;                                            0294 00540000
*         /***********************************************************/ 00541000
*         /*                                                         */ 00542000
*         /* PROCEDURE NAME - ESTA HANDLER.                          */ 00543000
*         /*                                                         */ 00544000
*         /* FUNCTION - ESTABLISHES A PRINT CONTROL TABLE FROM THE   */ 00545000
*         /* ARGUMENTS PASSED WITH THE CALL.  STATIC TEXT IS NOT     */ 00546000
*         /* REFERENCED IN THIS TYPE OF CALL.                        */ 00547000
*         /*                                                         */ 00548000
*         /* INPUT - THE ARGUMENT LIST DEFINED BY PCALIST IN THIS    */ 00549000
*         /* PROCEDURE.                                              */ 00550000
*         /*                                                         */ 00551000
*         /* OUTPUT - A PRINT CONTROL TABLE.                         */ 00552000
*         /*                                                         */ 00553000
*         /***********************************************************/ 00554000
*                                                                  0295 00555000
*ESTACONT: PROC (PCALIST);                                         0295 00556000
*                                                                  0295 00557000
ESTACONT STM   @14,@12,@SA00003                                    0295 00558000
         MVC   @PC00003(4),0(@01)                                  0295 00559000
*         SAVERC = 0;                                              0296 00560000
         SLR   SAVERC,SAVERC                                       0296 00561000
*         PCTPTR = GDTTPH;                                         0297 00562000
*                                                                  0297 00563000
         L     @08,GDTTPH(,GDTPTR)                                 0297 00564000
         LR    PCTPTR,@08                                          0297 00565000
*         PCAADDR = ADDR(PCALIST);     /* SET STRUCTURE ADDRESS      */ 00566000
*                                                                  0298 00567000
         L     @06,@PC00003                                        0298 00568000
         ST    @06,PCAADDR                                         0298 00569000
*         /***********************************************************/ 00570000
*         /*                                                         */ 00571000
*         /* GET AND INITIALIZE THE PRINT CONTROL TABLE AREA.        */ 00572000
*         /*                                                         */ 00573000
*         /***********************************************************/ 00574000
*                                                                  0299 00575000
*         IF GDTTPH = NULLPTR                                      0299 00576000
*           THEN                                                   0299 00577000
         LTR   @08,@08                                             0299 00578000
         BNZ   @RF00299                                            0299 00579000
*             PRIPCT = ON;              /* PRIMARY CONTROL TABLE ON. */ 00580000
         OI    PRIPCT,B'10000000'                                  0300 00581000
*           ELSE                                                   0301 00582000
*             PRIPCT = OFF;             /* PRIMARY CONTROL TABLE OFF */ 00583000
         B     @RC00299                                            0301 00584000
@RF00299 NI    PRIPCT,B'01111111'                                  0301 00585000
*         IF PRIPCT = OFF & PCTSPP ^= NULLPTR                      0302 00586000
*           THEN                                                   0302 00587000
@RC00299 TM    PRIPCT,B'10000000'                                  0302 00588000
         BNZ   @RF00302                                            0302 00589000
         L     @08,PCTSPP(,PCTPTR)                                 0302 00590000
         LTR   @08,@08                                             0302 00591000
         BZ    @RF00302                                            0302 00592000
*             PCTPTR = PCTSPP;                                     0303 00593000
*                                                                  0303 00594000
         LR    PCTPTR,@08                                          0303 00595000
*         CALL INITPCT;                /* GET CORE FOR THE PCT.     */  00596000
*                                                                  0304 00597000
@RF00302 BAL   @14,INITPCT                                         0304 00598000
*         /***********************************************************/ 00599000
*         /*                                                         */ 00600000
*         /*  CALL THE PROCEDURE TO INITIALIZE THE PARAMETERS.       */ 00601000
*         /*                                                         */ 00602000
*         /***********************************************************/ 00603000
*                                                                  0305 00604000
*         CALL P04SETUP;                                           0305 00605000
*                                                                  0305 00606000
         BAL   @14,P04SETUP                                        0305 00607000
*         /***********************************************************/ 00608000
*         /*                                                         */ 00609000
*         /*  CALL THE ROUTINE TO SET UP THE PARAMETERS IN THE PCT   */ 00610000
*         /*                                                         */ 00611000
*         /***********************************************************/ 00612000
*                                                                  0306 00613000
*         CALL PCTSETUP;                                           0306 00614000
*                                                                  0306 00615000
         BAL   @14,PCTSETUP                                        0306 00616000
*         RESPECIFY RTNREG RSTD;                                   0307 00617000
*         TESTRC = RTNREG;                                         0308 00618000
         LR    TESTRC,RTNREG                                       0308 00619000
*         RESPECIFY RTNREG UNRSTD;                                 0309 00620000
*         SAVERC = TESTRC;                                         0310 00621000
*                                                                  0310 00622000
         LR    SAVERC,TESTRC                                       0310 00623000
*         IF GDTDBG = NULLPTR                                      0311 00624000
*           THEN;                                                  0311 00625000
         L     @08,GDTDBG(,GDTPTR)                                 0311 00626000
         LTR   @08,@08                                             0311 00627000
         BZ    @RT00311                                            0311 00628000
*           ELSE                                                   0313 00629000
*             CALL IDCDB010  (GDTTBL,'TP4A');                      0313 00630000
*                                                                  0313 00631000
         ST    GDTPTR,@AL00001                                     0313 00632000
         LA    @08,@CC00798                                        0313 00633000
         ST    @08,@AL00001+4                                      0313 00634000
         MVI   @AL00001+4,X'80'                                    0313 00635000
         L     @15,GDTDBG(,GDTPTR)                                 0313 00636000
         LA    @01,@AL00001                                        0313 00637000
         BALR  @14,@15                                             0313 00638000
*         RETURN CODE(SAVERC);                                     0314 00639000
@RT00311 LR    @15,SAVERC                                          0314 00640000
         L     @14,@SA00003                                        0314 00641000
         LM    @00,@12,@SA00003+8                                  0314 00642000
         BR    @14                                                 0314 00643000
*         END ESTACONT;                                            0315 00644000
*         /***********************************************************/ 00645000
*         /*                                                         */ 00646000
*         /* PROCEDURE NAME - PRINT WORK TABLE INITIALIZATION.       */ 00647000
*         /*                                                         */ 00648000
*         /* FUNCTION - INITIALIZES MOST OF THE DEFAULT VALUES IN    */ 00649000
*         /* IN THE PRINT WORK TABLE.                                */ 00650000
*         /* THIS PROCEDURE IS CALLED FROM THE TP04A & TP04B         */ 00651000
*         /* PROCEDURES AND MOVES THE INPUT ARGUMENTS INTO THE       */ 00652000
*         /* COMMON WORK TABLE SO THEY CAN BE MORE EFFICIENTLY       */ 00653000
*         /* HANDLED.                                                */ 00654000
*         /*                                                         */ 00655000
*         /* INPUT - NONE.                                           */ 00656000
*         /*                                                         */ 00657000
*         /* OUTPUT - A PARTIALLY INITIALIZED PRINT WORK TABLE.      */ 00658000
*         /*                                                         */ 00659000
*         /***********************************************************/ 00660000
*                                                                  0316 00661000
*P04SETUP: PROC;                                                   0316 00662000
*                                                                  0316 00663000
P04SETUP STM   @14,@12,12(@13)                                     0316 00664000
*         /***********************************************************/ 00665000
*         /*                                                         */ 00666000
*         /* SET UP THE WORKING PARAMETER TABLE.                     */ 00667000
*         /*                                                         */ 00668000
*         /***********************************************************/ 00669000
*                                                                  0317 00670000
*         P04WT = ''B;                                             0317 00671000
         XC    P04WT(42),P04WT                                     0317 00672000
*         P04MTP = PCMTLP;              /* SET MAIN TITLE LINE PTR   */ 00673000
         L     @08,PCAADDR                                         0318 00674000
         L     @03,PCMTLP(,@08)                                    0318 00675000
         ST    @03,P04MTP                                          0318 00676000
*         P04MTC = PCMTLC;              /* SET MAIN TITLE LINE COUNT */ 00677000
         LH    @03,PCMTLC(,@08)                                    0319 00678000
         STH   @03,P04MTC                                          0319 00679000
*         P04STP = PCSTLP;              /* SET SUB-TITLE LINE PTR    */ 00680000
         L     @03,PCSTLP(,@08)                                    0320 00681000
         ST    @03,P04STP                                          0320 00682000
*         P04STC = PCSTLC;              /* SET SUB-TITLE LINE COUNT  */ 00683000
         LH    @03,PCSTLC(,@08)                                    0321 00684000
         STH   @03,P04STC                                          0321 00685000
*         P04FP = PCFLP;                /* SET FOOTING LINE PTR      */ 00686000
         L     @03,PCFLP(,@08)                                     0322 00687000
         ST    @03,P04FP                                           0322 00688000
*         P04FC = PCFLC;                /* SET FOOTING LINE COUNT    */ 00689000
         LH    @03,PCFLC(,@08)                                     0323 00690000
         STH   @03,P04FC                                           0323 00691000
*         P04PCP = PCPCP;               /* SET CHAIN POINTER.        */ 00692000
         L     @03,PCPCP(,@08)                                     0324 00693000
         ST    @03,P04PCP                                          0324 00694000
*         P04PNL = PCPNL;               /* SET PAGE NUMBER LOCATION  */ 00695000
         LH    @03,PCPNL(,@08)                                     0325 00696000
         STH   @03,P04PNL                                          0325 00697000
*         P04TL = PCPTL;                /* SET TIME LOCATION         */ 00698000
         LH    @03,PCPTL(,@08)                                     0326 00699000
         STH   @03,P04TL                                           0326 00700000
*         P04DL = PCPDL;                /* SET DATE LOCATION         */ 00701000
         LH    @03,PCPDL(,@08)                                     0327 00702000
         STH   @03,P04DL                                           0327 00703000
*         P04LW = PCLW;                 /* SET THE LINE WIDTH.       */ 00704000
         LH    @03,PCLW(,@08)                                      0328 00705000
         STH   @03,P04LW                                           0328 00706000
*         P04PD = PCPD;                 /* SET PAGE DEPTH            */ 00707000
         LH    @03,PCPD(,@08)                                      0329 00708000
         STH   @03,P04PD                                           0329 00709000
*         P04DSC = PCDSC;               /* SET DEFAULT SPACE CHAR    */ 00710000
         SLR   @03,@03                                             0330 00711000
         IC    @03,PCDSC(,@08)                                     0330 00712000
         STH   @03,P04DSC                                          0330 00713000
*         END P04SETUP;                                            0331 00714000
@EL00004 DS    0H                                                  0331 00715000
@EF00004 DS    0H                                                  0331 00716000
@ER00004 LM    @14,@12,12(@13)                                     0331 00717000
         BR    @14                                                 0331 00718000
*         /***********************************************************/ 00719000
*         /*                                                         */ 00720000
*         /* PROCEDURE NAME - REST HANDLER.                          */ 00721000
*         /*                                                         */ 00722000
*         /* FUNCTION - THIS PROCEDURE CONTROL THE SETTING UP OF     */ 00723000
*         /* PARAMETERS IN THE PRINT CONTROL TABLE PASSED BY THE     */ 00724000
*         /* UREST MACRO.                                            */ 00725000
*         /*                                                         */ 00726000
*         /* INPUT - THE ARGUMENT LIST DEFINED BY THE PCR STRUCTURE  */ 00727000
*         /* IN THIS PROCEDURE.                                      */ 00728000
*         /*                                                         */ 00729000
*         /* OUTPUT - A MODIFIED EXISTING PRINT CONTROL TABLE.       */ 00730000
*         /*                                                         */ 00731000
*         /***********************************************************/ 00732000
*                                                                  0332 00733000
*RESTCONT: PROC;                                                   0332 00734000
*                                                                  0332 00735000
RESTCONT STM   @14,@12,@SA00005                                    0332 00736000
*         IF GDTTPH = NULLPTR                                      0333 00737000
*           THEN                                                   0333 00738000
*                                                                  0333 00739000
         L     @03,GDTTPH(,GDTPTR)                                 0333 00740000
         LTR   @03,@03                                             0333 00741000
         BNZ   @RF00333                                            0333 00742000
*             DO;                                                  0334 00743000
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0335 00744000
*               REG15 = 24;                                        0336 00745000
         LA    REG15,24                                            0336 00746000
*               REG14 = GDTABT;                                    0337 00747000
         L     REG14,GDTABT(,GDTPTR)                               0337 00748000
*               REG13 = GDTABH;                                    0338 00749000
         L     REG13,GDTABH(,GDTPTR)                               0338 00750000
*               GEN(BR    REG14);                                  0339 00751000
         BR    REG14                                                    00752000
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0340 00753000
*             END;                                                 0341 00754000
*         PRIPCT = OFF;                                            0342 00755000
@RF00333 NI    PRIPCT,B'01111111'                                  0342 00756000
*         SAVERC = 0;                                      /*@YL026UE*/ 00757000
*                                                                  0343 00758000
         SLR   SAVERC,SAVERC                                       0343 00759000
*         PCTPTR = GDTTPH;                                         0344 00760000
         L     PCTPTR,GDTTPH(,GDTPTR)                              0344 00761000
*         IF PCTSPP ^= NULLPTR                                     0345 00762000
*           THEN                                                   0345 00763000
         L     @06,PCTSPP(,PCTPTR)                                 0345 00764000
         LTR   @06,@06                                             0345 00765000
         BZ    @RF00345                                            0345 00766000
*             PCTPTR = PCTSPP;                                     0346 00767000
*                                                                  0346 00768000
         LR    PCTPTR,@06                                          0346 00769000
*         /***********************************************************/ 00770000
*         /*                                                         */ 00771000
*         /* FLUSH THE STACK BUFFER BEFORE MAKING ANY CHANGES.       */ 00772000
*         /*                                                         */ 00773000
*         /***********************************************************/ 00774000
*                                                                  0347 00775000
*         CALL STACKFL;                                            0347 00776000
*                                                                  0347 00777000
@RF00345 BAL   @14,STACKFL                                         0347 00778000
*         /***********************************************************/ 00779000
*         /*                                                         */ 00780000
*         /* THE FOLLOWING ARE DECLARES USED EXCLUSIVELY IN THIS     */ 00781000
*         /* PROCEDURE.  THE FIRST IS THE TABLE USED IN GETTING THE  */ 00782000
*         /* TRANSLATE TABLE REQUIRED BY VARIOUS PRINT CHAINS.       */ 00783000
*         /*                                                         */ 00784000
*         /***********************************************************/ 00785000
*                                                                  0348 00786000
*         /***********************************************************/ 00787000
*         /*                                                         */ 00788000
*         /* THE FOLLOWING IS A THREE BYTE WIDE TABLE OF THE VARIOUS */ 00789000
*         /* STANDARD PRINT CHAINS.  THE FIRST TWO BYTES OF EACH     */ 00790000
*         /* ENTRY CONTAIN THE PRINT CHAIN ID, THE THIRD BYTE        */ 00791000
*         /* CONTAINS THE STATIC TEXT ENTRY NUMBER IN THE MODULE     */ 00792000
*         /* IDCTSTP0 THAT CONTAINS THE TRANSLATE TABLE FOR THAT     */ 00793000
*         /* TYPE OF CHAIN.                                          */ 00794000
*         /*                                                         */ 00795000
*         /***********************************************************/ 00796000
*         DCL PCTAB (7) CHAR (3) INIT                              0348 00797000
*           ('C1D501'X,                 /* AN CHAIN.                 */ 00798000
*            'C8D506'X,                 /* HN CHAIN.                 */ 00799000
*            'D7D502'X,                 /* PN CHAIN.                 */ 00800000
*            'D8D503'X,                 /* QN CHAIN.                 */ 00801000
*            'D9D507'X,                 /* RN CHAIN.                 */ 00802000
*            'E2D504'X,                 /* SN CHAIN.                 */ 00803000
*            'E3D505'X);                /* TN CHAIN.                 */ 00804000
*                                                                  0348 00805000
*         DCL RESTARG(7) PTR(31);                                  0349 00806000
*                                                                  0350 00807000
*         /***********************************************************/ 00808000
*         /*                                                         */ 00809000
*         /* RUNNING CODE BEGINS HERE.                               */ 00810000
*         /*                                                         */ 00811000
*         /***********************************************************/ 00812000
*                                                                  0350 00813000
*         P04WT = ''B;                  /* CLEAR THE WORK TABLE. */     00814000
         XC    P04WT(42),P04WT                                     0350 00815000
*         RESTARG(1)=ADDR(ARG1);                                   0351 00816000
         L     @06,@PC00001+8                                      0351 00817000
         ST    @06,RESTARG                                         0351 00818000
*         RESTARG(2)=ADDR(ARG2);                                   0352 00819000
         L     @06,@PC00001+12                                     0352 00820000
         ST    @06,RESTARG+4                                       0352 00821000
*         RESTARG(3)=ADDR(ARG3);                                   0353 00822000
         L     @06,@PC00001+16                                     0353 00823000
         ST    @06,RESTARG+8                                       0353 00824000
*         RESTARG(4)=ADDR(ARG4);                                   0354 00825000
         L     @06,@PC00001+20                                     0354 00826000
         ST    @06,RESTARG+12                                      0354 00827000
*         RESTARG(5)=ADDR(ARG5);                                   0355 00828000
         L     @06,@PC00001+24                                     0355 00829000
         ST    @06,RESTARG+16                                      0355 00830000
*         RESTARG(6)=ADDR(ARG6);                                   0356 00831000
         L     @06,@PC00001+28                                     0356 00832000
         ST    @06,RESTARG+20                                      0356 00833000
*         RESTARG(7)=ADDR(ARG7);                                   0357 00834000
         L     @06,@PC00001+32                                     0357 00835000
         ST    @06,RESTARG+24                                      0357 00836000
*         DO ARGNMB = 1 TO (LISTLN - 2) BY 1;                      0358 00837000
         LA    @06,1                                               0358 00838000
         STH   @06,ARGNMB                                          0358 00839000
         B     @DE00358                                            0358 00840000
@DL00358 DS    0H                                                  0359 00841000
*                                       /* LOOP THROUGH THE ARGS.    */ 00842000
*           PCRADDR = RESTARG(ARGNMB);  /* SET PARM ADDRESS          */ 00843000
*                                                                  0359 00844000
         LH    @04,ARGNMB                                          0359 00845000
         SLA   @04,2                                               0359 00846000
         L     PCRADDR,RESTARG-4(@04)                              0359 00847000
*           /*********************************************************/ 00848000
*           /*                                                       */ 00849000
*           /* IF SUB_TITLE ARGUMENT ENTERED, INITIALIZE THEM.       */ 00850000
*           /*                                                       */ 00851000
*           /*********************************************************/ 00852000
*                                                                  0360 00853000
*           IF PCRTYP = 'ST'            /* TEST FOR SUB-TITLE LINE   */ 00854000
*             THEN                                                 0360 00855000
         CLC   PCRTYP(2,PCRADDR),@CC00825                          0360 00856000
         BNE   @RF00360                                            0360 00857000
*               DO;                                                0361 00858000
*                 IF PCRPTR = NULLPTR                              0362 00859000
*                   THEN                                           0362 00860000
         L     @04,PCRPTR(,PCRADDR)                                0362 00861000
         LTR   @04,@04                                             0362 00862000
         BNZ   @RF00362                                            0362 00863000
*                     P04STC = -1;      /* SET TO CLEAR EXISTING.    */ 00864000
         MVC   P04STC(2),@CH00826                                  0363 00865000
*                   ELSE                                           0364 00866000
*                     DO;               /* SET NEW SUB-TITLE PTR.    */ 00867000
         B     @RC00362                                            0364 00868000
@RF00362 DS    0H                                                  0365 00869000
*                       P04STP = PCRPTR;                           0365 00870000
         L     @04,PCRPTR(,PCRADDR)                                0365 00871000
         ST    @04,P04STP                                          0365 00872000
*                       P04STC = PCRLC;                            0366 00873000
         LH    @04,PCRLC(,PCRADDR)                                 0366 00874000
         STH   @04,P04STC                                          0366 00875000
*                     END;                                         0367 00876000
*               END;                                               0368 00877000
*                                                                  0368 00878000
@RC00362 DS    0H                                                  0369 00879000
*           /*********************************************************/ 00880000
*           /*                                                       */ 00881000
*           /* IF FOOTING LINE ARGUMENT ENTERED INITIALIZE THEM.     */ 00882000
*           /*                                                       */ 00883000
*           /*********************************************************/ 00884000
*                                                                  0369 00885000
*           IF PCRTYP = 'FT'            /* CHECK FOR FOOTING LINE    */ 00886000
*             THEN                                                 0369 00887000
@RF00360 CLC   PCRTYP(2,PCRADDR),@CC00827                          0369 00888000
         BNE   @RF00369                                            0369 00889000
*               DO;                                                0370 00890000
*                 IF PCRPTR = NULLPTR                              0371 00891000
*                   THEN                                           0371 00892000
         L     @04,PCRPTR(,PCRADDR)                                0371 00893000
         LTR   @04,@04                                             0371 00894000
         BNZ   @RF00371                                            0371 00895000
*                     P04FC = -1;       /* SET TO CLEAR EXISTING.    */ 00896000
         MVC   P04FC(2),@CH00826                                   0372 00897000
*                   ELSE                                           0373 00898000
*                     DO;               /* SET NEW FOOTING PTR.      */ 00899000
         B     @RC00371                                            0373 00900000
@RF00371 DS    0H                                                  0374 00901000
*                       P04FP = PCRPTR;                            0374 00902000
         L     @04,PCRPTR(,PCRADDR)                                0374 00903000
         ST    @04,P04FP                                           0374 00904000
*                       P04FC = PCRLC;                             0375 00905000
         LH    @04,PCRLC(,PCRADDR)                                 0375 00906000
         STH   @04,P04FC                                           0375 00907000
*                     END;                                         0376 00908000
*               END;                                               0377 00909000
*                                                                  0377 00910000
@RC00371 DS    0H                                                  0378 00911000
*           /*********************************************************/ 00912000
*           /*                                                       */ 00913000
*           /* IF LINE WIDTH ARGUMENTS ENTERED, INITIALIZE THEM      */ 00914000
*           /*                                                       */ 00915000
*           /*********************************************************/ 00916000
*                                                                  0378 00917000
*           IF PCRTYP = 'LW'            /* TEST FOR NEW LINE WIDTH   */ 00918000
*             THEN                                                 0378 00919000
@RF00369 CLC   PCRTYP(2,PCRADDR),@CC00828                          0378 00920000
         BNE   @RF00378                                            0378 00921000
*               DO;                                                0379 00922000
*                 P04LW = PCRLC;        /* SET NEW LINE WIDTH        */ 00923000
         LH    @04,PCRLC(,PCRADDR)                                 0380 00924000
         STH   @04,P04LW                                           0380 00925000
*                 IF PCRLC = 0                                     0381 00926000
*                   THEN                                           0381 00927000
         LTR   @04,@04                                             0381 00928000
         BNZ   @RF00381                                            0381 00929000
*                     P04LW = STDLW;    /* SET TO RESTORE DEFAULT.   */ 00930000
         L     @04,STDLW                                           0382 00931000
         STH   @04,P04LW                                           0382 00932000
*               END;                                               0383 00933000
*                                                                  0383 00934000
@RF00381 DS    0H                                                  0384 00935000
*           /*********************************************************/ 00936000
*           /*                                                       */ 00937000
*           /* IF PAGE DEPTH ARGUMENTS ENTERED, INITIALIZE THEM.     */ 00938000
*           /*                                                       */ 00939000
*           /*********************************************************/ 00940000
*                                                                  0384 00941000
*           IF PCRTYP = 'PD'            /* TEST FOR NEW PAGE DEPTH   */ 00942000
*             THEN                                                 0384 00943000
@RF00378 CLC   PCRTYP(2,PCRADDR),@CC00829                          0384 00944000
         BNE   @RF00384                                            0384 00945000
*               DO;                                                0385 00946000
*                 P04PD = PCRLC;        /* SET NEW PAGE DEPTH        */ 00947000
         LH    @04,PCRLC(,PCRADDR)                                 0386 00948000
         STH   @04,P04PD                                           0386 00949000
*                 IF PCRLC = 0                                     0387 00950000
*                   THEN                                           0387 00951000
         LTR   @04,@04                                             0387 00952000
         BNZ   @RF00387                                            0387 00953000
*                     P04PD = STDPD;    /* SET TO RESTORE DEFAULT.   */ 00954000
         MVC   P04PD(2),@CH00725                                   0388 00955000
*               END;                                               0389 00956000
*                                                                  0389 00957000
@RF00387 DS    0H                                                  0390 00958000
*           /*********************************************************/ 00959000
*           /*                                                       */ 00960000
*           /* IF DEFAULT SPACE CHARACTER ENTERED, INITIALIZE IT.    */ 00961000
*           /*                                                       */ 00962000
*           /*********************************************************/ 00963000
*                                                                  0390 00964000
*           IF PCRTYP = 'SC'            /* TEST FOR NEW DEFAULT SPACE*/ 00965000
*             THEN                                                 0390 00966000
@RF00384 CLC   PCRTYP(2,PCRADDR),@CC00830                          0390 00967000
         BNE   @RF00390                                            0390 00968000
*               DO;                                                0391 00969000
*                 P04DSC = PCRLC;       /* SET NEW DSC               */ 00970000
         LH    @04,PCRLC(,PCRADDR)                                 0392 00971000
         STH   @04,P04DSC                                          0392 00972000
*                 IF PCRLC = 0                                     0393 00973000
*                   THEN                                           0393 00974000
         LTR   @04,@04                                             0393 00975000
         BNZ   @RF00393                                            0393 00976000
*                     P04DSC = 1;       /* SET TO RESTORE DEFAULT.   */ 00977000
         MVC   P04DSC(2),@CH00233                                  0394 00978000
*               END;                                               0395 00979000
*                                                                  0395 00980000
@RF00393 DS    0H                                                  0396 00981000
*           /*********************************************************/ 00982000
*           /*                                                       */ 00983000
*           /* IF PRINT CHAIN ARGUMENTS ENTERED, INITIALIZE IT.      */ 00984000
*           /*                                                       */ 00985000
*           /*********************************************************/ 00986000
*                                                                  0396 00987000
*         IF PCRTYP = 'PC'              /* TEST FOR PRINT CHAIN */ 0396 00988000
*           THEN                                                   0396 00989000
@RF00390 CLC   PCRTYP(2,PCRADDR),@CC00831                          0396 00990000
         BNE   @RF00396                                            0396 00991000
*             DO;                                                  0397 00992000
*               IF PCRLC ^= 0                                      0398 00993000
*                 THEN                                             0398 00994000
*                                                                  0398 00995000
         LH    @04,PCRLC(,PCRADDR)                                 0398 00996000
         LTR   @04,@04                                             0398 00997000
         BZ    @RF00398                                            0398 00998000
*                 /***************************************************/ 00999000
*                 /*                                                 */ 01000000
*                 /* IF PCRLC IS NON-ZERO, A STANDARD PRINT CHAIN    */ 01001000
*                 /* ID HAS BEEN FURNISHED.                          */ 01002000
*                 /* SEARCH THE TABLE FOR THE PRINT CHAIN ENTERED.   */ 01003000
*                 /* CHAIN ENTERED.                                  */ 01004000
*                 /* IF A MATCH IS FOUND, GO TO IDCTP05 TO GET IT.   */ 01005000
*                 /*                                                 */ 01006000
*                 /***************************************************/ 01007000
*                                                                  0399 01008000
*                   DO;                                            0399 01009000
*                     STID(1:3) = 'TP0';                           0400 01010000
         MVC   STID(3),@CC00832                                    0400 01011000
*                                       /* SET UP THE STID FOR CHAIN */ 01012000
*                     DO N = 1 TO 7 BY 1;                          0401 01013000
         LA    N,1                                                 0401 01014000
@DL00401 DS    0H                                                  0402 01015000
*                       IF PCTAB(N,1:2) = PCRLCC                   0402 01016000
*                         THEN                                     0402 01017000
         LR    @04,N                                               0402 01018000
         MH    @04,@CH00176                                        0402 01019000
         LA    @01,PCTAB-3(@04)                                    0402 01020000
         CLC   0(2,@01),PCRLCC(PCRADDR)                            0402 01021000
         BNE   @RF00402                                            0402 01022000
*                           STID(4) = PCTAB(N,3);                  0403 01023000
         LA    @01,PCTAB-1(@04)                                    0403 01024000
         MVC   STID+3(1),0(@01)                                    0403 01025000
*                                       /* SET THE ENTRY NUMBER.     */ 01026000
*                     END;                                         0404 01027000
@RF00402 AL    N,@CF00233                                          0404 01028000
         C     N,@CF00816                                          0404 01029000
         BNH   @DL00401                                            0404 01030000
*                     IF STID(4) ^= 0                              0405 01031000
*                       THEN                                       0405 01032000
         CLI   STID+3,0                                            0405 01033000
         BE    @RF00405                                            0405 01034000
*                         DO;                                      0406 01035000
*                                                                  0406 01036000
*                           CALL IDCTP05(GDTTBL,STID,SUBPZ,P04PCP);     01037000
*                                                                  0407 01038000
         ST    GDTPTR,@AL00001                                     0407 01039000
         LA    @04,STID                                            0407 01040000
         ST    @04,@AL00001+4                                      0407 01041000
         LA    @04,SUBPZ                                           0407 01042000
         ST    @04,@AL00001+8                                      0407 01043000
         LA    @04,P04PCP                                          0407 01044000
         ST    @04,@AL00001+12                                     0407 01045000
         L     @15,@CV00747                                        0407 01046000
         LA    @01,@AL00001                                        0407 01047000
         BALR  @14,@15                                             0407 01048000
*                           RESPECIFY RTNREG RSTD;                 0408 01049000
*                           TESTRC = RTNREG;                       0409 01050000
         LR    TESTRC,RTNREG                                       0409 01051000
*                           RESPECIFY RTNREG UNRSTD;               0410 01052000
*                           SAVERC = TESTRC;                       0411 01053000
         LR    SAVERC,TESTRC                                       0411 01054000
*                         END;                                     0412 01055000
*                   END;                                           0413 01056000
*                                                                  0413 01057000
@RF00405 DS    0H                                                  0414 01058000
*               /*****************************************************/ 01059000
*               /*                                                   */ 01060000
*               /* IF PCRPTR IS NON-ZERO, A LOADMODULE NAME WAS      */ 01061000
*               /* GIVEN SO LOAD THE MODULE AND SET THE POINTER TO   */ 01062000
*               /* THE ENTRY POINT OF THE LOAD MODULE AS THE START   */ 01063000
*               /* OF THE TRANSLATE TABLE.                           */ 01064000
*               /*                                                   */ 01065000
*               /*****************************************************/ 01066000
*                                                                  0414 01067000
*               IF PCRPTR ^= NULLPTR                               0414 01068000
*                 THEN                                             0414 01069000
@RF00398 L     @04,PCRPTR(,PCRADDR)                                0414 01070000
         LTR   @04,@04                                             0414 01071000
         BZ    @RF00414                                            0414 01072000
*                   DO;                                            0415 01073000
*                                                                  0415 01074000
*                     CALL IDCSALD0 (GDTTBL,TTDSN,P04PCP);         0416 01075000
*                                                                  0416 01076000
         ST    GDTPTR,@AL00001                                     0416 01077000
         ST    @04,@AL00001+4                                      0416 01078000
         LA    @04,P04PCP                                          0416 01079000
         ST    @04,@AL00001+8                                      0416 01080000
         L     @15,GDTLOD(,GDTPTR)                                 0416 01081000
         LA    @01,@AL00001                                        0416 01082000
         BALR  @14,@15                                             0416 01083000
*                   END;                                           0417 01084000
*             END;                                                 0418 01085000
*                                                                  0418 01086000
@RF00414 DS    0H                                                  0419 01087000
*           /*********************************************************/ 01088000
*           /*                                                       */ 01089000
*           /* TEST FOR A NEW PAGE NUMBER ENTERED                    */ 01090000
*           /* CONVERT TO BINARY AND ENTER IN TABLE.                 */ 01091000
*           /*                                                       */ 01092000
*           /*********************************************************/ 01093000
*                                                                  0419 01094000
*           IF PCRTYP = 'PN' & PGNOLIN > 0 & PGNOLIN <= 4    /*YM5742*/ 01095000
*             THEN                                                 0419 01096000
@RF00396 CLC   PCRTYP(2,PCRADDR),@CC00833                          0419 01097000
         BNE   @RF00419                                            0419 01098000
         L     @04,PCRPTR(,PCRADDR)                                0419 01099000
         LH    @03,PGNOLIN(,@04)                                   0419 01100000
         LTR   @03,@03                                             0419 01101000
         BNP   @RF00419                                            0419 01102000
         LA    @15,4                                               0419 01103000
         CR    @03,@15                                             0419 01104000
         BH    @RF00419                                            0419 01105000
*               DO;                                                0420 01106000
*                 PAGE = ''B;                                      0421 01107000
         XC    PAGE(4),PAGE                                        0421 01108000
*                 PAGE((5-PGNOLIN):4) = PGNOCIN(1:PGNOLIN);        0422 01109000
         LCR   @03,@03                                             0422 01110000
         AL    @03,@CF00300                                        0422 01111000
         LA    @01,PAGE-1(@03)                                     0422 01112000
         SLR   @15,@03                                             0422 01113000
         EX    @15,@SM00866                                        0422 01114000
*GEN     (PACK  PACKWD,PAGE);                                      0423 01115000
         PACK  PACKWD,PAGE                                              01116000
*GEN     (CVB   CVDREG,PACKWD);                                    0424 01117000
         CVB   CVDREG,PACKWD                                            01118000
*                 P04CPN = CVDREG - 1;                             0425 01119000
         LR    @06,CVDREG                                          0425 01120000
         BCTR  @06,0                                               0425 01121000
         STH   @06,P04CPN                                          0425 01122000
*               END;                                               0426 01123000
*         END;                                                     0427 01124000
@RF00419 LA    @06,1                                               0427 01125000
         AH    @06,ARGNMB                                          0427 01126000
         STH   @06,ARGNMB                                          0427 01127000
@DE00358 LR    @04,LISTLN                                          0427 01128000
         BCTR  @04,0                                               0427 01129000
         BCTR  @04,0                                               0427 01130000
         CR    @06,@04                                             0427 01131000
         BNH   @DL00358                                            0427 01132000
*         /***********************************************************/ 01133000
*         /*                                                         */ 01134000
*         /*  CALL THE PROCEDURE TO SET THE PCT                      */ 01135000
*         /*                                                         */ 01136000
*         /***********************************************************/ 01137000
*                                                                  0428 01138000
*         CALL PCTSETUP;                                           0428 01139000
*                                                                  0428 01140000
         BAL   @14,PCTSETUP                                        0428 01141000
*         IF GDTDBG = NULLPTR                                      0429 01142000
*           THEN;                                                  0429 01143000
         L     @08,GDTDBG(,GDTPTR)                                 0429 01144000
         LTR   @08,@08                                             0429 01145000
         BZ    @RT00429                                            0429 01146000
*           ELSE                                                   0431 01147000
*             CALL IDCDB010 (GDTTBL,'TP4R');                       0431 01148000
*                                                                  0431 01149000
         ST    GDTPTR,@AL00001                                     0431 01150000
         LA    @08,@CC00834                                        0431 01151000
         ST    @08,@AL00001+4                                      0431 01152000
         MVI   @AL00001+4,X'80'                                    0431 01153000
         L     @15,GDTDBG(,GDTPTR)                                 0431 01154000
         LA    @01,@AL00001                                        0431 01155000
         BALR  @14,@15                                             0431 01156000
*         RETURN CODE(SAVERC);                                     0432 01157000
@RT00429 LR    @15,SAVERC                                          0432 01158000
         L     @14,@SA00005                                        0432 01159000
         LM    @00,@12,@SA00005+8                                  0432 01160000
         BR    @14                                                 0432 01161000
*         END RESTCONT;                                            0433 01162000
*         /***********************************************************/ 01163000
*         /*                                                         */ 01164000
*         /* PROCEDURE NAME - PCT SETTING PROCEDURE.                 */ 01165000
*         /*                                                         */ 01166000
*         /* FUNCTION - THIS PROCEDURE CHECKS AND SETS VALUES        */ 01167000
*         /* ENTERED AND SET INTO THE PRINT CONTROL WORK TABLE INTO  */ 01168000
*         /* THE PRINT CONTROL TABLE.                                */ 01169000
*         /*                                                         */ 01170000
*         /* INPUT - THE PRINT CONTROL WORK TABLE (P04WT).           */ 01171000
*         /*                                                         */ 01172000
*         /* OUTPUT - THE PRINT CONTROL TABLE.                       */ 01173000
*         /*                                                         */ 01174000
*         /***********************************************************/ 01175000
*                                                                  0434 01176000
*PCTSETUP: PROC;                                                   0434 01177000
*                                                                  0434 01178000
PCTSETUP STM   @14,@06,@SA00006                                    0434 01179000
         STM   @08,@12,@SA00006+36                                 0434 01180000
*         /***********************************************************/ 01181000
*         /*                                                         */ 01182000
*         /* TEST FOR PRIMARY CONTROL TABLE BUILD AND IF TRUE, BUILD */ 01183000
*         /* TABLE WITH ALL THE DEFAULTS.                            */ 01184000
*         /*                                                         */ 01185000
*         /***********************************************************/ 01186000
*                                                                  0435 01187000
*         PCTNLI = 999;                 /* FORCE A PAGE OVERFLOW.    */ 01188000
         LA    @08,999                                             0435 01189000
         STH   @08,PCTNLI(,PCTPTR)                                 0435 01190000
*         PCTANL = 999;                 /* FOR ALTERNATE FILE ALSO.  */ 01191000
         STH   @08,PCTANL(,PCTPTR)                                 0436 01192000
*         IF PRIPCT = ON                                           0437 01193000
*           THEN                                                   0437 01194000
         TM    PRIPCT,B'10000000'                                  0437 01195000
         BNO   @RF00437                                            0437 01196000
*             DO;                                                  0438 01197000
*               /*****************************************************/ 01198000
*               /*                                                   */ 01199000
*               /* GET THE STANDARD PRINT CHAIN TRANSLATE            */ 01200000
*               /* TABLE.                                            */ 01201000
*               /*                                                   */ 01202000
*               /*****************************************************/ 01203000
*                                                                  0439 01204000
*               STID(1:3) = 'TP0';                                 0439 01205000
         MVC   STID(3),@CC00832                                    0439 01206000
*               STID(4) = '02'X;                                   0440 01207000
*                                                                  0440 01208000
         MVI   STID+3,X'02'                                        0440 01209000
*               CALL IDCTP05(GDTTBL,STID,SUBPZ,PCTTRP);    /*@YL026UE*/ 01210000
*                                                                  0441 01211000
         ST    GDTPTR,@AL00001                                     0441 01212000
         LA    @08,STID                                            0441 01213000
         ST    @08,@AL00001+4                                      0441 01214000
         LA    @08,SUBPZ                                           0441 01215000
         ST    @08,@AL00001+8                                      0441 01216000
         LA    @08,PCTTRP(,PCTPTR)                                 0441 01217000
         ST    @08,@AL00001+12                                     0441 01218000
         L     @15,@CV00747                                        0441 01219000
         LA    @01,@AL00001                                        0441 01220000
         BALR  @14,@15                                             0441 01221000
*               RESPECIFY RTNREG RSTD;                             0442 01222000
*               TESTRC = RTNREG;                                   0443 01223000
         LR    TESTRC,RTNREG                                       0443 01224000
*               RESPECIFY RTNREG UNRSTD;                           0444 01225000
*               IF TESTRC ^= 0                                     0445 01226000
*                 THEN                                             0445 01227000
*                                                                  0445 01228000
         LTR   TESTRC,TESTRC                                       0445 01229000
         BZ    @RF00445                                            0445 01230000
*                   DO;                                            0446 01231000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0447 01232000
*                     REG15 = 28;                                  0448 01233000
         LA    REG15,28                                            0448 01234000
*                     REG14 = GDTABT;                              0449 01235000
         L     REG14,GDTABT(,GDTPTR)                               0449 01236000
*                     REG13 = GDTABH;                              0450 01237000
         L     REG13,GDTABH(,GDTPTR)                               0450 01238000
*                     GEN(BR    REG14);                            0451 01239000
         BR    REG14                                                    01240000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0452 01241000
*                   END;                                           0453 01242000
*                                                                  0453 01243000
*               /*****************************************************/ 01244000
*               /*                                                   */ 01245000
*               /* INITIALIZE FIRST DATA LINE AND LAST DATA LINE.    */ 01246000
*               /*                                                   */ 01247000
*               /*****************************************************/ 01248000
*                                                                  0454 01249000
*               PCTPNI = 1;                                        0454 01250000
@RF00445 MVC   PCTPNI(2,PCTPTR),@CH00233                           0454 01251000
*               PCTFDL = 4;                                        0455 01252000
         MVC   PCTFDL(2,PCTPTR),@CH00053                           0455 01253000
*               PCTLDL = 60;                                       0456 01254000
         MVC   PCTLDL(2,PCTPTR),@CH00840                           0456 01255000
*             END;                                                 0457 01256000
*         /***********************************************************/ 01257000
*         /*                                                         */ 01258000
*         /* BEGIN TO VERIFY AND SET THE PRINT CONTROL TABLE ENTRIES */ 01259000
*         /* ENTERED WITH THIS REQUEST.                              */ 01260000
*         /*                                                         */ 01261000
*         /***********************************************************/ 01262000
*                                                                  0458 01263000
*         /***********************************************************/ 01264000
*         /*                                                         */ 01265000
*         /* SET UP A TRANSLATE TABLE ENTERED WITH THIS REQUEST.     */ 01266000
*         /*                                                         */ 01267000
*         /***********************************************************/ 01268000
*                                                                  0458 01269000
*         IF P04PCP ^= 0                                           0458 01270000
*           THEN                                                   0458 01271000
@RF00437 L     @08,P04PCP                                          0458 01272000
         LTR   @08,@08                                             0458 01273000
         BZ    @RF00458                                            0458 01274000
*             PCTTRP = P04PCP;                                     0459 01275000
*                                                                  0459 01276000
         ST    @08,PCTTRP(,PCTPTR)                                 0459 01277000
*         /***********************************************************/ 01278000
*         /*                                                         */ 01279000
*         /*  VERIFY AND SET CHANGES TO LINE WIDTH                   */ 01280000
*         /*                                                         */ 01281000
*         /***********************************************************/ 01282000
*                                                                  0460 01283000
*         IF P04LW > 0 & P04LW < 133                               0460 01284000
*           THEN                                                   0460 01285000
@RF00458 LH    @08,P04LW                                           0460 01286000
         LTR   @08,@08                                             0460 01287000
         BNP   @RF00460                                            0460 01288000
         C     @08,@CF00841                                        0460 01289000
         BNL   @RF00460                                            0460 01290000
*             PCTPLW = P04LW;                                      0461 01291000
         ST    @08,PCTPLW(,PCTPTR)                                 0461 01292000
*           ELSE                                                   0462 01293000
*             DO;                                                  0462 01294000
         B     @RC00460                                            0462 01295000
@RF00460 DS    0H                                                  0463 01296000
*               IF P04LW ^= 0                                      0463 01297000
*                 THEN                                             0463 01298000
         LH    @08,P04LW                                           0463 01299000
         LTR   @08,@08                                             0463 01300000
         BZ    @RF00463                                            0463 01301000
*                   SAVERC = 4;                                    0464 01302000
         LA    SAVERC,4                                            0464 01303000
*             END;                                                 0465 01304000
*                                                                  0465 01305000
@RF00463 DS    0H                                                  0466 01306000
*         /***********************************************************/ 01307000
*         /*                                                         */ 01308000
*         /* VERIFY AND SET CHANGES TO THE PAGE DEPTH.               */ 01309000
*         /*                                                         */ 01310000
*         /***********************************************************/ 01311000
*                                                                  0466 01312000
*         IF P04PD > 0                                             0466 01313000
*           THEN                                                   0466 01314000
@RC00460 LH    @08,P04PD                                           0466 01315000
         LTR   @08,@08                                             0466 01316000
         BNP   @RF00466                                            0466 01317000
*             DO;                                                  0467 01318000
*               PCTPPD = P04PD;                                    0468 01319000
         STH   @08,PCTPPD(,PCTPTR)                                 0468 01320000
*               PCTLDL = PCTPPD - OFLOSS;                          0469 01321000
         SH    @08,OFLOSS                                          0469 01322000
         STH   @08,PCTLDL(,PCTPTR)                                 0469 01323000
*             END;                                                 0470 01324000
*                                                                  0470 01325000
*         /***********************************************************/ 01326000
*         /*                                                         */ 01327000
*         /* VERIFY AND SET CHANGES TO DEFAULT SPACE CHARACTER.      */ 01328000
*         /*                                                         */ 01329000
*         /***********************************************************/ 01330000
*                                                                  0471 01331000
*         IF P04DSC > 0                                            0471 01332000
*           THEN                                                   0471 01333000
@RF00466 LH    @08,P04DSC                                          0471 01334000
         LTR   @08,@08                                             0471 01335000
         BNP   @RF00471                                            0471 01336000
*             DO;                                                  0472 01337000
*               IF P04DSC < 4                                      0473 01338000
*                 THEN                                             0473 01339000
         C     @08,@CF00053                                        0473 01340000
         BNL   @RF00473                                            0473 01341000
*                   PCTDSC = P04DSC;                               0474 01342000
         STH   @08,PCTDSC(,PCTPTR)                                 0474 01343000
*                 ELSE                                             0475 01344000
*                   SAVERC = 4;                                    0475 01345000
         B     @RC00473                                            0475 01346000
@RF00473 LA    SAVERC,4                                            0475 01347000
*             END;                                                 0476 01348000
*                                                                  0476 01349000
@RC00473 DS    0H                                                  0477 01350000
*         /***********************************************************/ 01351000
*         /*                                                         */ 01352000
*         /* VERIFY AND SET CHANGES TO CURRENT PAGE NUMBER           */ 01353000
*         /*                                                         */ 01354000
*         /***********************************************************/ 01355000
*                                                                  0477 01356000
*         IF P04CPN > 0                                            0477 01357000
*           THEN                                                   0477 01358000
@RF00471 LH    @08,P04CPN                                          0477 01359000
         LTR   @08,@08                                             0477 01360000
         BNP   @RF00477                                            0477 01361000
*             PCTCPN = P04CPN;                                     0478 01362000
*                                                                  0478 01363000
         STH   @08,PCTCPN(,PCTPTR)                                 0478 01364000
*         /***********************************************************/ 01365000
*         /*                                                         */ 01366000
*         /* VERIFY AND SET CHANGES TO PAGE NUMBER INCREMENT.        */ 01367000
*         /*                                                         */ 01368000
*         /***********************************************************/ 01369000
*                                                                  0479 01370000
*         IF P04PNI > 0                                            0479 01371000
*           THEN                                                   0479 01372000
@RF00477 LH    @08,P04PNI                                          0479 01373000
         LTR   @08,@08                                             0479 01374000
         BNP   @RF00479                                            0479 01375000
*             DO;                                                  0480 01376000
*               IF P04PNI > 9999                                   0481 01377000
*                 THEN                                             0481 01378000
         C     @08,@CF00842                                        0481 01379000
         BNH   @RF00481                                            0481 01380000
*                   SAVERC = 4;                                    0482 01381000
         LA    SAVERC,4                                            0482 01382000
*                 ELSE                                             0483 01383000
*                   PCTPNI = P04PNI;                               0483 01384000
         B     @RC00481                                            0483 01385000
@RF00481 LH    @08,P04PNI                                          0483 01386000
         STH   @08,PCTPNI(,PCTPTR)                                 0483 01387000
*             END;                                                 0484 01388000
*                                                                  0484 01389000
@RC00481 DS    0H                                                  0485 01390000
*         /***********************************************************/ 01391000
*         /*                                                         */ 01392000
*         /*  VERIFY AND SET CHANGES TO THE MAIN TITLE LINE          */ 01393000
*         /*                                                         */ 01394000
*         /***********************************************************/ 01395000
*                                                                  0485 01396000
*         IF P04MTP > 0                                            0485 01397000
*           THEN                                                   0485 01398000
@RF00479 L     @08,P04MTP                                          0485 01399000
         LTR   @08,@08                                             0485 01400000
         BNP   @RF00485                                            0485 01401000
*             DO;                                                  0486 01402000
*               /*****************************************************/ 01403000
*               /*                                                   */ 01404000
*               /* GET CORE FOR THE MAIN TITLE LINE.                 */ 01405000
*               /* GET POOL ZERO FOR PRIMARY CONTROL TABLE.          */ 01406000
*               /* GET POOL TP01 FOR SECONDARY CONTROL TABLE.        */ 01407000
*               /*                                                   */ 01408000
*               /*****************************************************/ 01409000
*                                                                  0487 01410000
*               IF PRIPCT = ON                                     0487 01411000
*                 THEN                                             0487 01412000
         TM    PRIPCT,B'10000000'                                  0487 01413000
         BNO   @RF00487                                            0487 01414000
*                   DO;                                            0488 01415000
*                                                                  0488 01416000
*                     CALL IDCSAGS0 (GDTTBL,STDLW,PCTMLP);         0489 01417000
*                                                                  0489 01418000
         ST    GDTPTR,@AL00001                                     0489 01419000
         LA    @08,STDLW                                           0489 01420000
         ST    @08,@AL00001+4                                      0489 01421000
         LA    @08,PCTMLP(,PCTPTR)                                 0489 01422000
         ST    @08,@AL00001+8                                      0489 01423000
         MVI   @AL00001+8,X'80'                                    0489 01424000
         L     @15,GDTGSP(,GDTPTR)                                 0489 01425000
         LA    @01,@AL00001                                        0489 01426000
         BALR  @14,@15                                             0489 01427000
*                     RESPECIFY RTNREG RSTD;                       0490 01428000
*                     TESTRC = RTNREG;                             0491 01429000
         LR    TESTRC,RTNREG                                       0491 01430000
*                     RESPECIFY RTNREG UNRSTD;                     0492 01431000
*                     IF TESTRC ^= 0                               0493 01432000
*                       THEN                                       0493 01433000
*                                                                  0493 01434000
         LTR   TESTRC,TESTRC                                       0493 01435000
         BZ    @RF00493                                            0493 01436000
*                         DO;                                      0494 01437000
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0495 01438000
*                           REG15 = 28;                            0496 01439000
         LA    REG15,28                                            0496 01440000
*                           REG14 = GDTABT;                        0497 01441000
         L     REG14,GDTABT(,GDTPTR)                               0497 01442000
*                           REG13 = GDTABH;                        0498 01443000
         L     REG13,GDTABH(,GDTPTR)                               0498 01444000
*                           GEN(BR    REG14);                      0499 01445000
         BR    REG14                                                    01446000
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0500 01447000
*                         END;                                     0501 01448000
*                   END;                                           0502 01449000
*                                                                  0502 01450000
*                 ELSE                                             0503 01451000
*                   DO;                                            0503 01452000
*                                                                  0503 01453000
         B     @RC00487                                            0503 01454000
@RF00487 DS    0H                                                  0504 01455000
*                     CALL IDCSAGP0 (GDTTBL,STDLW,PCTMLP,TPPOOL);  0504 01456000
*                                                                  0504 01457000
         ST    GDTPTR,@AL00001                                     0504 01458000
         LA    @08,STDLW                                           0504 01459000
         ST    @08,@AL00001+4                                      0504 01460000
         LA    @08,PCTMLP(,PCTPTR)                                 0504 01461000
         ST    @08,@AL00001+8                                      0504 01462000
         LA    @08,TPPOOL                                          0504 01463000
         ST    @08,@AL00001+12                                     0504 01464000
         MVI   @AL00001+12,X'80'                                   0504 01465000
         L     @15,GDTGPL(,GDTPTR)                                 0504 01466000
         LA    @01,@AL00001                                        0504 01467000
         BALR  @14,@15                                             0504 01468000
*                     RESPECIFY RTNREG RSTD;                       0505 01469000
*                     TESTRC = RTNREG;                             0506 01470000
         LR    TESTRC,RTNREG                                       0506 01471000
*                     RESPECIFY RTNREG UNRSTD;                     0507 01472000
*                     IF TESTRC ^= 0                               0508 01473000
*                       THEN                                       0508 01474000
*                                                                  0508 01475000
         LTR   TESTRC,TESTRC                                       0508 01476000
         BZ    @RF00508                                            0508 01477000
*                         DO;                                      0509 01478000
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0510 01479000
*                           REG15 = 28;                            0511 01480000
         LA    REG15,28                                            0511 01481000
*                           REG14 = GDTABT;                        0512 01482000
         L     REG14,GDTABT(,GDTPTR)                               0512 01483000
*                           REG13 = GDTABH;                        0513 01484000
         L     REG13,GDTABH(,GDTPTR)                               0513 01485000
*                           GEN(BR    REG14);                      0514 01486000
         BR    REG14                                                    01487000
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0515 01488000
*                         END;                                     0516 01489000
*                   END;                                           0517 01490000
*                                                                  0517 01491000
@RF00508 DS    0H                                                  0518 01492000
*               /*****************************************************/ 01493000
*               /*                                                   */ 01494000
*               /* MOVE THE MAIN TITLE LINE TO THE AREA              */ 01495000
*               /* OBTAINED.                                         */ 01496000
*               /*                                                   */ 01497000
*               /*****************************************************/ 01498000
*                                                                  0518 01499000
*               MTLBUFF(1:120) = MTLINBF(1:120);                   0518 01500000
@RC00487 L     @08,PCTMLP(,PCTPTR)                                 0518 01501000
         L     @06,P04MTP                                          0518 01502000
         MVC   MTLBUFF(120,@08),MTLINBF(@06)                       0518 01503000
*               MTLCC = EJECT;                                     0519 01504000
*                                                                  0519 01505000
         MVI   MTLCC(@08),C'1'                                     0519 01506000
*               /*****************************************************/ 01507000
*               /*                                                   */ 01508000
*               /* VERIFY AND SET PAGE NUMBER LOCATION CHANGES.      */ 01509000
*               /*                                                   */ 01510000
*               /*****************************************************/ 01511000
*                                                                  0520 01512000
*               IF P04PNL > 0                                      0520 01513000
*                 THEN                                             0520 01514000
         LH    @08,P04PNL                                          0520 01515000
         LTR   @08,@08                                             0520 01516000
         BNP   @RF00520                                            0520 01517000
*                   DO;                                            0521 01518000
*                     IF P04PNL < PCTPLW -4                        0522 01519000
*                       THEN                                       0522 01520000
         L     @06,PCTPLW(,PCTPTR)                                 0522 01521000
         SL    @06,@CF00053                                        0522 01522000
         CR    @08,@06                                             0522 01523000
         BNL   @RF00522                                            0522 01524000
*                         PCTPNL = P04PNL;                         0523 01525000
         STH   @08,PCTPNL(,PCTPTR)                                 0523 01526000
*                       ELSE                                       0524 01527000
*                         SAVERC = 4;                              0524 01528000
         B     @RC00522                                            0524 01529000
@RF00522 LA    SAVERC,4                                            0524 01530000
*                   END;                                           0525 01531000
*                                                                  0525 01532000
@RC00522 DS    0H                                                  0526 01533000
*               /*****************************************************/ 01534000
*               /*                                                   */ 01535000
*               /* VERIFY AND SET TIME LOCATION CHANGES.             */ 01536000
*               /*                                                   */ 01537000
*               /*****************************************************/ 01538000
*                                                                  0526 01539000
*               IF P04TL > 0                                       0526 01540000
*                 THEN                                             0526 01541000
@RF00520 LH    @08,P04TL                                           0526 01542000
         LTR   @08,@08                                             0526 01543000
         BNP   @RF00526                                            0526 01544000
*                   DO;                                            0527 01545000
*                     IF P04TL < PCTPLW - 6                        0528 01546000
*                       THEN;                                      0528 01547000
         L     @06,PCTPLW(,PCTPTR)                                 0528 01548000
         SL    @06,@CF00170                                        0528 01549000
         CR    @08,@06                                             0528 01550000
         BL    @RT00528                                            0528 01551000
*                       ELSE                                       0530 01552000
*                         SAVERC = 4;                              0530 01553000
         LA    SAVERC,4                                            0530 01554000
*                   END;                                           0531 01555000
*                                                                  0531 01556000
@RT00528 DS    0H                                                  0532 01557000
*               /*****************************************************/ 01558000
*               /*                                                   */ 01559000
*               /* VERIFY AND SET DATE LOCATION CHANGES.             */ 01560000
*               /*                                                   */ 01561000
*               /*****************************************************/ 01562000
*                                                                  0532 01563000
*               IF P04DL > 0                                       0532 01564000
*                 THEN                                             0532 01565000
@RF00526 LH    @08,P04DL                                           0532 01566000
         LTR   @08,@08                                             0532 01567000
         BNP   @RF00532                                            0532 01568000
*                   DO;                                            0533 01569000
*                     IF P04DL < PCTPLW - 6                        0534 01570000
*                       THEN;                                      0534 01571000
         L     @06,PCTPLW(,PCTPTR)                                 0534 01572000
         SL    @06,@CF00170                                        0534 01573000
         CR    @08,@06                                             0534 01574000
         BL    @RT00534                                            0534 01575000
*                       ELSE                                       0536 01576000
*                         SAVERC = 4;                              0536 01577000
         LA    SAVERC,4                                            0536 01578000
*                   END;                                           0537 01579000
*                                                                  0537 01580000
@RT00534 DS    0H                                                  0538 01581000
*               /*****************************************************/ 01582000
*               /*                                                   */ 01583000
*               /* INITIALIZE THE TIME AND DATE LOCATIONS IN THE     */ 01584000
*               /* MAIN TITLE LINE.                                  */ 01585000
*               /*                                                   */ 01586000
*               /*****************************************************/ 01587000
*                                                                  0538 01588000
*               CALL IDCSATI0 (GDTTBL,MTLBUFF(P04TL:P04TL+7),      0538 01589000
*                     MTLBUFF(P04DL:P04DL+7),FORMAT);              0538 01590000
@RF00532 ST    GDTPTR,@AL00001                                     0538 01591000
         LH    @08,P04TL                                           0538 01592000
         L     @06,PCTMLP(,PCTPTR)                                 0538 01593000
         LA    @08,MTLBUFF-1(@08,@06)                              0538 01594000
         ST    @08,@AL00001+4                                      0538 01595000
         LH    @08,P04DL                                           0538 01596000
         LA    @08,MTLBUFF-1(@08,@06)                              0538 01597000
         ST    @08,@AL00001+8                                      0538 01598000
         LA    @08,FORMAT                                          0538 01599000
         ST    @08,@AL00001+12                                     0538 01600000
         MVI   @AL00001+12,X'80'                                   0538 01601000
         L     @15,GDTTIM(,GDTPTR)                                 0538 01602000
         LA    @01,@AL00001                                        0538 01603000
         BALR  @14,@15                                             0538 01604000
*             END;                                                 0539 01605000
*         /***********************************************************/ 01606000
*         /*                                                         */ 01607000
*         /* VERIFY AND SET SUB-TITLE LINE CHANGES.                  */ 01608000
*         /*                                                         */ 01609000
*         /***********************************************************/ 01610000
*                                                                  0540 01611000
*         IF P04STP > 0                                            0540 01612000
*           THEN                                                   0540 01613000
@RF00485 L     @08,P04STP                                          0540 01614000
         LTR   @08,@08                                             0540 01615000
         BNP   @RF00540                                            0540 01616000
*             DO;                                                  0541 01617000
*             /*******************************************************/ 01618000
*             /*                                                     */ 01619000
*             /* CHECK NUMBER OF LINES ENTERED.                      */ 01620000
*             /*                                                     */ 01621000
*             /*******************************************************/ 01622000
*                                                                  0542 01623000
*               IF P04STC < 1 | P04STC > 3                         0542 01624000
*                 THEN                                             0542 01625000
         LH    @08,P04STC                                          0542 01626000
         LTR   @08,@08                                             0542 01627000
         BNP   @RT00542                                            0542 01628000
         C     @08,@CF00176                                        0542 01629000
         BNH   @RF00542                                            0542 01630000
@RT00542 DS    0H                                                  0543 01631000
*                   SAVERC = 4;                                    0543 01632000
         LA    SAVERC,4                                            0543 01633000
*                 ELSE                                             0544 01634000
*                   DO;                                            0544 01635000
*                                                                  0544 01636000
         B     @RC00542                                            0544 01637000
@RF00542 DS    0H                                                  0545 01638000
*                   /*************************************************/ 01639000
*                   /*                                               */ 01640000
*                   /* GET CORE FOR THE NUMBER OF LINES REQUIRED.    */ 01641000
*                   /*                                               */ 01642000
*                   /*************************************************/ 01643000
*                                                                  0545 01644000
*                     SPCCNT = P04STC * STDLW;                     0545 01645000
*                                                                  0545 01646000
         L     @08,STDLW                                           0545 01647000
         MH    @08,P04STC                                          0545 01648000
         ST    @08,SPCCNT                                          0545 01649000
*                     CALL IDCSAGP0 (GDTTBL,SPCCNT,PCTSLP,TPPOOL); 0546 01650000
*                                                                  0546 01651000
         ST    GDTPTR,@AL00001                                     0546 01652000
         LA    @08,SPCCNT                                          0546 01653000
         ST    @08,@AL00001+4                                      0546 01654000
         LA    @08,PCTSLP(,PCTPTR)                                 0546 01655000
         ST    @08,@AL00001+8                                      0546 01656000
         LA    @08,TPPOOL                                          0546 01657000
         ST    @08,@AL00001+12                                     0546 01658000
         MVI   @AL00001+12,X'80'                                   0546 01659000
         L     @15,GDTGPL(,GDTPTR)                                 0546 01660000
         LA    @01,@AL00001                                        0546 01661000
         BALR  @14,@15                                             0546 01662000
*                     RESPECIFY RTNREG RSTD;                       0547 01663000
*                     TESTRC = RTNREG;                             0548 01664000
         LR    TESTRC,RTNREG                                       0548 01665000
*                     RESPECIFY RTNREG UNRSTD;                     0549 01666000
*                     IF TESTRC ^= 0                               0550 01667000
*                       THEN                                       0550 01668000
*                                                                  0550 01669000
         LTR   TESTRC,TESTRC                                       0550 01670000
         BZ    @RF00550                                            0550 01671000
*                         DO;                                      0551 01672000
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0552 01673000
*                           REG15 = 28;                            0553 01674000
         LA    REG15,28                                            0553 01675000
*                           REG14 = GDTABT;                        0554 01676000
         L     REG14,GDTABT(,GDTPTR)                               0554 01677000
*                           REG13 = GDTABH;                        0555 01678000
         L     REG13,GDTABH(,GDTPTR)                               0555 01679000
*                           GEN(BR    REG14);                      0556 01680000
         BR    REG14                                                    01681000
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0557 01682000
*                         END;                                     0558 01683000
*                                                                  0558 01684000
*                     SPCCNT = 0;                                  0559 01685000
*                                                                  0559 01686000
@RF00550 SLR   @08,@08                                             0559 01687000
         ST    @08,SPCCNT                                          0559 01688000
*                     /***********************************************/ 01689000
*                     /*                                             */ 01690000
*                     /* COMPUTE THE LINE SPACES REQUIRED FOR THE    */ 01691000
*                     /* SUB-TITLE LINES ENTERED.                    */ 01692000
*                     /*                                             */ 01693000
*                     /***********************************************/ 01694000
*                                                                  0560 01695000
*                     DO N = 1 TO P04STC BY 1;                     0560 01696000
         LA    N,1                                                 0560 01697000
         B     @DE00560                                            0560 01698000
@DL00560 DS    0H                                                  0561 01699000
*                       STLINE(N) = P04STP -> STLINE(1);           0561 01700000
         LR    @08,N                                               0561 01701000
         MH    @08,@CH00723                                        0561 01702000
         L     @06,PCTSLP(,PCTPTR)                                 0561 01703000
         ST    @08,@TF00001                                        0561 01704000
         ALR   @08,@06                                             0561 01705000
         AL    @08,@CF00868                                        0561 01706000
         L     @04,P04STP                                          0561 01707000
         MVC   STLINE(121,@08),STLINE(@04)                         0561 01708000
*                       IF STLCC(N) = SINGLE                       0562 01709000
*                         THEN                                     0562 01710000
         AL    @06,@TF00001                                        0562 01711000
         AL    @06,@CF00868                                        0562 01712000
         CLI   STLCC(@06),C' '                                     0562 01713000
         BNE   @RF00562                                            0562 01714000
*                           SPCCNT = SPCCNT + 1;                   0563 01715000
         LA    @08,1                                               0563 01716000
         AL    @08,SPCCNT                                          0563 01717000
         ST    @08,SPCCNT                                          0563 01718000
*                       IF STLCC(N) = DOUBLE                       0564 01719000
*                         THEN                                     0564 01720000
@RF00562 LR    @08,N                                               0564 01721000
         MH    @08,@CH00723                                        0564 01722000
         L     @06,PCTSLP(,PCTPTR)                                 0564 01723000
         ALR   @06,@08                                             0564 01724000
         AL    @06,@CF00868                                        0564 01725000
         CLI   STLCC(@06),C'0'                                     0564 01726000
         BNE   @RF00564                                            0564 01727000
*                           SPCCNT = SPCCNT + 2;                   0565 01728000
         LA    @08,2                                               0565 01729000
         AL    @08,SPCCNT                                          0565 01730000
         ST    @08,SPCCNT                                          0565 01731000
*                       IF STLCC(N) = TRIPLE                       0566 01732000
*                         THEN                                     0566 01733000
@RF00564 LR    @08,N                                               0566 01734000
         MH    @08,@CH00723                                        0566 01735000
         L     @06,PCTSLP(,PCTPTR)                                 0566 01736000
         ALR   @06,@08                                             0566 01737000
         AL    @06,@CF00868                                        0566 01738000
         CLI   STLCC(@06),C'-'                                     0566 01739000
         BNE   @RF00566                                            0566 01740000
*                           SPCCNT = SPCCNT + 3;                   0567 01741000
*                                                                  0567 01742000
         LA    @08,3                                               0567 01743000
         AL    @08,SPCCNT                                          0567 01744000
         ST    @08,SPCCNT                                          0567 01745000
*                       /*********************************************/ 01746000
*                       /*                                           */ 01747000
*                       /* CHECK TO ASSURE THAT THE SPACING CHAR IS  */ 01748000
*                       /* VALID AND IF NOT, SET DOUBLE SPACE.       */ 01749000
*                       /*                                           */ 01750000
*                       /*********************************************/ 01751000
*                                                                  0568 01752000
*                       IF STLCC(N) ^= SINGLE                      0568 01753000
*                         & STLCC(N) ^= DOUBLE                     0568 01754000
*                         & STLCC(N) ^= TRIPLE                     0568 01755000
*                         THEN                                     0568 01756000
@RF00566 LR    @08,N                                               0568 01757000
         MH    @08,@CH00723                                        0568 01758000
         L     @06,PCTSLP(,PCTPTR)                                 0568 01759000
         ST    @08,@TF00001                                        0568 01760000
         ALR   @08,@06                                             0568 01761000
         AL    @08,@CF00868                                        0568 01762000
         CLI   STLCC(@08),C' '                                     0568 01763000
         BE    @RF00568                                            0568 01764000
         LR    @08,@06                                             0568 01765000
         AL    @08,@TF00001                                        0568 01766000
         AL    @08,@CF00868                                        0568 01767000
         CLI   STLCC(@08),C'0'                                     0568 01768000
         BE    @RF00568                                            0568 01769000
         LR    @08,@06                                             0568 01770000
         AL    @08,@TF00001                                        0568 01771000
         AL    @08,@CF00868                                        0568 01772000
         CLI   STLCC(@08),C'-'                                     0568 01773000
         BE    @RF00568                                            0568 01774000
*                           DO;                                    0569 01775000
*                             STLCC(N) = DOUBLE;                   0570 01776000
         AL    @06,@TF00001                                        0570 01777000
         AL    @06,@CF00868                                        0570 01778000
         MVI   STLCC(@06),C'0'                                     0570 01779000
*                             SPCCNT = SPCCNT + 2;                 0571 01780000
         LA    @08,2                                               0571 01781000
         AL    @08,SPCCNT                                          0571 01782000
         ST    @08,SPCCNT                                          0571 01783000
*                           END;                                   0572 01784000
*                       P04STP = P04STP + STDLW;                   0573 01785000
@RF00568 L     @08,P04STP                                          0573 01786000
         AL    @08,STDLW                                           0573 01787000
         ST    @08,P04STP                                          0573 01788000
*                     END;                                         0574 01789000
         AL    N,@CF00233                                          0574 01790000
@DE00560 CH    N,P04STC                                            0574 01791000
         BNH   @DL00560                                            0574 01792000
*                     PCTSLC = P04STC;                             0575 01793000
*                                                                  0575 01794000
         LH    @08,P04STC                                          0575 01795000
         STH   @08,PCTSLC(,PCTPTR)                                 0575 01796000
*                     /***********************************************/ 01797000
*                     /*                                             */ 01798000
*                     /* MOVE THE FIRST DATA LINE DOWN BY THE SPACE  */ 01799000
*                     /* TAKEN BY THE SUB-TITLE LINES.               */ 01800000
*                     /*                                             */ 01801000
*                     /***********************************************/ 01802000
*                                                                  0576 01803000
*                     PCTFDL = PCTFDL + SPCCNT + 2;                0576 01804000
         LH    @08,PCTFDL(,PCTPTR)                                 0576 01805000
         AL    @08,SPCCNT                                          0576 01806000
         AL    @08,@CF00167                                        0576 01807000
         STH   @08,PCTFDL(,PCTPTR)                                 0576 01808000
*                   END;                                           0577 01809000
*             END;                                                 0578 01810000
*                                                                  0578 01811000
@RC00542 DS    0H                                                  0579 01812000
*         /***********************************************************/ 01813000
*         /*                                                         */ 01814000
*         /* VERIFY AND SET FOOTING LINE CHANGES.                    */ 01815000
*         /*                                                         */ 01816000
*         /***********************************************************/ 01817000
*                                                                  0579 01818000
*         IF P04FP > 0                                             0579 01819000
*           THEN                                                   0579 01820000
@RF00540 L     @08,P04FP                                           0579 01821000
         LTR   @08,@08                                             0579 01822000
         BNP   @RF00579                                            0579 01823000
*             DO;                                                  0580 01824000
*                                                                  0580 01825000
*             /*******************************************************/ 01826000
*             /*                                                     */ 01827000
*             /* ASSURE THE FOOTING LINE COUNT IS VALID.             */ 01828000
*             /*                                                     */ 01829000
*             /*******************************************************/ 01830000
*                                                                  0581 01831000
*               IF P04FC < 1 | P04FC > 3                           0581 01832000
*                 THEN                                             0581 01833000
         LH    @08,P04FC                                           0581 01834000
         LTR   @08,@08                                             0581 01835000
         BNP   @RT00581                                            0581 01836000
         C     @08,@CF00176                                        0581 01837000
         BNH   @RF00581                                            0581 01838000
@RT00581 DS    0H                                                  0582 01839000
*                   SAVERC = 4;                                    0582 01840000
         LA    SAVERC,4                                            0582 01841000
*                 ELSE                                             0583 01842000
*                   DO;                                            0583 01843000
*                                                                  0583 01844000
         B     @RC00581                                            0583 01845000
@RF00581 DS    0H                                                  0584 01846000
*                   /*************************************************/ 01847000
*                   /*                                               */ 01848000
*                   /* GET CORE FOR THE FOOTING LINES ENTERED.       */ 01849000
*                   /*                                               */ 01850000
*                   /*************************************************/ 01851000
*                                                                  0584 01852000
*                     SPCCNT = P04FC * STDLW;                      0584 01853000
         LH    @08,P04FC                                           0584 01854000
         LR    @01,@08                                             0584 01855000
         M     @00,STDLW                                           0584 01856000
         ST    @01,SPCCNT                                          0584 01857000
*                     PCTFLC = P04FC;                              0585 01858000
*                                                                  0585 01859000
         STH   @08,PCTFLC(,PCTPTR)                                 0585 01860000
*                     CALL IDCSAGP0 (GDTTBL,SPCCNT,PCTFLP,TPPOOL); 0586 01861000
*                                                                  0586 01862000
         ST    GDTPTR,@AL00001                                     0586 01863000
         LA    @08,SPCCNT                                          0586 01864000
         ST    @08,@AL00001+4                                      0586 01865000
         LA    @08,PCTFLP(,PCTPTR)                                 0586 01866000
         ST    @08,@AL00001+8                                      0586 01867000
         LA    @08,TPPOOL                                          0586 01868000
         ST    @08,@AL00001+12                                     0586 01869000
         MVI   @AL00001+12,X'80'                                   0586 01870000
         L     @15,GDTGPL(,GDTPTR)                                 0586 01871000
         LA    @01,@AL00001                                        0586 01872000
         BALR  @14,@15                                             0586 01873000
*                     RESPECIFY RTNREG RSTD;                       0587 01874000
*                     TESTRC = RTNREG;                             0588 01875000
         LR    TESTRC,RTNREG                                       0588 01876000
*                     RESPECIFY RTNREG UNRSTD;                     0589 01877000
*                     IF TESTRC ^= 0                               0590 01878000
*                       THEN                                       0590 01879000
*                                                                  0590 01880000
         LTR   TESTRC,TESTRC                                       0590 01881000
         BZ    @RF00590                                            0590 01882000
*                         DO;                                      0591 01883000
*                           RESPECIFY(REG13,REG14,REG15) RSTD;     0592 01884000
*                           REG15 = 28;                            0593 01885000
         LA    REG15,28                                            0593 01886000
*                           REG14 = GDTABT;                        0594 01887000
         L     REG14,GDTABT(,GDTPTR)                               0594 01888000
*                           REG13 = GDTABH;                        0595 01889000
         L     REG13,GDTABH(,GDTPTR)                               0595 01890000
*                           GEN(BR    REG14);                      0596 01891000
         BR    REG14                                                    01892000
*                           RESPECIFY(REG13,REG14,REG15)UNRSTD;    0597 01893000
*                         END;                                     0598 01894000
*                                                                  0598 01895000
*                     SPCCNT = 0;                                  0599 01896000
*                                                                  0599 01897000
@RF00590 SLR   @08,@08                                             0599 01898000
         ST    @08,SPCCNT                                          0599 01899000
*                     /***********************************************/ 01900000
*                     /*                                             */ 01901000
*                     /* COMPUTE THE SPACE REQUIRED BY THE FOOTING   */ 01902000
*                     /* LINES.                                      */ 01903000
*                     /*                                             */ 01904000
*                     /***********************************************/ 01905000
*                                                                  0600 01906000
*                     DO N = 1 TO P04FC BY 1;                      0600 01907000
         LA    N,1                                                 0600 01908000
         B     @DE00600                                            0600 01909000
@DL00600 DS    0H                                                  0601 01910000
*                       FTLINE(N) = P04FP -> FTLINE(1);            0601 01911000
         LR    @08,N                                               0601 01912000
         MH    @08,@CH00723                                        0601 01913000
         L     @06,PCTFLP(,PCTPTR)                                 0601 01914000
         ST    @08,@TF00001                                        0601 01915000
         ALR   @08,@06                                             0601 01916000
         AL    @08,@CF00868                                        0601 01917000
         L     @04,P04FP                                           0601 01918000
         MVC   FTLINE(121,@08),FTLINE(@04)                         0601 01919000
*                       IF FTLCC(N) = SINGLE                       0602 01920000
*                         THEN                                     0602 01921000
         AL    @06,@TF00001                                        0602 01922000
         AL    @06,@CF00868                                        0602 01923000
         CLI   FTLCC(@06),C' '                                     0602 01924000
         BNE   @RF00602                                            0602 01925000
*                           SPCCNT = SPCCNT + 1;                   0603 01926000
         LA    @08,1                                               0603 01927000
         AL    @08,SPCCNT                                          0603 01928000
         ST    @08,SPCCNT                                          0603 01929000
*                       IF FTLCC(N) = DOUBLE                       0604 01930000
*                         THEN                                     0604 01931000
@RF00602 LR    @08,N                                               0604 01932000
         MH    @08,@CH00723                                        0604 01933000
         L     @06,PCTFLP(,PCTPTR)                                 0604 01934000
         ALR   @06,@08                                             0604 01935000
         AL    @06,@CF00868                                        0604 01936000
         CLI   FTLCC(@06),C'0'                                     0604 01937000
         BNE   @RF00604                                            0604 01938000
*                           SPCCNT = SPCCNT + 2;                   0605 01939000
         LA    @08,2                                               0605 01940000
         AL    @08,SPCCNT                                          0605 01941000
         ST    @08,SPCCNT                                          0605 01942000
*                       IF FTLCC(N) = TRIPLE                       0606 01943000
*                         THEN                                     0606 01944000
@RF00604 LR    @08,N                                               0606 01945000
         MH    @08,@CH00723                                        0606 01946000
         L     @06,PCTFLP(,PCTPTR)                                 0606 01947000
         ALR   @06,@08                                             0606 01948000
         AL    @06,@CF00868                                        0606 01949000
         CLI   FTLCC(@06),C'-'                                     0606 01950000
         BNE   @RF00606                                            0606 01951000
*                           SPCCNT = SPCCNT + 3;                   0607 01952000
*                                                                  0607 01953000
         LA    @08,3                                               0607 01954000
         AL    @08,SPCCNT                                          0607 01955000
         ST    @08,SPCCNT                                          0607 01956000
*                       /*********************************************/ 01957000
*                       /*                                           */ 01958000
*                       /* CHECK THE CARRIAGE CONTROL CHAR FOR       */ 01959000
*                       /* VALIDITY (1, 2 OR 3) AND IF INVALID SET   */ 01960000
*                       /* TO 1.                                     */ 01961000
*                       /*                                           */ 01962000
*                       /*********************************************/ 01963000
*                                                                  0608 01964000
*                       IF FTLCC(N) ^= SINGLE                      0608 01965000
*                         | FTLCC(N) ^= DOUBLE                     0608 01966000
*                         | FTLCC(N) ^= TRIPLE                     0608 01967000
*                           THEN                                   0608 01968000
@RF00606 LR    @08,N                                               0608 01969000
         MH    @08,@CH00723                                        0608 01970000
         L     @06,PCTFLP(,PCTPTR)                                 0608 01971000
         ST    @08,@TF00001                                        0608 01972000
         ALR   @08,@06                                             0608 01973000
         AL    @08,@CF00868                                        0608 01974000
         CLI   FTLCC(@08),C' '                                     0608 01975000
         BNE   @RT00608                                            0608 01976000
         LR    @08,@06                                             0608 01977000
         AL    @08,@TF00001                                        0608 01978000
         AL    @08,@CF00868                                        0608 01979000
         CLI   FTLCC(@08),C'0'                                     0608 01980000
         BNE   @RT00608                                            0608 01981000
         AL    @06,@TF00001                                        0608 01982000
         AL    @06,@CF00868                                        0608 01983000
         CLI   FTLCC(@06),C'-'                                     0608 01984000
         BE    @RF00608                                            0608 01985000
@RT00608 DS    0H                                                  0609 01986000
*                             DO;                                  0609 01987000
*                               FTLCC(N) = SINGLE;                 0610 01988000
         LR    @08,N                                               0610 01989000
         MH    @08,@CH00723                                        0610 01990000
         L     @06,PCTFLP(,PCTPTR)                                 0610 01991000
         ALR   @06,@08                                             0610 01992000
         AL    @06,@CF00868                                        0610 01993000
         MVI   FTLCC(@06),C' '                                     0610 01994000
*                               SPCCNT = SPCCNT + 1;               0611 01995000
         LA    @08,1                                               0611 01996000
         AL    @08,SPCCNT                                          0611 01997000
         ST    @08,SPCCNT                                          0611 01998000
*                             END;                                 0612 01999000
*                       P04FP = P04FP + STDLW;                     0613 02000000
@RF00608 L     @08,P04FP                                           0613 02001000
         AL    @08,STDLW                                           0613 02002000
         ST    @08,P04FP                                           0613 02003000
*                     END;                                         0614 02004000
*                                                                  0614 02005000
         AL    N,@CF00233                                          0614 02006000
@DE00600 CH    N,P04FC                                             0614 02007000
         BNH   @DL00600                                            0614 02008000
*                     /***********************************************/ 02009000
*                     /*                                             */ 02010000
*                     /* ADJUST THE LAST DATA LINE PER FOOTING LINE  */ 02011000
*                     /*                                             */ 02012000
*                     /***********************************************/ 02013000
*                                                                  0615 02014000
*                     PCTFLN = PCTPPD - SPCCNT - 3;                0615 02015000
         LH    @08,PCTPPD(,PCTPTR)                                 0615 02016000
         SL    @08,SPCCNT                                          0615 02017000
         SL    @08,@CF00176                                        0615 02018000
         STH   @08,PCTFLN(,PCTPTR)                                 0615 02019000
*                     PCTLDL = PCTFLN - 2;                         0616 02020000
         BCTR  @08,0                                               0616 02021000
         BCTR  @08,0                                               0616 02022000
         STH   @08,PCTLDL(,PCTPTR)                                 0616 02023000
*                   END;                                           0617 02024000
*             END;                                                 0618 02025000
*                                                                  0618 02026000
@RC00581 DS    0H                                                  0619 02027000
*         /***********************************************************/ 02028000
*         /*                                                         */ 02029000
*         /* END OF THE VERIFY AND PCT SETTING PROCEDURE.            */ 02030000
*         /* THEN RETURN TO THE CALLING PROCEDURE.                   */ 02031000
*         /*                                                         */ 02032000
*         /***********************************************************/ 02033000
*                                                                  0619 02034000
*         RETURN CODE (SAVERC);                                    0619 02035000
@RF00579 LR    @15,SAVERC                                          0619 02036000
         L     @14,@SA00006                                        0619 02037000
         LM    @00,@06,@SA00006+8                                  0619 02038000
         LM    @08,@12,@SA00006+36                                 0619 02039000
         BR    @14                                                 0619 02040000
*         END PCTSETUP;                                            0620 02041000
*                                                                  0620 02042000
*         /***********************************************************/ 02043000
*         /*                                                         */ 02044000
*         /* PROCEDURE NAME - RESET FUNCTION HANDLER.                */ 02045000
*         /*                                                         */ 02046000
*         /* FUNCTION - RESETS THE PRINT CONTROL TABLE TO THE        */ 02047000
*         /* INITIAL DEFAULT VALUES AND RELEASES ALL 'TP' POOL       */ 02048000
*         /* STORAGE.  IN ADDITION, IT RETURNS THE LAST PAGE NUMBER  */ 02049000
*         /* USED TO THE CALLING ROUTINE.                            */ 02050000
*         /*                                                         */ 02051000
*         /* INPUT - PAGE NUMBER LOCATION.                           */ 02052000
*         /*                                                         */ 02053000
*         /* OUTPUT - REVISED PRINT CONTROL TABLE.                   */ 02054000
*         /*                                                         */ 02055000
*         /***********************************************************/ 02056000
*                                                                  0621 02057000
*RESETCON: PROC (PGNOPTR);                                         0621 02058000
*                                                                  0621 02059000
RESETCON STM   @14,@12,@SA00007                                    0621 02060000
         MVC   @PC00007(4),0(@01)                                  0621 02061000
*         /***********************************************************/ 02062000
*         /*                                                         */ 02063000
*         /* THE ARGUMENT STRUCTURE PASSED WITH THE URESET MACRO FOR */ 02064000
*         /* RETURN OF THE PAGE NUMBER TO THE CALLER.                */ 02065000
*         /*                                                         */ 02066000
*         /***********************************************************/ 02067000
*                                                                  0622 02068000
*         DCL PGNOPTR PTR(31);                                     0622 02069000
*         DCL 1 PGNO BASED(PGNOPTR),                               0623 02070000
*              2 PGNOL FIXED(15),      /* LENGTH OF PAGE NUMBER.     */ 02071000
*              2 PGNOC CHAR(4);        /* CHARACTERS OF PAGE NUMBER  */ 02072000
*                                                                  0623 02073000
*         /***********************************************************/ 02074000
*         /*                                                         */ 02075000
*         /* CHECK TO ASSURE THAT A PRINT CONTROL TABLE EXISTS.      */ 02076000
*         /* IF NONE EXISTS, SOMETHING IS OUT OF SEQUENCE.           */ 02077000
*         /*                                                         */ 02078000
*         /***********************************************************/ 02079000
*                                                                  0624 02080000
*         IF GDTTPH = NULLPTR                                      0624 02081000
*           THEN                                                   0624 02082000
         L     @08,GDTTPH(,GDTPTR)                                 0624 02083000
         LTR   @08,@08                                             0624 02084000
         BNZ   @RF00624                                            0624 02085000
*             DO;                                                  0625 02086000
*                                                                  0625 02087000
*               DO;                                                0626 02088000
*                 RESPECIFY(REG13,REG14,REG15) RSTD;               0627 02089000
*                 REG15 = 24;                                      0628 02090000
         LA    REG15,24                                            0628 02091000
*                 REG14 = GDTABT;                                  0629 02092000
         L     REG14,GDTABT(,GDTPTR)                               0629 02093000
*                 REG13 = GDTABH;                                  0630 02094000
         L     REG13,GDTABH(,GDTPTR)                               0630 02095000
*                 GEN(BR    REG14);                                0631 02096000
         BR    REG14                                                    02097000
*                 RESPECIFY(REG13,REG14,REG15)UNRSTD;              0632 02098000
*               END;                                               0633 02099000
*             END;                                                 0634 02100000
*                                                                  0634 02101000
*         /***********************************************************/ 02102000
*         /*                                                         */ 02103000
*         /* SET ADDRESSABILITY TO THE CURRENT PCT.                  */ 02104000
*         /*                                                         */ 02105000
*         /***********************************************************/ 02106000
*                                                                  0635 02107000
*         PCTPTR = GDTTPH;                                         0635 02108000
@RF00624 L     PCTPTR,GDTTPH(,GDTPTR)                              0635 02109000
*         SAVERC = 0;                                      /*@YL026UE*/ 02110000
         SLR   SAVERC,SAVERC                                       0636 02111000
*         IF PCTSPP ^= NULLPTR                                     0637 02112000
*           THEN                                                   0637 02113000
         L     @08,PCTSPP(,PCTPTR)                                 0637 02114000
         LTR   @08,@08                                             0637 02115000
         BZ    @RF00637                                            0637 02116000
*             DO;                                                  0638 02117000
*               PCTPTR = PCTSPP;                                   0639 02118000
         LR    PCTPTR,@08                                          0639 02119000
*               PCTNLI = 999;                                      0640 02120000
         LA    @08,999                                             0640 02121000
         STH   @08,PCTNLI(,PCTPTR)                                 0640 02122000
*               PCTSNL = 999;                                      0641 02123000
         STH   @08,PCTSNL(,PCTPTR)                                 0641 02124000
*             END;                                                 0642 02125000
*                                                                  0642 02126000
*         /***********************************************************/ 02127000
*         /*                                                         */ 02128000
*         /* FLUSH THE STACK BUFFER BEFORE MAKING CHANGES.           */ 02129000
*         /*                                                         */ 02130000
*         /***********************************************************/ 02131000
*                                                                  0643 02132000
*         CALL STACKFL;                                            0643 02133000
*                                                                  0643 02134000
@RF00637 BAL   @14,STACKFL                                         0643 02135000
*         /***********************************************************/ 02136000
*         /*                                                         */ 02137000
*         /* CONVERT AND RETURN THE PAGE NUMBER TO THE CALLERS AREA. */ 02138000
*         /*                                                         */ 02139000
*         /***********************************************************/ 02140000
*                                                                  0644 02141000
*         IF PGNOF = ON & PGNOL > 0 & PGNOL <= 4             /*YM5742*/ 02142000
*           THEN                                                   0644 02143000
         TM    PGNOF,B'01000000'                                   0644 02144000
         BNO   @RF00644                                            0644 02145000
         L     @08,@PC00007                                        0644 02146000
         L     @08,PGNOPTR(,@08)                                   0644 02147000
         LH    @08,PGNOL(,@08)                                     0644 02148000
         LTR   @08,@08                                             0644 02149000
         BNP   @RF00644                                            0644 02150000
         C     @08,@CF00053                                        0644 02151000
         BH    @RF00644                                            0644 02152000
*             DO;                                                  0645 02153000
*               CVDREG = PCTCPN;                                   0646 02154000
         LH    CVDREG,PCTCPN(,PCTPTR)                              0646 02155000
*GEN     (CVD   CVDREG,PACKWD);                                    0647 02156000
         CVD   CVDREG,PACKWD                                            02157000
*GEN     (UNPK  PAGE,PACKWD);                                      0648 02158000
*                                                                  0648 02159000
         UNPK  PAGE,PACKWD                                              02160000
*               PAGE(4) = PAGE(4) | 'F0'X;  /* TURN OFF SIGN.        */ 02161000
         OI    PAGE+3,X'F0'                                        0649 02162000
*               PGNOC(1:PGNOL) = PAGE((5-PGNOL):4);                0650 02163000
         L     @08,@PC00007                                        0650 02164000
         L     @08,PGNOPTR(,@08)                                   0650 02165000
         LH    @04,PGNOL(,@08)                                     0650 02166000
         LR    @03,@04                                             0650 02167000
         BCTR  @03,0                                               0650 02168000
         LCR   @04,@04                                             0650 02169000
         AL    @04,@CF00300                                        0650 02170000
         LA    @01,PAGE-1(@04)                                     0650 02171000
         EX    @03,@SM00869                                        0650 02172000
*             END;                                                 0651 02173000
*         GDTTPH ->PCTSTM = PCTSTM;                                0652 02174000
@RF00644 L     @08,GDTTPH(,GDTPTR)                                 0652 02175000
         MVC   PCTSTM(8,@08),PCTSTM(PCTPTR)                        0652 02176000
*         GDTTPH ->PCTSME = PCTSME;                                0653 02177000
         L     @04,PCTSME(,PCTPTR)                                 0653 02178000
         ST    @04,PCTSME(,@08)                                    0653 02179000
*         IF PCTAPF = ON                                           0654 02180000
*           THEN                                                   0654 02181000
         TM    PCTAPF(PCTPTR),B'00001000'                          0654 02182000
         BNO   @RF00654                                            0654 02183000
*             GDTTPH->PCTACT = PCTSTD;                             0655 02184000
         MVC   PCTACT(8,@08),PCTSTD(PCTPTR)                        0655 02185000
*           ELSE                                                   0656 02186000
*             GDTTPH ->PCTACT = PCTACT;                            0656 02187000
*                                                                  0656 02188000
         B     @RC00654                                            0656 02189000
@RF00654 L     @08,GDTTPH(,GDTPTR)                                 0656 02190000
         MVC   PCTACT(8,@08),PCTACT(PCTPTR)                        0656 02191000
*         /***********************************************************/ 02192000
*         /*                                                         */ 02193000
*         /* FREE  THE TP01 SUB-POOL AND RETURN TO THE CALLER.       */ 02194000
*         /*                                                         */ 02195000
*         /***********************************************************/ 02196000
*                                                                  0657 02197000
*         CALL IDCSAFP0 (GDTTBL,TPPOOL,ALL);                       0657 02198000
*                                                                  0657 02199000
@RC00654 MVC   @AL00001+4(8),@AL00657                              0657 02200000
         ST    GDTPTR,@AL00001                                     0657 02201000
         L     @15,GDTFPL(,GDTPTR)                                 0657 02202000
         LA    @01,@AL00001                                        0657 02203000
         BALR  @14,@15                                             0657 02204000
*         /***********************************************************/ 02205000
*         /*                                                         */ 02206000
*         /* CLEAR THE STID AND HEADER QUEUE POINTERS.               */ 02207000
*         /*                                                         */ 02208000
*         /***********************************************************/ 02209000
*                                                                  0658 02210000
*         PCTPTR = GDTTPH;                                         0658 02211000
         L     PCTPTR,GDTTPH(,GDTPTR)                              0658 02212000
*         PCTSPP = NULLPTR;                                        0659 02213000
         SLR   @08,@08                                             0659 02214000
         ST    @08,PCTSPP(,PCTPTR)                                 0659 02215000
*         PCTSQP = NULLPTR;                                        0660 02216000
         ST    @08,PCTSQP(,PCTPTR)                                 0660 02217000
*         PCTAHP = NULLPTR;                                        0661 02218000
         ST    @08,PCTAHP(,PCTPTR)                                 0661 02219000
*         PCTBNL = PCTBUF;                                         0662 02220000
*                                                                  0662 02221000
         L     @04,PCTBUF(,PCTPTR)                                 0662 02222000
         ST    @04,PCTBNL(,PCTPTR)                                 0662 02223000
*         RETURN CODE(0);                                          0663 02224000
         LR    @15,@08                                             0663 02225000
         L     @14,@SA00007                                        0663 02226000
         LM    @00,@12,@SA00007+8                                  0663 02227000
         BR    @14                                                 0663 02228000
*         END RESETCON;                                            0664 02229000
*                                                                  0664 02230000
*         /*                                                         */ 02231000
*         /* PROCEDURE NAME - GET PRINT CONTROL TABLE.               */ 02232000
*         /*                                                         */ 02233000
*         /* FUNCTION - GETS CORE FOR AND INITIALIZES THE PRINT      */ 02234000
*         /* CONTROL TABLE.                                          */ 02235000
*         /*                                                         */ 02236000
*         /* INPUT - NONE.                                           */ 02237000
*         /*                                                         */ 02238000
*         /* OUTPUT - NEW UNINITIALIZED PRINT CONTROL TABLE.         */ 02239000
*         /*                                                         */ 02240000
*         /***********************************************************/ 02241000
*                                                                  0665 02242000
*INITPCT: PROC;                                                    0665 02243000
*                                                                  0665 02244000
INITPCT  STM   @14,@04,@SA00008                                    0665 02245000
         STM   @06,@12,@SA00008+28                                 0665 02246000
*         /***********************************************************/ 02247000
*         /*                                                         */ 02248000
*         /* FLUSH THE STACK BUFFER BEFORE MAKING CHANGES.           */ 02249000
*         /*                                                         */ 02250000
*         /***********************************************************/ 02251000
*                                                                  0666 02252000
*         IF GDTTPH ^= NULLPTR                                     0666 02253000
*           THEN                                                   0666 02254000
*                                                                  0666 02255000
         L     @08,GDTTPH(,GDTPTR)                                 0666 02256000
         LTR   @08,@08                                             0666 02257000
         BZ    @RF00666                                            0666 02258000
*             CALL STACKFL;                                        0667 02259000
*                                                                  0667 02260000
         BAL   @14,STACKFL                                         0667 02261000
*         PCTPTR = GDTTPH;                                         0668 02262000
*                                                                  0668 02263000
@RF00666 L     @08,GDTTPH(,GDTPTR)                                 0668 02264000
         LR    PCTPTR,@08                                          0668 02265000
*         /***********************************************************/ 02266000
*         /*                                                         */ 02267000
*         /* IF AN EXISTING SECONDARY TABLE EXISTS, FREE IT.         */ 02268000
*         /*                                                         */ 02269000
*         /***********************************************************/ 02270000
*                                                                  0669 02271000
*         IF GDTTPH ^= NULLPTR & PCTSPP ^= NULLPTR                 0669 02272000
*           THEN                                                   0669 02273000
         SLR   @04,@04                                             0669 02274000
         CR    @08,@04                                             0669 02275000
         BE    @RF00669                                            0669 02276000
         L     @03,PCTSPP(,PCTPTR)                                 0669 02277000
         CR    @03,@04                                             0669 02278000
         BE    @RF00669                                            0669 02279000
*             DO;                                                  0670 02280000
*               PCTPTR = PCTSPP;                           /*@OZ07572*/ 02281000
         LR    PCTPTR,@03                                          0671 02282000
*               IF GDTTPH -> PCTAPF = ON                   /*@OZ07572*/ 02283000
*                 THEN                                             0672 02284000
         TM    PCTAPF(@08),B'00001000'                             0672 02285000
         BNO   @RF00672                                            0672 02286000
*                   GDTTPH->PCTACT = PCTSTD;                       0673 02287000
         MVC   PCTACT(8,@08),PCTSTD(PCTPTR)                        0673 02288000
*                 ELSE                                             0674 02289000
*                   GDTTPH->PCTACT = PCTACT;                       0674 02290000
         B     @RC00672                                            0674 02291000
@RF00672 L     @08,GDTTPH(,GDTPTR)                                 0674 02292000
         MVC   PCTACT(8,@08),PCTACT(PCTPTR)                        0674 02293000
*               PCTPTR = GDTTPH;                           /*@OZ07572*/ 02294000
*                                                                  0675 02295000
@RC00672 L     PCTPTR,GDTTPH(,GDTPTR)                              0675 02296000
*               CALL IDCSAFP0 (GDTTBL,TPPOOL,ALL);                 0676 02297000
*                                                                  0676 02298000
         MVC   @AL00001+4(8),@AL00676                              0676 02299000
         ST    GDTPTR,@AL00001                                     0676 02300000
         L     @15,GDTFPL(,GDTPTR)                                 0676 02301000
         LA    @01,@AL00001                                        0676 02302000
         BALR  @14,@15                                             0676 02303000
*               GDTTPH->PCTSQP = NULLPTR;                  /*@Y30LSBE*/ 02304000
*                                                                  0677 02305000
         L     @08,GDTTPH(,GDTPTR)                                 0677 02306000
         SLR   @04,@04                                             0677 02307000
         ST    @04,PCTSQP(,@08)                                    0677 02308000
*             END;                                                 0678 02309000
*                                                                  0678 02310000
*             OLDERID2 = NEWERID2;                                 0679 02311000
@RF00669 L     @08,GDTTR2(,GDTPTR)                                 0679 02312000
         MVC   @TS00001(95),NEWERID2(@08)                          0679 02313000
         MVC   OLDERID2(95,@08),@TS00001                           0679 02314000
*             NEWID2 = 'TP4G';                                     0680 02315000
*                                                                  0680 02316000
         MVC   NEWID2(4,@08),@CC00855                              0680 02317000
*         /***********************************************************/ 02318000
*         /*                                                         */ 02319000
*         /* IF REQUEST IS FOR PRIMARY PCT, GET NON POOL CORE.       */ 02320000
*         /*                                                         */ 02321000
*         /***********************************************************/ 02322000
*                                                                  0681 02323000
*         IF GDTTPH = NULLPTR                                      0681 02324000
*           THEN                                                   0681 02325000
         L     @08,GDTTPH(,GDTPTR)                                 0681 02326000
         LTR   @08,@08                                             0681 02327000
         BNZ   @RF00681                                            0681 02328000
*             DO;                                                  0682 02329000
*                                                                  0682 02330000
*               CALL IDCSAGS0 (GDTTBL,PCTLEN,GDTTPH,SETZERO);      0683 02331000
*                                                                  0683 02332000
         ST    GDTPTR,@AL00001                                     0683 02333000
         LA    @08,PCTLEN                                          0683 02334000
         ST    @08,@AL00001+4                                      0683 02335000
         LA    @08,GDTTPH(,GDTPTR)                                 0683 02336000
         ST    @08,@AL00001+8                                      0683 02337000
         LA    @08,SETZERO                                         0683 02338000
         ST    @08,@AL00001+12                                     0683 02339000
         MVI   @AL00001+12,X'80'                                   0683 02340000
         L     @15,GDTGSP(,GDTPTR)                                 0683 02341000
         LA    @01,@AL00001                                        0683 02342000
         BALR  @14,@15                                             0683 02343000
*               RESPECIFY RTNREG RSTD;                             0684 02344000
*               TESTRC = RTNREG;                                   0685 02345000
         LR    TESTRC,RTNREG                                       0685 02346000
*               RESPECIFY RTNREG UNRSTD;                           0686 02347000
*               IF TESTRC ^= 0                                     0687 02348000
*                 THEN                                             0687 02349000
*                                                                  0687 02350000
         LTR   TESTRC,TESTRC                                       0687 02351000
         BZ    @RF00687                                            0687 02352000
*                   DO;                                            0688 02353000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0689 02354000
*                     REG15 = 28;                                  0690 02355000
         LA    REG15,28                                            0690 02356000
*                     REG14 = GDTABT;                              0691 02357000
         L     REG14,GDTABT(,GDTPTR)                               0691 02358000
*                     REG13 = GDTABH;                              0692 02359000
         L     REG13,GDTABH(,GDTPTR)                               0692 02360000
*                     GEN(BR    REG14);                            0693 02361000
         BR    REG14                                                    02362000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0694 02363000
*                   END;                                           0695 02364000
*               PCTPTR = GDTTPH;                                   0696 02365000
@RF00687 L     PCTPTR,GDTTPH(,GDTPTR)                              0696 02366000
*               PCTIDN = 'PCT1';                                   0697 02367000
         MVC   PCTIDN(4,PCTPTR),@CC00856                           0697 02368000
*             END;                                                 0698 02369000
*                                                                  0698 02370000
*           /*********************************************************/ 02371000
*           /*                                                       */ 02372000
*           /* IF REQUEST IS FOR SECONDARY PCT, GET TP POOL CORE.    */ 02373000
*           /*                                                       */ 02374000
*           /*********************************************************/ 02375000
*                                                                  0699 02376000
*           ELSE                                                   0699 02377000
*             DO;                                                  0699 02378000
*                                                                  0699 02379000
         B     @RC00681                                            0699 02380000
@RF00681 DS    0H                                                  0700 02381000
*               CALL IDCSAGP0 (GDTTBL,PCTLEN,PCTSPP,TPPOOL,SETZERO);    02382000
*                                                                  0700 02383000
         MVC   @AL00001+4(16),@AL00700                             0700 02384000
         ST    GDTPTR,@AL00001                                     0700 02385000
         LA    @08,PCTSPP(,PCTPTR)                                 0700 02386000
         ST    @08,@AL00001+8                                      0700 02387000
         L     @15,GDTGPL(,GDTPTR)                                 0700 02388000
         LA    @01,@AL00001                                        0700 02389000
         BALR  @14,@15                                             0700 02390000
*               RESPECIFY RTNREG RSTD;                             0701 02391000
*               TESTRC = RTNREG;                                   0702 02392000
         LR    TESTRC,RTNREG                                       0702 02393000
*               RESPECIFY RTNREG UNRSTD;                           0703 02394000
*               IF TESTRC ^= 0                                     0704 02395000
*                 THEN                                             0704 02396000
*                                                                  0704 02397000
         LTR   TESTRC,TESTRC                                       0704 02398000
         BZ    @RF00704                                            0704 02399000
*                   DO;                                            0705 02400000
*                     RESPECIFY(REG13,REG14,REG15) RSTD;           0706 02401000
*                     REG15 = 28;                                  0707 02402000
         LA    REG15,28                                            0707 02403000
*                     REG14 = GDTABT;                              0708 02404000
         L     REG14,GDTABT(,GDTPTR)                               0708 02405000
*                     REG13 = GDTABH;                              0709 02406000
         L     REG13,GDTABH(,GDTPTR)                               0709 02407000
*                     GEN(BR    REG14);                            0710 02408000
         BR    REG14                                                    02409000
*                     RESPECIFY(REG13,REG14,REG15)UNRSTD;          0711 02410000
*                   END;                                           0712 02411000
*                                                                  0712 02412000
*               PCTPTR = PCTSPP;                                   0713 02413000
@RF00704 L     PCTPTR,PCTSPP(,PCTPTR)                              0713 02414000
*               PCTTAB = GDTTPH->PCTTAB;                           0714 02415000
         L     @08,GDTTPH(,GDTPTR)                                 0714 02416000
         MVC   PCTTAB(112,PCTPTR),PCTTAB(@08)                      0714 02417000
*               PCTSPP = NULLPTR;                                  0715 02418000
         SLR   @08,@08                                             0715 02419000
         ST    @08,PCTSPP(,PCTPTR)                                 0715 02420000
*               PCTSQP = NULLPTR;                          /*@Y30LSBE*/ 02421000
         ST    @08,PCTSQP(,PCTPTR)                                 0716 02422000
*               PCTAHP = NULLPTR;                          /*@Y30LSBE*/ 02423000
         ST    @08,PCTAHP(,PCTPTR)                                 0717 02424000
*               PCTIDN = 'PCT2';                                   0718 02425000
         MVC   PCTIDN(4,PCTPTR),@CC00857                           0718 02426000
*             END;                                                 0719 02427000
*         END INITPCT;                                             0720 02428000
@EL00008 DS    0H                                                  0720 02429000
@EF00008 DS    0H                                                  0720 02430000
@ER00008 LM    @14,@04,@SA00008                                    0720 02431000
         LM    @06,@12,@SA00008+28                                 0720 02432000
         BR    @14                                                 0720 02433000
*         /***********************************************************/ 02434000
*         /*                                                         */ 02435000
*         /* PROCEDURE NAME - PRINT STACK BUFFER FLUSHING.           */ 02436000
*         /*                                                         */ 02437000
*         /* FUNCTION - CLEARS OUT ANY LINES THAT MAY HAVE BEEN LEFT */ 02438000
*         /* IN THE STACK BUFFER BY PREVIOUS OPERATIONS BY PUTTING   */ 02439000
*         /* THEM TO THE IO ADAPTOR.                                 */ 02440000
*         /*                                                         */ 02441000
*         /* INPUT - PRINT CONTROL TABLE & STACK BUFFER.             */ 02442000
*         /*                                                         */ 02443000
*         /* OUTPUT - PRINTED LINES TO SYSPRINT.                     */ 02444000
*         /*                                                         */ 02445000
*         /***********************************************************/ 02446000
*                                                                  0721 02447000
*STACKFL: PROC;                                                    0721 02448000
*                                                                  0721 02449000
STACKFL  STM   @14,@12,@SA00009                                    0721 02450000
*         IF PCTLNM = 0                                            0722 02451000
*           THEN                                                   0722 02452000
         SLR   @08,@08                                             0722 02453000
         CH    @08,PCTLNM(,PCTPTR)                                 0722 02454000
         BNE   @RF00722                                            0722 02455000
*             RETURN CODE(0);                                      0723 02456000
*                                                                  0723 02457000
         LR    @15,@08                                             0723 02458000
         L     @14,@SA00009                                        0723 02459000
         LM    @00,@12,@SA00009+8                                  0723 02460000
         BR    @14                                                 0723 02461000
*         IOCSPTR = PCTIOC;             /* SET IOCS ADDRESSABILITY   */ 02462000
@RF00722 L     IOCSPTR,PCTIOC(,PCTPTR)                             0724 02463000
*         IOCDLN = PCTBNL - PCTBUF;     /* SET DATA LENGTH.          */ 02464000
         L     @08,PCTBUF(,PCTPTR)                                 0725 02465000
         L     @04,PCTBNL(,PCTPTR)                                 0725 02466000
         SLR   @04,@08                                             0725 02467000
         ST    @04,IOCDLN(,IOCSPTR)                                0725 02468000
*         IOCDAD = PCTBUF;              /* SET DATA ADDRESS.         */ 02469000
         ST    @08,IOCDAD(,IOCSPTR)                                0726 02470000
*         IOCPNM = PCTLNM;              /* SET LINE COUNT.           */ 02471000
*                                                                  0727 02472000
         LH    @08,PCTLNM(,PCTPTR)                                 0727 02473000
         STH   @08,IOCPNM(,IOCSPTR)                                0727 02474000
*         CALL IDCIOPT0 (GDTTBL,PCTIOC,NULLPMN);                   0728 02475000
*                                                                  0728 02476000
         ST    GDTPTR,@AL00001                                     0728 02477000
         LA    @08,PCTIOC(,PCTPTR)                                 0728 02478000
         ST    @08,@AL00001+4                                      0728 02479000
         LA    @08,NULLPMN                                         0728 02480000
         ST    @08,@AL00001+8                                      0728 02481000
         MVI   @AL00001+8,X'80'                                    0728 02482000
         L     @15,GDTPUT(,GDTPTR)                                 0728 02483000
         LA    @01,@AL00001                                        0728 02484000
         BALR  @14,@15                                             0728 02485000
*         RESPECIFY RTNREG RSTD;                                   0729 02486000
*         TESTRC = RTNREG;                                         0730 02487000
         LR    TESTRC,RTNREG                                       0730 02488000
*         RESPECIFY RTNREG UNRSTD;                                 0731 02489000
*         IF TESTRC ^= 0                                           0732 02490000
*           THEN                                                   0732 02491000
*                                                                  0732 02492000
         LTR   TESTRC,TESTRC                                       0732 02493000
         BZ    @RF00732                                            0732 02494000
*             DO;                                                  0733 02495000
*               RESPECIFY(REG13,REG14,REG15) RSTD;                 0734 02496000
*               REG15 = 28;                                        0735 02497000
         LA    REG15,28                                            0735 02498000
*               REG14 = GDTABT;                                    0736 02499000
         L     REG14,GDTABT(,GDTPTR)                               0736 02500000
*               REG13 = GDTABH;                                    0737 02501000
         L     REG13,GDTABH(,GDTPTR)                               0737 02502000
*               GEN(BR    REG14);                                  0738 02503000
         BR    REG14                                                    02504000
*               RESPECIFY(REG13,REG14,REG15)UNRSTD;                0739 02505000
*             END;                                                 0740 02506000
*                                                                  0740 02507000
*         GDTTPH->PCTLNM = NULLPTR;                                0741 02508000
@RF00732 SLR   @08,@08                                             0741 02509000
         L     @04,GDTTPH(,GDTPTR)                                 0741 02510000
         STH   @08,PCTLNM(,@04)                                    0741 02511000
*         GDTTPH->PCTBNL = PCTBUF;                                 0742 02512000
         L     @03,PCTBUF(,PCTPTR)                                 0742 02513000
         ST    @03,PCTBNL(,@04)                                    0742 02514000
*         PCTLNM = NULLPTR;                                        0743 02515000
         STH   @08,PCTLNM(,PCTPTR)                                 0743 02516000
*         PCTBNL = PCTBUF;                                         0744 02517000
*                                                                  0744 02518000
         ST    @03,PCTBNL(,PCTPTR)                                 0744 02519000
*         END STACKFL;                                             0745 02520000
*                                                                  0745 02521000
@EL00009 DS    0H                                                  0745 02522000
@EF00009 DS    0H                                                  0745 02523000
@ER00009 LM    @14,@12,@SA00009                                    0745 02524000
         BR    @14                                                 0745 02525000
*         /***********************************************************/ 02526000
*         /*                                                         */ 02527000
*         /* END OF THE PAGE CONTROL MAJOR PROCEDURE.                */ 02528000
*         /*                                                         */ 02529000
*         /***********************************************************/ 02530000
*                                                                  0746 02531000
*         END IDCTP04                                              0746 02532000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02533000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 02534000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 02535000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 02536000
*/*%INCLUDE SYSLIB  (AMSDF40 )                                        * 02537000
*;                                                                 0746 02538000
@DATA    DS    0H                                                       02539000
@CH00840 DC    H'60'                                                    02540000
@CH00725 DC    H'66'                                                    02541000
@CH00723 DC    H'121'                                                   02542000
@CH00826 DC    H'-1'                                                    02543000
@SM00866 MVC   0(0,@01),PGNOCIN(@04)                                    02544000
@SM00869 MVC   PGNOC(0,@08),0(@01)                                      02545000
         DS    0F                                                       02546000
@AL00657 EQU   *                       LIST WITH   2 ARGUMENT(S)        02547000
@AL00676 DC    A(TPPOOL)               LIST WITH   2 ARGUMENT(S)        02548000
         DC    AL1(X'80')                                               02549000
         DC    AL3(ALL)                                                 02550000
@AL00700 DC    A(PCTLEN)               LIST WITH   4 ARGUMENT(S)        02551000
         DS    F                                                        02552000
         DC    A(TPPOOL)                                                02553000
         DC    AL1(X'80')                                               02554000
         DC    AL3(SETZERO)                                             02555000
@DATD    DSECT                                                          02556000
         DS    0F                                                       02557000
@SA00001 DS    18F                                                      02558000
@PC00001 DS    9F                                                       02559000
@SA00002 DS    15F                                                      02560000
@PC00002 DS    1F                                                       02561000
@SA00003 DS    15F                                                      02562000
@PC00003 DS    1F                                                       02563000
@SA00005 DS    15F                                                      02564000
@SA00007 DS    15F                                                      02565000
@PC00007 DS    1F                                                       02566000
@SA00008 DS    14F                                                      02567000
@SA00006 DS    14F                                                      02568000
@SA00009 DS    15F                                                      02569000
@AL00001 DS    5A                                                       02570000
@TF00001 DS    F                                                        02571000
IDCTP04  CSECT                                                          02572000
         DS    0F                                                       02573000
@CF00233 DC    F'1'                                                     02574000
@CH00233 EQU   @CF00233+2                                               02575000
@CF00167 DC    F'2'                                                     02576000
@CF00176 DC    F'3'                                                     02577000
@CH00176 EQU   @CF00176+2                                               02578000
@CF00053 DC    F'4'                                                     02579000
@CH00053 EQU   @CF00053+2                                               02580000
@CF00300 DC    F'5'                                                     02581000
@CF00170 DC    F'6'                                                     02582000
@CF00816 DC    F'7'                                                     02583000
@CF00841 DC    F'133'                                                   02584000
@CF00780 DC    F'255'                                                   02585000
@CF00842 DC    F'9999'                                                  02586000
@CF00868 DC    F'-121'                                                  02587000
@DATD    DSECT                                                          02588000
         DS    0D                                                       02589000
LISTSCAN DS    A                                                        02590000
DDSTRU   DS    A                                                        02591000
FSADDR   DS    A                                                        02592000
ERCNVADR DS    A                                                        02593000
DMPINDEX DS    A                                                        02594000
PCAADDR  DS    A                                                        02595000
SPCCNT   DS    F                                                        02596000
LISTPTR  DS    A                                                        02597000
TEMPTR   DS    A                                                        02598000
SETRC    DS    H                                                        02599000
ARGNMB   DS    H                                                        02600000
@TS00001 DS    CL95                                                     02601000
         DS    CL1                                                      02602000
P04WT    DS    CL42                                                     02603000
         ORG   P04WT                                                    02604000
P04MTP   DS    AL4                                                      02605000
P04STP   DS    AL4                                                      02606000
P04FP    DS    AL4                                                      02607000
P04FNP   DS    AL4                                                      02608000
P04PCP   DS    AL4                                                      02609000
P04MTC   DS    FL2                                                      02610000
P04STC   DS    FL2                                                      02611000
P04FC    DS    FL2                                                      02612000
P04LW    DS    FL2                                                      02613000
P04PD    DS    FL2                                                      02614000
P04DSC   DS    FL2                                                      02615000
P04CPN   DS    FL2                                                      02616000
P04PNI   DS    FL2                                                      02617000
P04PNL   DS    FL2                                                      02618000
P04TL    DS    FL2                                                      02619000
P04DL    DS    FL2                                                      02620000
         ORG   P04WT+42                                                 02621000
         DS    CL2                                                      02622000
PROPEN   DS    CL48                                                     02623000
P04FLG   DS    BL1                                                      02624000
         ORG   P04FLG                                                   02625000
PRIPCT   DS    BL1                                                      02626000
PGNOF    EQU   P04FLG+0                                                 02627000
         ORG   P04FLG+1                                                 02628000
STID     DS    CL4                                                      02629000
PAGE     DS    CL4                                                      02630000
MACARG   DS    CL3                                                      02631000
PACKWD   DS    CL8                                                      02632000
RESTARG  DS    7A                                                       02633000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02634000
@ENDDATD EQU   *                                                        02635000
IDCTP04  CSECT                                                          02636000
         DS    0F                                                       02637000
@SIZDATD DC    AL1(0)                                                   02638000
         DC    AL3(@ENDDATD-@DATD)                                      02639000
@CV00747 DC    V(IDCTP05)                                               02640000
         DS    0D                                                       02641000
PCTLEN   DC    AL4(112)                                                 02642000
STDLW    DC    F'121'                                                   02643000
PRBUFL   DC    F'2048'                                                  02644000
SUBPZ    DC    F'0'                                                     02645000
IOPLSP   DC    F'40'                                                    02646000
TTSIZE   DC    H'256'                                                   02647000
OFLOSS   DC    H'12'                                                    02648000
NULLPMN  DC    H'0'                                                     02649000
@CC00795 DC    C'TP4I'                                                  02650000
@CC00798 DC    C'TP4A'                                                  02651000
@CC00802 DC    C'TP4S'                                                  02652000
@CC00834 DC    C'TP4R'                                                  02653000
@CC00855 DC    C'TP4G'                                                  02654000
@CC00856 DC    C'PCT1'                                                  02655000
@CC00857 DC    C'PCT2'                                                  02656000
@CC00832 DC    C'TP0'                                                   02657000
@CC00825 DC    C'ST'                                                    02658000
@CC00827 DC    C'FT'                                                    02659000
@CC00828 DC    C'LW'                                                    02660000
@CC00829 DC    C'PD'                                                    02661000
@CC00830 DC    C'SC'                                                    02662000
@CC00831 EQU   @CC00856                                                 02663000
@CC00833 DC    C'PN'                                                    02664000
MODID    DC    CL4'TP04'                                                02665000
ALL      DC    CL3'ALL'                                                 02666000
FORMAT   DC    CL4'FORM'                                                02667000
HSECOND  DC    CL4'HSEC'                                                02668000
CLOCK    DC    CL4'KLOK'                                                02669000
SETZERO  DC    CL4'ZERO'                                                02670000
SETBLANK DC    CL4'BLNK'                                                02671000
NOSET    DC    CL4'NSET'                                                02672000
OVERRIDE DC    CL4'OVRD'                                                02673000
ACQUIRE  DC    CL8'ACQUIRE '                                            02674000
RELINQ   DC    CL8'RELINQ  '                                            02675000
MOUNT    DC    CL8'MOUNT   '                                            02676000
DEMOUNT  DC    CL8'DEMOUNT '                                            02677000
DEFINE   DC    CL8'DEFINE  '                                            02678000
MOVE     DC    CL8'MOVE    '                                            02679000
TRACEQ   DC    CL8'TRACEQ  '                                            02680000
COPYTABL DC    CL8'COPYTABL'                                            02681000
COPYCRTG DC    CL8'COPYCRTG'                                            02682000
COPYVOL  DC    CL8'COPYVOL '                                            02683000
VVIC     DC    CL8'VVIC    '                                            02684000
TUNE     DC    CL8'TUNE    '                                            02685000
NAMES    DC    CL4'NAME'                                                02686000
UNIT     DC    CL4'UNIT'                                                02687000
SHR      DC    CL4'SHR '                                                02688000
EXCL     DC    CL4'EXCL'                                                02689000
NOWAIT   DC    CL4'NWAI'                                                02690000
WAIT     DC    CL4'WAIT'                                                02691000
TPPOOL   DC    CL4'TP01'                                                02692000
DUMPID   DC    CL4'TP04'                                                02693000
FIXAREA  DS    CL220                                                    02694000
PCTAB    DC    X'C1D501'                                                02695000
         DC    X'C8D506'                                                02696000
         DC    X'D7D502'                                                02697000
         DC    X'D8D503'                                                02698000
         DC    X'D9D507'                                                02699000
         DC    X'E2D504'                                                02700000
         DC    X'E3D505'                                                02701000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02702000
@01      EQU   01                                                       02703000
@02      EQU   02                                                       02704000
@03      EQU   03                                                       02705000
@04      EQU   04                                                       02706000
@05      EQU   05                                                       02707000
@06      EQU   06                                                       02708000
@07      EQU   07                                                       02709000
@08      EQU   08                                                       02710000
@09      EQU   09                                                       02711000
@10      EQU   10                                                       02712000
@11      EQU   11                                                       02713000
@12      EQU   12                                                       02714000
@13      EQU   13                                                       02715000
@14      EQU   14                                                       02716000
@15      EQU   15                                                       02717000
N        EQU   @03                                                      02718000
SAVERC   EQU   @07                                                      02719000
PCRADDR  EQU   @06                                                      02720000
PCTPTR   EQU   @05                                                      02721000
OPNPTR   EQU   @03                                                      02722000
IOCSPTR  EQU   @03                                                      02723000
TESTRC   EQU   @03                                                      02724000
LISTLN   EQU   @08                                                      02725000
RTNREG   EQU   @15                                                      02726000
REG13    EQU   @13                                                      02727000
REG14    EQU   @14                                                      02728000
REG15    EQU   @15                                                      02729000
CVDREG   EQU   @02                                                      02730000
GDTPTR   EQU   @09                                                      02731000
REG0     EQU   @00                                                      02732000
REG1     EQU   @01                                                      02733000
REG10    EQU   @10                                                      02734000
REG11    EQU   @11                                                      02735000
REG12    EQU   @12                                                      02736000
REG2     EQU   @02                                                      02737000
REG3     EQU   @03                                                      02738000
REG4     EQU   @04                                                      02739000
REG5     EQU   @05                                                      02740000
REG6     EQU   @06                                                      02741000
REG7     EQU   @07                                                      02742000
REG8     EQU   @08                                                      02743000
REG9     EQU   @09                                                      02744000
GDTTBL   EQU   0                                                        02745000
GDTTR1   EQU   GDTTBL+8                                                 02746000
GDTTR2   EQU   GDTTBL+12                                                02747000
GDTTPH   EQU   GDTTBL+28                                                02748000
GDTDBG   EQU   GDTTBL+40                                                02749000
GDTSTC   EQU   GDTTBL+44                                                02750000
GDTPRT   EQU   GDTTBL+48                                                02751000
GDTESS   EQU   GDTTBL+52                                                02752000
GDTESA   EQU   GDTTBL+56                                                02753000
GDTRST   EQU   GDTTBL+60                                                02754000
GDTRES   EQU   GDTTBL+64                                                02755000
GDTCAL   EQU   GDTTBL+68                                                02756000
GDTGSP   EQU   GDTTBL+72                                                02757000
GDTFSP   EQU   GDTTBL+76                                                02758000
GDTGPL   EQU   GDTTBL+80                                                02759000
GDTFPL   EQU   GDTTBL+84                                                02760000
GDTLOD   EQU   GDTTBL+88                                                02761000
GDTDEL   EQU   GDTTBL+92                                                02762000
GDTPRL   EQU   GDTTBL+96                                                02763000
GDTEPL   EQU   GDTTBL+100                                               02764000
GDTTIM   EQU   GDTTBL+104                                               02765000
GDTIIO   EQU   GDTTBL+108                                               02766000
GDTTIO   EQU   GDTTBL+112                                               02767000
GDTOPN   EQU   GDTTBL+124                                               02768000
GDTCLS   EQU   GDTTBL+128                                               02769000
GDTGET   EQU   GDTTBL+132                                               02770000
GDTPUT   EQU   GDTTBL+136                                               02771000
GDTPOS   EQU   GDTTBL+140                                               02772000
GDTCPY   EQU   GDTTBL+144                                               02773000
GDTCAT   EQU   GDTTBL+148                                               02774000
GDTABT   EQU   GDTTBL+152                                               02775000
GDTABH   EQU   GDTTBL+156                                               02776000
GDTSNP   EQU   GDTTBL+164                                               02777000
GDTVFY   EQU   GDTTBL+172                                               02778000
GDTUID   EQU   GDTTBL+192                                               02779000
GDTPMT   EQU   GDTTBL+196                                               02780000
GDTCIR   EQU   GDTTBL+200                                               02781000
GDTLNK   EQU   GDTTBL+204                                               02782000
GDTALC   EQU   GDTTBL+208                                               02783000
GDTDLC   EQU   GDTTBL+212                                               02784000
GDTQAL   EQU   GDTTBL+216                                               02785000
GDTSTW   EQU   GDTTBL+220                                               02786000
GDTSSC   EQU   GDTTBL+224                                               02787000
GDTENQ   EQU   GDTTBL+228                                               02788000
GDTRSV   EQU   GDTTBL+232                                               02789000
GDTDEQ   EQU   GDTTBL+236                                               02790000
GDTSFO   EQU   GDTTBL+240                                               02791000
GDTWTO   EQU   GDTTBL+244                                               02792000
GDTSCR   EQU   GDTTBL+248                                               02793000
GDTUNT   EQU   GDTTBL+252                                               02794000
GDTRCT   EQU   GDTTBL+256                                               02795000
GDTIFO   EQU   GDTTBL+260                                               02796000
GDTEXP   EQU   GDTTBL+264                                               02797000
GDTSTA   EQU   GDTTBL+268                                               02798000
GDTERR   EQU   GDTTBL+272                                               02799000
GDTUNC   EQU   GDTTBL+276                                               02800000
GDTLOC   EQU   GDTTBL+280                                               02801000
IDCSALD0 EQU   0                                                        02802000
IDCSAEP0 EQU   0                                                        02803000
IDCSAGS0 EQU   0                                                        02804000
IDCSAFS0 EQU   0                                                        02805000
IDCSAGP0 EQU   0                                                        02806000
IDCSAFP0 EQU   0                                                        02807000
IDCSATI0 EQU   0                                                        02808000
TRACE1   EQU   0                                                        02809000
OLDERID1 EQU   TRACE1                                                   02810000
TRACE2   EQU   0                                                        02811000
OLDERID2 EQU   TRACE2                                                   02812000
NEWID2   EQU   TRACE2+95                                                02813000
NEWERID2 EQU   5                                                        02814000
LISTTEST EQU   0                                                        02815000
CIRAGL   EQU   0                                                        02816000
CIRTYPE  EQU   CIRAGL                                                   02817000
ALLAGL   EQU   0                                                        02818000
ALLSTS   EQU   ALLAGL+24                                                02819000
ALLDSP   EQU   ALLAGL+25                                                02820000
ALLORG   EQU   ALLAGL+26                                                02821000
ALLOPT   EQU   ALLAGL+28                                                02822000
UNITABL  EQU   0                                                        02823000
UNITADR  EQU   UNITABL+4                                                02824000
@NM00010 EQU   UNITADR                                                  02825000
UNITSTAT EQU   UNITABL+6                                                02826000
IDCIOOP0 EQU   0                                                        02827000
IDCIOPT0 EQU   0                                                        02828000
IOCSTR   EQU   0                                                        02829000
IOCDAD   EQU   IOCSTR                                                   02830000
IOCDLN   EQU   IOCSTR+4                                                 02831000
IOCDSO   EQU   IOCSTR+16                                                02832000
IOCRFM   EQU   IOCSTR+17                                                02833000
IOCMAC   EQU   IOCSTR+18                                                02834000
IOCMAC2  EQU   IOCSTR+19                                                02835000
IOCCHP   EQU   IOCSTR+20                                                02836000
IOCMSG   EQU   IOCSTR+21                                                02837000
IOCRBA   EQU   IOCSTR+40                                                02838000
IOCTTR   EQU   IOCRBA                                                   02839000
IOCMEM   EQU   IOCSTR+44                                                02840000
IOCNWM   EQU   IOCSTR+48                                                02841000
IOCPNM   EQU   IOCNWM+2                                                 02842000
OPNAGL   EQU   0                                                        02843000
OPNOPT   EQU   OPNAGL                                                   02844000
OPNRFM   EQU   OPNAGL+1                                                 02845000
OPNTYP   EQU   OPNAGL+2                                                 02846000
OPNTYPSO EQU   OPNTYP                                                   02847000
OPNMOD   EQU   OPNAGL+3                                                 02848000
OPNMODAC EQU   OPNMOD                                                   02849000
OPNIOC   EQU   OPNAGL+4                                                 02850000
OPNDEV   EQU   OPNAGL+24                                                02851000
OPNDSO   EQU   OPNAGL+41                                                02852000
OPNOPT2  EQU   OPNAGL+42                                                02853000
IOINFOPT EQU   0                                                        02854000
UVOLLIST EQU   0                                                        02855000
UVOLENT  EQU   UVOLLIST+2                                               02856000
DARGLIST EQU   0                                                        02857000
DARGSTID EQU   DARGLIST+8                                               02858000
DARGARY  EQU   DARGLIST+20                                              02859000
DARGINS  EQU   DARGARY                                                  02860000
DARGINL  EQU   DARGARY+2                                                02861000
FMTLIST  EQU   0                                                        02862000
FMTFLGS  EQU   FMTLIST                                                  02863000
FMTSPF   EQU   FMTLIST+2                                                02864000
FMTRFNO  EQU   FMTSPF                                                   02865000
FMTILEN  EQU   FMTRFNO                                                  02866000
FMTIOFF  EQU   FMTLIST+4                                                02867000
FMTTRBC  EQU   FMTIOFF                                                  02868000
FMTSTO   EQU   FMTTRBC                                                  02869000
FMTOCOL  EQU   FMTLIST+6                                                02870000
FMTCNVF  EQU   FMTLIST+10                                               02871000
ERCNVTAB EQU   0                                                        02872000
ERTYPE   EQU   ERCNVTAB                                                 02873000
EROPER   EQU   ERCNVTAB+1                                               02874000
EROSOPER EQU   ERCNVTAB+2                                               02875000
IDCDB010 EQU   0                                                        02876000
DMPITM   EQU   0                                                        02877000
DMPARY   EQU   0                                                        02878000
PCTTAB   EQU   0                                                        02879000
PCTIDN   EQU   PCTTAB                                                   02880000
PCTFLG   EQU   PCTTAB+4                                                 02881000
PCTAPF   EQU   PCTFLG                                                   02882000
PCTSPP   EQU   PCTTAB+8                                                 02883000
PCTACT   EQU   PCTTAB+12                                                02884000
PCTIOC   EQU   PCTACT                                                   02885000
PCTAPL   EQU   PCTACT+4                                                 02886000
PCTCPN   EQU   PCTAPL                                                   02887000
PCTNLI   EQU   PCTAPL+2                                                 02888000
PCTSTD   EQU   PCTTAB+20                                                02889000
PCTSPL   EQU   PCTSTD+4                                                 02890000
PCTSNL   EQU   PCTSPL+2                                                 02891000
PCTALT   EQU   PCTTAB+28                                                02892000
PCTLPL   EQU   PCTALT+4                                                 02893000
PCTANL   EQU   PCTLPL+2                                                 02894000
PCTSTM   EQU   PCTTAB+36                                                02895000
PCTSME   EQU   PCTTAB+44                                                02896000
PCTSQP   EQU   PCTTAB+48                                                02897000
PCTAHP   EQU   PCTTAB+52                                                02898000
PCTMLP   EQU   PCTTAB+56                                                02899000
PCTSLP   EQU   PCTTAB+60                                                02900000
PCTTRP   EQU   PCTTAB+64                                                02901000
PCTPLW   EQU   PCTTAB+68                                                02902000
PCTSLC   EQU   PCTTAB+74                                                02903000
PCTFLP   EQU   PCTTAB+76                                                02904000
PCTFLC   EQU   PCTTAB+80                                                02905000
PCTPNL   EQU   PCTTAB+84                                                02906000
PCTPPD   EQU   PCTTAB+90                                                02907000
PCTDSC   EQU   PCTTAB+92                                                02908000
PCTPNI   EQU   PCTTAB+94                                                02909000
PCTFDL   EQU   PCTTAB+96                                                02910000
PCTLDL   EQU   PCTTAB+98                                                02911000
PCTFLN   EQU   PCTTAB+100                                               02912000
PCTLNM   EQU   PCTTAB+102                                               02913000
PCTBUF   EQU   PCTTAB+104                                               02914000
PCTBNL   EQU   PCTTAB+108                                               02915000
MTLINE   EQU   0                                                        02916000
MTLCC    EQU   MTLINE                                                   02917000
MTLBUFF  EQU   MTLINE+1                                                 02918000
MTINL    EQU   0                                                        02919000
MTLINBF  EQU   MTINL+1                                                  02920000
STLINE   EQU   0                                                        02921000
STLCC    EQU   STLINE                                                   02922000
FTLINE   EQU   0                                                        02923000
FTLCC    EQU   FTLINE                                                   02924000
PCA      EQU   0                                                        02925000
PCMTLP   EQU   PCA                                                      02926000
PCSTLP   EQU   PCA+4                                                    02927000
PCFLP    EQU   PCA+8                                                    02928000
PCPCP    EQU   PCA+12                                                   02929000
PCPNL    EQU   PCA+16                                                   02930000
PCPTL    EQU   PCA+18                                                   02931000
PCPDL    EQU   PCA+20                                                   02932000
PCMTLC   EQU   PCA+22                                                   02933000
PCSTLC   EQU   PCA+24                                                   02934000
PCFLC    EQU   PCA+26                                                   02935000
PCLW     EQU   PCA+28                                                   02936000
PCPD     EQU   PCA+30                                                   02937000
PCDSC    EQU   PCA+32                                                   02938000
PCR      EQU   0                                                        02939000
PCRTYP   EQU   PCR                                                      02940000
PCRLC    EQU   PCR+2                                                    02941000
PCRPTR   EQU   PCR+4                                                    02942000
TTDSN    EQU   0                                                        02943000
PGNOIN   EQU   0                                                        02944000
PGNOLIN  EQU   PGNOIN                                                   02945000
PGNOCIN  EQU   PGNOIN+2                                                 02946000
PGNO     EQU   0                                                        02947000
PGNOL    EQU   PGNO                                                     02948000
PGNOC    EQU   PGNO+2                                                   02949000
AMSTP011 EQU   0                                                        02950000
AMSTP041 EQU   0                                                        02951000
AMSTP042 EQU   0                                                        02952000
AMSTP043 EQU   0                                                        02953000
AMSTP044 EQU   0                                                        02954000
DMPTRM   EQU   0                                                        02955000
IDCIOCL0 EQU   0                                                        02956000
IDCIOCO0 EQU   0                                                        02957000
IDCIOGT0 EQU   0                                                        02958000
IDCIOIT0 EQU   0                                                        02959000
IDCIOPO0 EQU   0                                                        02960000
IDCIOSI0 EQU   0                                                        02961000
IDCIOST0 EQU   0                                                        02962000
IDCIOTM0 EQU   0                                                        02963000
IDCIOVY0 EQU   0                                                        02964000
IDCIO050 EQU   0                                                        02965000
IDCSAAL0 EQU   0                                                        02966000
IDCSACA0 EQU   0                                                        02967000
IDCSACL0 EQU   0                                                        02968000
IDCSACR0 EQU   0                                                        02969000
IDCSADE0 EQU   0                                                        02970000
IDCSADL0 EQU   0                                                        02971000
IDCSADQ0 EQU   0                                                        02972000
IDCSAID0 EQU   0                                                        02973000
IDCSALC0 EQU   0                                                        02974000
IDCSALK0 EQU   0                                                        02975000
IDCSANQ0 EQU   0                                                        02976000
IDCSAPR0 EQU   0                                                        02977000
IDCSAPT0 EQU   0                                                        02978000
IDCSAQL0 EQU   0                                                        02979000
IDCSARC0 EQU   0                                                        02980000
IDCSARV0 EQU   0                                                        02981000
IDCSASC0 EQU   0                                                        02982000
IDCSASI0 EQU   0                                                        02983000
IDCSASN0 EQU   0                                                        02984000
IDCSASS0 EQU   0                                                        02985000
IDCSAST0 EQU   0                                                        02986000
IDCSAUC0 EQU   0                                                        02987000
IDCSAWO0 EQU   0                                                        02988000
IDCSA060 EQU   0                                                        02989000
IDCST010 EQU   0                                                        02990000
IDCTPER0 EQU   0                                                        02991000
NEWERID1 EQU   5                                                        02992000
TRANTAB  EQU   0                                                        02993000
GDTTBLX  EQU   0                                                        02994000
FILENAME EQU   0                                                        02995000
ARG1     EQU   0                                                        02996000
ARG2     EQU   0                                                        02997000
ARG3     EQU   0                                                        02998000
ARG4     EQU   0                                                        02999000
ARG5     EQU   0                                                        03000000
ARG6     EQU   0                                                        03001000
ARG7     EQU   0                                                        03002000
STIDS    EQU   0                                                        03003000
PCALIST  EQU   0                                                        03004000
PGNOPTR  EQU   0                                                        03005000
PCRLCC   EQU   PCRLC                                                    03006000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03007000
FTBUFF   EQU   FTLINE+1                                                 03008000
STLBUFF  EQU   STLINE+1                                                 03009000
MTLINCC  EQU   MTINL                                                    03010000
PCTAPC   EQU   PCTTAB+88                                                03011000
PCTPMN   EQU   PCTTAB+86                                                03012000
PCTHSC   EQU   PCTTAB+83                                                03013000
PCTHLC   EQU   PCTTAB+82                                                03014000
PCTMLC   EQU   PCTTAB+72                                                03015000
PCTAPN   EQU   PCTLPL                                                   03016000
PCTIOP   EQU   PCTALT                                                   03017000
PCTSPN   EQU   PCTSPL                                                   03018000
PCTIOS   EQU   PCTSTD                                                   03019000
@NM00038 EQU   PCTFLG                                                   03020000
PCTLLM   EQU   PCTFLG                                                   03021000
PCTHAF   EQU   PCTFLG                                                   03022000
PCTH2F   EQU   PCTFLG                                                   03023000
PCTH1F   EQU   PCTFLG                                                   03024000
@NM00037 EQU   DMPARY+15                                                03025000
DMPARYTP EQU   DMPARY+14                                                03026000
DMPARYEX EQU   DMPARY+12                                                03027000
DMPARYIC EQU   DMPARY+10                                                03028000
DMPARYSZ EQU   DMPARY+8                                                 03029000
DMPARYNM EQU   DMPARY                                                   03030000
@NM00036 EQU   DMPITM+15                                                03031000
DMPITMTP EQU   DMPITM+14                                                03032000
DMPITMLN EQU   DMPITM+12                                                03033000
DMPITMPT EQU   DMPITM+8                                                 03034000
DMPITMNM EQU   DMPITM                                                   03035000
@NM00035 EQU   ERCNVTAB+24                                              03036000
ERCPLPT  EQU   ERCNVTAB+20                                              03037000
ERCATRC  EQU   ERCNVTAB+16                                              03038000
ERDSNM   EQU   ERCNVTAB+12                                              03039000
@NM00034 EQU   ERCNVTAB+4                                               03040000
@NM00033 EQU   ERCNVTAB+3                                               03041000
@NM00032 EQU   EROSOPER                                                 03042000
EROSUCDX EQU   EROSOPER                                                 03043000
EROSCATL EQU   EROSOPER                                                 03044000
@NM00031 EQU   EROPER                                                   03045000
ERCATAL  EQU   EROPER                                                   03046000
ERCATDL  EQU   EROPER                                                   03047000
ERCATDE  EQU   EROPER                                                   03048000
ERCATLC  EQU   EROPER                                                   03049000
@NM00030 EQU   ERTYPE                                                   03050000
EROSCAT  EQU   ERTYPE                                                   03051000
ERCATLG  EQU   ERTYPE                                                   03052000
@NM00029 EQU   FMTCNVF+1                                                03053000
FMTAR    EQU   FMTCNVF+1                                                03054000
FMTBS    EQU   FMTCNVF+1                                                03055000
FMTSS    EQU   FMTCNVF+1                                                03056000
FMTAL    EQU   FMTCNVF+1                                                03057000
FMTZS    EQU   FMTCNVF+1                                                03058000
@NM00028 EQU   FMTCNVF                                                  03059000
FMTPU    EQU   FMTCNVF                                                  03060000
FMTBD    EQU   FMTCNVF                                                  03061000
FMTBHD   EQU   FMTCNVF                                                  03062000
FMTBHA   EQU   FMTCNVF                                                  03063000
FMTBH    EQU   FMTCNVF                                                  03064000
FMTOLEN  EQU   FMTLIST+8                                                03065000
FMTRIO   EQU   FMTOCOL                                                  03066000
FMTSPT   EQU   FMTSTO                                                   03067000
FMTSTL   EQU   FMTILEN                                                  03068000
@NM00027 EQU   FMTFLGS+1                                                03069000
FMTHDF   EQU   FMTFLGS                                                  03070000
FMTDFF   EQU   FMTFLGS                                                  03071000
FMTSTF   EQU   FMTFLGS                                                  03072000
FMTREPF  EQU   FMTFLGS                                                  03073000
FMTBDF   EQU   FMTFLGS                                                  03074000
FMTIDF   EQU   FMTFLGS                                                  03075000
FMTSCF   EQU   FMTFLGS                                                  03076000
FMTEOLF  EQU   FMTFLGS                                                  03077000
DARGDTM  EQU   DARGARY+4                                                03078000
DARGPCT  EQU   DARGINL                                                  03079000
DARGREP  EQU   DARGINS                                                  03080000
@NM00026 EQU   DARGLIST+19                                              03081000
DARGIND  EQU   DARGLIST+18                                              03082000
DARGRETL EQU   DARGLIST+16                                              03083000
DARGCNT  EQU   DARGLIST+14                                              03084000
DARGILP  EQU   DARGLIST+12                                              03085000
DARGSENT EQU   DARGSTID+3                                               03086000
DARGSMOD EQU   DARGSTID                                                 03087000
DARGRETP EQU   DARGLIST+4                                               03088000
DARGDBP  EQU   DARGLIST                                                 03089000
UVOLVOL  EQU   UVOLENT+4                                                03090000
UVOLDEV  EQU   UVOLENT                                                  03091000
UVOLCNT  EQU   UVOLLIST                                                 03092000
@NM00025 EQU   IOINFOPT                                                 03093000
IOINFTMS EQU   IOINFOPT                                                 03094000
IOINFSUP EQU   IOINFOPT                                                 03095000
IOINFDSN EQU   IOINFOPT                                                 03096000
IOINFVOL EQU   IOINFOPT                                                 03097000
IOINFDVT EQU   IOINFOPT                                                 03098000
OPNVOL   EQU   OPNAGL+44                                                03099000
@NM00024 EQU   OPNAGL+43                                                03100000
@NM00023 EQU   OPNOPT2                                                  03101000
OPNOPTJM EQU   OPNOPT2                                                  03102000
@NM00022 EQU   OPNOPT2                                                  03103000
OPNOPTAS EQU   OPNOPT2                                                  03104000
@NM00021 EQU   OPNDSO                                                   03105000
OPNDSOPO EQU   OPNDSO                                                   03106000
OPNDSOIS EQU   OPNDSO                                                   03107000
OPNDSOPS EQU   OPNDSO                                                   03108000
OPNDSOAM EQU   OPNDSO                                                   03109000
OPNKYL   EQU   OPNAGL+40                                                03110000
OPNBLK   EQU   OPNAGL+36                                                03111000
OPNREC   EQU   OPNAGL+32                                                03112000
OPNDEVIX EQU   OPNDEV+4                                                 03113000
OPNDEVDT EQU   OPNDEV                                                   03114000
OPNCBP   EQU   OPNAGL+20                                                03115000
OPNDSN   EQU   OPNAGL+16                                                03116000
OPNPWA   EQU   OPNAGL+12                                                03117000
OPNDDN   EQU   OPNAGL+8                                                 03118000
OPNMODRP EQU   OPNMOD                                                   03119000
OPNMODUB EQU   OPNMOD                                                   03120000
OPNMODRS EQU   OPNMOD                                                   03121000
OPNMODAX EQU   OPNMOD                                                   03122000
OPNMODRR EQU   OPNMOD                                                   03123000
OPNMODRC EQU   OPNMOD                                                   03124000
OPNMODPD EQU   OPNMOD                                                   03125000
@NM00020 EQU   OPNTYP                                                   03126000
OPNTYPRV EQU   OPNTYP                                                   03127000
OPNTYPEX EQU   OPNTYP                                                   03128000
OPNTYPRA EQU   OPNTYP                                                   03129000
OPNTYPXM EQU   OPNTYP                                                   03130000
OPNTYPCI EQU   OPNTYP                                                   03131000
OPNTYPSI EQU   OPNTYP                                                   03132000
@NM00019 EQU   OPNRFM                                                   03133000
OPNRFMBK EQU   OPNRFM                                                   03134000
OPNRFMSF EQU   OPNRFM                                                   03135000
OPNRFMUN EQU   OPNRFM                                                   03136000
OPNRFMVR EQU   OPNRFM                                                   03137000
OPNRFMFX EQU   OPNRFM                                                   03138000
OPNOPTSK EQU   OPNOPT                                                   03139000
OPNOPTDR EQU   OPNOPT                                                   03140000
OPNOPTCR EQU   OPNOPT                                                   03141000
OPNOPTKS EQU   OPNOPT                                                   03142000
OPNOPTBK EQU   OPNOPT                                                   03143000
OPNOPTUP EQU   OPNOPT                                                   03144000
OPNOPTOT EQU   OPNOPT                                                   03145000
OPNOPTIN EQU   OPNOPT                                                   03146000
IOCEXT   EQU   IOCSTR+64                                                03147000
IOCREL   EQU   IOCSTR+60                                                03148000
IOCWORK  EQU   IOCSTR+56                                                03149000
IOCRRN   EQU   IOCSTR+52                                                03150000
IOCPTL   EQU   IOCNWM                                                   03151000
IOCKYA   EQU   IOCMEM                                                   03152000
IOCVRC   EQU   IOCTTR                                                   03153000
IOCCBP   EQU   IOCSTR+36                                                03154000
IOCDSN   EQU   IOCSTR+32                                                03155000
IOCHURBA EQU   IOCSTR+28                                                03156000
IOCVOLSR EQU   IOCSTR+22                                                03157000
@NM00018 EQU   IOCMSG                                                   03158000
IOCMSGAE EQU   IOCMSG                                                   03159000
IOCMSGCE EQU   IOCMSG                                                   03160000
IOCMSGOE EQU   IOCMSG                                                   03161000
IOCMSGOP EQU   IOCMSG                                                   03162000
@NM00017 EQU   IOCMSG                                                   03163000
IOCCHPSY EQU   IOCCHP                                                   03164000
IOCCHPAS EQU   IOCCHP                                                   03165000
IOCCHPBK EQU   IOCCHP                                                   03166000
IOCCHPCR EQU   IOCCHP                                                   03167000
IOCCHPKS EQU   IOCCHP                                                   03168000
IOCCHPSK EQU   IOCCHP                                                   03169000
IOCCHPDR EQU   IOCCHP                                                   03170000
IOCCHPSQ EQU   IOCCHP                                                   03171000
@NM00016 EQU   IOCMAC2                                                  03172000
IOCMACPA EQU   IOCMAC2                                                  03173000
@NM00015 EQU   IOCMAC2                                                  03174000
IOCMACCP EQU   IOCMAC2                                                  03175000
IOCMACRR EQU   IOCMAC2                                                  03176000
IOCMACAS EQU   IOCMAC2                                                  03177000
IOCMACSK EQU   IOCMAC2                                                  03178000
@NM00014 EQU   IOCMAC                                                   03179000
IOCMACCC EQU   IOCMAC                                                   03180000
IOCMACDR EQU   IOCMAC                                                   03181000
IOCMACBK EQU   IOCMAC                                                   03182000
IOCMACCR EQU   IOCMAC                                                   03183000
IOCMACUP EQU   IOCMAC                                                   03184000
IOCMACOT EQU   IOCMAC                                                   03185000
IOCMACIN EQU   IOCMAC                                                   03186000
@NM00013 EQU   IOCRFM                                                   03187000
IOCRFMBK EQU   IOCRFM                                                   03188000
IOCRFMSF EQU   IOCRFM                                                   03189000
IOCRFMUN EQU   IOCRFM                                                   03190000
IOCRFMVR EQU   IOCRFM                                                   03191000
IOCRFMFX EQU   IOCRFM                                                   03192000
@NM00012 EQU   IOCDSO                                                   03193000
IOCDSOPO EQU   IOCDSO                                                   03194000
IOCDSOIS EQU   IOCDSO                                                   03195000
IOCDSOPS EQU   IOCDSO                                                   03196000
IOCDSOAM EQU   IOCDSO                                                   03197000
IOCRKP   EQU   IOCSTR+13                                                03198000
IOCKYL   EQU   IOCSTR+12                                                03199000
IOCTRN   EQU   IOCSTR+8                                                 03200000
UNITVTOC EQU   UNITABL+7                                                03201000
@NM00011 EQU   UNITSTAT                                                 03202000
UNITUSHR EQU   UNITSTAT                                                 03203000
UNITXSHR EQU   UNITSTAT                                                 03204000
UNITISHR EQU   UNITSTAT                                                 03205000
UNITUA   EQU   @NM00010+1                                               03206000
UNITCHA  EQU   @NM00010                                                 03207000
UNITUCB  EQU   UNITABL                                                  03208000
ALLUNCNT EQU   ALLAGL+30                                                03209000
ALLVLCNT EQU   ALLAGL+29                                                03210000
@NM00009 EQU   ALLOPT                                                   03211000
ALLOPTUN EQU   ALLOPT                                                   03212000
ALLOPTPV EQU   ALLOPT                                                   03213000
ALLOPTDS EQU   ALLOPT                                                   03214000
ALLOPTVL EQU   ALLOPT                                                   03215000
@NM00008 EQU   ALLORG+1                                                 03216000
ALLORGVS EQU   ALLORG+1                                                 03217000
@NM00007 EQU   ALLORG+1                                                 03218000
ALLORGGS EQU   ALLORG+1                                                 03219000
ALLORGUN EQU   ALLORG                                                   03220000
ALLORGPO EQU   ALLORG                                                   03221000
ALLORGMQ EQU   ALLORG                                                   03222000
ALLORGCQ EQU   ALLORG                                                   03223000
ALLORGCX EQU   ALLORG                                                   03224000
ALLORGDA EQU   ALLORG                                                   03225000
ALLORGPS EQU   ALLORG                                                   03226000
ALLORGIS EQU   ALLORG                                                   03227000
ALLDSPUN EQU   ALLDSP                                                   03228000
ALLDSPCG EQU   ALLDSP                                                   03229000
ALLDSPDE EQU   ALLDSP                                                   03230000
ALLDSPKP EQU   ALLDSP                                                   03231000
@NM00006 EQU   ALLDSP                                                   03232000
ALLSTSOD EQU   ALLSTS                                                   03233000
ALLSTSMD EQU   ALLSTS                                                   03234000
ALLSTSNW EQU   ALLSTS                                                   03235000
ALLSTSSR EQU   ALLSTS                                                   03236000
@NM00005 EQU   ALLSTS                                                   03237000
ALLPWD   EQU   ALLAGL+20                                                03238000
ALLVLP   EQU   ALLAGL+16                                                03239000
ALLULP   EQU   ALLAGL+12                                                03240000
ALLDDN   EQU   ALLAGL+4                                                 03241000
ALLDSN   EQU   ALLAGL                                                   03242000
CIRPID   EQU   CIRAGL+28                                                03243000
CIRPWD   EQU   CIRAGL+24                                                03244000
CIRCAT   EQU   CIRAGL+20                                                03245000
CIRWKP   EQU   CIRAGL+16                                                03246000
CIRTLR   EQU   CIRAGL+12                                                03247000
CIRHDR   EQU   CIRAGL+8                                                 03248000
CIRTLN   EQU   CIRAGL+6                                                 03249000
CIRHLN   EQU   CIRAGL+4                                                 03250000
@NM00004 EQU   CIRAGL+1                                                 03251000
@NM00003 EQU   CIRTYPE                                                  03252000
CIRTYPAQ EQU   CIRTYPE                                                  03253000
CIRTYP1Q EQU   CIRTYPE                                                  03254000
NEWID1   EQU   TRACE1+95                                                03255000
CALLID   EQU   OLDERID1+90                                              03256000
@NM00002 EQU   OLDERID1                                                 03257000
GDTECT   EQU   GDTTBL+188                                               03258000
GDTPSB   EQU   GDTTBL+184                                               03259000
GDTUPT   EQU   GDTTBL+180                                               03260000
GDTCMB   EQU   GDTTBL+176                                               03261000
GDTSPR   EQU   GDTTBL+168                                               03262000
@NM00001 EQU   GDTTBL+160                                               03263000
GDTTOH   EQU   GDTTBL+120                                               03264000
GDTRIP   EQU   GDTTBL+116                                               03265000
GDTIOH   EQU   GDTTBL+36                                                03266000
GDTSAH   EQU   GDTTBL+32                                                03267000
GDTRIH   EQU   GDTTBL+24                                                03268000
GDTSTH   EQU   GDTTBL+20                                                03269000
GDTDBH   EQU   GDTTBL+16                                                03270000
GDTPRM   EQU   GDTTBL+4                                                 03271000
GDTHDR   EQU   GDTTBL                                                   03272000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03273000
@RF00493 EQU   @RC00487                                                 03274000
@RC00681 EQU   @EL00008                                                 03275000
@PB00009 EQU   @EL00001                                                 03276000
@PB00008 EQU   @PB00009                                                 03277000
@PB00007 EQU   @PB00008                                                 03278000
@PB00006 EQU   @PB00007                                                 03279000
@PB00005 EQU   @PB00006                                                 03280000
@PB00004 EQU   @PB00005                                                 03281000
@PB00003 EQU   @PB00004                                                 03282000
@PB00002 EQU   @PB00003                                                 03283000
@ENDDATA EQU   *                                                        03284000
         END   IDCTP04,(C'PLS2203',0701,76278)                          03285000
