         TITLE '********** IDCTR01-  TRACE FUNCTION SUPPORT ROUTINE  ***00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCTR01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCTR01   77.132'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @11,0                                               0002 00021000
@PSTART  LA    @12,4095(,@11)                                      0002 00022000
         USING @PSTART,@11                                         0002 00023000
         USING @PSTART+4095,@12                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @10,@01                                             0002 00027000
         USING @DATD,@10                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @10,8(,@13)                                         0002 00031000
         LR    @13,@10                                             0002 00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*                                                                  0302 00034000
*/*  *****************************************************   @Y30LB01*/ 00035000
*/*                                                          @Y30LB01*/ 00036000
*/*     TRACE MAINLINE ROUTINE                               @Y30LB01*/ 00037000
*/*                                                          @Y30LB01*/ 00038000
*/*     MESSAGES ISSUED THIS ROUTINE -                       @Y30LB01*/ 00039000
*/*                                                          @Y30LB01*/ 00040000
*/*       IDC0001I - FUNCTION SUCCESSFULLY COMPLETED         @Y30LB01*/ 00041000
*/*       IDC3003I - FUNCTION FAILED TO COMPLETE             @Y30LB01*/ 00042000
*/*       IDC3004I - FUNCTION FAILED TO GETMAIN              @Y30LB01*/ 00043000
*/*                                                          @Y30LB01*/ 00044000
*/*  *****************************************************   @Y30LB01*/ 00045000
*                                                                  0302 00046000
*                                   /*                       @Y30LB01*/ 00047000
*   OLDERID2=NEWERID2;                                             0302 00048000
         L     @15,@PC00001                                        0302 00049000
         L     @14,GDTTR2(,@15)                                    0302 00050000
         MVC   @TS00001(95),NEWERID2(@14)                          0302 00051000
         MVC   OLDERID2(95,@14),@TS00001                           0302 00052000
*   NEWID2='TRAA';                  /* SET TRACE ID          @Y30LB01   00053000
*                                                            @Y30LB01*/ 00054000
         MVC   NEWID2(4,@14),@CC01312                              0303 00055000
*   IF GDTDBG=NULLPTR THEN                                         0304 00056000
         L     @15,GDTDBG(,@15)                                    0304 00057000
         LTR   @15,@15                                             0304 00058000
         BZ    @RT00304                                            0304 00059000
*     ;                                                            0305 00060000
*   ELSE                                                           0306 00061000
*     CALL IDCDB010(GDTTBL,'TRAA'); /* DUMP MEMORY           @Y30LB01   00062000
*                                                            @Y30LB01*/ 00063000
         L     @15,@PC00001                                        0306 00064000
         ST    @15,@AL00001                                        0306 00065000
         LA    @14,@CC01312                                        0306 00066000
         ST    @14,@AL00001+4                                      0306 00067000
         MVI   @AL00001+4,X'80'                                    0306 00068000
         L     @15,GDTDBG(,@15)                                    0306 00069000
         LA    @01,@AL00001                                        0306 00070000
         BALR  @14,@15                                             0306 00071000
*   DDSTRU=ADDR(PRINTTAB);          /* SET UPRINT AREA PTR   @Y30LB01*/ 00072000
@RT00304 LA    @15,PRINTTAB                                        0307 00073000
         ST    @15,DDSTRU                                          0307 00074000
*   SWITCHES=''B;                   /* CLEAR INTERNAL SW-S   @Y30LB01*/ 00075000
*                                                                  0308 00076000
         MVI   SWITCHES,X'00'                                      0308 00077000
*   /*****************************************************************/ 00078000
*   /*                                                               */ 00079000
*   /* IF REQUEST IS FOR TRACE ON OR TRACE OFF THEN          @Y30LB01*/ 00080000
*   /* A CALL WILL BE MADE TO TRACESET PROC                  @Y30LB01*/ 00081000
*   /*                                                               */ 00082000
*   /*****************************************************************/ 00083000
*                                                                  0309 00084000
*   IF ADDR(ZXON)^=NULLPTR|         /* TRACE ON REQUESTED    @Y30LB01*/ 00085000
*       ADDR(ZXOFF)^=NULLPTR THEN   /* TRACE OFF REQUESTED   @Y30LB01*/ 00086000
         SLR   @15,@15                                             0309 00087000
         L     @14,@PC00001+4                                      0309 00088000
         C     @15,FDTPTR(,@14)                                    0309 00089000
         BNE   @RT00309                                            0309 00090000
         C     @15,FDTPTR+4(,@14)                                  0309 00091000
         BE    @RF00309                                            0309 00092000
@RT00309 DS    0H                                                  0310 00093000
*     DO;                           /* STOP REQUEST. CALL    @Y30LB01*/ 00094000
*       CALL TRACESET;              /* TRACESET SUBROUTINE   @Y30LB01*/ 00095000
         BAL   @14,TRACESET                                        0311 00096000
*       RESPECIFY                                                  0312 00097000
*         RTNREG RSTD;                                             0312 00098000
*       TESTRC=RTNREG;                                             0313 00099000
         STH   RTNREG,TESTRC                                       0313 00100000
*       RESPECIFY                                                  0314 00101000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01*/ 00102000
*     END;                          /* END TRACE SET CALL    @Y30LB01*/ 00103000
*                                                                  0315 00104000
*   /*****************************************************************/ 00105000
*   /*                                                               */ 00106000
*   /* IF REQUEST WAS FOR TRACE DUMP THIS CODE WILL BE       @Y30LB01*/ 00107000
*   /* EXECUTED WHICH MAKES CALL TO TRACEDMP PROC.           @Y30LB01*/ 00108000
*   /*                                                               */ 00109000
*   /*****************************************************************/ 00110000
*                                                                  0316 00111000
*   ELSE                            /* TRACE DUMP            @Y30LB01*/ 00112000
*     DO;                           /* FUNCTION              @Y30LB01*/ 00113000
         B     @RC00309                                            0316 00114000
@RF00309 DS    0H                                                  0317 00115000
*       CALL TRACEDMP;              /* DUMP TRACE SUBROUTINE @Y30LB01*/ 00116000
         BAL   @14,TRACEDMP                                        0317 00117000
*       RESPECIFY                                                  0318 00118000
*         RTNREG RSTD;                                             0318 00119000
*       TESTRC=RTNREG;                                             0319 00120000
         STH   RTNREG,TESTRC                                       0319 00121000
*       RESPECIFY                                                  0320 00122000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01*/ 00123000
*     END;                          /* END TRACE DUMP CALL   @Y30LB01   00124000
*                                                            @Y30LB01*/ 00125000
*                                                                  0321 00126000
*   /*****************************************************************/ 00127000
*   /*                                                               */ 00128000
*   /* SET UP PARAMETERS FOR UPRINT                          @Y30LB01*/ 00129000
*   /* UPRINT MESSAGE IDC0001I FOR LASTCOND < 12             @Y30LB01*/ 00130000
*   /* UPRINT MESSAGE IDC3003I FOR LASTCOND >= 12            @Y30LB01*/ 00131000
*   /* UPRINT MESSAGE IDC3004I FOR GETMAIN FAILURE           @Y30LB01*/ 00132000
*   /*                                                               */ 00133000
*   /*****************************************************************/ 00134000
*                                                                  0322 00135000
*                                   /*                       @Y30LB01*/ 00136000
*   DDSTRU=ADDR(PRINTTAB);          /* UPRINT PARM LIST      @Y30LB01*/ 00137000
@RC00309 LA    @15,PRINTTAB                                        0322 00138000
         ST    @15,DDSTRU                                          0322 00139000
*   PRINTTAB=''B;                   /* NULL PARM LIST AREA   @Y30LB01*/ 00140000
*                                                                  0323 00141000
         XC    PRINTTAB(20),PRINTTAB                               0323 00142000
*   /*****************************************************************/ 00143000
*   /*                                                               */ 00144000
*   /* IF A TERMINAL ERROR IS RECEIVED AND THE GET MAIN      @Y30LB01*/ 00145000
*   /* FAIL SWITCH IS SET THEN UPRINT IDC3004I MSG           @Y30LB01*/ 00146000
*   /*                                                               */ 00147000
*   /*****************************************************************/ 00148000
*                                                                  0324 00149000
*   IF LASTCOND>=LASTCC12&          /* BAD RETURN            @Y30LB01*/ 00150000
*       GMAINF=ON THEN              /* GETMAIN FAILURE       @Y30LB01*/ 00151000
         L     @14,@PC00001+8                                      0324 00152000
         LH    @14,LASTCOND(,@14)                                  0324 00153000
         C     @14,@CF00567                                        0324 00154000
         BL    @RF00324                                            0324 00155000
         TM    GMAINF,B'10000000'                                  0324 00156000
         BNO   @RF00324                                            0324 00157000
*     DARGSENT=MSG3004I;            /* MESSAGE UV04          @Y30LB01*/ 00158000
*                                                                  0325 00159000
         MVI   DARGSENT(@15),X'04'                                 0325 00160000
*   /*****************************************************************/ 00161000
*   /*                                                               */ 00162000
*   /* TERMINAL ERROR BUT NOT DUE TO GET MAIN FAILURE,       @Y30LB01*/ 00163000
*   /* THEN UPRINT IDC3003I MSG.                             @Y30LB01*/ 00164000
*   /*                                                               */ 00165000
*   /*****************************************************************/ 00166000
*                                                                  0326 00167000
*   ELSE                            /* FUNCTION              @Y30LB01*/ 00168000
*     IF LASTCOND>=LASTCC12 THEN    /* NON GETMAIN FAILURE   @Y30LB01*/ 00169000
         B     @RC00324                                            0326 00170000
@RF00324 L     @15,@PC00001+8                                      0326 00171000
         LH    @15,LASTCOND(,@15)                                  0326 00172000
         C     @15,@CF00567                                        0326 00173000
         BL    @RF00326                                            0326 00174000
*       DARGSENT=MSG3003I;          /* MESSAGE UV03          @Y30LB01*/ 00175000
*                                                                  0327 00176000
         L     @01,DDSTRU                                          0327 00177000
         MVI   DARGSENT(@01),X'03'                                 0327 00178000
*   /*****************************************************************/ 00179000
*   /*                                                               */ 00180000
*   /* RETURN NOT TERMINAL THEN UPRINT IDC0001I MSG.         @Y30LB01*/ 00181000
*   /*                                                               */ 00182000
*   /*****************************************************************/ 00183000
*                                                                  0328 00184000
*     ELSE                          /* FUNCTION COMPLETED    @Y30LB01*/ 00185000
*       DARGSENT=MSG0001I;          /* FAILED                @Y30LB01*/ 00186000
         B     @RC00326                                            0328 00187000
@RF00326 L     @01,DDSTRU                                          0328 00188000
         MVI   DARGSENT(@01),X'01'                                 0328 00189000
*   DARGSMOD=UNIVMSG;               /* MESSAGE MODULE ID     @Y30LB01*/ 00190000
@RC00326 DS    0H                                                  0329 00191000
@RC00324 L     @15,DDSTRU                                          0329 00192000
         MVC   DARGSMOD(3,@15),@CC01276                            0329 00193000
*   DARGDBP=ADDR(LASTCOND);         /* PTR TO INSERT         @Y30LB01*/ 00194000
         L     @14,@PC00001+8                                      0330 00195000
         ST    @14,DARGDBP(,@15)                                   0330 00196000
*   DARGILP=LENGTH(LASTCOND);       /* LENGTH OF INSERT      @Y30LB01   00197000
*                                                            @Y30LB01*/ 00198000
*                                                                  0331 00199000
         MVC   DARGILP(2,@15),@CH00153                             0331 00200000
*   /*****************************************************************/ 00201000
*   /*                                                               */ 00202000
*   /* UPRINT CALL TO PRINT MESSAGE                          @Y30LB01*/ 00203000
*   /*                                                               */ 00204000
*   /*****************************************************************/ 00205000
*                                                                  0332 00206000
*   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* PRINT MESSAGE    @Y30LB01   00207000
*                                                            @Y30LB01*/ 00208000
*                                                                  0332 00209000
         L     @15,@PC00001                                        0332 00210000
         ST    @15,@AL00001                                        0332 00211000
         LA    @14,@CF00115                                        0332 00212000
         ST    @14,@AL00001+4                                      0332 00213000
         LA    @14,DDSTRU                                          0332 00214000
         ST    @14,@AL00001+8                                      0332 00215000
         MVI   @AL00001+8,X'80'                                    0332 00216000
         L     @15,GDTPRT(,@15)                                    0332 00217000
         LA    @01,@AL00001                                        0332 00218000
         BALR  @14,@15                                             0332 00219000
*   /*****************************************************************/ 00220000
*   /*                                                               */ 00221000
*   /* RETURN TO AMS EXECUTIVE WITH RETURN CODE SET          @Y30LB01*/ 00222000
*   /*                                                               */ 00223000
*   /*****************************************************************/ 00224000
*                                                                  0333 00225000
*                                   /*                       @Y30LB01*/ 00226000
*                                                                  0333 00227000
*   /*****************************************************************/ 00228000
*   /*                                                               */ 00229000
*   /* UDUMP CALL TO DIAGNOSTIC DUMP REGION                  @Y30LB01*/ 00230000
*   /*                                                               */ 00231000
*   /*****************************************************************/ 00232000
*                                                                  0333 00233000
*   IF GDTDBG=NULLPTR THEN                                         0333 00234000
         L     @15,@PC00001                                        0333 00235000
         L     @15,GDTDBG(,@15)                                    0333 00236000
         LTR   @15,@15                                             0333 00237000
         BZ    @RT00333                                            0333 00238000
*     ;                                                            0334 00239000
*   ELSE                                                           0335 00240000
*     CALL IDCDB010(GDTTBL,'TRAZ'); /* DUMP MEMORY           @Y30LB01   00241000
*                                      AT EXIT               @Y30LB01*/ 00242000
*                                                                  0335 00243000
         L     @15,@PC00001                                        0335 00244000
         ST    @15,@AL00001                                        0335 00245000
         LA    @14,@CC01316                                        0335 00246000
         ST    @14,@AL00001+4                                      0335 00247000
         MVI   @AL00001+4,X'80'                                    0335 00248000
         L     @15,GDTDBG(,@15)                                    0335 00249000
         LA    @01,@AL00001                                        0335 00250000
         BALR  @14,@15                                             0335 00251000
*   /*****************************************************************/ 00252000
*   /*                                                               */ 00253000
*   /* UEPIL MACRO                                           @Y30LB01*/ 00254000
*   /*                                                               */ 00255000
*   /*****************************************************************/ 00256000
*                                                                  0336 00257000
*   CALL IDCSAEP0(GDTTBL,MODID,LASTCOND);/* RETURN TO CALLER @Y30LB01*/ 00258000
@RT00333 L     @15,@PC00001                                        0336 00259000
         ST    @15,@AL00001                                        0336 00260000
         LA    @14,MODID                                           0336 00261000
         ST    @14,@AL00001+4                                      0336 00262000
         L     @14,@PC00001+8                                      0336 00263000
         ST    @14,@AL00001+8                                      0336 00264000
         MVI   @AL00001+8,X'80'                                    0336 00265000
         L     @15,GDTEPL(,@15)                                    0336 00266000
         LA    @01,@AL00001                                        0336 00267000
         BALR  @14,@15                                             0336 00268000
*                                                                  0337 00269000
*/*******************************************************    @Y30LB01*/ 00270000
*/*                                                          @Y30LB01*/ 00271000
*/*  PROCEDURE NAME - TRACESET                               @Y30LB01*/ 00272000
*/*                                                          @Y30LB01*/ 00273000
*/*  FUNCTION - USES USSC TO ISSUE ICBTRACE MACRO TO         @Y30LB01*/ 00274000
*/*             ACTIVATE AND DEACTIVATE THE MSC TRACE        @Y30LB01*/ 00275000
*/*             FACILITY.                                    @Y30LB01*/ 00276000
*/*                                                          @Y30LB01*/ 00277000
*/*  INPUT - GDTTBL,FDTTBL                                   @Y30LB01*/ 00278000
*/*                                                          @Y30LB01*/ 00279000
*/*  OUTPUT - LASTCOND = 0 SUCCESSFUL                        @Y30LB01*/ 00280000
*/*           LASTCOND = 4 TRACE ALREADY AS REQUESTED        @Y30LB01*/ 00281000
*/*           LASTCOND = 12 FUNCTION FAILED                  @Y30LB01*/ 00282000
*/*                                                          @Y30LB01*/ 00283000
*/*******************************************************    @Y30LB01*/ 00284000
*                                                                  0337 00285000
*                                   /*                       @Y30LB01*/ 00286000
*TRACESET:                                                         0337 00287000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB01*/ 00288000
@EL00001 L     @13,4(,@13)                                         0337 00289000
@EF00001 L     @00,@SIZDATD                                        0337 00290000
         LR    @01,@10                                             0337 00291000
         FREEMAIN R,LV=(0),A=(1)                                        00292000
@ER00001 LM    @14,@12,12(@13)                                     0337 00293000
         BR    @14                                                 0337 00294000
TRACESET DS    0H                                                  0338 00295000
*                                                                  0338 00296000
*   /*****************************************************************/ 00297000
*   /*                                                               */ 00298000
*   /* SAVE CALLERS RETURN ADDRESS AND SET INTERNAL TRACE    @Y30LB01*/ 00299000
*   /*                                                               */ 00300000
*   /*****************************************************************/ 00301000
*                                                                  0338 00302000
*   RESPECIFY                                                      0338 00303000
*     REG14 RSTD;                   /* RESTRICT REG 14       @Y30LB01*/ 00304000
*   RETADDR=REG14;                  /* SAVE RETURN ADDR      @Y30LB01*/ 00305000
         ST    REG14,RETADDR                                       0339 00306000
*   RESPECIFY                                                      0340 00307000
*     REG14 UNRSTD;                 /* RELEASE REG 14        @Y30LB01*/ 00308000
*   OLDERID2=NEWERID2;                                             0341 00309000
         L     @15,@PC00001                                        0341 00310000
         L     @14,GDTTR2(,@15)                                    0341 00311000
         MVC   @TS00001(95),NEWERID2(@14)                          0341 00312000
         MVC   OLDERID2(95,@14),@TS00001                           0341 00313000
*   NEWID2='TRAC';                  /* SET TRACE ID          @Y30LB01*/ 00314000
*                                                                  0342 00315000
         MVC   NEWID2(4,@14),@CC01320                              0342 00316000
*   /*****************************************************************/ 00317000
*   /*                                                               */ 00318000
*   /* GET TIME DATE FOR ICBTRACE MACRO BY UTIME             @Y30LB01*/ 00319000
*   /*                                                               */ 00320000
*   /*****************************************************************/ 00321000
*                                                                  0343 00322000
*                                   /*                       @Y30LB01*/ 00323000
*   CALL IDCSATI0(GDTTBL,TRTIME,TRDATE,HSECOND);/* GET TIME/DATE   0343 00324000
*                                                            @Y30LB01   00325000
*                                                            @Y30LB01*/ 00326000
*                                                                  0343 00327000
         ST    @15,@AL00001                                        0343 00328000
         LA    @14,TRTIME                                          0343 00329000
         ST    @14,@AL00001+4                                      0343 00330000
         LA    @14,TRDATE                                          0343 00331000
         ST    @14,@AL00001+8                                      0343 00332000
         LA    @14,HSECOND                                         0343 00333000
         ST    @14,@AL00001+12                                     0343 00334000
         MVI   @AL00001+12,X'80'                                   0343 00335000
         L     @15,GDTTIM(,@15)                                    0343 00336000
         LA    @01,@AL00001                                        0343 00337000
         BALR  @14,@15                                             0343 00338000
*   /*****************************************************************/ 00339000
*   /*                                                               */ 00340000
*   /* INITIALIZE THE ICBTRACE PARMS TRACLIST AND DUMP       @Y30LB01*/ 00341000
*   /* THE PARMS BEFORE ISSUING USSC                         @Y30LB01*/ 00342000
*   /*                                                               */ 00343000
*   /*****************************************************************/ 00344000
*                                                                  0344 00345000
*   TRLSTPTR=ADDR(PARMLST);         /* SET PARM PTR          @Y30LB01*/ 00346000
         LA    @15,PARMLST                                         0344 00347000
         ST    @15,TRLSTPTR                                        0344 00348000
*   TRACLIST=''B;                   /* CLEAR LIST            @Y30LB01*/ 00349000
         XC    TRACLIST(16,@15),TRACLIST(@15)                      0345 00350000
*   IF ADDR(ZXOFF)=NULLPTR THEN     /* REQUEST IS TRACE ON   @Y30LB01*/ 00351000
         L     @14,@PC00001+4                                      0346 00352000
         L     @14,FDTPTR+4(,@14)                                  0346 00353000
         LTR   @14,@14                                             0346 00354000
         BNZ   @RF00346                                            0346 00355000
*     TRACEON=ON;                   /* SET ON FLAG           @Y30LB01*/ 00356000
         OI    TRACEON(@15),B'10000000'                            0347 00357000
*   TRACTIM=TRDTETME;               /* SET DATE TIME FIELD   @Y30LB01*/ 00358000
*                                                                  0348 00359000
@RF00346 L     @01,TRLSTPTR                                        0348 00360000
         MVC   TRACTIM(8,@01),TRDTETME                             0348 00361000
*   /*****************************************************************/ 00362000
*   /*                                                               */ 00363000
*   /* USING DMPSTART, DMPITEM, DMPEND MACROS, SET UP        @Y30LB01*/ 00364000
*   /* DUMP PARMS TO DUMP ICBTRACE PARMS.                    @Y30LB01*/ 00365000
*   /*                                                               */ 00366000
*   /*****************************************************************/ 00367000
*                                                                  0349 00368000
*   IF GDTDBG=NULLPTR THEN                                         0349 00369000
         L     @15,@PC00001                                        0349 00370000
         L     @15,GDTDBG(,@15)                                    0349 00371000
         LTR   @15,@15                                             0349 00372000
         BZ    @RT00349                                            0349 00373000
*     ;                                                            0350 00374000
*   ELSE                                                           0351 00375000
*     DO;                                                          0351 00376000
*       DMPINDEX=ADDR(DUMPAREA);    /* ESTABLISH DUMP LIST   @Y30LB01*/ 00377000
         LA    @15,DUMPAREA                                        0352 00378000
         ST    @15,DMPINDEX                                        0352 00379000
*       DMPITMNM='TRACLIST';                                       0353 00380000
         MVC   DMPITMNM(8,@15),@CC01321                            0353 00381000
*       DMPITMPT=ADDR(TRACLIST);                                   0354 00382000
         L     @14,TRLSTPTR                                        0354 00383000
         ST    @14,DMPITMPT(,@15)                                  0354 00384000
*       DMPITMLN=LENGTH(TRACLIST);                                 0355 00385000
         LA    @14,16                                              0355 00386000
         STH   @14,DMPITMLN(,@15)                                  0355 00387000
*       DMPITMTP='H';                                              0356 00388000
         MVI   DMPITMTP(@15),C'H'                                  0356 00389000
*       DMPINDEX=DMPINDEX+DMPELEMT; /* HEX DUMP INDICATOR    @Y30LB01*/ 00390000
         ALR   @15,@14                                             0357 00391000
         ST    @15,DMPINDEX                                        0357 00392000
*       DMPTRM=DMPTRMVL;                                           0358 00393000
         MVI   DMPTRM(@15),X'FF'                                   0358 00394000
*     END;                          /* LIST TERMINATOR       @Y30LB01   00395000
*                                                            @Y30LB01*/ 00396000
*                                                                  0359 00397000
*   /*****************************************************************/ 00398000
*   /*                                                               */ 00399000
*   /* UDUMP CALL TO DIAGNOSTIC DUMP ICBTRACE PARMS          @Y30LB01*/ 00400000
*   /*                                                               */ 00401000
*   /*****************************************************************/ 00402000
*                                                                  0360 00403000
*   IF GDTDBG=NULLPTR THEN                                         0360 00404000
@RT00349 L     @15,@PC00001                                        0360 00405000
         L     @15,GDTDBG(,@15)                                    0360 00406000
         LTR   @15,@15                                             0360 00407000
         BZ    @RT00360                                            0360 00408000
*     ;                                                            0361 00409000
*   ELSE                                                           0362 00410000
*     CALL IDCDB010(GDTTBL,'TRAG',ADDR(DUMPAREA));/* DIAG DUMP     0362 00411000
*                                                            @Y30LB01   00412000
*                                                            @Y30LB01*/ 00413000
*                                                                  0362 00414000
         L     @15,@PC00001                                        0362 00415000
         ST    @15,@AL00001                                        0362 00416000
         LA    @14,@CC01323                                        0362 00417000
         ST    @14,@AL00001+4                                      0362 00418000
         LA    @14,DUMPAREA                                        0362 00419000
         ST    @14,@AFTEMPS                                        0362 00420000
         LA    @14,@AFTEMPS                                        0362 00421000
         ST    @14,@AL00001+8                                      0362 00422000
         MVI   @AL00001+8,X'80'                                    0362 00423000
         L     @15,GDTDBG(,@15)                                    0362 00424000
         LA    @01,@AL00001                                        0362 00425000
         BALR  @14,@15                                             0362 00426000
*   /*****************************************************************/ 00427000
*   /*                                                               */ 00428000
*   /* ISSUE ICBTRACE BY USSC MACRO                          @Y30LB01*/ 00429000
*   /*                                                               */ 00430000
*   /*****************************************************************/ 00431000
*                                                                  0363 00432000
*                                   /*                       @Y30LB01*/ 00433000
*   CALL IDCSASS0(GDTTBL,TRACEQ,TRLSTPTR,REASON);/* EXEC ICBTRACE  0363 00434000
*                                                            @Y30LB01*/ 00435000
@RT00360 L     @15,@PC00001                                        0363 00436000
         ST    @15,@AL00001                                        0363 00437000
         LA    @14,TRACEQ                                          0363 00438000
         ST    @14,@AL00001+4                                      0363 00439000
         LA    @14,TRLSTPTR                                        0363 00440000
         ST    @14,@AL00001+8                                      0363 00441000
         LA    @14,REASON                                          0363 00442000
         ST    @14,@AL00001+12                                     0363 00443000
         MVI   @AL00001+12,X'80'                                   0363 00444000
         L     @15,GDTSSC(,@15)                                    0363 00445000
         LA    @01,@AL00001                                        0363 00446000
         BALR  @14,@15                                             0363 00447000
*   RESPECIFY                                                      0364 00448000
*     RTNREG RSTD;                                                 0364 00449000
*   TESTRC=RTNREG;                                                 0365 00450000
         STH   RTNREG,TESTRC                                       0365 00451000
*   RESPECIFY                                                      0366 00452000
*     RTNREG UNRSTD;                /* SAVE RETURN CODE      @Y30LB01   00453000
*                                                            @Y30LB01*/ 00454000
*                                                                  0366 00455000
*   /*****************************************************************/ 00456000
*   /*                                                               */ 00457000
*   /* TEST RETURN CODE FROM USSC. SET LASTCOND AND IF THE   @Y30LB01*/ 00458000
*   /* ICBTRACE FAILED CALL SSCMSG TO PRINT COMMON REASON    @Y30LB01*/ 00459000
*   /* CODE MESSAGE.                                         @Y30LB01*/ 00460000
*   /*                                                               */ 00461000
*   /*****************************************************************/ 00462000
*                                                                  0367 00463000
*                                   /*                       @Y30LB01*/ 00464000
*   IF TESTRC=4 THEN                /* ICBTRACE FAILED       @Y30LB01*/ 00465000
         LH    @15,TESTRC                                          0367 00466000
         LA    @14,4                                               0367 00467000
         CR    @15,@14                                             0367 00468000
         BNE   @RF00367                                            0367 00469000
*     DO;                           /* SET LASTCOND          @Y30LB01*/ 00470000
*       IF REASID=ASREQ THEN        /* ALREADY AS REQUESTED  @Y30LB01*/ 00471000
         CLI   REASID,127                                          0369 00472000
         BNE   @RF00369                                            0369 00473000
*         LASTCOND=LASTCC04;        /* SET LASTCOND TO 4     @Y30LB01*/ 00474000
         L     @15,@PC00001+8                                      0370 00475000
         STH   @14,LASTCOND(,@15)                                  0370 00476000
*       ELSE                        /* OTHER FAILURE         @Y30LB01*/ 00477000
*         LASTCOND=LASTCC12;        /* SET LASTCOND TO 12    @Y30LB01   00478000
*                                                            @Y30LB01*/ 00479000
         B     @RC00369                                            0371 00480000
@RF00369 L     @15,@PC00001+8                                      0371 00481000
         MVC   LASTCOND(2,@15),@CH00567                            0371 00482000
*       CALL SSCMSG(REASON);        /* CALL SSCMSG FOR MSG   @Y30LB01*/ 00483000
@RC00369 LA    @15,REASON                                          0372 00484000
         ST    @15,@AL00001                                        0372 00485000
         LA    @01,@AL00001                                        0372 00486000
         BAL   @14,SSCMSG                                          0372 00487000
*     END;                          /*                       @Y30LB01*/ 00488000
*                                                                  0373 00489000
*   /*****************************************************************/ 00490000
*   /*                                                               */ 00491000
*   /* RESTORE REG 14 AND RETURN TO CALLER                   @Y30LB01*/ 00492000
*   /*                                                               */ 00493000
*   /*****************************************************************/ 00494000
*                                                                  0374 00495000
*   RESPECIFY                                                      0374 00496000
*     REG14 RSTD;                   /* RESTRICT REG 14       @Y30LB01*/ 00497000
@RF00367 DS    0H                                                  0375 00498000
*   REG14=RETADDR;                  /* RESTORE REG 14        @Y30LB01*/ 00499000
         L     REG14,RETADDR                                       0375 00500000
*   RETURN CODE(LASTCOND);          /* RETURN TO CALLER      @Y30LB01*/ 00501000
         L     @09,@PC00001+8                                      0376 00502000
         LH    @15,LASTCOND(,@09)                                  0376 00503000
@EL00002 DS    0H                                                  0376 00504000
@EF00002 DS    0H                                                  0376 00505000
@ER00002 BR    @14                                                 0376 00506000
*   RESPECIFY                                                      0377 00507000
*     REG14 UNRSTD;                 /* FREE REG 14           @Y30LB01*/ 00508000
*   END TRACESET;                   /* END TRACESET PROC     @Y30LB01*/ 00509000
*                                                                  0379 00510000
*/*******************************************************    @Y30LB01*/ 00511000
*/*                                                          @Y30LB01*/ 00512000
*/* PROCEDURE NAME - TRACEDMP                                @Y30LB01*/ 00513000
*/*                                                          @Y30LB01*/ 00514000
*/* FUNCTION - SETS UP WORK FILE AND OUTPUT FILE FOR IO.     @Y30LB01*/ 00515000
*/*            USES UEXCP FOR WORK FILE AND UOPEN FOR        @Y30LB01*/ 00516000
*/*            OUTPUT FILE. USSC IS USED TO ACQUIRE THE      @Y30LB01*/ 00517000
*/*            WORK DATASET WITH BIND, INHIBIT STAGE AND     @Y30LB01*/ 00518000
*/*            DELAYED RESPONSE. USSC IS USED TO COPY THE    @Y30LB01*/ 00519000
*/*            MSC TRACE TABLE DATA AREA(S). UGSPACE IS      @Y30LB01*/ 00520000
*/*            USED TO GET STORAGE FOR THE INPUT/OUTPUT      @Y30LB01*/ 00521000
*/*            I/O BUFFERS.                                  @Y30LB01*/ 00522000
*/*                                                          @Y30LB01*/ 00523000
*/* INPUTS - FDTTBL,LASTCOND                                 @Y30LB01*/ 00524000
*/*                                                          @Y30LB01*/ 00525000
*/* OUTPUTS - LASTCOND = 0 FOR SUCCESSFUL FUNCTION           @Y30LB01*/ 00526000
*/*           LASTCOND = 4 FOR MAX DUMP WHEN CURR SPECIFIED  @Y30LB01*/ 00527000
*/*           LASTCOND = 8 FOR PARTIAL DUMP WITH WARNINGS    @Y30LB01*/ 00528000
*/*           LASTCOND = 12 FOR TERMINAL ERRORS - NO DUMP    @Y30LB01*/ 00529000
*/*           GMAINF = ON FOR GETMAIN FAILURE                @Y30LB01*/ 00530000
*/*                                                          @Y30LB01*/ 00531000
*/*******************************************************    @Y30LB01*/ 00532000
*                                                                  0379 00533000
*TRACEDMP:                                                         0379 00534000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB01*/ 00535000
TRACEDMP DS    0H                                                  0380 00536000
*                                                                  0380 00537000
*   /*****************************************************************/ 00538000
*   /*                                                               */ 00539000
*   /* SAVE CALLERS RETURN ADDRESS AND SET INTERNAL TRACE    @Y30LB01*/ 00540000
*   /*                                                               */ 00541000
*   /*****************************************************************/ 00542000
*                                                                  0380 00543000
*   RESPECIFY                                                      0380 00544000
*     REG14 RSTD;                   /* RESTRICT REG 14       @Y30LB01*/ 00545000
*   RETADDR=REG14;                  /* SAVE RETURN ADDR      @Y30LB01*/ 00546000
         ST    REG14,RETADDR                                       0381 00547000
*   RESPECIFY                                                      0382 00548000
*     REG14 UNRSTD;                 /* RELEASE REG 14        @Y30LB01*/ 00549000
*   OLDERID2=NEWERID2;                                             0383 00550000
         L     @15,@PC00001                                        0383 00551000
         L     @15,GDTTR2(,@15)                                    0383 00552000
         MVC   @TS00001(95),NEWERID2(@15)                          0383 00553000
         MVC   OLDERID2(95,@15),@TS00001                           0383 00554000
*   NEWID2='TRAD';                  /* SET TRACE ID          @Y30LB01*/ 00555000
         MVC   NEWID2(4,@15),@CC01328                              0384 00556000
*   IOBPTR=NULLPTR;                 /* NULL UEXCP IO BLK PTR @Y30LB01*/ 00557000
         SLR   @15,@15                                             0385 00558000
         ST    @15,IOBPTR                                          0385 00559000
*   IOCSPTR=NULLPTR;                /* NULL UOPEN IO BLK PTR @Y30LB01*/ 00560000
         ST    @15,IOCSPTR                                         0386 00561000
*   INBLKPTR=NULLPTR;               /* NULL IO BUFFER PTR    @Y30LB01*/ 00562000
         ST    @15,INBLKPTR                                        0387 00563000
*   CTMSGPTR=NULLPTR;               /* NULL PTR TO MSG AREA  @Y30LB01*/ 00564000
*                                                                  0388 00565000
         ST    @15,CTMSGPTR                                        0388 00566000
*   /*****************************************************************/ 00567000
*   /*                                                               */ 00568000
*   /* CALL PROC TRALLOC TO ALLOCATE VIRTUAL UNIT TO         @Y30LB01*/ 00569000
*   /* WORK FILE AND GET THE WORK VOLUME SERIAL NUMBER.      @Y30LB01*/ 00570000
*   /*                                                               */ 00571000
*   /*****************************************************************/ 00572000
*                                                                  0389 00573000
*   RESPECIFY                                                      0389 00574000
*     ALLAGL BASED(WALLPTR);        /* SET ALLAGL BASE       @Y30LB01*/ 00575000
*   WALLPTR=ADDR(WALLOLST);         /* SET ALLAGL AREA PTR   @Y30LB01   00576000
*                                                            @Y30LB01*/ 00577000
         LA    @15,WALLOLST                                        0390 00578000
         ST    @15,WALLPTR                                         0390 00579000
*   CALL TRALLOC;                   /* TRACE ALLO SUB-RTN    @Y30LB01   00580000
*                                                            @Y30LB01*/ 00581000
         BAL   @14,TRALLOC                                         0391 00582000
*                                                                  0392 00583000
*   /*****************************************************************/ 00584000
*   /*                                                               */ 00585000
*   /* NEXT CODE IS TO OPEN WORK DATASET                     @Y30LB01*/ 00586000
*   /*                                                               */ 00587000
*   /*****************************************************************/ 00588000
*                                                                  0392 00589000
*   IF LASTCOND=0 THEN              /* IF LASTCOND IS 0      @Y30LB01*/ 00590000
         L     @15,@PC00001+8                                      0392 00591000
         LH    @15,LASTCOND(,@15)                                  0392 00592000
         LTR   @15,@15                                             0392 00593000
         BNZ   @RF00392                                            0392 00594000
*     DO;                           /* CONTINUE PROCESS      @Y30LB01*/ 00595000
*       WOPENLST=''B;               /* CLEAR EXOARG AREA     @Y30LB01*/ 00596000
         XC    WOPENLST(34),WOPENLST                               0394 00597000
*       WEXOPTR=ADDR(WOPENLST);     /* SET PTR EXOARG AREA   @Y30LB01*/ 00598000
         LA    @15,WOPENLST                                        0395 00599000
         ST    @15,WEXOPTR                                         0395 00600000
*       RESPECIFY                                                  0396 00601000
*         EXOARG BASED(WEXOPTR);    /* SET BASE              @Y30LB01*/ 00602000
*                                                                  0396 00603000
*       /*************************************************************/ 00604000
*       /*                                                           */ 00605000
*       /* INITIALIZE THE UEXCP OPEN ARGUMENT LIST EXOARG    @Y30LB01*/ 00606000
*       /*                                                           */ 00607000
*       /*************************************************************/ 00608000
*                                                                  0397 00609000
*       EXOTAB=ON;                  /* OPEN FOR TABLE READ   @Y30LB01*/ 00610000
         OI    EXOTAB(@15),B'10000000'                             0397 00611000
*       EXOREAD=ON;                 /* OPEN FOR READ         @Y30LB01*/ 00612000
         OI    EXOREAD(@15),B'10000000'                            0398 00613000
*       IF WALLOC^=ON THEN          /* NOT DYNAM ALLOCATED   @Y30LB01*/ 00614000
         TM    WALLOC,B'01000000'                                  0399 00615000
         BO    @RF00399                                            0399 00616000
*         EXODDN=ADDR(WFILEVAL);    /* DDN FROM FDT          @Y30LB01*/ 00617000
         L     @14,@PC00001+4                                      0400 00618000
         L     @01,FDTPTR+48(,@14)                                 0400 00619000
         LA    @14,WFILEVAL(,@01)                                  0400 00620000
         ST    @14,EXODDN(,@15)                                    0400 00621000
*       ELSE                                                       0401 00622000
*         EXODDN=ADDR(ALLDDN);      /* DDN FROM ALLAGL       @Y30LB01*/ 00623000
         B     @RC00399                                            0401 00624000
@RF00399 L     @01,WALLPTR                                         0401 00625000
         LA    @15,ALLDDN(,@01)                                    0401 00626000
         L     @14,WEXOPTR                                         0401 00627000
         ST    @15,EXODDN(,@14)                                    0401 00628000
*       EXOEXT=ADDR(WFEXTENT);      /* RETURN EXTS PTR       @Y30LB01*/ 00629000
@RC00399 L     @15,WEXOPTR                                         0402 00630000
         LA    @14,WFEXTENT                                        0402 00631000
         ST    @14,EXOEXT(,@15)                                    0402 00632000
*       EXOCTLBK=ADDR(IOBPTR);      /* RETURN IOBLK PTR      @Y30LB01*/ 00633000
*                                                                  0403 00634000
         LA    @14,IOBPTR                                          0403 00635000
         ST    @14,EXOCTLBK(,@15)                                  0403 00636000
*       /*************************************************************/ 00637000
*       /*                                                           */ 00638000
*       /* DIAGNOSTIC DUMP OF REGION                         @Y30LB01*/ 00639000
*       /*                                                           */ 00640000
*       /*************************************************************/ 00641000
*                                                                  0404 00642000
*       IF GDTDBG=NULLPTR THEN                                     0404 00643000
         L     @15,@PC00001                                        0404 00644000
         L     @15,GDTDBG(,@15)                                    0404 00645000
         LTR   @15,@15                                             0404 00646000
         BZ    @RT00404                                            0404 00647000
*         ;                                                        0405 00648000
*       ELSE                                                       0406 00649000
*         CALL IDCDB010(GDTTBL,'TRAH');/* DIAG DUMP CALL     @Y30LB01   00650000
*                                                            @Y30LB01*/ 00651000
*                                                                  0406 00652000
         L     @15,@PC00001                                        0406 00653000
         ST    @15,@AL00001                                        0406 00654000
         LA    @14,@CC01332                                        0406 00655000
         ST    @14,@AL00001+4                                      0406 00656000
         MVI   @AL00001+4,X'80'                                    0406 00657000
         L     @15,GDTDBG(,@15)                                    0406 00658000
         LA    @01,@AL00001                                        0406 00659000
         BALR  @14,@15                                             0406 00660000
*       /*************************************************************/ 00661000
*       /*                                                           */ 00662000
*       /* UEXCP CALL TO OPEN THE WORK DATASET               @Y30LB01*/ 00663000
*       /*                                                           */ 00664000
*       /*************************************************************/ 00665000
*                                                                  0407 00666000
*       CALL IDCIO050(GDTTBL,OPEN,EXOARG);/* OPEN CALL TO UEXCP    0407 00667000
*                                                            @Y30LB01*/ 00668000
@RT00404 L     @15,@PC00001                                        0407 00669000
         ST    @15,@AL00001                                        0407 00670000
         LA    @14,OPEN                                            0407 00671000
         ST    @14,@AL00001+4                                      0407 00672000
         L     @01,WEXOPTR                                         0407 00673000
         ST    @01,@AL00001+8                                      0407 00674000
         MVI   @AL00001+8,X'80'                                    0407 00675000
         L     @15,GDTEXP(,@15)                                    0407 00676000
         LA    @01,@AL00001                                        0407 00677000
         BALR  @14,@15                                             0407 00678000
*       RESPECIFY                                                  0408 00679000
*         RTNREG RSTD;                                             0408 00680000
*       TESTRC=RTNREG;                                             0409 00681000
         STH   RTNREG,TESTRC                                       0409 00682000
*       RESPECIFY                                                  0410 00683000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   00684000
*                                                            @Y30LB01*/ 00685000
*                                                                  0410 00686000
*       /*************************************************************/ 00687000
*       /*                                                           */ 00688000
*       /* TEST RETURN CODE FROM UEXCP AND IF FAIL CODE      @Y30LB01*/ 00689000
*       /* IS SET THEN SET LASTCOND TO 12 FOR TERMINAL ERR.  @Y30LB01*/ 00690000
*       /*                                                           */ 00691000
*       /*************************************************************/ 00692000
*                                                                  0411 00693000
*       IF TESTRC^=0 THEN           /* BAD RETURN FOR OPEN   @Y30LB01*/ 00694000
         LH    @15,TESTRC                                          0411 00695000
         LTR   @15,@15                                             0411 00696000
         BZ    @RF00411                                            0411 00697000
*         LASTCOND=LASTCC12;        /* SET LASTCOND TO 12    @Y30LB01*/ 00698000
         L     @15,@PC00001+8                                      0412 00699000
         MVC   LASTCOND(2,@15),@CH00567                            0412 00700000
*     END;                          /* END WFILE OPEN        @Y30LB01*/ 00701000
*                                                                  0413 00702000
@RF00411 DS    0H                                                  0414 00703000
*   /*****************************************************************/ 00704000
*   /*                                                               */ 00705000
*   /* *** END WORK DATASET OPEN CODE *********************  @Y30LB01*/ 00706000
*   /*                                                               */ 00707000
*   /*****************************************************************/ 00708000
*                                                                  0414 00709000
*                                                                  0414 00710000
*   /*****************************************************************/ 00711000
*   /*                                                               */ 00712000
*   /* NEXT CODE IS TO ACQUIRE WORK DATASET                  @Y30LB01*/ 00713000
*   /*                                                               */ 00714000
*   /*****************************************************************/ 00715000
*                                                                  0414 00716000
*   IF LASTCOND=0 THEN              /* IF LASTCOND IS 0      @Y30LB01*/ 00717000
@RF00392 L     @15,@PC00001+8                                      0414 00718000
         LH    @15,LASTCOND(,@15)                                  0414 00719000
         LTR   @15,@15                                             0414 00720000
         BNZ   @RF00414                                            0414 00721000
*     DO;                           /* CONTINUE PROCESS      @Y30LB01*/ 00722000
*       ACLSTPTR=ADDR(PARMLST);     /* SET ACQLIST AREA PTR  @Y30LB01*/ 00723000
         LA    @15,PARMLST                                         0416 00724000
         ST    @15,ACLSTPTR                                        0416 00725000
*       ACQLIST=''B;                /* CLEAR PARM AREA       @ZA17180*/ 00726000
*                                                                  0417 00727000
         XC    ACQLIST(96,@15),ACQLIST(@15)                        0417 00728000
*       /*************************************************************/ 00729000
*       /*                                                           */ 00730000
*       /* IF NOT ON CYLINDER BOUNDRY THE CC ADDRESS MUST    @ZA17180*/ 00731000
*       /* BE ROUNDED AT START AND END CCHHR.                @ZA17180*/ 00732000
*       /*                                                           */ 00733000
*       /*************************************************************/ 00734000
*                                                                  0418 00735000
*       IF WSTRTH2^=F0 THEN         /* NEEDS ROUNDING        @ZA17180*/ 00736000
         CLI   WSTRTH2,0                                           0418 00737000
         BE    @RF00418                                            0418 00738000
*         WSTRTCC=WSTRTCC+1;        /* ROUND TO NEXT CYL     @ZM30980*/ 00739000
         LA    @15,1                                               0419 00740000
         AH    @15,WSTRTCC                                         0419 00741000
         STH   @15,WSTRTCC                                         0419 00742000
*       IF WENDH2^=18 THEN          /* NEEDS ROUNDING        @ZM30980*/ 00743000
@RF00418 CLI   WENDH2,18                                           0420 00744000
         BE    @RF00420                                            0420 00745000
*         WENDDCC=WENDDCC-1;        /* ROUND NXT LOWER CYL   @ZM30980*/ 00746000
*                                                                  0421 00747000
         ICM   @15,12,WENDDCC                                      0421 00748000
         SRA   @15,16                                              0421 00749000
         BCTR  @15,0                                               0421 00750000
         STCM  @15,3,WENDDCC                                       0421 00751000
*       /*************************************************************/ 00752000
*       /*                                                           */ 00753000
*       /* INITIALIZE THE ICBACREL PARMS FOR ACQUIRE         @Y30LB01*/ 00754000
*       /*                                                           */ 00755000
*       /*************************************************************/ 00756000
*                                                                  0422 00757000
*       ARLL=LENGTH(ACQLIST);       /* PARM LENGTH           @Y30LB01*/ 00758000
@RF00420 L     @15,ACLSTPTR                                        0422 00759000
         MVC   ARLL(4,@15),@CF01381                                0422 00760000
*       AROP=OPACQ;                 /* ACQ OP HEX 02         @Y30LB01*/ 00761000
         MVI   AROP(@15),X'02'                                     0423 00762000
*       ARBDUBD=ON;                 /* BIND FLAG             @Y30LB01*/ 00763000
*       ARINH=ON;                   /* INHIBIT STAGE FLAG    @Y30LB01*/ 00764000
*       ARDRES=ON;                  /* DELAYED RESP FLAG     @Y30LB01*/ 00765000
         OI    ARBDUBD(@15),B'11100000'                            0426 00766000
*       ARNMEXT=F1;                 /* ONE EXTENT            @Y30LB01*/ 00767000
         MVI   ARNMEXT(@15),X'01'                                  0427 00768000
*       ARVOL=TRACVOL;              /* VOLID OF WFILE        @Y30LB01*/ 00769000
         MVC   ARVOL(6,@15),TRACVOL                                0428 00770000
*       ACQCCS=WSTARTCC;            /* CONCAT STRT END CC    @Y30LB01*/ 00771000
         MVC   ACQCCS(2),WSTARTCC                                  0429 00772000
*       ACQCCE=WENDCC;              /* CONCAT STRT END CC    @Y30LB01*/ 00773000
         MVC   ACQCCE(2),WENDCC                                    0430 00774000
*       AREXT(1)=ACQCCCC;           /* START AND END CC      @Y30LB01*/ 00775000
*                                                                  0431 00776000
         MVC   AREXT(4,@15),ACQCCCC                                0431 00777000
*       /*************************************************************/ 00778000
*       /*                                                           */ 00779000
*       /* USING DMPSTART, DMPITEM, DMPEND MACROS FOR        @Y30LB01*/ 00780000
*       /* DIAGNOSTIC DUMP ACQUIRE PARAMETERS                @Y30LB01*/ 00781000
*       /*                                                           */ 00782000
*       /*************************************************************/ 00783000
*                                                                  0432 00784000
*       IF GDTDBG=NULLPTR THEN                                     0432 00785000
         L     @15,@PC00001                                        0432 00786000
         L     @15,GDTDBG(,@15)                                    0432 00787000
         LTR   @15,@15                                             0432 00788000
         BZ    @RT00432                                            0432 00789000
*         ;                                                        0433 00790000
*       ELSE                                                       0434 00791000
*         DO;                                                      0434 00792000
*           DMPINDEX=ADDR(DUMPAREA);/* START DUMP LIST       @Y30LB01*/ 00793000
         LA    @15,DUMPAREA                                        0435 00794000
         ST    @15,DMPINDEX                                        0435 00795000
*           DMPITMNM='ACQLIST';                                    0436 00796000
         MVI   DMPITMNM+7(@15),C' '                                0436 00797000
         MVC   DMPITMNM(7,@15),@CC01334                            0436 00798000
*           DMPITMPT=ADDR(ACQLIST);                                0437 00799000
         L     @14,ACLSTPTR                                        0437 00800000
         ST    @14,DMPITMPT(,@15)                                  0437 00801000
*           DMPITMLN=LENGTH(ACQLIST);                              0438 00802000
         MVC   DMPITMLN(2,@15),@CH01381                            0438 00803000
*           DMPITMTP='H';                                          0439 00804000
         MVI   DMPITMTP(@15),C'H'                                  0439 00805000
*           DMPINDEX=DMPINDEX+DMPELEMT;/* HEX DUMP           @Y30LB01*/ 00806000
         AL    @15,@CF00474                                        0440 00807000
         ST    @15,DMPINDEX                                        0440 00808000
*           DMPTRM=DMPTRMVL;                                       0441 00809000
         MVI   DMPTRM(@15),X'FF'                                   0441 00810000
*         END;                      /* END DUMP LIST         @Y30LB01   00811000
*                                                            @Y30LB01*/ 00812000
*                                                                  0442 00813000
*       /*************************************************************/ 00814000
*       /*                                                           */ 00815000
*       /* UDUMP CALL TO DUMP ICBACREL PARMS                 @Y30LB01*/ 00816000
*       /*                                                           */ 00817000
*       /*************************************************************/ 00818000
*                                                                  0443 00819000
*       IF GDTDBG=NULLPTR THEN                                     0443 00820000
@RT00432 L     @15,@PC00001                                        0443 00821000
         L     @15,GDTDBG(,@15)                                    0443 00822000
         LTR   @15,@15                                             0443 00823000
         BZ    @RT00443                                            0443 00824000
*         ;                                                        0444 00825000
*       ELSE                                                       0445 00826000
*         CALL IDCDB010(GDTTBL,'TRAI',ADDR(DUMPAREA));/* DIAG DUMP 0445 00827000
*                                                            @Y30LB01   00828000
*                                                            @Y30LB01*/ 00829000
*                                                                  0445 00830000
         L     @15,@PC00001                                        0445 00831000
         ST    @15,@AL00001                                        0445 00832000
         LA    @14,@CC01335                                        0445 00833000
         ST    @14,@AL00001+4                                      0445 00834000
         LA    @14,DUMPAREA                                        0445 00835000
         ST    @14,@AFTEMPS+4                                      0445 00836000
         LA    @14,@AFTEMPS+4                                      0445 00837000
         ST    @14,@AL00001+8                                      0445 00838000
         MVI   @AL00001+8,X'80'                                    0445 00839000
         L     @15,GDTDBG(,@15)                                    0445 00840000
         LA    @01,@AL00001                                        0445 00841000
         BALR  @14,@15                                             0445 00842000
*       /*************************************************************/ 00843000
*       /*                                                           */ 00844000
*       /* USSC CALL TO PERFORM ACQUIRE FUNCTION             @Y30LB01*/ 00845000
*       /*                                                           */ 00846000
*       /*************************************************************/ 00847000
*                                                                  0446 00848000
*       CALL IDCSASS0(GDTTBL,ACQUIRE,ACLSTPTR,REASON,ECBCODE);/*   0446 00849000
*                                                            @Y30LB01*/ 00850000
@RT00443 L     @15,@PC00001                                        0446 00851000
         ST    @15,@AL00001                                        0446 00852000
         LA    @14,ACQUIRE                                         0446 00853000
         ST    @14,@AL00001+4                                      0446 00854000
         LA    @14,ACLSTPTR                                        0446 00855000
         ST    @14,@AL00001+8                                      0446 00856000
         LA    @14,REASON                                          0446 00857000
         ST    @14,@AL00001+12                                     0446 00858000
         LA    @14,ECBCODE                                         0446 00859000
         ST    @14,@AL00001+16                                     0446 00860000
         MVI   @AL00001+16,X'80'                                   0446 00861000
         L     @15,GDTSSC(,@15)                                    0446 00862000
         LA    @01,@AL00001                                        0446 00863000
         BALR  @14,@15                                             0446 00864000
*       RESPECIFY                                                  0447 00865000
*         RTNREG RSTD;                                             0447 00866000
*       TESTRC=RTNREG;                                             0448 00867000
         STH   RTNREG,TESTRC                                       0448 00868000
*       RESPECIFY                                                  0449 00869000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   00870000
*                                                            @Y30LB01*/ 00871000
*                                                                  0449 00872000
*       /*************************************************************/ 00873000
*       /*                                                           */ 00874000
*       /* TEST USSC RETURN AND IF FUNCTION FAILED THEN      @Y30LB01*/ 00875000
*       /* SET LASTCOND TO TERMINAL ERROR AND CALL           @Y30LB01*/ 00876000
*       /* SSCMSG TO PRINT MESSAGE                           @Y30LB01*/ 00877000
*       /*                                                           */ 00878000
*       /*************************************************************/ 00879000
*                                                                  0450 00880000
*       IF TESTRC^=0 THEN           /* BAD RETURN CODE       @Y30LB01*/ 00881000
         LH    @15,TESTRC                                          0450 00882000
         LTR   @15,@15                                             0450 00883000
         BZ    @RF00450                                            0450 00884000
*         DO;                       /* ERROR PROCESS         @Y30LB01*/ 00885000
*           IF TESTRC=4 THEN        /* EXECUTE ICBACREL FAIL @Y30LB01*/ 00886000
         C     @15,@CF00042                                        0452 00887000
         BNE   @RF00452                                            0452 00888000
*             CALL SSCMSG(REASON,ECBCODE);/* ISSUE MSG       @Y30LB01*/ 00889000
         LA    @15,REASON                                          0453 00890000
         ST    @15,@AL00001                                        0453 00891000
         LA    @15,ECBCODE                                         0453 00892000
         ST    @15,@AL00001+4                                      0453 00893000
         LA    @01,@AL00001                                        0453 00894000
         BAL   @14,SSCMSG                                          0453 00895000
*           LASTCOND=LASTCC12;      /* SET LASTCOND TO 12    @Y30LB01*/ 00896000
@RF00452 L     @15,@PC00001+8                                      0454 00897000
         MVC   LASTCOND(2,@15),@CH00567                            0454 00898000
*         END;                      /* END ERROR PROCESS     @Y30LB01*/ 00899000
*       ELSE                                                       0456 00900000
*         WACQ=ON;                  /* SET ACQUIRED SWITCH   @Y30LB01*/ 00901000
         B     @RC00450                                            0456 00902000
@RF00450 OI    WACQ,B'00100000'                                    0456 00903000
*     END;                          /* END ACQUIRE CODE      @Y30LB01*/ 00904000
*                                                                  0457 00905000
@RC00450 DS    0H                                                  0458 00906000
*   /*****************************************************************/ 00907000
*   /*                                                               */ 00908000
*   /* *** END WORK DATASET ACQUIRE CODE *****************   @Y30LB01*/ 00909000
*   /*                                                               */ 00910000
*   /*****************************************************************/ 00911000
*                                                                  0458 00912000
*                                                                  0458 00913000
*   /*****************************************************************/ 00914000
*   /*                                                               */ 00915000
*   /* NEXT CODE IS TO OPEN OUTPUT DATASET                   @Y30LB01*/ 00916000
*   /*                                                               */ 00917000
*   /*****************************************************************/ 00918000
*                                                                  0458 00919000
*   IF LASTCOND=0 THEN              /* IF LASTCOND IS 0      @Y30LB01*/ 00920000
@RF00414 SLR   @15,@15                                             0458 00921000
         L     @14,@PC00001+8                                      0458 00922000
         CH    @15,LASTCOND(,@14)                                  0458 00923000
         BNE   @RF00458                                            0458 00924000
*     DO;                           /* CONTINUE PROCESS      @Y30LB01*/ 00925000
*       OOPENLST=''B;               /* CLEAR OPNAGL AREA     @Y30LB01*/ 00926000
         XC    OOPENLST(48),OOPENLST                               0460 00927000
*       OPNPTR=ADDR(OOPENLST);      /* SET OPNAGL PTR        @Y30LB01*/ 00928000
*                                                                  0461 00929000
         LA    @14,OOPENLST                                        0461 00930000
         ST    @14,OPNPTR                                          0461 00931000
*       /*************************************************************/ 00932000
*       /*                                                           */ 00933000
*       /* INITIALIZE UOPEN PARAMETERS                       @Y30LB01*/ 00934000
*       /*                                                           */ 00935000
*       /*************************************************************/ 00936000
*                                                                  0462 00937000
*       OPNOPTOT=ON;                /* OPEN FOR OUTPUT       @Y30LB01*/ 00938000
*       OPNOPTBK=ON;                /* BLOCKED PROCESSING    @Y30LB01*/ 00939000
*       OPNOPTCR=ON;                /* SEQUENTIAL PROCESS    @Y30LB01*/ 00940000
         OI    OPNOPTOT(@14),B'01010100'                           0464 00941000
*       OPNRFMFX=ON;                /* FIXED RECORDS         @Y30LB01*/ 00942000
*       OPNRFMBK=ON;                /* BLOCKED               @Y30LB01*/ 00943000
         OI    OPNRFMFX(@14),B'10001000'                           0466 00944000
*       OPNREC=RECLN;               /* LRECL = 264 BLOCKED   @ZM30718*/ 00945000
         MVC   OPNREC(4,@14),@CF01258                              0467 00946000
*       OPNIOC=ADDR(IOCSPTR);       /* RETURN IOBLK PTR      @Y30LB01*/ 00947000
         LA    @09,IOCSPTR                                         0468 00948000
         ST    @09,OPNIOC(,@14)                                    0468 00949000
*       IF ADDR(OFILE)=NULLPTR THEN /* NO DD FOR OFILE       @Y30LB01*/ 00950000
         L     @09,@PC00001+4                                      0469 00951000
         C     @15,FDTPTR+40(,@09)                                 0469 00952000
         BNE   @RF00469                                            0469 00953000
*         OPNDSN=ADDR(ODSVAL);      /* SET DSNAME            @Y30LB01*/ 00954000
         L     @01,FDTPTR+44(,@09)                                 0470 00955000
         LA    @15,ODSVAL(,@01)                                    0470 00956000
         ST    @15,OPNDSN(,@14)                                    0470 00957000
*       ELSE                                                       0471 00958000
*         OPNDDN=ADDR(OFILEVAL);    /* SET DDNAME            @Y30LB01*/ 00959000
*                                                                  0471 00960000
         B     @RC00469                                            0471 00961000
@RF00469 L     @15,@PC00001+4                                      0471 00962000
         L     @01,FDTPTR+40(,@15)                                 0471 00963000
         LA    @15,OFILEVAL(,@01)                                  0471 00964000
         L     @14,OPNPTR                                          0471 00965000
         ST    @15,OPNDDN(,@14)                                    0471 00966000
*       /*************************************************************/ 00967000
*       /*                                                           */ 00968000
*       /* DIAGNOSTIC DUMP OF REGION                         @Y30LB01*/ 00969000
*       /*                                                           */ 00970000
*       /*************************************************************/ 00971000
*                                                                  0472 00972000
*       IF GDTDBG=NULLPTR THEN                                     0472 00973000
@RC00469 L     @15,@PC00001                                        0472 00974000
         L     @15,GDTDBG(,@15)                                    0472 00975000
         LTR   @15,@15                                             0472 00976000
         BZ    @RT00472                                            0472 00977000
*         ;                                                        0473 00978000
*       ELSE                                                       0474 00979000
*         CALL IDCDB010(GDTTBL,'TRAJ');/* DIAG DUMP          @Y30LB01   00980000
*                                                            @Y30LB01*/ 00981000
*                                                                  0474 00982000
         L     @15,@PC00001                                        0474 00983000
         ST    @15,@AL00001                                        0474 00984000
         LA    @14,@CC01336                                        0474 00985000
         ST    @14,@AL00001+4                                      0474 00986000
         MVI   @AL00001+4,X'80'                                    0474 00987000
         L     @15,GDTDBG(,@15)                                    0474 00988000
         LA    @01,@AL00001                                        0474 00989000
         BALR  @14,@15                                             0474 00990000
*       /*************************************************************/ 00991000
*       /*                                                           */ 00992000
*       /* UOPEN CALL TO OPEN THE OUTPUT DATASET             @Y30LB01*/ 00993000
*       /*                                                           */ 00994000
*       /*************************************************************/ 00995000
*                                                                  0475 00996000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/* OFILE OPEN CALL      @Y30LB01*/ 00997000
@RT00472 L     @15,@PC00001                                        0475 00998000
         ST    @15,@AL00001                                        0475 00999000
         L     @01,OPNPTR                                          0475 01000000
         ST    @01,@AL00001+4                                      0475 01001000
         MVI   @AL00001+4,X'80'                                    0475 01002000
         L     @15,GDTOPN(,@15)                                    0475 01003000
         LA    @01,@AL00001                                        0475 01004000
         BALR  @14,@15                                             0475 01005000
*       RESPECIFY                                                  0476 01006000
*         RTNREG RSTD;                                             0476 01007000
*       TESTRC=RTNREG;                                             0477 01008000
         STH   RTNREG,TESTRC                                       0477 01009000
*       RESPECIFY                                                  0478 01010000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   01011000
*                                                            @Y30LB01*/ 01012000
*                                                                  0478 01013000
*       /*************************************************************/ 01014000
*       /*                                                           */ 01015000
*       /* TEST UOPEN RETURN CODE AND IF FAIL CODE THEN      @Y30LB01*/ 01016000
*       /* SET LASTCOND TO TERMINAL ERROR VALUE              @Y30LB01*/ 01017000
*       /*                                                           */ 01018000
*       /*************************************************************/ 01019000
*                                                                  0479 01020000
*       IF TESTRC^=0 THEN           /* BAD RETURN CODE       @Y30LB01*/ 01021000
         LH    @15,TESTRC                                          0479 01022000
         LTR   @15,@15                                             0479 01023000
         BZ    @RF00479                                            0479 01024000
*         LASTCOND=LASTCC12;        /* SET LASTCOND TO 12    @Y30LB01   01025000
*                                                            @ZM30719*/ 01026000
*                                                                  0480 01027000
         L     @15,@PC00001+8                                      0480 01028000
         MVC   LASTCOND(2,@15),@CH00567                            0480 01029000
*       /*************************************************************/ 01030000
*       /*                                                           */ 01031000
*       /* TEST WHETHER BLOCKSIZE RETURNED FROM OPEN IS A    @ZM30719*/ 01032000
*       /* MULTIPLE OF 264, IF NOT SET LASTCOND TO TERMINAL  @ZM30719*/ 01033000
*       /* VALUE AND WRITE APPROPRIATE MESSAGE.              @ZM30719*/ 01034000
*       /*                                                           */ 01035000
*       /*************************************************************/ 01036000
*                                                                  0481 01037000
*       IF IOCTRN//RECLN^=0|        /*                       @ZA13050*/ 01038000
*           IOCTRN=0 THEN           /*                       @ZA13050*/ 01039000
@RF00479 SLR   @15,@15                                             0481 01040000
         L     @01,IOCSPTR                                         0481 01041000
         L     @14,IOCTRN(,@01)                                    0481 01042000
         LR    @00,@14                                             0481 01043000
         SRDA  @00,32                                              0481 01044000
         D     @00,@CF01258                                        0481 01045000
         CR    @00,@15                                             0481 01046000
         BNE   @RT00481                                            0481 01047000
         CR    @14,@15                                             0481 01048000
         BNE   @RF00481                                            0481 01049000
@RT00481 DS    0H                                                  0482 01050000
*         DO;                       /*                       @ZM30719*/ 01051000
*           LASTCOND=LASTCC12;      /* SET LASTCOND TO 12    @ZM30719*/ 01052000
         L     @15,@PC00001+8                                      0483 01053000
         MVC   LASTCOND(2,@15),@CH00567                            0483 01054000
*           PRINTTAB=''B;           /* CLEAR PARM AREA       @ZM30719*/ 01055000
         XC    PRINTTAB(20),PRINTTAB                               0484 01056000
*           DARGSENT=MSG3844I;      /* MESSAGE INDEX         @ZM30719*/ 01057000
         L     @15,DDSTRU                                          0485 01058000
         MVI   DARGSENT(@15),X'05'                                 0485 01059000
*           DARGSMOD=TRAMSG;        /* MESSAGE MODULE        @ZM30719   01060000
*                                                            @ZM30719*/ 01061000
*                                                                  0486 01062000
         MVC   DARGSMOD(3,@15),@CC01280                            0486 01063000
*           /*********************************************************/ 01064000
*           /*                                                       */ 01065000
*           /* UPRINT CALL TO PRINT MESSAGE                  @ZM30719*/ 01066000
*           /*                                                       */ 01067000
*           /*********************************************************/ 01068000
*                                                                  0487 01069000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* ISSUE UPRINT   0487 01070000
*                                                            @ZM30719*/ 01071000
         L     @15,@PC00001                                        0487 01072000
         ST    @15,@AL00001                                        0487 01073000
         LA    @14,@CF00115                                        0487 01074000
         ST    @14,@AL00001+4                                      0487 01075000
         LA    @14,DDSTRU                                          0487 01076000
         ST    @14,@AL00001+8                                      0487 01077000
         MVI   @AL00001+8,X'80'                                    0487 01078000
         L     @15,GDTPRT(,@15)                                    0487 01079000
         LA    @01,@AL00001                                        0487 01080000
         BALR  @14,@15                                             0487 01081000
*         END;                      /* END ERROR PROCESS     @ZM30719*/ 01082000
*     END;                          /* END OFILE OPEN CODE   @Y30LB01*/ 01083000
*                                                                  0489 01084000
@RF00481 DS    0H                                                  0490 01085000
*   /*****************************************************************/ 01086000
*   /*                                                               */ 01087000
*   /* *** END OF OUTPUT DATASET OPEN CODE ***************   @Y30LB01*/ 01088000
*   /*                                                               */ 01089000
*   /*****************************************************************/ 01090000
*                                                                  0490 01091000
*                                                                  0490 01092000
*   /*****************************************************************/ 01093000
*   /*                                                               */ 01094000
*   /* NEXT CODE GETS SPACE FOR INPUT/OUTPUT FILE BUFFERS    @Y30LB01*/ 01095000
*   /*                                                               */ 01096000
*   /*****************************************************************/ 01097000
*                                                                  0490 01098000
*   IF LASTCOND=0 THEN              /* IF LASTCOND IS 0      @Y30LB01*/ 01099000
@RF00458 L     @15,@PC00001+8                                      0490 01100000
         LH    @15,LASTCOND(,@15)                                  0490 01101000
         LTR   @15,@15                                             0490 01102000
         BNZ   @RF00490                                            0490 01103000
*     DO;                           /* CONTINUE PROCESS      @Y30LB01*/ 01104000
*       BUFFLN=IOCTRN+LENGTH(INBUF);/* SET SIZE OF AREA      @Y30LB01*/ 01105000
*                                                                  0492 01106000
         L     @15,@CF01246                                        0492 01107000
         L     @14,IOCSPTR                                         0492 01108000
         AL    @15,IOCTRN(,@14)                                    0492 01109000
         ST    @15,BUFFLN                                          0492 01110000
*       /*************************************************************/ 01111000
*       /*                                                           */ 01112000
*       /* * ISSUE UGSPACE TO OBTAIN BUFFER CORE *           @Y30LB01*/ 01113000
*       /*                                                           */ 01114000
*       /*************************************************************/ 01115000
*                                                                  0493 01116000
*                                   /*                       @Y30LB01*/ 01117000
*       CALL IDCSAGS0(GDTTBL,BUFFLN,INBLKPTR);/*             @Y30LB01*/ 01118000
         L     @15,@PC00001                                        0493 01119000
         ST    @15,@AL00001                                        0493 01120000
         LA    @14,BUFFLN                                          0493 01121000
         ST    @14,@AL00001+4                                      0493 01122000
         LA    @14,INBLKPTR                                        0493 01123000
         ST    @14,@AL00001+8                                      0493 01124000
         MVI   @AL00001+8,X'80'                                    0493 01125000
         L     @15,GDTGSP(,@15)                                    0493 01126000
         LA    @01,@AL00001                                        0493 01127000
         BALR  @14,@15                                             0493 01128000
*       RESPECIFY                                                  0494 01129000
*         RTNREG RSTD;                                             0494 01130000
*       TESTRC=RTNREG;                                             0495 01131000
         STH   RTNREG,TESTRC                                       0495 01132000
*       RESPECIFY                                                  0496 01133000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   01134000
*                                                            @Y30LB01*/ 01135000
*                                                                  0496 01136000
*       /*************************************************************/ 01137000
*       /*                                                           */ 01138000
*       /* TEST UGSPACE RETURN CODE AND IF FAIL CODE         @Y30LB01*/ 01139000
*       /* RETURNED SET GMAINF SWITCH ON AND SET             @Y30LB01*/ 01140000
*       /* LASTCOND TO TERMINAL ERROR VALUE                  @Y30LB01*/ 01141000
*       /*                                                           */ 01142000
*       /*************************************************************/ 01143000
*                                                                  0497 01144000
*       IF TESTRC^=0 THEN           /* BAD RETURN CODE       @Y30LB01*/ 01145000
         LH    @15,TESTRC                                          0497 01146000
         LTR   @15,@15                                             0497 01147000
         BZ    @RF00497                                            0497 01148000
*         DO;                       /* ERROR PROCESS         @Y30LB01*/ 01149000
*           GMAINF=ON;              /* SET GETMAIN FAIL SW   @Y30LB01*/ 01150000
         OI    GMAINF,B'10000000'                                  0499 01151000
*           LASTCOND=LASTCC12;      /* SET LASTCOND TO 12    @Y30LB01*/ 01152000
         L     @15,@PC00001+8                                      0500 01153000
         MVC   LASTCOND(2,@15),@CH00567                            0500 01154000
*         END;                      /* END ERROR PROCESS     @Y30LB01*/ 01155000
*     END;                          /* END GET SPACE CODE    @Y30LB01*/ 01156000
*                                                                  0502 01157000
@RF00497 DS    0H                                                  0503 01158000
*   /*****************************************************************/ 01159000
*   /*                                                               */ 01160000
*   /* **** END OF UGSPACE CODE FOR INPUT/OUTPUT BUFFER **** @Y30LB01*/ 01161000
*   /*                                                               */ 01162000
*   /*****************************************************************/ 01163000
*                                                                  0503 01164000
*                                                                  0503 01165000
*   /*****************************************************************/ 01166000
*   /*                                                               */ 01167000
*   /* NEXT CODE COPIES MSC TRACE TABLES                     @Y30LB01*/ 01168000
*   /*                                                               */ 01169000
*   /*****************************************************************/ 01170000
*                                                                  0503 01171000
*   IF LASTCOND=0 THEN              /* NO ERRORS THUS FAR    @Y30LB01*/ 01172000
@RF00490 SLR   @15,@15                                             0503 01173000
         L     @14,@PC00001+8                                      0503 01174000
         CH    @15,LASTCOND(,@14)                                  0503 01175000
         BNE   @RF00503                                            0503 01176000
*     DO;                           /* CONTINUE PROCESS      @Y30LB01*/ 01177000
*       CTLSTPTR=ADDR(PARMLST);     /* SET PTR FOR COTLIST   @Y30LB01*/ 01178000
         LA    @14,PARMLST                                         0505 01179000
         ST    @14,CTLSTPTR                                        0505 01180000
*       COTLIST=''B;                /* CLEAR PARM AREA       @Y30LB01*/ 01181000
*                                                                  0506 01182000
         XC    COTLIST(24,@14),COTLIST(@14)                        0506 01183000
*       /*************************************************************/ 01184000
*       /*                                                           */ 01185000
*       /* INITIALIZE ICBCOTB PARAMETERS                     @Y30LB01*/ 01186000
*       /*                                                           */ 01187000
*       /*************************************************************/ 01188000
*                                                                  0507 01189000
*       IF ADDR(BOTH)^=NULLPTR THEN /* BOTH AREAS SPECIFIED  @Y30LB01*/ 01190000
         L     @09,@PC00001+4                                      0507 01191000
         C     @15,FDTPTR+20(,@09)                                 0507 01192000
         BE    @RF00507                                            0507 01193000
*         DO;                       /* SET REQUIRED PARMS    @Y30LB01*/ 01194000
*           COTBTRX=ON;             /* X COPY FLAG           @Y30LB01*/ 01195000
*           COTBTRY=ON;             /* Y COPY FLAG           @Y30LB01*/ 01196000
         OI    COTBTRX(@14),B'11000000'                            0510 01197000
*         END;                      /* END BOTH PARMS        @Y30LB01*/ 01198000
*       ELSE                        /* SINGLE AREA           @Y30LB01*/ 01199000
*         DO;                       /* PROCESS PARMS         @Y30LB01*/ 01200000
         B     @RC00507                                            0512 01201000
@RF00507 DS    0H                                                  0513 01202000
*           IF ADDR(X)^=NULLPTR THEN/* X TO BE COPIED        @Y30LB01*/ 01203000
         L     @15,@PC00001+4                                      0513 01204000
         L     @15,FDTPTR+12(,@15)                                 0513 01205000
         LTR   @15,@15                                             0513 01206000
         BZ    @RF00513                                            0513 01207000
*             COTBTRX=ON;           /* X COPY FLAG           @Y30LB01*/ 01208000
         L     @01,CTLSTPTR                                        0514 01209000
         OI    COTBTRX(@01),B'10000000'                            0514 01210000
*           IF ADDR(Y)^=NULLPTR THEN/* Y TO BE COPIED        @Y30LB01*/ 01211000
@RF00513 L     @15,@PC00001+4                                      0515 01212000
         L     @15,FDTPTR+16(,@15)                                 0515 01213000
         LTR   @15,@15                                             0515 01214000
         BZ    @RF00515                                            0515 01215000
*             COTBTRY=ON;           /* Y COPY FLAG           @Y30LB01*/ 01216000
         L     @01,CTLSTPTR                                        0516 01217000
         OI    COTBTRY(@01),B'01000000'                            0516 01218000
*           IF ADDR(ACT)^=NULLPTR THEN/* ACTIVE TO BE COPIED @Y30LB01*/ 01219000
@RF00515 L     @15,@PC00001+4                                      0517 01220000
         L     @15,FDTPTR+24(,@15)                                 0517 01221000
         LTR   @15,@15                                             0517 01222000
         BZ    @RF00517                                            0517 01223000
*             COTBTRA=ON;           /* ACTIVE COPY FLAG      @Y30LB01*/ 01224000
         L     @01,CTLSTPTR                                        0518 01225000
         OI    COTBTRA(@01),B'00100000'                            0518 01226000
*           IF ADDR(INACT)^=NULLPTR THEN/* INACTIVE COPY     @Y30LB01*/ 01227000
@RF00517 L     @15,@PC00001+4                                      0519 01228000
         L     @15,FDTPTR+28(,@15)                                 0519 01229000
         LTR   @15,@15                                             0519 01230000
         BZ    @RF00519                                            0519 01231000
*             COTBTRI=ON;           /* INACT COPY FLAG       @Y30LB01*/ 01232000
         L     @01,CTLSTPTR                                        0520 01233000
         OI    COTBTRI(@01),B'00010000'                            0520 01234000
*         END;                      /* END SINGLE PARMS      @Y30LB01*/ 01235000
@RF00519 DS    0H                                                  0522 01236000
*       COTBEXTS=ACQCCCC;           /* SET EXTENTS USING     @Y30LB01   01237000
*                                      THOSE SET UP FOR ACQ  @Y30LB01*/ 01238000
@RC00507 L     @15,CTLSTPTR                                        0522 01239000
         MVC   COTBEXTS(4,@15),ACQCCCC                             0522 01240000
*       COTBVOL=TRACVOL;            /* VOLID PARM            @Y30LB01*/ 01241000
*                                                                  0523 01242000
         MVC   COTBVOL(6,@15),TRACVOL                              0523 01243000
*       /*************************************************************/ 01244000
*       /*                                                           */ 01245000
*       /* USING DMPSTART, DMPITEM, DMPEND MACROS            @Y30LB01*/ 01246000
*       /* DIAGNOSTIC DUMP COPY TABLES PARAMETERS            @Y30LB01*/ 01247000
*       /*                                                           */ 01248000
*       /*************************************************************/ 01249000
*                                                                  0524 01250000
*       IF GDTDBG=NULLPTR THEN                                     0524 01251000
         L     @15,@PC00001                                        0524 01252000
         L     @15,GDTDBG(,@15)                                    0524 01253000
         LTR   @15,@15                                             0524 01254000
         BZ    @RT00524                                            0524 01255000
*         ;                                                        0525 01256000
*       ELSE                                                       0526 01257000
*         DO;                                                      0526 01258000
*           DMPINDEX=ADDR(DUMPAREA);/* START DUMP LIST       @Y30LB01*/ 01259000
         LA    @15,DUMPAREA                                        0527 01260000
         ST    @15,DMPINDEX                                        0527 01261000
*           DMPITMNM='COTLIST';                                    0528 01262000
         MVI   DMPITMNM+7(@15),C' '                                0528 01263000
         MVC   DMPITMNM(7,@15),@CC01337                            0528 01264000
*           DMPITMPT=ADDR(COTLIST);                                0529 01265000
         L     @14,CTLSTPTR                                        0529 01266000
         ST    @14,DMPITMPT(,@15)                                  0529 01267000
*           DMPITMLN=LENGTH(COTLIST);                              0530 01268000
         MVC   DMPITMLN(2,@15),@CH00310                            0530 01269000
*           DMPITMTP='H';                                          0531 01270000
         MVI   DMPITMTP(@15),C'H'                                  0531 01271000
*           DMPINDEX=DMPINDEX+DMPELEMT;/* HEX DUMP           @Y30LB01*/ 01272000
         AL    @15,@CF00474                                        0532 01273000
         ST    @15,DMPINDEX                                        0532 01274000
*           DMPTRM=DMPTRMVL;                                       0533 01275000
         MVI   DMPTRM(@15),X'FF'                                   0533 01276000
*         END;                      /* END DUMP LIST         @Y30LB01   01277000
*                                                            @Y30LB01*/ 01278000
*                                                                  0534 01279000
*       /*************************************************************/ 01280000
*       /*                                                           */ 01281000
*       /* UDUMP CALL TO DUMP ICBCOTB PARMS                  @Y30LB01*/ 01282000
*       /*                                                           */ 01283000
*       /*************************************************************/ 01284000
*                                                                  0535 01285000
*       IF GDTDBG=NULLPTR THEN                                     0535 01286000
@RT00524 L     @15,@PC00001                                        0535 01287000
         L     @15,GDTDBG(,@15)                                    0535 01288000
         LTR   @15,@15                                             0535 01289000
         BZ    @RT00535                                            0535 01290000
*         ;                                                        0536 01291000
*       ELSE                                                       0537 01292000
*         CALL IDCDB010(GDTTBL,'TRAK',ADDR(DUMPAREA));/* DIAG DUMP 0537 01293000
*                                                            @Y30LB01   01294000
*                                                            @Y30LB01*/ 01295000
*                                                                  0537 01296000
         L     @15,@PC00001                                        0537 01297000
         ST    @15,@AL00001                                        0537 01298000
         LA    @14,@CC01338                                        0537 01299000
         ST    @14,@AL00001+4                                      0537 01300000
         LA    @14,DUMPAREA                                        0537 01301000
         ST    @14,@AFTEMPS+4                                      0537 01302000
         LA    @14,@AFTEMPS+4                                      0537 01303000
         ST    @14,@AL00001+8                                      0537 01304000
         MVI   @AL00001+8,X'80'                                    0537 01305000
         L     @15,GDTDBG(,@15)                                    0537 01306000
         LA    @01,@AL00001                                        0537 01307000
         BALR  @14,@15                                             0537 01308000
*       /*************************************************************/ 01309000
*       /*                                                           */ 01310000
*       /* *** ISSUE USSC TO EXECUTE ICBCOTB MACRO *****     @Y30LB01*/ 01311000
*       /*                                                           */ 01312000
*       /*************************************************************/ 01313000
*                                                                  0538 01314000
*       CALL IDCSASS0(GDTTBL,COPYTABL,CTLSTPTR,REASON,/*     @Y30LB01*/ 01315000
*           ECBCODE,CTMSGPTR);      /*                       @Y30LB01*/ 01316000
@RT00535 L     @15,@PC00001                                        0538 01317000
         ST    @15,@AL00001                                        0538 01318000
         LA    @14,COPYTABL                                        0538 01319000
         ST    @14,@AL00001+4                                      0538 01320000
         LA    @14,CTLSTPTR                                        0538 01321000
         ST    @14,@AL00001+8                                      0538 01322000
         LA    @14,REASON                                          0538 01323000
         ST    @14,@AL00001+12                                     0538 01324000
         LA    @14,ECBCODE                                         0538 01325000
         ST    @14,@AL00001+16                                     0538 01326000
         LA    @14,CTMSGPTR                                        0538 01327000
         ST    @14,@AL00001+20                                     0538 01328000
         MVI   @AL00001+20,X'80'                                   0538 01329000
         L     @15,GDTSSC(,@15)                                    0538 01330000
         LA    @01,@AL00001                                        0538 01331000
         BALR  @14,@15                                             0538 01332000
*       RESPECIFY                                                  0539 01333000
*         RTNREG RSTD;                                             0539 01334000
*       TESTRC=RTNREG;                                             0540 01335000
         STH   RTNREG,TESTRC                                       0540 01336000
*       RESPECIFY                                                  0541 01337000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   01338000
*                                                            @Y30LB01*/ 01339000
*                                                                  0541 01340000
*       /*************************************************************/ 01341000
*       /*                                                           */ 01342000
*       /* SET CTMSGPTR TO POINT TO THE MESSAGE TEXT IF      #Y30LB01*/ 01343000
*       /* THE POINTER IS NON ZERO.                          #Y30LB01*/ 01344000
*       /*                                                           */ 01345000
*       /*************************************************************/ 01346000
*                                                                  0542 01347000
*       IF CTMSGPTR^=NULLPTR THEN   /* MSG PTR SET BY USSC   @Y30LB01*/ 01348000
         L     @15,CTMSGPTR                                        0542 01349000
         LTR   @15,@15                                             0542 01350000
         BZ    @RF00542                                            0542 01351000
*         CTMSGPTR=CTMSGPTR+ECBLN;  /* POINT PAST THE ECB    @Y30LB01*/ 01352000
*                                                                  0543 01353000
         AL    @15,@CF00042                                        0543 01354000
         ST    @15,CTMSGPTR                                        0543 01355000
*       /*************************************************************/ 01356000
*       /*                                                           */ 01357000
*       /* TEST RETURN CODE FROM USSC AND IF FAIL CODE       @Y30LB01*/ 01358000
*       /* RETURNED CALL SSCMSG TO PRINT MESSAGE AND         @Y30LB01*/ 01359000
*       /* SET LASTCOND TO TERMINAL ERROR VALUE              @Y30LB01*/ 01360000
*       /*                                                           */ 01361000
*       /*************************************************************/ 01362000
*                                                                  0544 01363000
*       IF TESTRC^=0 THEN           /* BAD RETURN            @Y30LB01*/ 01364000
@RF00542 LH    @15,TESTRC                                          0544 01365000
         LTR   @15,@15                                             0544 01366000
         BZ    @RF00544                                            0544 01367000
*         DO;                       /* ERROR PROCESS         @Y30LB01*/ 01368000
*           IF TESTRC=4 THEN        /* FUNCTION FAIL CODE    @Y30LB01*/ 01369000
         C     @15,@CF00042                                        0546 01370000
         BNE   @RF00546                                            0546 01371000
*             CALL SSCMSG(REASON,ECBCODE);/* WRITE MESSAGE   @Y30LB01*/ 01372000
         LA    @15,REASON                                          0547 01373000
         ST    @15,@AL00001                                        0547 01374000
         LA    @15,ECBCODE                                         0547 01375000
         ST    @15,@AL00001+4                                      0547 01376000
         LA    @01,@AL00001                                        0547 01377000
         BAL   @14,SSCMSG                                          0547 01378000
*           LASTCOND=LASTCC12;      /* SET LASTCOND TO 12    @Y30LB01*/ 01379000
@RF00546 L     @15,@PC00001+8                                      0548 01380000
         MVC   LASTCOND(2,@15),@CH00567                            0548 01381000
*         END;                      /* END ERROR PROCESS     @Y30LB01*/ 01382000
*                                                                  0549 01383000
*       /*************************************************************/ 01384000
*       /*                                                           */ 01385000
*       /* IF AQUIRE WAS SUCCESSFUL, ISSUE THE USSC MACRO WITH       */ 01386000
*       /*                                                   @ZA17180*/ 01387000
*       /* THE RELINQ OPTION TO RELINQUISH THE DATA SET SPACE SPECIFY*/ 01388000
*       /* THE UNBIND OPTION.                                @ZA17180*/ 01389000
*       /*                                                           */ 01390000
*       /*************************************************************/ 01391000
*                                                                  0550 01392000
*       IF WACQ=ON THEN                                            0550 01393000
@RF00544 TM    WACQ,B'00100000'                                    0550 01394000
         BNO   @RF00550                                            0550 01395000
*         DO;                       /*                       @ZA17180*/ 01396000
*           ACQLIST=ACQLIST&&ACQLIST;/*                      @ZA17180*/ 01397000
         L     @15,ACLSTPTR                                        0552 01398000
         XC    ACQLIST(96,@15),ACQLIST(@15)                        0552 01399000
*           ARLL=LENGTH(ACQLIST);   /*                       @ZA17180*/ 01400000
         MVC   ARLL(4,@15),@CF01381                                0553 01401000
*           AROP=OPREL;             /*                       @ZA17180*/ 01402000
         MVI   AROP(@15),X'04'                                     0554 01403000
*           ARBDUBD=ON;             /*                       @ZA17180*/ 01404000
         OI    ARBDUBD(@15),B'10000000'                            0555 01405000
*           ARNMEXT=F1;             /*                       @ZA17180*/ 01406000
         MVI   ARNMEXT(@15),X'01'                                  0556 01407000
*           ARVOL=TRACVOL;          /*                       @ZA17180*/ 01408000
         MVC   ARVOL(6,@15),TRACVOL                                0557 01409000
*           AREXT(1,1:2)=WSTARTCC;  /*                       @ZA17180*/ 01410000
         MVC   AREXT(2,@15),WSTARTCC                               0558 01411000
*           AREXT(1,3:4)=WENDCC;    /*                       @ZA17180*/ 01412000
         MVC   AREXT+2(2,@15),WENDCC                               0559 01413000
*           CALL IDCSASS0(GDTTBL,RELINQ,ACLSTPTR,REASON);/*  @ZA17180*/ 01414000
         L     @15,@PC00001                                        0560 01415000
         ST    @15,@AL00001                                        0560 01416000
         LA    @14,RELINQ                                          0560 01417000
         ST    @14,@AL00001+4                                      0560 01418000
         LA    @14,ACLSTPTR                                        0560 01419000
         ST    @14,@AL00001+8                                      0560 01420000
         LA    @14,REASON                                          0560 01421000
         ST    @14,@AL00001+12                                     0560 01422000
         MVI   @AL00001+12,X'80'                                   0560 01423000
         L     @15,GDTSSC(,@15)                                    0560 01424000
         LA    @01,@AL00001                                        0560 01425000
         BALR  @14,@15                                             0560 01426000
*           RESPECIFY                                              0561 01427000
*             RTNREG RSTD;                                         0561 01428000
*           TESTRC=RTNREG;                                         0562 01429000
         STH   RTNREG,TESTRC                                       0562 01430000
*           RESPECIFY                                              0563 01431000
*             RTNREG UNRSTD;        /*                       @ZA17180*/ 01432000
*           IF TESTRC^=0 THEN                                      0564 01433000
         LH    @15,TESTRC                                          0564 01434000
         LTR   @15,@15                                             0564 01435000
         BZ    @RF00564                                            0564 01436000
*             DO;                   /*                       @ZA17180*/ 01437000
*                                                                  0565 01438000
*               /*****************************************************/ 01439000
*               /*                                                   */ 01440000
*               /* CALL SSCMSG TO ISSUE A MESSAGE GIVING THE @ZA17180*/ 01441000
*               /* REASON WHY A NON-ZERO RETURN CODE WAS RETURNED.   */ 01442000
*               /*                                           @ZA17180*/ 01443000
*               /*                                                   */ 01444000
*               /*****************************************************/ 01445000
*                                                                  0566 01446000
*               CALL SSCMSG(REASON);/*                       @ZA17180*/ 01447000
         LA    @15,REASON                                          0566 01448000
         ST    @15,@AL00001                                        0566 01449000
         LA    @01,@AL00001                                        0566 01450000
         BAL   @14,SSCMSG                                          0566 01451000
*               LASTCOND=LASTCC04;  /*                       @ZA17180*/ 01452000
         L     @15,@PC00001+8                                      0567 01453000
         MVC   LASTCOND(2,@15),@CH00042                            0567 01454000
*             END;                  /*                       @ZA17180*/ 01455000
*           ELSE                    /*                       @ZA17180*/ 01456000
*             WACQ=OFF;             /*                       @ZA17180*/ 01457000
         B     @RC00564                                            0569 01458000
@RF00564 NI    WACQ,B'11011111'                                    0569 01459000
*         END;                      /*                       @ZA17180*/ 01460000
@RC00564 DS    0H                                                  0571 01461000
*     END;                          /* END COPY CODE         #Y30LB01*/ 01462000
*                                                                  0571 01463000
@RF00550 DS    0H                                                  0572 01464000
*   /*****************************************************************/ 01465000
*   /*                                                               */ 01466000
*   /* ***** END OF COPY TABLES CODE *****************       @Y30LB01*/ 01467000
*   /*                                                               */ 01468000
*   /*****************************************************************/ 01469000
*                                                                  0572 01470000
*                                                                  0572 01471000
*   /*****************************************************************/ 01472000
*   /*                                                               */ 01473000
*   /* NEXT CODE CALLS TRPROCES TO DO THE IO                 @Y30LB01*/ 01474000
*   /*                                                               */ 01475000
*   /*****************************************************************/ 01476000
*                                                                  0572 01477000
*   IF LASTCOND=0 THEN              /* NO ERRORS             @Y30LB01*/ 01478000
@RF00503 L     @15,@PC00001+8                                      0572 01479000
         LH    @15,LASTCOND(,@15)                                  0572 01480000
         LTR   @15,@15                                             0572 01481000
         BNZ   @RF00572                                            0572 01482000
*     CALL TRPROCES;                /* IO PROCESS            @Y30LB01*/ 01483000
*                                                                  0573 01484000
         BAL   @14,TRPROCES                                        0573 01485000
*   /*****************************************************************/ 01486000
*   /*                                                               */ 01487000
*   /* *******END OF CALL TRPROCESS CODE ****************    @Y30LB01*/ 01488000
*   /*                                                               */ 01489000
*   /*****************************************************************/ 01490000
*                                                                  0574 01491000
*                                   /*                       @Y30LB01*/ 01492000
*                                                                  0574 01493000
*   /*****************************************************************/ 01494000
*   /*                                                               */ 01495000
*   /* NEXT CODE FREES CTMSG AREA VIA UFSPACE                @Y30LB01*/ 01496000
*   /*                                                               */ 01497000
*   /*****************************************************************/ 01498000
*                                                                  0574 01499000
*   IF CTMSGPTR^=NULLPTR THEN       /* SPACE OBTAINED        @Y30LB01*/ 01500000
@RF00572 L     @15,CTMSGPTR                                        0574 01501000
         LTR   @15,@15                                             0574 01502000
         BZ    @RF00574                                            0574 01503000
*     DO;                           /* FREE IT               @Y30LB01*/ 01504000
*       CTMSGPTR=CTMSGPTR-ECBLN;    /* INCLUDE ECB AREA      @Y30LB01   01505000
*                                                            @Y30LB01*/ 01506000
*                                                                  0576 01507000
         SL    @15,@CF00042                                        0576 01508000
         ST    @15,CTMSGPTR                                        0576 01509000
*       /*************************************************************/ 01510000
*       /*                                                           */ 01511000
*       /* UFSPACE CALL TO FREE COPT TABLES MSG AREA         @Y30LB01*/ 01512000
*       /*                                                           */ 01513000
*       /*************************************************************/ 01514000
*                                                                  0577 01515000
*       CALL IDCSAFS0(GDTTBL,CTMSGPTR);/* FREE VIA UFSPACE   @Y30LB01   01516000
*                                                            @Y30LB01*/ 01517000
         L     @15,@PC00001                                        0577 01518000
         ST    @15,@AL00001                                        0577 01519000
         LA    @14,CTMSGPTR                                        0577 01520000
         ST    @14,@AL00001+4                                      0577 01521000
         L     @15,GDTFSP(,@15)                                    0577 01522000
         LA    @01,@AL00001                                        0577 01523000
         BALR  @14,@15                                             0577 01524000
*     END;                          /* END UFSPACE CODE      @Y30LB01*/ 01525000
*                                                                  0578 01526000
*   /*****************************************************************/ 01527000
*   /*                                                               */ 01528000
*   /* **** END OF UFSPACE CODE TO FREE CTMSG AREA ******    @Y30LB01*/ 01529000
*   /*                                                               */ 01530000
*   /*****************************************************************/ 01531000
*                                                                  0579 01532000
*                                                                  0579 01533000
*   /*****************************************************************/ 01534000
*   /*                                                               */ 01535000
*   /* NEXT CODE FREES IO BUFFER AREAS IF OBTAINED           @Y30LB01*/ 01536000
*   /*                                                               */ 01537000
*   /*****************************************************************/ 01538000
*                                                                  0579 01539000
*   IF INBLKPTR^=NULLPTR THEN       /* CORE WAS OBTAINED     @Y30LB01   01540000
*                                                            @Y30LB01*/ 01541000
*                                                                  0579 01542000
@RF00574 L     @15,INBLKPTR                                        0579 01543000
         LTR   @15,@15                                             0579 01544000
         BZ    @RF00579                                            0579 01545000
*     /***************************************************************/ 01546000
*     /*                                                             */ 01547000
*     /* UFSPACE CALL TO FREE OUTPUT BUFFER AREA             @Y30LB01*/ 01548000
*     /*                                                             */ 01549000
*     /***************************************************************/ 01550000
*                                                                  0580 01551000
*     CALL IDCSAFS0(GDTTBL,INBLKPTR);/* FREE VIA UFSPACE     @Y30LB01   01552000
*                                                            @Y30LB01*/ 01553000
*                                                                  0580 01554000
         L     @15,@PC00001                                        0580 01555000
         ST    @15,@AL00001                                        0580 01556000
         LA    @14,INBLKPTR                                        0580 01557000
         ST    @14,@AL00001+4                                      0580 01558000
         L     @15,GDTFSP(,@15)                                    0580 01559000
         LA    @01,@AL00001                                        0580 01560000
         BALR  @14,@15                                             0580 01561000
*   /*****************************************************************/ 01562000
*   /*                                                               */ 01563000
*   /* ***** END OF UFSPACE CODE FOR I/O BUFFERS******       @Y30LB01*/ 01564000
*   /*                                                               */ 01565000
*   /*****************************************************************/ 01566000
*                                                                  0581 01567000
*                                                                  0581 01568000
*   /*****************************************************************/ 01569000
*   /*                                                               */ 01570000
*   /* NEXT CODE CLOSES OUTFILE IF OPENED                    @Y30LB01*/ 01571000
*   /*                                                               */ 01572000
*   /*****************************************************************/ 01573000
*                                                                  0581 01574000
*   IF IOCSPTR^=NULLPTR THEN        /* FILE WAS OPENED       @Y30LB01*/ 01575000
@RF00579 L     @15,IOCSPTR                                         0581 01576000
         LTR   @15,@15                                             0581 01577000
         BZ    @RF00581                                            0581 01578000
*     DO;                           /* CLOSE IT              @Y30LB01   01579000
*                                                            @Y30LB01*/ 01580000
*                                                                  0582 01581000
*       /*************************************************************/ 01582000
*       /*                                                           */ 01583000
*       /* UCLOSE CALL TO CLOSE OUTPUT DATASET               @Y30LB01*/ 01584000
*       /*                                                           */ 01585000
*       /*************************************************************/ 01586000
*                                                                  0583 01587000
*       CALL IDCIOCL0(GDTTBL,IOCSPTR);/* CLOSE VIA UCLOSE    @Y30LB01*/ 01588000
         L     @15,@PC00001                                        0583 01589000
         ST    @15,@AL00001                                        0583 01590000
         LA    @14,IOCSPTR                                         0583 01591000
         ST    @14,@AL00001+4                                      0583 01592000
         MVI   @AL00001+4,X'80'                                    0583 01593000
         L     @15,GDTCLS(,@15)                                    0583 01594000
         LA    @01,@AL00001                                        0583 01595000
         BALR  @14,@15                                             0583 01596000
*       RESPECIFY                                                  0584 01597000
*         RTNREG RSTD;                                             0584 01598000
*       TESTRC=RTNREG;                                             0585 01599000
         STH   RTNREG,TESTRC                                       0585 01600000
*       RESPECIFY                                                  0586 01601000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   01602000
*                                                            @Y30LB01   01603000
*                                                            @Y30LB01*/ 01604000
*                                                                  0586 01605000
*       /*************************************************************/ 01606000
*       /*                                                           */ 01607000
*       /* TEST RETURN FROM UCLOSE AND IF FAIL CODE          @Y30LB01*/ 01608000
*       /* SET LASTCOND TO MAXIMUM VALUE OF (LASTCOND        @Y30LB01*/ 01609000
*       /* OR RETURN FROM UCLOSE).                           @Y30LB01*/ 01610000
*       /*                                                           */ 01611000
*       /*************************************************************/ 01612000
*                                                                  0587 01613000
*       IF TESTRC^=0 THEN           /* BAD RETURN CODE       @Y30LB01*/ 01614000
         LH    @15,TESTRC                                          0587 01615000
         LTR   @15,@15                                             0587 01616000
         BZ    @RF00587                                            0587 01617000
*         LASTCOND=MAX(LASTCOND,TESTRC);/* SET LASTCOND      @Y30LB01*/ 01618000
         L     @14,@PC00001+8                                      0588 01619000
         LH    @09,LASTCOND(,@14)                                  0588 01620000
         CR    @09,@15                                             0588 01621000
         BNL   *+6                                                      01622000
         LR    @09,@15                                             0588 01623000
         STH   @09,LASTCOND(,@14)                                  0588 01624000
*     END;                          /* END CLOSE OUTFILE     @Y30LB01*/ 01625000
*                                                                  0589 01626000
@RF00587 DS    0H                                                  0590 01627000
*   /*****************************************************************/ 01628000
*   /*                                                               */ 01629000
*   /* ******* END UCLOSE OUTFILE CODE ******************    @Y30LB01*/ 01630000
*   /*                                                               */ 01631000
*   /*****************************************************************/ 01632000
*                                                                  0590 01633000
*                                                                  0590 01634000
*   /*****************************************************************/ 01635000
*   /*                                                               */ 01636000
*   /* NEXT CODE CLOSES WORKFILE IF OPENED                   @Y30LB01*/ 01637000
*   /*                                                               */ 01638000
*   /*****************************************************************/ 01639000
*                                                                  0590 01640000
*   IF IOBPTR^=NULLPTR THEN         /* FILE WAS OPENED       @Y30LB01*/ 01641000
@RF00581 L     @15,IOBPTR                                          0590 01642000
         LTR   @15,@15                                             0590 01643000
         BZ    @RF00590                                            0590 01644000
*     DO;                           /* CLOSE IT              @Y30LB01   01645000
*                                                            @Y30LB01*/ 01646000
*                                                                  0591 01647000
*       /*************************************************************/ 01648000
*       /*                                                           */ 01649000
*       /* UEXCP CALL TO CLOSE WORK DATASET                  @Y30LB01*/ 01650000
*       /*                                                           */ 01651000
*       /*************************************************************/ 01652000
*                                                                  0592 01653000
*       CALL IDCIO050(GDTTBL,CLOSE,IOBPTR);/* CLOSE VIA UEXCP      0592 01654000
*                                                            @Y30LB01*/ 01655000
         L     @15,@PC00001                                        0592 01656000
         ST    @15,@AL00001                                        0592 01657000
         LA    @14,CLOSE                                           0592 01658000
         ST    @14,@AL00001+4                                      0592 01659000
         LA    @14,IOBPTR                                          0592 01660000
         ST    @14,@AL00001+8                                      0592 01661000
         MVI   @AL00001+8,X'80'                                    0592 01662000
         L     @15,GDTEXP(,@15)                                    0592 01663000
         LA    @01,@AL00001                                        0592 01664000
         BALR  @14,@15                                             0592 01665000
*       RESPECIFY                                                  0593 01666000
*         RTNREG RSTD;                                             0593 01667000
*       TESTRC=RTNREG;                                             0594 01668000
         STH   RTNREG,TESTRC                                       0594 01669000
*       RESPECIFY                                                  0595 01670000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   01671000
*                                                            @Y30LB01   01672000
*                                                            @Y30LB01*/ 01673000
*                                                                  0595 01674000
*       /*************************************************************/ 01675000
*       /*                                                           */ 01676000
*       /* TEST RETURN FROM UEXCP AND IF FAIL CODE           @Y30LB01*/ 01677000
*       /* SET LASTCOND TO MAXIMUM VALUE OF (LASTCOND        @Y30LB01*/ 01678000
*       /* OR RETURN FROM UEXCP).                            @Y30LB01*/ 01679000
*       /*                                                           */ 01680000
*       /*************************************************************/ 01681000
*                                                                  0596 01682000
*       IF TESTRC^=0 THEN           /* BAD RETURN            @Y30LB01*/ 01683000
         LH    @15,TESTRC                                          0596 01684000
         LTR   @15,@15                                             0596 01685000
         BZ    @RF00596                                            0596 01686000
*         LASTCOND=MAX(LASTCOND,TESTRC);/* SET LASTCOND      @Y30LB01*/ 01687000
         L     @14,@PC00001+8                                      0597 01688000
         LH    @09,LASTCOND(,@14)                                  0597 01689000
         CR    @09,@15                                             0597 01690000
         BNL   *+6                                                      01691000
         LR    @09,@15                                             0597 01692000
         STH   @09,LASTCOND(,@14)                                  0597 01693000
*     END;                          /* END CLOSE WORKFILE    @Y30LB01*/ 01694000
*                                                                  0598 01695000
@RF00596 DS    0H                                                  0599 01696000
*   /*****************************************************************/ 01697000
*   /*                                                               */ 01698000
*   /* ******** END UEXCP WORKFILE CODE *****************    @Y30LB01*/ 01699000
*   /*                                                               */ 01700000
*   /*****************************************************************/ 01701000
*                                                                  0599 01702000
*                                                                  0599 01703000
*   /*****************************************************************/ 01704000
*   /*                                                               */ 01705000
*   /* NEXT CODE DEALLOCATES WORKFILE IF IT WAS              @Y30LB01*/ 01706000
*   /* DYNAMICALLY ALLOCATED.                                @Y30LB01*/ 01707000
*   /*                                                               */ 01708000
*   /*****************************************************************/ 01709000
*                                                                  0599 01710000
*   IF WALLOC=ON THEN               /* WAS DYNAM ALLOC-D     @Y30LB01*/ 01711000
@RF00590 TM    WALLOC,B'01000000'                                  0599 01712000
         BNO   @RF00599                                            0599 01713000
*     DO;                           /* DEALLOCATE IT         @Y30LB01   01714000
*                                                            @Y30LB01*/ 01715000
*                                                                  0600 01716000
*       /*************************************************************/ 01717000
*       /*                                                           */ 01718000
*       /* UDEALLOC CALL TO DEALLOCATE WORK FILE             @Y30LB01*/ 01719000
*       /*                                                           */ 01720000
*       /*************************************************************/ 01721000
*                                                                  0601 01722000
*       CALL IDCSADL0(GDTTBL,ALLAGL);/* DEALLO VIA UDEALLOC  @Y30LB01*/ 01723000
         L     @15,@PC00001                                        0601 01724000
         ST    @15,@AL00001                                        0601 01725000
         L     @01,WALLPTR                                         0601 01726000
         ST    @01,@AL00001+4                                      0601 01727000
         MVI   @AL00001+4,X'80'                                    0601 01728000
         L     @15,GDTDLC(,@15)                                    0601 01729000
         LA    @01,@AL00001                                        0601 01730000
         BALR  @14,@15                                             0601 01731000
*       RESPECIFY                                                  0602 01732000
*         RTNREG RSTD;                                             0602 01733000
*       TESTRC=RTNREG;                                             0603 01734000
         STH   RTNREG,TESTRC                                       0603 01735000
*       RESPECIFY                                                  0604 01736000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   01737000
*                                                            @Y30LB01*/ 01738000
*                                                                  0604 01739000
*       /*************************************************************/ 01740000
*       /*                                                           */ 01741000
*       /* TEST RETURN FROM UDEALLOC AND IF FAIL             @Y30LB01*/ 01742000
*       /* CODE RETURNED SET LASTCOND TO MAXIMUM             @Y30LB01*/ 01743000
*       /* VALUE(LASTCOND OR RETURN FROM UDEALLOC)           @Y30LB01*/ 01744000
*       /*                                                           */ 01745000
*       /*************************************************************/ 01746000
*                                                                  0605 01747000
*       IF TESTRC^=0 THEN           /* ERROR RETURN CODE     @Y30LB01*/ 01748000
         LH    @15,TESTRC                                          0605 01749000
         LTR   @15,@15                                             0605 01750000
         BZ    @RF00605                                            0605 01751000
*         LASTCOND=MAX(LASTCOND,TESTRC);/* SET LASTCOND      @Y30LB01*/ 01752000
         L     @14,@PC00001+8                                      0606 01753000
         LH    @09,LASTCOND(,@14)                                  0606 01754000
         CR    @09,@15                                             0606 01755000
         BNL   *+6                                                      01756000
         LR    @09,@15                                             0606 01757000
         STH   @09,LASTCOND(,@14)                                  0606 01758000
*     END;                          /* END DEALLOC CODE      @Y30LB01*/ 01759000
*                                                                  0607 01760000
@RF00605 DS    0H                                                  0608 01761000
*   /*****************************************************************/ 01762000
*   /*                                                               */ 01763000
*   /* ******END OF UDEALLOC WORKFILE CODE **************    @Y30LB01*/ 01764000
*   /*                                                               */ 01765000
*   /*****************************************************************/ 01766000
*                                                                  0608 01767000
*                                                                  0608 01768000
*   /*****************************************************************/ 01769000
*   /*                                                               */ 01770000
*   /* RESTORE CALLERS RETURN ADDR AND RETURN                @Y30LB01*/ 01771000
*   /*                                                               */ 01772000
*   /*****************************************************************/ 01773000
*                                                                  0608 01774000
*   RESPECIFY                                                      0608 01775000
*     REG14 RSTD;                   /* RESTRICT REG 14       @Y30LB01*/ 01776000
@RF00599 DS    0H                                                  0609 01777000
*   REG14=RETADDR;                  /* RESTORE RETURN ADDR   @Y30LB01*/ 01778000
         L     REG14,RETADDR                                       0609 01779000
*   RETURN CODE(LASTCOND);          /* RETURN TO CALLER      @Y30LB01*/ 01780000
         L     @09,@PC00001+8                                      0610 01781000
         LH    @15,LASTCOND(,@09)                                  0610 01782000
@EL00003 DS    0H                                                  0610 01783000
@EF00003 DS    0H                                                  0610 01784000
@ER00003 BR    @14                                                 0610 01785000
*   RESPECIFY                                                      0611 01786000
*     REG14 UNRSTD;                 /* FREE REG 14           @Y30LB01*/ 01787000
*   END TRACEDMP;                   /*                       @Y30LB01*/ 01788000
*                                                                  0613 01789000
*/*******************************************************    @Y30LB01*/ 01790000
*/*                                                          @Y30LB01*/ 01791000
*/* PROCEDURE NAME - TRALLOC                                 @Y30LB01*/ 01792000
*/*                                                          @Y30LB01*/ 01793000
*/* FUNCTION - TO DYNAMMICALLY ALLOCATE TRACE WORK DATASET   @Y30LB01*/ 01794000
*/*            IF REQUIRED, TO DETERMINE VOLSER OF WORK      @Y30LB01*/ 01795000
*/*            DATASET, AND TO VERIFY WORKFILE IS ALLOCATED  @Y30LB01*/ 01796000
*/*            TO A VIRTUAL UNIT.                            @Y30LB01*/ 01797000
*/*                                                          @Y30LB01*/ 01798000
*/* INPUTS - FDTTBL,LASTCOND                                 @Y30LB01*/ 01799000
*/*                                                          @Y30LB01*/ 01800000
*/* OUTPUTS - LASTCOND = 0  SUCCESSFUL FUNCTION              @Y30LB01*/ 01801000
*/*           LASTCOND = 12 TERMINAL ERROR                   @Y30LB01*/ 01802000
*/*           TRACVOL = VOLID - IF NO ERROR                  @Y30LB01*/ 01803000
*/*           WALLOC = ON - FLAG TO INDICATE DYNAM ALLOCATED @Y30LB01*/ 01804000
*/*                                                          @Y30LB01*/ 01805000
*/*******************************************************    @Y30LB01*/ 01806000
*                                                                  0613 01807000
*TRALLOC:                                                          0613 01808000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB01*/ 01809000
TRALLOC  DS    0H                                                  0614 01810000
*                                                                  0614 01811000
*   /*****************************************************************/ 01812000
*   /*                                                               */ 01813000
*   /* SAVE CALLERS RETURN ADDRESS AND SET INTERNAL TRACE    @Y30LB01*/ 01814000
*   /*                                                               */ 01815000
*   /*****************************************************************/ 01816000
*                                                                  0614 01817000
*   RESPECIFY                                                      0614 01818000
*     REG14 RSTD;                   /* RESTRICT REG14        @Y30LB01*/ 01819000
*   RETADDR1=REG14;                 /* SAVE REG 14           @Y30LB01*/ 01820000
         ST    REG14,RETADDR1                                      0615 01821000
*   RESPECIFY                                                      0616 01822000
*     REG14 UNRSTD;                 /* FREE REG 14           @Y30LB01*/ 01823000
*   OLDERID2=NEWERID2;                                             0617 01824000
         L     @15,@PC00001                                        0617 01825000
         L     @14,GDTTR2(,@15)                                    0617 01826000
         MVC   @TS00001(95),NEWERID2(@14)                          0617 01827000
         MVC   OLDERID2(95,@14),@TS00001                           0617 01828000
*   NEWID2='TRAE';                  /* SET TRACE ID          @Y30LB01   01829000
*                                                            @Y30LB01*/ 01830000
*                                                                  0618 01831000
         MVC   NEWID2(4,@14),@CC01343                              0618 01832000
*   /*****************************************************************/ 01833000
*   /*                                                               */ 01834000
*   /* IF WORK FILE MUST BE DYNAMMICALLY ALLOCATED, BUILD    @Y30LB01*/ 01835000
*   /* UALLOC ARGUMENT LIST (ALLAGL), DIAG DUMP ALLAGL,      @Y30LB01*/ 01836000
*   /* AND ISSUE UALLOC TO ALLOCATE THE WORK FILE.           @Y30LB01*/ 01837000
*   /*                                                               */ 01838000
*   /*****************************************************************/ 01839000
*                                                                  0619 01840000
*   IF ADDR(WDS)^=0 THEN            /* NEEDS DYNAM ALLOC     @Y30LB01*/ 01841000
         SLR   @14,@14                                             0619 01842000
         L     @09,@PC00001+4                                      0619 01843000
         L     @09,FDTPTR+52(,@09)                                 0619 01844000
         CR    @09,@14                                             0619 01845000
         BE    @RF00619                                            0619 01846000
*     DO;                           /* ALLOCATE IT           @Y30LB01*/ 01847000
*       WALLPTR=ADDR(WALLOLST);     /* SET PTR TO ALLAGL     @Y30LB01*/ 01848000
         LA    @08,WALLOLST                                        0621 01849000
         ST    @08,WALLPTR                                         0621 01850000
*       RESPECIFY                                                  0622 01851000
*         ALLAGL BASED(WALLPTR);    /* ADDRESS AREA          @Y30LB01*/ 01852000
*       WALLOLST=''B;               /* CLEAR AREA            @Y30LB01*/ 01853000
*                                                                  0623 01854000
         XC    WALLOLST(31),WALLOLST                               0623 01855000
*       /*************************************************************/ 01856000
*       /*                                                           */ 01857000
*       /* INITIALIZE UALLOC ARGUMENT LIST                   @Y30LB01*/ 01858000
*       /*                                                           */ 01859000
*       /*************************************************************/ 01860000
*                                                                  0624 01861000
*       ALLDSN=ADDR(WDSVAL);        /* DSNAME PARM           @Y30LB01*/ 01862000
         LA    @09,WDSVAL(,@09)                                    0624 01863000
         ST    @09,ALLDSN(,@08)                                    0624 01864000
*       ALLSTSOD=ON;                /* STATUS OLD PARM       @Y30LB01*/ 01865000
         OI    ALLSTSOD(@08),B'00000001'                           0625 01866000
*       ALLDSPKP=ON;                /* DISP KEEP PARM        @Y30LB01*/ 01867000
         OI    ALLDSPKP(@08),B'00001000'                           0626 01868000
*       ALLOPTDS=ON;                /* DS ALLO PARM          @Y30LB01*/ 01869000
         OI    ALLOPTDS(@08),B'01000000'                           0627 01870000
*       WUCNT=WORKUCNT;             /* SET NUM UNITS TO 1    @Y30LB01*/ 01871000
         MVC   WUCNT(2),@CH00219                                   0628 01872000
*       WULN=LENGTH(WORKUNME);      /* SET LENGTH UNIT PARM  @Y30LB01*/ 01873000
         MVC   WULN(2),@CH00286                                    0629 01874000
*       WUNAME=WORKUNME;            /* SET UNIT ESOTER NAME  @Y30LB01*/ 01875000
         MVI   WUNAME+5,C' '                                       0630 01876000
         MVC   WUNAME+6(2),WUNAME+5                                0630 01877000
         MVC   WUNAME(5),@CC01299                                  0630 01878000
*       ALLULP=ADDR(WORKUNIT);      /* SET PTR TO UNIT LIST  @Y30LB01*/ 01879000
*                                                                  0631 01880000
         LA    @09,WORKUNIT                                        0631 01881000
         ST    @09,ALLULP(,@08)                                    0631 01882000
*       /*************************************************************/ 01883000
*       /*                                                           */ 01884000
*       /* USING DMPSTART, DMPITEM, DMPEND MACROS SET        @Y30LB01*/ 01885000
*       /* DIAGNOSTIC DUMP ALLOCATION PARAMETERS             @Y30LB01*/ 01886000
*       /*                                                           */ 01887000
*       /*************************************************************/ 01888000
*                                                                  0632 01889000
*       IF GDTDBG=NULLPTR THEN                                     0632 01890000
         C     @14,GDTDBG(,@15)                                    0632 01891000
         BE    @RT00632                                            0632 01892000
*         ;                                                        0633 01893000
*       ELSE                                                       0634 01894000
*         DO;                                                      0634 01895000
*           DMPINDEX=ADDR(DUMPAREA);/* START DUMP LIST       @Y30LB01*/ 01896000
         LA    @15,DUMPAREA                                        0635 01897000
         ST    @15,DMPINDEX                                        0635 01898000
*           DMPITMNM='ALLAGL';                                     0636 01899000
         MVI   DMPITMNM+6(@15),C' '                                0636 01900000
         MVI   DMPITMNM+7(@15),C' '                                0636 01901000
         MVC   DMPITMNM(6,@15),@CC01345                            0636 01902000
*           DMPITMPT=ADDR(ALLAGL);                                 0637 01903000
         L     @14,WALLPTR                                         0637 01904000
         ST    @14,DMPITMPT(,@15)                                  0637 01905000
*           DMPITMLN=LENGTH(ALLAGL);                               0638 01906000
         MVC   DMPITMLN(2,@15),@CH00044                            0638 01907000
*           DMPITMTP='H';                                          0639 01908000
         MVI   DMPITMTP(@15),C'H'                                  0639 01909000
*           DMPINDEX=DMPINDEX+DMPELEMT;/* HEX DUMP           @Y30LB01*/ 01910000
         AL    @15,@CF00474                                        0640 01911000
         ST    @15,DMPINDEX                                        0640 01912000
*           DMPTRM=DMPTRMVL;                                       0641 01913000
         MVI   DMPTRM(@15),X'FF'                                   0641 01914000
*         END;                      /* END DUMP LIST         @Y30LB01*/ 01915000
*                                                                  0642 01916000
*       /*************************************************************/ 01917000
*       /*                                                           */ 01918000
*       /* UDUMP CALL TO DIAG DUMP ALLAGL                    @Y30LB01*/ 01919000
*       /*                                                           */ 01920000
*       /*************************************************************/ 01921000
*                                                                  0643 01922000
*       IF GDTDBG=NULLPTR THEN                                     0643 01923000
@RT00632 L     @15,@PC00001                                        0643 01924000
         L     @15,GDTDBG(,@15)                                    0643 01925000
         LTR   @15,@15                                             0643 01926000
         BZ    @RT00643                                            0643 01927000
*         ;                                                        0644 01928000
*       ELSE                                                       0645 01929000
*         CALL IDCDB010(GDTTBL,'TRAL',ADDR(DUMPAREA));/* UDUMP ALLAGL   01930000
*                                                            @Y30LB01   01931000
*                                                            @Y30LB01*/ 01932000
*                                                                  0645 01933000
         L     @15,@PC00001                                        0645 01934000
         ST    @15,@AL00001                                        0645 01935000
         LA    @14,@CC01346                                        0645 01936000
         ST    @14,@AL00001+4                                      0645 01937000
         LA    @14,DUMPAREA                                        0645 01938000
         ST    @14,@AFTEMPS+8                                      0645 01939000
         LA    @14,@AFTEMPS+8                                      0645 01940000
         ST    @14,@AL00001+8                                      0645 01941000
         MVI   @AL00001+8,X'80'                                    0645 01942000
         L     @15,GDTDBG(,@15)                                    0645 01943000
         LA    @01,@AL00001                                        0645 01944000
         BALR  @14,@15                                             0645 01945000
*       /*************************************************************/ 01946000
*       /*                                                           */ 01947000
*       /* UALLOC CALL TO ALLOCATE WORK FILE                 @Y30LB01*/ 01948000
*       /*                                                           */ 01949000
*       /*************************************************************/ 01950000
*                                                                  0646 01951000
*       CALL IDCSAAL0(GDTTBL,ALLAGL);/* ALLOCATE VIA UALLOC  @Y30LB01*/ 01952000
@RT00643 L     @15,@PC00001                                        0646 01953000
         ST    @15,@AL00001                                        0646 01954000
         L     @01,WALLPTR                                         0646 01955000
         ST    @01,@AL00001+4                                      0646 01956000
         MVI   @AL00001+4,X'80'                                    0646 01957000
         L     @15,GDTALC(,@15)                                    0646 01958000
         LA    @01,@AL00001                                        0646 01959000
         BALR  @14,@15                                             0646 01960000
*       RESPECIFY                                                  0647 01961000
*         RTNREG RSTD;                                             0647 01962000
*       TESTRC=RTNREG;                                             0648 01963000
         STH   RTNREG,TESTRC                                       0648 01964000
*       RESPECIFY                                                  0649 01965000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   01966000
*                                                            @Y30LB01*/ 01967000
*                                                                  0649 01968000
*       /*************************************************************/ 01969000
*       /*                                                           */ 01970000
*       /* TEST RETURN FROM UALLOC AND IF FAIL CODE          @Y30LB01*/ 01971000
*       /* RETURNED SET LASTCOND TO TERMINAL VALUE           @Y30LB01*/ 01972000
*       /*                                                           */ 01973000
*       /*************************************************************/ 01974000
*                                                                  0650 01975000
*       IF TESTRC^=0 THEN           /* BAD RETURN            @Y30LB01*/ 01976000
         LH    @15,TESTRC                                          0650 01977000
         LTR   @15,@15                                             0650 01978000
         BZ    @RF00650                                            0650 01979000
*         LASTCOND=LASTCC12;        /* SET LASTCOND TO 12    @Y30LB01*/ 01980000
         L     @15,@PC00001+8                                      0651 01981000
         MVC   LASTCOND(2,@15),@CH00567                            0651 01982000
*       ELSE                                                       0652 01983000
*         WALLOC=ON;                /* SET DYNAM ALLO SW ON  @Y30LB01*/ 01984000
         B     @RC00650                                            0652 01985000
@RF00650 OI    WALLOC,B'01000000'                                  0652 01986000
*     END;                          /* END UALLOC CODE       @Y30LB01*/ 01987000
*                                                                  0653 01988000
@RC00650 DS    0H                                                  0654 01989000
*   /*****************************************************************/ 01990000
*   /*                                                               */ 01991000
*   /* *********END OF WORKFILE ALLOCATION CODE *********    @Y30LB01*/ 01992000
*   /*                                                               */ 01993000
*   /*****************************************************************/ 01994000
*                                                                  0654 01995000
*                                                                  0654 01996000
*   /*****************************************************************/ 01997000
*   /*                                                               */ 01998000
*   /* NEXT CODE IS TO GET THE WORK FILE VOLUME SERIAL       @Y30LB01*/ 01999000
*   /*                                                               */ 02000000
*   /*****************************************************************/ 02001000
*                                                                  0654 02002000
*   IF LASTCOND=0 THEN              /* NO ERRORS             @Y30LB01*/ 02003000
@RF00619 L     @15,@PC00001+8                                      0654 02004000
         LH    @15,LASTCOND(,@15)                                  0654 02005000
         LTR   @15,@15                                             0654 02006000
         BNZ   @RF00654                                            0654 02007000
*     DO;                           /* CONTINUE PROCESS      @Y30LB01*/ 02008000
*       TINFOPTR=ADDR(PARMLST);     /* SET PTR TO PARM AREA  @Y30LB01*/ 02009000
         LA    @15,PARMLST                                         0656 02010000
         ST    @15,TINFOPTR                                        0656 02011000
*       RESPECIFY                                                  0657 02012000
*         IOINFOPT BASED(TINFOPTR); /* SET BASE              @Y30LB01*/ 02013000
*       IOINFOPT=''B;               /* CLEAR PARM AREA       @Y30LB01*/ 02014000
*                                                                  0658 02015000
         MVI   IOINFOPT(@15),X'00'                                 0658 02016000
*       /*************************************************************/ 02017000
*       /*                                                           */ 02018000
*       /* INITIALIZE UIOINFO OPTION LIST                    @Y30LB01*/ 02019000
*       /*                                                           */ 02020000
*       /*************************************************************/ 02021000
*                                                                  0659 02022000
*       IOINFVOL=ON;                /* VOLID OPT PARM        @Y30LB01*/ 02023000
         OI    IOINFVOL(@15),B'01000000'                           0659 02024000
*       VOLPTR=ADDR(VOLDATA);       /* SET PTR TO AREA       @Y30LB01*/ 02025000
         LA    @15,VOLDATA                                         0660 02026000
         ST    @15,VOLPTR                                          0660 02027000
*       VOLDATA=''B;                /* CLEAR DATA AREA       @Y30LB01*/ 02028000
         XC    VOLDATA(38),VOLDATA                                 0661 02029000
*       HDRLN1=LENGTH(VOLDATA);     /* SET AREA LENGTH       @Y30LB01*/ 02030000
         MVC   HDRLN1(2),@CH01385                                  0662 02031000
*       IF WALLOC=ON THEN           /* IF DYNAM ALLOC D      @Y30LB01*/ 02032000
         TM    WALLOC,B'01000000'                                  0663 02033000
         BNO   @RF00663                                            0663 02034000
*         TRACDDN=ALLDDN;           /* DDNAME FROM ALLAGL    @Y30LB01*/ 02035000
         L     @01,WALLPTR                                         0664 02036000
         MVC   TRACDDN(8),ALLDDN(@01)                              0664 02037000
*       ELSE                                                       0665 02038000
*         TRACDDN=WFILEVAL;         /* DDNAME FROM FDT       @Y30LB01   02039000
*                                                            @Y30LB01*/ 02040000
*                                                                  0665 02041000
         B     @RC00663                                            0665 02042000
@RF00663 L     @15,@PC00001+4                                      0665 02043000
         L     @01,FDTPTR+48(,@15)                                 0665 02044000
         MVC   TRACDDN(8),WFILEVAL(@01)                            0665 02045000
*       /*************************************************************/ 02046000
*       /*                                                           */ 02047000
*       /* UIOINFO CALL TO GET VOLID                         @Y30LB01*/ 02048000
*       /*                                                           */ 02049000
*       /*************************************************************/ 02050000
*                                                                  0666 02051000
*       CALL IDCIOSI0(GDTTBL,IOINFOPT,VOLPTR,TRACDDN);/*     @Y30LB01*/ 02052000
@RC00663 L     @15,@PC00001                                        0666 02053000
         ST    @15,@AL00001                                        0666 02054000
         L     @01,TINFOPTR                                        0666 02055000
         ST    @01,@AL00001+4                                      0666 02056000
         LA    @14,VOLPTR                                          0666 02057000
         ST    @14,@AL00001+8                                      0666 02058000
         LA    @14,TRACDDN                                         0666 02059000
         ST    @14,@AL00001+12                                     0666 02060000
         MVI   @AL00001+12,X'80'                                   0666 02061000
         L     @15,GDTIFO(,@15)                                    0666 02062000
         LA    @01,@AL00001                                        0666 02063000
         BALR  @14,@15                                             0666 02064000
*       RESPECIFY                                                  0667 02065000
*         RTNREG RSTD;                                             0667 02066000
*       TESTRC=RTNREG;                                             0668 02067000
         STH   RTNREG,TESTRC                                       0668 02068000
*       RESPECIFY                                                  0669 02069000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   02070000
*                                                            @Y30LB01*/ 02071000
*                                                                  0669 02072000
*       /*************************************************************/ 02073000
*       /*                                                           */ 02074000
*       /* TEST RETURN FROM UIOINFO AND IF FAIL CODE         @Y30LB01*/ 02075000
*       /* RETURNED SET LASTCOND TO TERMINAL VALUE           @Y30LB01*/ 02076000
*       /*                                                           */ 02077000
*       /*************************************************************/ 02078000
*                                                                  0670 02079000
*       IF TESTRC^=0 THEN           /* BAD RETURN CODE       @Y30LB01*/ 02080000
         LH    @15,TESTRC                                          0670 02081000
         LTR   @15,@15                                             0670 02082000
         BZ    @RF00670                                            0670 02083000
*         LASTCOND=LASTCC12;        /* SET LASTCOND TO 12    @Y30LB01*/ 02084000
         L     @15,@PC00001+8                                      0671 02085000
         MVC   LASTCOND(2,@15),@CH00567                            0671 02086000
*       ELSE                                                       0672 02087000
*         VOLPTR=ADDR(TRACVOL);     /* GOOD RETURN THEN SET  @Y30LB01   02088000
*                                      VOLPTR TO VOLID FLD   @Y30LB01*/ 02089000
         B     @RC00670                                            0672 02090000
@RF00670 LA    @15,TRACVOL                                         0672 02091000
         ST    @15,VOLPTR                                          0672 02092000
*     END;                          /* END UIOINFO CODE      @Y30LB01*/ 02093000
*                                                                  0673 02094000
@RC00670 DS    0H                                                  0674 02095000
*   /*****************************************************************/ 02096000
*   /*                                                               */ 02097000
*   /* *********** END OF UIOINFO CODE TO GET VOLSER *****   @Y30LB01*/ 02098000
*   /*                                                               */ 02099000
*   /*****************************************************************/ 02100000
*                                                                  0674 02101000
*                                                                  0674 02102000
*   /*****************************************************************/ 02103000
*   /*                                                               */ 02104000
*   /* NEXT CODE IS TO VERIFY THAT THE WORK DATASET IS       @Y30LB01*/ 02105000
*   /* ALLOCATED TO A VIRTUAL UNIT.                          @Y30LB01*/ 02106000
*   /*                                                               */ 02107000
*   /*****************************************************************/ 02108000
*                                                                  0674 02109000
*   IF LASTCOND=0 THEN              /* NO ERRORS             @Y30LB01*/ 02110000
@RF00654 SLR   @15,@15                                             0674 02111000
         L     @14,@PC00001+8                                      0674 02112000
         CH    @15,LASTCOND(,@14)                                  0674 02113000
         BNE   @RF00674                                            0674 02114000
*     DO;                           /* VERIFY UNIT           @Y30LB01*/ 02115000
*       TUMSSPTR=ADDR(PARMLST);     /* SET PTR TO AREA       @Y30LB01*/ 02116000
         LA    @14,PARMLST                                         0676 02117000
         ST    @14,TUMSSPTR                                        0676 02118000
*       RESPECIFY                                                  0677 02119000
*         CKAGL BASED(TUMSSPTR);    /* SET BASE              @Y30LB01*/ 02120000
*       CKAGL=''B;                  /* CLEAR PARM AREA       @Y30LB01*/ 02121000
*                                                                  0678 02122000
         XC    CKAGL(29,@14),CKAGL(@14)                            0678 02123000
*       /*************************************************************/ 02124000
*       /*                                                           */ 02125000
*       /* INITIALIZE UMSSUNIT CHECK PARMS TO TEST FOR       @Y30LB01*/ 02126000
*       /* VIRTUAL UNIT.                                     @Y30LB01*/ 02127000
*       /*                                                           */ 02128000
*       /*************************************************************/ 02129000
*                                                                  0679 02130000
*       TUCBPTR=NULLPTR;            /* CLEAR UCB PTR FIELD   @Y30LB01*/ 02131000
         ST    @15,TUCBPTR                                         0679 02132000
*       CKUCBPTR=ADDR(TUCBPTR);     /* UCBPTR PARM           @Y30LB01*/ 02133000
         LA    @15,TUCBPTR                                         0680 02134000
         ST    @15,CKUCBPTR(,@14)                                  0680 02135000
*       CKDDNAME=TRACDDN;           /* DDN FROM FDTTBL       @Y30LB01*/ 02136000
         MVC   CKDDNAME(8,@14),TRACDDN                             0681 02137000
*       CKTESTVT=ON;                /* VIRTUAL TEST PARM     @Y30LB01*/ 02138000
         OI    CKTESTVT(@14),B'10000000'                           0682 02139000
*       CKLABELP=VOLPTR;            /* VOLID PTR PARM        @Y30LB01   02140000
*                                                            @Y30LB01*/ 02141000
*                                                                  0683 02142000
         L     @15,VOLPTR                                          0683 02143000
         ST    @15,CKLABELP(,@14)                                  0683 02144000
*       /*************************************************************/ 02145000
*       /*                                                           */ 02146000
*       /* UMSSUNIT CALL TO TEST IF UNIT VIRTUAL             @Y30LB01*/ 02147000
*       /*                                                           */ 02148000
*       /*************************************************************/ 02149000
*                                                                  0684 02150000
*       CALL IDCSA060(GDTTBL,CHECK,CKAGL);/* CHECK VIA UMSSUNIT    0684 02151000
*                                                            @Y30LB01*/ 02152000
         L     @15,@PC00001                                        0684 02153000
         ST    @15,@AL00001                                        0684 02154000
         LA    @09,CHECK                                           0684 02155000
         ST    @09,@AL00001+4                                      0684 02156000
         ST    @14,@AL00001+8                                      0684 02157000
         MVI   @AL00001+8,X'80'                                    0684 02158000
         L     @15,GDTUNT(,@15)                                    0684 02159000
         LA    @01,@AL00001                                        0684 02160000
         BALR  @14,@15                                             0684 02161000
*       RESPECIFY                                                  0685 02162000
*         RTNREG RSTD;                                             0685 02163000
*       TESTRC=RTNREG;                                             0686 02164000
         STH   RTNREG,TESTRC                                       0686 02165000
*       RESPECIFY                                                  0687 02166000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   02167000
*                                                            @Y30LB01*/ 02168000
*                                                                  0687 02169000
*       /*************************************************************/ 02170000
*       /*                                                           */ 02171000
*       /* TEST RETURN FROM UMSSUNIT AND IF FAIL CODE        @Y30LB01*/ 02172000
*       /* RETURNED SET LASTCOND TO TERMINAL VALUE           @Y30LB01*/ 02173000
*       /*                                                           */ 02174000
*       /*************************************************************/ 02175000
*                                                                  0688 02176000
*       IF TESTRC^=0 THEN           /* BAD RETURN CODE       @Y30LB01*/ 02177000
         LH    @15,TESTRC                                          0688 02178000
         LTR   @15,@15                                             0688 02179000
         BZ    @RF00688                                            0688 02180000
*         LASTCOND=LASTCC12;        /* SET LASTCOND TO 12    @Y30LB01*/ 02181000
         L     @15,@PC00001+8                                      0689 02182000
         MVC   LASTCOND(2,@15),@CH00567                            0689 02183000
*     END;                          /* END VIRTUAL TEST      @Y30LB01*/ 02184000
*                                                                  0690 02185000
@RF00688 DS    0H                                                  0691 02186000
*   /*****************************************************************/ 02187000
*   /*                                                               */ 02188000
*   /* ******* END OF UMSSUNIT CODE TO VERIFY UNIT *******   @Y30LB01*/ 02189000
*   /*                                                               */ 02190000
*   /*****************************************************************/ 02191000
*                                                                  0691 02192000
*                                                                  0691 02193000
*   /*****************************************************************/ 02194000
*   /*                                                               */ 02195000
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN             @Y30LB01*/ 02196000
*   /*                                                               */ 02197000
*   /*****************************************************************/ 02198000
*                                                                  0691 02199000
*   RESPECIFY                                                      0691 02200000
*     REG14 RSTD;                   /* RESTRICT REG 14       @Y30LB01*/ 02201000
@RF00674 DS    0H                                                  0692 02202000
*   REG14=RETADDR1;                 /* RESTORE REG 14        @Y30LB01*/ 02203000
         L     REG14,RETADDR1                                      0692 02204000
*   RETURN CODE(LASTCOND);          /* RETURN TO CALLER      @Y30LB01*/ 02205000
         L     @09,@PC00001+8                                      0693 02206000
         LH    @15,LASTCOND(,@09)                                  0693 02207000
@EL00004 DS    0H                                                  0693 02208000
@EF00004 DS    0H                                                  0693 02209000
@ER00004 BR    @14                                                 0693 02210000
*   RESPECIFY                                                      0694 02211000
*     REG14 UNRSTD;                 /* FREE REG 14           @Y30LB01*/ 02212000
*   END TRALLOC;                    /* END PROCEDURE         @Y30LB01*/ 02213000
*                                                                  0696 02214000
*/*******************************************************    @Y30LB01*/ 02215000
*/*                                                          @Y30LB01*/ 02216000
*/* PROCEDURE NAME - TRPROCES                                @Y30LB01*/ 02217000
*/*                                                          @Y30LB01*/ 02218000
*/* FUNCTION - TO SET UP NECESSARY SEEK AND SEARCH           @Y30LB01*/ 02219000
*/*            ARGUMENTS AND ESTABLISH THE LIMIT             @Y30LB01*/ 02220000
*/*            SEARCH ARGUMENT. IT ALSO DETERMINES WHICH     @Y30LB01*/ 02221000
*/*            AREA TO DUMP FIRST IF BOTH IS SPECIFIED       @Y30LB01*/ 02222000
*/*            AND SETS THE SEARCH AND SEEK ARGUMENTS        @Y30LB01*/ 02223000
*/*            TO DUMP THE CORRECT AREA FIRST.               @Y30LB01*/ 02224000
*/*            MESSAGES ISSUED - IDC1841I TR02               @Y30LB01*/ 02225000
*/*                              IDC3842I TR03               @Y30LB01*/ 02226000
*/*                                                          @Y30LB01*/ 02227000
*/* INPUTS - FDTTBL,LASTCOND,CTMSG AREA                      @Y30LB01*/ 02228000
*/*                                                          @Y30LB01*/ 02229000
*/* OUTPUT - LASTCOND = 0 SUCCESSFUL FUNCTION                @Y30LB01*/ 02230000
*/*          LASTCOND = 4 WARNING WITH DUMP                  @Y30LB01*/ 02231000
*/*          LASTCOND = 12 TERMINAL ERROR                    @Y30LB01*/ 02232000
*/*                                                          @Y30LB01*/ 02233000
*/*******************************************************    @Y30LB01*/ 02234000
*                                                                  0696 02235000
*TRPROCES:                                                         0696 02236000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB01*/ 02237000
TRPROCES DS    0H                                                  0697 02238000
*                                                                  0697 02239000
*   /*****************************************************************/ 02240000
*   /*                                                               */ 02241000
*   /* SAVE CALLERS RETURN ADDRESS AND SET INTERNAL TRACE    @Y30LB01*/ 02242000
*   /*                                                               */ 02243000
*   /*****************************************************************/ 02244000
*                                                                  0697 02245000
*   RESPECIFY                                                      0697 02246000
*     REG14 RSTD;                   /* RESTRICT REG14        @Y30LB01*/ 02247000
*   RETADDR1=REG14;                 /* SAVE REG 14           @Y30LB01*/ 02248000
         ST    REG14,RETADDR1                                      0698 02249000
*   RESPECIFY                                                      0699 02250000
*     REG14 UNRSTD;                 /* FREE REG 14           @Y30LB01*/ 02251000
*   OLDERID2=NEWERID2;                                             0700 02252000
         L     @15,@PC00001                                        0700 02253000
         L     @14,GDTTR2(,@15)                                    0700 02254000
         MVC   @TS00001(95),NEWERID2(@14)                          0700 02255000
         MVC   OLDERID2(95,@14),@TS00001                           0700 02256000
*   NEWID2='TRAF';                  /* SET TRACE ID          @Y30LB01   02257000
*                                                            @Y30LB01*/ 02258000
*                                                                  0701 02259000
         MVC   NEWID2(4,@14),@CC01352                              0701 02260000
*   /*****************************************************************/ 02261000
*   /*                                                               */ 02262000
*   /* INITIALIZE THE LOOP COUNTER AND IOCS FIELDS           @Y30LB01*/ 02263000
*   /*                                                               */ 02264000
*   /*****************************************************************/ 02265000
*                                                                  0702 02266000
*   LOOPCNT=F1;                     /* INITIALIZE LOOP COUNT @Y30LB01*/ 02267000
         MVC   LOOPCNT(2),@CH00219                                 0702 02268000
*   IOCDAD=ADDR(OUTBLK);            /* PTR TO OUTPUT DATA    @Y30LB01*/ 02269000
         L     @14,IOCSPTR                                         0703 02270000
         L     @09,@CF01246                                        0703 02271000
         AL    @09,INBLKPTR                                        0703 02272000
         ST    @09,IOCDAD(,@14)                                    0703 02273000
*   IOCDLN=IOCTRN;                  /* SET O/P DATA LENGTH   @Y30LB01*/ 02274000
*                                                                  0704 02275000
         L     @09,IOCTRN(,@14)                                    0704 02276000
         ST    @09,IOCDLN(,@14)                                    0704 02277000
*   /*****************************************************************/ 02278000
*   /*                                                               */ 02279000
*   /* FOLLOWING ARRAY FIELDS NULLED,USED IN COMPARES ONLY   @Y30LB01*/ 02280000
*   /*                                                               */ 02281000
*   /*****************************************************************/ 02282000
*                                                                  0705 02283000
*   CURFILL=''B;                    /* NULL FILL AREA        @Y30LB01*/ 02284000
         XC    CURFILL(3),CURFILL                                  0705 02285000
*   LIMFILL(1)=''B;                 /* NULL FILL AREA        @Y30LB01*/ 02286000
         XC    LIMFILL(3),LIMFILL                                  0706 02287000
*   LIMFILL(2)=''B;                 /* NULL FILL AREA        @Y30LB01*/ 02288000
         XC    LIMFILL+8(3),LIMFILL+8                              0707 02289000
*   SEEKFILL(1)=''B;                /* NULL FILL AREA        @Y30LB01*/ 02290000
         XC    SEEKFILL(3),SEEKFILL                                0708 02291000
*   SEEKFILL(2)=''B;                /* NULL FILL AREA        @Y30LB01*/ 02292000
         XC    SEEKFILL+8(3),SEEKFILL+8                            0709 02293000
*   SRCHFILL(1)=''B;                /* NULL FILL AREA        @Y30LB01*/ 02294000
         XC    SRCHFILL(3),SRCHFILL                                0710 02295000
*   SRCHFILL(2)=''B;                /* NULL FILL AREA        @Y30LB01*/ 02296000
*                                                                  0711 02297000
         XC    SRCHFILL+8(3),SRCHFILL+8                            0711 02298000
*   /*****************************************************************/ 02299000
*   /*                                                               */ 02300000
*   /* IF BOTH WAS SPECIFIED THEN THE CURRENT DATA           @Y30LB01*/ 02301000
*   /* MUST BE A VALID VALUE BEFORE A DUMP IS MADE.          @Y30LB01*/ 02302000
*   /* IF THE CURRENT DATA POINTER IS VALID, THEN            @Y30LB01*/ 02303000
*   /* DETERMINE WHICH DATA AREA MUST BE DUMPED              @Y30LB01*/ 02304000
*   /* FIRST AND SET UP THE SEEK AND SEARCH                  @Y30LB01*/ 02305000
*   /* ARGUMENTS FOR THAT AREA, CALL TRACEIO TO              @Y30LB01*/ 02306000
*   /* DUMP THAT AREA, THEN SET UP SEEK AND SEARCH           @Y30LB01*/ 02307000
*   /* ARGUMENTS FOR THE OTHER AREA AND CALL TRACEIO         @Y30LB01*/ 02308000
*   /* TO DUMP THAT AREA.                                    @Y30LB01*/ 02309000
*   /*                                                               */ 02310000
*   /*****************************************************************/ 02311000
*                                                                  0712 02312000
*   IF ADDR(BOTH)^=NULLPTR THEN     /* BOTH SPECIFIED        @Y30LB01*/ 02313000
         L     @14,@PC00001+4                                      0712 02314000
         L     @14,FDTPTR+20(,@14)                                 0712 02315000
         LTR   @14,@14                                             0712 02316000
         BZ    @RF00712                                            0712 02317000
*     DO;                           /* PROCESS BOTH AREAS    @Y30LB01*/ 02318000
*                                                                  0713 02319000
*       /*************************************************************/ 02320000
*       /*                                                           */ 02321000
*       /* CHECK CURRENT DATA POINTER FIRST. IF ZERO THEN    @Y30LB01*/ 02322000
*       /* CONSIDER IT TERMINAL ERROR.                       @Y30LB01*/ 02323000
*       /*                                                           */ 02324000
*       /*************************************************************/ 02325000
*                                                                  0714 02326000
*       IF CTTBLCC(5)=F0&           /* CYL 0                 @Y30LB01*/ 02327000
*           CTTBLHH(5)=F0&          /* TRACK 0               @Y30LB01*/ 02328000
*           CTTBLRR(5)=F0 THEN      /* RECORD 0              @Y30LB01*/ 02329000
         L     @14,CTMSGPTR                                        0714 02330000
         CLI   CTTBLCC+16(@14),0                                   0714 02331000
         BNE   @RF00714                                            0714 02332000
         CLI   CTTBLHH+16(@14),0                                   0714 02333000
         BNE   @RF00714                                            0714 02334000
         CLI   CTTBLRR+16(@14),0                                   0714 02335000
         BNE   @RF00714                                            0714 02336000
*         DO;                       /* PROCESS AS ERROR      @Y30LB01*/ 02337000
*                                                                  0715 02338000
*           /*********************************************************/ 02339000
*           /*                                                       */ 02340000
*           /* SET UP UPRINT ARGUMENTS TO PRINT TRACE        @Y30LB01*/ 02341000
*           /* MESSAGE IDC3842I AND ISSUE UPRINT             @Y30LB01*/ 02342000
*           /*                                                       */ 02343000
*           /*********************************************************/ 02344000
*                                                                  0716 02345000
*           PRINTTAB=''B;           /* CLEAR PARM AREA       @Y30LB01*/ 02346000
         XC    PRINTTAB(20),PRINTTAB                               0716 02347000
*           DARGSENT=MSG3842I;      /* MESSAGE INDEX         @Y30LB01*/ 02348000
         L     @14,DDSTRU                                          0717 02349000
         MVI   DARGSENT(@14),X'03'                                 0717 02350000
*           DARGSMOD=TRAMSG;        /* MESSAGE MODULE        @Y30LB01   02351000
*                                                            @Y30LB01*/ 02352000
*                                                                  0718 02353000
         MVC   DARGSMOD(3,@14),@CC01280                            0718 02354000
*           /*********************************************************/ 02355000
*           /*                                                       */ 02356000
*           /* UPRINT CALL TO PRINT MESSAGE                  @Y30LB01*/ 02357000
*           /*                                                       */ 02358000
*           /*********************************************************/ 02359000
*                                                                  0719 02360000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* ISSUE UPRINT   0719 02361000
*                                                            @Y30LB01   02362000
*                                                            @Y30LB01*/ 02363000
         ST    @15,@AL00001                                        0719 02364000
         LA    @14,@CF00115                                        0719 02365000
         ST    @14,@AL00001+4                                      0719 02366000
         LA    @14,DDSTRU                                          0719 02367000
         ST    @14,@AL00001+8                                      0719 02368000
         MVI   @AL00001+8,X'80'                                    0719 02369000
         L     @15,GDTPRT(,@15)                                    0719 02370000
         LA    @01,@AL00001                                        0719 02371000
         BALR  @14,@15                                             0719 02372000
*           LASTCOND=LASTCC12;      /* SET LASTCOND TO 12    @Y30LB01*/ 02373000
         L     @15,@PC00001+8                                      0720 02374000
         MVC   LASTCOND(2,@15),@CH00567                            0720 02375000
*         END;                      /* END ERROR PROCESS     @Y30LB01*/ 02376000
*                                                                  0721 02377000
*       /*************************************************************/ 02378000
*       /*                                                           */ 02379000
*       /* VALID TWO AREA DUMP SO SET THE LOOPCNT            @Y30LB01*/ 02380000
*       /*                                                           */ 02381000
*       /*************************************************************/ 02382000
*                                                                  0722 02383000
*       LOOPCNT=F2;                 /* SET LOOPCNT TO 2      @Y30LB01*/ 02384000
*                                                                  0722 02385000
@RF00714 MVC   LOOPCNT(2),@CH00153                                 0722 02386000
*       /*************************************************************/ 02387000
*       /*                                                           */ 02388000
*       /* SEE WHICH AREA TO DUMP FIRST AND SWAP IF          @Y30LB01*/ 02389000
*       /* NECESSARY. IF THE CURRENT DATA POINTER IN         @Y30LB01*/ 02390000
*       /* ARRAY ELEMENT 5 FALLS WITHIN THE SECOND           @Y30LB01*/ 02391000
*       /* TRACE AREA DEFINED BY START ARRAY 3 AND           @Y30LB01*/ 02392000
*       /* END ARRAY 4 THEN THE ARRAY ELEMENTS MUST          @Y30LB01*/ 02393000
*       /* BE SWAPPED. THIS PROCEDURE PROCESSES              @Y30LB01*/ 02394000
*       /* THE TRACE AREAS FROM THE BOTTOM TO THE TOP        @Y30LB01*/ 02395000
*       /* OF THE ARRAY AND WILL THEREFORE PROCESS AREA      @Y30LB01*/ 02396000
*       /* ONE ARRAY LAST.                                   @Y30LB01*/ 02397000
*       /*                                                           */ 02398000
*       /*************************************************************/ 02399000
*                                                                  0723 02400000
*       IF LASTCOND=0 THEN          /* NO ERRORS             @Y30LB01*/ 02401000
         L     @15,@PC00001+8                                      0723 02402000
         LH    @15,LASTCOND(,@15)                                  0723 02403000
         LTR   @15,@15                                             0723 02404000
         BNZ   @RF00723                                            0723 02405000
*         DO;                       /* CONTINUE PROCESS      @Y30LB01*/ 02406000
*           IF TRCCHHR(5)<TRCCHHR(4)&/* AREA Y END           @ZM32883*/ 02407000
*               TRCCHHR(5)>TRCCHHR(3) THEN/* AREA Y START    @ZM32883*/ 02408000
         L     @15,CTMSGPTR                                        0725 02409000
         CLC   TRCCHHR+16(3,@15),TRCCHHR+12(@15)                   0725 02410000
         BNL   @RF00725                                            0725 02411000
         CLC   TRCCHHR+16(3,@15),TRCCHHR+8(@15)                    0725 02412000
         BNH   @RF00725                                            0725 02413000
*             DO;                   /* SWAP NEEDED           @Y30LB01*/ 02414000
*               CHRSAVE=TRCCHHR(3); /* SAVE ARRAY 3          @ZM32883*/ 02415000
         MVC   CHRSAVE(3),TRCCHHR+8(@15)                           0727 02416000
*               TRCCHHR(3)=TRCCHHR(1);/* SWAP 1 TO 3         @ZM32883*/ 02417000
         MVC   TRCCHHR+8(3,@15),TRCCHHR(@15)                       0728 02418000
*               TRCCHHR(1)=CHRSAVE; /* SWAP 3 TO 1           @ZM32883*/ 02419000
         MVC   TRCCHHR(3,@15),CHRSAVE                              0729 02420000
*               CHRSAVE=TRCCHHR(4); /* SAVE ARRAY 4          @ZM32883*/ 02421000
         MVC   CHRSAVE(3),TRCCHHR+12(@15)                          0730 02422000
*               TRCCHHR(4)=TRCCHHR(2);/* SWAP 2 TO 4         @ZM32883*/ 02423000
         MVC   TRCCHHR+12(3,@15),TRCCHHR+4(@15)                    0731 02424000
*               TRCCHHR(2)=CHRSAVE; /* SWAP 4 TO 2           @ZM32883*/ 02425000
         MVC   TRCCHHR+4(3,@15),CHRSAVE                            0732 02426000
*               TRSWAP=ON;          /* SET SWAP SWITCH       @Y30LB01*/ 02427000
         OI    TRSWAP,B'00010000'                                  0733 02428000
*             END;                  /* END SWAP              @Y30LB01*/ 02429000
*                                                                  0734 02430000
*           /*********************************************************/ 02431000
*           /*                                                       */ 02432000
*           /* SET UP SEEK AND SEARCH ARGUMENTS FOR THE      @Y30LB01*/ 02433000
*           /* FIRST AREA TO BE DUMPED.                      @Y30LB01*/ 02434000
*           /*                                                       */ 02435000
*           /*********************************************************/ 02436000
*                                                                  0735 02437000
*           IF TRSWAP=ON THEN       /* AREAS SWAPPED         @Y30LB01*/ 02438000
@RF00725 TM    TRSWAP,B'00010000'                                  0735 02439000
         BNO   @RF00735                                            0735 02440000
*             SEEKCC(2)=TRREALCC;   /* SEEK PER CTMSG        @ZM32883*/ 02441000
         L     @01,CTMSGPTR                                        0736 02442000
         MVC   SEEKCC+8(2),TRREALCC(@01)                           0736 02443000
*           ELSE                                                   0737 02444000
*             SEEKCC(2)=TRREALCC+CYLINC;/* 4 CYLS AHEAD      @ZM32883*/ 02445000
         B     @RC00735                                            0737 02446000
@RF00735 LA    @15,4                                               0737 02447000
         L     @14,CTMSGPTR                                        0737 02448000
         ICM   @14,12,TRREALCC(@14)                                0737 02449000
         SRA   @14,16                                              0737 02450000
         ALR   @15,@14                                             0737 02451000
         STH   @15,SEEKCC+8                                        0737 02452000
*           SEEKHH(2)=CTREALH;      /* SET HEAD              @Y30LB01*/ 02453000
@RC00735 L     @15,CTMSGPTR                                        0738 02454000
         SLR   @14,@14                                             0738 02455000
         IC    @14,CTREALH(,@15)                                   0738 02456000
         STH   @14,SEEKHH+8                                        0738 02457000
*           SEEKR(2)=F1;            /* ALWAYS REC 1          @Y30LB01*/ 02458000
         MVI   SEEKR+8,X'01'                                       0739 02459000
*           SRCHCC(2)=CTTBLCC(3);   /* START CYL             @Y30LB01*/ 02460000
         SLR   @14,@14                                             0740 02461000
         IC    @14,CTTBLCC+8(,@15)                                 0740 02462000
         STH   @14,SRCHCC+8                                        0740 02463000
*           SRCHHH(2)=CTTBLHH(3);   /* START HEAD            @Y30LB01*/ 02464000
         SLR   @14,@14                                             0741 02465000
         IC    @14,CTTBLHH+8(,@15)                                 0741 02466000
         STH   @14,SRCHHH+8                                        0741 02467000
*           SRCHR(2)=CTTBLRR(3);    /* START RECORD          @Y30LB01*/ 02468000
         MVC   SRCHR+8(1),CTTBLRR+8(@15)                           0742 02469000
*           LIMCC(2)=CTTBLCC(4);    /* END CYL               @Y30LB01*/ 02470000
         SLR   @14,@14                                             0743 02471000
         IC    @14,CTTBLCC+12(,@15)                                0743 02472000
         STH   @14,LIMCC+8                                         0743 02473000
*           LIMHH(2)=CTTBLHH(4);    /* END TRACK             @Y30LB01*/ 02474000
         SLR   @14,@14                                             0744 02475000
         IC    @14,CTTBLHH+12(,@15)                                0744 02476000
         STH   @14,LIMHH+8                                         0744 02477000
*           LIMR(2)=CTTBLRR(4);     /* END RECORD            @Y30LB01*/ 02478000
         MVC   LIMR+8(1),CTTBLRR+12(@15)                           0745 02479000
*         END;                      /* END SWAP CODE         @Y30LB01*/ 02480000
*     END;                          /* END BOTH CODE         @Y30LB01*/ 02481000
@RF00723 DS    0H                                                  0748 02482000
*                                                                  0748 02483000
*   /*****************************************************************/ 02484000
*   /*                                                               */ 02485000
*   /* REMAINING CODE IS DONE FOR SINGLE AREA OR BOTH        @Y30LB01*/ 02486000
*   /*                                                               */ 02487000
*   /*****************************************************************/ 02488000
*                                                                  0748 02489000
*   IF LASTCOND=0 THEN              /* NO ERRORS             @Y30LB01*/ 02490000
@RF00712 SLR   @15,@15                                             0748 02491000
         L     @14,@PC00001+8                                      0748 02492000
         CH    @15,LASTCOND(,@14)                                  0748 02493000
         BNE   @RF00748                                            0748 02494000
*     DO;                           /* CONTINUE PROCESS      @Y30LB01*/ 02495000
*                                                                  0749 02496000
*       /*************************************************************/ 02497000
*       /*                                                           */ 02498000
*       /* SET THE CURRENT CCHHR FROM THE PROPER COPY MSG    @Y30LB01*/ 02499000
*       /* ARRAY ELEMENT. IF TWO AREAS WERE REQUESTED THEN   @Y30LB01*/ 02500000
*       /* THE CURRENT CCHHR IS TAKEN FROM ARRAY ELEMENT     @Y30LB01*/ 02501000
*       /* 5. IF ONE AREA REQUESTED THEN ITS FROM ARRAY      @Y30LB01*/ 02502000
*       /* ELEMENT 3.                                        @Y30LB01*/ 02503000
*       /*                                                           */ 02504000
*       /*************************************************************/ 02505000
*                                                                  0750 02506000
*       IF ADDR(BOTH)^=NULLPTR THEN /* SET CURRENT           @Y30LB01*/ 02507000
         L     @14,@PC00001+4                                      0750 02508000
         C     @15,FDTPTR+20(,@14)                                 0750 02509000
         BE    @RF00750                                            0750 02510000
*         DO;                       /* PROPER FIELD          @Y30LB01*/ 02511000
*           CURRCC=CTTBLCC(5);      /* CURRENT CYL           @Y30LB01*/ 02512000
         L     @15,CTMSGPTR                                        0752 02513000
         SLR   @14,@14                                             0752 02514000
         IC    @14,CTTBLCC+16(,@15)                                0752 02515000
         STH   @14,CURRCC                                          0752 02516000
*           CURRHH=CTTBLHH(5);      /* CURRENT TRACK         @Y30LB01*/ 02517000
         SLR   @14,@14                                             0753 02518000
         IC    @14,CTTBLHH+16(,@15)                                0753 02519000
         STH   @14,CURRHH                                          0753 02520000
*           CURRR=CTTBLRR(5);       /* CURRENT RECORD        @Y30LB01*/ 02521000
         MVC   CURRR(1),CTTBLRR+16(@15)                            0754 02522000
*         END;                      /* END FOR BOTH OPTION   @Y30LB01*/ 02523000
*                                                                  0755 02524000
*       /*************************************************************/ 02525000
*       /*                                                           */ 02526000
*       /* SET CURRENT CCHHR FROM ARRAY ELEMENT 3            @Y30LB01*/ 02527000
*       /*                                                           */ 02528000
*       /*************************************************************/ 02529000
*                                                                  0756 02530000
*       ELSE                        /* SINGLE AREA OPTION    @Y30LB01*/ 02531000
*         DO;                       /* SET FOR SINGLE        @Y30LB01*/ 02532000
         B     @RC00750                                            0756 02533000
@RF00750 DS    0H                                                  0757 02534000
*           CURRCC=CTTBLCC(3);      /* CURRENT CYL           @Y30LB01*/ 02535000
         L     @15,CTMSGPTR                                        0757 02536000
         SLR   @14,@14                                             0757 02537000
         IC    @14,CTTBLCC+8(,@15)                                 0757 02538000
         STH   @14,CURRCC                                          0757 02539000
*           CURRHH=CTTBLHH(3);      /* CURRENT TRACK         @Y30LB01*/ 02540000
         SLR   @14,@14                                             0758 02541000
         IC    @14,CTTBLHH+8(,@15)                                 0758 02542000
         STH   @14,CURRHH                                          0758 02543000
*           CURRR=CTTBLRR(3);       /* CURRENT RECORD        @Y30LB01*/ 02544000
         MVC   CURRR(1),CTTBLRR+8(@15)                             0759 02545000
*         END;                      /* END SINGLE OPTION     @Y30LB01*/ 02546000
*                                                                  0760 02547000
*       /*************************************************************/ 02548000
*       /*                                                           */ 02549000
*       /* SET SEEK AND SEARCH ARGUMENTS FOR LAST OR         @Y30LB01*/ 02550000
*       /* ONLY AREA TO BE DUMPED.                           @Y30LB01*/ 02551000
*       /*                                                           */ 02552000
*       /*************************************************************/ 02553000
*                                                                  0761 02554000
*       IF ADDR(BOTH)^=NULLPTR&     /* TWO AREA SPECIFIED    @Y30LB01*/ 02555000
*           TRSWAP=ON THEN          /* SWAP MADE             @Y30LB01*/ 02556000
@RC00750 L     @15,@PC00001+4                                      0761 02557000
         L     @15,FDTPTR+20(,@15)                                 0761 02558000
         LTR   @15,@15                                             0761 02559000
         BZ    @RF00761                                            0761 02560000
         TM    TRSWAP,B'00010000'                                  0761 02561000
         BNO   @RF00761                                            0761 02562000
*         SEEKCC(1)=TRREALCC+CYLINC;/* ADD 4 TO CTMSG REALCC @ZM32883*/ 02563000
         LA    @15,4                                               0762 02564000
         L     @14,CTMSGPTR                                        0762 02565000
         ICM   @14,12,TRREALCC(@14)                                0762 02566000
         SRA   @14,16                                              0762 02567000
         ALR   @15,@14                                             0762 02568000
         STH   @15,SEEKCC                                          0762 02569000
*       ELSE                                                       0763 02570000
*         SEEKCC(1)=TRREALCC;       /* USE CTMSG REALCC AS IS@ZM32883*/ 02571000
         B     @RC00761                                            0763 02572000
@RF00761 L     @01,CTMSGPTR                                        0763 02573000
         MVC   SEEKCC(2),TRREALCC(@01)                             0763 02574000
*       SEEKHH(1)=CTREALH;          /* SET HEAD              @Y30LB01*/ 02575000
@RC00761 L     @15,CTMSGPTR                                        0764 02576000
         SLR   @14,@14                                             0764 02577000
         IC    @14,CTREALH(,@15)                                   0764 02578000
         STH   @14,SEEKHH                                          0764 02579000
*       SEEKR(1)=F1;                /* ALWAYS REC 1          @Y30LB01*/ 02580000
         MVI   SEEKR,X'01'                                         0765 02581000
*       SRCHCC(1)=CTTBLCC(1);       /* START CYL             @Y30LB01*/ 02582000
         SLR   @14,@14                                             0766 02583000
         IC    @14,CTTBLCC(,@15)                                   0766 02584000
         STH   @14,SRCHCC                                          0766 02585000
*       SRCHHH(1)=CTTBLHH(1);       /* START HEAD            @Y30LB01*/ 02586000
         SLR   @14,@14                                             0767 02587000
         IC    @14,CTTBLHH(,@15)                                   0767 02588000
         STH   @14,SRCHHH                                          0767 02589000
*       SRCHR(1)=CTTBLRR(1);        /* START RECORD          @Y30LB01*/ 02590000
         MVC   SRCHR(1),CTTBLRR(@15)                               0768 02591000
*       LIMCC(1)=CTTBLCC(2);        /* END CYL               @Y30LB01*/ 02592000
         SLR   @14,@14                                             0769 02593000
         IC    @14,CTTBLCC+4(,@15)                                 0769 02594000
         STH   @14,LIMCC                                           0769 02595000
*       LIMHH(1)=CTTBLHH(2);        /* END TRACK             @Y30LB01*/ 02596000
         SLR   @14,@14                                             0770 02597000
         IC    @14,CTTBLHH+4(,@15)                                 0770 02598000
         STH   @14,LIMHH                                           0770 02599000
*       LIMR(1)=CTTBLRR(2);         /* END RECORD            @Y30LB01*/ 02600000
         MVC   LIMR(1),CTTBLRR+4(@15)                              0771 02601000
*                                                                  0772 02602000
*       /*************************************************************/ 02603000
*       /*                                                           */ 02604000
*       /* DO LOOP TO DUMP ONE OR TWO AREAS OR UNTIL         @Y30LB01*/ 02605000
*       /* ERROR CONDITION.                                  @Y30LB01*/ 02606000
*       /*                                                           */ 02607000
*       /*************************************************************/ 02608000
*                                                                  0772 02609000
*       DO UNTIL LOOPCNT=F0|(LASTCOND>LASTCC04);/*           @Y30LB01*/ 02610000
*                                                                  0772 02611000
@DL00772 DS    0H                                                  0773 02612000
*         /***********************************************************/ 02613000
*         /*                                                         */ 02614000
*         /* IF CURRENT DATA WAS SPECIFIED AND THIS IS       @Y30LB01*/ 02615000
*         /* THE LAST AREA TO BE DUMPED THEN A LIMIT         @Y30LB01*/ 02616000
*         /* TO THE DUMP MUST BE ESTABLISHED.                @Y30LB01*/ 02617000
*         /*                                                         */ 02618000
*         /***********************************************************/ 02619000
*                                                                  0773 02620000
*         IF ADDR(ZXMAX)=NULLPTR&LOOPCNT=F1 THEN/* CURR      @Y30LB01*/ 02621000
         L     @15,@PC00001+4                                      0773 02622000
         L     @15,FDTPTR+36(,@15)                                 0773 02623000
         LTR   @15,@15                                             0773 02624000
         BNZ   @RF00773                                            0773 02625000
         LH    @15,LOOPCNT                                         0773 02626000
         LA    @14,1                                               0773 02627000
         CR    @15,@14                                             0773 02628000
         BNE   @RF00773                                            0773 02629000
*           DO;                     /* SEE IF IN AREA        @Y30LB01*/ 02630000
*                                                                  0774 02631000
*             /*******************************************************/ 02632000
*             /*                                                     */ 02633000
*             /* SET UP THE LIMITCHR TO EQUAL THE CURRENT    @Y30LB01*/ 02634000
*             /* DATA RECORD POINTER MINUS ONE IF THE        @Y30LB01*/ 02635000
*             /* CURRENT RECORD IS IN THE AREA NOW BEING     @Y30LB01*/ 02636000
*             /* PROCESSED & IS NOT ZERO.                    @Y30LB01*/ 02637000
*             /*                                                     */ 02638000
*             /*******************************************************/ 02639000
*                                                                  0775 02640000
*             IF CURCHR<=LIMITCHR(LOOPCNT)&/*                @ZM31000*/ 02641000
*                 CURCHR>SRCHCHR(LOOPCNT) THEN/*             @Y30LB01*/ 02642000
         SLA   @15,3                                               0775 02643000
         LA    @01,LIMITCHR-8(@15)                                 0775 02644000
         CLC   CURCHR(8),0(@01)                                    0775 02645000
         BH    @RF00775                                            0775 02646000
         LA    @01,SRCHCHR-8(@15)                                  0775 02647000
         CLC   CURCHR(8),0(@01)                                    0775 02648000
         BNH   @RF00775                                            0775 02649000
*               DO;                 /* IN CURRENT AREA       @Y30LB01*/ 02650000
*                 LIMITCHR(LOOPCNT)=CURCHR;/* SET LIMIT      @Y30LB01*/ 02651000
         LA    @01,LIMITCHR-8(@15)                                 0777 02652000
         MVC   0(8,@01),CURCHR                                     0777 02653000
*                 IF LIMR(LOOPCNT)>1 THEN/*                  @ZM31000*/ 02654000
         SLR   @09,@09                                             0778 02655000
         IC    @09,LIMR-8(@15)                                     0778 02656000
         CR    @09,@14                                             0778 02657000
         BNH   @RF00778                                            0778 02658000
*                   LIMR(LOOPCNT)=LIMR(LOOPCNT)-1;/*         @ZM31000*/ 02659000
         BCTR  @09,0                                               0779 02660000
         STC   @09,LIMR-8(@15)                                     0779 02661000
*                 ELSE              /*                       @ZM31000*/ 02662000
*                   IF LIMR(LOOPCNT)=1 THEN/*                @ZM31000*/ 02663000
         B     @RC00778                                            0780 02664000
@RF00778 LH    @15,LOOPCNT                                         0780 02665000
         SLA   @15,3                                               0780 02666000
         SLR   @14,@14                                             0780 02667000
         IC    @14,LIMR-8(@15)                                     0780 02668000
         C     @14,@CF00219                                        0780 02669000
         BNE   @RF00780                                            0780 02670000
*                     DO;           /*                       @ZM31000*/ 02671000
*                       LIMR(LOOPCNT)=32;/*                  @ZM31000*/ 02672000
         LA    @14,32                                              0782 02673000
         STC   @14,LIMR-8(@15)                                     0782 02674000
*                       IF LIMHH(LOOPCNT)=0 THEN/*           @ZM31000*/ 02675000
         LH    @14,LIMHH-8(@15)                                    0783 02676000
         LTR   @14,@14                                             0783 02677000
         BNZ   @RF00783                                            0783 02678000
*                         DO;       /*                       @ZM31000*/ 02679000
*                           LIMCC(LOOPCNT)=LIMCC(LOOPCNT)-1;       0785 02680000
         LH    @14,LIMCC-8(@15)                                    0785 02681000
         BCTR  @14,0                                               0785 02682000
         STH   @14,LIMCC-8(@15)                                    0785 02683000
*                           LIMHH(LOOPCNT)=18;/*             @ZM31000*/ 02684000
         LA    @14,18                                              0786 02685000
         STH   @14,LIMHH-8(@15)                                    0786 02686000
*                         END;      /*                       @ZM31000*/ 02687000
*                       ELSE        /*                       @ZM31000*/ 02688000
*                         LIMHH(LOOPCNT)=LIMHH(LOOPCNT)-1;         0788 02689000
         B     @RC00783                                            0788 02690000
@RF00783 LH    @15,LOOPCNT                                         0788 02691000
         SLA   @15,3                                               0788 02692000
         LH    @14,LIMHH-8(@15)                                    0788 02693000
         BCTR  @14,0                                               0788 02694000
         STH   @14,LIMHH-8(@15)                                    0788 02695000
*                     END;          /*                       @ZM31000*/ 02696000
*                   ELSE            /*                       @ZM31000*/ 02697000
*                     LIMR(LOOPCNT)=1;/*                     @ZM31000*/ 02698000
         B     @RC00780                                            0790 02699000
@RF00780 LH    @15,LOOPCNT                                         0790 02700000
         SLA   @15,3                                               0790 02701000
         LA    @14,1                                               0790 02702000
         STC   @14,LIMR-8(@15)                                     0790 02703000
*               END;                /* END CURRENT SET       @Y30LB01*/ 02704000
*                                                                  0791 02705000
*             /*******************************************************/ 02706000
*             /*                                                     */ 02707000
*             /* THE CURRENT DATA POINTER IS NOT AS          @Y30LB01*/ 02708000
*             /* EXPECTED. A WARNING MESSAGE MUST BE         @Y30LB01*/ 02709000
*             /* PRINTED UNLESS THE FOLLOWING CONDITIONS     @Y30LB01*/ 02710000
*             /* ARE MET:                                    @Y30LB01*/ 02711000
*             /* A. X OR Y DUMP AND CURRENT DATA PTR ^= 0    @Y30LB01*/ 02712000
*             /* B. INACTIVE DUMP REQUESTED                  @Y30LB01*/ 02713000
*             /*                                                     */ 02714000
*             /*******************************************************/ 02715000
*                                                                  0792 02716000
*             ELSE                  /* CHECK FOR ACTIVE REQ  @Y30LB01*/ 02717000
*               IF ADDR(INACT)=NULLPTR THEN/* INACT NOT SPEC @Y30LB01*/ 02718000
         B     @RC00775                                            0792 02719000
@RF00775 SLR   @15,@15                                             0792 02720000
         L     @14,@PC00001+4                                      0792 02721000
         C     @15,FDTPTR+28(,@14)                                 0792 02722000
         BNE   @RF00792                                            0792 02723000
*                 DO;               /* PROCESS ERROR         @Y30LB01*/ 02724000
*                   IF(ADDR(X)^=NULLPTR|/* X SPECIFIED       @Y30LB01*/ 02725000
*                       ADDR(Y)^=NULLPTR)&/* Y SPECIFIED     @Y30LB01*/ 02726000
*                       CURPTR>INVALID THEN                        0794 02727000
         C     @15,FDTPTR+12(,@14)                                 0794 02728000
         BNE   @GL00010                                            0794 02729000
         C     @15,FDTPTR+16(,@14)                                 0794 02730000
         BE    @RF00794                                            0794 02731000
@GL00010 CLC   CURPTR(5),@CB01295                                  0794 02732000
         BH    @RT00794                                            0794 02733000
*                     ;             /* VALID CURRENT         @Y30LB01*/ 02734000
*                   ELSE            /* WARNING MESSAGE       @Y30LB01*/ 02735000
*                     DO;           /* REQUIRED              @Y30LB01*/ 02736000
*                                                                  0796 02737000
@RF00794 DS    0H                                                  0797 02738000
*                       /*********************************************/ 02739000
*                       /*                                           */ 02740000
*                       /* SET UP UPRINT ARGS FOR MESSAGE    @Y30LB01*/ 02741000
*                       /* IDC1841I AND ISSUE UPRINT         @Y30LB01*/ 02742000
*                       /*                                           */ 02743000
*                       /*********************************************/ 02744000
*                                                                  0797 02745000
*                       PRINTTAB=''B;/* CLEAR AREA           @Y30LB01*/ 02746000
         XC    PRINTTAB(20),PRINTTAB                               0797 02747000
*                       DARGSENT=MSG1841I;/* SET MSG INDEX   @Y30LB01*/ 02748000
         L     @15,DDSTRU                                          0798 02749000
         MVI   DARGSENT(@15),X'02'                                 0798 02750000
*                       DARGSMOD=TRAMSG;/* SET MODULE ID     @Y30LB01*/ 02751000
*                                                                  0799 02752000
         MVC   DARGSMOD(3,@15),@CC01280                            0799 02753000
*                       /*********************************************/ 02754000
*                       /*                                           */ 02755000
*                       /* UPRINT CALL TO PRINT MESSAGE      @Y30LB01*/ 02756000
*                       /*                                           */ 02757000
*                       /*********************************************/ 02758000
*                                                                  0800 02759000
*                       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    0800 02760000
*                                      UPRINT                @Y30LB01*/ 02761000
         L     @15,@PC00001                                        0800 02762000
         ST    @15,@AL00001                                        0800 02763000
         LA    @14,@CF00115                                        0800 02764000
         ST    @14,@AL00001+4                                      0800 02765000
         LA    @14,DDSTRU                                          0800 02766000
         ST    @14,@AL00001+8                                      0800 02767000
         MVI   @AL00001+8,X'80'                                    0800 02768000
         L     @15,GDTPRT(,@15)                                    0800 02769000
         LA    @01,@AL00001                                        0800 02770000
         BALR  @14,@15                                             0800 02771000
*                       LASTCOND=LASTCC04;/* SET LASTCOND    @Y30LB01*/ 02772000
         L     @15,@PC00001+8                                      0801 02773000
         MVC   LASTCOND(2,@15),@CH00042                            0801 02774000
*                     END;          /* END WARNING MSG       @Y30LB01*/ 02775000
*                 END;              /* END ERROR PROCESS     @Y30LB01*/ 02776000
@RT00794 DS    0H                                                  0804 02777000
*           END;                    /* END SET LIMIT         @Y30LB01   02778000
*                                                            @Y30LB01*/ 02779000
*                                                                  0804 02780000
@RF00792 DS    0H                                                  0804 02781000
@RC00775 DS    0H                                                  0805 02782000
*         /***********************************************************/ 02783000
*         /*                                                         */ 02784000
*         /* CALL TRACEIO PROC TO DO THE I/O                 @Y30LB01*/ 02785000
*         /*                                                         */ 02786000
*         /***********************************************************/ 02787000
*                                                                  0805 02788000
*         CALL TRACEIO;             /* CALL IO ROUTINE       @Y30LB01   02789000
*                                                            @Y30LB01*/ 02790000
@RF00773 BAL   @14,TRACEIO                                         0805 02791000
*         LOOPCNT=LOOPCNT-F1;       /* DEC LOOP COUNT        @Y30LB01*/ 02792000
         LH    @15,LOOPCNT                                         0806 02793000
         BCTR  @15,0                                               0806 02794000
         STH   @15,LOOPCNT                                         0806 02795000
*       END;                        /* END DO UNTIL LOOP     @Y30LB01*/ 02796000
@DE00772 LH    @15,LOOPCNT                                         0807 02797000
         LTR   @15,@15                                             0807 02798000
         BZ    @DC00772                                            0807 02799000
         L     @15,@PC00001+8                                      0807 02800000
         LH    @15,LASTCOND(,@15)                                  0807 02801000
         C     @15,@CF00042                                        0807 02802000
         BNH   @DL00772                                            0807 02803000
@DC00772 DS    0H                                                  0808 02804000
*     END;                          /* END IO SETUP          @Y30LB01*/ 02805000
*                                                                  0809 02806000
*   /*****************************************************************/ 02807000
*   /*                                                               */ 02808000
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN             @Y30LB01*/ 02809000
*   /*                                                               */ 02810000
*   /*****************************************************************/ 02811000
*                                                                  0809 02812000
*   RESPECIFY                                                      0809 02813000
*     REG14 RSTD;                   /* RESTRICT REG 14       @Y30LB01*/ 02814000
@RF00748 DS    0H                                                  0810 02815000
*   REG14=RETADDR1;                 /* RESTORE REG 14        @Y30LB01*/ 02816000
         L     REG14,RETADDR1                                      0810 02817000
*   RETURN CODE(LASTCOND);          /* RETURN TO CALLER      @Y30LB01*/ 02818000
         L     @09,@PC00001+8                                      0811 02819000
         LH    @15,LASTCOND(,@09)                                  0811 02820000
@EL00005 DS    0H                                                  0811 02821000
@EF00005 DS    0H                                                  0811 02822000
@ER00005 BR    @14                                                 0811 02823000
*   RESPECIFY                                                      0812 02824000
*     REG14 UNRSTD;                 /* FREE REG 14           @Y30LB01*/ 02825000
*   END TRPROCES;                   /* END PROCEDURE         @Y30LB01*/ 02826000
*                                                                  0814 02827000
*/*******************************************************    @Y30LB01*/ 02828000
*/*                                                          @Y30LB01*/ 02829000
*/* PROCEDURE NAME - TRACEIO                                 @Y30LB01*/ 02830000
*/*                                                          @Y30LB01*/ 02831000
*/* FUNCTION - READ THE WORK FILE, VERIFY GOOD DATE,         @Y30LB01*/ 02832000
*/*            AND WRITE GOOD DATA TO THE OUTPUT             @Y30LB01*/ 02833000
*/*            FILE FOR ONE COMPLETE TRACE AREA EACH         @Y30LB01*/ 02834000
*/*            TIME THE PROC IS ENTERED.                     @Y30LB01*/ 02835000
*/*            MESSAGES ISSUED - IDC1840I TR01               @Y30LB01*/ 02836000
*/*                              IDC2843I TR04               @Y30LB01*/ 02837000
*/*                                                          @Y30LB01*/ 02838000
*/* INPUTS - FDTTBL,LASTCOND,LOOPCNT,                        @Y30LB01*/ 02839000
*/*          LIMIT-SEEK-SEARCH CCHHR ARRAYS                  @Y30LB01*/ 02840000
*/*                                                          @Y30LB01*/ 02841000
*/* OUTPUTS - LASTCOND = 0  FUNCTION SUCCESSFUL              @Y30LB01*/ 02842000
*/*           LASTCOND = 4  NULL DATA SET - NO DUMP          @Y30LB01*/ 02843000
*/*           LASTCOND = 8  SOME DATA DUMPED - WITH WARNING  @Y30LB01*/ 02844000
*/*           LASTCOND = 12 TERMINAL ERROR - NO DATA DUMPED  @Y30LB01*/ 02845000
*/*                                                          @Y30LB01*/ 02846000
*/*******************************************************    @Y30LB01*/ 02847000
*                                                                  0814 02848000
*TRACEIO:                                                          0814 02849000
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA);/*                  @Y30LB01*/ 02850000
TRACEIO  DS    0H                                                  0815 02851000
*                                                                  0815 02852000
*   /*****************************************************************/ 02853000
*   /*                                                               */ 02854000
*   /* SAVE CALLERS RETURN ADDRESS AND SET INTERNAL TRACE    @Y30LB01*/ 02855000
*   /*                                                               */ 02856000
*   /*****************************************************************/ 02857000
*                                                                  0815 02858000
*   RESPECIFY                                                      0815 02859000
*     REG14 RSTD;                   /* RESTRICT REG14        @Y30LB01*/ 02860000
*   RETADDR2=REG14;                 /* SAVE REG 14           @Y30LB01*/ 02861000
         ST    REG14,RETADDR2                                      0816 02862000
*   RESPECIFY                                                      0817 02863000
*     REG14 UNRSTD;                 /* FREE REG 14           @Y30LB01*/ 02864000
*   OLDERID2=NEWERID2;                                             0818 02865000
         L     @15,@PC00001                                        0818 02866000
         L     @15,GDTTR2(,@15)                                    0818 02867000
         MVC   @TS00001(95),NEWERID2(@15)                          0818 02868000
         MVC   OLDERID2(95,@15),@TS00001                           0818 02869000
*   NEWID2='TRAM';                  /* SET TRACE ID          @Y30LB01   02870000
*                                                            @Y30LB01*/ 02871000
*                                                                  0819 02872000
         MVC   NEWID2(4,@15),@CC01357                              0819 02873000
*   /*****************************************************************/ 02874000
*   /*                                                               */ 02875000
*   /* CLEAR AND SET IO COUNTERS AND SET FIXED EXGARG        @Y30LB01*/ 02876000
*   /* FIELDS.                                               @Y30LB01*/ 02877000
*   /*                                                               */ 02878000
*   /*****************************************************************/ 02879000
*                                                                  0820 02880000
*   BUFFUL=IOCTRN/RECLN;            /* SET BUFFER FULL CNT   @Y30LB01*/ 02881000
*                                                                  0820 02882000
         L     @01,IOCSPTR                                         0820 02883000
         L     @00,IOCTRN(,@01)                                    0820 02884000
         SRDA  @00,32                                              0820 02885000
         D     @00,@CF01258                                        0820 02886000
         STH   @01,BUFFUL                                          0820 02887000
*   /*****************************************************************/ 02888000
*   /*                                                               */ 02889000
*   /* IF BOTH SPECIFIED AND THIS IS SECOND AREA THEN DONT   @Y30LB01*/ 02890000
*   /* RESET THE OUTPUT COUNTER OR BUFFER COUNT              @Y30LB01*/ 02891000
*   /*                                                               */ 02892000
*   /*****************************************************************/ 02893000
*                                                                  0821 02894000
*   IF ADDR(BOTH)^=NULLPTR&         /* BOTH SPECIFIED        @Y30LB01*/ 02895000
*       LOOPCNT=F1 THEN                                            0821 02896000
         L     @15,@PC00001+4                                      0821 02897000
         L     @00,FDTPTR+20(,@15)                                 0821 02898000
         LTR   @00,@00                                             0821 02899000
         BZ    @RF00821                                            0821 02900000
         CLC   LOOPCNT(2),@CH00219                                 0821 02901000
         BE    @RT00821                                            0821 02902000
*     ;                             /* LAST AREA TO BE DMPD  @Y30LB01*/ 02903000
*   ELSE                            /* RESET OUTCNT BUFCNT   @Y30LB01*/ 02904000
*     DO;                           /* RESET COUNTS          @Y30LB01*/ 02905000
@RF00821 DS    0H                                                  0824 02906000
*       BUFCNT=F0;                  /* BUFFER COUNT          @Y30LB01*/ 02907000
         SLR   @15,@15                                             0824 02908000
         STH   @15,BUFCNT                                          0824 02909000
*       OUTCNT=F0;                  /* OUTPUT COUNT          @Y30LB01*/ 02910000
         STH   @15,OUTCNT                                          0825 02911000
*     END;                          /* END RESET             @Y30LB01*/ 02912000
*   EXITSW=OFF;                     /* DO LOOP EXIT SWITCH   @Y30LB01*/ 02913000
@RT00821 NI    EXITSW,B'11111011'                                  0827 02914000
*   WGETPTR=ADDR(WGETLST);          /* POINTER TO EXGARG     @Y30LB01*/ 02915000
         LA    @00,WGETLST                                         0828 02916000
         ST    @00,WGETPTR                                         0828 02917000
*   RESPECIFY                                                      0829 02918000
*     EXGARG BASED(WGETPTR);        /* EXGARG BASE           @Y30LB01*/ 02919000
*                                                                  0829 02920000
*   /*****************************************************************/ 02921000
*   /*                                                               */ 02922000
*   /* INITIALIZE UEXCP GET ARGUMENTS                        @Y30LB01*/ 02923000
*   /*                                                               */ 02924000
*   /*****************************************************************/ 02925000
*                                                                  0830 02926000
*   EXGARG=''B;                     /* CLEAR EXGARG AREA     @Y30LB01*/ 02927000
         LR    @15,@00                                             0830 02928000
         XC    EXGARG(32,@15),EXGARG(@15)                          0830 02929000
*   EXGRECNO=TRKLN;                 /* NUM RECS TO GET       @Y30LB01*/ 02930000
         LR    @15,@00                                             0831 02931000
         MVC   EXGRECNO(4,@15),@CF00221                            0831 02932000
*   EXGDATAP=ADDR(INBUF);           /* PTR TO INPUT BUFFER   @Y30LB01*/ 02933000
         L     @15,INBLKPTR                                        0832 02934000
         LR    @14,@00                                             0832 02935000
         ST    @15,EXGDATAP(,@14)                                  0832 02936000
*   EXGKEYLN=F0;                    /* ZERO KEY LENGTH       @Y30LB01*/ 02937000
         LR    @15,@00                                             0833 02938000
         MVI   EXGKEYLN(@15),X'00'                                 0833 02939000
*   EXGDATAL=RECLN;                 /* RECORD LENGTH         @Y30LB01*/ 02940000
         LR    @15,@00                                             0834 02941000
         MVC   EXGDATAL(2,@15),@CH01258                            0834 02942000
*   EXGCTLBK=IOBPTR;                /* IO BLOCK POINTER      @Y30LB01*/ 02943000
*                                                                  0835 02944000
         L     @15,IOBPTR                                          0835 02945000
         LR    @14,@00                                             0835 02946000
         ST    @15,EXGCTLBK(,@14)                                  0835 02947000
*   /*****************************************************************/ 02948000
*   /*                                                               */ 02949000
*   /* SET UP DO LOOP TO READ ALL TRACKS OF A TRACE AREA.    @Y30LB01*/ 02950000
*   /* 4 CYLS, 19 TRACKS PER CYL, 76 TRACKS TOTAL.           @Y30LB01*/ 02951000
*   /* READ LOOP ENDS ON IO ERROR, NULL AREA ENCOUNTERED,    @Y30LB01*/ 02952000
*   /* OR THE CURRENT DATA POINTER IS EXCEEDED.              @Y30LB01*/ 02953000
*   /*                                                               */ 02954000
*   /*****************************************************************/ 02955000
*                                                                  0836 02956000
*   DO READCNT=1 TO(CYLINC*CYLLN) WHILE EXITSW=OFF;/*        @Y30LB01*/ 02957000
         LA    @00,1                                               0836 02958000
         STH   @00,READCNT                                         0836 02959000
@DL00836 TM    EXITSW,B'00000100'                                  0836 02960000
         BNZ   @DC00836                                            0836 02961000
*     IF LIMITCHR(LOOPCNT)>         /* SETS READ             @Y30LB01*/ 02962000
*         SRCHCHR(LOOPCNT) THEN     /* LIMIT FOR             @Y30LB01*/ 02963000
         LH    @15,LOOPCNT                                         0837 02964000
         SLA   @15,3                                               0837 02965000
         LA    @14,LIMITCHR-8(@15)                                 0837 02966000
         LA    @09,SRCHCHR-8(@15)                                  0837 02967000
         CLC   0(8,@14),0(@09)                                     0837 02968000
         BNH   @RF00837                                            0837 02969000
*       DO;                         /* CURRENT SPECIFIED     @Y30LB01*/ 02970000
*         EXGCCHH1=ADDR(SEEKCHR(LOOPCNT));/* SET SEEK PTR    @Y30LB01*/ 02971000
         L     @14,WGETPTR                                         0839 02972000
         LA    @00,SEEKCHR-8(@15)                                  0839 02973000
         ST    @00,EXGCCHH1(,@14)                                  0839 02974000
*         EXGCCHH2=ADDR(SRCHCHR(LOOPCNT));/* SET SEARCH PTR  @Y30LB01   02975000
*                                                            @Y30LB01*/ 02976000
*                                                                  0840 02977000
         LA    @15,SRCHCHR-8(@15)                                  0840 02978000
         ST    @15,EXGCCHH2(,@14)                                  0840 02979000
*         /***********************************************************/ 02980000
*         /*                                                         */ 02981000
*         /* UEXCP CALL TO READ WORK FILE TRACK              @Y30LB01*/ 02982000
*         /*                                                         */ 02983000
*         /***********************************************************/ 02984000
*                                                                  0841 02985000
*         CALL IDCIO050(GDTTBL,GET,EXGARG);/* UEXCP CALL     @Y30LB01*/ 02986000
         L     @15,@PC00001                                        0841 02987000
         ST    @15,@AL00001                                        0841 02988000
         LA    @00,GET                                             0841 02989000
         ST    @00,@AL00001+4                                      0841 02990000
         ST    @14,@AL00001+8                                      0841 02991000
         MVI   @AL00001+8,X'80'                                    0841 02992000
         L     @15,GDTEXP(,@15)                                    0841 02993000
         LA    @01,@AL00001                                        0841 02994000
         BALR  @14,@15                                             0841 02995000
*         RESPECIFY                                                0842 02996000
*           RTNREG RSTD;                                           0842 02997000
*         TESTRC=RTNREG;                                           0843 02998000
         STH   RTNREG,TESTRC                                       0843 02999000
*         RESPECIFY                                                0844 03000000
*           RTNREG UNRSTD;          /* SAVE RETURN CODE      @Y30LB01   03001000
*                                                            @Y30LB01*/ 03002000
*                                                                  0844 03003000
*         /***********************************************************/ 03004000
*         /*                                                         */ 03005000
*         /* TEST RETURN FROM UEXCP AND IF FAIL CODE         @Y30LB01*/ 03006000
*         /* RETURNED SET SWITCH TO EXIT LOOP                @Y30LB01*/ 03007000
*         /* AND SET LASTCOND TO TERMINAL VALUE              @Y30LB01*/ 03008000
*         /*                                                         */ 03009000
*         /***********************************************************/ 03010000
*                                                                  0845 03011000
*         IF TESTRC^=0 THEN         /* BAD RETURN            @Y30LB01*/ 03012000
         LH    @15,TESTRC                                          0845 03013000
         LTR   @15,@15                                             0845 03014000
         BZ    @RF00845                                            0845 03015000
*           DO;                     /* ERROR PROCESS         @Y30LB01*/ 03016000
*             EXITSW=ON;            /* SET LOOP EXIT SW      @Y30LB01*/ 03017000
         OI    EXITSW,B'00000100'                                  0847 03018000
*             LASTCOND=LASTCC12;    /* SET LASTCOND TO 12    @Y30LB01*/ 03019000
         L     @15,@PC00001+8                                      0848 03020000
         MVC   LASTCOND(2,@15),@CH00567                            0848 03021000
*           END;                    /* END ERROR PROCESS     @Y30LB01*/ 03022000
*                                                                  0849 03023000
*         /***********************************************************/ 03024000
*         /*                                                         */ 03025000
*         /* ON GOOD UEXCP RETURN, CHECK THE DATA            @Y30LB01*/ 03026000
*         /* READ FOR A NULL FILE IF THIS READ               @Y30LB01*/ 03027000
*         /* WAS FOR THE FIRST TRACK OF AN AREA.             @Y30LB01*/ 03028000
*         /*                                                         */ 03029000
*         /***********************************************************/ 03030000
*                                                                  0850 03031000
*         ELSE                      /* PROCESS THE INPUT     @Y30LB01*/ 03032000
*           DO;                     /* DATA                  @Y30LB01*/ 03033000
*                                                                  0850 03034000
         B     @RC00845                                            0850 03035000
@RF00845 DS    0H                                                  0851 03036000
*             /*******************************************************/ 03037000
*             /*                                                     */ 03038000
*             /* IF THE DATA AREA IS NULL THEN SET           @Y30LB01*/ 03039000
*             /* SWITCH TO EXIT THE LOOP AND SET             @Y30LB01*/ 03040000
*             /* LASTCOND TO WARNING VALUE                   @Y30LB01*/ 03041000
*             /* FIRST, TEST FOR TRACK OF AREA BEING READ    @Y30LB01*/ 03042000
*             /* AND BOTH AREAS SPECIFIED.                   @Y30LB01*/ 03043000
*             /*                                                     */ 03044000
*             /*******************************************************/ 03045000
*                                                                  0851 03046000
*             IF READCNT=F1&        /* FIRST TRACK OF AREA   @Y30LB01*/ 03047000
*                 ADDR(BOTH)^=NULLPTR THEN/* TWO AREA DUMP   @Y30LB01*/ 03048000
         CLC   READCNT(2),@CH00219                                 0851 03049000
         BNE   @RF00851                                            0851 03050000
         L     @15,@PC00001+4                                      0851 03051000
         L     @00,FDTPTR+20(,@15)                                 0851 03052000
         LTR   @00,@00                                             0851 03053000
         BZ    @RF00851                                            0851 03054000
*               DO;                 /* JUST READ IN          @Y30LB01*/ 03055000
*                                                                  0852 03056000
*                 /***************************************************/ 03057000
*                 /*                                                 */ 03058000
*                 /* NEXT TEST THE SECOND RECORD OF THE      @Y30LB01*/ 03059000
*                 /* AREA TO SEE IF IT IS NULL.              @Y30LB01*/ 03060000
*                 /* IF THIS AREA IS NULL SET FLAG TO        @Y30LB01*/ 03061000
*                 /* INDICATE THE FIRST AREA IN A TWO        @Y30LB01*/ 03062000
*                 /* AREA DUMP IS NULL.                      @Y30LB01*/ 03063000
*                 /*                                                 */ 03064000
*                 /***************************************************/ 03065000
*                                                                  0853 03066000
*                 IF LOOPCNT=F2&    /* FIRST OF TWO AREAS    @Y30LB01*/ 03067000
*                     DATACNT(2)=F0 THEN/* 1ST DATA REC NULL @Y30LB01*/ 03068000
         CLC   LOOPCNT(2),@CH00153                                 0853 03069000
         BNE   @RF00853                                            0853 03070000
         L     @15,INBLKPTR                                        0853 03071000
         CLI   DATACNT+264(@15),0                                  0853 03072000
         BNE   @RF00853                                            0853 03073000
*                   DO;             /* SET UP FOR EXIT       @Y30LB01*/ 03074000
*                     EXITSW=ON;    /* SET EXIT SWITCH ON    @Y30LB01*/ 03075000
*                     TRNULL=ON;    /* SET NULL DATA SWITCH  @Y30LB01*/ 03076000
         OI    EXITSW,B'00001100'                                  0856 03077000
*                   END;            /* END NULL EXIT CODE    @Y30LB01*/ 03078000
*                                                                  0857 03079000
*                 /***************************************************/ 03080000
*                 /*                                                 */ 03081000
*                 /* FOR THE SECOND AREA OF A TWO AREA       @Y30LB01*/ 03082000
*                 /* DUMP, TEST THE SECOND RECORD FOR        @Y30LB01*/ 03083000
*                 /* NULL AND IF THE FIRST AREA WAS ALSO     @Y30LB01*/ 03084000
*                 /* NULL, THEN SET THE LASTCOND TO A        @Y30LB01*/ 03085000
*                 /* VALUE OF 4 AND SET THE EXIT SWITCH      @Y30LB01*/ 03086000
*                 /* ON.                                     @Y30LB01*/ 03087000
*                 /*                                                 */ 03088000
*                 /***************************************************/ 03089000
*                                                                  0858 03090000
*                 ELSE              /* LAST OF TWO AREAS     @Y30LB01*/ 03091000
*                   IF LOOPCNT=F1&  /* FIRST OF TWO AREAS    @Y30LB01*/ 03092000
*                       DATACNT(2)=F0&/* 1ST DATA REC NULL   @Y30LB01*/ 03093000
*                       TRNULL=ON THEN/* OTHER AREA ALSO NULL      0858 03094000
*                                                            @Y30LB01*/ 03095000
         B     @RC00853                                            0858 03096000
@RF00853 CLC   LOOPCNT(2),@CH00219                                 0858 03097000
         BNE   @RF00858                                            0858 03098000
         L     @15,INBLKPTR                                        0858 03099000
         CLI   DATACNT+264(@15),0                                  0858 03100000
         BNE   @RF00858                                            0858 03101000
         TM    TRNULL,B'00001000'                                  0858 03102000
         BNO   @RF00858                                            0858 03103000
*                     DO;           /* SET UP FOR ERROR      @Y30LB01*/ 03104000
*                       EXITSW=ON;  /* SET SW TO EXIT LOOP   @Y30LB01*/ 03105000
         OI    EXITSW,B'00000100'                                  0860 03106000
*                       LASTCOND=LASTCC04;/* SET LASTCOND    @Y30LB01*/ 03107000
         L     @15,@PC00001+8                                      0861 03108000
         MVC   LASTCOND(2,@15),@CH00042                            0861 03109000
*                     END;          /* END ERROR PROCESS     @Y30LB01*/ 03110000
*               END;                /* END NULL CHECK        @Y30LB01*/ 03111000
*                                                                  0863 03112000
@RF00858 DS    0H                                                  0863 03113000
@RC00853 DS    0H                                                  0864 03114000
*             /*******************************************************/ 03115000
*             /*                                                     */ 03116000
*             /* IF THIS IS A SINGLE AREA DUMP THEN TEST     @Y30LB01*/ 03117000
*             /* THE SECOND RECORD OF THE AREA FOR NULL      @Y30LB01*/ 03118000
*             /* IF IT IS NULL, SET SWITCH TO EXIT AND       @Y30LB01*/ 03119000
*             /* SET LASTCOND TO VALUE OF 4.                 @Y30LB01*/ 03120000
*             /*                                                     */ 03121000
*             /*******************************************************/ 03122000
*                                                                  0864 03123000
*             IF READCNT=F1&        /* ONE AREA DUMP         @Y30LB01*/ 03124000
*                 ADDR(BOTH)=NULLPTR&/* SINGLE AREA REQUEST  @Y30LB01*/ 03125000
*                 DATACNT(2)=F0 THEN/* AREA IS NULL          @Y30LB01*/ 03126000
@RF00851 CLC   READCNT(2),@CH00219                                 0864 03127000
         BNE   @RF00864                                            0864 03128000
         L     @15,@PC00001+4                                      0864 03129000
         L     @00,FDTPTR+20(,@15)                                 0864 03130000
         LTR   @00,@00                                             0864 03131000
         BNZ   @RF00864                                            0864 03132000
         L     @15,INBLKPTR                                        0864 03133000
         CLI   DATACNT+264(@15),0                                  0864 03134000
         BNE   @RF00864                                            0864 03135000
*               DO;                 /* SET UP FOR ERROR      @Y30LB01*/ 03136000
*                 TRNULL=ON;        /* SET NULL DATA SWITCH  @Y30LB01*/ 03137000
*                 EXITSW=ON;        /* SET SW TO EXIT LOOP   @Y30LB01*/ 03138000
         OI    TRNULL,B'00001100'                                  0867 03139000
*                 LASTCOND=LASTCC04;/* SET LASTCOND          @Y30LB01*/ 03140000
         L     @15,@PC00001+8                                      0868 03141000
         MVC   LASTCOND(2,@15),@CH00042                            0868 03142000
*               END;                /* END ERROR PROCESS     @Y30LB01*/ 03143000
*                                                                  0870 03144000
*             /*******************************************************/ 03145000
*             /*                                                     */ 03146000
*             /* SET UP LOOP TO PROCESS THE 32 WORK          @Y30LB01*/ 03147000
*             /* RECORDS FROM THE INPUT BUFFER TO THE        @Y30LB01*/ 03148000
*             /* OUTPUT BUFFER. IF THE OUTPUT BUFFER GETS    @Y30LB01*/ 03149000
*             /* FULL, WRITE IT TO THE OUTPUT FILE USING     @Y30LB01*/ 03150000
*             /* UPUT FACILITIES. THE RECORD PROCESSING LOOP @Y30LB01*/ 03151000
*             /* IS ENDED ON AN IO ERROR, THE LAST CURRENT   @Y30LB01*/ 03152000
*             /* DATA RECORD PROCESSED, OR A TRACE TRAILER   @Y30LB01*/ 03153000
*             /* RECORD IS PROCESSED AND MAX NOT SPECIFIED.  @Y30LB01*/ 03154000
*             /*                                                     */ 03155000
*             /*******************************************************/ 03156000
*                                                                  0870 03157000
*             DO MOVECNT=1 TO TRKLN WHILE EXITSW=OFF;/*      @Y30LB01*/ 03158000
@RF00864 LA    @00,1                                               0870 03159000
         STH   @00,MOVECNT                                         0870 03160000
@DL00870 TM    EXITSW,B'00000100'                                  0870 03161000
         BNZ   @DC00870                                            0870 03162000
*               SRCHR(LOOPCNT)=MOVECNT;/* TO TEST LAST REC   @Y30LB01*/ 03163000
         LH    @15,LOOPCNT                                         0871 03164000
         SLA   @15,3                                               0871 03165000
         STC   @00,SRCHR-8(@15)                                    0871 03166000
*               IF(SRCHCHR(LOOPCNT)>/* SEARCH CHR >          @Y30LB01*/ 03167000
*                   LIMITCHR(LOOPCNT))|/* LIMIT CHR          @Y30LB01*/ 03168000
*                   (ADDR(ZXMAX)=NULLPTR&/* CURRENT DATA ONLY      0872 03169000
*                                                            @Y30LB01*/ 03170000
*                   RECTYPE(MOVECNT)=TRLRCODE) THEN/* TRA TRLR     0872 03171000
*                                                            @Y30LB01*/ 03172000
         LA    @14,SRCHCHR-8(@15)                                  0872 03173000
         LA    @09,LIMITCHR-8(@15)                                 0872 03174000
         CLC   0(8,@14),0(@09)                                     0872 03175000
         BH    @RT00872                                            0872 03176000
         L     @15,@PC00001+4                                      0872 03177000
         L     @15,FDTPTR+36(,@15)                                 0872 03178000
         LTR   @15,@15                                             0872 03179000
         BNZ   @RF00872                                            0872 03180000
         MH    @00,@CH01258                                        0872 03181000
         L     @15,INBLKPTR                                        0872 03182000
         LR    @14,@00                                             0872 03183000
         AL    @15,@CF01405                                        0872 03184000
         SLR   @00,@00                                             0872 03185000
         IC    @00,RECTYPE-10(@14,@15)                             0872 03186000
         C     @00,@CF00548                                        0872 03187000
         BNE   @RF00872                                            0872 03188000
@RT00872 DS    0H                                                  0873 03189000
*                 EXITSW=ON;        /* SET EXIT SWITCH ON    @Y30LB01*/ 03190000
         OI    EXITSW,B'00000100'                                  0873 03191000
*               ELSE                /* MOVE RECORD           @Y30LB01*/ 03192000
*                 DO;               /* TO OUTPUT             @Y30LB01*/ 03193000
         B     @RC00872                                            0874 03194000
@RF00872 DS    0H                                                  0875 03195000
*                   BUFCNT=BUFCNT+1;/* INCREMENT COUNT       @Y30LB01*/ 03196000
         LA    @00,1                                               0875 03197000
         AH    @00,BUFCNT                                          0875 03198000
         STH   @00,BUFCNT                                          0875 03199000
*                   OUTPREF(BUFCNT)=PREFIX(MOVECNT);/* MVC   @Y30LB01*/ 03200000
         LA    @15,264                                             0876 03201000
         LR    @03,@00                                             0876 03202000
         MR    @02,@15                                             0876 03203000
         L     @02,INBLKPTR                                        0876 03204000
         L     @14,@CF01246                                        0876 03205000
         ALR   @14,@02                                             0876 03206000
         ST    @03,@TF00001                                        0876 03207000
         ALR   @03,@14                                             0876 03208000
         AL    @03,@CF01406                                        0876 03209000
         MH    @15,MOVECNT                                         0876 03210000
         ST    @15,@TF00002                                        0876 03211000
         ALR   @15,@02                                             0876 03212000
         AL    @15,@CF01406                                        0876 03213000
         MVC   OUTPREF(8,@03),PREFIX(@15)                          0876 03214000
*                   OUTDATA(BUFCNT)=TRACDATA(MOVECNT);/* MVC @Y30LB01*/ 03215000
*                                                                  0877 03216000
         LR    @15,@14                                             0877 03217000
         AL    @15,@TF00001                                        0877 03218000
         AL    @15,@CF01407                                        0877 03219000
         AL    @02,@TF00002                                        0877 03220000
         AL    @02,@CF01407                                        0877 03221000
         MVC   OUTDATA-8(256,@15),TRACDATA-8(@02)                  0877 03222000
*                   /*************************************************/ 03223000
*                   /*                                               */ 03224000
*                   /* TEST FOR FULL BUFFER AND IF FULL THEN @Y30LB01*/ 03225000
*                   /* WRITE THE FULL BUFFER TO OUTPUT FILE. @Y30LB01*/ 03226000
*                   /*                                               */ 03227000
*                   /*************************************************/ 03228000
*                                                                  0878 03229000
*                   IF BUFCNT>=BUFFUL THEN/* WRITE OUT BUFFER      0878 03230000
*                                                            @Y30LB01*/ 03231000
         CH    @00,BUFFUL                                          0878 03232000
         BL    @RF00878                                            0878 03233000
*                     DO;           /* TO OUTPUT DATASET     @Y30LB01*/ 03234000
*                                                                  0879 03235000
*                       /*********************************************/ 03236000
*                       /*                                           */ 03237000
*                       /* UPUT CALL TO WRITE OUTPUT BUFFER  @Y30LB01*/ 03238000
*                       /*                                           */ 03239000
*                       /*********************************************/ 03240000
*                                                                  0880 03241000
*                       IOCDAD=ADDR(OUTBLK);/*               @ZM30736*/ 03242000
         L     @15,IOCSPTR                                         0880 03243000
         ST    @14,IOCDAD(,@15)                                    0880 03244000
*                       IOCDLN=IOCTRN;/*                     @ZM30736*/ 03245000
         L     @14,IOCTRN(,@15)                                    0881 03246000
         ST    @14,IOCDLN(,@15)                                    0881 03247000
*                       CALL IDCIOPT0(GDTTBL,IOCSPTR);/* UPUT CALL 0882 03248000
*                                                            @Y30LB01*/ 03249000
         L     @00,@PC00001                                        0882 03250000
         LR    @15,@00                                             0882 03251000
         ST    @15,@AL00001                                        0882 03252000
         LA    @15,IOCSPTR                                         0882 03253000
         ST    @15,@AL00001+4                                      0882 03254000
         MVI   @AL00001+4,X'80'                                    0882 03255000
         LR    @14,@00                                             0882 03256000
         L     @15,GDTPUT(,@14)                                    0882 03257000
         LA    @01,@AL00001                                        0882 03258000
         BALR  @14,@15                                             0882 03259000
*                       RESPECIFY                                  0883 03260000
*                         RTNREG RSTD;                             0883 03261000
*                       TESTRC=RTNREG;                             0884 03262000
         STH   RTNREG,TESTRC                                       0884 03263000
*                       RESPECIFY                                  0885 03264000
*                         RTNREG UNRSTD;/* SAVE RETURN CODE  @Y30LB01   03265000
*                                                            @Y30LB01*/ 03266000
*                                                                  0885 03267000
*                       /*********************************************/ 03268000
*                       /*                                           */ 03269000
*                       /* TEST UPUT RETURN AND IF FAIL CODE @Y30LB01*/ 03270000
*                       /* SET EXIT SWITCH AND SET LASTCOND  @Y30LB01*/ 03271000
*                       /* TO TERMINAL VALUE                 @Y30LB01*/ 03272000
*                       /*                                           */ 03273000
*                       /*********************************************/ 03274000
*                                                                  0886 03275000
*                       IF TESTRC^=0 THEN/* BAD RETURN CODE  @Y30LB01*/ 03276000
         LH    @15,TESTRC                                          0886 03277000
         LTR   @15,@15                                             0886 03278000
         BZ    @RF00886                                            0886 03279000
*                         DO;       /* ERROR PROCESS         @Y30LB01*/ 03280000
*                           EXITSW=ON;/* SET LOOP EXIT SW    @Y30LB01*/ 03281000
         OI    EXITSW,B'00000100'                                  0888 03282000
*                           LASTCOND=LASTCC12;/* SET LASTCOND      0889 03283000
*                                                            @Y30LB01*/ 03284000
         L     @15,@PC00001+8                                      0889 03285000
         MVC   LASTCOND(2,@15),@CH00567                            0889 03286000
*                         END;      /* END ERROR PROCESS     @Y30LB01*/ 03287000
*                                                                  0890 03288000
*                       /*********************************************/ 03289000
*                       /*                                           */ 03290000
*                       /* GOOD UPUT THEN RESET THE BUFFER   @Y30LB01*/ 03291000
*                       /* COUNT AND UPDATE THE OUTPUT       @Y30LB01*/ 03292000
*                       /* TOTAL RECS WRITTEN COUNT          @Y30LB01*/ 03293000
*                       /*                                           */ 03294000
*                       /*********************************************/ 03295000
*                                                                  0891 03296000
*                       ELSE        /* GOOD WRITE            @Y30LB01*/ 03297000
*                         DO;       /* PROCESS               @Y30LB01*/ 03298000
         B     @RC00886                                            0891 03299000
@RF00886 DS    0H                                                  0892 03300000
*                           OUTCNT=OUTCNT+BUFFUL;/* KEEP COUNT     0892 03301000
*                                                            @Y30LB01*/ 03302000
         LH    @00,OUTCNT                                          0892 03303000
         AH    @00,BUFFUL                                          0892 03304000
         STH   @00,OUTCNT                                          0892 03305000
*                         END;      /* END GOOD PROCESS      @Y30LB01*/ 03306000
*                       BUFCNT=F0;  /* RESET BUFFER COUNT    @ZA17170*/ 03307000
@RC00886 SLR   @00,@00                                             0894 03308000
         STH   @00,BUFCNT                                          0894 03309000
*                     END;          /* END OF WRITE CODE     @Y30LB01*/ 03310000
*                 END;              /* END OF MVC CODE       @Y30LB01*/ 03311000
@RF00878 DS    0H                                                  0897 03312000
*             END;                  /* END OF MOVE LOGIC     @Y30LB01*/ 03313000
@RC00872 LA    @00,1                                               0897 03314000
         AH    @00,MOVECNT                                         0897 03315000
         STH   @00,MOVECNT                                         0897 03316000
         C     @00,@CF00221                                        0897 03317000
         BNH   @DL00870                                            0897 03318000
@DC00870 DS    0H                                                  0898 03319000
*           END;                    /* END GOOD READ         @Y30LB01*/ 03320000
*       END;                        /* END VALID READS       @Y30LB01*/ 03321000
*                                                                  0899 03322000
*     /***************************************************************/ 03323000
*     /*                                                             */ 03324000
*     /* REACHED LIMIT OF VALID TRACKS TO READ               @Y30LB01*/ 03325000
*     /*                                                             */ 03326000
*     /***************************************************************/ 03327000
*                                                                  0900 03328000
*     ELSE                          /* END OF VALID TRACKS   @Y30LB01*/ 03329000
*       EXITSW=ON;                  /* SET EXIT SWITCH       @Y30LB01*/ 03330000
*                                                                  0900 03331000
         B     @RC00837                                            0900 03332000
@RF00837 OI    EXITSW,B'00000100'                                  0900 03333000
*     /***************************************************************/ 03334000
*     /*                                                             */ 03335000
*     /* INCREMENT SEEK AND SEARCH POINTERS TO NEXT TRACK    @Y30LB01*/ 03336000
*     /*                                                             */ 03337000
*     /***************************************************************/ 03338000
*                                                                  0901 03339000
*     SRCHR(LOOPCNT)=F1;            /* RESET RECORD NUM      @Y30LB01*/ 03340000
@RC00837 LA    @15,1                                               0901 03341000
         LH    @14,LOOPCNT                                         0901 03342000
         SLA   @14,3                                               0901 03343000
         STC   @15,SRCHR-8(@14)                                    0901 03344000
*     SRCHHH(LOOPCNT)=SRCHHH(LOOPCNT)+F1;/* SRCH TRACK       @Y30LB01*/ 03345000
         LH    @00,SRCHHH-8(@14)                                   0902 03346000
         ALR   @00,@15                                             0902 03347000
         STH   @00,SRCHHH-8(@14)                                   0902 03348000
*     SEEKHH(LOOPCNT)=SEEKHH(LOOPCNT)+F1;/* SEEK TRACK       @Y30LB01*/ 03349000
         LH    @09,SEEKHH-8(@14)                                   0903 03350000
         ALR   @09,@15                                             0903 03351000
         STH   @09,SEEKHH-8(@14)                                   0903 03352000
*     IF SRCHHH(LOOPCNT)>=CYLLN THEN/* GO TO NEXT CYLINDER   @Y30LB35*/ 03353000
         C     @00,@CF01292                                        0904 03354000
         BL    @RF00904                                            0904 03355000
*       DO;                         /* NEXT CYLINDER         @Y30LB01*/ 03356000
*         SRCHCC(LOOPCNT)=SRCHCC(LOOPCNT)+F1;/* SRCH CYL     @Y30LB01*/ 03357000
         LH    @00,SRCHCC-8(@14)                                   0906 03358000
         ALR   @00,@15                                             0906 03359000
         STH   @00,SRCHCC-8(@14)                                   0906 03360000
*         SRCHHH(LOOPCNT)=F0;       /* RESET TO FIRST SRCH   @ZM31000*/ 03361000
         SLR   @09,@09                                             0907 03362000
         STH   @09,SRCHHH-8(@14)                                   0907 03363000
*         SEEKCC(LOOPCNT)=SEEKCC(LOOPCNT)+F1;/* SEEK CYL     @Y30LB01*/ 03364000
         AH    @15,SEEKCC-8(@14)                                   0908 03365000
         STH   @15,SEEKCC-8(@14)                                   0908 03366000
*         SEEKHH(LOOPCNT)=F0;       /* RESET TO FIRST SEEK   @ZM31000*/ 03367000
         STH   @09,SEEKHH-8(@14)                                   0909 03368000
*       END;                        /* END CYL UPDATE        @Y30LB01*/ 03369000
*   END;                            /* END I/O PROCESS LOOP  @Y30LB01*/ 03370000
@RF00904 LA    @00,1                                               0911 03371000
         AH    @00,READCNT                                         0911 03372000
         STH   @00,READCNT                                         0911 03373000
         C     @00,@CF01387                                        0911 03374000
         BNH   @DL00836                                            0911 03375000
@DC00836 DS    0H                                                  0912 03376000
*                                                                  0912 03377000
*   /*****************************************************************/ 03378000
*   /*                                                               */ 03379000
*   /* ZERO REMAINING RECORDS IN OUTPUT BUFFER AND WRITE     @Y30LB01*/ 03380000
*   /* FINAL OUTPUT BLOCK IF THIS IS LAST AREA TO BE         @Y30LB01*/ 03381000
*   /* DUMPED AND THERE IS RESIDULE RECORDS.                 @Y30LB01*/ 03382000
*   /*                                                               */ 03383000
*   /*****************************************************************/ 03384000
*                                                                  0912 03385000
*   IF BUFCNT>F0&LOOPCNT=F1 THEN    /* CLEANUP RESIDUAL      @Y30LB01*/ 03386000
         LH    @15,BUFCNT                                          0912 03387000
         LTR   @15,@15                                             0912 03388000
         BNP   @RF00912                                            0912 03389000
         CLC   LOOPCNT(2),@CH00219                                 0912 03390000
         BNE   @RF00912                                            0912 03391000
*     DO;                           /* OUTPUT RECORDS        @Y30LB01*/ 03392000
*       OUTCNT=OUTCNT+BUFCNT;       /* COUNT RESIDUAL RECS   @Y30LB01*/ 03393000
         AH    @15,OUTCNT                                          0914 03394000
         STH   @15,OUTCNT                                          0914 03395000
*       DO UNTIL BUFCNT>=BUFFUL;    /* ZERO NON VALID RECS   @Y30LB01*/ 03396000
@DL00915 DS    0H                                                  0916 03397000
*         OUTPREF(BUFCNT+1)=''B;    /* NULLIFY RECORD        @Y30LB01*/ 03398000
         LH    @15,BUFCNT                                          0916 03399000
         LR    @14,@15                                             0916 03400000
         MH    @14,@CH01258                                        0916 03401000
         L     @09,@CF01246                                        0916 03402000
         AL    @09,INBLKPTR                                        0916 03403000
         ST    @14,@TF00001                                        0916 03404000
         ALR   @14,@09                                             0916 03405000
         XC    OUTPREF(8,@14),OUTPREF(@14)                         0916 03406000
*         OUTDATA(BUFCNT+1)=''B;    /* NULLIFY RECORD        @Y30LB01*/ 03407000
         AL    @09,@TF00001                                        0917 03408000
         XC    OUTDATA(256,@09),OUTDATA(@09)                       0917 03409000
*         BUFCNT=BUFCNT+1;          /* INC REC POINTER       @Y30LB01*/ 03410000
         AL    @15,@CF00219                                        0918 03411000
         STH   @15,BUFCNT                                          0918 03412000
*       END;                        /* END REC NULL CODE     @Y30LB01   03413000
*                                                            @Y30LB01*/ 03414000
*                                                                  0919 03415000
@DE00915 LH    @00,BUFCNT                                          0919 03416000
         CH    @00,BUFFUL                                          0919 03417000
         BL    @DL00915                                            0919 03418000
*       /*************************************************************/ 03419000
*       /*                                                           */ 03420000
*       /* UPUT CALL TO WRITE OUTPUT BLOCK                   @Y30LB01*/ 03421000
*       /*                                                           */ 03422000
*       /*************************************************************/ 03423000
*                                                                  0920 03424000
*       IOCDAD=ADDR(OUTBLK);        /* PTR TO OUTPUT DATA    @ZM30736*/ 03425000
         L     @15,IOCSPTR                                         0920 03426000
         L     @14,@CF01246                                        0920 03427000
         AL    @14,INBLKPTR                                        0920 03428000
         ST    @14,IOCDAD(,@15)                                    0920 03429000
*       IOCDLN=IOCTRN;              /* SET O/P DATA LENGTH   @ZM30736*/ 03430000
         L     @14,IOCTRN(,@15)                                    0921 03431000
         ST    @14,IOCDLN(,@15)                                    0921 03432000
*       CALL IDCIOPT0(GDTTBL,IOCSPTR);/* UPUT CALL           @Y30LB01*/ 03433000
         L     @00,@PC00001                                        0922 03434000
         LR    @15,@00                                             0922 03435000
         ST    @15,@AL00001                                        0922 03436000
         LA    @15,IOCSPTR                                         0922 03437000
         ST    @15,@AL00001+4                                      0922 03438000
         MVI   @AL00001+4,X'80'                                    0922 03439000
         LR    @14,@00                                             0922 03440000
         L     @15,GDTPUT(,@14)                                    0922 03441000
         LA    @01,@AL00001                                        0922 03442000
         BALR  @14,@15                                             0922 03443000
*       RESPECIFY                                                  0923 03444000
*         RTNREG RSTD;                                             0923 03445000
*       TESTRC=RTNREG;                                             0924 03446000
         STH   RTNREG,TESTRC                                       0924 03447000
*       RESPECIFY                                                  0925 03448000
*         RTNREG UNRSTD;            /* SAVE RETURN CODE      @Y30LB01   03449000
*                                                            @Y30LB01*/ 03450000
*                                                                  0925 03451000
*       /*************************************************************/ 03452000
*       /*                                                           */ 03453000
*       /* TEST UPUT RETURN AND IF FAIL CODE THEN SET        @Y30LB01*/ 03454000
*       /* LASTCOND TO TERMINAL VALUE.                       @Y30LB01*/ 03455000
*       /*                                                           */ 03456000
*       /*************************************************************/ 03457000
*                                                                  0926 03458000
*       IF TESTRC^=0 THEN           /* BAD RETURN            @Y30LB01*/ 03459000
         LH    @15,TESTRC                                          0926 03460000
         LTR   @15,@15                                             0926 03461000
         BZ    @RF00926                                            0926 03462000
*         LASTCOND=LASTCC12;        /* SET LASTCOND TO 12    @Y30LB01*/ 03463000
         L     @15,@PC00001+8                                      0927 03464000
         MVC   LASTCOND(2,@15),@CH00567                            0927 03465000
*     END;                          /* END OF CLEANUP        @Y30LB01*/ 03466000
@RF00926 DS    0H                                                  0929 03467000
*                                                                  0929 03468000
*   /*****************************************************************/ 03469000
*   /*                                                               */ 03470000
*   /* IF THERE WAS AN I/O ERROR THE LASTCOND FIELD          @Y30LB01*/ 03471000
*   /* WAS SET TO 12. IF THERE WAS RECORDS WRITTEN           @Y30LB01*/ 03472000
*   /* TO THE OUTPUT FILE AND AN ERROR WAS ENCOUNTERED       @Y30LB01*/ 03473000
*   /* IN I/O THEN A MESSAGE WITH THE ACTUAL OUTPUT          @Y30LB01*/ 03474000
*   /* RECORD COUNT IS WRITTEN                               @Y30LB01*/ 03475000
*   /*                                                               */ 03476000
*   /*****************************************************************/ 03477000
*                                                                  0929 03478000
*   IF LASTCOND=LASTCC12&OUTCNT>F0 THEN/* I/O ERROR          @Y30LB01*/ 03479000
@RF00912 L     @15,@PC00001+8                                      0929 03480000
         CLC   LASTCOND(2,@15),@CH00567                            0929 03481000
         BNE   @RF00929                                            0929 03482000
         LH    @00,OUTCNT                                          0929 03483000
         LTR   @00,@00                                             0929 03484000
         BNP   @RF00929                                            0929 03485000
*     DO;                           /* PROCESS MESSAGE       @Y30LB01*/ 03486000
*       PRINTTAB=''B;               /* CLEAR PRINT AREA      @Y30LB01*/ 03487000
*                                                                  0931 03488000
         XC    PRINTTAB(20),PRINTTAB                               0931 03489000
*       /*************************************************************/ 03490000
*       /*                                                           */ 03491000
*       /* INITIALIZE UPRINT PARAMETERS                      @Y30LB01*/ 03492000
*       /*                                                           */ 03493000
*       /*************************************************************/ 03494000
*                                                                  0932 03495000
*       DARGSENT=MSG2843I;          /* SET MSG ID            @Y30LB01*/ 03496000
         L     @15,DDSTRU                                          0932 03497000
         MVI   DARGSENT(@15),X'04'                                 0932 03498000
*       DARGSMOD=TRAMSG;            /* SET MSG MOD           @Y30LB01*/ 03499000
         MVC   DARGSMOD(3,@15),@CC01280                            0933 03500000
*       DARGDBP=ADDR(OUTCNT);       /* PTR TO INSERT         @Y30LB01*/ 03501000
         LA    @14,OUTCNT                                          0934 03502000
         ST    @14,DARGDBP(,@15)                                   0934 03503000
*       DARGILP=LENGTH(OUTCNT);     /* LENGTH OF INSERT      @Y30LB01   03504000
*                                                            @Y30LB01*/ 03505000
*                                                                  0935 03506000
         MVC   DARGILP(2,@15),@CH00153                             0935 03507000
*       /*************************************************************/ 03508000
*       /*                                                           */ 03509000
*       /* UPRINT CALL TO PRINT MESSAGE                      @Y30LB01*/ 03510000
*       /*                                                           */ 03511000
*       /*************************************************************/ 03512000
*                                                                  0936 03513000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* UPRINT CALL  @Y30LB01   03514000
*                                                            @Y30LB01*/ 03515000
*                                                                  0936 03516000
         L     @00,@PC00001                                        0936 03517000
         LR    @15,@00                                             0936 03518000
         ST    @15,@AL00001                                        0936 03519000
         LA    @15,@CF00115                                        0936 03520000
         ST    @15,@AL00001+4                                      0936 03521000
         LA    @15,DDSTRU                                          0936 03522000
         ST    @15,@AL00001+8                                      0936 03523000
         MVI   @AL00001+8,X'80'                                    0936 03524000
         LR    @14,@00                                             0936 03525000
         L     @15,GDTPRT(,@14)                                    0936 03526000
         LA    @01,@AL00001                                        0936 03527000
         BALR  @14,@15                                             0936 03528000
*       /*************************************************************/ 03529000
*       /*                                                           */ 03530000
*       /* LASTCOND IS SET TO 8 INDICATING SOME OUTPUT WAS   @Y30LB01*/ 03531000
*       /* WRITTEN BUT AN IO ERROR WAS ENCOUNTERED.          @Y30LB01*/ 03532000
*       /*                                                           */ 03533000
*       /*************************************************************/ 03534000
*                                                                  0937 03535000
*       LASTCOND=LASTCC08;          /* SET LASTCOND TO 8     @Y30LB01*/ 03536000
         L     @15,@PC00001+8                                      0937 03537000
         MVC   LASTCOND(2,@15),@CH00179                            0937 03538000
*     END;                          /* END I/O ERROR         @Y30LB01*/ 03539000
*                                                                  0939 03540000
*   /*****************************************************************/ 03541000
*   /*                                                               */ 03542000
*   /* IF THE TRACE AREA(S) WAS NULL, NO DUMP IS MADE AND    @Y30LB01*/ 03543000
*   /* A WARNING MESSAGE IS PRINTED.                         @Y30LB01*/ 03544000
*   /*                                                               */ 03545000
*   /*****************************************************************/ 03546000
*                                                                  0939 03547000
*   IF LASTCOND=LASTCC04&           /* TEST FOR              @Y30LB01*/ 03548000
*       TRNULL=ON THEN              /* NULL FILE FOUND       @Y30LB01*/ 03549000
@RF00929 L     @15,@PC00001+8                                      0939 03550000
         CLC   LASTCOND(2,@15),@CH00042                            0939 03551000
         BNE   @RF00939                                            0939 03552000
         TM    TRNULL,B'00001000'                                  0939 03553000
         BNO   @RF00939                                            0939 03554000
*     DO;                           /* PROCESS MSG           @Y30LB01*/ 03555000
*       PRINTTAB=''B;               /* CLEAR PRINT AREA      @Y30LB01*/ 03556000
*                                                                  0941 03557000
         XC    PRINTTAB(20),PRINTTAB                               0941 03558000
*       /*************************************************************/ 03559000
*       /*                                                           */ 03560000
*       /* INITIALIZE UPRINT PARAMETERS                      @Y30LB01*/ 03561000
*       /*                                                           */ 03562000
*       /*************************************************************/ 03563000
*                                                                  0942 03564000
*       DARGSENT=MSG1840I;          /* MESSAGE ID            @Y30LB01*/ 03565000
         L     @15,DDSTRU                                          0942 03566000
         MVI   DARGSENT(@15),X'01'                                 0942 03567000
*       DARGSMOD=TRAMSG;            /* SET MOD ID            @Y30LB01   03568000
*                                                            @Y30LB01*/ 03569000
*                                                                  0943 03570000
         MVC   DARGSMOD(3,@15),@CC01280                            0943 03571000
*       /*************************************************************/ 03572000
*       /*                                                           */ 03573000
*       /* UPRINT CALL TO PRINT MESSAGE                      @Y30LB01*/ 03574000
*       /*                                                           */ 03575000
*       /*************************************************************/ 03576000
*                                                                  0944 03577000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/* UPRINT CALL  @Y30LB01   03578000
*                                                            @Y30LB01*/ 03579000
         L     @00,@PC00001                                        0944 03580000
         LR    @15,@00                                             0944 03581000
         ST    @15,@AL00001                                        0944 03582000
         LA    @15,@CF00115                                        0944 03583000
         ST    @15,@AL00001+4                                      0944 03584000
         LA    @15,DDSTRU                                          0944 03585000
         ST    @15,@AL00001+8                                      0944 03586000
         MVI   @AL00001+8,X'80'                                    0944 03587000
         LR    @14,@00                                             0944 03588000
         L     @15,GDTPRT(,@14)                                    0944 03589000
         LA    @01,@AL00001                                        0944 03590000
         BALR  @14,@15                                             0944 03591000
*     END;                          /* END NULL FILE CODE    @Y30LB01*/ 03592000
*                                                                  0946 03593000
*   /*****************************************************************/ 03594000
*   /*                                                               */ 03595000
*   /* RESTORE CALLERS RETURN ADDRESS AND RETURN             @Y30LB01*/ 03596000
*   /*                                                               */ 03597000
*   /*****************************************************************/ 03598000
*                                                                  0946 03599000
*   RESPECIFY                                                      0946 03600000
*     REG14 RSTD;                   /* RESTRICT REG 14       @Y30LB01*/ 03601000
@RF00939 DS    0H                                                  0947 03602000
*   REG14=RETADDR2;                 /* RESTORE REG 14        @Y30LB01*/ 03603000
         L     REG14,RETADDR2                                      0947 03604000
*   RETURN CODE(LASTCOND);          /* RETURN TO CALLER      @Y30LB01*/ 03605000
         L     @09,@PC00001+8                                      0948 03606000
         LH    @15,LASTCOND(,@09)                                  0948 03607000
@EL00006 DS    0H                                                  0948 03608000
@EF00006 DS    0H                                                  0948 03609000
@ER00006 BR    @14                                                 0948 03610000
*   RESPECIFY                                                      0949 03611000
*     REG14 UNRSTD;                 /* FREE REG 14           @Y30LB01*/ 03612000
*   END TRACEIO;                    /* END PROCEDURE         @Y30LB01*/ 03613000
*                                                                  0951 03614000
*/***********************************************************@Y30LB39*/ 03615000
*/* PROCEDURE NAME - SSCMSG                                  @Y30LB39*/ 03616000
*/*                                                          @Y30LB39*/ 03617000
*/* FUNCTION - THIS ROUTINE PRINTS MESSAGES                  @Y30LB39*/ 03618000
*/*   FROM IDCTSSS0 OR IDCTSCM0 AS DICTATED BY THE MSSC      @Y30LB39*/ 03619000
*/*   REASON CODE OR THE ECB POST CODE, EITHER ONE PASSED AS @Y30LB39*/ 03620000
*/*   INPUT ARGUMENTS.                                       @Y30LB39*/ 03621000
*/*                                                          @Y30LB39*/ 03622000
*/*   THE REASON CODE IS PASSED TO THIS ROUTINE FROM THE     @Y30LB39*/ 03623000
*/*   CALLER IN SSRCODE, AND THE ECB POST CODE IS PASSED     @Y30LB39*/ 03624000
*/*   IN SSECBCD.                                            @Y30LB39*/ 03625000
*/*                                                          @Y30LB39*/ 03626000
*/*   ONLY ONE MESSAGE IS PRINTED. IF THE REASON CODE        @Y30LB39*/ 03627000
*/*   CONTAINS A NUMBER GREATER THAN ZERO, IT IS USED AS     @Y30LB39*/ 03628000
*/*   THE INDICATION TO CALL UPRINT TO READ IN THE FIRST     @Y30LB39*/ 03629000
*/*   STATIC TEXT ENTRY FROM IDCTSSS0.  THAT ENTRY CONTAINS  @Y30LB39*/ 03630000
*/*   AN ARRAY OF THE MESSAGE INDICES USED TO PRINT THE      @Y30LB39*/ 03631000
*/*   MSSC REASON CODE MESSAGE. THE ARRAY IS SCANNED FOR THE @Y30LB39*/ 03632000
*/*   REASON CODE THAT WAS PASSED AS THE FIRST PARAMETER.    @Y30LB39*/ 03633000
*/*   IF THE ARRAY CONTAINS AN ENTRY WITH THAT VALUE, THE    @Y30LB39*/ 03634000
*/*   ARRAY INDEX IS USED TO PRINT THE MESSAGE.  IF THE      @Y30LB39*/ 03635000
*/*   REASON CODE IS NOT FOUND IN THE ARRAY, THE REASON      @Y30LB39*/ 03636000
*/*   CODE IS USED AS BLOCK DATA WHEN PRINTING THE "LAST"    @Y30LB39*/ 03637000
*/*   STATIC TEXT ENTRY IN THE TEXT MODULE.                  @Y30LB39*/ 03638000
*/*                                                          @Y30LB39*/ 03639000
*/*   IF THE REASON CODE FIELD IS ZERO, THE ECB POST CODE    @Y30LB39*/ 03640000
*/*   IS INSERTED AS BLOCK DATA INTO A GENERAL MESSAGE IN    @Y30LB39*/ 03641000
*/*   STATIC TEXT MODULE IDCTSCM0.                           @Y30LB39*/ 03642000
*/*                                                          @Y30LB39*/ 03643000
*/* INPUT - REASON CODE AS FIRST ARGUMENT, OPTIONALLY THE    @Y30LB39*/ 03644000
*/*         ECB CODE AS THE SECOND ARGUMENT.                 @Y30LB39*/ 03645000
*/*                                                          @Y30LB39*/ 03646000
*/* OUTPUT - PRINTED MESSAGE AND RETURN CODE OF ZERO.        @Y30LB39*/ 03647000
*/*                                                          @Y30LB39*/ 03648000
*/***********************************************************@Y30LB39*/ 03649000
*                                                                  0951 03650000
*                                   /*                       @Y30LB39*/ 03651000
*SSCMSG:                                                           0951 03652000
*   PROCEDURE(SSRCODE,              /* SSC RETURN CODE       @Y30LB39*/ 03653000
*       SSECBCD);                   /* ECB POST CODE         @Y30LB39   03654000
*                                                            @Y30LB39*/ 03655000
SSCMSG   STM   @14,@12,@SA00007                                    0951 03656000
         MVC   @PC00007(8),0(@01)                                  0951 03657000
*                                   /*                       @Y30LB39*/ 03658000
*                                                                  0952 03659000
*   /*****************************************************************/ 03660000
*   /*                                                               */ 03661000
*   /*                                                       @Y30LB39*/ 03662000
*   /* DECLARATIONS FOR THE SSCMSG PROCEDURE                 @Y30LB39*/ 03663000
*   /*                                                       @Y30LB39*/ 03664000
*   /*                                                               */ 03665000
*   /*****************************************************************/ 03666000
*                                                                  0952 03667000
*                                   /*                       @Y30LB39   03668000
*                                                            @Y30LB39*/ 03669000
*                                                                  0952 03670000
*   /*****************************************************************/ 03671000
*   /*                                                               */ 03672000
*   /*                                                       @Y30LB39*/ 03673000
*   /* THE NEXT TWO DECLARES ARE FOR THE TWO INPUT           @Y30LB39*/ 03674000
*   /* ARGUMENTS. 1ST - MSSC REASON CODE OR                  @Y30LB39*/ 03675000
*   /* 2ND - MSSC POST CODE                                  @Y30LB39*/ 03676000
*   /*                                                       @Y30LB39*/ 03677000
*   /*                                                               */ 03678000
*   /*****************************************************************/ 03679000
*                                                                  0952 03680000
*                                   /*                       @Y30LB39*/ 03681000
*   DCL                                                            0952 03682000
*     1 SSRCODE FIXED(31),          /*                       @Y30LB39*/ 03683000
*       3 * FIXED(15),              /*                       @Y30LB39*/ 03684000
*       3 SSRHALF FIXED(15);        /* 1ST ARG REASON CODE   @Y30LB39*/ 03685000
*   DCL                                                            0953 03686000
*     SSECBCD PTR(8);               /* 2ND ARG POST CODE     @Y30LB39   03687000
*                                                            @Y30LB39   03688000
*                                                            @Y30LB39*/ 03689000
*                                                                  0953 03690000
*   /*****************************************************************/ 03691000
*   /*                                                               */ 03692000
*   /*                                                       @Y30LB39*/ 03693000
*   /* DECLARE THE DYNAMIC AREA NEEDED TO POINT TO AND       @Y30LB39*/ 03694000
*   /* CONTAIN THE "LOCAL" PRINT ARGUMENT LIST               @Y30LB39*/ 03695000
*   /*                                                       @Y30LB39*/ 03696000
*   /*                                                               */ 03697000
*   /*****************************************************************/ 03698000
*                                                                  0954 03699000
*                                   /*                       @Y30LB39*/ 03700000
*   DCL                                                            0954 03701000
*     SSDLPTR PTR(31);              /*                       @Y30LB39*/ 03702000
*   DCL                                                            0955 03703000
*     SSDRGLT CHAR(LENGTH(DARGLIST));/*                      @Y30LB39   03704000
*                                                            @Y30LB39*/ 03705000
*                                                                  0955 03706000
*   /*****************************************************************/ 03707000
*   /*                                                               */ 03708000
*   /*                                                       @Y30LB39*/ 03709000
*   /* THE NEXT DECLARE IS FOR THE INDEX WHICH IS            @Y30LB39*/ 03710000
*   /* INCREMENTED WHILE SEARCHING THE ARRAY OF              @Y30LB39*/ 03711000
*   /* REASON CODES AND, UPON FINDING THE CORRECT            @Y30LB39*/ 03712000
*   /* REASON CODE, IS PASSED TO PRINT MODULE AS THE         @Y30LB39*/ 03713000
*   /* INDEX OF THE MESSAGE NUMBER TO BE PRINTED.            @Y30LB39*/ 03714000
*   /*                                                       @Y30LB39*/ 03715000
*   /*                                                               */ 03716000
*   /*****************************************************************/ 03717000
*                                                                  0956 03718000
*                                   /*                       @Y30LB39*/ 03719000
*   DECLARE                                                        0956 03720000
*     ENTRYNUM FIXED(8) UNSIGNED;   /*                       @Y30LB39   03721000
*                                                            @Y30LB39*/ 03722000
*                                                                  0956 03723000
*   /*****************************************************************/ 03724000
*   /*                                                               */ 03725000
*   /*                                                       @Y30LB39*/ 03726000
*   /* THE NEXT DECLARE IS FOR THE COMMON MESSAGE            @Y30LB39*/ 03727000
*   /* NUMBER TO IDENTIFY THE ECB POST CODE                  @Y30LB39*/ 03728000
*   /* MESSAGE CONTAINED IN STATIC TEXT MODULE               @Y30LB39*/ 03729000
*   /* IDCTSCM0.                                             @Y30LB39*/ 03730000
*   /*                                                       @Y30LB39*/ 03731000
*   /*                                                               */ 03732000
*   /*****************************************************************/ 03733000
*                                                                  0957 03734000
*                                   /*                       @Y30LB39*/ 03735000
*   DECLARE                                                        0957 03736000
*     SSMSGNUM FIXED(8) STATIC LOCAL INIT(56);/*             @Y30LB39   03737000
*                                                            @Y30LB39*/ 03738000
*                                                                  0957 03739000
*   /*****************************************************************/ 03740000
*   /*                                                               */ 03741000
*   /*                                                       @Y30LB39*/ 03742000
*   /* THE NEXT DECLARE IS FOR THE ARRAY WHICH IS            @Y30LB39*/ 03743000
*   /* SEARCHED FOR THE REASON CODE CORRESPONDING            @Y30LB39*/ 03744000
*   /* TO THE MESSAGE INDEX AND ULTIMATELY, THE              @Y30LB39*/ 03745000
*   /* MESSAGE TEXT TO BE PRINTED TO THE USER TELLING        @Y30LB39*/ 03746000
*   /* HIM OF THE EXACT REASON FOR THE MSSC FAILURE.         @Y30LB39*/ 03747000
*   /*                                                       @Y30LB39*/ 03748000
*   /*                                                               */ 03749000
*   /*****************************************************************/ 03750000
*                                                                  0958 03751000
*                                   /*                       @Y30LB39*/ 03752000
*   DECLARE                                                        0958 03753000
*     1 SSINXLST BDY(WORD),         /*                       @Y30LB39*/ 03754000
*       3 SSARRAY(60) FIXED(15);    /*                       @Y30LB39   03755000
*                                                            @Y30LB39*/ 03756000
*                                                                  0958 03757000
*   /*****************************************************************/ 03758000
*   /*                                                               */ 03759000
*   /*                                                       @Y30LB39*/ 03760000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 03761000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSSS0.            @Y30LB39*/ 03762000
*   /*                                                       @Y30LB39*/ 03763000
*   /*                                                               */ 03764000
*   /*****************************************************************/ 03765000
*                                                                  0959 03766000
*                                   /*                       @Y30LB39*/ 03767000
*   DECLARE                                                        0959 03768000
*     SSMODSS0 CHAR(3) STATIC INIT('SS0');/*                 @Y30LB39   03769000
*                                                            @Y30LB39*/ 03770000
*                                                                  0959 03771000
*   /*****************************************************************/ 03772000
*   /*                                                               */ 03773000
*   /*                                                       @Y30LB39*/ 03774000
*   /* THE NEXT DECLARATION IS FOR THE MESSAGE ID            @Y30LB39*/ 03775000
*   /* USED BY THE STATIC TEXT MODULE - IDCTSCMO.            @Y30LB39*/ 03776000
*   /*                                                       @Y30LB39*/ 03777000
*   /*                                                               */ 03778000
*   /*****************************************************************/ 03779000
*                                                                  0960 03780000
*                                   /*                       @Y30LB39*/ 03781000
*   DECLARE                                                        0960 03782000
*     SSMODCM0 CHAR(3) STATIC INIT('CM0');/*                 @Y30LB39   03783000
*                                                            @Y30LB39*/ 03784000
*                                   /*                       @Y30LB39*/ 03785000
*                                                                  0961 03786000
*   /*****************************************************************/ 03787000
*   /*                                                               */ 03788000
*   /* ISSUE UTRACE MACRO TO PROVIDE A TRACK OF FLOW         @Y30LB39*/ 03789000
*   /* ON CONTROL WITHIN THE SSMSG MODULE.                   @Y30LB39*/ 03790000
*   /* THIS WILL PLACE THE IDENTIFIER SPECIFIED IN           @Y30LB39*/ 03791000
*   /* A SEPARATE INTRA-MODULE TRACE TABLE.                  @Y30LB39*/ 03792000
*   /*                                                       @Y30LB39*/ 03793000
*   /*                                                               */ 03794000
*   /*****************************************************************/ 03795000
*                                                                  0961 03796000
*                                   /*                       @Y30LB39*/ 03797000
*   OLDERID2=NEWERID2;                                             0961 03798000
         L     @15,@PC00001                                        0961 03799000
         L     @14,GDTTR2(,@15)                                    0961 03800000
         MVC   @TS00001(95),NEWERID2(@14)                          0961 03801000
         MVC   OLDERID2(95,@14),@TS00001                           0961 03802000
*   NEWID2='SSAA';                  /*                       @Y30LB39   03803000
*                                                            @Y30LB39*/ 03804000
*                                                                  0962 03805000
         MVC   NEWID2(4,@14),@CC01379                              0962 03806000
*   /*****************************************************************/ 03807000
*   /*                                                               */ 03808000
*   /*                                                       @Y30LB39*/ 03809000
*   /* ESTABLISH ADDRESSABILITY TO THE DYNAMIC               @Y30LB39*/ 03810000
*   /* ARGUMENT LIST.                                        @Y30LB39*/ 03811000
*   /*                                                       @Y30LB39*/ 03812000
*   /*                                                               */ 03813000
*   /*****************************************************************/ 03814000
*                                                                  0963 03815000
*                                   /*                       @Y30LB39*/ 03816000
*   SSDLPTR=ADDR(SSDRGLT);          /*                       @Y30LB39   03817000
*                                                            @Y30LB39*/ 03818000
*                                                                  0963 03819000
         LA    @14,SSDRGLT                                         0963 03820000
         ST    @14,SSDLPTR                                         0963 03821000
*   /*****************************************************************/ 03822000
*   /*                                                               */ 03823000
*   /*                                                       @Y30LB39*/ 03824000
*   /* IF THE REASON CODE IS NOT ZERO, READ IN THE           @Y30LB39*/ 03825000
*   /* ARRAY FROM THE STATIC TEXT MODULE - IDCTSSS0.         @Y30LB39*/ 03826000
*   /*                                                       @Y30LB39*/ 03827000
*   /*                                                               */ 03828000
*   /*****************************************************************/ 03829000
*                                                                  0964 03830000
*                                   /*                       @Y30LB39*/ 03831000
*   IF SSRCODE>0 THEN                                              0964 03832000
         L     @09,@PC00007                                        0964 03833000
         L     @00,SSRCODE(,@09)                                   0964 03834000
         LTR   @00,@00                                             0964 03835000
         BNP   @RF00964                                            0964 03836000
*     DO;                           /*                       @Y30LB39   03837000
*                                                            @Y30LB39*/ 03838000
*                                                                  0965 03839000
*       /*************************************************************/ 03840000
*       /*                                                           */ 03841000
*       /*                                                   @Y30LB39*/ 03842000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND               @Y30LB39*/ 03843000
*       /* INITIALIZE THE PRINT ARGUMENT LIST TO READ        @Y30LB39*/ 03844000
*       /* IN THE ARRAY WHICH CONTAINS THE MSSC REASON       @Y30LB39*/ 03845000
*       /* CODES.                                            @Y30LB39*/ 03846000
*       /*                                                   @Y30LB39*/ 03847000
*       /*                                                           */ 03848000
*       /*************************************************************/ 03849000
*                                                                  0966 03850000
*                                   /*                       @Y30LB39*/ 03851000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 03852000
         XC    SSDRGLT(20),SSDRGLT                                 0966 03853000
*       SSDLPTR->DARGRETP=ADDR(SSINXLST);/*                  @Y30LB39*/ 03854000
         LA    @00,SSINXLST                                        0967 03855000
         ST    @00,DARGRETP(,@14)                                  0967 03856000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 03857000
         MVC   DARGSMOD(3,@14),SSMODSS0                            0968 03858000
*       SSDLPTR->DARGSENT=1;        /*                       @Y30LB39*/ 03859000
         MVI   DARGSENT(@14),X'01'                                 0969 03860000
*       SSDLPTR->DARGRETL=LENGTH(SSINXLST);/*                @Y30LB39   03861000
*                                                            @Y30LB39*/ 03862000
*                                                                  0970 03863000
         MVC   DARGRETL(2,@14),@CH01388                            0970 03864000
*       /*************************************************************/ 03865000
*       /*                                                           */ 03866000
*       /*                                                   @Y30LB39*/ 03867000
*       /* ISSUE UPRINT MACRO TO READ IN THE SEARCH          @Y30LB39*/ 03868000
*       /* ARRAY.                                            @Y30LB39*/ 03869000
*       /*                                                   @Y30LB39*/ 03870000
*       /*                                                           */ 03871000
*       /*************************************************************/ 03872000
*                                                                  0971 03873000
*                                   /*                       @Y30LB39*/ 03874000
*       CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*             @Y30LB39   03875000
*                                                            @Y30LB39*/ 03876000
*                                                                  0971 03877000
         ST    @15,@AL00001                                        0971 03878000
         LA    @14,@CF00115                                        0971 03879000
         ST    @14,@AL00001+4                                      0971 03880000
         LA    @14,SSDLPTR                                         0971 03881000
         ST    @14,@AL00001+8                                      0971 03882000
         MVI   @AL00001+8,X'80'                                    0971 03883000
         L     @15,GDTPRT(,@15)                                    0971 03884000
         LA    @01,@AL00001                                        0971 03885000
         BALR  @14,@15                                             0971 03886000
*       /*************************************************************/ 03887000
*       /*                                                           */ 03888000
*       /*                                                   @Y30LB39*/ 03889000
*       /* BEGIN DO LOOP TO SEARCH FOR THE MESSAGE           @Y30LB39*/ 03890000
*       /* INDEX CORRESPONDING TO THE REASON CODE            @Y30LB39*/ 03891000
*       /* PASSED AS THE FIRST ARGUMENT.                     @Y30LB39*/ 03892000
*       /* THE DO LOOP BEGINS WITH THE SECOND ARRAY          @Y30LB39*/ 03893000
*       /* ENTRY SINCE THE FIRST IS REQUIRED BY THE          @Y30LB39*/ 03894000
*       /* SEARCH ARRAY ITSELF.                              @Y30LB39*/ 03895000
*       /* THE SEARCH CONTINUES UNTIL THE REASON CODE        @Y30LB39*/ 03896000
*       /* IS FOUND, AT WHICH TIME THE SEARCH INDEX          @Y30LB39*/ 03897000
*       /* IS PASSED TO THE PRINT MODULE TO PRINT            @Y30LB39*/ 03898000
*       /* THE MESSAGE ASSOCIATED WITH THAT PARTICULAR       @Y30LB39*/ 03899000
*       /* REASON CODE.                                      @Y30LB39*/ 03900000
*       /* IF THERE IS NO MATCH FOUND IN THE ARRAY,          @Y30LB39*/ 03901000
*       /* THEN THE INDEX WILL BE THE LAST POSITION IN       @Y30LB39*/ 03902000
*       /* ARRAY. THIS WILL BE THE INDICATION THAT           @Y30LB39*/ 03903000
*       /* THE REASON CODE ITSELF SHOULD BE PRINTED.         @Y30LB39*/ 03904000
*       /*                                                   @Y30LB39*/ 03905000
*       /*                                                           */ 03906000
*       /*************************************************************/ 03907000
*                                                                  0972 03908000
*                                   /*                       @Y30LB39*/ 03909000
*       ENTRYNUM=1;                 /*                       @Y30LB39*/ 03910000
         MVI   ENTRYNUM,X'01'                                      0972 03911000
*       DO UNTIL(SSRHALF=SSARRAY(ENTRYNUM)|SSARRAY(ENTRYNUM)=0);   0973 03912000
@DL00973 DS    0H                                                  0974 03913000
*         ENTRYNUM=ENTRYNUM+1;      /*                       @Y30LB39*/ 03914000
         LA    @00,1                                               0974 03915000
         SLR   @15,@15                                             0974 03916000
         IC    @15,ENTRYNUM                                        0974 03917000
         ALR   @00,@15                                             0974 03918000
         STC   @00,ENTRYNUM                                        0974 03919000
*       END;                        /*                       @Y30LB39   03920000
*                                                            @Y30LB39*/ 03921000
*                                                                  0975 03922000
@DE00973 L     @15,@PC00007                                        0975 03923000
         SLR   @14,@14                                             0975 03924000
         IC    @14,ENTRYNUM                                        0975 03925000
         LR    @09,@14                                             0975 03926000
         ALR   @09,@09                                             0975 03927000
         LH    @09,SSARRAY-2(@09)                                  0975 03928000
         CH    @09,SSRHALF(,@15)                                   0975 03929000
         BE    @DC00973                                            0975 03930000
         SLR   @08,@08                                             0975 03931000
         CR    @09,@08                                             0975 03932000
         BNE   @DL00973                                            0975 03933000
@DC00973 DS    0H                                                  0976 03934000
*       /*************************************************************/ 03935000
*       /*                                                           */ 03936000
*       /*                                                   @Y30LB39*/ 03937000
*       /* THE CORRECT INDEX HAS BEEN FOUND                  @Y30LB39*/ 03938000
*       /*                                                   @Y30LB39*/ 03939000
*       /* CLEAR THE DYNAMIC ARGUMENT LIST AND FILL          @Y30LB39*/ 03940000
*       /* OUT THE PRINT ARGUMENT FIELDS WITH EITHER:        @Y30LB39*/ 03941000
*       /* 1) THE INDEX CORRESPONDING TO THE REASON          @Y30LB39*/ 03942000
*       /* CODE OR                                           @Y30LB39*/ 03943000
*       /* 2) THE LAST INDEX AND THE REASON CODE             @Y30LB39*/ 03944000
*       /* ITSELF AS A STATIC TEXT INSERT.                   @Y30LB39*/ 03945000
*       /*                                                   @Y30LB39*/ 03946000
*       /*                                                           */ 03947000
*       /*************************************************************/ 03948000
*                                                                  0976 03949000
*                                   /*                       @Y30LB39*/ 03950000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 03951000
         XC    SSDRGLT(20),SSDRGLT                                 0976 03952000
*       SSDLPTR->DARGSMOD=SSMODSS0; /*                       @Y30LB39*/ 03953000
         L     @07,SSDLPTR                                         0977 03954000
         MVC   DARGSMOD(3,@07),SSMODSS0                            0977 03955000
*       SSDLPTR->DARGSENT=ENTRYNUM; /*                       @Y30LB39*/ 03956000
         STC   @14,DARGSENT(,@07)                                  0978 03957000
*       IF SSARRAY(ENTRYNUM)=0 THEN /*                       @Y30LB39*/ 03958000
         CR    @09,@08                                             0979 03959000
         BNE   @RF00979                                            0979 03960000
*         DO;                       /*                       @Y30LB39*/ 03961000
*           SSDLPTR->DARGDBP=ADDR(SSRCODE);/*                @Y30LB39*/ 03962000
         ST    @15,DARGDBP(,@07)                                   0981 03963000
*           SSDLPTR->DARGILP=LENGTH(SSRCODE);/*              @Y30LB39*/ 03964000
         MVC   DARGILP(2,@07),@CH00042                             0982 03965000
*         END;                      /*                       @Y30LB39*/ 03966000
*     END;                          /*                       @Y30LB39*/ 03967000
*                                   /*                       @Y30LB39*/ 03968000
*                                                                  0985 03969000
*   /*****************************************************************/ 03970000
*   /*                                                               */ 03971000
*   /*                                                       @Y30LB39*/ 03972000
*   /* THE FIRST ARGUMENT WAS ZERO, INDICATING THAT          @Y30LB39*/ 03973000
*   /* THIS ROUTINE IS TO PRINT OUT THE ECB POST             @Y30LB39*/ 03974000
*   /* CODE. THEREFORE, CLEAR THE DYNAMIC ARGUMENT           @Y30LB39*/ 03975000
*   /* LIST AND FILL OUT THE PRINT ARGUMENT FIELDS           @Y30LB39*/ 03976000
*   /* SO THE STATIC TEXT MODULE, IDCTSCM0, WILL             @Y30LB39*/ 03977000
*   /* PRINT OUT THE MESSAGE ASSOCIATED WITH THE             @Y30LB39*/ 03978000
*   /* POST CODE.                                            @Y30LB39*/ 03979000
*   /*                                                       @Y30LB39*/ 03980000
*   /*                                                               */ 03981000
*   /*****************************************************************/ 03982000
*                                                                  0985 03983000
*                                   /*                       @Y30LB39*/ 03984000
*   ELSE                            /*                       @Y30LB39*/ 03985000
*     DO;                           /*                       @Y30LB39*/ 03986000
         B     @RC00964                                            0985 03987000
@RF00964 DS    0H                                                  0986 03988000
*       SSDRGLT=''B;                /*                       @Y30LB39*/ 03989000
         XC    SSDRGLT(20),SSDRGLT                                 0986 03990000
*       SSDLPTR->DARGSMOD=SSMODCM0; /*                       @Y30LB39*/ 03991000
         L     @15,SSDLPTR                                         0987 03992000
         MVC   DARGSMOD(3,@15),SSMODCM0                            0987 03993000
*       SSDLPTR->DARGSENT=SSMSGNUM; /*                       @Y30LB39*/ 03994000
         MVC   DARGSENT(1,@15),SSMSGNUM                            0988 03995000
*       SSDLPTR->DARGDBP=ADDR(SSECBCD);/*                    @Y30LB39*/ 03996000
         L     @14,@PC00007+4                                      0989 03997000
         ST    @14,DARGDBP(,@15)                                   0989 03998000
*       SSDLPTR->DARGILP=LENGTH(SSECBCD);/*                  @Y30LB39*/ 03999000
         MVC   DARGILP(2,@15),@CH00219                             0990 04000000
*     END;                          /*                       @Y30LB39   04001000
*                                                            @Y30LB39*/ 04002000
*                                                                  0991 04003000
*   /*****************************************************************/ 04004000
*   /*                                                               */ 04005000
*   /*                                                       @Y30LB39*/ 04006000
*   /* ISSUE UPRINT MACRO TO PRINT THE REASON                @Y30LB39*/ 04007000
*   /* CODE MESSAGE OR THE ECB POST CODE MESSAGE.            @Y30LB39*/ 04008000
*   /*                                                       @Y30LB39*/ 04009000
*   /*                                                               */ 04010000
*   /*****************************************************************/ 04011000
*                                                                  0992 04012000
*                                   /*                       @Y30LB39*/ 04013000
*   CALL AMSTP011(GDTTBL,PRTFILE,SSDLPTR);/*                 @Y30LB39   04014000
*                                                            @Y30LB39*/ 04015000
*                                                                  0992 04016000
@RC00964 L     @00,@PC00001                                        0992 04017000
         LR    @15,@00                                             0992 04018000
         ST    @15,@AL00001                                        0992 04019000
         LA    @15,@CF00115                                        0992 04020000
         ST    @15,@AL00001+4                                      0992 04021000
         LA    @15,SSDLPTR                                         0992 04022000
         ST    @15,@AL00001+8                                      0992 04023000
         MVI   @AL00001+8,X'80'                                    0992 04024000
         LR    @14,@00                                             0992 04025000
         L     @15,GDTPRT(,@14)                                    0992 04026000
         LA    @01,@AL00001                                        0992 04027000
         BALR  @14,@15                                             0992 04028000
*   /*****************************************************************/ 04029000
*   /*                                                               */ 04030000
*   /*                                                       @Y30LB39*/ 04031000
*   /* RETURN TO CALLER WITH A RETURN CODE OF ZERO           @Y30LB39*/ 04032000
*   /*                                                       @Y30LB39*/ 04033000
*   /*                                                               */ 04034000
*   /*****************************************************************/ 04035000
*                                                                  0993 04036000
*                                   /*                       @Y30LB39   04037000
*                                                            @Y30LB39*/ 04038000
*   RETURN CODE(0);                 /*                       @Y30LB39   04039000
*                                                            @Y30LB39*/ 04040000
         SLR   @15,@15                                             0993 04041000
         L     @14,@SA00007                                        0993 04042000
         LM    @00,@12,@SA00007+8                                  0993 04043000
         BR    @14                                                 0993 04044000
*   END SSCMSG;                     /*                       @Y30LB39*/ 04045000
*   END IDCTR01                     /* END OF PROCEDURE      @Y30LB01*/ 04046000
*                                                                  0995 04047000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04048000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 04049000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 04050000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 04051000
*/*%INCLUDE SYSLIB  (IDCCSTR )                                       */ 04052000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 04053000
*/*%INCLUDE SYSLIB  (IDCDF52 )                                       */ 04054000
*                                                                  0995 04055000
*       ;                                                          0995 04056000
@DATA    DS    0H                                                       04057000
@CH00153 DC    H'2'                                                     04058000
@CH00286 DC    H'5'                                                     04059000
@CH00179 DC    H'8'                                                     04060000
@CH00310 DC    H'24'                                                    04061000
@CH00044 DC    H'31'                                                    04062000
@CH01385 DC    H'38'                                                    04063000
@CH01388 DC    H'120'                                                   04064000
@DATD    DSECT                                                          04065000
         DS    0F                                                       04066000
@SA00001 DS    18F                                                      04067000
@PC00001 DS    3F                                                       04068000
@SA00007 DS    15F                                                      04069000
@PC00007 DS    2F                                                       04070000
@AL00001 DS    6A                                                       04071000
@TF00001 DS    F                                                        04072000
@TF00002 DS    F                                                        04073000
@AFTEMPS DS    3F                                                       04074000
IDCTR01  CSECT                                                          04075000
         DS    0F                                                       04076000
@CF00115 DC    F'0'                                                     04077000
@CF00219 DC    F'1'                                                     04078000
@CH00219 EQU   @CF00219+2                                               04079000
@CF00042 DC    F'4'                                                     04080000
@CH00042 EQU   @CF00042+2                                               04081000
@CF00567 DC    F'12'                                                    04082000
@CH00567 EQU   @CF00567+2                                               04083000
@CF00474 DC    F'16'                                                    04084000
@CF01292 DC    F'19'                                                    04085000
@CF00221 DC    F'32'                                                    04086000
@CF01387 DC    F'76'                                                    04087000
@CF01381 DC    F'96'                                                    04088000
@CH01381 EQU   @CF01381+2                                               04089000
@CF01258 DC    F'264'                                                   04090000
@CH01258 EQU   @CF01258+2                                               04091000
@CF01246 DC    F'8448'                                                  04092000
@CF01406 DC    F'-264'                                                  04093000
@CF01407 DC    F'-256'                                                  04094000
@CF01405 DC    F'-254'                                                  04095000
@CF00548 DC    XL4'FF'                                                  04096000
@DATD    DSECT                                                          04097000
         DS    0D                                                       04098000
LISTSCAN DS    A                                                        04099000
IOCSPTR  DS    A                                                        04100000
OPNPTR   DS    A                                                        04101000
DDSTRU   DS    A                                                        04102000
FSADDR   DS    A                                                        04103000
ERCNVADR DS    A                                                        04104000
DMPINDEX DS    A                                                        04105000
CCMSGPTR DS    A                                                        04106000
CMMSGPTR DS    A                                                        04107000
CTMSGPTR DS    A                                                        04108000
ELEMENT  DS    F                                                        04109000
TRLSTPTR DS    A                                                        04110000
CTLSTPTR DS    A                                                        04111000
ACLSTPTR DS    A                                                        04112000
INBLKPTR DS    A                                                        04113000
VOLPTR   DS    A                                                        04114000
WEXOPTR  DS    A                                                        04115000
WGETPTR  DS    A                                                        04116000
IOBPTR   DS    A                                                        04117000
TUCBPTR  DS    A                                                        04118000
TUMSSPTR DS    A                                                        04119000
TINFOPTR DS    A                                                        04120000
WALLPTR  DS    A                                                        04121000
RETADDR  DS    A                                                        04122000
RETADDR1 DS    A                                                        04123000
RETADDR2 DS    A                                                        04124000
BUFFLN   DS    F                                                        04125000
REASON   DS    FL4                                                      04126000
         ORG   REASON                                                   04127000
@NM00105 DS    CL3                                                      04128000
REASID   DS    AL1                                                      04129000
         ORG   REASON+4                                                 04130000
SSDLPTR  DS    A                                                        04131000
LISTPTR  DS    A                                                        04132000
TESTRC   DS    H                                                        04133000
LOOPCNT  DS    H                                                        04134000
OUTCNT   DS    H                                                        04135000
READCNT  DS    H                                                        04136000
BUFCNT   DS    H                                                        04137000
BUFFUL   DS    H                                                        04138000
MOVECNT  DS    H                                                        04139000
SETRC    DS    H                                                        04140000
ECBCODE  DS    FL1                                                      04141000
ENTRYNUM DS    FL1                                                      04142000
LISTLN   DS    FL1                                                      04143000
@TS00001 DS    CL95                                                     04144000
         DS    CL2                                                      04145000
TRDTETME DS    CL8                                                      04146000
         ORG   TRDTETME                                                 04147000
TRDATE   DS    CL4                                                      04148000
TRTIME   DS    FL4                                                      04149000
         ORG   TRDTETME+8                                               04150000
CURCHR   DS    CL8                                                      04151000
         ORG   CURCHR                                                   04152000
CURPTR   DS    CL5                                                      04153000
         ORG   CURPTR                                                   04154000
CURRCC   DS    FL2                                                      04155000
CURRHH   DS    FL2                                                      04156000
CURRR    DS    FL1                                                      04157000
         ORG   CURCHR+5                                                 04158000
CURFILL  DS    CL3                                                      04159000
         ORG   CURCHR+8                                                 04160000
ACQCCCC  DS    CL4                                                      04161000
         ORG   ACQCCCC                                                  04162000
ACQCCS   DS    CL2                                                      04163000
ACQCCE   DS    CL2                                                      04164000
         ORG   ACQCCCC+4                                                04165000
WORKUNIT DS    CL12                                                     04166000
         ORG   WORKUNIT                                                 04167000
WUCNT    DS    FL2                                                      04168000
WULN     DS    FL2                                                      04169000
WUNAME   DS    CL8                                                      04170000
         ORG   WORKUNIT+12                                              04171000
CHRSAVE  DS    CL3                                                      04172000
         DS    CL1                                                      04173000
WFEXTENT DS    CL10                                                     04174000
         ORG   WFEXTENT                                                 04175000
WSTARTCC DS    CL2                                                      04176000
         ORG   WSTARTCC                                                 04177000
WSTRTCC  DS    AL2                                                      04178000
         ORG   WFEXTENT+2                                               04179000
WSTARTHH DS    CL2                                                      04180000
         ORG   WSTARTHH                                                 04181000
WSTRTH1  DS    AL1                                                      04182000
WSTRTH2  DS    AL1                                                      04183000
         ORG   WFEXTENT+4                                               04184000
WSTARTRR DS    CL1                                                      04185000
WENDCC   DS    CL2                                                      04186000
         ORG   WENDCC                                                   04187000
WENDDCC  DS    AL2                                                      04188000
         ORG   WFEXTENT+7                                               04189000
WENDHH   DS    CL2                                                      04190000
         ORG   WENDHH                                                   04191000
WENDH1   DS    AL1                                                      04192000
WENDH2   DS    AL1                                                      04193000
         ORG   WFEXTENT+9                                               04194000
WENDRR   DS    CL1                                                      04195000
         ORG   WFEXTENT+10                                              04196000
         DS    CL2                                                      04197000
VOLDATA  DS    CL38                                                     04198000
         ORG   VOLDATA                                                  04199000
HDRLN1   DS    FL2                                                      04200000
HDRLN2   DS    FL2                                                      04201000
DATACODE DS    FL2                                                      04202000
DATALN   DS    FL2                                                      04203000
TRACVOL  DS    CL6                                                      04204000
@NM00103 DS    CL24                                                     04205000
         ORG   VOLDATA+38                                               04206000
TRACDDN  DS    CL8                                                      04207000
         DS    CL2                                                      04208000
WGETLST  DS    CL32                                                     04209000
WALLOLST DS    CL31                                                     04210000
         DS    CL1                                                      04211000
WOPENLST DS    CL34                                                     04212000
         DS    CL2                                                      04213000
OOPENLST DS    BL48                                                     04214000
PARMLST  DS    CL96                                                     04215000
DUMPAREA DS    CL17                                                     04216000
SWITCHES DS    CL1                                                      04217000
         ORG   SWITCHES                                                 04218000
GMAINF   DS    BL1                                                      04219000
WALLOC   EQU   SWITCHES+0                                               04220000
WACQ     EQU   SWITCHES+0                                               04221000
TRSWAP   EQU   SWITCHES+0                                               04222000
TRNULL   EQU   SWITCHES+0                                               04223000
EXITSW   EQU   SWITCHES+0                                               04224000
         ORG   SWITCHES+1                                               04225000
         DS    CL2                                                      04226000
PRINTTAB DS    CL20                                                     04227000
SSDRGLT  DS    CL20                                                     04228000
SSINXLST DS    CL120                                                    04229000
         ORG   SSINXLST                                                 04230000
SSARRAY  DS    60H                                                      04231000
         ORG   SSINXLST+120                                             04232000
LIMITCHR DS    CL8                                                      04233000
         ORG   LIMITCHR+0                                               04234000
LIMCC    DS    FL2                                                      04235000
LIMHH    DS    FL2                                                      04236000
LIMR     DS    FL1                                                      04237000
LIMFILL  DS    CL3                                                      04238000
         ORG   LIMITCHR+16                                              04239000
SEEKCHR  DS    CL8                                                      04240000
         ORG   SEEKCHR+0                                                04241000
SEEKCC   DS    FL2                                                      04242000
SEEKHH   DS    FL2                                                      04243000
SEEKR    DS    AL1                                                      04244000
SEEKFILL DS    CL3                                                      04245000
         ORG   SEEKCHR+16                                               04246000
SRCHCHR  DS    CL8                                                      04247000
         ORG   SRCHCHR+0                                                04248000
SRCHCC   DS    FL2                                                      04249000
SRCHHH   DS    FL2                                                      04250000
SRCHR    DS    AL1                                                      04251000
SRCHFILL DS    CL3                                                      04252000
         ORG   SRCHCHR+16                                               04253000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04254000
@ENDDATD EQU   *                                                        04255000
IDCTR01  CSECT                                                          04256000
         DS    0F                                                       04257000
@SIZDATD DC    AL1(0)                                                   04258000
         DC    AL3(@ENDDATD-@DATD)                                      04259000
         DS    0D                                                       04260000
SSMSGNUM DC    AL1(56)                                                  04261000
@CC01321 DC    C'TRACLIST'                                              04262000
@CC01334 DC    C'ACQLIST'                                               04263000
@CC01337 DC    C'COTLIST'                                               04264000
@CC01345 DC    C'ALLAGL'                                                04265000
@CC01299 DC    C'SDG00'                                                 04266000
@CC01312 DC    C'TRAA'                                                  04267000
@CC01316 DC    C'TRAZ'                                                  04268000
@CC01320 EQU   @CC01321                                                 04269000
@CC01323 DC    C'TRAG'                                                  04270000
@CC01328 DC    C'TRAD'                                                  04271000
@CC01332 DC    C'TRAH'                                                  04272000
@CC01335 DC    C'TRAI'                                                  04273000
@CC01336 DC    C'TRAJ'                                                  04274000
@CC01338 DC    C'TRAK'                                                  04275000
@CC01343 DC    C'TRAE'                                                  04276000
@CC01346 DC    C'TRAL'                                                  04277000
@CC01352 DC    C'TRAF'                                                  04278000
@CC01357 DC    C'TRAM'                                                  04279000
@CC01379 DC    C'SSAA'                                                  04280000
@CC01276 DC    C'UV0'                                                   04281000
@CC01280 DC    C'TR0'                                                   04282000
@CB01295 DC    X'0000000000'                                            04283000
ALL      DC    CL3'ALL'                                                 04284000
FORMAT   DC    CL4'FORM'                                                04285000
HSECOND  DC    CL4'HSEC'                                                04286000
CLOCK    DC    CL4'KLOK'                                                04287000
SETZERO  DC    CL4'ZERO'                                                04288000
SETBLANK DC    CL4'BLNK'                                                04289000
NOSET    DC    CL4'NSET'                                                04290000
OVERRIDE DC    CL4'OVRD'                                                04291000
ACQUIRE  DC    CL8'ACQUIRE '                                            04292000
RELINQ   DC    CL8'RELINQ  '                                            04293000
MOUNT    DC    CL8'MOUNT   '                                            04294000
DEMOUNT  DC    CL8'DEMOUNT '                                            04295000
DEFINE   DC    CL8'DEFINE  '                                            04296000
MOVE     DC    CL8'MOVE    '                                            04297000
TRACEQ   DC    CL8'TRACEQ  '                                            04298000
COPYTABL DC    CL8'COPYTABL'                                            04299000
COPYCRTG DC    CL8'COPYCRTG'                                            04300000
COPYVOL  DC    CL8'COPYVOL '                                            04301000
VVIC     DC    CL8'VVIC    '                                            04302000
TUNE     DC    CL8'TUNE    '                                            04303000
NAMES    DC    CL4'NAME'                                                04304000
UNIT     DC    CL4'UNIT'                                                04305000
SHR      DC    CL4'SHR '                                                04306000
EXCL     DC    CL4'EXCL'                                                04307000
NOWAIT   DC    CL4'NWAI'                                                04308000
WAIT     DC    CL4'WAIT'                                                04309000
SECCHECK DC    CL8'SECCHECK'                                            04310000
SCRVTOC  DC    CL8'SCRVTOC '                                            04311000
GETVTOC  DC    CL8'GETVTOC '                                            04312000
PUTVTOC  DC    CL8'PUTVTOC '                                            04313000
RECATLG  DC    CL8'RECATLG '                                            04314000
INITVOL  DC    CL8'INITVOL '                                            04315000
CHECK    DC    CL8'CHECK   '                                            04316000
POSTUCB  DC    CL8'POSTUCB '                                            04317000
GET      DC    CL8'GET     '                                            04318000
PUT      DC    CL8'PUT     '                                            04319000
CLOSE    DC    CL8'CLOSE   '                                            04320000
OPEN     DC    CL8'OPEN    '                                            04321000
RVOPENR  DC    CL8'OPENR   '                                            04322000
RVRDCNT  DC    CL8'READCNT '                                            04323000
RVREADKD DC    CL8'READKD  '                                            04324000
RVSPACCR DC    CL8'SPACCR  '                                            04325000
RVFWRITE DC    CL8'FWRITE  '                                            04326000
RVWRITER DC    CL8'WRITEREC'                                            04327000
PUTLABEL DC    CL8'PUTLABEL'                                            04328000
GETLABEL DC    CL8'GETLABEL'                                            04329000
CANCEL   DC    CL8'CANCEL  '                                            04330000
SET      DC    CL8'SET     '                                            04331000
SELECTX  DC    CL8'SELECTX '                                            04332000
CHANGEX  DC    CL8'CHANGEX '                                            04333000
SELECTDD DC    CL8'SELECTDD'                                            04334000
SELECTDS DC    CL8'SELECTDS'                                            04335000
TBLREST  DC    CL8'TBLREST '                                            04336000
NULLIFYC DC    CL8'NULLIFYC'                                            04337000
RDMSC    DC    CL8'RDMSC   '                                            04338000
RDMSCTBL DC    CL8'RDMSCTBL'                                            04339000
RDCARTLB DC    CL8'RDCARTLB'                                            04340000
AUDITCEL DC    CL8'AUDITCEL'                                            04341000
RDSTGAD  DC    CL8'RDSTGAD '                                            04342000
MODID    DC    CL4'TR01'                                                04343000
FIXAREA  DS    CL600                                                    04344000
         ORG   FIXAREA                                                  04345000
@NM00106 DC    600X'00'                                                 04346000
         ORG   FIXAREA+600                                              04347000
SSMODSS0 DC    CL3'SS0'                                                 04348000
SSMODCM0 DC    CL3'CM0'                                                 04349000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04350000
@01      EQU   01                                                       04351000
@02      EQU   02                                                       04352000
@03      EQU   03                                                       04353000
@04      EQU   04                                                       04354000
@05      EQU   05                                                       04355000
@06      EQU   06                                                       04356000
@07      EQU   07                                                       04357000
@08      EQU   08                                                       04358000
@09      EQU   09                                                       04359000
@10      EQU   10                                                       04360000
@11      EQU   11                                                       04361000
@12      EQU   12                                                       04362000
@13      EQU   13                                                       04363000
@14      EQU   14                                                       04364000
@15      EQU   15                                                       04365000
REG10    EQU   @10                                                      04366000
REG11    EQU   @11                                                      04367000
REG12    EQU   @12                                                      04368000
RTNREG   EQU   @15                                                      04369000
REG14    EQU   @14                                                      04370000
ARR1     EQU   @01                                                      04371000
COTBR1   EQU   @01                                                      04372000
REG0     EQU   @00                                                      04373000
REG1     EQU   @01                                                      04374000
REG13    EQU   @13                                                      04375000
REG15    EQU   @15                                                      04376000
REG2     EQU   @02                                                      04377000
REG3     EQU   @03                                                      04378000
REG4     EQU   @04                                                      04379000
REG5     EQU   @05                                                      04380000
REG6     EQU   @06                                                      04381000
REG7     EQU   @07                                                      04382000
REG8     EQU   @08                                                      04383000
REG9     EQU   @09                                                      04384000
TRACR1   EQU   @01                                                      04385000
IDCSAEP0 EQU   0                                                        04386000
IDCSAGS0 EQU   0                                                        04387000
IDCSAFS0 EQU   0                                                        04388000
IDCSATI0 EQU   0                                                        04389000
IDCSAAL0 EQU   0                                                        04390000
IDCSADL0 EQU   0                                                        04391000
IDCSASS0 EQU   0                                                        04392000
IDCSA060 EQU   0                                                        04393000
TRACE1   EQU   0                                                        04394000
OLDERID1 EQU   TRACE1                                                   04395000
TRACE2   EQU   0                                                        04396000
OLDERID2 EQU   TRACE2                                                   04397000
NEWID2   EQU   TRACE2+95                                                04398000
NEWERID2 EQU   5                                                        04399000
CIRAGL   EQU   0                                                        04400000
CIRTYPE  EQU   CIRAGL                                                   04401000
ALLAGL   EQU   0                                                        04402000
ALLDSN   EQU   ALLAGL                                                   04403000
ALLDDN   EQU   ALLAGL+4                                                 04404000
ALLULP   EQU   ALLAGL+12                                                04405000
ALLSTS   EQU   ALLAGL+24                                                04406000
ALLSTSOD EQU   ALLSTS                                                   04407000
ALLDSP   EQU   ALLAGL+25                                                04408000
ALLDSPKP EQU   ALLDSP                                                   04409000
ALLORG   EQU   ALLAGL+26                                                04410000
ALLOPT   EQU   ALLAGL+28                                                04411000
ALLOPTDS EQU   ALLOPT                                                   04412000
UNITABL  EQU   0                                                        04413000
UNITADR  EQU   UNITABL+4                                                04414000
@NM00010 EQU   UNITADR                                                  04415000
UNITSTAT EQU   UNITABL+6                                                04416000
IDCIOOP0 EQU   0                                                        04417000
IDCIOCL0 EQU   0                                                        04418000
IDCIOPT0 EQU   0                                                        04419000
IDCIOSI0 EQU   0                                                        04420000
IDCIO050 EQU   0                                                        04421000
IOCSTR   EQU   0                                                        04422000
IOCDAD   EQU   IOCSTR                                                   04423000
IOCDLN   EQU   IOCSTR+4                                                 04424000
IOCTRN   EQU   IOCSTR+8                                                 04425000
IOCDSO   EQU   IOCSTR+16                                                04426000
IOCRFM   EQU   IOCSTR+17                                                04427000
IOCMAC   EQU   IOCSTR+18                                                04428000
IOCMAC2  EQU   IOCSTR+19                                                04429000
IOCCHP   EQU   IOCSTR+20                                                04430000
IOCMSG   EQU   IOCSTR+21                                                04431000
IOCRBA   EQU   IOCSTR+40                                                04432000
IOCTTR   EQU   IOCRBA                                                   04433000
IOCMEM   EQU   IOCSTR+44                                                04434000
IOCNWM   EQU   IOCSTR+48                                                04435000
OPNAGL   EQU   0                                                        04436000
OPNOPT   EQU   OPNAGL                                                   04437000
OPNOPTOT EQU   OPNOPT                                                   04438000
OPNOPTBK EQU   OPNOPT                                                   04439000
OPNOPTCR EQU   OPNOPT                                                   04440000
OPNRFM   EQU   OPNAGL+1                                                 04441000
OPNRFMFX EQU   OPNRFM                                                   04442000
OPNRFMBK EQU   OPNRFM                                                   04443000
OPNTYP   EQU   OPNAGL+2                                                 04444000
OPNMOD   EQU   OPNAGL+3                                                 04445000
OPNIOC   EQU   OPNAGL+4                                                 04446000
OPNDDN   EQU   OPNAGL+8                                                 04447000
OPNDSN   EQU   OPNAGL+16                                                04448000
OPNDEV   EQU   OPNAGL+24                                                04449000
OPNREC   EQU   OPNAGL+32                                                04450000
OPNDSO   EQU   OPNAGL+41                                                04451000
OPNOPT2  EQU   OPNAGL+42                                                04452000
IOINFOPT EQU   0                                                        04453000
IOINFVOL EQU   IOINFOPT                                                 04454000
UVOLLIST EQU   0                                                        04455000
UVOLENT  EQU   UVOLLIST+2                                               04456000
AMSTP011 EQU   0                                                        04457000
DARGLIST EQU   0                                                        04458000
DARGDBP  EQU   DARGLIST                                                 04459000
DARGRETP EQU   DARGLIST+4                                               04460000
DARGSTID EQU   DARGLIST+8                                               04461000
DARGSMOD EQU   DARGSTID                                                 04462000
DARGSENT EQU   DARGSTID+3                                               04463000
DARGILP  EQU   DARGLIST+12                                              04464000
DARGRETL EQU   DARGLIST+16                                              04465000
DARGARY  EQU   DARGLIST+20                                              04466000
DARGINS  EQU   DARGARY                                                  04467000
DARGINL  EQU   DARGARY+2                                                04468000
FMTLIST  EQU   0                                                        04469000
FMTFLGS  EQU   FMTLIST                                                  04470000
FMTSPF   EQU   FMTLIST+2                                                04471000
FMTRFNO  EQU   FMTSPF                                                   04472000
FMTILEN  EQU   FMTRFNO                                                  04473000
FMTIOFF  EQU   FMTLIST+4                                                04474000
FMTTRBC  EQU   FMTIOFF                                                  04475000
FMTSTO   EQU   FMTTRBC                                                  04476000
FMTOCOL  EQU   FMTLIST+6                                                04477000
FMTCNVF  EQU   FMTLIST+10                                               04478000
ERCNVTAB EQU   0                                                        04479000
ERTYPE   EQU   ERCNVTAB                                                 04480000
EROPER   EQU   ERCNVTAB+1                                               04481000
EROSOPER EQU   ERCNVTAB+2                                               04482000
IDCDB010 EQU   0                                                        04483000
DMPITM   EQU   0                                                        04484000
DMPITMNM EQU   DMPITM                                                   04485000
DMPITMPT EQU   DMPITM+8                                                 04486000
DMPITMLN EQU   DMPITM+12                                                04487000
DMPITMTP EQU   DMPITM+14                                                04488000
DMPARY   EQU   0                                                        04489000
DMPTRM   EQU   0                                                        04490000
ZXON     EQU   0                                                        04491000
ZXOFF    EQU   0                                                        04492000
X        EQU   0                                                        04493000
Y        EQU   0                                                        04494000
BOTH     EQU   0                                                        04495000
ACT      EQU   0                                                        04496000
INACT    EQU   0                                                        04497000
ZXMAX    EQU   0                                                        04498000
OFILE    EQU   0                                                        04499000
OFILEVAL EQU   OFILE+1                                                  04500000
ODS      EQU   0                                                        04501000
ODSFLG   EQU   ODS+10                                                   04502000
ODSVAL   EQU   ODS+21                                                   04503000
WFILE    EQU   0                                                        04504000
WFILEVAL EQU   WFILE+1                                                  04505000
WDS      EQU   0                                                        04506000
WDSFLG   EQU   WDS+10                                                   04507000
WDSVAL   EQU   WDS+21                                                   04508000
CCMSG    EQU   0                                                        04509000
CMMSG    EQU   0                                                        04510000
CMVOLFLG EQU   CMMSG+6                                                  04511000
CTMSG    EQU   0                                                        04512000
CTREALH  EQU   CTMSG+3                                                  04513000
CTARRAY  EQU   CTMSG+4                                                  04514000
CTTBLCC  EQU   CTARRAY+1                                                04515000
CTTBLHH  EQU   CTARRAY+2                                                04516000
CTTBLRR  EQU   CTARRAY+3                                                04517000
MDAGL    EQU   0                                                        04518000
MDFLAGS  EQU   MDAGL+30                                                 04519000
MDVTOC   EQU   MDAGL+32                                                 04520000
PUAGL    EQU   0                                                        04521000
CKAGL    EQU   0                                                        04522000
CKUCBPTR EQU   CKAGL+8                                                  04523000
CKDDNAME EQU   CKAGL+12                                                 04524000
CKLABELP EQU   CKAGL+24                                                 04525000
CKFLAGS  EQU   CKAGL+28                                                 04526000
CKTESTVT EQU   CKFLAGS                                                  04527000
EXCLAGL  EQU   0                                                        04528000
EXCLFLAG EQU   EXCLAGL+22                                               04529000
EXOARG   EQU   0                                                        04530000
EXODDN   EQU   EXOARG+8                                                 04531000
EXOEXT   EQU   EXOARG+24                                                04532000
EXOCTLBK EQU   EXOARG+28                                                04533000
EXOPT    EQU   EXOARG+32                                                04534000
EXOTAB   EQU   EXOPT                                                    04535000
EXFLG    EQU   EXOARG+33                                                04536000
EXOREAD  EQU   EXFLG                                                    04537000
EXGARG   EQU   0                                                        04538000
EXGCTLBK EQU   EXGARG+8                                                 04539000
EXGCCHH1 EQU   EXGARG+12                                                04540000
EXGCCHH2 EQU   EXGARG+16                                                04541000
EXGRECNO EQU   EXGARG+20                                                04542000
EXGDATAP EQU   EXGARG+24                                                04543000
EXGKEYLN EQU   EXGARG+28                                                04544000
EXGDATAL EQU   EXGARG+30                                                04545000
EXWRARG  EQU   0                                                        04546000
EXRWCHR  EQU   EXWRARG+26                                               04547000
EXSPACE  EQU   EXWRARG+36                                               04548000
EXPARG   EQU   0                                                        04549000
EXPDATA  EQU   EXPARG+12                                                04550000
EXPDATAB EQU   0                                                        04551000
EXPARRAY EQU   EXPDATAB+4                                               04552000
VS2AGL   EQU   0                                                        04553000
VSLABOPT EQU   VS2AGL+28                                                04554000
VS2MSG   EQU   VS2AGL+35                                                04555000
VS2RESOP EQU   VS2AGL+36                                                04556000
VS1AGL   EQU   0                                                        04557000
VSSECOPT EQU   VS1AGL+68                                                04558000
VSVTOPT  EQU   VS1AGL+69                                                04559000
VSCATOPT EQU   VS1AGL+70                                                04560000
VSRETURN EQU   VS1AGL+71                                                04561000
VSMSG    EQU   VS1AGL+72                                                04562000
VSRESOPT EQU   VS1AGL+73                                                04563000
RCTAGL   EQU   0                                                        04564000
RCTOPT   EQU   RCTAGL+8                                                 04565000
STAEPARM EQU   0                                                        04566000
STARCVY  EQU   STAEPARM+52                                              04567000
STARETRY EQU   STAEPARM+53                                              04568000
VOLLABEL EQU   0                                                        04569000
SV82LIST EQU   0                                                        04570000
@NM00072 EQU   SV82LIST+4                                               04571000
SV82DCBP EQU   @NM00072                                                 04572000
@NM00073 EQU   SV82LIST+12                                              04573000
SV82WRKP EQU   @NM00073                                                 04574000
SRTAGL   EQU   0                                                        04575000
LCTINFO  EQU   0                                                        04576000
LCTFLAGS EQU   LCTINFO+32                                               04577000
UCTAGL   EQU   0                                                        04578000
UCTFLAGS EQU   UCTAGL+68                                                04579000
SELAGL   EQU   0                                                        04580000
SELFLAGS EQU   SELAGL+22                                                04581000
DATESAGL EQU   0                                                        04582000
DATESOPT EQU   DATESAGL+20                                              04583000
VS3AGL   EQU   0                                                        04584000
VS3FLAGS EQU   VS3AGL+58                                                04585000
VSDVTOC  EQU   0                                                        04586000
VSDSTAT  EQU   0                                                        04587000
VSDSFLG1 EQU   VSDSTAT+16                                               04588000
VSDFLG2  EQU   VSDSTAT+17                                               04589000
VSDSCR   EQU   0                                                        04590000
VSDSCRFL EQU   VSDSCR+4                                                 04591000
VSDUSAGE EQU   0                                                        04592000
VSDDORG  EQU   VSDUSAGE+9                                               04593000
VSDALLOC EQU   VSDUSAGE+10                                              04594000
VSDUSEF  EQU   VSDUSAGE+11                                              04595000
VSDDSORG EQU   VSDUSAGE+16                                              04596000
VSDBLOCK EQU   0                                                        04597000
VSDSPACE EQU   VSDBLOCK+12                                              04598000
VSDARRAY EQU   VSDBLOCK+16                                              04599000
VSDVARY  EQU   VSDARRAY+48                                              04600000
TRACLIST EQU   0                                                        04601000
TRACFLG  EQU   TRACLIST+6                                               04602000
TRACEON  EQU   TRACFLG                                                  04603000
TRACTIM  EQU   TRACLIST+8                                               04604000
COTLIST  EQU   0                                                        04605000
COTBFLG  EQU   COTLIST+6                                                04606000
COTBTRX  EQU   COTBFLG+1                                                04607000
COTBTRY  EQU   COTBFLG+1                                                04608000
COTBTRA  EQU   COTBFLG+1                                                04609000
COTBTRI  EQU   COTBFLG+1                                                04610000
COTBEXTS EQU   COTLIST+8                                                04611000
COTBVOL  EQU   COTLIST+12                                               04612000
ACQLIST  EQU   0                                                        04613000
ARLL     EQU   ACQLIST                                                  04614000
AROP     EQU   ACQLIST+4                                                04615000
ARFLG    EQU   ACQLIST+6                                                04616000
ARBDUBD  EQU   ARFLG                                                    04617000
ARDRES   EQU   ARFLG                                                    04618000
ARINH    EQU   ARFLG                                                    04619000
ARNMEXT  EQU   ACQLIST+7                                                04620000
ARVOL    EQU   ACQLIST+8                                                04621000
AREXT    EQU   ACQLIST+28                                               04622000
CTMSGDEF EQU   0                                                        04623000
TRREALCC EQU   CTMSGDEF+1                                               04624000
TRARRAY  EQU   CTMSGDEF+4                                               04625000
TRCCHHR  EQU   TRARRAY+1                                                04626000
INBUF    EQU   0                                                        04627000
INREC    EQU   INBUF                                                    04628000
PREFIX   EQU   INREC                                                    04629000
TRACDATA EQU   INREC+8                                                  04630000
DATACNT  EQU   TRACDATA                                                 04631000
RECTYPE  EQU   TRACDATA+2                                               04632000
OUTBLK   EQU   0                                                        04633000
OUTREC   EQU   OUTBLK                                                   04634000
OUTPREF  EQU   OUTREC                                                   04635000
OUTDATA  EQU   OUTREC+8                                                 04636000
AMSTP041 EQU   0                                                        04637000
AMSTP042 EQU   0                                                        04638000
AMSTP043 EQU   0                                                        04639000
AMSTP044 EQU   0                                                        04640000
CURR     EQU   0                                                        04641000
DUMP     EQU   0                                                        04642000
IDCIOCO0 EQU   0                                                        04643000
IDCIOGT0 EQU   0                                                        04644000
IDCIOIT0 EQU   0                                                        04645000
IDCIOPO0 EQU   0                                                        04646000
IDCIOST0 EQU   0                                                        04647000
IDCIOTM0 EQU   0                                                        04648000
IDCIOVY0 EQU   0                                                        04649000
IDCSACA0 EQU   0                                                        04650000
IDCSACL0 EQU   0                                                        04651000
IDCSACR0 EQU   0                                                        04652000
IDCSADE0 EQU   0                                                        04653000
IDCSADQ0 EQU   0                                                        04654000
IDCSAFP0 EQU   0                                                        04655000
IDCSAGP0 EQU   0                                                        04656000
IDCSAID0 EQU   0                                                        04657000
IDCSALC0 EQU   0                                                        04658000
IDCSALD0 EQU   0                                                        04659000
IDCSALK0 EQU   0                                                        04660000
IDCSANQ0 EQU   0                                                        04661000
IDCSAPR0 EQU   0                                                        04662000
IDCSAPT0 EQU   0                                                        04663000
IDCSAQL0 EQU   0                                                        04664000
IDCSARC0 EQU   0                                                        04665000
IDCSARV0 EQU   0                                                        04666000
IDCSASC0 EQU   0                                                        04667000
IDCSASI0 EQU   0                                                        04668000
IDCSASN0 EQU   0                                                        04669000
IDCSAST0 EQU   0                                                        04670000
IDCSAUC0 EQU   0                                                        04671000
IDCSAWO0 EQU   0                                                        04672000
IDCST010 EQU   0                                                        04673000
IDCTPER0 EQU   0                                                        04674000
LISTTEST EQU   0                                                        04675000
NEWERID1 EQU   5                                                        04676000
GDTTBL   EQU   0                                                        04677000
GDTTR1   EQU   GDTTBL+8                                                 04678000
GDTTR2   EQU   GDTTBL+12                                                04679000
GDTDBG   EQU   GDTTBL+40                                                04680000
GDTSTC   EQU   GDTTBL+44                                                04681000
GDTPRT   EQU   GDTTBL+48                                                04682000
GDTESS   EQU   GDTTBL+52                                                04683000
GDTESA   EQU   GDTTBL+56                                                04684000
GDTRST   EQU   GDTTBL+60                                                04685000
GDTRES   EQU   GDTTBL+64                                                04686000
GDTCAL   EQU   GDTTBL+68                                                04687000
GDTGSP   EQU   GDTTBL+72                                                04688000
GDTFSP   EQU   GDTTBL+76                                                04689000
GDTGPL   EQU   GDTTBL+80                                                04690000
GDTFPL   EQU   GDTTBL+84                                                04691000
GDTLOD   EQU   GDTTBL+88                                                04692000
GDTDEL   EQU   GDTTBL+92                                                04693000
GDTPRL   EQU   GDTTBL+96                                                04694000
GDTEPL   EQU   GDTTBL+100                                               04695000
GDTTIM   EQU   GDTTBL+104                                               04696000
GDTIIO   EQU   GDTTBL+108                                               04697000
GDTTIO   EQU   GDTTBL+112                                               04698000
GDTOPN   EQU   GDTTBL+124                                               04699000
GDTCLS   EQU   GDTTBL+128                                               04700000
GDTGET   EQU   GDTTBL+132                                               04701000
GDTPUT   EQU   GDTTBL+136                                               04702000
GDTPOS   EQU   GDTTBL+140                                               04703000
GDTCPY   EQU   GDTTBL+144                                               04704000
GDTCAT   EQU   GDTTBL+148                                               04705000
GDTSNP   EQU   GDTTBL+164                                               04706000
GDTVFY   EQU   GDTTBL+172                                               04707000
GDTUID   EQU   GDTTBL+192                                               04708000
GDTPMT   EQU   GDTTBL+196                                               04709000
GDTCIR   EQU   GDTTBL+200                                               04710000
GDTLNK   EQU   GDTTBL+204                                               04711000
GDTALC   EQU   GDTTBL+208                                               04712000
GDTDLC   EQU   GDTTBL+212                                               04713000
GDTQAL   EQU   GDTTBL+216                                               04714000
GDTSTW   EQU   GDTTBL+220                                               04715000
GDTSSC   EQU   GDTTBL+224                                               04716000
GDTENQ   EQU   GDTTBL+228                                               04717000
GDTRSV   EQU   GDTTBL+232                                               04718000
GDTDEQ   EQU   GDTTBL+236                                               04719000
GDTSFO   EQU   GDTTBL+240                                               04720000
GDTWTO   EQU   GDTTBL+244                                               04721000
GDTSCR   EQU   GDTTBL+248                                               04722000
GDTUNT   EQU   GDTTBL+252                                               04723000
GDTRCT   EQU   GDTTBL+256                                               04724000
GDTIFO   EQU   GDTTBL+260                                               04725000
GDTEXP   EQU   GDTTBL+264                                               04726000
GDTSTA   EQU   GDTTBL+268                                               04727000
GDTERR   EQU   GDTTBL+272                                               04728000
GDTUNC   EQU   GDTTBL+276                                               04729000
GDTLOC   EQU   GDTTBL+280                                               04730000
FDTTBL   EQU   0                                                        04731000
FDTPTR   EQU   FDTTBL+8                                                 04732000
LASTCOND EQU   0                                                        04733000
SSRCODE  EQU   0                                                        04734000
SSRHALF  EQU   SSRCODE+2                                                04735000
SSECBCD  EQU   0                                                        04736000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04737000
@NM00107 EQU   SSRCODE                                                  04738000
FDTVERB  EQU   FDTTBL                                                   04739000
GDTECT   EQU   GDTTBL+188                                               04740000
GDTPSB   EQU   GDTTBL+184                                               04741000
GDTUPT   EQU   GDTTBL+180                                               04742000
GDTCMB   EQU   GDTTBL+176                                               04743000
GDTSPR   EQU   GDTTBL+168                                               04744000
@NM00001 EQU   GDTTBL+160                                               04745000
GDTABH   EQU   GDTTBL+156                                               04746000
GDTABT   EQU   GDTTBL+152                                               04747000
GDTTOH   EQU   GDTTBL+120                                               04748000
GDTRIP   EQU   GDTTBL+116                                               04749000
GDTIOH   EQU   GDTTBL+36                                                04750000
GDTSAH   EQU   GDTTBL+32                                                04751000
GDTTPH   EQU   GDTTBL+28                                                04752000
GDTRIH   EQU   GDTTBL+24                                                04753000
GDTSTH   EQU   GDTTBL+20                                                04754000
GDTDBH   EQU   GDTTBL+16                                                04755000
GDTPRM   EQU   GDTTBL+4                                                 04756000
GDTHDR   EQU   GDTTBL                                                   04757000
@NM00104 EQU   TRACDATA+1                                               04758000
@NM00102 EQU   TRARRAY                                                  04759000
@NM00101 EQU   CTMSGDEF+3                                               04760000
@NM00100 EQU   CTMSGDEF                                                 04761000
ARNEDB   EQU   ACQLIST+92                                               04762000
@NM00099 EQU   AREXT                                                    04763000
ARCOMPC  EQU   ACQLIST+26                                               04764000
@NM00098 EQU   ACQLIST+25                                               04765000
ARHOST   EQU   ACQLIST+20                                               04766000
ARECB    EQU   ACQLIST+16                                               04767000
ARASID   EQU   ACQLIST+14                                               04768000
@NM00097 EQU   ARFLG                                                    04769000
ARSEC    EQU   ARFLG                                                    04770000
@NM00096 EQU   ACQLIST+5                                                04771000
COTBECB  EQU   COTLIST+20                                               04772000
COTBASID EQU   COTLIST+18                                               04773000
@NM00095 EQU   COTBFLG+1                                                04774000
@NM00094 EQU   COTBFLG                                                  04775000
COTBTID  EQU   COTBFLG                                                  04776000
@NM00093 EQU   COTLIST+5                                                04777000
COTBOP   EQU   COTLIST+4                                                04778000
COTBLL   EQU   COTLIST                                                  04779000
@NM00092 EQU   TRACFLG                                                  04780000
@NM00091 EQU   TRACLIST+5                                               04781000
TRACOPC  EQU   TRACLIST+4                                               04782000
TRACLEN  EQU   TRACLIST                                                 04783000
VSDDSN   EQU   VSDARRAY+4                                               04784000
VSDVOLCT EQU   VSDARRAY                                                 04785000
VSDFMT0  EQU   VSDBLOCK+8                                               04786000
VSDVTOCS EQU   VSDBLOCK+4                                               04787000
VSDELEM  EQU   VSDBLOCK                                                 04788000
VSDFREE  EQU   VSDUSAGE+24                                              04789000
VSDALLC  EQU   VSDUSAGE+19                                              04790000
VSDDSOR3 EQU   VSDDSORG+2                                               04791000
@NM00090 EQU   VSDDSORG                                                 04792000
VSDSCAL  EQU   VSDUSAGE+12                                              04793000
@NM00089 EQU   VSDUSEF                                                  04794000
VSDCALFR EQU   VSDUSEF                                                  04795000
@NM00088 EQU   VSDALLOC                                                 04796000
VSDABSTR EQU   VSDALLOC                                                 04797000
VSDABLK  EQU   VSDALLOC                                                 04798000
VSDATRK  EQU   VSDALLOC                                                 04799000
VSDACYL  EQU   VSDALLOC                                                 04800000
@NM00087 EQU   VSDDORG                                                  04801000
VSDOU    EQU   VSDDORG                                                  04802000
VSDOIS   EQU   VSDDORG                                                  04803000
VSDODA   EQU   VSDDORG                                                  04804000
VSDOUN   EQU   VSDDORG                                                  04805000
VSDOPS   EQU   VSDDORG                                                  04806000
VSDOPO   EQU   VSDDORG                                                  04807000
VSDEXTS  EQU   VSDUSAGE+8                                               04808000
VSDSECAL EQU   VSDUSAGE+4                                               04809000
VSDFTRK  EQU   VSDUSAGE+2                                               04810000
VSDTRKS  EQU   VSDUSAGE                                                 04811000
@NM00086 EQU   VSDSCR+5                                                 04812000
@NM00085 EQU   VSDSCRFL                                                 04813000
VSDVSAM  EQU   VSDSCRFL                                                 04814000
VSDCATLC EQU   VSDSCRFL                                                 04815000
VSDACBPT EQU   VSDSCR                                                   04816000
VSDPRTC  EQU   VSDSTAT+25                                               04817000
VSDCAT   EQU   VSDSTAT+22                                               04818000
VSDEXP   EQU   VSDSTAT+20                                               04819000
VSDCRE   EQU   VSDSTAT+18                                               04820000
@NM00084 EQU   VSDFLG2                                                  04821000
VSDERROR EQU   VSDFLG2                                                  04822000
VSDPROT  EQU   VSDFLG2                                                  04823000
VSDPWW   EQU   VSDFLG2                                                  04824000
VSDPWR   EQU   VSDFLG2                                                  04825000
@NM00083 EQU   VSDSFLG1                                                 04826000
VSDCVSAM EQU   VSDSFLG1                                                 04827000
VSDCATLG EQU   VSDSFLG1                                                 04828000
VSDVSAME EQU   VSDSFLG1                                                 04829000
VSDVSAMC EQU   VSDSFLG1                                                 04830000
VSDVTOCE EQU   VSDSFLG1                                                 04831000
VSDVTOCC EQU   VSDSFLG1                                                 04832000
VSDOWNER EQU   VSDSTAT+8                                                04833000
VSDEXPIR EQU   VSDSTAT+4                                                04834000
VSDCREAT EQU   VSDSTAT                                                  04835000
VSDFRCCL EQU   VSDVTOC+21                                               04836000
@NM00082 EQU   VSDVTOC+20                                               04837000
VSDFREXT EQU   VSDVTOC+16                                               04838000
@NM00081 EQU   VSDVTOC+15                                               04839000
VSDFRTRK EQU   VSDVTOC+11                                               04840000
@NM00080 EQU   VSDVTOC+10                                               04841000
VSDFRCYL EQU   VSDVTOC+6                                                04842000
@NM00079 EQU   VSDVTOC                                                  04843000
@NM00078 EQU   VS3FLAGS                                                 04844000
VS3SYSNM EQU   VS3FLAGS                                                 04845000
VS3UNCAT EQU   VS3FLAGS                                                 04846000
VS3SCR   EQU   VS3FLAGS                                                 04847000
VS3USAGE EQU   VS3FLAGS                                                 04848000
VS3STAT  EQU   VS3FLAGS                                                 04849000
VS3DD    EQU   VS3AGL+50                                                04850000
VS3VOL   EQU   VS3AGL+44                                                04851000
VS3POOL  EQU   VS3AGL+40                                                04852000
VS3DEV   EQU   VS3AGL+36                                                04853000
VS3UCBP  EQU   VS3AGL+32                                                04854000
VS3CREAT EQU   VS3AGL+28                                                04855000
VS3EXPIR EQU   VS3AGL+24                                                04856000
VS3AST   EQU   VS3AGL+22                                                04857000
VS3LEVLN EQU   VS3AGL+20                                                04858000
VS3LEVP  EQU   VS3AGL+16                                                04859000
VS3EXDSP EQU   VS3AGL+12                                                04860000
VS3LISTP EQU   VS3AGL+8                                                 04861000
VS3HEAD  EQU   VS3AGL                                                   04862000
@NM00077 EQU   DATESOPT                                                 04863000
DATDAYOP EQU   DATESOPT                                                 04864000
DATDTEOP EQU   DATESOPT                                                 04865000
DATSUB   EQU   DATESOPT                                                 04866000
DATADD   EQU   DATESOPT                                                 04867000
DATRETRN EQU   DATESAGL+16                                              04868000
DATDAYS  EQU   DATESAGL+12                                              04869000
DATDATE  EQU   DATESAGL+8                                               04870000
DATHEAD  EQU   DATESAGL                                                 04871000
@NM00076 EQU   SELFLAGS                                                 04872000
SELVOL   EQU   SELAGL+16                                                04873000
SELDDNP  EQU   SELAGL+12                                                04874000
SELUCBP  EQU   SELAGL+8                                                 04875000
SELHEAD  EQU   SELAGL                                                   04876000
@NM00075 EQU   UCTFLAGS                                                 04877000
UCTVSCAT EQU   UCTFLAGS                                                 04878000
UCTDD    EQU   UCTAGL+60                                                04879000
UCTVOLP  EQU   UCTAGL+56                                                04880000
UCTACBP  EQU   UCTAGL+52                                                04881000
UCTDSN   EQU   UCTAGL+8                                                 04882000
UCTHEAD  EQU   UCTAGL                                                   04883000
@NM00074 EQU   LCTFLAGS                                                 04884000
LCTVSCAT EQU   LCTFLAGS                                                 04885000
LCTOWNER EQU   LCTINFO+24                                               04886000
LCTEXPIR EQU   LCTINFO+20                                               04887000
LCTCREAT EQU   LCTINFO+16                                               04888000
LCTACBP  EQU   LCTINFO+12                                               04889000
LCTMULVC EQU   LCTINFO+8                                                04890000
LCTHEAD  EQU   LCTINFO                                                  04891000
SRTWORKP EQU   SRTAGL+28                                                04892000
SRTFLDLN EQU   SRTAGL+24                                                04893000
SRTPOSIT EQU   SRTAGL+20                                                04894000
SRTLEN   EQU   SRTAGL+16                                                04895000
SRTNUM   EQU   SRTAGL+12                                                04896000
SRTADDR  EQU   SRTAGL+8                                                 04897000
SRTHEAD  EQU   SRTAGL                                                   04898000
SV82DEBP EQU   SV82WRKP                                                 04899000
SV82TTRP EQU   SV82LIST+8                                               04900000
SV82VOLP EQU   SV82DCBP                                                 04901000
SV82UCBP EQU   SV82LIST+1                                               04902000
SV82CODE EQU   SV82LIST                                                 04903000
VOLRESV3 EQU   VOLLABEL+55                                              04904000
VOLOWNER EQU   VOLLABEL+45                                              04905000
VOLRESV1 EQU   VOLLABEL+20                                              04906000
VOLVTOC  EQU   VOLLABEL+15                                              04907000
VOLSECTY EQU   VOLLABEL+14                                              04908000
VOLSERNO EQU   VOLLABEL+8                                               04909000
VOLNO    EQU   VOLLABEL+7                                               04910000
VOLLABI  EQU   VOLLABEL+4                                               04911000
VOLKEY   EQU   VOLLABEL                                                 04912000
STAVTTR  EQU   STAEPARM+54                                              04913000
@NM00071 EQU   STARETRY                                                 04914000
STAVTOC  EQU   STARETRY                                                 04915000
STAOFF   EQU   STARETRY                                                 04916000
STAIO05  EQU   STARETRY                                                 04917000
@NM00070 EQU   STARCVY                                                  04918000
STACLEAR EQU   STARCVY                                                  04919000
STAVPOST EQU   STARCVY                                                  04920000
STAVENQ  EQU   STARCVY                                                  04921000
STAVDMNT EQU   STARCVY                                                  04922000
STAVMNT  EQU   STARCVY                                                  04923000
STATCB   EQU   STAEPARM+48                                              04924000
STARTADD EQU   STAEPARM+44                                              04925000
STAEXSAV EQU   STAEPARM+40                                              04926000
STARTSAV EQU   STAEPARM+36                                              04927000
STARTTR  EQU   STAEPARM+32                                              04928000
@NM00069 EQU   STAEPARM+30                                              04929000
STARVOL  EQU   STAEPARM+24                                              04930000
STARUCB  EQU   STAEPARM+20                                              04931000
@NM00068 EQU   STAEPARM+18                                              04932000
STAVVOL  EQU   STAEPARM+12                                              04933000
STAVUCB  EQU   STAEPARM+8                                               04934000
STAHEAD  EQU   STAEPARM                                                 04935000
RCTDSET  EQU   RCTAGL+32                                                04936000
RCTNVOL  EQU   RCTAGL+26                                                04937000
RCTOVOL  EQU   RCTAGL+20                                                04938000
RCTNDEV  EQU   RCTAGL+16                                                04939000
RCTODEV  EQU   RCTAGL+12                                                04940000
@NM00067 EQU   RCTAGL+10                                                04941000
@NM00066 EQU   RCTOPT                                                   04942000
RCTVOL   EQU   RCTOPT                                                   04943000
RCTDEV   EQU   RCTOPT                                                   04944000
RCTHEAD  EQU   RCTAGL                                                   04945000
@NM00065 EQU   VSRESOPT                                                 04946000
VSREAL   EQU   VSRESOPT                                                 04947000
VSRES    EQU   VSRESOPT                                                 04948000
@NM00064 EQU   VSMSG                                                    04949000
VSTOV    EQU   VSMSG                                                    04950000
VSFROMV  EQU   VSMSG                                                    04951000
@NM00063 EQU   VSRETURN                                                 04952000
VSUCAT   EQU   VSRETURN                                                 04953000
VSVSAM   EQU   VSRETURN                                                 04954000
@NM00062 EQU   VSCATOPT                                                 04955000
VSLIST   EQU   VSCATOPT                                                 04956000
VSSERIAL EQU   VSCATOPT                                                 04957000
VSDEVICE EQU   VSCATOPT                                                 04958000
@NM00061 EQU   VSVTOPT                                                  04959000
VSVSFLAG EQU   VSVTOPT                                                  04960000
VSALTTRK EQU   VSVTOPT                                                  04961000
VSTIME   EQU   VSVTOPT                                                  04962000
VSUCMAST EQU   VSSECOPT                                                 04963000
VSOPCAT  EQU   VSSECOPT                                                 04964000
VSUCTEST EQU   VSSECOPT                                                 04965000
VSWRITE  EQU   VSSECOPT                                                 04966000
VSREAD   EQU   VSSECOPT                                                 04967000
VSNONONV EQU   VSSECOPT                                                 04968000
VSMASTER EQU   VSSECOPT                                                 04969000
VSNOVSAM EQU   VSSECOPT                                                 04970000
VSODEVP  EQU   VS1AGL+64                                                04971000
VSOSERP  EQU   VS1AGL+60                                                04972000
VSDEVP   EQU   VS1AGL+56                                                04973000
VSSERP   EQU   VS1AGL+52                                                04974000
VSPFILEP EQU   VS1AGL+48                                                04975000
VSPSWDP  EQU   VS1AGL+44                                                04976000
VSCATDDP EQU   VS1AGL+40                                                04977000
VSACBP   EQU   VS1AGL+36                                                04978000
VSCATP   EQU   VS1AGL+32                                                04979000
VSNXTATP EQU   VS1AGL+28                                                04980000
VSNUMATP EQU   VS1AGL+24                                                04981000
VSIOP    EQU   VS1AGL+20                                                04982000
VSFILEP  EQU   VS1AGL+16                                                04983000
VSVOLP   EQU   VS1AGL+12                                                04984000
VSUCBP   EQU   VS1AGL+8                                                 04985000
VSHEAD   EQU   VS1AGL                                                   04986000
VSVTOCPT EQU   VS2AGL+48                                                04987000
@NM00060 EQU   VS2AGL+45                                                04988000
VSDDNAME EQU   VS2AGL+37                                                04989000
@NM00059 EQU   VS2RESOP                                                 04990000
VS2REAL  EQU   VS2RESOP                                                 04991000
VS2RES   EQU   VS2RESOP                                                 04992000
@NM00058 EQU   VS2MSG                                                   04993000
VS2TOV   EQU   VS2MSG                                                   04994000
VSVOLUME EQU   VS2AGL+29                                                04995000
@NM00057 EQU   VSLABOPT                                                 04996000
VSNOVTOC EQU   VSLABOPT                                                 04997000
VSVOLSER EQU   VSLABOPT                                                 04998000
VSOWNER  EQU   VSLABOPT                                                 04999000
VSIOBKPT EQU   VS2AGL+24                                                05000000
VSVOLPTR EQU   VS2AGL+20                                                05001000
VSOWNPTR EQU   VS2AGL+16                                                05002000
VSVTOCSZ EQU   VS2AGL+12                                                05003000
VSUCBPTR EQU   VS2AGL+8                                                 05004000
VS2HEAD  EQU   VS2AGL                                                   05005000
EXPDATAL EQU   EXPARRAY+6                                               05006000
@NM00056 EQU   EXPARRAY+5                                               05007000
EXPKEYLN EQU   EXPARRAY+4                                               05008000
EXPDATAP EQU   EXPARRAY                                                 05009000
EXPRECNO EQU   EXPDATAB                                                 05010000
EXPCCHHR EQU   EXPARG+16                                                05011000
EXPCTLBK EQU   EXPARG+8                                                 05012000
EXPHEAD  EQU   EXPARG                                                   05013000
EXRWFUN  EQU   EXWRARG+46                                               05014000
@NM00055 EQU   EXSPACE+8                                                05015000
@NM00054 EQU   EXSPACE+6                                                05016000
@NM00053 EQU   EXSPACE+4                                                05017000
@NM00052 EQU   EXSPACE+1                                                05018000
@NM00051 EQU   EXSPACE                                                  05019000
EXRWKDLN EQU   EXWRARG+32                                               05020000
@NM00050 EQU   EXWRARG+31                                               05021000
EXRECNUM EQU   EXRWCHR+4                                                05022000
EXHH     EQU   EXRWCHR+2                                                05023000
EXCC     EQU   EXRWCHR                                                  05024000
EXCCWCNT EQU   EXWRARG+24                                               05025000
EXLOCPTR EQU   EXWRARG+20                                               05026000
EXRWDARE EQU   EXWRARG+16                                               05027000
EXRWIOAR EQU   EXWRARG+12                                               05028000
EXRWCTBL EQU   EXWRARG+8                                                05029000
EXRWRES  EQU   EXWRARG                                                  05030000
@NM00049 EQU   EXGARG+29                                                05031000
EXGHEAD  EQU   EXGARG                                                   05032000
EXOVTH   EQU   EXFLG                                                    05033000
EXORVT   EQU   EXFLG                                                    05034000
EXORDS   EQU   EXFLG                                                    05035000
EXOSPK   EQU   EXFLG                                                    05036000
EXORVS   EQU   EXFLG                                                    05037000
@NM00048 EQU   EXFLG                                                    05038000
@NM00047 EQU   EXOPT                                                    05039000
EXOREP   EQU   EXOPT                                                    05040000
EXOVTOC  EQU   EXOPT                                                    05041000
EXONEW   EQU   EXOPT                                                    05042000
EXOPASS  EQU   EXOPT                                                    05043000
EXOLAB   EQU   EXOPT                                                    05044000
EXOUCB   EQU   EXOARG+20                                                05045000
EXOVSN   EQU   EXOARG+16                                                05046000
EXODSN   EQU   EXOARG+12                                                05047000
EXOHEAD  EQU   EXOARG                                                   05048000
@NM00046 EQU   EXCLFLAG                                                 05049000
EXCLMNT  EQU   EXCLFLAG                                                 05050000
EXCLVOL  EQU   EXCLAGL+16                                               05051000
EXCLDDP  EQU   EXCLAGL+12                                               05052000
EXCLUCBP EQU   EXCLAGL+8                                                05053000
EXCLHEAD EQU   EXCLAGL                                                  05054000
@NM00045 EQU   CKFLAGS                                                  05055000
CKDMTABL EQU   CKFLAGS                                                  05056000
CKRETTYP EQU   CKFLAGS                                                  05057000
CKDATYPE EQU   CKAGL+20                                                 05058000
CKHEAD   EQU   CKAGL                                                    05059000
PULABELP EQU   PUAGL+16                                                 05060000
PUTTRPTR EQU   PUAGL+12                                                 05061000
PUUCBPTR EQU   PUAGL+8                                                  05062000
PUHEAD   EQU   PUAGL                                                    05063000
MDR      EQU   MDVTOC+4                                                 05064000
MDHH     EQU   MDVTOC+2                                                 05065000
MDCC     EQU   MDVTOC                                                   05066000
@NM00044 EQU   MDAGL+31                                                 05067000
MDVTOCTR EQU   MDFLAGS                                                  05068000
MDFORCE  EQU   MDFLAGS                                                  05069000
MDDEQ    EQU   MDFLAGS                                                  05070000
MDENQ    EQU   MDFLAGS                                                  05071000
MDWAIT   EQU   MDFLAGS                                                  05072000
MDPOST   EQU   MDFLAGS                                                  05073000
MDCLEAR  EQU   MDFLAGS                                                  05074000
MDNEWVOL EQU   MDFLAGS                                                  05075000
MDLABEL  EQU   MDAGL+24                                                 05076000
MDPUAGL  EQU   MDAGL+20                                                 05077000
MDDDNAME EQU   MDAGL+12                                                 05078000
MDUCBPTR EQU   MDAGL+8                                                  05079000
MDHEAD   EQU   MDAGL                                                    05080000
CTTBLID  EQU   CTARRAY                                                  05081000
CTREALCC EQU   CTMSG+1                                                  05082000
@NM00043 EQU   CTMSG                                                    05083000
CMCSN2   EQU   CMMSG+28                                                 05084000
CMCSN1   EQU   CMMSG+16                                                 05085000
CMNUMCRT EQU   CMMSG+15                                                 05086000
@NM00042 EQU   CMMSG+14                                                 05087000
CMNEWVOL EQU   CMMSG+8                                                  05088000
@NM00041 EQU   CMMSG+7                                                  05089000
@NM00040 EQU   CMVOLFLG                                                 05090000
CMRONLY  EQU   CMVOLFLG                                                 05091000
CMBIND   EQU   CMVOLFLG                                                 05092000
CMSCRCRT EQU   CMVOLFLG                                                 05093000
CMEXCL   EQU   CMVOLFLG                                                 05094000
CMDERAS  EQU   CMVOLFLG                                                 05095000
CMSCRVOL EQU   CMVOLFLG                                                 05096000
CMCECART EQU   CMVOLFLG                                                 05097000
CMOLDVOL EQU   CMMSG                                                    05098000
CCOLDCSN EQU   CCMSG+24                                                 05099000
CCNEWCSN EQU   CCMSG+12                                                 05100000
@NM00039 EQU   CCMSG+10                                                 05101000
CCVOL    EQU   CCMSG+4                                                  05102000
@NM00038 EQU   CCMSG+2                                                  05103000
CCEJCODE EQU   CCMSG+1                                                  05104000
CCPSTCDE EQU   CCMSG                                                    05105000
WDSLEN   EQU   WDS+20                                                   05106000
WDSMEM   EQU   WDS+12                                                   05107000
WDSMLN   EQU   WDS+11                                                   05108000
WDSFUQ   EQU   WDSFLG                                                   05109000
WDSPOS   EQU   WDS+9                                                    05110000
WDSPAS   EQU   WDS+1                                                    05111000
WDSPLN   EQU   WDS                                                      05112000
WFILELEN EQU   WFILE                                                    05113000
ODSLEN   EQU   ODS+20                                                   05114000
ODSMEM   EQU   ODS+12                                                   05115000
ODSMLN   EQU   ODS+11                                                   05116000
ODSFUQ   EQU   ODSFLG                                                   05117000
ODSPOS   EQU   ODS+9                                                    05118000
ODSPAS   EQU   ODS+1                                                    05119000
ODSPLN   EQU   ODS                                                      05120000
OFILELEN EQU   OFILE                                                    05121000
@NM00037 EQU   DMPARY+15                                                05122000
DMPARYTP EQU   DMPARY+14                                                05123000
DMPARYEX EQU   DMPARY+12                                                05124000
DMPARYIC EQU   DMPARY+10                                                05125000
DMPARYSZ EQU   DMPARY+8                                                 05126000
DMPARYNM EQU   DMPARY                                                   05127000
@NM00036 EQU   DMPITM+15                                                05128000
@NM00035 EQU   ERCNVTAB+24                                              05129000
ERCPLPT  EQU   ERCNVTAB+20                                              05130000
ERCATRC  EQU   ERCNVTAB+16                                              05131000
ERDSNM   EQU   ERCNVTAB+12                                              05132000
@NM00034 EQU   ERCNVTAB+4                                               05133000
@NM00033 EQU   ERCNVTAB+3                                               05134000
@NM00032 EQU   EROSOPER                                                 05135000
EROSUCDX EQU   EROSOPER                                                 05136000
EROSCATL EQU   EROSOPER                                                 05137000
@NM00031 EQU   EROPER                                                   05138000
ERCATAL  EQU   EROPER                                                   05139000
ERCATDL  EQU   EROPER                                                   05140000
ERCATDE  EQU   EROPER                                                   05141000
ERCATLC  EQU   EROPER                                                   05142000
@NM00030 EQU   ERTYPE                                                   05143000
EROSCAT  EQU   ERTYPE                                                   05144000
ERCATLG  EQU   ERTYPE                                                   05145000
@NM00029 EQU   FMTCNVF+1                                                05146000
FMTAR    EQU   FMTCNVF+1                                                05147000
FMTBS    EQU   FMTCNVF+1                                                05148000
FMTSS    EQU   FMTCNVF+1                                                05149000
FMTAL    EQU   FMTCNVF+1                                                05150000
FMTZS    EQU   FMTCNVF+1                                                05151000
@NM00028 EQU   FMTCNVF                                                  05152000
FMTPU    EQU   FMTCNVF                                                  05153000
FMTBD    EQU   FMTCNVF                                                  05154000
FMTBHD   EQU   FMTCNVF                                                  05155000
FMTBHA   EQU   FMTCNVF                                                  05156000
FMTBH    EQU   FMTCNVF                                                  05157000
FMTOLEN  EQU   FMTLIST+8                                                05158000
FMTRIO   EQU   FMTOCOL                                                  05159000
FMTSPT   EQU   FMTSTO                                                   05160000
FMTSTL   EQU   FMTILEN                                                  05161000
@NM00027 EQU   FMTFLGS+1                                                05162000
FMTHDF   EQU   FMTFLGS                                                  05163000
FMTDFF   EQU   FMTFLGS                                                  05164000
FMTSTF   EQU   FMTFLGS                                                  05165000
FMTREPF  EQU   FMTFLGS                                                  05166000
FMTBDF   EQU   FMTFLGS                                                  05167000
FMTIDF   EQU   FMTFLGS                                                  05168000
FMTSCF   EQU   FMTFLGS                                                  05169000
FMTEOLF  EQU   FMTFLGS                                                  05170000
DARGDTM  EQU   DARGARY+4                                                05171000
DARGPCT  EQU   DARGINL                                                  05172000
DARGREP  EQU   DARGINS                                                  05173000
@NM00026 EQU   DARGLIST+19                                              05174000
DARGIND  EQU   DARGLIST+18                                              05175000
DARGCNT  EQU   DARGLIST+14                                              05176000
UVOLVOL  EQU   UVOLENT+4                                                05177000
UVOLDEV  EQU   UVOLENT                                                  05178000
UVOLCNT  EQU   UVOLLIST                                                 05179000
@NM00025 EQU   IOINFOPT                                                 05180000
IOINFTMS EQU   IOINFOPT                                                 05181000
IOINFSUP EQU   IOINFOPT                                                 05182000
IOINFDSN EQU   IOINFOPT                                                 05183000
IOINFDVT EQU   IOINFOPT                                                 05184000
OPNVOL   EQU   OPNAGL+44                                                05185000
@NM00024 EQU   OPNAGL+43                                                05186000
@NM00023 EQU   OPNOPT2                                                  05187000
OPNOPTJM EQU   OPNOPT2                                                  05188000
@NM00022 EQU   OPNOPT2                                                  05189000
OPNOPTAS EQU   OPNOPT2                                                  05190000
@NM00021 EQU   OPNDSO                                                   05191000
OPNDSOPO EQU   OPNDSO                                                   05192000
OPNDSOIS EQU   OPNDSO                                                   05193000
OPNDSOPS EQU   OPNDSO                                                   05194000
OPNDSOAM EQU   OPNDSO                                                   05195000
OPNKYL   EQU   OPNAGL+40                                                05196000
OPNBLK   EQU   OPNAGL+36                                                05197000
OPNDEVIX EQU   OPNDEV+4                                                 05198000
OPNDEVDT EQU   OPNDEV                                                   05199000
OPNCBP   EQU   OPNAGL+20                                                05200000
OPNPWA   EQU   OPNAGL+12                                                05201000
OPNMODRP EQU   OPNMOD                                                   05202000
OPNMODUB EQU   OPNMOD                                                   05203000
OPNMODRS EQU   OPNMOD                                                   05204000
OPNMODAX EQU   OPNMOD                                                   05205000
OPNMODRR EQU   OPNMOD                                                   05206000
OPNMODRC EQU   OPNMOD                                                   05207000
OPNMODAC EQU   OPNMOD                                                   05208000
OPNMODPD EQU   OPNMOD                                                   05209000
@NM00020 EQU   OPNTYP                                                   05210000
OPNTYPRV EQU   OPNTYP                                                   05211000
OPNTYPEX EQU   OPNTYP                                                   05212000
OPNTYPRA EQU   OPNTYP                                                   05213000
OPNTYPXM EQU   OPNTYP                                                   05214000
OPNTYPCI EQU   OPNTYP                                                   05215000
OPNTYPSO EQU   OPNTYP                                                   05216000
OPNTYPSI EQU   OPNTYP                                                   05217000
@NM00019 EQU   OPNRFM                                                   05218000
OPNRFMSF EQU   OPNRFM                                                   05219000
OPNRFMUN EQU   OPNRFM                                                   05220000
OPNRFMVR EQU   OPNRFM                                                   05221000
OPNOPTSK EQU   OPNOPT                                                   05222000
OPNOPTDR EQU   OPNOPT                                                   05223000
OPNOPTKS EQU   OPNOPT                                                   05224000
OPNOPTUP EQU   OPNOPT                                                   05225000
OPNOPTIN EQU   OPNOPT                                                   05226000
IOCEXT   EQU   IOCSTR+64                                                05227000
IOCREL   EQU   IOCSTR+60                                                05228000
IOCWORK  EQU   IOCSTR+56                                                05229000
IOCRRN   EQU   IOCSTR+52                                                05230000
IOCPNM   EQU   IOCNWM+2                                                 05231000
IOCPTL   EQU   IOCNWM                                                   05232000
IOCKYA   EQU   IOCMEM                                                   05233000
IOCVRC   EQU   IOCTTR                                                   05234000
IOCCBP   EQU   IOCSTR+36                                                05235000
IOCDSN   EQU   IOCSTR+32                                                05236000
IOCHURBA EQU   IOCSTR+28                                                05237000
IOCVOLSR EQU   IOCSTR+22                                                05238000
@NM00018 EQU   IOCMSG                                                   05239000
IOCMSGAE EQU   IOCMSG                                                   05240000
IOCMSGCE EQU   IOCMSG                                                   05241000
IOCMSGOE EQU   IOCMSG                                                   05242000
IOCMSGOP EQU   IOCMSG                                                   05243000
@NM00017 EQU   IOCMSG                                                   05244000
IOCCHPSY EQU   IOCCHP                                                   05245000
IOCCHPAS EQU   IOCCHP                                                   05246000
IOCCHPBK EQU   IOCCHP                                                   05247000
IOCCHPCR EQU   IOCCHP                                                   05248000
IOCCHPKS EQU   IOCCHP                                                   05249000
IOCCHPSK EQU   IOCCHP                                                   05250000
IOCCHPDR EQU   IOCCHP                                                   05251000
IOCCHPSQ EQU   IOCCHP                                                   05252000
@NM00016 EQU   IOCMAC2                                                  05253000
IOCMACPA EQU   IOCMAC2                                                  05254000
@NM00015 EQU   IOCMAC2                                                  05255000
IOCMACCP EQU   IOCMAC2                                                  05256000
IOCMACRR EQU   IOCMAC2                                                  05257000
IOCMACAS EQU   IOCMAC2                                                  05258000
IOCMACSK EQU   IOCMAC2                                                  05259000
@NM00014 EQU   IOCMAC                                                   05260000
IOCMACCC EQU   IOCMAC                                                   05261000
IOCMACDR EQU   IOCMAC                                                   05262000
IOCMACBK EQU   IOCMAC                                                   05263000
IOCMACCR EQU   IOCMAC                                                   05264000
IOCMACUP EQU   IOCMAC                                                   05265000
IOCMACOT EQU   IOCMAC                                                   05266000
IOCMACIN EQU   IOCMAC                                                   05267000
@NM00013 EQU   IOCRFM                                                   05268000
IOCRFMBK EQU   IOCRFM                                                   05269000
IOCRFMSF EQU   IOCRFM                                                   05270000
IOCRFMUN EQU   IOCRFM                                                   05271000
IOCRFMVR EQU   IOCRFM                                                   05272000
IOCRFMFX EQU   IOCRFM                                                   05273000
@NM00012 EQU   IOCDSO                                                   05274000
IOCDSOPO EQU   IOCDSO                                                   05275000
IOCDSOIS EQU   IOCDSO                                                   05276000
IOCDSOPS EQU   IOCDSO                                                   05277000
IOCDSOAM EQU   IOCDSO                                                   05278000
IOCRKP   EQU   IOCSTR+13                                                05279000
IOCKYL   EQU   IOCSTR+12                                                05280000
UNITVTOC EQU   UNITABL+7                                                05281000
@NM00011 EQU   UNITSTAT                                                 05282000
UNITUSHR EQU   UNITSTAT                                                 05283000
UNITXSHR EQU   UNITSTAT                                                 05284000
UNITISHR EQU   UNITSTAT                                                 05285000
UNITUA   EQU   @NM00010+1                                               05286000
UNITCHA  EQU   @NM00010                                                 05287000
UNITUCB  EQU   UNITABL                                                  05288000
ALLUNCNT EQU   ALLAGL+30                                                05289000
ALLVLCNT EQU   ALLAGL+29                                                05290000
@NM00009 EQU   ALLOPT                                                   05291000
ALLOPTUN EQU   ALLOPT                                                   05292000
ALLOPTPV EQU   ALLOPT                                                   05293000
ALLOPTVL EQU   ALLOPT                                                   05294000
@NM00008 EQU   ALLORG+1                                                 05295000
ALLORGVS EQU   ALLORG+1                                                 05296000
@NM00007 EQU   ALLORG+1                                                 05297000
ALLORGGS EQU   ALLORG+1                                                 05298000
ALLORGUN EQU   ALLORG                                                   05299000
ALLORGPO EQU   ALLORG                                                   05300000
ALLORGMQ EQU   ALLORG                                                   05301000
ALLORGCQ EQU   ALLORG                                                   05302000
ALLORGCX EQU   ALLORG                                                   05303000
ALLORGDA EQU   ALLORG                                                   05304000
ALLORGPS EQU   ALLORG                                                   05305000
ALLORGIS EQU   ALLORG                                                   05306000
ALLDSPUN EQU   ALLDSP                                                   05307000
ALLDSPCG EQU   ALLDSP                                                   05308000
ALLDSPDE EQU   ALLDSP                                                   05309000
@NM00006 EQU   ALLDSP                                                   05310000
ALLSTSMD EQU   ALLSTS                                                   05311000
ALLSTSNW EQU   ALLSTS                                                   05312000
ALLSTSSR EQU   ALLSTS                                                   05313000
@NM00005 EQU   ALLSTS                                                   05314000
ALLPWD   EQU   ALLAGL+20                                                05315000
ALLVLP   EQU   ALLAGL+16                                                05316000
CIRPID   EQU   CIRAGL+28                                                05317000
CIRPWD   EQU   CIRAGL+24                                                05318000
CIRCAT   EQU   CIRAGL+20                                                05319000
CIRWKP   EQU   CIRAGL+16                                                05320000
CIRTLR   EQU   CIRAGL+12                                                05321000
CIRHDR   EQU   CIRAGL+8                                                 05322000
CIRTLN   EQU   CIRAGL+6                                                 05323000
CIRHLN   EQU   CIRAGL+4                                                 05324000
@NM00004 EQU   CIRAGL+1                                                 05325000
@NM00003 EQU   CIRTYPE                                                  05326000
CIRTYPAQ EQU   CIRTYPE                                                  05327000
CIRTYP1Q EQU   CIRTYPE                                                  05328000
NEWID1   EQU   TRACE1+95                                                05329000
CALLID   EQU   OLDERID1+90                                              05330000
@NM00002 EQU   OLDERID1                                                 05331000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05332000
@RC00780 EQU   @RC00775                                                 05333000
@RC00778 EQU   @RC00775                                                 05334000
@RC00845 EQU   @RC00837                                                 05335000
@RF00979 EQU   @RC00964                                                 05336000
@PB00007 EQU   @EL00001                                                 05337000
@RC00783 EQU   @RC00780                                                 05338000
@PB00006 EQU   @PB00007                                                 05339000
@PB00005 EQU   @PB00006                                                 05340000
@PB00004 EQU   @PB00005                                                 05341000
@PB00003 EQU   @PB00004                                                 05342000
@PB00002 EQU   @PB00003                                                 05343000
@ENDDATA EQU   *                                                        05344000
         END   IDCTR01,(C'PLS2247',0603,77132)                          05345000
