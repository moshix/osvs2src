VS01     TITLE '********  IDCVS01:  VOLUME SERVICES - VTOC FUNCTIONS  **00001000
               ******** '                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCVS01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCVS01   76.320'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @06,0                                               0002 00021000
@PSTART  LA    @10,4095(,@06)                                      0002 00022000
         LA    @12,4095(,@10)                                      0002 00023000
         USING @PSTART,@06                                         0002 00024000
         USING @PSTART+4095,@10                                    0002 00025000
         USING @PSTART+8190,@12                                    0002 00026000
         L     @00,@SIZDATD                                        0002 00027000
         GETMAIN  R,LV=(0)                                              00028000
         LR    @11,@01                                             0002 00029000
         LA    @09,4095(,@11)                                      0002 00030000
         LA    @08,4095(,@09)                                      0002 00031000
         LA    @07,4095(,@08)                                      0002 00032000
         USING @DATD,@11                                           0002 00033000
         USING @DATD+4095,@09                                      0002 00034000
         USING @DATD+8190,@08                                      0002 00035000
         USING @DATD+12285,@07                                     0002 00036000
         ST    @13,@SA00001+4                                      0002 00037000
         LM    @00,@01,20(@13)                                     0002 00038000
         ST    @11,8(,@13)                                         0002 00039000
         LR    @13,@11                                             0002 00040000
         MVC   @PC00001(12),0(@01)                                 0002 00041000
*   OLDERID2=NEWERID2;                                             0304 00042000
         L     @04,@PC00001                                        0304 00043000
         L     @15,GDTTR2(,@04)                                    0304 00044000
         MVC   @TS00001(95),NEWERID2(@15)                          0304 00045000
         MVC   OLDERID2(95,@15),@TS00001                           0304 00046000
*   NEWID2='VS01';                  /*                       @Y30LB37*/ 00047000
         MVC   NEWID2(4,@15),@CC01329                              0305 00048000
*   IF GDTDBG=NULLPTR THEN                                         0306 00049000
         L     @04,GDTDBG(,@04)                                    0306 00050000
         LTR   @04,@04                                             0306 00051000
         BZ    @RT00306                                            0306 00052000
*     ;                                                            0307 00053000
*   ELSE                                                           0308 00054000
*     CALL IDCDB010(GDTTBL,'VSBG'); /*                       @Y30LB37*/ 00055000
*                                                                  0308 00056000
         L     @04,@PC00001                                        0308 00057000
         ST    @04,@AL00001                                        0308 00058000
         LA    @15,@CC01471                                        0308 00059000
         ST    @15,@AL00001+4                                      0308 00060000
         MVI   @AL00001+4,X'80'                                    0308 00061000
         L     @15,GDTDBG(,@04)                                    0308 00062000
         LA    @01,@AL00001                                        0308 00063000
         BALR  @14,@15                                             0308 00064000
*   /*****************************************************************/ 00065000
*   /*                                                               */ 00066000
*   /* INITIALIZE UPRINT AND USYSINFO AREAS TO ZERO.         @Y30LB37*/ 00067000
*   /* INITIALIZE RETURN CODE AND SWITCHES TO ZERO.          @Y30LB37*/ 00068000
*   /*                                                               */ 00069000
*   /*****************************************************************/ 00070000
*                                                                  0309 00071000
*   RETCODE=0;                      /* INITIALIZE RETURN CODE      0309 00072000
*                                                            @Y30LB37*/ 00073000
@RT00306 SLR   @15,@15                                             0309 00074000
         STH   @15,RETCODE                                         0309 00075000
*   V1PGSWS=''B;                    /* CLEAR SWITCH AREA     @Y30LB37*/ 00076000
         XC    V1PGSWS(2),V1PGSWS                                  0310 00077000
*   DDSTRU=ADDR(PRINTARG);          /* INIT ARGUMENT LIST PTR      0311 00078000
*                                                            @Y30LB37*/ 00079000
         LA    @15,PRINTARG                                        0311 00080000
         ST    @15,DDSTRU                                          0311 00081000
*   PRINTARG=''B;                   /* CLEAR PRINTARG BLOCK  @Y30LB37*/ 00082000
         XC    PRINTARG(44),PRINTARG                               0312 00083000
*   INFOPTR=ADDR(INFOAREA);         /* INIT UNITABL PTR      @Y30LB37*/ 00084000
         LA    @15,INFOAREA                                        0313 00085000
         ST    @15,INFOPTR                                         0313 00086000
*   UNITABL=''B;                    /* CLEAR UNITABL OUTPUT  @Y30LB37*/ 00087000
         XC    UNITABL(11,@15),UNITABL(@15)                        0314 00088000
*   ALLAGL=''B;                     /* CLEAR ALLAGL AREA     @Y30LB37*/ 00089000
         LA    @15,ALLLIST                                         0315 00090000
         XC    ALLAGL(31,@15),ALLAGL(@15)                          0315 00091000
*   VRACFPTR=ADDR(VS1RACF);         /*                       @G24LB31*/ 00092000
*                                                                  0316 00093000
         LA    @15,VS1RACF                                         0316 00094000
         ST    @15,VRACFPTR                                        0316 00095000
*   /*****************************************************************/ 00096000
*   /*                                                               */ 00097000
*   /* INITIALIZE ARGLIST PTR AND MOVE IN REQUEST.           @Y30LB37*/ 00098000
*   /*                                                               */ 00099000
*   /*****************************************************************/ 00100000
*                                                                  0317 00101000
*   ARGLPTR=ADDR(VS1ARGL);          /* INIT ARGLIST PTR      @Y30LB37*/ 00102000
         L     ARGLPTR,@PC00001+8                                  0317 00103000
*   VSHEAD=REQUEST;                 /* MOVE IN REQUEST       @Y30LB37*/ 00104000
         L     @15,@PC00001+4                                      0318 00105000
         MVC   VSHEAD(8,ARGLPTR),REQUEST(@15)                      0318 00106000
*                                                                  0319 00107000
*   /*****************************************************************/ 00108000
*   /*                                                               */ 00109000
*   /* DETERMINE REQUEST PASSED BY THE CALLER AND CALL THE   @Y30LB37*/ 00110000
*   /* APPROPRIATE ROUTINE TO PROCESS THE REQUEST OR UABORT  @Y30LB37*/ 00111000
*   /* IF AN INVALID REQUEST.                                @Y30LB37*/ 00112000
*   /*                                                               */ 00113000
*   /*****************************************************************/ 00114000
*                                                                  0319 00115000
*   IF REQUEST=SECCHECK THEN                                       0319 00116000
         CLC   REQUEST(8,@15),SECCHECK                             0319 00117000
         BNE   @RF00319                                            0319 00118000
*     CALL SECHECK;                 /*                       @Y30LB37*/ 00119000
         BAL   @14,SECHECK                                         0320 00120000
*   ELSE                                                           0321 00121000
*     IF REQUEST=GETVTOC THEN                                      0321 00122000
         B     @RC00319                                            0321 00123000
@RF00319 L     @15,@PC00001+4                                      0321 00124000
         CLC   REQUEST(8,@15),GETVTOC                              0321 00125000
         BNE   @RF00321                                            0321 00126000
*       CALL VTOCGET;               /*                       @Y30LB37*/ 00127000
         BAL   @14,VTOCGET                                         0322 00128000
*     ELSE                                                         0323 00129000
*       IF REQUEST=PUTVTOC THEN                                    0323 00130000
         B     @RC00321                                            0323 00131000
@RF00321 L     @15,@PC00001+4                                      0323 00132000
         CLC   REQUEST(8,@15),PUTVTOC                              0323 00133000
         BNE   @RF00323                                            0323 00134000
*         CALL VTOCPUT;             /*                       @Y30LB37*/ 00135000
         BAL   @14,VTOCPUT                                         0324 00136000
*       ELSE                                                       0325 00137000
*         IF REQUEST=SCRVTOC THEN                                  0325 00138000
         B     @RC00323                                            0325 00139000
@RF00323 L     @15,@PC00001+4                                      0325 00140000
         CLC   REQUEST(8,@15),SCRVTOC                              0325 00141000
         BNE   @RF00325                                            0325 00142000
*           CALL SCRATCH;           /*                       @Y30LB37*/ 00143000
         BAL   @14,SCRATCH                                         0326 00144000
*         ELSE                                                     0327 00145000
*           IF REQUEST=RECATLG THEN                                0327 00146000
         B     @RC00325                                            0327 00147000
@RF00325 L     @15,@PC00001+4                                      0327 00148000
         CLC   REQUEST(8,@15),RECATLG                              0327 00149000
         BNE   @RF00327                                            0327 00150000
*             CALL RECATLOG;        /*                       @Y30LB37*/ 00151000
         BAL   @14,RECATLOG                                        0328 00152000
*           ELSE                                                   0329 00153000
*             DO;                                                  0329 00154000
         B     @RC00327                                            0329 00155000
@RF00327 DS    0H                                                  0330 00156000
*               RESPECIFY                                          0330 00157000
*                (REG13,                                           0330 00158000
*                 REG14,                                           0330 00159000
*                 REG15) RSTD;                                     0330 00160000
*               REG15=40;                                          0331 00161000
         LA    REG15,40                                            0331 00162000
*               REG14=GDTABT;                                      0332 00163000
         L     @05,@PC00001                                        0332 00164000
         L     REG14,GDTABT(,@05)                                  0332 00165000
*               REG13=GDTABH;                                      0333 00166000
         L     REG13,GDTABH(,@05)                                  0333 00167000
*               GEN(BR    REG14);                                  0334 00168000
         BR    REG14                                                    00169000
*               RESPECIFY                                          0335 00170000
*                (REG13,                                           0335 00171000
*                 REG14,                                           0335 00172000
*                 REG15) UNRSTD;                                   0335 00173000
*             END;                  /* ISSUE UABORT FOR BAD  @Y30LB37   00174000
*                                      ARGUMENT LIST         @Y30LB37*/ 00175000
*                                                                  0336 00176000
*   /*****************************************************************/ 00177000
*   /*                                                               */ 00178000
*   /* SAVE THE RETURN CODE RETURNED FROM THE SUBROUTINE.    @Y30LB37*/ 00179000
*   /*                                                               */ 00180000
*   /*****************************************************************/ 00181000
*                                                                  0337 00182000
*   RESPECIFY                                                      0337 00183000
*     RTNREG RSTD;                                                 0337 00184000
@RC00327 DS    0H                                                  0337 00185000
@RC00325 DS    0H                                                  0337 00186000
@RC00323 DS    0H                                                  0337 00187000
@RC00321 DS    0H                                                  0337 00188000
@RC00319 DS    0H                                                  0338 00189000
*   TESTRC=RTNREG;                                                 0338 00190000
         STH   RTNREG,TESTRC                                       0338 00191000
*   RESPECIFY                                                      0339 00192000
*     RTNREG UNRSTD;                /*                       @Y30LB37*/ 00193000
*   IF TESTRC^=0 THEN                                              0340 00194000
         LH    @15,TESTRC                                          0340 00195000
         LTR   @15,@15                                             0340 00196000
         BZ    @RF00340                                            0340 00197000
*     RETCODE=TESTRC;               /*                       @Y30LB37*/ 00198000
         STH   @15,RETCODE                                         0341 00199000
*                                                                  0342 00200000
*   /*****************************************************************/ 00201000
*   /*                                                               */ 00202000
*   /* RETURN TO THE CALLER OF THIS VOLUME SERVICES ROUTINE  @Y30LB37*/ 00203000
*   /*                                                               */ 00204000
*   /*****************************************************************/ 00205000
*                                                                  0342 00206000
*   IF GDTDBG=NULLPTR THEN                                         0342 00207000
@RF00340 L     @15,@PC00001                                        0342 00208000
         L     @15,GDTDBG(,@15)                                    0342 00209000
         LTR   @15,@15                                             0342 00210000
         BZ    @RT00342                                            0342 00211000
*     ;                                                            0343 00212000
*   ELSE                                                           0344 00213000
*     CALL IDCDB010(GDTTBL,'VSND'); /* UDUMP EXIT            @Y30LB37*/ 00214000
         L     @15,@PC00001                                        0344 00215000
         ST    @15,@AL00001                                        0344 00216000
         LA    @14,@CC01479                                        0344 00217000
         ST    @14,@AL00001+4                                      0344 00218000
         MVI   @AL00001+4,X'80'                                    0344 00219000
         L     @15,GDTDBG(,@15)                                    0344 00220000
         LA    @01,@AL00001                                        0344 00221000
         BALR  @14,@15                                             0344 00222000
*   CALL IDCSAEP0(GDTTBL,MODID,RETCODE);/* RETURN            @Y30LB37*/ 00223000
@RT00342 L     @15,@PC00001                                        0345 00224000
         ST    @15,@AL00001                                        0345 00225000
         LA    @14,MODID                                           0345 00226000
         ST    @14,@AL00001+4                                      0345 00227000
         LA    @14,RETCODE                                         0345 00228000
         ST    @14,@AL00001+8                                      0345 00229000
         MVI   @AL00001+8,X'80'                                    0345 00230000
         L     @15,GDTEPL(,@15)                                    0345 00231000
         LA    @01,@AL00001                                        0345 00232000
         BALR  @14,@15                                             0345 00233000
*                                                                  0346 00234000
*/********************************************************************/ 00235000
*/*                                                                  */ 00236000
*/*  PROCEDURE NAME - VTOCGET                                @Y30LB37*/ 00237000
*/*                                                          @Y30LB37*/ 00238000
*/*  FUNCTION - THIS PROCEDURE RETRIEVES VTOC INFORMATION    @Y30LB37*/ 00239000
*/*             FROM THE FORMAT 4 DSCB.  VTOCGET CALLS       @Y30LB37*/ 00240000
*/*             SUBORDINATE ROUTINES VTOCOPEN, AND FMT4READ  @Y30LB37*/ 00241000
*/*             TO OPEN THE VTOC AND READ THE FORMAT 4       @Y30LB37*/ 00242000
*/*             DSCB.                                        @Y30LB37*/ 00243000
*/*                                                          @Y30LB37*/ 00244000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 00245000
*/*          LIST:  FIELDS VSIOP, VSALTTRK, AND VSVSFLAG.    @Y30LB37*/ 00246000
*/*                                                          @Y30LB37*/ 00247000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       @Y30LB37*/ 00248000
*/*          OR FOUR ERROR CODE.  IF THE RETURN CODE IS      @Y30LB37*/ 00249000
*/*          ZERO, INFORMATION IS RETURNED ABOUT THE         @Y30LB37*/ 00250000
*/*          VTOC ACCORDING TO THE INPUT REQUEST FLAGS.      @Y30LB37*/ 00251000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 00252000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 00253000
*/*          4 - VTOC OPEN WAS UNSUCCESSFUL                  @Y30LB37*/ 00254000
*/*              VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 00255000
*/*              FIRST RECORD WAS NOT A FORMAT 4             @Y30LB37*/ 00256000
*/*              ERROR RETRIEVING UCB ADDRESS                @Y30LB37*/ 00257000
*/*              ERROR RESERVING VOLUME                      @Y30LB37*/ 00258000
*/*                                                                  */ 00259000
*/********************************************************************/ 00260000
*                                                                  0346 00261000
*VTOCGET:                                                          0346 00262000
*   PROCEDURE;                      /*                       @Y30LB37*/ 00263000
*                                                                  0346 00264000
@EL00001 L     @13,4(,@13)                                         0346 00265000
@EF00001 L     @00,@SIZDATD                                        0346 00266000
         LR    @01,@11                                             0346 00267000
         FREEMAIN R,LV=(0),A=(1)                                        00268000
@ER00001 LM    @14,@12,12(@13)                                     0346 00269000
         BR    @14                                                 0346 00270000
VTOCGET  STM   @14,@12,@SA00002                                    0346 00271000
*   /*****************************************************************/ 00272000
*   /*                                                               */ 00273000
*   /* LOCAL DECLARATIONS FOR VTOCGET                        @Y30LB37*/ 00274000
*   /*                                                               */ 00275000
*   /*****************************************************************/ 00276000
*                                                                  0347 00277000
*   DCL                                                            0347 00278000
*     VTOCGRC FIXED(15);            /* VTOCGET RETURN CODE   @Y30LB37*/ 00279000
*                                                                  0348 00280000
*   /*****************************************************************/ 00281000
*   /*                                                               */ 00282000
*   /* CALL THE VTOCOPEN PROCEDURE TO OPEN THE VTOC          @Y30LB37*/ 00283000
*   /* IF IT IS NOT ALREADY OPEN (VSIOP IS ZERO).            @Y30LB37*/ 00284000
*   /* VTOCOPEN SETS THE VSIOP FIELD. IF VTOCOPEN IS         @Y30LB37*/ 00285000
*   /* UNSUCCESSFUL THEN SET VTOCGRC TO FOUR.                @Y30LB37*/ 00286000
*   /*                                                               */ 00287000
*   /*****************************************************************/ 00288000
*                                                                  0348 00289000
*   OLDERID2=NEWERID2;                                             0348 00290000
         L     @05,@PC00001                                        0348 00291000
         L     @05,GDTTR2(,@05)                                    0348 00292000
         MVC   @TS00001(95),NEWERID2(@05)                          0348 00293000
         MVC   OLDERID2(95,@05),@TS00001                           0348 00294000
*   NEWID2='VSVG';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 00295000
         MVC   NEWID2(4,@05),@CC01484                              0349 00296000
*   VTOCGRC=0;                      /*                       @Y30LB37*/ 00297000
         SLR   @05,@05                                             0350 00298000
         LR    VTOCGRC,@05                                         0350 00299000
*   IF VSIOP=NULLPTR THEN                                          0351 00300000
         C     @05,VSIOP(,ARGLPTR)                                 0351 00301000
         BNE   @RF00351                                            0351 00302000
*     DO;                           /*                       @Y30LB37*/ 00303000
*       CALL VTOCOPEN;              /*                       @Y30LB37*/ 00304000
         BAL   @14,VTOCOPEN                                        0353 00305000
*       RESPECIFY                                                  0354 00306000
*         RTNREG RSTD;                                             0354 00307000
*       TESTRC=RTNREG;                                             0355 00308000
         STH   RTNREG,TESTRC                                       0355 00309000
*       RESPECIFY                                                  0356 00310000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 00311000
*       IF TESTRC^=0 THEN                                          0357 00312000
         LH    @05,TESTRC                                          0357 00313000
         LTR   @05,@05                                             0357 00314000
         BZ    @RF00357                                            0357 00315000
*         VTOCGRC=4;                /*                       @Y30LB37*/ 00316000
         LA    VTOCGRC,4                                           0358 00317000
*     END;                          /*                       @Y30LB37*/ 00318000
*                                                                  0359 00319000
*   /*****************************************************************/ 00320000
*   /*                                                               */ 00321000
*   /* IF THE VTOC IS ALREADY OPEN PICK UP THE IOCSPTR FROM  @Y30LB37*/ 00322000
*   /* THE VS1AGL.                                           @Y30LB37*/ 00323000
*   /*                                                               */ 00324000
*   /*****************************************************************/ 00325000
*                                                                  0360 00326000
*   ELSE                                                           0360 00327000
*     IOCSPTR=VSIOP;                /*                       @Y30LB37*/ 00328000
         B     @RC00351                                            0360 00329000
@RF00351 L     @05,VSIOP(,ARGLPTR)                                 0360 00330000
         ST    @05,IOCSPTR                                         0360 00331000
*                                                                  0361 00332000
*   /*****************************************************************/ 00333000
*   /*                                                               */ 00334000
*   /* IF VTOCOPEN SUCCESSFUL CALL FMT4READ TO READ THE      @Y30LB37*/ 00335000
*   /* FORMAT 4 DSCB. IF VSALTTRK IS ON THEN RETRIEVE        @Y30LB37*/ 00336000
*   /* THE ALTERNATE TRACK INFORMATION FROM THE FORMAT 4     @Y30LB37*/ 00337000
*   /* DSCB. IF VSVSFLAG IS ON THEN SET THE VSVSAM FLAG      @Y30LB37*/ 00338000
*   /* ACCORDING TO THE SETTING OF THE DS4VSREF FLAG. IF     @Y30LB37*/ 00339000
*   /* THE FMT4READ PROCEDURE WAS NOT SUCCESSFUL, THEN       @Y30LB37*/ 00340000
*   /* SET THE RETURN CODE TO RCFAIL.                        @Y30LB37*/ 00341000
*   /*                                                               */ 00342000
*   /*****************************************************************/ 00343000
*                                                                  0361 00344000
*   IF VTOCGRC=0 THEN                                              0361 00345000
@RC00351 LTR   VTOCGRC,VTOCGRC                                     0361 00346000
         BNZ   @RF00361                                            0361 00347000
*     DO;                           /*                       @Y30LB37*/ 00348000
*       CALL FMT4READ;              /*                       @Y30LB37*/ 00349000
         BAL   @14,FMT4READ                                        0363 00350000
*       RESPECIFY                                                  0364 00351000
*         RTNREG RSTD;                                             0364 00352000
*       TESTRC=RTNREG;                                             0365 00353000
         STH   RTNREG,TESTRC                                       0365 00354000
*       RESPECIFY                                                  0366 00355000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 00356000
*       IF TESTRC=0 THEN                                           0367 00357000
         LH    @05,TESTRC                                          0367 00358000
         LTR   @05,@05                                             0367 00359000
         BNZ   @RF00367                                            0367 00360000
*         DO;                       /*                       @Y30LB37*/ 00361000
*           IF VSALTTRK=ON THEN                                    0369 00362000
         TM    VSALTTRK(ARGLPTR),B'01000000'                       0369 00363000
         BNO   @RF00369                                            0369 00364000
*             DO;                   /*                       @Y30LB37*/ 00365000
*               V1NXAREA=DS4HCCHH;  /*                       @Y30LB37*/ 00366000
         L     @05,VSNXTATP(,ARGLPTR)                              0371 00367000
         LA    @03,44                                              0371 00368000
         AL    @03,F4PTR                                           0371 00369000
         MVC   V1NXAREA(4,@05),DS4HCCHH(@03)                       0371 00370000
*               V1NUAREA=DS4NOATK;  /*                       @Y30LB37*/ 00371000
         L     @05,VSNUMATP(,ARGLPTR)                              0372 00372000
         MVC   V1NUAREA(2,@05),DS4NOATK(@03)                       0372 00373000
*             END;                  /*                       @Y30LB37*/ 00374000
*           IF VSVSFLAG=ON THEN                                    0374 00375000
@RF00369 TM    VSVSFLAG(ARGLPTR),B'00100000'                       0374 00376000
         BNO   @RF00374                                            0374 00377000
*             IF DS4VSREF=ON THEN                                  0375 00378000
         L     @05,F4PTR                                           0375 00379000
         TM    DS4VSREF+44(@05),B'10000000'                        0375 00380000
         BNO   @RF00375                                            0375 00381000
*               VSVSAM=ON;          /*                       @Y30LB37*/ 00382000
         OI    VSVSAM(ARGLPTR),B'10000000'                         0376 00383000
*             ELSE                                                 0377 00384000
*               VSVSAM=OFF;         /*                       @Y30LB37*/ 00385000
         B     @RC00375                                            0377 00386000
@RF00375 NI    VSVSAM(ARGLPTR),B'01111111'                         0377 00387000
*         END;                      /*                       @Y30LB37*/ 00388000
*       ELSE                                                       0379 00389000
*         VTOCGRC=4;                /*                       @Y30LB37*/ 00390000
         B     @RC00367                                            0379 00391000
@RF00367 LA    VTOCGRC,4                                           0379 00392000
*     END;                          /*                       @Y30LB37*/ 00393000
@RC00367 DS    0H                                                  0381 00394000
*   RETURN CODE(VTOCGRC);           /* RETURN TO MAIN ROUTINE      0381 00395000
*                                                            @Y30LB37*/ 00396000
@RF00361 LR    @15,VTOCGRC                                         0381 00397000
         L     @14,@SA00002                                        0381 00398000
         LM    @00,@12,@SA00002+8                                  0381 00399000
         BR    @14                                                 0381 00400000
*   END VTOCGET;                    /* END OF VTOCGET PROC   @Y30LB37*/ 00401000
*                                                                  0383 00402000
*/********************************************************************/ 00403000
*/*                                                                  */ 00404000
*/*  PROCEDURE NAME - VTOCPUT                                @Y30LB37*/ 00405000
*/*                                                          @Y30LB37*/ 00406000
*/*  FUNCTION - THIS PROCEDURE UPDATES VTOC INFORMATION      @Y30LB37*/ 00407000
*/*             IN THE FORMAT 4 DSCB.  VTOCPUT CALLS         @Y30LB37*/ 00408000
*/*             SUBORDINATE ROUTINES VTOCOPEN, AND FMT4READ  @Y30LB37*/ 00409000
*/*             TO OPEN THE VTOC AND READ THE FORMAT 4       @Y30LB37*/ 00410000
*/*             DSCB.  VTOCPUT CALLS UPRINT TO PRINT ERROR   @Y30LB37*/ 00411000
*/*             MESSAGES IDC1968I, IDC1969I OR IDC0970I IF   @Y30LB37*/ 00412000
*/*             AN ERROR OCCURRED UPDATING THE VTOC.         @Y30LB37*/ 00413000
*/*                                                          @Y30LB37*/ 00414000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 00415000
*/*          LIST:  FIELDS VSIOP, VSALTTRK, VSNXTATP,        @Y30LB37*/ 00416000
*/*          VSTIME, VSNUMATP, VSMSG, AND VSVOLP.            @Y30LB37*/ 00417000
*/*                                                          @Y30LB37*/ 00418000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       @Y30LB37*/ 00419000
*/*          OR FOUR ERROR CODE.                             @Y30LB37*/ 00420000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 00421000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 00422000
*/*          4 - VTOC OPEN WAS UNSUCCESSFUL                  @Y30LB37*/ 00423000
*/*              VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 00424000
*/*              FIRST RECORD WAS NOT A FORMAT 4             @Y30LB37*/ 00425000
*/*              ERROR UPDATING THE VTOC                     @Y30LB37*/ 00426000
*/*              ERROR RETRIEVING UCB ADDRESS                @Y30LB37*/ 00427000
*/*              ERROR RESERVING VOLUME                      @Y30LB37*/ 00428000
*/*                                                                  */ 00429000
*/********************************************************************/ 00430000
*                                                                  0383 00431000
*VTOCPUT:                                                          0383 00432000
*   PROCEDURE;                      /*                       @Y30LB37*/ 00433000
*                                                                  0383 00434000
VTOCPUT  STM   @14,@12,@SA00003                                    0383 00435000
*   /*****************************************************************/ 00436000
*   /*                                                               */ 00437000
*   /* LOCAL DECLARATIONS FOR VTOCPUT                        @Y30LB37*/ 00438000
*   /*                                                               */ 00439000
*   /*****************************************************************/ 00440000
*                                                                  0384 00441000
*   DCL                                                            0384 00442000
*     VTOCPRC FIXED(15);            /* VTOCPUT RETURN CODE   @Y30LB37*/ 00443000
*   DCL                                                            0385 00444000
*     VPTIME CHAR(8);               /* UTIME RETURN TIME AREA      0385 00445000
*                                                            @Y30LB37*/ 00446000
*   DCL                                                            0386 00447000
*     VPDATE CHAR(4);               /* UTIME RETURN DATE AREA      0386 00448000
*                                                            @Y30LB37*/ 00449000
*                                                                  0387 00450000
*   /*****************************************************************/ 00451000
*   /*                                                               */ 00452000
*   /* CALL THE VTOCOPEN PROCEDURE TO OPEN THE VTOC          @Y30LB37*/ 00453000
*   /* IF IT IS NOT ALREADY OPEN (VSIOP IS ZERO).            @Y30LB37*/ 00454000
*   /* VTOCOPEN SETS THE VSIOP FIELD. IF VTOCOPEN IS         @Y30LB37*/ 00455000
*   /* UNSUCCESSFUL THEN SET VTOCPRC TO FOUR.                @Y30LB37*/ 00456000
*   /*                                                               */ 00457000
*   /*****************************************************************/ 00458000
*                                                                  0387 00459000
*   OLDERID2=NEWERID2;                                             0387 00460000
         L     @05,@PC00001                                        0387 00461000
         L     @05,GDTTR2(,@05)                                    0387 00462000
         MVC   @TS00001(95),NEWERID2(@05)                          0387 00463000
         MVC   OLDERID2(95,@05),@TS00001                           0387 00464000
*   NEWID2='VSVP';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 00465000
         MVC   NEWID2(4,@05),@CC01493                              0388 00466000
*   VTOCPRC=0;                      /*                       @Y30LB37*/ 00467000
         SLR   @05,@05                                             0389 00468000
         LR    VTOCPRC,@05                                         0389 00469000
*   IF VSIOP=NULLPTR THEN                                          0390 00470000
         C     @05,VSIOP(,ARGLPTR)                                 0390 00471000
         BNE   @RF00390                                            0390 00472000
*     DO;                           /*                       @Y30LB37*/ 00473000
*       CALL VTOCOPEN;              /*                       @Y30LB37*/ 00474000
         BAL   @14,VTOCOPEN                                        0392 00475000
*       RESPECIFY                                                  0393 00476000
*         RTNREG RSTD;                                             0393 00477000
*       TESTRC=RTNREG;                                             0394 00478000
         STH   RTNREG,TESTRC                                       0394 00479000
*       RESPECIFY                                                  0395 00480000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 00481000
*       IF TESTRC^=0 THEN                                          0396 00482000
         LH    @05,TESTRC                                          0396 00483000
         LTR   @05,@05                                             0396 00484000
         BZ    @RF00396                                            0396 00485000
*         VTOCPRC=4;                /*                       @Y30LB37*/ 00486000
         LA    VTOCPRC,4                                           0397 00487000
*     END;                          /*                       @Y30LB37*/ 00488000
*                                                                  0398 00489000
*   /*****************************************************************/ 00490000
*   /*                                                               */ 00491000
*   /* IF THE VTOC IS ALREADY OPEN PICK UP THE IOCSPTR FROM  @Y30LB37*/ 00492000
*   /* THE VS1AGL.                                           @Y30LB37*/ 00493000
*   /*                                                               */ 00494000
*   /*****************************************************************/ 00495000
*                                                                  0399 00496000
*   ELSE                                                           0399 00497000
*     IOCSPTR=VSIOP;                /*                       @Y30LB37*/ 00498000
         B     @RC00390                                            0399 00499000
@RF00390 L     @05,VSIOP(,ARGLPTR)                                 0399 00500000
         ST    @05,IOCSPTR                                         0399 00501000
*                                                                  0400 00502000
*   /*****************************************************************/ 00503000
*   /*                                                               */ 00504000
*   /* IF VTOCOPEN SUCCESSFUL CALL FMT4READ TO READ THE      @Y30LB37*/ 00505000
*   /* FORMAT 4 DSCB. IF VSALTTRK IS ON THEN UPDATE          @Y30LB37*/ 00506000
*   /* THE ALTERNATE TRACK INFORMATION INTO THE FORMAT 4     @Y30LB37*/ 00507000
*   /* DSCB. IF VSTIME IS ON THEN ISSUE THE UTIME MACRO      @Y30LB37*/ 00508000
*   /* TO RETRIEVE THE TIME OF DAY IN BINARY AND SET THE     @Y30LB37*/ 00509000
*   /* FORMAT 4 DSCB ACCORDING TO THE RETURNED TIME FROM     @Y30LB37*/ 00510000
*   /* THE UTIME MACRO. IF THE FMT4READ PROCEDURE FOUND      @Y30LB37*/ 00511000
*   /* AN ERROR, SET THE RETURN CODE TO RCFAIL.              @Y30LB37*/ 00512000
*   /*                                                               */ 00513000
*   /*****************************************************************/ 00514000
*                                                                  0400 00515000
*   IF VTOCPRC=0 THEN                                              0400 00516000
@RC00390 LTR   VTOCPRC,VTOCPRC                                     0400 00517000
         BNZ   @RF00400                                            0400 00518000
*     DO;                           /*                       @Y30LB37*/ 00519000
*       CALL FMT4READ;              /*                       @Y30LB37*/ 00520000
         BAL   @14,FMT4READ                                        0402 00521000
*       RESPECIFY                                                  0403 00522000
*         RTNREG RSTD;                                             0403 00523000
*       TESTRC=RTNREG;                                             0404 00524000
         STH   RTNREG,TESTRC                                       0404 00525000
*       RESPECIFY                                                  0405 00526000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 00527000
*       IF TESTRC=0 THEN                                           0406 00528000
         LH    @05,TESTRC                                          0406 00529000
         LTR   @05,@05                                             0406 00530000
         BNZ   @RF00406                                            0406 00531000
*         DO;                       /*                       @Y30LB37*/ 00532000
*           IF VSALTTRK=ON THEN                                    0408 00533000
         TM    VSALTTRK(ARGLPTR),B'01000000'                       0408 00534000
         BNO   @RF00408                                            0408 00535000
*             DO;                   /*                       @Y30LB37*/ 00536000
*               DS4HCCHH=V1NXAREA;  /*                       @Y30LB37*/ 00537000
         LA    @05,44                                              0410 00538000
         AL    @05,F4PTR                                           0410 00539000
         L     @03,VSNXTATP(,ARGLPTR)                              0410 00540000
         MVC   DS4HCCHH(4,@05),V1NXAREA(@03)                       0410 00541000
*               DS4NOATK=V1NUAREA;  /*                       @Y30LB37*/ 00542000
         L     @03,VSNUMATP(,ARGLPTR)                              0411 00543000
         MVC   DS4NOATK(2,@05),V1NUAREA(@03)                       0411 00544000
*             END;                  /*                       @Y30LB37*/ 00545000
*           IF VSTIME=ON THEN                                      0413 00546000
@RF00408 TM    VSTIME(ARGLPTR),B'10000000'                         0413 00547000
         BNO   @RF00413                                            0413 00548000
*             DO;                   /*                       @Y30LB37*/ 00549000
*               CALL IDCSATI0(GDTTBL,VPTIME,VPDATE,CLOCK);/* @Y30LB37*/ 00550000
         L     @05,@PC00001                                        0415 00551000
         ST    @05,@AL00001                                        0415 00552000
         LA    @03,VPTIME                                          0415 00553000
         ST    @03,@AL00001+4                                      0415 00554000
         LA    @03,VPDATE                                          0415 00555000
         ST    @03,@AL00001+8                                      0415 00556000
         LA    @03,CLOCK                                           0415 00557000
         ST    @03,@AL00001+12                                     0415 00558000
         MVI   @AL00001+12,X'80'                                   0415 00559000
         L     @15,GDTTIM(,@05)                                    0415 00560000
         LA    @01,@AL00001                                        0415 00561000
         BALR  @14,@15                                             0415 00562000
*               DS4AMTIM=VPTIME;    /*                       @Y30LB37*/ 00563000
         L     @05,F4PTR                                           0416 00564000
         MVC   DS4AMTIM+44(8,@05),VPTIME                           0416 00565000
*             END;                  /*                       @Y30LB37*/ 00566000
*         END;                      /*                       @Y30LB37*/ 00567000
*       ELSE                                                       0419 00568000
*         VTOCPRC=4;                /*                       @Y30LB37*/ 00569000
         B     @RC00406                                            0419 00570000
@RF00406 LA    VTOCPRC,4                                           0419 00571000
*     END;                          /*                       @Y30LB37*/ 00572000
@RC00406 DS    0H                                                  0421 00573000
*                                                                  0421 00574000
*   /*****************************************************************/ 00575000
*   /*                                                               */ 00576000
*   /* ISSUE UPUT MACRO TO PUT THE UPDATED VTOC BACK. IF     @Y30LB37*/ 00577000
*   /* AN ERROR OCCURS THEN SET RETURN CODE TO TESTRC.       @Y30LB37*/ 00578000
*   /*                                                               */ 00579000
*   /*****************************************************************/ 00580000
*                                                                  0421 00581000
*   IF VTOCPRC=0 THEN                                              0421 00582000
@RF00400 LTR   VTOCPRC,VTOCPRC                                     0421 00583000
         BNZ   @RF00421                                            0421 00584000
*     DO;                           /*                       @Y30LB37*/ 00585000
*       CALL IDCIOPT0(GDTTBL,IOCSPTR);/*                     @Y30LB37*/ 00586000
         L     @05,@PC00001                                        0423 00587000
         ST    @05,@AL00001                                        0423 00588000
         LA    @03,IOCSPTR                                         0423 00589000
         ST    @03,@AL00001+4                                      0423 00590000
         MVI   @AL00001+4,X'80'                                    0423 00591000
         L     @15,GDTPUT(,@05)                                    0423 00592000
         LA    @01,@AL00001                                        0423 00593000
         BALR  @14,@15                                             0423 00594000
*       RESPECIFY                                                  0424 00595000
*         RTNREG RSTD;                                             0424 00596000
*       TESTRC=RTNREG;                                             0425 00597000
         STH   RTNREG,TESTRC                                       0425 00598000
*       RESPECIFY                                                  0426 00599000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 00600000
*       IF TESTRC^=0 THEN                                          0427 00601000
         LH    @05,TESTRC                                          0427 00602000
         LTR   @05,@05                                             0427 00603000
         BZ    @RF00427                                            0427 00604000
*         VTOCPRC=TESTRC;           /*                       @Y30LB37*/ 00605000
         LR    VTOCPRC,@05                                         0428 00606000
*     END;                          /*                       @Y30LB37*/ 00607000
*                                                                  0429 00608000
@RF00427 DS    0H                                                  0430 00609000
*   /*****************************************************************/ 00610000
*   /*                                                               */ 00611000
*   /* ISSUE A UPRINT MACRO IF AN ERROR OCCURRED UPDATING    @Y30LB37*/ 00612000
*   /* FORMAT 4 DSCB.                                        @Y30LB37*/ 00613000
*   /*                                                               */ 00614000
*   /*****************************************************************/ 00615000
*                                                                  0430 00616000
*   IF VTOCPRC^=0 THEN                                             0430 00617000
@RF00421 LTR   VTOCPRC,VTOCPRC                                     0430 00618000
         BZ    @RF00430                                            0430 00619000
*     DO;                           /*                       @Y30LB37*/ 00620000
*                                                                  0431 00621000
*       /*************************************************************/ 00622000
*       /*                                                           */ 00623000
*       /* IF THE TIME COULD NOT BE UPDATED, ISSUE MESSAGE   @Y30LB37*/ 00624000
*       /* IDC1968I. ISSUE THREE DIFFERENT VERSIONS OF       @Y30LB37*/ 00625000
*       /* IDC1968I ACCORDING TO THE WAY VSMSG IS SET.       @Y30LB37*/ 00626000
*       /*                                                           */ 00627000
*       /*************************************************************/ 00628000
*                                                                  0432 00629000
*       IF VSTIME=ON THEN                                          0432 00630000
         TM    VSTIME(ARGLPTR),B'10000000'                         0432 00631000
         BNO   @RF00432                                            0432 00632000
*         DO;                       /*                       @Y30LB37*/ 00633000
*           DARGSMOD=MSGMODID;      /*                       @Y30LB37*/ 00634000
         L     @05,DDSTRU                                          0434 00635000
         MVC   DARGSMOD(3,@05),@CC01408                            0434 00636000
*           DARGDBP=VSVOLP;         /*                       @Y30LB37*/ 00637000
         L     @03,VSVOLP(,ARGLPTR)                                0435 00638000
         ST    @03,DARGDBP(,@05)                                   0435 00639000
*           DARGILP=VOLSERLN;       /*                       @Y30LB37*/ 00640000
         MVC   DARGILP(2,@05),@CH00035                             0436 00641000
*           IF VSTOV=OFF&VSFROMV=OFF THEN                          0437 00642000
         TM    VSTOV(ARGLPTR),B'11000000'                          0437 00643000
         BNZ   @RF00437                                            0437 00644000
*             DARGSENT=MSG1968A;    /*                       @Y30LB37*/ 00645000
         MVI   DARGSENT(@05),X'0B'                                 0438 00646000
*           ELSE                                                   0439 00647000
*             IF VSTOV=ON THEN                                     0439 00648000
         B     @RC00437                                            0439 00649000
@RF00437 TM    VSTOV(ARGLPTR),B'01000000'                          0439 00650000
         BNO   @RF00439                                            0439 00651000
*               DARGSENT=MSG1968B;  /*                       @Y30LB37*/ 00652000
         L     @05,DDSTRU                                          0440 00653000
         MVI   DARGSENT(@05),X'13'                                 0440 00654000
*             ELSE                                                 0441 00655000
*               IF VSFROMV=ON THEN                                 0441 00656000
         B     @RC00439                                            0441 00657000
@RF00439 TM    VSFROMV(ARGLPTR),B'10000000'                        0441 00658000
         BNO   @RF00441                                            0441 00659000
*                 DARGSENT=MSG1968C;/*                       @Y30LB37*/ 00660000
         L     @05,DDSTRU                                          0442 00661000
         MVI   DARGSENT(@05),X'14'                                 0442 00662000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB37*/ 00663000
@RF00441 DS    0H                                                  0443 00664000
@RC00439 DS    0H                                                  0443 00665000
@RC00437 L     @05,@PC00001                                        0443 00666000
         ST    @05,@AL00001                                        0443 00667000
         LA    @03,@CF00120                                        0443 00668000
         ST    @03,@AL00001+4                                      0443 00669000
         LA    @03,DDSTRU                                          0443 00670000
         ST    @03,@AL00001+8                                      0443 00671000
         MVI   @AL00001+8,X'80'                                    0443 00672000
         L     @15,GDTPRT(,@05)                                    0443 00673000
         LA    @01,@AL00001                                        0443 00674000
         BALR  @14,@15                                             0443 00675000
*         END;                      /*                       @Y30LB37*/ 00676000
*                                                                  0445 00677000
*       /*************************************************************/ 00678000
*       /*                                                           */ 00679000
*       /* IF ALTERNATE TRACK INFORMATION COULD NOT BE       @Y30LB37*/ 00680000
*       /* UPDATED, THEN ISSUE ERROR MESSAGE IDC1969I.       @Y30LB37*/ 00681000
*       /*                                                           */ 00682000
*       /*************************************************************/ 00683000
*                                                                  0445 00684000
*       IF VSALTTRK=ON THEN                                        0445 00685000
@RF00432 TM    VSALTTRK(ARGLPTR),B'01000000'                       0445 00686000
         BNO   @RF00445                                            0445 00687000
*         DO;                       /*                       @Y30LB37*/ 00688000
*           DARGSMOD=MSGMODID;      /*                       @Y30LB37*/ 00689000
         L     @05,DDSTRU                                          0447 00690000
         MVC   DARGSMOD(3,@05),@CC01408                            0447 00691000
*           DARGSENT=MSG1969I;      /*                       @Y30LB37*/ 00692000
         MVI   DARGSENT(@05),X'0C'                                 0448 00693000
*           DARGDBP=VSVOLP;         /*                       @Y30LB37*/ 00694000
         L     @03,VSVOLP(,ARGLPTR)                                0449 00695000
         ST    @03,DARGDBP(,@05)                                   0449 00696000
*           DARGILP=VOLSERLN;       /*                       @Y30LB37*/ 00697000
         MVC   DARGILP(2,@05),@CH00035                             0450 00698000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB37*/ 00699000
*                                                                  0451 00700000
         L     @05,@PC00001                                        0451 00701000
         ST    @05,@AL00001                                        0451 00702000
         LA    @03,@CF00120                                        0451 00703000
         ST    @03,@AL00001+4                                      0451 00704000
         LA    @03,DDSTRU                                          0451 00705000
         ST    @03,@AL00001+8                                      0451 00706000
         MVI   @AL00001+8,X'80'                                    0451 00707000
         L     @15,GDTPRT(,@05)                                    0451 00708000
         LA    @01,@AL00001                                        0451 00709000
         BALR  @14,@15                                             0451 00710000
*           /*********************************************************/ 00711000
*           /*                                                       */ 00712000
*           /* IF ALTERNATE TRACK INFORMATION COULD NOT BE   @Y30LB37*/ 00713000
*           /* UPDATED, THEN ISSUE ERROR MESSAGE IDC0970I,   @Y30LB37*/ 00714000
*           /* INSERTING THE CALLERS UPDATE INFORMATION IN   @Y30LB37*/ 00715000
*           /* THE VS1AGL. ISSUE UPRINT MACRO.               @Y30LB37*/ 00716000
*           /*                                                       */ 00717000
*           /*********************************************************/ 00718000
*                                                                  0452 00719000
*           IF V1NXAREA^=ZEROFLD4&V1NUAREA^=ZEROFLD2 THEN          0452 00720000
         L     @05,VSNXTATP(,ARGLPTR)                              0452 00721000
         CLC   V1NXAREA(4,@05),ZEROFLD4                            0452 00722000
         BE    @RF00452                                            0452 00723000
         L     @03,VSNUMATP(,ARGLPTR)                              0452 00724000
         CLC   V1NUAREA(2,@03),ZEROFLD2                            0452 00725000
         BE    @RF00452                                            0452 00726000
*             DO;                   /*                       @Y30LB37*/ 00727000
*               PRINTARG=''B;       /*                       @Y30LB37*/ 00728000
         XC    PRINTARG(44),PRINTARG                               0454 00729000
*               DARGSMOD=MSGMODID;  /*                       @Y30LB37*/ 00730000
         L     @15,DDSTRU                                          0455 00731000
         MVC   DARGSMOD(3,@15),@CC01408                            0455 00732000
*               DARGSENT=MSG0970I;  /*                       @Y30LB37*/ 00733000
         MVI   DARGSENT(@15),X'16'                                 0456 00734000
*               DARGDBP=VSNUMATP;   /*                       @Y30LB37*/ 00735000
         ST    @03,DARGDBP(,@15)                                   0457 00736000
*               DARGILP=LENGTH(V1NUAREA);/*                  @Y30LB37*/ 00737000
         MVC   DARGILP(2,@15),@CH00159                             0458 00738000
*               DARGCNT=1;          /*                       @Y30LB37*/ 00739000
         LA    @03,1                                               0459 00740000
         STH   @03,DARGCNT(,@15)                                   0459 00741000
*               DARGINS(1)=ONE;     /*                       @Y30LB37*/ 00742000
         STH   @03,DARGINS(,@15)                                   0460 00743000
*               DARGDTM(1)=VSNXTATP;/*                       @Y30LB37*/ 00744000
         ST    @05,DARGDTM(,@15)                                   0461 00745000
*               DARGINL(1)=LENGTH(V1NXAREA);/*               @Y30LB37*/ 00746000
         MVC   DARGINL(2,@15),@CH00046                             0462 00747000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB37*/ 00748000
         L     @03,@PC00001                                        0463 00749000
         ST    @03,@AL00001                                        0463 00750000
         LA    @15,@CF00120                                        0463 00751000
         ST    @15,@AL00001+4                                      0463 00752000
         LA    @15,DDSTRU                                          0463 00753000
         ST    @15,@AL00001+8                                      0463 00754000
         MVI   @AL00001+8,X'80'                                    0463 00755000
         L     @15,GDTPRT(,@03)                                    0463 00756000
         LA    @01,@AL00001                                        0463 00757000
         BALR  @14,@15                                             0463 00758000
*             END;                  /*                       @Y30LB37*/ 00759000
*         END;                      /*                       @Y30LB37*/ 00760000
@RF00452 DS    0H                                                  0466 00761000
*     END;                          /*                       @Y30LB37*/ 00762000
@RF00445 DS    0H                                                  0467 00763000
*   RETURN CODE(VTOCPRC);           /* RETURN TO MAIN ROUTINE      0467 00764000
*                                                            @Y30LB37*/ 00765000
@RF00430 LR    @15,VTOCPRC                                         0467 00766000
         L     @14,@SA00003                                        0467 00767000
         LM    @00,@12,@SA00003+8                                  0467 00768000
         BR    @14                                                 0467 00769000
*   END VTOCPUT;                    /* END OF VTOCPUT PROC   @Y30LB37*/ 00770000
*                                                                  0469 00771000
*/********************************************************************/ 00772000
*/*                                                                  */ 00773000
*/*  PROCEDURE NAME - VTOCOPEN                               @Y30LB37*/ 00774000
*/*                                                          @Y30LB37*/ 00775000
*/*  FUNCTION - THIS PROCEDURE OPENS THE VTOC FOR BSAM       @Y30LB37*/ 00776000
*/*             UPDATE PROCESSING AND RESERVES THE           @Y30LB37*/ 00777000
*/*             VOLUME IF REQUESTED.  VTOCOPEN CALLS UPRINT  @Y30LB37*/ 00778000
*/*             TO PRINT ERROR MESSAGE IDC2971I IF THE       @Y30LB37*/ 00779000
*/*             RESERVE WAS NOT SUCCESSFUL.                  @Y30LB37*/ 00780000
*/*                                                          @Y30LB37*/ 00781000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 00782000
*/*          LIST:  FIELDS VSRES, VSFILEP, AND VSVOLP.  IT   @Y30LB37*/ 00783000
*/*          ALSO USES FIELD VSUCBP TO DETERMINE IF USYSINFO @Y30LB37*/ 00784000
*/*          SHOULD BE CALLED IF VSUCBP POINTS TO ZEROS.     @Y30LB37*/ 00785000
*/*                                                          @Y30LB37*/ 00786000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       @Y30LB37*/ 00787000
*/*          OR FOUR ERROR CODE.  VSIOP FIELD IS SET WITH    @Y30LB37*/ 00788000
*/*          ADDRESS OF IOCSTR FOR VTOC.  UCB ADDRESS IS     @Y30LB37*/ 00789000
*/*          RETURNED IN AREA POINTED TO BY THE              @Y30LB37*/ 00790000
*/*          VS1AGL.  RETURN CODES ARE:                      @Y30LB37*/ 00791000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 00792000
*/*          4 - VTOC OPEN WAS UNSUCCESSFUL                  @Y30LB37*/ 00793000
*/*              ERROR RETRIEVING UCB ADDRESS                @Y30LB37*/ 00794000
*/*              ERROR RESERVING VOLUME                      @Y30LB37*/ 00795000
*/*                                                                  */ 00796000
*/********************************************************************/ 00797000
*                                                                  0469 00798000
*VTOCOPEN:                                                         0469 00799000
*   PROCEDURE;                      /*                       @Y30LB37*/ 00800000
VTOCOPEN STM   @14,@12,@SA00004                                    0469 00801000
*                                                                  0470 00802000
*   /*****************************************************************/ 00803000
*   /*                                                               */ 00804000
*   /* LOCAL DECLARATIONS FOR VTOCOPEN                       @Y30LB37*/ 00805000
*   /*                                                               */ 00806000
*   /*****************************************************************/ 00807000
*                                                                  0470 00808000
*   DCL                                                            0470 00809000
*     VTOCORC FIXED(15);            /* VTOCOPEN RETURN CODE  @Y30LB37*/ 00810000
*   DCL                                                            0471 00811000
*     OPNLIST CHAR(LENGTH(OPNAGL))  /* OPNAGL GETMAINED      @Y30LB37*/ 00812000
*         BDY(WORD);                /* AREA                  @Y30LB37*/ 00813000
*   DCL                                                            0472 00814000
*     1 DSNAME BDY(WORD) STATIC,    /* DSNAME FIELD FOR VTOC @Y30LB37*/ 00815000
*      2 *(44) CHAR(1) INIT((44)'04'X);/* INITIALIZED        @Y30LB37*/ 00816000
*   DCL                                                            0473 00817000
*     BLKSIZ96 FIXED(31) CONSTANT(96);/* BLOCK SIZE 96       @Y30LB37*/ 00818000
*   DCL                                                            0474 00819000
*     KEYLEN44 FIXED(8) CONSTANT(44);/* KEY LENGTH OF 44     @Y30LB37*/ 00820000
*   DCL                                                            0475 00821000
*     1 CNTVOL BDY(WORD),           /* COUNT AND VOLSER      @Y30LB37*/ 00822000
*      2 COUNT FIXED(8),            /* NUMBER VOLSERS        @Y30LB37*/ 00823000
*      2 VOLLAB CHAR(6);            /* VOLUME SERIAL         @Y30LB37*/ 00824000
*   DCL                                                            0476 00825000
*     1 MINORNAM BDY(WORD),         /* MINOR NAME DSECT      @Y30LB37*/ 00826000
*      2 MINLEN FIXED(8),           /* MINOR NAME LENGTH     @Y30LB37*/ 00827000
*      2 MINVOL CHAR(6),            /* MINOR VOLUME SERIAL   @Y30LB37*/ 00828000
*      2 MINCON CHAR(16);           /* MINOR CONSTANT NAME   @Y30LB37*/ 00829000
*   DCL                                                            0477 00830000
*     MAJNAME CHAR(8) STATIC        /* URESERVE MAJOR NAME   @Y30LB37*/ 00831000
*         BDY(WORD) INIT('SYSZAMS ');/* INITIALIZED          @Y30LB37*/ 00832000
*   DCL                                                            0478 00833000
*     MINRNAME CHAR(13) STATIC      /* URESERVE MINOR NAME   @Y30LB37*/ 00834000
*         BDY(WORD) INIT('.REAL.RESERVE');/* INITIALIZED     @Y30LB37*/ 00835000
*   DCL                                                            0479 00836000
*     MINVNAME CHAR(16) STATIC      /* URESERVE MINOR NAME   @Y30LB37*/ 00837000
*         BDY(WORD) INIT('.VIRTUAL.RESERVE');/* INITIALIZED  @Y30LB37*/ 00838000
*                                                                  0480 00839000
*   /*****************************************************************/ 00840000
*   /*                                                               */ 00841000
*   /* INITIALIZE THE OPNAGL ARGUMENT LIST AND ISSUE THE     @Y30LB37*/ 00842000
*   /* UOPEN MACRO TO OPEN THE VTOC. IF FAILS ISSUE THE      @Y30LB37*/ 00843000
*   /* UCLOSE MACRO IF THE IOCSPTR IS NOT ZEROS AND SET      @Y30LB37*/ 00844000
*   /* THE RETURN CODE TO RCFAIL AND THE IOCSTR POINTER      @Y30LB37*/ 00845000
*   /* FIELD IN THE VS1AGL TO ZERO.                          @Y30LB37*/ 00846000
*   /*                                                               */ 00847000
*   /*****************************************************************/ 00848000
*                                                                  0480 00849000
*   OLDERID2=NEWERID2;                                             0480 00850000
         L     @03,@PC00001                                        0480 00851000
         L     @15,GDTTR2(,@03)                                    0480 00852000
         MVC   @TS00001(95),NEWERID2(@15)                          0480 00853000
         MVC   OLDERID2(95,@15),@TS00001                           0480 00854000
*   NEWID2='VSVT';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 00855000
         MVC   NEWID2(4,@15),@CC01519                              0481 00856000
*   VTOCORC=0;                      /* SET RETURN CODE TO 0  @Y30LB37*/ 00857000
         SLR   VTOCORC,VTOCORC                                     0482 00858000
*   OPNPTR=ADDR(OPNLIST);           /* INITIALIZE OPNAGL PTR @Y30LB37*/ 00859000
         LA    OPNPTR,OPNLIST                                      0483 00860000
*   OPNAGL=''B;                     /* CLEAR THE OPEN AGL    @Y30LB37*/ 00861000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    0484 00862000
*   OPNOPTUP=ON;                    /* UPDATE OPTION FLAG    @Y30LB37*/ 00863000
*   OPNOPTBK=ON;                    /* FIXED BLOCK OPTION    @Y30LB37*/ 00864000
         OI    OPNOPTUP(OPNPTR),B'00110000'                        0486 00865000
*   OPNRFMFX=ON;                    /* RECFM FIXED OPTION    @Y30LB37*/ 00866000
         OI    OPNRFMFX(OPNPTR),B'10000000'                        0487 00867000
*   OPNOPTJM=ON;                    /* OPEN TYPE J OPTION    @Y30LB37*/ 00868000
         OI    OPNOPTJM(OPNPTR),B'00100000'                        0488 00869000
*   OPNDSOPS=ON;                    /* DSORG PS              @Y30LB37*/ 00870000
         OI    OPNDSOPS(OPNPTR),B'01000000'                        0489 00871000
*   OPNIOC=ADDR(IOCSPTR);           /* INITIALIZE IOCSTR PTR @Y30LB37*/ 00872000
         LA    @15,IOCSPTR                                         0490 00873000
         ST    @15,OPNIOC(,OPNPTR)                                 0490 00874000
*   OPNDDN=VSFILEP;                 /* DDNAME POINTER        @Y30LB37*/ 00875000
         L     @15,VSFILEP(,ARGLPTR)                               0491 00876000
         ST    @15,OPNDDN(,OPNPTR)                                 0491 00877000
*   OPNBLK=BLKSIZ96;                /* BLKSIZE OF 96         @Y30LB37*/ 00878000
         MVC   OPNBLK(4,OPNPTR),@CF01150                           0492 00879000
*   OPNKYL=KEYLEN44;                /* KEY LENGTH OF 44      @Y30LB37*/ 00880000
         MVI   OPNKYL(OPNPTR),X'2C'                                0493 00881000
*   COUNT=ONE;                      /* ONE VOLSER PASSED     @Y30LB37*/ 00882000
         MVI   COUNT,X'01'                                         0494 00883000
*   VOLLAB=V1VOLA;                  /* VOLUME LABEL          @Y30LB37*/ 00884000
         L     @01,VSVOLP(,ARGLPTR)                                0495 00885000
         MVC   VOLLAB(6),V1VOLA(@01)                               0495 00886000
*   OPNVOL=ADDR(CNTVOL);            /* ADDRESS OF VOLSER/CNT @Y30LB37*/ 00887000
         LA    @15,CNTVOL                                          0496 00888000
         ST    @15,OPNVOL(,OPNPTR)                                 0496 00889000
*   OPNDSN=ADDR(DSNAME);            /* DSNAME ADDRESS        @Y30LB37*/ 00890000
         LA    @15,DSNAME                                          0497 00891000
         ST    @15,OPNDSN(,OPNPTR)                                 0497 00892000
*   CALL IDCIOOP0(GDTTBL,OPNAGL);   /* ISSUE UOPEN MACRO     @Y30LB37*/ 00893000
         ST    @03,@AL00001                                        0498 00894000
         ST    OPNPTR,@AL00001+4                                   0498 00895000
         MVI   @AL00001+4,X'80'                                    0498 00896000
         L     @15,GDTOPN(,@03)                                    0498 00897000
         LA    @01,@AL00001                                        0498 00898000
         BALR  @14,@15                                             0498 00899000
*   RESPECIFY                                                      0499 00900000
*     RTNREG RSTD;                                                 0499 00901000
*   TESTRC=RTNREG;                                                 0500 00902000
         STH   RTNREG,TESTRC                                       0500 00903000
*   RESPECIFY                                                      0501 00904000
*     RTNREG UNRSTD;                /*                       @Y30LB37*/ 00905000
*   IF TESTRC^=0 THEN                                              0502 00906000
         LH    @15,TESTRC                                          0502 00907000
         SLR   @14,@14                                             0502 00908000
         CR    @15,@14                                             0502 00909000
         BE    @RF00502                                            0502 00910000
*     DO;                           /*                       @Y30LB37*/ 00911000
*       VTOCORC=4;                  /*                       @Y30LB37*/ 00912000
         LA    VTOCORC,4                                           0504 00913000
*       IF IOCSPTR^=NULLPTR THEN                                   0505 00914000
         C     @14,IOCSPTR                                         0505 00915000
         BE    @RF00505                                            0505 00916000
*         CALL IDCIOCL0(GDTTBL,IOCSPTR);/*                   @Y30LB37*/ 00917000
         L     @15,@PC00001                                        0506 00918000
         ST    @15,@AL00001                                        0506 00919000
         LA    @14,IOCSPTR                                         0506 00920000
         ST    @14,@AL00001+4                                      0506 00921000
         MVI   @AL00001+4,X'80'                                    0506 00922000
         L     @15,GDTCLS(,@15)                                    0506 00923000
         LA    @01,@AL00001                                        0506 00924000
         BALR  @14,@15                                             0506 00925000
*       VSIOP=NULLPTR;              /*                       @Y30LB37*/ 00926000
@RF00505 SLR   @15,@15                                             0507 00927000
         ST    @15,VSIOP(,ARGLPTR)                                 0507 00928000
*     END;                          /*                       @Y30LB37*/ 00929000
*                                                                  0508 00930000
*   /*****************************************************************/ 00931000
*   /*                                                               */ 00932000
*   /* IF UOPEN SUCCESSFUL SET IOCSTR POINTER IN VS1AGL.     @Y30LB37*/ 00933000
*   /*                                                               */ 00934000
*   /*****************************************************************/ 00935000
*                                                                  0509 00936000
*   ELSE                                                           0509 00937000
*     VSIOP=IOCSPTR;                /*                       @Y30LB37*/ 00938000
         B     @RC00502                                            0509 00939000
@RF00502 L     @15,IOCSPTR                                         0509 00940000
         ST    @15,VSIOP(,ARGLPTR)                                 0509 00941000
*                                                                  0510 00942000
*   /*****************************************************************/ 00943000
*   /*                                                               */ 00944000
*   /* IF THE VTOC WAS OPENED SUCCESSFULLY, THEN IF A        @Y30LB37*/ 00945000
*   /* RESERVE WAS REQUESTED CHECK TO SEE IF THE CALLER      @Y30LB37*/ 00946000
*   /* SPECIFIED A UCB ADDRESS. IF NOT, THEN ISSUE A         @Y30LB37*/ 00947000
*   /* USYSINFO MACRO TO OBTAIN THE UCB ADDRESS AND PUT      @Y30LB37*/ 00948000
*   /* THE UCB ADDRESS IN THE CALLER'S AREA. IF USYSINFO     @Y30LB37*/ 00949000
*   /* WAS NOT SUCCESSFUL, SET THE RETURN CODE TO RCFAIL.    @Y30LB37*/ 00950000
*   /*                                                               */ 00951000
*   /*****************************************************************/ 00952000
*                                                                  0510 00953000
*   IF VTOCORC=0 THEN                                              0510 00954000
@RC00502 SLR   @15,@15                                             0510 00955000
         CR    VTOCORC,@15                                         0510 00956000
         BNE   @RF00510                                            0510 00957000
*     IF VSRES=ON THEN                                             0511 00958000
         TM    VSRES(ARGLPTR),B'10000000'                          0511 00959000
         BNO   @RF00511                                            0511 00960000
*       IF V1UCBADR=NULLPTR THEN                                   0512 00961000
         L     @01,VSUCBP(,ARGLPTR)                                0512 00962000
         C     @15,V1UCBADR(,@01)                                  0512 00963000
         BNE   @RF00512                                            0512 00964000
*         DO;                       /*                       @Y30LB37*/ 00965000
*           CALL IDCSASI0(GDTTBL,UNIT,INFOPTR,V1DDNAM);/*    @Y30LB37*/ 00966000
         L     @15,@PC00001                                        0514 00967000
         ST    @15,@AL00001                                        0514 00968000
         LA    @14,UNIT                                            0514 00969000
         ST    @14,@AL00001+4                                      0514 00970000
         LA    @14,INFOPTR                                         0514 00971000
         ST    @14,@AL00001+8                                      0514 00972000
         L     @01,VSFILEP(,ARGLPTR)                               0514 00973000
         ST    @01,@AL00001+12                                     0514 00974000
         MVI   @AL00001+12,X'80'                                   0514 00975000
         L     @15,GDTSFO(,@15)                                    0514 00976000
         LA    @01,@AL00001                                        0514 00977000
         BALR  @14,@15                                             0514 00978000
*           RESPECIFY                                              0515 00979000
*             RTNREG RSTD;                                         0515 00980000
*           TESTRC=RTNREG;                                         0516 00981000
         STH   RTNREG,TESTRC                                       0516 00982000
*           RESPECIFY                                              0517 00983000
*             RTNREG UNRSTD;        /*                       @Y30LB37*/ 00984000
*           IF TESTRC=0 THEN                                       0518 00985000
         LH    @15,TESTRC                                          0518 00986000
         LTR   @15,@15                                             0518 00987000
         BNZ   @RF00518                                            0518 00988000
*             V1UCBADR=UNITUCB;     /*                       @Y30LB37*/ 00989000
         L     @01,VSUCBP(,ARGLPTR)                                0519 00990000
         L     @15,INFOPTR                                         0519 00991000
         L     @00,UNITUCB(,@15)                                   0519 00992000
         ST    @00,V1UCBADR(,@01)                                  0519 00993000
*           ELSE                                                   0520 00994000
*             VTOCORC=4;            /*                       @Y30LB37*/ 00995000
         B     @RC00518                                            0520 00996000
@RF00518 LA    VTOCORC,4                                           0520 00997000
*         END;                      /*                       @Y30LB37*/ 00998000
@RC00518 DS    0H                                                  0522 00999000
*                                                                  0522 01000000
*   /*****************************************************************/ 01001000
*   /*                                                               */ 01002000
*   /* IF ALL IS SUCCESSFUL AND A RESERVE REQUEST WAS        @Y30LB37*/ 01003000
*   /* SPECIFIED, THEN ISSUE A URESERVE MACRO. SET THE       @Y30LB37*/ 01004000
*   /* MINOR NAME FOR VIRTUAL OR REAL VOLUME SERIAL NUMBER   @Y30LB37*/ 01005000
*   /* ACCORDING TO CALLER'S REQUEST. IF THE URESERVE        @Y30LB37*/ 01006000
*   /* MACRO IS UNSUCCESSFUL THEN ISSUE ERROR MESSAGE        @Y30LB37*/ 01007000
*   /* IDC2971I VIA THE UPRINT MACRO AND SET RETURN CODE     @Y30LB37*/ 01008000
*   /* TO RCFAIL.                                            @Y30LB37*/ 01009000
*   /*                                                               */ 01010000
*   /*****************************************************************/ 01011000
*                                                                  0522 01012000
*   IF VTOCORC=0 THEN                                              0522 01013000
@RF00512 DS    0H                                                  0522 01014000
@RF00511 DS    0H                                                  0522 01015000
@RF00510 LTR   VTOCORC,VTOCORC                                     0522 01016000
         BNZ   @RF00522                                            0522 01017000
*     IF VSRES=ON THEN                                             0523 01018000
         TM    VSRES(ARGLPTR),B'10000000'                          0523 01019000
         BNO   @RF00523                                            0523 01020000
*       DO;                         /*                       @Y30LB37*/ 01021000
*         IF VSREAL=ON THEN                                        0525 01022000
         TM    VSREAL(ARGLPTR),B'01000000'                         0525 01023000
         BNO   @RF00525                                            0525 01024000
*           DO;                     /*                       @Y30LB37*/ 01025000
*             MINCON=MINRNAME;      /*                       @Y30LB37*/ 01026000
         MVI   MINCON+13,C' '                                      0527 01027000
         MVC   MINCON+14(2),MINCON+13                              0527 01028000
         MVC   MINCON(13),MINRNAME                                 0527 01029000
*             MINLEN=LENGTH(MINRNAME)+VOLSERLN;/*            @Y30LB37*/ 01030000
         MVI   MINLEN,X'13'                                        0528 01031000
*           END;                    /*                       @Y30LB37*/ 01032000
*         ELSE                                                     0530 01033000
*           DO;                     /*                       @Y30LB37*/ 01034000
         B     @RC00525                                            0530 01035000
@RF00525 DS    0H                                                  0531 01036000
*             MINCON=MINVNAME;      /*                       @Y30LB37*/ 01037000
         MVC   MINCON(16),MINVNAME                                 0531 01038000
*             MINLEN=LENGTH(MINVNAME)+VOLSERLN;/*            @Y30LB37*/ 01039000
         MVI   MINLEN,X'16'                                        0532 01040000
*           END;                    /*                       @Y30LB37*/ 01041000
*         MINVOL=V1VOLA;            /*                       @Y30LB37*/ 01042000
@RC00525 L     @01,VSVOLP(,ARGLPTR)                                0534 01043000
         MVC   MINVOL(6),V1VOLA(@01)                               0534 01044000
*         CALL IDCSARV0(GDTTBL,EXCL,WAIT,V1UCBADR,MAJNAME,MINORNAM);    01045000
         L     @15,@PC00001                                        0535 01046000
         ST    @15,@AL00001                                        0535 01047000
         LA    @14,EXCL                                            0535 01048000
         ST    @14,@AL00001+4                                      0535 01049000
         LA    @14,WAIT                                            0535 01050000
         ST    @14,@AL00001+8                                      0535 01051000
         L     @01,VSUCBP(,ARGLPTR)                                0535 01052000
         ST    @01,@AL00001+12                                     0535 01053000
         LA    @14,MAJNAME                                         0535 01054000
         ST    @14,@AL00001+16                                     0535 01055000
         LA    @14,MINORNAM                                        0535 01056000
         ST    @14,@AL00001+20                                     0535 01057000
         MVI   @AL00001+20,X'80'                                   0535 01058000
         L     @15,GDTRSV(,@15)                                    0535 01059000
         LA    @01,@AL00001                                        0535 01060000
         BALR  @14,@15                                             0535 01061000
*                                   /*                       @ZA05123*/ 01062000
*         RESPECIFY                                                0536 01063000
*           RTNREG RSTD;                                           0536 01064000
*         TESTRC=RTNREG;                                           0537 01065000
         STH   RTNREG,TESTRC                                       0537 01066000
*         RESPECIFY                                                0538 01067000
*           RTNREG UNRSTD;          /*                       @Y30LB37*/ 01068000
*         IF TESTRC^=0 THEN                                        0539 01069000
         LH    @15,TESTRC                                          0539 01070000
         LTR   @15,@15                                             0539 01071000
         BZ    @RF00539                                            0539 01072000
*           DO;                     /*                       @Y30LB37*/ 01073000
*             VTOCORC=4;            /*                       @Y30LB37*/ 01074000
         LA    VTOCORC,4                                           0541 01075000
*             DARGSMOD=MSGMODID;    /*                       @Y30LB37*/ 01076000
         L     @15,DDSTRU                                          0542 01077000
         MVC   DARGSMOD(3,@15),@CC01408                            0542 01078000
*             DARGSENT=MSG2971I;    /*                       @Y30LB37*/ 01079000
         MVI   DARGSENT(@15),X'15'                                 0543 01080000
*             DARGDBP=VSVOLP;       /*                       @Y30LB37*/ 01081000
         L     @14,VSVOLP(,ARGLPTR)                                0544 01082000
         ST    @14,DARGDBP(,@15)                                   0544 01083000
*             DARGILP=VOLSERLN;     /*                       @Y30LB37*/ 01084000
         MVC   DARGILP(2,@15),@CH00035                             0545 01085000
*             CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*        @Y30LB37*/ 01086000
         L     @15,@PC00001                                        0546 01087000
         ST    @15,@AL00001                                        0546 01088000
         LA    @14,@CF00120                                        0546 01089000
         ST    @14,@AL00001+4                                      0546 01090000
         LA    @14,DDSTRU                                          0546 01091000
         ST    @14,@AL00001+8                                      0546 01092000
         MVI   @AL00001+8,X'80'                                    0546 01093000
         L     @15,GDTPRT(,@15)                                    0546 01094000
         LA    @01,@AL00001                                        0546 01095000
         BALR  @14,@15                                             0546 01096000
*           END;                    /*                       @Y30LB37*/ 01097000
*       END;                        /*                       @Y30LB37*/ 01098000
@RF00539 DS    0H                                                  0549 01099000
*   RETURN CODE(VTOCORC);           /* RETURN TO MAIN ROUTINE      0549 01100000
*                                                            @Y30LB37*/ 01101000
@RF00523 DS    0H                                                  0549 01102000
@RF00522 LR    @15,VTOCORC                                         0549 01103000
         L     @14,@SA00004                                        0549 01104000
         LM    @00,@12,@SA00004+8                                  0549 01105000
         BR    @14                                                 0549 01106000
*   END VTOCOPEN;                   /* END OF VTOCOPEN PROC  @Y30LB37*/ 01107000
*                                                                  0551 01108000
*/********************************************************************/ 01109000
*/*                                                                  */ 01110000
*/*  PROCEDURE NAME - FMT4READ                               @Y30LB37*/ 01111000
*/*                                                          @Y30LB37*/ 01112000
*/*  FUNCTION - THIS PROCEDURE READS AND TESTS INFORMATION   @Y30LB37*/ 01113000
*/*             FOR A FORMAT 4 DSCB.  FMT4READ CALLS UPRINT  @Y30LB37*/ 01114000
*/*             TO PRINT ERROR MESSAGE IDC2963I IF AN ERROR  @Y30LB37*/ 01115000
*/*             OCCURRED READING THE FORMAT 4 DSCB.          @Y30LB37*/ 01116000
*/*                                                          @Y30LB37*/ 01117000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 01118000
*/*          LIST:  FIELDS VSIOP, VSFILEP, VSVOLP, AND       @Y30LB37*/ 01119000
*/*          UNITVTOC IN UNITABL SET TO 0 OR TTR TO VTOC.    @Y30LB37*/ 01120000
*/*                                                          @Y30LB37*/ 01121000
*/*  OUTPUT- THE INFORMATION RETURNED IS A ZERO OR FOUR      @Y30LB37*/ 01122000
*/*          ERROR CODE.  THE UNITVTOC FIELD IS SET WITH     @Y30LB37*/ 01123000
*/*          THE TTR TO THE VTOC.  THE POINTER TO THE        @Y30LB37*/ 01124000
*/*          FORMAT 4 DSCB IS SET.                           @Y30LB37*/ 01125000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 01126000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 01127000
*/*          4 - VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 01128000
*/*              FIRST RECORD WAS NOT A FORMAT 4             @Y30LB37*/ 01129000
*/*              ERROR RETRIEVING TTR TO THE VTOC            @Y30LB37*/ 01130000
*/*                                                                  */ 01131000
*/********************************************************************/ 01132000
*                                                                  0551 01133000
*FMT4READ:                                                         0551 01134000
*   PROCEDURE;                      /*                       @Y30LB37*/ 01135000
*                                                                  0551 01136000
FMT4READ STM   @14,@12,@SA00005                                    0551 01137000
*   /*****************************************************************/ 01138000
*   /*                                                               */ 01139000
*   /* LOCAL DECLARATIONS FOR FMT4READ                       @Y30LB37*/ 01140000
*   /*                                                               */ 01141000
*   /*****************************************************************/ 01142000
*                                                                  0552 01143000
*   DCL                                                            0552 01144000
*     FMT4RRC FIXED(15);            /* FMT4READ RETURN CODE  @Y30LB37*/ 01145000
*   DCL                                                            0553 01146000
*     FORMAT4R CHAR(1) STATIC INIT('F4'X);/* CONSTANT F4     @Y30LB37*/ 01147000
*   DCL                                                            0554 01148000
*     RELATTRZ CHAR(4) STATIC       /* RELATIVE TRACK NO     @Y30LB37*/ 01149000
*         INIT('00000100'X);        /* FOR VTOC              @Y30LB37*/ 01150000
*                                                                  0555 01151000
*   /*****************************************************************/ 01152000
*   /*                                                               */ 01153000
*   /* INITITALIZE AND ISSUE UTRACE MACRO AND INITIALIZE     @Y30LB37*/ 01154000
*   /* FORMAT FOUR READ RETURN CODE.                         @Y30LB37*/ 01155000
*   /*                                                               */ 01156000
*   /*****************************************************************/ 01157000
*                                                                  0555 01158000
*   OLDERID2=NEWERID2;                                             0555 01159000
         L     @05,@PC00001                                        0555 01160000
         L     @03,GDTTR2(,@05)                                    0555 01161000
         MVC   @TS00001(95),NEWERID2(@03)                          0555 01162000
         MVC   OLDERID2(95,@03),@TS00001                           0555 01163000
*   NEWID2='VS4R';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 01164000
         MVC   NEWID2(4,@03),@CC01528                              0556 01165000
*   FMT4RRC=0;                      /*                       @Y30LB37*/ 01166000
*                                                                  0557 01167000
         SLR   FMT4RRC,FMT4RRC                                     0557 01168000
*   /*****************************************************************/ 01169000
*   /*                                                               */ 01170000
*   /* ISSUE THE UPOSIT MACRO TO POSITION TO THE TTR.        @Y30LB37*/ 01171000
*   /* THE ONLY POSSIBLE RETURN CODE IS ZERO FROM UPOSIT.    @Y30LB37*/ 01172000
*   /*                                                               */ 01173000
*   /*****************************************************************/ 01174000
*                                                                  0558 01175000
*   IOCTTR=RELATTRZ;                /*                       @Y30LB37*/ 01176000
         L     @03,IOCSPTR                                         0558 01177000
         MVC   IOCTTR(4,@03),RELATTRZ                              0558 01178000
*   CALL IDCIOPO0(GDTTBL,IOCSPTR);  /*                       @Y30LB37*/ 01179000
         ST    @05,@AL00001                                        0559 01180000
         LA    @03,IOCSPTR                                         0559 01181000
         ST    @03,@AL00001+4                                      0559 01182000
         MVI   @AL00001+4,X'80'                                    0559 01183000
         L     @15,GDTPOS(,@05)                                    0559 01184000
         LA    @01,@AL00001                                        0559 01185000
         BALR  @14,@15                                             0559 01186000
*                                                                  0560 01187000
*   /*****************************************************************/ 01188000
*   /*                                                               */ 01189000
*   /* ISSUE A UGET MACRO TO READ THE FIRST RECORD WHICH     @Y30LB37*/ 01190000
*   /* SHOULD BE THE FORMAT 4 DSCB. IF UGET IS SUCCESSFUL    @Y30LB37*/ 01191000
*   /* SET THE POINTER TO THE FORMAT 4 RECORD TO THE RECORD  @Y30LB37*/ 01192000
*   /* JUST READ. IF UGET FAILED SET BAD RETURN CODE.        @Y30LB37*/ 01193000
*   /*                                                               */ 01194000
*   /*****************************************************************/ 01195000
*                                                                  0560 01196000
*   IF FMT4RRC=0 THEN                                              0560 01197000
         LTR   FMT4RRC,FMT4RRC                                     0560 01198000
         BNZ   @RF00560                                            0560 01199000
*     DO;                           /*                       @Y30LB37*/ 01200000
*       CALL IDCIOGT0(GDTTBL,IOCSPTR);/*                     @Y30LB37*/ 01201000
         L     @05,@PC00001                                        0562 01202000
         ST    @05,@AL00001                                        0562 01203000
         LA    @03,IOCSPTR                                         0562 01204000
         ST    @03,@AL00001+4                                      0562 01205000
         MVI   @AL00001+4,X'80'                                    0562 01206000
         L     @15,GDTGET(,@05)                                    0562 01207000
         LA    @01,@AL00001                                        0562 01208000
         BALR  @14,@15                                             0562 01209000
*       RESPECIFY                                                  0563 01210000
*         RTNREG RSTD;                                             0563 01211000
*       TESTRC=RTNREG;                                             0564 01212000
         STH   RTNREG,TESTRC                                       0564 01213000
*       RESPECIFY                                                  0565 01214000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 01215000
*       IF TESTRC=0 THEN                                           0566 01216000
         LH    @05,TESTRC                                          0566 01217000
         LTR   @05,@05                                             0566 01218000
         BNZ   @RF00566                                            0566 01219000
*         F4PTR=IOCDAD;             /*                       @Y30LB37*/ 01220000
         L     @05,IOCSPTR                                         0567 01221000
         L     @05,IOCDAD(,@05)                                    0567 01222000
         ST    @05,F4PTR                                           0567 01223000
*       ELSE                                                       0568 01224000
*         FMT4RRC=4;                /*                       @Y30LB37*/ 01225000
         B     @RC00566                                            0568 01226000
@RF00566 LA    FMT4RRC,4                                           0568 01227000
*     END;                          /*                       @Y30LB37*/ 01228000
*                                                                  0569 01229000
@RC00566 DS    0H                                                  0570 01230000
*   /*****************************************************************/ 01231000
*   /*                                                               */ 01232000
*   /* ISSUE A UPRINT MACRO IF THE RECORD READ IS NOT A      @Y30LB37*/ 01233000
*   /* FORMAT 4 DSCB. THE ERROR MESSAGE IS IDC2963I WITH     @Y30LB37*/ 01234000
*   /* THREE VARIATIONS ACCORDING TO THE WAY VSMSG IS SET.   @Y30LB37*/ 01235000
*   /*                                                               */ 01236000
*   /*****************************************************************/ 01237000
*                                                                  0570 01238000
*   IF FMT4RRC=0 THEN                                              0570 01239000
@RF00560 LTR   FMT4RRC,FMT4RRC                                     0570 01240000
         BNZ   @RF00570                                            0570 01241000
*     IF DS4IDFMT^=FORMAT4R THEN                                   0571 01242000
         L     @05,F4PTR                                           0571 01243000
         CLC   DS4IDFMT+44(1,@05),FORMAT4R                         0571 01244000
         BE    @RF00571                                            0571 01245000
*       DO;                         /*                       @Y30LB37*/ 01246000
*         FMT4RRC=4;                /*                       @Y30LB37*/ 01247000
         LA    FMT4RRC,4                                           0573 01248000
*         DARGSMOD=MSGMODID;        /*                       @Y30LB37*/ 01249000
         L     @05,DDSTRU                                          0574 01250000
         MVC   DARGSMOD(3,@05),@CC01408                            0574 01251000
*         DARGDBP=VSVOLP;           /*                       @Y30LB37*/ 01252000
         L     @03,VSVOLP(,ARGLPTR)                                0575 01253000
         ST    @03,DARGDBP(,@05)                                   0575 01254000
*         DARGILP=VOLSERLN;         /*                       @Y30LB37*/ 01255000
         MVC   DARGILP(2,@05),@CH00035                             0576 01256000
*         IF VSFROMV=OFF&VSTOV=OFF THEN                            0577 01257000
         TM    VSFROMV(ARGLPTR),B'11000000'                        0577 01258000
         BNZ   @RF00577                                            0577 01259000
*           DARGSENT=MSG2963A;      /*                       @Y30LB37*/ 01260000
         MVI   DARGSENT(@05),X'05'                                 0578 01261000
*         ELSE                                                     0579 01262000
*           IF VSFROMV=ON THEN                                     0579 01263000
         B     @RC00577                                            0579 01264000
@RF00577 TM    VSFROMV(ARGLPTR),B'10000000'                        0579 01265000
         BNO   @RF00579                                            0579 01266000
*             DARGSENT=MSG2963B;    /*                       @Y30LB37*/ 01267000
         L     @05,DDSTRU                                          0580 01268000
         MVI   DARGSENT(@05),X'11'                                 0580 01269000
*           ELSE                                                   0581 01270000
*             DARGSENT=MSG2963C;    /*                       @Y30LB37*/ 01271000
         B     @RC00579                                            0581 01272000
@RF00579 L     @05,DDSTRU                                          0581 01273000
         MVI   DARGSENT(@05),X'12'                                 0581 01274000
*         CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*            @Y30LB37*/ 01275000
@RC00579 DS    0H                                                  0582 01276000
@RC00577 L     @05,@PC00001                                        0582 01277000
         ST    @05,@AL00001                                        0582 01278000
         LA    @03,@CF00120                                        0582 01279000
         ST    @03,@AL00001+4                                      0582 01280000
         LA    @03,DDSTRU                                          0582 01281000
         ST    @03,@AL00001+8                                      0582 01282000
         MVI   @AL00001+8,X'80'                                    0582 01283000
         L     @15,GDTPRT(,@05)                                    0582 01284000
         LA    @01,@AL00001                                        0582 01285000
         BALR  @14,@15                                             0582 01286000
*       END;                        /*                       @Y30LB37*/ 01287000
*   RETURN CODE(FMT4RRC);           /* RETURN TO MAIN ROUTINE      0584 01288000
*                                                            @Y30LB37*/ 01289000
@RF00571 DS    0H                                                  0584 01290000
@RF00570 LR    @15,FMT4RRC                                         0584 01291000
         L     @14,@SA00005                                        0584 01292000
         LM    @00,@12,@SA00005+8                                  0584 01293000
         BR    @14                                                 0584 01294000
*   END FMT4READ;                   /* END OF FMT4READ PROC  @Y30LB37*/ 01295000
*                                                                  0586 01296000
*/********************************************************************/ 01297000
*/*                                                                  */ 01298000
*/*  PROCEDURE NAME - FMT1READ                               @Y30LB37*/ 01299000
*/*                                                          @Y30LB37*/ 01300000
*/*  FUNCTION - THIS PROCEDURE READS AND TESTS INFORMATION   @Y30LB37*/ 01301000
*/*             IN A FORMAT 1 DSCB.  FMT1READ READS FORMAT   @Y30LB37*/ 01302000
*/*             1 DSCBS UNTIL A DSCB IS FOUND THAT MEETS     @Y30LB37*/ 01303000
*/*             THE TESTS.  FMT1READ ISSUES UGET TO GET      @Y30LB37*/ 01304000
*/*             THE FORMAT 1 DSCB.                           @Y30LB37*/ 01305000
*/*                                                          @Y30LB37*/ 01306000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 01307000
*/*          LIST:  FIELD VSIOP.  ORGTYPE FIELD FOR WHAT     @Y30LB37*/ 01308000
*/*          ORGANIZATION TO SEARCH ON.  PROTTYPE FIELD      @Y30LB37*/ 01309000
*/*          FOR WHAT PROTECTION TYPE TO SEARCH ON.          @Y30LB37*/ 01310000
*/*                                                          @Y30LB37*/ 01311000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       @Y30LB37*/ 01312000
*/*          OR FOUR ERROR CODE.  EXPONLY SET TO 1 IF DATA   @Y30LB37*/ 01313000
*/*          SET HAS NOT EXPIRED, SET TO 0 TO INITIALIZE.    @Y30LB37*/ 01314000
*/*          SET FORMAT 1 DSCB ADDRESS IF SUCCESSFUL.        @Y30LB37*/ 01315000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 01316000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 01317000
*/*          4 - VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 01318000
*/*          8 - END OF FILE SEARCHING FOR A FORMAT 1        @Y30LB37*/ 01319000
*/*                                                                  */ 01320000
*/********************************************************************/ 01321000
*                                                                  0586 01322000
*FMT1READ:                                                         0586 01323000
*   PROCEDURE(ORGTYPE,              /* ORGANIZATION TYPE     @Y30LB37*/ 01324000
*       PROTTYPE);                  /* PROTECTION TYPE       @Y30LB37*/ 01325000
FMT1READ STM   @14,@04,@SA00006                                    0586 01326000
         STM   @06,@12,@SA00006+28                                 0586 01327000
         MVC   @PC00006(8),0(@01)                                  0586 01328000
*                                                                  0587 01329000
*   /*****************************************************************/ 01330000
*   /*                                                               */ 01331000
*   /* LOCAL DECLARATIONS FOR FMT1READ                       @Y30LB37*/ 01332000
*   /*                                                               */ 01333000
*   /*****************************************************************/ 01334000
*                                                                  0587 01335000
*   DCL                                                            0587 01336000
*     FMT1RRC FIXED(15);            /* FMT1READ RETURN CODE  @Y30LB37*/ 01337000
*   DCL                                                            0588 01338000
*     FORMAT1R CHAR(1) STATIC INIT('F1'X);/* CONSTANT F1     @Y30LB37*/ 01339000
*   DCL                                                            0589 01340000
*     ZEROEXP CHAR(3) STATIC        /* ZERO CONSTANT FOR     @Y30LB37*/ 01341000
*         INIT('000000'X);          /* EXPIRATION DATE       @Y30LB37*/ 01342000
*   DCL                                                            0590 01343000
*     F1TIME CHAR(8);               /* UTIME RETURN TIME AREA      0590 01344000
*                                                            @Y30LB37*/ 01345000
*   DCL                                                            0591 01346000
*     F1DATE CHAR(4);               /* UTIME RETURN DATE AREA      0591 01347000
*                                                            @Y30LB37*/ 01348000
*   DCL                                                            0592 01349000
*     ORGTYPE CHAR(4);              /* DSORG TYPE PARM       @Y30LB37*/ 01350000
*   DCL                                                            0593 01351000
*     PROTTYPE CHAR(8);             /* PROTECTION TYPE PARM  @Y30LB37*/ 01352000
*   DCL                                                            0594 01353000
*     1 EXPDWORK CHAR(3) BDY(WORD), /* EXPIRATION DATE AREA  @Y30LB37*/ 01354000
*      2 EXPYEAR BIT(8),            /* YEAR AREA             @Y30LB37*/ 01355000
*      2 EXPDAY BIT(16);            /* DAY AREA              @Y30LB37*/ 01356000
*   DCL                                                            0595 01357000
*     1 DATEWORK FIXED(32) BDY(WORD),/* DATE CONVERSION AREA @Y30LB37*/ 01358000
*      2 * BIT(8),                  /* UNUSED                @Y30LB37*/ 01359000
*      2 DAWKYEAR BIT(8),           /* CONV YEAR AREA        @Y30LB37*/ 01360000
*      2 DAWKDAY BIT(16);           /* CONV DAY AREA         @Y30LB37*/ 01361000
*   DCL                                                            0596 01362000
*     BIN1000 FIXED(15) CONSTANT(1000);/* 1000 BINARY        @Y30LB37*/ 01363000
*                                                                  0597 01364000
*   /*****************************************************************/ 01365000
*   /*                                                               */ 01366000
*   /* READ THE VTOC UNTIL FORMAT 1 DSCB FOUND, END OF FILE  @Y30LB37*/ 01367000
*   /* IS ENCOUNTERED, OR AN ERROR OCCURS.                   @Y30LB37*/ 01368000
*   /*                                                               */ 01369000
*   /*****************************************************************/ 01370000
*                                                                  0597 01371000
*   OLDERID2=NEWERID2;                                             0597 01372000
         L     @04,@PC00001                                        0597 01373000
         L     @04,GDTTR2(,@04)                                    0597 01374000
         MVC   @TS00001(95),NEWERID2(@04)                          0597 01375000
         MVC   OLDERID2(95,@04),@TS00001                           0597 01376000
*   NEWID2='VS1R';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 01377000
         MVC   NEWID2(4,@04),@CC01553                              0598 01378000
*   FMT1RRC=0;                      /*                       @Y30LB37*/ 01379000
         SLR   FMT1RRC,FMT1RRC                                     0599 01380000
*   QUITSW=OFF;                     /*                       @Y30LB37*/ 01381000
*   EXPONLY=OFF;                    /*                       @Y30LB37*/ 01382000
         NI    QUITSW,B'00111111'                                  0601 01383000
*F1RDLOOP:                                                         0602 01384000
*   DO WHILE QUITSW=OFF;            /*                       @Y30LB37*/ 01385000
*                                                                  0602 01386000
F1RDLOOP B     @DE00602                                            0602 01387000
@DL00602 DS    0H                                                  0603 01388000
*     /***************************************************************/ 01389000
*     /*                                                             */ 01390000
*     /* ISSUE A UGET MACRO TO READ A FORMAT 1 DSCB. IF      @Y30LB37*/ 01391000
*     /* THE UGET IS SUCCESSFUL SET THE POINTER TO THE       @Y30LB37*/ 01392000
*     /* FORMAT 1 DSCB MAPPING MACRO. IF THE READ FAILS      @Y30LB37*/ 01393000
*     /* THEN SET THE RETURN CODE AND LOOP TERMINATION SW.   @Y30LB37*/ 01394000
*     /*                                                             */ 01395000
*     /***************************************************************/ 01396000
*                                                                  0603 01397000
*     CALL IDCIOGT0(GDTTBL,IOCSPTR);/*                       @Y30LB37*/ 01398000
         L     @04,@PC00001                                        0603 01399000
         ST    @04,@AL00001                                        0603 01400000
         LA    @03,IOCSPTR                                         0603 01401000
         ST    @03,@AL00001+4                                      0603 01402000
         MVI   @AL00001+4,X'80'                                    0603 01403000
         L     @15,GDTGET(,@04)                                    0603 01404000
         LA    @01,@AL00001                                        0603 01405000
         BALR  @14,@15                                             0603 01406000
*     RESPECIFY                                                    0604 01407000
*       RTNREG RSTD;                                               0604 01408000
*     TESTRC=RTNREG;                                               0605 01409000
         STH   RTNREG,TESTRC                                       0605 01410000
*     RESPECIFY                                                    0606 01411000
*       RTNREG UNRSTD;              /*                       @Y30LB37*/ 01412000
*     IF TESTRC=0 THEN                                             0607 01413000
         LH    @04,TESTRC                                          0607 01414000
         LTR   @04,@04                                             0607 01415000
         BNZ   @RF00607                                            0607 01416000
*       F1PTR=IOCDAD;               /*                       @Y30LB37*/ 01417000
         L     @03,IOCSPTR                                         0608 01418000
         L     F1PTR,IOCDAD(,@03)                                  0608 01419000
*     ELSE                                                         0609 01420000
*       DO;                         /*                       @Y30LB37*/ 01421000
         B     @RC00607                                            0609 01422000
@RF00607 DS    0H                                                  0610 01423000
*         QUITSW=ON;                /*                       @Y30LB37*/ 01424000
         OI    QUITSW,B'01000000'                                  0610 01425000
*         FMT1RRC=TESTRC;           /*                       @Y30LB37*/ 01426000
         LH    FMT1RRC,TESTRC                                      0611 01427000
*       END;                        /*                       @Y30LB37*/ 01428000
*                                                                  0613 01429000
*     /***************************************************************/ 01430000
*     /*                                                             */ 01431000
*     /* IF THE READ IS SUCCESSFUL AND THE RECORD READ IS    @Y30LB37*/ 01432000
*     /* A FORMAT 1 DSCB, THEN DETERMINE IF THE RECORD READ  @Y30LB37*/ 01433000
*     /* MEETS THE ORGANIZATION TYPE SPECIFIED BY THE        @Y30LB37*/ 01434000
*     /* CALLER.                                             @Y30LB37*/ 01435000
*     /*                                                             */ 01436000
*     /***************************************************************/ 01437000
*                                                                  0613 01438000
*     IF FMT1RRC=0&DS1FMTID=FORMAT1R THEN                          0613 01439000
@RC00607 LTR   FMT1RRC,FMT1RRC                                     0613 01440000
         BNZ   @RF00613                                            0613 01441000
         CLC   DS1FMTID(1,F1PTR),FORMAT1R                          0613 01442000
         BNE   @RF00613                                            0613 01443000
*       DO;                         /*                       @Y30LB37*/ 01444000
*         IF ORGTYPE=ORGTNONV&DSORGAM=OFF|ORGTYPE^=ORGTNONV THEN   0615 01445000
         L     @04,@PC00006                                        0615 01446000
         CLC   ORGTYPE(4,@04),ORGTNONV                             0615 01447000
         BNE   @GL00003                                            0615 01448000
         TM    DSORGAM(F1PTR),B'00001000'                          0615 01449000
         BZ    @RT00615                                            0615 01450000
@GL00003 L     @04,@PC00006                                        0615 01451000
         CLC   ORGTYPE(4,@04),ORGTNONV                             0615 01452000
         BE    @RF00615                                            0615 01453000
@RT00615 DS    0H                                                  0616 01454000
*           DO;                     /*                       @Y30LB37*/ 01455000
*                                                                  0616 01456000
*             /*******************************************************/ 01457000
*             /*                                                     */ 01458000
*             /* IF PROTTYPE IS 'READ' THEN TEST DS1DSIND    @Y30LB37*/ 01459000
*             /* EITHER FOR THE RACF PROTECTION BIT TO BE ON @G24LB31*/ 01460000
*             /* OR FOR THE PASSWORD PROTECTION BIT TO BE ON @G24LB31*/ 01461000
*             /* AND THE READ WITHOUT PASSWORD PROTECT BIT   @Y30LB37*/ 01462000
*             /* TO BE OFF INDICATING READ PROTECTION. IF    @Y30LB37*/ 01463000
*             /* READ PROTECTED RETURN THE RECORD TO THE     @Y30LB37*/ 01464000
*             /* CALLER, IF NOT READ ANOTHER FORMAT 1.       @Y30LB37*/ 01465000
*             /*                                                     */ 01466000
*             /*******************************************************/ 01467000
*                                                                  0617 01468000
*             IF PROTTYPE=PROTREAD THEN                            0617 01469000
         L     @04,@PC00006+4                                      0617 01470000
         CLC   PROTTYPE(8,@04),PROTREAD                            0617 01471000
         BNE   @RF00617                                            0617 01472000
*               IF(PASSPROT=ON&READOK=OFF)|/*                @G24LB31*/ 01473000
*                   PROTRACF=ON THEN/*                       @G24LB31*/ 01474000
         TM    PASSPROT(F1PTR),B'00010000'                         0618 01475000
         BNO   @GL00005                                            0618 01476000
         TM    READOK(F1PTR),B'00000100'                           0618 01477000
         BZ    @RT00618                                            0618 01478000
@GL00005 TM    PROTRACF(F1PTR),B'01000000'                         0618 01479000
         BNO   @RF00618                                            0618 01480000
@RT00618 DS    0H                                                  0619 01481000
*                 QUITSW=ON;        /*                       @G24LB31*/ 01482000
*                                                                  0619 01483000
         OI    QUITSW,B'01000000'                                  0619 01484000
*             /*******************************************************/ 01485000
*             /*                                                     */ 01486000
*             /* IF PROTTYPE IS 'WRITE' THEN TEST IF THE     @Y30LB37*/ 01487000
*             /* DS1DSIND RACF PROTECTION BIT IS ON OR THE   @G24LB31*/ 01488000
*             /* DS1DSIND PASSWORD PROTECTION BIT IS         @Y30LB37*/ 01489000
*             /* ON INDICATING READ PROTECTION AND           @Y30LB37*/ 01490000
*             /* WRITE PROTECTION. THE READ WITHOUT          @Y30LB37*/ 01491000
*             /* PASSWORD PROTECTION BIT CAN BE IGNORED.     @Y30LB37*/ 01492000
*             /* IF BOTH PROTECTED RETURN THE RECORD TO THE  @Y30LB37*/ 01493000
*             /* CALLER, IF NOT THEN CHECK THE EXPIRATION    @Y30LB37*/ 01494000
*             /* DATE.                                       @Y30LB37*/ 01495000
*             /*                                                     */ 01496000
*             /*******************************************************/ 01497000
*                                                                  0620 01498000
*             IF PROTTYPE=PROTRITE THEN                            0620 01499000
@RF00618 DS    0H                                                  0620 01500000
@RF00617 L     @04,@PC00006+4                                      0620 01501000
         CLC   PROTTYPE(8,@04),PROTRITE                            0620 01502000
         BNE   @RF00620                                            0620 01503000
*               IF PASSPROT=ON|PROTRACF=ON THEN/*            @G24LB31*/ 01504000
         TM    PASSPROT(F1PTR),B'01010000'                         0621 01505000
         BZ    @RF00621                                            0621 01506000
*                 QUITSW=ON;        /*                       @Y30LB37*/ 01507000
         OI    QUITSW,B'01000000'                                  0622 01508000
*               ELSE                                               0623 01509000
*                 IF DS1EXPDT^=ZEROEXP THEN                        0623 01510000
         B     @RC00621                                            0623 01511000
@RF00621 CLC   DS1EXPDT(3,F1PTR),ZEROEXP                           0623 01512000
         BE    @RF00623                                            0623 01513000
*                   DO;             /*                       @Y30LB37*/ 01514000
*                                                                  0625 01515000
*                     /***********************************************/ 01516000
*                     /*                                             */ 01517000
*                     /* ISSUE A UTIME MACRO TO GET THE      @Y30LB37*/ 01518000
*                     /* CURRENT TIME AND DATE. CONVERT      @Y30LB37*/ 01519000
*                     /* THE DATE TO BINARY AND DIVIDE BY    @Y30LB37*/ 01520000
*                     /* 1000 AND THEN DETERMINE IF THE      @Y30LB37*/ 01521000
*                     /* DATE ON THE FORMAT 1 HAS EXPIRED.   @Y30LB37*/ 01522000
*                     /* IF IT HASN'T EXPIRED, SET THE       @Y30LB37*/ 01523000
*                     /* EXPONLY SWITCH ON AND RETURN THE    @Y30LB37*/ 01524000
*                     /* RECORD TO THE CALLER.               @Y30LB37*/ 01525000
*                     /*                                             */ 01526000
*                     /***********************************************/ 01527000
*                                                                  0625 01528000
*                     EXPDWORK=DS1EXPDT;/*                   @Y30LB37*/ 01529000
         MVC   EXPDWORK(3),DS1EXPDT(F1PTR)                         0625 01530000
*                     CALL IDCSATI0(GDTTBL,F1TIME,F1DATE);/* @Y30LB37*/ 01531000
         L     @04,@PC00001                                        0626 01532000
         ST    @04,@AL00001                                        0626 01533000
         LA    @03,F1TIME                                          0626 01534000
         ST    @03,@AL00001+4                                      0626 01535000
         LA    @03,F1DATE                                          0626 01536000
         ST    @03,@AL00001+8                                      0626 01537000
         MVI   @AL00001+8,X'80'                                    0626 01538000
         L     @15,GDTTIM(,@04)                                    0626 01539000
         LA    @01,@AL00001                                        0626 01540000
         BALR  @14,@15                                             0626 01541000
*                     CVB(DATEWORK,F1DATE);/*                @Y30LB37*/ 01542000
         XC    @TS00001(8),@TS00001                                0627 01543000
         MVC   @TS00001+4(4),F1DATE                                0627 01544000
         CVB   @04,@TS00001                                        0627 01545000
         ST    @04,DATEWORK                                        0627 01546000
*                     DATEWORK=DATEWORK/BIN1000;/*           @Y30LB37*/ 01547000
         LR    @01,@04                                             0628 01548000
         SLR   @00,@00                                             0628 01549000
         D     @00,@CF01552                                        0628 01550000
         ST    @01,DATEWORK                                        0628 01551000
*                     IF DAWKYEAR<EXPYEAR THEN                     0629 01552000
         CLC   DAWKYEAR(1),EXPYEAR                                 0629 01553000
         BNL   @RF00629                                            0629 01554000
*                       DO;         /*                       @Y30LB37*/ 01555000
*                         EXPONLY=ON;/*                      @Y30LB37*/ 01556000
*                         QUITSW=ON;/*                       @Y30LB37*/ 01557000
         OI    EXPONLY,B'11000000'                                 0632 01558000
*                       END;        /*                       @Y30LB37*/ 01559000
*                     ELSE                                         0634 01560000
*                       IF DAWKYEAR=EXPYEAR THEN                   0634 01561000
         B     @RC00629                                            0634 01562000
@RF00629 CLC   DAWKYEAR(1),EXPYEAR                                 0634 01563000
         BNE   @RF00634                                            0634 01564000
*                         IF DAWKDAY<EXPDAY THEN                   0635 01565000
         CLC   DAWKDAY(2),EXPDAY                                   0635 01566000
         BNL   @RF00635                                            0635 01567000
*                           DO;     /*                       @Y30LB37*/ 01568000
*                             EXPONLY=ON;/*                  @Y30LB37*/ 01569000
*                             QUITSW=ON;/*                   @Y30LB37*/ 01570000
         OI    EXPONLY,B'11000000'                                 0638 01571000
*                           END;    /*                       @Y30LB37*/ 01572000
*                   END;            /*                       @Y30LB37*/ 01573000
*                                                                  0640 01574000
@RF00635 DS    0H                                                  0640 01575000
@RF00634 DS    0H                                                  0640 01576000
@RC00629 DS    0H                                                  0641 01577000
*             /*******************************************************/ 01578000
*             /*                                                     */ 01579000
*             /* IF 'ALL' SPECIFIED RETURN THE RECORD TO     @Y30LB37*/ 01580000
*             /* THE CALLER, IF NOT READ ANOTHER FORMAT 1.   @Y30LB37*/ 01581000
*             /*                                                     */ 01582000
*             /*******************************************************/ 01583000
*                                                                  0641 01584000
*             IF PROTTYPE=PROTTALL THEN                            0641 01585000
@RF00623 DS    0H                                                  0641 01586000
@RC00621 DS    0H                                                  0641 01587000
@RF00620 L     @04,@PC00006+4                                      0641 01588000
         CLC   PROTTYPE(8,@04),PROTTALL                            0641 01589000
         BNE   @RF00641                                            0641 01590000
*               QUITSW=ON;          /*                       @Y30LB37*/ 01591000
         OI    QUITSW,B'01000000'                                  0642 01592000
*           END;                    /*                       @Y30LB37*/ 01593000
@RF00641 DS    0H                                                  0644 01594000
*       END;                        /*                       @Y30LB37*/ 01595000
@RF00615 DS    0H                                                  0645 01596000
*   END F1RDLOOP;                   /*                       @Y30LB37*/ 01597000
@RF00613 DS    0H                                                  0645 01598000
@DE00602 TM    QUITSW,B'01000000'                                  0645 01599000
         BZ    @DL00602                                            0645 01600000
*   IF FMT1RRC=16 THEN                                             0646 01601000
         C     FMT1RRC,@CF00509                                    0646 01602000
         BNE   @RF00646                                            0646 01603000
*     FMT1RRC=RCEOFILE;             /* CHANGE RC 16 TO AN 8  @Y30LB37*/ 01604000
         LA    FMT1RRC,8                                           0647 01605000
*   RETURN CODE(FMT1RRC);           /* RETURN TO MAIN ROUTINE      0648 01606000
*                                                            @Y30LB37*/ 01607000
@RF00646 LR    @15,FMT1RRC                                         0648 01608000
         L     @14,@SA00006                                        0648 01609000
         LM    @00,@04,@SA00006+8                                  0648 01610000
         LM    @06,@12,@SA00006+28                                 0648 01611000
         BR    @14                                                 0648 01612000
*   END FMT1READ;                   /* END OF FMT1READ PROC  @Y30LB37*/ 01613000
*                                                                  0650 01614000
*/********************************************************************/ 01615000
*/*                                                                  */ 01616000
*/*  PROCEDURE NAME - RECATLOG                               @Y30LB37*/ 01617000
*/*                                                          @Y30LB37*/ 01618000
*/*  FUNCTION - THIS PROCEDURE RECATALOGS NON-VSAM DATA SETS @Y30LB37*/ 01619000
*/*             INTO THE CATALOG.  RECATLOG CALLS            @Y30LB37*/ 01620000
*/*             SUBORDINATE ROUTINES VTOCOPEN, FMT4READ,     @Y30LB37*/ 01621000
*/*             AND SUBORDINATE ROUTINE FMT1READ TO OPEN     @Y30LB37*/ 01622000
*/*             THE VTOC AND READ THE FORMAT 1 DSCBS.        @Y30LB37*/ 01623000
*/*             PRINTS MESSAGES IDC2966I OR IDC2967I IF AN   @Y30LB37*/ 01624000
*/*             ERROR OCCURS RECATALOGING.                   @Y30LB37*/ 01625000
*/*                                                          @Y30LB37*/ 01626000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 01627000
*/*          LIST:  FIELDS VSIOP, VSDEVICE, VSSERIAL,        @Y30LB37*/ 01628000
*/*          VSDEVP, AND VSSERP.                             @Y30LB37*/ 01629000
*/*                                                          @Y30LB37*/ 01630000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       @Y30LB37*/ 01631000
*/*          OR FOUR ERROR CODE.                             @Y30LB37*/ 01632000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 01633000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 01634000
*/*          4 - VTOC OPEN WAS UNSUCCESSFUL                  @Y30LB37*/ 01635000
*/*              VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 01636000
*/*              ERROR RECATALOGING A DATA SET               @Y30LB37*/ 01637000
*/*              ERROR RETRIEVING UCB ADDRESS                @Y30LB37*/ 01638000
*/*              ERROR RESERVING VOLUME                      @Y30LB37*/ 01639000
*/*                                                                  */ 01640000
*/********************************************************************/ 01641000
*                                                                  0650 01642000
*RECATLOG:                                                         0650 01643000
*   PROCEDURE;                      /*                       @Y30LB37*/ 01644000
*                                                                  0650 01645000
RECATLOG STM   @14,@12,@SA00007                                    0650 01646000
*   /*****************************************************************/ 01647000
*   /*                                                               */ 01648000
*   /* LOCAL DECLARATIONS FOR RECATLOG                       @Y30LB37*/ 01649000
*   /*                                                               */ 01650000
*   /*****************************************************************/ 01651000
*                                                                  0651 01652000
*   DCL                                                            0651 01653000
*     RECATRC FIXED(15);            /* RECATLOG RETURN CODE  @Y30LB37*/ 01654000
*   DCL                                                            0652 01655000
*     CATCOUNT FIXED(31);           /* NUM DS RECATALOGED    @Y30LB37*/ 01656000
*   DCL                                                            0653 01657000
*     RECATARG CHAR(LENGTH(RCTAGL)) /* RCTAGL GOTTEN         @Y30LB37*/ 01658000
*         BDY(WORD);                /* AREA                  @Y30LB37*/ 01659000
*                                                                  0654 01660000
*   /*****************************************************************/ 01661000
*   /*                                                               */ 01662000
*   /*                                                       @Y30LB37*/ 01663000
*   /* CALL THE VTOCOPEN PROCEDURE TO OPEN THE VTOC          @Y30LB37*/ 01664000
*   /* IF IT IS NOT ALREADY OPEN (VSIOP IS ZERO).            @Y30LB37*/ 01665000
*   /* VTOCOPEN SETS THE VSIOP FIELD. IF VTOCOPEN IS         @Y30LB37*/ 01666000
*   /* UNSUCCESSFUL THEN SET VTOCGRC TO FOUR.                @Y30LB37*/ 01667000
*   /*                                                       @Y30LB37*/ 01668000
*   /*                                                               */ 01669000
*   /*****************************************************************/ 01670000
*                                                                  0654 01671000
*   RFY                                                            0654 01672000
*     RCTAGL BASED(ADDR(RECATARG)); /*                       @Y30LB37*/ 01673000
*   OLDERID2=NEWERID2;                                             0655 01674000
         L     @03,@PC00001                                        0655 01675000
         L     @03,GDTTR2(,@03)                                    0655 01676000
         MVC   @TS00001(95),NEWERID2(@03)                          0655 01677000
         MVC   OLDERID2(95,@03),@TS00001                           0655 01678000
*   NEWID2='VSRC';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 01679000
         MVC   NEWID2(4,@03),@CC01565                              0656 01680000
*   RECATSW=ON;                     /*                       @Y30LB37*/ 01681000
         OI    RECATSW,B'00001000'                                 0657 01682000
*   RECATRC=0;                      /*                       @Y30LB37*/ 01683000
         SLR   @15,@15                                             0658 01684000
         LR    RECATRC,@15                                         0658 01685000
*   CATCOUNT=0;                     /*                       @Y30LB37*/ 01686000
         ST    @15,CATCOUNT                                        0659 01687000
*   IF VSIOP=NULLPTR THEN                                          0660 01688000
         C     @15,VSIOP(,ARGLPTR)                                 0660 01689000
         BNE   @RF00660                                            0660 01690000
*     DO;                           /*                       @Y30LB37*/ 01691000
*       CALL VTOCOPEN;              /*                       @Y30LB37*/ 01692000
         BAL   @14,VTOCOPEN                                        0662 01693000
*       RESPECIFY                                                  0663 01694000
*         RTNREG RSTD;                                             0663 01695000
*       TESTRC=RTNREG;                                             0664 01696000
         STH   RTNREG,TESTRC                                       0664 01697000
*       RESPECIFY                                                  0665 01698000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 01699000
*       IF TESTRC^=0 THEN                                          0666 01700000
         LH    @03,TESTRC                                          0666 01701000
         LTR   @03,@03                                             0666 01702000
         BZ    @RF00666                                            0666 01703000
*         DO;                       /*                       @Y30LB37*/ 01704000
*           RECATSW=OFF;            /*                       @Y30LB37*/ 01705000
         NI    RECATSW,B'11110111'                                 0668 01706000
*           RECATRC=4;              /*                       @Y30LB37*/ 01707000
         LA    RECATRC,4                                           0669 01708000
*         END;                      /*                       @Y30LB37*/ 01709000
*     END;                          /*                       @Y30LB37*/ 01710000
*                                                                  0672 01711000
*   /*****************************************************************/ 01712000
*   /*                                                               */ 01713000
*   /* IF VTOCOPEN WAS NOT CALLED INSERT THE ADDRESS OF      @Y30LB37*/ 01714000
*   /* THE IOCSTR FROM THE VS1AGL AND CALL FMT4READ TO       @Y30LB37*/ 01715000
*   /* POSITION TO THE BEGINNING OF THE VTOC. IF FMT4READ    @Y30LB37*/ 01716000
*   /* IS UNSUCCESSFUL THEN SET RECATRC TO RCFAIL.           @Y30LB37*/ 01717000
*   /*                                                               */ 01718000
*   /*****************************************************************/ 01719000
*                                                                  0672 01720000
*   ELSE                                                           0672 01721000
*     DO;                           /*                       @Y30LB37*/ 01722000
         B     @RC00660                                            0672 01723000
@RF00660 DS    0H                                                  0673 01724000
*       IOCSPTR=VSIOP;              /*                       @Y30LB37*/ 01725000
         L     @03,VSIOP(,ARGLPTR)                                 0673 01726000
         ST    @03,IOCSPTR                                         0673 01727000
*       CALL FMT4READ;              /*                       @Y30LB37*/ 01728000
         BAL   @14,FMT4READ                                        0674 01729000
*       RESPECIFY                                                  0675 01730000
*         RTNREG RSTD;                                             0675 01731000
*       TESTRC=RTNREG;                                             0676 01732000
         STH   RTNREG,TESTRC                                       0676 01733000
*       RESPECIFY                                                  0677 01734000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 01735000
*       IF TESTRC^=0 THEN                                          0678 01736000
         LH    @03,TESTRC                                          0678 01737000
         LTR   @03,@03                                             0678 01738000
         BZ    @RF00678                                            0678 01739000
*         DO;                       /*                       @Y30LB37*/ 01740000
*           RECATSW=OFF;            /*                       @Y30LB37*/ 01741000
         NI    RECATSW,B'11110111'                                 0680 01742000
*           RECATRC=4;              /*                       @Y30LB37*/ 01743000
         LA    RECATRC,4                                           0681 01744000
*         END;                      /*                       @Y30LB37*/ 01745000
*     END;                          /*                       @Y30LB37*/ 01746000
@RF00678 DS    0H                                                  0684 01747000
*                                                                  0684 01748000
*   /*****************************************************************/ 01749000
*   /*                                                               */ 01750000
*   /* EXECUTE RCATLOOP UNTIL END OF FILE IS DETECTED OR AN  @Y30LB37*/ 01751000
*   /* ERROR IS ENCOUNTERED READING THE VTOC.                @Y30LB37*/ 01752000
*   /*                                                               */ 01753000
*   /*****************************************************************/ 01754000
*                                                                  0684 01755000
*RCATLOOP:                                                         0684 01756000
*   DO WHILE RECATSW=ON;            /*                       @Y30LB37*/ 01757000
*                                                                  0684 01758000
@RC00660 DS    0H                                                  0684 01759000
RCATLOOP B     @DE00684                                            0684 01760000
@DL00684 DS    0H                                                  0685 01761000
*     /***************************************************************/ 01762000
*     /*                                                             */ 01763000
*     /* CALL THE FMT1READ PROCEDURE WITH ORGTYPE SET TO     @Y30LB37*/ 01764000
*     /* 'NONV' AND PROTTYPE SET TO 'ALL'. IF AN ERROR       @Y30LB37*/ 01765000
*     /* OR END OF FILE OCCURS THEN SET RECATSW OFF AND      @Y30LB37*/ 01766000
*     /* SET RETURN CODE ACCORDING TO THAT RETURNED BY       @Y30LB37*/ 01767000
*     /* FMT1READ.                                           @Y30LB37*/ 01768000
*     /*                                                             */ 01769000
*     /***************************************************************/ 01770000
*                                                                  0685 01771000
*     CALL FMT1READ(ORGTNONV,PROTTALL);/*                    @Y30LB37*/ 01772000
         LA    @01,@AL00685                                        0685 01773000
         BAL   @14,FMT1READ                                        0685 01774000
*     RESPECIFY                                                    0686 01775000
*       RTNREG RSTD;                                               0686 01776000
*     TESTRC=RTNREG;                                               0687 01777000
         STH   RTNREG,TESTRC                                       0687 01778000
*     RESPECIFY                                                    0688 01779000
*       RTNREG UNRSTD;              /*                       @Y30LB37*/ 01780000
*     IF TESTRC^=0 THEN                                            0689 01781000
         LH    @03,TESTRC                                          0689 01782000
         LTR   @03,@03                                             0689 01783000
         BZ    @RF00689                                            0689 01784000
*       DO;                         /*                       @Y30LB37*/ 01785000
*         RECATSW=OFF;              /*                       @Y30LB37*/ 01786000
         NI    RECATSW,B'11110111'                                 0691 01787000
*         IF RECATRC^=4 THEN        /*                       @ZM00977*/ 01788000
         C     RECATRC,@CF00046                                    0692 01789000
         BE    @RF00692                                            0692 01790000
*           RECATRC=TESTRC;         /*                       @Y30LB37*/ 01791000
         LR    RECATRC,@03                                         0693 01792000
*       END;                        /*                       @Y30LB37*/ 01793000
*                                                                  0695 01794000
*     /***************************************************************/ 01795000
*     /*                                                             */ 01796000
*     /* IF A FORMAT 1 DSCB WAS RETURNED, RECATALOG IT.      @Y30LB37*/ 01797000
*     /*                                                             */ 01798000
*     /***************************************************************/ 01799000
*                                                                  0695 01800000
*     ELSE                                                         0695 01801000
*       DO;                         /*                       @Y30LB37*/ 01802000
*                                                                  0695 01803000
         B     @RC00689                                            0695 01804000
@RF00689 DS    0H                                                  0696 01805000
*         /***********************************************************/ 01806000
*         /*                                                         */ 01807000
*         /* ISSUE URECAT MACRO TO RECATALOG THE DATA        @Y30LB37*/ 01808000
*         /* SET. IF VSDEVICE FLAG IS ON THEN RETRIEVE       @Y30LB37*/ 01809000
*         /* THE NEW DEVICE TYPE POINTED TO BY THE VSDEVP    @Y30LB37*/ 01810000
*         /* FIELD. IF VSSERIAL FLAG IS ON THEN RETRIEVE     @Y30LB37*/ 01811000
*         /* THE NEW VOLUME SERIAL POINTED TO BY THE VSSERP  @Y30LB37*/ 01812000
*         /* FIELD. CONTINUE ON IF AN ERROR OR NOT.          @Y30LB37*/ 01813000
*         /*                                                         */ 01814000
*         /***********************************************************/ 01815000
*                                                                  0696 01816000
*         RECATARG=''B;             /*                       @Y30LB37*/ 01817000
         XC    RECATARG(76),RECATARG                               0696 01818000
*         RCTDSET=DS1DSNAM;         /*                       @Y30LB37*/ 01819000
         LA    @03,RECATARG                                        0697 01820000
         MVC   RCTDSET(44,@03),DS1DSNAM(F1PTR)                     0697 01821000
*         RCTODEV=VSODEVP->V1DEVA;  /*                       @Y30LB37*/ 01822000
         L     @01,VSODEVP(,ARGLPTR)                               0698 01823000
         MVC   RCTODEV(4,@03),V1DEVA(@01)                          0698 01824000
*         RCTOVOL=VSOSERP->V1VOLA;  /*                       @Y30LB37*/ 01825000
         L     @01,VSOSERP(,ARGLPTR)                               0699 01826000
         MVC   RCTOVOL(6,@03),V1VOLA(@01)                          0699 01827000
*         IF VSDEVICE=ON THEN                                      0700 01828000
         TM    VSDEVICE(ARGLPTR),B'10000000'                       0700 01829000
         BNO   @RF00700                                            0700 01830000
*           DO;                     /*                       @Y30LB37*/ 01831000
*             RCTDEV=ON;            /*                       @Y30LB37*/ 01832000
         OI    RCTDEV(@03),B'10000000'                             0702 01833000
*             RCTNDEV=V1DEVA;       /*                       @Y30LB37*/ 01834000
         L     @01,VSDEVP(,ARGLPTR)                                0703 01835000
         MVC   RCTNDEV(4,@03),V1DEVA(@01)                          0703 01836000
*           END;                    /*                       @Y30LB37*/ 01837000
*         IF VSSERIAL=ON THEN                                      0705 01838000
@RF00700 TM    VSSERIAL(ARGLPTR),B'01000000'                       0705 01839000
         BNO   @RF00705                                            0705 01840000
*           DO;                     /*                       @Y30LB37*/ 01841000
*             RCTVOL=ON;            /*                       @Y30LB37*/ 01842000
         LA    @03,RECATARG                                        0707 01843000
         OI    RCTVOL(@03),B'01000000'                             0707 01844000
*             RCTNVOL=VSSERP->V1VOLA;/*                      @Y30LB37*/ 01845000
         L     @01,VSSERP(,ARGLPTR)                                0708 01846000
         MVC   RCTNVOL(6,@03),V1VOLA(@01)                          0708 01847000
*           END;                    /*                       @Y30LB37*/ 01848000
*         CALL IDCSARC0(GDTTBL,RCTAGL);/*                    @Y30LB37*/ 01849000
@RF00705 L     @03,@PC00001                                        0710 01850000
         ST    @03,@AL00001                                        0710 01851000
         LA    @15,RECATARG                                        0710 01852000
         ST    @15,@AL00001+4                                      0710 01853000
         MVI   @AL00001+4,X'80'                                    0710 01854000
         L     @15,GDTRCT(,@03)                                    0710 01855000
         LA    @01,@AL00001                                        0710 01856000
         BALR  @14,@15                                             0710 01857000
*         RESPECIFY                                                0711 01858000
*           RTNREG RSTD;                                           0711 01859000
*         TESTRC=RTNREG;                                           0712 01860000
         STH   RTNREG,TESTRC                                       0712 01861000
*         RESPECIFY                                                0713 01862000
*           RTNREG UNRSTD;          /*                       @Y30LB37*/ 01863000
*                                                                  0714 01864000
*         /***********************************************************/ 01865000
*         /*                                                         */ 01866000
*         /* IF THE DATA SET WAS RECATALOGED SUCCESSFULLY    @Y30LB37*/ 01867000
*         /* ISSUE UPRINT TO PRINT THE DATA SET NAME MSG.    @Y30LB37*/ 01868000
*         /* IF THE VSLIST FLAG IS SPECIFIED IN THE VS1AGL.  @Y30LB37*/ 01869000
*         /* INCREMENT THE COUNT OF DATA SETS RECATALOGED.   @Y30LB37*/ 01870000
*         /*                                                         */ 01871000
*         /***********************************************************/ 01872000
*                                                                  0714 01873000
*         IF TESTRC=0 THEN                                         0714 01874000
         LH    @03,TESTRC                                          0714 01875000
         LTR   @03,@03                                             0714 01876000
         BNZ   @RF00714                                            0714 01877000
*           DO;                     /*                       @ZM00977*/ 01878000
*             CATCOUNT=CATCOUNT+ONE;/*                       @ZM00977*/ 01879000
         LA    @03,1                                               0716 01880000
         AL    @03,CATCOUNT                                        0716 01881000
         ST    @03,CATCOUNT                                        0716 01882000
*             IF VSLIST=ON THEN                                    0717 01883000
         TM    VSLIST(ARGLPTR),B'00100000'                         0717 01884000
         BNO   @RF00717                                            0717 01885000
*               DO;                 /*                       @ZM00977*/ 01886000
*                 PRINTARG=''B;     /*                       @Y30LB37*/ 01887000
         XC    PRINTARG(44),PRINTARG                               0719 01888000
*                 DARGSMOD=MSGMODID;/*                       @Y30LB37*/ 01889000
         L     @03,DDSTRU                                          0720 01890000
         MVC   DARGSMOD(3,@03),@CC01408                            0720 01891000
*                 DARGSENT=MSGRECAT;/*                       @Y30LB37*/ 01892000
         MVI   DARGSENT(@03),X'09'                                 0721 01893000
*                 DARGDBP=ADDR(DS1DSNAM);/*                  @Y30LB37*/ 01894000
         ST    F1PTR,DARGDBP(,@03)                                 0722 01895000
*                 DARGILP=LENGTH(DS1DSNAM);/*                @Y30LB37*/ 01896000
         MVC   DARGILP(2,@03),@CH00849                             0723 01897000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB37*/ 01898000
         L     @03,@PC00001                                        0724 01899000
         ST    @03,@AL00001                                        0724 01900000
         LA    @15,@CF00120                                        0724 01901000
         ST    @15,@AL00001+4                                      0724 01902000
         LA    @15,DDSTRU                                          0724 01903000
         ST    @15,@AL00001+8                                      0724 01904000
         MVI   @AL00001+8,X'80'                                    0724 01905000
         L     @15,GDTPRT(,@03)                                    0724 01906000
         LA    @01,@AL00001                                        0724 01907000
         BALR  @14,@15                                             0724 01908000
*               END;                /*                       @Y30LB37*/ 01909000
*           END;                    /*                       @ZM00977*/ 01910000
*                                                                  0726 01911000
*         /***********************************************************/ 01912000
*         /*                                                         */ 01913000
*         /* IF AN ERROR OCCURRED RECATALOGING THE DATA SET  @Y30LB37*/ 01914000
*         /* THEN, SET THE RETURN CODE TO THAT RETURNED.     @Y30LB37*/ 01915000
*         /*                                                         */ 01916000
*         /***********************************************************/ 01917000
*                                                                  0727 01918000
*         ELSE                                                     0727 01919000
*           IF TESTRC=4 THEN                                       0727 01920000
         B     @RC00714                                            0727 01921000
@RF00714 LH    @03,TESTRC                                          0727 01922000
         C     @03,@CF00046                                        0727 01923000
         BNE   @RF00727                                            0727 01924000
*             RECATRC=TESTRC;       /*                       @Y30LB37*/ 01925000
         LR    RECATRC,@03                                         0728 01926000
*       END;                        /*                       @Y30LB37*/ 01927000
@RF00727 DS    0H                                                  0729 01928000
@RC00714 DS    0H                                                  0730 01929000
*   END RCATLOOP;                   /*                       @Y30LB37*/ 01930000
@RC00689 DS    0H                                                  0730 01931000
@DE00684 TM    RECATSW,B'00001000'                                 0730 01932000
         BO    @DL00684                                            0730 01933000
*                                                                  0731 01934000
*   /*****************************************************************/ 01935000
*   /*                                                               */ 01936000
*   /* IF END OF FILE RETURN CODE THEN SET RETURN CODE TO    @Y30LB37*/ 01937000
*   /* ZERO. ISSUE ERROR MESSAGE IDC2966I IF RETURN CODE     @Y30LB37*/ 01938000
*   /* FOUR AND RECATALOG COUNT IS ZEROS. ISSUE ERROR        @Y30LB37*/ 01939000
*   /* MESSAGE IDC2967I IF RETURN CODE IS FOUR AND RECAT-    @Y30LB37*/ 01940000
*   /* ALOG COUNT IS NOT ZEROS INDICATING SOME WERE RE-      @Y30LB37*/ 01941000
*   /* CATALOGED BEFORE AN ERROR OCCURRED.                   @Y30LB37*/ 01942000
*   /*                                                               */ 01943000
*   /*****************************************************************/ 01944000
*                                                                  0731 01945000
*   IF RECATRC=RCEOFILE THEN                                       0731 01946000
         C     RECATRC,@CF00040                                    0731 01947000
         BNE   @RF00731                                            0731 01948000
*     RECATRC=0;                    /*                       @Y30LB37*/ 01949000
         SLR   RECATRC,RECATRC                                     0732 01950000
*   IF RECATRC=4 THEN                                              0733 01951000
@RF00731 C     RECATRC,@CF00046                                    0733 01952000
         BNE   @RF00733                                            0733 01953000
*     DO;                           /*                       @Y30LB37*/ 01954000
*       PRINTARG=''B;               /*                       @Y30LB37*/ 01955000
         XC    PRINTARG(44),PRINTARG                               0735 01956000
*       IF CATCOUNT=0 THEN                                         0736 01957000
         L     @03,CATCOUNT                                        0736 01958000
         LTR   @03,@03                                             0736 01959000
         BNZ   @RF00736                                            0736 01960000
*         DARGSENT=MSG2966I;        /*                       @Y30LB37*/ 01961000
         L     @03,DDSTRU                                          0737 01962000
         MVI   DARGSENT(@03),X'08'                                 0737 01963000
*       ELSE                                                       0738 01964000
*         DARGSENT=MSG2967I;        /*                       @Y30LB37*/ 01965000
         B     @RC00736                                            0738 01966000
@RF00736 L     @03,DDSTRU                                          0738 01967000
         MVI   DARGSENT(@03),X'0A'                                 0738 01968000
*       DARGSMOD=MSGMODID;          /*                       @Y30LB37*/ 01969000
@RC00736 L     @03,DDSTRU                                          0739 01970000
         MVC   DARGSMOD(3,@03),@CC01408                            0739 01971000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB37*/ 01972000
         L     @03,@PC00001                                        0740 01973000
         ST    @03,@AL00001                                        0740 01974000
         LA    @15,@CF00120                                        0740 01975000
         ST    @15,@AL00001+4                                      0740 01976000
         LA    @15,DDSTRU                                          0740 01977000
         ST    @15,@AL00001+8                                      0740 01978000
         MVI   @AL00001+8,X'80'                                    0740 01979000
         L     @15,GDTPRT(,@03)                                    0740 01980000
         LA    @01,@AL00001                                        0740 01981000
         BALR  @14,@15                                             0740 01982000
*     END;                          /*                       @Y30LB37*/ 01983000
*   RETURN CODE(RECATRC);           /* RETURN TO MAIN ROUTINE      0742 01984000
*                                                            @Y30LB37*/ 01985000
@RF00733 LR    @15,RECATRC                                         0742 01986000
         L     @14,@SA00007                                        0742 01987000
         LM    @00,@12,@SA00007+8                                  0742 01988000
         BR    @14                                                 0742 01989000
*   END RECATLOG;                   /* END OF RECATLOG PROC  @Y30LB37*/ 01990000
*                                                                  0744 01991000
*/********************************************************************/ 01992000
*/*                                                                  */ 01993000
*/*  PROCEDURE NAME - SCRATCH                                @Y30LB37*/ 01994000
*/*                                                          @Y30LB37*/ 01995000
*/*  FUNCTION - THIS PROCEDURE SETS THE VSAM OWNERSHIP BIT   @Y30LB37*/ 01996000
*/*             OFF IN THE FORMAT 4 DSCB AND SCRATCHES THE   @Y30LB37*/ 01997000
*/*             NON-VSAM DATA SETS AND VSAM DATA SPACES      @Y30LB37*/ 01998000
*/*             REPRESENTED BY THE FORMAT 1 DSCB'S.          @Y30LB37*/ 01999000
*/*             SCRATCH CALLS SUBORDINATE ROUTINES           @Y30LB37*/ 02000000
*/*             VTOCOPEN, FMT4SCR, AND FMT1SCR TO SCRATCH    @Y30LB37*/ 02001000
*/*             THE FORMAT 4 AND FORMAT 1 DSCBS.  PRINTS     @Y30LB37*/ 02002000
*/*             MESSAGES IDC2964I OR IDC2965I, IF AN ERROR   @Y30LB37*/ 02003000
*/*             OCCURS SCRATCHING THE VTOC.                  @Y30LB37*/ 02004000
*/*                                                          @Y30LB37*/ 02005000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 02006000
*/*          LIST:  FIELD VSIOP.                             @Y30LB37*/ 02007000
*/*                                                          @Y30LB37*/ 02008000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       @Y30LB37*/ 02009000
*/*          OR FOUR ERROR CODE.                             @Y30LB37*/ 02010000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 02011000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 02012000
*/*          4 - VTOC OPEN WAS UNSUCCESSFUL                  @Y30LB37*/ 02013000
*/*              VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 02014000
*/*              ERROR SCRATCHING A DATA SET                 @Y30LB37*/ 02015000
*/*              ERROR RETRIEVING UCB ADDRESS                @Y30LB37*/ 02016000
*/*              ERROR RESERVING VOLUME                      @Y30LB37*/ 02017000
*/*              ERROR READING OR UPDATING A VTOC            @Y30LB37*/ 02018000
*/*              ERROR READING OR UPDATING A FORMAT 4 DSCB   @Y30LB37*/ 02019000
*/*                                                                  */ 02020000
*/********************************************************************/ 02021000
*                                                                  0744 02022000
*SCRATCH:                                                          0744 02023000
*   PROCEDURE;                      /*                       @Y30LB37*/ 02024000
*                                                                  0744 02025000
SCRATCH  STM   @14,@12,@SA00008                                    0744 02026000
*   /*****************************************************************/ 02027000
*   /*                                                               */ 02028000
*   /* LOCAL DECLARATIONS FOR SCRATCH                        @Y30LB37*/ 02029000
*   /*                                                               */ 02030000
*   /*****************************************************************/ 02031000
*                                                                  0745 02032000
*   DCL                                                            0745 02033000
*     SCRATRC FIXED(15);            /* SCRATCH RETURN CODE   @Y30LB37*/ 02034000
*                                                                  0746 02035000
*   /*****************************************************************/ 02036000
*   /*                                                               */ 02037000
*   /* CALL THE VTOCOPEN PROCEDURE TO OPEN THE VTOC          @Y30LB37*/ 02038000
*   /* IF IT IS NOT ALREADY OPEN (VSIOP IS ZERO).            @Y30LB37*/ 02039000
*   /* VTOCOPEN SETS THE VSIOP FIELD. IF VTOCOPEN IS         @Y30LB37*/ 02040000
*   /* UNSUCCESSFUL THEN SET SCRATRC TO FOUR.                @Y30LB37*/ 02041000
*   /*                                                               */ 02042000
*   /*****************************************************************/ 02043000
*                                                                  0746 02044000
*   OLDERID2=NEWERID2;                                             0746 02045000
         L     @03,@PC00001                                        0746 02046000
         L     @03,GDTTR2(,@03)                                    0746 02047000
         MVC   @TS00001(95),NEWERID2(@03)                          0746 02048000
         MVC   OLDERID2(95,@03),@TS00001                           0746 02049000
*   NEWID2='VSSC';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 02050000
         MVC   NEWID2(4,@03),@CC01572                              0747 02051000
*   SCRATRC=0;                      /*                       @Y30LB37*/ 02052000
         SLR   @15,@15                                             0748 02053000
         LR    SCRATRC,@15                                         0748 02054000
*   IF VSIOP=NULLPTR THEN                                          0749 02055000
         C     @15,VSIOP(,ARGLPTR)                                 0749 02056000
         BNE   @RF00749                                            0749 02057000
*     DO;                           /*                       @Y30LB37*/ 02058000
*       CALL VTOCOPEN;              /*                       @Y30LB37*/ 02059000
         BAL   @14,VTOCOPEN                                        0751 02060000
*       RESPECIFY                                                  0752 02061000
*         RTNREG RSTD;                                             0752 02062000
*       TESTRC=RTNREG;                                             0753 02063000
         STH   RTNREG,TESTRC                                       0753 02064000
*       RESPECIFY                                                  0754 02065000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 02066000
*       IF TESTRC^=0 THEN                                          0755 02067000
         LH    @03,TESTRC                                          0755 02068000
         LTR   @03,@03                                             0755 02069000
         BZ    @RF00755                                            0755 02070000
*         SCRATRC=4;                /*                       @Y30LB37*/ 02071000
         LA    SCRATRC,4                                           0756 02072000
*     END;                          /*                       @Y30LB37*/ 02073000
*                                                                  0757 02074000
*   /*****************************************************************/ 02075000
*   /*                                                               */ 02076000
*   /* IF THE VTOC IS ALREADY OPEN PICK UP THE IOCSPTR FROM  @Y30LB37*/ 02077000
*   /* THE VS1AGL.                                           @Y30LB37*/ 02078000
*   /*                                                               */ 02079000
*   /*****************************************************************/ 02080000
*                                                                  0758 02081000
*   ELSE                                                           0758 02082000
*     IOCSPTR=VSIOP;                /*                       @Y30LB37*/ 02083000
*                                                                  0758 02084000
         B     @RC00749                                            0758 02085000
@RF00749 L     @03,VSIOP(,ARGLPTR)                                 0758 02086000
         ST    @03,IOCSPTR                                         0758 02087000
*   /*****************************************************************/ 02088000
*   /*                                                               */ 02089000
*   /* CALL THE FMT4SCR PROCEDURE TO RESET THE VSAM FLAG     @Y30LB37*/ 02090000
*   /* IN THE FORMAT 4 DSCB. IF ERROR SET RETURN CODE        @Y30LB37*/ 02091000
*   /* TO INDICATE NO FUNCTION PERFORMED.                    @Y30LB37*/ 02092000
*   /*                                                               */ 02093000
*   /*****************************************************************/ 02094000
*                                                                  0759 02095000
*   IF SCRATRC=0 THEN                                              0759 02096000
@RC00749 LTR   SCRATRC,SCRATRC                                     0759 02097000
         BNZ   @RF00759                                            0759 02098000
*     DO;                           /*                       @Y30LB37*/ 02099000
*       CALL FMT4SCR;               /*                       @Y30LB37*/ 02100000
         BAL   @14,FMT4SCR                                         0761 02101000
*       RESPECIFY                                                  0762 02102000
*         RTNREG RSTD;                                             0762 02103000
*       TESTRC=RTNREG;                                             0763 02104000
         STH   RTNREG,TESTRC                                       0763 02105000
*       RESPECIFY                                                  0764 02106000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 02107000
*       IF TESTRC^=0 THEN                                          0765 02108000
         LH    @03,TESTRC                                          0765 02109000
         LTR   @03,@03                                             0765 02110000
         BZ    @RF00765                                            0765 02111000
*         SCRATRC=4;                /*                       @Y30LB37*/ 02112000
         LA    SCRATRC,4                                           0766 02113000
*     END;                          /*                       @Y30LB37*/ 02114000
@RF00765 DS    0H                                                  0768 02115000
*                                                                  0768 02116000
*   /*****************************************************************/ 02117000
*   /*                                                               */ 02118000
*   /* CALL THE FMT1SCR ROUTINE TO SCRATCH THE FORMAT 1      @Y30LB37*/ 02119000
*   /* DSCBS. IF FMT1SCR TERMINATED IN THE MIDDLE OF         @Y30LB37*/ 02120000
*   /* SCRATCHING THE VTOC (RETURN CODE IS 4). THEN SET      @Y30LB37*/ 02121000
*   /* THE RETURN CODE TO INDICATE FUNCTION TERMINATED       @Y30LB37*/ 02122000
*   /* (CODE 12). IF FMT1SCR FOUND AN ERROR BUT PROC-        @Y30LB37*/ 02123000
*   /* CESSED THE ENTIRE VTOC (RETURN CODE IS 8) THEN SET    @Y30LB37*/ 02124000
*   /* RETURN CODE 8 TO INDICATE NO MESSAGES BUT ERROR.      @Y30LB37*/ 02125000
*   /*                                                               */ 02126000
*   /*****************************************************************/ 02127000
*                                                                  0768 02128000
*   IF SCRATRC=0 THEN                                              0768 02129000
@RF00759 LTR   SCRATRC,SCRATRC                                     0768 02130000
         BNZ   @RF00768                                            0768 02131000
*     DO;                           /*                       @Y30LB37*/ 02132000
*       CALL FMT1SCR;               /*                       @Y30LB37*/ 02133000
         BAL   @14,FMT1SCR                                         0770 02134000
*       RESPECIFY                                                  0771 02135000
*         RTNREG RSTD;                                             0771 02136000
*       TESTRC=RTNREG;                                             0772 02137000
         STH   RTNREG,TESTRC                                       0772 02138000
*       RESPECIFY                                                  0773 02139000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 02140000
*       IF TESTRC^=0 THEN                                          0774 02141000
         LH    @03,TESTRC                                          0774 02142000
         LTR   @03,@03                                             0774 02143000
         BZ    @RF00774                                            0774 02144000
*         IF TESTRC=4 THEN                                         0775 02145000
         C     @03,@CF00046                                        0775 02146000
         BNE   @RF00775                                            0775 02147000
*           SCRATRC=RCFUNTRM;       /*                       @Y30LB37*/ 02148000
         LA    SCRATRC,12                                          0776 02149000
*         ELSE                                                     0777 02150000
*           SCRATRC=RCNOMSG;        /*                       @Y30LB37*/ 02151000
         B     @RC00775                                            0777 02152000
@RF00775 LA    SCRATRC,8                                           0777 02153000
*     END;                          /*                       @Y30LB37*/ 02154000
*                                                                  0778 02155000
@RC00775 DS    0H                                                  0778 02156000
@RF00774 DS    0H                                                  0779 02157000
*   /*****************************************************************/ 02158000
*   /*                                                               */ 02159000
*   /* IF NO FUNCTION PERFORMED THEN PRINT ERROR MESSAGE     @Y30LB37*/ 02160000
*   /* IDC2964I VIA UPRINT.                                  @Y30LB37*/ 02161000
*   /*                                                               */ 02162000
*   /*****************************************************************/ 02163000
*                                                                  0779 02164000
*   IF SCRATRC=4 THEN                                              0779 02165000
@RF00768 C     SCRATRC,@CF00046                                    0779 02166000
         BNE   @RF00779                                            0779 02167000
*     DO;                           /*                       @Y30LB37*/ 02168000
*       DARGSMOD=MSGMODID;          /*                       @Y30LB37*/ 02169000
         L     @03,DDSTRU                                          0781 02170000
         MVC   DARGSMOD(3,@03),@CC01408                            0781 02171000
*       DARGSENT=MSG2964I;          /*                       @Y30LB37*/ 02172000
         MVI   DARGSENT(@03),X'06'                                 0782 02173000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB37*/ 02174000
         L     @03,@PC00001                                        0783 02175000
         ST    @03,@AL00001                                        0783 02176000
         LA    @15,@CF00120                                        0783 02177000
         ST    @15,@AL00001+4                                      0783 02178000
         LA    @15,DDSTRU                                          0783 02179000
         ST    @15,@AL00001+8                                      0783 02180000
         MVI   @AL00001+8,X'80'                                    0783 02181000
         L     @15,GDTPRT(,@03)                                    0783 02182000
         LA    @01,@AL00001                                        0783 02183000
         BALR  @14,@15                                             0783 02184000
*     END;                          /*                       @Y30LB37*/ 02185000
*                                                                  0785 02186000
*   /*****************************************************************/ 02187000
*   /*                                                               */ 02188000
*   /* IF FUNCTION TERMINATED RETURN CODE 12 THEN PRINT      @Y30LB37*/ 02189000
*   /* ERROR MESSAGE IDC2965I VIA UPRINT AND SET RETURN      @Y30LB37*/ 02190000
*   /* CODE 12 TO A RETURN CODE 4.                           @Y30LB37*/ 02191000
*   /*                                                               */ 02192000
*   /*****************************************************************/ 02193000
*                                                                  0785 02194000
*   IF SCRATRC=RCFUNTRM THEN                                       0785 02195000
@RF00779 C     SCRATRC,@CF00037                                    0785 02196000
         BNE   @RF00785                                            0785 02197000
*     DO;                           /*                       @Y30LB37*/ 02198000
*       SCRATRC=4;                  /*                       @Y30LB37*/ 02199000
         LA    SCRATRC,4                                           0787 02200000
*       DARGSMOD=MSGMODID;          /*                       @Y30LB37*/ 02201000
         L     @03,DDSTRU                                          0788 02202000
         MVC   DARGSMOD(3,@03),@CC01408                            0788 02203000
*       DARGSENT=MSG2965I;          /*                       @Y30LB37*/ 02204000
         MVI   DARGSENT(@03),X'07'                                 0789 02205000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Y30LB37*/ 02206000
         L     @03,@PC00001                                        0790 02207000
         ST    @03,@AL00001                                        0790 02208000
         LA    @15,@CF00120                                        0790 02209000
         ST    @15,@AL00001+4                                      0790 02210000
         LA    @15,DDSTRU                                          0790 02211000
         ST    @15,@AL00001+8                                      0790 02212000
         MVI   @AL00001+8,X'80'                                    0790 02213000
         L     @15,GDTPRT(,@03)                                    0790 02214000
         LA    @01,@AL00001                                        0790 02215000
         BALR  @14,@15                                             0790 02216000
*     END;                          /*                       @Y30LB37*/ 02217000
*                                                                  0791 02218000
*   /*****************************************************************/ 02219000
*   /*                                                               */ 02220000
*   /* RETURN TO CALLER WITH A RETURN CODE OF 4 OR 0.        @Y30LB37*/ 02221000
*   /*                                                               */ 02222000
*   /*****************************************************************/ 02223000
*                                                                  0792 02224000
*   IF SCRATRC=RCNOMSG THEN                                        0792 02225000
@RF00785 C     SCRATRC,@CF00040                                    0792 02226000
         BNE   @RF00792                                            0792 02227000
*     SCRATRC=4;                    /*                       @Y30LB37*/ 02228000
         LA    SCRATRC,4                                           0793 02229000
*   RETURN CODE(SCRATRC);           /* RETURN TO MAIN ROUTINE      0794 02230000
*                                                            @Y30LB37*/ 02231000
@RF00792 LR    @15,SCRATRC                                         0794 02232000
         L     @14,@SA00008                                        0794 02233000
         LM    @00,@12,@SA00008+8                                  0794 02234000
         BR    @14                                                 0794 02235000
*   END SCRATCH;                    /* END OF SCRATCH PROC   @Y30LB37*/ 02236000
*                                                                  0796 02237000
*/********************************************************************/ 02238000
*/*                                                                  */ 02239000
*/*  PROCEDURE NAME - FMT4SCR                                @Y30LB37*/ 02240000
*/*                                                          @Y30LB37*/ 02241000
*/*  FUNCTION - THIS PROCEDURE CLEARS THE OWNERSHIP FLAG     @Y30LB37*/ 02242000
*/*             FROM THE FORMAT 4 DSCB.  FMT4SCR CALLS       @Y30LB37*/ 02243000
*/*             SUBORDINATE ROUTINE FMT4READ TO READ THE     @Y30LB37*/ 02244000
*/*             FORMAT 4 DSCB.                               @Y30LB37*/ 02245000
*/*                                                          @Y30LB37*/ 02246000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 02247000
*/*          LIST:  FIELD VSIOP.                             @Y30LB37*/ 02248000
*/*                                                          @Y30LB37*/ 02249000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       @Y30LB37*/ 02250000
*/*          OR FOUR ERROR CODE AND/OR RETURNED INFORMA-     @Y30LB37*/ 02251000
*/*          TION ABOUT THE VTOC ACCORDING TO THE INPUT      @Y30LB37*/ 02252000
*/*          REQUEST FLAGS.  RETURN CODES ARE:               @Y30LB37*/ 02253000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 02254000
*/*          4 - VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 02255000
*/*              FIRST RECORD WAS NOT A FORMAT 4             @Y30LB37*/ 02256000
*/*              ERROR UPDATING THE FORMAT 4 RECORD          @Y30LB37*/ 02257000
*/*                                                                  */ 02258000
*/********************************************************************/ 02259000
*                                                                  0796 02260000
*FMT4SCR:                                                          0796 02261000
*   PROCEDURE;                      /*                       @Y30LB37*/ 02262000
*                                                                  0796 02263000
FMT4SCR  STM   @14,@12,@SA00009                                    0796 02264000
*   /*****************************************************************/ 02265000
*   /*                                                               */ 02266000
*   /* LOCAL DECLARATIONS FOR FMT4SCR                        @Y30LB37*/ 02267000
*   /*                                                               */ 02268000
*   /*****************************************************************/ 02269000
*                                                                  0797 02270000
*   DCL                                                            0797 02271000
*     FMT4SRC FIXED(15);            /* FMT4SCR RETURN CODE   @Y30LB37*/ 02272000
*                                                                  0798 02273000
*   /*****************************************************************/ 02274000
*   /*                                                               */ 02275000
*   /* CALL FMT4READ PROCEDURE TO READ THE FORMAT 4 DSCB.    @Y30LB37*/ 02276000
*   /* IF FMT4READ FAILS SET ERROR RETURN CODE.              @Y30LB37*/ 02277000
*   /*                                                               */ 02278000
*   /*****************************************************************/ 02279000
*                                                                  0798 02280000
*   OLDERID2=NEWERID2;                                             0798 02281000
         L     @05,@PC00001                                        0798 02282000
         L     @05,GDTTR2(,@05)                                    0798 02283000
         MVC   @TS00001(95),NEWERID2(@05)                          0798 02284000
         MVC   OLDERID2(95,@05),@TS00001                           0798 02285000
*   NEWID2='VS4S';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 02286000
         MVC   NEWID2(4,@05),@CC01579                              0799 02287000
*   FMT4SRC=0;                      /*                       @Y30LB37*/ 02288000
         SLR   FMT4SRC,FMT4SRC                                     0800 02289000
*   CALL FMT4READ;                  /*                       @Y30LB37*/ 02290000
         BAL   @14,FMT4READ                                        0801 02291000
*   RESPECIFY                                                      0802 02292000
*     RTNREG RSTD;                                                 0802 02293000
*   TESTRC=RTNREG;                                                 0803 02294000
         STH   RTNREG,TESTRC                                       0803 02295000
*   RESPECIFY                                                      0804 02296000
*     RTNREG UNRSTD;                /*                       @Y30LB37*/ 02297000
*   IF TESTRC^=0 THEN                                              0805 02298000
         LH    @03,TESTRC                                          0805 02299000
         LTR   @03,@03                                             0805 02300000
         BZ    @RF00805                                            0805 02301000
*     FMT4SRC=4;                    /*                       @Y30LB37*/ 02302000
*                                                                  0806 02303000
         LA    FMT4SRC,4                                           0806 02304000
*   /*****************************************************************/ 02305000
*   /*                                                               */ 02306000
*   /* IF THE VSAM OWNERSHIP FLAG (DS4VSREF) IS ON, THEN     @Y30LB37*/ 02307000
*   /* SET OFF THE DS4VSREF FLAG IN THE FORMAT 4 DSCB AND    @Y30LB37*/ 02308000
*   /* ISSUE A UPUT MACRO TO UPDATE THE FORMAT 4 DSCB.       @Y30LB37*/ 02309000
*   /*                                                               */ 02310000
*   /*****************************************************************/ 02311000
*                                                                  0807 02312000
*   IF FMT4SRC=0 THEN                                              0807 02313000
@RF00805 LTR   FMT4SRC,FMT4SRC                                     0807 02314000
         BNZ   @RF00807                                            0807 02315000
*     IF DS4VSREF=ON THEN                                          0808 02316000
         LA    @03,44                                              0808 02317000
         AL    @03,F4PTR                                           0808 02318000
         TM    DS4VSREF(@03),B'10000000'                           0808 02319000
         BNO   @RF00808                                            0808 02320000
*       DO;                         /*                       @Y30LB37*/ 02321000
*         DS4VSREF=OFF;             /*                       @Y30LB37*/ 02322000
         NI    DS4VSREF(@03),B'01111111'                           0810 02323000
*         CALL IDCIOPT0(GDTTBL,IOCSPTR);/*                   @Y30LB37*/ 02324000
         L     @03,@PC00001                                        0811 02325000
         ST    @03,@AL00001                                        0811 02326000
         LA    @15,IOCSPTR                                         0811 02327000
         ST    @15,@AL00001+4                                      0811 02328000
         MVI   @AL00001+4,X'80'                                    0811 02329000
         L     @15,GDTPUT(,@03)                                    0811 02330000
         LA    @01,@AL00001                                        0811 02331000
         BALR  @14,@15                                             0811 02332000
*         RESPECIFY                                                0812 02333000
*           RTNREG RSTD;                                           0812 02334000
*         TESTRC=RTNREG;                                           0813 02335000
         STH   RTNREG,TESTRC                                       0813 02336000
*         RESPECIFY                                                0814 02337000
*           RTNREG UNRSTD;          /*                       @Y30LB37*/ 02338000
*         IF TESTRC^=0 THEN                                        0815 02339000
         LH    @03,TESTRC                                          0815 02340000
         LTR   @03,@03                                             0815 02341000
         BZ    @RF00815                                            0815 02342000
*           FMT4SRC=4;              /*                       @Y30LB37*/ 02343000
         LA    FMT4SRC,4                                           0816 02344000
*       END;                        /*                       @Y30LB37*/ 02345000
@RF00815 DS    0H                                                  0818 02346000
*   RETURN CODE(FMT4SRC);           /* RETURN TO MAIN ROUTINE      0818 02347000
*                                                            @Y30LB37*/ 02348000
@RF00808 DS    0H                                                  0818 02349000
@RF00807 LR    @15,FMT4SRC                                         0818 02350000
         L     @14,@SA00009                                        0818 02351000
         LM    @00,@12,@SA00009+8                                  0818 02352000
         BR    @14                                                 0818 02353000
*   END FMT4SCR;                    /* END OF FMT4SCR PROC   @Y30LB37*/ 02354000
*                                                                  0820 02355000
*/********************************************************************/ 02356000
*/*                                                                  */ 02357000
*/*  PROCEDURE NAME - FMT1SCR                                @Y30LB37*/ 02358000
*/*                                                          @Y30LB37*/ 02359000
*/*  FUNCTION - THIS PROCEDURE SCRATCHES FROM THE VOLUME     @Y30LB37*/ 02360000
*/*             ALL THE FORMAT 1 DSCBS.  FMT1SCR CALLS       @Y30LB37*/ 02361000
*/*             SUBORDINATE ROUTINE FMT1READ TO READ THE     @Y30LB37*/ 02362000
*/*             FORMAT 1 DSCB.                               @Y30LB37*/ 02363000
*/*                                                          @Y30LB37*/ 02364000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 02365000
*/*          LIST:  FIELD VSIOP.                             @Y30LB37*/ 02366000
*/*                                                          @Y30LB37*/ 02367000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO       @Y30LB37*/ 02368000
*/*          OR FOUR ERROR CODE AND/OR RETURNED INFORMA-     @Y30LB37*/ 02369000
*/*          TION ABOUT THE FMT1 ACCORDING TO THE INPUT      @Y30LB37*/ 02370000
*/*          REQUEST FLAGS.  RETURN CODES ARE:               @Y30LB37*/ 02371000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 02372000
*/*          4 - ERROR READING OR UPDATING VTOC              @Y30LB37*/ 02373000
*/*          8 - ERROR SCRATCHING DATA SETS BUT VTOC         @Y30LB37*/ 02374000
*/*              PROCESSED                                   @Y30LB37*/ 02375000
*/*                                                                  */ 02376000
*/********************************************************************/ 02377000
*                                                                  0820 02378000
*FMT1SCR:                                                          0820 02379000
*   PROCEDURE;                      /*                       @Y30LB37*/ 02380000
*                                                                  0820 02381000
FMT1SCR  STM   @14,@12,@SA00010                                    0820 02382000
*   /*****************************************************************/ 02383000
*   /*                                                               */ 02384000
*   /* LOCAL DECLARATIONS FOR FMT1SCR                        @Y30LB37*/ 02385000
*   /*                                                               */ 02386000
*   /*****************************************************************/ 02387000
*                                                                  0821 02388000
*   DCL                                                            0821 02389000
*     FMT1SRC FIXED(15);            /* FMT1SCR RETURN CODE   @Y30LB37*/ 02390000
*   DCL                                                            0822 02391000
*     VVOLPTR PTR(31);              /* UVOLLIST PTR          @Y30LB37*/ 02392000
*   DCL                                                            0823 02393000
*     VOLIST CHAR(LENGTH(UVOLLIST)) /* GETMAINED AREA FOR    @Y30LB37*/ 02394000
*         BDY(WORD);                /* UVOLLIST DSECT        @Y30LB37*/ 02395000
*                                                                  0824 02396000
*   /*****************************************************************/ 02397000
*   /*                                                               */ 02398000
*   /* ISSUE UTRACE MACRO AND THEN INITIALIZE FIELDS AND     @Y30LB37*/ 02399000
*   /* SWITCHES FOR LOOP CONTROL.                            @Y30LB37*/ 02400000
*   /*                                                               */ 02401000
*   /*****************************************************************/ 02402000
*                                                                  0824 02403000
*   RFY                                                            0824 02404000
*     UVOLLIST BASED(VVOLPTR);      /*                       @Y30LB37*/ 02405000
*   OLDERID2=NEWERID2;                                             0825 02406000
         L     @03,@PC00001                                        0825 02407000
         L     @03,GDTTR2(,@03)                                    0825 02408000
         MVC   @TS00001(95),NEWERID2(@03)                          0825 02409000
         MVC   OLDERID2(95,@03),@TS00001                           0825 02410000
*   NEWID2='VS1S';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 02411000
         MVC   NEWID2(4,@03),@CC01587                              0826 02412000
*   FMT1SRC=0;                      /*                       @Y30LB37*/ 02413000
         SLR   FMT1SRC,FMT1SRC                                     0827 02414000
*   TERMSW=OFF;                     /*                       @Y30LB37*/ 02415000
*   SCRERRSW=OFF;                   /*                       @Y30LB37*/ 02416000
         NI    TERMSW,B'11001111'                                  0829 02417000
*   VVOLPTR=ADDR(VOLIST);           /*                       @Y30LB37*/ 02418000
         LA    @03,VOLIST                                          0830 02419000
         ST    @03,VVOLPTR                                         0830 02420000
*                                                                  0831 02421000
*   /*****************************************************************/ 02422000
*   /*                                                               */ 02423000
*   /* LOOP THROUGH TO PROCESS ALL FORMAT 1 DSCBS UNTIL      @Y30LB37*/ 02424000
*   /* END OF FILE OCCURS OR AN ERROR OCCURS READING OR      @Y30LB37*/ 02425000
*   /* UPDATING THE VTOC.                                    @Y30LB37*/ 02426000
*   /*                                                               */ 02427000
*   /*****************************************************************/ 02428000
*                                                                  0831 02429000
*FMT1LOOP:                                                         0831 02430000
*   DO WHILE TERMSW=OFF;            /*                       @Y30LB37*/ 02431000
FMT1LOOP B     @DE00831                                            0831 02432000
@DL00831 DS    0H                                                  0832 02433000
*     RESETDS1=OFF;                 /*                       @G24LB31*/ 02434000
*     NOSCRDS1=OFF;                 /*                       @G24LB31*/ 02435000
*                                                                  0833 02436000
         NI    RESETDS1,B'00111111'                                0833 02437000
*     /***************************************************************/ 02438000
*     /*                                                             */ 02439000
*     /* CALL THE FMT1READ ROUTINE TO READ THE FORMAT 1      @Y30LB37*/ 02440000
*     /* DSCBS. THE ORGTYPE AND PROTTYPE FIELDS ARE SET      @Y30LB37*/ 02441000
*     /* TO 'ALL'.                                           @Y30LB37*/ 02442000
*     /*                                                             */ 02443000
*     /***************************************************************/ 02444000
*                                                                  0834 02445000
*     CALL FMT1READ(ORGTALL,PROTTALL);/*                     @Y30LB37*/ 02446000
         LA    @01,@AL00834                                        0834 02447000
         BAL   @14,FMT1READ                                        0834 02448000
*     RESPECIFY                                                    0835 02449000
*       RTNREG RSTD;                                               0835 02450000
*     TESTRC=RTNREG;                                               0836 02451000
         STH   RTNREG,TESTRC                                       0836 02452000
*     RESPECIFY                                                    0837 02453000
*       RTNREG UNRSTD;              /*                       @Y30LB37*/ 02454000
*     IF TESTRC=0 THEN                                             0838 02455000
         LH    @03,TESTRC                                          0838 02456000
         LTR   @03,@03                                             0838 02457000
         BNZ   @RF00838                                            0838 02458000
*       DO;                         /*                       @Y30LB37*/ 02459000
*                                                                  0839 02460000
*         /***********************************************************/ 02461000
*         /*                                                         */ 02462000
*         /* IF THE READ IS SUCCESSFUL THEN CHECK FOR A      @Y30LB37*/ 02463000
*         /* VSAM DATA SET OR DATA SPACE ('AM' DSORG TYPE).  @Y30LB37*/ 02464000
*         /* IF 'AM' THEN SET DSORG TO 'PS' TO INDICATE      @Y30LB37*/ 02465000
*         /* NON-VSAM AND ZERO THE DS1DSIND FIELD TO         @Y30LB37*/ 02466000
*         /* INDICATE NO PROTECTION. VSAM SECURITY CHECK-    @Y30LB37*/ 02467000
*         /* ING WILL THUS BE BYPASSED.                      @G24LB31*/ 02468000
*         /*                                                         */ 02469000
*         /***********************************************************/ 02470000
*                                                                  0840 02471000
*         IF DSORGAM=ON THEN                                       0840 02472000
         TM    DSORGAM(F1PTR),B'00001000'                          0840 02473000
         BNO   @RF00840                                            0840 02474000
*           DO;                     /*                       @Y30LB37*/ 02475000
*             DSORGAM=OFF;          /*                       @Y30LB37*/ 02476000
         NI    DSORGAM(F1PTR),B'11110111'                          0842 02477000
*             DSORGPS=ON;           /*                       @Y30LB37*/ 02478000
         OI    DSORGPS(F1PTR),B'01000000'                          0843 02479000
*             DS1DSIND=HEXZERO;     /*                       @Y30LB37*/ 02480000
         MVC   DS1DSIND(1,F1PTR),HEXZERO                           0844 02481000
*             RESETDS1=ON;          /*                       @G24LB31*/ 02482000
         OI    RESETDS1,B'10000000'                                0845 02483000
*           END;                    /*                       @G24LB31*/ 02484000
*                                                                  0847 02485000
*         /***********************************************************/ 02486000
*         /*                                                         */ 02487000
*         /*                                                 @G24LB31*/ 02488000
*         /* IF DATA SET IS RACF PROTECTED, ISSUE URACHECK.  @G24LB31*/ 02489000
*         /* SET THE RACF INDICATOR OFF IN THE FORMAT 1      @G24LB31*/ 02490000
*         /* DSCB AND REWRITE THE DSCB IF THE URACHECK       @G24LB31*/ 02491000
*         /* MACRO WAS SUCCESSFUL.                           @G24LB31*/ 02492000
*         /*                                                 @G24LB31*/ 02493000
*         /*                                                         */ 02494000
*         /***********************************************************/ 02495000
*                                                                  0847 02496000
*         ELSE                      /*                       @G24LB31*/ 02497000
*           IF PROTRACF=ON THEN     /*                       @G24LB31*/ 02498000
         B     @RC00840                                            0847 02499000
@RF00840 TM    PROTRACF(F1PTR),B'01000000'                         0847 02500000
         BNO   @RF00847                                            0847 02501000
*             DO;                   /*                       @G24LB31*/ 02502000
*               VS1RACF=''B;        /*                       @G24LB31*/ 02503000
         XC    VS1RACF(20),VS1RACF                                 0849 02504000
*               RACFDSTV=OFF;       /* RACF NON-VSAM D.S.    @G24LB31*/ 02505000
         LA    @03,VS1RACF                                         0850 02506000
         NI    RACFDSTV(@03),B'11101111'                           0850 02507000
*               RACFTUPD=ON;        /* RACF UPDATE ACCESS    @G24LB31*/ 02508000
         OI    RACFTUPD(@03),B'00000100'                           0851 02509000
*               RACFENT=ADDR(DS1DSNAM);/*                    @G24LB31*/ 02510000
         ST    F1PTR,RACFENT(,@03)                                 0852 02511000
*               RACFCLN=ADDR(CLASSRAC);/* RACF CLASS         @G24LB31*/ 02512000
         LA    @15,CLASSRAC                                        0853 02513000
         ST    @15,RACFCLN(,@03)                                   0853 02514000
*               CLASSLEN=LENGTH(CLASSDS);/*                  @G24LB31*/ 02515000
         MVI   CLASSLEN,X'07'                                      0854 02516000
*               CLASSNM=CLASSDS;    /*                       @G24LB31*/ 02517000
         MVI   CLASSNM+7,C' '                                      0855 02518000
         MVC   CLASSNM(7),CLASSDS                                  0855 02519000
*               RACFVOLS=VSVOLP;    /*                       @G24LB31*/ 02520000
         L     @15,VSVOLP(,ARGLPTR)                                0856 02521000
         ST    @15,RACFVOLS(,@03)                                  0856 02522000
*               CALL IDCSARK0(GDTTBL,VRACFPTR);/*            @G24LB31*/ 02523000
         L     @03,@PC00001                                        0857 02524000
         ST    @03,@AL00001                                        0857 02525000
         LA    @15,VRACFPTR                                        0857 02526000
         ST    @15,@AL00001+4                                      0857 02527000
         MVI   @AL00001+4,X'80'                                    0857 02528000
         L     @15,GDTRCK(,@03)                                    0857 02529000
         LA    @01,@AL00001                                        0857 02530000
         BALR  @14,@15                                             0857 02531000
*               RESPECIFY                                          0858 02532000
*                 RTNREG RSTD;                                     0858 02533000
*               TESTRC=RTNREG;                                     0859 02534000
         STH   RTNREG,TESTRC                                       0859 02535000
*               RESPECIFY                                          0860 02536000
*                 RTNREG UNRSTD;    /*                       @G24LB31*/ 02537000
*                                                                  0860 02538000
*               /*****************************************************/ 02539000
*               /*                                                   */ 02540000
*               /* ******************************************        */ 02541000
*               /*                                           @G24LB31*/ 02542000
*               /*                                           @G24LB31*/ 02543000
*               /* IF URACHECK MACRO FAILED, SET SCRERRSW TO @G24LB31*/ 02544000
*               /* INDICATE A D.S. COULD NOT BE SCRATCHED.   @G24LB31*/ 02545000
*               /* CONTINUE SCRATCHING REMAINING DATA SETS.  @G24LB31*/ 02546000
*               /*                                           @G24LB31*/ 02547000
*               /* ******************************************        */ 02548000
*               /*                                           @G24LB31*/ 02549000
*               /*                                                   */ 02550000
*               /*****************************************************/ 02551000
*                                                                  0861 02552000
*               IF TESTRC^=0 THEN   /*                       @G24LB31*/ 02553000
         LH    @03,TESTRC                                          0861 02554000
         LTR   @03,@03                                             0861 02555000
         BZ    @RF00861                                            0861 02556000
*                 DO;               /*                       @G24LB31*/ 02557000
*                   SCRERRSW=ON;    /*                       @G24LB31*/ 02558000
         OI    SCRERRSW,B'00010000'                                0863 02559000
*                   NOSCRDS1=ON;    /* DO NOT SCRATCH THIS D.S.    0864 02560000
*                                                            @G24LB31*/ 02561000
         OI    NOSCRDS1,B'01000000'                                0864 02562000
*                 END;              /*                       @G24LB31*/ 02563000
*               ELSE                /*                       @G24LB31*/ 02564000
*                 DO;               /*                       @G24LB31*/ 02565000
         B     @RC00861                                            0866 02566000
@RF00861 DS    0H                                                  0867 02567000
*                   DS1DSIND=HEXZERO;/* SET OFF RACF PROT    @G24LB31*/ 02568000
         MVC   DS1DSIND(1,F1PTR),HEXZERO                           0867 02569000
*                   RESETDS1=ON;    /*                       @G24LB31*/ 02570000
         OI    RESETDS1,B'10000000'                                0868 02571000
*                 END;              /*                       @G24LB31*/ 02572000
*             END;                  /*                       @G24LB31*/ 02573000
@RC00861 DS    0H                                                  0871 02574000
*                                                                  0871 02575000
*         /***********************************************************/ 02576000
*         /*                                                         */ 02577000
*         /*                                                 @G24LB31*/ 02578000
*         /* ISSUE UPUT MACRO TO PUT THE UPDATED FORMAT 1.   @G24LB31*/ 02579000
*         /*                                                 @G24LB31*/ 02580000
*         /*                                                         */ 02581000
*         /***********************************************************/ 02582000
*                                                                  0871 02583000
*         IF RESETDS1=ON THEN       /*                       @G24LB31*/ 02584000
@RF00847 DS    0H                                                  0871 02585000
@RC00840 TM    RESETDS1,B'10000000'                                0871 02586000
         BNO   @RF00871                                            0871 02587000
*           DO;                     /*                       @G24LB31*/ 02588000
*             CALL IDCIOPT0(GDTTBL,IOCSPTR);/*               @G24LB31*/ 02589000
         L     @03,@PC00001                                        0873 02590000
         ST    @03,@AL00001                                        0873 02591000
         LA    @15,IOCSPTR                                         0873 02592000
         ST    @15,@AL00001+4                                      0873 02593000
         MVI   @AL00001+4,X'80'                                    0873 02594000
         L     @15,GDTPUT(,@03)                                    0873 02595000
         LA    @01,@AL00001                                        0873 02596000
         BALR  @14,@15                                             0873 02597000
*             RESPECIFY                                            0874 02598000
*               RTNREG RSTD;                                       0874 02599000
*             TESTRC=RTNREG;                                       0875 02600000
         STH   RTNREG,TESTRC                                       0875 02601000
*             RESPECIFY                                            0876 02602000
*               RTNREG UNRSTD;      /*                       @G24LB31*/ 02603000
*                                                                  0876 02604000
*             /*******************************************************/ 02605000
*             /*                                                     */ 02606000
*             /*                                             @G24LB31*/ 02607000
*             /* IF THE UPUT MACRO IS UNSUCCESSFUL, THEN     @G24LB31*/ 02608000
*             /* SET THE RETURN CODE TO RCFAIL.              @G24LB31*/ 02609000
*             /*                                             @G24LB31*/ 02610000
*             /*                                                     */ 02611000
*             /*******************************************************/ 02612000
*                                                                  0877 02613000
*             IF TESTRC^=0 THEN                                    0877 02614000
         LH    @03,TESTRC                                          0877 02615000
         LTR   @03,@03                                             0877 02616000
         BZ    @RF00877                                            0877 02617000
*               DO;                 /*                       @G24LB31*/ 02618000
*                 TERMSW=ON;        /*                       @G24LB31*/ 02619000
         OI    TERMSW,B'00100000'                                  0879 02620000
*                 FMT1SRC=4;        /*                       @G24LB31*/ 02621000
         LA    FMT1SRC,4                                           0880 02622000
*               END;                /*                       @G24LB31*/ 02623000
*           END;                    /*                       @G24LB31*/ 02624000
*                                                                  0882 02625000
@RF00877 DS    0H                                                  0883 02626000
*         /***********************************************************/ 02627000
*         /*                                                         */ 02628000
*         /* IF THE UPUT IS SUCCESSFUL OR THE DSORG IS NOT   #Y30LB37*/ 02629000
*         /* 'AM' DSORG TYPE, THEN ISSUE A USCRATCH MACRO    #Y30LB37*/ 02630000
*         /* TO SCRATCH THE FORMAT 1 DSCB.                   #Y30LB37*/ 02631000
*         /*                                                         */ 02632000
*         /***********************************************************/ 02633000
*                                                                  0883 02634000
*         IF FMT1SRC=0&NOSCRDS1=OFF THEN/*                   @G24LB31*/ 02635000
@RF00871 LTR   FMT1SRC,FMT1SRC                                     0883 02636000
         BNZ   @RF00883                                            0883 02637000
         TM    NOSCRDS1,B'01000000'                                0883 02638000
         BNZ   @RF00883                                            0883 02639000
*           DO;                     /*                       @Y30LB37*/ 02640000
*             UVOLCNT=ONE;          /*                       @Y30LB37*/ 02641000
         L     @03,VVOLPTR                                         0885 02642000
         MVC   UVOLCNT(2,@03),@CH00223                             0885 02643000
*             UVOLDEV(1)=V1DEVA;    /*                       @Y30LB37*/ 02644000
         L     @01,VSDEVP(,ARGLPTR)                                0886 02645000
         MVC   UVOLDEV(4,@03),V1DEVA(@01)                          0886 02646000
*             UVOLVOL(1)=V1VOLA;    /*                       @Y30LB37*/ 02647000
         L     @01,VSVOLP(,ARGLPTR)                                0887 02648000
         MVC   UVOLVOL(6,@03),V1VOLA(@01)                          0887 02649000
*             CALL IDCSASC0(GDTTBL,DS1DSNAM,VVOLPTR,OVERRIDE);     0888 02650000
         L     @03,@PC00001                                        0888 02651000
         ST    @03,@AL00001                                        0888 02652000
         ST    F1PTR,@AL00001+4                                    0888 02653000
         LA    @15,VVOLPTR                                         0888 02654000
         ST    @15,@AL00001+8                                      0888 02655000
         LA    @15,OVERRIDE                                        0888 02656000
         ST    @15,@AL00001+12                                     0888 02657000
         MVI   @AL00001+12,X'80'                                   0888 02658000
         L     @15,GDTSCR(,@03)                                    0888 02659000
         LA    @01,@AL00001                                        0888 02660000
         BALR  @14,@15                                             0888 02661000
*             RESPECIFY                                            0889 02662000
*               RTNREG RSTD;                                       0889 02663000
*             TESTRC=RTNREG;                                       0890 02664000
         STH   RTNREG,TESTRC                                       0890 02665000
*             RESPECIFY                                            0891 02666000
*               RTNREG UNRSTD;      /*                       @Y30LB37*/ 02667000
*                                                                  0891 02668000
*             /*******************************************************/ 02669000
*             /*                                                     */ 02670000
*             /* IF AN ERROR OCCURRED, CONTINUE SCRATCHING   @Y30LB37*/ 02671000
*             /* MORE DATA SETS BUT SET THE SCRERRSW TO      @Y30LB37*/ 02672000
*             /* REMEMBER THAT AN ERROR OCCURRED.            @Y30LB37*/ 02673000
*             /*                                                     */ 02674000
*             /*******************************************************/ 02675000
*                                                                  0892 02676000
*             IF TESTRC^=0 THEN                                    0892 02677000
         LH    @03,TESTRC                                          0892 02678000
         LTR   @03,@03                                             0892 02679000
         BZ    @RF00892                                            0892 02680000
*               SCRERRSW=ON;        /*                       @Y30LB37*/ 02681000
         OI    SCRERRSW,B'00010000'                                0893 02682000
*           END;                    /*                       @Y30LB37*/ 02683000
*       END;                        /*                       @Y30LB37*/ 02684000
*                                                                  0896 02685000
*     /***************************************************************/ 02686000
*     /*                                                             */ 02687000
*     /* IF READ FAILED OR END OF FILE SET LOOP TERMSW ON.   @Y30LB37*/ 02688000
*     /* IF FMT1READ FAILED THEN ALSO SET THE RETURN CODE    @Y30LB37*/ 02689000
*     /* TO RCFAIL.                                          @Y30LB37*/ 02690000
*     /*                                                             */ 02691000
*     /***************************************************************/ 02692000
*                                                                  0896 02693000
*     ELSE                                                         0896 02694000
*       DO;                         /*                       @Y30LB37*/ 02695000
         B     @RC00838                                            0896 02696000
@RF00838 DS    0H                                                  0897 02697000
*         TERMSW=ON;                /*                       @Y30LB37*/ 02698000
         OI    TERMSW,B'00100000'                                  0897 02699000
*         IF TESTRC=4 THEN                                         0898 02700000
         LH    @03,TESTRC                                          0898 02701000
         C     @03,@CF00046                                        0898 02702000
         BNE   @RF00898                                            0898 02703000
*           FMT1SRC=TESTRC;         /*                       @Y30LB37*/ 02704000
         LR    FMT1SRC,@03                                         0899 02705000
*       END;                        /*                       @Y30LB37*/ 02706000
@RF00898 DS    0H                                                  0901 02707000
*   END FMT1LOOP;                   /*                       @Y30LB37*/ 02708000
*                                                                  0901 02709000
@RC00838 DS    0H                                                  0901 02710000
@DE00831 TM    TERMSW,B'00100000'                                  0901 02711000
         BZ    @DL00831                                            0901 02712000
*   /*****************************************************************/ 02713000
*   /*                                                               */ 02714000
*   /* SET THE PROPER RETURN CODE IN REGISTER 15 AND THEN    @Y30LB37*/ 02715000
*   /* RETURN TO THE CALLER. IF AN ERROR OCCURRED SCRATCH-   @Y30LB37*/ 02716000
*   /* ING A DATA SET (SCRERRSW ON) BUT THE ENTIRE VTOC WAS  @Y30LB37*/ 02717000
*   /* PROCESSED (RETURN CODE ZERO) SET THE FINAL RETURN     @Y30LB37*/ 02718000
*   /* CODE TO 8.                                            @Y30LB37*/ 02719000
*   /*                                                               */ 02720000
*   /*****************************************************************/ 02721000
*                                                                  0902 02722000
*   IF SCRERRSW=ON&FMT1SRC=0 THEN                                  0902 02723000
         TM    SCRERRSW,B'00010000'                                0902 02724000
         BNO   @RF00902                                            0902 02725000
         LTR   FMT1SRC,FMT1SRC                                     0902 02726000
         BNZ   @RF00902                                            0902 02727000
*     FMT1SRC=RCSCRERR;             /*                       @Y30LB37*/ 02728000
         LA    FMT1SRC,8                                           0903 02729000
*   RETURN CODE(FMT1SRC);           /* RETURN TO MAIN ROUTINE      0904 02730000
*                                                            @Y30LB37*/ 02731000
@RF00902 LR    @15,FMT1SRC                                         0904 02732000
         L     @14,@SA00010                                        0904 02733000
         LM    @00,@12,@SA00010+8                                  0904 02734000
         BR    @14                                                 0904 02735000
*   END FMT1SCR;                    /* END OF FMT1SCR PROC   @Y30LB37*/ 02736000
*                                                                  0906 02737000
*/********************************************************************/ 02738000
*/*                                                                  */ 02739000
*/*  PROCEDURE NAME - SECHECK                                @Y30LB37*/ 02740000
*/*                                                          @Y30LB37*/ 02741000
*/*  FUNCTION - THIS PROCEDURE CALLS THE PROPER ROUTINES     @Y30LB37*/ 02742000
*/*             TO OPEN THE VTOC, CHECK THE FORMAT 4 DSCB    @Y30LB37*/ 02743000
*/*             FOR SECURITY, AND CHECK THE FORMAT 1 DSCBS   @Y30LB37*/ 02744000
*/*             FOR SECURITY.                                @Y30LB37*/ 02745000
*/*                                                          @Y30LB37*/ 02746000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 02747000
*/*          LIST:  FIELD VSIOP AND VSNONONV FLAG.           @Y30LB37*/ 02748000
*/*                                                          @Y30LB37*/ 02749000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO, FOUR @Y30LB37*/ 02750000
*/*          OR EIGHT ERROR CODE.                            @Y30LB37*/ 02751000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 02752000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 02753000
*/*          4 - VTOC OPEN WAS UNSUCCESSFUL                  @Y30LB37*/ 02754000
*/*              VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 02755000
*/*              ERROR PASSWORD CHECKING A DATA SET          @Y30LB37*/ 02756000
*/*              ERROR RETRIEVING UCB ADDRESS                @Y30LB37*/ 02757000
*/*              ERROR RESERVING VOLUME                      @Y30LB37*/ 02758000
*/*              ERROR READING OR UPDATING A VTOC            @Y30LB37*/ 02759000
*/*              ERROR READING OR UPDATING A FORMAT 4 DSCB   @Y30LB37*/ 02760000
*/*          8 - VSAM CLOSE WAS UNSUCCESSFUL                 @Y30LB37*/ 02761000
*/*              ERROR CLOSING A DATA SET ON THE VTOC        @Y30LB37*/ 02762000
*/*                                                                  */ 02763000
*/********************************************************************/ 02764000
*                                                                  0906 02765000
*SECHECK:                                                          0906 02766000
*   PROCEDURE;                      /*                       @Y30LB37*/ 02767000
*                                                                  0906 02768000
SECHECK  STM   @14,@12,@SA00011                                    0906 02769000
*   /*****************************************************************/ 02770000
*   /*                                                               */ 02771000
*   /* LOCAL DECLARATIONS FOR SECHECK                        @Y30LB37*/ 02772000
*   /*                                                               */ 02773000
*   /*****************************************************************/ 02774000
*                                                                  0907 02775000
*   DCL                                                            0907 02776000
*     SECHKRC FIXED(15);            /* SECHECK RETURN CODE   @Y30LB37*/ 02777000
*   DCL                                                            0908 02778000
*     CATPASS CHAR(4);              /* CATALOG CHK PARM AREA @Y30LB37*/ 02779000
*                                                                  0909 02780000
*   /*****************************************************************/ 02781000
*   /*                                                               */ 02782000
*   /* CALL THE VTOCOPEN PROCEDURE TO OPEN THE VTOC          @Y30LB37*/ 02783000
*   /* IF IT IS NOT ALREADY OPEN (VSIOP IS ZERO).            @Y30LB37*/ 02784000
*   /* VTOCOPEN SETS THE VSIOP FIELD. IF VTOCOPEN IS         @Y30LB37*/ 02785000
*   /* UNSUCCESSFUL THEN SET SECHKRC TO FOUR.                @Y30LB37*/ 02786000
*   /*                                                               */ 02787000
*   /*****************************************************************/ 02788000
*                                                                  0909 02789000
*   OLDERID2=NEWERID2;                                             0909 02790000
         L     @03,@PC00001                                        0909 02791000
         L     @03,GDTTR2(,@03)                                    0909 02792000
         MVC   @TS00001(95),NEWERID2(@03)                          0909 02793000
         MVC   OLDERID2(95,@03),@TS00001                           0909 02794000
*   NEWID2='VSSE';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 02795000
         MVC   NEWID2(4,@03),@CC01595                              0910 02796000
*   SECHKRC=0;                      /*                       @Y30LB37*/ 02797000
         SLR   @15,@15                                             0911 02798000
         LR    SECHKRC,@15                                         0911 02799000
*   IF VSIOP=NULLPTR THEN                                          0912 02800000
         C     @15,VSIOP(,ARGLPTR)                                 0912 02801000
         BNE   @RF00912                                            0912 02802000
*     DO;                           /*                       @Y30LB37*/ 02803000
*       CALL VTOCOPEN;              /*                       @Y30LB37*/ 02804000
         BAL   @14,VTOCOPEN                                        0914 02805000
*       RESPECIFY                                                  0915 02806000
*         RTNREG RSTD;                                             0915 02807000
*       TESTRC=RTNREG;                                             0916 02808000
         STH   RTNREG,TESTRC                                       0916 02809000
*       RESPECIFY                                                  0917 02810000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 02811000
*       IF TESTRC^=0 THEN                                          0918 02812000
         LH    @03,TESTRC                                          0918 02813000
         LTR   @03,@03                                             0918 02814000
         BZ    @RF00918                                            0918 02815000
*         SECHKRC=4;                /*                       @Y30LB37*/ 02816000
         LA    SECHKRC,4                                           0919 02817000
*     END;                          /*                       @Y30LB37*/ 02818000
*                                                                  0920 02819000
*   /*****************************************************************/ 02820000
*   /*                                                               */ 02821000
*   /* IF THE VTOC IS ALREADY OPEN PICK UP THE IOCSPTR FROM  @Y30LB37*/ 02822000
*   /* THE VS1AGL.                                           @Y30LB37*/ 02823000
*   /*                                                               */ 02824000
*   /*****************************************************************/ 02825000
*                                                                  0921 02826000
*   ELSE                                                           0921 02827000
*     IOCSPTR=VSIOP;                /*                       @Y30LB37*/ 02828000
*                                                                  0921 02829000
         B     @RC00912                                            0921 02830000
@RF00912 L     @03,VSIOP(,ARGLPTR)                                 0921 02831000
         ST    @03,IOCSPTR                                         0921 02832000
*   /*****************************************************************/ 02833000
*   /*                                                               */ 02834000
*   /* IF VTOCOPEN SUCCESSFUL CALL FMT4CHK TO CHECK THE      @Y30LB37*/ 02835000
*   /* FORMAT 4 DSCB, FOR SECURITY. PASS AS INPUT CATPASS    @Y30LB37*/ 02836000
*   /* WHICH FMT4CHK WILL SET INDICATING WHETHER THE CATA-   @Y30LB37*/ 02837000
*   /* LOG-LEVEL PASSWORD HAS BEEN VERIFIED OR NOT. SET      @Y30LB37*/ 02838000
*   /* THE RETURN CODE TO THAT RETURNED BY FMT4CHK.          @Y30LB37*/ 02839000
*   /*                                                               */ 02840000
*   /*****************************************************************/ 02841000
*                                                                  0922 02842000
*   IF SECHKRC=0 THEN                                              0922 02843000
@RC00912 LTR   SECHKRC,SECHKRC                                     0922 02844000
         BNZ   @RF00922                                            0922 02845000
*     DO;                           /*                       @Y30LB37*/ 02846000
*       CALL FMT4CHK(CATPASS);      /*                       @Y30LB37*/ 02847000
         LA    @15,CATPASS                                         0924 02848000
         ST    @15,@AL00001                                        0924 02849000
         LA    @01,@AL00001                                        0924 02850000
         BAL   @14,FMT4CHK                                         0924 02851000
*       RESPECIFY                                                  0925 02852000
*         RTNREG RSTD;                                             0925 02853000
*       TESTRC=RTNREG;                                             0926 02854000
         STH   RTNREG,TESTRC                                       0926 02855000
*       RESPECIFY                                                  0927 02856000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 02857000
*       SECHKRC=TESTRC;             /*                       @Y30LB37*/ 02858000
         LH    @15,TESTRC                                          0928 02859000
         LR    SECHKRC,@15                                         0928 02860000
*                                                                  0929 02861000
*       /*************************************************************/ 02862000
*       /*                                                           */ 02863000
*       /* IF A NON SEVERE ERROR OCCURRED OR IF NO PASSWORD  @Y30LB37*/ 02864000
*       /* PROMPTING IS REQUIRED, CALL FMT1CHK TO CHECK THE  @Y30LB37*/ 02865000
*       /* FORMAT 1 DSCBS. PASS THE FMT1CHK ROUTINE THE 4-   @Y30LB37*/ 02866000
*       /* BYTE CATPASS FROM FMT4CHK THAT WAS SET INDICAT-   @Y30LB37*/ 02867000
*       /* ING WHETHER THE CATALOG PASSWORD WAS VERIFIED     @Y30LB37*/ 02868000
*       /* OR NOT.                                           @Y30LB37*/ 02869000
*       /*                                                           */ 02870000
*       /*************************************************************/ 02871000
*                                                                  0929 02872000
*       IF SECHKRC=4&VSNONONV=ON|SECHKRC=8|SECHKRC=0 THEN          0929 02873000
         C     SECHKRC,@CF00046                                    0929 02874000
         BNE   @GL00009                                            0929 02875000
         TM    VSNONONV(ARGLPTR),B'00100000'                       0929 02876000
         BO    @RT00929                                            0929 02877000
@GL00009 C     SECHKRC,@CF00040                                    0929 02878000
         BE    @RT00929                                            0929 02879000
         LTR   SECHKRC,SECHKRC                                     0929 02880000
         BNZ   @RF00929                                            0929 02881000
@RT00929 DS    0H                                                  0930 02882000
*         DO;                       /*                       @Y30LB37*/ 02883000
*           CALL FMT1CHK(CATPASS);  /*                       @Y30LB37*/ 02884000
         LA    @03,CATPASS                                         0931 02885000
         ST    @03,@AL00001                                        0931 02886000
         LA    @01,@AL00001                                        0931 02887000
         BAL   @14,FMT1CHK                                         0931 02888000
*           RESPECIFY                                              0932 02889000
*             RTNREG RSTD;                                         0932 02890000
*           TESTRC=RTNREG;                                         0933 02891000
         STH   RTNREG,TESTRC                                       0933 02892000
*           RESPECIFY                                              0934 02893000
*             RTNREG UNRSTD;        /*                       @Y30LB37*/ 02894000
*                                                                  0934 02895000
*           /*********************************************************/ 02896000
*           /*                                                       */ 02897000
*           /* IF THE RETURN CODE FROM FMT1CHK IS FOUR OR    @Y30LB37*/ 02898000
*           /* FMT4READ HAD AN ERROR,THEN SET RETURN CODE    @Y30LB37*/ 02899000
*           /* TO FOUR. IF CLOSE ERROR SET RETCODE TO 8.     @Y30LB37*/ 02900000
*           /*                                                       */ 02901000
*           /*********************************************************/ 02902000
*                                                                  0935 02903000
*           IF TESTRC=4 THEN                                       0935 02904000
         LH    @03,TESTRC                                          0935 02905000
         LA    @15,4                                               0935 02906000
         CR    @03,@15                                             0935 02907000
         BNE   @RF00935                                            0935 02908000
*             SECHKRC=4;            /*                       @Y30LB37*/ 02909000
         LR    SECHKRC,@15                                         0936 02910000
*           ELSE                                                   0937 02911000
*             IF TESTRC=8&SECHKRC=0 THEN                           0937 02912000
         B     @RC00935                                            0937 02913000
@RF00935 LA    @03,8                                               0937 02914000
         CH    @03,TESTRC                                          0937 02915000
         BNE   @RF00937                                            0937 02916000
         LTR   SECHKRC,SECHKRC                                     0937 02917000
         BNZ   @RF00937                                            0937 02918000
*               SECHKRC=8;          /*                       @Y30LB37*/ 02919000
         LR    SECHKRC,@03                                         0938 02920000
*         END;                      /*                       @Y30LB37*/ 02921000
@RF00937 DS    0H                                                  0939 02922000
@RC00935 DS    0H                                                  0940 02923000
*       IF SECHKRC=RC4RDERR THEN                                   0940 02924000
@RF00929 C     SECHKRC,@CF00509                                    0940 02925000
         BNE   @RF00940                                            0940 02926000
*         SECHKRC=4;                /*                       @Y30LB37*/ 02927000
         LA    SECHKRC,4                                           0941 02928000
*     END;                          /*                       @Y30LB37*/ 02929000
@RF00940 DS    0H                                                  0943 02930000
*   RETURN CODE(SECHKRC);           /* RETURN TO MAIN ROUTINE      0943 02931000
*                                                            @Y30LB37*/ 02932000
@RF00922 LR    @15,SECHKRC                                         0943 02933000
         L     @14,@SA00011                                        0943 02934000
         LM    @00,@12,@SA00011+8                                  0943 02935000
         BR    @14                                                 0943 02936000
*   END SECHECK;                    /* END OF SECHECK PROC   @Y30LB37*/ 02937000
*                                                                  0945 02938000
*/********************************************************************/ 02939000
*/*                                                                  */ 02940000
*/*  PROCEDURE NAME - FMT4CHK                                @Y30LB37*/ 02941000
*/*                                                          @Y30LB37*/ 02942000
*/*  FUNCTION - THIS PROCEDURE CHECKS THE FORMAT 4 DSCB      @Y30LB37*/ 02943000
*/*             FOR SECURITY.  CALLS THE PROPER ROUTINES     @Y30LB37*/ 02944000
*/*             TO READ THE FORMAT 4 DSCB AND VERIFY THE     @Y30LB37*/ 02945000
*/*             VSAM CATALOG PASSWORD.  CALLS UPRINT TO      @Y30LB37*/ 02946000
*/*             TO PRINT ERROR MESSAGE IDC3067I.             @Y30LB37*/ 02947000
*/*                                                          @Y30LB37*/ 02948000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 02949000
*/*          LIST:  FIELDS VSVOLP, VSMSG, AND VSNOVSAM FLAG. @Y30LB37*/ 02950000
*/*          ALSO THE 4 BYTE AREA FOR RETURNING THE SECURITY @Y30LB37*/ 02951000
*/*          INFORMATION CONCERNING THE CATALOG.             @Y30LB37*/ 02952000
*/*                                                          @Y30LB37*/ 02953000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A 0, 4,      @Y30LB37*/ 02954000
*/*          8, OR 16 ERROR CODE WHETHER THE 'GOOD' OR 'BAD' @Y30LB37*/ 02955000
*/*          TO INDICATE WHETHER THE CATALOG PASSWORD WAS    @Y30LB37*/ 02956000
*/*          VERIFIED.  THE VSVSAM AND VSUCAT FIELDS MAY BE  @Y30LB37*/ 02957000
*/*          SET IN THE CALLER'S VS1AGL.  FM4PASS IS SET.    @Y30LB37*/ 02958000
*/*          SECURITY INFORMATION FOUND.                     @Y30LB37*/ 02959000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 02960000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 02961000
*/*          4 - VSAM CATALOG OPEN WAS UNSUCCESSFUL          @Y30LB37*/ 02962000
*/*              VOLUME OWNED BY VSAM CATALOG, BUT           @Y30LB37*/ 02963000
*/*              NOT ALLOWED BY CALLER                       @Y30LB37*/ 02964000
*/*              ERROR VERIFYING CATALOG PASSWORD            @Y30LB37*/ 02965000
*/*              ERROR LOCATING VOLUME ENTRY                 @Y30LB37*/ 02966000
*/*          8 - ERROR CLOSING VSAM CATALOG                  @Y30LB37*/ 02967000
*/*          16- ERROR READING FORMAT 4 DSCB                 @Y30LB37*/ 02968000
*/*                                                                  */ 02969000
*/********************************************************************/ 02970000
*                                                                  0945 02971000
*FMT4CHK:                                                          0945 02972000
*   PROCEDURE(FM4PASS);             /* CATPASS PASSWORD PARM @Y30LB37*/ 02973000
*                                                                  0945 02974000
FMT4CHK  STM   @14,@12,@SA00012                                    0945 02975000
         MVC   @PC00012(4),0(@01)                                  0945 02976000
*   /*****************************************************************/ 02977000
*   /*                                                               */ 02978000
*   /* LOCAL DECLARATIONS FOR FMT4CHK                        @Y30LB37*/ 02979000
*   /*                                                               */ 02980000
*   /*****************************************************************/ 02981000
*                                                                  0946 02982000
*   DCL                                                            0946 02983000
*     FMT4CRC FIXED(15);            /* FMT4CHK RETURN CODE   @Y30LB37*/ 02984000
*   DCL                                                            0947 02985000
*     FM4PASS CHAR(4);              /* CATALOG CHK PARM AREA @Y30LB37*/ 02986000
*                                                                  0948 02987000
*   /*****************************************************************/ 02988000
*   /*                                                               */ 02989000
*   /* CALL THE FMT4READ PROCEDURE. IF THE FMT4READ IS       @Y30LB37*/ 02990000
*   /* UNSUCCESSFUL THEN SET FMT4CRC TO 16.                  @Y30LB37*/ 02991000
*   /*                                                               */ 02992000
*   /*****************************************************************/ 02993000
*                                                                  0948 02994000
*   OLDERID2=NEWERID2;                                             0948 02995000
         L     @05,@PC00001                                        0948 02996000
         L     @05,GDTTR2(,@05)                                    0948 02997000
         MVC   @TS00001(95),NEWERID2(@05)                          0948 02998000
         MVC   OLDERID2(95,@05),@TS00001                           0948 02999000
*   NEWID2='VS4C';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 03000000
         MVC   NEWID2(4,@05),@CC01604                              0949 03001000
*   FMT4CRC=0;                      /*                       @Y30LB37*/ 03002000
         SLR   FMT4CRC,FMT4CRC                                     0950 03003000
*   CALL FMT4READ;                  /*                       @Y30LB37*/ 03004000
         BAL   @14,FMT4READ                                        0951 03005000
*   RESPECIFY                                                      0952 03006000
*     RTNREG RSTD;                                                 0952 03007000
*   TESTRC=RTNREG;                                                 0953 03008000
         STH   RTNREG,TESTRC                                       0953 03009000
*   RESPECIFY                                                      0954 03010000
*     RTNREG UNRSTD;                /*                       @Y30LB37*/ 03011000
*   IF TESTRC^=0 THEN                                              0955 03012000
         LH    @05,TESTRC                                          0955 03013000
         LTR   @05,@05                                             0955 03014000
         BZ    @RF00955                                            0955 03015000
*     FMT4CRC=RC4RDERR;             /*                       @Y30LB37*/ 03016000
*                                                                  0956 03017000
         LA    FMT4CRC,16                                          0956 03018000
*   /*****************************************************************/ 03019000
*   /*                                                               */ 03020000
*   /* CHECK IF THE VOLUME IS VSAM (DS4VSREF FLAG IS ON).    @Y30LB37*/ 03021000
*   /* IF IT IS, SET THE VSVSAM BIT ON.                      @Y30LB37*/ 03022000
*   /* IF THE VSNOVSAM FLAG IS ON AND THE DS4VSREF FLAG      @Y30LB37*/ 03023000
*   /* IS ON THIS IS CONSIDERED UNSUCCESSFUL THEN            @Y30LB37*/ 03024000
*   /* SET FMT4CRC TO FOUR AND EXIT.                         @Y30LB37*/ 03025000
*   /*                                                               */ 03026000
*   /*****************************************************************/ 03027000
*                                                                  0957 03028000
*   IF FMT4CRC=0&DS4VSREF=ON THEN                                  0957 03029000
@RF00955 LTR   FMT4CRC,FMT4CRC                                     0957 03030000
         BNZ   @RF00957                                            0957 03031000
         L     @05,F4PTR                                           0957 03032000
         TM    DS4VSREF+44(@05),B'10000000'                        0957 03033000
         BNO   @RF00957                                            0957 03034000
*     DO;                           /*                       @Y30LB37*/ 03035000
*       VSVSAM=ON;                  /*                       @Y30LB37*/ 03036000
         OI    VSVSAM(ARGLPTR),B'10000000'                         0959 03037000
*                                                                  0960 03038000
*       /*************************************************************/ 03039000
*       /*                                                           */ 03040000
*       /* ISSUE A UPRINT MACRO IF THE VOLUME CAN            @Y30LB37*/ 03041000
*       /* NOT BE OWNED BY VSAM CATALOG. THE ERROR MESSAGE   @Y30LB37*/ 03042000
*       /* IS IDC3067I WITH THREE VARIATIONS ACCORDING       @Y30LB37*/ 03043000
*       /* TO THE WAY VSMSG IS SET.                          @Y30LB37*/ 03044000
*       /*                                                           */ 03045000
*       /*************************************************************/ 03046000
*                                                                  0960 03047000
*       IF VSNOVSAM=ON THEN                                        0960 03048000
         TM    VSNOVSAM(ARGLPTR),B'10000000'                       0960 03049000
         BNO   @RF00960                                            0960 03050000
*         DO;                       /*                       @Y30LB37*/ 03051000
*           FMT4CRC=4;              /*                       @Y30LB37*/ 03052000
         LA    FMT4CRC,4                                           0962 03053000
*           DARGSMOD=MSGCM0ID;      /*                       @Y30LB37*/ 03054000
         L     @05,DDSTRU                                          0963 03055000
         MVC   DARGSMOD(3,@05),@CC01410                            0963 03056000
*           DARGDBP=VSVOLP;         /*                       @Y30LB37*/ 03057000
         L     @03,VSVOLP(,ARGLPTR)                                0964 03058000
         ST    @03,DARGDBP(,@05)                                   0964 03059000
*           DARGILP=VOLSERLN;       /*                       @Y30LB37*/ 03060000
         MVC   DARGILP(2,@05),@CH00035                             0965 03061000
*           IF VSFROMV=OFF&VSTOV=OFF THEN                          0966 03062000
         TM    VSFROMV(ARGLPTR),B'11000000'                        0966 03063000
         BNZ   @RF00966                                            0966 03064000
*             DARGSENT=MSG3067A;    /*                       @Y30LB37*/ 03065000
         MVI   DARGSENT(@05),X'29'                                 0967 03066000
*           ELSE                                                   0968 03067000
*             IF VSTOV=ON THEN                                     0968 03068000
         B     @RC00966                                            0968 03069000
@RF00966 TM    VSTOV(ARGLPTR),B'01000000'                          0968 03070000
         BNO   @RF00968                                            0968 03071000
*               DARGSENT=MSG3067B;  /*                       @Y30LB37*/ 03072000
         L     @05,DDSTRU                                          0969 03073000
         MVI   DARGSENT(@05),X'2A'                                 0969 03074000
*             ELSE                                                 0970 03075000
*               DARGSENT=MSG3067C;  /*                       @Y30LB37*/ 03076000
         B     @RC00968                                            0970 03077000
@RF00968 L     @05,DDSTRU                                          0970 03078000
         MVI   DARGSENT(@05),X'2B'                                 0970 03079000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB37*/ 03080000
@RC00968 DS    0H                                                  0971 03081000
@RC00966 L     @05,@PC00001                                        0971 03082000
         ST    @05,@AL00001                                        0971 03083000
         LA    @03,@CF00120                                        0971 03084000
         ST    @03,@AL00001+4                                      0971 03085000
         LA    @03,DDSTRU                                          0971 03086000
         ST    @03,@AL00001+8                                      0971 03087000
         MVI   @AL00001+8,X'80'                                    0971 03088000
         L     @15,GDTPRT(,@05)                                    0971 03089000
         LA    @01,@AL00001                                        0971 03090000
         BALR  @14,@15                                             0971 03091000
*         END;                      /*                       @Y30LB37*/ 03092000
*                                                                  0972 03093000
*       /*************************************************************/ 03094000
*       /*                                                           */ 03095000
*       /* CALL CATCHK IF THE VOLUME CAN BE OWNED BY A VSAM  @Y30LB37*/ 03096000
*       /* CATALOG. THE PARAMETER PASSED IS THE CATPASS      @Y30LB37*/ 03097000
*       /* FIELD FROM THE CALLING PROCEDURE. SET THE         @Y30LB37*/ 03098000
*       /* RETURN CODE IF ERROR IN CATCHK TO THE CODE        @Y30LB37*/ 03099000
*       /* RETURNED BY CATCHK.                               @Y30LB37*/ 03100000
*       /*                                                           */ 03101000
*       /*************************************************************/ 03102000
*                                                                  0973 03103000
*       ELSE                                                       0973 03104000
*         DO;                       /*                       @Y30LB37*/ 03105000
         B     @RC00960                                            0973 03106000
@RF00960 DS    0H                                                  0974 03107000
*           CALL CATCHK(FM4PASS);   /*                       @Y30LB37*/ 03108000
         L     @05,@PC00012                                        0974 03109000
         ST    @05,@AL00001                                        0974 03110000
         LA    @01,@AL00001                                        0974 03111000
         BAL   @14,CATCHK                                          0974 03112000
*           RESPECIFY                                              0975 03113000
*             RTNREG RSTD;                                         0975 03114000
*           TESTRC=RTNREG;                                         0976 03115000
         STH   RTNREG,TESTRC                                       0976 03116000
*           RESPECIFY                                              0977 03117000
*             RTNREG UNRSTD;        /*                       @Y30LB37*/ 03118000
*           IF TESTRC^=0 THEN                                      0978 03119000
         LH    @05,TESTRC                                          0978 03120000
         LTR   @05,@05                                             0978 03121000
         BZ    @RF00978                                            0978 03122000
*             FMT4CRC=TESTRC;       /*                       @Y30LB37*/ 03123000
         LR    FMT4CRC,@05                                         0979 03124000
*         END;                      /*                       @Y30LB37*/ 03125000
*     END;                          /*                       @Y30LB37*/ 03126000
*                                                                  0982 03127000
*   /*****************************************************************/ 03128000
*   /*                                                               */ 03129000
*   /* THE DS4VSREF FLAG IS OFF THEN SET THE VSVSAM BIT OFF  @Y30LB37*/ 03130000
*   /* AND THE VSUCAT BIT OFF.                               @Y30LB37*/ 03131000
*   /*                                                               */ 03132000
*   /*****************************************************************/ 03133000
*                                                                  0982 03134000
*   ELSE                                                           0982 03135000
*     DO;                           /*                       @Y30LB37*/ 03136000
         B     @RC00957                                            0982 03137000
@RF00957 DS    0H                                                  0983 03138000
*       VSVSAM=OFF;                 /*                       @Y30LB37*/ 03139000
*       VSUCAT=OFF;                 /*                       @Y30LB37*/ 03140000
         NI    VSVSAM(ARGLPTR),B'00111111'                         0984 03141000
*     END;                          /*                       @Y30LB37*/ 03142000
*   RETURN CODE(FMT4CRC);           /* RETURN TO MAIN ROUTINE      0986 03143000
*                                                            @Y30LB37*/ 03144000
@RC00957 LR    @15,FMT4CRC                                         0986 03145000
         L     @14,@SA00012                                        0986 03146000
         LM    @00,@12,@SA00012+8                                  0986 03147000
         BR    @14                                                 0986 03148000
*   END FMT4CHK;                    /* END OF FMT4CHK PROC   @Y30LB37*/ 03149000
*                                                                  0988 03150000
*/********************************************************************/ 03151000
*/*                                                                  */ 03152000
*/*  PROCEDURE NAME - FMT1CHK                                @Y30LB37*/ 03153000
*/*                                                          @Y30LB37*/ 03154000
*/*  FUNCTION - THIS PROCEDURE CHECKS THE FORMAT 1 DSCBS     @Y30LB37*/ 03155000
*/*             FOR SECURITY.  CALLS THE PROPER ROUTINES     @Y30LB37*/ 03156000
*/*             TO OPEN DATA SETS, AND READ THE FORMAT 1     @Y30LB37*/ 03157000
*/*             DSCBS.                                       @Y30LB37*/ 03158000
*/*                                                          @Y30LB37*/ 03159000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 03160000
*/*          LIST:  FIELDS VSREAD, VSWRITE, VSVOLP, VSMSG,   @Y30LB37*/ 03161000
*/*          AND VSNONONV.  FMT1PASS SET WITH 'GOOD' OR      @Y30LB37*/ 03162000
*/*          'BAD' TO INDICATE WHETHER THE CATALOG PASSWORD  @Y30LB37*/ 03163000
*/*          HAS ALREADY BEEN VERIFIED.                      @Y30LB37*/ 03164000
*/*                                                          @Y30LB37*/ 03165000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO, FOUR @Y30LB37*/ 03166000
*/*          OR EIGHT ERROR CODE AND/OR SECURITY INFORMA-    @Y30LB37*/ 03167000
*/*          TION, ACCORDING TO THE INPUT REQUEST FLAGS.     @Y30LB37*/ 03168000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 03169000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 03170000
*/*          4 - VTOC READ WAS UNSUCCESSFUL                  @Y30LB37*/ 03171000
*/*              ERROR OPENING DATA SETS                     @Y30LB37*/ 03172000
*/*              VOLUME HAS DATA SETS NOT ALLOWED BY CALLER  @Y30LB37*/ 03173000
*/*          8 - ERROR CLOSING DATA SETS                     @Y30LB37*/ 03174000
*/*                                                                  */ 03175000
*/********************************************************************/ 03176000
*                                                                  0988 03177000
*FMT1CHK:                                                          0988 03178000
*   PROCEDURE(FM1PASS);             /* CATPASS PASSWORD PARM @Y30LB37*/ 03179000
*                                                                  0988 03180000
FMT1CHK  STM   @14,@12,@SA00013                                    0988 03181000
         MVC   @PC00013(4),0(@01)                                  0988 03182000
*   /*****************************************************************/ 03183000
*   /*                                                               */ 03184000
*   /* LOCAL DECLARATIONS FOR FMT1CHK                        @Y30LB37*/ 03185000
*   /*                                                               */ 03186000
*   /*****************************************************************/ 03187000
*                                                                  0989 03188000
*   DCL                                                            0989 03189000
*     FMT1CRC FIXED(15);            /* FMT1CHK RETURN CODE   @Y30LB37*/ 03190000
*   DCL                                                            0990 03191000
*     FM1PASS CHAR(4);              /* CATALOG CHK PARM AREA @Y30LB37*/ 03192000
*   DCL                                                            0991 03193000
*     ORGTAREA CHAR(4);             /* ORGTYPE AREA          @Y30LB37*/ 03194000
*   DCL                                                            0992 03195000
*     PROTAREA CHAR(8);             /* PROTTYPE AREA         @Y30LB37*/ 03196000
*                                                                  0993 03197000
*   /*****************************************************************/ 03198000
*   /*                                                               */ 03199000
*   /* CALL THE FMT1READ PROCEDURE IF VSNONONV BIT IS ON.    @Y30LB37*/ 03200000
*   /* FMT1READ GETS THE ORGTYPE SET TO NONV AND THE PROT-   @Y30LB37*/ 03201000
*   /* TYPE SET TO ALL TO READ FOR ALL NON-VSAM              @Y30LB37*/ 03202000
*   /* DATA SETS. IF FMT1READ IS SUCCESSFUL THEN             @Y30LB37*/ 03203000
*   /* THAT IS CONSIDERED AN ERROR. IF FMT1READ IS           @Y30LB37*/ 03204000
*   /* UNSUCCESSFUL THEN SET FMT1CRC TO FOUR AND EXIT.       @Y30LB37*/ 03205000
*   /*                                                               */ 03206000
*   /*****************************************************************/ 03207000
*                                                                  0993 03208000
*   OLDERID2=NEWERID2;                                             0993 03209000
         L     @03,@PC00001                                        0993 03210000
         L     @03,GDTTR2(,@03)                                    0993 03211000
         MVC   @TS00001(95),NEWERID2(@03)                          0993 03212000
         MVC   OLDERID2(95,@03),@TS00001                           0993 03213000
*   NEWID2='VS1C';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 03214000
         MVC   NEWID2(4,@03),@CC01614                              0994 03215000
*   FMT1CRC=0;                      /*                       @Y30LB37*/ 03216000
         SLR   FMT1CRC,FMT1CRC                                     0995 03217000
*   IF VSNONONV=ON THEN                                            0996 03218000
         TM    VSNONONV(ARGLPTR),B'00100000'                       0996 03219000
         BNO   @RF00996                                            0996 03220000
*     DO;                           /*                       @Y30LB37*/ 03221000
*       CALL FMT1READ(ORGTNONV,PROTTALL);/*                  @Y30LB37*/ 03222000
         LA    @01,@AL00998                                        0998 03223000
         BAL   @14,FMT1READ                                        0998 03224000
*       RESPECIFY                                                  0999 03225000
*         RTNREG RSTD;                                             0999 03226000
*       TESTRC=RTNREG;                                             1000 03227000
         STH   RTNREG,TESTRC                                       1000 03228000
*       RESPECIFY                                                  1001 03229000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 03230000
*       IF TESTRC=0 THEN                                           1002 03231000
         LH    @05,TESTRC                                          1002 03232000
         LTR   @05,@05                                             1002 03233000
         BNZ   @RF01002                                            1002 03234000
*         DO;                       /*                       @Y30LB37*/ 03235000
*                                                                  1003 03236000
*           /*********************************************************/ 03237000
*           /*                                                       */ 03238000
*           /* ISSUE A UPRINT MACRO IF THE VOLUME HAS        @Y30LB37*/ 03239000
*           /* SUCCESSFULLY READ A FORMAT 1. THE ERROR       @Y30LB37*/ 03240000
*           /* MESSAGE IS IDC2961I WITH THREE VARIATIONS     @Y30LB37*/ 03241000
*           /* ACCORDING TO THE WAY VSMSG IS SET.            @Y30LB37*/ 03242000
*           /*                                                       */ 03243000
*           /*********************************************************/ 03244000
*                                                                  1004 03245000
*           FMT1CRC=4;              /*                       @Y30LB37*/ 03246000
         LA    FMT1CRC,4                                           1004 03247000
*           DARGSMOD=MSGMODID;      /*                       @Y30LB37*/ 03248000
         L     @05,DDSTRU                                          1005 03249000
         MVC   DARGSMOD(3,@05),@CC01408                            1005 03250000
*           DARGDBP=VSVOLP;         /*                       @Y30LB37*/ 03251000
         L     @03,VSVOLP(,ARGLPTR)                                1006 03252000
         ST    @03,DARGDBP(,@05)                                   1006 03253000
*           DARGILP=VOLSERLN;       /*                       @Y30LB37*/ 03254000
         MVC   DARGILP(2,@05),@CH00035                             1007 03255000
*           IF VSFROMV=OFF&VSTOV=OFF THEN                          1008 03256000
         TM    VSFROMV(ARGLPTR),B'11000000'                        1008 03257000
         BNZ   @RF01008                                            1008 03258000
*             DARGSENT=MSG2961A;    /*                       @Y30LB37*/ 03259000
         MVI   DARGSENT(@05),X'03'                                 1009 03260000
*           ELSE                                                   1010 03261000
*             IF VSFROMV=ON THEN                                   1010 03262000
         B     @RC01008                                            1010 03263000
@RF01008 TM    VSFROMV(ARGLPTR),B'10000000'                        1010 03264000
         BNO   @RF01010                                            1010 03265000
*               DARGSENT=MSG2961B;  /*                       @Y30LB37*/ 03266000
         L     @03,DDSTRU                                          1011 03267000
         MVI   DARGSENT(@03),X'0F'                                 1011 03268000
*             ELSE                                                 1012 03269000
*               DARGSENT=MSG2961C;  /*                       @Y30LB37*/ 03270000
         B     @RC01010                                            1012 03271000
@RF01010 L     @03,DDSTRU                                          1012 03272000
         MVI   DARGSENT(@03),X'10'                                 1012 03273000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB37*/ 03274000
@RC01010 DS    0H                                                  1013 03275000
@RC01008 L     @03,@PC00001                                        1013 03276000
         ST    @03,@AL00001                                        1013 03277000
         LA    @15,@CF00120                                        1013 03278000
         ST    @15,@AL00001+4                                      1013 03279000
         LA    @15,DDSTRU                                          1013 03280000
         ST    @15,@AL00001+8                                      1013 03281000
         MVI   @AL00001+8,X'80'                                    1013 03282000
         L     @15,GDTPRT(,@03)                                    1013 03283000
         LA    @01,@AL00001                                        1013 03284000
         BALR  @14,@15                                             1013 03285000
*         END;                      /*                       @Y30LB37*/ 03286000
*       IF TESTRC=4 THEN                                           1015 03287000
@RF01002 LA    @03,4                                               1015 03288000
         CH    @03,TESTRC                                          1015 03289000
         BNE   @RF01015                                            1015 03290000
*         FMT1CRC=4;                /*                       @Y30LB37*/ 03291000
         LR    FMT1CRC,@03                                         1016 03292000
*     END;                          /*                       @Y30LB37*/ 03293000
*                                                                  1018 03294000
*   /*****************************************************************/ 03295000
*   /*                                                               */ 03296000
*   /* CALL THE FMT1READ PROCEDURE IF VSNONONV BIT IS OFF.   @Y30LB37*/ 03297000
*   /* FMT1READ GETS THE ORGTYPE SET TO NONV IF THE PASSED   @Y30LB37*/ 03298000
*   /* PARAMETER IS CATGOOD TO READ ONLY FOR NON-VSAM DATA   @Y30LB37*/ 03299000
*   /* SETS SINCE VSAM CATALOG PASSWORD HAS ALREADY          @Y30LB37*/ 03300000
*   /* BEEN VERIFIED. IF VSREAD IS SET THE PROTTYPE          @Y30LB37*/ 03301000
*   /* IS SET TO READ. IF VSWRITE IS SET THE PROTTYPE        @Y30LB37*/ 03302000
*   /* IS SET TO WRITE. IF FMT1READ IS SUCCESSFUL THEN       @Y30LB37*/ 03303000
*   /* CONTINUE WITH THE SECURITY CHECK. IF FMT1READ IS      @Y30LB37*/ 03304000
*   /* UNSUCCESSFUL THEN SET FMT1CRC TO FOUR.                @Y30LB37*/ 03305000
*   /*                                                               */ 03306000
*   /*****************************************************************/ 03307000
*                                                                  1018 03308000
*   ELSE                                                           1018 03309000
*     DO;                           /*                       @Y30LB37*/ 03310000
         B     @RC00996                                            1018 03311000
@RF00996 DS    0H                                                  1019 03312000
*       V1DDCNT=''B;                /*                       @Y30LB37*/ 03313000
         SLR   @03,@03                                             1019 03314000
         STH   @03,V1DDCNT                                         1019 03315000
*       SECHKSW=OFF;                /*                       @Y30LB37*/ 03316000
*                                                                  1020 03317000
         NI    SECHKSW,B'11111011'                                 1020 03318000
*       /*************************************************************/ 03319000
*       /*                                                           */ 03320000
*       /* DO WHILE LOOP WHILE SECHKSW IS TURNED OFF.        @Y30LB37*/ 03321000
*       /*                                                           */ 03322000
*       /*************************************************************/ 03323000
*                                                                  1021 03324000
*SECKLOOP:                                                         1021 03325000
*       DO WHILE SECHKSW=OFF;       /*                       @Y30LB37*/ 03326000
SECKLOOP B     @DE01021                                            1021 03327000
@DL01021 DS    0H                                                  1022 03328000
*         IF VSREAD=ON THEN                                        1022 03329000
         TM    VSREAD(ARGLPTR),B'00010000'                         1022 03330000
         BNO   @RF01022                                            1022 03331000
*           PROTAREA=PROTREAD;      /*                       @Y30LB37*/ 03332000
         MVC   PROTAREA(8),PROTREAD                                1023 03333000
*         ELSE                                                     1024 03334000
*           PROTAREA=PROTRITE;      /*                       @Y30LB37*/ 03335000
         B     @RC01022                                            1024 03336000
@RF01022 MVC   PROTAREA(8),PROTRITE                                1024 03337000
*         IF FM1PASS=CATGOOD THEN                                  1025 03338000
@RC01022 L     @03,@PC00013                                        1025 03339000
         CLC   FM1PASS(4,@03),CATGOOD                              1025 03340000
         BNE   @RF01025                                            1025 03341000
*           ORGTAREA=ORGTNONV;      /*                       @Y30LB37*/ 03342000
         MVC   ORGTAREA(4),ORGTNONV                                1026 03343000
*         ELSE                                                     1027 03344000
*           ORGTAREA=ORGTALL;       /*                       @Y30LB37*/ 03345000
         B     @RC01025                                            1027 03346000
@RF01025 MVC   ORGTAREA(4),ORGTALL                                 1027 03347000
*         CALL FMT1READ(ORGTAREA,PROTAREA);/*                @Y30LB37*/ 03348000
@RC01025 LA    @03,ORGTAREA                                        1028 03349000
         ST    @03,@AL00001                                        1028 03350000
         LA    @03,PROTAREA                                        1028 03351000
         ST    @03,@AL00001+4                                      1028 03352000
         LA    @01,@AL00001                                        1028 03353000
         BAL   @14,FMT1READ                                        1028 03354000
*         RESPECIFY                                                1029 03355000
*           RTNREG RSTD;                                           1029 03356000
*         TESTRC=RTNREG;                                           1030 03357000
         STH   RTNREG,TESTRC                                       1030 03358000
*         RESPECIFY                                                1031 03359000
*           RTNREG UNRSTD;          /*                       @Y30LB37*/ 03360000
*         IF TESTRC=4 THEN                                         1032 03361000
         LH    @03,TESTRC                                          1032 03362000
         LA    @15,4                                               1032 03363000
         CR    @03,@15                                             1032 03364000
         BNE   @RF01032                                            1032 03365000
*           DO;                     /*                       @Y30LB37*/ 03366000
*             FMT1CRC=4;            /*                       @Y30LB37*/ 03367000
         LR    FMT1CRC,@15                                         1034 03368000
*             SECHKSW=ON;           /*                       @Y30LB37*/ 03369000
         OI    SECHKSW,B'00000100'                                 1035 03370000
*           END;                    /*                       @Y30LB37*/ 03371000
*         IF TESTRC=RCEOFILE THEN                                  1037 03372000
@RF01032 CLC   TESTRC(2),@CH00040                                  1037 03373000
         BNE   @RF01037                                            1037 03374000
*           SECHKSW=ON;             /*                       @Y30LB37*/ 03375000
         OI    SECHKSW,B'00000100'                                 1038 03376000
*                                                                  1039 03377000
*         /***********************************************************/ 03378000
*         /*                                                         */ 03379000
*         /* CALL VSAMCHK, EXPIRCHK, OR NVSAMCHK DEPENDING   @Y30LB37*/ 03380000
*         /* ON IF THE FORMAT 1 IS A VSAM DATA SET OR THE    @Y30LB37*/ 03381000
*         /* EXPONLY SWITCH IS SET (CHECK THE EXPIRATION     @Y30LB37*/ 03382000
*         /* DATE).                                          @Y30LB37*/ 03383000
*         /*                                                         */ 03384000
*         /***********************************************************/ 03385000
*                                                                  1039 03386000
*         IF TESTRC=0 THEN                                         1039 03387000
@RF01037 LH    @03,TESTRC                                          1039 03388000
         LTR   @03,@03                                             1039 03389000
         BNZ   @RF01039                                            1039 03390000
*           DO;                     /*                       @Y30LB37*/ 03391000
*             IF DSORGAM=ON THEN                                   1041 03392000
         TM    DSORGAM(F1PTR),B'00001000'                          1041 03393000
         BNO   @RF01041                                            1041 03394000
*               CALL VSAMCHK;       /*                       @Y30LB37*/ 03395000
         BAL   @14,VSAMCHK                                         1042 03396000
*             ELSE                                                 1043 03397000
*               IF EXPONLY=ON THEN                                 1043 03398000
         B     @RC01041                                            1043 03399000
@RF01041 TM    EXPONLY,B'10000000'                                 1043 03400000
         BNO   @RF01043                                            1043 03401000
*                 CALL EXPIRCHK;    /*                       @Y30LB37*/ 03402000
         BAL   @14,EXPIRCHK                                        1044 03403000
*               ELSE                                               1045 03404000
*                 CALL NVSAMCHK;    /*                       @Y30LB37*/ 03405000
         B     @RC01043                                            1045 03406000
@RF01043 BAL   @14,NVSAMCHK                                        1045 03407000
*             RESPECIFY                                            1046 03408000
*               RTNREG RSTD;                                       1046 03409000
@RC01043 DS    0H                                                  1046 03410000
@RC01041 DS    0H                                                  1047 03411000
*             TESTRC=RTNREG;                                       1047 03412000
         STH   RTNREG,TESTRC                                       1047 03413000
*             RESPECIFY                                            1048 03414000
*               RTNREG UNRSTD;      /*                       @Y30LB37*/ 03415000
*             IF TESTRC=4 THEN                                     1049 03416000
         LH    @03,TESTRC                                          1049 03417000
         LA    @15,4                                               1049 03418000
         CR    @03,@15                                             1049 03419000
         BNE   @RF01049                                            1049 03420000
*               DO;                 /*                       @Y30LB37*/ 03421000
*                 FMT1CRC=4;        /*                       @Y30LB37*/ 03422000
         LR    FMT1CRC,@15                                         1051 03423000
*                 SECHKSW=ON;       /*                       @Y30LB37*/ 03424000
         OI    SECHKSW,B'00000100'                                 1052 03425000
*               END;                /*                       @Y30LB37*/ 03426000
*             IF TESTRC=8 THEN                                     1054 03427000
@RF01049 LH    @03,TESTRC                                          1054 03428000
         C     @03,@CF00040                                        1054 03429000
         BNE   @RF01054                                            1054 03430000
*               FMT1CRC=TESTRC;     /*                       @Y30LB37*/ 03431000
         LR    FMT1CRC,@03                                         1055 03432000
*           END;                    /*                       @Y30LB37*/ 03433000
@RF01054 DS    0H                                                  1057 03434000
*       END SECKLOOP;               /*                       @Y30LB37*/ 03435000
@RF01039 DS    0H                                                  1057 03436000
@DE01021 TM    SECHKSW,B'00000100'                                 1057 03437000
         BZ    @DL01021                                            1057 03438000
*     END;                          /*                       @Y30LB37*/ 03439000
*   RETURN CODE(FMT1CRC);           /* RETURN TO MAIN ROUTINE      1059 03440000
*                                                            @Y30LB37*/ 03441000
@RC00996 LR    @15,FMT1CRC                                         1059 03442000
         L     @14,@SA00013                                        1059 03443000
         LM    @00,@12,@SA00013+8                                  1059 03444000
         BR    @14                                                 1059 03445000
*   END FMT1CHK;                    /* END OF FMT1CHK PROC   @Y30LB37*/ 03446000
*                                                                  1061 03447000
*/********************************************************************/ 03448000
*/*                                                                  */ 03449000
*/*  PROCEDURE NAME - VSAMCHK                                @Y30LB37*/ 03450000
*/*                                                          @Y30LB37*/ 03451000
*/*  FUNCTION - THIS PROCEDURE OPENS THE VSAM DATA           @Y30LB37*/ 03452000
*/*             SPACE.  ISSUES THE UEXCP MACRO TO OPEN THE   @Y30LB37*/ 03453000
*/*             DATA SPACE, AND UEXCP MACRO TO CLOSE THE     @Y30LB37*/ 03454000
*/*             DATA SPACE.                                  @Y30LB37*/ 03455000
*/*                                                          @Y30LB37*/ 03456000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 03457000
*/*          LIST:  FIELD VSFILEP.  DS1DSNAM FIELD IN THE    @Y30LB37*/ 03458000
*/*          FORMAT 1 DSCB.                                  @Y30LB37*/ 03459000
*/*                                                          @Y30LB37*/ 03460000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO,      @Y30LB37*/ 03461000
*/*          FOUR OR EIGHT ERROR CODES.                      @Y30LB37*/ 03462000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 03463000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 03464000
*/*          4 - ERROR OPENING DATA SET                      @Y30LB37*/ 03465000
*/*          8 - ERROR CLOSING DATA SET                      @Y30LB37*/ 03466000
*/*                                                                  */ 03467000
*/********************************************************************/ 03468000
*                                                                  1061 03469000
*VSAMCHK:                                                          1061 03470000
*   PROCEDURE;                      /*                       @Y30LB37*/ 03471000
*                                                                  1061 03472000
VSAMCHK  STM   @14,@12,@SA00014                                    1061 03473000
*   /*****************************************************************/ 03474000
*   /*                                                               */ 03475000
*   /* LOCAL DECLARATIONS FOR VSAMCHK                        @Y30LB37*/ 03476000
*   /*                                                               */ 03477000
*   /*****************************************************************/ 03478000
*                                                                  1062 03479000
*   DCL                                                            1062 03480000
*     VSAMCRC FIXED(15);            /* VSAMCHK RETURN CODE   @Y30LB37*/ 03481000
*                                                                  1063 03482000
*   /*****************************************************************/ 03483000
*   /*                                                               */ 03484000
*   /* INITIALIZE THE OPEN ARGUMENT LIST AND OPEN THE DATA   @Y30LB37*/ 03485000
*   /* SET VIA THE UEXCP MACRO. IF THE OPEN WAS NOT          @Y30LB37*/ 03486000
*   /* SUCCESSFUL, SET THE RETURN CODE TO RCFAIL.            @Y30LB37*/ 03487000
*   /*                                                               */ 03488000
*   /*****************************************************************/ 03489000
*                                                                  1063 03490000
*   RFY                                                            1063 03491000
*     EXOARG BASED(ADDR(EXOLIST));  /*                       @Y30LB37*/ 03492000
*   OLDERID2=NEWERID2;                                             1064 03493000
         L     @03,@PC00001                                        1064 03494000
         L     @15,GDTTR2(,@03)                                    1064 03495000
         MVC   @TS00001(95),NEWERID2(@15)                          1064 03496000
         MVC   OLDERID2(95,@15),@TS00001                           1064 03497000
*   NEWID2='VSVC';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 03498000
         MVC   NEWID2(4,@15),@CC01626                              1065 03499000
*   VSAMCRC=0;                      /*                       @Y30LB37*/ 03500000
         SLR   VSAMCRC,VSAMCRC                                     1066 03501000
*   RTNAREA=''B;                    /*                       @Y30LB37*/ 03502000
         SLR   @15,@15                                             1067 03503000
         ST    @15,RTNAREA                                         1067 03504000
*   EXOARG=''B;                     /*                       @Y30LB37*/ 03505000
         LA    @15,EXOLIST                                         1068 03506000
         XC    EXOARG(34,@15),EXOARG(@15)                          1068 03507000
*   EXOPASS=ON;                     /*                       @Y30LB37*/ 03508000
         OI    EXOPASS(@15),B'00100000'                            1069 03509000
*   EXOVSN=VSVOLP;                  /* INSERT VOLUME SERIAL  @ZA09532*/ 03510000
         L     @14,VSVOLP(,ARGLPTR)                                1070 03511000
         ST    @14,EXOVSN(,@15)                                    1070 03512000
*   EXODDN=VSFILEP;                 /*                       @Y30LB37*/ 03513000
         L     @14,VSFILEP(,ARGLPTR)                               1071 03514000
         ST    @14,EXODDN(,@15)                                    1071 03515000
*   EXODSN=ADDR(DS1DSNAM);          /*                       @Y30LB37*/ 03516000
         ST    F1PTR,EXODSN(,@15)                                  1072 03517000
*   EXOCTLBK=ADDR(RTNAREA);         /*                       @Y30LB37*/ 03518000
         LA    @14,RTNAREA                                         1073 03519000
         ST    @14,EXOCTLBK(,@15)                                  1073 03520000
*   EXOREAD=ON;                     /*                       @Y30LB37*/ 03521000
         OI    EXOREAD(@15),B'10000000'                            1074 03522000
*   CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                     @Y30LB37*/ 03523000
         ST    @03,@AL00001                                        1075 03524000
         LA    @14,OPEN                                            1075 03525000
         ST    @14,@AL00001+4                                      1075 03526000
         ST    @15,@AL00001+8                                      1075 03527000
         MVI   @AL00001+8,X'80'                                    1075 03528000
         L     @15,GDTEXP(,@03)                                    1075 03529000
         LA    @01,@AL00001                                        1075 03530000
         BALR  @14,@15                                             1075 03531000
*   RESPECIFY                                                      1076 03532000
*     RTNREG RSTD;                                                 1076 03533000
*   TESTRC=RTNREG;                                                 1077 03534000
         STH   RTNREG,TESTRC                                       1077 03535000
*   RESPECIFY                                                      1078 03536000
*     RTNREG UNRSTD;                /*                       @Y30LB37*/ 03537000
*   IF TESTRC^=0 THEN                                              1079 03538000
         LH    @03,TESTRC                                          1079 03539000
         LTR   @03,@03                                             1079 03540000
         BZ    @RF01079                                            1079 03541000
*     VSAMCRC=4;                    /*                       @Y30LB37*/ 03542000
*                                                                  1080 03543000
         LA    VSAMCRC,4                                           1080 03544000
*   /*****************************************************************/ 03545000
*   /*                                                               */ 03546000
*   /* IF THE OPEN WAS SUCCESSFUL THEN ISSUE THE CLOSE       @Y30LB37*/ 03547000
*   /* MACRO VIA THE UEXCP MACRO. IF THE OPEN WAS NOT        @Y30LB37*/ 03548000
*   /* SUCCESSFUL, SET THE RETURN CODE TO RCNCLOSE UNLESS    @Y30LB37*/ 03549000
*   /* THE RETURN CODE IS RCFAIL.                            @Y30LB37*/ 03550000
*   /*                                                               */ 03551000
*   /*****************************************************************/ 03552000
*                                                                  1081 03553000
*   IF RTNAREA^=NULLPTR THEN                                       1081 03554000
@RF01079 L     @03,RTNAREA                                         1081 03555000
         LTR   @03,@03                                             1081 03556000
         BZ    @RF01081                                            1081 03557000
*     DO;                           /*                       @Y30LB37*/ 03558000
*       CALL IDCIO050(GDTTBL,CLOSE,RTNAREA);/*               @Y30LB37*/ 03559000
         L     @03,@PC00001                                        1083 03560000
         ST    @03,@AL00001                                        1083 03561000
         LA    @15,CLOSE                                           1083 03562000
         ST    @15,@AL00001+4                                      1083 03563000
         LA    @15,RTNAREA                                         1083 03564000
         ST    @15,@AL00001+8                                      1083 03565000
         MVI   @AL00001+8,X'80'                                    1083 03566000
         L     @15,GDTEXP(,@03)                                    1083 03567000
         LA    @01,@AL00001                                        1083 03568000
         BALR  @14,@15                                             1083 03569000
*       RESPECIFY                                                  1084 03570000
*         RTNREG RSTD;                                             1084 03571000
*       TESTRC=RTNREG;                                             1085 03572000
         STH   RTNREG,TESTRC                                       1085 03573000
*       RESPECIFY                                                  1086 03574000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 03575000
*       IF TESTRC^=0&VSAMCRC^=4 THEN                               1087 03576000
         LH    @03,TESTRC                                          1087 03577000
         LTR   @03,@03                                             1087 03578000
         BZ    @RF01087                                            1087 03579000
         C     VSAMCRC,@CF00046                                    1087 03580000
         BE    @RF01087                                            1087 03581000
*         VSAMCRC=8;                /*                       @Y30LB37*/ 03582000
         LA    VSAMCRC,8                                           1088 03583000
*     END;                          /*                       @Y30LB37*/ 03584000
@RF01087 DS    0H                                                  1090 03585000
*   RETURN CODE(VSAMCRC);           /* RETURN TO MAIN ROUTINE      1090 03586000
*                                                            @Y30LB37*/ 03587000
@RF01081 LR    @15,VSAMCRC                                         1090 03588000
         L     @14,@SA00014                                        1090 03589000
         LM    @00,@12,@SA00014+8                                  1090 03590000
         BR    @14                                                 1090 03591000
*   END VSAMCHK;                    /* END OF VSAMCHK PROC   @Y30LB37*/ 03592000
*                                                                  1092 03593000
*/********************************************************************/ 03594000
*/*                                                                  */ 03595000
*/*  PROCEDURE NAME - NVSAMCHK                               @Y30LB37*/ 03596000
*/*                                                          @Y30LB37*/ 03597000
*/* FUNCTION - THIS PROC OPENS THE NON-VSAM NON-RACF DATA    @G24LB31*/ 03598000
*/*             SET.  ISSUES THE UIOINFO MACRO TO LOCATE THE @Y30LB37*/ 03599000
*/*             DSNAME THAT CORRESPONDS TO THE DD CARDS FOR  @Y30LB37*/ 03600000
*/*             PASSWORD CHECKING.  ISSUES THE UEXCP         @Y30LB37*/ 03601000
*/*             MACRO TO OPEN THE DATA SET, AND UEXCP        @Y30LB37*/ 03602000
*/*             MACRO TO CLOSE THE DATA  SET.                @Y30LB37*/ 03603000
*/*             ISSUES UPRINT MACRO TO PRINT MESSAGE         @Y30LB37*/ 03604000
*/*             IDC2960I IF ANY PASSWORD FILE ERRORS.        @Y30LB37*/ 03605000
*/*             FOR RACF PROTECTED NON-VSAM DATA SETS,       @G24LB31*/ 03606000
*/*             ISSUES THE URACHECK MACRO FOR RACF           @G24LB31*/ 03607000
*/*             AUTHORIZATION CHECKING.                      @G24LB31*/ 03608000
*/*                                                          @Y30LB37*/ 03609000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 03610000
*/*          LIST:  FIELDS VSFILEP AND VSVOLP.  VSFILEP      @Y30LB37*/ 03611000
*/*          POINTS TO A TABLE OF DDNAMES FOR THE PASSWORD   @Y30LB37*/ 03612000
*/*          FILES SPECIFIED ON THE UTILITY COMMAND.  THE    @Y30LB37*/ 03613000
*/*          FORMAT 1 DSCB OF DATA SET TO BE RACF OR         @G24LB31*/ 03614000
*/*          PASSWORD CHECKED.                               @G24LB31*/ 03615000
*/*          V1DSNTBL IS SET WITH THE DDNAME AND COR-        @G24LB31*/ 03616000
*/*          RESPONDING DATA SET NAME OF THOSE PASSWORD      @Y30LB37*/ 03617000
*/*          DD CARD FOR WHICH UIOINFO HAS ALREADY BEEN      @Y30LB37*/ 03618000
*/*          ISSUED.                                         @Y30LB37*/ 03619000
*/*                                                          @Y30LB37*/ 03620000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO,      @Y30LB37*/ 03621000
*/*          FOUR OR EIGHT ERROR CODES. V1DSNTBL IS UPDATED  @Y30LB37*/ 03622000
*/*          WITH MORE DDNAMES AND CORRESPONDING DSNAMES.    @Y30LB37*/ 03623000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 03624000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 03625000
*/*          4 - ERROR OPENING DATA SET                      @Y30LB37*/ 03626000
*/*              NO DD CARD FOR DATA SET                     @Y30LB37*/ 03627000
*/*              ERROR RETRIEVING THE NAME OF THE DATA SET   @Y30LB37*/ 03628000
*/*          8 - ERROR CLOSING DATA SET                      @Y30LB37*/ 03629000
*/*                                                                  */ 03630000
*/********************************************************************/ 03631000
*                                                                  1092 03632000
*NVSAMCHK:                                                         1092 03633000
*   PROCEDURE;                      /*                       @Y30LB37*/ 03634000
NVSAMCHK STM   @14,@12,@SA00015                                    1092 03635000
*                                                                  1093 03636000
*   /*****************************************************************/ 03637000
*   /*                                                               */ 03638000
*   /* LOCAL DECLARATIONS FOR NVSAMCHK                       @Y30LB37*/ 03639000
*   /*                                                               */ 03640000
*   /*****************************************************************/ 03641000
*                                                                  1093 03642000
*   DCL                                                            1093 03643000
*     NVSAMRC FIXED(15);            /* NVSAMCHK RETURN CODE  @Y30LB37*/ 03644000
*   DCL                                                            1094 03645000
*     NVCOUNT FIXED(15);            /* DDNAME INTERNAL COUNT @Y30LB37*/ 03646000
*                                                                  1094 03647000
*   /*****************************************************************/ 03648000
*   /*                                                               */ 03649000
*   /* DECLARATION FOR PASSWORD FILE TABLE IN FDT.           @Y30LB37*/ 03650000
*   /*                                                               */ 03651000
*   /*****************************************************************/ 03652000
*                                                                  1095 03653000
*   DCL                                                            1095 03654000
*     1 PFILE BASED(VSPFILEP) BDY(HWORD),                          1095 03655000
*      2 PFILECNT FIXED(15),        /* COUNT OF ENTRIES      @Y30LB37*/ 03656000
*      2 *(255) BDY(HWORD),                                        1095 03657000
*       3 PFILELEN FIXED(8),        /* DATA ITEM LENGTH      @Y30LB37*/ 03658000
*       3 PFILEVAL CHAR(8);         /* DATA ITEM VALUE       @Y30LB37*/ 03659000
*   DCL                                                            1096 03660000
*     1 IOINFBLK BDY(WORD),         /* UIOINFO RETURN AREA   @Y30LB37*/ 03661000
*      2 IOHEADLN FIXED(15),        /* HEADER LENGTH PASSED  @Y30LB37*/ 03662000
*      2 IOHEAD02 FIXED(15),        /* HEADER LEN RETURNED   @Y30LB37*/ 03663000
*      2 IOID CHAR(2),              /* ID FIELD              @Y30LB37*/ 03664000
*      2 IOLENGTH CHAR(2),          /* DATA LENGTH           @Y30LB37*/ 03665000
*      2 IORETDSN CHAR(44);         /* RETURNED DSNAME       @Y30LB37*/ 03666000
*   DCL                                                            1097 03667000
*     IOINFBYT CHAR(1);             /* UIOINFO OPTION BYTE   @Y30LB37*/ 03668000
*   DCL                                                            1098 03669000
*     V1NVDDNM CHAR(8);             /* UIOINFO DDNAME        @Y30LB37*/ 03670000
*   DCL                                                            1099 03671000
*     IOBLKPTR PTR(31);             /* POINTER TO IOINFOBLK  @Y30LB37*/ 03672000
*                                                                  1100 03673000
*   /*****************************************************************/ 03674000
*   /*                                                               */ 03675000
*   /* ISSUE UTRACE MACRO AND INITIALIZE THE RETURN CODE.    @Y30LB37*/ 03676000
*   /*                                                               */ 03677000
*   /*****************************************************************/ 03678000
*                                                                  1100 03679000
*   RFY                                                            1100 03680000
*     IOINFOPT BASED(ADDR(IOINFBYT));/*                      @Y30LB37*/ 03681000
*   RFY                                                            1101 03682000
*     EXOARG BASED(ADDR(EXOLIST));  /*                       @Y30LB37*/ 03683000
*   OLDERID2=NEWERID2;                                             1102 03684000
         L     @03,@PC00001                                        1102 03685000
         L     @03,GDTTR2(,@03)                                    1102 03686000
         MVC   @TS00001(95),NEWERID2(@03)                          1102 03687000
         MVC   OLDERID2(95,@03),@TS00001                           1102 03688000
*   NEWID2='VSNC';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 03689000
         MVC   NEWID2(4,@03),@CC01650                              1103 03690000
*   OPENSW=OFF;                     /*                       @Y30LB37*/ 03691000
         NI    OPENSW,B'11111101'                                  1104 03692000
*   NVSAMRC=0;                      /*                       @Y30LB37*/ 03693000
         SLR   NVSAMRC,NVSAMRC                                     1105 03694000
*   IOINFBYT=''B;                   /*                       @Y30LB37*/ 03695000
         MVI   IOINFBYT,X'00'                                      1106 03696000
*   RTNAREA=''B;                    /*                       @Y30LB37*/ 03697000
         SLR   @03,@03                                             1107 03698000
         ST    @03,RTNAREA                                         1107 03699000
*   EXOARG=''B;                     /*                       @Y30LB37*/ 03700000
         LA    @03,EXOLIST                                         1108 03701000
         XC    EXOARG(34,@03),EXOARG(@03)                          1108 03702000
*                                                                  1109 03703000
*   /*****************************************************************/ 03704000
*   /*                                                               */ 03705000
*   /*                                                       @G24LB31*/ 03706000
*   /* IF THE NON-VSAM DATA SET IS RACF PROTECTED,           @G24LB31*/ 03707000
*   /* ISSUE THE URACHECK MACRO TO VERIFY ACCESS TO          @G24LB31*/ 03708000
*   /* THE RACF PROTECTED NON-VSAM DATA SET.                 @G24LB31*/ 03709000
*   /*                                                       @G24LB31*/ 03710000
*   /*                                                               */ 03711000
*   /*****************************************************************/ 03712000
*                                                                  1109 03713000
*   IF PROTRACF=ON THEN             /*                       @G24LB31*/ 03714000
         TM    PROTRACF(F1PTR),B'01000000'                         1109 03715000
         BNO   @RF01109                                            1109 03716000
*     DO;                           /*                       @G24LB31*/ 03717000
*       VS1RACF=''B;                /*                       @G24LB31*/ 03718000
         XC    VS1RACF(20),VS1RACF                                 1111 03719000
*       RACFDSTV=OFF;               /* RACF NON-VSAM D.S.    @G24LB31*/ 03720000
         LA    @03,VS1RACF                                         1112 03721000
         NI    RACFDSTV(@03),B'11101111'                           1112 03722000
*       IF VSREAD=ON THEN           /*                       @G24LB31*/ 03723000
         TM    VSREAD(ARGLPTR),B'00010000'                         1113 03724000
         BNO   @RF01113                                            1113 03725000
*         RACFTRD=ON;               /* RACF READ ACCESS      @G24LB31*/ 03726000
         OI    RACFTRD(@03),B'00000010'                            1114 03727000
*       ELSE                        /*                       @G24LB31*/ 03728000
*         RACFTUPD=ON;              /* RACF UPDATE ACCESS    @G24LB31*/ 03729000
         B     @RC01113                                            1115 03730000
@RF01113 LA    @03,VS1RACF                                         1115 03731000
         OI    RACFTUPD(@03),B'00000100'                           1115 03732000
*       RACFENT=ADDR(DS1DSNAM);     /*                       @G24LB31*/ 03733000
@RC01113 LA    @03,VS1RACF                                         1116 03734000
         ST    F1PTR,RACFENT(,@03)                                 1116 03735000
*       RACFCLN=ADDR(CLASSRAC);     /* RACF PROTECTION CLASS @G24LB31*/ 03736000
         LA    @15,CLASSRAC                                        1117 03737000
         ST    @15,RACFCLN(,@03)                                   1117 03738000
*       CLASSLEN=LENGTH(CLASSDS);   /*                       @G24LB31*/ 03739000
         MVI   CLASSLEN,X'07'                                      1118 03740000
*       CLASSNM=CLASSDS;            /*                       @G24LB31*/ 03741000
         MVI   CLASSNM+7,C' '                                      1119 03742000
         MVC   CLASSNM(7),CLASSDS                                  1119 03743000
*       RACFVOLS=VSVOLP;            /*                       @G24LB31*/ 03744000
         L     @15,VSVOLP(,ARGLPTR)                                1120 03745000
         ST    @15,RACFVOLS(,@03)                                  1120 03746000
*       CALL IDCSARK0(GDTTBL,VRACFPTR);/*                    @G24LB31*/ 03747000
         L     @03,@PC00001                                        1121 03748000
         ST    @03,@AL00001                                        1121 03749000
         LA    @15,VRACFPTR                                        1121 03750000
         ST    @15,@AL00001+4                                      1121 03751000
         MVI   @AL00001+4,X'80'                                    1121 03752000
         L     @15,GDTRCK(,@03)                                    1121 03753000
         LA    @01,@AL00001                                        1121 03754000
         BALR  @14,@15                                             1121 03755000
*       RESPECIFY                                                  1122 03756000
*         RTNREG RSTD;                                             1122 03757000
*       TESTRC=RTNREG;                                             1123 03758000
         STH   RTNREG,TESTRC                                       1123 03759000
*       RESPECIFY                                                  1124 03760000
*         RTNREG UNRSTD;            /*                       @G24LB31*/ 03761000
*                                                                  1124 03762000
*       /*************************************************************/ 03763000
*       /*                                                           */ 03764000
*       /* ************************************************* @G24LB31*/ 03765000
*       /*                                                   @G24LB31*/ 03766000
*       /* IF URACHECK MACRO IS UNSUCCESSFUL, SET RETURN     @G24LB31*/ 03767000
*       /* CODE TO RCFAIL.                                   @G24LB31*/ 03768000
*       /*                                                   @G24LB31*/ 03769000
*       /* ************************************************* @G24LB31*/ 03770000
*       /*                                                           */ 03771000
*       /*************************************************************/ 03772000
*                                                                  1125 03773000
*       IF TESTRC^=0 THEN           /*                       @G24LB31*/ 03774000
         LH    @03,TESTRC                                          1125 03775000
         LTR   @03,@03                                             1125 03776000
         BZ    @RF01125                                            1125 03777000
*         NVSAMRC=4;                /*                       @G24LB31*/ 03778000
         LA    NVSAMRC,4                                           1126 03779000
*     END;                          /*                       @G24LB31*/ 03780000
*                                                                  1128 03781000
*   /*****************************************************************/ 03782000
*   /*                                                               */ 03783000
*   /*                                                       @G24LB31*/ 03784000
*   /* IF THE DATA SET IS NOT RACF PROTECTED, PROCEED WITH   @G24LB31*/ 03785000
*   /* PASSWORD PROTECTION CHECKING.                         @G24LB31*/ 03786000
*   /*                                                       @G24LB31*/ 03787000
*   /*                                                               */ 03788000
*   /*****************************************************************/ 03789000
*                                                                  1128 03790000
*   ELSE                            /*                       @G24LB31*/ 03791000
*NONRACF:                           /*                       @G24LB31*/ 03792000
*     DO;                           /*                       @G24LB31*/ 03793000
*                                                                  1128 03794000
         B     @RC01109                                            1128 03795000
@RF01109 DS    0H                                                  1128 03796000
NONRACF  DS    0H                                                  1129 03797000
*       /*************************************************************/ 03798000
*       /*                                                           */ 03799000
*       /*                                                   @G24LB31*/ 03800000
*       /* CHECK IF PFILE LIST WAS SPECIFIED. IF NOT THEN    @G24LB31*/ 03801000
*       /* SET RETURN CODE TO PRINT MESSAGE IDC2960I.        @G24LB31*/ 03802000
*       /*                                                   @G24LB31*/ 03803000
*       /*                                                           */ 03804000
*       /*************************************************************/ 03805000
*                                                                  1129 03806000
*       IF VSPFILEP=NULLPTR THEN                                   1129 03807000
         L     @03,VSPFILEP(,ARGLPTR)                              1129 03808000
         LTR   @03,@03                                             1129 03809000
         BNZ   @RF01129                                            1129 03810000
*         NVSAMRC=RCPRTMSG;         /*                       #Y30LB37*/ 03811000
*                                                                  1130 03812000
         LA    NVSAMRC,16                                          1130 03813000
*       /*************************************************************/ 03814000
*       /*                                                           */ 03815000
*       /* PROCESS THE INTERNAL DSNAME TABLE OF PASSWORD FILE        */ 03816000
*       /*                                                   @Y30LB37*/ 03817000
*       /* DDNAMES AND CORRESPONDING DSNAMES TO FIND THE DSNAME      */ 03818000
*       /*                                                   @Y30LB37*/ 03819000
*       /* PASSED AS INPUT. IF THE DSNAME IS FOUND TURN ON THE       */ 03820000
*       /*                                                   @Y30LB37*/ 03821000
*       /* OPENSW TO INDICATE A DDNAME WAS FOUND TO OPEN AND @Y30LB37*/ 03822000
*       /* RETRIEVE THE DDNAME FROM THE TABLE AND EXIT.      @Y30LB37*/ 03823000
*       /*                                                           */ 03824000
*       /*************************************************************/ 03825000
*                                                                  1131 03826000
*       NVCOUNT=ONE;                /*                       @Y30LB37*/ 03827000
@RF01129 LA    NVCOUNT,1                                           1131 03828000
*SCANLOOP:                                                         1132 03829000
*       DO WHILE(NVCOUNT<=V1DDCNT&OPENSW=OFF&NVSAMRC=0);           1132 03830000
SCANLOOP B     @DE01132                                            1132 03831000
@DL01132 DS    0H                                                  1133 03832000
*         IF V1DDSNAM(NVCOUNT)=DS1DSNAM THEN                       1133 03833000
         LR    @15,NVCOUNT                                         1133 03834000
         MH    @15,@CH01708                                        1133 03835000
         LA    @14,V1DDSNAM-52(@15)                                1133 03836000
         CLC   0(44,@14),DS1DSNAM(F1PTR)                           1133 03837000
         BNE   @RF01133                                            1133 03838000
*           DO;                     /*                       @Y30LB37*/ 03839000
*             OPENSW=ON;            /*                       @Y30LB37*/ 03840000
         OI    OPENSW,B'00000010'                                  1135 03841000
*             EXODDN=ADDR(V1DDDNAM(NVCOUNT));/*              @Y30LB37*/ 03842000
         LA    @14,EXOLIST                                         1136 03843000
         LA    @15,V1DDDNAM-52(@15)                                1136 03844000
         ST    @15,EXODDN(,@14)                                    1136 03845000
*           END;                    /*                       @Y30LB37*/ 03846000
*         NVCOUNT=NVCOUNT+ONE;      /*                       @Y30LB37*/ 03847000
@RF01133 AL    NVCOUNT,@CF00223                                    1138 03848000
*       END SCANLOOP;               /*                       @Y30LB37*/ 03849000
@DE01132 CH    NVCOUNT,V1DDCNT                                     1139 03850000
         BH    @DC01132                                            1139 03851000
         TM    OPENSW,B'00000010'                                  1139 03852000
         BNZ   @DC01132                                            1139 03853000
         LTR   NVSAMRC,NVSAMRC                                     1139 03854000
         BZ    @DL01132                                            1139 03855000
@DC01132 DS    0H                                                  1140 03856000
*                                                                  1140 03857000
*       /*************************************************************/ 03858000
*       /*                                                           */ 03859000
*       /* IF THE DD CARD FOR THE INPUT DATA SET NAME HAS NOT        */ 03860000
*       /*                                                   @Y30LB37*/ 03861000
*       /* ALREADY BEEN FOUND, THEN PROCESS THE PASSWORD INPUT       */ 03862000
*       /*                                                   @Y30LB37*/ 03863000
*       /* FILE (PFILE) TABLE. WHEN ALL THE DDNAMES IN THE   @Y30LB37*/ 03864000
*       /* PFILE TABLE ARE PROCESSED, SET THE RETURN CODE TO @Y30LB37*/ 03865000
*       /* ISSUE MESSAGE IDC2960I. IF NOT ISSUE USYSINFO.    @Y30LB37*/ 03866000
*       /*                                                           */ 03867000
*       /*************************************************************/ 03868000
*                                                                  1140 03869000
*FINDLOOP:                                                         1140 03870000
*       DO WHILE(OPENSW=OFF&NVSAMRC=0);/*                    @Y30LB37*/ 03871000
FINDLOOP B     @DE01140                                            1140 03872000
@DL01140 DS    0H                                                  1141 03873000
*         IF PFILECNT=V1DDCNT THEN                                 1141 03874000
         L     @03,VSPFILEP(,ARGLPTR)                              1141 03875000
         CLC   PFILECNT(2,@03),V1DDCNT                             1141 03876000
         BNE   @RF01141                                            1141 03877000
*           NVSAMRC=RCPRTMSG;       /*                       @Y30LB37*/ 03878000
         LA    NVSAMRC,16                                          1142 03879000
*         ELSE                                                     1143 03880000
*           DO;                     /*                       @Y30LB37*/ 03881000
*                                                                  1143 03882000
         B     @RC01141                                            1143 03883000
@RF01141 DS    0H                                                  1144 03884000
*             /*******************************************************/ 03885000
*             /*                                                     */ 03886000
*             /* ISSUE USYSINFO MACRO TO OBTAIN DSNAME THAT  @Y30LB37*/ 03887000
*             /* CORRESPONDS TO THE DDNAME.                  @Y30LB37*/ 03888000
*             /*                                                     */ 03889000
*             /*******************************************************/ 03890000
*                                                                  1144 03891000
*             IOINFBLK=''B;         /*                       @Y30LB37*/ 03892000
         XC    IOINFBLK(52),IOINFBLK                               1144 03893000
*             IOHEADLN=LENGTH(IOINFBLK);/*                   @Y30LB37*/ 03894000
         MVC   IOHEADLN(2),@CH01708                                1145 03895000
*             IOBLKPTR=ADDR(IOINFBLK);/*                     @Y30LB37*/ 03896000
         LA    @03,IOINFBLK                                        1146 03897000
         ST    @03,IOBLKPTR                                        1146 03898000
*             IOINFDSN=ON;          /*                       @Y30LB37*/ 03899000
         LA    @03,IOINFBYT                                        1147 03900000
         OI    IOINFDSN(@03),B'00100000'                           1147 03901000
*             V1NVDDNM=PFILEVAL(V1DDCNT+ONE);/*              @Y30LB37*/ 03902000
         LH    @03,V1DDCNT                                         1148 03903000
         MH    @03,@CH00036                                        1148 03904000
         L     @01,VSPFILEP(,ARGLPTR)                              1148 03905000
         ALR   @01,@03                                             1148 03906000
         MVC   V1NVDDNM(8),PFILEVAL(@01)                           1148 03907000
*             CALL IDCIOSI0(GDTTBL,IOINFBYT,IOBLKPTR,V1NVDDNM);    1149 03908000
         L     @03,@PC00001                                        1149 03909000
         ST    @03,@AL00001                                        1149 03910000
         LA    @15,IOINFBYT                                        1149 03911000
         ST    @15,@AL00001+4                                      1149 03912000
         LA    @15,IOBLKPTR                                        1149 03913000
         ST    @15,@AL00001+8                                      1149 03914000
         LA    @15,V1NVDDNM                                        1149 03915000
         ST    @15,@AL00001+12                                     1149 03916000
         MVI   @AL00001+12,X'80'                                   1149 03917000
         L     @15,GDTIFO(,@03)                                    1149 03918000
         LA    @01,@AL00001                                        1149 03919000
         BALR  @14,@15                                             1149 03920000
*             RESPECIFY                                            1150 03921000
*               RTNREG RSTD;                                       1150 03922000
*             TESTRC=RTNREG;                                       1151 03923000
         STH   RTNREG,TESTRC                                       1151 03924000
*             RESPECIFY                                            1152 03925000
*               RTNREG UNRSTD;      /*                       @Y30LB37*/ 03926000
*                                                                  1152 03927000
*             /*******************************************************/ 03928000
*             /*                                                     */ 03929000
*             /* IF USYSINFO MACRO IS UNSUCCESSFUL SET RETURN        */ 03930000
*             /*                                             @Y30LB37*/ 03931000
*             /* CODE TO RCFAIL.                             @Y30LB37*/ 03932000
*             /*                                                     */ 03933000
*             /*******************************************************/ 03934000
*                                                                  1153 03935000
*             IF TESTRC^=0 THEN                                    1153 03936000
         LH    @03,TESTRC                                          1153 03937000
         LTR   @03,@03                                             1153 03938000
         BZ    @RF01153                                            1153 03939000
*               NVSAMRC=4;          /*                       @Y30LB37*/ 03940000
         LA    NVSAMRC,4                                           1154 03941000
*                                                                  1155 03942000
*             /*******************************************************/ 03943000
*             /*                                                     */ 03944000
*             /* SET THE DDNAME OF CORRESPONDING DATA SET NAME       */ 03945000
*             /*                                             @Y30LB37*/ 03946000
*             /* IN THE INTERNAL TABLE. IF NO DATA SET NAME  @Y30LB37*/ 03947000
*             /* WAS FOUND IN THE JFCB, MOVE 44 BLANKS INTO  @Y30LB37*/ 03948000
*             /* THE INTERNAL TABLE INSTEAD OF THE DSNAME.   @Y30LB37*/ 03949000
*             /*                                                     */ 03950000
*             /*******************************************************/ 03951000
*                                                                  1155 03952000
*             ELSE                                                 1155 03953000
*               DO;                 /*                       @Y30LB37*/ 03954000
         B     @RC01153                                            1155 03955000
@RF01153 DS    0H                                                  1156 03956000
*                 V1DDCNT=V1DDCNT+ONE;/*                     @Y30LB37*/ 03957000
         LA    @03,1                                               1156 03958000
         AH    @03,V1DDCNT                                         1156 03959000
         STH   @03,V1DDCNT                                         1156 03960000
*                 V1DDDNAM(V1DDCNT)=V1NVDDNM;/*              @Y30LB37*/ 03961000
         MH    @03,@CH01708                                        1157 03962000
         LA    @01,V1DDDNAM-52(@03)                                1157 03963000
         MVC   0(8,@01),V1NVDDNM                                   1157 03964000
*                 IF IOLENGTH=ZEROFLD2 THEN                        1158 03965000
         CLC   IOLENGTH(2),ZEROFLD2                                1158 03966000
         BNE   @RF01158                                            1158 03967000
*                   V1DDSNAM(V1DDCNT)=' ';/*                 @Y30LB37*/ 03968000
         LA    @01,V1DDSNAM-52(@03)                                1159 03969000
         MVI   1(@01),C' '                                         1159 03970000
         MVC   2(42,@01),1(@01)                                    1159 03971000
         MVI   0(@01),C' '                                         1159 03972000
*                 ELSE                                             1160 03973000
*                   V1DDSNAM(V1DDCNT)=IORETDSN;/*            @Y30LB37*/ 03974000
*                                                                  1160 03975000
         B     @RC01158                                            1160 03976000
@RF01158 LH    @03,V1DDCNT                                         1160 03977000
         MH    @03,@CH01708                                        1160 03978000
         LA    @01,V1DDSNAM-52(@03)                                1160 03979000
         MVC   0(44,@01),IORETDSN                                  1160 03980000
*                 /***************************************************/ 03981000
*                 /*                                                 */ 03982000
*                 /* IF DSNAMES ARE EQUAL THEN SET OPENSW ON.        */ 03983000
*                 /*                                         @Y30LB37*/ 03984000
*                 /* SET DDNAME IN OPEN ARGUMENT LIST.       @Y30LB37*/ 03985000
*                 /*                                                 */ 03986000
*                 /***************************************************/ 03987000
*                                                                  1161 03988000
*                 IF V1DDSNAM(V1DDCNT)=DS1DSNAM THEN               1161 03989000
@RC01158 LH    @03,V1DDCNT                                         1161 03990000
         MH    @03,@CH01708                                        1161 03991000
         LA    @01,V1DDSNAM-52(@03)                                1161 03992000
         CLC   0(44,@01),DS1DSNAM(F1PTR)                           1161 03993000
         BNE   @RF01161                                            1161 03994000
*                   DO;             /*                       @Y30LB37*/ 03995000
*                     OPENSW=ON;    /*                       @Y30LB37*/ 03996000
         OI    OPENSW,B'00000010'                                  1163 03997000
*                     EXODDN=ADDR(V1DDDNAM(V1DDCNT));/*      @Y30LB37*/ 03998000
         LA    @15,EXOLIST                                         1164 03999000
         LA    @03,V1DDDNAM-52(@03)                                1164 04000000
         ST    @03,EXODDN(,@15)                                    1164 04001000
*                   END;            /*                       @Y30LB37*/ 04002000
*               END;                /*                       @Y30LB37*/ 04003000
@RF01161 DS    0H                                                  1167 04004000
*           END;                    /*                       @Y30LB37*/ 04005000
@RC01153 DS    0H                                                  1168 04006000
*       END FINDLOOP;               /*                       @Y30LB37*/ 04007000
@RC01141 DS    0H                                                  1168 04008000
@DE01140 TM    OPENSW,B'00000010'                                  1168 04009000
         BNZ   @DC01140                                            1168 04010000
         LTR   NVSAMRC,NVSAMRC                                     1168 04011000
         BZ    @DL01140                                            1168 04012000
@DC01140 DS    0H                                                  1169 04013000
*                                                                  1169 04014000
*       /*************************************************************/ 04015000
*       /*                                                           */ 04016000
*       /* PRINT MESSAGE IDC2960I TO INDICATE A DD CARD WAS NOT      */ 04017000
*       /*                                                   @Y30LB37*/ 04018000
*       /* FOUND FOR THE DSNAME, IF THE RETURN CODE IS       @Y30LB37*/ 04019000
*       /* RCPRTMSG SET THE RETURN CODE TO RCFAIL.           @Y30LB37*/ 04020000
*       /*                                                           */ 04021000
*       /*************************************************************/ 04022000
*                                                                  1169 04023000
*       IF NVSAMRC=RCPRTMSG THEN                                   1169 04024000
         C     NVSAMRC,@CF00509                                    1169 04025000
         BNE   @RF01169                                            1169 04026000
*         DO;                       /*                       @Y30LB37*/ 04027000
*           DARGSMOD=MSGMODID;      /*                       @Y30LB37*/ 04028000
         L     @03,DDSTRU                                          1171 04029000
         MVC   DARGSMOD(3,@03),@CC01408                            1171 04030000
*           DARGSENT=MSG2960I;      /*                       @Y30LB37*/ 04031000
         MVI   DARGSENT(@03),X'02'                                 1172 04032000
*           DARGDBP=ADDR(DS1DSNAM); /*                       @Y30LB37*/ 04033000
         ST    F1PTR,DARGDBP(,@03)                                 1173 04034000
*           DARGILP=LENGTH(DS1DSNAM);/*                      @Y30LB37*/ 04035000
         MVC   DARGILP(2,@03),@CH00849                             1174 04036000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Y30LB37*/ 04037000
         L     @03,@PC00001                                        1175 04038000
         ST    @03,@AL00001                                        1175 04039000
         LA    @15,@CF00120                                        1175 04040000
         ST    @15,@AL00001+4                                      1175 04041000
         LA    @15,DDSTRU                                          1175 04042000
         ST    @15,@AL00001+8                                      1175 04043000
         MVI   @AL00001+8,X'80'                                    1175 04044000
         L     @15,GDTPRT(,@03)                                    1175 04045000
         LA    @01,@AL00001                                        1175 04046000
         BALR  @14,@15                                             1175 04047000
*           NVSAMRC=4;              /*                       @Y30LB37*/ 04048000
         LA    NVSAMRC,4                                           1176 04049000
*         END;                      /*                       @Y30LB37*/ 04050000
*                                                                  1177 04051000
*       /*************************************************************/ 04052000
*       /*                                                           */ 04053000
*       /* IF A DD CARD HAS BEEN FOUND TO OPEN, THEN         @Y30LB37*/ 04054000
*       /* INITIALIZE THE OPEN ARGUMENT LIST AND ISSUE       @Y30LB37*/ 04055000
*       /* THE UEXCP MACRO. IF THE OPEN IS NOT SUCCESSFUL,   @Y30LB37*/ 04056000
*       /* SET THE RETURN CODE TO RCFAIL.                    @Y30LB37*/ 04057000
*       /*                                                           */ 04058000
*       /*************************************************************/ 04059000
*                                                                  1178 04060000
*       IF OPENSW=ON THEN                                          1178 04061000
@RF01169 TM    OPENSW,B'00000010'                                  1178 04062000
         BNO   @RF01178                                            1178 04063000
*         DO;                       /*                       @Y30LB37*/ 04064000
*           EXOPASS=ON;             /* PASSWORD VERIFY ON    @Y30LB37*/ 04065000
         LA    @03,EXOLIST                                         1180 04066000
         OI    EXOPASS(@03),B'00100000'                            1180 04067000
*           EXOVSN=VSVOLP;          /* INSERT VOLUME SERIAL  @Y30LB37*/ 04068000
         L     @15,VSVOLP(,ARGLPTR)                                1181 04069000
         ST    @15,EXOVSN(,@03)                                    1181 04070000
*           EXOCTLBK=ADDR(RTNAREA); /* ADDRESS OPEN BLOCK    @Y30LB37*/ 04071000
         LA    @15,RTNAREA                                         1182 04072000
         ST    @15,EXOCTLBK(,@03)                                  1182 04073000
*           IF VSREAD=ON THEN                                      1183 04074000
         TM    VSREAD(ARGLPTR),B'00010000'                         1183 04075000
         BNO   @RF01183                                            1183 04076000
*             EXOREAD=ON;           /* OPEN READ IF VSREAD   @Y30LB37*/ 04077000
         OI    EXOREAD(@03),B'10000000'                            1184 04078000
*           CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*             @Y30LB37*/ 04079000
@RF01183 L     @03,@PC00001                                        1185 04080000
         ST    @03,@AL00001                                        1185 04081000
         LA    @15,OPEN                                            1185 04082000
         ST    @15,@AL00001+4                                      1185 04083000
         LA    @15,EXOLIST                                         1185 04084000
         ST    @15,@AL00001+8                                      1185 04085000
         MVI   @AL00001+8,X'80'                                    1185 04086000
         L     @15,GDTEXP(,@03)                                    1185 04087000
         LA    @01,@AL00001                                        1185 04088000
         BALR  @14,@15                                             1185 04089000
*           RESPECIFY                                              1186 04090000
*             RTNREG RSTD;                                         1186 04091000
*           TESTRC=RTNREG;                                         1187 04092000
         STH   RTNREG,TESTRC                                       1187 04093000
*           RESPECIFY                                              1188 04094000
*             RTNREG UNRSTD;        /*                       @Y30LB37*/ 04095000
*           IF TESTRC^=0 THEN                                      1189 04096000
         LH    @03,TESTRC                                          1189 04097000
         LTR   @03,@03                                             1189 04098000
         BZ    @RF01189                                            1189 04099000
*             NVSAMRC=4;            /*                       @Y30LB37*/ 04100000
         LA    NVSAMRC,4                                           1190 04101000
*         END;                      /*                       @Y30LB37*/ 04102000
@RF01189 DS    0H                                                  1192 04103000
*                                                                  1192 04104000
*       /*************************************************************/ 04105000
*       /*                                                           */ 04106000
*       /* IF THE OPEN WAS PERFORMED THEN ISSUE THE CLOSE    @Y30LB37*/ 04107000
*       /* MACRO VIA THE UEXCP MACRO. IF CLOSE NOT SUCCESSFUL,       */ 04108000
*       /*                                                   @Y30LB37*/ 04109000
*       /* SET RETURN CODE TO RCNCLOSE ONLY IF RETURN CODE IS        */ 04110000
*       /*                                                   @Y30LB37*/ 04111000
*       /* NOT MORE SEVERE ALREADY.                          @Y30LB37*/ 04112000
*       /*                                                           */ 04113000
*       /*************************************************************/ 04114000
*                                                                  1192 04115000
*       IF RTNAREA^=NULLPTR THEN                                   1192 04116000
@RF01178 L     @03,RTNAREA                                         1192 04117000
         LTR   @03,@03                                             1192 04118000
         BZ    @RF01192                                            1192 04119000
*         DO;                       /*                       @Y30LB37*/ 04120000
*           CALL IDCIO050(GDTTBL,CLOSE,RTNAREA);/*           @Y30LB37*/ 04121000
         L     @03,@PC00001                                        1194 04122000
         ST    @03,@AL00001                                        1194 04123000
         LA    @15,CLOSE                                           1194 04124000
         ST    @15,@AL00001+4                                      1194 04125000
         LA    @15,RTNAREA                                         1194 04126000
         ST    @15,@AL00001+8                                      1194 04127000
         MVI   @AL00001+8,X'80'                                    1194 04128000
         L     @15,GDTEXP(,@03)                                    1194 04129000
         LA    @01,@AL00001                                        1194 04130000
         BALR  @14,@15                                             1194 04131000
*           RESPECIFY                                              1195 04132000
*             RTNREG RSTD;                                         1195 04133000
*           TESTRC=RTNREG;                                         1196 04134000
         STH   RTNREG,TESTRC                                       1196 04135000
*           RESPECIFY                                              1197 04136000
*             RTNREG UNRSTD;        /*                       @Y30LB37*/ 04137000
*           IF TESTRC^=0&NVSAMRC^=4 THEN                           1198 04138000
         LH    @03,TESTRC                                          1198 04139000
         LTR   @03,@03                                             1198 04140000
         BZ    @RF01198                                            1198 04141000
         C     NVSAMRC,@CF00046                                    1198 04142000
         BE    @RF01198                                            1198 04143000
*             NVSAMRC=8;            /*                       @Y30LB37*/ 04144000
         LA    NVSAMRC,8                                           1199 04145000
*         END;                      /*                       @Y30LB37*/ 04146000
@RF01198 DS    0H                                                  1201 04147000
*     END NONRACF;                  /*                       @G24LB31*/ 04148000
@RF01192 DS    0H                                                  1202 04149000
*   RETURN CODE(NVSAMRC);           /* RETURN TO MAIN ROUTINE      1202 04150000
*                                                            @Y30LB37*/ 04151000
@RC01109 LR    @15,NVSAMRC                                         1202 04152000
         L     @14,@SA00015                                        1202 04153000
         LM    @00,@12,@SA00015+8                                  1202 04154000
         BR    @14                                                 1202 04155000
*   END NVSAMCHK;                   /* END OF NVSAMCHK PROC  @Y30LB37*/ 04156000
*                                                                  1204 04157000
*/********************************************************************/ 04158000
*/*                                                                  */ 04159000
*/*  PROCEDURE NAME - EXPIRCHK                               @Y30LB37*/ 04160000
*/*                                                          @Y30LB37*/ 04161000
*/*  FUNCTION - THIS PROCEDURE OPENS THE NON-EXPIRED DATA    @Y30LB37*/ 04162000
*/*             SET TO ASK FOR OPERATOR PERMISSION.          @Y30LB37*/ 04163000
*/*             ISSUES THE UEXCP MACRO TO OPEN THE           @Y30LB37*/ 04164000
*/*             DATA SET, AND UEXCP MACRO TO CLOSE THE DATA  @Y30LB37*/ 04165000
*/*             SET.                                         @Y30LB37*/ 04166000
*/*                                                          @Y30LB37*/ 04167000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 04168000
*/*          LIST:  FIELD VSFILEP.                           @Y30LB37*/ 04169000
*/*                                                          @Y30LB37*/ 04170000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO,      @Y30LB37*/ 04171000
*/*          FOUR OR EIGHT ERROR CODES.                      @Y30LB37*/ 04172000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 04173000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 04174000
*/*          4 - ERROR OPENING DATA SET                      @Y30LB37*/ 04175000
*/*          8 - ERROR CLOSING DATA SET                      @Y30LB37*/ 04176000
*/*                                                                  */ 04177000
*/********************************************************************/ 04178000
*                                                                  1204 04179000
*EXPIRCHK:                                                         1204 04180000
*   PROCEDURE;                      /*                       @Y30LB37*/ 04181000
*                                                                  1204 04182000
EXPIRCHK STM   @14,@12,@SA00016                                    1204 04183000
*   /*****************************************************************/ 04184000
*   /*                                                               */ 04185000
*   /* LOCAL DECLARATIONS FOR EXPIRCHK                       @Y30LB37*/ 04186000
*   /*                                                               */ 04187000
*   /*****************************************************************/ 04188000
*                                                                  1205 04189000
*   DCL                                                            1205 04190000
*     EXPIRRC FIXED(15);            /* EXPIRCHK RETURN CODE  @Y30LB37*/ 04191000
*                                                                  1206 04192000
*   /*****************************************************************/ 04193000
*   /*                                                               */ 04194000
*   /* INITIALIZE THE OPEN ARGUMENT LIST AND ISSUE           @Y30LB37*/ 04195000
*   /* THE UEXCP MACRO TO OPEN THE DATA SET FOR OUTPUT.      @Y30LB37*/ 04196000
*   /*                                                               */ 04197000
*   /*****************************************************************/ 04198000
*                                                                  1206 04199000
*   RFY                                                            1206 04200000
*     EXOARG BASED(ADDR(EXOLIST));  /*                       @Y30LB37*/ 04201000
*   OLDERID2=NEWERID2;                                             1207 04202000
         L     @03,@PC00001                                        1207 04203000
         L     @15,GDTTR2(,@03)                                    1207 04204000
         MVC   @TS00001(95),NEWERID2(@15)                          1207 04205000
         MVC   OLDERID2(95,@15),@TS00001                           1207 04206000
*   NEWID2='VSEC';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 04207000
         MVC   NEWID2(4,@15),@CC01664                              1208 04208000
*   EXPIRRC=0;                      /*                       @Y30LB37*/ 04209000
         SLR   EXPIRRC,EXPIRRC                                     1209 04210000
*   RTNAREA=''B;                    /*                       @Y30LB37*/ 04211000
         SLR   @15,@15                                             1210 04212000
         ST    @15,RTNAREA                                         1210 04213000
*   EXOARG=''B;                     /*                       @Y30LB37*/ 04214000
         LA    @15,EXOLIST                                         1211 04215000
         XC    EXOARG(34,@15),EXOARG(@15)                          1211 04216000
*   EXOPASS=ON;                     /*                       @Y30LB37*/ 04217000
         OI    EXOPASS(@15),B'00100000'                            1212 04218000
*   EXOVSN=VSVOLP;                  /* INSERT VOLUME SERIAL  @ZA09532*/ 04219000
         L     @14,VSVOLP(,ARGLPTR)                                1213 04220000
         ST    @14,EXOVSN(,@15)                                    1213 04221000
*   EXODDN=VSFILEP;                 /*                       @Y30LB37*/ 04222000
         L     @14,VSFILEP(,ARGLPTR)                               1214 04223000
         ST    @14,EXODDN(,@15)                                    1214 04224000
*   EXODSN=ADDR(DS1DSNAM);          /*                       @Y30LB37*/ 04225000
         ST    F1PTR,EXODSN(,@15)                                  1215 04226000
*   EXOCTLBK=ADDR(RTNAREA);         /*                       @Y30LB37*/ 04227000
         LA    @14,RTNAREA                                         1216 04228000
         ST    @14,EXOCTLBK(,@15)                                  1216 04229000
*   CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                     @Y30LB37*/ 04230000
         ST    @03,@AL00001                                        1217 04231000
         LA    @14,OPEN                                            1217 04232000
         ST    @14,@AL00001+4                                      1217 04233000
         ST    @15,@AL00001+8                                      1217 04234000
         MVI   @AL00001+8,X'80'                                    1217 04235000
         L     @15,GDTEXP(,@03)                                    1217 04236000
         LA    @01,@AL00001                                        1217 04237000
         BALR  @14,@15                                             1217 04238000
*   RESPECIFY                                                      1218 04239000
*     RTNREG RSTD;                                                 1218 04240000
*   TESTRC=RTNREG;                                                 1219 04241000
         STH   RTNREG,TESTRC                                       1219 04242000
*   RESPECIFY                                                      1220 04243000
*     RTNREG UNRSTD;                /*                       @Y30LB37*/ 04244000
*                                                                  1220 04245000
*   /*****************************************************************/ 04246000
*   /*                                                               */ 04247000
*   /* IF THE OPEN IS UNSUCCESSFUL THEN SET RETURN CODE      @Y30LB37*/ 04248000
*   /* TO RCFAIL.                                            @Y30LB37*/ 04249000
*   /*                                                               */ 04250000
*   /*****************************************************************/ 04251000
*                                                                  1221 04252000
*   IF TESTRC^=0 THEN                                              1221 04253000
         LH    @03,TESTRC                                          1221 04254000
         LTR   @03,@03                                             1221 04255000
         BZ    @RF01221                                            1221 04256000
*     EXPIRRC=4;                    /*                       @Y30LB37*/ 04257000
         LA    EXPIRRC,4                                           1222 04258000
*                                                                  1223 04259000
*   /*****************************************************************/ 04260000
*   /*                                                               */ 04261000
*   /* IF THE OPEN WAS PERFORMED THEN ISSUE THE CLOSE        @Y30LB37*/ 04262000
*   /* MACRO VIA THE UEXCP MACRO. IF CLOSE NOT SUCCESSFUL,   @Y30LB37*/ 04263000
*   /* SET RETURN CODE TO RCNCLOSE ONLY IF RETURN CODE IS    @Y30LB37*/ 04264000
*   /* NOT MORE SEVERE ALREADY.                              @Y30LB37*/ 04265000
*   /*                                                               */ 04266000
*   /*****************************************************************/ 04267000
*                                                                  1223 04268000
*   IF RTNAREA^=NULLPTR THEN                                       1223 04269000
@RF01221 L     @03,RTNAREA                                         1223 04270000
         LTR   @03,@03                                             1223 04271000
         BZ    @RF01223                                            1223 04272000
*     DO;                           /*                       @Y30LB37*/ 04273000
*       CALL IDCIO050(GDTTBL,CLOSE,RTNAREA);/*               @Y30LB37*/ 04274000
         L     @03,@PC00001                                        1225 04275000
         ST    @03,@AL00001                                        1225 04276000
         LA    @15,CLOSE                                           1225 04277000
         ST    @15,@AL00001+4                                      1225 04278000
         LA    @15,RTNAREA                                         1225 04279000
         ST    @15,@AL00001+8                                      1225 04280000
         MVI   @AL00001+8,X'80'                                    1225 04281000
         L     @15,GDTEXP(,@03)                                    1225 04282000
         LA    @01,@AL00001                                        1225 04283000
         BALR  @14,@15                                             1225 04284000
*       RESPECIFY                                                  1226 04285000
*         RTNREG RSTD;                                             1226 04286000
*       TESTRC=RTNREG;                                             1227 04287000
         STH   RTNREG,TESTRC                                       1227 04288000
*       RESPECIFY                                                  1228 04289000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 04290000
*       IF TESTRC^=0&EXPIRRC^=4 THEN                               1229 04291000
         LH    @03,TESTRC                                          1229 04292000
         LTR   @03,@03                                             1229 04293000
         BZ    @RF01229                                            1229 04294000
         C     EXPIRRC,@CF00046                                    1229 04295000
         BE    @RF01229                                            1229 04296000
*         EXPIRRC=8;                /*                       @Y30LB37*/ 04297000
         LA    EXPIRRC,8                                           1230 04298000
*     END;                          /*                       @Y30LB37*/ 04299000
@RF01229 DS    0H                                                  1232 04300000
*   RETURN CODE(EXPIRRC);           /* RETURN TO MAIN ROUTINE      1232 04301000
*                                                            @Y30LB37*/ 04302000
@RF01223 LR    @15,EXPIRRC                                         1232 04303000
         L     @14,@SA00016                                        1232 04304000
         LM    @00,@12,@SA00016+8                                  1232 04305000
         BR    @14                                                 1232 04306000
*   END EXPIRCHK;                   /* END OF EXPIRCHK PROC  @Y30LB37*/ 04307000
*                                                                  1234 04308000
*/********************************************************************/ 04309000
*/*                                                                  */ 04310000
*/*  PROCEDURE NAME - CATCHK                                 @Y30LB37*/ 04311000
*/*                                                          @Y30LB37*/ 04312000
*/*  FUNCTION - THIS PROCEDURE DETERMINES IF THE VOLUME IS   @Y30LB37*/ 04313000
*/*             OWNED BY THE VSAM CATALOG, VERIFIES THE      @Y30LB37*/ 04314000
*/*             CATALOG MASTER LEVEL PASSWORD, AND DETER-    @Y30LB37*/ 04315000
*/*             MINES IF THE USER CATALOG IS ON THIS         @Y30LB37*/ 04316000
*/*             VOLUME.  CALLS CATOPEN TO OPEN THE CATALOG,  @Y30LB37*/ 04317000
*/*             AND PRINTS ERROR MESSAGES IDC3009I,          @Y30LB37*/ 04318000
*/*             IDC3007I AND IDC2962I.                       @Y30LB37*/ 04319000
*/*                                                          @Y30LB37*/ 04320000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 04321000
*/*          LIST: FIELDS VSCATP, VSCATDDP, VSVOLP, VSACBP,  @Y30LB37*/ 04322000
*/*          VSUCTEST AND VSPSWDP.  CHKPASS IS THE CATPASS   @Y30LB37*/ 04323000
*/*          PARM TO BE UPDATED WITH 'GOOD' OR 'BAD'.        @Y30LB37*/ 04324000
*/*                                                          @Y30LB37*/ 04325000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO, FOUR @Y30LB37*/ 04326000
*/*          OR EIGHT ERROR CODE.  CHKPASS IS SET TO 'GOOD'  @Y30LB37*/ 04327000
*/*          IF THE CATALOG PASSWORD WAS VERIFIED OR SET     @Y30LB37*/ 04328000
*/*          TO 'BAD' OTHERWISE.  VSUCAT IS SET TO 1 IF THE  @Y30LB37*/ 04329000
*/*          USER CATALOG IS ON THE VOLUME ELSE SET TO ZERO. @Y30LB37*/ 04330000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 04331000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 04332000
*/*          4 - ERROR VERIFYING PASSWORDS                   @Y30LB37*/ 04333000
*/*              ERROR OPENING THE CATALOG                   @Y30LB37*/ 04334000
*/*              ERROR LOCATING VOLUME ENTRY OR OTHER ERROR  @Y30LB37*/ 04335000
*/*          8 - ERROR CLOSING THE CATALOG                   @Y30LB37*/ 04336000
*/*              ERROR DEALLOCATING CATALOG                  @Y30LB37*/ 04337000
*/*                                                                  */ 04338000
*/********************************************************************/ 04339000
*                                                                  1234 04340000
*CATCHK:                                                           1234 04341000
*   PROCEDURE(CHKPASS);             /* CATPASS PASSWORD PARM @Y30LB37*/ 04342000
CATCHK   STM   @14,@12,@SA00017                                    1234 04343000
         MVC   @PC00017(4),0(@01)                                  1234 04344000
*                                                                  1235 04345000
*   /*****************************************************************/ 04346000
*   /*                                                               */ 04347000
*   /* LOCAL DECLARATIONS FOR CATCHK                         @Y30LB37*/ 04348000
*   /*                                                               */ 04349000
*   /*****************************************************************/ 04350000
*                                                                  1235 04351000
*   DCL                                                            1235 04352000
*     CATCKRC FIXED(15);            /* CATCHK RETURN CODE    @Y30LB37*/ 04353000
*   DCL                                                            1236 04354000
*     CHKPASS CHAR(4);              /* CATALOG CHK PARM AREA @Y30LB37*/ 04355000
*   DCL                                                            1237 04356000
*     V1CPLIST CHAR(LENGTH(CTGPL)+LENGTH(CTGFIELD))/* CATALOG      1237 04357000
*                                                            @Y30LB37*/ 04358000
*         BDY(WORD);                /* PARAMETER LIST        @Y30LB37*/ 04359000
*   DCL                                                            1238 04360000
*     V1CFLIST CHAR(LENGTH(CTGFL)+LENGTH(CTGFLDAT))/* CATALOG      1238 04361000
*                                                            @Y30LB37*/ 04362000
*         BDY(WORD);                /* PARAMETER LIST        @Y30LB37*/ 04363000
*   DCL                                                            1239 04364000
*     V1CPSAVE CHAR(LENGTH(CTGPL)+LENGTH(CTGFIELD))/* CATALOG      1239 04365000
*                                                            @Y30LB37*/ 04366000
*         BDY(WORD);                /* PARAMETER SAVE LIST   @Y30LB37*/ 04367000
*   DCL                                                            1240 04368000
*     V1CFSAVE CHAR(LENGTH(CTGFL)+LENGTH(CTGFLDAT))/* CATALOG      1240 04369000
*                                                            @Y30LB37*/ 04370000
*         BDY(WORD);                /* PARAMETER SAVE LIST   @Y30LB37*/ 04371000
*   DCL                                                            1241 04372000
*     CATIOCSP PTR(31);             /* IOCSTR POINTER        @Y30LB37*/ 04373000
*   DCL                                                            1242 04374000
*     CATACB PTR(31);               /* ACB POINTER           @Y30LB37*/ 04375000
*   DCL                                                            1243 04376000
*     1 VOLBLOCK,                   /* VOLSER AND BLANKS     @Y30LB37*/ 04377000
*      2 VOLBSER CHAR(6),           /* VOLSER AREA           @Y30LB37*/ 04378000
*      2 VOLBLANK CHAR(38);         /* BLANK OUT AREA        @Y30LB37*/ 04379000
*   DCL                                                            1244 04380000
*     1 V1CWORKA BDY(WORD),         /* CTGPL WORK AREA       @Y30LB37*/ 04381000
*      2 V1CWRKLN FIXED(15),        /* LENGTH AREA           @Y30LB37*/ 04382000
*      2 V1CRETLN FIXED(15),        /* LENGTH AREA           @Y30LB37*/ 04383000
*      2 V1CWRKAR CHAR(3);          /* RETURN AREA           @ZM00982*/ 04384000
*   DCL                                                            1245 04385000
*     V1ENTID CHAR(8) STATIC        /* ENTRY ID CONSTANT     @Y30LB37*/ 04386000
*         INIT('ENTIDNO ');         /* INITIALIZED           @Y30LB37*/ 04387000
*   DCL                                                            1246 04388000
*     RCPASERR FIXED(15) CONSTANT(56);/* PASSWORD ERROR      @Y30LB37*/ 04389000
*   DCL                                                            1247 04390000
*     RCNVOLEN FIXED(15) CONSTANT(8);/* NO ENTRY ERROR       @Y30LB37*/ 04391000
*   DCL                                                            1248 04392000
*     USERCAT9 CHAR(3) STATIC INIT('000009'X);/*             @ZM00982*/ 04393000
*                                                                  1248 04394000
*   /*****************************************************************/ 04395000
*   /*                                                               */ 04396000
*   /* USER ENTRY ID NO                                      @ZM00982*/ 04397000
*   /*                                                               */ 04398000
*   /*****************************************************************/ 04399000
*                                                                  1249 04400000
*                                                                  1249 04401000
*   /*****************************************************************/ 04402000
*   /*                                                               */ 04403000
*   /* INITIALIZE THE CPL AND FPL ALSO INITIALIZE            @Y30LB37*/ 04404000
*   /* THE PARAMETERS TO ZEROS.                              @Y30LB37*/ 04405000
*   /*                                                               */ 04406000
*   /*****************************************************************/ 04407000
*                                                                  1249 04408000
*   OLDERID2=NEWERID2;                                             1249 04409000
         L     @03,@PC00001                                        1249 04410000
         L     @03,GDTTR2(,@03)                                    1249 04411000
         MVC   @TS00001(95),NEWERID2(@03)                          1249 04412000
         MVC   OLDERID2(95,@03),@TS00001                           1249 04413000
*   NEWID2='VSCC';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 04414000
         MVC   NEWID2(4,@03),@CC01692                              1250 04415000
*   CATCKRC=0;                      /*                       @Y30LB37*/ 04416000
         SLR   @15,@15                                             1251 04417000
         LR    CATCKRC,@15                                         1251 04418000
*   CTGPLPTR=ADDR(V1CPLIST);        /*                       @Y30LB37*/ 04419000
         LA    @03,V1CPLIST                                        1252 04420000
         ST    @03,CTGPLPTR                                        1252 04421000
*   CTGFLPTR=ADDR(V1CFLIST);        /*                       @Y30LB37*/ 04422000
         LA    CTGFLPTR,V1CFLIST                                   1253 04423000
*   CTGPL=''B;                      /*                       @Y30LB37*/ 04424000
         XC    CTGPL(28,@03),CTGPL(@03)                            1254 04425000
*   CTGFL=''B;                      /*                       @Y30LB37*/ 04426000
         XC    CTGFL(16,CTGFLPTR),CTGFL(CTGFLPTR)                  1255 04427000
*   CATIOCSP=NULLPTR;               /*                       @Y30LB37*/ 04428000
         ST    @15,CATIOCSP                                        1256 04429000
*   CATACB=NULLPTR;                 /*                       @Y30LB37*/ 04430000
         ST    @15,CATACB                                          1257 04431000
*   VOLBLANK=''B;                   /*                       @Y30LB37*/ 04432000
         XC    VOLBLANK(38),VOLBLANK                               1258 04433000
*                                                                  1259 04434000
*   /*****************************************************************/ 04435000
*   /*                                                               */ 04436000
*   /* CALL THE CATOPEN PROCEDURE IF THERE IS NO CATALOG     @Y30LB37*/ 04437000
*   /* ACB ALREADY (VSACBP IS ZERO), AND A CATALOG DD CARD   @Y30LB37*/ 04438000
*   /* IS PASSED OR NEEDS TO BE RETURNED (VSCATDDP IS        @Y30LB37*/ 04439000
*   /* NOT EQUAL TO ZEROS).                                  @Y30LB37*/ 04440000
*   /*                                                               */ 04441000
*   /*****************************************************************/ 04442000
*                                                                  1259 04443000
*   IF VSACBP=NULLPTR&VSCATDDP^=NULLPTR THEN                       1259 04444000
         C     @15,VSACBP(,ARGLPTR)                                1259 04445000
         BNE   @RF01259                                            1259 04446000
         C     @15,VSCATDDP(,ARGLPTR)                              1259 04447000
         BE    @RF01259                                            1259 04448000
*     DO;                           /*                       @Y30LB37*/ 04449000
*       CALL CATOPEN(CATACB,CATIOCSP);/*                     @Y30LB37*/ 04450000
         LA    @03,CATACB                                          1261 04451000
         ST    @03,@AL00001                                        1261 04452000
         LA    @03,CATIOCSP                                        1261 04453000
         ST    @03,@AL00001+4                                      1261 04454000
         LA    @01,@AL00001                                        1261 04455000
         BAL   @14,CATOPEN                                         1261 04456000
*       RESPECIFY                                                  1262 04457000
*         RTNREG RSTD;                                             1262 04458000
*       TESTRC=RTNREG;                                             1263 04459000
         STH   RTNREG,TESTRC                                       1263 04460000
*       RESPECIFY                                                  1264 04461000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 04462000
*                                                                  1264 04463000
*       /*************************************************************/ 04464000
*       /*                                                           */ 04465000
*       /* IF CATOPEN IS UNSUCCESSFUL SET RETURN CODE TO     @Y30LB37*/ 04466000
*       /* RCFAIL.                                           @Y30LB37*/ 04467000
*       /*                                                           */ 04468000
*       /*************************************************************/ 04469000
*                                                                  1265 04470000
*       IF TESTRC^=0 THEN                                          1265 04471000
         LH    @03,TESTRC                                          1265 04472000
         LTR   @03,@03                                             1265 04473000
         BZ    @RF01265                                            1265 04474000
*         CATCKRC=4;                /*                       @Y30LB37*/ 04475000
         LA    CATCKRC,4                                           1266 04476000
*     END;                          /*                       @Y30LB37*/ 04477000
*                                                                  1267 04478000
@RF01265 DS    0H                                                  1268 04479000
*   /*****************************************************************/ 04480000
*   /*                                                               */ 04481000
*   /* ISSUE THE UCATLG MACRO TO LOCATE THE VOLUME ENTRY     @Y30LB37*/ 04482000
*   /* AND VERIFY RACF ALTER AUTHORIZATION OR                @G24LB31*/ 04483000
*   /* THE MASTER LEVEL PASSWORD OF THE                      @G24LB31*/ 04484000
*   /* CATALOG IF RETURN CODE IS ZERO. SET THE CPL           @Y30LB37*/ 04485000
*   /* AND FPL TO ISSUE THE UCATLG. INITIALIZE THE CPL       @Y30LB37*/ 04486000
*   /* ACCORDING TO THE INPUT VS1AGL PARAMETERS.             @Y30LB37*/ 04487000
*   /*                                                               */ 04488000
*   /*****************************************************************/ 04489000
*                                                                  1268 04490000
*   IF CATCKRC=0 THEN                                              1268 04491000
@RF01259 SLR   @03,@03                                             1268 04492000
         CR    CATCKRC,@03                                         1268 04493000
         BNE   @RF01268                                            1268 04494000
*     DO;                           /*                       @Y30LB37*/ 04495000
*       CTGMAST=ON;                 /*                       @Y30LB37*/ 04496000
*       CTGNAME=ON;                 /*                       @Y30LB37*/ 04497000
         L     @15,CTGPLPTR                                        1271 04498000
         OI    CTGMAST(@15),B'01000100'                            1271 04499000
*       CTGAM0=ON;                  /*                       @Y30LB37*/ 04500000
*       CTGNUM=ON;                  /*                       @Y30LB37*/ 04501000
         OI    CTGAM0(@15),B'00000011'                             1273 04502000
*                                                                  1274 04503000
*       /*************************************************************/ 04504000
*       /*                                                           */ 04505000
*       /* IF VSACBP AND CATACB POINTERS ARE ZERO THEN USE   @Y30LB37*/ 04506000
*       /* THE CATALOG NAME POINTER AND TURN ON CTGCNAME.    @Y30LB37*/ 04507000
*       /* IF NOT, THEN USE ONE OF THE TWO FIELDS WHICH      @Y30LB37*/ 04508000
*       /* WAS SPECIFIED BY THE CALLER.                      @Y30LB37*/ 04509000
*       /*                                                           */ 04510000
*       /*************************************************************/ 04511000
*                                                                  1274 04512000
*       IF VSACBP=NULLPTR&CATACB=NULLPTR THEN                      1274 04513000
         C     @03,VSACBP(,ARGLPTR)                                1274 04514000
         BNE   @RF01274                                            1274 04515000
         C     @03,CATACB                                          1274 04516000
         BNE   @RF01274                                            1274 04517000
*         DO;                       /*                       @Y30LB37*/ 04518000
*           CTGCNAME=ON;            /*                       @Y30LB37*/ 04519000
         OI    CTGCNAME(@15),B'00000010'                           1276 04520000
*           CTGCAT=VSCATP;          /*                       @Y30LB37*/ 04521000
         L     @03,VSCATP(,ARGLPTR)                                1277 04522000
         ST    @03,CTGCAT(,@15)                                    1277 04523000
*         END;                      /*                       @Y30LB37*/ 04524000
*       ELSE                                                       1279 04525000
*         IF VSACBP^=NULLPTR THEN                                  1279 04526000
         B     @RC01274                                            1279 04527000
@RF01274 L     @03,VSACBP(,ARGLPTR)                                1279 04528000
         LTR   @03,@03                                             1279 04529000
         BZ    @RF01279                                            1279 04530000
*           CTGCAT=ADDR(VSACBP);    /*                       @ZM30711*/ 04531000
         LA    @03,VSACBP(,ARGLPTR)                                1280 04532000
         L     @01,CTGPLPTR                                        1280 04533000
         ST    @03,CTGCAT(,@01)                                    1280 04534000
*         ELSE                                                     1281 04535000
*           CTGCAT=ADDR(CATACB);    /*                       @ZM30711*/ 04536000
         B     @RC01279                                            1281 04537000
@RF01279 LA    @03,CATACB                                          1281 04538000
         L     @01,CTGPLPTR                                        1281 04539000
         ST    @03,CTGCAT(,@01)                                    1281 04540000
*       V1CWRKLN=LENGTH(V1CWORKA);  /* INIT LENGTH OF WRK    @Y30LB37*/ 04541000
@RC01279 DS    0H                                                  1282 04542000
@RC01274 MVC   V1CWRKLN(2),@CH00041                                1282 04543000
*       CTGWKA=ADDR(V1CWORKA);      /* ADDRESS OF WRK AREA   @Y30LB37*/ 04544000
         L     @03,CTGPLPTR                                        1283 04545000
         LA    @15,V1CWORKA                                        1283 04546000
         ST    @15,CTGWKA(,@03)                                    1283 04547000
*       VOLBSER=V1VOLA;             /* INSERT VOLSER         @Y30LB37*/ 04548000
         L     @01,VSVOLP(,ARGLPTR)                                1284 04549000
         MVC   VOLBSER(6),V1VOLA(@01)                              1284 04550000
*       CTGENT=ADDR(VOLBLOCK);      /* ADDRESS OF VOLSER WRK @Y30LB37*/ 04551000
         LA    @15,VOLBLOCK                                        1285 04552000
         ST    @15,CTGENT(,@03)                                    1285 04553000
*       CTGFUNC=CTGLOC;             /* FUNCTION LOCATE       @Y30LB37*/ 04554000
         NI    CTGFUNC(@03),B'00111111'                            1286 04555000
         OI    CTGFUNC(@03),B'00100000'                            1286 04556000
*       CTGNOFLD=1;                 /* NO OF CTGFL FIELDS    @Y30LB37*/ 04557000
         MVI   CTGNOFLD(@03),X'01'                                 1287 04558000
*       CTGPSWD=VSPSWDP;            /* PASSWORD POINTER      @Y30LB37*/ 04559000
         L     @15,VSPSWDP(,ARGLPTR)                               1288 04560000
         ST    @15,CTGPSWD(,@03)                                   1288 04561000
*       CTGFIELD(1)=CTGFLPTR;       /* CTGFL FIELD POINTER   @Y30LB37*/ 04562000
         ST    CTGFLPTR,CTGFIELD(,@03)                             1289 04563000
*       CTGFLDNO=1;                 /* CTGFL FIELD NUMBER    @Y30LB37*/ 04564000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            1290 04565000
*       CTGFLDNM=ADDR(V1ENTID);     /* CATALOG ENTRY ID      @Y30LB37*/ 04566000
*                                                                  1291 04567000
         LA    @03,V1ENTID                                         1291 04568000
         ST    @03,CTGFLDNM(,CTGFLPTR)                             1291 04569000
*       /*************************************************************/ 04570000
*       /*                                                           */ 04571000
*       /* IF VSUCTEST IS ON THEN SAVE THE INITIALIZED       @Y30LB37*/ 04572000
*       /* CATALOG PARAMETER LISTS.                          @Y30LB37*/ 04573000
*       /*                                                           */ 04574000
*       /*************************************************************/ 04575000
*                                                                  1292 04576000
*       IF VSUCTEST=ON THEN                                        1292 04577000
         TM    VSUCTEST(ARGLPTR),B'00000100'                       1292 04578000
         BNO   @RF01292                                            1292 04579000
*         DO;                       /*                       @Y30LB37*/ 04580000
*           V1CPSAVE=V1CPLIST;      /*                       @Y30LB37*/ 04581000
         MVC   V1CPSAVE(32),V1CPLIST                               1294 04582000
*           V1CFSAVE=V1CFLIST;      /*                       @Y30LB37*/ 04583000
         MVC   V1CFSAVE(24),V1CFLIST                               1295 04584000
*         END;                      /*                       @Y30LB37*/ 04585000
*                                                                  1296 04586000
*       /*************************************************************/ 04587000
*       /*                                                           */ 04588000
*       /* ISSUE UCATLG MACRO WITH CPL POINTER SPECIFIED.    @Y30LB37*/ 04589000
*       /*                                                           */ 04590000
*       /*************************************************************/ 04591000
*                                                                  1297 04592000
*       CALL IDCSACA0(GDTTBL,CTGPLPTR);/*                    @Y30LB37*/ 04593000
@RF01292 L     @05,@PC00001                                        1297 04594000
         ST    @05,@AL00001                                        1297 04595000
         LA    @03,CTGPLPTR                                        1297 04596000
         ST    @03,@AL00001+4                                      1297 04597000
         L     @15,GDTCAT(,@05)                                    1297 04598000
         LA    @01,@AL00001                                        1297 04599000
         BALR  @14,@15                                             1297 04600000
*       RESPECIFY                                                  1298 04601000
*         RTNREG RSTD;                                             1298 04602000
*       TESTRC=RTNREG;                                             1299 04603000
         STH   RTNREG,TESTRC                                       1299 04604000
*       RESPECIFY                                                  1300 04605000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 04606000
*                                                                  1301 04607000
*       /*************************************************************/ 04608000
*       /*                                                           */ 04609000
*       /* CHECK IF THE RETURN CODE FROM UCATLG IS ZERO.     @Y30LB37*/ 04610000
*       /* SET CHKPASS TO 'GOOD' IF ZERO. IF FAILURE         @Y30LB37*/ 04611000
*       /* PRINT ERROR MESSAGES ACCORDINGLY AND SET          @Y30LB37*/ 04612000
*       /* CHKPASS TO 'BAD'.                                 @Y30LB37*/ 04613000
*       /*                                                           */ 04614000
*       /*************************************************************/ 04615000
*                                                                  1301 04616000
*       IF TESTRC=0 THEN                                           1301 04617000
         LH    @05,TESTRC                                          1301 04618000
         LTR   @05,@05                                             1301 04619000
         BNZ   @RF01301                                            1301 04620000
*         CHKPASS=CATGOOD;          /*                       @Y30LB37*/ 04621000
         L     @05,@PC00017                                        1302 04622000
         MVC   CHKPASS(4,@05),CATGOOD                              1302 04623000
*       ELSE                                                       1303 04624000
*         DO;                       /*                       @Y30LB37*/ 04625000
         B     @RC01301                                            1303 04626000
@RF01301 DS    0H                                                  1304 04627000
*           CHKPASS=CATBAD;         /*                       @Y30LB37*/ 04628000
*                                                                  1304 04629000
         L     @05,@PC00017                                        1304 04630000
         MVC   CHKPASS(4,@05),CATBAD                               1304 04631000
*           /*********************************************************/ 04632000
*           /*                                                       */ 04633000
*           /* IF UCATLG RETURNED A PASSWORD ERROR THEN SET  @Y30LB37*/ 04634000
*           /* THE CATCKRC TO A PASSWORD ERROR IF CHECKING   @YD00171*/ 04635000
*           /* CATALOG MASTER PASSWORD IS NOT REQUIRED.      @YD00171*/ 04636000
*           /*                                                       */ 04637000
*           /*********************************************************/ 04638000
*                                                                  1305 04639000
*           IF TESTRC=RCPASERR&VSUCMAST=OFF THEN                   1305 04640000
         LA    @05,56                                              1305 04641000
         CH    @05,TESTRC                                          1305 04642000
         BNE   @RF01305                                            1305 04643000
         TM    VSUCMAST(ARGLPTR),B'00000001'                       1305 04644000
         BNZ   @RF01305                                            1305 04645000
*             CATCKRC=RCPASERR;     /*                       @YD00171*/ 04646000
         LR    CATCKRC,@05                                         1306 04647000
*           ELSE                                                   1307 04648000
*                                                                  1307 04649000
*             /*******************************************************/ 04650000
*             /*                                                     */ 04651000
*             /* IF CMS RETURNED A NO VOLUME ENTRY ERROR     @Y30LB37*/ 04652000
*             /* RETURN CODE THEN PRINT MESSAGE IDC2962I     @Y30LB37*/ 04653000
*             /* AND SET RETURN CODE TO RCFAIL.              @Y30LB37*/ 04654000
*             /*                                                     */ 04655000
*             /*******************************************************/ 04656000
*                                                                  1307 04657000
*             IF TESTRC=RCNVOLEN THEN                              1307 04658000
         B     @RC01305                                            1307 04659000
@RF01305 CLC   TESTRC(2),@CH00040                                  1307 04660000
         BNE   @RF01307                                            1307 04661000
*               DO;                 /*                       @Y30LB37*/ 04662000
*                 CATCKRC=4;        /*                       @Y30LB37*/ 04663000
         LA    CATCKRC,4                                           1309 04664000
*                 DARGSMOD=MSGMODID;/*                       @Y30LB37*/ 04665000
         L     @05,DDSTRU                                          1310 04666000
         MVC   DARGSMOD(3,@05),@CC01408                            1310 04667000
*                 DARGSENT=MSG2962I;/*                       @Y30LB37*/ 04668000
         MVI   DARGSENT(@05),X'04'                                 1311 04669000
*                 DARGDBP=VSVOLP;   /*                       @Y30LB37*/ 04670000
         L     @03,VSVOLP(,ARGLPTR)                                1312 04671000
         ST    @03,DARGDBP(,@05)                                   1312 04672000
*                 DARGILP=VOLSERLN; /*                       @Y30LB37*/ 04673000
         MVC   DARGILP(2,@05),@CH00035                             1313 04674000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB37*/ 04675000
         L     @05,@PC00001                                        1314 04676000
         ST    @05,@AL00001                                        1314 04677000
         LA    @03,@CF00120                                        1314 04678000
         ST    @03,@AL00001+4                                      1314 04679000
         LA    @03,DDSTRU                                          1314 04680000
         ST    @03,@AL00001+8                                      1314 04681000
         MVI   @AL00001+8,X'80'                                    1314 04682000
         L     @15,GDTPRT(,@05)                                    1314 04683000
         LA    @01,@AL00001                                        1314 04684000
         BALR  @14,@15                                             1314 04685000
*               END;                /*                       @Y30LB37*/ 04686000
*                                                                  1316 04687000
*           /*********************************************************/ 04688000
*           /*                                                       */ 04689000
*           /* IF CMS RETURNED INFORMATION IN FEED BACK      @Y30LB37*/ 04690000
*           /* AREA PRINT MESSAGE IDC3009I.                  @Y30LB37*/ 04691000
*           /*                                                       */ 04692000
*           /*********************************************************/ 04693000
*                                                                  1316 04694000
*             ELSE                                                 1316 04695000
*               DO;                 /*                       @Y30LB37*/ 04696000
         B     @RC01307                                            1316 04697000
@RF01307 DS    0H                                                  1317 04698000
*                 CATCKRC=4;        /*                       @Y30LB37*/ 04699000
         LA    CATCKRC,4                                           1317 04700000
*                 IF CTGFDBK^=NULLPTR THEN                         1318 04701000
         L     @05,CTGPLPTR                                        1318 04702000
         LH    @03,CTGFDBK(,@05)                                   1318 04703000
         N     @03,@CF01734                                        1318 04704000
         LTR   @03,@03                                             1318 04705000
         BZ    @RF01318                                            1318 04706000
*                   DO;             /*                       @Y30LB37*/ 04707000
*                     PRINTARG=''B; /*                       @Y30LB37*/ 04708000
         XC    PRINTARG(44),PRINTARG                               1320 04709000
*                     DARGSMOD=MSGUV0ID;/*                   @Y30LB37*/ 04710000
         L     @03,DDSTRU                                          1321 04711000
         MVC   DARGSMOD(3,@03),@CC01412                            1321 04712000
*                     DARGSENT=MUV3009I;/*                   @Y30LB37*/ 04713000
         MVI   DARGSENT(@03),X'0A'                                 1322 04714000
*                     DARGRETP=NULLPTR;/*                    @Y30LB37*/ 04715000
         SLR   @15,@15                                             1323 04716000
         ST    @15,DARGRETP(,@03)                                  1323 04717000
*                     DARGCNT=3;    /*                       @Y30LB37*/ 04718000
         LA    @15,3                                               1324 04719000
         STH   @15,DARGCNT(,@03)                                   1324 04720000
*                     DARGINS(1)=1; /*                       @Y30LB37*/ 04721000
         MVC   DARGINS(2,@03),@CH00223                             1325 04722000
*                     DARGDTM(1)=ADDR(TESTRC);/*             @Y30LB37*/ 04723000
         LA    @14,TESTRC                                          1326 04724000
         ST    @14,DARGDTM(,@03)                                   1326 04725000
*                     DARGINL(1)=LENGTH(TESTRC);/*           @Y30LB37*/ 04726000
         LA    @14,2                                               1327 04727000
         STH   @14,DARGINL(,@03)                                   1327 04728000
*                     DARGINS(2)=2; /*                       @Y30LB37*/ 04729000
         STH   @14,DARGINS+8(,@03)                                 1328 04730000
*                     DARGDTM(2)=ADDR(CTGFDBK);/*            @Y30LB37*/ 04731000
         LA    @01,CTGFDBK(,@05)                                   1329 04732000
         ST    @01,DARGDTM+8(,@03)                                 1329 04733000
*                     DARGINL(2)=LENGTH(CTGFDBK);/*          @Y30LB37*/ 04734000
         STH   @14,DARGINL+8(,@03)                                 1330 04735000
*                     DARGINS(3)=3; /*                       @Y30LB37*/ 04736000
         STH   @15,DARGINS+16(,@03)                                1331 04737000
*                     DARGDTM(3)=ADDR(CTGFBFLG);/*           @Y30LB37*/ 04738000
         LA    @05,CTGFBFLG(,@05)                                  1332 04739000
         ST    @05,DARGDTM+16(,@03)                                1332 04740000
*                     DARGINL(3)=2; /*                       @Y30LB37*/ 04741000
         STH   @14,DARGINL+16(,@03)                                1333 04742000
*                   END;            /*                       @Y30LB37*/ 04743000
*                                                                  1334 04744000
*                 /***************************************************/ 04745000
*                 /*                                                 */ 04746000
*                 /* IF CMS DID NOT RETURN INFORMATION IN    @Y30LB37*/ 04747000
*                 /* FEEDBACK AREA PRINT MESSAGE IDC3007I.   @Y30LB37*/ 04748000
*                 /*                                                 */ 04749000
*                 /***************************************************/ 04750000
*                                                                  1335 04751000
*                 ELSE                                             1335 04752000
*                   DO;             /*                       @Y30LB37*/ 04753000
         B     @RC01318                                            1335 04754000
@RF01318 DS    0H                                                  1336 04755000
*                     DARGSMOD=MSGUV0ID;/*                   @Y30LB37*/ 04756000
         L     @05,DDSTRU                                          1336 04757000
         MVC   DARGSMOD(3,@05),@CC01412                            1336 04758000
*                     DARGSENT=MUV3007I;/*                   @Y30LB37*/ 04759000
         MVI   DARGSENT(@05),X'07'                                 1337 04760000
*                     DARGDBP=ADDR(TESTRC);/*                @Y30LB37*/ 04761000
         LA    @03,TESTRC                                          1338 04762000
         ST    @03,DARGDBP(,@05)                                   1338 04763000
*                     DARGILP=LENGTH(TESTRC);/*              @Y30LB37*/ 04764000
         MVC   DARGILP(2,@05),@CH00159                             1339 04765000
*                     DARGRETP=NULLPTR;/*                    @Y30LB37*/ 04766000
         SLR   @03,@03                                             1340 04767000
         ST    @03,DARGRETP(,@05)                                  1340 04768000
*                   END;            /*                       @Y30LB37*/ 04769000
*                 CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    @Y30LB37*/ 04770000
@RC01318 L     @05,@PC00001                                        1342 04771000
         ST    @05,@AL00001                                        1342 04772000
         LA    @03,@CF00120                                        1342 04773000
         ST    @03,@AL00001+4                                      1342 04774000
         LA    @03,DDSTRU                                          1342 04775000
         ST    @03,@AL00001+8                                      1342 04776000
         MVI   @AL00001+8,X'80'                                    1342 04777000
         L     @15,GDTPRT(,@05)                                    1342 04778000
         LA    @01,@AL00001                                        1342 04779000
         BALR  @14,@15                                             1342 04780000
*               END;                /*                       @Y30LB37*/ 04781000
*         END;                      /*                       @Y30LB37*/ 04782000
@RC01307 DS    0H                                                  1344 04783000
@RC01305 DS    0H                                                  1345 04784000
*     END;                          /*                       @Y30LB37*/ 04785000
@RC01301 DS    0H                                                  1346 04786000
*                                                                  1346 04787000
*   /*****************************************************************/ 04788000
*   /*                                                               */ 04789000
*   /* IF THE VSUCTEST BIT IS ON THEN CHECK IF A PASSWORD    @Y30LB37*/ 04790000
*   /* ERROR OCCURRED, IF SO RE-ISSUE UCATLG MACRO USING     @Y30LB37*/ 04791000
*   /* THE SAVED CPL AND FPL PREVIOUSLY INITIALIZED.         @Y30LB37*/ 04792000
*   /*                                                               */ 04793000
*   /*****************************************************************/ 04794000
*                                                                  1346 04795000
*   IF VSUCTEST=ON THEN                                            1346 04796000
@RF01268 TM    VSUCTEST(ARGLPTR),B'00000100'                       1346 04797000
         BNO   @RF01346                                            1346 04798000
*     DO;                           /*                       @Y30LB37*/ 04799000
*       IF CATCKRC=RCPASERR THEN                                   1348 04800000
         C     CATCKRC,@CF01688                                    1348 04801000
         BNE   @RF01348                                            1348 04802000
*         DO;                       /*                       @Y30LB37*/ 04803000
*           CTGPLPTR=ADDR(V1CPSAVE);/*                       @Y30LB37*/ 04804000
         LA    @15,V1CPSAVE                                        1350 04805000
         ST    @15,CTGPLPTR                                        1350 04806000
*           CTGFLPTR=ADDR(V1CFSAVE);/*                       @Y30LB37*/ 04807000
         LA    CTGFLPTR,V1CFSAVE                                   1351 04808000
*           CTGMAST=OFF;            /*                       @Y30LB37*/ 04809000
         NI    CTGMAST(@15),B'10111111'                            1352 04810000
*           CALL IDCSACA0(GDTTBL,CTGPLPTR);/*                @Y30LB37*/ 04811000
         L     @05,@PC00001                                        1353 04812000
         ST    @05,@AL00001                                        1353 04813000
         LA    @15,CTGPLPTR                                        1353 04814000
         ST    @15,@AL00001+4                                      1353 04815000
         L     @15,GDTCAT(,@05)                                    1353 04816000
         LA    @01,@AL00001                                        1353 04817000
         BALR  @14,@15                                             1353 04818000
*           RESPECIFY                                              1354 04819000
*             RTNREG RSTD;                                         1354 04820000
*           TESTRC=RTNREG;                                         1355 04821000
         STH   RTNREG,TESTRC                                       1355 04822000
*           RESPECIFY                                              1356 04823000
*             RTNREG UNRSTD;        /*                       @Y30LB37*/ 04824000
*           IF TESTRC^=0 THEN                                      1357 04825000
         LH    @05,TESTRC                                          1357 04826000
         SLR   @15,@15                                             1357 04827000
         CR    @05,@15                                             1357 04828000
         BE    @RF01357                                            1357 04829000
*             DO;                   /*                       @Y30LB37*/ 04830000
*                                                                  1358 04831000
*               /*****************************************************/ 04832000
*               /*                                                   */ 04833000
*               /* IF ERROR THEN PRINT MESSAGE IDC3007I.     @Y30LB37*/ 04834000
*               /*                                                   */ 04835000
*               /*****************************************************/ 04836000
*                                                                  1359 04837000
*               CATCKRC=4;          /*                       @Y30LB37*/ 04838000
         LA    CATCKRC,4                                           1359 04839000
*               DARGSMOD=MSGUV0ID;  /*                       @Y30LB37*/ 04840000
         L     @05,DDSTRU                                          1360 04841000
         MVC   DARGSMOD(3,@05),@CC01412                            1360 04842000
*               DARGSENT=MUV3007I;  /*                       @Y30LB37*/ 04843000
         MVI   DARGSENT(@05),X'07'                                 1361 04844000
*               DARGDBP=ADDR(TESTRC);/*                      @Y30LB37*/ 04845000
         LA    @03,TESTRC                                          1362 04846000
         ST    @03,DARGDBP(,@05)                                   1362 04847000
*               DARGILP=LENGTH(TESTRC);/*                    @Y30LB37*/ 04848000
         MVC   DARGILP(2,@05),@CH00159                             1363 04849000
*               DARGRETP=NULLPTR;   /*                       @Y30LB37*/ 04850000
         ST    @15,DARGRETP(,@05)                                  1364 04851000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB37*/ 04852000
         L     @05,@PC00001                                        1365 04853000
         ST    @05,@AL00001                                        1365 04854000
         LA    @03,@CF00120                                        1365 04855000
         ST    @03,@AL00001+4                                      1365 04856000
         LA    @03,DDSTRU                                          1365 04857000
         ST    @03,@AL00001+8                                      1365 04858000
         MVI   @AL00001+8,X'80'                                    1365 04859000
         L     @15,GDTPRT(,@05)                                    1365 04860000
         LA    @01,@AL00001                                        1365 04861000
         BALR  @14,@15                                             1365 04862000
*             END;                  /*                       @Y30LB37*/ 04863000
*           ELSE                                                   1367 04864000
*             CATCKRC=0;            /*                       @Y30LB37*/ 04865000
         B     @RC01357                                            1367 04866000
@RF01357 SLR   CATCKRC,CATCKRC                                     1367 04867000
*         END;                      /*                       @Y30LB37*/ 04868000
*                                                                  1368 04869000
@RC01357 DS    0H                                                  1369 04870000
*       /*************************************************************/ 04871000
*       /*                                                           */ 04872000
*       /* IF USER CATALOG IS ON THIS VOLUME SET VSUCAT      @Y30LB37*/ 04873000
*       /* ON OR ELSE SET IT OFF.                            @Y30LB37*/ 04874000
*       /*                                                           */ 04875000
*       /*************************************************************/ 04876000
*                                                                  1369 04877000
*       IF CATCKRC=0 THEN                                          1369 04878000
@RF01348 LTR   CATCKRC,CATCKRC                                     1369 04879000
         BNZ   @RF01369                                            1369 04880000
*         IF V1CWRKAR=USERCAT9 THEN                                1370 04881000
         CLC   V1CWRKAR(3),USERCAT9                                1370 04882000
         BNE   @RF01370                                            1370 04883000
*           VSUCAT=ON;              /*                       @Y30LB37*/ 04884000
         OI    VSUCAT(ARGLPTR),B'01000000'                         1371 04885000
*         ELSE                                                     1372 04886000
*           VSUCAT=OFF;             /*                       @Y30LB37*/ 04887000
         B     @RC01370                                            1372 04888000
@RF01370 NI    VSUCAT(ARGLPTR),B'10111111'                         1372 04889000
*     END;                          /*                       @Y30LB37*/ 04890000
@RC01370 DS    0H                                                  1373 04891000
@RF01369 DS    0H                                                  1374 04892000
*                                                                  1374 04893000
*   /*****************************************************************/ 04894000
*   /*                                                               */ 04895000
*   /* IF THE CATIOCSP IS NOT ZEROS THEN ISSUE A UCLOSE      @Y30LB37*/ 04896000
*   /* MACRO. IF ERROR OCCURS THEN SET RETURN CODE TO 8      @Y30LB37*/ 04897000
*   /* (RCNCLOSE) UNLESS RETURN CODE ALREADY MORE SEVERE.    @Y30LB37*/ 04898000
*   /*                                                               */ 04899000
*   /*****************************************************************/ 04900000
*                                                                  1374 04901000
*   IF CATIOCSP^=NULLPTR THEN                                      1374 04902000
@RF01346 L     @05,CATIOCSP                                        1374 04903000
         LTR   @05,@05                                             1374 04904000
         BZ    @RF01374                                            1374 04905000
*     DO;                           /*                       @Y30LB37*/ 04906000
*       CALL IDCIOCL0(GDTTBL,CATIOCSP);/*                    @Y30LB37*/ 04907000
         L     @05,@PC00001                                        1376 04908000
         ST    @05,@AL00001                                        1376 04909000
         LA    @03,CATIOCSP                                        1376 04910000
         ST    @03,@AL00001+4                                      1376 04911000
         MVI   @AL00001+4,X'80'                                    1376 04912000
         L     @15,GDTCLS(,@05)                                    1376 04913000
         LA    @01,@AL00001                                        1376 04914000
         BALR  @14,@15                                             1376 04915000
*       RESPECIFY                                                  1377 04916000
*         RTNREG RSTD;                                             1377 04917000
*       TESTRC=RTNREG;                                             1378 04918000
         STH   RTNREG,TESTRC                                       1378 04919000
*       RESPECIFY                                                  1379 04920000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 04921000
*       IF TESTRC^=0&CATCKRC^=4 THEN                               1380 04922000
         LH    @05,TESTRC                                          1380 04923000
         LTR   @05,@05                                             1380 04924000
         BZ    @RF01380                                            1380 04925000
         C     CATCKRC,@CF00046                                    1380 04926000
         BE    @RF01380                                            1380 04927000
*         CATCKRC=8;                /*                       @Y30LB37*/ 04928000
         LA    CATCKRC,8                                           1381 04929000
*     END;                          /*                       @Y30LB37*/ 04930000
*                                                                  1382 04931000
@RF01380 DS    0H                                                  1383 04932000
*   /*****************************************************************/ 04933000
*   /*                                                               */ 04934000
*   /* IF THE ALLOCSW IS ON THEN ISSUE A UDEALLOC            @Y30LB37*/ 04935000
*   /* MACRO. IF ERROR OCCURS THEN SET RETURN CODE TO 8      @Y30LB37*/ 04936000
*   /* (RCNCLOSE) UNLESS RETURN CODE ALREADY MORE SEVERE.    @Y30LB37*/ 04937000
*   /*                                                               */ 04938000
*   /*****************************************************************/ 04939000
*                                                                  1383 04940000
*   IF ALLOCSW=ON THEN                                             1383 04941000
@RF01374 TM    ALLOCSW,B'00000001'                                 1383 04942000
         BNO   @RF01383                                            1383 04943000
*     DO;                           /*                       @Y30LB37*/ 04944000
*       CALL IDCSADL0(GDTTBL,ALLAGL);/*                      @Y30LB37*/ 04945000
         L     @05,@PC00001                                        1385 04946000
         ST    @05,@AL00001                                        1385 04947000
         LA    @03,ALLLIST                                         1385 04948000
         ST    @03,@AL00001+4                                      1385 04949000
         MVI   @AL00001+4,X'80'                                    1385 04950000
         L     @15,GDTDLC(,@05)                                    1385 04951000
         LA    @01,@AL00001                                        1385 04952000
         BALR  @14,@15                                             1385 04953000
*       RESPECIFY                                                  1386 04954000
*         RTNREG RSTD;                                             1386 04955000
*       TESTRC=RTNREG;                                             1387 04956000
         STH   RTNREG,TESTRC                                       1387 04957000
*       RESPECIFY                                                  1388 04958000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 04959000
*       IF TESTRC^=0&CATCKRC^=4 THEN                               1389 04960000
         LH    @05,TESTRC                                          1389 04961000
         LTR   @05,@05                                             1389 04962000
         BZ    @RF01389                                            1389 04963000
         C     CATCKRC,@CF00046                                    1389 04964000
         BE    @RF01389                                            1389 04965000
*         CATCKRC=8;                /*                       @Y30LB37*/ 04966000
         LA    CATCKRC,8                                           1390 04967000
*     END;                          /*                       @Y30LB37*/ 04968000
@RF01389 DS    0H                                                  1392 04969000
*   IF CATCKRC=RCPASERR THEN                                       1392 04970000
@RF01383 C     CATCKRC,@CF01688                                    1392 04971000
         BNE   @RF01392                                            1392 04972000
*     CATCKRC=0;                    /*                       @Y30LB37*/ 04973000
         SLR   CATCKRC,CATCKRC                                     1393 04974000
*   RETURN CODE(CATCKRC);           /* RETURN TO MAIN ROUTINE      1394 04975000
*                                                            @Y30LB37*/ 04976000
@RF01392 LR    @15,CATCKRC                                         1394 04977000
         L     @14,@SA00017                                        1394 04978000
         LM    @00,@12,@SA00017+8                                  1394 04979000
         BR    @14                                                 1394 04980000
*   END CATCHK;                     /* END OF CATCHK PROC    @Y30LB37*/ 04981000
*                                                                  1396 04982000
*/********************************************************************/ 04983000
*/*                                                                  */ 04984000
*/*  PROCEDURE NAME - CATOPEN                                @Y30LB37*/ 04985000
*/*                                                          @Y30LB37*/ 04986000
*/*  FUNCTION - THIS PROCEDURE ALLOCATES A DD CARD FOR THE   @Y30LB37*/ 04987000
*/*             CATALOG IF NECESSARY & OPENS A VSAM CATALOG  @Y30LB37*/ 04988000
*/*             TO VERIFY PASSWORDS, AND PRINTS ERROR        @Y30LB37*/ 04989000
*/*             MESSAGE IDC3010I.  PERFORMS UALLOC IF        @Y30LB37*/ 04990000
*/*             DDNAME NOT PASSED BY CALLER.                 @Y30LB37*/ 04991000
*/*                                                          @Y30LB37*/ 04992000
*/*  INPUT - THE INFORMATION PASSED IN THE VS1AGL ARGUMENT   @Y30LB37*/ 04993000
*/*          LIST:  FIELDS VSCATP, VSCATDDP, VSVOLP, VSACBP, @Y30LB37*/ 04994000
*/*          VSOPCAT AND VSPSWDP.  TWO INPUT PARA-           @Y30LB37*/ 04995000
*/*          METERS ARE PASSED THAT WILL BE INITIALIZED IF   @Y30LB37*/ 04996000
*/*          THE CATALOG OPEN IS SUCCESSFUL.  THEY ARE (1)   @Y30LB37*/ 04997000
*/*          OPENACB - ACB POINTER AND (2) OPENIOCS - OPEN   @Y30LB37*/ 04998000
*/*          IOCSTR POINTER.                                 @Y30LB37*/ 04999000
*/*                                                          @Y30LB37*/ 05000000
*/*  OUTPUT- THE INFORMATION RETURNED IS EITHER A ZERO,      @Y30LB37*/ 05001000
*/*          OR FOUR ERROR CODE.  ALLOCSW SET ON IF UALLOC   @Y30LB37*/ 05002000
*/*          IS PERFORMED SUCCESSFULLY AND THE DDNAME IN THE @Y30LB37*/ 05003000
*/*          VS1AGL POINTED TO BY VSCATDDP.  TWO INPUT PARA- @Y30LB37*/ 05004000
*/*          METERS ARE PASSED THAT WILL BE INITIALIZED IF   @Y30LB37*/ 05005000
*/*          THE CATALOG OPEN IS SUCCESSFUL.  THEY ARE (1)   @Y30LB37*/ 05006000
*/*          OPENACB - ACB POINTER AND (2) OPENIOCS - OPEN   @Y30LB37*/ 05007000
*/*          IOCSTR POINTER.                                 @Y30LB37*/ 05008000
*/*          RETURN CODES ARE:                               @Y30LB37*/ 05009000
*/*          0 - SUCCESSFUL                                  @Y30LB37*/ 05010000
*/*          4 - ERROR OPENING THE CATALOG                   @Y30LB37*/ 05011000
*/*              ERROR ALLOCATING CATALOG                    @Y30LB37*/ 05012000
*/*                                                                  */ 05013000
*/********************************************************************/ 05014000
*                                                                  1396 05015000
*CATOPEN:                                                          1396 05016000
*   PROCEDURE(OPENACB,              /* OPEN ACB POINTER      @Y30LB37*/ 05017000
*       OPENIOCS);                  /* OPEN IOCSTR POINTER   @Y30LB37*/ 05018000
CATOPEN  STM   @14,@12,@SA00018                                    1396 05019000
         MVC   @PC00018(8),0(@01)                                  1396 05020000
*                                                                  1397 05021000
*   /*****************************************************************/ 05022000
*   /*                                                               */ 05023000
*   /* LOCAL DECLARATIONS FOR CATOPEN                        @Y30LB37*/ 05024000
*   /*                                                               */ 05025000
*   /*****************************************************************/ 05026000
*                                                                  1397 05027000
*   DCL                                                            1397 05028000
*     CATOPRC FIXED(15);            /* CATOPEN RETURN CODE   @Y30LB37*/ 05029000
*   DCL                                                            1398 05030000
*     OPENACB PTR(31);              /* CATALOG ACB PARM AREA @Y30LB37*/ 05031000
*   DCL                                                            1399 05032000
*     OPENIOCS PTR(31);             /* CATALOG OPEN IOCSTRP  @Y30LB37*/ 05033000
*   DCL                                                            1400 05034000
*     BLANKDDN CHAR(8) STATIC       /* BLANK DDNAME          @Y30LB37*/ 05035000
*         INIT('        ');         /* INITIALIZED           @Y30LB37*/ 05036000
*   DCL                                                            1401 05037000
*     OPENLST CHAR(LENGTH(OPNAGL))  /* OPEN GETMAINED        @Y30LB37*/ 05038000
*         BDY(WORD);                /* LIST                  @Y30LB37*/ 05039000
*   DCL                                                            1402 05040000
*     CATDSN CHAR(44) BASED;        /* DSNAME FOR COMPARING  @Y30LB37*/ 05041000
*                                                                  1403 05042000
*   /*****************************************************************/ 05043000
*   /*                                                               */ 05044000
*   /* ISSUE UTRACE MACRO AND INITIALIZE OPNPTR AND RETURN   @Y30LB37*/ 05045000
*   /* CODE.                                                 @Y30LB37*/ 05046000
*   /*                                                               */ 05047000
*   /*****************************************************************/ 05048000
*                                                                  1403 05049000
*   OLDERID2=NEWERID2;                                             1403 05050000
         L     @03,@PC00001                                        1403 05051000
         L     @15,GDTTR2(,@03)                                    1403 05052000
         MVC   @TS00001(95),NEWERID2(@15)                          1403 05053000
         MVC   OLDERID2(95,@15),@TS00001                           1403 05054000
*   NEWID2='VSCO';                  /* ISSUE UTRACE MACRO    @Y30LB37*/ 05055000
         MVC   NEWID2(4,@15),@CC01706                              1404 05056000
*   CATOPRC=0;                      /*                       @Y30LB37*/ 05057000
         SLR   @15,@15                                             1405 05058000
         LR    CATOPRC,@15                                         1405 05059000
*   OPNPTR=ADDR(OPENLST);           /*                       @Y30LB37*/ 05060000
         LA    OPNPTR,OPENLST                                      1406 05061000
*   OPNAGL=''B;                     /* CLEAR THE OPEN AGL    @ZA11678*/ 05062000
         XC    OPNAGL(48,OPNPTR),OPNAGL(OPNPTR)                    1407 05063000
*                                                                  1408 05064000
*   /*****************************************************************/ 05065000
*   /*                                                               */ 05066000
*   /* CHECK VSOPCAT AND VSCATP FIELDS TO SEE IF AN OPEN     @Y30LB37*/ 05067000
*   /* SHOULD BE PERFORMED OR NOT.                           @Y30LB37*/ 05068000
*   /*                                                               */ 05069000
*   /*****************************************************************/ 05070000
*                                                                  1408 05071000
*   IF VSOPCAT=ON&VSCATP^=NULLPTR THEN                             1408 05072000
         TM    VSOPCAT(ARGLPTR),B'00000010'                        1408 05073000
         BNO   @RF01408                                            1408 05074000
         L     @14,VSCATP(,ARGLPTR)                                1408 05075000
         CR    @14,@15                                             1408 05076000
         BE    @RF01408                                            1408 05077000
*     DO;                           /*                       @Y30LB37*/ 05078000
*                                                                  1409 05079000
*       /*************************************************************/ 05080000
*       /*                                                           */ 05081000
*       /* CHECK TO SEE IF DDNAME FOR CATALOG IS BLANK.      @Y30LB37*/ 05082000
*       /* IF SO, THEN ISSUE A UALLOC MACRO.                 @Y30LB37*/ 05083000
*       /*                                                           */ 05084000
*       /*************************************************************/ 05085000
*                                                                  1410 05086000
*       IF VSCATDDP->V1DDNAM=BLANKDDN THEN                         1410 05087000
         L     @01,VSCATDDP(,ARGLPTR)                              1410 05088000
         CLC   V1DDNAM(8,@01),BLANKDDN                             1410 05089000
         BNE   @RF01410                                            1410 05090000
*         DO;                       /*                       @Y30LB37*/ 05091000
*           ALLDSN=VSCATP;          /*                       @Y30LB37*/ 05092000
         LA    @15,ALLLIST                                         1412 05093000
         ST    @14,ALLDSN(,@15)                                    1412 05094000
*           ALLSTSSR=ON;            /*                       @Y30LB37*/ 05095000
         OI    ALLSTSSR(@15),B'00001000'                           1413 05096000
*           ALLDSPKP=ON;            /*                       @Y30LB37*/ 05097000
         OI    ALLDSPKP(@15),B'00001000'                           1414 05098000
*           ALLOPTDS=ON;            /*                       @Y30LB37*/ 05099000
         OI    ALLOPTDS(@15),B'01000000'                           1415 05100000
*           CALL IDCSAAL0(GDTTBL,ALLAGL);/*                  @Y30LB37*/ 05101000
         ST    @03,@AL00001                                        1416 05102000
         ST    @15,@AL00001+4                                      1416 05103000
         MVI   @AL00001+4,X'80'                                    1416 05104000
         L     @15,GDTALC(,@03)                                    1416 05105000
         LA    @01,@AL00001                                        1416 05106000
         BALR  @14,@15                                             1416 05107000
*           RESPECIFY                                              1417 05108000
*             RTNREG RSTD;                                         1417 05109000
*           TESTRC=RTNREG;                                         1418 05110000
         STH   RTNREG,TESTRC                                       1418 05111000
*           RESPECIFY                                              1419 05112000
*             RTNREG UNRSTD;        /*                       @Y30LB37*/ 05113000
*                                                                  1419 05114000
*           /*********************************************************/ 05115000
*           /*                                                       */ 05116000
*           /* IF UALLOC FAILS SET RETURN CODE TO RCFAIL.    @Y30LB37*/ 05117000
*           /* IF UALLOC IS SUCCESSFUL THEN PLACE THE DD-    @Y30LB37*/ 05118000
*           /* NAME RETURNED BY UALLOC IN THE FIELD POINTED  @Y30LB37*/ 05119000
*           /* TO BY VSCATDDP AND SET THE UALLOC SWITCH ON.  @Y30LB37*/ 05120000
*           /*                                                       */ 05121000
*           /*********************************************************/ 05122000
*                                                                  1420 05123000
*           IF TESTRC^=0 THEN                                      1420 05124000
         LH    @03,TESTRC                                          1420 05125000
         LTR   @03,@03                                             1420 05126000
         BZ    @RF01420                                            1420 05127000
*             CATOPRC=4;            /*                       @Y30LB37*/ 05128000
         LA    CATOPRC,4                                           1421 05129000
*           ELSE                                                   1422 05130000
*             DO;                   /*                       @Y30LB37*/ 05131000
         B     @RC01420                                            1422 05132000
@RF01420 DS    0H                                                  1423 05133000
*               VSCATDDP->V1DDNAM=ALLDDN;/*                  @Y30LB37*/ 05134000
         L     @03,VSCATDDP(,ARGLPTR)                              1423 05135000
         LA    @15,ALLLIST                                         1423 05136000
         MVC   V1DDNAM(8,@03),ALLDDN(@15)                          1423 05137000
*               ALLOCSW=ON;         /*                       @Y30LB37*/ 05138000
         OI    ALLOCSW,B'00000001'                                 1424 05139000
*             END;                  /*                       @Y30LB37*/ 05140000
*         END;                      /*                       @Y30LB37*/ 05141000
*     END;                          /*                       @Y30LB37*/ 05142000
*   ELSE                                                           1428 05143000
*     CATOPRC=RCFUNTRM;             /*                       @Y30LB37*/ 05144000
         B     @RC01408                                            1428 05145000
@RF01408 LA    CATOPRC,12                                          1428 05146000
*                                                                  1429 05147000
*   /*****************************************************************/ 05148000
*   /*                                                               */ 05149000
*   /* ISSUE THE UOPEN MACRO TO OPEN THE CATALOG FOR         @Y30LB37*/ 05150000
*   /* PASSWORD CHECKING IF RETURN CODE IS ZERO.             @Y30LB37*/ 05151000
*   /*                                                               */ 05152000
*   /*****************************************************************/ 05153000
*                                                                  1429 05154000
*   IF CATOPRC=0 THEN                                              1429 05155000
@RC01408 LTR   CATOPRC,CATOPRC                                     1429 05156000
         BNZ   @RF01429                                            1429 05157000
*     DO;                           /*                       @Y30LB37*/ 05158000
*       OPNTYPCI=ON;                /* OPEN CATALOG OPTION   @Y30LB37*/ 05159000
         OI    OPNTYPCI(OPNPTR),B'00100000'                        1431 05160000
*       OPNIOC=ADDR(OPENIOCS);      /* OPEN IOCSTR POINTER   @Y30LB37*/ 05161000
         L     @03,@PC00018+4                                      1432 05162000
         ST    @03,OPNIOC(,OPNPTR)                                 1432 05163000
*       OPNOPTUP=ON;                /* OPEN FOR UPDATE       @Y30LB37*/ 05164000
         OI    OPNOPTUP(OPNPTR),B'00100000'                        1433 05165000
*       OPNDDN=VSCATDDP;            /* DDNAME ADDRESS        @Y30LB37*/ 05166000
         L     @03,VSCATDDP(,ARGLPTR)                              1434 05167000
         ST    @03,OPNDDN(,OPNPTR)                                 1434 05168000
*       OPNMODRC=ON;                /* RETURN ACB ADDRESS    @Y30LB37*/ 05169000
         OI    OPNMODRC(OPNPTR),B'00100000'                        1435 05170000
*       OPNPWA=VSPSWDP;             /* PASSWORD ADDR IF ^0   @Y30LB37*/ 05171000
         L     @03,VSPSWDP(,ARGLPTR)                               1436 05172000
         ST    @03,OPNPWA(,OPNPTR)                                 1436 05173000
*       CALL IDCIOOP0(GDTTBL,OPNAGL);/* OPEN THE CATALOG     @Y30LB37*/ 05174000
         L     @03,@PC00001                                        1437 05175000
         ST    @03,@AL00001                                        1437 05176000
         ST    OPNPTR,@AL00001+4                                   1437 05177000
         MVI   @AL00001+4,X'80'                                    1437 05178000
         L     @15,GDTOPN(,@03)                                    1437 05179000
         LA    @01,@AL00001                                        1437 05180000
         BALR  @14,@15                                             1437 05181000
*       RESPECIFY                                                  1438 05182000
*         RTNREG RSTD;                                             1438 05183000
*       TESTRC=RTNREG;                                             1439 05184000
         STH   RTNREG,TESTRC                                       1439 05185000
*       RESPECIFY                                                  1440 05186000
*         RTNREG UNRSTD;            /*                       @Y30LB37*/ 05187000
*                                                                  1440 05188000
*       /*************************************************************/ 05189000
*       /*                                                           */ 05190000
*       /* IF UOPEN SUCCESSFUL AND CATALOG NAMES ARE EQUAL   @Y30LB37*/ 05191000
*       /* THEN SET PARAMETERS TO IOCSPTR AND ACB PTR. IF    @Y30LB37*/ 05192000
*       /* UOPEN UNSUCCESSFUL AND CATALOG NAMES ARE          @Y30LB37*/ 05193000
*       /* NOT EQUAL THEN PRINT MESSAGE IDC3010I VIA UPRINT  @Y30LB37*/ 05194000
*       /* AND SET RETURN CODE TO 4. IF OPEN IS NOT SUC-     @Y30LB37*/ 05195000
*       /* CESSFUL, SET RETURN CODE TO RCFAIL.               @Y30LB37*/ 05196000
*       /*                                                           */ 05197000
*       /*************************************************************/ 05198000
*                                                                  1441 05199000
*       IF TESTRC=0&VSCATP^=NULLPTR THEN                           1441 05200000
         LH    @15,TESTRC                                          1441 05201000
         SLR   @14,@14                                             1441 05202000
         CR    @15,@14                                             1441 05203000
         BNE   @RF01441                                            1441 05204000
         L     @15,VSCATP(,ARGLPTR)                                1441 05205000
         CR    @15,@14                                             1441 05206000
         BE    @RF01441                                            1441 05207000
*         DO;                       /*                       @Y30LB37*/ 05208000
*           RFY                                                    1443 05209000
*             IOCSTR BASED(OPENIOCS);/*                      @Y30LB37*/ 05210000
*           IF VSCATP->CATDSN=IOCDSN->CATDSN THEN                  1444 05211000
         L     @14,@PC00018+4                                      1444 05212000
         L     @14,OPENIOCS(,@14)                                  1444 05213000
         L     @01,IOCDSN(,@14)                                    1444 05214000
         CLC   CATDSN(44,@15),CATDSN(@01)                          1444 05215000
         BNE   @RF01444                                            1444 05216000
*             OPENACB=IOCCBP;       /*                       @Y30LB37*/ 05217000
         L     @15,@PC00018                                        1445 05218000
         L     @14,IOCCBP(,@14)                                    1445 05219000
         ST    @14,OPENACB(,@15)                                   1445 05220000
*           ELSE                                                   1446 05221000
*             DO;                   /*                       @Y30LB37*/ 05222000
         B     @RC01444                                            1446 05223000
@RF01444 DS    0H                                                  1447 05224000
*               DARGSMOD=MSGUV0ID;  /*                       @Y30LB37*/ 05225000
         L     @15,DDSTRU                                          1447 05226000
         MVC   DARGSMOD(3,@15),@CC01412                            1447 05227000
*               DARGSENT=MUV3010I;  /*                       @Y30LB37*/ 05228000
         MVI   DARGSENT(@15),X'0B'                                 1448 05229000
*               DARGDBP=VSCATP;     /*                       @Y30LB37*/ 05230000
         L     @14,VSCATP(,ARGLPTR)                                1449 05231000
         ST    @14,DARGDBP(,@15)                                   1449 05232000
*               DARGILP=LENGTH(CATDSN);/*                    @Y30LB37*/ 05233000
         MVC   DARGILP(2,@15),@CH00849                             1450 05234000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Y30LB37*/ 05235000
         L     @15,@PC00001                                        1451 05236000
         ST    @15,@AL00001                                        1451 05237000
         LA    @14,@CF00120                                        1451 05238000
         ST    @14,@AL00001+4                                      1451 05239000
         LA    @14,DDSTRU                                          1451 05240000
         ST    @14,@AL00001+8                                      1451 05241000
         MVI   @AL00001+8,X'80'                                    1451 05242000
         L     @15,GDTPRT(,@15)                                    1451 05243000
         LA    @01,@AL00001                                        1451 05244000
         BALR  @14,@15                                             1451 05245000
*               CATOPRC=4;          /*                       @Y30LB37*/ 05246000
         LA    CATOPRC,4                                           1452 05247000
*             END;                  /*                       @Y30LB37*/ 05248000
*         END;                      /*                       @Y30LB37*/ 05249000
*       ELSE                                                       1455 05250000
*         CATOPRC=4;                /*                       @Y30LB37*/ 05251000
         B     @RC01441                                            1455 05252000
@RF01441 LA    CATOPRC,4                                           1455 05253000
*     END;                          /*                       @Y30LB37*/ 05254000
@RC01441 DS    0H                                                  1457 05255000
*                                                                  1457 05256000
*   /*****************************************************************/ 05257000
*   /*                                                               */ 05258000
*   /* CLOSE THE CATALOG IF OPEN FAILURE BUT OPEN PERFORMED  @Y30LB37*/ 05259000
*   /* SOME FUNCTION.                                        @Y30LB37*/ 05260000
*   /*                                                               */ 05261000
*   /*****************************************************************/ 05262000
*                                                                  1457 05263000
*   IF CATOPRC=4&OPENIOCS^=NULLPTR THEN                            1457 05264000
@RF01429 C     CATOPRC,@CF00046                                    1457 05265000
         BNE   @RF01457                                            1457 05266000
         L     @15,@PC00018+4                                      1457 05267000
         L     @14,OPENIOCS(,@15)                                  1457 05268000
         LTR   @14,@14                                             1457 05269000
         BZ    @RF01457                                            1457 05270000
*     DO;                           /*                       @Y30LB37*/ 05271000
*       CALL IDCIOCL0(GDTTBL,OPENIOCS);/*                    @Y30LB37*/ 05272000
         L     @14,@PC00001                                        1459 05273000
         ST    @14,@AL00001                                        1459 05274000
         ST    @15,@AL00001+4                                      1459 05275000
         MVI   @AL00001+4,X'80'                                    1459 05276000
         L     @15,GDTCLS(,@14)                                    1459 05277000
         LA    @01,@AL00001                                        1459 05278000
         BALR  @14,@15                                             1459 05279000
*       OPENIOCS=NULLPTR;           /*                       @Y30LB37*/ 05280000
         L     @15,@PC00018+4                                      1460 05281000
         SLR   @14,@14                                             1460 05282000
         ST    @14,OPENIOCS(,@15)                                  1460 05283000
*     END;                          /*                       @Y30LB37*/ 05284000
*   IF CATOPRC=RCFUNTRM THEN                                       1462 05285000
@RF01457 C     CATOPRC,@CF00037                                    1462 05286000
         BNE   @RF01462                                            1462 05287000
*     CATOPRC=0;                    /* CHANGE RC 12 TO AN 8  @Y30LB37*/ 05288000
         SLR   CATOPRC,CATOPRC                                     1463 05289000
*   RETURN CODE(CATOPRC);           /* RETURN TO MAIN ROUTINE      1464 05290000
*                                                            @Y30LB37*/ 05291000
@RF01462 LR    @15,CATOPRC                                         1464 05292000
         L     @14,@SA00018                                        1464 05293000
         LM    @00,@12,@SA00018+8                                  1464 05294000
         BR    @14                                                 1464 05295000
*   END CATOPEN;                    /* END OF CATOPEN PROC   @Y30LB37*/ 05296000
*   END IDCVS01                     /* END OF MSS VOLUME SERVICES -     05297000
*                                      IDCVS01               @Y30LB37*/ 05298000
*                                                                  1466 05299000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05300000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 05301000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 05302000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 05303000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 05304000
*/*%INCLUDE SYSLIB  (IECSDSL1)                                       */ 05305000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                       */ 05306000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                       */ 05307000
*                                                                  1466 05308000
*       ;                                                          1466 05309000
@DATA    DS    0H                                                       05310000
@CH00159 DC    H'2'                                                     05311000
@CH00035 DC    H'6'                                                     05312000
@CH00041 DC    H'7'                                                     05313000
@CH00036 DC    H'10'                                                    05314000
@CH00849 DC    H'44'                                                    05315000
@CH01708 DC    H'52'                                                    05316000
         DS    0F                                                       05317000
@AL00685 EQU   *                       LIST WITH   2 ARGUMENT(S)        05318000
@AL00998 DC    A(ORGTNONV)             LIST WITH   2 ARGUMENT(S)        05319000
         DC    A(PROTTALL)                                              05320000
@AL00834 DC    A(ORGTALL)              LIST WITH   2 ARGUMENT(S)        05321000
         DC    A(PROTTALL)                                              05322000
@DATD    DSECT                                                          05323000
         DS    0F                                                       05324000
@SA00001 DS    18F                                                      05325000
@PC00001 DS    3F                                                       05326000
@SA00011 DS    15F                                                      05327000
@SA00002 DS    15F                                                      05328000
@SA00003 DS    15F                                                      05329000
@SA00008 DS    15F                                                      05330000
@SA00007 DS    15F                                                      05331000
@SA00004 DS    15F                                                      05332000
@SA00005 DS    15F                                                      05333000
@SA00006 DS    14F                                                      05334000
@PC00006 DS    2F                                                       05335000
@SA00009 DS    15F                                                      05336000
@SA00010 DS    15F                                                      05337000
@SA00012 DS    15F                                                      05338000
@PC00012 DS    1F                                                       05339000
@SA00013 DS    15F                                                      05340000
@PC00013 DS    1F                                                       05341000
@SA00017 DS    15F                                                      05342000
@PC00017 DS    1F                                                       05343000
@SA00014 DS    15F                                                      05344000
@SA00016 DS    15F                                                      05345000
@SA00015 DS    15F                                                      05346000
@SA00018 DS    15F                                                      05347000
@PC00018 DS    2F                                                       05348000
@AL00001 DS    6A                                                       05349000
IDCVS01  CSECT                                                          05350000
         DS    0F                                                       05351000
@CF00120 DC    F'0'                                                     05352000
@CF00223 DC    F'1'                                                     05353000
@CH00223 EQU   @CF00223+2                                               05354000
@CF00046 DC    F'4'                                                     05355000
@CH00046 EQU   @CF00046+2                                               05356000
@CF00040 DC    F'8'                                                     05357000
@CH00040 EQU   @CF00040+2                                               05358000
@CF00037 DC    F'12'                                                    05359000
@CF00509 DC    F'16'                                                    05360000
@CF01688 DC    F'56'                                                    05361000
@CF01150 DC    F'96'                                                    05362000
@CF01552 DC    F'1000'                                                  05363000
@CF01734 DC    XL4'0000FFFF'                                            05364000
@DATD    DSECT                                                          05365000
         DS    0D                                                       05366000
LISTSCAN DS    A                                                        05367000
IOCSPTR  DS    A                                                        05368000
DDSTRU   DS    A                                                        05369000
FSADDR   DS    A                                                        05370000
ERCNVADR DS    A                                                        05371000
DMPINDEX DS    A                                                        05372000
CCMSGPTR DS    A                                                        05373000
CMMSGPTR DS    A                                                        05374000
CTMSGPTR DS    A                                                        05375000
ELEMENT  DS    F                                                        05376000
F4PTR    DS    A                                                        05377000
CTGPLPTR DS    A                                                        05378000
VRACFPTR DS    A                                                        05379000
RTNAREA  DS    A                                                        05380000
INFOPTR  DS    A                                                        05381000
DATEWORK DS    FL4                                                      05382000
         ORG   DATEWORK                                                 05383000
@NM00122 DS    BL1                                                      05384000
DAWKYEAR DS    BL1                                                      05385000
DAWKDAY  DS    BL2                                                      05386000
         ORG   DATEWORK+4                                               05387000
CATCOUNT DS    F                                                        05388000
VVOLPTR  DS    A                                                        05389000
IOBLKPTR DS    A                                                        05390000
CATIOCSP DS    A                                                        05391000
CATACB   DS    A                                                        05392000
LISTPTR  DS    A                                                        05393000
TESTRC   DS    H                                                        05394000
RETCODE  DS    H                                                        05395000
SETRC    DS    H                                                        05396000
LISTLN   DS    FL1                                                      05397000
         DS    0D                                                       05398000
@TS00001 DS    CL95                                                     05399000
         DS    CL1                                                      05400000
PRINTARG DS    CL44                                                     05401000
EXOLIST  DS    CL34                                                     05402000
         DS    CL2                                                      05403000
ALLLIST  DS    CL31                                                     05404000
         DS    CL1                                                      05405000
VS1RACF  DS    CL20                                                     05406000
CLASSRAC DS    CL9                                                      05407000
         ORG   CLASSRAC                                                 05408000
CLASSLEN DS    AL1                                                      05409000
CLASSNM  DS    CL8                                                      05410000
         ORG   CLASSRAC+9                                               05411000
V1PGSWS  DS    CL2                                                      05412000
         ORG   V1PGSWS                                                  05413000
EXPONLY  DS    BL1                                                      05414000
QUITSW   EQU   V1PGSWS+0                                                05415000
TERMSW   EQU   V1PGSWS+0                                                05416000
SCRERRSW EQU   V1PGSWS+0                                                05417000
RECATSW  EQU   V1PGSWS+0                                                05418000
SECHKSW  EQU   V1PGSWS+0                                                05419000
OPENSW   EQU   V1PGSWS+0                                                05420000
ALLOCSW  EQU   V1PGSWS+0                                                05421000
RESETDS1 DS    BL1                                                      05422000
NOSCRDS1 EQU   V1PGSWS+1                                                05423000
         ORG   V1PGSWS+2                                                05424000
         DS    CL1                                                      05425000
INFOAREA DS    CL11                                                     05426000
         DS    CL1                                                      05427000
V1DSNTBL DS    CL13262                                                  05428000
         ORG   V1DSNTBL                                                 05429000
V1DDCNT  DS    FL2                                                      05430000
@NM00120 DS    CL52                                                     05431000
         ORG   @NM00120+0                                               05432000
V1DDDNAM DS    CL8                                                      05433000
V1DDSNAM DS    CL44                                                     05434000
         ORG   V1DSNTBL+13262                                           05435000
VPTIME   DS    CL8                                                      05436000
VPDATE   DS    CL4                                                      05437000
         DS    CL2                                                      05438000
OPNLIST  DS    CL384                                                    05439000
CNTVOL   DS    CL7                                                      05440000
         ORG   CNTVOL                                                   05441000
COUNT    DS    FL1                                                      05442000
VOLLAB   DS    CL6                                                      05443000
         ORG   CNTVOL+7                                                 05444000
         DS    CL1                                                      05445000
MINORNAM DS    CL23                                                     05446000
         ORG   MINORNAM                                                 05447000
MINLEN   DS    FL1                                                      05448000
MINVOL   DS    CL6                                                      05449000
MINCON   DS    CL16                                                     05450000
         ORG   MINORNAM+23                                              05451000
F1TIME   DS    CL8                                                      05452000
F1DATE   DS    CL4                                                      05453000
         DS    CL1                                                      05454000
EXPDWORK DS    CL3                                                      05455000
         ORG   EXPDWORK                                                 05456000
EXPYEAR  DS    BL1                                                      05457000
EXPDAY   DS    BL2                                                      05458000
         ORG   EXPDWORK+3                                               05459000
         DS    CL1                                                      05460000
RECATARG DS    CL76                                                     05461000
VOLIST   DS    CL2                                                      05462000
CATPASS  DS    CL4                                                      05463000
ORGTAREA DS    CL4                                                      05464000
PROTAREA DS    CL8                                                      05465000
         DS    CL2                                                      05466000
IOINFBLK DS    CL52                                                     05467000
         ORG   IOINFBLK                                                 05468000
IOHEADLN DS    FL2                                                      05469000
IOHEAD02 DS    FL2                                                      05470000
IOID     DS    CL2                                                      05471000
IOLENGTH DS    CL2                                                      05472000
IORETDSN DS    CL44                                                     05473000
         ORG   IOINFBLK+52                                              05474000
IOINFBYT DS    CL1                                                      05475000
V1NVDDNM DS    CL8                                                      05476000
         DS    CL3                                                      05477000
V1CPLIST DS    CL32                                                     05478000
V1CFLIST DS    CL24                                                     05479000
V1CPSAVE DS    CL32                                                     05480000
V1CFSAVE DS    CL24                                                     05481000
VOLBLOCK DS    CL44                                                     05482000
         ORG   VOLBLOCK                                                 05483000
VOLBSER  DS    CL6                                                      05484000
VOLBLANK DS    CL38                                                     05485000
         ORG   VOLBLOCK+44                                              05486000
V1CWORKA DS    CL7                                                      05487000
         ORG   V1CWORKA                                                 05488000
V1CWRKLN DS    FL2                                                      05489000
V1CRETLN DS    FL2                                                      05490000
V1CWRKAR DS    CL3                                                      05491000
         ORG   V1CWORKA+7                                               05492000
         DS    CL1                                                      05493000
OPENLST  DS    CL384                                                    05494000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05495000
@ENDDATD EQU   *                                                        05496000
IDCVS01  CSECT                                                          05497000
         DS    0F                                                       05498000
@SIZDATD DC    AL1(0)                                                   05499000
         DC    AL3(@ENDDATD-@DATD)                                      05500000
         DS    0D                                                       05501000
@CC01329 DC    C'VS01'                                                  05502000
@CC01471 DC    C'VSBG'                                                  05503000
@CC01479 DC    C'VSND'                                                  05504000
@CC01484 DC    C'VSVG'                                                  05505000
@CC01493 DC    C'VSVP'                                                  05506000
@CC01519 DC    C'VSVT'                                                  05507000
@CC01528 DC    C'VS4R'                                                  05508000
@CC01553 DC    C'VS1R'                                                  05509000
@CC01565 DC    C'VSRC'                                                  05510000
@CC01572 DC    C'VSSC'                                                  05511000
@CC01579 DC    C'VS4S'                                                  05512000
@CC01587 DC    C'VS1S'                                                  05513000
@CC01595 DC    C'VSSE'                                                  05514000
@CC01604 DC    C'VS4C'                                                  05515000
@CC01614 DC    C'VS1C'                                                  05516000
@CC01626 DC    C'VSVC'                                                  05517000
@CC01650 DC    C'VSNC'                                                  05518000
@CC01664 DC    C'VSEC'                                                  05519000
@CC01692 DC    C'VSCC'                                                  05520000
@CC01706 DC    C'VSCO'                                                  05521000
@CC01408 EQU   @CC01329                                                 05522000
@CC01410 DC    C'CM0'                                                   05523000
@CC01412 DC    C'UV0'                                                   05524000
ALL      DC    CL3'ALL'                                                 05525000
FORMAT   DC    CL4'FORM'                                                05526000
HSECOND  DC    CL4'HSEC'                                                05527000
CLOCK    DC    CL4'KLOK'                                                05528000
SETZERO  DC    CL4'ZERO'                                                05529000
SETBLANK DC    CL4'BLNK'                                                05530000
NOSET    DC    CL4'NSET'                                                05531000
OVERRIDE DC    CL4'OVRD'                                                05532000
ACQUIRE  DC    CL8'ACQUIRE '                                            05533000
RELINQ   DC    CL8'RELINQ  '                                            05534000
MOUNT    DC    CL8'MOUNT   '                                            05535000
DEMOUNT  DC    CL8'DEMOUNT '                                            05536000
DEFINE   DC    CL8'DEFINE  '                                            05537000
MOVE     DC    CL8'MOVE    '                                            05538000
TRACEQ   DC    CL8'TRACEQ  '                                            05539000
COPYTABL DC    CL8'COPYTABL'                                            05540000
COPYCRTG DC    CL8'COPYCRTG'                                            05541000
COPYVOL  DC    CL8'COPYVOL '                                            05542000
VVIC     DC    CL8'VVIC    '                                            05543000
TUNE     DC    CL8'TUNE    '                                            05544000
NAMES    DC    CL4'NAME'                                                05545000
UNIT     DC    CL4'UNIT'                                                05546000
SHR      DC    CL4'SHR '                                                05547000
EXCL     DC    CL4'EXCL'                                                05548000
NOWAIT   DC    CL4'NWAI'                                                05549000
WAIT     DC    CL4'WAIT'                                                05550000
SECCHECK DC    CL8'SECCHECK'                                            05551000
SCRVTOC  DC    CL8'SCRVTOC '                                            05552000
GETVTOC  DC    CL8'GETVTOC '                                            05553000
PUTVTOC  DC    CL8'PUTVTOC '                                            05554000
RECATLG  DC    CL8'RECATLG '                                            05555000
INITVOL  DC    CL8'INITVOL '                                            05556000
CHECK    DC    CL8'CHECK   '                                            05557000
POSTUCB  DC    CL8'POSTUCB '                                            05558000
GET      DC    CL8'GET     '                                            05559000
PUT      DC    CL8'PUT     '                                            05560000
CLOSE    DC    CL8'CLOSE   '                                            05561000
OPEN     DC    CL8'OPEN    '                                            05562000
RVOPENR  DC    CL8'OPENR   '                                            05563000
RVRDCNT  DC    CL8'READCNT '                                            05564000
RVREADKD DC    CL8'READKD  '                                            05565000
RVSPACCR DC    CL8'SPACCR  '                                            05566000
RVFWRITE DC    CL8'FWRITE  '                                            05567000
RVWRITER DC    CL8'WRITEREC'                                            05568000
PUTLABEL DC    CL8'PUTLABEL'                                            05569000
GETLABEL DC    CL8'GETLABEL'                                            05570000
CANCEL   DC    CL8'CANCEL  '                                            05571000
SET      DC    CL8'SET     '                                            05572000
SELECTX  DC    CL8'SELECTX '                                            05573000
CHANGEX  DC    CL8'CHANGEX '                                            05574000
SELECTDD DC    CL8'SELECTDD'                                            05575000
SELECTDS DC    CL8'SELECTDS'                                            05576000
TBLREST  DC    CL8'TBLREST '                                            05577000
NULLIFYC DC    CL8'NULLIFYC'                                            05578000
RDMSC    DC    CL8'RDMSC   '                                            05579000
RDMSCTBL DC    CL8'RDMSCTBL'                                            05580000
RDCARTLB DC    CL8'RDCARTLB'                                            05581000
AUDITCEL DC    CL8'AUDITCEL'                                            05582000
RDSTGAD  DC    CL8'RDSTGAD '                                            05583000
MODIFYC  DC    CL8'MODIFYC '                                            05584000
MODID    DC    CL4'VS01'                                                05585000
CLASSDS  DC    CL7'DATASET'                                             05586000
ZEROVOL  DC    X'000000000000'                                          05587000
ZEROVTOC DC    X'00000000'                                              05588000
HEXZERO  DC    X'00'                                                    05589000
ZEROFLD4 DC    X'00000000'                                              05590000
ZEROFLD2 DC    X'0000'                                                  05591000
ORGTALL  DC    CL4'ALL '                                                05592000
ORGTNONV DC    CL4'NONV'                                                05593000
PROTTALL DC    CL8'ALL     '                                            05594000
PROTREAD DC    CL8'READ    '                                            05595000
PROTRITE DC    CL8'WRITE   '                                            05596000
CATGOOD  DC    CL4'GOOD'                                                05597000
CATBAD   DC    CL4'BAD '                                                05598000
FIXAREA  DS    CL400                                                    05599000
         ORG   FIXAREA                                                  05600000
ZAPAREA  DC    400X'00'                                                 05601000
         ORG   FIXAREA+400                                              05602000
         DS    CL3                                                      05603000
DSNAME   DS    CL44                                                     05604000
         ORG   DSNAME                                                   05605000
@NM00121 DC    44X'04'                                                  05606000
         ORG   DSNAME+44                                                05607000
MAJNAME  DC    CL8'SYSZAMS '                                            05608000
MINRNAME DC    CL13'.REAL.RESERVE'                                      05609000
         DS    CL3                                                      05610000
MINVNAME DC    CL16'.VIRTUAL.RESERVE'                                   05611000
FORMAT4R DC    X'F4'                                                    05612000
RELATTRZ DC    X'00000100'                                              05613000
FORMAT1R DC    X'F1'                                                    05614000
ZEROEXP  DC    X'000000'                                                05615000
V1ENTID  DC    CL8'ENTIDNO '                                            05616000
USERCAT9 DC    X'000009'                                                05617000
BLANKDDN DC    CL8'        '                                            05618000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05619000
@01      EQU   01                                                       05620000
@02      EQU   02                                                       05621000
@03      EQU   03                                                       05622000
@04      EQU   04                                                       05623000
@05      EQU   05                                                       05624000
@06      EQU   06                                                       05625000
@07      EQU   07                                                       05626000
@08      EQU   08                                                       05627000
@09      EQU   09                                                       05628000
@10      EQU   10                                                       05629000
@11      EQU   11                                                       05630000
@12      EQU   12                                                       05631000
@13      EQU   13                                                       05632000
@14      EQU   14                                                       05633000
@15      EQU   15                                                       05634000
CATOPRC  EQU   @05                                                      05635000
CATCKRC  EQU   @02                                                      05636000
EXPIRRC  EQU   @02                                                      05637000
NVCOUNT  EQU   @03                                                      05638000
NVSAMRC  EQU   @02                                                      05639000
VSAMCRC  EQU   @02                                                      05640000
FMT1CRC  EQU   @02                                                      05641000
FMT4CRC  EQU   @02                                                      05642000
SECHKRC  EQU   @02                                                      05643000
FMT1SRC  EQU   @02                                                      05644000
FMT4SRC  EQU   @02                                                      05645000
SCRATRC  EQU   @02                                                      05646000
RECATRC  EQU   @02                                                      05647000
FMT1RRC  EQU   @02                                                      05648000
FMT4RRC  EQU   @02                                                      05649000
VTOCORC  EQU   @05                                                      05650000
VTOCPRC  EQU   @02                                                      05651000
VTOCGRC  EQU   @02                                                      05652000
ARGLPTR  EQU   @04                                                      05653000
CTGFLPTR EQU   @05                                                      05654000
F1PTR    EQU   @05                                                      05655000
OPNPTR   EQU   @02                                                      05656000
RTNREG   EQU   @15                                                      05657000
REG13    EQU   @13                                                      05658000
REG14    EQU   @14                                                      05659000
REG15    EQU   @15                                                      05660000
REG0     EQU   @00                                                      05661000
REG1     EQU   @01                                                      05662000
REG10    EQU   @10                                                      05663000
REG11    EQU   @11                                                      05664000
REG12    EQU   @12                                                      05665000
REG2     EQU   @02                                                      05666000
REG3     EQU   @03                                                      05667000
REG4     EQU   @04                                                      05668000
REG5     EQU   @05                                                      05669000
REG6     EQU   @06                                                      05670000
REG7     EQU   @07                                                      05671000
REG8     EQU   @08                                                      05672000
REG9     EQU   @09                                                      05673000
IDCSAEP0 EQU   0                                                        05674000
IDCSATI0 EQU   0                                                        05675000
IDCSACA0 EQU   0                                                        05676000
IDCSAAL0 EQU   0                                                        05677000
IDCSADL0 EQU   0                                                        05678000
IDCSARV0 EQU   0                                                        05679000
IDCSASI0 EQU   0                                                        05680000
IDCSASC0 EQU   0                                                        05681000
IDCSARC0 EQU   0                                                        05682000
IDCSARK0 EQU   0                                                        05683000
TRACE1   EQU   0                                                        05684000
OLDERID1 EQU   TRACE1                                                   05685000
TRACE2   EQU   0                                                        05686000
OLDERID2 EQU   TRACE2                                                   05687000
NEWID2   EQU   TRACE2+95                                                05688000
NEWERID2 EQU   5                                                        05689000
CIRAGL   EQU   0                                                        05690000
CIRTYPE  EQU   CIRAGL                                                   05691000
ALLAGL   EQU   0                                                        05692000
ALLDSN   EQU   ALLAGL                                                   05693000
ALLDDN   EQU   ALLAGL+4                                                 05694000
ALLSTS   EQU   ALLAGL+24                                                05695000
ALLSTSSR EQU   ALLSTS                                                   05696000
ALLDSP   EQU   ALLAGL+25                                                05697000
ALLDSPKP EQU   ALLDSP                                                   05698000
ALLORG   EQU   ALLAGL+26                                                05699000
ALLOPT   EQU   ALLAGL+28                                                05700000
ALLOPTDS EQU   ALLOPT                                                   05701000
RACFAGL  EQU   0                                                        05702000
RACFFLG1 EQU   RACFAGL                                                  05703000
RACFDSTV EQU   RACFFLG1                                                 05704000
RACFFLG2 EQU   RACFAGL+1                                                05705000
RACFTUPD EQU   RACFFLG2                                                 05706000
RACFTRD  EQU   RACFFLG2                                                 05707000
RACFFLG3 EQU   RACFAGL+2                                                05708000
RACFFLG4 EQU   RACFAGL+3                                                05709000
RACFENT  EQU   RACFAGL+4                                                05710000
RACFCLN  EQU   RACFAGL+12                                               05711000
RACFVOLS EQU   RACFAGL+16                                               05712000
UNITABL  EQU   0                                                        05713000
UNITUCB  EQU   UNITABL                                                  05714000
UNITADR  EQU   UNITABL+4                                                05715000
@NM00017 EQU   UNITADR                                                  05716000
UNITSTAT EQU   UNITABL+6                                                05717000
IDCIOOP0 EQU   0                                                        05718000
IDCIOCL0 EQU   0                                                        05719000
IDCIOPO0 EQU   0                                                        05720000
IDCIOGT0 EQU   0                                                        05721000
IDCIOPT0 EQU   0                                                        05722000
IDCIOSI0 EQU   0                                                        05723000
IDCIO050 EQU   0                                                        05724000
IOCSTR   EQU   0                                                        05725000
IOCDAD   EQU   IOCSTR                                                   05726000
IOCDSO   EQU   IOCSTR+16                                                05727000
IOCRFM   EQU   IOCSTR+17                                                05728000
IOCMAC   EQU   IOCSTR+18                                                05729000
IOCMAC2  EQU   IOCSTR+19                                                05730000
IOCCHP   EQU   IOCSTR+20                                                05731000
IOCMSG   EQU   IOCSTR+21                                                05732000
IOCDSN   EQU   IOCSTR+32                                                05733000
IOCCBP   EQU   IOCSTR+36                                                05734000
IOCRBA   EQU   IOCSTR+40                                                05735000
IOCTTR   EQU   IOCRBA                                                   05736000
IOCMEM   EQU   IOCSTR+44                                                05737000
IOCNWM   EQU   IOCSTR+48                                                05738000
IOCREL   EQU   IOCSTR+60                                                05739000
OPNAGL   EQU   0                                                        05740000
OPNOPT   EQU   OPNAGL                                                   05741000
OPNOPTUP EQU   OPNOPT                                                   05742000
OPNOPTBK EQU   OPNOPT                                                   05743000
OPNRFM   EQU   OPNAGL+1                                                 05744000
OPNRFMFX EQU   OPNRFM                                                   05745000
OPNTYP   EQU   OPNAGL+2                                                 05746000
OPNTYPCI EQU   OPNTYP                                                   05747000
OPNMOD   EQU   OPNAGL+3                                                 05748000
OPNMODRC EQU   OPNMOD                                                   05749000
OPNIOC   EQU   OPNAGL+4                                                 05750000
OPNDDN   EQU   OPNAGL+8                                                 05751000
OPNPWA   EQU   OPNAGL+12                                                05752000
OPNDSN   EQU   OPNAGL+16                                                05753000
OPNDEV   EQU   OPNAGL+24                                                05754000
OPNBLK   EQU   OPNAGL+36                                                05755000
OPNKYL   EQU   OPNAGL+40                                                05756000
OPNDSO   EQU   OPNAGL+41                                                05757000
OPNDSOPS EQU   OPNDSO                                                   05758000
OPNOPT2  EQU   OPNAGL+42                                                05759000
OPNOPTJM EQU   OPNOPT2                                                  05760000
OPNVOL   EQU   OPNAGL+44                                                05761000
IOINFOPT EQU   0                                                        05762000
IOINFDSN EQU   IOINFOPT                                                 05763000
UVOLLIST EQU   0                                                        05764000
UVOLCNT  EQU   UVOLLIST                                                 05765000
UVOLENT  EQU   UVOLLIST+2                                               05766000
UVOLDEV  EQU   UVOLENT                                                  05767000
UVOLVOL  EQU   UVOLENT+4                                                05768000
AMSTP011 EQU   0                                                        05769000
DARGLIST EQU   0                                                        05770000
DARGDBP  EQU   DARGLIST                                                 05771000
DARGRETP EQU   DARGLIST+4                                               05772000
DARGSTID EQU   DARGLIST+8                                               05773000
DARGSMOD EQU   DARGSTID                                                 05774000
DARGSENT EQU   DARGSTID+3                                               05775000
DARGILP  EQU   DARGLIST+12                                              05776000
DARGCNT  EQU   DARGLIST+14                                              05777000
DARGARY  EQU   DARGLIST+20                                              05778000
DARGINS  EQU   DARGARY                                                  05779000
DARGINL  EQU   DARGARY+2                                                05780000
DARGDTM  EQU   DARGARY+4                                                05781000
FMTLIST  EQU   0                                                        05782000
FMTFLGS  EQU   FMTLIST                                                  05783000
FMTSPF   EQU   FMTLIST+2                                                05784000
FMTRFNO  EQU   FMTSPF                                                   05785000
FMTILEN  EQU   FMTRFNO                                                  05786000
FMTIOFF  EQU   FMTLIST+4                                                05787000
FMTTRBC  EQU   FMTIOFF                                                  05788000
FMTSTO   EQU   FMTTRBC                                                  05789000
FMTOCOL  EQU   FMTLIST+6                                                05790000
FMTCNVF  EQU   FMTLIST+10                                               05791000
ERCNVTAB EQU   0                                                        05792000
ERTYPE   EQU   ERCNVTAB                                                 05793000
EROPER   EQU   ERCNVTAB+1                                               05794000
EROSOPER EQU   ERCNVTAB+2                                               05795000
ERCATRC  EQU   ERCNVTAB+16                                              05796000
ERCPLPT  EQU   ERCNVTAB+20                                              05797000
IDCDB010 EQU   0                                                        05798000
DMPITM   EQU   0                                                        05799000
DMPARY   EQU   0                                                        05800000
CCMSG    EQU   0                                                        05801000
CMMSG    EQU   0                                                        05802000
CMVOLFLG EQU   CMMSG+6                                                  05803000
CTMSG    EQU   0                                                        05804000
CTARRAY  EQU   CTMSG+4                                                  05805000
MDAGL    EQU   0                                                        05806000
MDFLAGS  EQU   MDAGL+30                                                 05807000
MDVTOC   EQU   MDAGL+32                                                 05808000
PUAGL    EQU   0                                                        05809000
CKAGL    EQU   0                                                        05810000
CKFLAGS  EQU   CKAGL+28                                                 05811000
EXCLAGL  EQU   0                                                        05812000
EXCLFLAG EQU   EXCLAGL+22                                               05813000
EXOARG   EQU   0                                                        05814000
EXODDN   EQU   EXOARG+8                                                 05815000
EXODSN   EQU   EXOARG+12                                                05816000
EXOVSN   EQU   EXOARG+16                                                05817000
EXOCTLBK EQU   EXOARG+28                                                05818000
EXOPT    EQU   EXOARG+32                                                05819000
EXOPASS  EQU   EXOPT                                                    05820000
EXFLG    EQU   EXOARG+33                                                05821000
EXOREAD  EQU   EXFLG                                                    05822000
EXGARG   EQU   0                                                        05823000
EXWRARG  EQU   0                                                        05824000
EXRWCHR  EQU   EXWRARG+26                                               05825000
EXSPACE  EQU   EXWRARG+36                                               05826000
EXPARG   EQU   0                                                        05827000
EXPDATA  EQU   EXPARG+12                                                05828000
EXPDATAB EQU   0                                                        05829000
EXPARRAY EQU   EXPDATAB+4                                               05830000
VS2AGL   EQU   0                                                        05831000
VSLABOPT EQU   VS2AGL+28                                                05832000
VS2MSG   EQU   VS2AGL+35                                                05833000
VS2RESOP EQU   VS2AGL+36                                                05834000
VS1AGL   EQU   0                                                        05835000
VSHEAD   EQU   VS1AGL                                                   05836000
VSUCBP   EQU   VS1AGL+8                                                 05837000
VSVOLP   EQU   VS1AGL+12                                                05838000
VSFILEP  EQU   VS1AGL+16                                                05839000
VSIOP    EQU   VS1AGL+20                                                05840000
VSNUMATP EQU   VS1AGL+24                                                05841000
VSNXTATP EQU   VS1AGL+28                                                05842000
VSCATP   EQU   VS1AGL+32                                                05843000
VSACBP   EQU   VS1AGL+36                                                05844000
VSCATDDP EQU   VS1AGL+40                                                05845000
VSPSWDP  EQU   VS1AGL+44                                                05846000
VSPFILEP EQU   VS1AGL+48                                                05847000
VSSERP   EQU   VS1AGL+52                                                05848000
VSDEVP   EQU   VS1AGL+56                                                05849000
VSOSERP  EQU   VS1AGL+60                                                05850000
VSODEVP  EQU   VS1AGL+64                                                05851000
VSSECOPT EQU   VS1AGL+68                                                05852000
VSNOVSAM EQU   VSSECOPT                                                 05853000
VSNONONV EQU   VSSECOPT                                                 05854000
VSREAD   EQU   VSSECOPT                                                 05855000
VSUCTEST EQU   VSSECOPT                                                 05856000
VSOPCAT  EQU   VSSECOPT                                                 05857000
VSUCMAST EQU   VSSECOPT                                                 05858000
VSVTOPT  EQU   VS1AGL+69                                                05859000
VSTIME   EQU   VSVTOPT                                                  05860000
VSALTTRK EQU   VSVTOPT                                                  05861000
VSVSFLAG EQU   VSVTOPT                                                  05862000
VSCATOPT EQU   VS1AGL+70                                                05863000
VSDEVICE EQU   VSCATOPT                                                 05864000
VSSERIAL EQU   VSCATOPT                                                 05865000
VSLIST   EQU   VSCATOPT                                                 05866000
VSRETURN EQU   VS1AGL+71                                                05867000
VSVSAM   EQU   VSRETURN                                                 05868000
VSUCAT   EQU   VSRETURN                                                 05869000
VSMSG    EQU   VS1AGL+72                                                05870000
VSFROMV  EQU   VSMSG                                                    05871000
VSTOV    EQU   VSMSG                                                    05872000
VSRESOPT EQU   VS1AGL+73                                                05873000
VSRES    EQU   VSRESOPT                                                 05874000
VSREAL   EQU   VSRESOPT                                                 05875000
RCTAGL   EQU   0                                                        05876000
RCTOPT   EQU   RCTAGL+8                                                 05877000
RCTDEV   EQU   RCTOPT                                                   05878000
RCTVOL   EQU   RCTOPT                                                   05879000
RCTODEV  EQU   RCTAGL+12                                                05880000
RCTNDEV  EQU   RCTAGL+16                                                05881000
RCTOVOL  EQU   RCTAGL+20                                                05882000
RCTNVOL  EQU   RCTAGL+26                                                05883000
RCTDSET  EQU   RCTAGL+32                                                05884000
STAEPARM EQU   0                                                        05885000
STARCVY  EQU   STAEPARM+52                                              05886000
STARETRY EQU   STAEPARM+53                                              05887000
VOLLABEL EQU   0                                                        05888000
SV82LIST EQU   0                                                        05889000
@NM00074 EQU   SV82LIST+4                                               05890000
SV82DCBP EQU   @NM00074                                                 05891000
@NM00075 EQU   SV82LIST+12                                              05892000
SV82WRKP EQU   @NM00075                                                 05893000
SRTAGL   EQU   0                                                        05894000
LCTINFO  EQU   0                                                        05895000
LCTFLAGS EQU   LCTINFO+32                                               05896000
UCTAGL   EQU   0                                                        05897000
UCTFLAGS EQU   UCTAGL+68                                                05898000
SELAGL   EQU   0                                                        05899000
SELFLAGS EQU   SELAGL+22                                                05900000
DATESAGL EQU   0                                                        05901000
DATESOPT EQU   DATESAGL+20                                              05902000
VS3AGL   EQU   0                                                        05903000
VS3FLAGS EQU   VS3AGL+58                                                05904000
VSDVTOC  EQU   0                                                        05905000
VSDSTAT  EQU   0                                                        05906000
VSDSFLG1 EQU   VSDSTAT+16                                               05907000
VSDFLG2  EQU   VSDSTAT+17                                               05908000
VSDSCR   EQU   0                                                        05909000
VSDSCRFL EQU   VSDSCR+4                                                 05910000
VSDUSAGE EQU   0                                                        05911000
VSDDORG  EQU   VSDUSAGE+9                                               05912000
VSDALLOC EQU   VSDUSAGE+10                                              05913000
VSDUSEF  EQU   VSDUSAGE+11                                              05914000
VSDDSORG EQU   VSDUSAGE+16                                              05915000
VSDBLOCK EQU   0                                                        05916000
VSDSPACE EQU   VSDBLOCK+12                                              05917000
VSDARRAY EQU   VSDBLOCK+16                                              05918000
VSDVARY  EQU   VSDARRAY+48                                              05919000
IECSDSF1 EQU   0                                                        05920000
IECSDSL1 EQU   0                                                        05921000
DS1DSNAM EQU   IECSDSL1                                                 05922000
DS1FMTID EQU   IECSDSL1+44                                              05923000
DS1EXPDT EQU   IECSDSL1+56                                              05924000
DS1DSORG EQU   IECSDSL1+82                                              05925000
DS1DSIND EQU   IECSDSL1+93                                              05926000
IECSDSF4 EQU   0                                                        05927000
IECSDSL4 EQU   0                                                        05928000
DS4IDFMT EQU   IECSDSL4                                                 05929000
DS4HCCHH EQU   IECSDSL4+8                                               05930000
DS4NOATK EQU   IECSDSL4+12                                              05931000
DS4DEVCT EQU   IECSDSL4+18                                              05932000
DS4DEVOV EQU   DS4DEVCT+6                                               05933000
DS4AMTIM EQU   IECSDSL4+32                                              05934000
DS4AMCAT EQU   IECSDSL4+40                                              05935000
DS4VSIND EQU   DS4AMCAT                                                 05936000
DS4VSREF EQU   DS4VSIND                                                 05937000
CTGPL    EQU   0                                                        05938000
CTGOPTN1 EQU   CTGPL                                                    05939000
CTGMAST  EQU   CTGOPTN1                                                 05940000
CTGNAME  EQU   CTGOPTN1                                                 05941000
CTGCNAME EQU   CTGOPTN1                                                 05942000
CTGOPTN2 EQU   CTGPL+1                                                  05943000
CTGEXT   EQU   CTGOPTN2                                                 05944000
CTGERASE EQU   CTGOPTN2                                                 05945000
CTGSMF   EQU   CTGERASE                                                 05946000
CTGREL   EQU   CTGSMF                                                   05947000
CTGPURG  EQU   CTGOPTN2                                                 05948000
CTGVMNT  EQU   CTGPURG                                                  05949000
CTGOPTN3 EQU   CTGPL+2                                                  05950000
CTGFUNC  EQU   CTGOPTN3                                                 05951000
CTGNUM   EQU   CTGOPTN3                                                 05952000
CTGAM0   EQU   CTGOPTN3                                                 05953000
CTGOPTN4 EQU   CTGPL+3                                                  05954000
CTGENT   EQU   CTGPL+4                                                  05955000
CTGCAT   EQU   CTGPL+8                                                  05956000
CTGWKA   EQU   CTGPL+12                                                 05957000
CTGDSORG EQU   CTGPL+16                                                 05958000
CTGNOFLD EQU   CTGPL+19                                                 05959000
CTGDDNM  EQU   CTGPL+20                                                 05960000
CTGNEWNM EQU   CTGDDNM                                                  05961000
CTGFDBK  EQU   CTGNEWNM                                                 05962000
CTGFBFLG EQU   CTGNEWNM+2                                               05963000
CTGJSCB  EQU   CTGPL+24                                                 05964000
CTGPSWD  EQU   CTGJSCB                                                  05965000
CTGFIELD EQU   CTGPL+28                                                 05966000
CTGFL    EQU   0                                                        05967000
CTGFLDNO EQU   CTGFL                                                    05968000
CTGFLDRE EQU   CTGFL+3                                                  05969000
CTGFLDNM EQU   CTGFL+8                                                  05970000
CTGFLDAT EQU   CTGFL+16                                                 05971000
DSCBFMT4 EQU   0                                                        05972000
DS4DATA  EQU   DSCBFMT4+44                                              05973000
V1VOLA   EQU   0                                                        05974000
V1DEVA   EQU   0                                                        05975000
V1UCBADR EQU   0                                                        05976000
V1DDNAM  EQU   0                                                        05977000
V1NXAREA EQU   0                                                        05978000
V1NUAREA EQU   0                                                        05979000
PFILE    EQU   0                                                        05980000
PFILECNT EQU   PFILE                                                    05981000
@NM00123 EQU   PFILE+2                                                  05982000
PFILEVAL EQU   @NM00123+1                                               05983000
CATDSN   EQU   0                                                        05984000
AMSTP041 EQU   0                                                        05985000
AMSTP042 EQU   0                                                        05986000
AMSTP043 EQU   0                                                        05987000
AMSTP044 EQU   0                                                        05988000
DMPTRM   EQU   0                                                        05989000
IDCIOCO0 EQU   0                                                        05990000
IDCIOIT0 EQU   0                                                        05991000
IDCIOST0 EQU   0                                                        05992000
IDCIOTM0 EQU   0                                                        05993000
IDCIOVY0 EQU   0                                                        05994000
IDCSACL0 EQU   0                                                        05995000
IDCSACR0 EQU   0                                                        05996000
IDCSADE0 EQU   0                                                        05997000
IDCSADQ0 EQU   0                                                        05998000
IDCSAFP0 EQU   0                                                        05999000
IDCSAFS0 EQU   0                                                        06000000
IDCSAGP0 EQU   0                                                        06001000
IDCSAGS0 EQU   0                                                        06002000
IDCSAID0 EQU   0                                                        06003000
IDCSALC0 EQU   0                                                        06004000
IDCSALD0 EQU   0                                                        06005000
IDCSALK0 EQU   0                                                        06006000
IDCSANQ0 EQU   0                                                        06007000
IDCSAPR0 EQU   0                                                        06008000
IDCSAPT0 EQU   0                                                        06009000
IDCSAQL0 EQU   0                                                        06010000
IDCSASN0 EQU   0                                                        06011000
IDCSASS0 EQU   0                                                        06012000
IDCSAST0 EQU   0                                                        06013000
IDCSAUC0 EQU   0                                                        06014000
IDCSAWO0 EQU   0                                                        06015000
IDCSA060 EQU   0                                                        06016000
IDCST010 EQU   0                                                        06017000
IDCTPER0 EQU   0                                                        06018000
LISTTEST EQU   0                                                        06019000
NEWERID1 EQU   5                                                        06020000
GDTTBL   EQU   0                                                        06021000
GDTTR1   EQU   GDTTBL+8                                                 06022000
GDTTR2   EQU   GDTTBL+12                                                06023000
GDTDBG   EQU   GDTTBL+40                                                06024000
GDTSTC   EQU   GDTTBL+44                                                06025000
GDTPRT   EQU   GDTTBL+48                                                06026000
GDTESS   EQU   GDTTBL+52                                                06027000
GDTESA   EQU   GDTTBL+56                                                06028000
GDTRST   EQU   GDTTBL+60                                                06029000
GDTRES   EQU   GDTTBL+64                                                06030000
GDTCAL   EQU   GDTTBL+68                                                06031000
GDTGSP   EQU   GDTTBL+72                                                06032000
GDTFSP   EQU   GDTTBL+76                                                06033000
GDTGPL   EQU   GDTTBL+80                                                06034000
GDTFPL   EQU   GDTTBL+84                                                06035000
GDTLOD   EQU   GDTTBL+88                                                06036000
GDTDEL   EQU   GDTTBL+92                                                06037000
GDTPRL   EQU   GDTTBL+96                                                06038000
GDTEPL   EQU   GDTTBL+100                                               06039000
GDTTIM   EQU   GDTTBL+104                                               06040000
GDTIIO   EQU   GDTTBL+108                                               06041000
GDTTIO   EQU   GDTTBL+112                                               06042000
GDTOPN   EQU   GDTTBL+124                                               06043000
GDTCLS   EQU   GDTTBL+128                                               06044000
GDTGET   EQU   GDTTBL+132                                               06045000
GDTPUT   EQU   GDTTBL+136                                               06046000
GDTPOS   EQU   GDTTBL+140                                               06047000
GDTCPY   EQU   GDTTBL+144                                               06048000
GDTCAT   EQU   GDTTBL+148                                               06049000
GDTABT   EQU   GDTTBL+152                                               06050000
GDTABH   EQU   GDTTBL+156                                               06051000
GDTSNP   EQU   GDTTBL+164                                               06052000
GDTVFY   EQU   GDTTBL+172                                               06053000
GDTUID   EQU   GDTTBL+192                                               06054000
GDTPMT   EQU   GDTTBL+196                                               06055000
GDTCIR   EQU   GDTTBL+200                                               06056000
GDTLNK   EQU   GDTTBL+204                                               06057000
GDTALC   EQU   GDTTBL+208                                               06058000
GDTDLC   EQU   GDTTBL+212                                               06059000
GDTQAL   EQU   GDTTBL+216                                               06060000
GDTSTW   EQU   GDTTBL+220                                               06061000
GDTSSC   EQU   GDTTBL+224                                               06062000
GDTENQ   EQU   GDTTBL+228                                               06063000
GDTRSV   EQU   GDTTBL+232                                               06064000
GDTDEQ   EQU   GDTTBL+236                                               06065000
GDTSFO   EQU   GDTTBL+240                                               06066000
GDTWTO   EQU   GDTTBL+244                                               06067000
GDTSCR   EQU   GDTTBL+248                                               06068000
GDTUNT   EQU   GDTTBL+252                                               06069000
GDTRCT   EQU   GDTTBL+256                                               06070000
GDTIFO   EQU   GDTTBL+260                                               06071000
GDTEXP   EQU   GDTTBL+264                                               06072000
GDTSTA   EQU   GDTTBL+268                                               06073000
GDTERR   EQU   GDTTBL+272                                               06074000
GDTUNC   EQU   GDTTBL+276                                               06075000
GDTLOC   EQU   GDTTBL+280                                               06076000
GDTRCK   EQU   GDTTBL+284                                               06077000
REQUEST  EQU   0                                                        06078000
VS1ARGL  EQU   0                                                        06079000
ORGTYPE  EQU   0                                                        06080000
PROTTYPE EQU   0                                                        06081000
FM4PASS  EQU   0                                                        06082000
FM1PASS  EQU   0                                                        06083000
CHKPASS  EQU   0                                                        06084000
OPENACB  EQU   0                                                        06085000
OPENIOCS EQU   0                                                        06086000
@NM00108 EQU   CTGDDNM                                                  06087000
CTGPROB  EQU   @NM00108                                                 06088000
CTGREASN EQU   CTGPROB+2                                                06089000
DSDSORG  EQU   DS1DSORG                                                 06090000
DSBYTE1  EQU   DSDSORG                                                  06091000
DSORGPS  EQU   DSBYTE1                                                  06092000
DSBYTE2  EQU   DSDSORG+1                                                06093000
DSORGAM  EQU   DSBYTE2                                                  06094000
DSINDDS  EQU   DS1DSIND                                                 06095000
PROTRACF EQU   DSINDDS                                                  06096000
PASSPROT EQU   DSINDDS                                                  06097000
READOK   EQU   DSINDDS                                                  06098000
*                                      START UNREFERENCED COMPONENTS    06099000
@NM00119 EQU   DSINDDS                                                  06100000
@NM00118 EQU   DSINDDS                                                  06101000
@NM00117 EQU   DSINDDS                                                  06102000
@NM00116 EQU   DSINDDS                                                  06103000
@NM00115 EQU   DSBYTE2                                                  06104000
@NM00114 EQU   DSBYTE2                                                  06105000
@NM00113 EQU   DSBYTE1                                                  06106000
@NM00112 EQU   DSBYTE1                                                  06107000
CTGREAS2 EQU   CTGREASN+1                                               06108000
CTGREAS1 EQU   CTGREASN                                                 06109000
CTGMODID EQU   CTGPROB                                                  06110000
@NM00110 EQU   VS1ARGL                                                  06111000
GDTECT   EQU   GDTTBL+188                                               06112000
GDTPSB   EQU   GDTTBL+184                                               06113000
GDTUPT   EQU   GDTTBL+180                                               06114000
GDTCMB   EQU   GDTTBL+176                                               06115000
GDTSPR   EQU   GDTTBL+168                                               06116000
@NM00001 EQU   GDTTBL+160                                               06117000
GDTTOH   EQU   GDTTBL+120                                               06118000
GDTRIP   EQU   GDTTBL+116                                               06119000
GDTIOH   EQU   GDTTBL+36                                                06120000
GDTSAH   EQU   GDTTBL+32                                                06121000
GDTTPH   EQU   GDTTBL+28                                                06122000
GDTRIH   EQU   GDTTBL+24                                                06123000
GDTSTH   EQU   GDTTBL+20                                                06124000
GDTDBH   EQU   GDTTBL+16                                                06125000
GDTPRM   EQU   GDTTBL+4                                                 06126000
GDTHDR   EQU   GDTTBL                                                   06127000
PFILELEN EQU   @NM00123                                                 06128000
@NM00111 EQU   DSCBFMT4                                                 06129000
CTGFLPT  EQU   CTGFLDAT+4                                               06130000
CTGFLNG  EQU   CTGFLDAT                                                 06131000
CTGFLCHN EQU   CTGFL+12                                                 06132000
CTGFLDWA EQU   CTGFL+4                                                  06133000
CTGFLDTS EQU   CTGFLDRE                                                 06134000
@NM00109 EQU   CTGFLDRE                                                 06135000
CTGFLDGC EQU   CTGFL+2                                                  06136000
CTGFLDCD EQU   CTGFL+1                                                  06137000
@NM00107 EQU   CTGFBFLG                                                 06138000
CTGNGDSN EQU   CTGFBFLG                                                 06139000
CTGGDGB  EQU   CTGFBFLG                                                 06140000
CTGKEEP  EQU   CTGFBFLG                                                 06141000
CTGPAR   EQU   CTGFBFLG                                                 06142000
CTGTYPE  EQU   CTGPL+18                                                 06143000
@NM00106 EQU   CTGDSORG                                                 06144000
CTGOPTNS EQU   CTGDSORG                                                 06145000
CTGCVOL  EQU   CTGCAT                                                   06146000
CTGFVT   EQU   CTGENT                                                   06147000
@NM00105 EQU   CTGOPTN4                                                 06148000
CTGBYPMT EQU   CTGOPTN4                                                 06149000
@NM00104 EQU   CTGOPTN4                                                 06150000
CTGDOCAT EQU   CTGOPTN4                                                 06151000
CTGLBASE EQU   CTGOPTN4                                                 06152000
CTGSRH   EQU   CTGOPTN3                                                 06153000
CTGGDGL  EQU   CTGOPTN3                                                 06154000
CTGSUPLT EQU   CTGOPTN3                                                 06155000
@NM00103 EQU   CTGOPTN2                                                 06156000
CTGSCR   EQU   CTGOPTN2                                                 06157000
CTGOVRID EQU   CTGOPTN2                                                 06158000
CTGDISC  EQU   CTGOPTN2                                                 06159000
CTGGTNXT EQU   CTGOPTN2                                                 06160000
CTGRCATN EQU   CTGVMNT                                                  06161000
CTGGTALL EQU   CTGREL                                                   06162000
CTGNSVS  EQU   CTGEXT                                                   06163000
CTGGENLD EQU   CTGOPTN1                                                 06164000
CTGREAD  EQU   CTGOPTN1                                                 06165000
CTGUPD   EQU   CTGOPTN1                                                 06166000
CTGCI    EQU   CTGOPTN1                                                 06167000
CTGBYPSS EQU   CTGOPTN1                                                 06168000
DS4END   EQU   IECSDSL4+96                                              06169000
@NM00102 EQU   IECSDSL4+71                                              06170000
DS4VTOCE EQU   IECSDSL4+61                                              06171000
DS4F6PTR EQU   IECSDSL4+56                                              06172000
@NM00101 EQU   IECSDSL4+51                                              06173000
DS4R2TIM EQU   IECSDSL4+43                                              06174000
DS4VSCRA EQU   DS4AMCAT+1                                               06175000
@NM00100 EQU   DS4VSIND                                                 06176000
DS4VSBAD EQU   DS4VSIND                                                 06177000
DS4DEVDB EQU   DS4DEVCT+13                                              06178000
DS4DEVDT EQU   DS4DEVCT+12                                              06179000
DS4DEVTL EQU   DS4DEVCT+10                                              06180000
DS4DEVFG EQU   DS4DEVCT+9                                               06181000
DS4DEVK  EQU   DS4DEVCT+8                                               06182000
DS4DEVL  EQU   DS4DEVOV+1                                               06183000
DS4DEVI  EQU   DS4DEVOV                                                 06184000
DS4DEVTK EQU   DS4DEVCT+4                                               06185000
DS4DEVSZ EQU   DS4DEVCT                                                 06186000
@NM00099 EQU   IECSDSL4+16                                              06187000
DS4NOEXT EQU   IECSDSL4+15                                              06188000
DS4VTOCI EQU   IECSDSL4+14                                              06189000
DS4DSREC EQU   IECSDSL4+6                                               06190000
DS4HPCHR EQU   IECSDSL4+1                                               06191000
@NM00098 EQU   IECSDSF4                                                 06192000
DS1END   EQU   IECSDSL1+140                                             06193000
DS1PTRDS EQU   IECSDSL1+135                                             06194000
DS1EXT3  EQU   IECSDSL1+125                                             06195000
DS1EXT2  EQU   IECSDSL1+115                                             06196000
DS1EXT1  EQU   IECSDSL1+105                                             06197000
@NM00097 EQU   IECSDSL1+103                                             06198000
DS1TRBAL EQU   IECSDSL1+101                                             06199000
DS1LSTAR EQU   IECSDSL1+98                                              06200000
DS1SCALO EQU   IECSDSL1+94                                              06201000
DS1RKP   EQU   IECSDSL1+91                                              06202000
DS1KEYL  EQU   IECSDSL1+90                                              06203000
DS1LRECL EQU   IECSDSL1+88                                              06204000
DS1BLKL  EQU   IECSDSL1+86                                              06205000
DS1OPTCD EQU   IECSDSL1+85                                              06206000
DS1RECFM EQU   IECSDSL1+84                                              06207000
@NM00096 EQU   IECSDSL1+75                                              06208000
DS1SYSCD EQU   IECSDSL1+62                                              06209000
@NM00095 EQU   IECSDSL1+61                                              06210000
DS1NOBDB EQU   IECSDSL1+60                                              06211000
DS1NOEPV EQU   IECSDSL1+59                                              06212000
DS1CREDT EQU   IECSDSL1+53                                              06213000
DS1VOLSQ EQU   IECSDSL1+51                                              06214000
DS1DSSN  EQU   IECSDSL1+45                                              06215000
@NM00094 EQU   IECSDSF1                                                 06216000
VSDDSN   EQU   VSDARRAY+4                                               06217000
VSDVOLCT EQU   VSDARRAY                                                 06218000
VSDFMT0  EQU   VSDBLOCK+8                                               06219000
VSDVTOCS EQU   VSDBLOCK+4                                               06220000
VSDELEM  EQU   VSDBLOCK                                                 06221000
VSDFREE  EQU   VSDUSAGE+24                                              06222000
VSDALLC  EQU   VSDUSAGE+19                                              06223000
VSDDSOR3 EQU   VSDDSORG+2                                               06224000
@NM00093 EQU   VSDDSORG                                                 06225000
VSDSCAL  EQU   VSDUSAGE+12                                              06226000
@NM00092 EQU   VSDUSEF                                                  06227000
VSDCALFR EQU   VSDUSEF                                                  06228000
@NM00091 EQU   VSDALLOC                                                 06229000
VSDABSTR EQU   VSDALLOC                                                 06230000
VSDABLK  EQU   VSDALLOC                                                 06231000
VSDATRK  EQU   VSDALLOC                                                 06232000
VSDACYL  EQU   VSDALLOC                                                 06233000
@NM00090 EQU   VSDDORG                                                  06234000
VSDOU    EQU   VSDDORG                                                  06235000
VSDOIS   EQU   VSDDORG                                                  06236000
VSDODA   EQU   VSDDORG                                                  06237000
VSDOUN   EQU   VSDDORG                                                  06238000
VSDOPS   EQU   VSDDORG                                                  06239000
VSDOPO   EQU   VSDDORG                                                  06240000
VSDEXTS  EQU   VSDUSAGE+8                                               06241000
VSDSECAL EQU   VSDUSAGE+4                                               06242000
VSDFTRK  EQU   VSDUSAGE+2                                               06243000
VSDTRKS  EQU   VSDUSAGE                                                 06244000
@NM00089 EQU   VSDSCR+5                                                 06245000
@NM00088 EQU   VSDSCRFL                                                 06246000
VSDVSAM  EQU   VSDSCRFL                                                 06247000
VSDCATLC EQU   VSDSCRFL                                                 06248000
VSDACBPT EQU   VSDSCR                                                   06249000
@NM00087 EQU   VSDSTAT+29                                               06250000
VSDPRTC  EQU   VSDSTAT+25                                               06251000
VSDCAT   EQU   VSDSTAT+22                                               06252000
VSDEXP   EQU   VSDSTAT+20                                               06253000
VSDCRE   EQU   VSDSTAT+18                                               06254000
@NM00086 EQU   VSDFLG2                                                  06255000
VSDRACF  EQU   VSDFLG2                                                  06256000
VSDERROR EQU   VSDFLG2                                                  06257000
VSDPROT  EQU   VSDFLG2                                                  06258000
VSDPWW   EQU   VSDFLG2                                                  06259000
VSDPWR   EQU   VSDFLG2                                                  06260000
@NM00085 EQU   VSDSFLG1                                                 06261000
VSDCVSAM EQU   VSDSFLG1                                                 06262000
VSDCATLG EQU   VSDSFLG1                                                 06263000
VSDVSAME EQU   VSDSFLG1                                                 06264000
VSDVSAMC EQU   VSDSFLG1                                                 06265000
VSDVTOCE EQU   VSDSFLG1                                                 06266000
VSDVTOCC EQU   VSDSFLG1                                                 06267000
VSDOWNER EQU   VSDSTAT+8                                                06268000
VSDEXPIR EQU   VSDSTAT+4                                                06269000
VSDCREAT EQU   VSDSTAT                                                  06270000
VSDFRCCL EQU   VSDVTOC+21                                               06271000
@NM00084 EQU   VSDVTOC+20                                               06272000
VSDFREXT EQU   VSDVTOC+16                                               06273000
@NM00083 EQU   VSDVTOC+15                                               06274000
VSDFRTRK EQU   VSDVTOC+11                                               06275000
@NM00082 EQU   VSDVTOC+10                                               06276000
VSDFRCYL EQU   VSDVTOC+6                                                06277000
@NM00081 EQU   VSDVTOC                                                  06278000
@NM00080 EQU   VS3FLAGS                                                 06279000
VS3SYSNM EQU   VS3FLAGS                                                 06280000
VS3UNCAT EQU   VS3FLAGS                                                 06281000
VS3SCR   EQU   VS3FLAGS                                                 06282000
VS3USAGE EQU   VS3FLAGS                                                 06283000
VS3STAT  EQU   VS3FLAGS                                                 06284000
VS3DD    EQU   VS3AGL+50                                                06285000
VS3VOL   EQU   VS3AGL+44                                                06286000
VS3POOL  EQU   VS3AGL+40                                                06287000
VS3DEV   EQU   VS3AGL+36                                                06288000
VS3UCBP  EQU   VS3AGL+32                                                06289000
VS3CREAT EQU   VS3AGL+28                                                06290000
VS3EXPIR EQU   VS3AGL+24                                                06291000
VS3AST   EQU   VS3AGL+22                                                06292000
VS3LEVLN EQU   VS3AGL+20                                                06293000
VS3LEVP  EQU   VS3AGL+16                                                06294000
VS3EXDSP EQU   VS3AGL+12                                                06295000
VS3LISTP EQU   VS3AGL+8                                                 06296000
VS3HEAD  EQU   VS3AGL                                                   06297000
@NM00079 EQU   DATESOPT                                                 06298000
DATDAYOP EQU   DATESOPT                                                 06299000
DATDTEOP EQU   DATESOPT                                                 06300000
DATSUB   EQU   DATESOPT                                                 06301000
DATADD   EQU   DATESOPT                                                 06302000
DATRETRN EQU   DATESAGL+16                                              06303000
DATDAYS  EQU   DATESAGL+12                                              06304000
DATDATE  EQU   DATESAGL+8                                               06305000
DATHEAD  EQU   DATESAGL                                                 06306000
@NM00078 EQU   SELFLAGS                                                 06307000
SELVOL   EQU   SELAGL+16                                                06308000
SELDDNP  EQU   SELAGL+12                                                06309000
SELUCBP  EQU   SELAGL+8                                                 06310000
SELHEAD  EQU   SELAGL                                                   06311000
@NM00077 EQU   UCTFLAGS                                                 06312000
UCTVSCAT EQU   UCTFLAGS                                                 06313000
UCTDD    EQU   UCTAGL+60                                                06314000
UCTVOLP  EQU   UCTAGL+56                                                06315000
UCTACBP  EQU   UCTAGL+52                                                06316000
UCTDSN   EQU   UCTAGL+8                                                 06317000
UCTHEAD  EQU   UCTAGL                                                   06318000
@NM00076 EQU   LCTFLAGS                                                 06319000
LCTVSCAT EQU   LCTFLAGS                                                 06320000
LCTOWNER EQU   LCTINFO+24                                               06321000
LCTEXPIR EQU   LCTINFO+20                                               06322000
LCTCREAT EQU   LCTINFO+16                                               06323000
LCTACBP  EQU   LCTINFO+12                                               06324000
LCTMULVC EQU   LCTINFO+8                                                06325000
LCTHEAD  EQU   LCTINFO                                                  06326000
SRTWORKP EQU   SRTAGL+28                                                06327000
SRTFLDLN EQU   SRTAGL+24                                                06328000
SRTPOSIT EQU   SRTAGL+20                                                06329000
SRTLEN   EQU   SRTAGL+16                                                06330000
SRTNUM   EQU   SRTAGL+12                                                06331000
SRTADDR  EQU   SRTAGL+8                                                 06332000
SRTHEAD  EQU   SRTAGL                                                   06333000
SV82DEBP EQU   SV82WRKP                                                 06334000
SV82TTRP EQU   SV82LIST+8                                               06335000
SV82VOLP EQU   SV82DCBP                                                 06336000
SV82UCBP EQU   SV82LIST+1                                               06337000
SV82CODE EQU   SV82LIST                                                 06338000
VOLRESV3 EQU   VOLLABEL+55                                              06339000
VOLOWNER EQU   VOLLABEL+45                                              06340000
VOLRESV1 EQU   VOLLABEL+20                                              06341000
VOLVTOC  EQU   VOLLABEL+15                                              06342000
VOLSECTY EQU   VOLLABEL+14                                              06343000
VOLSERNO EQU   VOLLABEL+8                                               06344000
VOLNO    EQU   VOLLABEL+7                                               06345000
VOLLABI  EQU   VOLLABEL+4                                               06346000
VOLKEY   EQU   VOLLABEL                                                 06347000
STAVTTR  EQU   STAEPARM+54                                              06348000
@NM00073 EQU   STARETRY                                                 06349000
STAVTOC  EQU   STARETRY                                                 06350000
STAOFF   EQU   STARETRY                                                 06351000
STAIO05  EQU   STARETRY                                                 06352000
@NM00072 EQU   STARCVY                                                  06353000
STACLEAR EQU   STARCVY                                                  06354000
STAVPOST EQU   STARCVY                                                  06355000
STAVENQ  EQU   STARCVY                                                  06356000
STAVDMNT EQU   STARCVY                                                  06357000
STAVMNT  EQU   STARCVY                                                  06358000
STATCB   EQU   STAEPARM+48                                              06359000
STARTADD EQU   STAEPARM+44                                              06360000
STAEXSAV EQU   STAEPARM+40                                              06361000
STARTSAV EQU   STAEPARM+36                                              06362000
STARTTR  EQU   STAEPARM+32                                              06363000
@NM00071 EQU   STAEPARM+30                                              06364000
STARVOL  EQU   STAEPARM+24                                              06365000
STARUCB  EQU   STAEPARM+20                                              06366000
@NM00070 EQU   STAEPARM+18                                              06367000
STAVVOL  EQU   STAEPARM+12                                              06368000
STAVUCB  EQU   STAEPARM+8                                               06369000
STAHEAD  EQU   STAEPARM                                                 06370000
@NM00069 EQU   RCTAGL+10                                                06371000
@NM00068 EQU   RCTOPT                                                   06372000
RCTHEAD  EQU   RCTAGL                                                   06373000
@NM00067 EQU   VSRESOPT                                                 06374000
@NM00066 EQU   VSMSG                                                    06375000
@NM00065 EQU   VSRETURN                                                 06376000
@NM00064 EQU   VSCATOPT                                                 06377000
@NM00063 EQU   VSVTOPT                                                  06378000
VSWRITE  EQU   VSSECOPT                                                 06379000
VSMASTER EQU   VSSECOPT                                                 06380000
VSVTOCPT EQU   VS2AGL+48                                                06381000
@NM00062 EQU   VS2AGL+45                                                06382000
VSDDNAME EQU   VS2AGL+37                                                06383000
@NM00061 EQU   VS2RESOP                                                 06384000
VS2REAL  EQU   VS2RESOP                                                 06385000
VS2RES   EQU   VS2RESOP                                                 06386000
@NM00060 EQU   VS2MSG                                                   06387000
VS2TOV   EQU   VS2MSG                                                   06388000
VSVOLUME EQU   VS2AGL+29                                                06389000
@NM00059 EQU   VSLABOPT                                                 06390000
VSNOVTOC EQU   VSLABOPT                                                 06391000
VSVOLSER EQU   VSLABOPT                                                 06392000
VSOWNER  EQU   VSLABOPT                                                 06393000
VSIOBKPT EQU   VS2AGL+24                                                06394000
VSVOLPTR EQU   VS2AGL+20                                                06395000
VSOWNPTR EQU   VS2AGL+16                                                06396000
VSVTOCSZ EQU   VS2AGL+12                                                06397000
VSUCBPTR EQU   VS2AGL+8                                                 06398000
VS2HEAD  EQU   VS2AGL                                                   06399000
EXPDATAL EQU   EXPARRAY+6                                               06400000
@NM00058 EQU   EXPARRAY+5                                               06401000
EXPKEYLN EQU   EXPARRAY+4                                               06402000
EXPDATAP EQU   EXPARRAY                                                 06403000
EXPRECNO EQU   EXPDATAB                                                 06404000
EXPCCHHR EQU   EXPARG+16                                                06405000
EXPCTLBK EQU   EXPARG+8                                                 06406000
EXPHEAD  EQU   EXPARG                                                   06407000
EXRWFUN  EQU   EXWRARG+46                                               06408000
@NM00057 EQU   EXSPACE+8                                                06409000
@NM00056 EQU   EXSPACE+6                                                06410000
@NM00055 EQU   EXSPACE+4                                                06411000
@NM00054 EQU   EXSPACE+1                                                06412000
@NM00053 EQU   EXSPACE                                                  06413000
EXRWKDLN EQU   EXWRARG+32                                               06414000
@NM00052 EQU   EXWRARG+31                                               06415000
EXRECNUM EQU   EXRWCHR+4                                                06416000
EXHH     EQU   EXRWCHR+2                                                06417000
EXCC     EQU   EXRWCHR                                                  06418000
EXCCWCNT EQU   EXWRARG+24                                               06419000
EXLOCPTR EQU   EXWRARG+20                                               06420000
EXRWDARE EQU   EXWRARG+16                                               06421000
EXRWIOAR EQU   EXWRARG+12                                               06422000
EXRWCTBL EQU   EXWRARG+8                                                06423000
EXRWRES  EQU   EXWRARG                                                  06424000
EXGDATAL EQU   EXGARG+30                                                06425000
@NM00051 EQU   EXGARG+29                                                06426000
EXGKEYLN EQU   EXGARG+28                                                06427000
EXGDATAP EQU   EXGARG+24                                                06428000
EXGRECNO EQU   EXGARG+20                                                06429000
EXGCCHH2 EQU   EXGARG+16                                                06430000
EXGCCHH1 EQU   EXGARG+12                                                06431000
EXGCTLBK EQU   EXGARG+8                                                 06432000
EXGHEAD  EQU   EXGARG                                                   06433000
EXOVTH   EQU   EXFLG                                                    06434000
EXORVT   EQU   EXFLG                                                    06435000
EXORDS   EQU   EXFLG                                                    06436000
EXOSPK   EQU   EXFLG                                                    06437000
EXORVS   EQU   EXFLG                                                    06438000
@NM00050 EQU   EXFLG                                                    06439000
@NM00049 EQU   EXOPT                                                    06440000
EXOREP   EQU   EXOPT                                                    06441000
EXOVTOC  EQU   EXOPT                                                    06442000
EXONEW   EQU   EXOPT                                                    06443000
EXOLAB   EQU   EXOPT                                                    06444000
EXOTAB   EQU   EXOPT                                                    06445000
EXOEXT   EQU   EXOARG+24                                                06446000
EXOUCB   EQU   EXOARG+20                                                06447000
EXOHEAD  EQU   EXOARG                                                   06448000
@NM00048 EQU   EXCLFLAG                                                 06449000
EXCLMNT  EQU   EXCLFLAG                                                 06450000
EXCLVOL  EQU   EXCLAGL+16                                               06451000
EXCLDDP  EQU   EXCLAGL+12                                               06452000
EXCLUCBP EQU   EXCLAGL+8                                                06453000
EXCLHEAD EQU   EXCLAGL                                                  06454000
@NM00047 EQU   CKFLAGS                                                  06455000
CKDMTABL EQU   CKFLAGS                                                  06456000
CKRETTYP EQU   CKFLAGS                                                  06457000
CKTESTVT EQU   CKFLAGS                                                  06458000
CKLABELP EQU   CKAGL+24                                                 06459000
CKDATYPE EQU   CKAGL+20                                                 06460000
CKDDNAME EQU   CKAGL+12                                                 06461000
CKUCBPTR EQU   CKAGL+8                                                  06462000
CKHEAD   EQU   CKAGL                                                    06463000
PULABELP EQU   PUAGL+16                                                 06464000
PUTTRPTR EQU   PUAGL+12                                                 06465000
PUUCBPTR EQU   PUAGL+8                                                  06466000
PUHEAD   EQU   PUAGL                                                    06467000
MDR      EQU   MDVTOC+4                                                 06468000
MDHH     EQU   MDVTOC+2                                                 06469000
MDCC     EQU   MDVTOC                                                   06470000
@NM00046 EQU   MDAGL+31                                                 06471000
MDVTOCTR EQU   MDFLAGS                                                  06472000
MDFORCE  EQU   MDFLAGS                                                  06473000
MDDEQ    EQU   MDFLAGS                                                  06474000
MDENQ    EQU   MDFLAGS                                                  06475000
MDWAIT   EQU   MDFLAGS                                                  06476000
MDPOST   EQU   MDFLAGS                                                  06477000
MDCLEAR  EQU   MDFLAGS                                                  06478000
MDNEWVOL EQU   MDFLAGS                                                  06479000
MDLABEL  EQU   MDAGL+24                                                 06480000
MDPUAGL  EQU   MDAGL+20                                                 06481000
MDDDNAME EQU   MDAGL+12                                                 06482000
MDUCBPTR EQU   MDAGL+8                                                  06483000
MDHEAD   EQU   MDAGL                                                    06484000
CTTBLRR  EQU   CTARRAY+3                                                06485000
CTTBLHH  EQU   CTARRAY+2                                                06486000
CTTBLCC  EQU   CTARRAY+1                                                06487000
CTTBLID  EQU   CTARRAY                                                  06488000
CTREALH  EQU   CTMSG+3                                                  06489000
CTREALCC EQU   CTMSG+1                                                  06490000
@NM00045 EQU   CTMSG                                                    06491000
CMCSN2   EQU   CMMSG+28                                                 06492000
CMCSN1   EQU   CMMSG+16                                                 06493000
CMNUMCRT EQU   CMMSG+15                                                 06494000
@NM00044 EQU   CMMSG+14                                                 06495000
CMNEWVOL EQU   CMMSG+8                                                  06496000
@NM00043 EQU   CMMSG+7                                                  06497000
@NM00042 EQU   CMVOLFLG                                                 06498000
CMRONLY  EQU   CMVOLFLG                                                 06499000
CMBIND   EQU   CMVOLFLG                                                 06500000
CMSCRCRT EQU   CMVOLFLG                                                 06501000
CMEXCL   EQU   CMVOLFLG                                                 06502000
CMDERAS  EQU   CMVOLFLG                                                 06503000
CMSCRVOL EQU   CMVOLFLG                                                 06504000
CMCECART EQU   CMVOLFLG                                                 06505000
CMOLDVOL EQU   CMMSG                                                    06506000
CCOLDCSN EQU   CCMSG+24                                                 06507000
CCNEWCSN EQU   CCMSG+12                                                 06508000
@NM00041 EQU   CCMSG+10                                                 06509000
CCVOL    EQU   CCMSG+4                                                  06510000
@NM00040 EQU   CCMSG+2                                                  06511000
CCEJCODE EQU   CCMSG+1                                                  06512000
CCPSTCDE EQU   CCMSG                                                    06513000
@NM00039 EQU   DMPARY+15                                                06514000
DMPARYTP EQU   DMPARY+14                                                06515000
DMPARYEX EQU   DMPARY+12                                                06516000
DMPARYIC EQU   DMPARY+10                                                06517000
DMPARYSZ EQU   DMPARY+8                                                 06518000
DMPARYNM EQU   DMPARY                                                   06519000
@NM00038 EQU   DMPITM+15                                                06520000
DMPITMTP EQU   DMPITM+14                                                06521000
DMPITMLN EQU   DMPITM+12                                                06522000
DMPITMPT EQU   DMPITM+8                                                 06523000
DMPITMNM EQU   DMPITM                                                   06524000
@NM00037 EQU   ERCNVTAB+24                                              06525000
ERDARBPT EQU   ERCPLPT                                                  06526000
ERDYNRC  EQU   ERCATRC                                                  06527000
ERDSNM   EQU   ERCNVTAB+12                                              06528000
@NM00036 EQU   ERCNVTAB+4                                               06529000
@NM00035 EQU   ERCNVTAB+3                                               06530000
@NM00034 EQU   EROSOPER                                                 06531000
EROSUCDX EQU   EROSOPER                                                 06532000
EROSCATL EQU   EROSOPER                                                 06533000
@NM00033 EQU   EROPER                                                   06534000
ERCATAL  EQU   EROPER                                                   06535000
ERCATDL  EQU   EROPER                                                   06536000
ERCATDE  EQU   EROPER                                                   06537000
ERCATLC  EQU   EROPER                                                   06538000
@NM00032 EQU   ERTYPE                                                   06539000
ERDYNAL  EQU   ERTYPE                                                   06540000
EROSCAT  EQU   ERTYPE                                                   06541000
ERCATLG  EQU   ERTYPE                                                   06542000
@NM00031 EQU   FMTCNVF+1                                                06543000
FMTAR    EQU   FMTCNVF+1                                                06544000
FMTBS    EQU   FMTCNVF+1                                                06545000
FMTSS    EQU   FMTCNVF+1                                                06546000
FMTAL    EQU   FMTCNVF+1                                                06547000
FMTZS    EQU   FMTCNVF+1                                                06548000
@NM00030 EQU   FMTCNVF                                                  06549000
FMTPU    EQU   FMTCNVF                                                  06550000
FMTBD    EQU   FMTCNVF                                                  06551000
FMTBHD   EQU   FMTCNVF                                                  06552000
FMTBHA   EQU   FMTCNVF                                                  06553000
FMTBH    EQU   FMTCNVF                                                  06554000
FMTOLEN  EQU   FMTLIST+8                                                06555000
FMTRIO   EQU   FMTOCOL                                                  06556000
FMTSPT   EQU   FMTSTO                                                   06557000
FMTSTL   EQU   FMTILEN                                                  06558000
@NM00029 EQU   FMTFLGS+1                                                06559000
FMTSMSG  EQU   FMTFLGS+1                                                06560000
FMTHDF   EQU   FMTFLGS                                                  06561000
FMTDFF   EQU   FMTFLGS                                                  06562000
FMTSTF   EQU   FMTFLGS                                                  06563000
FMTREPF  EQU   FMTFLGS                                                  06564000
FMTBDF   EQU   FMTFLGS                                                  06565000
FMTIDF   EQU   FMTFLGS                                                  06566000
FMTSCF   EQU   FMTFLGS                                                  06567000
FMTEOLF  EQU   FMTFLGS                                                  06568000
DARGPCT  EQU   DARGINL                                                  06569000
DARGREP  EQU   DARGINS                                                  06570000
@NM00028 EQU   DARGLIST+19                                              06571000
DARGIND  EQU   DARGLIST+18                                              06572000
DARGRETL EQU   DARGLIST+16                                              06573000
@NM00027 EQU   IOINFOPT                                                 06574000
IOINFLUB EQU   IOINFOPT                                                 06575000
IOINFTMS EQU   IOINFOPT                                                 06576000
IOINFSUP EQU   IOINFOPT                                                 06577000
IOINFVOL EQU   IOINFOPT                                                 06578000
IOINFDVT EQU   IOINFOPT                                                 06579000
OPNSTRNO EQU   OPNAGL+43                                                06580000
@NM00026 EQU   OPNOPT2                                                  06581000
@NM00025 EQU   OPNOPT2                                                  06582000
OPNOPTAS EQU   OPNOPT2                                                  06583000
@NM00024 EQU   OPNDSO                                                   06584000
OPNDSOPO EQU   OPNDSO                                                   06585000
OPNDSOIS EQU   OPNDSO                                                   06586000
OPNDSOAM EQU   OPNDSO                                                   06587000
OPNREC   EQU   OPNAGL+32                                                06588000
OPNDEVIX EQU   OPNDEV+4                                                 06589000
OPNDEVDT EQU   OPNDEV                                                   06590000
OPNCBP   EQU   OPNAGL+20                                                06591000
OPNMODRP EQU   OPNMOD                                                   06592000
OPNMODUB EQU   OPNMOD                                                   06593000
OPNMODRS EQU   OPNMOD                                                   06594000
OPNMODAX EQU   OPNMOD                                                   06595000
OPNMODRR EQU   OPNMOD                                                   06596000
OPNMODAC EQU   OPNMOD                                                   06597000
OPNMODPD EQU   OPNMOD                                                   06598000
OPNTYPSY EQU   OPNTYP                                                   06599000
OPNTYPRV EQU   OPNTYP                                                   06600000
OPNTYPEX EQU   OPNTYP                                                   06601000
OPNTYPRA EQU   OPNTYP                                                   06602000
OPNTYPXM EQU   OPNTYP                                                   06603000
OPNTYPSO EQU   OPNTYP                                                   06604000
OPNTYPSI EQU   OPNTYP                                                   06605000
@NM00023 EQU   OPNRFM                                                   06606000
OPNRFMBK EQU   OPNRFM                                                   06607000
OPNRFMSF EQU   OPNRFM                                                   06608000
OPNRFMUN EQU   OPNRFM                                                   06609000
OPNRFMVR EQU   OPNRFM                                                   06610000
OPNOPTSK EQU   OPNOPT                                                   06611000
OPNOPTDR EQU   OPNOPT                                                   06612000
OPNOPTCR EQU   OPNOPT                                                   06613000
OPNOPTKS EQU   OPNOPT                                                   06614000
OPNOPTOT EQU   OPNOPT                                                   06615000
OPNOPTIN EQU   OPNOPT                                                   06616000
IOCEXT   EQU   IOCSTR+64                                                06617000
IOCTSML  EQU   IOCREL+2                                                 06618000
IOCTPML  EQU   IOCREL                                                   06619000
IOCWORK  EQU   IOCSTR+56                                                06620000
IOCRRN   EQU   IOCSTR+52                                                06621000
IOCPNM   EQU   IOCNWM+2                                                 06622000
IOCPTL   EQU   IOCNWM                                                   06623000
IOCKYA   EQU   IOCMEM                                                   06624000
IOCVRC   EQU   IOCTTR                                                   06625000
IOCHURBA EQU   IOCSTR+28                                                06626000
IOCVOLSR EQU   IOCSTR+22                                                06627000
@NM00022 EQU   IOCMSG                                                   06628000
IOCMSGSM EQU   IOCMSG                                                   06629000
IOCMSGAE EQU   IOCMSG                                                   06630000
IOCMSGCE EQU   IOCMSG                                                   06631000
IOCMSGOE EQU   IOCMSG                                                   06632000
IOCMSGOP EQU   IOCMSG                                                   06633000
IOCCHPKG EQU   IOCMSG                                                   06634000
IOCCHPKE EQU   IOCMSG                                                   06635000
IOCCHPNU EQU   IOCCHP                                                   06636000
IOCCHPUP EQU   IOCCHP                                                   06637000
IOCCHPBK EQU   IOCCHP                                                   06638000
IOCCHPCR EQU   IOCCHP                                                   06639000
IOCCHPKS EQU   IOCCHP                                                   06640000
IOCCHPSK EQU   IOCCHP                                                   06641000
IOCCHPDR EQU   IOCCHP                                                   06642000
IOCCHPSQ EQU   IOCCHP                                                   06643000
IOCMACNT EQU   IOCMAC2                                                  06644000
IOCMACER EQU   IOCMAC2                                                  06645000
IOCMACPA EQU   IOCMAC2                                                  06646000
IOCMACEN EQU   IOCMAC2                                                  06647000
IOCMACCP EQU   IOCMAC2                                                  06648000
IOCMACRR EQU   IOCMAC2                                                  06649000
IOCMACAS EQU   IOCMAC2                                                  06650000
IOCMACSK EQU   IOCMAC2                                                  06651000
@NM00021 EQU   IOCMAC                                                   06652000
IOCMACCC EQU   IOCMAC                                                   06653000
IOCMACDR EQU   IOCMAC                                                   06654000
IOCMACBK EQU   IOCMAC                                                   06655000
IOCMACCR EQU   IOCMAC                                                   06656000
IOCMACUP EQU   IOCMAC                                                   06657000
IOCMACOT EQU   IOCMAC                                                   06658000
IOCMACIN EQU   IOCMAC                                                   06659000
@NM00020 EQU   IOCRFM                                                   06660000
IOCRFMBK EQU   IOCRFM                                                   06661000
IOCRFMSF EQU   IOCRFM                                                   06662000
IOCRFMUN EQU   IOCRFM                                                   06663000
IOCRFMVR EQU   IOCRFM                                                   06664000
IOCRFMFX EQU   IOCRFM                                                   06665000
@NM00019 EQU   IOCDSO                                                   06666000
IOCDSOPO EQU   IOCDSO                                                   06667000
IOCDSOIS EQU   IOCDSO                                                   06668000
IOCDSOPS EQU   IOCDSO                                                   06669000
IOCDSOAM EQU   IOCDSO                                                   06670000
IOCRKP   EQU   IOCSTR+13                                                06671000
IOCKYL   EQU   IOCSTR+12                                                06672000
IOCTRN   EQU   IOCSTR+8                                                 06673000
IOCDLN   EQU   IOCSTR+4                                                 06674000
UNITVTOC EQU   UNITABL+7                                                06675000
@NM00018 EQU   UNITSTAT                                                 06676000
UNITUSHR EQU   UNITSTAT                                                 06677000
UNITXSHR EQU   UNITSTAT                                                 06678000
UNITISHR EQU   UNITSTAT                                                 06679000
UNITUA   EQU   @NM00017+1                                               06680000
UNITCHA  EQU   @NM00017                                                 06681000
RACFPROF EQU   RACFAGL+8                                                06682000
@NM00016 EQU   RACFFLG4                                                 06683000
@NM00015 EQU   RACFFLG3                                                 06684000
RACFPRF  EQU   RACFFLG3                                                 06685000
@NM00014 EQU   RACFFLG3                                                 06686000
@NM00013 EQU   RACFFLG2                                                 06687000
RACFTCTL EQU   RACFFLG2                                                 06688000
@NM00012 EQU   RACFFLG2                                                 06689000
RACFTALT EQU   RACFFLG2                                                 06690000
RACFCSA  EQU   RACFFLG1                                                 06691000
RACFLOGN EQU   RACFFLG1                                                 06692000
RACFLOGF EQU   RACFFLG1                                                 06693000
@NM00011 EQU   RACFFLG1                                                 06694000
@NM00010 EQU   RACFFLG1                                                 06695000
ALLUNCNT EQU   ALLAGL+30                                                06696000
ALLVLCNT EQU   ALLAGL+29                                                06697000
@NM00009 EQU   ALLOPT                                                   06698000
ALLOPTUN EQU   ALLOPT                                                   06699000
ALLOPTPV EQU   ALLOPT                                                   06700000
ALLOPTVL EQU   ALLOPT                                                   06701000
@NM00008 EQU   ALLORG+1                                                 06702000
ALLORGVS EQU   ALLORG+1                                                 06703000
@NM00007 EQU   ALLORG+1                                                 06704000
ALLORGGS EQU   ALLORG+1                                                 06705000
ALLORGUN EQU   ALLORG                                                   06706000
ALLORGPO EQU   ALLORG                                                   06707000
ALLORGMQ EQU   ALLORG                                                   06708000
ALLORGCQ EQU   ALLORG                                                   06709000
ALLORGCX EQU   ALLORG                                                   06710000
ALLORGDA EQU   ALLORG                                                   06711000
ALLORGPS EQU   ALLORG                                                   06712000
ALLORGIS EQU   ALLORG                                                   06713000
ALLDSPUN EQU   ALLDSP                                                   06714000
ALLDSPCG EQU   ALLDSP                                                   06715000
ALLDSPDE EQU   ALLDSP                                                   06716000
@NM00006 EQU   ALLDSP                                                   06717000
ALLSTSOD EQU   ALLSTS                                                   06718000
ALLSTSMD EQU   ALLSTS                                                   06719000
ALLSTSNW EQU   ALLSTS                                                   06720000
@NM00005 EQU   ALLSTS                                                   06721000
ALLPWD   EQU   ALLAGL+20                                                06722000
ALLVLP   EQU   ALLAGL+16                                                06723000
ALLULP   EQU   ALLAGL+12                                                06724000
CIRPID   EQU   CIRAGL+28                                                06725000
CIRPWD   EQU   CIRAGL+24                                                06726000
CIRCAT   EQU   CIRAGL+20                                                06727000
CIRWKP   EQU   CIRAGL+16                                                06728000
CIRTLR   EQU   CIRAGL+12                                                06729000
CIRHDR   EQU   CIRAGL+8                                                 06730000
CIRTLN   EQU   CIRAGL+6                                                 06731000
CIRHLN   EQU   CIRAGL+4                                                 06732000
@NM00004 EQU   CIRAGL+1                                                 06733000
@NM00003 EQU   CIRTYPE                                                  06734000
CIRTYPAQ EQU   CIRTYPE                                                  06735000
CIRTYP1Q EQU   CIRTYPE                                                  06736000
NEWID1   EQU   TRACE1+95                                                06737000
CALLID   EQU   OLDERID1+90                                              06738000
@NM00002 EQU   OLDERID1                                                 06739000
*                                      END UNREFERENCED COMPONENTS      06740000
@RF00357 EQU   @RC00351                                                 06741000
@RC00375 EQU   @RC00367                                                 06742000
@RF00374 EQU   @RC00367                                                 06743000
@RF00396 EQU   @RC00390                                                 06744000
@RF00413 EQU   @RC00406                                                 06745000
@RF00666 EQU   @RC00660                                                 06746000
@RF00692 EQU   @RC00689                                                 06747000
@RF00717 EQU   @RC00714                                                 06748000
@RF00755 EQU   @RC00749                                                 06749000
@RF00883 EQU   @RC00838                                                 06750000
@RF00892 EQU   @RC00838                                                 06751000
@RF00918 EQU   @RC00912                                                 06752000
@RC00960 EQU   @RC00957                                                 06753000
@RF00978 EQU   @RC00957                                                 06754000
@RF01015 EQU   @RC00996                                                 06755000
@RF01125 EQU   @RC01109                                                 06756000
@RF01410 EQU   @RC01408                                                 06757000
@RC01420 EQU   @RC01408                                                 06758000
@RC01444 EQU   @RC01441                                                 06759000
@PB00018 EQU   @EL00001                                                 06760000
@PB00017 EQU   @PB00018                                                 06761000
@PB00016 EQU   @PB00017                                                 06762000
@PB00015 EQU   @PB00016                                                 06763000
@PB00014 EQU   @PB00015                                                 06764000
@PB00013 EQU   @PB00014                                                 06765000
@PB00012 EQU   @PB00013                                                 06766000
@PB00011 EQU   @PB00012                                                 06767000
@PB00010 EQU   @PB00011                                                 06768000
@PB00009 EQU   @PB00010                                                 06769000
@PB00008 EQU   @PB00009                                                 06770000
@PB00007 EQU   @PB00008                                                 06771000
@PB00006 EQU   @PB00007                                                 06772000
@PB00005 EQU   @PB00006                                                 06773000
@PB00004 EQU   @PB00005                                                 06774000
@PB00003 EQU   @PB00004                                                 06775000
@PB00002 EQU   @PB00003                                                 06776000
@ENDDATA EQU   *                                                        06777000
         END   IDCVS01,(C'PLS2022',0603,76320)                          06778000
