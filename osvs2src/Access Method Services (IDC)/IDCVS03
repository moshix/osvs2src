         TITLE '*************** IDCVS03:  VOLUME SERVICE ROUTINE *******00001000
               *********'                                               00002000
         MACRO                                                          00003000
         GETMAIN &R,&LV=                                                00004000
         L     REG15,0(REG1)           GDTTBL ADDRESS                   00005000
         L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS             00006000
         CNOP  2,4                     BOUNDARY ALIGNMENT               00007000
         LA    REG14,*+14              RETURN ADDRESS                   00008000
         BALR  REG1,REG15              LINKAGE TO PROL ROUTINE          00009000
         DC    A(MODID)                MODULE ID ADDRESS                00010000
         DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS   00011000
         MEND                                                           00012000
IDCVS03  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCVS03   78.165'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @02,4095(,@12)                                      0002 00022000
         USING @PSTART,@12                                         0002 00023000
         USING @PSTART+4095,@02                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         GETMAIN  R,LV=(0)                                              00026000
         LR    @11,@01                                             0002 00027000
         USING @DATD,@11                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @11,8(,@13)                                         0002 00031000
         LR    @13,@11                                             0002 00032000
         MVC   @PC00001(12),0(@01)                                 0002 00033000
*                                                            @Z40LB35*/ 00034000
*   OLDERID2=NEWERID2;                                             0269 00035000
         L     @04,@PC00001                                        0269 00036000
         L     @15,GDTTR2(,@04)                                    0269 00037000
         MVC   @TS00001(95),NEWERID2(@15)                          0269 00038000
         MVC   OLDERID2(95,@15),@TS00001                           0269 00039000
*   NEWID2='VS03';                  /*                       @Z40LB35   00040000
*                                                            @Z40LB35*/ 00041000
         MVC   NEWID2(4,@15),@CC01112                              0270 00042000
*   IF GDTDBG=NULLPTR THEN                                         0271 00043000
         L     @04,GDTDBG(,@04)                                    0271 00044000
         LTR   @04,@04                                             0271 00045000
         BZ    @RT00271                                            0271 00046000
*     ;                                                            0272 00047000
*   ELSE                                                           0273 00048000
*     CALL IDCDB010(GDTTBL,'VS03'); /*                       @Z40LB35   00049000
*                                                            @Z40LB35*/ 00050000
         L     @04,@PC00001                                        0273 00051000
         ST    @04,@AL00001                                        0273 00052000
         LA    @15,@CC01112                                        0273 00053000
         ST    @15,@AL00001+4                                      0273 00054000
         MVI   @AL00001+4,X'80'                                    0273 00055000
         L     @15,GDTDBG(,@04)                                    0273 00056000
         LA    @01,@AL00001                                        0273 00057000
         BALR  @14,@15                                             0273 00058000
*   DDSTRU=ADDR(PRINTARG);          /*                       @Z40LB35   00059000
*                                                            @Z40LB35*/ 00060000
@RT00271 LA    @04,PRINTARG                                        0274 00061000
         ST    @04,DDSTRU                                          0274 00062000
*   TESTRC=0;                       /*                       @Z40LB35   00063000
*                                                            @Z40LB35*/ 00064000
         SLR   @04,@04                                             0275 00065000
         STH   @04,TESTRC                                          0275 00066000
*   FINALRC=0;                      /*                       @Z40LB35   00067000
*                                                            @Z40LB35*/ 00068000
         STH   @04,FINALRC                                         0276 00069000
*   TRACKPTR=NULLPTR;               /*                       @Z40LB35   00070000
*                                                            @Z40LB35*/ 00071000
*                                                                  0277 00072000
         ST    @04,TRACKPTR                                        0277 00073000
*   /*****************************************************************/ 00074000
*   /*                                                               */ 00075000
*   /* MOVE REQUEST NAME INTO CALLER'S PARMLIST              @Z40LB35*/ 00076000
*   /* THIS WILL AID TO DETERMINE IF LIST WAS PASSED         @Z40LB35*/ 00077000
*   /* IF A DUMP IS BEING READ.                              @Z40LB35*/ 00078000
*   /* IF THE FIRST 8 CHAR CONTAIN THE REQUEST NAME          @Z40LB35*/ 00079000
*   /* WHICH IS "SELECTDS"                                   @Z40LB35*/ 00080000
*   /* IT INDICATES THAT THIS MODULE WAS CALLED.             @Z40LB35*/ 00081000
*   /*                                                               */ 00082000
*   /*****************************************************************/ 00083000
*                                                                  0278 00084000
*   VS3HEAD=REQUEST;                /*                       @Z40LB35   00085000
*                                                            @Z40LB35*/ 00086000
         L     @04,@PC00001+8                                      0278 00087000
         L     @15,@PC00001+4                                      0278 00088000
         MVC   VS3HEAD(8,@04),REQUEST(@15)                         0278 00089000
*                                                                  0279 00090000
*   /*****************************************************************/ 00091000
*   /*                                                               */ 00092000
*   /* THIS PORTION OF THE MODULE IS CONSIDERED              @Z40LB35*/ 00093000
*   /* THE CONTROLLER AND DETERMINES WHICH SERVICE           @Z40LB35*/ 00094000
*   /* THE CALLER HAS REQUESTED                              @Z40LB35*/ 00095000
*   /* AND DIRECTS CONTROL TO PROPER SUBROUTINE.             @Z40LB35*/ 00096000
*   /* IF THE REQUEST IS INVALID, UABORT IS ISSUED           @Z40LB35*/ 00097000
*   /*                                                               */ 00098000
*   /*****************************************************************/ 00099000
*                                                                  0279 00100000
*   IF REQUEST=SELECTDS THEN        /*                       @Z40LB35*/ 00101000
         CLC   REQUEST(8,@15),SELECTDS                             0279 00102000
         BNE   @RF00279                                            0279 00103000
*     DO;                           /*                       @Z40LB35*/ 00104000
*       CALL INITIAL;               /*                       @Z40LB35*/ 00105000
         BAL   @14,INITIAL                                         0281 00106000
*       RESPECIFY                                                  0282 00107000
*         RTNREG RSTD;                                             0282 00108000
*       TESTRC=RTNREG;                                             0283 00109000
         STH   RTNREG,TESTRC                                       0283 00110000
*       RESPECIFY                                                  0284 00111000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 00112000
*       IF TESTRC^=0 THEN           /*                       @Z40LB35*/ 00113000
         LH    @04,TESTRC                                          0285 00114000
         LTR   @04,@04                                             0285 00115000
         BZ    @RF00285                                            0285 00116000
*         FINALRC=TESTRC;           /*                       @Z40LB35*/ 00117000
         STH   @04,FINALRC                                         0286 00118000
*     END;                          /*                       @Z40LB35*/ 00119000
*   ELSE                            /*                       @Z40LB35*/ 00120000
*     DO;                                                          0288 00121000
         B     @RC00279                                            0288 00122000
@RF00279 DS    0H                                                  0289 00123000
*       RESPECIFY                                                  0289 00124000
*        (REG13,                                                   0289 00125000
*         REG14,                                                   0289 00126000
*         REG15) RSTD;                                             0289 00127000
*       REG15=40;                                                  0290 00128000
         LA    REG15,40                                            0290 00129000
*       REG14=GDTABT;                                              0291 00130000
         L     @04,@PC00001                                        0291 00131000
         L     REG14,GDTABT(,@04)                                  0291 00132000
*       REG13=GDTABH;                                              0292 00133000
         L     REG13,GDTABH(,@04)                                  0292 00134000
*       GEN(BR    REG14);                                          0293 00135000
         BR    REG14                                                    00136000
*       RESPECIFY                                                  0294 00137000
*        (REG13,                                                   0294 00138000
*         REG14,                                                   0294 00139000
*         REG15) UNRSTD;                                           0294 00140000
*     END;                          /*                       @Z40LB35*/ 00141000
*                                                                  0295 00142000
*   /*****************************************************************/ 00143000
*   /*                                                               */ 00144000
*   /* AFTER THE VTOC HAS BEEN OPENED AND                    @Z40LB35*/ 00145000
*   /* STORAGE HAS BEEN OBTAINED, THE VTOC IS                @Z40LB35*/ 00146000
*   /* PROCESSED TO FIND DSNS THAT MEET THE                  @Z40LB35*/ 00147000
*   /* CRITERIA.                                             @Z40LB35*/ 00148000
*   /*                                                               */ 00149000
*   /*****************************************************************/ 00150000
*                                                                  0296 00151000
*   IF FINALRC=0 THEN               /*                       @Z40LB35*/ 00152000
@RC00279 LH    @04,FINALRC                                         0296 00153000
         LTR   @04,@04                                             0296 00154000
         BNZ   @RF00296                                            0296 00155000
*     DO;                           /*                       @Z40LB35*/ 00156000
*       CALL SELECTOR;              /*                       @Z40LB35*/ 00157000
         BAL   @14,SELECTOR                                        0298 00158000
*       RESPECIFY                                                  0299 00159000
*         RTNREG RSTD;                                             0299 00160000
*       TESTRC=RTNREG;                                             0300 00161000
         STH   RTNREG,TESTRC                                       0300 00162000
*       RESPECIFY                                                  0301 00163000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 00164000
*       IF TESTRC^=0 THEN           /*                       @Z40LB35*/ 00165000
         LH    @10,TESTRC                                          0302 00166000
         LTR   @10,@10                                             0302 00167000
         BZ    @RF00302                                            0302 00168000
*         FINALRC=TESTRC;           /*                       @Z40LB35*/ 00169000
         STH   @10,FINALRC                                         0303 00170000
*     END;                          /*                       @Z40LB35*/ 00171000
*                                                                  0304 00172000
@RF00302 DS    0H                                                  0305 00173000
*   /*****************************************************************/ 00174000
*   /*                                                               */ 00175000
*   /* CLEANUP IS CALLED TO CLOSE THE VTOC AND               @Z40LB35*/ 00176000
*   /* FREE THE TRACK BUFFER.                                @Z40LB35*/ 00177000
*   /*                                                               */ 00178000
*   /*****************************************************************/ 00179000
*                                                                  0305 00180000
*   CALL CLEANUP;                   /*                       @Z40LB35*/ 00181000
@RF00296 BAL   @14,CLEANUP                                         0305 00182000
*   RESPECIFY                                                      0306 00183000
*     RTNREG RSTD;                                                 0306 00184000
*   TESTRC=RTNREG;                                                 0307 00185000
         STH   RTNREG,TESTRC                                       0307 00186000
*   RESPECIFY                                                      0308 00187000
*     RTNREG UNRSTD;                /*                       @Z40LB35*/ 00188000
*                                                                  0308 00189000
*   /*****************************************************************/ 00190000
*   /*                                                               */ 00191000
*   /* HERE THE FINAL RETURN CODE IS SET.                    @Z40LB35*/ 00192000
*   /*                                                               */ 00193000
*   /*****************************************************************/ 00194000
*                                                                  0309 00195000
*   IF FINALRC=0&TESTRC^=0 THEN     /*                       @Z40LB35*/ 00196000
         SLR   @10,@10                                             0309 00197000
         CH    @10,FINALRC                                         0309 00198000
         BNE   @RF00309                                            0309 00199000
         LH    @03,TESTRC                                          0309 00200000
         CR    @03,@10                                             0309 00201000
         BE    @RF00309                                            0309 00202000
*     FINALRC=TESTRC;               /*                       @Z40LB35   00203000
*                                                            @Z40LB35*/ 00204000
*                                                                  0310 00205000
         STH   @03,FINALRC                                         0310 00206000
*   /*****************************************************************/ 00207000
*   /*                                                               */ 00208000
*   /* HERE IDCVS03 WILL EXIT. BEFORE EXIT, THE              @Z40LB35*/ 00209000
*   /* DUMP POINT FOR A FULL REGION DUMP OF 'VS3X'           @Z40LB35*/ 00210000
*   /* CAN BE ISSUED.                                        @Z40LB35*/ 00211000
*   /* THE RETURN CODE SAVED IN FINALRC IS RETURNED.         @Z40LB35*/ 00212000
*   /*                                                               */ 00213000
*   /*****************************************************************/ 00214000
*                                                                  0311 00215000
*   IF GDTDBG=NULLPTR THEN                                         0311 00216000
@RF00309 L     @10,@PC00001                                        0311 00217000
         L     @10,GDTDBG(,@10)                                    0311 00218000
         LTR   @10,@10                                             0311 00219000
         BZ    @RT00311                                            0311 00220000
*     ;                                                            0312 00221000
*   ELSE                                                           0313 00222000
*     CALL IDCDB010(GDTTBL,'VS3X'); /*                       @Z40LB35*/ 00223000
         L     @10,@PC00001                                        0313 00224000
         ST    @10,@AL00001                                        0313 00225000
         LA    @03,@CC01290                                        0313 00226000
         ST    @03,@AL00001+4                                      0313 00227000
         MVI   @AL00001+4,X'80'                                    0313 00228000
         L     @15,GDTDBG(,@10)                                    0313 00229000
         LA    @01,@AL00001                                        0313 00230000
         BALR  @14,@15                                             0313 00231000
*   CALL IDCSAEP0(GDTTBL,MODID,FINALRC);                           0314 00232000
*                                                                  0314 00233000
@RT00311 L     @10,@PC00001                                        0314 00234000
         ST    @10,@AL00001                                        0314 00235000
         LA    @03,MODID                                           0314 00236000
         ST    @03,@AL00001+4                                      0314 00237000
         LA    @03,FINALRC                                         0314 00238000
         ST    @03,@AL00001+8                                      0314 00239000
         MVI   @AL00001+8,X'80'                                    0314 00240000
         L     @15,GDTEPL(,@10)                                    0314 00241000
         LA    @01,@AL00001                                        0314 00242000
         BALR  @14,@15                                             0314 00243000
*   /*****************************************************************/ 00244000
*   /*                                                               */ 00245000
*   /*                                                       @Z40LB35*/ 00246000
*   /*                                                               */ 00247000
*   /*****************************************************************/ 00248000
*                                                                  0315 00249000
*                                                                  0315 00250000
*/********************************************************************/ 00251000
*/*                                                          @Z40LB35*/ 00252000
*/* PROCEDURE NAME - INITIAL                                 @Z40LB35*/ 00253000
*/*                                                          @Z40LB35*/ 00254000
*/* FUNCTION -  CONTROL THE INITIALIZATION PROCESS BY        @Z40LB35*/ 00255000
*/*             CALLING THE SUBORDINATE PROCEDURES OF        @Z40LB35*/ 00256000
*/*             OPENVTOC AND GETBLK.                         @Z40LB35*/ 00257000
*/*                                                          @Z40LB35*/ 00258000
*/* INPUT -     NONE                                         @Z40LB35*/ 00259000
*/*                                                          @Z40LB35*/ 00260000
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 00261000
*/*                           4, ERROR IN OPENVTOC PROC      @Z40LB35*/ 00262000
*/*                           4, ERROR IN GETBLK PROC        @Z40LB35*/ 00263000
*/*                                                          @Z40LB35*/ 00264000
*/********************************************************************/ 00265000
*                                                                  0315 00266000
*                                   /*                       @Z40LB35*/ 00267000
*INITIAL:                                                          0315 00268000
*   PROC;                           /*                       @Z40LB35*/ 00269000
*                                                                  0315 00270000
@EL00001 L     @13,4(,@13)                                         0315 00271000
@EF00001 L     @00,@SIZDATD                                        0315 00272000
         LR    @01,@11                                             0315 00273000
         FREEMAIN R,LV=(0),A=(1)                                        00274000
@ER00001 LM    @14,@12,12(@13)                                     0315 00275000
         BR    @14                                                 0315 00276000
INITIAL  STM   @14,@04,@SA00002                                    0315 00277000
         STM   @06,@08,@SA00002+28                                 0315 00278000
         STM   @10,@12,@SA00002+40                                 0315 00279000
*   /*****************************************************************/ 00280000
*   /*                                                               */ 00281000
*   /* SET UP TRACE POINT 'VSIT' IN TRACE TABLE              @Z40LB35*/ 00282000
*   /*                                                               */ 00283000
*   /*****************************************************************/ 00284000
*                                                                  0316 00285000
*   OLDERID2=NEWERID2;                                             0316 00286000
         L     @10,@PC00001                                        0316 00287000
         L     @10,GDTTR2(,@10)                                    0316 00288000
         MVC   @TS00001(95),NEWERID2(@10)                          0316 00289000
         MVC   OLDERID2(95,@10),@TS00001                           0316 00290000
*   NEWID2='VSIT';                  /*                       @Z40LB35*/ 00291000
*                                                                  0317 00292000
         MVC   NEWID2(4,@10),@CC01294                              0317 00293000
*   /*****************************************************************/ 00294000
*   /*                                                               */ 00295000
*   /* CALL OPENVTOC TO PREPARE FOR I/O TO VTOC              @Z40LB35*/ 00296000
*   /*                                                               */ 00297000
*   /*****************************************************************/ 00298000
*                                                                  0318 00299000
*   CALL OPENVTOC;                  /*                       @Z40LB35*/ 00300000
         BAL   @14,OPENVTOC                                        0318 00301000
*   RESPECIFY                                                      0319 00302000
*     RTNREG RSTD;                                                 0319 00303000
*   TESTRC=RTNREG;                                                 0320 00304000
         STH   RTNREG,TESTRC                                       0320 00305000
*   RESPECIFY                                                      0321 00306000
*     RTNREG UNRSTD;                /*                       @Z40LB35*/ 00307000
*                                                                  0321 00308000
*   /*****************************************************************/ 00309000
*   /*                                                               */ 00310000
*   /* IF THE OPENVTOC PROCEDURE WAS SUCCESSFUL,             @Z40LB35*/ 00311000
*   /* GETBLK IS CALLED TO OBTAIN STORAGE.                   @Z40LB35*/ 00312000
*   /*                                                               */ 00313000
*   /*****************************************************************/ 00314000
*                                                                  0322 00315000
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/ 00316000
         LH    @10,TESTRC                                          0322 00317000
         LTR   @10,@10                                             0322 00318000
         BNZ   @RF00322                                            0322 00319000
*     DO;                           /*                       @Z40LB35*/ 00320000
*       CALL GETBLK;                /*                       @Z40LB35*/ 00321000
         BAL   @14,GETBLK                                          0324 00322000
*       RESPECIFY                                                  0325 00323000
*         RTNREG RSTD;                                             0325 00324000
*       TESTRC=RTNREG;                                             0326 00325000
         STH   RTNREG,TESTRC                                       0326 00326000
*       RESPECIFY                                                  0327 00327000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 00328000
*     END;                          /*                       @Z40LB35*/ 00329000
*                                                                  0328 00330000
*   /*****************************************************************/ 00331000
*   /*                                                               */ 00332000
*   /* HERE CONTROL IS RETURNED TO IDCVS03 WITH              @Z40LB35*/ 00333000
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/ 00334000
*   /*                                                               */ 00335000
*   /*****************************************************************/ 00336000
*                                                                  0329 00337000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 00338000
@RF00322 LH    @15,TESTRC                                          0329 00339000
         L     @14,@SA00002                                        0329 00340000
         LM    @00,@04,@SA00002+8                                  0329 00341000
         LM    @06,@08,@SA00002+28                                 0329 00342000
         LM    @10,@12,@SA00002+40                                 0329 00343000
         BR    @14                                                 0329 00344000
*   END INITIAL;                    /*                       @Z40LB35*/ 00345000
*                                                                  0331 00346000
*/********************************************************************/ 00347000
*/*                                                          @Z40LB35*/ 00348000
*/* PROCEDURE NAME - GETBLK                                  @Z40LB35*/ 00349000
*/*                                                          @Z40LB35*/ 00350000
*/* FUNCTION -  THIS PROCEDURE OBTAINS STORAGE FOR THE TRACK @Z40LB35*/ 00351000
*/*             BUFFER AND THE VSDBLOCK WHICH IS RETURNED    @Z40LB35*/ 00352000
*/*             TO THE CALLER OF IDCVS03.                    @Z40LB35*/ 00353000
*/*                                                          @Z40LB35*/ 00354000
*/*             IDC22011I ISSUED IF UNABLE TO OBTAIN STORAGE @Z40LB35*/ 00355000
*/*                                                          @Z40LB35*/ 00356000
*/* INPUT -     DS4VTOCE FROM THE IECSDSL1 FMT 4 DSCB        @Z40LB35*/ 00357000
*/*             DS1IDFMT ('F1') FROM THE IECSDSL1 FMT 1 DSCB @Z40LB35*/ 00358000
*/*                                                          @Z40LB35*/ 00359000
*/* OUTPUT -    TRACKPTR (POINTER TO I/O BUFFER)             @Z40LB35*/ 00360000
*/*             VSDPTR   (POINTER TO THE VSDBLOCK)           @Z40LB35*/ 00361000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 00362000
*/*                           4, ERROR IN UGSPACE            @Z40LB35*/ 00363000
*/*                                                          @Z40LB35*/ 00364000
*/********************************************************************/ 00365000
*                                                                  0331 00366000
*                                   /*                       @Z40LB35*/ 00367000
*GETBLK:                                                           0331 00368000
*   PROC;                           /*                       @Z40LB35*/ 00369000
*                                                                  0331 00370000
GETBLK   STM   @14,@04,@SA00003                                    0331 00371000
         STM   @06,@08,@SA00003+28                                 0331 00372000
         STM   @10,@12,@SA00003+40                                 0331 00373000
*   /*****************************************************************/ 00374000
*   /*                                                               */ 00375000
*   /* LOCAL DECLARES                                        @Z40LB35*/ 00376000
*   /*                                                               */ 00377000
*   /*****************************************************************/ 00378000
*                                                                  0332 00379000
*   DCL                                                            0332 00380000
*     1 DS4EXTS BASED(ADDR(DS4VTOCE)),/*                     @Z40LB35*/ 00381000
*      2 DS4BEGCY FIXED(15),        /* BEGIN CYL OF VTOC     @Z40LB35*/ 00382000
*      2 DS4BEGTK FIXED(15),        /* BEGIN TRK OF VTOC     @Z40LB35*/ 00383000
*      2 DS4ENDCY FIXED(15),        /* END CYL OF VTOC       @Z40LB35*/ 00384000
*      2 DS4ENDTK FIXED(15);        /* END TRK OF VTOC       @Z40LB35*/ 00385000
*   DCL                                                            0333 00386000
*     FMT1DSCB FIXED(31);           /* DO LOOP COUNTER       @Z40LB35*/ 00387000
*   DCL                                                            0334 00388000
*     VSDSIZE FIXED(31);            /* SIZE STORAGE FOR BLOCK      0334 00389000
*                                                            @Z40LB35*/ 00390000
*                                                                  0334 00391000
*   /*****************************************************************/ 00392000
*   /*                                                               */ 00393000
*   /* STATIC CONSTANTS                                      @Z40LB35*/ 00394000
*   /*                                                               */ 00395000
*   /*****************************************************************/ 00396000
*                                                                  0335 00397000
*   DCL                                                            0335 00398000
*     FMT4KEY FIXED(8) UNSIGNED INITIAL(44);/*               @Z40LB35   00399000
*                                      LEN OF FMT4 DSCB KEY  @Z40LB35*/ 00400000
*                                                                  0336 00401000
*   /*****************************************************************/ 00402000
*   /*                                                               */ 00403000
*   /* SET UP TRACE POINT 'VSGB' IN TRACE TABLE              @Z40LB35*/ 00404000
*   /*                                                               */ 00405000
*   /*****************************************************************/ 00406000
*                                                                  0336 00407000
*   OLDERID2=NEWERID2;                                             0336 00408000
         L     @10,@PC00001                                        0336 00409000
         L     @08,GDTTR2(,@10)                                    0336 00410000
         MVC   @TS00001(95),NEWERID2(@08)                          0336 00411000
         MVC   OLDERID2(95,@08),@TS00001                           0336 00412000
*   NEWID2='VSGB';                  /*                       @Z40LB35*/ 00413000
*                                                                  0337 00414000
         MVC   NEWID2(4,@08),@CC01308                              0337 00415000
*   /*****************************************************************/ 00416000
*   /*                                                               */ 00417000
*   /* ISSUE UGSPACE TO OBTAIN CORE FOR VTOC TRACK           @Z40LB35*/ 00418000
*   /*                                                               */ 00419000
*   /*****************************************************************/ 00420000
*                                                                  0338 00421000
*   CALL IDCSAGS0(GDTTBL,TRACKLEN,TRACKPTR,SETZERO);/*       @Z40LB35*/ 00422000
         ST    @10,@AL00001                                        0338 00423000
         LA    @08,TRACKLEN                                        0338 00424000
         ST    @08,@AL00001+4                                      0338 00425000
         LA    @08,TRACKPTR                                        0338 00426000
         ST    @08,@AL00001+8                                      0338 00427000
         LA    @08,SETZERO                                         0338 00428000
         ST    @08,@AL00001+12                                     0338 00429000
         MVI   @AL00001+12,X'80'                                   0338 00430000
         L     @15,GDTGSP(,@10)                                    0338 00431000
         LA    @01,@AL00001                                        0338 00432000
         BALR  @14,@15                                             0338 00433000
*   RESPECIFY                                                      0339 00434000
*     RTNREG RSTD;                                                 0339 00435000
*   TESTRC=RTNREG;                                                 0340 00436000
         STH   RTNREG,TESTRC                                       0340 00437000
*   RESPECIFY                                                      0341 00438000
*     RTNREG UNRSTD;                /*                       @Z40LB35*/ 00439000
*                                                                  0341 00440000
*   /*****************************************************************/ 00441000
*   /*                                                               */ 00442000
*   /* IF UGSPACE FAILED, BUILD DARGLIST TO ISSUE            @Z40LB35*/ 00443000
*   /* MESSAGE "IDC2011I FUNCTION CANNOT BE                  @Z40LB35*/ 00444000
*   /* EXECUTED. INSUFFICIENT MAIN STOARAGE"                 @Z40LB35*/ 00445000
*   /*                                                               */ 00446000
*   /*****************************************************************/ 00447000
*                                                                  0342 00448000
*   IF TESTRC^=0 THEN               /*                       @Z40LB35*/ 00449000
         LH    @10,TESTRC                                          0342 00450000
         LTR   @10,@10                                             0342 00451000
         BZ    @RF00342                                            0342 00452000
*     DO;                           /*                       @Z40LB35*/ 00453000
*       DARGLIST=''B;               /*                       @Z40LB35*/ 00454000
         L     @10,DDSTRU                                          0344 00455000
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0344 00456000
*       DARGSMOD=IDCTSUV0;          /*                       @Z40LB35*/ 00457000
         MVC   DARGSMOD(3,@10),@CC01119                            0345 00458000
*       DARGSENT=MSG2011A;          /*                       @Z40LB35*/ 00459000
         MVI   DARGSENT(@10),X'0C'                                 0346 00460000
*       CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*              @Z40LB35*/ 00461000
         L     @10,@PC00001                                        0347 00462000
         ST    @10,@AL00001                                        0347 00463000
         LA    @08,@CF00115                                        0347 00464000
         ST    @08,@AL00001+4                                      0347 00465000
         LA    @08,DDSTRU                                          0347 00466000
         ST    @08,@AL00001+8                                      0347 00467000
         MVI   @AL00001+8,X'80'                                    0347 00468000
         L     @15,GDTPRT(,@10)                                    0347 00469000
         LA    @01,@AL00001                                        0347 00470000
         BALR  @14,@15                                             0347 00471000
*     END;                          /*                       @Z40LB35*/ 00472000
*                                                                  0348 00473000
*   /*****************************************************************/ 00474000
*   /*                                                               */ 00475000
*   /* IF TRACK BUFFER OBTAINED OK, READ THE ENTIRE          @Z40LB35*/ 00476000
*   /* VTOC TO DETERMINE HOW MANY FMT1 DSCBS                 @Z40LB35*/ 00477000
*   /*                                                               */ 00478000
*   /*****************************************************************/ 00479000
*                                                                  0349 00480000
*   ELSE                            /*                       @Z40LB35*/ 00481000
*     DO;                           /*                       @Z40LB35*/ 00482000
         B     @RC00342                                            0349 00483000
@RF00342 DS    0H                                                  0350 00484000
*       CALL TRKREAD;               /*                       @Z40LB35*/ 00485000
         BAL   @14,TRKREAD                                         0350 00486000
*       RESPECIFY                                                  0351 00487000
*         RTNREG RSTD;                                             0351 00488000
*       TESTRC=RTNREG;                                             0352 00489000
         STH   RTNREG,TESTRC                                       0352 00490000
*       RESPECIFY                                                  0353 00491000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 00492000
*                                                                  0353 00493000
*       /*************************************************************/ 00494000
*       /*                                                           */ 00495000
*       /* IF THE FIRST VTOC TRACK WAS READ SUCCESSFUL       @Z40LB35*/ 00496000
*       /* THEN INTERROGATE THE FORMAT 4 DSCB TO             @Z40LB35*/ 00497000
*       /* DETERMINE THE DEB EXTENTS OF THE VTOC             @Z40LB35*/ 00498000
*       /*                                                           */ 00499000
*       /*************************************************************/ 00500000
*                                                                  0354 00501000
*       IF TESTRC=0 THEN            /*                       @Z40LB35*/ 00502000
         LH    @10,TESTRC                                          0354 00503000
         SLR   @08,@08                                             0354 00504000
         CR    @10,@08                                             0354 00505000
         BNE   @RF00354                                            0354 00506000
*         DO;                       /*                       @Z40LB35*/ 00507000
*           FMT1CTR=0;              /*                       @Z40LB35*/ 00508000
         SLR   FMT1CTR,FMT1CTR                                     0356 00509000
*           FMT0CTR=0;              /*                       @Z40LB35*/ 00510000
         ST    @08,FMT0CTR                                         0357 00511000
*           F4PTR=TRACKPTR+FMT4KEY; /*                       @Z40LB35*/ 00512000
         L     @10,TRACKPTR                                        0358 00513000
         SLR   F4PTR,F4PTR                                         0358 00514000
         IC    F4PTR,FMT4KEY                                       0358 00515000
         ALR   F4PTR,@10                                           0358 00516000
*           F1PTR=TRACKPTR;         /*                       @Z40LB35*/ 00517000
*                                                                  0359 00518000
         LR    F1PTR,@10                                           0359 00519000
*           /*********************************************************/ 00520000
*           /*                                                       */ 00521000
*           /* THE FOLLOWING DO GROUP WILL READ THE VTOC     @Z40LB35*/ 00522000
*           /* AND COUNT UP THE NUMBER OF FMT 1 DSCBS        @Z40LB35*/ 00523000
*           /*                                                       */ 00524000
*           /*********************************************************/ 00525000
*                                                                  0360 00526000
*           DO WHILE TESTRC=0;      /*                       @Z40LB35*/ 00527000
         B     @DE00360                                            0360 00528000
@DL00360 DS    0H                                                  0361 00529000
*             DO FMT1DSCB=1 TO VTOCTRK;/*                    @Z40LB35*/ 00530000
         LA    FMT1DSCB,1                                          0361 00531000
         B     @DE00361                                            0361 00532000
@DL00361 DS    0H                                                  0362 00533000
*               IF DS1FMTID=FMT1ID THEN/*                    @Z40LB35*/ 00534000
         CLC   DS1FMTID(1,F1PTR),FMT1ID                            0362 00535000
         BNE   @RF00362                                            0362 00536000
*                 FMT1CTR=FMT1CTR+1;/*                       @Z40LB35*/ 00537000
         AL    FMT1CTR,@CF00219                                    0363 00538000
*               IF DS1FMTID=FMT0ID THEN/*                    @Z40LB35*/ 00539000
@RF00362 CLC   DS1FMTID(1,F1PTR),FMT0ID                            0364 00540000
         BNE   @RF00364                                            0364 00541000
*                 FMT0CTR=FMT0CTR+1;/*                       @Z40LB35*/ 00542000
         LA    @10,1                                               0365 00543000
         AL    @10,FMT0CTR                                         0365 00544000
         ST    @10,FMT0CTR                                         0365 00545000
*               F1PTR=F1PTR+LENGTH(IECSDSF1);/*              @Z40LB35*/ 00546000
@RF00364 AL    F1PTR,@CF01203                                      0366 00547000
*             END;                  /*                       @Z40LB35*/ 00548000
         AL    FMT1DSCB,@CF00219                                   0367 00549000
@DE00361 CH    FMT1DSCB,VTOCTRK                                    0367 00550000
         BNH   @DL00361                                            0367 00551000
*             CALL TRKREAD;         /*                       @Z40LB35*/ 00552000
         BAL   @14,TRKREAD                                         0368 00553000
*             RESPECIFY                                            0369 00554000
*               RTNREG RSTD;                                       0369 00555000
*             TESTRC=RTNREG;                                       0370 00556000
         STH   RTNREG,TESTRC                                       0370 00557000
*             RESPECIFY                                            0371 00558000
*               RTNREG UNRSTD;      /*                       @Z40LB35*/ 00559000
*             F1PTR=TRACKPTR;       /*                       @Z40LB35*/ 00560000
         L     F1PTR,TRACKPTR                                      0372 00561000
*           END;                    /*                       @Z40LB35*/ 00562000
@DE00360 LH    @10,TESTRC                                          0373 00563000
         LTR   @10,@10                                             0373 00564000
         BZ    @DL00360                                            0373 00565000
*         END;                      /*                       @Z40LB35*/ 00566000
*     END;                          /*                       @Z40LB35*/ 00567000
*                                                                  0375 00568000
@RF00354 DS    0H                                                  0376 00569000
*   /*****************************************************************/ 00570000
*   /*                                                               */ 00571000
*   /* THE EOF RETURN CODE IS TRANSLATED TO                  @Z40LB35*/ 00572000
*   /* SUCCESSFUL.                                           @Z40LB35*/ 00573000
*   /*                                                               */ 00574000
*   /*****************************************************************/ 00575000
*                                                                  0376 00576000
*   IF TESTRC=EOF THEN              /*                       @Z40LB35*/ 00577000
@RC00342 CLC   TESTRC(2),EOF                                       0376 00578000
         BNE   @RF00376                                            0376 00579000
*     TESTRC=0;                     /*                       @Z40LB35*/ 00580000
*                                                                  0377 00581000
         SLR   @10,@10                                             0377 00582000
         STH   @10,TESTRC                                          0377 00583000
*   /*****************************************************************/ 00584000
*   /*                                                               */ 00585000
*   /* PROVIDED THE OPERATION WAS SUCCESSFUL THUS            @Z40LB35*/ 00586000
*   /* FAR, THE UGPOOL IS CALLED TO OBTAIN THE               @Z40LB35*/ 00587000
*   /* VSDBLOCK THAT IS RETURNED TO CALLER OF THIS           @Z40LB35*/ 00588000
*   /* MODULE. THE POOL ID IS PROVIDED BY CALLER             @Z40LB35*/ 00589000
*   /* AND THE CALLER WILL FREE THE CORE.                    @Z40LB35*/ 00590000
*   /*                                                               */ 00591000
*   /*****************************************************************/ 00592000
*                                                                  0378 00593000
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/ 00594000
@RF00376 LH    @10,TESTRC                                          0378 00595000
         LTR   @10,@10                                             0378 00596000
         BNZ   @RF00378                                            0378 00597000
*     DO;                           /*                       @Z40LB35*/ 00598000
*       VSDSIZE=(FMT1CTR*LENGTH(VSDARRAY))+LENGTH(VSDBLOCK);       0380 00599000
         LR    @10,FMT1CTR                                         0380 00600000
         MH    @10,@CH01471                                        0380 00601000
         AL    @10,@CF00506                                        0380 00602000
         ST    @10,VSDSIZE                                         0380 00603000
*       CALL IDCSAGP0(GDTTBL,VSDSIZE,VSDPTR,VS3POOL,SETZERO);/*    0381 00604000
*                                                            @Z40LB35*/ 00605000
         L     @10,@PC00001                                        0381 00606000
         ST    @10,@AL00001                                        0381 00607000
         LA    @08,VSDSIZE                                         0381 00608000
         ST    @08,@AL00001+4                                      0381 00609000
         L     @08,@PC00001+8                                      0381 00610000
         L     @04,VS3LISTP(,@08)                                  0381 00611000
         ST    @04,@AL00001+8                                      0381 00612000
         LA    @08,VS3POOL(,@08)                                   0381 00613000
         ST    @08,@AL00001+12                                     0381 00614000
         LA    @08,SETZERO                                         0381 00615000
         ST    @08,@AL00001+16                                     0381 00616000
         MVI   @AL00001+16,X'80'                                   0381 00617000
         L     @15,GDTGPL(,@10)                                    0381 00618000
         LA    @01,@AL00001                                        0381 00619000
         BALR  @14,@15                                             0381 00620000
*       RESPECIFY                                                  0382 00621000
*         RTNREG RSTD;                                             0382 00622000
*       TESTRC=RTNREG;                                             0383 00623000
         STH   RTNREG,TESTRC                                       0383 00624000
*       RESPECIFY                                                  0384 00625000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 00626000
*                                                                  0384 00627000
*       /*************************************************************/ 00628000
*       /*                                                           */ 00629000
*       /* IF UGPOOL FAILED, BUILD DARGLIST TO ISSUE         @Z40LB35*/ 00630000
*       /* MESSAGE "IDC2011I FUNCTION CANNOT BE              @Z40LB35*/ 00631000
*       /* EXECUTED. INSUFFICIENT MAIN STOARAGE"             @Z40LB35*/ 00632000
*       /*                                                           */ 00633000
*       /*************************************************************/ 00634000
*                                                                  0385 00635000
*       IF TESTRC^=0 THEN           /*                       @Z40LB35*/ 00636000
         LH    @10,TESTRC                                          0385 00637000
         LTR   @10,@10                                             0385 00638000
         BZ    @RF00385                                            0385 00639000
*         DO;                       /*                       @Z40LB35*/ 00640000
*           DARGLIST=''B;           /*                       @Z40LB35*/ 00641000
         L     @10,DDSTRU                                          0387 00642000
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0387 00643000
*           DARGSMOD=IDCTSUV0;      /*                       @Z40LB35*/ 00644000
         MVC   DARGSMOD(3,@10),@CC01119                            0388 00645000
*           DARGSENT=MSG2011A;      /*                       @Z40LB35*/ 00646000
         MVI   DARGSENT(@10),X'0C'                                 0389 00647000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB35*/ 00648000
         L     @10,@PC00001                                        0390 00649000
         ST    @10,@AL00001                                        0390 00650000
         LA    @08,@CF00115                                        0390 00651000
         ST    @08,@AL00001+4                                      0390 00652000
         LA    @08,DDSTRU                                          0390 00653000
         ST    @08,@AL00001+8                                      0390 00654000
         MVI   @AL00001+8,X'80'                                    0390 00655000
         L     @15,GDTPRT(,@10)                                    0390 00656000
         LA    @01,@AL00001                                        0390 00657000
         BALR  @14,@15                                             0390 00658000
*         END;                      /*                       @Z40LB35*/ 00659000
*     END;                          /*                       @Z40LB35*/ 00660000
*                                                                  0392 00661000
@RF00385 DS    0H                                                  0393 00662000
*   /*****************************************************************/ 00663000
*   /*                                                               */ 00664000
*   /* CONTROL IS RETURNED TO CALLER WITH THE CODE           @Z40LB35*/ 00665000
*   /* SAVED IN TESTRC.                                      @Z40LB35*/ 00666000
*   /*                                                               */ 00667000
*   /*****************************************************************/ 00668000
*                                                                  0393 00669000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 00670000
@RF00378 LH    @15,TESTRC                                          0393 00671000
         L     @14,@SA00003                                        0393 00672000
         LM    @00,@04,@SA00003+8                                  0393 00673000
         LM    @06,@08,@SA00003+28                                 0393 00674000
         LM    @10,@12,@SA00003+40                                 0393 00675000
         BR    @14                                                 0393 00676000
*   END GETBLK;                     /*                       @Z40LB35*/ 00677000
*                                                                  0395 00678000
*/********************************************************************/ 00679000
*/*                                                          @Z40LB35*/ 00680000
*/* PROCEDURE NAME - TRKREAD                                 @Z40LB35*/ 00681000
*/*                                                          @Z40LB35*/ 00682000
*/* FUNCTION -  THIS PROCEDURE READS THE NEXT TRACK FROM     @Z40LB35*/ 00683000
*/*             THE VTOC OR RETURNS AN EOF CONDITION IF      @Z40LB35*/ 00684000
*/*             THE VTOC IS ENTIRELY PROCESSED.              @Z40LB35*/ 00685000
*/*                                                          @Z40LB35*/ 00686000
*/* INPUT -     DS1DSNAM FROM THE IECSDSL1 FMT 1 DSCB        @Z40LB35*/ 00687000
*/*             BEGCCHH FROM IOBLOCK                         @Z40LB35*/ 00688000
*/*             ENDCCHH FROM IOBLOCK                         @Z40LB35*/ 00689000
*/*             LASTCCHH FROM IOBLOCK                        @Z40LB35*/ 00690000
*/*             HH FROM IOBLOCK                              @Z40LB35*/ 00691000
*/*                                                          @Z40LB35*/ 00692000
*/* OUTPUT -    HH OF IOBLOCK                                @Z40LB35*/ 00693000
*/*             CC OF IOBLOCK                                @Z40LB35*/ 00694000
*/*             LASTCCHH OF IOBLOCK                          @Z40LB35*/ 00695000
*/*             EXGCTLBK OF EXGAGL                           @Z40LB35*/ 00696000
*/*             EXGCCHH2 OF EXGAGL                           @Z40LB35*/ 00697000
*/*             EXGRECNO OF EXGAGL                           @Z40LB35*/ 00698000
*/*             EXGDATAP OF EXGAGL                           @Z40LB35*/ 00699000
*/*             EXGKEYLN OF EXGAGL                           @Z40LB35*/ 00700000
*/*             EXGDATAL OF EXGAGL                           @Z40LB35*/ 00701000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 00702000
*/*                           4, ERROR IN UEXCP              @Z40LB35*/ 00703000
*/*                           8, EOF - END OF FILE           @Z40LB35*/ 00704000
*/*                                                          @Z40LB35*/ 00705000
*/********************************************************************/ 00706000
*                                                                  0395 00707000
*                                   /*                       @Z40LB35*/ 00708000
*TRKREAD:                                                          0395 00709000
*   PROC;                           /*                       @Z40LB35*/ 00710000
*                                                                  0395 00711000
TRKREAD  STM   @14,@12,@SA00004                                    0395 00712000
*   /*****************************************************************/ 00713000
*   /*                                                               */ 00714000
*   /* SET UP TRACE POINT 'VSTK' IN TRACE TABLE              @Z40LB35*/ 00715000
*   /*                                                               */ 00716000
*   /*****************************************************************/ 00717000
*                                                                  0396 00718000
*   OLDERID2=NEWERID2;                                             0396 00719000
         L     @10,@PC00001                                        0396 00720000
         L     @10,GDTTR2(,@10)                                    0396 00721000
         MVC   @TS00001(95),NEWERID2(@10)                          0396 00722000
         MVC   OLDERID2(95,@10),@TS00001                           0396 00723000
*   NEWID2='VSTK';                  /*                       @Z40LB35*/ 00724000
         MVC   NEWID2(4,@10),@CC01314                              0397 00725000
*   GETPTR=ADDR(EXGPARM1);          /*                       @Z40LB35*/ 00726000
*                                                                  0398 00727000
         LA    GETPTR,EXGPARM1                                     0398 00728000
*   /*****************************************************************/ 00729000
*   /*                                                               */ 00730000
*   /* IF LAST CCHHR IS ZERO, THE EXGAGL IS                  @Z40LB35*/ 00731000
*   /* INITIALIZED TO READ FIRST TRACK.                      @Z40LB35*/ 00732000
*   /*                                                               */ 00733000
*   /*****************************************************************/ 00734000
*                                                                  0399 00735000
*   IF LASTCCHH=0 THEN              /*                       @Z40LB35*/ 00736000
         L     @10,LASTCCHH                                        0399 00737000
         LTR   @10,@10                                             0399 00738000
         BNZ   @RF00399                                            0399 00739000
*     DO;                           /*                       @Z40LB35*/ 00740000
*       LASTCCHH=BEGCCHH;           /*                       @Z40LB35*/ 00741000
         L     @10,BEGCCHH                                         0401 00742000
         ST    @10,LASTCCHH                                        0401 00743000
*       LR=1;                       /*                       @Z40LB35*/ 00744000
         MVI   LR,X'01'                                            0402 00745000
*       EXGARG=''B;                 /*                       @Z40LB35*/ 00746000
         XC    EXGARG(32,GETPTR),EXGARG(GETPTR)                    0403 00747000
*       EXGCTLBK=IOXPTR;            /*                       @Z40LB35*/ 00748000
         L     @10,IOXPTR                                          0404 00749000
         ST    @10,EXGCTLBK(,GETPTR)                               0404 00750000
*       EXGCCHH2=ADDR(LASTCCHH);    /*                       @Z40LB35*/ 00751000
         LA    @10,LASTCCHH                                        0405 00752000
         ST    @10,EXGCCHH2(,GETPTR)                               0405 00753000
*       EXGRECNO=VTOCTRK;           /*                       @Z40LB35*/ 00754000
         LH    @10,VTOCTRK                                         0406 00755000
         ST    @10,EXGRECNO(,GETPTR)                               0406 00756000
*       EXGDATAP=TRACKPTR;          /*                       @Z40LB35*/ 00757000
         L     @10,TRACKPTR                                        0407 00758000
         ST    @10,EXGDATAP(,GETPTR)                               0407 00759000
*       EXGKEYLN=LENGTH(DS1DSNAM);  /*                       @Z40LB35*/ 00760000
         MVI   EXGKEYLN(GETPTR),X'2C'                              0408 00761000
*       EXGDATAL=LENGTH(IECSDSL1)-LENGTH(DS1DSNAM);/*        @Z40LB35*/ 00762000
         MVC   EXGDATAL(2,GETPTR),@CH01243                         0409 00763000
*     END;                          /*                       @Z40LB35*/ 00764000
*                                                                  0410 00765000
*   /*****************************************************************/ 00766000
*   /*                                                               */ 00767000
*   /* HERE THE TEST IS MADE TO DETERMINE IF THE             @Z40LB35*/ 00768000
*   /* NEXT TRACK TO READ IS BEYOND THE VTOC.                @Z40LB35*/ 00769000
*   /* IF THE NEXT TRACK TO READ IS BEYOND THE               @Z40LB35*/ 00770000
*   /* VTOC EXTENTS, THEN THE END-OF-FILE IS SET.            @Z40LB35*/ 00771000
*   /*                                                               */ 00772000
*   /*****************************************************************/ 00773000
*                                                                  0411 00774000
*   IF LASTCCHH>ENDCCHH THEN        /*                       @Z40LB35*/ 00775000
@RF00399 L     @10,LASTCCHH                                        0411 00776000
         ICM   @07,15,ENDCCHH                                      0411 00777000
         CR    @10,@07                                             0411 00778000
         BNH   @RF00411                                            0411 00779000
*     TESTRC=EOF;                   /*                       @Z40LB35*/ 00780000
*                                                                  0412 00781000
         LH    @10,EOF                                             0412 00782000
         STH   @10,TESTRC                                          0412 00783000
*   /*****************************************************************/ 00784000
*   /*                                                               */ 00785000
*   /* IF NOT EOF, THE NEXT TRACK IS READ.                   @Z40LB35*/ 00786000
*   /*                                                               */ 00787000
*   /*****************************************************************/ 00788000
*                                                                  0413 00789000
*   ELSE                            /*                       @Z40LB35*/ 00790000
*     DO;                           /*                       @Z40LB35*/ 00791000
         B     @RC00411                                            0413 00792000
@RF00411 DS    0H                                                  0414 00793000
*       CALL IDCIO050(GDTTBL,GET,EXGARG);/*                  @Z40LB35*/ 00794000
         L     @10,@PC00001                                        0414 00795000
         ST    @10,@AL00001                                        0414 00796000
         LA    @07,GET                                             0414 00797000
         ST    @07,@AL00001+4                                      0414 00798000
         ST    GETPTR,@AL00001+8                                   0414 00799000
         MVI   @AL00001+8,X'80'                                    0414 00800000
         L     @15,GDTEXP(,@10)                                    0414 00801000
         LA    @01,@AL00001                                        0414 00802000
         BALR  @14,@15                                             0414 00803000
*       RESPECIFY                                                  0415 00804000
*         RTNREG RSTD;                                             0415 00805000
*       TESTRC=RTNREG;                                             0416 00806000
         STH   RTNREG,TESTRC                                       0416 00807000
*       RESPECIFY                                                  0417 00808000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 00809000
*                                                                  0417 00810000
*       /*************************************************************/ 00811000
*       /*                                                           */ 00812000
*       /* TRACK IS SET UP TO BE READ FOR NEXT CALL          @Z40LB35*/ 00813000
*       /*                                                           */ 00814000
*       /*************************************************************/ 00815000
*                                                                  0418 00816000
*       DO;                         /*                       @Z40LB35*/ 00817000
*         IF LHH=MAXTRKS THEN       /*                       @Z40LB35*/ 00818000
         CLC   LHH(2),MAXTRKS                                      0419 00819000
         BNE   @RF00419                                            0419 00820000
*           DO;                     /*                       @Z40LB35*/ 00821000
*             LHH=0;                /*                       @Z40LB35*/ 00822000
         SLR   @10,@10                                             0421 00823000
         STH   @10,LHH                                             0421 00824000
*             LCC=LCC+1;            /*                       @Z40LB35*/ 00825000
         LH    @10,LCC                                             0422 00826000
         LA    @10,1(,@10)                                         0422 00827000
         STH   @10,LCC                                             0422 00828000
*           END;                    /*                       @Z40LB35*/ 00829000
*         ELSE                      /*                       @Z40LB35*/ 00830000
*           LHH=LHH+1;              /*                       @Z40LB35*/ 00831000
         B     @RC00419                                            0424 00832000
@RF00419 LH    @10,LHH                                             0424 00833000
         LA    @10,1(,@10)                                         0424 00834000
         STH   @10,LHH                                             0424 00835000
*       END;                        /*                       @Z40LB35*/ 00836000
@RC00419 DS    0H                                                  0426 00837000
*     END;                          /*                       @Z40LB35*/ 00838000
*                                                                  0426 00839000
*   /*****************************************************************/ 00840000
*   /*                                                               */ 00841000
*   /* IF LAST CCHHR IS NOT ZERO, THEN THE NEXT              @Z40LB35*/ 00842000
*   /* CONTROL IS RETURNED TO CALLER WITH CODE               @Z40LB35*/ 00843000
*   /* THAT WAS SAVED IN TESTRC.                             @Z40LB35*/ 00844000
*   /*                                                               */ 00845000
*   /*****************************************************************/ 00846000
*                                                                  0427 00847000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 00848000
@RC00411 LH    @15,TESTRC                                          0427 00849000
         L     @14,@SA00004                                        0427 00850000
         LM    @00,@12,@SA00004+8                                  0427 00851000
         BR    @14                                                 0427 00852000
*   END TRKREAD;                    /*                       @Z40LB35*/ 00853000
*                                                                  0429 00854000
*/********************************************************************/ 00855000
*/*                                                          @Z40LB35*/ 00856000
*/* PROCEDURE NAME - OPENVTOC                                @Z40LB35*/ 00857000
*/*                                                          @Z40LB35*/ 00858000
*/* FUNCTION -  THIS PROCEDURE PERFORMS THE OPEN OF THE      @Z40LB35*/ 00859000
*/*             VOLUME VTOC AND ISSUES URESERVE ON VOL VTOC  @Z40LB35*/ 00860000
*/*                                                          @Z40LB35*/ 00861000
*/* INPUT -     VSD3DD OF THE VS3AGL                         @Z40LB35*/ 00862000
*/*             VS3VOL OF THE VS3AGL                         @Z40LB35*/ 00863000
*/*                                                          @Z40LB35*/ 00864000
*/* OUTPUT -    EXODDN OF EXOARG                             @Z40LB35*/ 00865000
*/*             EXOVSN OF EXOARG                             @Z40LB35*/ 00866000
*/*             EXOCTLBK OF EXOARG                           @Z40LB35*/ 00867000
*/*             EXOREAD OF EXOARG                            @Z40LB35*/ 00868000
*/*             EXOVTOC OF EXOARG                            @Z40LB35*/ 00869000
*/*             EXOEXT OF EXOARG                             @Z40LB35*/ 00870000
*/*             UNITABL                                      @Z40LB35*/ 00871000
*/*             IOXPTR                                       @Z40LB35*/ 00872000
*/*             RLENGTH                                      @Z40LB35*/ 00873000
*/*             RVOLSER                                      @Z40LB35*/ 00874000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 00875000
*/*                           4, ERROR IN UEXCP (OPEN)       @Z40LB35*/ 00876000
*/*                           4, ERROR IN USYSINFO           @Z40LB35*/ 00877000
*/*                                                          @Z40LB35*/ 00878000
*/********************************************************************/ 00879000
*                                                                  0429 00880000
*                                   /*                       @Z40LB35*/ 00881000
*OPENVTOC:                                                         0429 00882000
*   PROC;                           /*                       @Z40LB35*/ 00883000
*                                                                  0429 00884000
OPENVTOC STM   @14,@12,@SA00005                                    0429 00885000
*   /*****************************************************************/ 00886000
*   /*                                                               */ 00887000
*   /* LOCAL DECLARES                                        @Z40LB35*/ 00888000
*   /*                                                               */ 00889000
*   /*****************************************************************/ 00890000
*                                                                  0430 00891000
*   DCL                                                            0430 00892000
*     UNITABLP PTR(31) BDY(WORD);   /* PTR UNITABL - USYSINFO      0430 00893000
*                                                            @Z40LB35*/ 00894000
*                                                                  0431 00895000
*   /*****************************************************************/ 00896000
*   /*                                                               */ 00897000
*   /* SET UP TRACE POINT 'VSOP' IN TRACE TABLE              @Z40LB35*/ 00898000
*   /*                                                               */ 00899000
*   /*****************************************************************/ 00900000
*                                                                  0431 00901000
*   OLDERID2=NEWERID2;                                             0431 00902000
         L     @10,@PC00001                                        0431 00903000
         L     @03,GDTTR2(,@10)                                    0431 00904000
         MVC   @TS00001(95),NEWERID2(@03)                          0431 00905000
         MVC   OLDERID2(95,@03),@TS00001                           0431 00906000
*   NEWID2='VSOP';                  /*                       @Z40LB35*/ 00907000
*                                                                  0432 00908000
         MVC   NEWID2(4,@03),@CC01319                              0432 00909000
*   /*****************************************************************/ 00910000
*   /*                                                               */ 00911000
*   /* HERE THE EXOARG IS INITIALIZED TO OPEN                @Z40LB35*/ 00912000
*   /* THE VOLUME VTOC. THE VOLSER IS PASSED                 @Z40LB35*/ 00913000
*   /* AND THE READ BIT IS SET BECAUSE NO UP-                @Z40LB35*/ 00914000
*   /* DATING IS DONE.                                       @Z40LB35*/ 00915000
*   /* CALL OPENVTOC TO PREPARE FOR I/O TO VTOC              @Z40LB35*/ 00916000
*   /*                                                               */ 00917000
*   /*****************************************************************/ 00918000
*                                                                  0433 00919000
*   EXOARG=''B;                     /*                       @Z40LB35*/ 00920000
         LA    @03,EXOPARM                                         0433 00921000
         XC    EXOARG(34,@03),EXOARG(@03)                          0433 00922000
*   IOXPTR=''B;                     /*                       @Z40LB35*/ 00923000
         SLR   @15,@15                                             0434 00924000
         ST    @15,IOXPTR                                          0434 00925000
*   EXODDN=ADDR(VS3DD);             /*                       @Z40LB35*/ 00926000
         L     @15,@PC00001+8                                      0435 00927000
         LA    @14,VS3DD(,@15)                                     0435 00928000
         ST    @14,EXODDN(,@03)                                    0435 00929000
*   EXOVSN=ADDR(VS3VOL);            /*                       @Z40LB35*/ 00930000
         LA    @15,VS3VOL(,@15)                                    0436 00931000
         ST    @15,EXOVSN(,@03)                                    0436 00932000
*   EXOCTLBK=ADDR(IOXPTR);          /*                       @Z40LB35*/ 00933000
         LA    @15,IOXPTR                                          0437 00934000
         ST    @15,EXOCTLBK(,@03)                                  0437 00935000
*   EXOREAD=ON;                     /*                       @Z40LB35*/ 00936000
         OI    EXOREAD(@03),B'10000000'                            0438 00937000
*   EXOVTOC=ON;                     /*                       @Z40LB35*/ 00938000
         OI    EXOVTOC(@03),B'00001000'                            0439 00939000
*   IOBLOCK=''B;                    /*                       @Z40LB35*/ 00940000
         XC    IOBLOCK(28),IOBLOCK                                 0440 00941000
*   EXOEXT=ADDR(IOBLOCK);           /*                       @Z40LB35*/ 00942000
         LA    @15,IOBLOCK                                         0441 00943000
         ST    @15,EXOEXT(,@03)                                    0441 00944000
*   CALL IDCIO050(GDTTBL,OPEN,EXOARG);/*                     @Z40LB35*/ 00945000
         ST    @10,@AL00001                                        0442 00946000
         LA    @15,OPEN                                            0442 00947000
         ST    @15,@AL00001+4                                      0442 00948000
         ST    @03,@AL00001+8                                      0442 00949000
         MVI   @AL00001+8,X'80'                                    0442 00950000
         L     @15,GDTEXP(,@10)                                    0442 00951000
         LA    @01,@AL00001                                        0442 00952000
         BALR  @14,@15                                             0442 00953000
*   RESPECIFY                                                      0443 00954000
*     RTNREG RSTD;                                                 0443 00955000
*   TESTRC=RTNREG;                                                 0444 00956000
         STH   RTNREG,TESTRC                                       0444 00957000
*   RESPECIFY                                                      0445 00958000
*     RTNREG UNRSTD;                /*                       @Z40LB35*/ 00959000
*                                                                  0445 00960000
*   /*****************************************************************/ 00961000
*   /*                                                               */ 00962000
*   /* PROVIDING THE OPEN WAS SUCCESSFUL, THE                @Z40LB35*/ 00963000
*   /* USYSINFO ROUTINE IS USED TO OBTAIN THE                @Z40LB35*/ 00964000
*   /* UCB ADDRESS WHICH IS NEEDED TO RESERVE                @Z40LB35*/ 00965000
*   /* THE VOLUME VIA THE URESERVE MACRO CALL.               @Z40LB35*/ 00966000
*   /*                                                               */ 00967000
*   /*****************************************************************/ 00968000
*                                                                  0446 00969000
*   IF TESTRC=0&VS3UCBP=NULLPTR THEN/*                       @Z40LB35*/ 00970000
         LH    @10,TESTRC                                          0446 00971000
         SLR   @03,@03                                             0446 00972000
         CR    @10,@03                                             0446 00973000
         BNE   @RF00446                                            0446 00974000
         L     @10,@PC00001+8                                      0446 00975000
         C     @03,VS3UCBP(,@10)                                   0446 00976000
         BNE   @RF00446                                            0446 00977000
*     DO;                           /*                       @Z40LB35*/ 00978000
*       UNITABLP=ADDR(UNITABL);     /*                       @Z40LB35*/ 00979000
         LA    @03,RTNUNIT                                         0448 00980000
         ST    @03,UNITABLP                                        0448 00981000
*       UNITABL=''B;                /*                       @Z40LB35*/ 00982000
         XC    UNITABL(11,@03),UNITABL(@03)                        0449 00983000
*       CALL IDCSASI0(GDTTBL,UNIT,UNITABLP,VS3DD);/*         @Z40LB35*/ 00984000
         L     @03,@PC00001                                        0450 00985000
         ST    @03,@AL00001                                        0450 00986000
         LA    @15,UNIT                                            0450 00987000
         ST    @15,@AL00001+4                                      0450 00988000
         LA    @15,UNITABLP                                        0450 00989000
         ST    @15,@AL00001+8                                      0450 00990000
         LA    @10,VS3DD(,@10)                                     0450 00991000
         ST    @10,@AL00001+12                                     0450 00992000
         MVI   @AL00001+12,X'80'                                   0450 00993000
         L     @15,GDTSFO(,@03)                                    0450 00994000
         LA    @01,@AL00001                                        0450 00995000
         BALR  @14,@15                                             0450 00996000
*       RESPECIFY                                                  0451 00997000
*         RTNREG RSTD;                                             0451 00998000
*       TESTRC=RTNREG;                                             0452 00999000
         STH   RTNREG,TESTRC                                       0452 01000000
*       RESPECIFY                                                  0453 01001000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 01002000
*     END;                          /*                       @Z40LB35*/ 01003000
*   ELSE                            /*                       @Z40LB35*/ 01004000
*     UNITUCB=VS3UCBP;              /*                       @Z40LB35*/ 01005000
*                                                                  0455 01006000
         B     @RC00446                                            0455 01007000
@RF00446 LA    @10,RTNUNIT                                         0455 01008000
         L     @03,@PC00001+8                                      0455 01009000
         L     @03,VS3UCBP(,@03)                                   0455 01010000
         ST    @03,UNITUCB(,@10)                                   0455 01011000
*   /*****************************************************************/ 01012000
*   /*                                                               */ 01013000
*   /* PROVIDING THE OPERATIONS THUS FAR ARE                 @Z40LB35*/ 01014000
*   /* SUCCESSFUL, THE URESERVE IS ISSUED.                   @Z40LB35*/ 01015000
*   /* THE URESERVE IS BEING USED TO ENSURE THE              @Z40LB35*/ 01016000
*   /* VTOC INFORMATION DOES NOT CHANGE WHILE                @Z40LB35*/ 01017000
*   /* THE VTOC IS BEING PROCESSED.                          @Z40LB35*/ 01018000
*   /*                                                               */ 01019000
*   /*****************************************************************/ 01020000
*                                                                  0456 01021000
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/ 01022000
@RC00446 LH    @10,TESTRC                                          0456 01023000
         LTR   @10,@10                                             0456 01024000
         BNZ   @RF00456                                            0456 01025000
*     DO;                           /*                       @Z40LB35*/ 01026000
*       ENQ=ON;                     /*                       @Z40LB35*/ 01027000
         OI    ENQ,B'10000000'                                     0458 01028000
*       RLENGTH=LENGTH(RVOLSER);    /*                       @Z40LB35*/ 01029000
         MVI   RLENGTH,X'06'                                       0459 01030000
*       RVOLSER=VS3VOL;             /*                       @Z40LB35*/ 01031000
         L     @10,@PC00001+8                                      0460 01032000
         MVC   RVOLSER(6),VS3VOL(@10)                              0460 01033000
*       CALL IDCSARV0(GDTTBL,SHR,WAIT,UNITUCB,QNAME,RNAME);        0461 01034000
         L     @10,@PC00001                                        0461 01035000
         ST    @10,@AL00001                                        0461 01036000
         LA    @03,SHR                                             0461 01037000
         ST    @03,@AL00001+4                                      0461 01038000
         LA    @03,WAIT                                            0461 01039000
         ST    @03,@AL00001+8                                      0461 01040000
         LA    @03,RTNUNIT                                         0461 01041000
         ST    @03,@AL00001+12                                     0461 01042000
         LA    @03,QNAME                                           0461 01043000
         ST    @03,@AL00001+16                                     0461 01044000
         LA    @03,RNAME                                           0461 01045000
         ST    @03,@AL00001+20                                     0461 01046000
         MVI   @AL00001+20,X'80'                                   0461 01047000
         L     @15,GDTRSV(,@10)                                    0461 01048000
         LA    @01,@AL00001                                        0461 01049000
         BALR  @14,@15                                             0461 01050000
*     END;                          /*                       @Z40LB35*/ 01051000
*   ELSE                            /*                       @Z40LB35*/ 01052000
*                                                                  0463 01053000
*     /***************************************************************/ 01054000
*     /*                                                             */ 01055000
*     /* IF THE RESERVE WAS NOT ISSUED, INITIALIZE THE       @Z40LB35*/ 01056000
*     /* ENQ BIT OFF.                                        @Z40LB35*/ 01057000
*     /*                                                             */ 01058000
*     /***************************************************************/ 01059000
*                                                                  0463 01060000
*     ENQ=OFF;                      /*                       @Z40LB35*/ 01061000
*                                                                  0463 01062000
         B     @RC00456                                            0463 01063000
@RF00456 NI    ENQ,B'01111111'                                     0463 01064000
*   /*****************************************************************/ 01065000
*   /*                                                               */ 01066000
*   /* CONTROL IS RETURNED TO INITIAL PROC WITH              @Z40LB35*/ 01067000
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/ 01068000
*   /*                                                               */ 01069000
*   /*****************************************************************/ 01070000
*                                                                  0464 01071000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 01072000
@RC00456 LH    @15,TESTRC                                          0464 01073000
         L     @14,@SA00005                                        0464 01074000
         LM    @00,@12,@SA00005+8                                  0464 01075000
         BR    @14                                                 0464 01076000
*   END OPENVTOC;                   /*                       @Z40LB35*/ 01077000
*                                                                  0466 01078000
*/********************************************************************/ 01079000
*/*                                                          @Z40LB35*/ 01080000
*/* PROCEDURE NAME - SELECTOR                                @Z40LB35*/ 01081000
*/*                                                          @Z40LB35*/ 01082000
*/* FUNCTION -  THIS PROCEDURE IS THE CONTROLLING ROUTINE    @Z40LB35*/ 01083000
*/*             FOR THE DATA SET SELECTION.  IT CALLS        @Z40LB35*/ 01084000
*/*             SUB PROCEDURES GETFMT1, STATUS, AND USAGE.   @Z40LB35*/ 01085000
*/*                                                          @Z40LB35*/ 01086000
*/* INPUT -     VS3STAT OF THE VS3AGL                        @Z40LB35*/ 01087000
*/*             VS3USAGE OF THE VS3AGL                       @Z40LB35*/ 01088000
*/*                                                          @Z40LB35*/ 01089000
*/* OUTPUT -    VSDARRAY OF VSDBLOCK                         @Z40LB35*/ 01090000
*/*             EXOVSN OF EXOARG                             @Z40LB35*/ 01091000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 01092000
*/*                           4, ERROR IN CRITERIA           @Z40LB35*/ 01093000
*/*                           4, ERROR IN USAGE              @Z40LB35*/ 01094000
*/*                           4, ERROR IN STATUS             @Z40LB35*/ 01095000
*/*                           8, MESSAGE SENT ON CONFLICTS   @Z40LB35*/ 01096000
*/*                                                          @Z40LB35*/ 01097000
*/********************************************************************/ 01098000
*                                                                  0466 01099000
*                                   /*                       @Z40LB35*/ 01100000
*SELECTOR:                                                         0466 01101000
*   PROC;                           /*                       @Z40LB35*/ 01102000
*                                                                  0466 01103000
SELECTOR STM   @14,@12,@SA00006                                    0466 01104000
*   /*****************************************************************/ 01105000
*   /*                                                               */ 01106000
*   /* LOCAL DECLARES                                        @Z40LB35*/ 01107000
*   /*                                                               */ 01108000
*   /*****************************************************************/ 01109000
*                                                                  0467 01110000
*   DCL                                                            0467 01111000
*     FMT1S FIXED(31);              /* CTR MAX NUM POSSIBILE @Z40LB35*/ 01112000
*   DCL                                                            0468 01113000
*     LSPACE FIXED(31) CONSTANT(78);/*                       @Z40LB35   01114000
*                                      EQUATE FOR LSPACE SVC @Z40LB35*/ 01115000
*   DCL                                                            0469 01116000
*     LSPACESZ FIXED(31) CONSTANT(36);/*                     @Z40LB35   01117000
*                                      EQUATE LSPACE BUF SIZE      0469 01118000
*                                                            @Z40LB35*/ 01119000
*   DCL                                                            0470 01120000
*     UCBREG REGISTER(0);           /* ASGN REG 0 FOR LSPACE @Z40LB35*/ 01121000
*   DCL                                                            0471 01122000
*     LSPACEBF REGISTER(1);         /* ASGN REG 1 FOR LSPACE @Z40LB35*/ 01123000
*                                                                  0472 01124000
*   /*****************************************************************/ 01125000
*   /*                                                               */ 01126000
*   /* SET UP TRACE POINT 'VSSR' IN TRACE TABLE              @Z40LB35*/ 01127000
*   /*                                                               */ 01128000
*   /*****************************************************************/ 01129000
*                                                                  0472 01130000
*   OLDERID2=NEWERID2;                                             0472 01131000
         L     @07,@PC00001                                        0472 01132000
         L     @07,GDTTR2(,@07)                                    0472 01133000
         MVC   @TS00001(95),NEWERID2(@07)                          0472 01134000
         MVC   OLDERID2(95,@07),@TS00001                           0472 01135000
*   NEWID2='VSSR';                  /*                       @Z40LB35*/ 01136000
*                                                                  0473 01137000
         MVC   NEWID2(4,@07),@CC01330                              0473 01138000
*   /*****************************************************************/ 01139000
*   /*                                                               */ 01140000
*   /* INITIALIZE MSG SENT BIT OFF                           @Z40LB35*/ 01141000
*   /* AND INITIALIZE THE FIELDS VSDELEM AND ELEMENT         @Z40LB35*/ 01142000
*   /* ALSO INITIALIZED IS THE VTOC CCHHR.                   @Z40LB35*/ 01143000
*   /*                                                               */ 01144000
*   /*****************************************************************/ 01145000
*                                                                  0474 01146000
*   MSGSENT=OFF;                    /*                       @Z40LB35*/ 01147000
         NI    MSGSENT,B'01111111'                                 0474 01148000
*   LOCATESW=OFF;                   /*                       @Z40LB35*/ 01149000
         NI    LOCATESW,B'01111111'                                0475 01150000
*   VSDELEM=0;                      /*                       @Z40LB35*/ 01151000
         L     @07,@PC00001+8                                      0476 01152000
         L     @07,VS3LISTP(,@07)                                  0476 01153000
         L     @07,VSDPTR(,@07)                                    0476 01154000
         SLR   @15,@15                                             0476 01155000
         ST    @15,VSDELEM(,@07)                                   0476 01156000
*   ELEMENT=1;                      /*                       @Z40LB35*/ 01157000
         LA    ELEMENT,1                                           0477 01158000
*   FMT1S=0;                        /*                       @Z40LB35*/ 01159000
         SLR   FMT1S,FMT1S                                         0478 01160000
*   LASTCCHH=BEGCCHH;               /*                       @Z40LB35*/ 01161000
         L     @07,BEGCCHH                                         0479 01162000
         ST    @07,LASTCCHH                                        0479 01163000
*   LR=''B;                         /*                       @Z40LB35*/ 01164000
*                                                                  0480 01165000
         SLR   @07,@07                                             0480 01166000
         STC   @07,LR                                              0480 01167000
*   /*****************************************************************/ 01168000
*   /*                                                               */ 01169000
*   /* HERE THE LOOP WILL OCCUR UNTIL ALL FMT1               @Z40LB35*/ 01170000
*   /* DSCBS HAVE BEEN PROCESSED                             @Z40LB35*/ 01171000
*   /*                                                               */ 01172000
*   /*****************************************************************/ 01173000
*                                                                  0481 01174000
*   DO WHILE TESTRC=0&FMT1S<FMT1CTR;/*                       @Z40LB35*/ 01175000
         B     @DE00481                                            0481 01176000
@DL00481 DS    0H                                                  0482 01177000
*     CALL GETFMT1;                 /*                       @Z40LB35*/ 01178000
         BAL   @14,GETFMT1                                         0482 01179000
*     RESPECIFY                                                    0483 01180000
*       RTNREG RSTD;                                               0483 01181000
*     TESTRC=RTNREG;                                               0484 01182000
         STH   RTNREG,TESTRC                                       0484 01183000
*     RESPECIFY                                                    0485 01184000
*       RTNREG UNRSTD;              /*                       @Z40LB35*/ 01185000
*                                                                  0485 01186000
*     /***************************************************************/ 01187000
*     /*                                                             */ 01188000
*     /* AFTER THE NEXT FMT1 HAS BEEN READ, IT IS            @Z40LB35*/ 01189000
*     /* PROCESSED BY THE SUBPROCEDURE CRITERIA.             @Z40LB35*/ 01190000
*     /*                                                             */ 01191000
*     /***************************************************************/ 01192000
*                                                                  0486 01193000
*     IF TESTRC=0 THEN              /*                       @Z40LB35*/ 01194000
         LH    @07,TESTRC                                          0486 01195000
         LTR   @07,@07                                             0486 01196000
         BNZ   @RF00486                                            0486 01197000
*       DO;                         /*                       @Z40LB35*/ 01198000
*         FMT1S=FMT1S+1;            /*                       @Z40LB35*/ 01199000
         AL    FMT1S,@CF00219                                      0488 01200000
*         VSDDSN(ELEMENT)=DS1DSNAM; /*                       @Z40LB35*/ 01201000
         LR    @07,ELEMENT                                         0489 01202000
         MH    @07,@CH01471                                        0489 01203000
         L     @15,@PC00001+8                                      0489 01204000
         L     @01,VS3LISTP(,@15)                                  0489 01205000
         L     @01,VSDPTR(,@01)                                    0489 01206000
         ALR   @01,@07                                             0489 01207000
         AL    @01,@CF01484                                        0489 01208000
         MVC   VSDDSN-20(44,@01),DS1DSNAM(F1PTR)                   0489 01209000
*         CALL CRITERIA;            /*                       @Z40LB35*/ 01210000
         BAL   @14,CRITERIA                                        0490 01211000
*         RESPECIFY                                                0491 01212000
*           RTNREG RSTD;                                           0491 01213000
*         TESTRC=RTNREG;                                           0492 01214000
         STH   RTNREG,TESTRC                                       0492 01215000
*         RESPECIFY                                                0493 01216000
*           RTNREG UNRSTD;          /*                       @Z40LB35*/ 01217000
*                                                                  0493 01218000
*         /***********************************************************/ 01219000
*         /*                                                         */ 01220000
*         /* PROVIDING THE DSN MET THE CRITERIA, THE         @Z40LB35*/ 01221000
*         /* POINTERS ARE ADJUSTED TO THE NEXT ELEMENT.      @Z40LB35*/ 01222000
*         /* IF THE SERVICE LISTDSET IS CALLING FOR THE      @Z40LB35*/ 01223000
*         /* STATUS REPORT, IT WILL NEED THE DSN FOR         @Z40LB35*/ 01224000
*         /* THE REPORT EVEN WHEN ULOCATE HAS ISSUED         @Z40LB35*/ 01225000
*         /* AN ERROR MESSAGE.                               @Z40LB35*/ 01226000
*         /*                                                         */ 01227000
*         /***********************************************************/ 01228000
*                                                                  0494 01229000
*         IF TESTRC=0|(TESTRC=MSGCODE&VS3STAT=ON) THEN/*     @Z40LB35*/ 01230000
         LH    @07,TESTRC                                          0494 01231000
         LTR   @07,@07                                             0494 01232000
         BZ    @RT00494                                            0494 01233000
         SLR   @15,@15                                             0494 01234000
         IC    @15,MSGCODE                                         0494 01235000
         CR    @07,@15                                             0494 01236000
         BNE   @RF00494                                            0494 01237000
         L     @07,@PC00001+8                                      0494 01238000
         TM    VS3STAT(@07),B'10000000'                            0494 01239000
         BNO   @RF00494                                            0494 01240000
@RT00494 DS    0H                                                  0495 01241000
*           DO;                     /*                       @Z40LB35*/ 01242000
*                                                                  0495 01243000
*             /*******************************************************/ 01244000
*             /*                                                     */ 01245000
*             /* IF THE LISTDSET SERVICE IS CALLING FOR USAGE        */ 01246000
*             /*                                             @Z40LB35*/ 01247000
*             /* REPORT THE INFOMATION NEEDED IS PROVIDED    @Z40LB35*/ 01248000
*             /* BY USAGE PROCEDURE.                         @Z40LB35*/ 01249000
*             /*                                                     */ 01250000
*             /*******************************************************/ 01251000
*                                                                  0496 01252000
*             IF TESTRC=0&VS3USAGE=ON THEN/*                 @Z40LB35*/ 01253000
         LH    @07,TESTRC                                          0496 01254000
         LTR   @07,@07                                             0496 01255000
         BNZ   @RF00496                                            0496 01256000
         L     @07,@PC00001+8                                      0496 01257000
         TM    VS3USAGE(@07),B'01000000'                           0496 01258000
         BNO   @RF00496                                            0496 01259000
*               DO;                 /*                       @Z40LB35*/ 01260000
*                 CALL USAGE;       /*                       @Z40LB35*/ 01261000
         BAL   @14,USAGE                                           0498 01262000
*                 RESPECIFY                                        0499 01263000
*                   RTNREG RSTD;                                   0499 01264000
*                 TESTRC=RTNREG;                                   0500 01265000
         STH   RTNREG,TESTRC                                       0500 01266000
*                 RESPECIFY                                        0501 01267000
*                   RTNREG UNRSTD;  /*                       @Z40LB35*/ 01268000
*               END;                /*                       @Z40LB35*/ 01269000
*                                                                  0502 01270000
*             /*******************************************************/ 01271000
*             /*                                                     */ 01272000
*             /* IF THE LISTDSET SERVICE IS CALLING FOR STATUS       */ 01273000
*             /*                                             @Z40LB35*/ 01274000
*             /* REPORT THE INFOMATION NEEDED IS PROVIDED    @Z40LB35*/ 01275000
*             /* BY STATUS PROCEDURE.                        @Z40LB35*/ 01276000
*             /*                                                     */ 01277000
*             /*******************************************************/ 01278000
*                                                                  0503 01279000
*             IF VS3STAT=ON THEN    /*                       @Z40LB35*/ 01280000
@RF00496 L     @07,@PC00001+8                                      0503 01281000
         TM    VS3STAT(@07),B'10000000'                            0503 01282000
         BNO   @RF00503                                            0503 01283000
*               DO;                 /*                       @Z40LB35*/ 01284000
*                 CALL STATUS;      /*                       @Z40LB35*/ 01285000
         BAL   @14,STATUS                                          0505 01286000
*                 RESPECIFY                                        0506 01287000
*                   RTNREG RSTD;                                   0506 01288000
*                 TESTRC=RTNREG;                                   0507 01289000
         STH   RTNREG,TESTRC                                       0507 01290000
*                 RESPECIFY                                        0508 01291000
*                   RTNREG UNRSTD;  /*                       @Z40LB35*/ 01292000
*               END;                /*                       @Z40LB35*/ 01293000
*                                                                  0509 01294000
*             /*******************************************************/ 01295000
*             /*                                                     */ 01296000
*             /* IF THE DS STILL MEETS CRITERIA, ADVANCE     @Z40LB35*/ 01297000
*             /* TO NEXT ELEMENT IN VSDBLOCK.                @Z40LB35*/ 01298000
*             /*                                                     */ 01299000
*             /*******************************************************/ 01300000
*                                                                  0510 01301000
*             IF TESTRC^=NOMEET THEN/*                       @Z40LB35*/ 01302000
@RF00503 CLC   TESTRC(2),NOMEET                                    0510 01303000
         BE    @RF00510                                            0510 01304000
*               DO;                 /*                       @Z40LB35*/ 01305000
*                 VSDELEM=VSDELEM+1;/*                       @Z40LB35*/ 01306000
         L     @07,@PC00001+8                                      0512 01307000
         L     @07,VS3LISTP(,@07)                                  0512 01308000
         L     @07,VSDPTR(,@07)                                    0512 01309000
         LA    @15,1                                               0512 01310000
         L     @14,VSDELEM(,@07)                                   0512 01311000
         ALR   @14,@15                                             0512 01312000
         ST    @14,VSDELEM(,@07)                                   0512 01313000
*                 ELEMENT=ELEMENT+1;/*                       @Z40LB35*/ 01314000
         ALR   ELEMENT,@15                                         0513 01315000
*               END;                /*                       @Z40LB35*/ 01316000
*                                                                  0514 01317000
*             /*******************************************************/ 01318000
*             /*                                                     */ 01319000
*             /* ELSE NULL OUT ENTRY                         @Z40LB35*/ 01320000
*             /*                                                     */ 01321000
*             /*******************************************************/ 01322000
*                                                                  0515 01323000
*             ELSE                  /*                       @Z40LB35*/ 01324000
*               VSDARRAY(ELEMENT)=''B;/*                     @Z40LB35*/ 01325000
         B     @RC00510                                            0515 01326000
@RF00510 LR    @07,ELEMENT                                         0515 01327000
         MH    @07,@CH01471                                        0515 01328000
         L     @15,@PC00001+8                                      0515 01329000
         L     @01,VS3LISTP(,@15)                                  0515 01330000
         L     @01,VSDPTR(,@01)                                    0515 01331000
         ALR   @01,@07                                             0515 01332000
         AL    @01,@CF01485                                        0515 01333000
         XC    VSDARRAY-16(80,@01),VSDARRAY-16(@01)                0515 01334000
*           END;                    /*                       @Z40LB35*/ 01335000
*         ELSE                      /*                       @Z40LB35*/ 01336000
*                                                                  0517 01337000
*           /*********************************************************/ 01338000
*           /*                                                       */ 01339000
*           /* IF DSN IS NOT BEING PASSED BACK, THE ELEMENT  @Z40LB35*/ 01340000
*           /* IS ZEROED OUT.                                @Z40LB35*/ 01341000
*           /*                                                       */ 01342000
*           /*********************************************************/ 01343000
*                                                                  0517 01344000
*           VSDARRAY(ELEMENT)=''B;  /*                       @Z40LB35*/ 01345000
*                                                                  0517 01346000
         B     @RC00494                                            0517 01347000
@RF00494 LR    @07,ELEMENT                                         0517 01348000
         MH    @07,@CH01471                                        0517 01349000
         L     @15,@PC00001+8                                      0517 01350000
         L     @01,VS3LISTP(,@15)                                  0517 01351000
         L     @01,VSDPTR(,@01)                                    0517 01352000
         ALR   @01,@07                                             0517 01353000
         AL    @01,@CF01485                                        0517 01354000
         XC    VSDARRAY-16(80,@01),VSDARRAY-16(@01)                0517 01355000
*         /***********************************************************/ 01356000
*         /*                                                         */ 01357000
*         /* IF THE DSN DOES NOT MEET THE CRITERIA           @Z40LB35*/ 01358000
*         /* OR AN ERROR MESSAGE WAS ISSUED, THE             @Z40LB35*/ 01359000
*         /* CODE IS TRANSLATED INTO RCOK.                   @Z40LB35*/ 01360000
*         /*                                                         */ 01361000
*         /***********************************************************/ 01362000
*                                                                  0518 01363000
*         IF TESTRC>4 THEN          /*                       @Z40LB35*/ 01364000
@RC00494 LH    @07,TESTRC                                          0518 01365000
         C     @07,@CF00041                                        0518 01366000
         BNH   @RF00518                                            0518 01367000
*           TESTRC=0;               /*                       @Z40LB35*/ 01368000
         SLR   @07,@07                                             0519 01369000
         STH   @07,TESTRC                                          0519 01370000
*       END;                        /*                       @Z40LB35*/ 01371000
@RF00518 DS    0H                                                  0521 01372000
*   END;                            /*                       @Z40LB35*/ 01373000
*                                                                  0521 01374000
@RF00486 DS    0H                                                  0521 01375000
@DE00481 LH    @07,TESTRC                                          0521 01376000
         LTR   @07,@07                                             0521 01377000
         BNZ   @DC00481                                            0521 01378000
         CR    FMT1S,FMT1CTR                                       0521 01379000
         BL    @DL00481                                            0521 01380000
@DC00481 DS    0H                                                  0522 01381000
*   /*****************************************************************/ 01382000
*   /*                                                               */ 01383000
*   /* ISSUE UDEQ TO FREE UP VTOC                            @Z40LB35*/ 01384000
*   /*                                                               */ 01385000
*   /*****************************************************************/ 01386000
*                                                                  0522 01387000
*   IF ENQ=ON THEN                  /*                       @Z40LB35*/ 01388000
         TM    ENQ,B'10000000'                                     0522 01389000
         BNO   @RF00522                                            0522 01390000
*     DO;                           /*                       @Z40LB35*/ 01391000
*       ENQ=OFF;                    /*                       @Z40LB35*/ 01392000
         NI    ENQ,B'01111111'                                     0524 01393000
*       CALL IDCSADQ0(GDTTBL,QNAME,RNAME);/*                 @Z40LB35*/ 01394000
         L     @10,@PC00001                                        0525 01395000
         ST    @10,@AL00001                                        0525 01396000
         LA    @03,QNAME                                           0525 01397000
         ST    @03,@AL00001+4                                      0525 01398000
         LA    @03,RNAME                                           0525 01399000
         ST    @03,@AL00001+8                                      0525 01400000
         MVI   @AL00001+8,X'80'                                    0525 01401000
         L     @15,GDTDEQ(,@10)                                    0525 01402000
         LA    @01,@AL00001                                        0525 01403000
         BALR  @14,@15                                             0525 01404000
*     END;                          /*                       @Z40LB35*/ 01405000
*                                                                  0526 01406000
*   /*****************************************************************/ 01407000
*   /*                                                               */ 01408000
*   /* IF THE VTOC IS FULLY PROCESSED THE CODE               @Z40LB35*/ 01409000
*   /* IS RESET TO RCOK.                                     @Z40LB35*/ 01410000
*   /*                                                               */ 01411000
*   /*****************************************************************/ 01412000
*                                                                  0527 01413000
*   IF TESTRC=EOF THEN              /*                       @Z40LB35*/ 01414000
@RF00522 CLC   TESTRC(2),EOF                                       0527 01415000
         BNE   @RF00527                                            0527 01416000
*     TESTRC=0;                     /*                       @Z40LB35*/ 01417000
*                                                                  0528 01418000
         SLR   @10,@10                                             0528 01419000
         STH   @10,TESTRC                                          0528 01420000
*   /*****************************************************************/ 01421000
*   /*                                                               */ 01422000
*   /* HERE THE VOLUME SPACE INFORMATION IS RETRIEVED FROM THE VOLUME*/ 01423000
*   /* VTOC VIA THE LSPACE SVC.                              @Z40LB35*/ 01424000
*   /*                                                               */ 01425000
*   /*****************************************************************/ 01426000
*                                                                  0529 01427000
*   IF TESTRC^=4&VS3USAGE=ON THEN   /*                       @Z40LB35*/ 01428000
@RF00527 CLC   TESTRC(2),@CH00041                                  0529 01429000
         BE    @RF00529                                            0529 01430000
         L     @10,@PC00001+8                                      0529 01431000
         TM    VS3USAGE(@10),B'01000000'                           0529 01432000
         BNO   @RF00529                                            0529 01433000
*     DO;                           /*                       @Z40LB35*/ 01434000
*       RESPECIFY                                                  0531 01435000
*        (UCBREG,                                                  0531 01436000
*         LSPACEBF) RSTD;           /*                       @Z40LB35*/ 01437000
*                                                                  0531 01438000
*       /*************************************************************/ 01439000
*       /*                                                           */ 01440000
*       /* THE UGPOOL IS CALLED TO OBTAIN THE LSPACE BUF     @Z40LB35*/ 01441000
*       /*                                                           */ 01442000
*       /*************************************************************/ 01443000
*                                                                  0532 01444000
*       CALL IDCSAGP0(GDTTBL,LSPACESZ,VSDSPACE,VS3POOL,SETZERO);   0532 01445000
         L     @03,@PC00001                                        0532 01446000
         ST    @03,@AL00001                                        0532 01447000
         LA    @15,@CF01327                                        0532 01448000
         ST    @15,@AL00001+4                                      0532 01449000
         L     @15,VS3LISTP(,@10)                                  0532 01450000
         L     @15,VSDPTR(,@15)                                    0532 01451000
         LA    @15,VSDSPACE(,@15)                                  0532 01452000
         ST    @15,@AL00001+8                                      0532 01453000
         LA    @10,VS3POOL(,@10)                                   0532 01454000
         ST    @10,@AL00001+12                                     0532 01455000
         LA    @10,SETZERO                                         0532 01456000
         ST    @10,@AL00001+16                                     0532 01457000
         MVI   @AL00001+16,X'80'                                   0532 01458000
         L     @15,GDTGPL(,@03)                                    0532 01459000
         LA    @01,@AL00001                                        0532 01460000
         BALR  @14,@15                                             0532 01461000
*       RESPECIFY                                                  0533 01462000
*         RTNREG RSTD;                                             0533 01463000
*       TESTRC=RTNREG;                                             0534 01464000
         STH   RTNREG,TESTRC                                       0534 01465000
*       RESPECIFY                                                  0535 01466000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 01467000
*                                                                  0535 01468000
*       /*************************************************************/ 01469000
*       /*                                                           */ 01470000
*       /* IF UGPOOL FAILED, BUILD DARGLIST TO ISSUE         @Z40LB35*/ 01471000
*       /* MESSAGE "IDC2011I FUNCTION CANNOT BE              @Z40LB35*/ 01472000
*       /* EXECUTED. INSUFFICIENT MAIN STOARAGE"             @Z40LB35*/ 01473000
*       /*                                                           */ 01474000
*       /*************************************************************/ 01475000
*                                                                  0536 01476000
*       IF TESTRC^=0 THEN           /*                       @Z40LB35*/ 01477000
         LH    @10,TESTRC                                          0536 01478000
         LTR   @10,@10                                             0536 01479000
         BZ    @RF00536                                            0536 01480000
*         DO;                       /*                       @Z40LB35*/ 01481000
*           DARGLIST=''B;           /*                       @Z40LB35*/ 01482000
         L     @10,DDSTRU                                          0538 01483000
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0538 01484000
*           DARGSMOD=IDCTSUV0;      /*                       @Z40LB35*/ 01485000
         MVC   DARGSMOD(3,@10),@CC01119                            0539 01486000
*           DARGSENT=MSG2011A;      /*                       @Z40LB35*/ 01487000
         MVI   DARGSENT(@10),X'0C'                                 0540 01488000
*           CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*          @Z40LB35*/ 01489000
         L     @10,@PC00001                                        0541 01490000
         ST    @10,@AL00001                                        0541 01491000
         LA    @03,@CF00115                                        0541 01492000
         ST    @03,@AL00001+4                                      0541 01493000
         LA    @03,DDSTRU                                          0541 01494000
         ST    @03,@AL00001+8                                      0541 01495000
         MVI   @AL00001+8,X'80'                                    0541 01496000
         L     @15,GDTPRT(,@10)                                    0541 01497000
         LA    @01,@AL00001                                        0541 01498000
         BALR  @14,@15                                             0541 01499000
*         END;                      /*                       @Z40LB35*/ 01500000
*       ELSE                        /*                       @Z40LB35*/ 01501000
*         DO;                       /*                       @Z40LB35*/ 01502000
         B     @RC00536                                            0543 01503000
@RF00536 DS    0H                                                  0544 01504000
*           VSDVTOC=''B;            /*                       @Z40LB35*/ 01505000
         L     @10,@PC00001+8                                      0544 01506000
         L     @10,VS3LISTP(,@10)                                  0544 01507000
         L     @10,VSDPTR(,@10)                                    0544 01508000
         L     @10,VSDSPACE(,@10)                                  0544 01509000
         XC    VSDVTOC(25,@10),VSDVTOC(@10)                        0544 01510000
*           UCBREG=UNITUCB;         /*                       @Z40LB35*/ 01511000
         LA    @03,RTNUNIT                                         0545 01512000
         L     UCBREG,UNITUCB(,@03)                                0545 01513000
*           LSPACEBF=0;             /*                       @Z40LB35*/ 01514000
         SLR   LSPACEBF,LSPACEBF                                   0546 01515000
*           LSPACEBF=ADDR(VSDVTOC); /*                       @Z40LB35*/ 01516000
         LR    LSPACEBF,@10                                        0547 01517000
*LLSPACE1:                                                         0548 01518000
*           SVC(LSPACE);            /*                       @Z40LB35*/ 01519000
LLSPACE1 SVC   78                                                  0548 01520000
*           RESPECIFY                                              0549 01521000
*             RTNREG RSTD;                                         0549 01522000
*           TESTRC=RTNREG;                                         0550 01523000
         STH   RTNREG,TESTRC                                       0550 01524000
*           RESPECIFY                                              0551 01525000
*             RTNREG UNRSTD;        /*                       @Z40LB35*/ 01526000
*           RESPECIFY                                              0552 01527000
*            (UCBREG,                                              0552 01528000
*             LSPACEBF) UNRSTD;     /*                       @Z40LB35*/ 01529000
*                                                                  0552 01530000
*           /*********************************************************/ 01531000
*           /*                                                       */ 01532000
*           /* IF THE LSPACE WAS UNSUCCESSFUL, THE ERROR     @Z40LB35*/ 01533000
*           /* MESSAGE "IDC2972I LSPACE ERROR. LSPACE        @Z40LB35*/ 01534000
*           /* RETURN CODE ( )." WILL BE ISSUED.             @Z40LB35*/ 01535000
*           /*                                                       */ 01536000
*           /*********************************************************/ 01537000
*                                                                  0553 01538000
*           IF TESTRC^=0 THEN       /*                       @Z40LB35*/ 01539000
         LH    @10,TESTRC                                          0553 01540000
         LTR   @10,@10                                             0553 01541000
         BZ    @RF00553                                            0553 01542000
*             DO;                   /*                       @Z40LB35*/ 01543000
*               DARGLIST=''B;       /*                       @Z40LB35*/ 01544000
         L     @10,DDSTRU                                          0555 01545000
         XC    DARGLIST(20,@10),DARGLIST(@10)                      0555 01546000
*               DARGSMOD=IDCTSVS0;  /*                       @Z40LB35*/ 01547000
         MVC   DARGSMOD(3,@10),@CC01121                            0556 01548000
*               DARGSENT=MSG2972A;  /*                       @Z40LB35*/ 01549000
         MVI   DARGSENT(@10),X'17'                                 0557 01550000
*               DARGDBP=ADDR(TESTRC);/*                      @Z40LB35*/ 01551000
         LA    @03,TESTRC                                          0558 01552000
         ST    @03,DARGDBP(,@10)                                   0558 01553000
*               DARGILP=LENGTH(TESTRC);/*                    @Z40LB35*/ 01554000
         MVC   DARGILP(2,@10),@CH00036                             0559 01555000
*               CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*      @Z40LB35*/ 01556000
         L     @10,@PC00001                                        0560 01557000
         ST    @10,@AL00001                                        0560 01558000
         LA    @03,@CF00115                                        0560 01559000
         ST    @03,@AL00001+4                                      0560 01560000
         LA    @03,DDSTRU                                          0560 01561000
         ST    @03,@AL00001+8                                      0560 01562000
         MVI   @AL00001+8,X'80'                                    0560 01563000
         L     @15,GDTPRT(,@10)                                    0560 01564000
         LA    @01,@AL00001                                        0560 01565000
         BALR  @14,@15                                             0560 01566000
*               TESTRC=4;           /*                       @Z40LB35*/ 01567000
         MVC   TESTRC(2),@CH00041                                  0561 01568000
*             END;                  /*                       @Z40LB35*/ 01569000
*         END;                      /*                       @Z40LB35*/ 01570000
*                                                                  0563 01571000
@RF00553 DS    0H                                                  0564 01572000
*       /*************************************************************/ 01573000
*       /*                                                           */ 01574000
*       /* HERE THE NUMBER OF FMT 0 DSCB IS INITIALIZED      @Z40LB35*/ 01575000
*       /*                                                           */ 01576000
*       /*************************************************************/ 01577000
*                                                                  0564 01578000
*       VSDFMT0=FMT0CTR;            /*                       @Z40LB35*/ 01579000
*                                                                  0564 01580000
@RC00536 L     @10,@PC00001+8                                      0564 01581000
         L     @10,VS3LISTP(,@10)                                  0564 01582000
         L     @10,VSDPTR(,@10)                                    0564 01583000
         L     @03,FMT0CTR                                         0564 01584000
         ST    @03,VSDFMT0(,@10)                                   0564 01585000
*       /*************************************************************/ 01586000
*       /*                                                           */ 01587000
*       /* THE TRACKS ALLOCATED FOR VTOC IS CALCULATED       @Z40LB35*/ 01588000
*       /*                                                           */ 01589000
*       /*************************************************************/ 01590000
*                                                                  0565 01591000
*       VSDVTOCS=(ENDCC*TRACKSIZ)+ENDHH+1;/*                 @Z40LB35*/ 01592000
         LH    @03,TRACKSIZ                                        0565 01593000
         ICM   @01,12,ENDCC                                        0565 01594000
         SRA   @01,16                                              0565 01595000
         MR    @00,@03                                             0565 01596000
         ICM   @00,12,ENDHH                                        0565 01597000
         SRA   @00,16                                              0565 01598000
         ALR   @01,@00                                             0565 01599000
         AL    @01,@CF00219                                        0565 01600000
         ST    @01,VSDVTOCS(,@10)                                  0565 01601000
*       VSDVTOCS=VSDVTOCS-((BEGCC*TRACKSIZ)+BEGHH);                0566 01602000
         MH    @03,BEGCC                                           0566 01603000
         AH    @03,BEGHH                                           0566 01604000
         SLR   @01,@03                                             0566 01605000
         ST    @01,VSDVTOCS(,@10)                                  0566 01606000
*     END;                          /*                       @Z40LB35*/ 01607000
*                                                                  0567 01608000
*   /*****************************************************************/ 01609000
*   /*                                                               */ 01610000
*   /* PROVIDING THE TERMINATING ERROR DID NOT               @Z40LB35*/ 01611000
*   /* OCCUR AND AN ERROR MESSAGE WAS ISSUED BY              @Z40LB35*/ 01612000
*   /* ULOCATE THE 8 - CODE IS SET.                          @Z40LB35*/ 01613000
*   /*                                                               */ 01614000
*   /*****************************************************************/ 01615000
*                                                                  0568 01616000
*   IF TESTRC^=4&MSGSENT=ON THEN    /*                       @Z40LB35*/ 01617000
@RF00529 CLC   TESTRC(2),@CH00041                                  0568 01618000
         BE    @RF00568                                            0568 01619000
         TM    MSGSENT,B'10000000'                                 0568 01620000
         BNO   @RF00568                                            0568 01621000
*     TESTRC=8;                     /*                       @Z40LB35*/ 01622000
*                                                                  0569 01623000
         MVC   TESTRC(2),@CH00179                                  0569 01624000
*   /*****************************************************************/ 01625000
*   /*                                                               */ 01626000
*   /* CONTROL IS RETURNED TO IDCVS03                        @Z40LB35*/ 01627000
*   /* WITH THE CODE SAVED IN TESTRC.                        @Z40LB35*/ 01628000
*   /*                                                               */ 01629000
*   /*****************************************************************/ 01630000
*                                                                  0570 01631000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 01632000
@RF00568 LH    @15,TESTRC                                          0570 01633000
         L     @14,@SA00006                                        0570 01634000
         LM    @00,@12,@SA00006+8                                  0570 01635000
         BR    @14                                                 0570 01636000
*   END SELECTOR;                   /*                       @Z40LB35*/ 01637000
*                                                                  0572 01638000
*/********************************************************************/ 01639000
*/*                                                          @Z40LB35*/ 01640000
*/* PROCEDURE NAME - CLEANUP                                 @Z40LB35*/ 01641000
*/*                                                          @Z40LB35*/ 01642000
*/* FUNCTION -  THIS PROCEDURE PERFORMS THE CLOSE OF THE     @Z40LB35*/ 01643000
*/*             VOLUME VTOC AND FREES THE TRACK BUFFER.      @Z40LB35*/ 01644000
*/*                                                          @Z40LB35*/ 01645000
*/* INPUT -     IOXPTR PTR TO IOXCTLBK FOR EXCP PROCESSING   @Z40LB35*/ 01646000
*/*             TRACKPTR PTR TO THE VTOC TRACK BUFFER        @Z40LB35*/ 01647000
*/*                                                          @Z40LB35*/ 01648000
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 01649000
*/*                          12, ERROR CLOSE - UEXCP         @Z40LB35*/ 01650000
*/*                                                          @Z40LB35*/ 01651000
*/********************************************************************/ 01652000
*                                                                  0572 01653000
*                                   /*                       @Z40LB35*/ 01654000
*CLEANUP:                                                          0572 01655000
*   PROC;                           /*                       @Z40LB35*/ 01656000
*                                                                  0572 01657000
CLEANUP  STM   @14,@12,@SA00007                                    0572 01658000
*   /*****************************************************************/ 01659000
*   /*                                                               */ 01660000
*   /* SET UP TRACE POINT 'VSCU' IN TRACE TABLE              @Z40LB35*/ 01661000
*   /*                                                               */ 01662000
*   /*****************************************************************/ 01663000
*                                                                  0573 01664000
*   OLDERID2=NEWERID2;                                             0573 01665000
         L     @10,@PC00001                                        0573 01666000
         L     @03,GDTTR2(,@10)                                    0573 01667000
         MVC   @TS00001(95),NEWERID2(@03)                          0573 01668000
         MVC   OLDERID2(95,@03),@TS00001                           0573 01669000
*   NEWID2='VSCU';                  /*                       @Z40LB35*/ 01670000
*                                                                  0574 01671000
         MVC   NEWID2(4,@03),@CC01341                              0574 01672000
*   /*****************************************************************/ 01673000
*   /*                                                               */ 01674000
*   /* ISSUE UDEQ TO FREE UP VTOC                            @Z40LB35*/ 01675000
*   /*                                                               */ 01676000
*   /*****************************************************************/ 01677000
*                                                                  0575 01678000
*   IF ENQ=ON THEN                  /*                       @Z40LB35*/ 01679000
         TM    ENQ,B'10000000'                                     0575 01680000
         BNO   @RF00575                                            0575 01681000
*     CALL IDCSADQ0(GDTTBL,QNAME,RNAME);/*                   @Z40LB35*/ 01682000
*                                                                  0576 01683000
         ST    @10,@AL00001                                        0576 01684000
         LA    @03,QNAME                                           0576 01685000
         ST    @03,@AL00001+4                                      0576 01686000
         LA    @03,RNAME                                           0576 01687000
         ST    @03,@AL00001+8                                      0576 01688000
         MVI   @AL00001+8,X'80'                                    0576 01689000
         L     @15,GDTDEQ(,@10)                                    0576 01690000
         LA    @01,@AL00001                                        0576 01691000
         BALR  @14,@15                                             0576 01692000
*   /*****************************************************************/ 01693000
*   /*                                                               */ 01694000
*   /* ISSUE UEXCP TO CLOSE THE VTOC                         @Z40LB35*/ 01695000
*   /*                                                               */ 01696000
*   /*****************************************************************/ 01697000
*                                                                  0577 01698000
*   TESTRC=0;                       /*                       @Z40LB35*/ 01699000
@RF00575 SLR   @10,@10                                             0577 01700000
         STH   @10,TESTRC                                          0577 01701000
*   IF IOXPTR^=NULLPTR THEN         /*                       @Z40LB35*/ 01702000
         C     @10,IOXPTR                                          0578 01703000
         BE    @RF00578                                            0578 01704000
*     DO;                           /*                       @Z40LB35*/ 01705000
*       CALL IDCIO050(GDTTBL,CLOSE,IOXPTR);/*                @Z40LB35*/ 01706000
         L     @10,@PC00001                                        0580 01707000
         ST    @10,@AL00001                                        0580 01708000
         LA    @03,CLOSE                                           0580 01709000
         ST    @03,@AL00001+4                                      0580 01710000
         LA    @03,IOXPTR                                          0580 01711000
         ST    @03,@AL00001+8                                      0580 01712000
         MVI   @AL00001+8,X'80'                                    0580 01713000
         L     @15,GDTEXP(,@10)                                    0580 01714000
         LA    @01,@AL00001                                        0580 01715000
         BALR  @14,@15                                             0580 01716000
*       RESPECIFY                                                  0581 01717000
*         RTNREG RSTD;                                             0581 01718000
*       TESTRC=RTNREG;                                             0582 01719000
         STH   RTNREG,TESTRC                                       0582 01720000
*       RESPECIFY                                                  0583 01721000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 01722000
*     END;                          /*                       @Z40LB35*/ 01723000
*                                                                  0584 01724000
*   /*****************************************************************/ 01725000
*   /*                                                               */ 01726000
*   /* IF THE CLOSE FAILED, SET THE CLOSE ERROR              @Z40LB35*/ 01727000
*   /* CODE. THIS IS NOT A TERMINATING ERROR AND             @Z40LB35*/ 01728000
*   /* REQUIRES A SPECIAL CODE.                              @Z40LB35*/ 01729000
*   /*                                                               */ 01730000
*   /*****************************************************************/ 01731000
*                                                                  0585 01732000
*   IF TESTRC^=0 THEN               /*                       @Z40LB35*/ 01733000
@RF00578 LH    @10,TESTRC                                          0585 01734000
         LTR   @10,@10                                             0585 01735000
         BZ    @RF00585                                            0585 01736000
*     TESTRC=12;                    /*                       @Z40LB35*/ 01737000
*                                                                  0586 01738000
         MVC   TESTRC(2),@CH00035                                  0586 01739000
*   /*****************************************************************/ 01740000
*   /*                                                               */ 01741000
*   /* PROVIDING THE UGSPACE WAS SUCCESSFUL OR NOT           @Z40LB35*/ 01742000
*   /* FREE THE STORAGE FOR THE VTOC TRACK BUFFER.           @Z40LB35*/ 01743000
*   /*                                                               */ 01744000
*   /*****************************************************************/ 01745000
*                                                                  0587 01746000
*   IF TRACKPTR^=NULLPTR THEN       /*                       @Z40LB35*/ 01747000
@RF00585 L     @10,TRACKPTR                                        0587 01748000
         LTR   @10,@10                                             0587 01749000
         BZ    @RF00587                                            0587 01750000
*     CALL IDCSAFS0(GDTTBL,TRACKPTR);/*                      @Z40LB35*/ 01751000
*                                                                  0588 01752000
         L     @10,@PC00001                                        0588 01753000
         ST    @10,@AL00001                                        0588 01754000
         LA    @03,TRACKPTR                                        0588 01755000
         ST    @03,@AL00001+4                                      0588 01756000
         L     @15,GDTFSP(,@10)                                    0588 01757000
         LA    @01,@AL00001                                        0588 01758000
         BALR  @14,@15                                             0588 01759000
*   /*****************************************************************/ 01760000
*   /*                                                               */ 01761000
*   /* CONTROL IS RETURNED TO IDCVS03 WITH THE CODE          @Z40LB35*/ 01762000
*   /* SAVED IN TESTRC.                                      @Z40LB35*/ 01763000
*   /*                                                               */ 01764000
*   /*****************************************************************/ 01765000
*                                                                  0589 01766000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 01767000
@RF00587 LH    @15,TESTRC                                          0589 01768000
         L     @14,@SA00007                                        0589 01769000
         LM    @00,@12,@SA00007+8                                  0589 01770000
         BR    @14                                                 0589 01771000
*   END CLEANUP;                    /*                       @Z40LB35*/ 01772000
*                                                                  0591 01773000
*/********************************************************************/ 01774000
*/*                                                          @Z40LB35*/ 01775000
*/* PROCEDURE NAME - GETFMT1                                 @Z40LB35*/ 01776000
*/*                                                          @Z40LB35*/ 01777000
*/* FUNCTION -  THIS PROCEDURE CALLS TRKREAD PROCEDURE       @Z40LB35*/ 01778000
*/*             TO READ A TRACK IF NECESSARY AND LOCATES THE @Z40LB35*/ 01779000
*/*             NEXT FMT1 DSCB FOR THE CALLER (SELECTOR      @Z40LB35*/ 01780000
*/*             PROCEDURE).                                  @Z40LB35*/ 01781000
*/*                                                          @Z40LB35*/ 01782000
*/* INPUT -     DS1FMTID FROM IECSDSL1 FMT1 DSCB             @Z40LB35*/ 01783000
*/*                                                          @Z40LB35*/ 01784000
*/* OUTPUT -    F1PTR TO THE DSCB                            @Z40LB35*/ 01785000
*/*             LR FROM THE IOBLOCK                          @Z40LB35*/ 01786000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 01787000
*/*                           4, ERROR IN TRKREAD            @Z40LB35*/ 01788000
*/*                          12, EOF END OF FILE             @Z40LB35*/ 01789000
*/*                                                          @Z40LB35*/ 01790000
*/********************************************************************/ 01791000
*                                                                  0591 01792000
*                                   /*                       @Z40LB35*/ 01793000
*GETFMT1:                                                          0591 01794000
*   PROC;                           /*                       @Z40LB35*/ 01795000
GETFMT1  STM   @14,@04,@SA00008                                    0591 01796000
         STM   @06,@09,@SA00008+28                                 0591 01797000
         STM   @11,@12,@SA00008+44                                 0591 01798000
*   DCL                                                            0592 01799000
*     TRACKRSW BIT(1);              /* SWITCH FOR READ TRACK @Z40LB35*/ 01800000
*   DCL                                                            0593 01801000
*     FMT1SW BIT(1);                /* FMT1 SWITCH           @Z40LB35*/ 01802000
*   DCL                                                            0594 01803000
*     DSCBNUM FIXED(31);            /* DSCB COUNTER          @Z40LB35*/ 01804000
*                                                                  0595 01805000
*   /*****************************************************************/ 01806000
*   /*                                                               */ 01807000
*   /* SET UP TRACE POINT 'VSF1' IN TRACE TABLE              @Z40LB35*/ 01808000
*   /*                                                               */ 01809000
*   /*****************************************************************/ 01810000
*                                                                  0595 01811000
*   OLDERID2=NEWERID2;                                             0595 01812000
         L     @04,@PC00001                                        0595 01813000
         L     @04,GDTTR2(,@04)                                    0595 01814000
         MVC   @TS00001(95),NEWERID2(@04)                          0595 01815000
         MVC   OLDERID2(95,@04),@TS00001                           0595 01816000
*   NEWID2='VSF1';                  /*                       @Z40LB35*/ 01817000
*                                                                  0596 01818000
         MVC   NEWID2(4,@04),@CC01348                              0596 01819000
*   /*****************************************************************/ 01820000
*   /*                                                               */ 01821000
*   /* IF THE RECORD NUMBER IS STILL INITIALIZED TO          @Z40LB35*/ 01822000
*   /* ZERO, THE FIRST TRACK HAS STILL TO BE READ.           @Z40LB35*/ 01823000
*   /*                                                               */ 01824000
*   /*****************************************************************/ 01825000
*                                                                  0597 01826000
*   IF LR=0 THEN                    /*                       @Z40LB35*/ 01827000
         CLI   LR,0                                                0597 01828000
         BNE   @RF00597                                            0597 01829000
*     DO;                           /*                       @Z40LB35*/ 01830000
*       TRACKRSW=ON;                /*                       @Z40LB35*/ 01831000
         OI    TRACKRSW,B'10000000'                                0599 01832000
*       LR=1;                       /*                       @Z40LB35*/ 01833000
         MVI   LR,X'01'                                            0600 01834000
*     END;                          /*                       @Z40LB35*/ 01835000
*                                                                  0601 01836000
*   /*****************************************************************/ 01837000
*   /*                                                               */ 01838000
*   /* INITIALIZE FMT1 SWITCH OFF                            @Z40LB35*/ 01839000
*   /*                                                               */ 01840000
*   /*****************************************************************/ 01841000
*                                                                  0602 01842000
*   FMT1SW=OFF;                     /*                       @Z40LB35*/ 01843000
*                                                                  0602 01844000
@RF00597 NI    FMT1SW,B'01111111'                                  0602 01845000
*   /*****************************************************************/ 01846000
*   /*                                                               */ 01847000
*   /* THE FOLLOWING DO LOOP WILL LOCATE THE NEXT            @Z40LB35*/ 01848000
*   /* FMT 1 DSCB OR REACH AN EOF.                           @Z40LB35*/ 01849000
*   /*                                                               */ 01850000
*   /*****************************************************************/ 01851000
*                                                                  0603 01852000
*   DO WHILE TESTRC=0&FMT1SW=OFF;   /*                       @Z40LB35*/ 01853000
*                                                                  0603 01854000
         B     @DE00603                                            0603 01855000
@DL00603 DS    0H                                                  0604 01856000
*     /***************************************************************/ 01857000
*     /*                                                             */ 01858000
*     /* THE DSCB COUNT IS ADVANCED AND THE PTR              @Z40LB35*/ 01859000
*     /* TO THE NEXT DSCB IS POSITIONED.                     @Z40LB35*/ 01860000
*     /*                                                             */ 01861000
*     /***************************************************************/ 01862000
*                                                                  0604 01863000
*     DSCBNUM=DSCBNUM+1;            /*                       @Z40LB35*/ 01864000
         AL    DSCBNUM,@CF00219                                    0604 01865000
*     F1PTR=F1PTR+LENGTH(IECSDSL1); /*                       @Z40LB35*/ 01866000
*                                                                  0605 01867000
         AL    F1PTR,@CF01203                                      0605 01868000
*     /***************************************************************/ 01869000
*     /*                                                             */ 01870000
*     /* HERE THE DETERMINATION IS MADE WHETHER THE          @Z40LB35*/ 01871000
*     /* END OF THE TRACK HAS BEEN REACHED.                  @Z40LB35*/ 01872000
*     /*                                                             */ 01873000
*     /***************************************************************/ 01874000
*                                                                  0606 01875000
*     IF TRACKRSW=ON THEN           /*                       @Z40LB35*/ 01876000
*                                                                  0606 01877000
         TM    TRACKRSW,B'10000000'                                0606 01878000
         BNO   @RF00606                                            0606 01879000
*       /*************************************************************/ 01880000
*       /*                                                           */ 01881000
*       /* IF THE END OF TRACK HAS BEEN REACHED,             @Z40LB35*/ 01882000
*       /* THE NEXT TRACK IS READ.                           @Z40LB35*/ 01883000
*       /*                                                           */ 01884000
*       /*************************************************************/ 01885000
*                                                                  0607 01886000
*       DO;                         /*                       @Z40LB35*/ 01887000
*         CALL TRKREAD;             /*                       @Z40LB35*/ 01888000
         BAL   @14,TRKREAD                                         0608 01889000
*         RESPECIFY                                                0609 01890000
*           RTNREG RSTD;                                           0609 01891000
*         TESTRC=RTNREG;                                           0610 01892000
         STH   RTNREG,TESTRC                                       0610 01893000
*         RESPECIFY                                                0611 01894000
*           RTNREG UNRSTD;          /*                       @Z40LB35*/ 01895000
*         DSCBNUM=1;                /*                       @Z40LB35*/ 01896000
         LA    DSCBNUM,1                                           0612 01897000
*         LR=1;                     /*                       @Z40LB35*/ 01898000
         MVI   LR,X'01'                                            0613 01899000
*         F1PTR=TRACKPTR;           /*                       @Z40LB35*/ 01900000
         L     F1PTR,TRACKPTR                                      0614 01901000
*         TRACKRSW=OFF;             /*                       @Z40LB35*/ 01902000
         NI    TRACKRSW,B'01111111'                                0615 01903000
*       END;                        /*                       @Z40LB35*/ 01904000
*                                                                  0616 01905000
*     /***************************************************************/ 01906000
*     /*                                                             */ 01907000
*     /* HERE A TEST IS MADE TO DETERMINE IF THE             @Z40LB35*/ 01908000
*     /* CURRENT DSCB IS A FMT 1 DSCB AND NOT VSAM           @Z40LB35*/ 01909000
*     /*                                                             */ 01910000
*     /***************************************************************/ 01911000
*                                                                  0617 01912000
*     IF DS1FMTID=FMT1ID&DS1VSAM=OFF THEN/*                  @Z40LB35*/ 01913000
@RF00606 CLC   DS1FMTID(1,F1PTR),FMT1ID                            0617 01914000
         BNE   @RF00617                                            0617 01915000
         TM    DS1VSAM(F1PTR),B'00001000'                          0617 01916000
         BNZ   @RF00617                                            0617 01917000
*       FMT1SW=ON;                  /*                       @Z40LB35*/ 01918000
*                                                                  0618 01919000
         OI    FMT1SW,B'10000000'                                  0618 01920000
*     /***************************************************************/ 01921000
*     /*                                                             */ 01922000
*     /* IF THE DSCB COUNT IS GREATER THAN 39, THE           @Z40LB35*/ 01923000
*     /* TRACK READ SWITCH IS SET FOR THE NEXT               @Z40LB35*/ 01924000
*     /* COMPARISON.                                         @Z40LB35*/ 01925000
*     /*                                                             */ 01926000
*     /***************************************************************/ 01927000
*                                                                  0619 01928000
*     IF DSCBNUM>=VTOCTRK THEN      /*                       @Z40LB35*/ 01929000
@RF00617 CH    DSCBNUM,VTOCTRK                                     0619 01930000
         BL    @RF00619                                            0619 01931000
*       TRACKRSW=ON;                /*                       @Z40LB35*/ 01932000
         OI    TRACKRSW,B'10000000'                                0620 01933000
*   END;                            /*                       @Z40LB35*/ 01934000
*                                                                  0621 01935000
@RF00619 DS    0H                                                  0621 01936000
@DE00603 LH    @04,TESTRC                                          0621 01937000
         LTR   @04,@04                                             0621 01938000
         BNZ   @DC00603                                            0621 01939000
         TM    FMT1SW,B'10000000'                                  0621 01940000
         BZ    @DL00603                                            0621 01941000
@DC00603 DS    0H                                                  0622 01942000
*   /*****************************************************************/ 01943000
*   /*                                                               */ 01944000
*   /* CONTROL IS RETURNED TO SELECTOR PROC WITH             @Z40LB35*/ 01945000
*   /* CODE SAVE IN TESTRC.                                  @Z40LB35*/ 01946000
*   /*                                                               */ 01947000
*   /*****************************************************************/ 01948000
*                                                                  0622 01949000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 01950000
         LH    @15,TESTRC                                          0622 01951000
         L     @14,@SA00008                                        0622 01952000
         LM    @00,@04,@SA00008+8                                  0622 01953000
         LM    @06,@09,@SA00008+28                                 0622 01954000
         LM    @11,@12,@SA00008+44                                 0622 01955000
         BR    @14                                                 0622 01956000
*   END GETFMT1;                    /*                       @Z40LB35*/ 01957000
*                                                                  0624 01958000
*/********************************************************************/ 01959000
*/*                                                          @Z40LB35*/ 01960000
*/* PROCEDURE NAME - CRITERIA                                @Z40LB35*/ 01961000
*/*                                                          @Z40LB35*/ 01962000
*/* FUNCTION -  THIS PROCEDURE IS THE CONTROLLING PROCEDURE  @Z40LB35*/ 01963000
*/*             FOR A SPECIFIC DATA SET CRITERIA STATUS.     @Z40LB35*/ 01964000
*/*             CALLS SUB PROCEDURES CATLG, QUAL, CREATION,  @Z40LB35*/ 01965000
*/*             EXPIRATN, SYSNAMES, AND EXCLUDE.             @Z40LB35*/ 01966000
*/*                                                          @Z40LB35*/ 01967000
*/* INPUT -     VS3UNCAT FROM THE VS3AGL                     @Z40LB35*/ 01968000
*/*             VS3EXDSP FROM THE VS3AGL                     @Z40LB35*/ 01969000
*/*             VS3LEVP  FROM THE VS3AGL                     @Z40LB35*/ 01970000
*/*             VS3CREAT FROM THE VS3AGL                     @Z40LB35*/ 01971000
*/*             VS3EXPIR FROM THE VS3AGL                     @Z40LB35*/ 01972000
*/*             VS3SYSNM FROM THE VS3AGL                     @Z40LB35*/ 01973000
*/*                                                          @Z40LB35*/ 01974000
*/* OUTPUT -    F1PTR TO THE DSCB                            @Z40LB35*/ 01975000
*/*             LR FROM THE IOBLOCK                          @Z40LB35*/ 01976000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 01977000
*/*                           8, ERROR CLOSE - UEXCP         @Z40LB35*/ 01978000
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/ 01979000
*/*                                                          @Z40LB35*/ 01980000
*/********************************************************************/ 01981000
*                                                                  0624 01982000
*                                   /*                       @Z40LB35*/ 01983000
*CRITERIA:                                                         0624 01984000
*   PROC;                           /*                       @Z40LB35*/ 01985000
*                                                                  0624 01986000
CRITERIA STM   @14,@12,@SA00009                                    0624 01987000
*   /*****************************************************************/ 01988000
*   /*                                                               */ 01989000
*   /* SET UP TRACE POINT 'VSCT' IN TRACE TABLE              @ZM41110*/ 01990000
*   /*                                                               */ 01991000
*   /*****************************************************************/ 01992000
*                                                                  0625 01993000
*   OLDERID2=NEWERID2;                                             0625 01994000
         L     @10,@PC00001                                        0625 01995000
         L     @10,GDTTR2(,@10)                                    0625 01996000
         MVC   @TS00001(95),NEWERID2(@10)                          0625 01997000
         MVC   OLDERID2(95,@10),@TS00001                           0625 01998000
*   NEWID2='VSCT';                  /*                       @ZM41110*/ 01999000
*                                                                  0626 02000000
         MVC   NEWID2(4,@10),@CC01352                              0626 02001000
*   /*****************************************************************/ 02002000
*   /*                                                               */ 02003000
*   /* INITIALIZE THE RETURN CODE TO ZERO                    @Z40LB35*/ 02004000
*   /*                                                               */ 02005000
*   /*****************************************************************/ 02006000
*                                                                  0627 02007000
*   TESTRC=0;                       /*                       @Z40LB35*/ 02008000
*                                                                  0627 02009000
         SLR   @10,@10                                             0627 02010000
         STH   @10,TESTRC                                          0627 02011000
*   /*****************************************************************/ 02012000
*   /*                                                               */ 02013000
*   /* IF THE EXCLUDED DSN LIST IS PASSED                    @Z40LB35*/ 02014000
*   /* THE EXCLUDE SUB PROCEDURE IS CALLED.                  @Z40LB35*/ 02015000
*   /*                                                               */ 02016000
*   /*****************************************************************/ 02017000
*                                                                  0628 02018000
*   IF VS3EXDSP^=NULLPTR THEN       /*                       @Z40LB35*/ 02019000
         L     @03,@PC00001+8                                      0628 02020000
         C     @10,VS3EXDSP(,@03)                                  0628 02021000
         BE    @RF00628                                            0628 02022000
*     DO;                           /*                       @Z40LB35*/ 02023000
*       CALL EXCLUDE;               /*                       @Z40LB35*/ 02024000
         BAL   @14,EXCLUDE                                         0630 02025000
*       RESPECIFY                                                  0631 02026000
*         RTNREG RSTD;                                             0631 02027000
*       TESTRC=RTNREG;                                             0632 02028000
         STH   RTNREG,TESTRC                                       0632 02029000
*       RESPECIFY                                                  0633 02030000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02031000
*     END;                          /*                       @Z40LB35*/ 02032000
*                                                                  0634 02033000
*   /*****************************************************************/ 02034000
*   /*                                                               */ 02035000
*   /* IF A DSN HIGHER LEVEL QUALIFIER IS PASSED,            @Z40LB35*/ 02036000
*   /* THE SUB PROCEDURE QUAL IS CALLED.                     @Z40LB35*/ 02037000
*   /*                                                               */ 02038000
*   /*****************************************************************/ 02039000
*                                                                  0635 02040000
*   IF TESTRC=0&VS3LEVP^=NULLPTR THEN/*                      @Z40LB35*/ 02041000
@RF00628 SLR   @10,@10                                             0635 02042000
         CH    @10,TESTRC                                          0635 02043000
         BNE   @RF00635                                            0635 02044000
         L     @03,@PC00001+8                                      0635 02045000
         C     @10,VS3LEVP(,@03)                                   0635 02046000
         BE    @RF00635                                            0635 02047000
*     DO;                           /*                       @Z40LB35*/ 02048000
*       CALL QUAL;                  /*                       @Z40LB35*/ 02049000
         BAL   @14,QUAL                                            0637 02050000
*       RESPECIFY                                                  0638 02051000
*         RTNREG RSTD;                                             0638 02052000
*       TESTRC=RTNREG;                                             0639 02053000
         STH   RTNREG,TESTRC                                       0639 02054000
*       RESPECIFY                                                  0640 02055000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02056000
*     END;                          /*                       @Z40LB35*/ 02057000
*                                                                  0641 02058000
*   /*****************************************************************/ 02059000
*   /*                                                               */ 02060000
*   /* IF THE CALLER WANTS THE SYSNAME CRITERIA, THE         @Z40LB35*/ 02061000
*   /* SUB PROCEDURE SYSNAMES IS CALLED.                     @Z40LB35*/ 02062000
*   /*                                                               */ 02063000
*   /*****************************************************************/ 02064000
*                                                                  0642 02065000
*   IF TESTRC=0&VS3SYSNM=ON THEN    /*                       @Z40LB35*/ 02066000
@RF00635 LH    @10,TESTRC                                          0642 02067000
         LTR   @10,@10                                             0642 02068000
         BNZ   @RF00642                                            0642 02069000
         L     @10,@PC00001+8                                      0642 02070000
         TM    VS3SYSNM(@10),B'00001000'                           0642 02071000
         BNO   @RF00642                                            0642 02072000
*     DO;                           /*                       @Z40LB35*/ 02073000
*       CALL SYSNAMES;              /*                       @Z40LB35*/ 02074000
         BAL   @14,SYSNAMES                                        0644 02075000
*       RESPECIFY                                                  0645 02076000
*         RTNREG RSTD;                                             0645 02077000
*       TESTRC=RTNREG;                                             0646 02078000
         STH   RTNREG,TESTRC                                       0646 02079000
*       RESPECIFY                                                  0647 02080000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02081000
*     END;                          /*                       @Z40LB35*/ 02082000
*                                                                  0648 02083000
*   /*****************************************************************/ 02084000
*   /*                                                               */ 02085000
*   /* HERE THE DETERMINATION IS MADE WHETHER THE            @Z40LB35*/ 02086000
*   /* CATALOG SHOULD BE SEARCHED FOR THE DSN.               @Z40LB35*/ 02087000
*   /* THE SCRDSET SERVICE WILL NEED TO KNOW IF A            @Z40LB35*/ 02088000
*   /* DATA SET IS CATLG OR NOT TO UNCATLG IT                @Z40LB35*/ 02089000
*   /* WHEN THE DSN IS SCRATCHED.                            @Z40LB35*/ 02090000
*   /* THE LISTDSET WILL NEED TO KNOW IF A DSN               @Z40LB35*/ 02091000
*   /* IS CATLG WHEN IT PREPARES THE STATUS REPORT.          @Z40LB35*/ 02092000
*   /* IF ANY CALLER HAS SPECIFIED THE VS3UNCAT              @Z40LB35*/ 02093000
*   /* CRITERIA, CATLG WILL BE SEARCHED TO DETERMINE         @Z40LB35*/ 02094000
*   /* IF THE DATA SET MEETS THE CRITERIAN.                  @Z40LB35*/ 02095000
*   /* AND FINALLY IF THE USER HAS USED EXPIRATION           @Z40LB35*/ 02096000
*   /* OR CREATION DATE CRITERIA, THE VSAM CATLG             @Z40LB35*/ 02097000
*   /* ENTRY WILL BE NEEDED TO TEST THE DATES.               @Z40LB35*/ 02098000
*   /*                                                               */ 02099000
*   /*****************************************************************/ 02100000
*                                                                  0649 02101000
*   IF TESTRC^=NOMEET&(VS3STAT=ON|VS3UNCAT=ON|VS3EXPIR^=NULLPTR|   0649 02102000
*       VS3CREAT^=NULLPTR|VS3SCR=ON) THEN                          0649 02103000
*                                                                  0649 02104000
@RF00642 CLC   TESTRC(2),NOMEET                                    0649 02105000
         BE    @RF00649                                            0649 02106000
         L     @10,@PC00001+8                                      0649 02107000
         TM    VS3STAT(@10),B'10010000'                            0649 02108000
         BNZ   @RT00649                                            0649 02109000
         SLR   @03,@03                                             0649 02110000
         C     @03,VS3EXPIR(,@10)                                  0649 02111000
         BNE   @RT00649                                            0649 02112000
         C     @03,VS3CREAT(,@10)                                  0649 02113000
         BNE   @RT00649                                            0649 02114000
         TM    VS3SCR(@10),B'00100000'                             0649 02115000
         BNO   @RF00649                                            0649 02116000
@RT00649 DS    0H                                                  0650 02117000
*     /***************************************************************/ 02118000
*     /*                                                             */ 02119000
*     /* THE SUB PROCEDURE CATLG WILL DO THE ULOCATE.        @Z40LB35*/ 02120000
*     /*                                                             */ 02121000
*     /***************************************************************/ 02122000
*                                                                  0650 02123000
*     DO;                           /*                       @Z40LB35*/ 02124000
*       CALL CATLG;                 /*                       @Z40LB35*/ 02125000
         BAL   @14,CATLG                                           0651 02126000
*       RESPECIFY                                                  0652 02127000
*         RTNREG RSTD;                                             0652 02128000
*       TESTRC=RTNREG;                                             0653 02129000
         STH   RTNREG,TESTRC                                       0653 02130000
*       RESPECIFY                                                  0654 02131000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02132000
*     END;                          /*                       @Z40LB35*/ 02133000
*                                                                  0655 02134000
*   /*****************************************************************/ 02135000
*   /*                                                               */ 02136000
*   /* IF THE CALLER HAS SUPPLIED A CREATION DATE            @Z40LB35*/ 02137000
*   /* THE SUB PROCEDURE CREATION IS CALLED.                 @Z40LB35*/ 02138000
*   /*                                                               */ 02139000
*   /*****************************************************************/ 02140000
*                                                                  0656 02141000
*   IF TESTRC^=NOMEET&VS3CREAT^=NULLPTR THEN/*               @Z40LB35*/ 02142000
@RF00649 CLC   TESTRC(2),NOMEET                                    0656 02143000
         BE    @RF00656                                            0656 02144000
         L     @10,@PC00001+8                                      0656 02145000
         L     @10,VS3CREAT(,@10)                                  0656 02146000
         LTR   @10,@10                                             0656 02147000
         BZ    @RF00656                                            0656 02148000
*     DO;                           /*                       @Z40LB35*/ 02149000
*       CALL CREATION;              /*                       @Z40LB35*/ 02150000
         BAL   @14,CREATION                                        0658 02151000
*       RESPECIFY                                                  0659 02152000
*         RTNREG RSTD;                                             0659 02153000
*       TESTRC=RTNREG;                                             0660 02154000
         STH   RTNREG,TESTRC                                       0660 02155000
*       RESPECIFY                                                  0661 02156000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02157000
*     END;                          /*                       @Z40LB35*/ 02158000
*                                                                  0662 02159000
*   /*****************************************************************/ 02160000
*   /*                                                               */ 02161000
*   /* IF THE CALLER HAS SUPPLIED A EXPIRATION DATE          @Z40LB35*/ 02162000
*   /* THE SUB PROCEDURE EXPIRATN IS CALLED.                 @Z40LB35*/ 02163000
*   /*                                                               */ 02164000
*   /*****************************************************************/ 02165000
*                                                                  0663 02166000
*   IF TESTRC^=NOMEET&VS3EXPIR^=NULLPTR THEN/*               @Z40LB35*/ 02167000
@RF00656 CLC   TESTRC(2),NOMEET                                    0663 02168000
         BE    @RF00663                                            0663 02169000
         L     @10,@PC00001+8                                      0663 02170000
         L     @10,VS3EXPIR(,@10)                                  0663 02171000
         LTR   @10,@10                                             0663 02172000
         BZ    @RF00663                                            0663 02173000
*     DO;                           /*                       @Z40LB35*/ 02174000
*       CALL EXPIRATN;              /*                       @Z40LB35*/ 02175000
         BAL   @14,EXPIRATN                                        0665 02176000
*       RESPECIFY                                                  0666 02177000
*         RTNREG RSTD;                                             0666 02178000
*       TESTRC=RTNREG;                                             0667 02179000
         STH   RTNREG,TESTRC                                       0667 02180000
*       RESPECIFY                                                  0668 02181000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02182000
*     END;                          /*                       @Z40LB35*/ 02183000
*                                                                  0669 02184000
*   /*****************************************************************/ 02185000
*   /*                                                               */ 02186000
*   /* IF ULOCATE ISSUED AN DSN ERROR OR CONFLICT            @Z40LB35*/ 02187000
*   /* MESSAGE, THEN THE CODE 8 IS RETURNED.                 @Z40LB35*/ 02188000
*   /*                                                               */ 02189000
*   /*****************************************************************/ 02190000
*                                                                  0670 02191000
*   IF TESTRC=4 THEN                /*                       @Z40LB35*/ 02192000
@RF00663 CLC   TESTRC(2),@CH00041                                  0670 02193000
         BNE   @RF00670                                            0670 02194000
*     TESTRC=MSGCODE;               /*                       @Z40LB35*/ 02195000
*                                                                  0671 02196000
         SLR   @10,@10                                             0671 02197000
         IC    @10,MSGCODE                                         0671 02198000
         STH   @10,TESTRC                                          0671 02199000
*   /*****************************************************************/ 02200000
*   /*                                                               */ 02201000
*   /* CONTROL IS RETURNED TO SELECTOR WITH THE CODE         @Z40LB35*/ 02202000
*   /* SAVED IN TESTRC.                                      @Z40LB35*/ 02203000
*   /*                                                               */ 02204000
*   /*****************************************************************/ 02205000
*                                                                  0672 02206000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 02207000
@RF00670 LH    @15,TESTRC                                          0672 02208000
         L     @14,@SA00009                                        0672 02209000
         LM    @00,@12,@SA00009+8                                  0672 02210000
         BR    @14                                                 0672 02211000
*   END CRITERIA;                   /*                       @Z40LB35*/ 02212000
*                                                                  0674 02213000
*/********************************************************************/ 02214000
*/*                                                          @Z40LB35*/ 02215000
*/* PROCEDURE NAME - USAGE                                   @Z40LB35*/ 02216000
*/*                                                          @Z40LB35*/ 02217000
*/* FUNCTION -  THIS PROCEDURE INITIALIZES THE VSDUSAGE      @Z40LB35*/ 02218000
*/*             PORTION OF THE VSDBLOCK.                     @Z40LB35*/ 02219000
*/*                                                          @Z40LB35*/ 02220000
*/* INPUT -     DS1DSORG FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/ 02221000
*/*             DS1SCALO FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/ 02222000
*/*             DS1EXT1  FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/ 02223000
*/*             DS1LSTAR FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/ 02224000
*/*             DS3FMTID FROM IECDSF3 OF THE DSCB FMT3       @Z40LB35*/ 02225000
*/*                                                          @Z40LB35*/ 02226000
*/* OUTPUT -    VSDOPS   OF VSDUSAGE                         @Z40LB35*/ 02227000
*/*             VSDOPO   OF VSDUSAGE                         @Z40LB35*/ 02228000
*/*             VSDOIS   OF VSDUSAGE                         @Z40LB35*/ 02229000
*/*             VSDODA   OF VSDUSAGE                         @Z40LB35*/ 02230000
*/*             VSDOU    OF VSDUSAGE                         @Z40LB35*/ 02231000
*/*             VSDACYL  OF VSDUSAGE                         @Z40LB35*/ 02232000
*/*             VSDATRK  OF VSDUSAGE                         @Z40LB35*/ 02233000
*/*             VSDABLK  OF VSDUSAGE                         @Z40LB35*/ 02234000
*/*             VSDBSTR  OF VSDUSAGE                         @Z40LB35*/ 02235000
*/*             VSDSECAL OF VSDUSAGE                         @Z40LB35*/ 02236000
*/*             VSDCALFR OF VSDUSAGE                         @Z40LB35*/ 02237000
*/*             VSDFTRK  OF VSDUSAGE                         @Z40LB35*/ 02238000
*/*             VSDTRKS  OF VSDUSAGE                         @Z40LB35*/ 02239000
*/*             EXGCTLBK OF EXGARG                           @Z40LB35*/ 02240000
*/*             EXGCCHH2 OF EXGARG                           @Z40LB35*/ 02241000
*/*             EXGRECNO OF EXGARG                           @Z40LB35*/ 02242000
*/*             EXGDATAP OF EXGARG                           @Z40LB35*/ 02243000
*/*             EXGKEYLN OF EXGARG                           @Z40LB35*/ 02244000
*/*             EXGDATAL OF EXGARG                           @Z40LB35*/ 02245000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 02246000
*/*                                                          @Z40LB35*/ 02247000
*/********************************************************************/ 02248000
*                                                                  0674 02249000
*                                   /*                       @Z40LB35*/ 02250000
*USAGE:                                                            0674 02251000
*   PROC;                           /*                       @Z40LB35*/ 02252000
*                                                                  0674 02253000
USAGE    STM   @14,@02,@SA00010                                    0674 02254000
         STM   @04,@07,@SA00010+20                                 0674 02255000
         STM   @09,@12,@SA00010+36                                 0674 02256000
*   /*****************************************************************/ 02257000
*   /*                                                               */ 02258000
*   /* THE FOLLOWING STRUCTURE DEFINE THE SECONDARY          @Z40LB35*/ 02259000
*   /* ALLOCATION INTO A FIXED NUMBER.                       @Z40LB35*/ 02260000
*   /*                                                               */ 02261000
*   /*****************************************************************/ 02262000
*                                                                  0675 02263000
*   DCL                                                            0675 02264000
*     1 * DEFINED(DS1SCALO) BDY(BYTE),/*                     @Z40LB35*/ 02265000
*      2 * FIXED(8),                /* RESERVED              @Z40LB35*/ 02266000
*      2 DS1SECAL FIXED(24);        /* SECONDARY ALLOC UNITS @Z40LB35*/ 02267000
*                                                                  0675 02268000
*   /*****************************************************************/ 02269000
*   /*                                                               */ 02270000
*   /* THE FOLLOWING BIT DEFINES THE TRACK UNIT BIT          @Z40LB35*/ 02271000
*   /*                                                               */ 02272000
*   /*****************************************************************/ 02273000
*                                                                  0676 02274000
*   DCL                                                            0676 02275000
*     DS1TRACK BIT(1) DEFINED(DS1SCALO);/* DS ALLOC - TRKS   @Z40LB35*/ 02276000
*                                                                  0676 02277000
*   /*****************************************************************/ 02278000
*   /*                                                               */ 02279000
*   /* THE FOLLOWING BIT DEFINES THE ABSOLUTE                @Z40LB35*/ 02280000
*   /* TRACK ALLOCATION.                                     @Z40LB35*/ 02281000
*   /*                                                               */ 02282000
*   /*****************************************************************/ 02283000
*                                                                  0677 02284000
*   DCL                                                            0677 02285000
*     1 * DEFINED(DS1SCALO),        /*                       @Z40LB35*/ 02286000
*      2 * BIT(4),                  /*                       @Z40LB35*/ 02287000
*      2 DS1ABSTR BIT(1);           /* DS ALLOC-ABSOLUTE TRKS      0677 02288000
*                                                            @Z40LB35*/ 02289000
*                                                                  0677 02290000
*   /*****************************************************************/ 02291000
*   /*                                                               */ 02292000
*   /* THE FOLLOWING BIT DEFINES THE CYL UNIT BIT            @Z40LB35*/ 02293000
*   /*                                                               */ 02294000
*   /*****************************************************************/ 02295000
*                                                                  0678 02296000
*   DCL                                                            0678 02297000
*     1 DS1SCAL DEFINED(DS1SCALO),  /*                       @Z40LB35*/ 02298000
*      2 DS1CAL1 BIT(1),            /* DS ALLOC              @Z40LB35*/ 02299000
*      2 DS1CAL2 BIT(1);            /* DS ALLOC              @Z40LB35*/ 02300000
*   DCL                                                            0679 02301000
*     NOFMT3 BIT(1);                /* NO FMT 3 FOR DS       @Z40LB35*/ 02302000
*   DCL                                                            0680 02303000
*     FMT3 CHAR(LENGTH(IECSDSF3));  /* FMT 3 BUFFER          @Z40LB35*/ 02304000
*   DCL                                                            0681 02305000
*     DSNSCRAT FIXED(8) CONSTANT(16);/* DS SCRATCHED         @Z40LB35*/ 02306000
*                                                                  0681 02307000
*   /*****************************************************************/ 02308000
*   /*                                                               */ 02309000
*   /* THE FOLLOWING STRUCTURE DEFINES A DSCB                @Z40LB35*/ 02310000
*   /* DEB EXTENTS.                                          @Z40LB35*/ 02311000
*   /*                                                               */ 02312000
*   /*****************************************************************/ 02313000
*                                                                  0682 02314000
*   DCL                                                            0682 02315000
*     1 DSEXTS BASED(EXTENTP),      /*                       @Z40LB35*/ 02316000
*      2 * CHAR(2),                 /*                       @Z40LB35*/ 02317000
*      2 DSBG FIXED(31) BDY(BYTE),  /*                       @Z40LB35*/ 02318000
*       3 DSBGCYLS FIXED(15),       /* BEGINNING CYL         @Z40LB35*/ 02319000
*       3 DSBGTRKS FIXED(15),       /* BEGINNING TRACK       @Z40LB35*/ 02320000
*      2 DSENCYLS FIXED(15),        /* ENDING CYL            @Z40LB35*/ 02321000
*      2 DSENTRKS FIXED(15);        /* ENDING TRACK          @Z40LB35*/ 02322000
*                                                                  0682 02323000
*   /*****************************************************************/ 02324000
*   /*                                                               */ 02325000
*   /* THE FOLLOWING STRUCTURE DEFINES THE                   @Z40LB35*/ 02326000
*   /* LAST TTR OF LAST RECORD WRITTEN.                      @Z40LB35*/ 02327000
*   /*                                                               */ 02328000
*   /*****************************************************************/ 02329000
*                                                                  0683 02330000
*   DCL                                                            0683 02331000
*     1 * DEFINED(DS1LSTAR) BDY(BYTE),/*                     @Z40LB35*/ 02332000
*      2 DS1LSTTT FIXED(15),        /* LAST TRACK            @Z40LB35*/ 02333000
*      2 DS1LSTR FIXED(8);          /* LAST RECORD           @Z40LB35*/ 02334000
*   DCL                                                            0684 02335000
*     1 * DEFINED(DS1TRBAL) BDY(BYTE),/*                     @ZA29215*/ 02336000
*      2 DS1TBAL FIXED(15);         /* TRACK BALANCE         @ZA29215*/ 02337000
*   DCL                                                            0685 02338000
*     1 * DEFINED(DS1RECFM) BDY(BYTE),/*                     @Z40LB35*/ 02339000
*      2 * BIT(2),                  /* RESERVED              @Z40LB35*/ 02340000
*      2 DS1TRKOV BIT(1);           /* TRACK OVERFLOW        @Z40LB35*/ 02341000
*   DCL                                                            0686 02342000
*     EXTENTCT FIXED(31);           /* NUM OF EXTENTS CTR    @Z40LB35*/ 02343000
*   DCL                                                            0687 02344000
*     EXTELEM FIXED(31);            /* EXTENT ELEMENT        @Z40LB35*/ 02345000
*   DCL                                                            0688 02346000
*     FMT1EXTS FIXED(8) STATIC INITIAL(3);/*                 @Z40LB35   02347000
*                                      NUM OF PRIMARY EXTS.  @Z40LB35*/ 02348000
*   DCL                                                            0689 02349000
*     FMT3EXT1 FIXED(8) INITIAL(4); /*                       @Z40LB35   02350000
*                                      NUM OF FMT3 EXTS      @Z40LB35   02351000
*                                      IN FIRST PORTION      @Z40LB35*/ 02352000
*   DCL                                                            0690 02353000
*     FMT3EXT2 FIXED(8) INITIAL(9); /*                       @Z40LB35   02354000
*                                      NUM OF FMT3 EXTS      @Z40LB35   02355000
*                                      IN SECOND PORTION     @Z40LB35*/ 02356000
*   DCL                                                            0691 02357000
*     FMT3ID CHAR(1) INITIAL('F3'X);/*                       @Z40LB35   02358000
*                                      FMT3 IDENTIFIER       @Z40LB35*/ 02359000
*   DCL                                                            0692 02360000
*     NULLCCHH CHAR(5) STATIC INITIAL('0000000000'X);/*      @Z40LB35   02361000
*                                      NULL EXTENT           @Z40LB35*/ 02362000
*   DCL                                                            0693 02363000
*     EXTENTP PTR(31);              /* EXTENT POINTER        @Z40LB35*/ 02364000
*   DCL                                                            0694 02365000
*     STARTEXT FIXED(31);           /* START EXTENT          @Z40LB35*/ 02366000
*   DCL                                                            0695 02367000
*     ENDEXT FIXED(31);             /* END EXTENT            @Z40LB35*/ 02368000
*                                                                  0696 02369000
*   /*****************************************************************/ 02370000
*   /*                                                               */ 02371000
*   /* SET UP TRACE POINT 'VSUS' IN TRACE TABLE              @Z40LB35*/ 02372000
*   /*                                                               */ 02373000
*   /*****************************************************************/ 02374000
*                                                                  0696 02375000
*   OLDERID2=NEWERID2;                                             0696 02376000
         L     @10,@PC00001                                        0696 02377000
         L     @10,GDTTR2(,@10)                                    0696 02378000
         MVC   @TS00001(95),NEWERID2(@10)                          0696 02379000
         MVC   OLDERID2(95,@10),@TS00001                           0696 02380000
*   NEWID2='VSUS';                  /*                       @Z40LB35*/ 02381000
*                                                                  0697 02382000
         MVC   NEWID2(4,@10),@CC01404                              0697 02383000
*   /*****************************************************************/ 02384000
*   /*                                                               */ 02385000
*   /* THE FOLLOWING CODE WILL DETERMINE WHAT TYPE           @Z40LB35*/ 02386000
*   /* DATA SET WE HAVE AND SET THE PROPER TYPE              @Z40LB35*/ 02387000
*   /* IN VSDSTAT.                                           @Z40LB35*/ 02388000
*   /*                                                               */ 02389000
*   /*****************************************************************/ 02390000
*                                                                  0698 02391000
*   IF DS1DSPS=ON THEN              /*                       @Z40LB35*/ 02392000
         TM    DS1DSPS(F1PTR),B'01000000'                          0698 02393000
         BNO   @RF00698                                            0698 02394000
*     VSDOPS=ON;                    /*                       @Z40LB35*/ 02395000
         LR    @10,ELEMENT                                         0699 02396000
         MH    @10,@CH01471                                        0699 02397000
         L     @09,@PC00001+8                                      0699 02398000
         L     @09,VS3LISTP(,@09)                                  0699 02399000
         L     @09,VSDPTR(,@09)                                    0699 02400000
         AL    @09,@CF01486                                        0699 02401000
         LA    @10,VSDVARY-64(@10,@09)                             0699 02402000
         OI    VSDOPS(@10),B'01000000'                             0699 02403000
*   ELSE                            /*                       @Z40LB35*/ 02404000
*     IF DS1DSPO=ON THEN            /*                       @Z40LB35*/ 02405000
         B     @RC00698                                            0700 02406000
@RF00698 TM    DS1DSPO(F1PTR),B'00000010'                          0700 02407000
         BNO   @RF00700                                            0700 02408000
*       VSDOPO=ON;                  /*                       @Z40LB35*/ 02409000
         LR    @10,ELEMENT                                         0701 02410000
         MH    @10,@CH01471                                        0701 02411000
         L     @09,@PC00001+8                                      0701 02412000
         L     @09,VS3LISTP(,@09)                                  0701 02413000
         L     @09,VSDPTR(,@09)                                    0701 02414000
         AL    @09,@CF01486                                        0701 02415000
         LA    @10,VSDVARY-64(@10,@09)                             0701 02416000
         OI    VSDOPO(@10),B'10000000'                             0701 02417000
*     ELSE                          /*                       @Z40LB35*/ 02418000
*       IF DS1DSIS=ON THEN          /*                       @Z40LB35*/ 02419000
         B     @RC00700                                            0702 02420000
@RF00700 TM    DS1DSIS(F1PTR),B'10000000'                          0702 02421000
         BNO   @RF00702                                            0702 02422000
*         VSDOIS=ON;                /*                       @Z40LB35*/ 02423000
         LR    @10,ELEMENT                                         0703 02424000
         MH    @10,@CH01471                                        0703 02425000
         L     @09,@PC00001+8                                      0703 02426000
         L     @09,VS3LISTP(,@09)                                  0703 02427000
         L     @09,VSDPTR(,@09)                                    0703 02428000
         AL    @09,@CF01486                                        0703 02429000
         LA    @10,VSDVARY-64(@10,@09)                             0703 02430000
         OI    VSDOIS(@10),B'00001000'                             0703 02431000
*       ELSE                        /*                       @Z40LB35*/ 02432000
*         IF DS1DSDA=ON THEN        /*                       @Z40LB35*/ 02433000
         B     @RC00702                                            0704 02434000
@RF00702 TM    DS1DSDA(F1PTR),B'00100000'                          0704 02435000
         BNO   @RF00704                                            0704 02436000
*           VSDODA=ON;              /*                       @Z40LB35*/ 02437000
         LR    @10,ELEMENT                                         0705 02438000
         MH    @10,@CH01471                                        0705 02439000
         L     @09,@PC00001+8                                      0705 02440000
         L     @09,VS3LISTP(,@09)                                  0705 02441000
         L     @09,VSDPTR(,@09)                                    0705 02442000
         AL    @09,@CF01486                                        0705 02443000
         LA    @10,VSDVARY-64(@10,@09)                             0705 02444000
         OI    VSDODA(@10),B'00010000'                             0705 02445000
*         ELSE                      /*                       @Z40LB35*/ 02446000
*           VSDOUN=ON;              /*                       @Z40LB35*/ 02447000
*                                                                  0706 02448000
         B     @RC00704                                            0706 02449000
@RF00704 LR    @10,ELEMENT                                         0706 02450000
         MH    @10,@CH01471                                        0706 02451000
         L     @09,@PC00001+8                                      0706 02452000
         L     @09,VS3LISTP(,@09)                                  0706 02453000
         L     @09,VSDPTR(,@09)                                    0706 02454000
         AL    @09,@CF01486                                        0706 02455000
         LA    @10,VSDVARY-64(@10,@09)                             0706 02456000
         OI    VSDOUN(@10),B'00100000'                             0706 02457000
*   /*****************************************************************/ 02458000
*   /*                                                               */ 02459000
*   /* THE UNMOVEABLE BIT WILL BE SET IF DSN IS              @Z40LB35*/ 02460000
*   /* UNMOVEABLE                                            @Z40LB35*/ 02461000
*   /*                                                               */ 02462000
*   /*****************************************************************/ 02463000
*                                                                  0707 02464000
*   IF DS1DSU=ON THEN               /*                       @Z40LB35*/ 02465000
@RC00704 DS    0H                                                  0707 02466000
@RC00702 DS    0H                                                  0707 02467000
@RC00700 DS    0H                                                  0707 02468000
@RC00698 TM    DS1DSU(F1PTR),B'00000001'                           0707 02469000
         BNO   @RF00707                                            0707 02470000
*     VSDOU=ON;                     /*                       @Z40LB35*/ 02471000
*                                                                  0708 02472000
         LR    @10,ELEMENT                                         0708 02473000
         MH    @10,@CH01471                                        0708 02474000
         L     @09,@PC00001+8                                      0708 02475000
         L     @09,VS3LISTP(,@09)                                  0708 02476000
         L     @09,VSDPTR(,@09)                                    0708 02477000
         AL    @09,@CF01486                                        0708 02478000
         LA    @10,VSDVARY-64(@10,@09)                             0708 02479000
         OI    VSDOU(@10),B'00000100'                              0708 02480000
*   /*****************************************************************/ 02481000
*   /*                                                               */ 02482000
*   /* THE FOLLOWING CODE WILL DETERMINE WHAT TYPE           @Z40LB35*/ 02483000
*   /* UNIT ALLOCATION THE DATA SET HAS AND SET              @Z40LB35*/ 02484000
*   /* THE PROPER TYPE IN VSDSTAT.                           @Z40LB35*/ 02485000
*   /*                                                               */ 02486000
*   /*****************************************************************/ 02487000
*                                                                  0709 02488000
*   IF DS1CAL1=ON&DS1CAL2=ON THEN   /*                       @Z40LB35*/ 02489000
@RF00707 TM    DS1CAL1(F1PTR),B'11000000'                          0709 02490000
         BNO   @RF00709                                            0709 02491000
*     VSDACYL=ON;                   /*                       @Z40LB35*/ 02492000
         LR    @10,ELEMENT                                         0710 02493000
         MH    @10,@CH01471                                        0710 02494000
         L     @09,@PC00001+8                                      0710 02495000
         L     @09,VS3LISTP(,@09)                                  0710 02496000
         L     @09,VSDPTR(,@09)                                    0710 02497000
         AL    @09,@CF01486                                        0710 02498000
         LA    @10,VSDVARY-64(@10,@09)                             0710 02499000
         OI    VSDACYL(@10),B'10000000'                            0710 02500000
*   ELSE                            /*                       @Z40LB35*/ 02501000
*     IF DS1CAL1=ON&DS1CAL2=OFF THEN/*                       @Z40LB35*/ 02502000
         B     @RC00709                                            0711 02503000
@RF00709 TM    DS1CAL1(F1PTR),B'10000000'                          0711 02504000
         BNO   @RF00711                                            0711 02505000
         TM    DS1CAL2(F1PTR),B'01000000'                          0711 02506000
         BNZ   @RF00711                                            0711 02507000
*       VSDATRK=ON;                 /*                       @Z40LB35*/ 02508000
         LR    @10,ELEMENT                                         0712 02509000
         MH    @10,@CH01471                                        0712 02510000
         L     @09,@PC00001+8                                      0712 02511000
         L     @09,VS3LISTP(,@09)                                  0712 02512000
         L     @09,VSDPTR(,@09)                                    0712 02513000
         AL    @09,@CF01486                                        0712 02514000
         LA    @10,VSDVARY-64(@10,@09)                             0712 02515000
         OI    VSDATRK(@10),B'01000000'                            0712 02516000
*     ELSE                          /*                       @Z40LB35*/ 02517000
*       IF DS1CAL1=OFF&DS1CAL2=OFF THEN/*                    @Z40LB35*/ 02518000
         B     @RC00711                                            0713 02519000
@RF00711 TM    DS1CAL1(F1PTR),B'11000000'                          0713 02520000
         BNZ   @RF00713                                            0713 02521000
*         VSDABSTR=ON;              /*                       @Z40LB35*/ 02522000
         LR    @10,ELEMENT                                         0714 02523000
         MH    @10,@CH01471                                        0714 02524000
         L     @09,@PC00001+8                                      0714 02525000
         L     @09,VS3LISTP(,@09)                                  0714 02526000
         L     @09,VSDPTR(,@09)                                    0714 02527000
         AL    @09,@CF01486                                        0714 02528000
         LA    @10,VSDVARY-64(@10,@09)                             0714 02529000
         OI    VSDABSTR(@10),B'00010000'                           0714 02530000
*       ELSE                        /*                       @Z40LB35*/ 02531000
*         VSDABLK=ON;               /*                       @Z40LB35*/ 02532000
*                                                                  0715 02533000
         B     @RC00713                                            0715 02534000
@RF00713 LR    @10,ELEMENT                                         0715 02535000
         MH    @10,@CH01471                                        0715 02536000
         L     @09,@PC00001+8                                      0715 02537000
         L     @09,VS3LISTP(,@09)                                  0715 02538000
         L     @09,VSDPTR(,@09)                                    0715 02539000
         AL    @09,@CF01486                                        0715 02540000
         LA    @10,VSDVARY-64(@10,@09)                             0715 02541000
         OI    VSDABLK(@10),B'00100000'                            0715 02542000
*   /*****************************************************************/ 02543000
*   /*                                                               */ 02544000
*   /* THE SECONDARY UNIT ALLOCATION WILL BE SET             @Z40LB35*/ 02545000
*   /*                                                               */ 02546000
*   /*****************************************************************/ 02547000
*                                                                  0716 02548000
*   VSDSECAL=DS1SECAL;              /*                       @Z40LB35*/ 02549000
*                                                                  0716 02550000
@RC00713 DS    0H                                                  0716 02551000
@RC00711 DS    0H                                                  0716 02552000
@RC00709 LR    @10,ELEMENT                                         0716 02553000
         MH    @10,@CH01471                                        0716 02554000
         L     @09,@PC00001+8                                      0716 02555000
         L     @09,VS3LISTP(,@09)                                  0716 02556000
         L     @09,VSDPTR(,@09)                                    0716 02557000
         AL    @09,@CF01486                                        0716 02558000
         LA    @10,VSDVARY-64(@10,@09)                             0716 02559000
         SLR   @09,@09                                             0716 02560000
         ICM   @09,7,DS1SECAL(F1PTR)                               0716 02561000
         ST    @09,VSDSECAL(,@10)                                  0716 02562000
*   /*****************************************************************/ 02563000
*   /*                                                               */ 02564000
*   /* IF THE DATA SET IS NOT PARTITIONED OR                 @Z40LB35*/ 02565000
*   /* PHYSICAL SEQUENTIAL, THE UNABLE TO CALCULATE          @Z40LB35*/ 02566000
*   /* FREE SPACE BIT IS SET.                                @Z40LB35*/ 02567000
*   /*                                                               */ 02568000
*   /*****************************************************************/ 02569000
*                                                                  0717 02570000
*   IF DS1DSPO^=ON&DS1DSPS^=ON THEN /*                       @Z40LB35*/ 02571000
         TM    DS1DSPO(F1PTR),B'01000010'                          0717 02572000
         BNZ   @RF00717                                            0717 02573000
*     VSDCALFR=ON;                  /*                       @Z40LB35*/ 02574000
*                                                                  0718 02575000
         OI    VSDCALFR(@10),B'10000000'                           0718 02576000
*   /*****************************************************************/ 02577000
*   /*                                                               */ 02578000
*   /* IF THE DATA SET HAS TRACK OVERFLOW, THEN THE          @Z40LB35*/ 02579000
*   /* VSDCALFR IS SET TO INDICATE UNABLE TO CAL.            @Z40LB35*/ 02580000
*   /*                                                               */ 02581000
*   /*****************************************************************/ 02582000
*                                                                  0719 02583000
*   IF DS1TRKOV=ON THEN             /*                       @Z40LB35*/ 02584000
@RF00717 TM    DS1TRKOV(F1PTR),B'00100000'                         0719 02585000
         BNO   @RF00719                                            0719 02586000
*     VSDCALFR=ON;                  /*                       @Z40LB35*/ 02587000
*                                                                  0720 02588000
         LR    @10,ELEMENT                                         0720 02589000
         MH    @10,@CH01471                                        0720 02590000
         L     @09,@PC00001+8                                      0720 02591000
         L     @09,VS3LISTP(,@09)                                  0720 02592000
         L     @09,VSDPTR(,@09)                                    0720 02593000
         AL    @09,@CF01486                                        0720 02594000
         LA    @10,VSDVARY-64(@10,@09)                             0720 02595000
         OI    VSDCALFR(@10),B'10000000'                           0720 02596000
*   /*****************************************************************/ 02597000
*   /*                                                               */ 02598000
*   /* IF THERE IS A FMT3 FOR THE DATA SET AND               @Z40LB35*/ 02599000
*   /* THE SPACE CAN BE CALCULATED, THE UEXCP IS             @Z40LB35*/ 02600000
*   /* CALLED TO READ IT.                                    @Z40LB35*/ 02601000
*   /*                                                               */ 02602000
*   /*****************************************************************/ 02603000
*                                                                  0721 02604000
*   IF VSDCALFR^=ON&DS1PTRDS^=NULLCCHH THEN/*                @Z40LB35*/ 02605000
@RF00719 LR    @10,ELEMENT                                         0721 02606000
         MH    @10,@CH01471                                        0721 02607000
         L     @09,@PC00001+8                                      0721 02608000
         L     @09,VS3LISTP(,@09)                                  0721 02609000
         L     @09,VSDPTR(,@09)                                    0721 02610000
         AL    @09,@CF01486                                        0721 02611000
         LA    @10,VSDVARY-64(@10,@09)                             0721 02612000
         TM    VSDCALFR(@10),B'10000000'                           0721 02613000
         BO    @RF00721                                            0721 02614000
         CLC   DS1PTRDS(5,F1PTR),NULLCCHH                          0721 02615000
         BE    @RF00721                                            0721 02616000
*     DO;                           /*                       @Z40LB35*/ 02617000
*       NOFMT3=OFF;                 /*                       @Z40LB35*/ 02618000
         NI    NOFMT3,B'01111111'                                  0723 02619000
*       GETPTR=ADDR(EXGPARM2);      /*                       @Z40LB35*/ 02620000
         LA    GETPTR,EXGPARM2                                     0724 02621000
*       EXGARG=''B;                 /*                       @Z40LB35*/ 02622000
         XC    EXGARG(32,GETPTR),EXGARG(GETPTR)                    0725 02623000
*       EXGCTLBK=IOXPTR;            /*                       @Z40LB35*/ 02624000
         L     @10,IOXPTR                                          0726 02625000
         ST    @10,EXGCTLBK(,GETPTR)                               0726 02626000
*       EXGCCHH2=ADDR(DS1PTRDS);    /*                       @Z40LB35*/ 02627000
         LA    @10,DS1PTRDS(,F1PTR)                                0727 02628000
         ST    @10,EXGCCHH2(,GETPTR)                               0727 02629000
*       EXGRECNO=1;                 /*                       @Z40LB35*/ 02630000
         MVC   EXGRECNO(4,GETPTR),@CF00219                         0728 02631000
*       EXGDATAP=ADDR(FMT3);        /*                       @Z40LB35*/ 02632000
         LA    @10,FMT3                                            0729 02633000
         ST    @10,EXGDATAP(,GETPTR)                               0729 02634000
*       EXGKEYLN=LENGTH(DS1DSNAM);  /*                       @Z40LB35*/ 02635000
         MVI   EXGKEYLN(GETPTR),X'2C'                              0730 02636000
*       EXGDATAL=LENGTH(IECSDSL3)-LENGTH(DS1DSNAM);/*        @Z40LB35*/ 02637000
         MVC   EXGDATAL(2,GETPTR),@CH01243                         0731 02638000
*       CALL IDCIO050(GDTTBL,GET,EXGARG);/*                  @Z40LB35*/ 02639000
         L     @10,@PC00001                                        0732 02640000
         ST    @10,@AL00001                                        0732 02641000
         LA    @09,GET                                             0732 02642000
         ST    @09,@AL00001+4                                      0732 02643000
         ST    GETPTR,@AL00001+8                                   0732 02644000
         MVI   @AL00001+8,X'80'                                    0732 02645000
         L     @15,GDTEXP(,@10)                                    0732 02646000
         LA    @01,@AL00001                                        0732 02647000
         BALR  @14,@15                                             0732 02648000
*       RESPECIFY                                                  0733 02649000
*         RTNREG RSTD;                                             0733 02650000
*       TESTRC=RTNREG;                                             0734 02651000
         STH   RTNREG,TESTRC                                       0734 02652000
*       RESPECIFY                                                  0735 02653000
*         RTNREG UNRSTD;            /*                       @Z40LB35*/ 02654000
*       F3PTR=ADDR(FMT3);           /*                       @Z40LB35*/ 02655000
*                                                                  0736 02656000
         LA    F3PTR,FMT3                                          0736 02657000
*       /*************************************************************/ 02658000
*       /*                                                           */ 02659000
*       /* IF THE DSCB READ IS NOT A FMT3 DSCB               @Z40LB35*/ 02660000
*       /* THE CODE 16 IS SET BECAUSE THE DS WAS             @Z40LB35*/ 02661000
*       /* SCRATCHED OUT FROM UNDER US.                      @Z40LB35*/ 02662000
*       /*                                                           */ 02663000
*       /*************************************************************/ 02664000
*                                                                  0737 02665000
*       IF DS3FMTID^=FMT3ID&TESTRC=0 THEN/*                  @Z40LB35*/ 02666000
         CLC   DS3FMTID(1,F3PTR),FMT3ID                            0737 02667000
         BE    @RF00737                                            0737 02668000
         LH    @10,TESTRC                                          0737 02669000
         LTR   @10,@10                                             0737 02670000
         BNZ   @RF00737                                            0737 02671000
*         TESTRC=DSNSCRAT;          /*                       @Z40LB35*/ 02672000
         MVC   TESTRC(2),@CH00506                                  0738 02673000
*     END;                          /*                       @Z40LB35*/ 02674000
*                                                                  0739 02675000
*   /*****************************************************************/ 02676000
*   /*                                                               */ 02677000
*   /* OTHERWISE SET NO FMT3 DSCB SWITCH.                    @Z40LB35*/ 02678000
*   /*                                                               */ 02679000
*   /*****************************************************************/ 02680000
*                                                                  0740 02681000
*   ELSE                            /*                       @Z40LB35*/ 02682000
*     NOFMT3=ON;                    /*                       @Z40LB35*/ 02683000
*                                                                  0740 02684000
         B     @RC00721                                            0740 02685000
@RF00721 OI    NOFMT3,B'10000000'                                  0740 02686000
*   /*****************************************************************/ 02687000
*   /*                                                               */ 02688000
*   /* THE FOLLOWING CODE WILL CALCULATE THE                 @Z40LB35*/ 02689000
*   /* SPACE ALLOCATED BY THE DSN.                           @Z40LB35*/ 02690000
*   /*                                                               */ 02691000
*   /*****************************************************************/ 02692000
*                                                                  0741 02693000
*   EXTENTCT=0;                     /*                       @Z40LB35*/ 02694000
@RC00721 SLR   EXTENTCT,EXTENTCT                                   0741 02695000
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/ 02696000
         LH    @10,TESTRC                                          0742 02697000
         LTR   @10,@10                                             0742 02698000
         BNZ   @RF00742                                            0742 02699000
*     EXTENTP=ADDR(DS1EXT1);        /*                       @Z40LB35*/ 02700000
*                                                                  0743 02701000
         LA    EXTENTP,DS1EXT1(,F1PTR)                             0743 02702000
*   /*****************************************************************/ 02703000
*   /*                                                               */ 02704000
*   /* SEARCH THRU THE PRIMARY EXTENTS                       @Z40LB35*/ 02705000
*   /*                                                               */ 02706000
*   /*****************************************************************/ 02707000
*                                                                  0744 02708000
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/ 02709000
@RF00742 LH    @10,TESTRC                                          0744 02710000
         LTR   @10,@10                                             0744 02711000
         BNZ   @RF00744                                            0744 02712000
*     DO EXTELEM=1 TO FMT1EXTS WHILE DSBG^=0;/*              @Z40LB35*/ 02713000
         LA    EXTELEM,1                                           0745 02714000
         B     @DE00745                                            0745 02715000
@DL00745 ICM   @10,15,DSBG(EXTENTP)                                0745 02716000
         BZ    @DC00745                                            0745 02717000
*       STARTEXT=(DSBGCYLS*TRACKSIZ)+DSBGTRKS;/*             @Z40LB35*/ 02718000
         LH    @15,TRACKSIZ                                        0746 02719000
         LR    STARTEXT,@15                                        0746 02720000
         MH    STARTEXT,DSBGCYLS(,EXTENTP)                         0746 02721000
         AH    STARTEXT,DSBGTRKS(,EXTENTP)                         0746 02722000
*       ENDEXT=(DSENCYLS*TRACKSIZ)+DSENTRKS+1;/*             @Z40LB35*/ 02723000
         LA    @14,1                                               0747 02724000
         MH    @15,DSENCYLS(,EXTENTP)                              0747 02725000
         AH    @15,DSENTRKS(,EXTENTP)                              0747 02726000
         ALR   @15,@14                                             0747 02727000
         LR    ENDEXT,@15                                          0747 02728000
*       VSDTRKS=VSDTRKS+ENDEXT-STARTEXT;/*                   @Z40LB35*/ 02729000
         LR    @15,ELEMENT                                         0748 02730000
         MH    @15,@CH01471                                        0748 02731000
         L     @01,@PC00001+8                                      0748 02732000
         L     @01,VS3LISTP(,@01)                                  0748 02733000
         L     @01,VSDPTR(,@01)                                    0748 02734000
         AL    @01,@CF01486                                        0748 02735000
         LA    @15,VSDVARY-64(@15,@01)                             0748 02736000
         LR    @01,ENDEXT                                          0748 02737000
         AH    @01,VSDTRKS(,@15)                                   0748 02738000
         SLR   @01,STARTEXT                                        0748 02739000
         STH   @01,VSDTRKS(,@15)                                   0748 02740000
*       EXTENTCT=EXTENTCT+1;        /*                       @Z40LB35*/ 02741000
         ALR   EXTENTCT,@14                                        0749 02742000
*       EXTENTP=EXTENTP+LENGTH(DSEXTS);/*                    @Z40LB35*/ 02743000
         AL    EXTENTP,@CF00476                                    0750 02744000
*     END;                          /*                       @Z40LB35*/ 02745000
*                                                                  0751 02746000
         AL    EXTELEM,@CF00219                                    0751 02747000
@DE00745 SLR   @10,@10                                             0751 02748000
         IC    @10,FMT1EXTS                                        0751 02749000
         CR    EXTELEM,@10                                         0751 02750000
         BNH   @DL00745                                            0751 02751000
@DC00745 DS    0H                                                  0752 02752000
*   /*****************************************************************/ 02753000
*   /*                                                               */ 02754000
*   /* SEARCH THRU THE SECONDARY EXTENTS                     @Z40LB35*/ 02755000
*   /*                                                               */ 02756000
*   /*****************************************************************/ 02757000
*                                                                  0752 02758000
*   EXTENTP=ADDR(DS3EXTNT);         /*                       @Z40LB35*/ 02759000
@RF00744 LA    EXTENTP,DS3EXTNT(,F3PTR)                            0752 02760000
*   IF TESTRC=0&NOFMT3^=ON THEN     /*                       @Z40LB35*/ 02761000
         LH    @10,TESTRC                                          0753 02762000
         LTR   @10,@10                                             0753 02763000
         BNZ   @RF00753                                            0753 02764000
         TM    NOFMT3,B'10000000'                                  0753 02765000
         BO    @RF00753                                            0753 02766000
*     DO EXTELEM=1 TO FMT3EXT1 WHILE DSBG^=0;/*              @Z40LB35*/ 02767000
         LA    EXTELEM,1                                           0754 02768000
         B     @DE00754                                            0754 02769000
@DL00754 ICM   @10,15,DSBG(EXTENTP)                                0754 02770000
         BZ    @DC00754                                            0754 02771000
*       STARTEXT=(DSBGCYLS*TRACKSIZ)+DSBGTRKS;/*             @Z40LB35*/ 02772000
         LH    @15,TRACKSIZ                                        0755 02773000
         LR    STARTEXT,@15                                        0755 02774000
         MH    STARTEXT,DSBGCYLS(,EXTENTP)                         0755 02775000
         AH    STARTEXT,DSBGTRKS(,EXTENTP)                         0755 02776000
*       ENDEXT=(DSENCYLS*TRACKSIZ)+DSENTRKS+1;/*             @Z40LB35*/ 02777000
         LA    @14,1                                               0756 02778000
         MH    @15,DSENCYLS(,EXTENTP)                              0756 02779000
         AH    @15,DSENTRKS(,EXTENTP)                              0756 02780000
         ALR   @15,@14                                             0756 02781000
         LR    ENDEXT,@15                                          0756 02782000
*       VSDTRKS=VSDTRKS+ENDEXT-STARTEXT;/*                   @Z40LB35*/ 02783000
         LR    @15,ELEMENT                                         0757 02784000
         MH    @15,@CH01471                                        0757 02785000
         L     @01,@PC00001+8                                      0757 02786000
         L     @01,VS3LISTP(,@01)                                  0757 02787000
         L     @01,VSDPTR(,@01)                                    0757 02788000
         AL    @01,@CF01486                                        0757 02789000
         LA    @15,VSDVARY-64(@15,@01)                             0757 02790000
         LR    @01,ENDEXT                                          0757 02791000
         AH    @01,VSDTRKS(,@15)                                   0757 02792000
         SLR   @01,STARTEXT                                        0757 02793000
         STH   @01,VSDTRKS(,@15)                                   0757 02794000
*       EXTENTCT=EXTENTCT+1;        /*                       @Z40LB35*/ 02795000
         ALR   EXTENTCT,@14                                        0758 02796000
*       EXTENTP=EXTENTP+LENGTH(DSEXTS);/*                    @Z40LB35*/ 02797000
         AL    EXTENTP,@CF00476                                    0759 02798000
*     END;                          /*                       @Z40LB35*/ 02799000
*                                                                  0760 02800000
         AL    EXTELEM,@CF00219                                    0760 02801000
@DE00754 SLR   @10,@10                                             0760 02802000
         IC    @10,FMT3EXT1                                        0760 02803000
         CR    EXTELEM,@10                                         0760 02804000
         BNH   @DL00754                                            0760 02805000
@DC00754 DS    0H                                                  0761 02806000
*   /*****************************************************************/ 02807000
*   /*                                                               */ 02808000
*   /* SEARCH THRU THE LAST HALF OF SECONDARY EXTS           @Z40LB35*/ 02809000
*   /*                                                               */ 02810000
*   /*****************************************************************/ 02811000
*                                                                  0761 02812000
*   EXTENTP=ADDR(DS3ADEXT);         /*                       @Z40LB35*/ 02813000
@RF00753 LA    EXTENTP,DS3ADEXT(,F3PTR)                            0761 02814000
*   IF TESTRC=0&NOFMT3^=ON THEN     /*                       @Z40LB35*/ 02815000
         LH    @10,TESTRC                                          0762 02816000
         LTR   @10,@10                                             0762 02817000
         BNZ   @RF00762                                            0762 02818000
         TM    NOFMT3,B'10000000'                                  0762 02819000
         BO    @RF00762                                            0762 02820000
*     DO EXTELEM=1 TO FMT3EXT2 WHILE DSBG^=0;/*              @Z40LB35*/ 02821000
         LA    EXTELEM,1                                           0763 02822000
         B     @DE00763                                            0763 02823000
@DL00763 ICM   @10,15,DSBG(EXTENTP)                                0763 02824000
         BZ    @DC00763                                            0763 02825000
*       STARTEXT=(DSBGCYLS*TRACKSIZ)+DSBGTRKS;/*             @Z40LB35*/ 02826000
         LH    @15,TRACKSIZ                                        0764 02827000
         LR    STARTEXT,@15                                        0764 02828000
         MH    STARTEXT,DSBGCYLS(,EXTENTP)                         0764 02829000
         AH    STARTEXT,DSBGTRKS(,EXTENTP)                         0764 02830000
*       ENDEXT=(DSENCYLS*TRACKSIZ)+DSENTRKS+1;/*             @Z40LB35*/ 02831000
         LA    @14,1                                               0765 02832000
         MH    @15,DSENCYLS(,EXTENTP)                              0765 02833000
         AH    @15,DSENTRKS(,EXTENTP)                              0765 02834000
         ALR   @15,@14                                             0765 02835000
         LR    ENDEXT,@15                                          0765 02836000
*       VSDTRKS=VSDTRKS+ENDEXT-STARTEXT;/*                   @Z40LB35*/ 02837000
         LR    @15,ELEMENT                                         0766 02838000
         MH    @15,@CH01471                                        0766 02839000
         L     @01,@PC00001+8                                      0766 02840000
         L     @01,VS3LISTP(,@01)                                  0766 02841000
         L     @01,VSDPTR(,@01)                                    0766 02842000
         AL    @01,@CF01486                                        0766 02843000
         LA    @15,VSDVARY-64(@15,@01)                             0766 02844000
         LR    @01,ENDEXT                                          0766 02845000
         AH    @01,VSDTRKS(,@15)                                   0766 02846000
         SLR   @01,STARTEXT                                        0766 02847000
         STH   @01,VSDTRKS(,@15)                                   0766 02848000
*       EXTENTCT=EXTENTCT+1;        /*                       @Z40LB35*/ 02849000
         ALR   EXTENTCT,@14                                        0767 02850000
*       EXTENTP=EXTENTP+LENGTH(DSEXTS);/*                    @Z40LB35*/ 02851000
         AL    EXTENTP,@CF00476                                    0768 02852000
*     END;                          /*                       @Z40LB35*/ 02853000
         AL    EXTELEM,@CF00219                                    0769 02854000
@DE00763 SLR   @10,@10                                             0769 02855000
         IC    @10,FMT3EXT2                                        0769 02856000
         CR    EXTELEM,@10                                         0769 02857000
         BNH   @DL00763                                            0769 02858000
@DC00763 DS    0H                                                  0770 02859000
*   VSDEXTS=EXTENTCT;               /*                       @Z40LB35*/ 02860000
*                                                                  0770 02861000
@RF00762 LR    @10,ELEMENT                                         0770 02862000
         MH    @10,@CH01471                                        0770 02863000
         L     @09,@PC00001+8                                      0770 02864000
         L     @09,VS3LISTP(,@09)                                  0770 02865000
         L     @09,VSDPTR(,@09)                                    0770 02866000
         AL    @09,@CF01486                                        0770 02867000
         LA    @10,VSDVARY-64(@10,@09)                             0770 02868000
         STC   EXTENTCT,VSDEXTS(,@10)                              0770 02869000
*   /*****************************************************************/ 02870000
*   /*                                                               */ 02871000
*   /* CALCULATE FREE SPACE.                                 @Z40LB35*/ 02872000
*   /*                                                               */ 02873000
*   /*****************************************************************/ 02874000
*                                                                  0771 02875000
*   VSDFTRK=0;                      /* ZERO FREE SPACE       @ZA29215*/ 02876000
         SLR   @09,@09                                             0771 02877000
         STH   @09,VSDFTRK(,@10)                                   0771 02878000
*   IF TESTRC=0&VSDCALFR^=ON THEN   /*                       @Z40LB35*/ 02879000
         CH    @09,TESTRC                                          0772 02880000
         BNE   @RF00772                                            0772 02881000
         TM    VSDCALFR(@10),B'10000000'                           0772 02882000
         BO    @RF00772                                            0772 02883000
*     DO;                           /*                       @Z40LB35*/ 02884000
*       IF DS1LSTR^=0 THEN          /*                       @Z40LB35*/ 02885000
         CLI   DS1LSTR(F1PTR),0                                    0774 02886000
         BE    @RF00774                                            0774 02887000
*         VSDFTRK=VSDTRKS-(DS1LSTTT+1);/*                    @Z40LB35*/ 02888000
         LA    @09,1                                               0775 02889000
         ICM   @15,12,DS1LSTTT(F1PTR)                              0775 02890000
         SRA   @15,16                                              0775 02891000
         ALR   @09,@15                                             0775 02892000
         LCR   @09,@09                                             0775 02893000
         AH    @09,VSDTRKS(,@10)                                   0775 02894000
         STH   @09,VSDFTRK(,@10)                                   0775 02895000
*       ELSE                        /*                       @Z40LB35*/ 02896000
*         IF DS1TBAL^=0 THEN        /* IF NON-ZERO, VALID    @ZA29215*/ 02897000
         B     @RC00774                                            0776 02898000
@RF00774 ICM   @10,3,DS1TBAL(F1PTR)                                0776 02899000
         BZ    @RF00776                                            0776 02900000
*           VSDFTRK=VSDTRKS-DS1LSTTT;/*                      @Z40LB35*/ 02901000
         LR    @10,ELEMENT                                         0777 02902000
         MH    @10,@CH01471                                        0777 02903000
         L     @09,@PC00001+8                                      0777 02904000
         L     @09,VS3LISTP(,@09)                                  0777 02905000
         L     @09,VSDPTR(,@09)                                    0777 02906000
         AL    @09,@CF01486                                        0777 02907000
         LA    @10,VSDVARY-64(@10,@09)                             0777 02908000
         LH    @09,VSDTRKS(,@10)                                   0777 02909000
         ICM   @15,12,DS1LSTTT(F1PTR)                              0777 02910000
         SRA   @15,16                                              0777 02911000
         SLR   @09,@15                                             0777 02912000
         STH   @09,VSDFTRK(,@10)                                   0777 02913000
*         ELSE                      /* IF ZERO, INVALID      @ZA29215*/ 02914000
*           VSDCALFR=ON;            /* SET CANNOT CALCULATE  @ZA20215*/ 02915000
         B     @RC00776                                            0778 02916000
@RF00776 LR    @10,ELEMENT                                         0778 02917000
         MH    @10,@CH01471                                        0778 02918000
         L     @09,@PC00001+8                                      0778 02919000
         L     @09,VS3LISTP(,@09)                                  0778 02920000
         L     @09,VSDPTR(,@09)                                    0778 02921000
         AL    @09,@CF01486                                        0778 02922000
         LA    @10,VSDVARY-64(@10,@09)                             0778 02923000
         OI    VSDCALFR(@10),B'10000000'                           0778 02924000
*     END;                          /*                       @Z40LB35*/ 02925000
*                                                                  0779 02926000
@RC00776 DS    0H                                                  0779 02927000
@RC00774 DS    0H                                                  0780 02928000
*   /*****************************************************************/ 02929000
*   /*                                                               */ 02930000
*   /* CONTROL IS RETURNED TO SELECTOR WITH THE              @Z40LB35*/ 02931000
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/ 02932000
*   /*                                                               */ 02933000
*   /*****************************************************************/ 02934000
*                                                                  0780 02935000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 02936000
@RF00772 LH    @15,TESTRC                                          0780 02937000
         L     @14,@SA00010                                        0780 02938000
         LM    @00,@02,@SA00010+8                                  0780 02939000
         LM    @04,@07,@SA00010+20                                 0780 02940000
         LM    @09,@12,@SA00010+36                                 0780 02941000
         BR    @14                                                 0780 02942000
*   END USAGE;                      /*                       @Z40LB35*/ 02943000
*                                                                  0782 02944000
*/********************************************************************/ 02945000
*/*                                                          @Z40LB35*/ 02946000
*/* PROCEDURE NAME - STATUS                                  @Z40LB35*/ 02947000
*/*                                                          @Z40LB35*/ 02948000
*/* FUNCTION -  THIS PROCEDURE INITIALIZES THE VSDSTAT       @Z40LB35*/ 02949000
*/*             PORTION OF THE VSDBLOCK.                     @Z40LB35*/ 02950000
*/*                                                          @Z40LB35*/ 02951000
*/* INPUT -     DS1CREDT FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/ 02952000
*/*             DS1EXPDT FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/ 02953000
*/*             DS1DSIND FROM IECDSF1 OF THE DSCB FMT1       @Z40LB35*/ 02954000
*/*             LCTCREAT OF THE LCTINFO                      @Z40LB35*/ 02955000
*/*             LCTEXPIR OF THE LCTINFO                      @Z40LB35*/ 02956000
*/*             LCTVSCAT OF THE LCTINFO                      @Z40LB35*/ 02957000
*/*             LCTOWNER OF THE LCTINFO                      @Z40LB35*/ 02958000
*/*                                                          @Z40LB35*/ 02959000
*/* OUTPUT -    VSDCVSAM OF VSDSTAT                          @Z40LB35*/ 02960000
*/*             VSDCREAT OF VSDSTAT                          @Z40LB35*/ 02961000
*/*             VSDVTOCC OF VSDSTAT                          @Z40LB35*/ 02962000
*/*             VSDVTOCE OF VSDSTAT                          @Z40LB35*/ 02963000
*/*             VSDVSAMC OF VSDSTAT                          @Z40LB35*/ 02964000
*/*             VSDVSAME OF VSDSTAT                          @Z40LB35*/ 02965000
*/*             VSDVSAMC OF VSDSTAT                          @Z40LB35*/ 02966000
*/*             VSDEXPIR OF VSDSTAT                          @Z40LB35*/ 02967000
*/*             VSDCREAT OF VSDSTAT                          @Z40LB35*/ 02968000
*/*             VSDOWNER OF VSDSTAT                          @Z40LB35*/ 02969000
*/*             VSDPWR   OF VSDSTAT                          @Z40LB35*/ 02970000
*/*             VSDPWW   OF VSDSTAT                          @Z40LB35*/ 02971000
*/*             VSDPROT  OF VSDSTAT                          @Z40LB35*/ 02972000
*/*             VSDRACF  OF VSDSTAT                          @G24LB31*/ 02973000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 02974000
*/*                                                          @Z40LB35*/ 02975000
*/********************************************************************/ 02976000
*                                                                  0782 02977000
*                                   /*                       @Z40LB35*/ 02978000
*STATUS:                                                           0782 02979000
*   PROC;                           /*                       @Z40LB35*/ 02980000
*                                                                  0782 02981000
STATUS   STM   @14,@12,12(@13)                                     0782 02982000
*   /*****************************************************************/ 02983000
*   /*                                                               */ 02984000
*   /* THE FOLLOWING STRUCTURE MAPS THE PROTECTION           @Z40LB35*/ 02985000
*   /* BITS IN THE FMT1 DSCBS                                @Z40LB35*/ 02986000
*   /*                                                               */ 02987000
*   /*****************************************************************/ 02988000
*                                                                  0783 02989000
*   DCL                                                            0783 02990000
*     1 * DEFINED(DS1DSIND),        /*                       @Z40LB35*/ 02991000
*      2 * BIT(1),                  /*                       @G24LB31*/ 02992000
*      2 DS1RACF BIT(1),            /* RACF PROTECTED        @G24LB31*/ 02993000
*      2 * BIT(1),                  /*                       @G24LB31*/ 02994000
*      2 DS1PW BIT(1),              /* PROTECTED             @Z40LB35*/ 02995000
*      2 * BIT(1),                  /*                       @Z40LB35*/ 02996000
*      2 DS1PWW BIT(1);             /* WRITE PROTECTED       @Z40LB35*/ 02997000
*                                                                  0784 02998000
*   /*****************************************************************/ 02999000
*   /*                                                               */ 03000000
*   /* SET UP TRACE POINT 'VSST' IN TRACE TABLE              @Z40LB35*/ 03001000
*   /*                                                               */ 03002000
*   /*****************************************************************/ 03003000
*                                                                  0784 03004000
*   OLDERID2=NEWERID2;                                             0784 03005000
         L     @10,@PC00001                                        0784 03006000
         L     @10,GDTTR2(,@10)                                    0784 03007000
         MVC   @TS00001(95),NEWERID2(@10)                          0784 03008000
         MVC   OLDERID2(95,@10),@TS00001                           0784 03009000
*   NEWID2='VSST';                  /*                       @Z40LB35*/ 03010000
*                                                                  0785 03011000
         MVC   NEWID2(4,@10),@CC01415                              0785 03012000
*   /*****************************************************************/ 03013000
*   /*                                                               */ 03014000
*   /* IF THE DSN WAS LOCATED IN THE CATLG,                  @Z40LB35*/ 03015000
*   /* THE VSAM BIT IS CHECKED TO DETERMINE                  @Z40LB35*/ 03016000
*   /* IF THE DSN WAS FOUND IN THE VSAM                      @Z40LB35*/ 03017000
*   /* CATLG.                                                @Z40LB35*/ 03018000
*   /*                                                               */ 03019000
*   /*****************************************************************/ 03020000
*                                                                  0786 03021000
*   IF LOCATESW=ON THEN             /*                       @Z40LB35*/ 03022000
         TM    LOCATESW,B'10000000'                                0786 03023000
         BNO   @RF00786                                            0786 03024000
*     DO;                           /*                       @Z40LB35*/ 03025000
*       VSDCATLG=ON;                /*                       @Z40LB35*/ 03026000
         LR    @10,ELEMENT                                         0788 03027000
         MH    @10,@CH01471                                        0788 03028000
         L     @03,@PC00001+8                                      0788 03029000
         L     @03,VS3LISTP(,@03)                                  0788 03030000
         L     @03,VSDPTR(,@03)                                    0788 03031000
         AL    @03,@CF01486                                        0788 03032000
         LA    @10,VSDVARY-64(@10,@03)                             0788 03033000
         OI    VSDCATLG(@10),B'00001000'                           0788 03034000
*       IF LCTVSCAT=ON THEN         /*                       @Z40LB35*/ 03035000
*                                                                  0789 03036000
         LA    @03,LCTAREA                                         0789 03037000
         TM    LCTVSCAT(@03),B'10000000'                           0789 03038000
         BNO   @RF00789                                            0789 03039000
*         /***********************************************************/ 03040000
*         /*                                                         */ 03041000
*         /* IF THE DSN WAS FOUND IN THE VSAM CATLG,         @Z40LB35*/ 03042000
*         /* THE EXPIRATION AND CREATION DATES ARE           @Z40LB35*/ 03043000
*         /* COMPARED WITH THE DSCB TO FIND OUT WHICH        @Z40LB35*/ 03044000
*         /* HAS THE LATER DATES.                            @Z40LB35*/ 03045000
*         /*                                                         */ 03046000
*         /***********************************************************/ 03047000
*                                                                  0790 03048000
*         DO;                       /*                       @Z40LB35*/ 03049000
*           VSDCVSAM=ON;            /*                       @Z40LB35*/ 03050000
*                                                                  0791 03051000
         OI    VSDCVSAM(@10),B'00000100'                           0791 03052000
*           /*********************************************************/ 03053000
*           /*                                                       */ 03054000
*           /* IF THE VSAM CREATION DATE IS EQUAL OR         @Z40LB35*/ 03055000
*           /* GREATER, IT IS USED AND RETURNED TO           @Z40LB35*/ 03056000
*           /* THE CALLER.                                   @Z40LB35*/ 03057000
*           /*                                                       */ 03058000
*           /*********************************************************/ 03059000
*                                                                  0792 03060000
*           IF CATCREAT>=DSCREAT&CATCREAT^=NULLENTY THEN           0792 03061000
         L     @03,CATCREAT(,@03)                                  0792 03062000
         SLR   @15,@15                                             0792 03063000
         ICM   @15,7,DSCREAT(F1PTR)                                0792 03064000
         CR    @03,@15                                             0792 03065000
         BL    @RF00792                                            0792 03066000
         C     @03,NULLENTY                                        0792 03067000
         BE    @RF00792                                            0792 03068000
*             DO;                   /*                       @Z40LB35*/ 03069000
*               VSDCREAT=CATCREAT;  /*                       @Z40LB35*/ 03070000
         ST    @03,VSDCREAT(,@10)                                  0794 03071000
*               VSDVSAMC=ON;        /*                       @Z40LB35*/ 03072000
         OI    VSDVSAMC(@10),B'00100000'                           0795 03073000
*             END;                  /*                       @Z40LB35*/ 03074000
*                                                                  0796 03075000
*           /*********************************************************/ 03076000
*           /*                                                       */ 03077000
*           /* OTHERWISE THE FMT1 DSCB CREATION DATE         @Z40LB35*/ 03078000
*           /* IS RETURNED.                                  @Z40LB35*/ 03079000
*           /*                                                       */ 03080000
*           /*********************************************************/ 03081000
*                                                                  0797 03082000
*           ELSE                    /*                       @Z40LB35*/ 03083000
*             DO;                   /*                       @Z40LB35*/ 03084000
         B     @RC00792                                            0797 03085000
@RF00792 DS    0H                                                  0798 03086000
*               VSDCREAT=DSCREAT;   /*                       @Z40LB35*/ 03087000
         LR    @10,ELEMENT                                         0798 03088000
         MH    @10,@CH01471                                        0798 03089000
         L     @03,@PC00001+8                                      0798 03090000
         L     @03,VS3LISTP(,@03)                                  0798 03091000
         L     @03,VSDPTR(,@03)                                    0798 03092000
         AL    @03,@CF01486                                        0798 03093000
         LA    @10,VSDVARY-64(@10,@03)                             0798 03094000
         SLR   @03,@03                                             0798 03095000
         ICM   @03,7,DSCREAT(F1PTR)                                0798 03096000
         ST    @03,VSDCREAT(,@10)                                  0798 03097000
*               VSDVTOCC=ON;        /*                       @Z40LB35*/ 03098000
         OI    VSDVTOCC(@10),B'10000000'                           0799 03099000
*             END;                  /*                       @Z40LB35*/ 03100000
*                                                                  0800 03101000
*           /*********************************************************/ 03102000
*           /*                                                       */ 03103000
*           /* IF BOTH DATES ARE EQUAL, THEN SET             @Z40LB35*/ 03104000
*           /* BOTH BITS INDICATING TO THE CALLER            @Z40LB35*/ 03105000
*           /* THAT THEY ARE EQUAL.                          @Z40LB35*/ 03106000
*           /*                                                       */ 03107000
*           /*********************************************************/ 03108000
*                                                                  0801 03109000
*           IF CATCREAT=DSCREAT&CATCREAT^=NULLENTY THEN            0801 03110000
@RC00792 LA    @10,LCTAREA                                         0801 03111000
         L     @10,CATCREAT(,@10)                                  0801 03112000
         SLR   @03,@03                                             0801 03113000
         ICM   @03,7,DSCREAT(F1PTR)                                0801 03114000
         CR    @10,@03                                             0801 03115000
         BNE   @RF00801                                            0801 03116000
         C     @10,NULLENTY                                        0801 03117000
         BE    @RF00801                                            0801 03118000
*             VSDVTOCC=ON;          /*                       @Z40LB35*/ 03119000
*                                                                  0802 03120000
         LR    @10,ELEMENT                                         0802 03121000
         MH    @10,@CH01471                                        0802 03122000
         L     @03,@PC00001+8                                      0802 03123000
         L     @03,VS3LISTP(,@03)                                  0802 03124000
         L     @03,VSDPTR(,@03)                                    0802 03125000
         AL    @03,@CF01486                                        0802 03126000
         LA    @10,VSDVARY-64(@10,@03)                             0802 03127000
         OI    VSDVTOCC(@10),B'10000000'                           0802 03128000
*           /*********************************************************/ 03129000
*           /*                                                       */ 03130000
*           /* IF THE VSAM EXPIRATION DATE IS EQUAL OR       @Z40LB35*/ 03131000
*           /* GREATER, IT IS USED AND RETURNED TO           @Z40LB35*/ 03132000
*           /* THE CALLER.                                   @Z40LB35*/ 03133000
*           /*                                                       */ 03134000
*           /*********************************************************/ 03135000
*                                                                  0803 03136000
*           IF CATEXPIR>=DSEXPIR&CATEXPIR^=NULLENTY THEN           0803 03137000
@RF00801 LA    @10,LCTAREA                                         0803 03138000
         L     @10,CATEXPIR(,@10)                                  0803 03139000
         SLR   @03,@03                                             0803 03140000
         ICM   @03,7,DSEXPIR(F1PTR)                                0803 03141000
         CR    @10,@03                                             0803 03142000
         BL    @RF00803                                            0803 03143000
         C     @10,NULLENTY                                        0803 03144000
         BE    @RF00803                                            0803 03145000
*             DO;                   /*                       @Z40LB35*/ 03146000
*               VSDEXPIR=CATEXPIR;  /*                       @Z40LB35*/ 03147000
         LR    @03,ELEMENT                                         0805 03148000
         MH    @03,@CH01471                                        0805 03149000
         L     @15,@PC00001+8                                      0805 03150000
         L     @01,VS3LISTP(,@15)                                  0805 03151000
         L     @01,VSDPTR(,@01)                                    0805 03152000
         AL    @01,@CF01486                                        0805 03153000
         LA    @03,VSDVARY-64(@03,@01)                             0805 03154000
         ST    @10,VSDEXPIR(,@03)                                  0805 03155000
*               VSDVSAME=ON;        /*                       @Z40LB35*/ 03156000
         OI    VSDVSAME(@03),B'00010000'                           0806 03157000
*             END;                  /*                       @Z40LB35*/ 03158000
*                                                                  0807 03159000
*           /*********************************************************/ 03160000
*           /*                                                       */ 03161000
*           /* OTHERWISE THE FMT1 DSCB EXPIRATION DATE       @Z40LB35*/ 03162000
*           /* IS RETURNED.                                  @Z40LB35*/ 03163000
*           /*                                                       */ 03164000
*           /*********************************************************/ 03165000
*                                                                  0808 03166000
*           ELSE                    /*                       @Z40LB35*/ 03167000
*             DO;                   /*                       @Z40LB35*/ 03168000
         B     @RC00803                                            0808 03169000
@RF00803 DS    0H                                                  0809 03170000
*               VSDEXPIR=DSEXPIR;   /*                       @Z40LB35*/ 03171000
         LR    @10,ELEMENT                                         0809 03172000
         MH    @10,@CH01471                                        0809 03173000
         L     @03,@PC00001+8                                      0809 03174000
         L     @03,VS3LISTP(,@03)                                  0809 03175000
         L     @03,VSDPTR(,@03)                                    0809 03176000
         AL    @03,@CF01486                                        0809 03177000
         LA    @10,VSDVARY-64(@10,@03)                             0809 03178000
         SLR   @03,@03                                             0809 03179000
         ICM   @03,7,DSEXPIR(F1PTR)                                0809 03180000
         ST    @03,VSDEXPIR(,@10)                                  0809 03181000
*               VSDVTOCE=ON;        /*                       @Z40LB35*/ 03182000
         OI    VSDVTOCE(@10),B'01000000'                           0810 03183000
*             END;                  /*                       @Z40LB35*/ 03184000
*                                                                  0811 03185000
*           /*********************************************************/ 03186000
*           /*                                                       */ 03187000
*           /* IF BOTH DATES ARE EQUAL, THEN SET             @Z40LB35*/ 03188000
*           /* BOTH BITS INDICATING TO THE CALLER            @Z40LB35*/ 03189000
*           /* THAT THEY ARE EQUAL.                          @Z40LB35*/ 03190000
*           /*                                                       */ 03191000
*           /*********************************************************/ 03192000
*                                                                  0812 03193000
*           IF CATEXPIR=DSEXPIR&CATEXPIR^=NULLENTY THEN            0812 03194000
@RC00803 LA    @10,LCTAREA                                         0812 03195000
         L     @10,CATEXPIR(,@10)                                  0812 03196000
         SLR   @03,@03                                             0812 03197000
         ICM   @03,7,DSEXPIR(F1PTR)                                0812 03198000
         CR    @10,@03                                             0812 03199000
         BNE   @RF00812                                            0812 03200000
         C     @10,NULLENTY                                        0812 03201000
         BE    @RF00812                                            0812 03202000
*             VSDVTOCE=ON;          /*                       @Z40LB35*/ 03203000
         LR    @10,ELEMENT                                         0813 03204000
         MH    @10,@CH01471                                        0813 03205000
         L     @03,@PC00001+8                                      0813 03206000
         L     @03,VS3LISTP(,@03)                                  0813 03207000
         L     @03,VSDPTR(,@03)                                    0813 03208000
         AL    @03,@CF01486                                        0813 03209000
         LA    @10,VSDVARY-64(@10,@03)                             0813 03210000
         OI    VSDVTOCE(@10),B'01000000'                           0813 03211000
*           VSDOWNER=LCTOWNER;      /*                       @Z40LB35*/ 03212000
@RF00812 LR    @10,ELEMENT                                         0814 03213000
         MH    @10,@CH01471                                        0814 03214000
         L     @03,@PC00001+8                                      0814 03215000
         L     @03,VS3LISTP(,@03)                                  0814 03216000
         L     @03,VSDPTR(,@03)                                    0814 03217000
         AL    @03,@CF01486                                        0814 03218000
         LA    @10,VSDVARY-64(@10,@03)                             0814 03219000
         LA    @03,LCTAREA                                         0814 03220000
         MVC   VSDOWNER(8,@10),LCTOWNER(@03)                       0814 03221000
*         END;                      /*                       @Z40LB35*/ 03222000
*       ELSE                        /*                       @Z40LB35*/ 03223000
*         DO;                       /*                       @Z40LB35*/ 03224000
         B     @RC00789                                            0816 03225000
@RF00789 DS    0H                                                  0817 03226000
*           VSDOWNER=BLANK;         /*                       @Z40LB35*/ 03227000
         LR    @10,ELEMENT                                         0817 03228000
         MH    @10,@CH01471                                        0817 03229000
         L     @03,@PC00001+8                                      0817 03230000
         L     @03,VS3LISTP(,@03)                                  0817 03231000
         L     @03,VSDPTR(,@03)                                    0817 03232000
         AL    @03,@CF01486                                        0817 03233000
         LA    @10,VSDVARY-64(@10,@03)                             0817 03234000
         MVI   VSDOWNER+1(@10),C' '                                0817 03235000
         MVC   VSDOWNER+2(6,@10),VSDOWNER+1(@10)                   0817 03236000
         MVC   VSDOWNER(1,@10),BLANK                               0817 03237000
*           VSDVTOCC=ON;            /*                       @Z40LB35*/ 03238000
*           VSDVTOCE=ON;            /*                       @Z40LB35*/ 03239000
         OI    VSDVTOCC(@10),B'11000000'                           0819 03240000
*           VSDCREAT=DSCREAT;       /*                       @Z40LB35*/ 03241000
         SLR   @03,@03                                             0820 03242000
         ICM   @03,7,DSCREAT(F1PTR)                                0820 03243000
         ST    @03,VSDCREAT(,@10)                                  0820 03244000
*           VSDEXPIR=DSEXPIR;       /*                       @Z40LB35*/ 03245000
         SLR   @03,@03                                             0821 03246000
         ICM   @03,7,DSEXPIR(F1PTR)                                0821 03247000
         ST    @03,VSDEXPIR(,@10)                                  0821 03248000
*         END;                      /*                       @Z40LB35*/ 03249000
*     END;                          /*                       @Z40LB35*/ 03250000
*                                                                  0823 03251000
*   /*****************************************************************/ 03252000
*   /*                                                               */ 03253000
*   /* IF DSN NOT FOUND IN A CATLG, THE DATES                @Z40LB35*/ 03254000
*   /* FOUND IN THE FMT1 DSCB ARE RETURNED.                  @Z40LB35*/ 03255000
*   /*                                                               */ 03256000
*   /*****************************************************************/ 03257000
*                                                                  0824 03258000
*   ELSE                            /*                       @Z40LB35*/ 03259000
*     DO;                           /*                       @Z40LB35*/ 03260000
         B     @RC00786                                            0824 03261000
@RF00786 DS    0H                                                  0825 03262000
*       VSDOWNER=BLANK;             /*                       @Z40LB35*/ 03263000
         LR    @10,ELEMENT                                         0825 03264000
         MH    @10,@CH01471                                        0825 03265000
         L     @03,@PC00001+8                                      0825 03266000
         L     @03,VS3LISTP(,@03)                                  0825 03267000
         L     @03,VSDPTR(,@03)                                    0825 03268000
         AL    @03,@CF01486                                        0825 03269000
         LA    @10,VSDVARY-64(@10,@03)                             0825 03270000
         MVI   VSDOWNER+1(@10),C' '                                0825 03271000
         MVC   VSDOWNER+2(6,@10),VSDOWNER+1(@10)                   0825 03272000
         MVC   VSDOWNER(1,@10),BLANK                               0825 03273000
*       VSDVTOCC=ON;                /*                       @Z40LB35*/ 03274000
*       VSDVTOCE=ON;                /*                       @Z40LB35*/ 03275000
         OI    VSDVTOCC(@10),B'11000000'                           0827 03276000
*       VSDCREAT=DSCREAT;           /*                       @Z40LB35*/ 03277000
         SLR   @03,@03                                             0828 03278000
         ICM   @03,7,DSCREAT(F1PTR)                                0828 03279000
         ST    @03,VSDCREAT(,@10)                                  0828 03280000
*       VSDEXPIR=DSEXPIR;           /*                       @Z40LB35*/ 03281000
         SLR   @03,@03                                             0829 03282000
         ICM   @03,7,DSEXPIR(F1PTR)                                0829 03283000
         ST    @03,VSDEXPIR(,@10)                                  0829 03284000
*     END;                          /*                       @Z40LB35*/ 03285000
*                                                                  0830 03286000
*   /*****************************************************************/ 03287000
*   /*                                                               */ 03288000
*   /* HERE THE DSN IS TESTED TO DETERMINE                   @Z40LB35*/ 03289000
*   /* WHETHER OR NOT THE DSN IS PROTECTED.                  @Z40LB35*/ 03290000
*   /*                                                               */ 03291000
*   /*****************************************************************/ 03292000
*                                                                  0831 03293000
*   IF(DS1PW=ON)|(DS1RACF=ON) THEN  /*                       @G24LB31*/ 03294000
*                                                                  0831 03295000
@RC00786 TM    DS1PW(F1PTR),B'01010000'                            0831 03296000
         BZ    @RF00831                                            0831 03297000
*     /***************************************************************/ 03298000
*     /*                                                             */ 03299000
*     /* IF THE DSN IS PROTECTED, THE TYPE PROTECTION        @Z40LB35*/ 03300000
*     /* IS RETURNED.                                        @Z40LB35*/ 03301000
*     /*                                                             */ 03302000
*     /***************************************************************/ 03303000
*                                                                  0832 03304000
*     DO;                           /*                       @Z40LB35*/ 03305000
*       VSDPROT=ON;                 /*                       @Z40LB35*/ 03306000
         LR    @10,ELEMENT                                         0833 03307000
         MH    @10,@CH01471                                        0833 03308000
         L     @03,@PC00001+8                                      0833 03309000
         L     @03,VS3LISTP(,@03)                                  0833 03310000
         L     @03,VSDPTR(,@03)                                    0833 03311000
         AL    @03,@CF01486                                        0833 03312000
         LA    @10,VSDVARY-64(@10,@03)                             0833 03313000
         OI    VSDPROT(@10),B'00100000'                            0833 03314000
*       IF DS1RACF=ON THEN          /*                       @G24LB31*/ 03315000
         TM    DS1RACF(F1PTR),B'01000000'                          0834 03316000
         BNO   @RF00834                                            0834 03317000
*         VSDRACF=ON;               /* RACF                  @G24LB31*/ 03318000
         OI    VSDRACF(@10),B'00001000'                            0835 03319000
*       IF DS1PWW=ON THEN           /*                       @Z40LB35*/ 03320000
@RF00834 TM    DS1PWW(F1PTR),B'00000100'                           0836 03321000
         BNO   @RF00836                                            0836 03322000
*         VSDPWW=ON;                /* WRITE                 @G24LB31*/ 03323000
         LR    @10,ELEMENT                                         0837 03324000
         MH    @10,@CH01471                                        0837 03325000
         L     @03,@PC00001+8                                      0837 03326000
         L     @03,VS3LISTP(,@03)                                  0837 03327000
         L     @03,VSDPTR(,@03)                                    0837 03328000
         AL    @03,@CF01486                                        0837 03329000
         LA    @10,VSDVARY-64(@10,@03)                             0837 03330000
         OI    VSDPWW(@10),B'01000000'                             0837 03331000
*       ELSE                        /*                       @G24LB31*/ 03332000
*         IF DS1PW=ON THEN          /*                       @G24LB31*/ 03333000
         B     @RC00836                                            0838 03334000
@RF00836 TM    DS1PW(F1PTR),B'00010000'                            0838 03335000
         BNO   @RF00838                                            0838 03336000
*           VSDPWR=ON;              /* READ/WRITE            @G24LB31*/ 03337000
         LR    @10,ELEMENT                                         0839 03338000
         MH    @10,@CH01471                                        0839 03339000
         L     @03,@PC00001+8                                      0839 03340000
         L     @03,VS3LISTP(,@03)                                  0839 03341000
         L     @03,VSDPTR(,@03)                                    0839 03342000
         AL    @03,@CF01486                                        0839 03343000
         LA    @10,VSDVARY-64(@10,@03)                             0839 03344000
         OI    VSDPWR(@10),B'10000000'                             0839 03345000
*     END;                          /*                       @Z40LB35*/ 03346000
*                                                                  0840 03347000
@RF00838 DS    0H                                                  0840 03348000
@RC00836 DS    0H                                                  0841 03349000
*   /*****************************************************************/ 03350000
*   /*                                                               */ 03351000
*   /* CONTROL IS RETURNED TO SELECTOR WITH THE CODE         @Z40LB35*/ 03352000
*   /* ZERO BECAUSE THERE ARE NO LOGICAL ERRORS              @Z40LB35*/ 03353000
*   /* POSSIBLE.                                             @Z40LB35*/ 03354000
*   /*                                                               */ 03355000
*   /*****************************************************************/ 03356000
*                                                                  0841 03357000
*   RETURN CODE(0);                 /*                       @Z40LB35*/ 03358000
@RF00831 SLR   @15,@15                                             0841 03359000
         L     @14,12(,@13)                                        0841 03360000
         LM    @00,@12,20(@13)                                     0841 03361000
         BR    @14                                                 0841 03362000
*   END STATUS;                     /*                       @Z40LB35*/ 03363000
*                                                                  0843 03364000
*/********************************************************************/ 03365000
*/*                                                          @Z40LB35*/ 03366000
*/* PROCEDURE NAME - CATLG                                   @Z40LB35*/ 03367000
*/*                                                          @Z40LB35*/ 03368000
*/* FUNCTION -  THIS PROCEDURE ISSUES ULOCATE AND DETERMINES @Z40LB35*/ 03369000
*/*             IF A DATA SET IS CATALOGED IN A VSAM OR OS   @Z40LB35*/ 03370000
*/*             CATALOG.                                     @Z40LB35*/ 03371000
*/*                                                          @Z40LB35*/ 03372000
*/* INPUT -     VS3SCR   OF THE VS3AGL                       @Z40LB35*/ 03373000
*/*             VS3UNCAT OF THE VS3AGL                       @Z40LB35*/ 03374000
*/*             VS3DEV   OF THE VS3AGL                       @Z40LB35*/ 03375000
*/*             VS3VOL   OF THE VS3AGL                       @Z40LB35*/ 03376000
*/*             DS1DSNAM OF THE IECDSF1 DSCB FMT 1           @Z40LB35*/ 03377000
*/*             LCTVSCAT OF THE LCTINFO                      @Z40LB35*/ 03378000
*/*                                                          @Z40LB35*/ 03379000
*/* OUTPUT -    VSDVSAMC OF VSDSCR                           @Z40LB35*/ 03380000
*/*             REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 03381000
*/*                           8, ERROR IN ULOCATE            @Z40LB35*/ 03382000
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/ 03383000
*/*                                                          @Z40LB35*/ 03384000
*/********************************************************************/ 03385000
*                                                                  0843 03386000
*                                   /*                       @Z40LB35*/ 03387000
*CATLG:                                                            0843 03388000
*   PROC;                           /*                       @Z40LB35*/ 03389000
CATLG    STM   @14,@12,@SA00012                                    0843 03390000
*                                                                  0844 03391000
*   /*****************************************************************/ 03392000
*   /*                                                               */ 03393000
*   /* SET UP TRACE POINT 'VSCG' IN TRACE TABLE              @Z40LB35*/ 03394000
*   /*                                                               */ 03395000
*   /*****************************************************************/ 03396000
*                                                                  0844 03397000
*   OLDERID2=NEWERID2;                                             0844 03398000
         L     @10,@PC00001                                        0844 03399000
         L     @03,GDTTR2(,@10)                                    0844 03400000
         MVC   @TS00001(95),NEWERID2(@03)                          0844 03401000
         MVC   OLDERID2(95,@03),@TS00001                           0844 03402000
*   NEWID2='VSCG';                  /*                       @Z40LB35*/ 03403000
*                                                                  0845 03404000
         MVC   NEWID2(4,@03),@CC01419                              0845 03405000
*   /*****************************************************************/ 03406000
*   /*                                                               */ 03407000
*   /* INITIALIZE THE LOCATE IN CATLG SWITCH OFF.            @Z40LB35*/ 03408000
*   /*                                                               */ 03409000
*   /*****************************************************************/ 03410000
*                                                                  0846 03411000
*   LOCATESW=OFF;                   /*                       @Z40LB35*/ 03412000
*                                                                  0846 03413000
         NI    LOCATESW,B'01111111'                                0846 03414000
*   /*****************************************************************/ 03415000
*   /*                                                               */ 03416000
*   /* ISSUE ULOCATE TO DETERMINE WHETHER A DSN              @Z40LB35*/ 03417000
*   /* IS CATLG OR NOT.                                      @Z40LB35*/ 03418000
*   /*                                                               */ 03419000
*   /*****************************************************************/ 03420000
*                                                                  0847 03421000
*   LCTINFO=''B;                    /*                       @Z40LB35*/ 03422000
         LA    @03,LCTAREA                                         0847 03423000
         XC    LCTINFO(33,@03),LCTINFO(@03)                        0847 03424000
*   LCTINFOP=ADDR(LCTINFO);         /*                       @Z40LB35*/ 03425000
         ST    @03,LCTINFOP                                        0848 03426000
*   CALL IDCSALC0(GDTTBL,DS1DSNAM,VS3VOL,VS3DEV,LCTINFOP);/* @Z40LB35*/ 03427000
         ST    @10,@AL00001                                        0849 03428000
         ST    F1PTR,@AL00001+4                                    0849 03429000
         L     @03,@PC00001+8                                      0849 03430000
         LA    @15,VS3VOL(,@03)                                    0849 03431000
         ST    @15,@AL00001+8                                      0849 03432000
         LA    @03,VS3DEV(,@03)                                    0849 03433000
         ST    @03,@AL00001+12                                     0849 03434000
         LA    @03,LCTINFOP                                        0849 03435000
         ST    @03,@AL00001+16                                     0849 03436000
         MVI   @AL00001+16,X'80'                                   0849 03437000
         L     @15,GDTLOC(,@10)                                    0849 03438000
         LA    @01,@AL00001                                        0849 03439000
         BALR  @14,@15                                             0849 03440000
*   RESPECIFY                                                      0850 03441000
*     RTNREG RSTD;                                                 0850 03442000
*   TESTRC=RTNREG;                                                 0851 03443000
         STH   RTNREG,TESTRC                                       0851 03444000
*   RESPECIFY                                                      0852 03445000
*     RTNREG UNRSTD;                /*                       @Z40LB35*/ 03446000
*                                                                  0852 03447000
*   /*****************************************************************/ 03448000
*   /*                                                               */ 03449000
*   /* IF A DSN IS CATLG AND THE USER WANTED                 @Z40LB35*/ 03450000
*   /* ONLY DSNS THAT ARE NOT CATLG, THE DOES NOT            @Z40LB35*/ 03451000
*   /* MEET THE CRITERION CODE IS SET.                       @Z40LB35*/ 03452000
*   /*                                                               */ 03453000
*   /*****************************************************************/ 03454000
*                                                                  0853 03455000
*   IF TESTRC=0&VS3UNCAT=ON THEN    /*                       @Z40LB35*/ 03456000
         LH    @10,TESTRC                                          0853 03457000
         LTR   @10,@10                                             0853 03458000
         BNZ   @RF00853                                            0853 03459000
         L     @10,@PC00001+8                                      0853 03460000
         TM    VS3UNCAT(@10),B'00010000'                           0853 03461000
         BNO   @RF00853                                            0853 03462000
*     TESTRC=NOMEET;                /*                       @Z40LB35*/ 03463000
*                                                                  0854 03464000
         LH    @10,NOMEET                                          0854 03465000
         STH   @10,TESTRC                                          0854 03466000
*   /*****************************************************************/ 03467000
*   /*                                                               */ 03468000
*   /* IF THE DSN WAS LOCATED IN A CATLG,                    @Z40LB35*/ 03469000
*   /* THE VOLUME COUNT IS MOVED INTO                        @Z40LB35*/ 03470000
*   /* THE VSDBLOCK.                                         @Z40LB35*/ 03471000
*   /*                                                               */ 03472000
*   /*****************************************************************/ 03473000
*                                                                  0855 03474000
*   IF TESTRC=0 THEN                /*                       @Z40LB35*/ 03475000
@RF00853 LH    @10,TESTRC                                          0855 03476000
         LTR   @10,@10                                             0855 03477000
         BNZ   @RF00855                                            0855 03478000
*     DO;                           /*                       @Z40LB35*/ 03479000
*       VSDVOLCT(ELEMENT)=LCTMULVC; /*                       @Z40LB35*/ 03480000
         LR    @10,ELEMENT                                         0857 03481000
         MH    @10,@CH01471                                        0857 03482000
         L     @03,@PC00001+8                                      0857 03483000
         L     @03,VS3LISTP(,@03)                                  0857 03484000
         L     @03,VSDPTR(,@03)                                    0857 03485000
         LA    @15,LCTAREA                                         0857 03486000
         L     @15,LCTMULVC(,@15)                                  0857 03487000
         AL    @03,@CF01485                                        0857 03488000
         ST    @15,VSDVOLCT-16(@10,@03)                            0857 03489000
*       LOCATESW=ON;                /*                       @Z40LB35*/ 03490000
         OI    LOCATESW,B'10000000'                                0858 03491000
*     END;                          /*                       @Z40LB35*/ 03492000
*                                                                  0859 03493000
*   /*****************************************************************/ 03494000
*   /*                                                               */ 03495000
*   /* IF THE DSN WAS NOT LOCATED IN A CATLG,                @Z40LB35*/ 03496000
*   /* THE VOLUME COUNT IS SET TO ONE.                       @Z40LB35*/ 03497000
*   /*                                                               */ 03498000
*   /*****************************************************************/ 03499000
*                                                                  0860 03500000
*   ELSE                            /*                       @Z40LB35*/ 03501000
*     VSDVOLCT(ELEMENT)=1;          /*                       @Z40LB35*/ 03502000
*                                                                  0860 03503000
         B     @RC00855                                            0860 03504000
@RF00855 LR    @10,ELEMENT                                         0860 03505000
         MH    @10,@CH01471                                        0860 03506000
         L     @03,@PC00001+8                                      0860 03507000
         L     @03,VS3LISTP(,@03)                                  0860 03508000
         L     @03,VSDPTR(,@03)                                    0860 03509000
         LA    @15,1                                               0860 03510000
         AL    @03,@CF01485                                        0860 03511000
         ST    @15,VSDVOLCT-16(@10,@03)                            0860 03512000
*   /*****************************************************************/ 03513000
*   /*                                                               */ 03514000
*   /* IF ULOCATE HAS ISSUED A MESSAGE ABOUT CATLG           @Z40LB35*/ 03515000
*   /* CONFLICT PROBLEMS OR OTHER CATLG PROBLEMS,            @Z40LB35*/ 03516000
*   /* THE DOES NOT MEET CRITERIA CODE IS SET.               @Z40LB35*/ 03517000
*   /*                                                               */ 03518000
*   /*****************************************************************/ 03519000
*                                                                  0861 03520000
*   IF TESTRC=4 THEN                /*                       @Z40LB35*/ 03521000
@RC00855 CLC   TESTRC(2),@CH00041                                  0861 03522000
         BNE   @RF00861                                            0861 03523000
*     MSGSENT=ON;                   /*                       @Z40LB35*/ 03524000
*                                                                  0862 03525000
         OI    MSGSENT,B'10000000'                                 0862 03526000
*   /*****************************************************************/ 03527000
*   /*                                                               */ 03528000
*   /* IF THE SCRDSET SERVICE IS THE CALLER,                 @Z40LB35*/ 03529000
*   /* INITIALIZE THE CATLG INFO IN THE                      @Z40LB35*/ 03530000
*   /* VSDSCR PORTION OF THE VSDBLOCK.                       @Z40LB35*/ 03531000
*   /*                                                               */ 03532000
*   /*****************************************************************/ 03533000
*                                                                  0863 03534000
*   IF TESTRC=0&VS3SCR=ON THEN      /*                       @Z40LB35*/ 03535000
@RF00861 LH    @10,TESTRC                                          0863 03536000
         LTR   @10,@10                                             0863 03537000
         BNZ   @RF00863                                            0863 03538000
         L     @10,@PC00001+8                                      0863 03539000
         TM    VS3SCR(@10),B'00100000'                             0863 03540000
         BNO   @RF00863                                            0863 03541000
*     DO;                           /*                       @Z40LB35*/ 03542000
*       VSDCATLC=ON;                /*                       @Z40LB35*/ 03543000
         LR    @03,ELEMENT                                         0865 03544000
         MH    @03,@CH01471                                        0865 03545000
         L     @10,VS3LISTP(,@10)                                  0865 03546000
         L     @10,VSDPTR(,@10)                                    0865 03547000
         AL    @10,@CF01486                                        0865 03548000
         LA    @10,VSDVARY-64(@03,@10)                             0865 03549000
         OI    VSDCATLC(@10),B'10000000'                           0865 03550000
*       IF LCTVSCAT=ON THEN         /*                       @Z40LB35*/ 03551000
         LA    @03,LCTAREA                                         0866 03552000
         TM    LCTVSCAT(@03),B'10000000'                           0866 03553000
         BNO   @RF00866                                            0866 03554000
*         DO;                       /*                       @Z40LB35*/ 03555000
*           VSDVSAM=ON;             /*                       @Z40LB35*/ 03556000
         OI    VSDVSAM(@10),B'01000000'                            0868 03557000
*           VSDACBPT=LCTACBP;       /*                       @Z40LB35*/ 03558000
         L     @03,LCTACBP(,@03)                                   0869 03559000
         ST    @03,VSDACBPT(,@10)                                  0869 03560000
*         END;                      /*                       @Z40LB35*/ 03561000
*     END;                          /*                       @Z40LB35*/ 03562000
*                                                                  0871 03563000
@RF00866 DS    0H                                                  0872 03564000
*   /*****************************************************************/ 03565000
*   /*                                                               */ 03566000
*   /* IF THE LISTDSET SERVICE IS THE CALLER                 @Z40LB35*/ 03567000
*   /* FOR THE STATUS REPORT, THE VSDSTAT                    @Z40LB35*/ 03568000
*   /* PORTION OF THE VSDBLOCK IS INITIALIZED.               @Z40LB35*/ 03569000
*   /*                                                               */ 03570000
*   /*****************************************************************/ 03571000
*                                                                  0872 03572000
*   IF TESTRC=4&VS3STAT=ON THEN     /*                       @Z40LB35*/ 03573000
@RF00863 CLC   TESTRC(2),@CH00041                                  0872 03574000
         BNE   @RF00872                                            0872 03575000
         L     @10,@PC00001+8                                      0872 03576000
         TM    VS3STAT(@10),B'10000000'                            0872 03577000
         BNO   @RF00872                                            0872 03578000
*     VSDERROR=ON;                  /*                       @Z40LB35*/ 03579000
         LR    @03,ELEMENT                                         0873 03580000
         MH    @03,@CH01471                                        0873 03581000
         L     @10,VS3LISTP(,@10)                                  0873 03582000
         L     @10,VSDPTR(,@10)                                    0873 03583000
         AL    @10,@CF01486                                        0873 03584000
         LA    @10,VSDVARY-64(@03,@10)                             0873 03585000
         OI    VSDERROR(@10),B'00010000'                           0873 03586000
*   IF TESTRC=4 THEN                /*                       @Z40LB35*/ 03587000
@RF00872 CLC   TESTRC(2),@CH00041                                  0874 03588000
         BNE   @RF00874                                            0874 03589000
*     IF(VS3UNCAT=ON|VS3SCR=ON|     /*                       @Z40LB35*/ 03590000
*         VS3CREAT^=NULLPTR|VS3EXPIR^=NULLPTR) THEN/*        @Z40LB35*/ 03591000
         L     @10,@PC00001+8                                      0875 03592000
         TM    VS3UNCAT(@10),B'00110000'                           0875 03593000
         BNZ   @RT00875                                            0875 03594000
         SLR   @04,@04                                             0875 03595000
         C     @04,VS3CREAT(,@10)                                  0875 03596000
         BNE   @RT00875                                            0875 03597000
         C     @04,VS3EXPIR(,@10)                                  0875 03598000
         BE    @RF00875                                            0875 03599000
@RT00875 DS    0H                                                  0876 03600000
*       TESTRC=NOMEET;              /*                       @Z40LB35*/ 03601000
         LH    @10,NOMEET                                          0876 03602000
         STH   @10,TESTRC                                          0876 03603000
*     ELSE                          /*                       @Z40LB35*/ 03604000
*       TESTRC=0;                   /*                       @Z40LB35*/ 03605000
*                                                                  0877 03606000
         B     @RC00875                                            0877 03607000
@RF00875 SLR   @10,@10                                             0877 03608000
         STH   @10,TESTRC                                          0877 03609000
*   /*****************************************************************/ 03610000
*   /*                                                               */ 03611000
*   /* IF THE DSN WAS NOT LOCATED IN A CATLG                 @Z40LB35*/ 03612000
*   /* THE CODE IS TRANSLATED TO ZERO AS THIS                @Z40LB35*/ 03613000
*   /* IS NOT AN ERROR SITUATION.                            @Z40LB35*/ 03614000
*   /*                                                               */ 03615000
*   /*****************************************************************/ 03616000
*                                                                  0878 03617000
*   IF TESTRC=8 THEN                /*                       @Z40LB35*/ 03618000
@RC00875 DS    0H                                                  0878 03619000
@RF00874 CLC   TESTRC(2),@CH00179                                  0878 03620000
         BNE   @RF00878                                            0878 03621000
*     TESTRC=0;                     /*                       @Z40LB35*/ 03622000
*                                                                  0879 03623000
         SLR   @10,@10                                             0879 03624000
         STH   @10,TESTRC                                          0879 03625000
*   /*****************************************************************/ 03626000
*   /*                                                               */ 03627000
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/ 03628000
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/ 03629000
*   /*                                                               */ 03630000
*   /*****************************************************************/ 03631000
*                                                                  0880 03632000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 03633000
@RF00878 LH    @15,TESTRC                                          0880 03634000
         L     @14,@SA00012                                        0880 03635000
         LM    @00,@12,@SA00012+8                                  0880 03636000
         BR    @14                                                 0880 03637000
*   END CATLG;                      /*                       @Z40LB35*/ 03638000
*                                                                  0882 03639000
*/********************************************************************/ 03640000
*/*                                                          @Z40LB35*/ 03641000
*/* PROCEDURE NAME - QUAL                                    @Z40LB35*/ 03642000
*/*                                                          @Z40LB35*/ 03643000
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF A DATA SET      @Z40LB35*/ 03644000
*/*             POSSESSES THE USERS QUALIFIER.               @Z40LB35*/ 03645000
*/*                                                          @Z40LB35*/ 03646000
*/* INPUT -     VS3AST   OF THE VS3AGL                       @Z40LB35*/ 03647000
*/*             VS3LEVLN OF THE VS3AGL                       @Z40LB35*/ 03648000
*/*             VS3LEVP  OF THE VS3AGL                       @Z40LB35*/ 03649000
*/*             DS1DSNAM OF THE IECDSF1 DSCB FMT 1           @Z40LB35*/ 03650000
*/*                                                          @Z40LB35*/ 03651000
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 03652000
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/ 03653000
*/*                                                          @Z40LB35*/ 03654000
*/********************************************************************/ 03655000
*                                                                  0882 03656000
*                                   /*                       @Z40LB35*/ 03657000
*QUAL:                                                             0882 03658000
*   PROC;                           /*                       @Z40LB35*/ 03659000
QUAL     STM   @14,@12,12(@13)                                     0882 03660000
*   DCL                                                            0883 03661000
*     PERIOD CHAR(1) STATIC INITIAL('.');/*                  @Z40LB35   03662000
*                                      PERIOD DEFINED TO     @Z40LB35   03663000
*                                      PARSE DSN QUALIFIERS. @Z40LB35*/ 03664000
*   DCL                                                            0884 03665000
*     DSNQUAL CHAR(44) BASED(VS3LEVP);/*                     @Z40LB35   03666000
*                                      DEFINE CALLERS QUAL   @Z40LB35*/ 03667000
*   DCL                                                            0885 03668000
*     LEADLEV FIXED(15);            /*                       @Z40LB35   03669000
*                                      OFFSET COUNTER        @Z40LB35*/ 03670000
*   DCL                                                            0886 03671000
*     TRAILLEV FIXED(15);           /*                       @Z40LB35   03672000
*                                      OFFSET COUNTER        @Z40LB35*/ 03673000
*   DCL                                                            0887 03674000
*     BEGTRAIL FIXED(15);           /*                       @Z40LB35   03675000
*                                      OFFSET COUNTER        @Z40LB35*/ 03676000
*   DCL                                                            0888 03677000
*     ENDQUAL FIXED(15);            /* LOOP CONTROL          @Z40LB35*/ 03678000
*                                                                  0889 03679000
*   /*****************************************************************/ 03680000
*   /*                                                               */ 03681000
*   /* SET UP TRACE POINT 'VSQL' IN TRACE TABLE              @Z40LB35*/ 03682000
*   /*                                                               */ 03683000
*   /*****************************************************************/ 03684000
*                                                                  0889 03685000
*   OLDERID2=NEWERID2;                                             0889 03686000
         L     @10,@PC00001                                        0889 03687000
         L     @10,GDTTR2(,@10)                                    0889 03688000
         MVC   @TS00001(95),NEWERID2(@10)                          0889 03689000
         MVC   OLDERID2(95,@10),@TS00001                           0889 03690000
*   NEWID2='VSQL';                  /*                       @Z40LB35*/ 03691000
*                                                                  0890 03692000
         MVC   NEWID2(4,@10),@CC01430                              0890 03693000
*   /*****************************************************************/ 03694000
*   /*                                                               */ 03695000
*   /* CALCULATE THE END OF THE                              @Z40LB35*/ 03696000
*   /* LEADING QUALIFIER.                                    @Z40LB35*/ 03697000
*   /*                                                               */ 03698000
*   /*****************************************************************/ 03699000
*                                                                  0891 03700000
*   IF VS3AST^=0 THEN               /*                       @Z40LB35*/ 03701000
         L     @10,@PC00001+8                                      0891 03702000
         LH    @10,VS3AST(,@10)                                    0891 03703000
         LTR   @10,@10                                             0891 03704000
         BZ    @RF00891                                            0891 03705000
*     LEADLEV=VS3AST-1;             /*                       @Z40LB35*/ 03706000
         BCTR  @10,0                                               0892 03707000
         LR    LEADLEV,@10                                         0892 03708000
*   ELSE                            /*                       @Z40LB35*/ 03709000
*     LEADLEV=VS3LEVLN;             /*                       @Z40LB35*/ 03710000
*                                                                  0893 03711000
         B     @RC00891                                            0893 03712000
@RF00891 L     @10,@PC00001+8                                      0893 03713000
         LH    LEADLEV,VS3LEVLN(,@10)                              0893 03714000
*   /*****************************************************************/ 03715000
*   /*                                                               */ 03716000
*   /* CALCULATE THE BEGINNING OF                            @Z40LB35*/ 03717000
*   /* THE TRAILING QUALIFIER.                               @Z40LB35*/ 03718000
*   /*                                                               */ 03719000
*   /*****************************************************************/ 03720000
*                                                                  0894 03721000
*   TRAILLEV=VS3LEVLN;              /*                       @Z40LB35*/ 03722000
*                                                                  0894 03723000
@RC00891 L     @10,@PC00001+8                                      0894 03724000
         LH    TRAILLEV,VS3LEVLN(,@10)                             0894 03725000
*   /*****************************************************************/ 03726000
*   /*                                                               */ 03727000
*   /* INITIALIZE THE RETURN CODE TO ZERO                    @Z40LB35*/ 03728000
*   /*                                                               */ 03729000
*   /*****************************************************************/ 03730000
*                                                                  0895 03731000
*   TESTRC=0;                       /*                       @Z40LB35*/ 03732000
*                                                                  0895 03733000
         SLR   @07,@07                                             0895 03734000
         STH   @07,TESTRC                                          0895 03735000
*   /*****************************************************************/ 03736000
*   /*                                                               */ 03737000
*   /* TEST THE LEADING QUALIFIER FOR A MATCH.               @Z40LB35*/ 03738000
*   /*                                                               */ 03739000
*   /*****************************************************************/ 03740000
*                                                                  0896 03741000
*   IF DSNQUAL(1:LEADLEV)=DS1DSNAM(1:LEADLEV) THEN/*         @Z40LB35*/ 03742000
*                                                                  0896 03743000
         L     @03,VS3LEVP(,@10)                                   0896 03744000
         LR    @15,LEADLEV                                         0896 03745000
         BCTR  @15,0                                               0896 03746000
         EX    @15,@SC01491                                        0896 03747000
         BNE   @RF00896                                            0896 03748000
*     /***************************************************************/ 03749000
*     /*                                                             */ 03750000
*     /* IF LEADING QUALIFIER MATCHES, DETERMINE IF          @Z40LB35*/ 03751000
*     /* THERE IS A TRAILING QUALIFIER.                      @Z40LB35*/ 03752000
*     /*                                                             */ 03753000
*     /***************************************************************/ 03754000
*                                                                  0897 03755000
*     IF VS3AST^=0 THEN             /*                       @Z40LB35*/ 03756000
         CH    @07,VS3AST(,@10)                                    0897 03757000
         BE    @RF00897                                            0897 03758000
*       DO;                         /*                       @Z40LB35*/ 03759000
*                                                                  0898 03760000
*         /***********************************************************/ 03761000
*         /*                                                         */ 03762000
*         /* IF THERE IS A TRAILING QUALIFIER,               @Z40LB35*/ 03763000
*         /* INDEX TO TRAILING QUALIFIER.                    @Z40LB35*/ 03764000
*         /*                                                         */ 03765000
*         /***********************************************************/ 03766000
*                                                                  0899 03767000
*         ENDQUAL=LEADLEV+8;        /*                       @Z40LB35*/ 03768000
         LA    ENDQUAL,8                                           0899 03769000
         ALR   ENDQUAL,LEADLEV                                     0899 03770000
*         DO BEGTRAIL=(LEADLEV+2) TO ENDQUAL WHILE/*         @Z40LB35*/ 03771000
*               DS1DSNAM(BEGTRAIL:BEGTRAIL)^=PERIOD;/*       @Z40LB35*/ 03772000
*                                                                  0900 03773000
         LA    BEGTRAIL,2                                          0900 03774000
         ALR   BEGTRAIL,LEADLEV                                    0900 03775000
         B     @DE00900                                            0900 03776000
@DL00900 LR    @10,F1PTR                                           0900 03777000
         ALR   @10,BEGTRAIL                                        0900 03778000
         BCTR  @10,0                                               0900 03779000
         CLC   DS1DSNAM(1,@10),PERIOD                              0900 03780000
         BE    @DC00900                                            0900 03781000
*           /*********************************************************/ 03782000
*           /*                                                       */ 03783000
*           /*                                               @Z40LB35*/ 03784000
*           /*                                               @Z40LB35*/ 03785000
*           /*                                                       */ 03786000
*           /*********************************************************/ 03787000
*                                                                  0901 03788000
*           TRAILLEV=TRAILLEV+1;    /*                       @Z40LB35*/ 03789000
         AL    TRAILLEV,@CF00219                                   0901 03790000
*         END;                      /*                       @Z40LB35*/ 03791000
*                                                                  0902 03792000
         AL    BEGTRAIL,@CF00219                                   0902 03793000
@DE00900 CR    BEGTRAIL,ENDQUAL                                    0902 03794000
         BNH   @DL00900                                            0902 03795000
@DC00900 DS    0H                                                  0903 03796000
*         /***********************************************************/ 03797000
*         /*                                                         */ 03798000
*         /* IF THERE IS A TRAILING QUALIFIER,               @Z40LB35*/ 03799000
*         /* TEST FOR A MATCH.                               @Z40LB35*/ 03800000
*         /* IF THE TRAILING QUALIFIER DOES NOT MATCH,       @Z40LB35*/ 03801000
*         /* SET THE DOES NOT MEET CRITERION CODE.           @Z40LB35*/ 03802000
*         /*                                                         */ 03803000
*         /***********************************************************/ 03804000
*                                                                  0903 03805000
*         IF DS1DSNAM(BEGTRAIL:TRAILLEV)^=DSNQUAL(VS3AST+1:VS3LEVLN)    03806000
*           THEN                    /*                       @Z40LB35*/ 03807000
         L     @10,@PC00001+8                                      0903 03808000
         LH    @06,VS3AST(,@10)                                    0903 03809000
         L     @03,VS3LEVP(,@10)                                   0903 03810000
         LH    @10,VS3LEVLN(,@10)                                  0903 03811000
         SLR   @10,@06                                             0903 03812000
         BCTR  @10,0                                               0903 03813000
         LR    @01,F1PTR                                           0903 03814000
         ALR   @01,BEGTRAIL                                        0903 03815000
         BCTR  @01,0                                               0903 03816000
         ALR   @03,@06                                             0903 03817000
         EX    @10,@SC01493                                        0903 03818000
         BE    @RF00903                                            0903 03819000
*           TESTRC=NOMEET;          /*                       @Z40LB35*/ 03820000
         LH    @10,NOMEET                                          0904 03821000
         STH   @10,TESTRC                                          0904 03822000
*         ELSE                      /*                       @Z40LB35*/ 03823000
*           IF TRAILLEV<LENGTH(DS1DSNAM)&(DS1DSNAM(TRAILLEV+1:TRAILLEV+ 03824000
*               1)^=BLANK&DS1DSNAM(TRAILLEV+1:TRAILLEV+1)^=PERIOD) THEN 03825000
         B     @RC00903                                            0905 03826000
@RF00903 C     TRAILLEV,@CF00847                                   0905 03827000
         BNL   @RF00905                                            0905 03828000
         LR    @10,F1PTR                                           0905 03829000
         ALR   @10,TRAILLEV                                        0905 03830000
         CLC   DS1DSNAM(1,@10),BLANK                               0905 03831000
         BE    @RF00905                                            0905 03832000
         LR    @10,F1PTR                                           0905 03833000
         ALR   @10,TRAILLEV                                        0905 03834000
         CLC   DS1DSNAM(1,@10),PERIOD                              0905 03835000
         BE    @RF00905                                            0905 03836000
*             TESTRC=NOMEET;        /*                       @Z40LB35*/ 03837000
*                                                                  0906 03838000
         LH    @10,NOMEET                                          0906 03839000
         STH   @10,TESTRC                                          0906 03840000
*         /***********************************************************/ 03841000
*         /*                                                         */ 03842000
*         /* IF LEADING QUALIFIER DOES NOT MATCH,            @Z40LB35*/ 03843000
*         /* SET THE DOES NOT MEET CRITERION CODE.           @Z40LB35*/ 03844000
*         /*                                                         */ 03845000
*         /***********************************************************/ 03846000
*                                                                  0907 03847000
*       END;                        /*                       @Z40LB35*/ 03848000
*     ELSE                                                         0908 03849000
*       ;                           /*                       @Z40LB35*/ 03850000
@RF00897 DS    0H                                                  0909 03851000
*   ELSE                            /*                       @Z40LB35*/ 03852000
*     TESTRC=NOMEET;                /*                       @Z40LB35*/ 03853000
*                                                                  0909 03854000
         B     @RC00896                                            0909 03855000
@RF00896 LH    @10,NOMEET                                          0909 03856000
         STH   @10,TESTRC                                          0909 03857000
*   /*****************************************************************/ 03858000
*   /*                                                               */ 03859000
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/ 03860000
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/ 03861000
*   /*                                                               */ 03862000
*   /*****************************************************************/ 03863000
*                                                                  0910 03864000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 03865000
@RC00896 LH    @15,TESTRC                                          0910 03866000
         L     @14,12(,@13)                                        0910 03867000
         LM    @00,@12,20(@13)                                     0910 03868000
         BR    @14                                                 0910 03869000
*   END QUAL;                       /*                       @Z40LB35*/ 03870000
*                                                                  0912 03871000
*/********************************************************************/ 03872000
*/*                                                          @Z40LB35*/ 03873000
*/* PROCEDURE NAME - CREATION                                @Z40LB35*/ 03874000
*/*                                                          @Z40LB35*/ 03875000
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF THE             @Z40LB35*/ 03876000
*/*             CREATION DATE CRITERION IS MET.              @Z40LB35*/ 03877000
*/*                                                          @Z40LB35*/ 03878000
*/* INPUT -     VS3CREAT OF THE VS3AGL                       @Z40LB35*/ 03879000
*/*             LCTVSCAT OF THE LCTINFO                      @Z40LB35*/ 03880000
*/*                                                          @Z40LB35*/ 03881000
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 03882000
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/ 03883000
*/*                                                          @Z40LB35*/ 03884000
*/********************************************************************/ 03885000
*                                                                  0912 03886000
*                                   /*                       @Z40LB35*/ 03887000
*CREATION:                                                         0912 03888000
*   PROC;                           /*                       @Z40LB35*/ 03889000
*                                                                  0912 03890000
CREATION STM   @14,@12,12(@13)                                     0912 03891000
*   /*****************************************************************/ 03892000
*   /*                                                               */ 03893000
*   /* SET UP TRACE POINT 'VSCR' IN TRACE TABLE              @Z40LB35*/ 03894000
*   /*                                                               */ 03895000
*   /*****************************************************************/ 03896000
*                                                                  0913 03897000
*   OLDERID2=NEWERID2;                                             0913 03898000
         L     @10,@PC00001                                        0913 03899000
         L     @10,GDTTR2(,@10)                                    0913 03900000
         MVC   @TS00001(95),NEWERID2(@10)                          0913 03901000
         MVC   OLDERID2(95,@10),@TS00001                           0913 03902000
*   NEWID2='VSCR';                  /*                       @Z40LB35*/ 03903000
*                                                                  0914 03904000
         MVC   NEWID2(4,@10),@CC01434                              0914 03905000
*   /*****************************************************************/ 03906000
*   /*                                                               */ 03907000
*   /* A TEST IS MADE TO DETERMINE WHETHER THE               @Z40LB35*/ 03908000
*   /* DSN IS CATLG IN A VSAM CATLG.                         @Z40LB35*/ 03909000
*   /*                                                               */ 03910000
*   /*****************************************************************/ 03911000
*                                                                  0915 03912000
*   IF LOCATESW=ON&LCTVSCAT=ON THEN /*                       @Z40LB35*/ 03913000
*                                                                  0915 03914000
         TM    LOCATESW,B'10000000'                                0915 03915000
         BNO   @RF00915                                            0915 03916000
         LA    @10,LCTAREA                                         0915 03917000
         TM    LCTVSCAT(@10),B'10000000'                           0915 03918000
         BNO   @RF00915                                            0915 03919000
*     /***************************************************************/ 03920000
*     /*                                                             */ 03921000
*     /* IF DSN IS CATLG IN VSAM CATLG, THEN                 @Z40LB35*/ 03922000
*     /* DATES ARE COMPARED IN BOTH THE VSAM AS              @Z40LB35*/ 03923000
*     /* WELL AS THE DSCB.                                   @Z40LB35*/ 03924000
*     /*                                                             */ 03925000
*     /***************************************************************/ 03926000
*                                                                  0916 03927000
*     IF(DSCREAT<=CREATDTE&CATCREAT<=CREATDTE)|(CATCREAT=NULLENTY& 0916 03928000
*         DSCREAT<=CREATDTE) THEN                                  0916 03929000
         L     @04,@PC00001+8                                      0916 03930000
         L     @04,VS3CREAT(,@04)                                  0916 03931000
         L     @04,CREATDTE(,@04)                                  0916 03932000
         SLR   @03,@03                                             0916 03933000
         ICM   @03,7,DSCREAT(F1PTR)                                0916 03934000
         CR    @04,@03                                             0916 03935000
         BL    @GL00036                                            0916 03936000
         C     @04,CATCREAT(,@10)                                  0916 03937000
         BNL   @RT00916                                            0916 03938000
@GL00036 LA    @10,LCTAREA                                         0916 03939000
         CLC   CATCREAT(4,@10),NULLENTY                            0916 03940000
         BNE   @RF00916                                            0916 03941000
         L     @10,@PC00001+8                                      0916 03942000
         L     @10,VS3CREAT(,@10)                                  0916 03943000
         SLR   @04,@04                                             0916 03944000
         ICM   @04,7,DSCREAT(F1PTR)                                0916 03945000
         C     @04,CREATDTE(,@10)                                  0916 03946000
         BH    @RF00916                                            0916 03947000
@RT00916 DS    0H                                                  0917 03948000
*       TESTRC=0;                   /*                       @Z40LB35*/ 03949000
         SLR   @10,@10                                             0917 03950000
         STH   @10,TESTRC                                          0917 03951000
*     ELSE                          /*                       @Z40LB35*/ 03952000
*       TESTRC=NOMEET;              /*                       @Z40LB35*/ 03953000
*                                                                  0918 03954000
         B     @RC00916                                            0918 03955000
@RF00916 LH    @10,NOMEET                                          0918 03956000
         STH   @10,TESTRC                                          0918 03957000
*   /*****************************************************************/ 03958000
*   /*                                                               */ 03959000
*   /* IF DSN NOT FOUND IN VSAM CATLG, THE                   @Z40LB35*/ 03960000
*   /* DSCB DATE IS THE ONLY DATE COMPARED.                  @Z40LB35*/ 03961000
*   /*                                                               */ 03962000
*   /*****************************************************************/ 03963000
*                                                                  0919 03964000
*   ELSE                            /*                       @Z40LB35*/ 03965000
*     IF DSCREAT>CREATDTE THEN      /*                       @Z40LB35*/ 03966000
         B     @RC00915                                            0919 03967000
@RF00915 L     @10,@PC00001+8                                      0919 03968000
         L     @10,VS3CREAT(,@10)                                  0919 03969000
         SLR   @04,@04                                             0919 03970000
         ICM   @04,7,DSCREAT(F1PTR)                                0919 03971000
         C     @04,CREATDTE(,@10)                                  0919 03972000
         BNH   @RF00919                                            0919 03973000
*       TESTRC=NOMEET;              /*                       @Z40LB35*/ 03974000
*                                                                  0920 03975000
         LH    @10,NOMEET                                          0920 03976000
         STH   @10,TESTRC                                          0920 03977000
*   /*****************************************************************/ 03978000
*   /*                                                               */ 03979000
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/ 03980000
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/ 03981000
*   /*                                                               */ 03982000
*   /*****************************************************************/ 03983000
*                                                                  0921 03984000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 03985000
@RF00919 DS    0H                                                  0921 03986000
@RC00915 LH    @15,TESTRC                                          0921 03987000
         L     @14,12(,@13)                                        0921 03988000
         LM    @00,@12,20(@13)                                     0921 03989000
         BR    @14                                                 0921 03990000
*   END CREATION;                   /*                       @Z40LB35*/ 03991000
*                                                                  0923 03992000
*/********************************************************************/ 03993000
*/*                                                          @Z40LB35*/ 03994000
*/* PROCEDURE NAME - EXPIRATN                                @Z40LB35*/ 03995000
*/*                                                          @Z40LB35*/ 03996000
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF THE             @Z40LB35*/ 03997000
*/*             EXPIRATION DATE CRITERION IS MET.            @Z40LB35*/ 03998000
*/*                                                          @Z40LB35*/ 03999000
*/* INPUT -     VS3EXPIR OF THE VS3AGL                       @Z40LB35*/ 04000000
*/*             LCTVSCAT OF THE LCTINFO                      @Z40LB35*/ 04001000
*/*                                                          @Z40LB35*/ 04002000
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 04003000
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/ 04004000
*/*                                                          @Z40LB35*/ 04005000
*/********************************************************************/ 04006000
*                                                                  0923 04007000
*                                   /*                       @Z40LB35*/ 04008000
*EXPIRATN:                                                         0923 04009000
*   PROC;                           /*                       @Z40LB35*/ 04010000
*                                                                  0923 04011000
EXPIRATN STM   @14,@12,12(@13)                                     0923 04012000
*   /*****************************************************************/ 04013000
*   /*                                                               */ 04014000
*   /* SET UP TRACE POINT 'VSEX' IN TRACE TABLE              @Z40LB35*/ 04015000
*   /*                                                               */ 04016000
*   /*****************************************************************/ 04017000
*                                                                  0924 04018000
*   OLDERID2=NEWERID2;                                             0924 04019000
         L     @10,@PC00001                                        0924 04020000
         L     @10,GDTTR2(,@10)                                    0924 04021000
         MVC   @TS00001(95),NEWERID2(@10)                          0924 04022000
         MVC   OLDERID2(95,@10),@TS00001                           0924 04023000
*   NEWID2='VSEX';                  /*                       @Z40LB35*/ 04024000
*                                                                  0925 04025000
         MVC   NEWID2(4,@10),@CC01438                              0925 04026000
*   /*****************************************************************/ 04027000
*   /*                                                               */ 04028000
*   /* A TEST IS MADE TO DETERMINE WHETHER THE               @Z40LB35*/ 04029000
*   /* DSN IS CATLG IN A VSAM CATLG.                         @Z40LB35*/ 04030000
*   /*                                                               */ 04031000
*   /*****************************************************************/ 04032000
*                                                                  0926 04033000
*   IF LOCATESW=ON&LCTVSCAT=ON THEN /*                       @Z40LB35*/ 04034000
*                                                                  0926 04035000
         TM    LOCATESW,B'10000000'                                0926 04036000
         BNO   @RF00926                                            0926 04037000
         LA    @10,LCTAREA                                         0926 04038000
         TM    LCTVSCAT(@10),B'10000000'                           0926 04039000
         BNO   @RF00926                                            0926 04040000
*     /***************************************************************/ 04041000
*     /*                                                             */ 04042000
*     /* IF DSN IS CATLG IN VSAM CATLG, THE                  @Z40LB35*/ 04043000
*     /* DATES ARE COMPARED IN BOTH THE VSAM AS              @Z40LB35*/ 04044000
*     /* WELL AS THE DSCB.                                   @Z40LB35*/ 04045000
*     /*                                                             */ 04046000
*     /***************************************************************/ 04047000
*                                                                  0927 04048000
*     IF(DSEXPIR<=EXPIRDTE&CATEXPIR<=EXPIRDTE)|(CATEXPIR=NULLENTY& 0927 04049000
*         DSEXPIR<=EXPIRDTE) THEN                                  0927 04050000
         L     @04,@PC00001+8                                      0927 04051000
         L     @04,VS3EXPIR(,@04)                                  0927 04052000
         L     @04,EXPIRDTE(,@04)                                  0927 04053000
         SLR   @03,@03                                             0927 04054000
         ICM   @03,7,DSEXPIR(F1PTR)                                0927 04055000
         CR    @04,@03                                             0927 04056000
         BL    @GL00040                                            0927 04057000
         C     @04,CATEXPIR(,@10)                                  0927 04058000
         BNL   @RT00927                                            0927 04059000
@GL00040 LA    @10,LCTAREA                                         0927 04060000
         CLC   CATEXPIR(4,@10),NULLENTY                            0927 04061000
         BNE   @RF00927                                            0927 04062000
         L     @10,@PC00001+8                                      0927 04063000
         L     @10,VS3EXPIR(,@10)                                  0927 04064000
         SLR   @04,@04                                             0927 04065000
         ICM   @04,7,DSEXPIR(F1PTR)                                0927 04066000
         C     @04,EXPIRDTE(,@10)                                  0927 04067000
         BH    @RF00927                                            0927 04068000
@RT00927 DS    0H                                                  0928 04069000
*       TESTRC=0;                   /*                       @Z40LB35*/ 04070000
         SLR   @10,@10                                             0928 04071000
         STH   @10,TESTRC                                          0928 04072000
*     ELSE                          /*                       @Z40LB35*/ 04073000
*       TESTRC=NOMEET;              /*                       @Z40LB35*/ 04074000
*                                                                  0929 04075000
         B     @RC00927                                            0929 04076000
@RF00927 LH    @10,NOMEET                                          0929 04077000
         STH   @10,TESTRC                                          0929 04078000
*   /*****************************************************************/ 04079000
*   /*                                                               */ 04080000
*   /* IF DSN NOT FOUND IN VSAM CATLG, THE                   @Z40LB35*/ 04081000
*   /* DSCB DATE IS THE ONLY DATE COMPARED.                  @Z40LB35*/ 04082000
*   /*                                                               */ 04083000
*   /*****************************************************************/ 04084000
*                                                                  0930 04085000
*   ELSE                            /*                       @Z40LB35*/ 04086000
*     IF DSEXPIR>EXPIRDTE THEN      /*                       @Z40LB35*/ 04087000
         B     @RC00926                                            0930 04088000
@RF00926 L     @10,@PC00001+8                                      0930 04089000
         L     @10,VS3EXPIR(,@10)                                  0930 04090000
         SLR   @04,@04                                             0930 04091000
         ICM   @04,7,DSEXPIR(F1PTR)                                0930 04092000
         C     @04,EXPIRDTE(,@10)                                  0930 04093000
         BNH   @RF00930                                            0930 04094000
*       TESTRC=NOMEET;              /*                       @Z40LB35*/ 04095000
*                                                                  0931 04096000
         LH    @10,NOMEET                                          0931 04097000
         STH   @10,TESTRC                                          0931 04098000
*   /*****************************************************************/ 04099000
*   /*                                                               */ 04100000
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/ 04101000
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/ 04102000
*   /*                                                               */ 04103000
*   /*****************************************************************/ 04104000
*                                                                  0932 04105000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 04106000
@RF00930 DS    0H                                                  0932 04107000
@RC00926 LH    @15,TESTRC                                          0932 04108000
         L     @14,12(,@13)                                        0932 04109000
         LM    @00,@12,20(@13)                                     0932 04110000
         BR    @14                                                 0932 04111000
*   END EXPIRATN;                   /*                       @Z40LB35*/ 04112000
*                                                                  0934 04113000
*/********************************************************************/ 04114000
*/*                                                          @Z40LB35*/ 04115000
*/* PROCEDURE NAME - SYSNAMES                                @Z40LB35*/ 04116000
*/*                                                          @Z40LB35*/ 04117000
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF THE SYSNAMES    @Z40LB35*/ 04118000
*/*             CRITERION IS MET.                            @Z40LB35*/ 04119000
*/*                                                          @Z40LB35*/ 04120000
*/* INPUT -     DS1DSNAM OF IECDSF1 - DSCB FMT1              @Z40LB35*/ 04121000
*/*                                                          @Z40LB35*/ 04122000
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 04123000
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/ 04124000
*/*                                                          @Z40LB35*/ 04125000
*/********************************************************************/ 04126000
*                                                                  0934 04127000
*                                   /*                       @Z40LB35*/ 04128000
*SYSNAMES:                                                         0934 04129000
*   PROC;                           /*                       @Z40LB35*/ 04130000
SYSNAMES STM   @14,@12,12(@13)                                     0934 04131000
*   DCL                                                            0935 04132000
*     AAAAAASW BIT(1);              /* SW IF AAAAAAAA. DSN   @Z40LB35*/ 04133000
*   DCL                                                            0936 04134000
*     AAAANAME CHAR(35) STATIC      /*                       @Z40LB35*/ 04135000
*         INITIAL('AAAAAAAA.AAAAAAAA.AAAAAAAA.AAAAAAAA');/*  @Z40LB35   04136000
*                                      SYSTEM NAMED DSN      @Z40LB35*/ 04137000
*   DCL                                                            0937 04138000
*     SYSNAMNO FIXED(8) BASED(NUMPTR);/*                     @Z40LB35   04139000
*                                      TEST FOR NUMBERS      @Z40LB35*/ 04140000
*   DCL                                                            0938 04141000
*     NUMPTR PTR(31);               /* POINTER SYSNAME PTR   @Z40LB35*/ 04142000
*   DCL                                                            0939 04143000
*     NUMCTR PTR(31);               /* COUNTER FOR SYS NUM   @Z40LB35*/ 04144000
*                                                                  0940 04145000
*   /*****************************************************************/ 04146000
*   /*                                                               */ 04147000
*   /* SET UP TRACE POINT 'VSSN' IN TRACE TABLE              @Z40LB35*/ 04148000
*   /*                                                               */ 04149000
*   /*****************************************************************/ 04150000
*                                                                  0940 04151000
*   OLDERID2=NEWERID2;                                             0940 04152000
         L     @10,@PC00001                                        0940 04153000
         L     @10,GDTTR2(,@10)                                    0940 04154000
         MVC   @TS00001(95),NEWERID2(@10)                          0940 04155000
         MVC   OLDERID2(95,@10),@TS00001                           0940 04156000
*   NEWID2='VSSN';                  /*                       @Z40LB35*/ 04157000
*                                                                  0941 04158000
         MVC   NEWID2(4,@10),@CC01451                              0941 04159000
*   /*****************************************************************/ 04160000
*   /*                                                               */ 04161000
*   /* INITIALIZE AAAAAAAA. SW OFF                           @Z40LB35*/ 04162000
*   /*                                                               */ 04163000
*   /*****************************************************************/ 04164000
*                                                                  0942 04165000
*   AAAAAASW=OFF;                   /*                       @Z40LB35*/ 04166000
*                                                                  0942 04167000
         NI    AAAAAASW,B'01111111'                                0942 04168000
*   /*****************************************************************/ 04169000
*   /*                                                               */ 04170000
*   /* TEST FOR AAAAAAAA. TYPE DSN                           @Z40LB35*/ 04171000
*   /*                                                               */ 04172000
*   /*****************************************************************/ 04173000
*                                                                  0943 04174000
*   IF DS1DSNAM(1:LENGTH(AAAANAME))=AAAANAME THEN/*          @Z40LB35*/ 04175000
         CLC   DS1DSNAM(35,F1PTR),AAAANAME                         0943 04176000
         BNE   @RF00943                                            0943 04177000
*     AAAAAASW=ON;                  /*                       @Z40LB35*/ 04178000
*                                                                  0944 04179000
         OI    AAAAAASW,B'10000000'                                0944 04180000
*   /*****************************************************************/ 04181000
*   /*                                                               */ 04182000
*   /* IF NOT AAAAAAAA. SYSTEM NAME DSN,                     @Z40LB35*/ 04183000
*   /* TEST FOR OTHER SYSTEM NAMES.                          @Z40LB35*/ 04184000
*   /*                                                               */ 04185000
*   /*****************************************************************/ 04186000
*                                                                  0945 04187000
*   IF AAAAAASW=OFF THEN            /*                       @Z40LB35*/ 04188000
@RF00943 TM    AAAAAASW,B'10000000'                                0945 04189000
         BNZ   @RF00945                                            0945 04190000
*     DO;                           /*                       @Z40LB35*/ 04191000
*                                                                  0946 04192000
*       /*************************************************************/ 04193000
*       /*                                                           */ 04194000
*       /* THE FOLLOWING CODE WILL TEST FOR THE SYSTEM       @Z40LB35*/ 04195000
*       /* NAME THAT LOOKS LIKE "SYSNNNNN.TXXXXXXXXY"        @Z40LB35*/ 04196000
*       /* WHERE Y CAN BE A,V,F, OR P AND THE N IS           @Z40LB35*/ 04197000
*       /* CHAR NUMBER FROM 0 TO 9.                          @Z40LB35*/ 04198000
*       /*                                                           */ 04199000
*       /*************************************************************/ 04200000
*                                                                  0947 04201000
*       IF DS1DSNAM(1:LENGTH('SYS'))='SYS' THEN/*            @Z40LB35*/ 04202000
         CLC   DS1DSNAM(3,F1PTR),@CC01452                          0947 04203000
         BNE   @RF00947                                            0947 04204000
*         IF DS1DSNAM(9:10)='.T' THEN/*                      @Z40LB35*/ 04205000
         CLC   DS1DSNAM+8(2,F1PTR),@CC01453                        0948 04206000
         BNE   @RF00948                                            0948 04207000
*           IF DS1DSNAM(19)='A'|DS1DSNAM(19)=/*              @Z40LB35*/ 04208000
*               'V'|DS1DSNAM(19)='F'|DS1DSNAM(19)='P' THEN         0949 04209000
         CLI   DS1DSNAM+18(F1PTR),C'A'                             0949 04210000
         BE    @RT00949                                            0949 04211000
         CLI   DS1DSNAM+18(F1PTR),C'V'                             0949 04212000
         BE    @RT00949                                            0949 04213000
         CLI   DS1DSNAM+18(F1PTR),C'F'                             0949 04214000
         BE    @RT00949                                            0949 04215000
         CLI   DS1DSNAM+18(F1PTR),C'P'                             0949 04216000
         BNE   @RF00949                                            0949 04217000
@RT00949 DS    0H                                                  0950 04218000
*             DO;                   /*                       @Z40LB35*/ 04219000
*               NUMPTR=ADDR(DS1DSNAM)+3;/*                   @Z40LB35*/ 04220000
         LA    NUMPTR,3                                            0951 04221000
         ALR   NUMPTR,F1PTR                                        0951 04222000
*               DO NUMCTR=1 TO 5 WHILE TESTRC=0;                   0952 04223000
         LA    NUMCTR,1                                            0952 04224000
@DL00952 LH    @10,TESTRC                                          0952 04225000
         LTR   @10,@10                                             0952 04226000
         BNZ   @DC00952                                            0952 04227000
*                 IF SYSNAMNO>'F9'X|SYSNAMNO<'F0'X THEN            0953 04228000
         CLI   SYSNAMNO(NUMPTR),249                                0953 04229000
         BH    @RT00953                                            0953 04230000
         CLI   SYSNAMNO(NUMPTR),240                                0953 04231000
         BNL   @RF00953                                            0953 04232000
@RT00953 DS    0H                                                  0954 04233000
*                   TESTRC=NOMEET;  /*                       @Z40LB35*/ 04234000
         LH    @10,NOMEET                                          0954 04235000
         STH   @10,TESTRC                                          0954 04236000
*                 ELSE              /*                       @Z40LB35*/ 04237000
*                   NUMPTR=NUMPTR+1;/*                       @Z40LB35*/ 04238000
         B     @RC00953                                            0955 04239000
@RF00953 AL    NUMPTR,@CF00219                                     0955 04240000
*               END;                /*                       @Z40LB35*/ 04241000
@RC00953 AL    NUMCTR,@CF00219                                     0956 04242000
         C     NUMCTR,@CF00295                                     0956 04243000
         BNH   @DL00952                                            0956 04244000
@DC00952 DS    0H                                                  0957 04245000
*             END;                  /*                       @Z40LB35*/ 04246000
*           ELSE                    /*                       @Z40LB35*/ 04247000
*             TESTRC=NOMEET;        /*                       @Z40LB35*/ 04248000
         B     @RC00949                                            0958 04249000
@RF00949 LH    @10,NOMEET                                          0958 04250000
         STH   @10,TESTRC                                          0958 04251000
*         ELSE                      /*                       @Z40LB35*/ 04252000
*           TESTRC=NOMEET;          /*                       @Z40LB35*/ 04253000
         B     @RC00948                                            0959 04254000
@RF00948 LH    @10,NOMEET                                          0959 04255000
         STH   @10,TESTRC                                          0959 04256000
*       ELSE                        /*                       @Z40LB35*/ 04257000
*         TESTRC=NOMEET;            /*                       @Z40LB35*/ 04258000
         B     @RC00947                                            0960 04259000
@RF00947 LH    @10,NOMEET                                          0960 04260000
         STH   @10,TESTRC                                          0960 04261000
*     END;                          /*                       @Z40LB35*/ 04262000
*                                                                  0961 04263000
@RC00947 DS    0H                                                  0962 04264000
*   /*****************************************************************/ 04265000
*   /*                                                               */ 04266000
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE CODE SAVE IN TESTRC. */ 04267000
*   /*                                                       @Z40LB35*/ 04268000
*   /*                                                               */ 04269000
*   /*****************************************************************/ 04270000
*                                                                  0962 04271000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 04272000
@RF00945 LH    @15,TESTRC                                          0962 04273000
         L     @14,12(,@13)                                        0962 04274000
         LM    @00,@12,20(@13)                                     0962 04275000
         BR    @14                                                 0962 04276000
*   END SYSNAMES;                   /*                       @Z40LB35*/ 04277000
*                                                                  0964 04278000
*/********************************************************************/ 04279000
*/*                                                          @Z40LB35*/ 04280000
*/* PROCEDURE NAME - EXCLUDE                                 @Z40LB35*/ 04281000
*/*                                                          @Z40LB35*/ 04282000
*/* FUNCTION -  THIS PROCEDURE DETERMINES IF THE DSN         @Z40LB35*/ 04283000
*/*             CRITERION IS MET.                            @Z40LB35*/ 04284000
*/*                                                          @Z40LB35*/ 04285000
*/* INPUT -     DS1DSNAM OF IECDSF1 - DSCB FMT1              @Z40LB35*/ 04286000
*/*                                                          @Z40LB35*/ 04287000
*/* OUTPUT -    REGISTER 15 = 0, SUCCESSFUL                  @Z40LB35*/ 04288000
*/*                          16, DOES NOT MEET CRITERIA      @Z40LB35*/ 04289000
*/*                                                          @Z40LB35*/ 04290000
*/********************************************************************/ 04291000
*                                                                  0964 04292000
*                                   /*                       @Z40LB35*/ 04293000
*EXCLUDE:                                                          0964 04294000
*   PROC;                           /*                       @Z40LB35*/ 04295000
*                                                                  0964 04296000
EXCLUDE  STM   @14,@12,12(@13)                                     0964 04297000
*   /*****************************************************************/ 04298000
*   /*                                                               */ 04299000
*   /* THE FOLLOWING STRUCTURE WILL OVERLAY THE              @Z40LB35*/ 04300000
*   /* EXCLUDED DSN ARRAY PASSED BY CALLER.                  @Z40LB35*/ 04301000
*   /*                                                               */ 04302000
*   /*****************************************************************/ 04303000
*                                                                  0965 04304000
*   DCL                                                            0965 04305000
*     1 EXCLDSNS BASED(VS3EXDSP) BDY(WORD),/*                @Z40LB35*/ 04306000
*      2 EXCLDCNT FIXED(15),        /* NUMBER OF ELEMENTS    @Z40LB35*/ 04307000
*      2 *(*) BDY(HWORD),           /*                       @Z40LB35*/ 04308000
*       3 * CHAR(20),               /*                       @Z40LB35*/ 04309000
*       3 EXCLDLEN FIXED(8),        /* LENGTH OF DSN         @Z40LB35*/ 04310000
*       3 EXCLDVAL CHAR(44);        /* DSN                   @Z40LB35*/ 04311000
*   DCL                                                            0966 04312000
*     EXCNUM FIXED(31);             /* COUNTER TO PROCESS    @Z40LB35   04313000
*                                      ARRAY                 @Z40LB35   04314000
*                                                            @Z40LB35*/ 04315000
*                                                                  0967 04316000
*   /*****************************************************************/ 04317000
*   /*                                                               */ 04318000
*   /* SET UP TRACE POINT 'VSEL' IN TRACE TABLE              @ZM41110*/ 04319000
*   /*                                                               */ 04320000
*   /*****************************************************************/ 04321000
*                                                                  0967 04322000
*   OLDERID2=NEWERID2;                                             0967 04323000
         L     @10,@PC00001                                        0967 04324000
         L     @10,GDTTR2(,@10)                                    0967 04325000
         MVC   @TS00001(95),NEWERID2(@10)                          0967 04326000
         MVC   OLDERID2(95,@10),@TS00001                           0967 04327000
*   NEWID2='VSEL';                  /*                       @ZM41110*/ 04328000
*                                                                  0968 04329000
         MVC   NEWID2(4,@10),@CC01470                              0968 04330000
*   /*****************************************************************/ 04331000
*   /*                                                               */ 04332000
*   /* THE ARRAY IS INDEXED THROUGH TO DETERMINE             @Z40LB35*/ 04333000
*   /* IF THE CURRENT DSN IS AMONG THE EXCLUDE               @Z40LB35*/ 04334000
*   /* DSNS                                                  @Z40LB35*/ 04335000
*   /*                                                               */ 04336000
*   /*****************************************************************/ 04337000
*                                                                  0969 04338000
*   DO EXCNUM=1 TO EXCLDCNT WHILE TESTRC=0;/*                @Z40LB35*/ 04339000
*                                                                  0969 04340000
         LA    EXCNUM,1                                            0969 04341000
         B     @DE00969                                            0969 04342000
@DL00969 LH    @10,TESTRC                                          0969 04343000
         LTR   @10,@10                                             0969 04344000
         BNZ   @DC00969                                            0969 04345000
*     /***************************************************************/ 04346000
*     /*                                                             */ 04347000
*     /* IF DSN IS AMONG THE DSN EXCLUDE LIST                @Z40LB35*/ 04348000
*     /* THE DOES NOT MEET CRITERION CODE IS SET             @Z40LB35*/ 04349000
*     /*                                                             */ 04350000
*     /***************************************************************/ 04351000
*                                                                  0970 04352000
*     IF DS1DSNAM=EXCLDVAL(EXCNUM) THEN/*                    @Z40LB35*/ 04353000
         LR    @10,EXCNUM                                          0970 04354000
         MH    @10,@CH01472                                        0970 04355000
         L     @03,@PC00001+8                                      0970 04356000
         L     @03,VS3EXDSP(,@03)                                  0970 04357000
         ALR   @03,@10                                             0970 04358000
         AL    @03,@CF01495                                        0970 04359000
         CLC   DS1DSNAM(44,F1PTR),EXCLDVAL-23(@03)                 0970 04360000
         BNE   @RF00970                                            0970 04361000
*       TESTRC=NOMEET;              /*                       @Z40LB35*/ 04362000
         LH    @10,NOMEET                                          0971 04363000
         STH   @10,TESTRC                                          0971 04364000
*   END;                            /*                       @Z40LB35*/ 04365000
*                                                                  0972 04366000
@RF00970 AL    EXCNUM,@CF00219                                     0972 04367000
@DE00969 L     @10,@PC00001+8                                      0972 04368000
         L     @10,VS3EXDSP(,@10)                                  0972 04369000
         CH    EXCNUM,EXCLDCNT(,@10)                               0972 04370000
         BNH   @DL00969                                            0972 04371000
@DC00969 DS    0H                                                  0973 04372000
*   /*****************************************************************/ 04373000
*   /*                                                               */ 04374000
*   /* CONTROL IS RETURNED TO CRITERIA WITH THE              @Z40LB35*/ 04375000
*   /* CODE SAVED IN TESTRC.                                 @Z40LB35*/ 04376000
*   /*                                                               */ 04377000
*   /*****************************************************************/ 04378000
*                                                                  0973 04379000
*   RETURN CODE(TESTRC);            /*                       @Z40LB35*/ 04380000
         LH    @15,TESTRC                                          0973 04381000
         L     @14,12(,@13)                                        0973 04382000
         LM    @00,@12,20(@13)                                     0973 04383000
         BR    @14                                                 0973 04384000
*   END EXCLUDE;                    /*                       @Z40LB35*/ 04385000
*   END IDCVS03                     /*                       @Z40LB35*/ 04386000
*                                                                  0975 04387000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04388000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                       */ 04389000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                       */ 04390000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                       */ 04391000
*/*%INCLUDE SYSLIB  (IDCDF04 )                                       */ 04392000
*/*%INCLUDE SYSLIB  (IECSDSL1)                                       */ 04393000
*                                                                  0975 04394000
*       ;                                                          0975 04395000
@DATA    DS    0H                                                       04396000
@CH00036 DC    H'2'                                                     04397000
@CH00179 DC    H'8'                                                     04398000
@CH00035 DC    H'12'                                                    04399000
@CH01472 DC    H'66'                                                    04400000
@CH01471 DC    H'80'                                                    04401000
@CH01243 DC    H'96'                                                    04402000
@SC01491 CLC   DSNQUAL(0,@03),DS1DSNAM(F1PTR)                           04403000
@SC01493 CLC   DS1DSNAM(0,@01),DSNQUAL(@03)                             04404000
@DATD    DSECT                                                          04405000
         DS    0F                                                       04406000
@SA00001 DS    18F                                                      04407000
@PC00001 DS    3F                                                       04408000
@SA00002 DS    13F                                                      04409000
@SA00006 DS    15F                                                      04410000
@SA00007 DS    15F                                                      04411000
@SA00005 DS    15F                                                      04412000
@SA00003 DS    13F                                                      04413000
@SA00004 DS    15F                                                      04414000
@SA00008 DS    13F                                                      04415000
@SA00009 DS    15F                                                      04416000
@SA00010 DS    13F                                                      04417000
@SA00012 DS    15F                                                      04418000
@AL00001 DS    6A                                                       04419000
IDCVS03  CSECT                                                          04420000
         DS    0F                                                       04421000
@CF00115 DC    F'0'                                                     04422000
@CF00219 DC    F'1'                                                     04423000
@CF00041 DC    F'4'                                                     04424000
@CH00041 EQU   @CF00041+2                                               04425000
@CF00295 DC    F'5'                                                     04426000
@CF00476 DC    F'10'                                                    04427000
@CF00506 DC    F'16'                                                    04428000
@CH00506 EQU   @CF00506+2                                               04429000
@CF01327 DC    F'36'                                                    04430000
@CF00847 DC    F'44'                                                    04431000
@CF01203 DC    F'140'                                                   04432000
@CF01485 DC    F'-64'                                                   04433000
@CF01484 DC    F'-60'                                                   04434000
@CF01495 DC    F'-43'                                                   04435000
@CF01486 DC    F'-16'                                                   04436000
@DATD    DSECT                                                          04437000
         DS    0D                                                       04438000
LISTSCAN DS    A                                                        04439000
IOCSPTR  DS    A                                                        04440000
OPNPTR   DS    A                                                        04441000
DDSTRU   DS    A                                                        04442000
FSADDR   DS    A                                                        04443000
ERCNVADR DS    A                                                        04444000
DMPINDEX DS    A                                                        04445000
CCMSGPTR DS    A                                                        04446000
CMMSGPTR DS    A                                                        04447000
CTMSGPTR DS    A                                                        04448000
IOXPTR   DS    A                                                        04449000
TRACKPTR DS    A                                                        04450000
LCTINFOP DS    A                                                        04451000
FMT0CTR  DS    F                                                        04452000
VSDSIZE  DS    F                                                        04453000
UNITABLP DS    A                                                        04454000
LISTPTR  DS    A                                                        04455000
TESTRC   DS    H                                                        04456000
FINALRC  DS    H                                                        04457000
SETRC    DS    H                                                        04458000
LISTLN   DS    FL1                                                      04459000
@TS00001 DS    CL95                                                     04460000
         DS    CL2                                                      04461000
PRINTARG DS    CL20                                                     04462000
LOCATESW DS    BL1                                                      04463000
MSGSENT  DS    BL1                                                      04464000
ENQ      DS    BL1                                                      04465000
         DS    CL1                                                      04466000
EXOPARM  DS    CL34                                                     04467000
         DS    CL2                                                      04468000
EXGPARM1 DS    CL32                                                     04469000
EXGPARM2 DS    CL32                                                     04470000
RTNUNIT  DS    CL11                                                     04471000
         DS    CL1                                                      04472000
LCTAREA  DS    CL33                                                     04473000
RNAME    DS    CL7                                                      04474000
         ORG   RNAME                                                    04475000
RLENGTH  DS    FL1                                                      04476000
RVOLSER  DS    CL6                                                      04477000
         ORG   RNAME+7                                                  04478000
IOBLOCK  DS    CL28                                                     04479000
         ORG   IOBLOCK                                                  04480000
BEGCCHH  DS    FL4                                                      04481000
         ORG   BEGCCHH                                                  04482000
BEGCC    DS    FL2                                                      04483000
BEGHH    DS    FL2                                                      04484000
         ORG   IOBLOCK+4                                                04485000
@NM00094 DS    CL1                                                      04486000
ENDCCHH  DS    FL4                                                      04487000
         ORG   ENDCCHH                                                  04488000
ENDCC    DS    FL2                                                      04489000
ENDHH    DS    FL2                                                      04490000
         ORG   IOBLOCK+9                                                04491000
@NM00095 DS    CL1                                                      04492000
         DS    CL2                                                      04493000
LASTCCHH DS    FL4                                                      04494000
         ORG   LASTCCHH                                                 04495000
LCC      DS    FL2                                                      04496000
LHH      DS    FL2                                                      04497000
         ORG   IOBLOCK+16                                               04498000
LR       DS    FL1                                                      04499000
@NM00096 DS    CL3                                                      04500000
FMT1CNT  DS    FL4                                                      04501000
FMT1PTR  DS    AL4                                                      04502000
         ORG   IOBLOCK+28                                               04503000
TRACKRSW DS    BL1                                                      04504000
FMT1SW   DS    BL1                                                      04505000
NOFMT3   DS    BL1                                                      04506000
FMT3     DS    CL140                                                    04507000
AAAAAASW DS    BL1                                                      04508000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04509000
@ENDDATD EQU   *                                                        04510000
IDCVS03  CSECT                                                          04511000
         DS    0F                                                       04512000
@SIZDATD DC    AL1(0)                                                   04513000
         DC    AL3(@ENDDATD-@DATD)                                      04514000
         DS    0D                                                       04515000
NULLENTY DC    XL4'FFFFFF'                                              04516000
TRACKLEN DC    F'5460'                                                  04517000
MAXTRKS  DC    H'18'                                                    04518000
TRACKSIZ DC    H'19'                                                    04519000
VTOCTRK  DC    H'39'                                                    04520000
EOF      DC    H'12'                                                    04521000
NOMEET   DC    H'16'                                                    04522000
MSGCODE  DC    AL1(8)                                                   04523000
FMT4KEY  DC    AL1(44)                                                  04524000
FMT1EXTS DC    AL1(3)                                                   04525000
FMT3EXT1 DC    AL1(4)                                                   04526000
FMT3EXT2 DC    AL1(9)                                                   04527000
@CC01112 DC    C'VS03'                                                  04528000
@CC01290 DC    C'VS3X'                                                  04529000
@CC01294 DC    C'VSIT'                                                  04530000
@CC01308 DC    C'VSGB'                                                  04531000
@CC01314 DC    C'VSTK'                                                  04532000
@CC01319 DC    C'VSOP'                                                  04533000
@CC01330 DC    C'VSSR'                                                  04534000
@CC01341 DC    C'VSCU'                                                  04535000
@CC01348 DC    C'VSF1'                                                  04536000
@CC01352 DC    C'VSCT'                                                  04537000
@CC01404 DC    C'VSUS'                                                  04538000
@CC01415 DC    C'VSST'                                                  04539000
@CC01419 DC    C'VSCG'                                                  04540000
@CC01430 DC    C'VSQL'                                                  04541000
@CC01434 DC    C'VSCR'                                                  04542000
@CC01438 DC    C'VSEX'                                                  04543000
@CC01451 DC    C'VSSN'                                                  04544000
@CC01470 DC    C'VSEL'                                                  04545000
@CC01119 DC    C'UV0'                                                   04546000
@CC01121 EQU   @CC01112                                                 04547000
@CC01452 DC    C'SYS'                                                   04548000
@CC01453 DC    C'.T'                                                    04549000
ALL      DC    CL3'ALL'                                                 04550000
FORMAT   DC    CL4'FORM'                                                04551000
HSECOND  DC    CL4'HSEC'                                                04552000
CLOCK    DC    CL4'KLOK'                                                04553000
SETZERO  DC    CL4'ZERO'                                                04554000
SETBLANK DC    CL4'BLNK'                                                04555000
NOSET    DC    CL4'NSET'                                                04556000
OVERRIDE DC    CL4'OVRD'                                                04557000
ACQUIRE  DC    CL8'ACQUIRE '                                            04558000
RELINQ   DC    CL8'RELINQ  '                                            04559000
MOUNT    DC    CL8'MOUNT   '                                            04560000
DEMOUNT  DC    CL8'DEMOUNT '                                            04561000
DEFINE   DC    CL8'DEFINE  '                                            04562000
MOVE     DC    CL8'MOVE    '                                            04563000
TRACEQ   DC    CL8'TRACEQ  '                                            04564000
COPYTABL DC    CL8'COPYTABL'                                            04565000
COPYCRTG DC    CL8'COPYCRTG'                                            04566000
COPYVOL  DC    CL8'COPYVOL '                                            04567000
VVIC     DC    CL8'VVIC    '                                            04568000
TUNE     DC    CL8'TUNE    '                                            04569000
NAMES    DC    CL4'NAME'                                                04570000
UNIT     DC    CL4'UNIT'                                                04571000
SHR      DC    CL4'SHR '                                                04572000
EXCL     DC    CL4'EXCL'                                                04573000
NOWAIT   DC    CL4'NWAI'                                                04574000
WAIT     DC    CL4'WAIT'                                                04575000
SECCHECK DC    CL8'SECCHECK'                                            04576000
SCRVTOC  DC    CL8'SCRVTOC '                                            04577000
GETVTOC  DC    CL8'GETVTOC '                                            04578000
PUTVTOC  DC    CL8'PUTVTOC '                                            04579000
RECATLG  DC    CL8'RECATLG '                                            04580000
INITVOL  DC    CL8'INITVOL '                                            04581000
CHECK    DC    CL8'CHECK   '                                            04582000
POSTUCB  DC    CL8'POSTUCB '                                            04583000
GET      DC    CL8'GET     '                                            04584000
PUT      DC    CL8'PUT     '                                            04585000
CLOSE    DC    CL8'CLOSE   '                                            04586000
OPEN     DC    CL8'OPEN    '                                            04587000
RVOPENR  DC    CL8'OPENR   '                                            04588000
RVRDCNT  DC    CL8'READCNT '                                            04589000
RVREADKD DC    CL8'READKD  '                                            04590000
RVSPACCR DC    CL8'SPACCR  '                                            04591000
RVFWRITE DC    CL8'FWRITE  '                                            04592000
RVWRITER DC    CL8'WRITEREC'                                            04593000
PUTLABEL DC    CL8'PUTLABEL'                                            04594000
GETLABEL DC    CL8'GETLABEL'                                            04595000
CANCEL   DC    CL8'CANCEL  '                                            04596000
SET      DC    CL8'SET     '                                            04597000
SELECTX  DC    CL8'SELECTX '                                            04598000
CHANGEX  DC    CL8'CHANGEX '                                            04599000
SELECTDD DC    CL8'SELECTDD'                                            04600000
SELECTDS DC    CL8'SELECTDS'                                            04601000
TBLREST  DC    CL8'TBLREST '                                            04602000
NULLIFYC DC    CL8'NULLIFYC'                                            04603000
RDMSC    DC    CL8'RDMSC   '                                            04604000
RDMSCTBL DC    CL8'RDMSCTBL'                                            04605000
RDCARTLB DC    CL8'RDCARTLB'                                            04606000
AUDITCEL DC    CL8'AUDITCEL'                                            04607000
RDSTGAD  DC    CL8'RDSTGAD '                                            04608000
MODIFYC  DC    CL8'MODIFYC '                                            04609000
MODID    DC    CL4'VS03'                                                04610000
         DS    CL2                                                      04611000
FIXAREA  DS    CL350                                                    04612000
         ORG   FIXAREA                                                  04613000
@NM00093 DC    350X'00'                                                 04614000
         ORG   FIXAREA+350                                              04615000
BLANK    DC    CL1' '                                                   04616000
FMT1ID   DC    X'F1'                                                    04617000
FMT0ID   DC    X'00'                                                    04618000
QNAME    DC    CL8'SYSVTOC'                                             04619000
FMT3ID   DC    X'F3'                                                    04620000
NULLCCHH DC    X'0000000000'                                            04621000
PERIOD   DC    CL1'.'                                                   04622000
AAAANAME DC    CL35'AAAAAAAA.AAAAAAAA.AAAAAAAA.AAAAAAAA'                04623000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04624000
@01      EQU   01                                                       04625000
@02      EQU   02                                                       04626000
@03      EQU   03                                                       04627000
@04      EQU   04                                                       04628000
@05      EQU   05                                                       04629000
@06      EQU   06                                                       04630000
@07      EQU   07                                                       04631000
@08      EQU   08                                                       04632000
@09      EQU   09                                                       04633000
@10      EQU   10                                                       04634000
@11      EQU   11                                                       04635000
@12      EQU   12                                                       04636000
@13      EQU   13                                                       04637000
@14      EQU   14                                                       04638000
@15      EQU   15                                                       04639000
EXCNUM   EQU   @04                                                      04640000
NUMCTR   EQU   @06                                                      04641000
NUMPTR   EQU   @04                                                      04642000
ENDQUAL  EQU   @08                                                      04643000
BEGTRAIL EQU   @07                                                      04644000
TRAILLEV EQU   @04                                                      04645000
LEADLEV  EQU   @06                                                      04646000
ENDEXT   EQU   @07                                                      04647000
STARTEXT EQU   @10                                                      04648000
EXTELEM  EQU   @09                                                      04649000
EXTENTCT EQU   @06                                                      04650000
EXTENTP  EQU   @08                                                      04651000
DSCBNUM  EQU   @10                                                      04652000
FMT1S    EQU   @06                                                      04653000
FMT1DSCB EQU   @04                                                      04654000
FMT1CTR  EQU   @09                                                      04655000
GETPTR   EQU   @06                                                      04656000
F1PTR    EQU   @05                                                      04657000
F3PTR    EQU   @03                                                      04658000
F4PTR    EQU   @04                                                      04659000
ELEMENT  EQU   @04                                                      04660000
RTNREG   EQU   @15                                                      04661000
REG13    EQU   @13                                                      04662000
REG14    EQU   @14                                                      04663000
REG15    EQU   @15                                                      04664000
UCBREG   EQU   @00                                                      04665000
LSPACEBF EQU   @01                                                      04666000
REG0     EQU   @00                                                      04667000
REG1     EQU   @01                                                      04668000
REG10    EQU   @10                                                      04669000
REG11    EQU   @11                                                      04670000
REG12    EQU   @12                                                      04671000
REG2     EQU   @02                                                      04672000
REG3     EQU   @03                                                      04673000
REG4     EQU   @04                                                      04674000
REG5     EQU   @05                                                      04675000
REG6     EQU   @06                                                      04676000
REG7     EQU   @07                                                      04677000
REG8     EQU   @08                                                      04678000
REG9     EQU   @09                                                      04679000
IDCSAEP0 EQU   0                                                        04680000
IDCSAGS0 EQU   0                                                        04681000
IDCSAFS0 EQU   0                                                        04682000
IDCSAGP0 EQU   0                                                        04683000
IDCSARV0 EQU   0                                                        04684000
IDCSADQ0 EQU   0                                                        04685000
IDCSASI0 EQU   0                                                        04686000
IDCSALC0 EQU   0                                                        04687000
TRACE1   EQU   0                                                        04688000
OLDERID1 EQU   TRACE1                                                   04689000
TRACE2   EQU   0                                                        04690000
OLDERID2 EQU   TRACE2                                                   04691000
NEWID2   EQU   TRACE2+95                                                04692000
NEWERID2 EQU   5                                                        04693000
CIRAGL   EQU   0                                                        04694000
CIRTYPE  EQU   CIRAGL                                                   04695000
ALLAGL   EQU   0                                                        04696000
ALLSTS   EQU   ALLAGL+24                                                04697000
ALLDSP   EQU   ALLAGL+25                                                04698000
ALLORG   EQU   ALLAGL+26                                                04699000
ALLOPT   EQU   ALLAGL+28                                                04700000
RACFAGL  EQU   0                                                        04701000
RACFFLG1 EQU   RACFAGL                                                  04702000
RACFFLG2 EQU   RACFAGL+1                                                04703000
RACFFLG3 EQU   RACFAGL+2                                                04704000
RACFFLG4 EQU   RACFAGL+3                                                04705000
UNITABL  EQU   0                                                        04706000
UNITUCB  EQU   UNITABL                                                  04707000
UNITADR  EQU   UNITABL+4                                                04708000
@NM00017 EQU   UNITADR                                                  04709000
UNITSTAT EQU   UNITABL+6                                                04710000
IDCIO050 EQU   0                                                        04711000
IOCSTR   EQU   0                                                        04712000
IOCDSO   EQU   IOCSTR+16                                                04713000
IOCRFM   EQU   IOCSTR+17                                                04714000
IOCMAC   EQU   IOCSTR+18                                                04715000
IOCMAC2  EQU   IOCSTR+19                                                04716000
IOCCHP   EQU   IOCSTR+20                                                04717000
IOCMSG   EQU   IOCSTR+21                                                04718000
IOCRBA   EQU   IOCSTR+40                                                04719000
IOCTTR   EQU   IOCRBA                                                   04720000
IOCMEM   EQU   IOCSTR+44                                                04721000
IOCNWM   EQU   IOCSTR+48                                                04722000
IOCREL   EQU   IOCSTR+60                                                04723000
OPNAGL   EQU   0                                                        04724000
OPNOPT   EQU   OPNAGL                                                   04725000
OPNRFM   EQU   OPNAGL+1                                                 04726000
OPNTYP   EQU   OPNAGL+2                                                 04727000
OPNMOD   EQU   OPNAGL+3                                                 04728000
OPNDEV   EQU   OPNAGL+24                                                04729000
OPNDSO   EQU   OPNAGL+41                                                04730000
OPNOPT2  EQU   OPNAGL+42                                                04731000
IOINFOPT EQU   0                                                        04732000
UVOLLIST EQU   0                                                        04733000
UVOLENT  EQU   UVOLLIST+2                                               04734000
AMSTP011 EQU   0                                                        04735000
DARGLIST EQU   0                                                        04736000
DARGDBP  EQU   DARGLIST                                                 04737000
DARGSTID EQU   DARGLIST+8                                               04738000
DARGSMOD EQU   DARGSTID                                                 04739000
DARGSENT EQU   DARGSTID+3                                               04740000
DARGILP  EQU   DARGLIST+12                                              04741000
DARGARY  EQU   DARGLIST+20                                              04742000
DARGINS  EQU   DARGARY                                                  04743000
DARGINL  EQU   DARGARY+2                                                04744000
FMTLIST  EQU   0                                                        04745000
FMTFLGS  EQU   FMTLIST                                                  04746000
FMTSPF   EQU   FMTLIST+2                                                04747000
FMTRFNO  EQU   FMTSPF                                                   04748000
FMTILEN  EQU   FMTRFNO                                                  04749000
FMTIOFF  EQU   FMTLIST+4                                                04750000
FMTTRBC  EQU   FMTIOFF                                                  04751000
FMTSTO   EQU   FMTTRBC                                                  04752000
FMTOCOL  EQU   FMTLIST+6                                                04753000
FMTCNVF  EQU   FMTLIST+10                                               04754000
ERCNVTAB EQU   0                                                        04755000
ERTYPE   EQU   ERCNVTAB                                                 04756000
EROPER   EQU   ERCNVTAB+1                                               04757000
EROSOPER EQU   ERCNVTAB+2                                               04758000
ERCATRC  EQU   ERCNVTAB+16                                              04759000
ERCPLPT  EQU   ERCNVTAB+20                                              04760000
IDCDB010 EQU   0                                                        04761000
DMPITM   EQU   0                                                        04762000
DMPARY   EQU   0                                                        04763000
CCMSG    EQU   0                                                        04764000
CMMSG    EQU   0                                                        04765000
CMVOLFLG EQU   CMMSG+6                                                  04766000
CTMSG    EQU   0                                                        04767000
CTARRAY  EQU   CTMSG+4                                                  04768000
MDAGL    EQU   0                                                        04769000
MDFLAGS  EQU   MDAGL+30                                                 04770000
MDVTOC   EQU   MDAGL+32                                                 04771000
PUAGL    EQU   0                                                        04772000
CKAGL    EQU   0                                                        04773000
CKFLAGS  EQU   CKAGL+28                                                 04774000
EXCLAGL  EQU   0                                                        04775000
EXCLFLAG EQU   EXCLAGL+22                                               04776000
EXOARG   EQU   0                                                        04777000
EXODDN   EQU   EXOARG+8                                                 04778000
EXOVSN   EQU   EXOARG+16                                                04779000
EXOEXT   EQU   EXOARG+24                                                04780000
EXOCTLBK EQU   EXOARG+28                                                04781000
EXOPT    EQU   EXOARG+32                                                04782000
EXOVTOC  EQU   EXOPT                                                    04783000
EXFLG    EQU   EXOARG+33                                                04784000
EXOREAD  EQU   EXFLG                                                    04785000
EXGARG   EQU   0                                                        04786000
EXGCTLBK EQU   EXGARG+8                                                 04787000
EXGCCHH2 EQU   EXGARG+16                                                04788000
EXGRECNO EQU   EXGARG+20                                                04789000
EXGDATAP EQU   EXGARG+24                                                04790000
EXGKEYLN EQU   EXGARG+28                                                04791000
EXGDATAL EQU   EXGARG+30                                                04792000
EXWRARG  EQU   0                                                        04793000
EXRWCHR  EQU   EXWRARG+26                                               04794000
EXSPACE  EQU   EXWRARG+36                                               04795000
EXPARG   EQU   0                                                        04796000
EXPDATA  EQU   EXPARG+12                                                04797000
EXPDATAB EQU   0                                                        04798000
EXPARRAY EQU   EXPDATAB+4                                               04799000
VS2AGL   EQU   0                                                        04800000
VSLABOPT EQU   VS2AGL+28                                                04801000
VS2MSG   EQU   VS2AGL+35                                                04802000
VS2RESOP EQU   VS2AGL+36                                                04803000
VS1AGL   EQU   0                                                        04804000
VSSECOPT EQU   VS1AGL+68                                                04805000
VSVTOPT  EQU   VS1AGL+69                                                04806000
VSCATOPT EQU   VS1AGL+70                                                04807000
VSRETURN EQU   VS1AGL+71                                                04808000
VSMSG    EQU   VS1AGL+72                                                04809000
VSRESOPT EQU   VS1AGL+73                                                04810000
RCTAGL   EQU   0                                                        04811000
RCTOPT   EQU   RCTAGL+8                                                 04812000
STAEPARM EQU   0                                                        04813000
STARCVY  EQU   STAEPARM+52                                              04814000
STARETRY EQU   STAEPARM+53                                              04815000
VOLLABEL EQU   0                                                        04816000
SV82LIST EQU   0                                                        04817000
@NM00073 EQU   SV82LIST+4                                               04818000
SV82DCBP EQU   @NM00073                                                 04819000
@NM00074 EQU   SV82LIST+12                                              04820000
SV82WRKP EQU   @NM00074                                                 04821000
SRTAGL   EQU   0                                                        04822000
LCTINFO  EQU   0                                                        04823000
LCTMULVC EQU   LCTINFO+8                                                04824000
LCTACBP  EQU   LCTINFO+12                                               04825000
LCTCREAT EQU   LCTINFO+16                                               04826000
LCTEXPIR EQU   LCTINFO+20                                               04827000
LCTOWNER EQU   LCTINFO+24                                               04828000
LCTFLAGS EQU   LCTINFO+32                                               04829000
LCTVSCAT EQU   LCTFLAGS                                                 04830000
UCTAGL   EQU   0                                                        04831000
UCTFLAGS EQU   UCTAGL+68                                                04832000
SELAGL   EQU   0                                                        04833000
SELFLAGS EQU   SELAGL+22                                                04834000
DATESAGL EQU   0                                                        04835000
DATESOPT EQU   DATESAGL+20                                              04836000
VS3AGL   EQU   0                                                        04837000
VS3HEAD  EQU   VS3AGL                                                   04838000
VS3LISTP EQU   VS3AGL+8                                                 04839000
VS3EXDSP EQU   VS3AGL+12                                                04840000
VS3LEVP  EQU   VS3AGL+16                                                04841000
VS3LEVLN EQU   VS3AGL+20                                                04842000
VS3AST   EQU   VS3AGL+22                                                04843000
VS3EXPIR EQU   VS3AGL+24                                                04844000
VS3CREAT EQU   VS3AGL+28                                                04845000
VS3UCBP  EQU   VS3AGL+32                                                04846000
VS3DEV   EQU   VS3AGL+36                                                04847000
VS3POOL  EQU   VS3AGL+40                                                04848000
VS3VOL   EQU   VS3AGL+44                                                04849000
VS3DD    EQU   VS3AGL+50                                                04850000
VS3FLAGS EQU   VS3AGL+58                                                04851000
VS3STAT  EQU   VS3FLAGS                                                 04852000
VS3USAGE EQU   VS3FLAGS                                                 04853000
VS3SCR   EQU   VS3FLAGS                                                 04854000
VS3UNCAT EQU   VS3FLAGS                                                 04855000
VS3SYSNM EQU   VS3FLAGS                                                 04856000
VSDVTOC  EQU   0                                                        04857000
VSDSTAT  EQU   0                                                        04858000
VSDCREAT EQU   VSDSTAT                                                  04859000
VSDEXPIR EQU   VSDSTAT+4                                                04860000
VSDOWNER EQU   VSDSTAT+8                                                04861000
VSDSFLG1 EQU   VSDSTAT+16                                               04862000
VSDVTOCC EQU   VSDSFLG1                                                 04863000
VSDVTOCE EQU   VSDSFLG1                                                 04864000
VSDVSAMC EQU   VSDSFLG1                                                 04865000
VSDVSAME EQU   VSDSFLG1                                                 04866000
VSDCATLG EQU   VSDSFLG1                                                 04867000
VSDCVSAM EQU   VSDSFLG1                                                 04868000
VSDFLG2  EQU   VSDSTAT+17                                               04869000
VSDPWR   EQU   VSDFLG2                                                  04870000
VSDPWW   EQU   VSDFLG2                                                  04871000
VSDPROT  EQU   VSDFLG2                                                  04872000
VSDERROR EQU   VSDFLG2                                                  04873000
VSDRACF  EQU   VSDFLG2                                                  04874000
VSDSCR   EQU   0                                                        04875000
VSDACBPT EQU   VSDSCR                                                   04876000
VSDSCRFL EQU   VSDSCR+4                                                 04877000
VSDCATLC EQU   VSDSCRFL                                                 04878000
VSDVSAM  EQU   VSDSCRFL                                                 04879000
VSDUSAGE EQU   0                                                        04880000
VSDTRKS  EQU   VSDUSAGE                                                 04881000
VSDFTRK  EQU   VSDUSAGE+2                                               04882000
VSDSECAL EQU   VSDUSAGE+4                                               04883000
VSDEXTS  EQU   VSDUSAGE+8                                               04884000
VSDDORG  EQU   VSDUSAGE+9                                               04885000
VSDOPO   EQU   VSDDORG                                                  04886000
VSDOPS   EQU   VSDDORG                                                  04887000
VSDOUN   EQU   VSDDORG                                                  04888000
VSDODA   EQU   VSDDORG                                                  04889000
VSDOIS   EQU   VSDDORG                                                  04890000
VSDOU    EQU   VSDDORG                                                  04891000
VSDALLOC EQU   VSDUSAGE+10                                              04892000
VSDACYL  EQU   VSDALLOC                                                 04893000
VSDATRK  EQU   VSDALLOC                                                 04894000
VSDABLK  EQU   VSDALLOC                                                 04895000
VSDABSTR EQU   VSDALLOC                                                 04896000
VSDUSEF  EQU   VSDUSAGE+11                                              04897000
VSDCALFR EQU   VSDUSEF                                                  04898000
VSDDSORG EQU   VSDUSAGE+16                                              04899000
VSDBLOCK EQU   0                                                        04900000
VSDELEM  EQU   VSDBLOCK                                                 04901000
VSDVTOCS EQU   VSDBLOCK+4                                               04902000
VSDFMT0  EQU   VSDBLOCK+8                                               04903000
VSDSPACE EQU   VSDBLOCK+12                                              04904000
VSDARRAY EQU   VSDBLOCK+16                                              04905000
VSDVOLCT EQU   VSDARRAY                                                 04906000
VSDDSN   EQU   VSDARRAY+4                                               04907000
VSDVARY  EQU   VSDARRAY+48                                              04908000
VSDPTR   EQU   0                                                        04909000
CREATDTE EQU   0                                                        04910000
EXPIRDTE EQU   0                                                        04911000
IECSDSF1 EQU   0                                                        04912000
IECSDSL1 EQU   0                                                        04913000
DS1DSNAM EQU   IECSDSL1                                                 04914000
DS1FMTID EQU   IECSDSL1+44                                              04915000
DS1CREDT EQU   IECSDSL1+53                                              04916000
DS1EXPDT EQU   IECSDSL1+56                                              04917000
DS1DSORG EQU   IECSDSL1+82                                              04918000
DS1RECFM EQU   IECSDSL1+84                                              04919000
DS1DSIND EQU   IECSDSL1+93                                              04920000
DS1SCALO EQU   IECSDSL1+94                                              04921000
DS1LSTAR EQU   IECSDSL1+98                                              04922000
DS1TRBAL EQU   IECSDSL1+101                                             04923000
DS1EXT1  EQU   IECSDSL1+105                                             04924000
DS1PTRDS EQU   IECSDSL1+135                                             04925000
IECSDSF3 EQU   0                                                        04926000
IECSDSL3 EQU   0                                                        04927000
DS3EXTNT EQU   IECSDSL3+4                                               04928000
DS3FMTID EQU   IECSDSL3+44                                              04929000
DS3ADEXT EQU   IECSDSL3+45                                              04930000
IECSDSF4 EQU   0                                                        04931000
IECSDSL4 EQU   0                                                        04932000
DS4DEVCT EQU   IECSDSL4+18                                              04933000
DS4DEVOV EQU   DS4DEVCT+6                                               04934000
DS4AMCAT EQU   IECSDSL4+40                                              04935000
DS4VSIND EQU   DS4AMCAT                                                 04936000
DS4VTOCE EQU   IECSDSL4+61                                              04937000
DS4EXTS  EQU   0                                                        04938000
DSEXTS   EQU   0                                                        04939000
DSBG     EQU   DSEXTS+2                                                 04940000
DSBGCYLS EQU   DSBG                                                     04941000
DSBGTRKS EQU   DSBG+2                                                   04942000
DSENCYLS EQU   DSEXTS+6                                                 04943000
DSENTRKS EQU   DSEXTS+8                                                 04944000
DSNQUAL  EQU   0                                                        04945000
SYSNAMNO EQU   0                                                        04946000
EXCLDSNS EQU   0                                                        04947000
EXCLDCNT EQU   EXCLDSNS                                                 04948000
@NM00123 EQU   EXCLDSNS+2                                               04949000
EXCLDVAL EQU   @NM00123+21                                              04950000
AMSTP041 EQU   0                                                        04951000
AMSTP042 EQU   0                                                        04952000
AMSTP043 EQU   0                                                        04953000
AMSTP044 EQU   0                                                        04954000
DMPTRM   EQU   0                                                        04955000
IDCIOCL0 EQU   0                                                        04956000
IDCIOCO0 EQU   0                                                        04957000
IDCIOGT0 EQU   0                                                        04958000
IDCIOIT0 EQU   0                                                        04959000
IDCIOOP0 EQU   0                                                        04960000
IDCIOPO0 EQU   0                                                        04961000
IDCIOPT0 EQU   0                                                        04962000
IDCIOSI0 EQU   0                                                        04963000
IDCIOST0 EQU   0                                                        04964000
IDCIOTM0 EQU   0                                                        04965000
IDCIOVY0 EQU   0                                                        04966000
IDCSAAL0 EQU   0                                                        04967000
IDCSACA0 EQU   0                                                        04968000
IDCSACL0 EQU   0                                                        04969000
IDCSACR0 EQU   0                                                        04970000
IDCSADE0 EQU   0                                                        04971000
IDCSADL0 EQU   0                                                        04972000
IDCSAFP0 EQU   0                                                        04973000
IDCSAID0 EQU   0                                                        04974000
IDCSALD0 EQU   0                                                        04975000
IDCSALK0 EQU   0                                                        04976000
IDCSANQ0 EQU   0                                                        04977000
IDCSAPR0 EQU   0                                                        04978000
IDCSAPT0 EQU   0                                                        04979000
IDCSAQL0 EQU   0                                                        04980000
IDCSARC0 EQU   0                                                        04981000
IDCSARK0 EQU   0                                                        04982000
IDCSASC0 EQU   0                                                        04983000
IDCSASN0 EQU   0                                                        04984000
IDCSASS0 EQU   0                                                        04985000
IDCSAST0 EQU   0                                                        04986000
IDCSATI0 EQU   0                                                        04987000
IDCSAUC0 EQU   0                                                        04988000
IDCSAWO0 EQU   0                                                        04989000
IDCSA060 EQU   0                                                        04990000
IDCST010 EQU   0                                                        04991000
IDCTPER0 EQU   0                                                        04992000
LISTTEST EQU   0                                                        04993000
NEWERID1 EQU   5                                                        04994000
GDTTBL   EQU   0                                                        04995000
GDTTR1   EQU   GDTTBL+8                                                 04996000
GDTTR2   EQU   GDTTBL+12                                                04997000
GDTDBG   EQU   GDTTBL+40                                                04998000
GDTSTC   EQU   GDTTBL+44                                                04999000
GDTPRT   EQU   GDTTBL+48                                                05000000
GDTESS   EQU   GDTTBL+52                                                05001000
GDTESA   EQU   GDTTBL+56                                                05002000
GDTRST   EQU   GDTTBL+60                                                05003000
GDTRES   EQU   GDTTBL+64                                                05004000
GDTCAL   EQU   GDTTBL+68                                                05005000
GDTGSP   EQU   GDTTBL+72                                                05006000
GDTFSP   EQU   GDTTBL+76                                                05007000
GDTGPL   EQU   GDTTBL+80                                                05008000
GDTFPL   EQU   GDTTBL+84                                                05009000
GDTLOD   EQU   GDTTBL+88                                                05010000
GDTDEL   EQU   GDTTBL+92                                                05011000
GDTPRL   EQU   GDTTBL+96                                                05012000
GDTEPL   EQU   GDTTBL+100                                               05013000
GDTTIM   EQU   GDTTBL+104                                               05014000
GDTIIO   EQU   GDTTBL+108                                               05015000
GDTTIO   EQU   GDTTBL+112                                               05016000
GDTOPN   EQU   GDTTBL+124                                               05017000
GDTCLS   EQU   GDTTBL+128                                               05018000
GDTGET   EQU   GDTTBL+132                                               05019000
GDTPUT   EQU   GDTTBL+136                                               05020000
GDTPOS   EQU   GDTTBL+140                                               05021000
GDTCPY   EQU   GDTTBL+144                                               05022000
GDTCAT   EQU   GDTTBL+148                                               05023000
GDTABT   EQU   GDTTBL+152                                               05024000
GDTABH   EQU   GDTTBL+156                                               05025000
GDTSNP   EQU   GDTTBL+164                                               05026000
GDTVFY   EQU   GDTTBL+172                                               05027000
GDTUID   EQU   GDTTBL+192                                               05028000
GDTPMT   EQU   GDTTBL+196                                               05029000
GDTCIR   EQU   GDTTBL+200                                               05030000
GDTLNK   EQU   GDTTBL+204                                               05031000
GDTALC   EQU   GDTTBL+208                                               05032000
GDTDLC   EQU   GDTTBL+212                                               05033000
GDTQAL   EQU   GDTTBL+216                                               05034000
GDTSTW   EQU   GDTTBL+220                                               05035000
GDTSSC   EQU   GDTTBL+224                                               05036000
GDTENQ   EQU   GDTTBL+228                                               05037000
GDTRSV   EQU   GDTTBL+232                                               05038000
GDTDEQ   EQU   GDTTBL+236                                               05039000
GDTSFO   EQU   GDTTBL+240                                               05040000
GDTWTO   EQU   GDTTBL+244                                               05041000
GDTSCR   EQU   GDTTBL+248                                               05042000
GDTUNT   EQU   GDTTBL+252                                               05043000
GDTRCT   EQU   GDTTBL+256                                               05044000
GDTIFO   EQU   GDTTBL+260                                               05045000
GDTEXP   EQU   GDTTBL+264                                               05046000
GDTSTA   EQU   GDTTBL+268                                               05047000
GDTERR   EQU   GDTTBL+272                                               05048000
GDTUNC   EQU   GDTTBL+276                                               05049000
GDTLOC   EQU   GDTTBL+280                                               05050000
GDTRCK   EQU   GDTTBL+284                                               05051000
REQUEST  EQU   0                                                        05052000
ARGLIST  EQU   0                                                        05053000
DSCREAT  EQU   DS1CREDT                                                 05054000
DSEXPIR  EQU   DS1EXPDT                                                 05055000
CATCREAT EQU   LCTCREAT                                                 05056000
CATEXPIR EQU   LCTEXPIR                                                 05057000
DSORG    EQU   DS1DSORG                                                 05058000
DS1DSIS  EQU   DSORG                                                    05059000
DS1DSPS  EQU   DSORG                                                    05060000
DS1DSDA  EQU   DSORG                                                    05061000
DS1DSPO  EQU   DSORG                                                    05062000
DS1DSU   EQU   DSORG                                                    05063000
DS1VSAM  EQU   DSORG+1                                                  05064000
@NM00110 EQU   DS1SCALO                                                 05065000
DS1SECAL EQU   @NM00110+1                                               05066000
@NM00112 EQU   DS1SCALO                                                 05067000
DS1SCAL  EQU   DS1SCALO                                                 05068000
DS1CAL1  EQU   DS1SCAL                                                  05069000
DS1CAL2  EQU   DS1SCAL                                                  05070000
@NM00115 EQU   DS1LSTAR                                                 05071000
DS1LSTTT EQU   @NM00115                                                 05072000
DS1LSTR  EQU   @NM00115+2                                               05073000
@NM00116 EQU   DS1TRBAL                                                 05074000
DS1TBAL  EQU   @NM00116                                                 05075000
@NM00117 EQU   DS1RECFM                                                 05076000
DS1TRKOV EQU   @NM00117                                                 05077000
@NM00119 EQU   DS1DSIND                                                 05078000
DS1RACF  EQU   @NM00119                                                 05079000
DS1PW    EQU   @NM00119                                                 05080000
DS1PWW   EQU   @NM00119                                                 05081000
DS1TRACK EQU   DS1SCALO                                                 05082000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05083000
@NM00122 EQU   @NM00119                                                 05084000
@NM00121 EQU   @NM00119                                                 05085000
@NM00120 EQU   @NM00119                                                 05086000
@NM00118 EQU   @NM00117                                                 05087000
DS1ABSTR EQU   @NM00112                                                 05088000
@NM00113 EQU   @NM00112                                                 05089000
@NM00111 EQU   @NM00110                                                 05090000
@NM00098 EQU   DSORG+1                                                  05091000
@NM00097 EQU   DSORG                                                    05092000
GDTECT   EQU   GDTTBL+188                                               05093000
GDTPSB   EQU   GDTTBL+184                                               05094000
GDTUPT   EQU   GDTTBL+180                                               05095000
GDTCMB   EQU   GDTTBL+176                                               05096000
GDTSPR   EQU   GDTTBL+168                                               05097000
@NM00001 EQU   GDTTBL+160                                               05098000
GDTTOH   EQU   GDTTBL+120                                               05099000
GDTRIP   EQU   GDTTBL+116                                               05100000
GDTIOH   EQU   GDTTBL+36                                                05101000
GDTSAH   EQU   GDTTBL+32                                                05102000
GDTTPH   EQU   GDTTBL+28                                                05103000
GDTRIH   EQU   GDTTBL+24                                                05104000
GDTSTH   EQU   GDTTBL+20                                                05105000
GDTDBH   EQU   GDTTBL+16                                                05106000
GDTPRM   EQU   GDTTBL+4                                                 05107000
GDTHDR   EQU   GDTTBL                                                   05108000
EXCLDLEN EQU   @NM00123+20                                              05109000
@NM00124 EQU   @NM00123                                                 05110000
@NM00114 EQU   DSEXTS                                                   05111000
DS4ENDTK EQU   DS4EXTS+6                                                05112000
DS4ENDCY EQU   DS4EXTS+4                                                05113000
DS4BEGTK EQU   DS4EXTS+2                                                05114000
DS4BEGCY EQU   DS4EXTS                                                  05115000
DS4END   EQU   IECSDSL4+96                                              05116000
@NM00109 EQU   IECSDSL4+71                                              05117000
DS4F6PTR EQU   IECSDSL4+56                                              05118000
@NM00108 EQU   IECSDSL4+51                                              05119000
DS4R2TIM EQU   IECSDSL4+43                                              05120000
DS4VSCRA EQU   DS4AMCAT+1                                               05121000
@NM00107 EQU   DS4VSIND                                                 05122000
DS4VSBAD EQU   DS4VSIND                                                 05123000
DS4VSREF EQU   DS4VSIND                                                 05124000
DS4AMTIM EQU   IECSDSL4+32                                              05125000
DS4DEVDB EQU   DS4DEVCT+13                                              05126000
DS4DEVDT EQU   DS4DEVCT+12                                              05127000
DS4DEVTL EQU   DS4DEVCT+10                                              05128000
DS4DEVFG EQU   DS4DEVCT+9                                               05129000
DS4DEVK  EQU   DS4DEVCT+8                                               05130000
DS4DEVL  EQU   DS4DEVOV+1                                               05131000
DS4DEVI  EQU   DS4DEVOV                                                 05132000
DS4DEVTK EQU   DS4DEVCT+4                                               05133000
DS4DEVSZ EQU   DS4DEVCT                                                 05134000
@NM00106 EQU   IECSDSL4+16                                              05135000
DS4NOEXT EQU   IECSDSL4+15                                              05136000
DS4VTOCI EQU   IECSDSL4+14                                              05137000
DS4NOATK EQU   IECSDSL4+12                                              05138000
DS4HCCHH EQU   IECSDSL4+8                                               05139000
DS4DSREC EQU   IECSDSL4+6                                               05140000
DS4HPCHR EQU   IECSDSL4+1                                               05141000
DS4IDFMT EQU   IECSDSL4                                                 05142000
@NM00105 EQU   IECSDSF4                                                 05143000
DS3END   EQU   IECSDSL3+140                                             05144000
DS3PTRDS EQU   IECSDSL3+135                                             05145000
@NM00104 EQU   IECSDSL3                                                 05146000
@NM00103 EQU   IECSDSF3                                                 05147000
DS1END   EQU   IECSDSL1+140                                             05148000
DS1EXT3  EQU   IECSDSL1+125                                             05149000
DS1EXT2  EQU   IECSDSL1+115                                             05150000
@NM00102 EQU   IECSDSL1+103                                             05151000
DS1RKP   EQU   IECSDSL1+91                                              05152000
DS1KEYL  EQU   IECSDSL1+90                                              05153000
DS1LRECL EQU   IECSDSL1+88                                              05154000
DS1BLKL  EQU   IECSDSL1+86                                              05155000
DS1OPTCD EQU   IECSDSL1+85                                              05156000
@NM00101 EQU   IECSDSL1+75                                              05157000
DS1SYSCD EQU   IECSDSL1+62                                              05158000
@NM00100 EQU   IECSDSL1+61                                              05159000
DS1NOBDB EQU   IECSDSL1+60                                              05160000
DS1NOEPV EQU   IECSDSL1+59                                              05161000
DS1VOLSQ EQU   IECSDSL1+51                                              05162000
DS1DSSN  EQU   IECSDSL1+45                                              05163000
@NM00099 EQU   IECSDSF1                                                 05164000
VSDFREE  EQU   VSDUSAGE+24                                              05165000
VSDALLC  EQU   VSDUSAGE+19                                              05166000
VSDDSOR3 EQU   VSDDSORG+2                                               05167000
@NM00092 EQU   VSDDSORG                                                 05168000
VSDSCAL  EQU   VSDUSAGE+12                                              05169000
@NM00091 EQU   VSDUSEF                                                  05170000
@NM00090 EQU   VSDALLOC                                                 05171000
@NM00089 EQU   VSDDORG                                                  05172000
@NM00088 EQU   VSDSCR+5                                                 05173000
@NM00087 EQU   VSDSCRFL                                                 05174000
@NM00086 EQU   VSDSTAT+29                                               05175000
VSDPRTC  EQU   VSDSTAT+25                                               05176000
VSDCAT   EQU   VSDSTAT+22                                               05177000
VSDEXP   EQU   VSDSTAT+20                                               05178000
VSDCRE   EQU   VSDSTAT+18                                               05179000
@NM00085 EQU   VSDFLG2                                                  05180000
@NM00084 EQU   VSDSFLG1                                                 05181000
VSDFRCCL EQU   VSDVTOC+21                                               05182000
@NM00083 EQU   VSDVTOC+20                                               05183000
VSDFREXT EQU   VSDVTOC+16                                               05184000
@NM00082 EQU   VSDVTOC+15                                               05185000
VSDFRTRK EQU   VSDVTOC+11                                               05186000
@NM00081 EQU   VSDVTOC+10                                               05187000
VSDFRCYL EQU   VSDVTOC+6                                                05188000
@NM00080 EQU   VSDVTOC                                                  05189000
@NM00079 EQU   VS3FLAGS                                                 05190000
@NM00078 EQU   DATESOPT                                                 05191000
DATDAYOP EQU   DATESOPT                                                 05192000
DATDTEOP EQU   DATESOPT                                                 05193000
DATSUB   EQU   DATESOPT                                                 05194000
DATADD   EQU   DATESOPT                                                 05195000
DATRETRN EQU   DATESAGL+16                                              05196000
DATDAYS  EQU   DATESAGL+12                                              05197000
DATDATE  EQU   DATESAGL+8                                               05198000
DATHEAD  EQU   DATESAGL                                                 05199000
@NM00077 EQU   SELFLAGS                                                 05200000
SELVOL   EQU   SELAGL+16                                                05201000
SELDDNP  EQU   SELAGL+12                                                05202000
SELUCBP  EQU   SELAGL+8                                                 05203000
SELHEAD  EQU   SELAGL                                                   05204000
@NM00076 EQU   UCTFLAGS                                                 05205000
UCTVSCAT EQU   UCTFLAGS                                                 05206000
UCTDD    EQU   UCTAGL+60                                                05207000
UCTVOLP  EQU   UCTAGL+56                                                05208000
UCTACBP  EQU   UCTAGL+52                                                05209000
UCTDSN   EQU   UCTAGL+8                                                 05210000
UCTHEAD  EQU   UCTAGL                                                   05211000
@NM00075 EQU   LCTFLAGS                                                 05212000
LCTHEAD  EQU   LCTINFO                                                  05213000
SRTWORKP EQU   SRTAGL+28                                                05214000
SRTFLDLN EQU   SRTAGL+24                                                05215000
SRTPOSIT EQU   SRTAGL+20                                                05216000
SRTLEN   EQU   SRTAGL+16                                                05217000
SRTNUM   EQU   SRTAGL+12                                                05218000
SRTADDR  EQU   SRTAGL+8                                                 05219000
SRTHEAD  EQU   SRTAGL                                                   05220000
SV82DEBP EQU   SV82WRKP                                                 05221000
SV82TTRP EQU   SV82LIST+8                                               05222000
SV82VOLP EQU   SV82DCBP                                                 05223000
SV82UCBP EQU   SV82LIST+1                                               05224000
SV82CODE EQU   SV82LIST                                                 05225000
VOLRESV3 EQU   VOLLABEL+55                                              05226000
VOLOWNER EQU   VOLLABEL+45                                              05227000
VOLRESV1 EQU   VOLLABEL+20                                              05228000
VOLVTOC  EQU   VOLLABEL+15                                              05229000
VOLSECTY EQU   VOLLABEL+14                                              05230000
VOLSERNO EQU   VOLLABEL+8                                               05231000
VOLNO    EQU   VOLLABEL+7                                               05232000
VOLLABI  EQU   VOLLABEL+4                                               05233000
VOLKEY   EQU   VOLLABEL                                                 05234000
STAVTTR  EQU   STAEPARM+54                                              05235000
@NM00072 EQU   STARETRY                                                 05236000
STAVTOC  EQU   STARETRY                                                 05237000
STAOFF   EQU   STARETRY                                                 05238000
STAIO05  EQU   STARETRY                                                 05239000
@NM00071 EQU   STARCVY                                                  05240000
STACLEAR EQU   STARCVY                                                  05241000
STAVPOST EQU   STARCVY                                                  05242000
STAVENQ  EQU   STARCVY                                                  05243000
STAVDMNT EQU   STARCVY                                                  05244000
STAVMNT  EQU   STARCVY                                                  05245000
STATCB   EQU   STAEPARM+48                                              05246000
STARTADD EQU   STAEPARM+44                                              05247000
STAEXSAV EQU   STAEPARM+40                                              05248000
STARTSAV EQU   STAEPARM+36                                              05249000
STARTTR  EQU   STAEPARM+32                                              05250000
@NM00070 EQU   STAEPARM+30                                              05251000
STARVOL  EQU   STAEPARM+24                                              05252000
STARUCB  EQU   STAEPARM+20                                              05253000
@NM00069 EQU   STAEPARM+18                                              05254000
STAVVOL  EQU   STAEPARM+12                                              05255000
STAVUCB  EQU   STAEPARM+8                                               05256000
STAHEAD  EQU   STAEPARM                                                 05257000
RCTDSET  EQU   RCTAGL+32                                                05258000
RCTNVOL  EQU   RCTAGL+26                                                05259000
RCTOVOL  EQU   RCTAGL+20                                                05260000
RCTNDEV  EQU   RCTAGL+16                                                05261000
RCTODEV  EQU   RCTAGL+12                                                05262000
@NM00068 EQU   RCTAGL+10                                                05263000
@NM00067 EQU   RCTOPT                                                   05264000
RCTVOL   EQU   RCTOPT                                                   05265000
RCTDEV   EQU   RCTOPT                                                   05266000
RCTHEAD  EQU   RCTAGL                                                   05267000
@NM00066 EQU   VSRESOPT                                                 05268000
VSREAL   EQU   VSRESOPT                                                 05269000
VSRES    EQU   VSRESOPT                                                 05270000
@NM00065 EQU   VSMSG                                                    05271000
VSTOV    EQU   VSMSG                                                    05272000
VSFROMV  EQU   VSMSG                                                    05273000
@NM00064 EQU   VSRETURN                                                 05274000
VSUCAT   EQU   VSRETURN                                                 05275000
VSVSAM   EQU   VSRETURN                                                 05276000
@NM00063 EQU   VSCATOPT                                                 05277000
VSLIST   EQU   VSCATOPT                                                 05278000
VSSERIAL EQU   VSCATOPT                                                 05279000
VSDEVICE EQU   VSCATOPT                                                 05280000
@NM00062 EQU   VSVTOPT                                                  05281000
VSVSFLAG EQU   VSVTOPT                                                  05282000
VSALTTRK EQU   VSVTOPT                                                  05283000
VSTIME   EQU   VSVTOPT                                                  05284000
VSUCMAST EQU   VSSECOPT                                                 05285000
VSOPCAT  EQU   VSSECOPT                                                 05286000
VSUCTEST EQU   VSSECOPT                                                 05287000
VSWRITE  EQU   VSSECOPT                                                 05288000
VSREAD   EQU   VSSECOPT                                                 05289000
VSNONONV EQU   VSSECOPT                                                 05290000
VSMASTER EQU   VSSECOPT                                                 05291000
VSNOVSAM EQU   VSSECOPT                                                 05292000
VSODEVP  EQU   VS1AGL+64                                                05293000
VSOSERP  EQU   VS1AGL+60                                                05294000
VSDEVP   EQU   VS1AGL+56                                                05295000
VSSERP   EQU   VS1AGL+52                                                05296000
VSPFILEP EQU   VS1AGL+48                                                05297000
VSPSWDP  EQU   VS1AGL+44                                                05298000
VSCATDDP EQU   VS1AGL+40                                                05299000
VSACBP   EQU   VS1AGL+36                                                05300000
VSCATP   EQU   VS1AGL+32                                                05301000
VSNXTATP EQU   VS1AGL+28                                                05302000
VSNUMATP EQU   VS1AGL+24                                                05303000
VSIOP    EQU   VS1AGL+20                                                05304000
VSFILEP  EQU   VS1AGL+16                                                05305000
VSVOLP   EQU   VS1AGL+12                                                05306000
VSUCBP   EQU   VS1AGL+8                                                 05307000
VSHEAD   EQU   VS1AGL                                                   05308000
VSVTOCPT EQU   VS2AGL+48                                                05309000
@NM00061 EQU   VS2AGL+45                                                05310000
VSDDNAME EQU   VS2AGL+37                                                05311000
@NM00060 EQU   VS2RESOP                                                 05312000
VS2REAL  EQU   VS2RESOP                                                 05313000
VS2RES   EQU   VS2RESOP                                                 05314000
@NM00059 EQU   VS2MSG                                                   05315000
VS2TOV   EQU   VS2MSG                                                   05316000
VSVOLUME EQU   VS2AGL+29                                                05317000
@NM00058 EQU   VSLABOPT                                                 05318000
VSNOVTOC EQU   VSLABOPT                                                 05319000
VSVOLSER EQU   VSLABOPT                                                 05320000
VSOWNER  EQU   VSLABOPT                                                 05321000
VSIOBKPT EQU   VS2AGL+24                                                05322000
VSVOLPTR EQU   VS2AGL+20                                                05323000
VSOWNPTR EQU   VS2AGL+16                                                05324000
VSVTOCSZ EQU   VS2AGL+12                                                05325000
VSUCBPTR EQU   VS2AGL+8                                                 05326000
VS2HEAD  EQU   VS2AGL                                                   05327000
EXPDATAL EQU   EXPARRAY+6                                               05328000
@NM00057 EQU   EXPARRAY+5                                               05329000
EXPKEYLN EQU   EXPARRAY+4                                               05330000
EXPDATAP EQU   EXPARRAY                                                 05331000
EXPRECNO EQU   EXPDATAB                                                 05332000
EXPCCHHR EQU   EXPARG+16                                                05333000
EXPCTLBK EQU   EXPARG+8                                                 05334000
EXPHEAD  EQU   EXPARG                                                   05335000
EXRWFUN  EQU   EXWRARG+46                                               05336000
@NM00056 EQU   EXSPACE+8                                                05337000
@NM00055 EQU   EXSPACE+6                                                05338000
@NM00054 EQU   EXSPACE+4                                                05339000
@NM00053 EQU   EXSPACE+1                                                05340000
@NM00052 EQU   EXSPACE                                                  05341000
EXRWKDLN EQU   EXWRARG+32                                               05342000
@NM00051 EQU   EXWRARG+31                                               05343000
EXRECNUM EQU   EXRWCHR+4                                                05344000
EXHH     EQU   EXRWCHR+2                                                05345000
EXCC     EQU   EXRWCHR                                                  05346000
EXCCWCNT EQU   EXWRARG+24                                               05347000
EXLOCPTR EQU   EXWRARG+20                                               05348000
EXRWDARE EQU   EXWRARG+16                                               05349000
EXRWIOAR EQU   EXWRARG+12                                               05350000
EXRWCTBL EQU   EXWRARG+8                                                05351000
EXRWRES  EQU   EXWRARG                                                  05352000
@NM00050 EQU   EXGARG+29                                                05353000
EXGCCHH1 EQU   EXGARG+12                                                05354000
EXGHEAD  EQU   EXGARG                                                   05355000
EXOVTH   EQU   EXFLG                                                    05356000
EXORVT   EQU   EXFLG                                                    05357000
EXORDS   EQU   EXFLG                                                    05358000
EXOSPK   EQU   EXFLG                                                    05359000
EXORVS   EQU   EXFLG                                                    05360000
@NM00049 EQU   EXFLG                                                    05361000
@NM00048 EQU   EXOPT                                                    05362000
EXOREP   EQU   EXOPT                                                    05363000
EXONEW   EQU   EXOPT                                                    05364000
EXOPASS  EQU   EXOPT                                                    05365000
EXOLAB   EQU   EXOPT                                                    05366000
EXOTAB   EQU   EXOPT                                                    05367000
EXOUCB   EQU   EXOARG+20                                                05368000
EXODSN   EQU   EXOARG+12                                                05369000
EXOHEAD  EQU   EXOARG                                                   05370000
@NM00047 EQU   EXCLFLAG                                                 05371000
EXCLMNT  EQU   EXCLFLAG                                                 05372000
EXCLVOL  EQU   EXCLAGL+16                                               05373000
EXCLDDP  EQU   EXCLAGL+12                                               05374000
EXCLUCBP EQU   EXCLAGL+8                                                05375000
EXCLHEAD EQU   EXCLAGL                                                  05376000
@NM00046 EQU   CKFLAGS                                                  05377000
CKDMTABL EQU   CKFLAGS                                                  05378000
CKRETTYP EQU   CKFLAGS                                                  05379000
CKTESTVT EQU   CKFLAGS                                                  05380000
CKLABELP EQU   CKAGL+24                                                 05381000
CKDATYPE EQU   CKAGL+20                                                 05382000
CKDDNAME EQU   CKAGL+12                                                 05383000
CKUCBPTR EQU   CKAGL+8                                                  05384000
CKHEAD   EQU   CKAGL                                                    05385000
PULABELP EQU   PUAGL+16                                                 05386000
PUTTRPTR EQU   PUAGL+12                                                 05387000
PUUCBPTR EQU   PUAGL+8                                                  05388000
PUHEAD   EQU   PUAGL                                                    05389000
MDR      EQU   MDVTOC+4                                                 05390000
MDHH     EQU   MDVTOC+2                                                 05391000
MDCC     EQU   MDVTOC                                                   05392000
@NM00045 EQU   MDAGL+31                                                 05393000
MDVTOCTR EQU   MDFLAGS                                                  05394000
MDFORCE  EQU   MDFLAGS                                                  05395000
MDDEQ    EQU   MDFLAGS                                                  05396000
MDENQ    EQU   MDFLAGS                                                  05397000
MDWAIT   EQU   MDFLAGS                                                  05398000
MDPOST   EQU   MDFLAGS                                                  05399000
MDCLEAR  EQU   MDFLAGS                                                  05400000
MDNEWVOL EQU   MDFLAGS                                                  05401000
MDLABEL  EQU   MDAGL+24                                                 05402000
MDPUAGL  EQU   MDAGL+20                                                 05403000
MDDDNAME EQU   MDAGL+12                                                 05404000
MDUCBPTR EQU   MDAGL+8                                                  05405000
MDHEAD   EQU   MDAGL                                                    05406000
CTTBLRR  EQU   CTARRAY+3                                                05407000
CTTBLHH  EQU   CTARRAY+2                                                05408000
CTTBLCC  EQU   CTARRAY+1                                                05409000
CTTBLID  EQU   CTARRAY                                                  05410000
CTREALH  EQU   CTMSG+3                                                  05411000
CTREALCC EQU   CTMSG+1                                                  05412000
@NM00044 EQU   CTMSG                                                    05413000
CMCSN2   EQU   CMMSG+28                                                 05414000
CMCSN1   EQU   CMMSG+16                                                 05415000
CMNUMCRT EQU   CMMSG+15                                                 05416000
@NM00043 EQU   CMMSG+14                                                 05417000
CMNEWVOL EQU   CMMSG+8                                                  05418000
@NM00042 EQU   CMMSG+7                                                  05419000
@NM00041 EQU   CMVOLFLG                                                 05420000
CMRONLY  EQU   CMVOLFLG                                                 05421000
CMBIND   EQU   CMVOLFLG                                                 05422000
CMSCRCRT EQU   CMVOLFLG                                                 05423000
CMEXCL   EQU   CMVOLFLG                                                 05424000
CMDERAS  EQU   CMVOLFLG                                                 05425000
CMSCRVOL EQU   CMVOLFLG                                                 05426000
CMCECART EQU   CMVOLFLG                                                 05427000
CMOLDVOL EQU   CMMSG                                                    05428000
CCOLDCSN EQU   CCMSG+24                                                 05429000
CCNEWCSN EQU   CCMSG+12                                                 05430000
@NM00040 EQU   CCMSG+10                                                 05431000
CCVOL    EQU   CCMSG+4                                                  05432000
@NM00039 EQU   CCMSG+2                                                  05433000
CCEJCODE EQU   CCMSG+1                                                  05434000
CCPSTCDE EQU   CCMSG                                                    05435000
@NM00038 EQU   DMPARY+15                                                05436000
DMPARYTP EQU   DMPARY+14                                                05437000
DMPARYEX EQU   DMPARY+12                                                05438000
DMPARYIC EQU   DMPARY+10                                                05439000
DMPARYSZ EQU   DMPARY+8                                                 05440000
DMPARYNM EQU   DMPARY                                                   05441000
@NM00037 EQU   DMPITM+15                                                05442000
DMPITMTP EQU   DMPITM+14                                                05443000
DMPITMLN EQU   DMPITM+12                                                05444000
DMPITMPT EQU   DMPITM+8                                                 05445000
DMPITMNM EQU   DMPITM                                                   05446000
@NM00036 EQU   ERCNVTAB+24                                              05447000
ERDARBPT EQU   ERCPLPT                                                  05448000
ERDYNRC  EQU   ERCATRC                                                  05449000
ERDSNM   EQU   ERCNVTAB+12                                              05450000
@NM00035 EQU   ERCNVTAB+4                                               05451000
@NM00034 EQU   ERCNVTAB+3                                               05452000
@NM00033 EQU   EROSOPER                                                 05453000
EROSUCDX EQU   EROSOPER                                                 05454000
EROSCATL EQU   EROSOPER                                                 05455000
@NM00032 EQU   EROPER                                                   05456000
ERCATAL  EQU   EROPER                                                   05457000
ERCATDL  EQU   EROPER                                                   05458000
ERCATDE  EQU   EROPER                                                   05459000
ERCATLC  EQU   EROPER                                                   05460000
@NM00031 EQU   ERTYPE                                                   05461000
ERDYNAL  EQU   ERTYPE                                                   05462000
EROSCAT  EQU   ERTYPE                                                   05463000
ERCATLG  EQU   ERTYPE                                                   05464000
@NM00030 EQU   FMTCNVF+1                                                05465000
FMTAR    EQU   FMTCNVF+1                                                05466000
FMTBS    EQU   FMTCNVF+1                                                05467000
FMTSS    EQU   FMTCNVF+1                                                05468000
FMTAL    EQU   FMTCNVF+1                                                05469000
FMTZS    EQU   FMTCNVF+1                                                05470000
@NM00029 EQU   FMTCNVF                                                  05471000
FMTPU    EQU   FMTCNVF                                                  05472000
FMTBD    EQU   FMTCNVF                                                  05473000
FMTBHD   EQU   FMTCNVF                                                  05474000
FMTBHA   EQU   FMTCNVF                                                  05475000
FMTBH    EQU   FMTCNVF                                                  05476000
FMTOLEN  EQU   FMTLIST+8                                                05477000
FMTRIO   EQU   FMTOCOL                                                  05478000
FMTSPT   EQU   FMTSTO                                                   05479000
FMTSTL   EQU   FMTILEN                                                  05480000
@NM00028 EQU   FMTFLGS+1                                                05481000
FMTSMSG  EQU   FMTFLGS+1                                                05482000
FMTHDF   EQU   FMTFLGS                                                  05483000
FMTDFF   EQU   FMTFLGS                                                  05484000
FMTSTF   EQU   FMTFLGS                                                  05485000
FMTREPF  EQU   FMTFLGS                                                  05486000
FMTBDF   EQU   FMTFLGS                                                  05487000
FMTIDF   EQU   FMTFLGS                                                  05488000
FMTSCF   EQU   FMTFLGS                                                  05489000
FMTEOLF  EQU   FMTFLGS                                                  05490000
DARGDTM  EQU   DARGARY+4                                                05491000
DARGPCT  EQU   DARGINL                                                  05492000
DARGREP  EQU   DARGINS                                                  05493000
@NM00027 EQU   DARGLIST+19                                              05494000
DARGIND  EQU   DARGLIST+18                                              05495000
DARGRETL EQU   DARGLIST+16                                              05496000
DARGCNT  EQU   DARGLIST+14                                              05497000
DARGRETP EQU   DARGLIST+4                                               05498000
UVOLVOL  EQU   UVOLENT+4                                                05499000
UVOLDEV  EQU   UVOLENT                                                  05500000
UVOLCNT  EQU   UVOLLIST                                                 05501000
@NM00026 EQU   IOINFOPT                                                 05502000
IOINFLUB EQU   IOINFOPT                                                 05503000
IOINFTMS EQU   IOINFOPT                                                 05504000
IOINFSUP EQU   IOINFOPT                                                 05505000
IOINFDSN EQU   IOINFOPT                                                 05506000
IOINFVOL EQU   IOINFOPT                                                 05507000
IOINFDVT EQU   IOINFOPT                                                 05508000
OPNVOL   EQU   OPNAGL+44                                                05509000
OPNSTRNO EQU   OPNAGL+43                                                05510000
@NM00025 EQU   OPNOPT2                                                  05511000
OPNOPTJM EQU   OPNOPT2                                                  05512000
OPNOPTNM EQU   OPNOPT2                                                  05513000
OPNOPTAS EQU   OPNOPT2                                                  05514000
@NM00024 EQU   OPNDSO                                                   05515000
OPNDSOPO EQU   OPNDSO                                                   05516000
OPNDSOIS EQU   OPNDSO                                                   05517000
OPNDSOPS EQU   OPNDSO                                                   05518000
OPNDSOAM EQU   OPNDSO                                                   05519000
OPNKYL   EQU   OPNAGL+40                                                05520000
OPNBLK   EQU   OPNAGL+36                                                05521000
OPNREC   EQU   OPNAGL+32                                                05522000
OPNDEVIX EQU   OPNDEV+4                                                 05523000
OPNDEVDT EQU   OPNDEV                                                   05524000
OPNCBP   EQU   OPNAGL+20                                                05525000
OPNDSN   EQU   OPNAGL+16                                                05526000
OPNPWA   EQU   OPNAGL+12                                                05527000
OPNDDN   EQU   OPNAGL+8                                                 05528000
OPNIOC   EQU   OPNAGL+4                                                 05529000
OPNMODRP EQU   OPNMOD                                                   05530000
OPNMODUB EQU   OPNMOD                                                   05531000
OPNMODRS EQU   OPNMOD                                                   05532000
OPNMODAX EQU   OPNMOD                                                   05533000
OPNMODRR EQU   OPNMOD                                                   05534000
OPNMODRC EQU   OPNMOD                                                   05535000
OPNMODAC EQU   OPNMOD                                                   05536000
OPNMODPD EQU   OPNMOD                                                   05537000
OPNTYPSY EQU   OPNTYP                                                   05538000
OPNTYPRV EQU   OPNTYP                                                   05539000
OPNTYPEX EQU   OPNTYP                                                   05540000
OPNTYPRA EQU   OPNTYP                                                   05541000
OPNTYPXM EQU   OPNTYP                                                   05542000
OPNTYPCI EQU   OPNTYP                                                   05543000
OPNTYPSO EQU   OPNTYP                                                   05544000
OPNTYPSI EQU   OPNTYP                                                   05545000
@NM00023 EQU   OPNRFM                                                   05546000
OPNRFMBK EQU   OPNRFM                                                   05547000
OPNRFMSF EQU   OPNRFM                                                   05548000
OPNRFMUN EQU   OPNRFM                                                   05549000
OPNRFMVR EQU   OPNRFM                                                   05550000
OPNRFMFX EQU   OPNRFM                                                   05551000
OPNOPTSK EQU   OPNOPT                                                   05552000
OPNOPTDR EQU   OPNOPT                                                   05553000
OPNOPTCR EQU   OPNOPT                                                   05554000
OPNOPTKS EQU   OPNOPT                                                   05555000
OPNOPTBK EQU   OPNOPT                                                   05556000
OPNOPTUP EQU   OPNOPT                                                   05557000
OPNOPTOT EQU   OPNOPT                                                   05558000
OPNOPTIN EQU   OPNOPT                                                   05559000
IOCEXT   EQU   IOCSTR+64                                                05560000
IOCTSML  EQU   IOCREL+2                                                 05561000
IOCTPML  EQU   IOCREL                                                   05562000
IOCWORK  EQU   IOCSTR+56                                                05563000
IOCRRN   EQU   IOCSTR+52                                                05564000
IOCPNM   EQU   IOCNWM+2                                                 05565000
IOCPTL   EQU   IOCNWM                                                   05566000
IOCKYA   EQU   IOCMEM                                                   05567000
IOCVRC   EQU   IOCTTR                                                   05568000
IOCCBP   EQU   IOCSTR+36                                                05569000
IOCDSN   EQU   IOCSTR+32                                                05570000
IOCHURBA EQU   IOCSTR+28                                                05571000
IOCVOLSR EQU   IOCSTR+22                                                05572000
@NM00022 EQU   IOCMSG                                                   05573000
IOCMSGSM EQU   IOCMSG                                                   05574000
IOCMSGAE EQU   IOCMSG                                                   05575000
IOCMSGCE EQU   IOCMSG                                                   05576000
IOCMSGOE EQU   IOCMSG                                                   05577000
IOCMSGOP EQU   IOCMSG                                                   05578000
IOCCHPKG EQU   IOCMSG                                                   05579000
IOCCHPKE EQU   IOCMSG                                                   05580000
IOCCHPNU EQU   IOCCHP                                                   05581000
IOCCHPUP EQU   IOCCHP                                                   05582000
IOCCHPBK EQU   IOCCHP                                                   05583000
IOCCHPCR EQU   IOCCHP                                                   05584000
IOCCHPKS EQU   IOCCHP                                                   05585000
IOCCHPSK EQU   IOCCHP                                                   05586000
IOCCHPDR EQU   IOCCHP                                                   05587000
IOCCHPSQ EQU   IOCCHP                                                   05588000
IOCMACNT EQU   IOCMAC2                                                  05589000
IOCMACER EQU   IOCMAC2                                                  05590000
IOCMACPA EQU   IOCMAC2                                                  05591000
IOCMACEN EQU   IOCMAC2                                                  05592000
IOCMACCP EQU   IOCMAC2                                                  05593000
IOCMACRR EQU   IOCMAC2                                                  05594000
IOCMACAS EQU   IOCMAC2                                                  05595000
IOCMACSK EQU   IOCMAC2                                                  05596000
@NM00021 EQU   IOCMAC                                                   05597000
IOCMACCC EQU   IOCMAC                                                   05598000
IOCMACDR EQU   IOCMAC                                                   05599000
IOCMACBK EQU   IOCMAC                                                   05600000
IOCMACCR EQU   IOCMAC                                                   05601000
IOCMACUP EQU   IOCMAC                                                   05602000
IOCMACOT EQU   IOCMAC                                                   05603000
IOCMACIN EQU   IOCMAC                                                   05604000
@NM00020 EQU   IOCRFM                                                   05605000
IOCRFMBK EQU   IOCRFM                                                   05606000
IOCRFMSF EQU   IOCRFM                                                   05607000
IOCRFMUN EQU   IOCRFM                                                   05608000
IOCRFMVR EQU   IOCRFM                                                   05609000
IOCRFMFX EQU   IOCRFM                                                   05610000
@NM00019 EQU   IOCDSO                                                   05611000
IOCDSOPO EQU   IOCDSO                                                   05612000
IOCDSOIS EQU   IOCDSO                                                   05613000
IOCDSOPS EQU   IOCDSO                                                   05614000
IOCDSOAM EQU   IOCDSO                                                   05615000
IOCRKP   EQU   IOCSTR+13                                                05616000
IOCKYL   EQU   IOCSTR+12                                                05617000
IOCTRN   EQU   IOCSTR+8                                                 05618000
IOCDLN   EQU   IOCSTR+4                                                 05619000
IOCDAD   EQU   IOCSTR                                                   05620000
UNITVTOC EQU   UNITABL+7                                                05621000
@NM00018 EQU   UNITSTAT                                                 05622000
UNITUSHR EQU   UNITSTAT                                                 05623000
UNITXSHR EQU   UNITSTAT                                                 05624000
UNITISHR EQU   UNITSTAT                                                 05625000
UNITUA   EQU   @NM00017+1                                               05626000
UNITCHA  EQU   @NM00017                                                 05627000
RACFVOLS EQU   RACFAGL+16                                               05628000
RACFCLN  EQU   RACFAGL+12                                               05629000
RACFPROF EQU   RACFAGL+8                                                05630000
RACFENT  EQU   RACFAGL+4                                                05631000
@NM00016 EQU   RACFFLG4                                                 05632000
@NM00015 EQU   RACFFLG3                                                 05633000
RACFPRF  EQU   RACFFLG3                                                 05634000
@NM00014 EQU   RACFFLG3                                                 05635000
@NM00013 EQU   RACFFLG2                                                 05636000
RACFTRD  EQU   RACFFLG2                                                 05637000
RACFTUPD EQU   RACFFLG2                                                 05638000
RACFTCTL EQU   RACFFLG2                                                 05639000
@NM00012 EQU   RACFFLG2                                                 05640000
RACFTALT EQU   RACFFLG2                                                 05641000
RACFCSA  EQU   RACFFLG1                                                 05642000
RACFLOGN EQU   RACFFLG1                                                 05643000
RACFLOGF EQU   RACFFLG1                                                 05644000
@NM00011 EQU   RACFFLG1                                                 05645000
RACFDSTV EQU   RACFFLG1                                                 05646000
@NM00010 EQU   RACFFLG1                                                 05647000
ALLUNCNT EQU   ALLAGL+30                                                05648000
ALLVLCNT EQU   ALLAGL+29                                                05649000
@NM00009 EQU   ALLOPT                                                   05650000
ALLOPTUN EQU   ALLOPT                                                   05651000
ALLOPTPV EQU   ALLOPT                                                   05652000
ALLOPTDS EQU   ALLOPT                                                   05653000
ALLOPTVL EQU   ALLOPT                                                   05654000
@NM00008 EQU   ALLORG+1                                                 05655000
ALLORGVS EQU   ALLORG+1                                                 05656000
@NM00007 EQU   ALLORG+1                                                 05657000
ALLORGGS EQU   ALLORG+1                                                 05658000
ALLORGUN EQU   ALLORG                                                   05659000
ALLORGPO EQU   ALLORG                                                   05660000
ALLORGMQ EQU   ALLORG                                                   05661000
ALLORGCQ EQU   ALLORG                                                   05662000
ALLORGCX EQU   ALLORG                                                   05663000
ALLORGDA EQU   ALLORG                                                   05664000
ALLORGPS EQU   ALLORG                                                   05665000
ALLORGIS EQU   ALLORG                                                   05666000
ALLDSPUN EQU   ALLDSP                                                   05667000
ALLDSPCG EQU   ALLDSP                                                   05668000
ALLDSPDE EQU   ALLDSP                                                   05669000
ALLDSPKP EQU   ALLDSP                                                   05670000
@NM00006 EQU   ALLDSP                                                   05671000
ALLSTSOD EQU   ALLSTS                                                   05672000
ALLSTSMD EQU   ALLSTS                                                   05673000
ALLSTSNW EQU   ALLSTS                                                   05674000
ALLSTSSR EQU   ALLSTS                                                   05675000
@NM00005 EQU   ALLSTS                                                   05676000
ALLPWD   EQU   ALLAGL+20                                                05677000
ALLVLP   EQU   ALLAGL+16                                                05678000
ALLULP   EQU   ALLAGL+12                                                05679000
ALLDDN   EQU   ALLAGL+4                                                 05680000
ALLDSN   EQU   ALLAGL                                                   05681000
CIRPID   EQU   CIRAGL+28                                                05682000
CIRPWD   EQU   CIRAGL+24                                                05683000
CIRCAT   EQU   CIRAGL+20                                                05684000
CIRWKP   EQU   CIRAGL+16                                                05685000
CIRTLR   EQU   CIRAGL+12                                                05686000
CIRHDR   EQU   CIRAGL+8                                                 05687000
CIRTLN   EQU   CIRAGL+6                                                 05688000
CIRHLN   EQU   CIRAGL+4                                                 05689000
@NM00004 EQU   CIRAGL+1                                                 05690000
@NM00003 EQU   CIRTYPE                                                  05691000
CIRTYPAQ EQU   CIRTYPE                                                  05692000
CIRTYP1Q EQU   CIRTYPE                                                  05693000
NEWID1   EQU   TRACE1+95                                                05694000
CALLID   EQU   OLDERID1+90                                              05695000
@NM00002 EQU   OLDERID1                                                 05696000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05697000
@RF00285 EQU   @RC00279                                                 05698000
@RC00510 EQU   @RC00494                                                 05699000
@RF00737 EQU   @RC00721                                                 05700000
@RC00789 EQU   @RC00786                                                 05701000
@RC00897 EQU   @RC00896                                                 05702000
@RC00916 EQU   @RC00915                                                 05703000
@RC00927 EQU   @RC00926                                                 05704000
@RC00948 EQU   @RC00947                                                 05705000
@PB00017 EQU   @EL00001                                                 05706000
@RF00905 EQU   @RC00897                                                 05707000
@RC00903 EQU   @RC00897                                                 05708000
@RC00949 EQU   @RC00948                                                 05709000
@PB00016 EQU   @PB00017                                                 05710000
@PB00015 EQU   @PB00016                                                 05711000
@PB00014 EQU   @PB00015                                                 05712000
@PB00013 EQU   @PB00014                                                 05713000
@PB00012 EQU   @PB00013                                                 05714000
@PB00011 EQU   @PB00012                                                 05715000
@PB00010 EQU   @PB00011                                                 05716000
@PB00009 EQU   @PB00010                                                 05717000
@PB00008 EQU   @PB00009                                                 05718000
@PB00007 EQU   @PB00008                                                 05719000
@PB00006 EQU   @PB00007                                                 05720000
@PB00005 EQU   @PB00006                                                 05721000
@PB00004 EQU   @PB00005                                                 05722000
@PB00003 EQU   @PB00004                                                 05723000
@PB00002 EQU   @PB00003                                                 05724000
@ENDDATA EQU   *                                                        05725000
         END   IDCVS03,(C'PLS2002',0701,78165)                          05726000
