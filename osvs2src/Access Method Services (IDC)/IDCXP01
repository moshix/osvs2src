         TITLE '*********** IDCXP01:  EXPORT FUNCTION SUPPORT ROUTINE **00001000
               *********'                                               00002000
        MACRO                                                           00003000
        GETMAIN &R,&LV=                                                 00004000
        L     REG15,0(REG1)           GDTTBL ADDRESS                    00005000
        L     REG15,GDTPRL(REG15)     PROL ROUTINE ADDRESS              00006000
        CNOP  2,4                     BOUNDARY ALIGNMENT                00007000
        LA    REG14,*+14              RETURN ADDRESS                    00008000
        BALR  REG1,REG15              LINKAGE TO PROL ROUTINE           00009000
        DC    A(MODID)                MODULE ID ADDRESS                 00010000
        DC    A(@SIZDATD)             AUTOMATIC STORAGE SIZE ADDRESS    00011000
        MEND                                                            00012000
IDCXP01  CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'IDCXP01   77.127'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @11,4095(,@12)                                      0002 00022000
         LA    @10,4095(,@11)                                      0002 00023000
         LA    @09,4095(,@10)                                      0002 00024000
         USING @PSTART,@12                                         0002 00025000
         USING @PSTART+4095,@11                                    0002 00026000
         USING @PSTART+8190,@10                                    0002 00027000
         USING @PSTART+12285,@09                                   0002 00028000
         L     @00,@SIZDATD                                        0002 00029000
         GETMAIN  R,LV=(0)                                              00030000
         LR    @08,@01                                             0002 00031000
         USING @DATD,@08                                           0002 00032000
         ST    @13,@SA00001+4                                      0002 00033000
         LM    @00,@01,20(@13)                                     0002 00034000
         ST    @08,8(,@13)                                         0002 00035000
         LR    @13,@08                                             0002 00036000
         MVC   @PC00001(12),0(@01)                                 0002 00037000
*        /************************************************************/ 00038000
*        /*                                                          */ 00039000
*        /*   THIS IS THE HIGHEST LEVEL OF PROCESSING FOR THE        */ 00040000
*        /*   EXPORT ROUTINE.  THIS SECTION DETERMINES WHETHER A     */ 00041000
*        /*   USER CATALOG OR A CLUSTER OR AIX IS TO BE EXPORTED,    */ 00042000
*        /*   AND CALLS THE CORRESPONDING OBJECT PROCESSOR.          */ 00043000
*        /*   TERMINATION PROCESSING IS ALSO HANDLED IN THIS SECTION.*/ 00044000
*        /*                                                          */ 00045000
*        /************************************************************/ 00046000
*                                                                  0294 00047000
*        OLDERID2 = NEWERID2;                                      0294 00048000
         L     @15,@PC00001                                        0294 00049000
         L     @14,GDTTR2(,@15)                                    0294 00050000
         MVC   @TS00001(95),NEWERID2(@14)                          0294 00051000
         MVC   OLDERID2(95,@14),@TS00001                           0294 00052000
*        NEWID2 = 'XPBG';                                          0295 00053000
         MVC   NEWID2(4,@14),@CC01134                              0295 00054000
*        IF GDTDBG = NULLPTR                                       0296 00055000
*          THEN;                                                   0296 00056000
         L     @15,GDTDBG(,@15)                                    0296 00057000
         LTR   @15,@15                                             0296 00058000
         BZ    @RT00296                                            0296 00059000
*          ELSE                                                    0298 00060000
*            CALL IDCDB010 (GDTTBL,'XP01');                        0298 00061000
         L     @15,@PC00001                                        0298 00062000
         ST    @15,@AL00001                                        0298 00063000
         LA    @14,@CC00896                                        0298 00064000
         ST    @14,@AL00001+4                                      0298 00065000
         MVI   @AL00001+4,X'80'                                    0298 00066000
         L     @15,GDTDBG(,@15)                                    0298 00067000
         LA    @01,@AL00001                                        0298 00068000
         BALR  @14,@15                                             0298 00069000
*        DDSTRU = ADDR(PRINTTAB);                                  0299 00070000
@RT00296 LA    @07,PRINTTAB                                        0299 00071000
         ST    @07,DDSTRU                                          0299 00072000
*        DARGLIST = ''B;                                           0300 00073000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0300 00074000
*        DEFSTID = NORMSTAT;                               /*@Y30SSFR*/ 00075000
         SLR   DEFSTID,DEFSTID                                     0301 00076000
*        DARGSMOD = EXPMSG;                                        0302 00077000
         MVC   DARGSMOD(3,@07),@CC00914                            0302 00078000
*        SUPPRESS = OFF;                                           0303 00079000
         NI    SUPPRESS,B'01111111'                                0303 00080000
*        RESPECIFY ALLAGL BASED(ALLPTR);                   /*@YL026UA*/ 00081000
*        DEALLOC = OFF;                                    /*@YM08500*/ 00082000
*                                                                  0305 00083000
         NI    DEALLOC,B'01111111'                                 0305 00084000
*        /************************************************************/ 00085000
*        /*                                                          */ 00086000
*        /*  INITIALIZE CATALOG ACB POINTER, POINTER TO OPEN         */ 00087000
*        /*  OUTPUT DATA SET IOCS, AND POINTER TO OPEN INPUT         */ 00088000
*        /*  DATA SET IOCS                                           */ 00089000
*        /*                                                          */ 00090000
*        /************************************************************/ 00091000
*                                                                  0306 00092000
*        PTRCTACB = NULLPTR;                                       0306 00093000
         SLR   @07,@07                                             0306 00094000
         ST    @07,PTRCTACB                                        0306 00095000
*        PINIOCS = NULLPTR;                                        0307 00096000
         ST    @07,PINIOCS                                         0307 00097000
*        POUTIOCS = NULLPTR;                                       0308 00098000
*                                                                  0308 00099000
         ST    @07,POUTIOCS                                        0308 00100000
*        /************************************************************/ 00101000
*        /*                                                          */ 00102000
*        /* DETERMINE WHETHER A USERCATALOG OR A CLUSTER OR AN AIX   */ 00103000
*        /* IS TO BE EXPORTED                                @Y30SSFR*/ 00104000
*        /*                                                          */ 00105000
*        /************************************************************/ 00106000
*                                                                  0309 00107000
*        IF ADDR(DISCT) ^= NULLPTR                                 0309 00108000
*          THEN                                                    0309 00109000
         L     @15,@PC00001+4                                      0309 00110000
         C     @07,FDTPTR+52(,@15)                                 0309 00111000
         BE    @RF00309                                            0309 00112000
*            DO;                                                   0310 00113000
*                                                                  0310 00114000
*            /********************************************************/ 00115000
*            /*                                                      */ 00116000
*            /*  PROCESS DISCONNECT OF USER CATALOG                  */ 00117000
*            /*                                                      */ 00118000
*            /********************************************************/ 00119000
*                                                                  0311 00120000
*            CALL DSCTPROC;                                        0311 00121000
         BAL   @14,DSCTPROC                                        0311 00122000
*            RESPECIFY RTNREG RSTD;                                0312 00123000
*            TESTRC = RTNREG;                                      0313 00124000
         LR    TESTRC,RTNREG                                       0313 00125000
*            RESPECIFY RTNREG UNRSTD;                              0314 00126000
*            SETRC = TESTRC;                                       0315 00127000
         STH   TESTRC,SETRC                                        0315 00128000
*            END;                                                  0316 00129000
*                                                                  0316 00130000
*          ELSE                                                    0317 00131000
*            DO;                                                   0317 00132000
*                                                                  0317 00133000
         B     @RC00309                                            0317 00134000
@RF00309 DS    0H                                                  0318 00135000
*            /********************************************************/ 00136000
*            /*                                                      */ 00137000
*            /*  PROCESS EXPORTATION OF A CLUSTER OR AN AIX  @Y30SSFR*/ 00138000
*            /*                                                      */ 00139000
*            /********************************************************/ 00140000
*                                                                  0318 00141000
*            CALL CLUSPROC;                                        0318 00142000
         BAL   @14,CLUSPROC                                        0318 00143000
*            RESPECIFY RTNREG RSTD;                                0319 00144000
*            TESTRC = RTNREG;                                      0320 00145000
         LR    TESTRC,RTNREG                                       0320 00146000
*            RESPECIFY RTNREG UNRSTD;                              0321 00147000
*            SETRC = TESTRC;                                       0322 00148000
*                                                                  0322 00149000
         STH   TESTRC,SETRC                                        0322 00150000
*            /********************************************************/ 00151000
*            /*                                              @Y30SSFR*/ 00152000
*            /*  IF SOMETHING THAT WAS ALLOCATED BY EXPORT   @Y30SSFR*/ 00153000
*            /*  IS STILL ALLOCATED, DYNAMICALLY UNALLOCATE  @Y30SSFR*/ 00154000
*            /*  IT.                                         @Y30SSFR*/ 00155000
*            /*                                              @Y30SSFR*/ 00156000
*            /********************************************************/ 00157000
*                                                                  0323 00158000
*            IF DEALLOC = ON                               /*#YM08500*/ 00159000
*              THEN                                                0323 00160000
         TM    DEALLOC,B'10000000'                                 0323 00161000
         BNO   @RF00323                                            0323 00162000
*                CALL IDCSADL0(GDTTBL,ALLAGL);             /*#YL026UA*/ 00163000
         L     @07,@PC00001                                        0324 00164000
         ST    @07,@AL00001                                        0324 00165000
         L     @01,ALLPTR                                          0324 00166000
         ST    @01,@AL00001+4                                      0324 00167000
         MVI   @AL00001+4,X'80'                                    0324 00168000
         L     @15,GDTDLC(,@07)                                    0324 00169000
         LA    @01,@AL00001                                        0324 00170000
         BALR  @14,@15                                             0324 00171000
*            END;                                                  0325 00172000
*                                                                  0325 00173000
@RF00323 DS    0H                                                  0326 00174000
*        /************************************************************/ 00175000
*        /*                                                          */ 00176000
*        /*   TERMINATION PROCESSING WILL LIST APPROPRIATE ERROR     */ 00177000
*        /*   MESSAGES, AND INDICATE THE FINAL STATUS OF EXPORT      */ 00178000
*        /*   IN LASTCC.                                             */ 00179000
*        /*                                                          */ 00180000
*        /************************************************************/ 00181000
*                                                                  0326 00182000
*        IF GDTDBG = NULLPTR                                       0326 00183000
*          THEN;                                                   0326 00184000
@RC00309 L     @07,@PC00001                                        0326 00185000
         L     @07,GDTDBG(,@07)                                    0326 00186000
         LTR   @07,@07                                             0326 00187000
         BZ    @RT00326                                            0326 00188000
*          ELSE                                                    0328 00189000
*            CALL IDCDB010 (GDTTBL,'XPFN');                        0328 00190000
*                                                                  0328 00191000
         L     @07,@PC00001                                        0328 00192000
         ST    @07,@AL00001                                        0328 00193000
         LA    @15,@CC01139                                        0328 00194000
         ST    @15,@AL00001+4                                      0328 00195000
         MVI   @AL00001+4,X'80'                                    0328 00196000
         L     @15,GDTDBG(,@07)                                    0328 00197000
         LA    @01,@AL00001                                        0328 00198000
         BALR  @14,@15                                             0328 00199000
*        /************************************************************/ 00200000
*        /*                                                          */ 00201000
*        /*  TEST FOR ANY SPECIAL MESSAGES TO BE LISTED - ERROR OR   */ 00202000
*        /*  INFORMATIONAL                                           */ 00203000
*        /*                                                          */ 00204000
*        /************************************************************/ 00205000
*                                                                  0329 00206000
*        IF DEFSTID ^= NORMSTAT                                    0329 00207000
*          THEN                                                    0329 00208000
@RT00326 C     DEFSTID,@CF00116                                    0329 00209000
         BE    @RF00329                                            0329 00210000
*            DO;                                                   0330 00211000
*            DARGSENT = DEFSTID;                                   0331 00212000
*                                                                  0331 00213000
         L     @07,DDSTRU                                          0331 00214000
         STC   DEFSTID,DARGSENT(,@07)                              0331 00215000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0332 00216000
*                                                                  0332 00217000
         L     @15,@PC00001                                        0332 00218000
         ST    @15,@AL00001                                        0332 00219000
         LA    @14,@CF00116                                        0332 00220000
         ST    @14,@AL00001+4                                      0332 00221000
         LA    @14,DDSTRU                                          0332 00222000
         ST    @14,@AL00001+8                                      0332 00223000
         MVI   @AL00001+8,X'80'                                    0332 00224000
         L     @15,GDTPRT(,@15)                                    0332 00225000
         LA    @01,@AL00001                                        0332 00226000
         BALR  @14,@15                                             0332 00227000
*            END;                                                  0333 00228000
*                                                                  0333 00229000
*        IF SUPPRESS = ON & SETRC < LASTCC04                       0334 00230000
*          THEN                                                    0334 00231000
@RF00329 TM    SUPPRESS,B'10000000'                                0334 00232000
         BNO   @RF00334                                            0334 00233000
         LA    @15,4                                               0334 00234000
         CH    @15,SETRC                                           0334 00235000
         BNH   @RF00334                                            0334 00236000
*            SETRC = LASTCC04;                                     0335 00237000
*                                                                  0335 00238000
         STH   @15,SETRC                                           0335 00239000
*        /************************************************************/ 00240000
*        /*                                                          */ 00241000
*        /*  ISSUE FINAL COMPLETION MESSAGE INDICATING WHETHER       */ 00242000
*        /*  EXPORT WAS SUCCESSFUL OR NOT                            */ 00243000
*        /*  SET LASTCC TO INDICATE SUCCESS OR FAILURE TO THE        */ 00244000
*        /*  AMS EXECUTIVE                                           */ 00245000
*        /*                                                          */ 00246000
*        /************************************************************/ 00247000
*                                                                  0336 00248000
*        IF (SETRC > LASTCC00) & (GDTECT ^= NULLPTR)       /*@Y30SSFR*/ 00249000
*          THEN                                            /*@Y30SSFR*/ 00250000
@RF00334 SLR   @15,@15                                             0336 00251000
         CH    @15,SETRC                                           0336 00252000
         BNL   @RF00336                                            0336 00253000
         L     @14,@PC00001                                        0336 00254000
         C     @15,GDTECT(,@14)                                    0336 00255000
         BE    @RF00336                                            0336 00256000
*            DARGSENT = TSOFAIL;                           /*@Y30SSFR*/ 00257000
         L     @01,DDSTRU                                          0337 00258000
         MVI   DARGSENT(@01),X'0F'                                 0337 00259000
*          ELSE                                            /*@Y30SSFR*/ 00260000
*            IF SETRC < LASTCC08                           /*@Y30SSFR*/ 00261000
*              THEN                                        /*@Y30SSFR*/ 00262000
         B     @RC00336                                            0338 00263000
@RF00336 LH    @15,SETRC                                           0338 00264000
         C     @15,@CF00180                                        0338 00265000
         BNL   @RF00338                                            0338 00266000
*                DARGSENT = EXPTGOOD;                      /*@Y30SSFR*/ 00267000
         L     @01,DDSTRU                                          0339 00268000
         MVI   DARGSENT(@01),X'01'                                 0339 00269000
*              ELSE                                        /*@Y30SSFR*/ 00270000
*                DARGSENT = EXPTFAIL;                      /*@Y30SSFR*/ 00271000
         B     @RC00338                                            0340 00272000
@RF00338 L     @01,DDSTRU                                          0340 00273000
         MVI   DARGSENT(@01),X'03'                                 0340 00274000
*        LASTCC = SETRC;                                   /*@Y30SSFR*/ 00275000
@RC00338 DS    0H                                                  0341 00276000
@RC00336 L     @15,@PC00001+8                                      0341 00277000
         LH    @14,SETRC                                           0341 00278000
         STH   @14,LASTCC(,@15)                                    0341 00279000
*        DARGSMOD = UNIVMSG;                                       0342 00280000
         L     @14,DDSTRU                                          0342 00281000
         MVC   DARGSMOD(3,@14),@CC00930                            0342 00282000
*        DARGDBP = ADDR(LASTCC);                                   0343 00283000
         ST    @15,DARGDBP(,@14)                                   0343 00284000
*        DARGILP = LENGTH(LASTCC);                                 0344 00285000
*                                                                  0344 00286000
         MVC   DARGILP(2,@14),@CH00154                             0344 00287000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0345 00288000
*                                                                  0345 00289000
         L     @15,@PC00001                                        0345 00290000
         ST    @15,@AL00001                                        0345 00291000
         LA    @14,@CF00116                                        0345 00292000
         ST    @14,@AL00001+4                                      0345 00293000
         LA    @14,DDSTRU                                          0345 00294000
         ST    @14,@AL00001+8                                      0345 00295000
         MVI   @AL00001+8,X'80'                                    0345 00296000
         L     @15,GDTPRT(,@15)                                    0345 00297000
         LA    @01,@AL00001                                        0345 00298000
         BALR  @14,@15                                             0345 00299000
*        /************************************************************/ 00300000
*        /*                                                          */ 00301000
*        /*  CLOSE ANY OPEN DATA SETS                                */ 00302000
*        /*                                                          */ 00303000
*        /************************************************************/ 00304000
*                                                                  0346 00305000
*        IF POUTIOCS ^= NULLPTR                                    0346 00306000
*          THEN                                                    0346 00307000
*                                                                  0346 00308000
         L     @15,POUTIOCS                                        0346 00309000
         LTR   @15,@15                                             0346 00310000
         BZ    @RF00346                                            0346 00311000
*            CALL IDCIOCL0 (GDTTBL,POUTIOCS);                      0347 00312000
*                                                                  0347 00313000
         L     @15,@PC00001                                        0347 00314000
         ST    @15,@AL00001                                        0347 00315000
         LA    @14,POUTIOCS                                        0347 00316000
         ST    @14,@AL00001+4                                      0347 00317000
         MVI   @AL00001+4,X'80'                                    0347 00318000
         L     @15,GDTCLS(,@15)                                    0347 00319000
         LA    @01,@AL00001                                        0347 00320000
         BALR  @14,@15                                             0347 00321000
*        IF PINIOCS ^= NULLPTR                                     0348 00322000
*          THEN                                                    0348 00323000
*                                                                  0348 00324000
@RF00346 L     @15,PINIOCS                                         0348 00325000
         LTR   @15,@15                                             0348 00326000
         BZ    @RF00348                                            0348 00327000
*            CALL IDCIOCL0 (GDTTBL,PINIOCS);                       0349 00328000
*                                                                  0349 00329000
*                                                                  0349 00330000
         L     @15,@PC00001                                        0349 00331000
         ST    @15,@AL00001                                        0349 00332000
         LA    @14,PINIOCS                                         0349 00333000
         ST    @14,@AL00001+4                                      0349 00334000
         MVI   @AL00001+4,X'80'                                    0349 00335000
         L     @15,GDTCLS(,@15)                                    0349 00336000
         LA    @01,@AL00001                                        0349 00337000
         BALR  @14,@15                                             0349 00338000
*        OLDERID2 = NEWERID2;                                      0350 00339000
@RF00348 L     @15,@PC00001                                        0350 00340000
         L     @14,GDTTR2(,@15)                                    0350 00341000
         MVC   @TS00001(95),NEWERID2(@14)                          0350 00342000
         MVC   OLDERID2(95,@14),@TS00001                           0350 00343000
*        NEWID2 = 'XPED';                                          0351 00344000
         MVC   NEWID2(4,@14),@CC01140                              0351 00345000
*        CALL IDCSAFP0 (GDTTBL,GPID);                              0352 00346000
*                                                                  0352 00347000
         ST    @15,@AL00001                                        0352 00348000
         LA    @14,GPID                                            0352 00349000
         ST    @14,@AL00001+4                                      0352 00350000
         MVI   @AL00001+4,X'80'                                    0352 00351000
         L     @15,GDTFPL(,@15)                                    0352 00352000
         LA    @01,@AL00001                                        0352 00353000
         BALR  @14,@15                                             0352 00354000
*        CALL IDCSAEP0(GDTTBL,MODID,LASTCC);                       0353 00355000
         L     @15,@PC00001                                        0353 00356000
         ST    @15,@AL00001                                        0353 00357000
         LA    @14,MODID                                           0353 00358000
         ST    @14,@AL00001+4                                      0353 00359000
         L     @14,@PC00001+8                                      0353 00360000
         ST    @14,@AL00001+8                                      0353 00361000
         MVI   @AL00001+8,X'80'                                    0353 00362000
         L     @15,GDTEPL(,@15)                                    0353 00363000
         LA    @01,@AL00001                                        0353 00364000
         BALR  @14,@15                                             0353 00365000
*        /************************************************************/ 00366000
*        /*                                                          */ 00367000
*        /*  PROCEDURE NAME - CLUSPROC                               */ 00368000
*        /*                                                          */ 00369000
*        /*  FUNCTION - OBTAINS CATALOG INFORMATION ABOUT    @Y30SSFR*/ 00370000
*        /*  THE OBJECT BEING EXPORTED AND ANY PATHS DEFINED @Y30SSFR*/ 00371000
*        /*  OVER IT.  BUILDS CONTROL AND DATA RECORDS, AND  @Y30SSFR*/ 00372000
*        /*  WRITES OUT THE HEADER RECORDS OF THE            @Y30SSFR*/ 00373000
*        /*  PORTABILITY DATA SET.  CALLS LOWER LEVEL        @Y30SSFR*/ 00374000
*        /*  PROCEDURES TO WRITE THE RECORDS OF THE DATA     @Y30SSFR*/ 00375000
*        /*  SET BEING EXPORTED TO THE PORTABILITY DATA      @Y30SSFR*/ 00376000
*        /*  SET.                                            @Y30SSFR*/ 00377000
*        /*                                                          */ 00378000
*        /* INPUT - FDT                                              */ 00379000
*        /*                                                          */ 00380000
*        /*  OUTPUT - PORTABILITY DATA SET THAT CAN BE EMPLOYED BY   */ 00381000
*        /*  THE IMPORT FSR TO RECONSTRUCT THE VSAM OBJECT ON THE    */ 00382000
*        /*  SAME SYSTEM OR ON A DIFFERENT SYSTEM.                   */ 00383000
*        /*                                                          */ 00384000
*        /************************************************************/ 00385000
*                                                                  0354 00386000
*CLUSPROC: PROCEDURE;                                              0354 00387000
*                                                                  0354 00388000
@EL00001 L     @13,4(,@13)                                         0354 00389000
@EF00001 L     @00,@SIZDATD                                        0354 00390000
         LR    @01,@08                                             0354 00391000
         FREEMAIN R,LV=(0),A=(1)                                        00392000
@ER00001 LM    @14,@12,12(@13)                                     0354 00393000
         BR    @14                                                 0354 00394000
CLUSPROC STM   @14,@05,@SA00002                                    0354 00395000
         STM   @07,@12,@SA00002+32                                 0354 00396000
*        /************************************************************/ 00397000
*        /*                                                  @Y30SSFR*/ 00398000
*        /*  SET AN INITIAL VALUE FOR THE BLOCKSIZE OF THE   @Y30SSFR*/ 00399000
*        /*  PORTABLE DATA SET.                              @Y30SSFR*/ 00400000
*        /*                                                  @Y30SSFR*/ 00401000
*        /************************************************************/ 00402000
*                                                                  0355 00403000
*        BLKSIZ = 2048;                                    /*@Y30SSFR*/ 00404000
*                                                                  0355 00405000
         MVC   BLKSIZ(4),@CF01144                                  0355 00406000
*        /************************************************************/ 00407000
*        /*                                                          */ 00408000
*        /*  TEST FOR OUT PARAMETERS SPECIFIED IN AMS COMMAND        */ 00409000
*        /*  IF OUTDS OR OUT NOT SPECIFIED, RETURN WITH ERROR        */ 00410000
*        /*                                                          */ 00411000
*        /************************************************************/ 00412000
*                                                                  0356 00413000
*        IF ADDR(OUT) = NULLPTR & ADDR(OUTDS) = NULLPTR            0356 00414000
*          THEN                                                    0356 00415000
         SLR   @07,@07                                             0356 00416000
         L     @15,@PC00001+4                                      0356 00417000
         C     @07,FDTPTR+8(,@15)                                  0356 00418000
         BNE   @RF00356                                            0356 00419000
         C     @07,FDTPTR+68(,@15)                                 0356 00420000
         BNE   @RF00356                                            0356 00421000
*            DO;                                                   0357 00422000
*            DARGSENT = NOOUPARM;                          /*@ZA01380*/ 00423000
         L     @07,DDSTRU                                          0358 00424000
         MVI   DARGSENT(@07),X'02'                                 0358 00425000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0359 00426000
         L     @07,@PC00001                                        0359 00427000
         ST    @07,@AL00001                                        0359 00428000
         LA    @15,@CF00116                                        0359 00429000
         ST    @15,@AL00001+4                                      0359 00430000
         LA    @15,DDSTRU                                          0359 00431000
         ST    @15,@AL00001+8                                      0359 00432000
         MVI   @AL00001+8,X'80'                                    0359 00433000
         L     @15,GDTPRT(,@07)                                    0359 00434000
         LA    @01,@AL00001                                        0359 00435000
         BALR  @14,@15                                             0359 00436000
*            RETURN CODE(LASTCC12);                        /*@YL026UA*/ 00437000
         LA    @15,12                                              0360 00438000
         L     @14,@SA00002                                        0360 00439000
         LM    @00,@05,@SA00002+8                                  0360 00440000
         LM    @07,@12,@SA00002+32                                 0360 00441000
         BR    @14                                                 0360 00442000
*            END;                                                  0361 00443000
*                                                                  0361 00444000
*        /************************************************************/ 00445000
*        /*                                                  @YL026UA*/ 00446000
*        /*  IF THE ENTRIES ARE NOT FULLY QUALIFIED - ISSUE  @YL026UA*/ 00447000
*        /*  THE UQUAL MACRO TO OBTAIN THE TRAILING QUALIFIERS       */ 00448000
*        /*                                                  @YL026UA*/ 00449000
*        /************************************************************/ 00450000
*                                                                  0362 00451000
*          IF ENTFUQ = ON                                          0362 00452000
*            THEN                                                  0362 00453000
*                                                                  0362 00454000
@RF00356 L     @07,@PC00001+4                                      0362 00455000
         L     @07,FDTPTR(,@07)                                    0362 00456000
         TM    ENTFUQ(@07),B'10000000'                             0362 00457000
         BNO   @RF00362                                            0362 00458000
*              DO;                                         /*@YL026UA*/ 00459000
*                QUALLIST = ''B;                           /*@YL026UA*/ 00460000
         XC    QUALLIST(12),QUALLIST                               0364 00461000
*                QUALADDR = ADDR(ENTVAL);                   /*@YL026UA* 00462000
         LA    @15,ENTVAL(,@07)                                    0365 00463000
         ST    @15,QUALADDR                                        0365 00464000
*                IF ENTPLN ^= 0                                    0366 00465000
*                  THEN                                            0366 00466000
         CLI   ENTPLN(@07),0                                       0366 00467000
         BE    @RF00366                                            0366 00468000
*                    QUALPAS = ADDR(ENTPAS);               /*@YL026UA*/ 00469000
         LA    @07,ENTPAS(,@07)                                    0367 00470000
         ST    @07,QUALPAS                                         0367 00471000
*                QUALLEN = ENTLEN;                         /*@Y30SSFR*/ 00472000
*                                                                  0368 00473000
@RF00366 L     @07,@PC00001+4                                      0368 00474000
         L     @07,FDTPTR(,@07)                                    0368 00475000
         SLR   @03,@03                                             0368 00476000
         IC    @03,ENTLEN(,@07)                                    0368 00477000
         STH   @03,QUALLEN                                         0368 00478000
*                CALL IDCSAQL0(GDTTBL,QUALADDR,QUALLEN,    /*@Y30SSFR*/ 00479000
*                  QUALCAT,QUALPAS);                       /*@Y30SSFR*/ 00480000
         L     @07,@PC00001                                        0369 00481000
         ST    @07,@AL00001                                        0369 00482000
         LA    @03,QUALADDR                                        0369 00483000
         ST    @03,@AL00001+4                                      0369 00484000
         LA    @03,QUALLEN                                         0369 00485000
         ST    @03,@AL00001+8                                      0369 00486000
         LA    @03,QUALCAT                                         0369 00487000
         ST    @03,@AL00001+12                                     0369 00488000
         LA    @03,QUALPAS                                         0369 00489000
         ST    @03,@AL00001+16                                     0369 00490000
         MVI   @AL00001+16,X'80'                                   0369 00491000
         L     @15,GDTQAL(,@07)                                    0369 00492000
         LA    @01,@AL00001                                        0369 00493000
         BALR  @14,@15                                             0369 00494000
*                RESPECIFY RTNREG RSTD;                            0370 00495000
*                TESTRC = RTNREG;                                  0371 00496000
         LR    TESTRC,RTNREG                                       0371 00497000
*                RESPECIFY RTNREG UNRSTD;                  /*#YL026UA*/ 00498000
*                IF TESTRC ^= 0                                    0373 00499000
*                  THEN                                            0373 00500000
         LTR   TESTRC,TESTRC                                       0373 00501000
         BZ    @RF00373                                            0373 00502000
*                    RETURN CODE(LASTCC12);                /*#YL026UA*/ 00503000
         LA    @15,12                                              0374 00504000
         L     @14,@SA00002                                        0374 00505000
         LM    @00,@05,@SA00002+8                                  0374 00506000
         LM    @07,@12,@SA00002+32                                 0374 00507000
         BR    @14                                                 0374 00508000
*              END;                                        /*#YL026UA*/ 00509000
*                                                                  0375 00510000
@RF00373 DS    0H                                                  0376 00511000
*          IF OUTDSFUQ = ON & ADDR(OUTDS) ^= NULLPTR               0376 00512000
*            THEN                                                  0376 00513000
@RF00362 L     @07,@PC00001+4                                      0376 00514000
         L     @07,FDTPTR+68(,@07)                                 0376 00515000
         TM    OUTDSFUQ(@07),B'10000000'                           0376 00516000
         BNO   @RF00376                                            0376 00517000
         LTR   @07,@07                                             0376 00518000
         BZ    @RF00376                                            0376 00519000
*              DO;                                         /*#YL026UA*/ 00520000
*                QUALLIST = ''B;                           /*#YL026UA*/ 00521000
         XC    QUALLIST(12),QUALLIST                               0378 00522000
*                QUALADDR = ADDR(OUTDSVAL);                /*@Y30SSFR*/ 00523000
         LA    @15,OUTDSVAL(,@07)                                  0379 00524000
         ST    @15,QUALADDR                                        0379 00525000
*                IF OUTDSPLN ^= NULLPTR                            0380 00526000
*                  THEN                                            0380 00527000
         CLI   OUTDSPLN(@07),0                                     0380 00528000
         BE    @RF00380                                            0380 00529000
*                    QUALPAS = ADDR(OUTDSPAS);             /*#YL026UA*/ 00530000
         LA    @07,OUTDSPAS(,@07)                                  0381 00531000
         ST    @07,QUALPAS                                         0381 00532000
*                QUALLEN = OUTDSLEN;                       /*@OZ17980*/ 00533000
*                                                                  0382 00534000
@RF00380 L     @07,@PC00001+4                                      0382 00535000
         L     @07,FDTPTR+68(,@07)                                 0382 00536000
         SLR   @03,@03                                             0382 00537000
         IC    @03,OUTDSLEN(,@07)                                  0382 00538000
         STH   @03,QUALLEN                                         0382 00539000
*                CALL IDCSAQL0(GDTTBL,QUALADDR,QUALLEN,QUALCAT,QUALPAS) 00540000
         L     @07,@PC00001                                        0383 00541000
         ST    @07,@AL00001                                        0383 00542000
         LA    @03,QUALADDR                                        0383 00543000
         ST    @03,@AL00001+4                                      0383 00544000
         LA    @03,QUALLEN                                         0383 00545000
         ST    @03,@AL00001+8                                      0383 00546000
         LA    @03,QUALCAT                                         0383 00547000
         ST    @03,@AL00001+12                                     0383 00548000
         LA    @03,QUALPAS                                         0383 00549000
         ST    @03,@AL00001+16                                     0383 00550000
         MVI   @AL00001+16,X'80'                                   0383 00551000
         L     @15,GDTQAL(,@07)                                    0383 00552000
         LA    @01,@AL00001                                        0383 00553000
         BALR  @14,@15                                             0383 00554000
*                                                          /*#YL026UA*/ 00555000
*                RESPECIFY RTNREG RSTD;                            0384 00556000
*                TESTRC = RTNREG;                                  0385 00557000
         LR    TESTRC,RTNREG                                       0385 00558000
*                RESPECIFY RTNREG UNRSTD;                  /*#YL026UA*/ 00559000
*                IF TESTRC ^= 0                                    0387 00560000
*                  THEN                                            0387 00561000
         LTR   TESTRC,TESTRC                                       0387 00562000
         BZ    @RF00387                                            0387 00563000
*                    RETURN CODE(LASTCC12);                /*#YL026UA*/ 00564000
         LA    @15,12                                              0388 00565000
         L     @14,@SA00002                                        0388 00566000
         LM    @00,@05,@SA00002+8                                  0388 00567000
         LM    @07,@12,@SA00002+32                                 0388 00568000
         BR    @14                                                 0388 00569000
*              END;                                        /*#YL026UA*/ 00570000
*                                                                  0389 00571000
@RF00387 DS    0H                                                  0390 00572000
*        /************************************************************/ 00573000
*        /*                                                  #YL026UA*/ 00574000
*        /*  ALLOCATE THE CLUSTER IF IT WAS NOT ALLOCATED BY JCL     */ 00575000
*        /*                                                  #YL026UA*/ 00576000
*        /************************************************************/ 00577000
*                                                                  0390 00578000
*        IF ADDR(INDD) = NULLPTR                                   0390 00579000
*          THEN                                            /*@YL026UA*/ 00580000
@RF00376 L     @07,@PC00001+4                                      0390 00581000
         L     @15,FDTPTR+4(,@07)                                  0390 00582000
         LTR   @15,@15                                             0390 00583000
         BNZ   @RF00390                                            0390 00584000
*            DO;                                           /*@YL026UA*/ 00585000
*              ALLPTR = ADDR(ALLLIST);                     /*@YL026UA*/ 00586000
         LA    @15,ALLLIST                                         0392 00587000
         ST    @15,ALLPTR                                          0392 00588000
*              ALLAGL = ''B;                               /*@YL026UA*/ 00589000
         XC    ALLAGL(31,@15),ALLAGL(@15)                          0393 00590000
*              ALLDSN = ADDR(ENTVAL);                      /*@Y30SSFR*/ 00591000
         L     @07,FDTPTR(,@07)                                    0394 00592000
         LA    @14,ENTVAL(,@07)                                    0394 00593000
         ST    @14,ALLDSN(,@15)                                    0394 00594000
*              IF ENTPLN ^= 0                                      0395 00595000
*                THEN                                              0395 00596000
         CLI   ENTPLN(@07),0                                       0395 00597000
         BE    @RF00395                                            0395 00598000
*                  ALLPWD = ADDR(ENTPAS);                  /*@YL026UA*/ 00599000
         LA    @07,ENTPAS(,@07)                                    0396 00600000
         ST    @07,ALLPWD(,@15)                                    0396 00601000
*              ALLOPTVL = OFF;                             /*@YL026UA*/ 00602000
@RF00395 DS    0H                                                  0398 00603000
*              ALLOPTDS = ON;                              /*@YL026UA*/ 00604000
         L     @07,ALLPTR                                          0398 00605000
         OI    ALLOPTDS(@07),B'01000000'                           0398 00606000
         NI    ALLOPTVL(@07),B'01111111'                           0398 00607000
*              ALLSTSOD = ON;                              /*@YL026UA*/ 00608000
         OI    ALLSTSOD(@07),B'00000001'                           0399 00609000
*              ALLDSPKP = ON;                              /*#YL026UA*/ 00610000
         OI    ALLDSPKP(@07),B'00001000'                           0400 00611000
*              CALL IDCSAAL0(GDTTBL,ALLAGL);               /*#YL026UA*/ 00612000
         L     @03,@PC00001                                        0401 00613000
         ST    @03,@AL00001                                        0401 00614000
         ST    @07,@AL00001+4                                      0401 00615000
         MVI   @AL00001+4,X'80'                                    0401 00616000
         L     @15,GDTALC(,@03)                                    0401 00617000
         LA    @01,@AL00001                                        0401 00618000
         BALR  @14,@15                                             0401 00619000
*              RESPECIFY RTNREG RSTD;                              0402 00620000
*              TESTRC = RTNREG;                                    0403 00621000
         LR    TESTRC,RTNREG                                       0403 00622000
*              RESPECIFY RTNREG UNRSTD;                    /*#YL026UA*/ 00623000
*              IF TESTRC ^= 0                                      0405 00624000
*                THEN                                              0405 00625000
         LTR   TESTRC,TESTRC                                       0405 00626000
         BZ    @RF00405                                            0405 00627000
*                  RETURN CODE(LASTCC12);                  /*#YL026UA*/ 00628000
         LA    @15,12                                              0406 00629000
         L     @14,@SA00002                                        0406 00630000
         LM    @00,@05,@SA00002+8                                  0406 00631000
         LM    @07,@12,@SA00002+32                                 0406 00632000
         BR    @14                                                 0406 00633000
*              DEALLOC = ON;                               /*#YM08500*/ 00634000
@RF00405 OI    DEALLOC,B'10000000'                                 0407 00635000
*            END;                                          /*#YL026UA*/ 00636000
*                                                                  0408 00637000
*        /************************************************************/ 00638000
*        /*                                                  #YL026UA*/ 00639000
*        /*  INITIALIZE POINTERS TO CPL'S YET TO BE CONSTRUCTED      */ 00640000
*        /*                                                  #YL026UA*/ 00641000
*        /************************************************************/ 00642000
*                                                                  0409 00643000
*        DO I= 1 TO 5;                                     /*@Y30SSFR*/ 00644000
@RF00390 LA    I,1                                                 0409 00645000
@DL00409 DS    0H                                                  0410 00646000
*          PTRCPL(I) = NULLPTR;                                    0410 00647000
         LR    @07,I                                               0410 00648000
         SLA   @07,2                                               0410 00649000
         SLR   @05,@05                                             0410 00650000
         ST    @05,PTRCPL-4(@07)                                   0410 00651000
*        END;                                                      0411 00652000
*                                                                  0411 00653000
         AL    I,@CF00220                                          0411 00654000
         C     I,@CF00287                                          0411 00655000
         BNH   @DL00409                                            0411 00656000
*        RECSZ = 0;                    /*LRECL FOR PORTABLE DATA SET */ 00657000
         SLR   @07,@07                                             0412 00658000
         ST    @07,RECSZ                                           0412 00659000
*        SUPPRESS = OFF;               /*INITIALIZE PASSWORD SUPPRESS*/ 00660000
         NI    SUPPRESS,B'01111111'                                0413 00661000
*        AIXFLAG = OFF;                /*INITIALIZE AIXFLAG  @Y30SSFR*/ 00662000
         NI    AIXFLAG,B'01111111'                                 0414 00663000
*                                      /*FLAG                        */ 00664000
*                                                                  0415 00665000
*        /************************************************************/ 00666000
*        /*                                                          */ 00667000
*        /*  PERFORM LOCATE ON THE CLUSTER OR AIX NAME.      @Y30SSFR*/ 00668000
*        /*  CALL LOCPROC TO BUILD THE NECESSARY CPL AND FPLS.       */ 00669000
*        /*  CALL CTLGPROC TO INVOKE CATALOG MANAGEMENT FOR LOCATE   */ 00670000
*        /*                                                          */ 00671000
*        /************************************************************/ 00672000
*                                                                  0415 00673000
*        OLDERID2 = NEWERID2;                                      0415 00674000
         L     @07,@PC00001                                        0415 00675000
         L     @07,GDTTR2(,@07)                                    0415 00676000
         MVC   @TS00001(95),NEWERID2(@07)                          0415 00677000
         MVC   OLDERID2(95,@07),@TS00001                           0415 00678000
*        NEWID2 = 'XPCP';                                          0416 00679000
         MVC   NEWID2(4,@07),@CC01145                              0416 00680000
*        CALL LOCPROC(ADDR(ENTVAL),NULLPARM,NULLPARM,FIELDLST,CNUM,     00681000
*          PTRCPL(1));                                             0417 00682000
*                                                                  0417 00683000
         MVC   @AL00001+4(16),@AL00417                             0417 00684000
         L     @07,@PC00001+4                                      0417 00685000
         L     @07,FDTPTR(,@07)                                    0417 00686000
         LA    @07,ENTVAL(,@07)                                    0417 00687000
         ST    @07,@AFTEMPS                                        0417 00688000
         LA    @07,@AFTEMPS                                        0417 00689000
         ST    @07,@AL00001                                        0417 00690000
         LA    @07,PTRCPL                                          0417 00691000
         ST    @07,@AL00001+20                                     0417 00692000
         LA    @01,@AL00001                                        0417 00693000
         BAL   @14,LOCPROC                                         0417 00694000
*        /************************************************************/ 00695000
*        /*                                                          */ 00696000
*        /* IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -TERMINATE     */ 00697000
*        /*                                                          */ 00698000
*        /************************************************************/ 00699000
*                                                                  0418 00700000
*        RESPECIFY RTNREG RSTD;                                    0418 00701000
*        TESTRC = RTNREG;                                          0419 00702000
         LR    TESTRC,RTNREG                                       0419 00703000
*        RESPECIFY RTNREG UNRSTD;                                  0420 00704000
*        IF TESTRC ^= 0                                            0421 00705000
*          THEN                                                    0421 00706000
         LTR   TESTRC,TESTRC                                       0421 00707000
         BZ    @RF00421                                            0421 00708000
*            RETURN CODE(LASTCC12);                                0422 00709000
*                                                                  0422 00710000
         LA    @15,12                                              0422 00711000
         L     @14,@SA00002                                        0422 00712000
         LM    @00,@05,@SA00002+8                                  0422 00713000
         LM    @07,@12,@SA00002+32                                 0422 00714000
         BR    @14                                                 0422 00715000
*        CALL CTLGPROC(PTRCPL(1));                                 0423 00716000
*                                                                  0423 00717000
@RF00421 LA    @07,PTRCPL                                          0423 00718000
         ST    @07,@AL00001                                        0423 00719000
         LA    @01,@AL00001                                        0423 00720000
         BAL   @14,CTLGPROC                                        0423 00721000
*        /************************************************************/ 00722000
*        /*                                                          */ 00723000
*        /* IF CTLGPROC FAILS TO PERFORM THE LOCATES - TERMINATE     */ 00724000
*        /*                                                          */ 00725000
*        /************************************************************/ 00726000
*                                                                  0424 00727000
*        RESPECIFY RTNREG RSTD;                                    0424 00728000
*        TESTRC = RTNREG;                                          0425 00729000
         LR    TESTRC,RTNREG                                       0425 00730000
*        RESPECIFY RTNREG UNRSTD;                                  0426 00731000
*        IF TESTRC ^= 0                                            0427 00732000
*          THEN                                                    0427 00733000
         LTR   TESTRC,TESTRC                                       0427 00734000
         BZ    @RF00427                                            0427 00735000
*            RETURN CODE(LASTCC12);                                0428 00736000
*                                                                  0428 00737000
         LA    @15,12                                              0428 00738000
         L     @14,@SA00002                                        0428 00739000
         LM    @00,@05,@SA00002+8                                  0428 00740000
         LM    @07,@12,@SA00002+32                                 0428 00741000
         BR    @14                                                 0428 00742000
*        /************************************************************/ 00743000
*        /*                                                          */ 00744000
*        /*  GET ENTYPE FPL AND EXAMINE RETURNED FIELD INFORMATION   */ 00745000
*        /*  TO INSURE THAT ENTRYVAL WAS INDEED A CLUSTER OR AIX     */ 00746000
*        /*  NAME                                            @Y30SSFR*/ 00747000
*        /*                                                          */ 00748000
*        /************************************************************/ 00749000
*                                                                  0429 00750000
*        CTGPLPTR = PTRCPL(1);                                     0429 00751000
@RF00427 L     @07,PTRCPL                                          0429 00752000
         ST    @07,CTGPLPTR                                        0429 00753000
*        CTGFLPTR = CTGFIELD(IENTYPE);                             0430 00754000
         L     CTGFLPTR,CTGFIELD(,@07)                             0430 00755000
*        IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0                      0431 00756000
*          THEN                                                    0431 00757000
         SLR   @07,@07                                             0431 00758000
         C     @07,CTGFLNG(,CTGFLPTR)                              0431 00759000
         BE    @RF00431                                            0431 00760000
         L     @03,CTGFLPT(,CTGFLPTR)                              0431 00761000
         CR    @03,@07                                             0431 00762000
         BE    @RF00431                                            0431 00763000
*            IF FENTYPE = CTGTAIX                          /*@Y30SSFR*/ 00764000
*              THEN                                                0432 00765000
*                                                                  0432 00766000
         CLI   FENTYPE(@03),C'G'                                   0432 00767000
         BNE   @RF00432                                            0432 00768000
*                /****************************************************/ 00769000
*                /*                                          @Y30SSFR*/ 00770000
*                /*  HAVE AN AIX.  SET AIXFLAG TO ON.        @Y30SSFR*/ 00771000
*                /*                                          @Y30SSFR*/ 00772000
*                /****************************************************/ 00773000
*                                                                  0433 00774000
*                AIXFLAG = ON;                             /*@Y30SSFR*/ 00775000
         OI    AIXFLAG,B'10000000'                                 0433 00776000
*              ELSE                                        /*@Y30SSFR*/ 00777000
*                IF FENTYPE = CTGTCL                       /*@Y30SSFR*/ 00778000
*                  THEN                                    /*@Y30SSFR*/ 00779000
         B     @RC00432                                            0434 00780000
@RF00432 L     @07,CTGFLPT(,CTGFLPTR)                              0434 00781000
         CLI   FENTYPE(@07),C'C'                                   0434 00782000
         BNE   @RF00434                                            0434 00783000
*                    DO;                                   /*@Y30SSFR*/ 00784000
*                    CTGFLPTR = CTGFIELD(ICATTR);          /*@Y30SSFR*/ 00785000
         L     @07,CTGPLPTR                                        0436 00786000
         L     CTGFLPTR,CTGFIELD+92(,@07)                          0436 00787000
*                    IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0  /*@Y30SSFR*/ 00788000
*                     & FCATTR ^= NOTINIT(1:1) &           /*@Y30SSFR*/ 00789000
*                     PAGESPC = ON                         /*@Y30SSFR*/ 00790000
*                      THEN                                /*@Y30SSFR*/ 00791000
         SLR   @07,@07                                             0437 00792000
         C     @07,CTGFLNG(,CTGFLPTR)                              0437 00793000
         BE    @RF00437                                            0437 00794000
         L     @03,CTGFLPT(,CTGFLPTR)                              0437 00795000
         CR    @03,@07                                             0437 00796000
         BE    @RF00437                                            0437 00797000
         CLC   FCATTR(1,@03),NOTINIT                               0437 00798000
         BE    @RF00437                                            0437 00799000
         TM    PAGESPC(@03),B'00000001'                            0437 00800000
         BNO   @RF00437                                            0437 00801000
*                        DO;                               /*@Y30SSFR*/ 00802000
*                        DEFSTID = NOCLUSNM;               /*@Y30SSFR*/ 00803000
         LA    DEFSTID,3                                           0439 00804000
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/ 00805000
         LA    @15,12                                              0440 00806000
         L     @14,@SA00002                                        0440 00807000
         LM    @00,@05,@SA00002+8                                  0440 00808000
         LM    @07,@12,@SA00002+32                                 0440 00809000
         BR    @14                                                 0440 00810000
*                        END;                              /*@Y30SSFR*/ 00811000
*                    END;                                  /*@Y30SSFR*/ 00812000
*              ELSE                                        /*@YL026UA*/ 00813000
*                                                                  0443 00814000
*                IF FENTYPE ^= CTGTCL                      /*@Y30SSFR*/ 00815000
*                    THEN                                  /*@Y30SSFR*/ 00816000
         B     @RC00434                                            0443 00817000
@RF00434 L     @07,CTGFLPT(,CTGFLPTR)                              0443 00818000
         CLI   FENTYPE(@07),C'C'                                   0443 00819000
         BE    @RF00443                                            0443 00820000
*                      DO;                                 /*@Y30SSFR*/ 00821000
*                      DEFSTID = NOCLUSNM;                 /*@Y30SSFR*/ 00822000
         LA    DEFSTID,3                                           0445 00823000
*                      RETURN CODE(LASTCC12);              /*@Y30SSFR*/ 00824000
         LA    @15,12                                              0446 00825000
         L     @14,@SA00002                                        0446 00826000
         LM    @00,@05,@SA00002+8                                  0446 00827000
         LM    @07,@12,@SA00002+32                                 0446 00828000
         BR    @14                                                 0446 00829000
*                      END;                                /*@Y30SSFR*/ 00830000
*                    ELSE;                                 /*@Y30SSFR*/ 00831000
@RF00443 DS    0H                                                  0449 00832000
*          ELSE                                                    0449 00833000
*                                                                  0449 00834000
*            /********************************************************/ 00835000
*            /*                                                      */ 00836000
*            /*  NO ENTYPE FIELD -IMPOSSIBLE - TERMINATE             */ 00837000
*            /*                                                      */ 00838000
*            /********************************************************/ 00839000
*                                                                  0449 00840000
*            DO;                                                   0449 00841000
         B     @RC00431                                            0449 00842000
@RF00431 DS    0H                                                  0450 00843000
*            DEFSTID = NOCTFLD;                                    0450 00844000
         LA    DEFSTID,4                                           0450 00845000
*            RETURN CODE(LASTCC12);                                0451 00846000
         LA    @15,12                                              0451 00847000
         L     @14,@SA00002                                        0451 00848000
         LM    @00,@05,@SA00002+8                                  0451 00849000
         LM    @07,@12,@SA00002+32                                 0451 00850000
         BR    @14                                                 0451 00851000
*            END;                                                  0452 00852000
*                                                                  0452 00853000
*        /************************************************************/ 00854000
*        /*                                                          */ 00855000
*        /*  GET CATALOG ACB FIELD IF RETURNED IN FPL FOR CATACB     */ 00856000
*        /*                                                          */ 00857000
*        /************************************************************/ 00858000
*                                                                  0453 00859000
*        CTGFLPTR = CTGFIELD(ICATACB);                             0453 00860000
@RC00431 L     @07,CTGPLPTR                                        0453 00861000
         L     CTGFLPTR,CTGFIELD+88(,@07)                          0453 00862000
*        PTRCTACB = FCATACB;                                       0454 00863000
*                                                                  0454 00864000
         L     @03,CTGFLPT(,CTGFLPTR)                              0454 00865000
         L     @03,FCATACB(,@03)                                   0454 00866000
         ST    @03,PTRCTACB                                        0454 00867000
*        /************************************************************/ 00868000
*        /*                                                          */ 00869000
*        /*  GET NAMEDS FPL FOR DATA AND POSSIBLY INDEX.     @Y30SSFR*/ 00870000
*        /*  CALL LOCPROC TO BUILD CPL AND FPLS AND ISSUE A  @Y30SSFR*/ 00871000
*        /*  LOCATE.                                         @Y30SSFR*/ 00872000
*        /*                                                          */ 00873000
*        /************************************************************/ 00874000
*                                                                  0455 00875000
*        CTGFLPTR = CTGFIELD(INAMEDS);                             0455 00876000
*                                                                  0455 00877000
         L     CTGFLPTR,CTGFIELD+84(,@07)                          0455 00878000
*        /************************************************************/ 00879000
*        /*                                                          */ 00880000
*        /*TEST FOR DATA AND INDEX COMPONENT                         */ 00881000
*        /*RETURN IF UNAVAILABLE                                     */ 00882000
*        /*  THE STRUCTURE OF THE NAMEDS AREA RETURNED BY    @Y30SSFR*/ 00883000
*        /*  CATALOG MANAGEMENT IS USED EXPLICITLY IN ALL    @Y30SSFR*/ 00884000
*        /*  OF THE CODE IN THIS MODULE THAT REFERENCES      @Y30SSFR*/ 00885000
*        /*  NAMEDS.  FOR A CLUSTER OBJECT THE STRUCTURE     @Y30SSFR*/ 00886000
*        /*  IS DATA, INDEX (IF EXISTANT), AND A MIXTURE OF  @Y30SSFR*/ 00887000
*        /*  PATHS AND ALTERNATE INDEXES.  IN THE CASE OF    @Y30SSFR*/ 00888000
*        /*  AN AIX, THE ORDER OF ASSOCIATED OBJECTS IS      @Y30SSFR*/ 00889000
*        /*  DATA, INDEX, BASE CLUSTER, AND ANY PATHS.  FOR  @Y30SSFR*/ 00890000
*        /*  PATHS IDCXP01 ASSUMES ONLY THAT THE PATHENTRY   @Y30SSFR*/ 00891000
*        /*  OBJECT APPEARS FIRST IN THE NAMEDS AREA.        @Y30SSFR*/ 00892000
*        /*                                                          */ 00893000
*        /************************************************************/ 00894000
*                                                                  0456 00895000
*        IF CTGFLNG(1) = 0                                         0456 00896000
*          THEN                                                    0456 00897000
         L     @07,CTGFLNG(,CTGFLPTR)                              0456 00898000
         LTR   @07,@07                                             0456 00899000
         BNZ   @RF00456                                            0456 00900000
*            DO;                                                   0457 00901000
*            DEFSTID= NOCTFLD;                                     0458 00902000
         LA    DEFSTID,4                                           0458 00903000
*            RETURN CODE(LASTCC12);                                0459 00904000
         LA    @15,12                                              0459 00905000
         L     @14,@SA00002                                        0459 00906000
         LM    @00,@05,@SA00002+8                                  0459 00907000
         LM    @07,@12,@SA00002+32                                 0459 00908000
         BR    @14                                                 0459 00909000
*            END;                                                  0460 00910000
*                                                                  0460 00911000
*        /************************************************************/ 00912000
*        /*                                                          */ 00913000
*        /*  ISSUE LOCATES FOR EITHER DATA AND INDEX OR JUST @Y30SSFR*/ 00914000
*        /*  DATA.  THE INFORMATION RETURNED BY CATALOG WILL @Y30SSFR*/ 00915000
*        /*  BE WRITTEN TO THE PORTABILITY DATA SET.         @Y30SSFR*/ 00916000
*        /*                                                          */ 00917000
*        /************************************************************/ 00918000
*                                                                  0461 00919000
*        FNMPTR = CTGFLPT(1);                              /*@Y30SSFR*/ 00920000
@RF00456 L     FNMPTR,CTGFLPT(,CTGFLPTR)                           0461 00921000
*        NUMOBJ = CTGFLNG(1) / LNAMEDS;                    /*@Y30SSFR*/ 00922000
         L     @00,CTGFLNG(,CTGFLPTR)                              0462 00923000
         SRDA  @00,32                                              0462 00924000
         D     @00,@CF00043                                        0462 00925000
         STH   @01,NUMOBJ                                          0462 00926000
*        NUMOBJCT = NUMOBJ;                                /*@Y30SSFR*/ 00927000
         LR    NUMOBJCT,@01                                        0463 00928000
*        NUMASSOC = NUMOBJ;                                /*@Y30SSFR*/ 00929000
         STH   @01,NUMASSOC                                        0464 00930000
*        KSDSFLAG = OFF;                                   /*@Y30SSFR*/ 00931000
*        PATHFLAG = OFF;                                   /*@Y30SSFR*/ 00932000
*                                                                  0466 00933000
         NI    KSDSFLAG,B'10011111'                                0466 00934000
*ASSOCLP: DO I = 1 TO NUMOBJ;                              /*@Y30SSFR*/ 00935000
ASSOCLP  LA    I,1                                                 0467 00936000
         B     @DE00467                                            0467 00937000
@DL00467 DS    0H                                                  0468 00938000
*          OLDERID2 = NEWERID2;                                    0468 00939000
         L     @07,@PC00001                                        0468 00940000
         L     @07,GDTTR2(,@07)                                    0468 00941000
         MVC   @TS00001(95),NEWERID2(@07)                          0468 00942000
         MVC   OLDERID2(95,@07),@TS00001                           0468 00943000
*          NEWID2 = 'XPAO';                                /*@Y30SSFR*/ 00944000
*                                                                  0469 00945000
         MVC   NEWID2(4,@07),@CC01150                              0469 00946000
*          /**********************************************************/ 00947000
*          /*                                                @Y30SSFR*/ 00948000
*          /*  IF DATA OR INDEX, CALL LOCPROC TO BUILD CPL,  @Y30SSFR*/ 00949000
*          /*  FPL'S.  THEN CALL CTLGPROC TO ISSUE A UCATLG. @Y30SSFR*/ 00950000
*          /*  IF EITHER PROCEDURE SHOULD FAIL, RETURN.      @Y30SSFR*/ 00951000
*          /*                                                @Y30SSFR*/ 00952000
*          /**********************************************************/ 00953000
*                                                                  0470 00954000
*          IF FTYPE = CTGTINDX | FTYPE = CTGTDATA          /*@Y30SSFR*/ 00955000
*             | (FTYPE = CTGTCL & AIXFLAG = ON)            /*@Y30SSFR*/ 00956000
*            THEN                                          /*@Y30SSFR*/ 00957000
         CLI   FTYPE(FNMPTR),C'I'                                  0470 00958000
         BE    @RT00470                                            0470 00959000
         CLI   FTYPE(FNMPTR),C'D'                                  0470 00960000
         BE    @RT00470                                            0470 00961000
         CLI   FTYPE(FNMPTR),C'C'                                  0470 00962000
         BNE   @RF00470                                            0470 00963000
         TM    AIXFLAG,B'10000000'                                 0470 00964000
         BNO   @RF00470                                            0470 00965000
@RT00470 DS    0H                                                  0471 00966000
*LOCCOMP:      DO;                                         /*@Y30SSFR*/ 00967000
LOCCOMP  DS    0H                                                  0472 00968000
*              IF (FTYPE = CTGTINDX) | (FTYPE = CTGTDATA)  /*@ZA03936*/ 00969000
*                THEN                                      /*@ZA03936*/ 00970000
         CLI   FTYPE(FNMPTR),C'I'                                  0472 00971000
         BE    @RT00472                                            0472 00972000
         CLI   FTYPE(FNMPTR),C'D'                                  0472 00973000
         BNE   @RF00472                                            0472 00974000
@RT00472 DS    0H                                                  0473 00975000
*                  CALL LOCPROC(NULLPARM,FNAME,PTRCTACB,   /*@ZA03936*/ 00976000
*                    FIELDLST,ONUM,PTRCPL(I+1));           /*@ZA03936*/ 00977000
         LA    @07,NULLPARM                                        0473 00978000
         ST    @07,@AL00001                                        0473 00979000
         LA    @07,FNAME(,FNMPTR)                                  0473 00980000
         ST    @07,@AL00001+4                                      0473 00981000
         LA    @07,PTRCTACB                                        0473 00982000
         ST    @07,@AL00001+8                                      0473 00983000
         LA    @07,FIELDLST                                        0473 00984000
         ST    @07,@AL00001+12                                     0473 00985000
         LA    @07,ONUM                                            0473 00986000
         ST    @07,@AL00001+16                                     0473 00987000
         LR    @07,I                                               0473 00988000
         SLA   @07,2                                               0473 00989000
         LA    @07,PTRCPL(@07)                                     0473 00990000
         ST    @07,@AL00001+20                                     0473 00991000
         LA    @01,@AL00001                                        0473 00992000
         BAL   @14,LOCPROC                                         0473 00993000
*                ELSE                                      /*@ZA03936*/ 00994000
*                  DO;                                     /*@ZA03936*/ 00995000
         B     @RC00472                                            0474 00996000
@RF00472 DS    0H                                                  0475 00997000
*                  CALL LOCPROC(NULLPARM,FNAME,PTRCTACB,   /*@ZA03936*/ 00998000
*                    FIELDLST,AIXNUM,PTRCPL(I+1));         /*@ZA03936*/ 00999000
*                                                                  0475 01000000
         LA    @07,NULLPARM                                        0475 01001000
         ST    @07,@AL00001                                        0475 01002000
         LA    @07,FNAME(,FNMPTR)                                  0475 01003000
         ST    @07,@AL00001+4                                      0475 01004000
         LA    @07,PTRCTACB                                        0475 01005000
         ST    @07,@AL00001+8                                      0475 01006000
         LA    @07,FIELDLST                                        0475 01007000
         ST    @07,@AL00001+12                                     0475 01008000
         LA    @07,AIXNUM                                          0475 01009000
         ST    @07,@AL00001+16                                     0475 01010000
         LR    @07,I                                               0475 01011000
         SLA   @07,2                                               0475 01012000
         LA    @07,PTRCPL(@07)                                     0475 01013000
         ST    @07,@AL00001+20                                     0475 01014000
         LA    @01,@AL00001                                        0475 01015000
         BAL   @14,LOCPROC                                         0475 01016000
*                  /**************************************************/ 01017000
*                  /*                                        @ZA03936*/ 01018000
*                  /*  SET CTGBYPSS ON TO BYPASS DOS         @ZA03936*/ 01019000
*                  /*  SECURITY.                             @ZA03936*/ 01020000
*                  /*                                        @ZA03936*/ 01021000
*                  /**************************************************/ 01022000
*                                                                  0476 01023000
*                  PTRCPL(I+1)->CTGBYPSS = ON;             /*@ZA03936*/ 01024000
         LR    @07,I                                               0476 01025000
         SLA   @07,2                                               0476 01026000
         L     @07,PTRCPL(@07)                                     0476 01027000
         OI    CTGBYPSS(@07),B'10000000'                           0476 01028000
*                  END;                                    /*@ZA03936*/ 01029000
*                                                                  0477 01030000
*              /******************************************************/ 01031000
*              /*                                                    */ 01032000
*              /*  IF LOCPROC FAILS TO BUILD CPL'S AND FPL'S -       */ 01033000
*              /*  TERMINATE.                                        */ 01034000
*              /*                                                    */ 01035000
*              /******************************************************/ 01036000
*                                                                  0478 01037000
*              RESPECIFY RTNREG RSTD;                              0478 01038000
@RC00472 DS    0H                                                  0479 01039000
*              TESTRC = RTNREG;                                    0479 01040000
         LR    TESTRC,RTNREG                                       0479 01041000
*              RESPECIFY RTNREG UNRSTD;                            0480 01042000
*              IF TESTRC ^= 0                                      0481 01043000
*                THEN                                              0481 01044000
         LTR   TESTRC,TESTRC                                       0481 01045000
         BZ    @RF00481                                            0481 01046000
*                  RETURN CODE(LASTCC12);                  /*@Y30SSFR*/ 01047000
*                                                                  0482 01048000
         LA    @15,12                                              0482 01049000
         L     @14,@SA00002                                        0482 01050000
         LM    @00,@05,@SA00002+8                                  0482 01051000
         LM    @07,@12,@SA00002+32                                 0482 01052000
         BR    @14                                                 0482 01053000
*              /******************************************************/ 01054000
*              /*                                                    */ 01055000
*              /*  INVOKE CATALOG MANAGEMENT TO LOCATE RELATED       */ 01056000
*              /*  CLUSTER OR AIX OBJECT.                    #Y30SSFR*/ 01057000
*              /*  TERMINATE IF LOCATE UNSUCCESSFUL                  */ 01058000
*              /*                                                    */ 01059000
*              /******************************************************/ 01060000
*                                                                  0483 01061000
*              CALL CTLGPROC(PTRCPL(I+1));                         0483 01062000
*                                                                  0483 01063000
@RF00481 LR    @07,I                                               0483 01064000
         SLA   @07,2                                               0483 01065000
         LA    @07,PTRCPL(@07)                                     0483 01066000
         ST    @07,@AL00001                                        0483 01067000
         LA    @01,@AL00001                                        0483 01068000
         BAL   @14,CTLGPROC                                        0483 01069000
*              RESPECIFY RTNREG RSTD;                              0484 01070000
*              TESTRC = RTNREG;                                    0485 01071000
         LR    TESTRC,RTNREG                                       0485 01072000
*              RESPECIFY RTNREG UNRSTD;                            0486 01073000
*              IF TESTRC ^= 0                                      0487 01074000
*                THEN                                              0487 01075000
         LTR   TESTRC,TESTRC                                       0487 01076000
         BZ    @RF00487                                            0487 01077000
*                  RETURN CODE(LASTCC12);                          0488 01078000
*                                                                  0488 01079000
         LA    @15,12                                              0488 01080000
         L     @14,@SA00002                                        0488 01081000
         LM    @00,@05,@SA00002+8                                  0488 01082000
         LM    @07,@12,@SA00002+32                                 0488 01083000
         BR    @14                                                 0488 01084000
*              CTGPLPTR = PTRCPL(I+1);                     /*@Y30SSFR*/ 01085000
*                                                                  0489 01086000
@RF00487 LR    @07,I                                               0489 01087000
         SLA   @07,2                                               0489 01088000
         L     @07,PTRCPL(@07)                                     0489 01089000
         ST    @07,CTGPLPTR                                        0489 01090000
*              /******************************************************/ 01091000
*              /*                                            @Y30SSFR*/ 01092000
*              /*  IF WE ARE LOCATING A CLUSTER ASSOCIATED   @Y30SSFR*/ 01093000
*              /*  OBJECT FOR AN AIX, SAVE THE NAME OF THE   @Y30SSFR*/ 01094000
*              /*  CLUSTER.  ALSO DECREMENT THE NUMBER OF    @Y30SSFR*/ 01095000
*              /*  THINGS TO BE EXPORTED.                    @Y30SSFR*/ 01096000
*              /*                                            @Y30SSFR*/ 01097000
*              /******************************************************/ 01098000
*                                                                  0490 01099000
*              IF FTYPE = CTGTCL & AIXFLAG = ON            /*@Y30SSFR*/ 01100000
*                THEN                                      /*@Y30SSFR*/ 01101000
         CLI   FTYPE(FNMPTR),C'C'                                  0490 01102000
         BNE   @RF00490                                            0490 01103000
         TM    AIXFLAG,B'10000000'                                 0490 01104000
         BNO   @RF00490                                            0490 01105000
*                  DO;                                     /*@Y30SSFR*/ 01106000
*                  CTGFLPTR = CTGFIELD(IENTNAME);          /*@Y30SSFR*/ 01107000
         L     CTGFLPTR,CTGFIELD+4(,@07)                           0492 01108000
*                  RELNAME = FENTNAME;                     /*@Y30SSFR*/ 01109000
         L     @07,CTGFLPT(,CTGFLPTR)                              0493 01110000
         MVC   RELNAME(44),FENTNAME(@07)                           0493 01111000
*                  NUMOBJCT = NUMOBJCT - 1;                /*@Y30SSFR*/ 01112000
         BCTR  NUMOBJCT,0                                          0494 01113000
*                  END;                                    /*@Y30SSFR*/ 01114000
*                                                                  0495 01115000
*                                                                  0495 01116000
*              /******************************************************/ 01117000
*              /*                                            @Y30SSFR*/ 01118000
*              /*  TEST FOR THE USABILITY OF THE OBJECT.     @Y30SSFR*/ 01119000
*              /*  IF IT HAS BEEN MARKED AS NOT USABLE,SET   @Y30SSFR*/ 01120000
*              /*  UP TO PRINT A MESSAGE AND RETURN.         @Y30SSFR*/ 01121000
*              /*                                            @Y30SSFR*/ 01122000
*              /******************************************************/ 01123000
*                                                                  0496 01124000
*              IF FTYPE ^= CTGTCL                          /*@Y30SSFR*/ 01125000
*                THEN                                      /*@Y30SSFR*/ 01126000
@RF00490 CLI   FTYPE(FNMPTR),C'C'                                  0496 01127000
         BE    @RF00496                                            0496 01128000
*                  DO;                                     /*@Y30SSFR*/ 01129000
*                  CTGFLPTR = CTGFIELD(IDSATTR);           /*@Y30SSFR*/ 01130000
         L     @07,CTGPLPTR                                        0498 01131000
         L     CTGFLPTR,CTGFIELD+8(,@07)                           0498 01132000
*                  IF FDSNTUSE = ON                        /*@Y30SSFR*/ 01133000
*                    THEN                                  /*@Y30SSFR*/ 01134000
         L     @07,CTGFLPT(,CTGFLPTR)                              0499 01135000
         TM    FDSNTUSE(@07),B'00000001'                           0499 01136000
         BNO   @RF00499                                            0499 01137000
*                      DO;                                 /*@Y30SSFR*/ 01138000
*                      DEFSTID = NOTUSEMG;                 /*@Y30SSFR*/ 01139000
         LA    DEFSTID,7                                           0501 01140000
*                      DARGSMOD = EXPMSG;                  /*@Y30SSFR*/ 01141000
         L     @07,DDSTRU                                          0502 01142000
         MVC   DARGSMOD(3,@07),@CC00914                            0502 01143000
*                      RETURN CODE(LASTCC12);              /*@Y30SSFR*/ 01144000
         LA    @15,12                                              0503 01145000
         L     @14,@SA00002                                        0503 01146000
         LM    @00,@05,@SA00002+8                                  0503 01147000
         LM    @07,@12,@SA00002+32                                 0503 01148000
         BR    @14                                                 0503 01149000
*                      END;                                /*@Y30SSFR*/ 01150000
*                  END;                                    /*@Y30SSFR*/ 01151000
*                                                                  0505 01152000
@RF00499 DS    0H                                                  0506 01153000
*              /******************************************************/ 01154000
*              /*                                            @Y30SSFR*/ 01155000
*              /*  IF THE LOCATE WAS ON A DATA COMPONENT     @Y30SSFR*/ 01156000
*              /*  EXTRACT THE AMDSB FIELD THAT GIVES THE    @Y30SSFR*/ 01157000
*              /*  MAXIMUM LRECL (AMDLRECL), AND SET THE     @Y30SSFR*/ 01158000
*              /*  LRECL OF THE PORTABILITY DATA SET         @Y30SSFR*/ 01159000
*              /*  ACCORDINGLY.  TEST FOR A RELATIVE RECORD  @Y30SSFR*/ 01160000
*              /*  DATA SET, AND SET THE RRDSFLAG IF THE     @Y30SSFR*/ 01161000
*              /*  TEST SUCCEEDS.                            @Y30SSFR*/ 01162000
*              /*                                            @Y30SSFR*/ 01163000
*              /******************************************************/ 01164000
*                                                                  0506 01165000
*              CTGFLPTR = CTGFIELD(IENTYPE);               /*@Y30SSFR*/ 01166000
*                                                                  0506 01167000
@RF00496 L     @07,CTGPLPTR                                        0506 01168000
         L     CTGFLPTR,CTGFIELD(,@07)                             0506 01169000
*              /******************************************************/ 01170000
*              /*                                            @Y30SSFR*/ 01171000
*              /*  TEST TO BE CERTAIN THAT AN ENTYPE FIELD   @Y30SSFR*/ 01172000
*              /*  HAS BEEN LOCATED.                         @Y30SSFR*/ 01173000
*              /*                                            @Y30SSFR*/ 01174000
*              /******************************************************/ 01175000
*                                                                  0507 01176000
*              IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= 0        /*@Y30SSFR*/ 01177000
*                THEN                                      /*@Y30SSFR*/ 01178000
         SLR   @15,@15                                             0507 01179000
         C     @15,CTGFLNG(,CTGFLPTR)                              0507 01180000
         BE    @RF00507                                            0507 01181000
         L     @14,CTGFLPT(,CTGFLPTR)                              0507 01182000
         CR    @14,@15                                             0507 01183000
         BE    @RF00507                                            0507 01184000
*                  IF FENTYPE = CTGTDATA                   /*@Y30SSFR*/ 01185000
*                    THEN                                  /*@Y30SSFR*/ 01186000
         CLI   FENTYPE(@14),C'D'                                   0508 01187000
         BNE   @RF00508                                            0508 01188000
*                      DO;                                 /*@Y30SSFR*/ 01189000
*                      CTGFLPTR = CTGFIELD(IAMDSB);        /*@Y30SSFR*/ 01190000
         L     CTGFLPTR,CTGFIELD+68(,@07)                          0510 01191000
*                      DSCCATPT = CTGFLPT(1);              /*@Y30SSFR*/ 01192000
         L     @07,CTGFLPT(,CTGFLPTR)                              0511 01193000
         ST    @07,DSCCATPT                                        0511 01194000
*                      RESPECIFY IDAAMDSB BASED(DSCCATPT); /*@Y30SSFR*/ 01195000
*                                                                  0512 01196000
*                      /**********************************************/ 01197000
*                      /*                                    @Y30SSFR*/ 01198000
*                      /*  IF THE DATA SET IS AN RRDS, SET   @Y30SSFR*/ 01199000
*                      /*  THE LRECL OF THE PORTABILITY DATA @Y30SSFR*/ 01200000
*                      /*  SET TO BE THE MAXIMUM OF THE      @Y30SSFR*/ 01201000
*                      /*  OF THE LRECL OF THE VSAM OBJECT   @Y30SSFR*/ 01202000
*                      /*  AND THE CONTROL RECORD SIZE PLUS  @Y30SSFR*/ 01203000
*                      /*  8 BYTES (4 FOR RECORD DESCRIPTOR  @Y30SSFR*/ 01204000
*                      /*  WORD AND 4 FOR RELATIVE RECORD    @Y30SSFR*/ 01205000
*                      /*  NUMBER).  OTHERWISE, SET THE      @Y30SSFR*/ 01206000
*                      /*  LRECL OF THE PORTABILITY DATA SET @Y30SSFR*/ 01207000
*                      /*  TO BE THE MAXIMUM OF THE LRECL OF @Y30SSFR*/ 01208000
*                      /*  THE VSAM OBJECT BEING EXPORTED    @Y30SSFR*/ 01209000
*                      /*  AND THE SIZE OF A CONTROL RECORD  @Y30SSFR*/ 01210000
*                      /*  PLUS 4 BYTES.                     @Y30SSFR*/ 01211000
*                      /*                                    @Y30SSFR*/ 01212000
*                      /**********************************************/ 01213000
*                                                                  0513 01214000
*                      IF AMDRRDS = ON                     /*@Y30SSFR*/ 01215000
*                        THEN                              /*@Y30SSFR*/ 01216000
         TM    AMDRRDS(@07),B'00000010'                            0513 01217000
         BNO   @RF00513                                            0513 01218000
*                          DO;                             /*@Y30SSFR*/ 01219000
*                          RRDSFLAG = ON;                  /*@Y30SSFR*/ 01220000
         OI    RRDSFLAG,B'00010000'                                0515 01221000
*                          RECSZ = AMDLRECL + 8;           /*@Y30SSFR*/ 01222000
         LA    @02,8                                               0516 01223000
         L     @07,AMDLRECL(,@07)                                  0516 01224000
         ALR   @07,@02                                             0516 01225000
         ST    @07,RECSZ                                           0516 01226000
*                          IF RECSZ < MINRECSZ + 8         /*@Y30SSFR*/ 01227000
*                            THEN                          /*@Y30SSFR*/ 01228000
         AL    @02,MINRECSZ                                        0517 01229000
         CR    @07,@02                                             0517 01230000
         BNL   @RF00517                                            0517 01231000
*                              RECSZ = MINRECSZ + 8;       /*@Y30SSFR*/ 01232000
         ST    @02,RECSZ                                           0518 01233000
*                            ELSE ;                        /*@Y30SSFR*/ 01234000
@RF00517 DS    0H                                                  0520 01235000
*                          END;                            /*@Y30SSFR*/ 01236000
*                        ELSE                              /*@Y30SSFR*/ 01237000
*                          DO;                             /*@Y30SSFR*/ 01238000
         B     @RC00513                                            0521 01239000
@RF00513 DS    0H                                                  0522 01240000
*                          RECSZ = AMDLRECL +4;            /*@Y30SSFR*/ 01241000
         LA    @07,4                                               0522 01242000
         L     @02,DSCCATPT                                        0522 01243000
         L     @02,AMDLRECL(,@02)                                  0522 01244000
         ALR   @02,@07                                             0522 01245000
         ST    @02,RECSZ                                           0522 01246000
*                          IF RECSZ < MINRECSZ + 4         /*@Y30SSFR*/ 01247000
*                            THEN                          /*@Y30SSFR*/ 01248000
         AL    @07,MINRECSZ                                        0523 01249000
         CR    @02,@07                                             0523 01250000
         BNL   @RF00523                                            0523 01251000
*                              RECSZ = MINRECSZ + 4;       /*@Y30SSFR*/ 01252000
         ST    @07,RECSZ                                           0524 01253000
*                          END;                            /*@Y30SSFR*/ 01254000
*                      END;                                /*@Y30SSFR*/ 01255000
*                                                                  0526 01256000
*                    ELSE                                          0527 01257000
*                                                                  0527 01258000
*                    /************************************************/ 01259000
*                    /*                                      @Y30SSFR*/ 01260000
*                    /*  TEST FOR THE PRESENCE OF AN INDEX   @Y30SSFR*/ 01261000
*                    /*  COMPONENT.  IF THIS IS ONE, THEN    @Y30SSFR*/ 01262000
*                    /*  SET THE KSDSFLAG TO ON.             @Y30SSFR*/ 01263000
*                    /*                                      @Y30SSFR*/ 01264000
*                    /************************************************/ 01265000
*                                                                  0527 01266000
*                      IF FENTYPE = CTGTINDX               /*@Y30SSFR*/ 01267000
*                        THEN                              /*@Y30SSFR*/ 01268000
         B     @RC00508                                            0527 01269000
@RF00508 L     @07,CTGFLPT(,CTGFLPTR)                              0527 01270000
         CLI   FENTYPE(@07),C'I'                                   0527 01271000
         BNE   @RF00527                                            0527 01272000
*                          KSDSFLAG = ON;                  /*@Y30SSFR*/ 01273000
         OI    KSDSFLAG,B'01000000'                                0528 01274000
*                        ELSE ;                            /*@Y30SSFR*/ 01275000
*                                                                  0529 01276000
@RF00527 DS    0H                                                  0530 01277000
*              END LOCCOMP;                                /*@Y30SSFR*/ 01278000
*                                                                  0530 01279000
*            ELSE                                          /*@Y30SSFR*/ 01280000
*                                                                  0531 01281000
*            /********************************************************/ 01282000
*            /*                                              @Y30SSFR*/ 01283000
*            /*  TEST TO SEE IF THE ENTRY TYPE IS PATH.  IF  @Y30SSFR*/ 01284000
*            /*  SO, SET A FLAG INDICATING PATH ASSOCIATIONS @Y30SSFR*/ 01285000
*            /*  OTHERWISE TEST FOR AN AIX.  IF ONE IS       @Y30SSFR*/ 01286000
*            /*  PRESENT, SUBTRACT ONE FROM THE TOTAL        @Y30SSFR*/ 01287000
*            /*  NUMBER OF THINGS TO BE EXPORTED.            @Y30SSFR*/ 01288000
*            /*  AIX'S OVER CLUSTERS DO NOT GET EXPORTED.    @Y30SSFR*/ 01289000
*            /*                                              @Y30SSFR*/ 01290000
*            /********************************************************/ 01291000
*                                                                  0531 01292000
*              IF FTYPE = CTGTPTH                          /*@Y30SSFR*/ 01293000
*                THEN                                      /*@Y30SSFR*/ 01294000
         B     @RC00470                                            0531 01295000
@RF00470 CLI   FTYPE(FNMPTR),C'R'                                  0531 01296000
         BNE   @RF00531                                            0531 01297000
*                  PATHFLAG = ON;                          /*@Y30SSFR*/ 01298000
         OI    PATHFLAG,B'00100000'                                0532 01299000
*                ELSE                                      /*@Y30SSFR*/ 01300000
*                  IF FTYPE = CTGTAIX                      /*@Y30SSFR*/ 01301000
*                    THEN                                  /*@Y30SSFR*/ 01302000
         B     @RC00531                                            0533 01303000
@RF00531 CLI   FTYPE(FNMPTR),C'G'                                  0533 01304000
         BNE   @RF00533                                            0533 01305000
*                      NUMOBJCT = NUMOBJCT - 1;            /*@Y30SSFR*/ 01306000
         BCTR  NUMOBJCT,0                                          0534 01307000
*                    ELSE ;                                /*@Y30SSFR*/ 01308000
*                                                                  0535 01309000
@RF00533 DS    0H                                                  0536 01310000
*          FNMPTR = FNMPTR + LNAMEDS;                      /*@Y30SSFR*/ 01311000
@RC00531 DS    0H                                                  0536 01312000
@RC00470 AL    FNMPTR,@CF00043                                     0536 01313000
*        END ASSOCLP;                                      /*@Y30SSFR*/ 01314000
*                                                                  0537 01315000
         AL    I,@CF00220                                          0537 01316000
@DE00467 CH    I,NUMOBJ                                            0537 01317000
         BNH   @DL00467                                            0537 01318000
*        /************************************************************/ 01319000
*        /*                                                  @Y30SSFR*/ 01320000
*        /*  SET THE NUMBER OF OBJECTS TO BE EXPORTED TO BE  @Y30SSFR*/ 01321000
*        /*  THE NUMBER OF OBJECTS ASSOCIATED WITH THE ENTRY @Y30SSFR*/ 01322000
*        /*  MINUS THE NUMBER OF AIX'S ASSOCIATED.           @Y30SSFR*/ 01323000
*        /*                                                  @Y30SSFR*/ 01324000
*        /************************************************************/ 01325000
*                                                                  0538 01326000
*        NUMOBJ = NUMOBJCT;                                /*@Y30SSFR*/ 01327000
*                                                                  0538 01328000
         STH   NUMOBJCT,NUMOBJ                                     0538 01329000
*        /************************************************************/ 01330000
*        /*                                                  @Y30SSFR*/ 01331000
*        /*  INDICATE HOW MANY CPL'S HAVE BEEN BUILT AND     @Y30SSFR*/ 01332000
*        /*  ARE TO BE WRITTEN TO THE PORTABILITY DATA       @Y30SSFR*/ 01333000
*        /*  SET.                                            @Y30SSFR*/ 01334000
*        /*                                                  @Y30SSFR*/ 01335000
*        /************************************************************/ 01336000
*                                                                  0539 01337000
*        IF KSDSFLAG = ON                                  /*@Y30SSFR*/ 01338000
*          THEN                                            /*@Y30SSFR*/ 01339000
         TM    KSDSFLAG,B'01000000'                                0539 01340000
         BNO   @RF00539                                            0539 01341000
*            NUMCPL = 3;                                   /*@Y30SSFR*/ 01342000
         LA    NUMCPL,3                                            0540 01343000
*          ELSE                                            /*@Y30SSFR*/ 01344000
*            NUMCPL = 2;                                   /*@Y30SSFR*/ 01345000
         B     @RC00539                                            0541 01346000
@RF00539 LA    NUMCPL,2                                            0541 01347000
*        /************************************************************/ 01348000
*        /*                                                          */ 01349000
*        /*  OPEN OUTPUT DATA SET - THE PORTABILITY DATA SET         */ 01350000
*        /*                                                          */ 01351000
*        /************************************************************/ 01352000
*                                                                  0542 01353000
*        IF RECSZ = 0                                              0542 01354000
*          THEN                                                    0542 01355000
@RC00539 L     @07,RECSZ                                           0542 01356000
         LTR   @07,@07                                             0542 01357000
         BNZ   @RF00542                                            0542 01358000
*            DO;                                                   0543 01359000
*                                                                  0543 01360000
*            /********************************************************/ 01361000
*            /*                                                      */ 01362000
*            /*  IF NO VALID LRECL SIZE WAS SET, THE CATALOG MUST BE */ 01363000
*            /*  IN ERROR.  SET ERROR MESSAGE NUMBER AND RETURN      */ 01364000
*            /*                                                      */ 01365000
*            /********************************************************/ 01366000
*                                                                  0544 01367000
*            DEFSTID = NOCTFLD;                                    0544 01368000
         LA    DEFSTID,4                                           0544 01369000
*            RETURN CODE(LASTCC12);                                0545 01370000
         LA    @15,12                                              0545 01371000
         L     @14,@SA00002                                        0545 01372000
         LM    @00,@05,@SA00002+8                                  0545 01373000
         LM    @07,@12,@SA00002+32                                 0545 01374000
         BR    @14                                                 0545 01375000
*            END;                                                  0546 01376000
*                                                                  0546 01377000
*        IF ADDR(OUTDD) = NULLPTR                          /*@OZ15686*/ 01378000
*          THEN                                            /*@OZ15686*/ 01379000
@RF00542 L     @07,@PC00001+4                                      0547 01380000
         L     @04,FDTPTR+12(,@07)                                 0547 01381000
         LTR   @04,@04                                             0547 01382000
         BNZ   @RF00547                                            0547 01383000
*            CALL OPENPROC('O',NULLPARM,ADDR(OUTDSVAL),    /*@OZ15686*/ 01384000
*              RECSZ,BLKSIZ,ADDR(POUTIOCS));               /*@OZ15686*/ 01385000
         LA    @04,@CC01155                                        0548 01386000
         ST    @04,@AL00001                                        0548 01387000
         LA    @04,NULLPARM                                        0548 01388000
         ST    @04,@AL00001+4                                      0548 01389000
         L     @07,FDTPTR+68(,@07)                                 0548 01390000
         LA    @07,OUTDSVAL(,@07)                                  0548 01391000
         ST    @07,@AFTEMPS                                        0548 01392000
         LA    @07,@AFTEMPS                                        0548 01393000
         ST    @07,@AL00001+8                                      0548 01394000
         LA    @07,RECSZ                                           0548 01395000
         ST    @07,@AL00001+12                                     0548 01396000
         LA    @07,BLKSIZ                                          0548 01397000
         ST    @07,@AL00001+16                                     0548 01398000
         LA    @07,POUTIOCS                                        0548 01399000
         ST    @07,@AFTEMPS+4                                      0548 01400000
         LA    @07,@AFTEMPS+4                                      0548 01401000
         ST    @07,@AL00001+20                                     0548 01402000
         LA    @01,@AL00001                                        0548 01403000
         BAL   @14,OPENPROC                                        0548 01404000
*           ELSE                                           /*@OZ15686*/ 01405000
*            CALL OPENPROC('O',ADDR(OUTDDVAL),NULLPARM,    /*@Y30SSFR*/ 01406000
*              RECSZ,BLKSIZ,ADDR(POUTIOCS));               /*@Y30SSFR*/ 01407000
*                                                                  0549 01408000
         B     @RC00547                                            0549 01409000
@RF00547 LA    @07,@CC01155                                        0549 01410000
         ST    @07,@AL00001                                        0549 01411000
         L     @07,@PC00001+4                                      0549 01412000
         L     @07,FDTPTR+12(,@07)                                 0549 01413000
         LA    @07,OUTDDVAL(,@07)                                  0549 01414000
         ST    @07,@AFTEMPS                                        0549 01415000
         LA    @07,@AFTEMPS                                        0549 01416000
         ST    @07,@AL00001+4                                      0549 01417000
         LA    @07,NULLPARM                                        0549 01418000
         ST    @07,@AL00001+8                                      0549 01419000
         LA    @07,RECSZ                                           0549 01420000
         ST    @07,@AL00001+12                                     0549 01421000
         LA    @07,BLKSIZ                                          0549 01422000
         ST    @07,@AL00001+16                                     0549 01423000
         LA    @07,POUTIOCS                                        0549 01424000
         ST    @07,@AFTEMPS+4                                      0549 01425000
         LA    @07,@AFTEMPS+4                                      0549 01426000
         ST    @07,@AL00001+20                                     0549 01427000
         LA    @01,@AL00001                                        0549 01428000
         BAL   @14,OPENPROC                                        0549 01429000
*        /************************************************************/ 01430000
*        /*                                                          */ 01431000
*        /*  TEST FOR SUCCESSFUL OPEN.  IF OPEN UNSUCCESSFUL         */ 01432000
*        /*  RETURN TO CALLING PROCESSOR WITH ERROR INDICATED        */ 01433000
*        /*                                                          */ 01434000
*        /************************************************************/ 01435000
*                                                                  0550 01436000
*        RESPECIFY RTNREG RSTD;                                    0550 01437000
@RC00547 DS    0H                                                  0551 01438000
*        TESTRC = RTNREG;                                          0551 01439000
         LR    TESTRC,RTNREG                                       0551 01440000
*        RESPECIFY RTNREG UNRSTD;                                  0552 01441000
*        IF TESTRC ^= 0                                            0553 01442000
*          THEN                                                    0553 01443000
         LTR   TESTRC,TESTRC                                       0553 01444000
         BZ    @RF00553                                            0553 01445000
*            RETURN CODE(LASTCC12);                                0554 01446000
         LA    @15,12                                              0554 01447000
         L     @14,@SA00002                                        0554 01448000
         LM    @00,@05,@SA00002+8                                  0554 01449000
         LM    @07,@12,@SA00002+32                                 0554 01450000
         BR    @14                                                 0554 01451000
*        /************************************************************/ 01452000
*        /*                                                          */ 01453000
*        /*  WRITE CATALOG INFORMATION TO THE PORTABILITY DATA SET   */ 01454000
*        /*  CATALOG INFORMATION WILL BE CONTAINED IN TWO TYPES OF   */ 01455000
*        /*  RECORDS- CONTROL RECORDS CONTAINING A DICTIONARY        */ 01456000
*        /*  INDEXING EACH CATALOG FIELD IN THE WORK AREA RETURNED   */ 01457000
*        /*  BY VSAM AND DATA RECORDS CONTAINING THE ENTIRE WORK     */ 01458000
*        /*  AREA RETURNED BY LOCATE                                 */ 01459000
*        /*                                                          */ 01460000
*        /************************************************************/ 01461000
*                                                                  0555 01462000
*        OLDERID2 = NEWERID2;                                      0555 01463000
@RF00553 L     @07,@PC00001                                        0555 01464000
         L     @04,GDTTR2(,@07)                                    0555 01465000
         MVC   @TS00001(95),NEWERID2(@04)                          0555 01466000
         MVC   OLDERID2(95,@04),@TS00001                           0555 01467000
*        NEWID2 = 'XPWC';                                          0556 01468000
*                                                                  0556 01469000
         MVC   NEWID2(4,@04),@CC01156                              0556 01470000
*        /************************************************************/ 01471000
*        /*                                                          */ 01472000
*        /*  GET AN AREA FOR THE CONTROL RECORD OUTPUT BUFFER        */ 01473000
*        /*  IF CORE NOT OBTAINED, RETURN TO CALLING PROCESSOR        * 01474000
*        /*                                                          */ 01475000
*        /************************************************************/ 01476000
*                                                                  0557 01477000
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CONREC),CONRCPTR,GPID,SETZERO);   01478000
*                                                                  0557 01479000
         MVC   @AL00001+4(16),@AL00557                             0557 01480000
         ST    @07,@AL00001                                        0557 01481000
         LA    @04,CONRCPTR                                        0557 01482000
         ST    @04,@AL00001+8                                      0557 01483000
         L     @15,GDTGPL(,@07)                                    0557 01484000
         LA    @01,@AL00001                                        0557 01485000
         BALR  @14,@15                                             0557 01486000
*        RESPECIFY RTNREG RSTD;                                    0558 01487000
*        TESTRC = RTNREG;                                          0559 01488000
         LR    TESTRC,RTNREG                                       0559 01489000
*        RESPECIFY RTNREG UNRSTD;                                  0560 01490000
*        IF TESTRC ^= 0                                            0561 01491000
*          THEN                                                    0561 01492000
         LTR   TESTRC,TESTRC                                       0561 01493000
         BZ    @RF00561                                            0561 01494000
*            DO;                                                   0562 01495000
*            DARGSMOD = UNIVMSG;                                   0563 01496000
         L     @07,DDSTRU                                          0563 01497000
         MVC   DARGSMOD(3,@07),@CC00930                            0563 01498000
*            DEFSTID = NOSTORAG;                                   0564 01499000
         LA    DEFSTID,4                                           0564 01500000
*            RETURN CODE(LASTCC12);                                0565 01501000
         LA    @15,12                                              0565 01502000
         L     @14,@SA00002                                        0565 01503000
         LM    @00,@05,@SA00002+8                                  0565 01504000
         LM    @07,@12,@SA00002+32                                 0565 01505000
         BR    @14                                                 0565 01506000
*            END;                                                  0566 01507000
*                                                                  0566 01508000
*        /************************************************************/ 01509000
*        /*                                                          */ 01510000
*        /*  THE FIRST RECORD WRITTEN TO THE PORTABILITY DATA SET IS */ 01511000
*        /*  THE TIME STAMP INDICATING THE EXACT MOMENT WHEN EXPORT  */ 01512000
*        /*  OCCURRED.                                               */ 01513000
*        /*                                                          */ 01514000
*        /************************************************************/ 01515000
*                                                                  0567 01516000
*        CALL IDCSATI0 (GDTTBL,TIMEODAY,TIMEDATE,FORMAT);          0567 01517000
*                                                                  0567 01518000
@RF00561 L     @07,@PC00001                                        0567 01519000
         ST    @07,@AL00001                                        0567 01520000
         LA    @04,8                                               0567 01521000
         AL    @04,CONRCPTR                                        0567 01522000
         LA    @15,TIMEODAY(,@04)                                  0567 01523000
         ST    @15,@AL00001+4                                      0567 01524000
         LA    @04,TIMEDATE(,@04)                                  0567 01525000
         ST    @04,@AL00001+8                                      0567 01526000
         LA    @04,FORMAT                                          0567 01527000
         ST    @04,@AL00001+12                                     0567 01528000
         MVI   @AL00001+12,X'80'                                   0567 01529000
         L     @15,GDTTIM(,@07)                                    0567 01530000
         LA    @01,@AL00001                                        0567 01531000
         BALR  @14,@15                                             0567 01532000
*        PORTTIME = TIMEODAY;                                      0568 01533000
         L     @07,CONRCPTR                                        0568 01534000
         LA    @04,8                                               0568 01535000
         ALR   @04,@07                                             0568 01536000
         MVC   PORTTIME(8),TIMEODAY(@04)                           0568 01537000
*        PORTDATE = TIMEDATE;                                      0569 01538000
*                                                                  0569 01539000
         MVC   PORTDATE(8),TIMEDATE(@04)                           0569 01540000
*        HEADLN = LENGTH(HEADER) + LENGTH(TIMESTMP);               0570 01541000
         MVC   HEADLN(2,@07),@CH01340                              0570 01542000
*        HEADFLG1 = HDFL1CAT;                                      0571 01543000
         MVI   HEADFLG1(@07),X'FF'                                 0571 01544000
*        HEADFLG2 = HDFL2TSP;                                      0572 01545000
*                                                                  0572 01546000
         MVI   HEADFLG2(@07),X'FF'                                 0572 01547000
*        /************************************************************/ 01548000
*        /*                                                          */ 01549000
*        /*  IF INHIBITTARGET HAS BEEN SPECIFIED, THE DSATTR FIELDS  */ 01550000
*        /*  MUST BE CHANGED TO SPECIFY INHIBIT UPDATE AT IMPORT TIME*/ 01551000
*        /*  A FLAG WILL BE SET IN THE TIME STAMP RECORD, SO THAT    */ 01552000
*        /*  IMPORT WILL KNOW TO ALTER THE DSATTR FIELDS AFTER THE   */ 01553000
*        /*  DATA SET HAS BEEN LOADED.                               */ 01554000
*        /*  ALSO PUT THE NUMBER OF CLUSTER COMPONENTS IN THE RECORD */ 01555000
*        /*                                                          */ 01556000
*        /************************************************************/ 01557000
*                                                                  0573 01558000
*        IF ADDR(INHBT) ^= NULLPTR                                 0573 01559000
*          THEN                                                    0573 01560000
         L     @07,@PC00001+4                                      0573 01561000
         L     @07,FDTPTR+32(,@07)                                 0573 01562000
         LTR   @07,@07                                             0573 01563000
         BZ    @RF00573                                            0573 01564000
*            TEXINHTG = ON;                                        0574 01565000
*                                                                  0574 01566000
         OI    TEXINHTG(@04),B'01000000'                           0574 01567000
*        NUMOBJ = NUMOBJ + 1;                              /*@Y30SSFR*/ 01568000
@RF00573 LA    @07,1                                               0575 01569000
         AH    @07,NUMOBJ                                          0575 01570000
         STH   @07,NUMOBJ                                          0575 01571000
*        TEXOJCT = NUMOBJ;                                 /*@Y30SSFR*/ 01572000
*                                                                  0576 01573000
         LA    @04,8                                               0576 01574000
         AL    @04,CONRCPTR                                        0576 01575000
         STC   @07,TEXOJCT(,@04)                                   0576 01576000
*        /************************************************************/ 01577000
*        /*                                                  @Y30SSFR*/ 01578000
*        /*  IF THE PATHFLAG IS ON, SET THE TEXASSOC BIT, AND@Y30SSFR*/ 01579000
*        /*  TEST THE KSDSFLAG.  IF THAT FLAG IS ALSO ON,    @Y30SSFR*/ 01580000
*        /*  SET THE TEXBASE BIT.                            @Y30SSFR*/ 01581000
*        /*                                                  @Y30SSFR*/ 01582000
*        /************************************************************/ 01583000
*                                                                  0577 01584000
*        IF PATHFLAG = ON                                  /*@Y30SSFR*/ 01585000
*          THEN                                            /*@Y30SSFR*/ 01586000
         TM    PATHFLAG,B'00100000'                                0577 01587000
         BNO   @RF00577                                            0577 01588000
*            DO;                                           /*@Y30SSFR*/ 01589000
*            TEXASSOC = ON;                                /*@Y30SSFR*/ 01590000
         OI    TEXASSOC(@04),B'00100000'                           0579 01591000
*            IF KSDSFLAG = ON                              /*@Y30SSFR*/ 01592000
*              THEN                                        /*@Y30SSFR*/ 01593000
         TM    KSDSFLAG,B'01000000'                                0580 01594000
         BNO   @RF00580                                            0580 01595000
*                TEXBASE = ON;                             /*@Y30SSFR*/ 01596000
         OI    TEXBASE(@04),B'00010000'                            0581 01597000
*            END;                                          /*@Y30SSFR*/ 01598000
*                                                                  0582 01599000
@RF00580 DS    0H                                                  0583 01600000
*        TEXFLG2 = EXPTYPE1;                                       0583 01601000
*                                                                  0583 01602000
@RF00577 L     @07,CONRCPTR                                        0583 01603000
         MVC   TEXFLG2+8(1,@07),EXPTYPE1                           0583 01604000
*        TOTLEN = HEADLN;                                          0584 01605000
*                                                                  0584 01606000
         LH    @07,HEADLN(,@07)                                    0584 01607000
         ST    @07,TOTLEN                                          0584 01608000
*        /************************************************************/ 01609000
*        /*                                                          */ 01610000
*        /*  WRITE THE TIME STAMP RECORD TO PORTABILITY DATA SET.    */ 01611000
*        /*  IF AN ERROR IS ENCOUNTERED, RETURN TO THE CALLING       */ 01612000
*        /*  PROCESSOR.                                              */ 01613000
*        /*                                                          */ 01614000
*        /************************************************************/ 01615000
*                                                                  0585 01616000
*        CALL PUTPROC(TOTLEN,CONRCPTR);                            0585 01617000
*                                                                  0585 01618000
         LA    @07,TOTLEN                                          0585 01619000
         ST    @07,@AL00001                                        0585 01620000
         LA    @07,CONRCPTR                                        0585 01621000
         ST    @07,@AL00001+4                                      0585 01622000
         LA    @01,@AL00001                                        0585 01623000
         BAL   @14,PUTPROC                                         0585 01624000
*        RESPECIFY RTNREG RSTD;                                    0586 01625000
*        TESTRC = RTNREG;                                          0587 01626000
         LR    TESTRC,RTNREG                                       0587 01627000
*        RESPECIFY RTNREG UNRSTD;                                  0588 01628000
*        IF TESTRC ^= 0                                            0589 01629000
*          THEN                                                    0589 01630000
         LTR   TESTRC,TESTRC                                       0589 01631000
         BZ    @RF00589                                            0589 01632000
*            RETURN CODE(LASTCC12);                                0590 01633000
*                                                                  0590 01634000
         LA    @15,12                                              0590 01635000
         L     @14,@SA00002                                        0590 01636000
         LM    @00,@05,@SA00002+8                                  0590 01637000
         LM    @07,@12,@SA00002+32                                 0590 01638000
         BR    @14                                                 0590 01639000
*        /************************************************************/ 01640000
*        /*                                                          */ 01641000
*        /*  NOW SELECT EACH CPL AND INTERROGATE FPL'S FOR FIELD     */ 01642000
*        /*  INFORMATION                                             */ 01643000
*        /*                                                          */ 01644000
*        /************************************************************/ 01645000
*                                                                  0591 01646000
*        DO INDXCPL = 1 TO NUMCPL;                        /*@Y30SSFR*/  01647000
*                                                                  0591 01648000
@RF00589 LA    @07,1                                               0591 01649000
         B     @DE00591                                            0591 01650000
@DL00591 DS    0H                                                  0592 01651000
*          /**********************************************************/ 01652000
*          /*                                                @Y30SSFR*/ 01653000
*          /*  IF WE ARE PROCESSING AN AIX CONTROL RECORD,   @Y30SSFR*/ 01654000
*          /*  CALL CONTRBL WITH TYPE 'G' SPECIFIED.         @Y30SSFR*/ 01655000
*          /*  OTHERWISE, CALL CONTRBL WITH TYPE 'N' AS AN   @Y30SSFR*/ 01656000
*          /*  ARGUMENT.  ('N' STANDS FOR NEUTRAL--A TYPE    @Y30SSFR*/ 01657000
*          /*  OTHER THAN PATH OR AIX.)  CONTRBL ACTUALLY    @Y30SSFR*/ 01658000
*          /*  BUILDS THE CONTROL RECORD TO BE WRITTEN TO    @Y30SSFR*/ 01659000
*          /*  THE PORTABILITY DATA SET.                     @Y30SSFR*/ 01660000
*          /*                                                @Y30SSFR*/ 01661000
*          /**********************************************************/ 01662000
*                                                                  0592 01663000
*          IF AIXFLAG = ON & INDXCPL =1                    /*@Y30SSFR*/ 01664000
*            THEN                                          /*@Y30SSFR*/ 01665000
         TM    AIXFLAG,B'10000000'                                 0592 01666000
         BNO   @RF00592                                            0592 01667000
         C     @07,@CF00220                                        0592 01668000
         BNE   @RF00592                                            0592 01669000
*              DO;                                         /*@Y30SSFR*/ 01670000
*              CALL CONTRBL(INDXCPL,CTGTAIX);              /*@Y30SSFR*/ 01671000
         LA    @07,INDXCPL                                         0594 01672000
         ST    @07,@AL00001                                        0594 01673000
         LA    @07,@CC00738                                        0594 01674000
         ST    @07,@AL00001+4                                      0594 01675000
         LA    @01,@AL00001                                        0594 01676000
         BAL   @14,CONTRBL                                         0594 01677000
*              RESPECIFY RTNREG RSTD;                              0595 01678000
*              TESTRC = RTNREG;                                    0596 01679000
         LR    TESTRC,RTNREG                                       0596 01680000
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30SSFR*/ 01681000
*              IF TESTRC ^= 0                              /*@Y30SSFR*/ 01682000
*                THEN                                      /*@Y30SSFR*/ 01683000
         LTR   TESTRC,TESTRC                                       0598 01684000
         BZ    @RF00598                                            0598 01685000
*                  RETURN CODE(LASTCC12);                  /*@Y30SSFR*/ 01686000
         LA    @15,12                                              0599 01687000
         L     @14,@SA00002                                        0599 01688000
         LM    @00,@05,@SA00002+8                                  0599 01689000
         LM    @07,@12,@SA00002+32                                 0599 01690000
         BR    @14                                                 0599 01691000
*              END;                                        /*@Y30SSFR*/ 01692000
*            ELSE                                          /*@Y30SSFR*/ 01693000
*              DO;                                         /*@Y30SSFR*/ 01694000
         B     @RC00592                                            0601 01695000
@RF00592 DS    0H                                                  0602 01696000
*              CALL CONTRBL(INDXCPL,'N');                  /*@Y30SSFR*/ 01697000
         LA    @07,INDXCPL                                         0602 01698000
         ST    @07,@AL00001                                        0602 01699000
         LA    @07,@CC01159                                        0602 01700000
         ST    @07,@AL00001+4                                      0602 01701000
         LA    @01,@AL00001                                        0602 01702000
         BAL   @14,CONTRBL                                         0602 01703000
*              RESPECIFY RTNREG RSTD;                              0603 01704000
*              TESTRC = RTNREG;                                    0604 01705000
         LR    TESTRC,RTNREG                                       0604 01706000
*              RESPECIFY RTNREG UNRSTD;                    /*@Y30SSFR*/ 01707000
*              IF TESTRC ^= 0                              /*@Y30SSFR*/ 01708000
*                THEN                                      /*@Y30SSFR*/ 01709000
         LTR   TESTRC,TESTRC                                       0606 01710000
         BZ    @RF00606                                            0606 01711000
*                  RETURN CODE(LASTCC12);                  /*@Y30SSFR*/ 01712000
         LA    @15,12                                              0607 01713000
         L     @14,@SA00002                                        0607 01714000
         LM    @00,@05,@SA00002+8                                  0607 01715000
         LM    @07,@12,@SA00002+32                                 0607 01716000
         BR    @14                                                 0607 01717000
*              END;                                        /*@Y30SSFR*/ 01718000
*                                                                  0608 01719000
@RF00606 DS    0H                                                  0609 01720000
*        END;                                              /*@Y30SSFR*/ 01721000
*                                                                  0609 01722000
@RC00592 LA    @07,1                                               0609 01723000
         AL    @07,INDXCPL                                         0609 01724000
@DE00591 ST    @07,INDXCPL                                         0609 01725000
         CR    @07,NUMCPL                                          0609 01726000
         BNH   @DL00591                                            0609 01727000
*        /************************************************************/ 01728000
*        /*                                                  @Y30SSFR*/ 01729000
*        /*  TEST TO DETERMINE IF THERE ARE PATH             @Y30SSFR*/ 01730000
*        /*  ASSOCIATIONS PRESENT.  IF SO LOOP, DOING        @Y30SSFR*/ 01731000
*        /*  LOCATES FOR THE PATHS, AND WRITING OUT THE      @Y30SSFR*/ 01732000
*        /*  CATALOG INFORMATION TO THE PORTABILITY          @Y30SSFR*/ 01733000
*        /*  DATA SET.                                       @Y30SSFR*/ 01734000
*        /*                                                  @Y30SSFR*/ 01735000
*        /************************************************************/ 01736000
*                                                                  0610 01737000
*        IF PATHFLAG = ON                                          0610 01738000
*          THEN                                                    0610 01739000
         TM    PATHFLAG,B'00100000'                                0610 01740000
         BNO   @RF00610                                            0610 01741000
*PTHDEF:     DO;                                           /*@Y30SSFR*/ 01742000
*                                                                  0611 01743000
PTHDEF   DS    0H                                                  0612 01744000
*            /********************************************************/ 01745000
*            /*                                              @Y30SSFR*/ 01746000
*            /*  SET A FLAG TO INDICATE THAT WE ARE PROCESS- @Y30SSFR*/ 01747000
*            /*  ING THE FIRST PATH.  LOOP THROUGH THE PATHS @Y30SSFR*/ 01748000
*            /*  DOING LOCATES AND WRITING CATALOG           @Y30SSFR*/ 01749000
*            /*  INFORMATION TO THE PORTABILITY DATA SET.    @Y30SSFR*/ 01750000
*            /*                                              @Y30SSFR*/ 01751000
*            /********************************************************/ 01752000
*                                                                  0612 01753000
*            FIRFLAG = ON;                                 /*@Y30SSFR*/ 01754000
*                                                                  0612 01755000
         OI    FIRFLAG,B'00001000'                                 0612 01756000
*PATHREC:    DO I = NUMCPL+1 TO NUMASSOC+1;                /*@Y30SSFR*/ 01757000
PATHREC  LA    I,1                                                 0613 01758000
         ALR   I,NUMCPL                                            0613 01759000
         B     @DE00613                                            0613 01760000
@DL00613 DS    0H                                                  0614 01761000
*              CTGPLPTR = PTRCPL(1);                       /*@Y30SSFR*/ 01762000
         L     @07,PTRCPL                                          0614 01763000
         ST    @07,CTGPLPTR                                        0614 01764000
*              CTGFLPTR = CTGFIELD(INAMEDS);               /*@Y30SSFR*/ 01765000
         L     CTGFLPTR,CTGFIELD+84(,@07)                          0615 01766000
*              FNMPTR = CTGFLPT(1) + LNAMEDS *             /*@Y30SSFR*/ 01767000
*                (I - 2);                                  /*@Y30SSFR*/ 01768000
*                                                                  0616 01769000
         LR    FNMPTR,I                                            0616 01770000
         BCTR  FNMPTR,0                                            0616 01771000
         BCTR  FNMPTR,0                                            0616 01772000
         SLA   FNMPTR,2                                            0616 01773000
         AL    FNMPTR,CTGFLPT(,CTGFLPTR)                           0616 01774000
*              /******************************************************/ 01775000
*              /*                                            @Y30SSFR*/ 01776000
*              /*  TEST TO DETERMINE IF THE ASSOCIATED       @Y30SSFR*/ 01777000
*              /*  OBJECT IS A PATH.                         @Y30SSFR*/ 01778000
*              /*                                            @Y30SSFR*/ 01779000
*              /******************************************************/ 01780000
*                                                                  0617 01781000
*              IF FTYPE = CTGTPTH                          /*@Y30SSFR*/ 01782000
*                THEN                                      /*@Y30SSFR*/ 01783000
*                                                                  0617 01784000
         CLI   FTYPE(FNMPTR),C'R'                                  0617 01785000
         BNE   @RF00617                                            0617 01786000
*                  /**************************************************/ 01787000
*                  /*                                        @Y30SSFR*/ 01788000
*                  /*  TEST TO DETERMINE WHETHER THIS IS THE @Y30SSFR*/ 01789000
*                  /*  FIRST PATH TO BE PROCESSED.           @Y30SSFR*/ 01790000
*                  /*                                        @Y30SSFR*/ 01791000
*                  /**************************************************/ 01792000
*                                                                  0618 01793000
*                  IF FIRFLAG = ON                         /*@Y30SSFR*/ 01794000
*                    THEN                                  /*@Y30SSFR*/ 01795000
         TM    FIRFLAG,B'00001000'                                 0618 01796000
         BNO   @RF00618                                            0618 01797000
*FIRPATH:              DO;                                 /*@Y30SSFR*/ 01798000
FIRPATH  DS    0H                                                  0620 01799000
*                      FIRFLAG = OFF;                      /*@Y30SSFR*/ 01800000
*                                                                  0620 01801000
         NI    FIRFLAG,B'11110111'                                 0620 01802000
*                      /**********************************************/ 01803000
*                      /*                                    @Y30SSFR*/ 01804000
*                      /*  IF THIS IS THE FIRST PATH TO BE   @Y30SSFR*/ 01805000
*                      /*  PROCESSED CALL LOCPROC TO BUILD   @Y30SSFR*/ 01806000
*                      /*  THE CPL AND FPL'S.                @Y30SSFR*/ 01807000
*                      /*                                    @Y30SSFR*/ 01808000
*                      /**********************************************/ 01809000
*                                                                  0621 01810000
*                      CALL LOCPROC(NULLPARM,FNAME,PTRCTACB,       0621 01811000
*                        FIELDLST,ONUM,                    /*@Y30SSFR*/ 01812000
*                        PTRCPL(PTHCPLNO));                /*@Y30SSFR*/ 01813000
*                                                                  0621 01814000
         LA    @07,NULLPARM                                        0621 01815000
         ST    @07,@AL00001                                        0621 01816000
         LA    @07,FNAME(,FNMPTR)                                  0621 01817000
         ST    @07,@AL00001+4                                      0621 01818000
         LA    @07,PTRCTACB                                        0621 01819000
         ST    @07,@AL00001+8                                      0621 01820000
         LA    @07,FIELDLST                                        0621 01821000
         ST    @07,@AL00001+12                                     0621 01822000
         LA    @07,ONUM                                            0621 01823000
         ST    @07,@AL00001+16                                     0621 01824000
         LA    @07,PTRCPL+16                                       0621 01825000
         ST    @07,@AL00001+20                                     0621 01826000
         LA    @01,@AL00001                                        0621 01827000
         BAL   @14,LOCPROC                                         0621 01828000
*                      RESPECIFY RTNREG RSTD;                      0622 01829000
*                      TESTRC = RTNREG;                            0623 01830000
         LR    TESTRC,RTNREG                                       0623 01831000
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/ 01832000
*                                                                  0624 01833000
*                      IF TESTRC ^= 0                      /*@Y30SSFR*/ 01834000
*                        THEN                              /*@Y30SSFR*/ 01835000
         LTR   TESTRC,TESTRC                                       0625 01836000
         BZ    @RF00625                                            0625 01837000
*                          RETURN CODE(LASTCC04);          /*@Y30SSFR*/ 01838000
*                                                                  0626 01839000
         LA    @15,4                                               0626 01840000
         L     @14,@SA00002                                        0626 01841000
         LM    @00,@05,@SA00002+8                                  0626 01842000
         LM    @07,@12,@SA00002+32                                 0626 01843000
         BR    @14                                                 0626 01844000
*                      /**********************************************/ 01845000
*                      /*                                    @Y30SSFR*/ 01846000
*                      /*  SAVE THE CPL AND FPL'S JUST       @Y30SSFR*/ 01847000
*                      /*  CONSTRUCTED FOR USE WITH OTHER    @Y30SSFR*/ 01848000
*                      /*  PATHS.                            @Y30SSFR*/ 01849000
*                      /*                                    @Y30SSFR*/ 01850000
*                      /**********************************************/ 01851000
*                                                                  0627 01852000
*                      SAPLLEN = LENGTH(SAVEPL);           /*@Y30SSFR*/ 01853000
*                                                                  0627 01854000
@RF00625 MVC   SAPLLEN(2),@CH01341                                 0627 01855000
*                      CALL MVDAPROC(SAPLLEN,PTRCPL(PTHCPLNO),     0628 01856000
*                        ADDR(SAVEPL),NULLPARM);           /*@Y30SSFR*/ 01857000
*                                                                  0628 01858000
         LA    @07,SAPLLEN                                         0628 01859000
         ST    @07,@AL00001                                        0628 01860000
         LA    @07,PTRCPL+16                                       0628 01861000
         ST    @07,@AL00001+4                                      0628 01862000
         LA    @07,SAVEPL                                          0628 01863000
         ST    @07,@AFTEMPS                                        0628 01864000
         LA    @07,@AFTEMPS                                        0628 01865000
         ST    @07,@AL00001+8                                      0628 01866000
         LA    @07,NULLPARM                                        0628 01867000
         ST    @07,@AL00001+12                                     0628 01868000
         LA    @01,@AL00001                                        0628 01869000
         BAL   @14,MVDAPROC                                        0628 01870000
*                      /**********************************************/ 01871000
*                      /*                                    @Y30SSFR*/ 01872000
*                      /*  CALL CTLGPROC TO ISSUE A UCATLG   @Y30SSFR*/ 01873000
*                      /*  TO DO THE ACTUAL LOCATE.          @Y30SSFR*/ 01874000
*                      /*                                    @Y30SSFR*/ 01875000
*                      /**********************************************/ 01876000
*                                                                  0629 01877000
*                      CALL CTLGPROC(PTRCPL(PTHCPLNO));    /*@Y30SSFR*/ 01878000
*                                                                  0629 01879000
         LA    @07,PTRCPL+16                                       0629 01880000
         ST    @07,@AL00001                                        0629 01881000
         LA    @01,@AL00001                                        0629 01882000
         BAL   @14,CTLGPROC                                        0629 01883000
*                      RESPECIFY RTNREG RSTD;                      0630 01884000
*                      TESTRC = RTNREG;                            0631 01885000
         LR    TESTRC,RTNREG                                       0631 01886000
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/ 01887000
*                                                                  0632 01888000
*                      IF TESTRC ^= 0                              0633 01889000
*                        THEN                                      0633 01890000
         LTR   TESTRC,TESTRC                                       0633 01891000
         BZ    @RF00633                                            0633 01892000
*                          RETURN CODE(LASTCC12);          /*@Y30SSFR*/ 01893000
*                                                                  0634 01894000
         LA    @15,12                                              0634 01895000
         L     @14,@SA00002                                        0634 01896000
         LM    @00,@05,@SA00002+8                                  0634 01897000
         LM    @07,@12,@SA00002+32                                 0634 01898000
         BR    @14                                                 0634 01899000
*                      /**********************************************/ 01900000
*                      /*                                    @Y30SSFR*/ 01901000
*                      /*  CALL CONTRBL TO BUILD THE CONTROL @Y30SSFR*/ 01902000
*                      /*  RECORD FOR THE CURRENT PATH AND   @Y30SSFR*/ 01903000
*                      /*  TO WRITE IT AND THE CATALOG WORK  @Y30SSFR*/ 01904000
*                      /*  AREA OUT THE PORTABILITY DATA SET @Y30SSFR*/ 01905000
*                      /*                                    @Y30SSFR*/ 01906000
*                      /**********************************************/ 01907000
*                                                                  0635 01908000
*                      CALL CONTRBL(PTHCPLNO,CTGTPTH);     /*@Y30SSFR*/ 01909000
*                                                                  0635 01910000
@RF00633 LA    @01,@AL00635                                        0635 01911000
         BAL   @14,CONTRBL                                         0635 01912000
*                      RESPECIFY RTNREG RSTD;                      0636 01913000
*                      TESTRC = RTNREG;                            0637 01914000
         LR    TESTRC,RTNREG                                       0637 01915000
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/ 01916000
*                                                                  0638 01917000
*                      IF TESTRC ^= 0                              0639 01918000
*                        THEN                                      0639 01919000
         LTR   TESTRC,TESTRC                                       0639 01920000
         BZ    @RF00639                                            0639 01921000
*                          RETURN CODE(LASTCC12);          /*@Y30SSFR*/ 01922000
*                                                                  0640 01923000
         LA    @15,12                                              0640 01924000
         L     @14,@SA00002                                        0640 01925000
         LM    @00,@05,@SA00002+8                                  0640 01926000
         LM    @07,@12,@SA00002+32                                 0640 01927000
         BR    @14                                                 0640 01928000
*                      END FIRPATH;                        /*@Y30SSFR*/ 01929000
*                                                                  0641 01930000
*                    ELSE                                          0642 01931000
*                                                                  0642 01932000
*                      /**********************************************/ 01933000
*                      /*                                    @Y30SSFR*/ 01934000
*                      /*  THIS IS NOT THE FIRST PATH TO BE  @Y30SSFR*/ 01935000
*                      /*  PROCESSED.  RESTORE THE CPL AND   @Y30SSFR*/ 01936000
*                      /*  FPL'S, MODIFY THE CPL TO DO A     @Y30SSFR*/ 01937000
*                      /*  LOCATE ON THE APPROPRIATE PATH    @Y30SSFR*/ 01938000
*                      /*  AND CALL CATALOG.                 @Y30SSFR*/ 01939000
*                      /*                                    @Y30SSFR*/ 01940000
*                      /**********************************************/ 01941000
*                                                                  0642 01942000
*NFIRPATH:             DO;                                 /*@Y30SSFR*/ 01943000
         B     @RC00618                                            0642 01944000
@RF00618 DS    0H                                                  0642 01945000
NFIRPATH DS    0H                                                  0643 01946000
*                      CTGPLPTR = PTRCPL(PTHCPLNO);        /*@Y30SSFR*/ 01947000
         L     @07,PTRCPL+16                                       0643 01948000
         ST    @07,CTGPLPTR                                        0643 01949000
*                      CALL MVDAPROC(SAPLLEN,ADDR(SAVEPL),         0644 01950000
*                        PTRCPL(PTHCPLNO),NULLPARM);       /*@Y30SSFR*/ 01951000
*                                                                  0644 01952000
         LA    @07,SAPLLEN                                         0644 01953000
         ST    @07,@AL00001                                        0644 01954000
         LA    @07,SAVEPL                                          0644 01955000
         ST    @07,@AFTEMPS                                        0644 01956000
         LA    @07,@AFTEMPS                                        0644 01957000
         ST    @07,@AL00001+4                                      0644 01958000
         LA    @07,PTRCPL+16                                       0644 01959000
         ST    @07,@AL00001+8                                      0644 01960000
         LA    @07,NULLPARM                                        0644 01961000
         ST    @07,@AL00001+12                                     0644 01962000
         LA    @01,@AL00001                                        0644 01963000
         BAL   @14,MVDAPROC                                        0644 01964000
*                      CALL MVDAPROC(WKAREALN+LENGTH(PATHREL),     0645 01965000
*                        NULLPARM,CTGWKA,SETZERO);         /*@Y30SSFR*/ 01966000
         MVC   @AL00001(16),@AL00645                               0645 01967000
         L     @07,CTGPLPTR                                        0645 01968000
         LA    @07,CTGWKA(,@07)                                    0645 01969000
         ST    @07,@AL00001+8                                      0645 01970000
         LA    @01,@AL00001                                        0645 01971000
         BAL   @14,MVDAPROC                                        0645 01972000
*                      AREALN = WKAREALN;                  /*@Y30SSFR*/ 01973000
         L     @07,CTGPLPTR                                        0646 01974000
         L     @02,CTGWKA(,@07)                                    0646 01975000
         MVC   AREALN(2,@02),@CH00894                              0646 01976000
*                      CTGENT = ADDR(FNAME);               /*@Y30SSFR*/ 01977000
*                                                                  0647 01978000
         LA    @02,FNAME(,FNMPTR)                                  0647 01979000
         ST    @02,CTGENT(,@07)                                    0647 01980000
*                      /**********************************************/ 01981000
*                      /*                                    @Y30SSFR*/ 01982000
*                      /*  CLEAR THE FPL POINTERS SET BY     @Y30SSFR*/ 01983000
*                      /*  THE PREVIOUS LOCATE.              @Y30SSFR*/ 01984000
*                      /*                                    @Y30SSFR*/ 01985000
*                      /**********************************************/ 01986000
*                                                                  0648 01987000
*                      DO CLRFDCTR = 1 TO ONUM;            /*@Y30SSFR*/ 01988000
         LA    CLRFDCTR,1                                          0648 01989000
         B     @DE00648                                            0648 01990000
@DL00648 DS    0H                                                  0649 01991000
*                        CTGFLPTR = CTGFIELD(CLRFDCTR);    /*@Y30SSFR*/ 01992000
         LR    @07,CLRFDCTR                                        0649 01993000
         SLA   @07,2                                               0649 01994000
         L     @01,CTGPLPTR                                        0649 01995000
         L     CTGFLPTR,CTGFIELD-4(@07,@01)                        0649 01996000
*                        CTGFLNG(1) = 0;                   /*@Y30SSFR*/ 01997000
         SLR   @07,@07                                             0650 01998000
         ST    @07,CTGFLNG(,CTGFLPTR)                              0650 01999000
*                        CTGFLPT(1) = NULLPTR;             /*@Y30SSFR*/ 02000000
         ST    @07,CTGFLPT(,CTGFLPTR)                              0651 02001000
*                      END;                                /*@Y30SSFR*/ 02002000
*                                                                  0652 02003000
         AL    CLRFDCTR,@CF00220                                   0652 02004000
@DE00648 SLR   @07,@07                                             0652 02005000
         IC    @07,ONUM                                            0652 02006000
         CR    CLRFDCTR,@07                                        0652 02007000
         BNH   @DL00648                                            0652 02008000
*                      /**********************************************/ 02009000
*                      /*                                    @Y30SSFR*/ 02010000
*                      /*  CALL CTLGPROC TO ISSUE A UCATLG   @Y30SSFR*/ 02011000
*                      /*  TO DO THE ACTUAL LOCATE.          @Y30SSFR*/ 02012000
*                      /*                                    @Y30SSFR*/ 02013000
*                      /**********************************************/ 02014000
*                                                                  0653 02015000
*                      CALL CTLGPROC(PTRCPL(PTHCPLNO));    /*@Y30SSFR*/ 02016000
*                                                                  0653 02017000
         LA    @07,PTRCPL+16                                       0653 02018000
         ST    @07,@AL00001                                        0653 02019000
         LA    @01,@AL00001                                        0653 02020000
         BAL   @14,CTLGPROC                                        0653 02021000
*                      RESPECIFY RTNREG RSTD;                      0654 02022000
*                      TESTRC = RTNREG;                            0655 02023000
         LR    TESTRC,RTNREG                                       0655 02024000
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/ 02025000
*                                                                  0656 02026000
*                      IF TESTRC ^= 0                      /*@Y30SSFR*/ 02027000
*                        THEN                              /*@Y30SSFR*/ 02028000
         LTR   TESTRC,TESTRC                                       0657 02029000
         BZ    @RF00657                                            0657 02030000
*                          RETURN CODE(LASTCC12);          /*@Y30SSFR*/ 02031000
*                                                                  0658 02032000
         LA    @15,12                                              0658 02033000
         L     @14,@SA00002                                        0658 02034000
         LM    @00,@05,@SA00002+8                                  0658 02035000
         LM    @07,@12,@SA00002+32                                 0658 02036000
         BR    @14                                                 0658 02037000
*                      /**********************************************/ 02038000
*                      /*                                    @Y30SSFR*/ 02039000
*                      /*  CALL CONTRBL TO BUILD THE CONTROL @Y30SSFR*/ 02040000
*                      /*  RECORD FOR THE CURRENT PATH AND   @Y30SSFR*/ 02041000
*                      /*  TO WRITE IT AND THE CATALOG WORK  @Y30SSFR*/ 02042000
*                      /*  AREA OUT THE PORTABILITY DATA SET @Y30SSFR*/ 02043000
*                      /*                                    @Y30SSFR*/ 02044000
*                      /**********************************************/ 02045000
*                                                                  0659 02046000
*                      CALL CONTRBL(PTHCPLNO,CTGTPTH);     /*@Y30SSFR*/ 02047000
*                                                                  0659 02048000
@RF00657 LA    @01,@AL00659                                        0659 02049000
         BAL   @14,CONTRBL                                         0659 02050000
*                      RESPECIFY RTNREG RSTD;                      0660 02051000
*                      TESTRC = RTNREG;                            0661 02052000
         LR    TESTRC,RTNREG                                       0661 02053000
*                      RESPECIFY RTNREG UNRSTD;            /*@Y30SSFR*/ 02054000
*                      IF TESTRC ^= 0                      /*@Y30SSFR*/ 02055000
*                        THEN                              /*@Y30SSFR*/ 02056000
         LTR   TESTRC,TESTRC                                       0663 02057000
         BZ    @RF00663                                            0663 02058000
*                          RETURN CODE(LASTCC12);          /*@Y30SSFR*/ 02059000
*                                                                  0664 02060000
         LA    @15,12                                              0664 02061000
         L     @14,@SA00002                                        0664 02062000
         LM    @00,@05,@SA00002+8                                  0664 02063000
         LM    @07,@12,@SA00002+32                                 0664 02064000
         BR    @14                                                 0664 02065000
*                      END NFIRPATH;                       /*@Y30SSFR*/ 02066000
*                                                                  0665 02067000
*                ELSE ;                                    /*@Y30SSFR*/ 02068000
*                                                                  0666 02069000
@RF00617 DS    0H                                                  0667 02070000
*            END PATHREC;                                  /*@Y30SSFR*/ 02071000
*                                                                  0667 02072000
@RC00617 AL    I,@CF00220                                          0667 02073000
@DE00613 LA    @07,1                                               0667 02074000
         AH    @07,NUMASSOC                                        0667 02075000
         CR    I,@07                                               0667 02076000
         BNH   @DL00613                                            0667 02077000
*            END PTHDEF;                                   /*@Y30SSFR*/ 02078000
*                                                                  0668 02079000
*          ELSE  ;                                         /*@Y30SSFR*/ 02080000
@RF00610 DS    0H                                                  0670 02081000
*        /************************************************************/ 02082000
*        /*                                                          */ 02083000
*        /*  CALL RECPROC TO COPY THE CLUSTER DATA SET TO THE        */ 02084000
*        /*  PORTABILITY DATA SET, RECORD BY RECORD                  */ 02085000
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */ 02086000
*        /*  CALLING PROCESSOR.                                      */ 02087000
*        /*                                                          */ 02088000
*        /************************************************************/ 02089000
*                                                                  0670 02090000
*        CALL RECPROC;                                             0670 02091000
*                                                                  0670 02092000
         BAL   @14,RECPROC                                         0670 02093000
*        RESPECIFY RTNREG RSTD;                                    0671 02094000
*        TESTRC = RTNREG;                                          0672 02095000
         LR    TESTRC,RTNREG                                       0672 02096000
*        RESPECIFY RTNREG UNRSTD;                                  0673 02097000
*        IF TESTRC ^= 0                                            0674 02098000
*          THEN                                                    0674 02099000
         LTR   TESTRC,TESTRC                                       0674 02100000
         BZ    @RF00674                                            0674 02101000
*            RETURN CODE(LASTCC12);                                0675 02102000
*                                                                  0675 02103000
         LA    @15,12                                              0675 02104000
         L     @14,@SA00002                                        0675 02105000
         LM    @00,@05,@SA00002+8                                  0675 02106000
         LM    @07,@12,@SA00002+32                                 0675 02107000
         BR    @14                                                 0675 02108000
*        /************************************************************/ 02109000
*        /*                                                          */ 02110000
*        /*  CLOSE OUTPUT DATA SET- PORTABILITY DATA SET             */ 02111000
*        /*                                                          */ 02112000
*        /************************************************************/ 02113000
*                                                                  0676 02114000
*        CALL IDCIOCL0 (GDTTBL,POUTIOCS);                          0676 02115000
*                                                                  0676 02116000
@RF00674 L     @07,@PC00001                                        0676 02117000
         ST    @07,@AL00001                                        0676 02118000
         LA    @04,POUTIOCS                                        0676 02119000
         ST    @04,@AL00001+4                                      0676 02120000
         MVI   @AL00001+4,X'80'                                    0676 02121000
         L     @15,GDTCLS(,@07)                                    0676 02122000
         LA    @01,@AL00001                                        0676 02123000
         BALR  @14,@15                                             0676 02124000
*        RESPECIFY RTNREG RSTD;                                    0677 02125000
*        TESTRC = RTNREG;                                          0678 02126000
         LR    TESTRC,RTNREG                                       0678 02127000
*        RESPECIFY RTNREG UNRSTD;                                  0679 02128000
*        POUTIOCS = NULLPTR;                                       0680 02129000
         SLR   @07,@07                                             0680 02130000
         ST    @07,POUTIOCS                                        0680 02131000
*        IF TESTRC ^= 0                                            0681 02132000
*          THEN                                                    0681 02133000
*                                                                  0681 02134000
         CR    TESTRC,@07                                          0681 02135000
         BE    @RF00681                                            0681 02136000
*            /********************************************************/ 02137000
*            /*                                                      */ 02138000
*            /*  IF CLOSE FAILED, SET RETURN CODE TO INDICATE        */ 02139000
*            /*  FAILURE AND RETURN TO MAIN LINE OF CODE             */ 02140000
*            /*                                                      */ 02141000
*            /********************************************************/ 02142000
*                                                                  0682 02143000
*            RETURN CODE(LASTCC12);                                0682 02144000
*                                                                  0682 02145000
         LA    @15,12                                              0682 02146000
         L     @14,@SA00002                                        0682 02147000
         LM    @00,@05,@SA00002+8                                  0682 02148000
         LM    @07,@12,@SA00002+32                                 0682 02149000
         BR    @14                                                 0682 02150000
*        /************************************************************/ 02151000
*        /*                                                          */ 02152000
*        /*  ISSUE MESSAGE - PORTABLE DATA SET CREATED SUCCESSFULLY. */ 02153000
*        /*                                                          */ 02154000
*        /************************************************************/ 02155000
*                                                                  0683 02156000
*        DARGCNT = 2;                                              0683 02157000
@RF00681 LA    @07,2                                               0683 02158000
         L     @04,DDSTRU                                          0683 02159000
         STH   @07,DARGCNT(,@04)                                   0683 02160000
*        DARGINS(1) = 1;                                           0684 02161000
         MVC   DARGINS(2,@04),@CH00220                             0684 02162000
*        DARGINL(1) = LENGTH(PORTDATE);                            0685 02163000
         LA    @15,8                                               0685 02164000
         STH   @15,DARGINL(,@04)                                   0685 02165000
*        DARGDTM(1) = ADDR(PORTDATE);                              0686 02166000
         LA    @14,PORTDATE                                        0686 02167000
         ST    @14,DARGDTM(,@04)                                   0686 02168000
*        DARGINS(2) = 2;                                           0687 02169000
         STH   @07,DARGINS+8(,@04)                                 0687 02170000
*        DARGINL(2) = LENGTH(PORTTIME);                            0688 02171000
         STH   @15,DARGINL+8(,@04)                                 0688 02172000
*        DARGDTM(2) = ADDR(PORTTIME);                              0689 02173000
         LA    @07,PORTTIME                                        0689 02174000
         ST    @07,DARGDTM+8(,@04)                                 0689 02175000
*        DARGSENT = GOODPORT;                                      0690 02176000
*                                                                  0690 02177000
         MVI   DARGSENT(@04),X'05'                                 0690 02178000
*        CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                    0691 02179000
*                                                                  0691 02180000
         L     @07,@PC00001                                        0691 02181000
         ST    @07,@AL00001                                        0691 02182000
         LA    @04,@CF00116                                        0691 02183000
         ST    @04,@AL00001+4                                      0691 02184000
         LA    @04,DDSTRU                                          0691 02185000
         ST    @04,@AL00001+8                                      0691 02186000
         MVI   @AL00001+8,X'80'                                    0691 02187000
         L     @15,GDTPRT(,@07)                                    0691 02188000
         LA    @01,@AL00001                                        0691 02189000
         BALR  @14,@15                                             0691 02190000
*        DARGLIST = ''B;                                           0692 02191000
         L     @07,DDSTRU                                          0692 02192000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0692 02193000
*        DARGSMOD = EXPMSG;                                        0693 02194000
*                                                                  0693 02195000
         MVC   DARGSMOD(3,@07),@CC00914                            0693 02196000
*        /************************************************************/ 02197000
*        /*                                                          */ 02198000
*        /*  IF PASSWORDS HAVE BEEN SUPPRESSED BY LOCATE, ISSUE      */ 02199000
*        /*  MESSAGE TO USER                                         */ 02200000
*        /*                                                          */ 02201000
*        /************************************************************/ 02202000
*                                                                  0694 02203000
*        IF SUPPRESS = ON                                          0694 02204000
*          THEN                                                    0694 02205000
         TM    SUPPRESS,B'10000000'                                0694 02206000
         BNO   @RF00694                                            0694 02207000
*            DO;                                                   0695 02208000
*            DARGSENT = PASSUPRS;                                  0696 02209000
*                                                                  0696 02210000
         MVI   DARGSENT(@07),X'06'                                 0696 02211000
*            CALL AMSTP011 (GDTTBL,PRTFILE,DDSTRU);                0697 02212000
*                                                                  0697 02213000
         L     @07,@PC00001                                        0697 02214000
         ST    @07,@AL00001                                        0697 02215000
         LA    @04,@CF00116                                        0697 02216000
         ST    @04,@AL00001+4                                      0697 02217000
         LA    @04,DDSTRU                                          0697 02218000
         ST    @04,@AL00001+8                                      0697 02219000
         MVI   @AL00001+8,X'80'                                    0697 02220000
         L     @15,GDTPRT(,@07)                                    0697 02221000
         LA    @01,@AL00001                                        0697 02222000
         BALR  @14,@15                                             0697 02223000
*            DARGLIST = ''B;                                       0698 02224000
         L     @07,DDSTRU                                          0698 02225000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      0698 02226000
*            DARGSMOD = EXPMSG;                                    0699 02227000
         MVC   DARGSMOD(3,@07),@CC00914                            0699 02228000
*            END;                                                  0700 02229000
*                                                                  0700 02230000
*                                                                  0701 02231000
*        /************************************************************/ 02232000
*        /*                                                          */ 02233000
*        /*  PROCESS DISPOSITION OPTIONS - PERMANENT OR TEMPORARY    */ 02234000
*        /*  EXPORT.  FOR PERMANENT ISSUE A CATALOG DELETE ON CLUSTER*/ 02235000
*        /*  NAME.  FOR TEMPORARY ISSUE A CATALOG ALTER              */ 02236000
*        /*                                                          */ 02237000
*        /************************************************************/ 02238000
*                                                                  0701 02239000
*         IF ADDR(PERM) ^= NULLPTR                                 0701 02240000
*          THEN                                                    0701 02241000
@RF00694 L     @07,@PC00001+4                                      0701 02242000
         L     @07,FDTPTR+24(,@07)                                 0701 02243000
         LTR   @07,@07                                             0701 02244000
         BZ    @RF00701                                            0701 02245000
*PERMP:      DO;                                                   0702 02246000
PERMP    DS    0H                                                  0703 02247000
*            OLDERID2 = NEWERID2;                                  0703 02248000
         L     @07,@PC00001                                        0703 02249000
         L     @07,GDTTR2(,@07)                                    0703 02250000
         MVC   @TS00001(95),NEWERID2(@07)                          0703 02251000
         MVC   OLDERID2(95,@07),@TS00001                           0703 02252000
*            NEWID2 = 'XPPM';                                      0704 02253000
*                                                                  0704 02254000
         MVC   NEWID2(4,@07),@CC01172                              0704 02255000
*            /********************************************************/ 02256000
*            /*                                                      */ 02257000
*            /*  PROCESS PERMANENT OPTION BY DELETING CLUSTER NAME   */ 02258000
*            /*  IF THE DELETE IS NOT COMPLETED SUCCESSFULLY,        */ 02259000
*            /*  RETURN TO THE CALLING PROCESSOR                     */ 02260000
*            /*                                                      */ 02261000
*            /********************************************************/ 02262000
*                                                                  0705 02263000
*            IF AIXFLAG = ON                               /*@Y30SSFR*/ 02264000
*              THEN                                        /*@Y30SSFR*/ 02265000
         TM    AIXFLAG,B'10000000'                                 0705 02266000
         BNO   @RF00705                                            0705 02267000
*                CALL DELTPROC(CTGTAIX,ADDR(ENTVAL),       /*@Y30SSFR*/ 02268000
*                  DCPLPTR);                               /*@Y30SSFR*/ 02269000
         LA    @07,@CC00738                                        0706 02270000
         ST    @07,@AL00001                                        0706 02271000
         L     @07,@PC00001+4                                      0706 02272000
         L     @07,FDTPTR(,@07)                                    0706 02273000
         LA    @07,ENTVAL(,@07)                                    0706 02274000
         ST    @07,@AFTEMPS                                        0706 02275000
         LA    @07,@AFTEMPS                                        0706 02276000
         ST    @07,@AL00001+4                                      0706 02277000
         LA    @07,DCPLPTR                                         0706 02278000
         ST    @07,@AL00001+8                                      0706 02279000
         LA    @01,@AL00001                                        0706 02280000
         BAL   @14,DELTPROC                                        0706 02281000
*              ELSE                                        /*@Y30SSFR*/ 02282000
*                CALL DELTPROC(CTGTCL,ADDR(ENTVAL),        /*@Y30SSFR*/ 02283000
*                  DCPLPTR);                               /*@Y30SSFR*/ 02284000
         B     @RC00705                                            0707 02285000
@RF00705 LA    @07,@CC00736                                        0707 02286000
         ST    @07,@AL00001                                        0707 02287000
         L     @07,@PC00001+4                                      0707 02288000
         L     @07,FDTPTR(,@07)                                    0707 02289000
         LA    @07,ENTVAL(,@07)                                    0707 02290000
         ST    @07,@AFTEMPS                                        0707 02291000
         LA    @07,@AFTEMPS                                        0707 02292000
         ST    @07,@AL00001+4                                      0707 02293000
         LA    @07,DCPLPTR                                         0707 02294000
         ST    @07,@AL00001+8                                      0707 02295000
         LA    @01,@AL00001                                        0707 02296000
         BAL   @14,DELTPROC                                        0707 02297000
*            RESPECIFY RTNREG RSTD;                                0708 02298000
@RC00705 DS    0H                                                  0709 02299000
*            TESTRC = RTNREG;                                      0709 02300000
         LR    TESTRC,RTNREG                                       0709 02301000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 02302000
*            IF TESTRC ^= 0                                        0711 02303000
*              THEN                                                0711 02304000
         LTR   TESTRC,TESTRC                                       0711 02305000
         BZ    @RF00711                                            0711 02306000
*                RETURN CODE(TESTRC);                      /*@Y30SSFR*/ 02307000
         LR    @15,TESTRC                                          0712 02308000
         L     @14,@SA00002                                        0712 02309000
         LM    @00,@05,@SA00002+8                                  0712 02310000
         LM    @07,@12,@SA00002+32                                 0712 02311000
         BR    @14                                                 0712 02312000
*            END PERMP;                                            0713 02313000
*                                                                  0713 02314000
*          ELSE                                                    0714 02315000
*                                                                  0714 02316000
*            /********************************************************/ 02317000
*            /*                                                      */ 02318000
*            /*  TEMPORARY WAS INDICATED IN AMS COMMAND              */ 02319000
*            /*  MODIFY DSATTR FIELDS IN CATALOG TO INDICATE         */ 02320000
*            /*  TEMPORARY EXPORT (OPTIONALLY INHIBIT UPDATE).       */ 02321000
*            /*                                                      */ 02322000
*            /********************************************************/ 02323000
*                                                                  0714 02324000
*TEMPLP:     DO INDX = 2 TO NUMCPL;                        /*@Y30SSFR*/ 02325000
         B     @RC00701                                            0714 02326000
@RF00701 DS    0H                                                  0714 02327000
TEMPLP   LA    INDX,2                                              0714 02328000
         B     @DE00714                                            0714 02329000
@DL00714 DS    0H                                                  0715 02330000
*              CTGPLPTR = PTRCPL(INDX);                            0715 02331000
         LR    @07,INDX                                            0715 02332000
         SLA   @07,2                                               0715 02333000
         L     @07,PTRCPL-4(@07)                                   0715 02334000
         ST    @07,CTGPLPTR                                        0715 02335000
*              CTGFLPTR = CTGFIELD(IDSATTR);                       0716 02336000
         L     CTGFLPTR,CTGFIELD+8(,@07)                           0716 02337000
*              IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR          0717 02338000
*                THEN                                              0717 02339000
         SLR   @07,@07                                             0717 02340000
         C     @07,CTGFLNG(,CTGFLPTR)                              0717 02341000
         BE    @RF00717                                            0717 02342000
         L     @03,CTGFLPT(,CTGFLPTR)                              0717 02343000
         CR    @03,@07                                             0717 02344000
         BE    @RF00717                                            0717 02345000
*                  DO;                                             0718 02346000
*                                                                  0718 02347000
*                  /**************************************************/ 02348000
*                  /*                                                */ 02349000
*                  /*  A DSATTR CATALOG FIELD EXISTS FOR THIS OBJECT */ 02350000
*                  /*  SET THE APPROPRIATE FLAGS IN THE DSATTR FIELD */ 02351000
*                  /*                                                */ 02352000
*                  /**************************************************/ 02353000
*                                                                  0719 02354000
*                  IF FDSATTR ^= NOTINIT(1:2)              /*@Y30SSFR*/ 02355000
*                    THEN                                          0719 02356000
         CLC   FDSATTR(2,@03),NOTINIT                              0719 02357000
         BE    @RF00719                                            0719 02358000
*                      DO;                                         0720 02359000
*                        FDSTMPEX = ON;                            0721 02360000
         OI    FDSTMPEX(@03),B'00000010'                           0721 02361000
*                        IF ADDR(INHBS) ^= NULLPTR                 0722 02362000
*                          THEN                                    0722 02363000
         L     @15,@PC00001+4                                      0722 02364000
         C     @07,FDTPTR+28(,@15)                                 0722 02365000
         BE    @RF00722                                            0722 02366000
*                            FDSINHUP = ON;                        0723 02367000
*                                                                  0723 02368000
         OI    FDSINHUP(@03),B'00000100'                           0723 02369000
*                  /**************************************************/ 02370000
*                  /*                                                */ 02371000
*                  /*  CALL ALTERPROC TO MODIFY THE CPL FOR AN ALTER */ 02372000
*                  /*  THEN CALL CTLGPROC TO CALL CATALOG MANAGEMENT */ 02373000
*                  /* IF ALTERPROC FAILS TO MODIFY THE CPL OR IF     */ 02374000
*                  /*  CTLGPROC FAILS TO PERFORM THE ALTER -TERMINATE*/ 02375000
*                  /*                                                */ 02376000
*                  /**************************************************/ 02377000
*                                                                  0724 02378000
*                  OLDERID2 = NEWERID2;                            0724 02379000
@RF00722 L     @07,@PC00001                                        0724 02380000
         L     @07,GDTTR2(,@07)                                    0724 02381000
         MVC   @TS00001(95),NEWERID2(@07)                          0724 02382000
         MVC   OLDERID2(95,@07),@TS00001                           0724 02383000
*                  NEWID2 = 'XPTM';                                0725 02384000
         MVC   NEWID2(4,@07),@CC01176                              0725 02385000
*                  CALL ALTRPROC(PTRCPL(INDX));                    0726 02386000
*                                                                  0726 02387000
         LR    @07,INDX                                            0726 02388000
         SLA   @07,2                                               0726 02389000
         LA    @07,PTRCPL-4(@07)                                   0726 02390000
         ST    @07,@AL00001                                        0726 02391000
         LA    @01,@AL00001                                        0726 02392000
         BAL   @14,ALTRPROC                                        0726 02393000
*                  RESPECIFY RTNREG RSTD;                          0727 02394000
*                  TESTRC = RTNREG;                                0728 02395000
         LR    TESTRC,RTNREG                                       0728 02396000
*                  RESPECIFY RTNREG UNRSTD;                        0729 02397000
*                  IF TESTRC ^= 0                                  0730 02398000
*                    THEN                                          0730 02399000
         LTR   TESTRC,TESTRC                                       0730 02400000
         BZ    @RF00730                                            0730 02401000
*                      RETURN CODE(LASTCC08);                      0731 02402000
*                                                                  0731 02403000
         LA    @15,8                                               0731 02404000
         L     @14,@SA00002                                        0731 02405000
         LM    @00,@05,@SA00002+8                                  0731 02406000
         LM    @07,@12,@SA00002+32                                 0731 02407000
         BR    @14                                                 0731 02408000
*                  CALL CTLGPROC(PTRCPL(INDX));                    0732 02409000
*                                                                  0732 02410000
@RF00730 LR    @07,INDX                                            0732 02411000
         SLA   @07,2                                               0732 02412000
         LA    @07,PTRCPL-4(@07)                                   0732 02413000
         ST    @07,@AL00001                                        0732 02414000
         LA    @01,@AL00001                                        0732 02415000
         BAL   @14,CTLGPROC                                        0732 02416000
*                  RESPECIFY RTNREG RSTD;                          0733 02417000
*                  TESTRC = RTNREG;                                0734 02418000
         LR    TESTRC,RTNREG                                       0734 02419000
*                  RESPECIFY RTNREG UNRSTD;                        0735 02420000
*                  IF TESTRC ^= 0                                  0736 02421000
*                    THEN                                          0736 02422000
         LTR   TESTRC,TESTRC                                       0736 02423000
         BZ    @RF00736                                            0736 02424000
*                      RETURN CODE(LASTCC08);                      0737 02425000
         LA    @15,8                                               0737 02426000
         L     @14,@SA00002                                        0737 02427000
         LM    @00,@05,@SA00002+8                                  0737 02428000
         LM    @07,@12,@SA00002+32                                 0737 02429000
         BR    @14                                                 0737 02430000
*                  END;                                            0738 02431000
@RF00736 DS    0H                                                  0739 02432000
*             END;                                                 0739 02433000
*                                                                  0739 02434000
@RF00719 DS    0H                                                  0740 02435000
*             END TEMPLP;                                          0740 02436000
*                                                                  0740 02437000
@RF00717 AL    INDX,@CF00220                                       0740 02438000
@DE00714 CR    INDX,NUMCPL                                         0740 02439000
         BNH   @DL00714                                            0740 02440000
*        /************************************************************/ 02441000
*        /*                                                          */ 02442000
*        /*  RETURN TO MAIN PROCEDURE WITH SUCCESS INDICATED         */ 02443000
*        /*                                                          */ 02444000
*        /************************************************************/ 02445000
*                                                                  0741 02446000
*        RETURN CODE(0);                                           0741 02447000
*                                                                  0741 02448000
@RC00701 SLR   @15,@15                                             0741 02449000
         L     @14,@SA00002                                        0741 02450000
         LM    @00,@05,@SA00002+8                                  0741 02451000
         LM    @07,@12,@SA00002+32                                 0741 02452000
         BR    @14                                                 0741 02453000
*END CLUSPROC;                                                     0742 02454000
*        /************************************************************/ 02455000
*        /*                                                          */ 02456000
*        /*  PROCEDURE NAME - DSCTPROC                       @Y30SSFR*/ 02457000
*        /*                                                          */ 02458000
*        /*  FUNCTION - PROCESS EXPORTING OF A USER CATALOG BY       */ 02459000
*        /*  DISCONNECTING THE USER CATALOG FROM THE MASTER CATALOG  */ 02460000
*        /*                                                          */ 02461000
*        /*  INPUT - FDT                                             */ 02462000
*        /*                                                          */ 02463000
*        /*  OUTPUT -  USER CATALOG WILL BE DISCONNECTED FROM MASTER */ 02464000
*        /*  CATALOG AND THE PHYSICAL VOLUME ON WHICH THE USER       */ 02465000
*        /*  RESIDES CAN THEN BE HAND CARRIED TO ANOTHER SYSTEM      */ 02466000
*        /*                                                          */ 02467000
*        /************************************************************/ 02468000
*                                                                  0743 02469000
*DSCTPROC: PROCEDURE;                                              0743 02470000
*                                                                  0743 02471000
DSCTPROC STM   @14,@05,@SA00003                                    0743 02472000
         STM   @07,@12,@SA00003+32                                 0743 02473000
*        /************************************************************/ 02474000
*        /*                                                          */ 02475000
*        /*  BUILD CPL REQUIRED FOR CATALOG DISCONNECT WHICH IS      */ 02476000
*        /*  A FORM OF DELETE                                        */ 02477000
*        /*  IF THE CPL IS NOT CONSTRUCTED SUCCESSFULLY, RETURN       * 02478000
*        /*  TO THE CALLING PROCESSOR WITH FAILURE INDICATED          * 02479000
*        /*                                                          */ 02480000
*        /************************************************************/ 02481000
*                                                                  0744 02482000
*        OLDERID2 = NEWERID2;                                      0744 02483000
         L     @07,@PC00001                                        0744 02484000
         L     @07,GDTTR2(,@07)                                    0744 02485000
         MVC   @TS00001(95),NEWERID2(@07)                          0744 02486000
         MVC   OLDERID2(95,@07),@TS00001                           0744 02487000
*        NEWID2 = 'XPUC';                                          0745 02488000
         MVC   NEWID2(4,@07),@CC01181                              0745 02489000
*        NUMOBJ = 1;                                       /*@Y30SSFR*/ 02490000
*                                                                  0746 02491000
         MVC   NUMOBJ(2),@CH00220                                  0746 02492000
*        CALL DELTPROC('U',ADDR(ENTVAL),DCPLPTR);          /*@Y30SSFR*/ 02493000
*                                                                  0747 02494000
         LA    @07,@CC00732                                        0747 02495000
         ST    @07,@AL00001                                        0747 02496000
         L     @07,@PC00001+4                                      0747 02497000
         L     @07,FDTPTR(,@07)                                    0747 02498000
         LA    @07,ENTVAL(,@07)                                    0747 02499000
         ST    @07,@AFTEMPS+8                                      0747 02500000
         LA    @07,@AFTEMPS+8                                      0747 02501000
         ST    @07,@AL00001+4                                      0747 02502000
         LA    @07,DCPLPTR                                         0747 02503000
         ST    @07,@AL00001+8                                      0747 02504000
         LA    @01,@AL00001                                        0747 02505000
         BAL   @14,DELTPROC                                        0747 02506000
*        RESPECIFY RTNREG RSTD;                                    0748 02507000
*        TESTRC = RTNREG;                                          0749 02508000
         LR    TESTRC,RTNREG                                       0749 02509000
*        RESPECIFY RTNREG UNRSTD;                                  0750 02510000
*        IF TESTRC ^= 0                                            0751 02511000
*          THEN                                                    0751 02512000
         LTR   TESTRC,TESTRC                                       0751 02513000
         BZ    @RF00751                                            0751 02514000
*            RETURN CODE(LASTCC12);                                0752 02515000
*                                                                  0752 02516000
         LA    @15,12                                              0752 02517000
         L     @14,@SA00003                                        0752 02518000
         LM    @00,@05,@SA00003+8                                  0752 02519000
         LM    @07,@12,@SA00003+32                                 0752 02520000
         BR    @14                                                 0752 02521000
*        /************************************************************/ 02522000
*        /*                                                          */ 02523000
*        /*  INVOKE  CATALOG MANAGEMENT SUPPORT                      */ 02524000
*        /*  IF THE DISCONNECT FAILS, RETURN TO THE CALLING PROCESSOR*/ 02525000
*        /*  WITH FAILURE INDICATED                                  */ 02526000
*        /*                                                          */ 02527000
*        /************************************************************/ 02528000
*                                                                  0753 02529000
*        CALL CTLGPROC(DCPLPTR);                                   0753 02530000
*                                                                  0753 02531000
@RF00751 LA    @07,DCPLPTR                                         0753 02532000
         ST    @07,@AL00001                                        0753 02533000
         LA    @01,@AL00001                                        0753 02534000
         BAL   @14,CTLGPROC                                        0753 02535000
*        RESPECIFY RTNREG RSTD;                                    0754 02536000
*        TESTRC = RTNREG;                                          0755 02537000
         LR    TESTRC,RTNREG                                       0755 02538000
*        RESPECIFY RTNREG UNRSTD;                                  0756 02539000
*        IF TESTRC ^= 0                                            0757 02540000
*          THEN                                                    0757 02541000
         LTR   TESTRC,TESTRC                                       0757 02542000
         BZ    @RF00757                                            0757 02543000
*            RETURN CODE(LASTCC12);                                0758 02544000
*                                                                  0758 02545000
*                                                                  0758 02546000
         LA    @15,12                                              0758 02547000
         L     @14,@SA00003                                        0758 02548000
         LM    @00,@05,@SA00003+8                                  0758 02549000
         LM    @07,@12,@SA00003+32                                 0758 02550000
         BR    @14                                                 0758 02551000
*        CTGPLPTR = DCPLPTR;                                       0759 02552000
*                                                                  0759 02553000
@RF00757 L     @07,DCPLPTR                                         0759 02554000
         ST    @07,CTGPLPTR                                        0759 02555000
*        /************************************************************/ 02556000
*        /*                                                          */ 02557000
*        /*  CONTROL IS RETURNED TO IDCXP01.                         */ 02558000
*        /*                                                          */ 02559000
*        /************************************************************/ 02560000
*                                                                  0760 02561000
*        RETURN CODE(0);                                           0760 02562000
*                                                                  0760 02563000
         SLR   @15,@15                                             0760 02564000
         L     @14,@SA00003                                        0760 02565000
         LM    @00,@05,@SA00003+8                                  0760 02566000
         LM    @07,@12,@SA00003+32                                 0760 02567000
         BR    @14                                                 0760 02568000
*END DSCTPROC;                                                     0761 02569000
*        /************************************************************/ 02570000
*        /*                                                          */ 02571000
*        /* PROCEDURE NAME - LOCPROC                                 */ 02572000
*        /*                                                          */ 02573000
*        /*  FUNCTION - BUILD A CPL AND A MULTITUDE OF FPL'S FOR     */ 02574000
*        /*  USE BY CATALOG LOCATE                                   */ 02575000
*        /*                                                          */ 02576000
*        /*  INPUT -                                                 */ 02577000
*        /*    . LNAME - 44-BYTE ENTRYNAME                           */ 02578000
*        /*    . LCINUM - CONTROL INTERVAL NUMBER (LOCATE BY         */ 02579000
*        /*      CONTROL INTERVAL)                                   */ 02580000
*        /*    . LCATACB - CATALOG ACB ADDRESS                       */ 02581000
*        /*    . LFLDLST - LIST OF CATALOG FIELD NAMES. AN FPL IS    */ 02582000
*        /*      CONSTRUCTED FOR EACH ONE.                           */ 02583000
*        /*    . LFLDNUM - NUMBER OF NAMES IN FIELD LIST             */ 02584000
*        /*    . LCPLPTR - RETURN CELL FOR CPL ADDRESS               */ 02585000
*        /*                                                          */ 02586000
*        /*  OUTPUT- CPL ADDRESS                                     */ 02587000
*        /*                                                          */ 02588000
*        /************************************************************/ 02589000
*                                                                  0762 02590000
*LOCPROC:  PROCEDURE(LNAME,            /*44-BYTE ENTRY NAME          */ 02591000
*                    LCINUM,           /*CONTROL INTERVAL NUMBER     */ 02592000
*                    LCATACB,          /*CATALOG ACB ADDRESS         */ 02593000
*                    LFLDLST,          /*LIST OF CATALOG FIELD NAMES */ 02594000
*                    LFLDNUM,          /*NUMBER OF FIELDS IN LIST    */ 02595000
*                    LCPLPTR);         /*RETURN CELL FOR CPL POINTER */ 02596000
*                                                                  0762 02597000
LOCPROC  STM   @14,@05,@SA00004                                    0762 02598000
         STM   @07,@12,@SA00004+32                                 0762 02599000
         MVC   @PC00004(24),0(@01)                                 0762 02600000
*        /************************************************************/ 02601000
*        /*                                                          */ 02602000
*        /*  ARGUMENTS OF INVOCATION                                 */ 02603000
*        /*                                                          */ 02604000
*        /************************************************************/ 02605000
*                                                                  0763 02606000
*        DCL                                                       0763 02607000
*          LNAME      PTR(31),                                     0763 02608000
*          LCINUM     FIXED(24),                                   0763 02609000
*          LCATACB    PTR(31),                                     0763 02610000
*          LFLDLST(*) CHAR(8),                                     0763 02611000
*          LFLDNUM    PTR(8),                                      0763 02612000
*          LCPLPTR    PTR(31);                                     0763 02613000
*                                                                  0763 02614000
*        /************************************************************/ 02615000
*        /*                                                          */ 02616000
*        /* LOCAL DECLARATIONS                                       */ 02617000
*        /*                                                          */ 02618000
*        /************************************************************/ 02619000
*                                                                  0764 02620000
*        DCL CITYPEXT CHAR(8) INIT('ITYPEXT ');                    0764 02621000
*        DCL SSFLAG   CHAR(1) INIT('80'X);                         0765 02622000
*                                                                  0765 02623000
*        /************************************************************/ 02624000
*        /*                                                          */ 02625000
*        /*  COMPUTE HOW MUCH CORE NECESSARY FOR ONE CPL AND THE     */ 02626000
*        /*  NUMBER OF FPL'S SPECIFIED BY FLDNUM, AND GET A CHUNK    */ 02627000
*        /*  OF CORE.  GET A SEPARATE CHUNK OF CORE FOR THE WORK AREA*/ 02628000
*        /*  IF CORE IS NOT OBTAINED, CONTROL IS RETURNED TO THE     */ 02629000
*        /*  CALLING PROCESSOR WITH FAILURE INDICATED                */ 02630000
*        /*                                                          */ 02631000
*        /************************************************************/ 02632000
*                                                                  0766 02633000
*        OLDERID2 = NEWERID2;                                      0766 02634000
         L     @07,@PC00001                                        0766 02635000
         L     @03,GDTTR2(,@07)                                    0766 02636000
         MVC   @TS00001(95),NEWERID2(@03)                          0766 02637000
         MVC   OLDERID2(95,@03),@TS00001                           0766 02638000
*        NEWID2 = 'XPLP';                                          0767 02639000
*                                                                  0767 02640000
         MVC   NEWID2(4,@03),@CC01200                              0767 02641000
*        TOTLEN = LENGTH(CTGPL) + LFLDNUM*4                        0768 02642000
*                  + (LENGTH(CTGFL) + 8) * (LFLDNUM + 1);          0768 02643000
*                                                                  0768 02644000
         L     @03,@PC00004+16                                     0768 02645000
         SLR   @15,@15                                             0768 02646000
         IC    @15,LFLDNUM(,@03)                                   0768 02647000
         LR    @03,@15                                             0768 02648000
         SLA   @03,2                                               0768 02649000
         AL    @03,@CF01340                                        0768 02650000
         AL    @15,@CF00220                                        0768 02651000
         MH    @15,@CH00311                                        0768 02652000
         ALR   @03,@15                                             0768 02653000
         ST    @03,TOTLEN                                          0768 02654000
*        CALL IDCSAGP0 (GDTTBL,TOTLEN,LCPLPTR,GPID,SETZERO);       0769 02655000
*                                                                  0769 02656000
         ST    @07,@AL00001                                        0769 02657000
         LA    @03,TOTLEN                                          0769 02658000
         ST    @03,@AL00001+4                                      0769 02659000
         L     @03,@PC00004+20                                     0769 02660000
         ST    @03,@AL00001+8                                      0769 02661000
         LA    @03,GPID                                            0769 02662000
         ST    @03,@AL00001+12                                     0769 02663000
         LA    @03,SETZERO                                         0769 02664000
         ST    @03,@AL00001+16                                     0769 02665000
         MVI   @AL00001+16,X'80'                                   0769 02666000
         L     @15,GDTGPL(,@07)                                    0769 02667000
         LA    @01,@AL00001                                        0769 02668000
         BALR  @14,@15                                             0769 02669000
*        RESPECIFY RTNREG RSTD;                                    0770 02670000
*        TESTRC = RTNREG;                                          0771 02671000
         LR    TESTRC,RTNREG                                       0771 02672000
*        RESPECIFY RTNREG UNRSTD;                                  0772 02673000
*        IF TESTRC ^= 0                                            0773 02674000
*          THEN                                                    0773 02675000
         LTR   TESTRC,TESTRC                                       0773 02676000
         BZ    @RF00773                                            0773 02677000
*            DO;                                                   0774 02678000
*            DARGSMOD = UNIVMSG;                                   0775 02679000
         L     @07,DDSTRU                                          0775 02680000
         MVC   DARGSMOD(3,@07),@CC00930                            0775 02681000
*            DEFSTID = NOSTORAG;                                   0776 02682000
         LA    DEFSTID,4                                           0776 02683000
*            RETURN CODE(LASTCC12);                                0777 02684000
         LA    @15,12                                              0777 02685000
         L     @14,@SA00004                                        0777 02686000
         LM    @00,@05,@SA00004+8                                  0777 02687000
         LM    @07,@12,@SA00004+32                                 0777 02688000
         BR    @14                                                 0777 02689000
*            END;                                                  0778 02690000
*                                                                  0778 02691000
*        CTGPLPTR = LCPLPTR;                                       0779 02692000
*                                                                  0779 02693000
@RF00773 L     @07,@PC00004+20                                     0779 02694000
         L     @07,LCPLPTR(,@07)                                   0779 02695000
         ST    @07,CTGPLPTR                                        0779 02696000
*        /************************************************************/ 02697000
*        /*                                                          */ 02698000
*        /*  GET WORK AREA CORE FOR CATALOG MANAGEMENT LOCATE        */ 02699000
*        /*  IF CORE NOT OBTAINED - TERMINATE                        */ 02700000
*        /*                                                          */ 02701000
*        /************************************************************/ 02702000
*                                                                  0780 02703000
*        CALL IDCSAGP0 (GDTTBL,WKAREALN+LENGTH(PATHREL),           0780 02704000
*          CTGWKA,GPID,SETZERO);                           /*@Y30SSFR*/ 02705000
         MVC   @AL00001+4(16),@AL00780                             0780 02706000
         L     @03,@PC00001                                        0780 02707000
         ST    @03,@AL00001                                        0780 02708000
         LA    @07,CTGWKA(,@07)                                    0780 02709000
         ST    @07,@AL00001+8                                      0780 02710000
         L     @15,GDTGPL(,@03)                                    0780 02711000
         LA    @01,@AL00001                                        0780 02712000
         BALR  @14,@15                                             0780 02713000
*        RESPECIFY RTNREG RSTD;                                    0781 02714000
*        TESTRC = RTNREG;                                          0782 02715000
         LR    TESTRC,RTNREG                                       0782 02716000
*        RESPECIFY RTNREG UNRSTD;                                  0783 02717000
*        IF TESTRC ^= 0                                            0784 02718000
*          THEN                                                    0784 02719000
         LTR   TESTRC,TESTRC                                       0784 02720000
         BZ    @RF00784                                            0784 02721000
*            DO;                                                   0785 02722000
*            DARGSMOD = UNIVMSG;                                   0786 02723000
         L     @07,DDSTRU                                          0786 02724000
         MVC   DARGSMOD(3,@07),@CC00930                            0786 02725000
*            DEFSTID = NOSTORAG;                                   0787 02726000
         LA    DEFSTID,4                                           0787 02727000
*            RETURN CODE(LASTCC12);                                0788 02728000
         LA    @15,12                                              0788 02729000
         L     @14,@SA00004                                        0788 02730000
         LM    @00,@05,@SA00004+8                                  0788 02731000
         LM    @07,@12,@SA00004+32                                 0788 02732000
         BR    @14                                                 0788 02733000
*            END;                                                  0789 02734000
*                                                                  0789 02735000
*        AREALN = WKAREALN;                                        0790 02736000
*                                                                  0790 02737000
@RF00784 L     @07,CTGPLPTR                                        0790 02738000
         L     @01,CTGWKA(,@07)                                    0790 02739000
         MVC   AREALN(2,@01),@CH00894                              0790 02740000
*        /************************************************************/ 02741000
*        /*                                                          */ 02742000
*        /*  INITIALIZE CPL WITH ENTRYNAME OR CONTROL INTERVAL NUMBER*/ 02743000
*        /*                                                          */ 02744000
*        /************************************************************/ 02745000
*                                                                  0791 02746000
*        IF LNAME ^= NULLPTR                                       0791 02747000
*          THEN                                                    0791 02748000
         L     @15,@PC00004                                        0791 02749000
         L     @15,LNAME(,@15)                                     0791 02750000
         LTR   @15,@15                                             0791 02751000
         BZ    @RF00791                                            0791 02752000
*            DO;                                                   0792 02753000
*            CTGENT = LNAME;                                       0793 02754000
         ST    @15,CTGENT(,@07)                                    0793 02755000
*            CTGNAME = ON;                                         0794 02756000
         OI    CTGNAME(@07),B'00000100'                            0794 02757000
*            END;                                                  0795 02758000
*          ELSE                                                    0796 02759000
*            CTGENT = ADDR(LCINUM);                                0796 02760000
*                                                                  0796 02761000
         B     @RC00791                                            0796 02762000
@RF00791 L     @07,@PC00004+4                                      0796 02763000
         L     @01,CTGPLPTR                                        0796 02764000
         ST    @07,CTGENT(,@01)                                    0796 02765000
*        /************************************************************/ 02766000
*        /*                                                          */ 02767000
*        /*  INITIALIZE CPL POINTER TO CATALOG NAME OR ACB PTR OR 0  */ 02768000
*        /*                                                          */ 02769000
*        /************************************************************/ 02770000
*                                                                  0797 02771000
*        IF LCATACB ^= NULLPTR                                     0797 02772000
*          THEN                                                    0797 02773000
@RC00791 L     @07,@PC00004+8                                      0797 02774000
         L     @15,LCATACB(,@07)                                   0797 02775000
         LTR   @15,@15                                             0797 02776000
         BZ    @RF00797                                            0797 02777000
*            CTGCAT = ADDR(LCATACB);                               0798 02778000
*                                                                  0798 02779000
         L     @01,CTGPLPTR                                        0798 02780000
         ST    @07,CTGCAT(,@01)                                    0798 02781000
*          ELSE                                                    0799 02782000
*            CTGCNAME = ON;                                        0799 02783000
*                                                                  0799 02784000
         B     @RC00797                                            0799 02785000
@RF00797 L     @07,CTGPLPTR                                        0799 02786000
         OI    CTGCNAME(@07),B'00000010'                           0799 02787000
*        /************************************************************/ 02788000
*        /*                                                          */ 02789000
*        /*  SET OPTIONS FLAGS IN CPL FOR LOCATE                     */ 02790000
*        /*                                                          */ 02791000
*        /************************************************************/ 02792000
*        CTGAM0 = ON;                                              0800 02793000
@RC00797 DS    0H                                                  0801 02794000
*        CTGNUM = ON;                                              0801 02795000
         L     @07,CTGPLPTR                                        0801 02796000
         OI    CTGAM0(@07),B'00000011'                             0801 02797000
*        CTGFUNC = CTGLOC;                                         0802 02798000
*                                                                  0802 02799000
         NI    CTGFUNC(@07),B'00111111'                            0802 02800000
         OI    CTGFUNC(@07),B'00100000'                            0802 02801000
*        /************************************************************/ 02802000
*        /*                                                          */ 02803000
*        /*  SET PASSWORD IF SPECIFIED IN AMS COMMAND                */ 02804000
*        /*                                                          */ 02805000
*        /************************************************************/ 02806000
*                                                                  0803 02807000
*                                                                  0803 02808000
*        IF ENTPLN > 0                                             0803 02809000
*          THEN                                                    0803 02810000
         L     @15,@PC00001+4                                      0803 02811000
         L     @15,FDTPTR(,@15)                                    0803 02812000
         CLI   ENTPLN(@15),0                                       0803 02813000
         BNH   @RF00803                                            0803 02814000
*            CTGPSWD = ADDR(ENTPAS);                               0804 02815000
         LA    @15,ENTPAS(,@15)                                    0804 02816000
         ST    @15,CTGPSWD(,@07)                                   0804 02817000
*        /************************************************************/ 02818000
*        /*                                                          */ 02819000
*        /*  BUILD A FPL FOR EACH CATALOG FIELD NAME IN THE FIELD    */ 02820000
*        /*  LIST.  THE FPLS WILL BE BUILT FOLLOWING THE CPL         */ 02821000
*        /*                                                          */ 02822000
*        /************************************************************/ 02823000
*                                                                  0805 02824000
*        CTGFLPTR = CTGPLPTR + LENGTH(CTGPL) + LFLDNUM*4;          0805 02825000
@RF00803 L     @07,CTGPLPTR                                        0805 02826000
         LA    CTGFLPTR,28                                         0805 02827000
         ALR   CTGFLPTR,@07                                        0805 02828000
         L     @03,@PC00004+16                                     0805 02829000
         SLR   @15,@15                                             0805 02830000
         IC    @15,LFLDNUM(,@03)                                   0805 02831000
         LR    @14,@15                                             0805 02832000
         SLA   @14,2                                               0805 02833000
         ALR   CTGFLPTR,@14                                        0805 02834000
*        CTGNOFLD = LFLDNUM;                                       0806 02835000
*                                                                  0806 02836000
         STC   @15,CTGNOFLD(,@07)                                  0806 02837000
*          /**********************************************************/ 02838000
*          /*                                                        */ 02839000
*          /*  LFLDNUM CONTAINS THE NUMBER OF FIELDNAMES, HENCE      */ 02840000
*          /*  THE NUMBER OF FPLS TO BE CONSTRUCTED.  THE CPL        */ 02841000
*          /*  CONTAINS A POINTER TO EACH FPL IN THE ARRAY CTGFIELD  */ 02842000
*          /*                                                        */ 02843000
*          /**********************************************************/ 02844000
*                                                                  0807 02845000
*        DO INDX = 1 TO LFLDNUM;                                   0807 02846000
         LA    INDX,1                                              0807 02847000
         B     @DE00807                                            0807 02848000
@DL00807 DS    0H                                                  0808 02849000
*          CTGFIELD(INDX) = CTGFLPTR;                              0808 02850000
         LR    @07,INDX                                            0808 02851000
         SLA   @07,2                                               0808 02852000
         L     @05,CTGPLPTR                                        0808 02853000
         ST    CTGFLPTR,CTGFIELD-4(@07,@05)                        0808 02854000
*          CTGFLDNO = '00000001'B;                                 0809 02855000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0809 02856000
*          CTGFLDNM = ADDR(LFLDLST(INDX));                         0810 02857000
         LR    @07,INDX                                            0810 02858000
         SLA   @07,3                                               0810 02859000
         L     @05,@PC00004+12                                     0810 02860000
         AL    @05,@CF01368                                        0810 02861000
         LA    @07,LFLDLST(@07,@05)                                0810 02862000
         ST    @07,CTGFLDNM(,CTGFLPTR)                             0810 02863000
*          CTGFLPTR = CTGFLPTR + LENGTH(CTGFL) + 8;                0811 02864000
*                                                                  0811 02865000
         LA    @07,24                                              0811 02866000
         ALR   CTGFLPTR,@07                                        0811 02867000
*          /**********************************************************/ 02868000
*          /*                                                        */ 02869000
*          /*  IF CONSTRUCTING A VOLSER FPL, CONSTRUCT AN ADDITIONAL */ 02870000
*          /*  FPL TO BE CHAINED TO THE VOLSER FPL FOR THE TEST      */ 02871000
*          /*  SO THAT CATALOG MANAGEMENT WILL NOT RETURN SEQUENCE   */ 02872000
*          /*  SET VOLUMES(IMBED FEATURE)                            */ 02873000
*          /*                                                        */ 02874000
*          /**********************************************************/ 02875000
*                                                                  0812 02876000
*          IF INDX = IVOLSER                                       0812 02877000
*            THEN                                                  0812 02878000
         C     INDX,@CF00988                                       0812 02879000
         BNE   @RF00812                                            0812 02880000
*              DO;                                                 0813 02881000
*              CTGFIELD(INDX) -> CTGFLCHN = CTGFLPTR;              0814 02882000
         LR    @05,INDX                                            0814 02883000
         SLA   @05,2                                               0814 02884000
         L     @03,CTGPLPTR                                        0814 02885000
         L     @05,CTGFIELD-4(@05,@03)                             0814 02886000
         ST    CTGFLPTR,CTGFLCHN(,@05)                             0814 02887000
*              CTGFLDNO = '00000001'B;                             0815 02888000
         MVI   CTGFLDNO(CTGFLPTR),X'01'                            0815 02889000
*              CTGFLDCD = CTGFLDZ;                                 0816 02890000
         MVI   CTGFLDCD(CTGFLPTR),X'80'                            0816 02891000
*              CTGFLDNM = ADDR(CITYPEXT);                          0817 02892000
         LA    @05,CITYPEXT                                        0817 02893000
         ST    @05,CTGFLDNM(,CTGFLPTR)                             0817 02894000
*              CTGFLNG(1) = 1;                                     0818 02895000
         MVC   CTGFLNG(4,CTGFLPTR),@CF00220                        0818 02896000
*              CTGFLPT(1) = ADDR(SSFLAG);                          0819 02897000
         LA    @05,SSFLAG                                          0819 02898000
         ST    @05,CTGFLPT(,CTGFLPTR)                              0819 02899000
*              CTGFLPTR = CTGFLPTR + LENGTH(CTGFL) + 8;            0820 02900000
         ALR   CTGFLPTR,@07                                        0820 02901000
*              END;                                                0821 02902000
*        END;                                                      0822 02903000
*                                                                  0822 02904000
@RF00812 AL    INDX,@CF00220                                       0822 02905000
@DE00807 L     @07,@PC00004+16                                     0822 02906000
         SLR   @05,@05                                             0822 02907000
         IC    @05,LFLDNUM(,@07)                                   0822 02908000
         CR    INDX,@05                                            0822 02909000
         BNH   @DL00807                                            0822 02910000
*        /************************************************************/ 02911000
*        /*                                                          */ 02912000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 02913000
*        /*                                                          */ 02914000
*        /************************************************************/ 02915000
*                                                                  0823 02916000
*        RETURN CODE(0);                                           0823 02917000
*                                                                  0823 02918000
         SLR   @15,@15                                             0823 02919000
         L     @14,@SA00004                                        0823 02920000
         LM    @00,@05,@SA00004+8                                  0823 02921000
         LM    @07,@12,@SA00004+32                                 0823 02922000
         BR    @14                                                 0823 02923000
*END LOCPROC;                                                      0824 02924000
*        /************************************************************/ 02925000
*        /*                                                          */ 02926000
*        /* PROCEDURE NAME - CTLGPROC                                */ 02927000
*        /*                                                          */ 02928000
*        /*  FUNCTION - INVOKE THE VSAM CATALOG MANAGEMENT TO PERFORM*/ 02929000
*        /*  THE OPERATION INDICATED IN THE CPL (LOCATE,ALTER,DELETE)*/ 02930000
*        /*  EXAMINE THE RETURN CODE FROM CATALOG MANAGEMENT,GET MORE*/ 02931000
*        /*  CATALOG WORK AREA IF REQUIRED, SET UP APPROPRIATE ERROR */ 02932000
*        /*  INDICATORS                                              */ 02933000
*        /*  CTLGPROC DOES NOT PERFORM CATALOG DELETES FOR   @Y30SSFR*/ 02934000
*        /*  CLUSTERS AND AIX'S, BUT IT DOES INVOKE CATALOG  @Y30SSFR*/ 02935000
*        /*  MANAGEMENT TO DO DISCONNECTS FOR USER CATALOGS. @Y30SSFR*/ 02936000
*        /*  DELETION OF CLUSTERS AND AIX'S IS DONE USING    @Y30SSFR*/ 02937000
*        /*  DELTPROC.                                       @Y30SSFR*/ 02938000
*        /*                                                          */ 02939000
*        /*  INPUT - CATALOG PARAMETER LIST(CPL)                     */ 02940000
*        /*                                                          */ 02941000
*        /*  OUTPUT - RETURN CODE IS SET TO INDICATE SUCCESS OR      */ 02942000
*        /*  FAILURE.  DEFSTID IS SET TO INDICATE MESSAGE ID IF      */ 02943000
*        /*  AN ERROR MESSAGE IS TO BE LISTED.                       */ 02944000
*        /*                                                          */ 02945000
*        /************************************************************/ 02946000
*                                                                  0825 02947000
*CTLGPROC:  PROCEDURE(SCPLPTR);         /*CPL POINTER                */ 02948000
*                                                                  0825 02949000
CTLGPROC STM   @14,@05,@SA00005                                    0825 02950000
         STM   @07,@12,@SA00005+32                                 0825 02951000
         MVC   @PC00005(4),0(@01)                                  0825 02952000
*        /************************************************************/ 02953000
*        /*                                                          */ 02954000
*        /*  ARGUMENTS OF INVOCATION                                 */ 02955000
*        /*                                                          */ 02956000
*        /************************************************************/ 02957000
*                                                                  0826 02958000
*        DCL SCPLPTR PTR(31);                                      0826 02959000
*                                                                  0826 02960000
*        /************************************************************/ 02961000
*        /*                                                          */ 02962000
*        /* LOCAL DECLARATIONS                                       */ 02963000
*        /*                                                          */ 02964000
*        /************************************************************/ 02965000
*                                                                  0827 02966000
*        DCL WSIZE   FIXED(31);        /*SIZE OF WORK AREA NEEDED BY */ 02967000
*                                      /*VSAM CATALOG MANAGEMENT     */ 02968000
*                                                                  0828 02969000
*        /************************************************************/ 02970000
*        /*                                                          */ 02971000
*        /*  INVOKE CATALOG MANAGEMENT                               */ 02972000
*        /*                                                          */ 02973000
*        /************************************************************/ 02974000
*                                                                  0828 02975000
*        OLDERID2 = NEWERID2;                                      0828 02976000
         L     @07,@PC00001                                        0828 02977000
         L     @15,GDTTR2(,@07)                                    0828 02978000
         MVC   @TS00001(95),NEWERID2(@15)                          0828 02979000
         MVC   OLDERID2(95,@15),@TS00001                           0828 02980000
*        NEWID2 = 'XPSP';                                          0829 02981000
         MVC   NEWID2(4,@15),@CC01208                              0829 02982000
*        CATRTNID = 'CATLGRTN';                                    0830 02983000
*                                                                  0830 02984000
         MVC   CATRTNID(8),@CC01209                                0830 02985000
*        CALL IDCSACA0 (GDTTBL,SCPLPTR);                           0831 02986000
*                                                                  0831 02987000
         ST    @07,@AL00001                                        0831 02988000
         L     @15,@PC00005                                        0831 02989000
         ST    @15,@AL00001+4                                      0831 02990000
         L     @15,GDTCAT(,@07)                                    0831 02991000
         LA    @01,@AL00001                                        0831 02992000
         BALR  @14,@15                                             0831 02993000
*        RESPECIFY REG15 RSTD;                             /*@Y30SSFR*/ 02994000
*        CATLGRC = REG15;                                          0833 02995000
         STH   REG15,CATLGRC                                       0833 02996000
*        RESPECIFY REG15 UNRSTD;                           /*@Y30SSFR*/ 02997000
*        IF GDTDBG = NULLPTR                                       0835 02998000
*          THEN;                                                   0835 02999000
         L     @07,@PC00001                                        0835 03000000
         L     @07,GDTDBG(,@07)                                    0835 03001000
         LTR   @07,@07                                             0835 03002000
         BZ    @RT00835                                            0835 03003000
*          ELSE                                                    0837 03004000
*            CALL IDCDB010 (GDTTBL,'XPZZ');                        0837 03005000
*                                                                  0837 03006000
         L     @07,@PC00001                                        0837 03007000
         ST    @07,@AL00001                                        0837 03008000
         LA    @15,@CC01210                                        0837 03009000
         ST    @15,@AL00001+4                                      0837 03010000
         MVI   @AL00001+4,X'80'                                    0837 03011000
         L     @15,GDTDBG(,@07)                                    0837 03012000
         LA    @01,@AL00001                                        0837 03013000
         BALR  @14,@15                                             0837 03014000
*        /************************************************************/ 03015000
*        /*                                                          */ 03016000
*        /*  IF THE RETURN CODE INDICATES AN ERROR, TEST FOR WORK    */ 03017000
*        /*  AREA TOO SMALL.  IF IT IS, GET A NEW WORK AREA AFTER    */ 03018000
*        /*  FREEING THE OLD ONE.  RE-INVOKE CATALOG MANAGEMENT      */ 03019000
*        /*                                                          */ 03020000
*        /************************************************************/ 03021000
*                                                                  0838 03022000
*        IF CATLGRC ^= 0                                           0838 03023000
*          THEN                                                    0838 03024000
@RT00835 LH    @07,CATLGRC                                         0838 03025000
         LTR   @07,@07                                             0838 03026000
         BZ    @RF00838                                            0838 03027000
*            IF CATLGRC = 40                                       0839 03028000
*              THEN                                                0839 03029000
         C     @07,@CF01110                                        0839 03030000
         BNE   @RF00839                                            0839 03031000
*                DO;                                               0840 03032000
*                                                                  0840 03033000
*                /****************************************************/ 03034000
*                /*                                                  */ 03035000
*                /*  GET NEEDED SIZE FROM CATALOG WORKARE AT OFFSET  */ 03036000
*                /*  AND OBTAIN CORE.  IF SIZE NOT RETURNED OR       */ 03037000
*                /*  CORE NOT OBTAINED - TERMINATE                   */ 03038000
*                /*                                                  */ 03039000
*                /****************************************************/ 03040000
*                                                                  0841 03041000
*                CTGPLPTR = SCPLPTR;                               0841 03042000
         L     @07,@PC00005                                        0841 03043000
         L     @07,SCPLPTR(,@07)                                   0841 03044000
         ST    @07,CTGPLPTR                                        0841 03045000
*                WSIZE = RETURNLN;                                 0842 03046000
*                                                                  0842 03047000
         L     @01,CTGWKA(,@07)                                    0842 03048000
         LH    WSIZE,RETURNLN(,@01)                                0842 03049000
*                CALL IDCSAFS0 (GDTTBL,CTGWKA);                    0843 03050000
*                                                                  0843 03051000
         L     @15,@PC00001                                        0843 03052000
         ST    @15,@AL00001                                        0843 03053000
         LA    @07,CTGWKA(,@07)                                    0843 03054000
         ST    @07,@AL00001+4                                      0843 03055000
         L     @15,GDTFSP(,@15)                                    0843 03056000
         LA    @01,@AL00001                                        0843 03057000
         BALR  @14,@15                                             0843 03058000
*                CALL IDCSAGP0 (GDTTBL,WSIZE + LENGTH(PATHREL),/*  0844 03059000
*                                                            @Y30SSFR*/ 03060000
*                  CTGWKA,GPID,SETZERO);                   /*@Y30SSFR*/ 03061000
         L     @07,@PC00001                                        0844 03062000
         ST    @07,@AL00001                                        0844 03063000
         LA    @15,52                                              0844 03064000
         ALR   @15,WSIZE                                           0844 03065000
         ST    @15,@AFTEMPS+12                                     0844 03066000
         LA    @15,@AFTEMPS+12                                     0844 03067000
         ST    @15,@AL00001+4                                      0844 03068000
         L     @01,CTGPLPTR                                        0844 03069000
         LA    @15,CTGWKA(,@01)                                    0844 03070000
         ST    @15,@AL00001+8                                      0844 03071000
         LA    @15,GPID                                            0844 03072000
         ST    @15,@AL00001+12                                     0844 03073000
         LA    @15,SETZERO                                         0844 03074000
         ST    @15,@AL00001+16                                     0844 03075000
         MVI   @AL00001+16,X'80'                                   0844 03076000
         L     @15,GDTGPL(,@07)                                    0844 03077000
         LA    @01,@AL00001                                        0844 03078000
         BALR  @14,@15                                             0844 03079000
*                RESPECIFY RTNREG RSTD;                            0845 03080000
*                TESTRC = RTNREG;                                  0846 03081000
         LR    TESTRC,RTNREG                                       0846 03082000
*                RESPECIFY RTNREG UNRSTD;                          0847 03083000
*                IF TESTRC ^= 0                                    0848 03084000
*                  THEN                                            0848 03085000
         LTR   TESTRC,TESTRC                                       0848 03086000
         BZ    @RF00848                                            0848 03087000
*                    DO;                                           0849 03088000
*                    DARGSMOD = UNIVMSG;                           0850 03089000
         L     @07,DDSTRU                                          0850 03090000
         MVC   DARGSMOD(3,@07),@CC00930                            0850 03091000
*                    DEFSTID = NOSTORAG;                           0851 03092000
         LA    DEFSTID,4                                           0851 03093000
*                    RETURN CODE(LASTCC12);                        0852 03094000
         LA    @15,12                                              0852 03095000
         L     @14,@SA00005                                        0852 03096000
         LM    @00,@05,@SA00005+8                                  0852 03097000
         LM    @07,@12,@SA00005+32                                 0852 03098000
         BR    @14                                                 0852 03099000
*                    END;                                          0853 03100000
*                                                                  0853 03101000
*                AREALN = WSIZE;                                   0854 03102000
*                                                                  0854 03103000
@RF00848 L     @07,CTGPLPTR                                        0854 03104000
         L     @07,CTGWKA(,@07)                                    0854 03105000
         STH   WSIZE,AREALN(,@07)                                  0854 03106000
*                /****************************************************/ 03107000
*                /*                                                  */ 03108000
*                /*  RE- INVOKE CATALOG MANAGEMENT                   */ 03109000
*                /*                                                  */ 03110000
*                /****************************************************/ 03111000
*                                                                  0855 03112000
*                CALL IDCSACA0 (GDTTBL,SCPLPTR);                   0855 03113000
*                                                                  0855 03114000
         L     @07,@PC00001                                        0855 03115000
         ST    @07,@AL00001                                        0855 03116000
         L     @15,@PC00005                                        0855 03117000
         ST    @15,@AL00001+4                                      0855 03118000
         L     @15,GDTCAT(,@07)                                    0855 03119000
         LA    @01,@AL00001                                        0855 03120000
         BALR  @14,@15                                             0855 03121000
*                RESPECIFY REG15 RSTD;                     /*@Y30SSFR*/ 03122000
*                CATLGRC = REG15;                                  0857 03123000
         STH   REG15,CATLGRC                                       0857 03124000
*                RESPECIFY REG15 UNRSTD;                   /*@Y30SSFR*/ 03125000
*                END;                                              0859 03126000
*        IF CATLGRC ^= 0                                           0860 03127000
*          THEN                                                    0860 03128000
@RF00839 DS    0H                                                  0860 03129000
@RF00838 LH    @07,CATLGRC                                         0860 03130000
         LTR   @07,@07                                             0860 03131000
         BZ    @RF00860                                            0860 03132000
*ERCALL1:     DO;                                          /*@Y30SSFR*/ 03133000
*                                                                  0861 03134000
ERCALL1  DS    0H                                                  0862 03135000
*            /********************************************************/ 03136000
*            /*                                              @Y30SSFR*/ 03137000
*            /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE     @Y30SSFR*/ 03138000
*            /*  ERROR CONVERSION TABLE.                     @Y30SSFR*/ 03139000
*            /*                                              @Y30SSFR*/ 03140000
*            /********************************************************/ 03141000
*                                                                  0862 03142000
*            ERRORTAB = ''B;                               /*@Y30SSFR*/ 03143000
*                                                                  0862 03144000
         XC    ERRORTAB(32),ERRORTAB                               0862 03145000
*            /********************************************************/ 03146000
*            /*                                              @Y30SSFR*/ 03147000
*            /*  SET ERCNVADR TO POINT TO THE STORAGE FOR    @Y30SSFR*/ 03148000
*            /*  THE ERROR CONVERSION TABLE.                 @Y30SSFR*/ 03149000
*            /*                                              @Y30SSFR*/ 03150000
*            /********************************************************/ 03151000
*                                                                  0863 03152000
*            ERCNVADR = ADDR(ERRORTAB);                    /*@Y30SSFR*/ 03153000
*                                                                  0863 03154000
         LA    @07,ERRORTAB                                        0863 03155000
         ST    @07,ERCNVADR                                        0863 03156000
*            /********************************************************/ 03157000
*            /*                                              @Y30SSFR*/ 03158000
*            /*  SET ERCATLG TO BE ON TO INDICATE THAT THIS  @Y30SSFR*/ 03159000
*            /*  IS A CATALOG ERROR.  DETERMINE THE CMS      @Y30SSFR*/ 03160000
*            /*  FUNCTION BEING PERFORMED, AND SET THE       @Y30SSFR*/ 03161000
*            /*  APPROPRIATE EROPER BIT.                     @Y30SSFR*/ 03162000
*            /*                                              @Y30SSFR*/ 03163000
*            /********************************************************/ 03164000
*                                                                  0864 03165000
*            ERCATLG = ON;                                 /*@Y30SSFR*/ 03166000
         OI    ERCATLG(@07),B'10000000'                            0864 03167000
*            IF CTGFUNC = CTGLOC                                   0865 03168000
*              THEN                                                0865 03169000
*                                                                  0865 03170000
         L     @01,CTGPLPTR                                        0865 03171000
         TM    CTGFUNC(@01),B'00100000'                            0865 03172000
         BNO   @RF00865                                            0865 03173000
         TM    CTGFUNC(@01),B'11000000'                            0865 03174000
         BNZ   @RF00865                                            0865 03175000
*                /****************************************************/ 03176000
*                /*                                          @Y30SSFR*/ 03177000
*                /*  THE OPERATION WAS A LOCATE.  SET        @Y30SSFR*/ 03178000
*                /*  ERCATLC.                                @Y30SSFR*/ 03179000
*                /*                                          @Y30SSFR*/ 03180000
*                /****************************************************/ 03181000
*                                                                  0866 03182000
*                ERCATLC = ON;                             /*@Y30SSFR*/ 03183000
         OI    ERCATLC(@07),B'10000000'                            0866 03184000
*              ELSE                                                0867 03185000
*                IF CTGOPTNS = CTGALTER                            0867 03186000
*                  THEN                                            0867 03187000
*                                                                  0867 03188000
         B     @RC00865                                            0867 03189000
@RF00865 L     @07,CTGPLPTR                                        0867 03190000
         TM    CTGOPTNS(@07),B'00010000'                           0867 03191000
         BNO   @RF00867                                            0867 03192000
         TM    CTGOPTNS(@07),B'11101000'                           0867 03193000
         BNZ   @RF00867                                            0867 03194000
*                    /************************************************/ 03195000
*                    /*                                      @Y30SSFR*/ 03196000
*                    /*  THE CATALOG OPERATION IS AN ALTER.  @Y30SSFR*/ 03197000
*                    /*  SET ERCATAL TO BE ON.               @Y30SSFR*/ 03198000
*                    /*                                      @Y30SSFR*/ 03199000
*                    /************************************************/ 03200000
*                                                                  0868 03201000
*                    ERCATAL = ON;                         /*@Y30SSFR*/ 03202000
         L     @07,ERCNVADR                                        0868 03203000
         OI    ERCATAL(@07),B'00010000'                            0868 03204000
*                  ELSE                                            0869 03205000
*                    IF CTGOPTNS = CTGDELET                        0869 03206000
*                      THEN                                        0869 03207000
*                                                                  0869 03208000
         B     @RC00867                                            0869 03209000
@RF00867 L     @07,CTGPLPTR                                        0869 03210000
         TM    CTGOPTNS(@07),B'00011000'                           0869 03211000
         BNO   @RF00869                                            0869 03212000
         TM    CTGOPTNS(@07),B'11100000'                           0869 03213000
         BNZ   @RF00869                                            0869 03214000
*                        /********************************************/ 03215000
*                        /*                                  @Y30SSFR*/ 03216000
*                        /*  THE CATALOG OPERATION WAS A     @Y30SSFR*/ 03217000
*                        /*  DELETE.  SET ERCATDL TO BE      @Y30SSFR*/ 03218000
*                        /*  ON.                             @Y30SSFR*/ 03219000
*                        /*                                  @Y30SSFR*/ 03220000
*                        /********************************************/ 03221000
*                                                                  0870 03222000
*                        ERCATDL = ON;                     /*@Y30SSFR*/ 03223000
*                                                                  0870 03224000
         L     @07,ERCNVADR                                        0870 03225000
         OI    ERCATDL(@07),B'00100000'                            0870 03226000
*            /********************************************************/ 03227000
*            /*                                              @Y30SSFR*/ 03228000
*            /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT TO  @Y30SSFR*/ 03229000
*            /*  POINT TO THE CPL FOR THE CATALOG OPERATION. @Y30SSFR*/ 03230000
*            /*                                              @Y30SSFR*/ 03231000
*            /********************************************************/ 03232000
*                                                                  0871 03233000
*            ERCATRC = CATLGRC;                            /*@Y30SSFR*/ 03234000
@RF00869 DS    0H                                                  0871 03235000
@RC00867 DS    0H                                                  0871 03236000
@RC00865 L     @07,ERCNVADR                                        0871 03237000
         LH    @15,CATLGRC                                         0871 03238000
         ST    @15,ERCATRC(,@07)                                   0871 03239000
*            ERCPLPT = SCPLPTR;                            /*@Y30SSFR*/ 03240000
*                                                                  0872 03241000
         L     @15,@PC00005                                        0872 03242000
         L     @15,SCPLPTR(,@15)                                   0872 03243000
         ST    @15,ERCPLPT(,@07)                                   0872 03244000
*            /********************************************************/ 03245000
*            /*                                              @Y30SSFR*/ 03246000
*            /*  SET AN POINTER TO THE ENTRY NAME IN THE     @Y30SSFR*/ 03247000
*            /*  ERROR CONVERSION TABLE.                     @Y30SSFR*/ 03248000
*            /*                                              @Y30SSFR*/ 03249000
*            /********************************************************/ 03250000
*                                                                  0873 03251000
*            IF ERCATLC = ON | ERCATDL = ON                /*@Y30SSFR*/ 03252000
*              THEN                                        /*@Y30SSFR*/ 03253000
         TM    ERCATLC(@07),B'10100000'                            0873 03254000
         BZ    @RF00873                                            0873 03255000
*                ERDSNM = CTGENT;                          /*@Y30SSFR*/ 03256000
         L     @01,CTGPLPTR                                        0874 03257000
         L     @15,CTGENT(,@01)                                    0874 03258000
         ST    @15,ERDSNM(,@07)                                    0874 03259000
*              ELSE                                        /*@Y30SSFR*/ 03260000
*                ERDSNM = CTGFVT -> CTGFVENT;              /*@Y30SSFR*/ 03261000
*                                                                  0875 03262000
         B     @RC00873                                            0875 03263000
@RF00873 L     @07,CTGPLPTR                                        0875 03264000
         L     @07,CTGFVT(,@07)                                    0875 03265000
         L     @07,CTGFVENT(,@07)                                  0875 03266000
         L     @01,ERCNVADR                                        0875 03267000
         ST    @07,ERDSNM(,@01)                                    0875 03268000
*            /********************************************************/ 03269000
*            /*                                              @Y30SSFR*/ 03270000
*            /*  INVOKE THE UERROR ROUTINE BY ISSUING THE    @Y30SSFR*/ 03271000
*            /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.     @Y30SSFR*/ 03272000
*            /*                                              @Y30SSFR*/ 03273000
*            /********************************************************/ 03274000
*                                                                  0876 03275000
*            CALL IDCTPER0(GDTTBL,ERCNVADR);               /*@Y30SSFR*/ 03276000
*                                                                  0876 03277000
@RC00873 L     @07,@PC00001                                        0876 03278000
         ST    @07,@AL00001                                        0876 03279000
         LA    @15,ERCNVADR                                        0876 03280000
         ST    @15,@AL00001+4                                      0876 03281000
         MVI   @AL00001+4,X'80'                                    0876 03282000
         L     @15,GDTERR(,@07)                                    0876 03283000
         LA    @01,@AL00001                                        0876 03284000
         BALR  @14,@15                                             0876 03285000
*            /********************************************************/ 03286000
*            /*                                              @Y30SSFR*/ 03287000
*            /*  RETURN TO THE CALLER WITH AN ERROR          @Y30SSFR*/ 03288000
*            /*  INDICATED.                                  @Y30SSFR*/ 03289000
*            /*                                              @Y30SSFR*/ 03290000
*            /********************************************************/ 03291000
*                                                                  0877 03292000
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/ 03293000
         LA    @15,12                                              0877 03294000
         L     @14,@SA00005                                        0877 03295000
         LM    @00,@05,@SA00005+8                                  0877 03296000
         LM    @07,@12,@SA00005+32                                 0877 03297000
         BR    @14                                                 0877 03298000
*            END ERCALL1;                                  /*#Y30SSFR*/ 03299000
*                                                                  0878 03300000
*        /************************************************************/ 03301000
*        /*                                                          */ 03302000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 03303000
*        /*                                                          */ 03304000
*        /************************************************************/ 03305000
*                                                                  0879 03306000
*        RETURN CODE(0);                                           0879 03307000
*                                                                  0879 03308000
@RF00860 SLR   @15,@15                                             0879 03309000
         L     @14,@SA00005                                        0879 03310000
         LM    @00,@05,@SA00005+8                                  0879 03311000
         LM    @07,@12,@SA00005+32                                 0879 03312000
         BR    @14                                                 0879 03313000
*END CTLGPROC;                                                     0880 03314000
*        /************************************************************/ 03315000
*        /*                                                          */ 03316000
*        /*  PROCEDURE NAME - OPENPROC                               */ 03317000
*        /*                                                          */ 03318000
*        /*  FUNCTION - PERFORMS ALL OPENS REQUIRED FOR OPENING AN   */ 03319000
*        /*  VSAM COMPONENT FOR INPUT, OR OPENING THE PORTABILITY    */ 03320000
*        /*  DATA SET FOR OUTPUT.                                    */ 03321000
*        /*  WHEN OPENING THE VSAM OBJECT FOR INPUT, SETS    @Y30SSFR*/ 03322000
*        /*  THE EXPORT/IMPORT FLAG IN THE OPNAGL.           @Y30SSFR*/ 03323000
*        /*                                                          */ 03324000
*        /*  INPUT -                                                 */ 03325000
*        /*    .OTYPE - I INDICATES INPUT, O INDICATES OUTPUT        */ 03326000
*        /*    .ODD - 8-BYTE JCL STATEMENT NAME FOR DATA SET TO BE   */ 03327000
*        /*           OPENED                                         */ 03328000
*        /*    .ODSN - NAME OF VSAM COMPONENT                        */ 03329000
*        /*    .OREC - LRECL SIZE FOR OUTPUT DATA SET                */ 03330000
*        /*    .OBLK - BLKSIZE FOR OUTPUT DATA SET                   */ 03331000
*        /*                                                          */ 03332000
*        /*  OUTPUT - POINTER TO IOCS FOR OPEN DATA SET              */ 03333000
*        /*                                                          */ 03334000
*        /************************************************************/ 03335000
*                                                                  0881 03336000
*OPENPROC:  PROCEDURE(OTYPE,           /*OPEN FOR INPUT OR OUTPUT    */ 03337000
*                     ODD,             /*8-BYTE JCL STATEMENT NAME   */ 03338000
*                     ODSN,            /*ENTRYNAME OF OBJECT RELATED */ 03339000
*                                      /*TO CLUSTER                  */ 03340000
*                     OREC,            /*LRECL FOR OUTPUT DATA SET   */ 03341000
*                     OBLK,            /*BLKSIZE FOR OUTPUT DATA SET */ 03342000
*                     OIOCS);          /*RETURN CELL FOR IOCS        */ 03343000
*                                                                  0881 03344000
OPENPROC STM   @14,@12,@SA00006                                    0881 03345000
         MVC   @PC00006(24),0(@01)                                 0881 03346000
*        /************************************************************/ 03347000
*        /*                                                          */ 03348000
*        /*  ARGUMENTS OF INVOCATION                                 */ 03349000
*        /*                                                          */ 03350000
*        /************************************************************/ 03351000
*                                                                  0882 03352000
*        DCL                                                       0882 03353000
*          OTYPE CHAR(1),                                          0882 03354000
*          ODD   PTR(31),                                          0882 03355000
*          ODSN  PTR(31),                                          0882 03356000
*          OREC,                                                   0882 03357000
*          OBLK,                                                   0882 03358000
*          OIOCS PTR(31);                                          0882 03359000
*                                                                  0882 03360000
*        /************************************************************/ 03361000
*        /*                                                          */ 03362000
*        /*  LOCAL DECLARATIONS                                      */ 03363000
*        /*                                                          */ 03364000
*        /************************************************************/ 03365000
*                                                                  0883 03366000
*        DCL OPENLIST BIT(LENGTH(OPNAGL)) BDY(WORD);               0883 03367000
*                                      /* STORAGE FOR OPEN ARGUMENT  */ 03368000
*                                      /* LIST                       */ 03369000
*        DCL OIOCSPTR PTR(31) BASED(OIOCS);                        0884 03370000
*                                      /*PTR TO IOCS RETURNED BY OPEN*/ 03371000
*                                                                  0885 03372000
*        /************************************************************/ 03373000
*        /*                                                          */ 03374000
*        /*  CONSTRUCT OPNAGL SETTING DIFFERENT OPTIONS FOR INPUT    */ 03375000
*        /*  VERSUS AN OUTPUT DATA SET                               */ 03376000
*        /*                                                          */ 03377000
*        /************************************************************/ 03378000
*                                                                  0885 03379000
*        OLDERID2 = NEWERID2;                                      0885 03380000
         L     @02,@PC00001                                        0885 03381000
         L     @02,GDTTR2(,@02)                                    0885 03382000
         MVC   @TS00001(95),NEWERID2(@02)                          0885 03383000
         MVC   OLDERID2(95,@02),@TS00001                           0885 03384000
*        NEWID2 = 'XPOP';                                          0886 03385000
         MVC   NEWID2(4,@02),@CC01230                              0886 03386000
*        OPENLIST = ''B;                                           0887 03387000
         XC    OPENLIST(48),OPENLIST                               0887 03388000
*        OPNPTR = ADDR(OPENLIST);                                  0888 03389000
         LA    OPNPTR,OPENLIST                                     0888 03390000
*        IF OTYPE = 'O'                                            0889 03391000
*          THEN                                                    0889 03392000
         L     @02,@PC00006                                        0889 03393000
         CLI   OTYPE(@02),C'O'                                     0889 03394000
         BNE   @RF00889                                            0889 03395000
*            /********************************************************/ 03396000
*            /*                                                      */ 03397000
*            /*  OPEN FOR OUTPUT SPECIFIED - SET VBS  FORMAT         */ 03398000
*            /*                                                      */ 03399000
*            /********************************************************/ 03400000
*                                                                  0890 03401000
*            DO;                                                   0890 03402000
*            OPNOPTOT = ON;                                        0891 03403000
         OI    OPNOPTOT(OPNPTR),B'01000000'                        0891 03404000
*            OPNRFMSF = ON;                                        0892 03405000
*            OPNRFMBK = ON;                                        0893 03406000
         OI    OPNRFMSF(OPNPTR),B'00011000'                        0893 03407000
*            OPNBLK = OBLK;                                        0894 03408000
         L     @02,@PC00006+16                                     0894 03409000
         L     @02,OBLK(,@02)                                      0894 03410000
         ST    @02,OPNBLK(,OPNPTR)                                 0894 03411000
*            OPNREC = OREC;                                        0895 03412000
*                                                                  0895 03413000
         L     @02,@PC00006+12                                     0895 03414000
         L     @02,OREC(,@02)                                      0895 03415000
         ST    @02,OPNREC(,OPNPTR)                                 0895 03416000
*            /********************************************************/ 03417000
*            /*                                                      */ 03418000
*            /*  PROCESS ENVIRONMENT PARAMETER FOR DOS TO SPECIFY    */ 03419000
*            /*  DEVICE TYPES ON EXPORT COMMAND                      */ 03420000
*            /*                                                      */ 03421000
*            /********************************************************/ 03422000
*                                                                  0896 03423000
*            IF ADDR(ENVIR) ^= NULLPTR                             0896 03424000
*              THEN                                                0896 03425000
         SLR   @02,@02                                             0896 03426000
         L     @15,@PC00001+4                                      0896 03427000
         C     @02,FDTPTR+16(,@15)                                 0896 03428000
         BE    @RF00896                                            0896 03429000
*                DO;                                               0897 03430000
*                IF ADDR(PDEV) ^= NULLPTR                          0898 03431000
*                  THEN                                            0898 03432000
         L     @15,FDTPTR+76(,@15)                                 0898 03433000
         CR    @15,@02                                             0898 03434000
         BE    @RF00898                                            0898 03435000
*                    OPNDEVDT = ADDR(PDEVVAL);                     0899 03436000
*                                                                  0899 03437000
         LA    @02,PDEVVAL(,@15)                                   0899 03438000
         ST    @02,OPNDEVDT(,OPNPTR)                               0899 03439000
*                /****************************************************/ 03440000
*                /*                                          @Y30SSFR*/ 03441000
*                /*  IF THE USER HAS SPECIFIED THE BLKSZ     @Y30SSFR*/ 03442000
*                /*  SUBPARAMETER, RESET THE VALUE OF OPNBLK @Y30SSFR*/ 03443000
*                /*  TO THAT GIVEN BY THE USER.              @Y30SSFR*/ 03444000
*                /*                                          @Y30SSFR*/ 03445000
*                /****************************************************/ 03446000
*                                                                  0900 03447000
*                IF ADDR(BLKSZ) ^= NULLPTR                 /*@Y30SSFR*/ 03448000
*                  THEN                                    /*@Y30SSFR*/ 03449000
@RF00898 L     @02,@PC00001+4                                      0900 03450000
         L     @02,FDTPTR+80(,@02)                                 0900 03451000
         LTR   @02,@02                                             0900 03452000
         BZ    @RF00900                                            0900 03453000
*                    OPNBLK = BLKSZVAL;                    /*@Y30SSFR*/ 03454000
*                                                                  0901 03455000
         L     @02,BLKSZVAL(,@02)                                  0901 03456000
         ST    @02,OPNBLK(,OPNPTR)                                 0901 03457000
*                END;                                              0902 03458000
@RF00900 DS    0H                                                  0903 03459000
*             IF ADDR(OUTDD) = NULLPTR                             0903 03460000
*               THEN                                               0903 03461000
@RF00896 L     @02,@PC00001+4                                      0903 03462000
         L     @02,FDTPTR+12(,@02)                                 0903 03463000
         LTR   @02,@02                                             0903 03464000
         BNZ   @RF00903                                            0903 03465000
*                 OPNDSN = ODSN;                           /*@YL026UA*/ 03466000
         L     @02,@PC00006+8                                      0904 03467000
         L     @02,ODSN(,@02)                                      0904 03468000
         ST    @02,OPNDSN(,OPNPTR)                                 0904 03469000
*               ELSE                                               0905 03470000
*                 OPNDDN = ODD;                            /*@YL026UA*/ 03471000
         B     @RC00903                                            0905 03472000
@RF00903 L     @02,@PC00006+4                                      0905 03473000
         L     @02,ODD(,@02)                                       0905 03474000
         ST    @02,OPNDDN(,OPNPTR)                                 0905 03475000
*            END;                                                  0906 03476000
*                                                                  0906 03477000
@RC00903 DS    0H                                                  0907 03478000
*        IF OTYPE = 'I'                                            0907 03479000
*          THEN                                                    0907 03480000
*                                                                  0907 03481000
@RF00889 L     @02,@PC00006                                        0907 03482000
         CLI   OTYPE(@02),C'I'                                     0907 03483000
         BNE   @RF00907                                            0907 03484000
*            /********************************************************/ 03485000
*            /*                                                      */ 03486000
*            /*  OPEN VSAM CLUSTER FOR INPUT AND RECORD PROCESSING   */ 03487000
*            /*  SET THE EXPORT/IMPORT FLAG IN THE OPENAGL.  @Y30SSFR*/ 03488000
*            /*                                                      */ 03489000
*            /********************************************************/ 03490000
*                                                                  0908 03491000
*            DO;                                                   0908 03492000
*            OPNOPTIN = ON;                                        0909 03493000
         OI    OPNOPTIN(OPNPTR),B'10000000'                        0909 03494000
*            OPNTYPXM = ON;                                /*@Y30SSFR*/ 03495000
*                                                                  0910 03496000
         OI    OPNTYPXM(OPNPTR),B'00010000'                        0910 03497000
*            /********************************************************/ 03498000
*            /*                                              @Y30SSFR*/ 03499000
*            /*  IF EXPORTING AN AIX, SET THE OPNMODAX BIT   @Y30SSFR*/ 03500000
*            /*  SO THAT WHEN OPENING BY PATH NAME, THE AIX  @Y30SSFR*/ 03501000
*            /*  IS OPENED RATHER THAN THE BASE CLUSTER.     @Y30SSFR*/ 03502000
*            /*                                              @Y30SSFR*/ 03503000
*            /********************************************************/ 03504000
*                                                                  0911 03505000
*            IF AIXFLAG = ON                               /*@Y30SSFR*/ 03506000
*              THEN                                        /*@Y30SSFR*/ 03507000
         TM    AIXFLAG,B'10000000'                                 0911 03508000
         BNO   @RF00911                                            0911 03509000
*                OPNMODAX = ON;                            /*@Y30SSFR*/ 03510000
*                                                                  0912 03511000
         OI    OPNMODAX(OPNPTR),B'00001000'                        0912 03512000
*            CTGFLPTR = PTRCPL(1) -> CTGFIELD(IPASSWOR);           0913 03513000
@RF00911 L     @01,PTRCPL                                          0913 03514000
         L     CTGFLPTR,CTGFIELD+36(,@01)                          0913 03515000
*            IF CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR            0914 03516000
*              THEN                                                0914 03517000
         SLR   @15,@15                                             0914 03518000
         C     @15,CTGFLNG(,CTGFLPTR)                              0914 03519000
         BE    @RF00914                                            0914 03520000
         L     @14,CTGFLPT(,CTGFLPTR)                              0914 03521000
         CR    @14,@15                                             0914 03522000
         BE    @RF00914                                            0914 03523000
*                OPNPWA = CTGFLPT(1);                              0915 03524000
         ST    @14,OPNPWA(,OPNPTR)                                 0915 03525000
*              ELSE                                                0916 03526000
*                IF ENTPLN > 0                                     0916 03527000
*                  THEN                                            0916 03528000
         B     @RC00914                                            0916 03529000
@RF00914 L     @02,@PC00001+4                                      0916 03530000
         L     @02,FDTPTR(,@02)                                    0916 03531000
         CLI   ENTPLN(@02),0                                       0916 03532000
         BNH   @RF00916                                            0916 03533000
*                    OPNPWA = ADDR(ENTPAS);                        0917 03534000
         LA    @02,ENTPAS(,@02)                                    0917 03535000
         ST    @02,OPNPWA(,OPNPTR)                                 0917 03536000
*             OPNDDN = ODD;                                /*@YL026UA*/ 03537000
@RF00916 DS    0H                                                  0918 03538000
@RC00914 L     @02,@PC00006+4                                      0918 03539000
         L     @02,ODD(,@02)                                       0918 03540000
         ST    @02,OPNDDN(,OPNPTR)                                 0918 03541000
*            END;                                                  0919 03542000
*                                                                  0919 03543000
*                                                                  0919 03544000
*        /************************************************************/ 03545000
*        /*                                                          */ 03546000
*        /*  SET FIELDS IN OPNAGL THAT ARE COMMON FOR OUTPUT AND     */ 03547000
*        /*  INPUT                                                   */ 03548000
*        /*                                                          */ 03549000
*        /************************************************************/ 03550000
*                                                                  0920 03551000
*        OPNIOC = OIOCS;                                           0920 03552000
*                                                                  0920 03553000
@RF00907 L     @15,@PC00006+20                                     0920 03554000
         L     @15,OIOCS(,@15)                                     0920 03555000
         ST    @15,OPNIOC(,OPNPTR)                                 0920 03556000
*        /************************************************************/ 03557000
*        /*                                                          */ 03558000
*        /*  ISSUE THE UOPEN MACRO TO OPEN INPUT OR OUTPUT DATA SET  */ 03559000
*        /*                                                          */ 03560000
*        /************************************************************/ 03561000
*                                                                  0921 03562000
*        CALL IDCIOOP0 (GDTTBL,OPNAGL);                            0921 03563000
*                                                                  0921 03564000
         L     @15,@PC00001                                        0921 03565000
         ST    @15,@AL00001                                        0921 03566000
         ST    OPNPTR,@AL00001+4                                   0921 03567000
         MVI   @AL00001+4,X'80'                                    0921 03568000
         L     @15,GDTOPN(,@15)                                    0921 03569000
         LA    @01,@AL00001                                        0921 03570000
         BALR  @14,@15                                             0921 03571000
*        RESPECIFY RTNREG RSTD;                                    0922 03572000
*        TESTRC = RTNREG;                                          0923 03573000
         LR    TESTRC,RTNREG                                       0923 03574000
*        RESPECIFY RTNREG UNRSTD;                                  0924 03575000
*                                                                  0924 03576000
*        /************************************************************/ 03577000
*        /*                                                          */ 03578000
*        /*  TEST RETURN CODE FROM OPEN.  IF NOT SUCCESSFUL, CLOSE   */ 03579000
*        /*  DATA SET TO FREE CORE, AND SET RETURN CODE TO FAILURE   */ 03580000
*        /*                                                          */ 03581000
*        /************************************************************/ 03582000
*                                                                  0925 03583000
*        IF TESTRC ^= 0                                            0925 03584000
*          THEN                                                    0925 03585000
         LTR   TESTRC,TESTRC                                       0925 03586000
         BZ    @RF00925                                            0925 03587000
*            DO;                                                   0926 03588000
*                                                                  0926 03589000
*            CALL IDCIOCL0 (GDTTBL,OIOCSPTR);                      0927 03590000
*                                                                  0927 03591000
         L     @15,@PC00001                                        0927 03592000
         ST    @15,@AL00001                                        0927 03593000
         L     @14,@PC00006+20                                     0927 03594000
         L     @01,OIOCS(,@14)                                     0927 03595000
         ST    @01,@AL00001+4                                      0927 03596000
         MVI   @AL00001+4,X'80'                                    0927 03597000
         L     @15,GDTCLS(,@15)                                    0927 03598000
         LA    @01,@AL00001                                        0927 03599000
         BALR  @14,@15                                             0927 03600000
*            OIOCSPTR = NULLPTR;                                   0928 03601000
         L     @15,@PC00006+20                                     0928 03602000
         L     @01,OIOCS(,@15)                                     0928 03603000
         SLR   @00,@00                                             0928 03604000
         ST    @00,OIOCSPTR(,@01)                                  0928 03605000
*            RETURN CODE(LASTCC12);                                0929 03606000
         LA    @15,12                                              0929 03607000
         L     @14,@SA00006                                        0929 03608000
         LM    @00,@12,@SA00006+8                                  0929 03609000
         BR    @14                                                 0929 03610000
*            END;                                                  0930 03611000
*          ELSE                                                    0931 03612000
*                                                                  0931 03613000
*            /********************************************************/ 03614000
*            /*                                                      */ 03615000
*            /*  RETURN TO CALLER INDICATING SUCCESSFUL COMPLETION   */ 03616000
*            /*  OF OPEN                                             */ 03617000
*            /*                                                      */ 03618000
*            /********************************************************/ 03619000
*                                                                  0931 03620000
*            RETURN CODE(0);                                       0931 03621000
*                                                                  0931 03622000
@RF00925 SLR   @15,@15                                             0931 03623000
         L     @14,@SA00006                                        0931 03624000
         LM    @00,@12,@SA00006+8                                  0931 03625000
         BR    @14                                                 0931 03626000
*END OPENPROC;                                                     0932 03627000
*        /************************************************************/ 03628000
*        /*                                                          */ 03629000
*        /*  PROCEDURE NAME - ALTRPROC                               */ 03630000
*        /*                                                          */ 03631000
*        /*  FUNCTION - WILL MODIFY THE CPL FOR CATALOG ALTER        */ 03632000
*        /*  OPERATION, SO THAT DSATTR CATALOG FIELD CAN BE MODIFIED */ 03633000
*        /*                                                          */ 03634000
*        /*  INPUT - CPL POINTER FOR CPL TO BE MODIFIED              */ 03635000
*        /*                                                          */ 03636000
*        /*  OUTPUT - POINTER TO CONSTRUCTED CPL                     */ 03637000
*        /*                                                          */ 03638000
*        /************************************************************/ 03639000
*                                                                  0933 03640000
*ALTRPROC: PROCEDURE(ACPLPTR);         /*CPL POINTER                 */ 03641000
*                                                                  0933 03642000
ALTRPROC STM   @14,@05,@SA00007                                    0933 03643000
         STM   @07,@12,@SA00007+32                                 0933 03644000
         MVC   @PC00007(4),0(@01)                                  0933 03645000
*        /************************************************************/ 03646000
*        /*                                                          */ 03647000
*        /*  ARGUMENTS OF INVOCATION                                 */ 03648000
*        /*                                                          */ 03649000
*        /************************************************************/ 03650000
*                                                                  0934 03651000
*        DCL ACPLPTR PTR(31);          /* CPL POINTER                */ 03652000
*                                                                  0934 03653000
*        /************************************************************/ 03654000
*        /*                                                          */ 03655000
*        /*  LOCAL DECLARATIONS                                      */ 03656000
*        /*                                                          */ 03657000
*        /************************************************************/ 03658000
*                                                                  0935 03659000
*        DCL A1CPLPTR  PTR(31);        /*ADDR OF CONSTRUCTED CPL     */ 03660000
*        DCL AFVTPTR   PTR(31);        /*ADDR OF CONSTRUCTED FVT     */ 03661000
*                                                                  0936 03662000
*        /************************************************************/ 03663000
*        /*                                                          */ 03664000
*        /*  FIRST GET CORE FOR FIELD VECTOR TABLE (FVT) WHICH WILL  */ 03665000
*        /*  POINT TO ENTNAME FPL AND DSATTR FPL (FIELD PARAMETER    */ 03666000
*        /*  BLOCK)                                                  */ 03667000
*        /*                                                          */ 03668000
*        /************************************************************/ 03669000
*                                                                  0937 03670000
*        OLDERID2 = NEWERID2;                                      0937 03671000
         L     @07,@PC00001                                        0937 03672000
         L     @03,GDTTR2(,@07)                                    0937 03673000
         MVC   @TS00001(95),NEWERID2(@03)                          0937 03674000
         MVC   OLDERID2(95,@03),@TS00001                           0937 03675000
*        NEWID2 = 'XPAP';                                          0938 03676000
*                                                                  0938 03677000
         MVC   NEWID2(4,@03),@CC01238                              0938 03678000
*        CALL IDCSAGP0 (GDTTBL,(LENGTH(CTGFV)+LENGTH(CTGPL)),A1CPLPTR,  03679000
*                GPID,SETZERO);                                    0939 03680000
*                                                                  0939 03681000
         ST    @07,@AL00001                                        0939 03682000
         LA    @03,120                                             0939 03683000
         ST    @03,@AFTEMPS+16                                     0939 03684000
         LA    @03,@AFTEMPS+16                                     0939 03685000
         ST    @03,@AL00001+4                                      0939 03686000
         LA    @03,A1CPLPTR                                        0939 03687000
         ST    @03,@AL00001+8                                      0939 03688000
         LA    @03,GPID                                            0939 03689000
         ST    @03,@AL00001+12                                     0939 03690000
         LA    @03,SETZERO                                         0939 03691000
         ST    @03,@AL00001+16                                     0939 03692000
         MVI   @AL00001+16,X'80'                                   0939 03693000
         L     @15,GDTGPL(,@07)                                    0939 03694000
         LA    @01,@AL00001                                        0939 03695000
         BALR  @14,@15                                             0939 03696000
*        RESPECIFY RTNREG RSTD;                                    0940 03697000
*        TESTRC = RTNREG;                                          0941 03698000
         LR    TESTRC,RTNREG                                       0941 03699000
*        RESPECIFY RTNREG UNRSTD;                                  0942 03700000
*                                                                  0942 03701000
*        /************************************************************/ 03702000
*        /*                                                          */ 03703000
*        /*  IF CORE WAS NOT OBTAINED SUCCESSFULLY, PROCESSING IS    */ 03704000
*        /*  TERMINATED AND CONTROL RETURNS TO THE CALLING PROCESSOR */ 03705000
*        /*  WITH SETRC SET TO INDICATE FAILURE                      */ 03706000
*        /*                                                          */ 03707000
*        /************************************************************/ 03708000
*                                                                  0943 03709000
*        IF TESTRC ^= 0                                            0943 03710000
*          THEN                                                    0943 03711000
         LTR   TESTRC,TESTRC                                       0943 03712000
         BZ    @RF00943                                            0943 03713000
*            DO;                                                   0944 03714000
*            DARGSMOD = UNIVMSG;                                   0945 03715000
         L     @07,DDSTRU                                          0945 03716000
         MVC   DARGSMOD(3,@07),@CC00930                            0945 03717000
*            DEFSTID = NOSTORAG;                                   0946 03718000
         LA    DEFSTID,4                                           0946 03719000
*            RETURN CODE(LASTCC12);                                0947 03720000
         LA    @15,12                                              0947 03721000
         L     @14,@SA00007                                        0947 03722000
         LM    @00,@05,@SA00007+8                                  0947 03723000
         LM    @07,@12,@SA00007+32                                 0947 03724000
         BR    @14                                                 0947 03725000
*            END;                                                  0948 03726000
*                                                                  0948 03727000
*        /************************************************************/ 03728000
*        /*                                                          */ 03729000
*        /*  MODIFY CPL FOR AN ALTER OPERATION                       */ 03730000
*        /*                                                          */ 03731000
*        /************************************************************/ 03732000
*                                                                  0949 03733000
*        CTGPLPTR = A1CPLPTR;                                      0949 03734000
@RF00943 L     @07,A1CPLPTR                                        0949 03735000
         ST    @07,CTGPLPTR                                        0949 03736000
*        CTGAM0= ON;                                               0950 03737000
*        CTGNUM = ON;                                              0951 03738000
         OI    CTGAM0(@07),B'00000011'                             0951 03739000
*        CTGNAME = ON;                                             0952 03740000
         OI    CTGNAME(@07),B'00000100'                            0952 03741000
*        CTGCAT = ADDR(PTRCTACB);                                  0953 03742000
         LA    @15,PTRCTACB                                        0953 03743000
         ST    @15,CTGCAT(,@07)                                    0953 03744000
*        CTGFUNC = CTGCMS;                                         0954 03745000
         NI    CTGFUNC(@07),B'10011111'                            0954 03746000
         OI    CTGFUNC(@07),B'10000000'                            0954 03747000
*        CTGOPTNS = CTGALTER;                                      0955 03748000
         NI    CTGOPTNS(@07),B'00010111'                           0955 03749000
         OI    CTGOPTNS(@07),B'00010000'                           0955 03750000
*        CTGNAME = ON;                                             0956 03751000
*                                                                  0956 03752000
         OI    CTGNAME(@07),B'00000100'                            0956 03753000
*        /************************************************************/ 03754000
*        /*                                                          */ 03755000
*        /*  PLACE PASSWORD INFORMATION INTO CPL IF AVAILABLE         * 03756000
*        /*                                                          */ 03757000
*        /************************************************************/ 03758000
*                                                                  0957 03759000
*        IF ENTPLN > 0                                             0957 03760000
*          THEN                                                    0957 03761000
         L     @15,@PC00001+4                                      0957 03762000
         L     @15,FDTPTR(,@15)                                    0957 03763000
         CLI   ENTPLN(@15),0                                       0957 03764000
         BNH   @RF00957                                            0957 03765000
*            CTGPSWD = ADDR(ENTPAS);                               0958 03766000
         LA    @15,ENTPAS(,@15)                                    0958 03767000
         ST    @15,CTGPSWD(,@07)                                   0958 03768000
*          ELSE                                                    0959 03769000
*            DO;                                                   0959 03770000
         B     @RC00957                                            0959 03771000
@RF00957 DS    0H                                                  0960 03772000
*            CTGFLPTR = ACPLPTR -> CTGFIELD(IPASSWOR);             0960 03773000
         L     @07,@PC00007                                        0960 03774000
         L     @07,ACPLPTR(,@07)                                   0960 03775000
         L     CTGFLPTR,CTGFIELD+36(,@07)                          0960 03776000
*            IF CTGFLNG(1) ^= 0  & CTGFLPT(1) ^= NULLPTR           0961 03777000
*              THEN                                                0961 03778000
         SLR   @07,@07                                             0961 03779000
         C     @07,CTGFLNG(,CTGFLPTR)                              0961 03780000
         BE    @RF00961                                            0961 03781000
         L     @03,CTGFLPT(,CTGFLPTR)                              0961 03782000
         CR    @03,@07                                             0961 03783000
         BE    @RF00961                                            0961 03784000
*                CTGPSWD = CTGFLPT(1);                             0962 03785000
         L     @07,CTGPLPTR                                        0962 03786000
         ST    @03,CTGPSWD(,@07)                                   0962 03787000
*            END;                                          /*@Y30SSFR*/ 03788000
*                                                                  0963 03789000
@RF00961 DS    0H                                                  0964 03790000
*        CTGFVT = CTGPLPTR + LENGTH(CTGPL);                        0964 03791000
@RC00957 L     @07,CTGPLPTR                                        0964 03792000
         LA    @03,28                                              0964 03793000
         ALR   @03,@07                                             0964 03794000
         ST    @03,CTGFVT(,@07)                                    0964 03795000
*        AFVTPTR = CTGFVT;                                         0965 03796000
*                                                                  0965 03797000
         LR    AFVTPTR,@03                                         0965 03798000
*        /************************************************************/ 03799000
*        /*                                                          */ 03800000
*        /*  SET FPL POINTERS IN FVT TO DSATTR AND ENTNAME FPLS      */ 03801000
*        /*  BECAUSE THE FPL'S HAVE BEEN USED BY LOCATE              */ 03802000
*        /*                                                          */ 03803000
*        /************************************************************/ 03804000
*                                                                  0966 03805000
*        CTGPLPTR = ACPLPTR;                                       0966 03806000
         L     @07,@PC00007                                        0966 03807000
         L     @03,ACPLPTR(,@07)                                   0966 03808000
         ST    @03,CTGPLPTR                                        0966 03809000
*        CTGFVT = AFVTPTR;                                         0967 03810000
         ST    AFVTPTR,CTGFVT(,@03)                                0967 03811000
*        CTGFLPTR = CTGFIELD(IENTYPE);                             0968 03812000
         L     CTGFLPTR,CTGFIELD(,@03)                             0968 03813000
*        CTGFVTYP = FENTYPE;             /*  ENTRY TYPE              */ 03814000
         L     @01,CTGPLPTR                                        0969 03815000
         L     @15,CTGFVT(,@01)                                    0969 03816000
         L     @01,CTGFLPT(,CTGFLPTR)                              0969 03817000
         MVC   CTGFVTYP(1,@15),FENTYPE(@01)                        0969 03818000
*        CTGFLPTR = CTGFIELD(IENTNAME);                            0970 03819000
         L     CTGFLPTR,CTGFIELD+4(,@03)                           0970 03820000
*        CTGFVENT = CTGFLPT(1);          /*  ENTRY NAME              */ 03821000
         L     @14,CTGFLPT(,CTGFLPTR)                              0971 03822000
         ST    @14,CTGFVENT(,@15)                                  0971 03823000
*        CTGFVATR = CTGFIELD(IDSATTR);                             0972 03824000
         L     @03,CTGFIELD+8(,@03)                                0972 03825000
         ST    @03,CTGFVATR(,@15)                                  0972 03826000
*        CTGFLPTR = CTGFVATR;            /*  DATA SET ATTRIBUTES     */ 03827000
         LR    CTGFLPTR,@03                                        0973 03828000
*        CTGFLDWA = ''B;                                           0974 03829000
         XC    CTGFLDWA(4,CTGFLPTR),CTGFLDWA(CTGFLPTR)             0974 03830000
*        CTGFLCHN = NULLPTR;                                       0975 03831000
         SLR   @03,@03                                             0975 03832000
         ST    @03,CTGFLCHN(,CTGFLPTR)                             0975 03833000
*        CTGFVIND = ADDR(INDDVAL);                         /*@Y30SSFR*/ 03834000
*                                                                  0976 03835000
         L     @14,@PC00001+4                                      0976 03836000
         L     @01,FDTPTR+4(,@14)                                  0976 03837000
         LA    @14,INDDVAL(,@01)                                   0976 03838000
         ST    @14,CTGFVIND(,@15)                                  0976 03839000
*        /************************************************************/ 03840000
*        /*                                                          */ 03841000
*        /*  NOW RESET ACPLPTR TO THE NEWLY CONSTRUCTED CPL WHICH    */ 03842000
*        /*  CONTAINS A POINTER TO THE NEWLY CONSTRUCTED FVT, AND    */ 03843000
*        /*  RETURN TO CALLER.                                       */ 03844000
*        /*                                                          */ 03845000
*        /************************************************************/ 03846000
*                                                                  0977 03847000
*        ACPLPTR = A1CPLPTR;                                       0977 03848000
*                                                                  0977 03849000
         L     @02,A1CPLPTR                                        0977 03850000
         ST    @02,ACPLPTR(,@07)                                   0977 03851000
*        RETURN CODE(0);                                           0978 03852000
*                                                                  0978 03853000
         LR    @15,@03                                             0978 03854000
         L     @14,@SA00007                                        0978 03855000
         LM    @00,@05,@SA00007+8                                  0978 03856000
         LM    @07,@12,@SA00007+32                                 0978 03857000
         BR    @14                                                 0978 03858000
*END ALTRPROC;                                                     0979 03859000
*        /************************************************************/ 03860000
*        /*                                                          */ 03861000
*        /*  PROCEDURE NAME - DELTPROC                               */ 03862000
*        /*                                                          */ 03863000
*        /*  FUNCTION - CONSTRUCT A CATALOG PARAMETER LIST (CPL) TO  */ 03864000
*        /*  BE EMPLOYED BY CATALOG DELETE TO DELETE A CLUSTER OR    */ 03865000
*        /*  TO DISCONNECT A USER CATALOG                            */ 03866000
*        /*                                                          */ 03867000
*        /*  INPUT -                                                 */ 03868000
*        /*    .DTYPE - TYPE OF DELETE REQUEST                       */ 03869000
*        /*              'U' = USER CATALOG DISCONNECT               */ 03870000
*        /*              'C' = CLUSTER OBJECT DELETE                 */ 03871000
*        /*              'G' = AIX OBJECT TO BE DELETED      @Y30SSFR*/ 03872000
*        /*    .DENTVAL - NAME OF OBJECT TO BE DELETED               */ 03873000
*        /*    .DCPL - RETURN CELL FOR CPL POINTER                   */ 03874000
*        /*                                                          */ 03875000
*        /*  OUTPUT - POINTER TO CPL CONSTRUCTED                     */ 03876000
*        /*                                                          */ 03877000
*        /************************************************************/ 03878000
*                                                                  0980 03879000
*DELTPROC: PROCEDURE(DTYPE,            /*TYPE OF REQUEST             */ 03880000
*                    DENTVAL,          /*NAME OF OBJECT              */ 03881000
*                    DCPL);            /*RETURN CELL FOR CPL         */ 03882000
*                                                                  0980 03883000
DELTPROC STM   @14,@05,@SA00008                                    0980 03884000
         STM   @07,@12,@SA00008+32                                 0980 03885000
         MVC   @PC00008(12),0(@01)                                 0980 03886000
*        /************************************************************/ 03887000
*        /*                                                          */ 03888000
*        /*  ARGUMENTS OF INVOCATION                                 */ 03889000
*        /*                                                          */ 03890000
*        /************************************************************/ 03891000
*                                                                  0981 03892000
*        DCL                                                       0981 03893000
*          DTYPE   CHAR(1),                                        0981 03894000
*          DENTVAL PTR(31),                                        0981 03895000
*          DCPL    PTR(31);                                        0981 03896000
*                                                                  0981 03897000
*        /************************************************************/ 03898000
*        /*                                                  @Y30SSFR*/ 03899000
*        /*  SIZE TO BE REQUESTED IN CALL TO UGPOOL.         @Y30SSFR*/ 03900000
*        /*                                                  @Y30SSFR*/ 03901000
*        /************************************************************/ 03902000
*                                                                  0982 03903000
*        DCL DSIZE FIXED(31);                              /*@Y30SSFR*/ 03904000
*                                                                  0982 03905000
*        /************************************************************/ 03906000
*        /*                                                  @Y30SSFR*/ 03907000
*        /*  INDEX TO THE OBJECT TO BE ALLOCATED ON A VSAM   @Y30SSFR*/ 03908000
*        /*  CATALOG RETURN CODE OF 72.                      @Y30SSFR*/ 03909000
*        /*                                                  @Y30SSFR*/ 03910000
*        /************************************************************/ 03911000
*                                                                  0983 03912000
*        DCL ALLOINDX FIXED(31);                           /*@Y30SSFR*/ 03913000
*                                                                  0983 03914000
*        /************************************************************/ 03915000
*        /*                                                  @Y30SSFR*/ 03916000
*        /*  LOOP CONTROL VARIABLES.                         @Y30SSFR*/ 03917000
*        /*                                                  @Y30SSFR*/ 03918000
*        /************************************************************/ 03919000
*                                                                  0984 03920000
*        DCL DEFINED BIT(1);           /*VARIABLE USED TO    @Y30SSFR*/ 03921000
*                                      /*CONTROL THE LOOP    @Y30SSFR*/ 03922000
*                                      /*CATALOG             @Y30SSFR*/ 03923000
*        DCL IND1    FIXED(31);        /*INDEX USED TO CLEAR @Y30SSFR*/ 03924000
*                                      /*WORK AREA           @Y30SSFR*/ 03925000
*        DCL IX      FIXED(31);        /*INDEX USED TO PRINT @Y30SSFR*/ 03926000
*                                      /*NAMES FROM THE      @Y30SSFR*/ 03927000
*                                      /*WORK AREA           @Y30SSFR*/ 03928000
*                                                                  0987 03929000
*        /************************************************************/ 03930000
*        /*                                                  @Y30SSFR*/ 03931000
*        /*  NUMBER OF OBJECTS IN THE WORKAREA ON A VSAM     @Y30SSFR*/ 03932000
*        /*  CATALOG RETURN CODE OF 40.                      @Y30SSFR*/ 03933000
*        /*                                                  @Y30SSFR*/ 03934000
*        /************************************************************/ 03935000
*                                                                  0987 03936000
*        DCL MNOENT FIXED(31);                             /*@Y30SSFR*/ 03937000
*        /************************************************************/ 03938000
*        /*                                                          */ 03939000
*        /*  GET CORE IN WHICH TO CONSTRUCT CPL                      */ 03940000
*        /*                                                          */ 03941000
*        /************************************************************/ 03942000
*                                                                  0988 03943000
*        OLDERID2 = NEWERID2;                                      0988 03944000
         L     @07,@PC00001                                        0988 03945000
         L     @03,GDTTR2(,@07)                                    0988 03946000
         MVC   @TS00001(95),NEWERID2(@03)                          0988 03947000
         MVC   OLDERID2(95,@03),@TS00001                           0988 03948000
*        NEWID2 = 'XPDP';                                          0989 03949000
*                                                                  0989 03950000
         MVC   NEWID2(4,@03),@CC01254                              0989 03951000
*        CALL IDCSAGP0 (GDTTBL,LENGTH(CTGPL),DCPL,GPID,SETZERO);   0990 03952000
*                                                                  0990 03953000
         MVC   @AL00001+4(16),@AL00990                             0990 03954000
         ST    @07,@AL00001                                        0990 03955000
         L     @03,@PC00008+8                                      0990 03956000
         ST    @03,@AL00001+8                                      0990 03957000
         L     @15,GDTGPL(,@07)                                    0990 03958000
         LA    @01,@AL00001                                        0990 03959000
         BALR  @14,@15                                             0990 03960000
*        RESPECIFY RTNREG RSTD;                                    0991 03961000
*        TESTRC = RTNREG;                                          0992 03962000
         LR    TESTRC,RTNREG                                       0992 03963000
*        RESPECIFY RTNREG UNRSTD;                                  0993 03964000
*                                                                  0993 03965000
*        /************************************************************/ 03966000
*        /*                                                          */ 03967000
*        /*  IF CORE CAN NOT BE OBTAINED, RETURN TO CALLING          */ 03968000
*        /*  PROCESSOR INDICATING FAILURE                            */ 03969000
*        /*                                                          */ 03970000
*        /************************************************************/ 03971000
*                                                                  0994 03972000
*        IF TESTRC ^= 0                                            0994 03973000
*          THEN                                                    0994 03974000
         LTR   TESTRC,TESTRC                                       0994 03975000
         BZ    @RF00994                                            0994 03976000
*            DO;                                                   0995 03977000
*            DARGSMOD = UNIVMSG;                                   0996 03978000
         L     @07,DDSTRU                                          0996 03979000
         MVC   DARGSMOD(3,@07),@CC00930                            0996 03980000
*            DEFSTID = NOSTORAG;                                   0997 03981000
         LA    DEFSTID,4                                           0997 03982000
*            RETURN CODE(LASTCC12);                                0998 03983000
         LA    @15,12                                              0998 03984000
         L     @14,@SA00008                                        0998 03985000
         LM    @00,@05,@SA00008+8                                  0998 03986000
         LM    @07,@12,@SA00008+32                                 0998 03987000
         BR    @14                                                 0998 03988000
*            END;                                                  0999 03989000
*                                                                  0999 03990000
*        /************************************************************/ 03991000
*        /*                                                          */ 03992000
*        /*  INITIALIZE FIELDS IN THE CPL                            */ 03993000
*        /*                                                          */ 03994000
*        /************************************************************/ 03995000
*                                                                  1000 03996000
*        CTGPLPTR = DCPL;                                          1000 03997000
@RF00994 L     @07,@PC00008+8                                      1000 03998000
         L     @07,DCPL(,@07)                                      1000 03999000
         ST    @07,CTGPLPTR                                        1000 04000000
*        CTGAM0 = ON;                  /* VSAM REQUEST               */ 04001000
         OI    CTGAM0(@07),B'00000001'                             1001 04002000
*        CTGENT = DENTVAL;             /* POINTER TO ENTRY NAME      */ 04003000
         L     @15,@PC00008+4                                      1002 04004000
         L     @15,DENTVAL(,@15)                                   1002 04005000
         ST    @15,CTGENT(,@07)                                    1002 04006000
*        CTGNAME = ON;                 /* NAME FLAG                  */ 04007000
*                                                                  1003 04008000
         OI    CTGNAME(@07),B'00000100'                            1003 04009000
*        /************************************************************/ 04010000
*        /*                                                          */ 04011000
*        /*  DETERMINE IF PASSWORD SUPPLIED AND IF SO PUT IN CPL     */ 04012000
*        /*                                                          */ 04013000
*        /************************************************************/ 04014000
*                                                                  1004 04015000
*        IF ENTPLN ^= 0                                            1004 04016000
*          THEN                                                    1004 04017000
         L     @15,@PC00001+4                                      1004 04018000
         L     @15,FDTPTR(,@15)                                    1004 04019000
         CLI   ENTPLN(@15),0                                       1004 04020000
         BE    @RF01004                                            1004 04021000
*            CTGPSWD = ADDR(ENTPAS);                               1005 04022000
*                                                                  1005 04023000
         LA    @15,ENTPAS(,@15)                                    1005 04024000
         ST    @15,CTGPSWD(,@07)                                   1005 04025000
*        /************************************************************/ 04026000
*        /*                                                          */ 04027000
*        /* TEST FOR CATALOG ACB SUPPLIED  IF IT IS NOT INDICATE     */ 04028000
*        /* THAT THE CATALOG NAME IS SUPPLIED                        */ 04029000
*        /*                                                          */ 04030000
*        /************************************************************/ 04031000
*                                                                  1006 04032000
*        IF PTRCTACB ^= NULLPTR                                    1006 04033000
*          THEN                                                    1006 04034000
@RF01004 L     @07,PTRCTACB                                        1006 04035000
         LTR   @07,@07                                             1006 04036000
         BZ    @RF01006                                            1006 04037000
*            CTGCAT = ADDR(PTRCTACB);                              1007 04038000
         LA    @07,PTRCTACB                                        1007 04039000
         L     @01,CTGPLPTR                                        1007 04040000
         ST    @07,CTGCAT(,@01)                                    1007 04041000
*          ELSE                                                    1008 04042000
*            CTGCNAME = ON;            /* ACB NOT PASSED             */ 04043000
*                                                                  1008 04044000
         B     @RC01006                                            1008 04045000
@RF01006 L     @07,CTGPLPTR                                        1008 04046000
         OI    CTGCNAME(@07),B'00000010'                           1008 04047000
*        CTGFUNC = CTGCMS;             /*  CMS FUNCTION              */ 04048000
@RC01006 L     @07,CTGPLPTR                                        1009 04049000
         NI    CTGFUNC(@07),B'10011111'                            1009 04050000
         OI    CTGFUNC(@07),B'10000000'                            1009 04051000
*        CTGOPTNS = CTGDELET;          /*  DELETE REQUEST            */ 04052000
*                                                                  1010 04053000
         NI    CTGOPTNS(@07),B'00011111'                           1010 04054000
         OI    CTGOPTNS(@07),B'00011000'                           1010 04055000
*        /************************************************************/ 04056000
*        /*                                                          */ 04057000
*        /*  TEST TYPE FIELD.  IF TYPE INDICATES USER CATALOG,       */ 04058000
*        /*  SET DISCONNECT FLAG AND TYPE FIELD TO 'U'               */ 04059000
*        /*                                                          */ 04060000
*        /************************************************************/ 04061000
*                                                                  1011 04062000
*        IF DTYPE = 'U'                                            1011 04063000
*          THEN                                                    1011 04064000
         L     @15,@PC00008                                        1011 04065000
         CLI   DTYPE(@15),C'U'                                     1011 04066000
         BNE   @RF01011                                            1011 04067000
*            DO;                                                   1012 04068000
*            CTGDISC = ON;             /*  A DISCONNECT REQUEST      */ 04069000
         OI    CTGDISC(@07),B'00001000'                            1013 04070000
*            CTGTYPE = CTGTUCAT;       /*  USER CATALOG INDICATION   */ 04071000
         MVI   CTGTYPE(@07),C'U'                                   1014 04072000
*            END;                                                  1015 04073000
*                                                                  1015 04074000
*          /**********************************************************/ 04075000
*          /*                                                @Y30SSFR*/ 04076000
*          /*  THE TYPE IS CLUSTER OR AIX.  SET SPECIAL      @Y30SSFR*/ 04077000
*          /*  FIELDS IN CPL                                 @Y30SSFR*/ 04078000
*          /*                                                @Y30SSFR*/ 04079000
*          /**********************************************************/ 04080000
*                                                                  1016 04081000
*          ELSE                                                    1016 04082000
*            DO;                                                   1016 04083000
         B     @RC01011                                            1016 04084000
@RF01011 DS    0H                                                  1017 04085000
*            CTGTYPE = DTYPE;         /*  TYPE IS CLUSTER    @Y30SSFR*/ 04086000
         L     @07,CTGPLPTR                                        1017 04087000
         L     @15,@PC00008                                        1017 04088000
         MVC   CTGTYPE(1,@07),DTYPE(@15)                           1017 04089000
*                                      /* OR AIX             @Y30SSFR*/ 04090000
*            IF ADDR(INDD) ^= NULLPTR                      /*@Y30SSFR*/ 04091000
*              THEN                                                1018 04092000
         L     @15,@PC00001+4                                      1018 04093000
         L     @15,FDTPTR+4(,@15)                                  1018 04094000
         LTR   @15,@15                                             1018 04095000
         BZ    @RF01018                                            1018 04096000
*                CTGDDNM = ADDR(INDDVAL);  /*  INPUT DD NAME ADDRESS */ 04097000
         LA    @15,INDDVAL(,@15)                                   1019 04098000
         ST    @15,CTGDDNM(,@07)                                   1019 04099000
*              ELSE                                        /*@YL026UA*/ 04100000
*                CTGDDNM = ADDR(ALLDDN);   /*  INPUT DD NAME ADDRESS */ 04101000
         B     @RC01018                                            1020 04102000
@RF01018 L     @07,ALLPTR                                          1020 04103000
         LA    @07,ALLDDN(,@07)                                    1020 04104000
         L     @01,CTGPLPTR                                        1020 04105000
         ST    @07,CTGDDNM(,@01)                                   1020 04106000
*            IF CTGPSWD = NULLPTR                                  1021 04107000
*              THEN                                                1021 04108000
@RC01018 SLR   @07,@07                                             1021 04109000
         L     @15,CTGPLPTR                                        1021 04110000
         C     @07,CTGPSWD(,@15)                                   1021 04111000
         BNE   @RF01021                                            1021 04112000
*                DO;                                               1022 04113000
*                CTGFLPTR =  PTRCPL(1) -> CTGFIELD(IPASSWOR);      1023 04114000
         L     @01,PTRCPL                                          1023 04115000
         L     CTGFLPTR,CTGFIELD+36(,@01)                          1023 04116000
*                IF CTGFLNG(1) ^= 0                                1024 04117000
*                  THEN                                            1024 04118000
         C     @07,CTGFLNG(,CTGFLPTR)                              1024 04119000
         BE    @RF01024                                            1024 04120000
*                    CTGPSWD = CTGFLPT(1); /*  CLUSTER PASSWORD      */ 04121000
         L     @07,CTGFLPT(,CTGFLPTR)                              1025 04122000
         ST    @07,CTGPSWD(,@15)                                   1025 04123000
*                END;                                              1026 04124000
*                                                                  1026 04125000
@RF01024 DS    0H                                                  1027 04126000
*            END;                                                  1027 04127000
*                                                                  1027 04128000
@RF01021 DS    0H                                                  1028 04129000
*        /************************************************************/ 04130000
*        /*                                                          */ 04131000
*        /*  GET CORE FOR CATALOG WORK AREA WHERE OBJECT NAMES       */ 04132000
*        /*  OF DELETED OBJECTS WILL BE RETURNED                     */ 04133000
*        /*  IF CORE IS NOT OBTAINED, RETURN TO CALLING PROCESSOR    */ 04134000
*        /*                                                          */ 04135000
*        /************************************************************/ 04136000
*                                                                  1028 04137000
*        DSIZE = NUMOBJ * NMLENGTH +4;                     /*@Y30SSFR*/ 04138000
*                                                                  1028 04139000
@RC01011 LH    @07,NUMOBJ                                          1028 04140000
         MH    @07,NMLENGTH                                        1028 04141000
         AL    @07,@CF00043                                        1028 04142000
         ST    @07,DSIZE                                           1028 04143000
*        CALL IDCSAGP0 (GDTTBL,DSIZE,CTGWKA,GPID,SETZERO);         1029 04144000
*                                                                  1029 04145000
         L     @07,@PC00001                                        1029 04146000
         ST    @07,@AL00001                                        1029 04147000
         LA    @03,DSIZE                                           1029 04148000
         ST    @03,@AL00001+4                                      1029 04149000
         L     @03,CTGPLPTR                                        1029 04150000
         LA    @03,CTGWKA(,@03)                                    1029 04151000
         ST    @03,@AL00001+8                                      1029 04152000
         LA    @03,GPID                                            1029 04153000
         ST    @03,@AL00001+12                                     1029 04154000
         LA    @03,SETZERO                                         1029 04155000
         ST    @03,@AL00001+16                                     1029 04156000
         MVI   @AL00001+16,X'80'                                   1029 04157000
         L     @15,GDTGPL(,@07)                                    1029 04158000
         LA    @01,@AL00001                                        1029 04159000
         BALR  @14,@15                                             1029 04160000
*        RESPECIFY RTNREG RSTD;                                    1030 04161000
*        TESTRC = RTNREG;                                          1031 04162000
         LR    TESTRC,RTNREG                                       1031 04163000
*        RESPECIFY RTNREG UNRSTD;                                  1032 04164000
*        IF TESTRC ^= 0                                            1033 04165000
*          THEN                                                    1033 04166000
         LTR   TESTRC,TESTRC                                       1033 04167000
         BZ    @RF01033                                            1033 04168000
*            DO;                                                   1034 04169000
*            DARGSMOD = UNIVMSG;                                   1035 04170000
         L     @07,DDSTRU                                          1035 04171000
         MVC   DARGSMOD(3,@07),@CC00930                            1035 04172000
*            DEFSTID = NOSTORAG;                                   1036 04173000
         LA    DEFSTID,4                                           1036 04174000
*            RETURN CODE(LASTCC12);                                1037 04175000
         LA    @15,12                                              1037 04176000
         L     @14,@SA00008                                        1037 04177000
         LM    @00,@05,@SA00008+8                                  1037 04178000
         LM    @07,@12,@SA00008+32                                 1037 04179000
         BR    @14                                                 1037 04180000
*            END;                                                  1038 04181000
*        AREALN = DSIZE;                                           1039 04182000
*                                                                  1039 04183000
@RF01033 L     @07,CTGPLPTR                                        1039 04184000
         L     @07,CTGWKA(,@07)                                    1039 04185000
         L     @15,DSIZE                                           1039 04186000
         STH   @15,AREALN(,@07)                                    1039 04187000
*        /************************************************************/ 04188000
*        /*                                                  @Y30SSFR*/ 04189000
*        /*  IF THE TYPE IS EITHER CLUSTER OR AIX, FINISH    @Y30SSFR*/ 04190000
*        /*  BUILDING THE CPL AND CALL CATALOG TO DELETE     @Y30SSFR*/ 04191000
*        /*  THE OBJECT.                                     @Y30SSFR*/ 04192000
*        /*                                                  @Y30SSFR*/ 04193000
*        /************************************************************/ 04194000
*                                                                  1040 04195000
*        IF DTYPE = CTGTCL | DTYPE = CTGTAIX                       1040 04196000
*          THEN                                                    1040 04197000
         L     @07,@PC00008                                        1040 04198000
         CLI   DTYPE(@07),C'C'                                     1040 04199000
         BE    @RT01040                                            1040 04200000
         CLI   DTYPE(@07),C'G'                                     1040 04201000
         BNE   @RF01040                                            1040 04202000
@RT01040 DS    0H                                                  1041 04203000
*PERMEXP:    DO;                                           /*@Y30SSFR*/ 04204000
*                                                                  1041 04205000
PERMEXP  DS    0H                                                  1042 04206000
*            /********************************************************/ 04207000
*            /*                                              @Y30SSFR*/ 04208000
*            /*  IF ERASE OR NOERASE WAS SPECIFIED ON THE    @Y30SSFR*/ 04209000
*            /*  EXPORT COMMAND, SET THE APPROPRIATE BITS.   @Y30SSFR*/ 04210000
*            /*                                              @Y30SSFR*/ 04211000
*            /********************************************************/ 04212000
*                                                                  1042 04213000
*            IF ADDR(ERASE) ^= NULLPTR                             1042 04214000
*              THEN                                                1042 04215000
         L     @07,@PC00001+4                                      1042 04216000
         L     @07,FDTPTR+36(,@07)                                 1042 04217000
         LTR   @07,@07                                             1042 04218000
         BZ    @RF01042                                            1042 04219000
*                DO;                                       /*@Y30SSFR*/ 04220000
*                CTGERASE = ON;                            /*@Y30SSFR*/ 04221000
*                CTGOVRID = ON;                            /*@Y30SSFR*/ 04222000
         L     @07,CTGPLPTR                                        1045 04223000
         OI    CTGERASE(@07),B'01000100'                           1045 04224000
*                END;                                      /*@Y30SSFR*/ 04225000
*              ELSE                                                1047 04226000
*                IF ADDR(NOERS) ^= NULLPTR                         1047 04227000
*                  THEN                                            1047 04228000
         B     @RC01042                                            1047 04229000
@RF01042 L     @07,@PC00001+4                                      1047 04230000
         L     @07,FDTPTR+40(,@07)                                 1047 04231000
         LTR   @07,@07                                             1047 04232000
         BZ    @RF01047                                            1047 04233000
*                    CTGOVRID = ON;                        /*@Y30SSFR*/ 04234000
         L     @07,CTGPLPTR                                        1048 04235000
         OI    CTGOVRID(@07),B'00000100'                           1048 04236000
*                  ELSE ;                                  /*@Y30SSFR*/ 04237000
*                                                                  1049 04238000
@RF01047 DS    0H                                                  1050 04239000
*            /********************************************************/ 04240000
*            /*                                              @Y30SSFR*/ 04241000
*            /*  IF PURGE WAS SPECIFIED ON THE AMS COMMAND,  @Y30SSFR*/ 04242000
*            /*  SET THE CTGPURG BIT TO ON.                  @Y30SSFR*/ 04243000
*            /*                                              @Y30SSFR*/ 04244000
*            /********************************************************/ 04245000
*                                                                  1050 04246000
*            IF ADDR(PURGE) ^= NULLPTR                             1050 04247000
*              THEN                                                1050 04248000
@RC01042 L     @07,@PC00001+4                                      1050 04249000
         L     @07,FDTPTR+44(,@07)                                 1050 04250000
         LTR   @07,@07                                             1050 04251000
         BZ    @RF01050                                            1050 04252000
*                CTGPURG = ON;                             /*@Y30SSFR*/ 04253000
*                                                                  1051 04254000
         L     @07,CTGPLPTR                                        1051 04255000
         OI    CTGPURG(@07),B'00100000'                            1051 04256000
*            /********************************************************* 04257000
*            /*                                              @Y30SSFR*/ 04258000
*            /*  SAVE THE DELETE CPL                         @Y30SSFR*/ 04259000
*            /*                                              @Y30SSFR*/ 04260000
*            /********************************************************/ 04261000
*                                                                  1052 04262000
*            CTGPLPTR = DCPLPTR;                           /*@Y30SSFR*/ 04263000
@RF01050 L     @07,DCPLPTR                                         1052 04264000
         ST    @07,CTGPLPTR                                        1052 04265000
*            DSAVCPL = CTGPL;                              /*@Y30SSFR*/ 04266000
         MVC   DSAVCPL(28),CTGPL(@07)                              1053 04267000
*            DEFINED = ON;                                 /*@Y30SSFR*/ 04268000
*                                                                  1054 04269000
         OI    DEFINED,B'10000000'                                 1054 04270000
*            /********************************************************/ 04271000
*            /*                                              @Y30SSFR*/ 04272000
*            /*  CALL THE VSAM CATALOG WITH REGISTER 1       @Y30SSFR*/ 04273000
*            /*  POINTING TO THE CATALOG PARAMETER LIST.     @Y30SSFR*/ 04274000
*            /*  THE CATALOG IS CALLED ITERATIVELY UNTIL A   @Y30SSFR*/ 04275000
*            /*  TERMINATING ERROR OCCURS OR UNTIL THE ENTIRE@Y30SSFR*/ 04276000
*            /*  STRUCTURE ASSOCIATED WITH THE ENTRY BEING   @Y30SSFR*/ 04277000
*            /*  DELETED HAS BEEN REMOVED FROM THE CATALOG.  @Y30SSFR*/ 04278000
*            /*                                              @Y30SSFR*/ 04279000
*            /********************************************************/ 04280000
*                                                                  1055 04281000
*CATALOG:     DO WHILE DEFINED = ON;                       /*@Y30SSFR*/ 04282000
*                                                                  1055 04283000
CATALOG  B     @DE01055                                            1055 04284000
@DL01055 DS    0H                                                  1056 04285000
*              /******************************************************/ 04286000
*              /*                                            @Y30SSFR*/ 04287000
*              /*  SET THE LOOP CONTROL VARIABLE TO OFF      @Y30SSFR*/ 04288000
*              /*  AND SAVE THE CTGPL BEFORE INVOKING        @Y30SSFR*/ 04289000
*              /*  VSAM CATALOG MANAGEMENT.                  @Y30SSFR*/ 04290000
*              /*                                            @Y30SSFR*/ 04291000
*              /******************************************************/ 04292000
*                                                                  1056 04293000
*              DEFINED = OFF;                              /*@Y30SSFR*/ 04294000
         NI    DEFINED,B'01111111'                                 1056 04295000
*              DSAVCPL = CTGPL;                            /*@Y30SSFR*/ 04296000
*                                                                  1057 04297000
         L     @07,CTGPLPTR                                        1057 04298000
         MVC   DSAVCPL(28),CTGPL(@07)                              1057 04299000
*              CALL IDCSACA0 (GDTTBL,DCPLPTR);             /*@Y30SSFR*/ 04300000
*                                                                  1058 04301000
         L     @07,@PC00001                                        1058 04302000
         ST    @07,@AL00001                                        1058 04303000
         LA    @15,DCPLPTR                                         1058 04304000
         ST    @15,@AL00001+4                                      1058 04305000
         L     @15,GDTCAT(,@07)                                    1058 04306000
         LA    @01,@AL00001                                        1058 04307000
         BALR  @14,@15                                             1058 04308000
*              RESPECIFY REG15 RSTD;                       /*@Y30SSFR*/ 04309000
*              CATLGRC = REG15;                            /*@Y30SSFR*/ 04310000
         STH   REG15,CATLGRC                                       1060 04311000
*              RESPECIFY REG15 UNRSTD;                     /*@Y30SSFR*/ 04312000
*                                                                  1061 04313000
*              IF GDTDBG = NULLPTR                                 1062 04314000
*                THEN;                                             1062 04315000
         L     @07,@PC00001                                        1062 04316000
         L     @07,GDTDBG(,@07)                                    1062 04317000
         LTR   @07,@07                                             1062 04318000
         BZ    @RT01062                                            1062 04319000
*                ELSE                                              1064 04320000
*                  CALL IDCDB010 (GDTTBL,'XPZY');                  1064 04321000
         L     @07,@PC00001                                        1064 04322000
         ST    @07,@AL00001                                        1064 04323000
         LA    @15,@CC01259                                        1064 04324000
         ST    @15,@AL00001+4                                      1064 04325000
         MVI   @AL00001+4,X'80'                                    1064 04326000
         L     @15,GDTDBG(,@07)                                    1064 04327000
         LA    @01,@AL00001                                        1064 04328000
         BALR  @14,@15                                             1064 04329000
*                                                          /*@Y30SSFR*/ 04330000
*                                                                  1065 04331000
*              /******************************************************/ 04332000
*              /*                                            @Y30SSFR*/ 04333000
*              /*  INITIALIZE THE VALUE OF MNOENT TO ZERO    @Y30SSFR*/ 04334000
*              /*  IN CASE CATALOG RETURNS WITH RETURNLN     @Y30SSFR*/ 04335000
*              /*  EQUAL TO 4, AND A RETURN CODE OF 40.      @Y30SSFR*/ 04336000
*              /*                                            @Y30SSFR*/ 04337000
*              /******************************************************/ 04338000
*                                                                  1065 04339000
*              MNOENT = 0;                                 /*@Y30SSFR*/ 04340000
*                                                                  1065 04341000
@RT01062 SLR   @07,@07                                             1065 04342000
         ST    @07,MNOENT                                          1065 04343000
*              /******************************************************/ 04344000
*              /*                                            @Y30SSFR*/ 04345000
*              /*  IF CATALOG HAS SET RETURNLN TO A VALUE    @Y30SSFR*/ 04346000
*              /*  GREATER THAN 4, THERE ARE NAMES IN THE    @Y30SSFR*/ 04347000
*              /*  WORK AREA TO BE PRINTED.  EXCEPT WHEN     @Y30SSFR*/ 04348000
*              /*  THE VSAM CATALOG RETURN CODE IS 72, ALL   @Y30SSFR*/ 04349000
*              /*  OF THE NAMES IN WORKAREA ARE TO BE        @Y30SSFR*/ 04350000
*              /*  PRINTED.  WHEN THE RETURN CODE IS 72,     @Y30SSFR*/ 04351000
*              /*  THE LAST NAME IN THE WORKAREA IS THE      @Y30SSFR*/ 04352000
*              /*  NAME OF THE OBJECT TO BE ALLOCATED.       @Y30SSFR*/ 04353000
*              /*  IT AND ITS IMMEDIATE ASSOCIATIONS HAVE    @Y30SSFR*/ 04354000
*              /*  NOT BEEN DELETED, AND SO MUST NOT BE      @Y30SSFR*/ 04355000
*              /*  PRINTED.                                  @Y30SSFR*/ 04356000
*              /*                                            @Y30SSFR*/ 04357000
*              /******************************************************/ 04358000
*                                                                  1066 04359000
*              IF RETURNLN > 4                                     1066 04360000
*                THEN                                              1066 04361000
*                                                                  1066 04362000
         L     @07,CTGPLPTR                                        1066 04363000
         L     @07,CTGWKA(,@07)                                    1066 04364000
         LH    @07,RETURNLN(,@07)                                  1066 04365000
         C     @07,@CF00043                                        1066 04366000
         BNH   @RF01066                                            1066 04367000
*                  /**************************************************/ 04368000
*                  /*                                        @Y30SSFR*/ 04369000
*                  /*  IF THE VSAM CATALOG RETURN CODE       @Y30SSFR*/ 04370000
*                  /*  IS 40, THEN THE VALUE OF RETURNLN     @Y30SSFR*/ 04371000
*                  /*  IS THE SUM OF THE AMOUNT OF SPACE     @Y30SSFR*/ 04372000
*                  /*  IN THE WORKAREA THAT IS BEING USED    @Y30SSFR*/ 04373000
*                  /*  CURRENTLY AND THE AMOUNT THAT CMS     @Y30SSFR*/ 04374000
*                  /*  REQUIRES ON THE NEXT ITERATION.       @Y30SSFR*/ 04375000
*                  /*  ACCORDINGLY, A SPECIAL CALCULATION    @Y30SSFR*/ 04376000
*                  /*  IS REQUIRED TO DETERMINE HOW MANY     @Y30SSFR*/ 04377000
*                  /*  NAMES TO PRINT.                       @Y30SSFR*/ 04378000
*                  /*                                        @Y30SSFR*/ 04379000
*                  /**************************************************/ 04380000
*                                                                  1067 04381000
*                  IF CATLGRC = NEEDCORE                   /*@Y30SSFR*/ 04382000
*                     THEN                                 /*@Y30SSFR*/ 04383000
         CLC   CATLGRC(2),@CH01110                                 1067 04384000
         BNE   @RF01067                                            1067 04385000
*MPRTLP:                DO;                                 /*@Y30SSFR* 04386000
*                                                                  1068 04387000
MPRTLP   DS    0H                                                  1069 04388000
*                      /**********************************************/ 04389000
*                      /*                                    @Y30SSFR*/ 04390000
*                      /*  SET UP THE DARGLIST FOR THE ENTRY @Y30SSFR*/ 04391000
*                      /*  DELETED MESSAGE.                  @Y30SSFR*/ 04392000
*                      /*                                    @Y30SSFR*/ 04393000
*                      /**********************************************/ 04394000
*                                                                  1069 04395000
*                      DARGSMOD = DELMSG;                  /*@Y30SSFR*/ 04396000
         L     @07,DDSTRU                                          1069 04397000
         MVC   DARGSMOD(3,@07),@CC00938                            1069 04398000
*                      DARGSENT = ENTRYMSG;                /*@Y30SSFR*/ 04399000
*                                                                  1070 04400000
         MVI   DARGSENT(@07),X'01'                                 1070 04401000
*                      /**********************************************/ 04402000
*                      /*                                    @Y30SSFR*/ 04403000
*                      /*  CALCULATE THE MAXIMUM NUMBER      @Y30SSFR*/ 04404000
*                      /*  OF ITEMS THAT WILL FIT INTO THE   @Y30SSFR*/ 04405000
*                      /*  CURRENT WORK AREA.  THEN LOOP     @Y30SSFR*/ 04406000
*                      /*  PRINTING NAMES UNTIL THIS LIMIT   @Y30SSFR*/ 04407000
*                      /*  IS REACHED OR AN EMPTY SLOT IS    @Y30SSFR*/ 04408000
*                      /*  FOUND.                            @Y30SSFR*/ 04409000
*                      /*                                    @Y30SSFR*/ 04410000
*                      /**********************************************/ 04411000
*                                                                  1071 04412000
*                      LIMIT = (AREALN - 4) /              /*@Y30SSFR*/ 04413000
*                      LENGTH(ENTITEM);                    /*@Y30SSFR*/ 04414000
         LA    @03,45                                              1071 04415000
         L     @01,CTGPLPTR                                        1071 04416000
         L     @01,CTGWKA(,@01)                                    1071 04417000
         LH    @00,AREALN(,@01)                                    1071 04418000
         SL    @00,@CF00043                                        1071 04419000
         SRDA  @00,32                                              1071 04420000
         DR    @00,@03                                             1071 04421000
         ST    @01,LIMIT                                           1071 04422000
*                      IX = 1;                             /*@Y30SSFR*/ 04423000
         LA    IX,1                                                1072 04424000
*                      DARGILP = LENGTH(ENTLIST(1));       /*@Y30SSFR*/ 04425000
*                                                                  1073 04426000
         STH   @03,DARGILP(,@07)                                   1073 04427000
*                      DO WHILE IX <= LIMIT &              /*@Y30SSFR*/ 04428000
*                      ENTRYTYP(IX) ^= 0;                  /*@Y30SSFR*/ 04429000
         B     @DE01074                                            1074 04430000
@DL01074 DS    0H                                                  1075 04431000
*                        DARGDBP = ADDR(ENTLIST(IX));      /*@Y30SSFR*/ 04432000
*                                                                  1075 04433000
         LR    @07,IX                                              1075 04434000
         MH    @07,@CH00912                                        1075 04435000
         L     @03,CTGPLPTR                                        1075 04436000
         L     @03,CTGWKA(,@03)                                    1075 04437000
         AL    @03,@CF01373                                        1075 04438000
         LA    @07,ENTLIST-4(@07,@03)                              1075 04439000
         L     @03,DDSTRU                                          1075 04440000
         ST    @07,DARGDBP(,@03)                                   1075 04441000
*                        CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*   1076 04442000
*                                                            @Y30SSFR*/ 04443000
*                                                                  1076 04444000
         L     @07,@PC00001                                        1076 04445000
         ST    @07,@AL00001                                        1076 04446000
         LA    @03,@CF00116                                        1076 04447000
         ST    @03,@AL00001+4                                      1076 04448000
         LA    @03,DDSTRU                                          1076 04449000
         ST    @03,@AL00001+8                                      1076 04450000
         MVI   @AL00001+8,X'80'                                    1076 04451000
         L     @15,GDTPRT(,@07)                                    1076 04452000
         LA    @01,@AL00001                                        1076 04453000
         BALR  @14,@15                                             1076 04454000
*                        IX = IX + 1;                      /*@Y30SSFR*/ 04455000
         AL    IX,@CF00220                                         1077 04456000
*                      END;                                /*@Y30SSFR*/ 04457000
*                                                                  1078 04458000
@DE01074 C     IX,LIMIT                                            1078 04459000
         BH    @DC01074                                            1078 04460000
         LR    @07,IX                                              1078 04461000
         MH    @07,@CH00912                                        1078 04462000
         L     @03,CTGPLPTR                                        1078 04463000
         L     @03,CTGWKA(,@03)                                    1078 04464000
         AL    @03,@CF01373                                        1078 04465000
         SLR   @15,@15                                             1078 04466000
         IC    @15,ENTRYTYP-4(@07,@03)                             1078 04467000
         C     @15,@CF00116                                        1078 04468000
         BNE   @DL01074                                            1078 04469000
@DC01074 DS    0H                                                  1079 04470000
*                      /**********************************************/ 04471000
*                      /*                                    @Y30SSFR*/ 04472000
*                      /*  UPON EXITING THE LOOP THE VALUE   @Y30SSFR*/ 04473000
*                      /*  OF IX IS ONE MORE THAN THE ACTUAL @Y30SSFR*/ 04474000
*                      /*  NUMBER OF ENTRIES IN THE WORK     @Y30SSFR*/ 04475000
*                      /*  WORK AREA.  SUBTRACT ONE TO GET   @Y30SSFR*/ 04476000
*                      /*  THE VALUE TO BE PASSED TO MORESP. @Y30SSFR*/ 04477000
*                      /*                                    @Y30SSFR*/ 04478000
*                      /**********************************************/ 04479000
*                                                                  1079 04480000
*                      MNOENT = IX - 1;                    /*@Y30SSFR*/ 04481000
*                                                                  1079 04482000
         LR    @07,IX                                              1079 04483000
         BCTR  @07,0                                               1079 04484000
         ST    @07,MNOENT                                          1079 04485000
*                      END MPRTLP;                         /*@Y30SSFR*/ 04486000
*                                                                  1080 04487000
*                    ELSE                                  /*@Y30SSFR*/ 04488000
*                                                                  1081 04489000
*                      /**********************************************/ 04490000
*                      /*                                    @Y30SSFR*/ 04491000
*                      /*  IF THE VSAM CATALOG RETURN CODE   @Y30SSFR*/ 04492000
*                      /*  IS 72 OR 76, THEN THE LAST ITEM   @Y30SSFR*/ 04493000
*                      /*  IN THE WORKAREA IS THE NAME OF AN @Y30SSFR*/ 04494000
*                      /*  OBJECT THAT MUST BE DYNAMICALLY   @Y30SSFR*/ 04495000
*                      /*  ALLOCATED.  NOTE THAT THIS THING  @Y30SSFR*/ 04496000
*                      /*  HAS NOT BEEN DELETED YET,         @Y30SSFR*/ 04497000
*                      /*  AND SO MUST NOT BE PRINTED.       @Y30SSFR*/ 04498000
*                      /*                                    @Y30SSFR*/ 04499000
*                      /**********************************************/ 04500000
*                                                                  1081 04501000
*                      IF (CATLGRC = ALLORC1) |            /*@Y30SSFR*/ 04502000
*                           (CATLGRC = ALLORC3)            /*@Y30SSFR*/ 04503000
*                        THEN                              /*@Y30SSFR*/ 04504000
         B     @RC01067                                            1081 04505000
@RF01067 LH    @07,CATLGRC                                         1081 04506000
         C     @07,@CF01112                                        1081 04507000
         BE    @RT01081                                            1081 04508000
         C     @07,@CF01114                                        1081 04509000
         BNE   @RF01081                                            1081 04510000
@RT01081 DS    0H                                                  1082 04511000
*A1PRTLP:                  DO;                             /*@Y30SSFR*/ 04512000
*                                                                  1082 04513000
A1PRTLP  DS    0H                                                  1083 04514000
*                          LIMIT = ((RETURNLN - 4) /       /*@Y30SSFR*/ 04515000
*                          LENGTH(ENTITEM)) -1 ;           /*@Y30SSFR*/ 04516000
*                                                                  1083 04517000
         LA    @07,45                                              1083 04518000
         L     @03,CTGPLPTR                                        1083 04519000
         L     @03,CTGWKA(,@03)                                    1083 04520000
         LH    @00,RETURNLN(,@03)                                  1083 04521000
         SL    @00,@CF00043                                        1083 04522000
         SRDA  @00,32                                              1083 04523000
         DR    @00,@07                                             1083 04524000
         BCTR  @01,0                                               1083 04525000
         ST    @01,LIMIT                                           1083 04526000
*                          /******************************************/ 04527000
*                          /*                                @Y30SSFR*/ 04528000
*                          /*  LOOP, PRINTING THE NAMES OF   @Y30SSFR*/ 04529000
*                          /*  THE ENTRIES DELETED SO FAR.   @Y30SSFR*/ 04530000
*                          /*                                @Y30SSFR*/ 04531000
*                          /******************************************/ 04532000
*                                                                  1084 04533000
*                          DARGSMOD = DELMSG;              /*@Y30SSFR*/ 04534000
         L     @03,DDSTRU                                          1084 04535000
         MVC   DARGSMOD(3,@03),@CC00938                            1084 04536000
*                          DARGSENT = ENTRYMSG;            /*@Y30SSFR*/ 04537000
         MVI   DARGSENT(@03),X'01'                                 1085 04538000
*                          IX = 1;                         /*@Y30SSFR*/ 04539000
         LA    IX,1                                                1086 04540000
*                          DARGILP = LENGTH(ENTLIST(1));   /*@Y30SSFR*/ 04541000
*                                                                  1087 04542000
         STH   @07,DARGILP(,@03)                                   1087 04543000
*                          DO WHILE IX <= LIMIT &          /*@Y30SSFR*/ 04544000
*                          ENTRYTYP(IX) ^= 0;              /*@Y30SSFR*/ 04545000
         B     @DE01088                                            1088 04546000
@DL01088 DS    0H                                                  1089 04547000
*                            DARGDBP = ADDR(ENTLIST(IX));  /*@Y30SSFR*/ 04548000
*                                                                  1089 04549000
         LR    @07,IX                                              1089 04550000
         MH    @07,@CH00912                                        1089 04551000
         L     @03,CTGPLPTR                                        1089 04552000
         L     @03,CTGWKA(,@03)                                    1089 04553000
         AL    @03,@CF01373                                        1089 04554000
         LA    @07,ENTLIST-4(@07,@03)                              1089 04555000
         L     @03,DDSTRU                                          1089 04556000
         ST    @07,DARGDBP(,@03)                                   1089 04557000
*                            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    04558000
*                                                            @Y30SSFR*/ 04559000
*                                                                  1090 04560000
         L     @07,@PC00001                                        1090 04561000
         ST    @07,@AL00001                                        1090 04562000
         LA    @03,@CF00116                                        1090 04563000
         ST    @03,@AL00001+4                                      1090 04564000
         LA    @03,DDSTRU                                          1090 04565000
         ST    @03,@AL00001+8                                      1090 04566000
         MVI   @AL00001+8,X'80'                                    1090 04567000
         L     @15,GDTPRT(,@07)                                    1090 04568000
         LA    @01,@AL00001                                        1090 04569000
         BALR  @14,@15                                             1090 04570000
*                            IX = IX + 1;                  /*@Y30SSFR*/ 04571000
         AL    IX,@CF00220                                         1091 04572000
*                          END;                            /*@Y30SSFR*/ 04573000
@DE01088 C     IX,LIMIT                                            1092 04574000
         BH    @DC01088                                            1092 04575000
         LR    @07,IX                                              1092 04576000
         MH    @07,@CH00912                                        1092 04577000
         L     @03,CTGPLPTR                                        1092 04578000
         L     @03,CTGWKA(,@03)                                    1092 04579000
         AL    @03,@CF01373                                        1092 04580000
         SLR   @15,@15                                             1092 04581000
         IC    @15,ENTRYTYP-4(@07,@03)                             1092 04582000
         C     @15,@CF00116                                        1092 04583000
         BNE   @DL01088                                            1092 04584000
@DC01088 DS    0H                                                  1093 04585000
*                          END A1PRTLP;                    /*@Y30SSFR*/ 04586000
*                                                                  1093 04587000
*                        ELSE                              /*@Y30SSFR*/ 04588000
*                                                                  1094 04589000
*                          /******************************************/ 04590000
*                          /*                                @Y30SSFR*/ 04591000
*                          /*  IN ALL OTHER CASES THE VALUE  @Y30SSFR*/ 04592000
*                          /*  OF RETURNLN IS AN ACCURATE    @Y30SSFR*/ 04593000
*                          /*  INIDCATION OF HOW MANY ITEMS  @Y30SSFR*/ 04594000
*                          /*  ARE TO BE PRINTED.            @Y30SSFR*/ 04595000
*                          /*  CALCULATE THE NUMBER OF ITEMS @Y30SSFR*/ 04596000
*                          /*  IN THE WORKAREA AND PRINT     @Y30SSFR*/ 04597000
*                          /*  THEM OUT.                     @Y30SSFR*/ 04598000
*                          /*                                @Y30SSFR*/ 04599000
*                          /******************************************/ 04600000
*                                                                  1094 04601000
*OTPRTLP:                  DO;                             /*@Y30SSFR*/ 04602000
*                                                                  1094 04603000
         B     @RC01081                                            1094 04604000
@RF01081 DS    0H                                                  1094 04605000
OTPRTLP  DS    0H                                                  1095 04606000
*                          /******************************************/ 04607000
*                          /*                                @Y30SSFR*/ 04608000
*                          /*  CALCULATE THE NUMBER OF ITEMS @Y30SSFR*/ 04609000
*                          /*  TO BE PRINTED.  SET THE       @Y30SSFR*/ 04610000
*                          /*  MODULE AND ENTRY ID'S AND     @Y30SSFR*/ 04611000
*                          /*  THE ENTRY LENGTH IN THE       @Y30SSFR*/ 04612000
*                          /*  DARGLIST.                     @Y30SSFR*/ 04613000
*                          /*                                @Y30SSFR*/ 04614000
*                          /******************************************/ 04615000
*                                                                  1095 04616000
*                          ENTRYNO = (RETURNLN - 4)/       /*@Y30SSFR*/ 04617000
*                          LENGTH(ENTLIST);                /*@Y30SSFR*/ 04618000
         LA    @07,45                                              1095 04619000
         L     @01,CTGPLPTR                                        1095 04620000
         L     @01,CTGWKA(,@01)                                    1095 04621000
         LH    @00,RETURNLN(,@01)                                  1095 04622000
         SL    @00,@CF00043                                        1095 04623000
         SRDA  @00,32                                              1095 04624000
         DR    @00,@07                                             1095 04625000
         LR    ENTRYNO,@01                                         1095 04626000
*                          DARGSMOD = DELMSG;              /*@Y30SSFR*/ 04627000
         L     @03,DDSTRU                                          1096 04628000
         MVC   DARGSMOD(3,@03),@CC00938                            1096 04629000
*                          DARGSENT = ENTRYMSG;            /*@Y30SSFR*/ 04630000
         MVI   DARGSENT(@03),X'01'                                 1097 04631000
*                          DARGILP = LENGTH(ENTLIST(1));   /*@Y30SSFR*/ 04632000
*                                                                  1098 04633000
         STH   @07,DARGILP(,@03)                                   1098 04634000
*                          /******************************************/ 04635000
*                          /*                                @Y30SSFR*/ 04636000
*                          /*  LOOP PRINTING THE NAMES OF    @Y30SSFR*/ 04637000
*                          /*  THE OBJECTS DELETED SO FAR BY @Y30SSFR*/ 04638000
*                          /*  CATALOG MANAGEMENT.           @Y30SSFR*/ 04639000
*                          /*                                @Y30SSFR*/ 04640000
*                          /******************************************/ 04641000
*                                                                  1099 04642000
*                          DO I = 1 TO ENTRYNO;            /*@Y30SSFR*/ 04643000
         LA    I,1                                                 1099 04644000
         B     @DE01099                                            1099 04645000
@DL01099 DS    0H                                                  1100 04646000
*                            DARGDBP = ADDR(ENTLIST(I));   /*@Y30SSFR*/ 04647000
*                                                                  1100 04648000
         LR    @07,I                                               1100 04649000
         MH    @07,@CH00912                                        1100 04650000
         L     @05,CTGPLPTR                                        1100 04651000
         L     @05,CTGWKA(,@05)                                    1100 04652000
         AL    @05,@CF01373                                        1100 04653000
         LA    @07,ENTLIST-4(@07,@05)                              1100 04654000
         L     @05,DDSTRU                                          1100 04655000
         ST    @07,DARGDBP(,@05)                                   1100 04656000
*                            CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);/*    04657000
*                                                            @Y30SSFR*/ 04658000
*                                                                  1101 04659000
         L     @07,@PC00001                                        1101 04660000
         ST    @07,@AL00001                                        1101 04661000
         LA    @05,@CF00116                                        1101 04662000
         ST    @05,@AL00001+4                                      1101 04663000
         LA    @05,DDSTRU                                          1101 04664000
         ST    @05,@AL00001+8                                      1101 04665000
         MVI   @AL00001+8,X'80'                                    1101 04666000
         L     @15,GDTPRT(,@07)                                    1101 04667000
         LA    @01,@AL00001                                        1101 04668000
         BALR  @14,@15                                             1101 04669000
*                          END;                            /*@Y30SSFR*/ 04670000
*                                                                  1102 04671000
         AL    I,@CF00220                                          1102 04672000
@DE01099 CR    I,ENTRYNO                                           1102 04673000
         BNH   @DL01099                                            1102 04674000
*                          END OTPRTLP;                    /*@Y30SSFR*/ 04675000
*                                                                  1103 04676000
*              /******************************************************/ 04677000
*              /*                                            @Y30SSFR*/ 04678000
*              /*  NOW TEST THE VSAM CATALOG RETURN CODE     @Y30SSFR*/ 04679000
*              /*  TO DETERMINE THE COURSE OF FURTHER        @Y30SSFR*/ 04680000
*              /*  PROCESSING.  A VSAM CATALOG RETURN        @Y30SSFR*/ 04681000
*              /*  CODE OF 40 INDICATES THAT CATALOG NEEDS   @Y30SSFR*/ 04682000
*              /*  A LARGER WORK AREA.  MORESP IS INVOKED    @Y30SSFR*/ 04683000
*              /*  TO HANDLE THIS.  A CATALOG RETURN CODE    @Y30SSFR*/ 04684000
*              /*  OF 72 IS AN ALLOCATION REQUEST.  THE      @Y30SSFR*/ 04685000
*              /*  NAME OF THE THING TO BE ALLOCATED IS THE  @Y30SSFR*/ 04686000
*              /*  LAST ITEM IN THE WORKAREA.  ANY OTHER     @Y30SSFR*/ 04687000
*              /*  NON-ZERO RETURN CODE IS A TERMINAL ERROR. @Y30SSFR*/ 04688000
*              /*                                            @Y30SSFR*/ 04689000
*              /******************************************************/ 04690000
*                                                                  1104 04691000
*              IF CATLGRC = NEEDCORE                               1104 04692000
*                THEN                                              1104 04693000
*                                                                  1104 04694000
@RC01081 DS    0H                                                  1104 04695000
@RC01067 DS    0H                                                  1104 04696000
@RF01066 CLC   CATLGRC(2),@CH01110                                 1104 04697000
         BNE   @RF01104                                            1104 04698000
*                  /**************************************************/ 04699000
*                  /*                                        @Y30SSFR*/ 04700000
*                  /*  THE VSAM CATALOG RETURN CODE IS 40.   @Y30SSFR*/ 04701000
*                  /*  CALL MORESP TO GET A NEW WORKAREA OR  @Y30SSFR*/ 04702000
*                  /*  CLEAR THE OLD ONE.  IF IT IS SUCCESS- @Y30SSFR*/ 04703000
*                  /*  FUL SET DEFINED TO BE ON TO INDICATE  @Y30SSFR*/ 04704000
*                  /*  ANOTHER ITERATION OF THE LOOP CATALOG @Y30SSFR*/ 04705000
*                  /*                                        @Y30SSFR*/ 04706000
*                  /**************************************************/ 04707000
*                                                                  1105 04708000
*NCRC:             DO;                                     /*@Y30SSFR*/ 04709000
NCRC     DS    0H                                                  1106 04710000
*                  CALL MORESP(MNOENT);                    /*@Y30SSFR*/ 04711000
         LA    @07,MNOENT                                          1106 04712000
         ST    @07,@AL00001                                        1106 04713000
         LA    @01,@AL00001                                        1106 04714000
         BAL   @14,MORESP                                          1106 04715000
*                  RESPECIFY RTNREG RSTD;                          1107 04716000
*                  TESTRC = RTNREG;                                1108 04717000
         LR    TESTRC,RTNREG                                       1108 04718000
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30SSFR*/ 04719000
*                  IF TESTRC ^= 0                          /*@Y30SSFR*/ 04720000
*                    THEN                                  /*@Y30SSFR*/ 04721000
         LTR   TESTRC,TESTRC                                       1110 04722000
         BZ    @RF01110                                            1110 04723000
*                      DO;                                 /*@Y30SSFR*/ 04724000
*                      SETRC = LASTCC08;                   /*@Y30SSFR*/ 04725000
         LA    @07,8                                               1112 04726000
         STH   @07,SETRC                                           1112 04727000
*                      RETURN CODE(SETRC);                 /*@Y30SSFR*/ 04728000
         LR    @15,@07                                             1113 04729000
         L     @14,@SA00008                                        1113 04730000
         LM    @00,@05,@SA00008+8                                  1113 04731000
         LM    @07,@12,@SA00008+32                                 1113 04732000
         BR    @14                                                 1113 04733000
*                      END;                                /*@Y30SSFR*/ 04734000
*                  DEFINED = ON;                           /*@Y30SSFR*/ 04735000
@RF01110 OI    DEFINED,B'10000000'                                 1115 04736000
*                  END NCRC;                               /*@Y30SSFR*/ 04737000
*                                                                  1116 04738000
*                ELSE                                      /*@Y30SSFR*/ 04739000
*                                                                  1117 04740000
*                  /**************************************************/ 04741000
*                  /*                                        @Y30SSFR*/ 04742000
*                  /*  TEST FOR A VSAM CATALOG RETURN CODE   @Y30SSFR*/ 04743000
*                  /*  OF 72 OR 76.                          @Y30SSFR*/ 04744000
*                  /*                                        @Y30SSFR*/ 04745000
*                  /*************************************************** 04746000
*                                                                  1117 04747000
*                  IF (CATLGRC = ALLORC1) | (CATLGRC = ALLORC3)    1117 04748000
*                    THEN                                          1117 04749000
*                                                                  1117 04750000
         B     @RC01104                                            1117 04751000
@RF01104 LH    @07,CATLGRC                                         1117 04752000
         C     @07,@CF01112                                        1117 04753000
         BE    @RT01117                                            1117 04754000
         C     @07,@CF01114                                        1117 04755000
         BNE   @RF01117                                            1117 04756000
@RT01117 DS    0H                                                  1118 04757000
*                      /**********************************************/ 04758000
*                      /*                                    @Y30SSFR*/ 04759000
*                      /*  THE VSAM CATALOG RETURN CODE IS   @Y30SSFR*/ 04760000
*                      /*  72 OR 76. DYNAMICALLY ALLOCATE THE@Y30SSFR*/ 04761000
*                      /*  OBJECT NAMED BY THE LAST ENTRY    @Y30SSFR*/ 04762000
*                      /*  IN THE WORKAREA.                  @Y30SSFR*/ 04763000
*                      /*                                    @Y30SSFR*/ 04764000
*                      /**********************************************/ 04765000
*                                                                  1118 04766000
*A1RC:                 DO;                                 /*@Y30SSFR*/ 04767000
A1RC     DS    0H                                                  1119 04768000
*                      ALLOINDX = (RETURNLN-4)/            /*@Y30SSFR*/ 04769000
*                      LENGTH(ENTITEM);                    /*@Y30SSFR*/ 04770000
*                                                                  1119 04771000
         L     @07,CTGPLPTR                                        1119 04772000
         L     @07,CTGWKA(,@07)                                    1119 04773000
         LH    @00,RETURNLN(,@07)                                  1119 04774000
         SL    @00,@CF00043                                        1119 04775000
         SRDA  @00,32                                              1119 04776000
         D     @00,@CF00912                                        1119 04777000
         LR    ALLOINDX,@01                                        1119 04778000
*                      /**********************************************/ 04779000
*                      /*                                    @Y30SSFR*/ 04780000
*                      /*  ALLOINDX IS THE INDEX OF THE LAST @Y30SSFR*/ 04781000
*                      /*  ENTRY IN THE CMS WORKAREA. IN     @Y30SSFR*/ 04782000
*                      /*  TO DYNAMICALLY ALLOCATE THIS      @Y30SSFR*/ 04783000
*                      /*  OBJECT, WE MUST FIRST TEST TO     @Y30SSFR*/ 04784000
*                      /*  DETERMINE IF THE ALLAGL IS IN     @Y30SSFR*/ 04785000
*                      /*  USE DUE TO A PRIOR CALL TO        @Y30SSFR*/ 04786000
*                      /*  DYNAMIC ALLOCATION.               @Y30SSFR*/ 04787000
*                      /*                                    @Y30SSFR*/ 04788000
*                      /**********************************************/ 04789000
*                                                                  1120 04790000
*                      IF DEALLOC = ON                     /*@Y30SSFR*/ 04791000
*                        THEN                              /*@Y30SSFR*/ 04792000
*                                                                  1120 04793000
         TM    DEALLOC,B'10000000'                                 1120 04794000
         BNO   @RF01120                                            1120 04795000
*                          /******************************************/ 04796000
*                          /*                                @Y30SSFR*/ 04797000
*                          /*  DYNAMIC ALLOCATION HAS BEEN   @Y30SSFR*/ 04798000
*                          /*  USED PREVIOUSLY.  SET DEALLOC @Y30SSFR*/ 04799000
*                          /*  TO OFF TO INDICATE THAT       @Y30SSFR*/ 04800000
*                          /*  DYNAMIC UNALLOCATION HAS BEEN @Y30SSFR*/ 04801000
*                          /*  ATTEMPTED.                    @Y30SSFR*/ 04802000
*                          /*                                @Y30SSFR*/ 04803000
*                          /******************************************/ 04804000
*                                                                  1121 04805000
*                          DO;                             /*@Y30SSFR*/ 04806000
*                          DEALLOC = OFF;                  /*@Y30SSFR*/ 04807000
*                                                                  1122 04808000
         NI    DEALLOC,B'01111111'                                 1122 04809000
*                          /******************************************/ 04810000
*                          /*                                @Y30SSFR*/ 04811000
*                          /*  ISSUE THE UDEALLOC REQUEST,   @Y30SSFR*/ 04812000
*                          /*  AND SET THE VALUE OF SETRC    @Y30SSFR*/ 04813000
*                          /*  ACCORDINGLY.                  @Y30SSFR*/ 04814000
*                          /*                                @Y30SSFR*/ 04815000
*                          /******************************************/ 04816000
*                                                                  1123 04817000
*                          CALL IDCSADL0(GDTTBL,ALLAGL);   /*@Y30SSFR*/ 04818000
         L     @07,@PC00001                                        1123 04819000
         ST    @07,@AL00001                                        1123 04820000
         L     @01,ALLPTR                                          1123 04821000
         ST    @01,@AL00001+4                                      1123 04822000
         MVI   @AL00001+4,X'80'                                    1123 04823000
         L     @15,GDTDLC(,@07)                                    1123 04824000
         LA    @01,@AL00001                                        1123 04825000
         BALR  @14,@15                                             1123 04826000
*                          RESPECIFY RTNREG RSTD;                  1124 04827000
*                          TESTRC = RTNREG;                        1125 04828000
         LR    TESTRC,RTNREG                                       1125 04829000
*                          RESPECIFY RTNREG UNRSTD;        /*@Y30SSFR*/ 04830000
*                          IF TESTRC ^= 0                  /*@Y30SSFR*/ 04831000
*                            THEN                          /*@Y30SSFR*/ 04832000
         LTR   TESTRC,TESTRC                                       1127 04833000
         BZ    @RF01127                                            1127 04834000
*                              DO;                         /*@Y30SSFR*/ 04835000
*                              SETRC = MAX(SETRC,          /*@Y30SSFR*/ 04836000
*                              LASTCC08);                  /*@Y30SSFR*/ 04837000
         LH    @07,SETRC                                           1129 04838000
         LA    @15,8                                               1129 04839000
         CR    @07,@15                                             1129 04840000
         BNL   *+6                                                      04841000
         LR    @07,@15                                             1129 04842000
         STH   @07,SETRC                                           1129 04843000
*                              RETURN CODE(SETRC);         /*@Y30SSFR*/ 04844000
         LR    @15,@07                                             1130 04845000
         L     @14,@SA00008                                        1130 04846000
         LM    @00,@05,@SA00008+8                                  1130 04847000
         LM    @07,@12,@SA00008+32                                 1130 04848000
         BR    @14                                                 1130 04849000
*                              END;                        /*@Y30SSFR*/ 04850000
*                      END;                                /*@Y30SSFR*/ 04851000
*                                                                  1132 04852000
@RF01127 DS    0H                                                  1133 04853000
*                  /**************************************************/ 04854000
*                  /*                                        @Y30SSFR*/ 04855000
*                  /*  BUILD AN ALLAGL FOR THE OBJECT TO BE  @Y30SSFR*/ 04856000
*                  /*  ALLOCATED.  POINT TO THAT PART OF     @Y30SSFR*/ 04857000
*                  /*  MAIN STORAGE IN WHICH THE ALLAGL IS   @Y30SSFR*/ 04858000
*                  /*  TO BE BUILT, AND CLEAR IT.            @Y30SSFR*/ 04859000
*                  /*                                        @Y30SSFR*/ 04860000
*                  /**************************************************/ 04861000
*                                                                  1133 04862000
*                  ALLPTR = ADDR(ALLLIST);                 /*@Y30SSFR*/ 04863000
@RF01120 LA    @07,ALLLIST                                         1133 04864000
         ST    @07,ALLPTR                                          1133 04865000
*                  ALLAGL = ''B;                           /*@Y30SSFR*/ 04866000
*                                                                  1134 04867000
         XC    ALLAGL(31,@07),ALLAGL(@07)                          1134 04868000
*                  /**************************************************/ 04869000
*                  /*                                        @Y30SSFR*/ 04870000
*                  /*  SET A POINTER TO THE DSNAME IN THE    @Y30SSFR*/ 04871000
*                  /*  ALLAGL.                               @Y30SSFR*/ 04872000
*                  /*                                        @Y30SSFR*/ 04873000
*                  /**************************************************/ 04874000
*                                                                  1135 04875000
*                  ALLDSN = ADDR(ENTRYNM(ALLOINDX));       /*@Y30SSFR*/ 04876000
*                                                                  1135 04877000
         LR    @15,ALLOINDX                                        1135 04878000
         MH    @15,@CH00912                                        1135 04879000
         L     @01,CTGPLPTR                                        1135 04880000
         L     @01,CTGWKA(,@01)                                    1135 04881000
         AL    @01,@CF01374                                        1135 04882000
         LA    @15,ENTRYNM-5(@15,@01)                              1135 04883000
         ST    @15,ALLDSN(,@07)                                    1135 04884000
*                  /**************************************************/ 04885000
*                  /*                                        @Y30SSFR*/ 04886000
*                  /*  SELECT ALLOCATION OPTIONS.            @Y30SSFR*/ 04887000
*                  /*  (1) ALLOCATION BY DATA SET NAME       @Y30SSFR*/ 04888000
*                  /*  (2) STATUS = OLD                      @Y30SSFR*/ 04889000
*                  /*  (3) DISP = KEEP                       @Y30SSFR*/ 04890000
*                  /*                                        @Y30SSFR*/ 04891000
*                  /**************************************************/ 04892000
*                                                                  1136 04893000
*                  ALLOPTVL = OFF;                         /*@Y30SSFR*/ 04894000
*                  ALLOPTDS = ON;                          /*@Y30SSFR*/ 04895000
         OI    ALLOPTDS(@07),B'01000000'                           1137 04896000
         NI    ALLOPTVL(@07),B'01111111'                           1137 04897000
*                  ALLSTSOD = ON;                          /*@Y30SSFR*/ 04898000
         OI    ALLSTSOD(@07),B'00000001'                           1138 04899000
*                  ALLDSPKP = ON;                          /*@Y30SSFR*/ 04900000
*                                                                  1139 04901000
         OI    ALLDSPKP(@07),B'00001000'                           1139 04902000
*                  /**************************************************/ 04903000
*                  /*                                        @Y30SSFR*/ 04904000
*                  /*  ISSUE THE UALLOC, AND TEST THE        @Y30SSFR*/ 04905000
*                  /*  RETURN CODE.                          @Y30SSFR*/ 04906000
*                  /*                                        @Y30SSFR*/ 04907000
*                  /**************************************************/ 04908000
*                                                                  1140 04909000
*                  CALL IDCSAAL0(GDTTBL,ALLAGL);           /*@Y30SSFR*/ 04910000
*                                                                  1140 04911000
         L     @15,@PC00001                                        1140 04912000
         ST    @15,@AL00001                                        1140 04913000
         ST    @07,@AL00001+4                                      1140 04914000
         MVI   @AL00001+4,X'80'                                    1140 04915000
         L     @15,GDTALC(,@15)                                    1140 04916000
         LA    @01,@AL00001                                        1140 04917000
         BALR  @14,@15                                             1140 04918000
*                  RESPECIFY RTNREG RSTD;                          1141 04919000
*                  TESTRC = RTNREG;                                1142 04920000
         LR    TESTRC,RTNREG                                       1142 04921000
*                  RESPECIFY RTNREG UNRSTD;                /*@Y30SSFR*/ 04922000
*                  IF TESTRC = 0                           /*@Y30SSFR*/ 04923000
*                    THEN                                  /*@Y30SSFR*/ 04924000
         LTR   TESTRC,TESTRC                                       1144 04925000
         BNZ   @RF01144                                            1144 04926000
*                      DO;                                 /*@Y30SSFR*/ 04927000
*                                                                  1145 04928000
*                      /**********************************************/ 04929000
*                      /*                                    @Y30SSFR*/ 04930000
*                      /*  THE OBJECT HAS BEEN ALLOCATED     @Y30SSFR*/ 04931000
*                      /*  SUCCESSFULLY.  PLACE A POINTER    @Y30SSFR*/ 04932000
*                      /*  TO THE DDNAME RETURNED IN THE     @Y30SSFR*/ 04933000
*                      /*  CPL.  SET DEALLOC TO ON TO        @Y30SSFR*/ 04934000
*                      /*  INDICATE THAT THE ALLAGL IS       @Y30SSFR*/ 04935000
*                      /*  AGAIN IN USE.                     @Y30SSFR*/ 04936000
*                      /*                                    @Y30SSFR*/ 04937000
*                      /**********************************************/ 04938000
*                                                                  1146 04939000
*                      CTGDDNM = ADDR(ALLDDN);             /*@Y30SSFR*/ 04940000
         L     @07,ALLPTR                                          1146 04941000
         LA    @07,ALLDDN(,@07)                                    1146 04942000
         L     @02,CTGPLPTR                                        1146 04943000
         ST    @07,CTGDDNM(,@02)                                   1146 04944000
*                      DEALLOC = ON;                       /*@Y30SSFR*/ 04945000
*                                                                  1147 04946000
         OI    DEALLOC,B'10000000'                                 1147 04947000
*                      /**********************************************/ 04948000
*                      /*                                    @Y30SSFR*/ 04949000
*                      /*  CLEAR THE CATALOG WORKAREA.       @Y30SSFR*/ 04950000
*                      /*                                    @Y30SSFR*/ 04951000
*                      /**********************************************/ 04952000
*                                                                  1148 04953000
*                      DO IND1 = 1 TO ALLOINDX;            /*@Y30SSFR*/ 04954000
         LA    IND1,1                                              1148 04955000
         B     @DE01148                                            1148 04956000
@DL01148 DS    0H                                                  1149 04957000
*                        ENTLIST(IND1) = ''B;              /*@Y30SSFR*/ 04958000
         LR    @07,IND1                                            1149 04959000
         MH    @07,@CH00912                                        1149 04960000
         L     @01,CTGPLPTR                                        1149 04961000
         L     @01,CTGWKA(,@01)                                    1149 04962000
         ALR   @01,@07                                             1149 04963000
         AL    @01,@CF01373                                        1149 04964000
         XC    ENTLIST-4(45,@01),ENTLIST-4(@01)                    1149 04965000
*                      END;                                /*@Y30SSFR*/ 04966000
         AL    IND1,@CF00220                                       1150 04967000
@DE01148 CR    IND1,ALLOINDX                                       1150 04968000
         BNH   @DL01148                                            1150 04969000
*                      RETURNLN = 0;                       /*@Y30SSFR*/ 04970000
*                                                                  1151 04971000
         L     @07,CTGPLPTR                                        1151 04972000
         L     @07,CTGWKA(,@07)                                    1151 04973000
         SLR   @15,@15                                             1151 04974000
         STH   @15,RETURNLN(,@07)                                  1151 04975000
*                      /**********************************************/ 04976000
*                      /*                                    @Y30SSFR*/ 04977000
*                      /*  SET DEFINED TO BE ON TO INDICATE  @Y30SSFR*/ 04978000
*                      /*  ANOTHER ITERATION OF THE LOOP     @Y30SSFR*/ 04979000
*                      /*  CATALOG.                          @Y30SSFR*/ 04980000
*                      /*                                    @Y30SSFR*/ 04981000
*                      /**********************************************/ 04982000
*                                                                  1152 04983000
*                      DEFINED = ON;                       /*@Y30SSFR*/ 04984000
         OI    DEFINED,B'10000000'                                 1152 04985000
*                      END;                                /*@Y30SSFR*/ 04986000
*                                                                  1153 04987000
*                    ELSE                                  /*@Y30SSFR*/ 04988000
*                                                                  1154 04989000
*                      /**********************************************/ 04990000
*                      /*                                    @Y30SSFR*/ 04991000
*                      /*  DYNAMIC ALLOCATION HAS FAILED.    @Y30SSFR*/ 04992000
*                      /*  MAKE SETRC 8 TO INDICATE THAT THE @Y30SSFR*/ 04993000
*                      /*  THE OBJECT CANNOT BE DELETED.     @Y30SSFR*/ 04994000
*                      /*  RETURN TO THE CALLIN PROCESSOR.   @Y30SSFR*/ 04995000
*                      /*                                    @Y30SSFR*/ 04996000
*                      /**********************************************/ 04997000
*                                                                  1154 04998000
*                      DO;                                 /*@Y30SSFR*/ 04999000
         B     @RC01144                                            1154 05000000
@RF01144 DS    0H                                                  1155 05001000
*                      SETRC = MAX(SETRC,LASTCC08);        /*@Y30SSFR*/ 05002000
         LH    @07,SETRC                                           1155 05003000
         LA    @15,8                                               1155 05004000
         CR    @07,@15                                             1155 05005000
         BNL   *+6                                                      05006000
         LR    @07,@15                                             1155 05007000
         STH   @07,SETRC                                           1155 05008000
*                      RETURN CODE(SETRC);                 /*@Y30SSFR*/ 05009000
         LR    @15,@07                                             1156 05010000
         L     @14,@SA00008                                        1156 05011000
         LM    @00,@05,@SA00008+8                                  1156 05012000
         LM    @07,@12,@SA00008+32                                 1156 05013000
         BR    @14                                                 1156 05014000
*                      END;                                /*@Y30SSFR*/ 05015000
*                    END A1RC;                             /*@Y30SSFR*/ 05016000
*                                                                  1158 05017000
@RC01144 DS    0H                                                  1159 05018000
*              /******************************************************/ 05019000
*              /*                                            @Y30SSFR*/ 05020000
*              /*  SAVE THE CURRENT CPL IN DSAVCPL PRIOR TO  @Y30SSFR*/ 05021000
*              /*  CALLING CATALOG AGAIN.                    @Y30SSFR*/ 05022000
*              /*                                            @Y30SSFR*/ 05023000
*              /******************************************************/ 05024000
*                                                                  1159 05025000
*              DSAVCPL = CTGPL;                            /*@Y30SSFR*/ 05026000
*                                                                  1159 05027000
@RF01117 DS    0H                                                  1159 05028000
@RC01104 L     @07,CTGPLPTR                                        1159 05029000
         MVC   DSAVCPL(28),CTGPL(@07)                              1159 05030000
*            END CATALOG;                                  /*@Y30SSFR*/ 05031000
*                                                                  1160 05032000
@DE01055 TM    DEFINED,B'10000000'                                 1160 05033000
         BO    @DL01055                                            1160 05034000
*            /********************************************************/ 05035000
*            /*                                              @Z40RSSA*/ 05036000
*            /*  IF THE VSAM CATALOG RETURN CODE IS 110      @Z40RSSA*/ 05037000
*            /*  PRINT THE REASON THE PROFILE COULD NOT BE   @Z40RSSA*/ 05038000
*            /*  DELETED.                                    @Z40RSSA*/ 05039000
*            /*         REASON CODE 4 - NO PROFILE           @Z40RSSA*/ 05040000
*            /*         REASON CODE 8 - NOT DELETEABLE       @Z40RSSA*/ 05041000
*            /*                                              @Z40RSSA*/ 05042000
*            /*  IF NOT 110, SIMPLY PRINT THE VSAM RETURN CODE       */ 05043000
*            /*                                              @Z40RSSA*/ 05044000
*            /********************************************************/ 05045000
*                                                                  1161 05046000
*               IF CATLGRC = PRNTDEL & (CTGFBFLG = NFRET |         1161 05047000
*                 CTGFBFLG=NDRET) THEN                             1161 05048000
         CLC   CATLGRC(2),@CH01116                                 1161 05049000
         BNE   @RF01161                                            1161 05050000
         L     @07,CTGPLPTR                                        1161 05051000
         CLC   CTGFBFLG(2,@07),@CH00043                            1161 05052000
         BE    @RT01161                                            1161 05053000
         CLC   CTGFBFLG(2,@07),@CH00180                            1161 05054000
         BNE   @RF01161                                            1161 05055000
@RT01161 DS    0H                                                  1162 05056000
*                 DO;                                      /*@Z40RSSA*/ 05057000
*                   DARGLIST=''B;                          /*@Z40RSSA*/ 05058000
         L     @07,DDSTRU                                          1163 05059000
         XC    DARGLIST(20,@07),DARGLIST(@07)                      1163 05060000
*                   DARGSMOD = DELMSG;                     /*@Z40RSSA*/ 05061000
         MVC   DARGSMOD(3,@07),@CC00938                            1164 05062000
*                   IF CTGFBFLG = NFRET THEN                       1165 05063000
         L     @01,CTGPLPTR                                        1165 05064000
         CLC   CTGFBFLG(2,@01),@CH00043                            1165 05065000
         BNE   @RF01165                                            1165 05066000
*                     DARGSENT = PFNTFND;                  /*@Z40RSSA*/ 05067000
         MVI   DARGSENT(@07),X'0D'                                 1166 05068000
*                   ELSE                                   /*@Z40RSSA*/ 05069000
*                     DARGSENT = PFINUSE;                  /*@Z40RSSA*/ 05070000
         B     @RC01165                                            1167 05071000
@RF01165 L     @07,DDSTRU                                          1167 05072000
         MVI   DARGSENT(@07),X'0C'                                 1167 05073000
*                   CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);  /*@Z40RSSA*/ 05074000
@RC01165 L     @07,@PC00001                                        1168 05075000
         ST    @07,@AL00001                                        1168 05076000
         LA    @15,@CF00116                                        1168 05077000
         ST    @15,@AL00001+4                                      1168 05078000
         LA    @15,DDSTRU                                          1168 05079000
         ST    @15,@AL00001+8                                      1168 05080000
         MVI   @AL00001+8,X'80'                                    1168 05081000
         L     @15,GDTPRT(,@07)                                    1168 05082000
         LA    @01,@AL00001                                        1168 05083000
         BALR  @14,@15                                             1168 05084000
*                   SETRC = LASTCC04;                      /*@Z40RSSA*/ 05085000
         MVC   SETRC(2),@CH00043                                   1169 05086000
*                 END;                                     /*@Z40RSSA*/ 05087000
*              ELSE                                       /*@Z40RSSA*/  05088000
*            /********************************************************/ 05089000
*            /*                                              #Y30SSFR*/ 05090000
*            /*  IF THE VSAM CATALOG RETURN IS NON-ZERO,     #Y30SSFR*/ 05091000
*            /*  THERE IS AN ERROR CONDITION.  PRINT THE     #Y30SSFR*/ 05092000
*            /*  VSAM CATALOG RETURN CODE PROBLEM            #Y30SSFR*/ 05093000
*            /*  DETERMINATION MESSAGE PROVIDED THAT         #Y30SSFR*/ 05094000
*            /*  CATALOG HAS SET THE MODULE ID IN THE        #Y30SSFR*/ 05095000
*            /*  CTGFDBK FIELD OF THE CPL.  OTHERWISE, JUST  #Y30SSFR*/ 05096000
*            /*  PRINT THE CATALOG RETURN CODE.              #Y30SSFR*/ 05097000
*            /*                                              #Y30SSFR*/ 05098000
*            /********************************************************/ 05099000
*                                                                  1171 05100000
*            IF CATLGRC ^= 0                               /*#Y30SSFR*/ 05101000
*              THEN                                        /*#Y30SSFR*/ 05102000
         B     @RC01161                                            1171 05103000
@RF01161 LH    @07,CATLGRC                                         1171 05104000
         LTR   @07,@07                                             1171 05105000
         BZ    @RF01171                                            1171 05106000
*ERCALL2:        DO;                                       /*@Y30SSFR*/ 05107000
*                                                                  1172 05108000
ERCALL2  DS    0H                                                  1173 05109000
*               /*****************************************************/ 05110000
*               /*                                           @Y30SSFR*/ 05111000
*               /*  CLEAR THE STORAGE TO BE OCCUPIED BY THE  @Y30SSFR*/ 05112000
*               /*  ERROR CONVERSION TABLE.                  @Y30SSFR*/ 05113000
*               /*                                           @Y30SSFR*/ 05114000
*               /*****************************************************/ 05115000
*                                                                  1173 05116000
*               ERRORTAB = ''B;                            /*@Y30SSFR*/ 05117000
*                                                                  1173 05118000
         XC    ERRORTAB(32),ERRORTAB                               1173 05119000
*               /*****************************************************/ 05120000
*               /*                                           @Y30SSFR*/ 05121000
*               /*  SET ERCNVADR TO POINT TO THE STORAGE FOR @Y30SSFR*/ 05122000
*               /*  THE ERROR CONVERSION TABLE.              @Y30SSFR*/ 05123000
*               /*                                           @Y30SSFR*/ 05124000
*               /*****************************************************/ 05125000
*                                                                  1174 05126000
*               ERCNVADR = ADDR(ERRORTAB);                 /*@Y30SSFR*/ 05127000
*                                                                  1174 05128000
         LA    @07,ERRORTAB                                        1174 05129000
         ST    @07,ERCNVADR                                        1174 05130000
*               /*****************************************************/ 05131000
*               /*                                           @Y30SSFR*/ 05132000
*               /*  SET ERCATLG TO ON TO INDICATE THAT THIS  @Y30SSFR*/ 05133000
*               /*  IS A CATALOG ERROR.  THE CMS             @Y30SSFR*/ 05134000
*               /*  FUNCTION BEING PERFORMED IS A DELETE.    @Y30SSFR*/ 05135000
*               /*  SET THE ERCATDL BIT.                     @Y30SSFR*/ 05136000
*               /*                                           @Y30SSFR*/ 05137000
*               /*****************************************************/ 05138000
*                                                                  1175 05139000
*               ERCATLG = ON;                              /*@Y30SSFR*/ 05140000
         OI    ERCATLG(@07),B'10000000'                            1175 05141000
*               ERCATDL = ON;                              /*@Y30SSFR*/ 05142000
*                                                                  1176 05143000
         OI    ERCATDL(@07),B'00100000'                            1176 05144000
*               /*****************************************************/ 05145000
*               /*                                           @Y30SSFR*/ 05146000
*               /*  SET ERCATRC TO CATLGRC, AND SET ERCPLPT  @Y30SSFR*/ 05147000
*               /*  TO POINT TO THE CPL FOR THE CATALOG      @Y30SSFR*/ 05148000
*               /*  OPERATION.                               @Y30SSFR*/ 05149000
*               /*                                           @Y30SSFR*/ 05150000
*               /*****************************************************/ 05151000
*                                                                  1177 05152000
*               ERCATRC = CATLGRC;                         /*@Y30SSFR*/ 05153000
         LH    @15,CATLGRC                                         1177 05154000
         ST    @15,ERCATRC(,@07)                                   1177 05155000
*               ERCPLPT = CTGPLPTR;                        /*@Y30SSFR*/ 05156000
*                                                                  1178 05157000
         L     @15,CTGPLPTR                                        1178 05158000
         ST    @15,ERCPLPT(,@07)                                   1178 05159000
*              /******************************************************/ 05160000
*              /*                                            @Y30SSFR*/ 05161000
*              /*  SET A POINTER TO THE ENTRY NAME IN THE    @Y30SSFR*/ 05162000
*              /*  ERROR CONVERSION TABLE.                   @Y30SSFR*/ 05163000
*              /*                                            @Y30SSFR*/ 05164000
*              /******************************************************/ 05165000
*                                                                  1179 05166000
*              ERDSNM = CTGENT;                            /*@Y30SSFR*/ 05167000
*                                                                  1179 05168000
         L     @15,CTGENT(,@15)                                    1179 05169000
         ST    @15,ERDSNM(,@07)                                    1179 05170000
*               /*****************************************************/ 05171000
*               /*                                           @Y30SSFR*/ 05172000
*               /*  INVOKE THE UERROR ROUTINE BY ISSUING THE @Y30SSFR*/ 05173000
*               /*  UERROR MACRO OF THE AMS TEXT PROCESSOR.  @Y30SSFR*/ 05174000
*               /*                                           @Y30SSFR*/ 05175000
*               /*****************************************************/ 05176000
*                                                                  1180 05177000
*               CALL IDCTPER0(GDTTBL,ERCNVADR);            /*@Y30SSFR*/ 05178000
*                                                                  1180 05179000
         L     @07,@PC00001                                        1180 05180000
         ST    @07,@AL00001                                        1180 05181000
         LA    @15,ERCNVADR                                        1180 05182000
         ST    @15,@AL00001+4                                      1180 05183000
         MVI   @AL00001+4,X'80'                                    1180 05184000
         L     @15,GDTERR(,@07)                                    1180 05185000
         LA    @01,@AL00001                                        1180 05186000
         BALR  @14,@15                                             1180 05187000
*               SETRC = LASTCC08;                          /*@Y30SSFR*/ 05188000
         MVC   SETRC(2),@CH00180                                   1181 05189000
*               END ERCALL2;                               /*@Y30SSFR*/ 05190000
*                                                                  1182 05191000
*             ELSE                                         /*@Y30SSFR*/ 05192000
*                                                                  1183 05193000
*                /****************************************************/ 05194000
*                /*                                          #Y30SSFR*/ 05195000
*                /*  MAKE SETRC EQUAL TO 0 TO INDICATE THAT  #Y30SSFR*/ 05196000
*                /*  THE OBJECT HAS BEEN SUCCESSFULLY        #Y30SSFR*/ 05197000
*                /*  DELETED.                                #Y30SSFR*/ 05198000
*                /*                                          #Y30SSFR*/ 05199000
*                /****************************************************/ 05200000
*                                                                  1183 05201000
*                SETRC = LASTCC00;                         /*#Y30SSFR*/ 05202000
*                                                                  1183 05203000
         B     @RC01171                                            1183 05204000
@RF01171 SLR   @07,@07                                             1183 05205000
         STH   @07,SETRC                                           1183 05206000
*            RETURN CODE(SETRC);                           /*#Y30SSFR*/ 05207000
*                                                                  1184 05208000
@RC01171 DS    0H                                                  1184 05209000
@RC01161 LH    @15,SETRC                                           1184 05210000
         L     @14,@SA00008                                        1184 05211000
         LM    @00,@05,@SA00008+8                                  1184 05212000
         LM    @07,@12,@SA00008+32                                 1184 05213000
         BR    @14                                                 1184 05214000
*            END PERMEXP;                                  /*#Y30SSFR*/ 05215000
*                                                                  1185 05216000
*        /************************************************************/ 05217000
*        /*                                                          */ 05218000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 05219000
*        /*                                                          */ 05220000
*        /************************************************************/ 05221000
*                                                                  1186 05222000
*        RETURN CODE(0);                                           1186 05223000
*                                                                  1186 05224000
@RF01040 SLR   @15,@15                                             1186 05225000
         L     @14,@SA00008                                        1186 05226000
         LM    @00,@05,@SA00008+8                                  1186 05227000
         LM    @07,@12,@SA00008+32                                 1186 05228000
         BR    @14                                                 1186 05229000
*END DELTPROC;                                                     1187 05230000
*        /************************************************************/ 05231000
*        /*                                                          */ 05232000
*        /*  PROCEDURE NAME - PUTPROC                                */ 05233000
*        /*                                                          */ 05234000
*        /*  FUNCTION - OUTPUT A RECORD TO THE PORTABILITY DATA SET  */ 05235000
*        /*                                                          */ 05236000
*        /*  INPUT - LENGTH AND ADDRESS OF RECORD TO BE OUTPUTTED    */ 05237000
*        /*                                                          */ 05238000
*        /*  OUTPUT - RECORD WILL BE WRITTEN TO PORTABILITY DATA SET */ 05239000
*        /*                                                          */ 05240000
*        /************************************************************/ 05241000
*                                                                  1188 05242000
*PUTPROC:  PROCEDURE(PLNINIT,          /*LENGTH OF RECORD            */ 05243000
*                    PADINIT);         /*ADDRESS OF RECORD           */ 05244000
*                                                                  1188 05245000
PUTPROC  STM   @14,@12,@SA00009                                    1188 05246000
         MVC   @PC00009(8),0(@01)                                  1188 05247000
*        /************************************************************/ 05248000
*        /*                                                          */ 05249000
*        /*  ARGUMENTS OF INVOCATION                                 */ 05250000
*        /*                                                          */ 05251000
*        /************************************************************/ 05252000
*                                                                  1189 05253000
*        DCL PLNINIT FIXED(31),                                    1189 05254000
*            PADINIT PTR(31);                                      1189 05255000
*                                                                  1189 05256000
*        /************************************************************/ 05257000
*        /*                                                          */ 05258000
*        /*  LOCAL DECLARATIONS                                      */ 05259000
*        /*                                                          */ 05260000
*        /************************************************************/ 05261000
*                                                                  1190 05262000
*        DCL PLN FIXED(31);            /*LENGTH OF DATA YET TO OUTPUT*/ 05263000
*        DCL PAD PTR(31);              /*ADDRESS OF DATA TO OUTPUT   */ 05264000
*                                                                  1191 05265000
*        /************************************************************/ 05266000
*        /*                                                          */ 05267000
*        /*  SET UP IOCS FOR OUTPUT OF RECORD                        */ 05268000
*        /*                                                          */ 05269000
*        /************************************************************/ 05270000
*                                                                  1192 05271000
*        OLDERID2 = NEWERID2;                                      1192 05272000
         L     @02,@PC00001                                        1192 05273000
         L     @02,GDTTR2(,@02)                                    1192 05274000
         MVC   @TS00001(95),NEWERID2(@02)                          1192 05275000
         MVC   OLDERID2(95,@02),@TS00001                           1192 05276000
*        NEWID2 = 'XPPP';                                          1193 05277000
         MVC   NEWID2(4,@02),@CC01283                              1193 05278000
*        IOCSPTR = POUTIOCS;                                       1194 05279000
         L     IOCSPTR,POUTIOCS                                    1194 05280000
*        PAD = PADINIT;                                            1195 05281000
         L     @02,@PC00009+4                                      1195 05282000
         L     PAD,PADINIT(,@02)                                   1195 05283000
*        PLN = PLNINIT;                                            1196 05284000
*                                                                  1196 05285000
         L     @02,@PC00009                                        1196 05286000
         L     PLN,PLNINIT(,@02)                                   1196 05287000
*        /************************************************************/ 05288000
*        /*                                                          */ 05289000
*        /*  SPLIT RECORD INTO SEGMENTS IF LARGER THAN OUTPUT        */ 05290000
*        /*  LRECL LENGTH                                            */ 05291000
*        /*                                                          */ 05292000
*        /************************************************************/ 05293000
*                                                                  1197 05294000
*        DOCNTRL = ON;                                             1197 05295000
         OI    DOCNTRL,B'10000000'                                 1197 05296000
*PUTLP:  DO WHILE (DOCNTRL= ON);                                   1198 05297000
PUTLP    B     @DE01198                                            1198 05298000
@DL01198 DS    0H                                                  1199 05299000
*          IF PLN > IOCTRN                                         1199 05300000
*            THEN                                                  1199 05301000
         L     @02,IOCTRN(,IOCSPTR)                                1199 05302000
         CR    PLN,@02                                             1199 05303000
         BNH   @RF01199                                            1199 05304000
*              DO;                                                 1200 05305000
*              IOCDLN = IOCTRN;                                    1201 05306000
         ST    @02,IOCDLN(,IOCSPTR)                                1201 05307000
*              IOCDAD = PAD;                                       1202 05308000
         ST    PAD,IOCDAD(,IOCSPTR)                                1202 05309000
*              PAD = PAD + IOCTRN;                                 1203 05310000
         ALR   PAD,@02                                             1203 05311000
*              PLN = PLN - IOCTRN;                                 1204 05312000
         SLR   PLN,@02                                             1204 05313000
*              END;                                                1205 05314000
*            ELSE                                                  1206 05315000
*              DO;                                                 1206 05316000
         B     @RC01199                                            1206 05317000
@RF01199 DS    0H                                                  1207 05318000
*              IOCDLN = PLN;                                       1207 05319000
         ST    PLN,IOCDLN(,IOCSPTR)                                1207 05320000
*              IOCDAD = PAD;                                       1208 05321000
         ST    PAD,IOCDAD(,IOCSPTR)                                1208 05322000
*              DOCNTRL = OFF;                                      1209 05323000
         NI    DOCNTRL,B'01111111'                                 1209 05324000
*              END;                                                1210 05325000
*                                                                  1210 05326000
*                                                                  1210 05327000
*        /************************************************************/ 05328000
*        /*                                                          */ 05329000
*        /*  OUTPUT RECORD BY ISSUANCE OF THE UGET I/O ADAPTER       */ 05330000
*        /*  INTERFACE.  IF AN ERROR OCCURS, THE RETURN CODE WILL    */ 05331000
*        /*  BE SET TO INDICATE FAILURE. OTHERWISE, A GOOD RETURN    */ 05332000
*        /*  CODE WILL BE SET AND CONTROL WILL RETURN TO THE CALLING */ 05333000
*        /*  PROCESSOR.                                              */ 05334000
*        /*                                                          */ 05335000
*        /************************************************************/ 05336000
*                                                                  1211 05337000
*        CALL IDCIOPT0 (GDTTBL,POUTIOCS);                          1211 05338000
*                                                                  1211 05339000
@RC01199 L     @15,@PC00001                                        1211 05340000
         ST    @15,@AL00001                                        1211 05341000
         LA    @14,POUTIOCS                                        1211 05342000
         ST    @14,@AL00001+4                                      1211 05343000
         MVI   @AL00001+4,X'80'                                    1211 05344000
         L     @15,GDTPUT(,@15)                                    1211 05345000
         LA    @01,@AL00001                                        1211 05346000
         BALR  @14,@15                                             1211 05347000
*        RESPECIFY RTNREG RSTD;                                    1212 05348000
*        TESTRC = RTNREG;                                          1213 05349000
         LR    TESTRC,RTNREG                                       1213 05350000
*        RESPECIFY RTNREG UNRSTD;                                  1214 05351000
*        IF TESTRC ^= 0                                            1215 05352000
*          THEN                                                    1215 05353000
         LTR   TESTRC,TESTRC                                       1215 05354000
         BZ    @RF01215                                            1215 05355000
*            IF IOCMSGOP = OFF                                     1216 05356000
*              THEN                                                1216 05357000
         TM    IOCMSGOP(IOCSPTR),B'00100000'                       1216 05358000
         BNZ   @RF01216                                            1216 05359000
*                RETURN CODE(LASTCC12);                            1217 05360000
*                                                                  1217 05361000
         LA    @15,12                                              1217 05362000
         L     @14,@SA00009                                        1217 05363000
         LM    @00,@12,@SA00009+8                                  1217 05364000
         BR    @14                                                 1217 05365000
*        END PUTLP;                                                1218 05366000
*                                                                  1218 05367000
@RF01216 DS    0H                                                  1218 05368000
@RF01215 DS    0H                                                  1218 05369000
@DE01198 TM    DOCNTRL,B'10000000'                                 1218 05370000
         BO    @DL01198                                            1218 05371000
*        /************************************************************/ 05372000
*        /*                                                          */ 05373000
*        /*  RETURN TO CALLER WITH SUCCESS INDICATED                 */ 05374000
*        /*                                                          */ 05375000
*        /************************************************************/ 05376000
*                                                                  1219 05377000
*        RETURN CODE(0);                                           1219 05378000
*                                                                  1219 05379000
         SLR   @15,@15                                             1219 05380000
         L     @14,@SA00009                                        1219 05381000
         LM    @00,@12,@SA00009+8                                  1219 05382000
         BR    @14                                                 1219 05383000
*END PUTPROC;                                                      1220 05384000
*        /************************************************************/ 05385000
*        /*                                                          */ 05386000
*        /*  PROCEDURE NAME - RECPROC                                */ 05387000
*        /*                                                          */ 05388000
*        /*  FUNCTION - COPY THE DATA FROM THE DATA SET TO BE        */ 05389000
*        /*  EXPORTED TO THE PORTABILITY DATA SET, RECORD BY         */ 05390000
*        /*  RECORD.  THE VSAM CLUSTER IS OPENED BY OPENPROC,        */ 05391000
*        /*  THE UCOPY MACRO IS EMPLOYED TO PERFORM THE COPY, THEN   */ 05392000
*        /*  THE CLUSTER DATA SET IS CLOSED THROUGH ISSUANCE OF THE  */ 05393000
*        /*  UCLOSE MACRO.                                           */ 05394000
*        /*                                                          */ 05395000
*        /*  INPUT - NONE                                            */ 05396000
*        /*                                                          */ 05397000
*        /*  OUTPUT - THE PORTABILITY DATA SET WILL CONTAIN THE      */ 05398000
*        /*  RECORDS THAT COMPRISE THE EXPORTED DATA SET             */ 05399000
*        /*                                                          */ 05400000
*        /************************************************************/ 05401000
*                                                                  1221 05402000
*RECPROC:  PROCEDURE;                                              1221 05403000
*                                                                  1221 05404000
RECPROC  STM   @14,@05,@SA00010                                    1221 05405000
         STM   @07,@12,@SA00010+32                                 1221 05406000
*        /************************************************************/ 05407000
*        /*                                                          */ 05408000
*        /*  WRITE OUT CONTROL RECORD IDENTIFYING TYPE OF EXPORT     */ 05409000
*        /*  REORGANIZE OPTION, WHERE THE LOGICAL RECORDS            */ 05410000
*        /*  COMPRISING THE CLUSTER ARE COPIED TO THE PORTABILITY    */ 05411000
*        /*  DATA SET      ZERO FIELDS NOT USED                      */ 05412000
*        /*                                                          */ 05413000
*        /************************************************************/ 05414000
*                                                                  1222 05415000
*        OLDERID2 = NEWERID2;                                      1222 05416000
         L     @07,@PC00001                                        1222 05417000
         L     @07,GDTTR2(,@07)                                    1222 05418000
         MVC   @TS00001(95),NEWERID2(@07)                          1222 05419000
         MVC   OLDERID2(95,@07),@TS00001                           1222 05420000
*        NEWID2 = 'XPRP';                                  /*@Y30SSFR*/ 05421000
*                                                                  1223 05422000
         MVC   NEWID2(4,@07),@CC01289                              1223 05423000
*        HEADFLG2 = '00'X;                                         1224 05424000
         L     @07,CONRCPTR                                        1224 05425000
         MVI   HEADFLG2(@07),X'00'                                 1224 05426000
*        ASSRECLN = 0;                                             1225 05427000
         SLR   @15,@15                                             1225 05428000
         STH   @15,ASSRECLN(,@07)                                  1225 05429000
*        ASSRECNM = 0;                                             1226 05430000
         STH   @15,ASSRECNM(,@07)                                  1226 05431000
*        HEADLN = LENGTH(HEADER);                                  1227 05432000
         LA    @15,8                                               1227 05433000
         STH   @15,HEADLN(,@07)                                    1227 05434000
*        HEADFLG1 = HDFL1REO;                                      1228 05435000
         MVI   HEADFLG1(@07),X'01'                                 1228 05436000
*        TOTLEN = HEADLN;                                          1229 05437000
*                                                                  1229 05438000
         ST    @15,TOTLEN                                          1229 05439000
*        CALL PUTPROC(TOTLEN,CONRCPTR);                            1230 05440000
*                                                                  1230 05441000
         LA    @07,TOTLEN                                          1230 05442000
         ST    @07,@AL00001                                        1230 05443000
         LA    @07,CONRCPTR                                        1230 05444000
         ST    @07,@AL00001+4                                      1230 05445000
         LA    @01,@AL00001                                        1230 05446000
         BAL   @14,PUTPROC                                         1230 05447000
*        RESPECIFY RTNREG RSTD;                                    1231 05448000
*        TESTRC = RTNREG;                                          1232 05449000
         LR    TESTRC,RTNREG                                       1232 05450000
*        RESPECIFY RTNREG UNRSTD;                                  1233 05451000
*        IF TESTRC ^= 0                                            1234 05452000
*          THEN                                                    1234 05453000
         LTR   TESTRC,TESTRC                                       1234 05454000
         BZ    @RF01234                                            1234 05455000
*            RETURN CODE(LASTCC12);                                1235 05456000
*                                                                  1235 05457000
         LA    @15,12                                              1235 05458000
         L     @14,@SA00010                                        1235 05459000
         LM    @00,@05,@SA00010+8                                  1235 05460000
         LM    @07,@12,@SA00010+32                                 1235 05461000
         BR    @14                                                 1235 05462000
*        /************************************************************/ 05463000
*        /*                                                          */ 05464000
*        /*  CALL OPENPROC TO OPEN THE VSAM CLUSTER FOR INPUT.       */ 05465000
*        /*  IF THE OPEN FAILS, RETURN TO THE CALLING PROCESSOR WITH */ 05466000
*        /*  FAILURE INDICATED                                       */ 05467000
*        /*                                                          */ 05468000
*        /************************************************************/ 05469000
*                                                                  1236 05470000
*    IF ADDR(INDD) ^= NULLPTR                                      1236 05471000
*      THEN                                                        1236 05472000
@RF01234 L     @07,@PC00001+4                                      1236 05473000
         L     @07,FDTPTR+4(,@07)                                  1236 05474000
         LTR   @07,@07                                             1236 05475000
         BZ    @RF01236                                            1236 05476000
*        CALL OPENPROC('I',ADDR(INDDVAL),NULLPARM,0,0,             1237 05477000
*          ADDR(PINIOCS));                                         1237 05478000
         MVC   @AL00001(20),@AL01237                               1237 05479000
         LA    @07,INDDVAL(,@07)                                   1237 05480000
         ST    @07,@AFTEMPS+20                                     1237 05481000
         LA    @07,@AFTEMPS+20                                     1237 05482000
         ST    @07,@AL00001+4                                      1237 05483000
         LA    @07,PINIOCS                                         1237 05484000
         ST    @07,@AFTEMPS+24                                     1237 05485000
         LA    @07,@AFTEMPS+24                                     1237 05486000
         ST    @07,@AL00001+20                                     1237 05487000
         LA    @01,@AL00001                                        1237 05488000
         BAL   @14,OPENPROC                                        1237 05489000
*      ELSE                                                        1238 05490000
*        CALL OPENPROC('I',ADDR(ALLDDN),NULLPARM,0,0,              1238 05491000
*          ADDR(PINIOCS));                                 /*@YL026UA*/ 05492000
         B     @RC01236                                            1238 05493000
@RF01236 MVC   @AL00001(20),@AL01238                               1238 05494000
         L     @07,ALLPTR                                          1238 05495000
         LA    @07,ALLDDN(,@07)                                    1238 05496000
         ST    @07,@AFTEMPS+20                                     1238 05497000
         LA    @07,@AFTEMPS+20                                     1238 05498000
         ST    @07,@AL00001+4                                      1238 05499000
         LA    @07,PINIOCS                                         1238 05500000
         ST    @07,@AFTEMPS+24                                     1238 05501000
         LA    @07,@AFTEMPS+24                                     1238 05502000
         ST    @07,@AL00001+20                                     1238 05503000
         LA    @01,@AL00001                                        1238 05504000
         BAL   @14,OPENPROC                                        1238 05505000
*        RESPECIFY RTNREG RSTD;                                    1239 05506000
@RC01236 DS    0H                                                  1240 05507000
*        TESTRC = RTNREG;                                          1240 05508000
         LR    TESTRC,RTNREG                                       1240 05509000
*        RESPECIFY RTNREG UNRSTD;                                  1241 05510000
*        IF TESTRC ^= 0                                            1242 05511000
*          THEN                                                    1242 05512000
         LTR   TESTRC,TESTRC                                       1242 05513000
         BZ    @RF01242                                            1242 05514000
*            RETURN CODE(LASTCC12);                                1243 05515000
*                                                                  1243 05516000
         LA    @15,12                                              1243 05517000
         L     @14,@SA00010                                        1243 05518000
         LM    @00,@05,@SA00010+8                                  1243 05519000
         LM    @07,@12,@SA00010+32                                 1243 05520000
         BR    @14                                                 1243 05521000
*        /************************************************************/ 05522000
*        /*                                                  @Y30SSFR*/ 05523000
*        /*  COMPARE THE NAME OF THE DATA SET ACTUALLY       @Y30SSFR*/ 05524000
*        /*  OPENED WITH THAT GIVEN AS THE NAME OF THE       @Y30SSFR*/ 05525000
*        /*  OBJECT TO BE EXPORTED.  IF THEY ARE NOT         @Y30SSFR*/ 05526000
*        /*  EQUAL, DETERMINE IF THE OBJECT OPENED IS        @Y30SSFR*/ 05527000
*        /*  A PATH OVER THE OBJECT BEING EXPORTED.          @Y30SSFR*/ 05528000
*        /*                                                  @Y30SSFR*/ 05529000
*        /************************************************************/ 05530000
*                                                                  1244 05531000
*        IOCSPTR = PINIOCS;                                /*@Y30SSFR*/ 05532000
*                                                                  1244 05533000
@RF01242 L     IOCSPTR,PINIOCS                                     1244 05534000
*        IF DSNAME ^= ENTVAL                               /*@Y30SSFR*/ 05535000
*          THEN                                            /*@Y30SSFR*/ 05536000
         L     @07,IOCDSN(,IOCSPTR)                                1245 05537000
         L     @02,@PC00001+4                                      1245 05538000
         L     @02,FDTPTR(,@02)                                    1245 05539000
         CLC   DSNAME(44,@07),ENTVAL(@02)                          1245 05540000
         BE    @RF01245                                            1245 05541000
*NAMEOPEN:   DO;                                           /*@XO4SVFR*/ 05542000
*                                                                  1246 05543000
NAMEOPEN DS    0H                                                  1247 05544000
*            /********************************************************/ 05545000
*            /*                                              @Y30SSFR*/ 05546000
*            /*  CALL LOCPROC TO BUILD A CPL AND FPL'S FOR A @Y30SSFR*/ 05547000
*            /*  LOCATE ON THE NAME RETURNED IN THE IOCSTR.  @Y30SSFR*/ 05548000
*            /*                                              @Y30SSFR*/ 05549000
*            /********************************************************/ 05550000
*                                                                  1247 05551000
*            CALL LOCPROC(ADDR(DSNAME),NULLPARM,PTRCTACB,  /*@Y30SSFR*/ 05552000
*               FLIST1,F1NUM,RCPCPLPT);                    /*@Y30SSFR*/ 05553000
*                                                                  1247 05554000
         LA    @07,IOCDSN(,IOCSPTR)                                1247 05555000
         ST    @07,@AL00001                                        1247 05556000
         LA    @07,NULLPARM                                        1247 05557000
         ST    @07,@AL00001+4                                      1247 05558000
         LA    @07,PTRCTACB                                        1247 05559000
         ST    @07,@AL00001+8                                      1247 05560000
         LA    @07,FLIST1                                          1247 05561000
         ST    @07,@AL00001+12                                     1247 05562000
         LA    @07,F1NUM                                           1247 05563000
         ST    @07,@AL00001+16                                     1247 05564000
         LA    @07,RCPCPLPT                                        1247 05565000
         ST    @07,@AL00001+20                                     1247 05566000
         LA    @01,@AL00001                                        1247 05567000
         BAL   @14,LOCPROC                                         1247 05568000
*            RESPECIFY RTNREG RSTD;                                1248 05569000
*            TESTRC = RTNREG;                                      1249 05570000
         LR    TESTRC,RTNREG                                       1249 05571000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 05572000
*                                                                  1250 05573000
*            IF TESTRC ^= 0                                /*@Y30SSFR*/ 05574000
*              THEN                                        /*@Y30SSFR*/ 05575000
         LTR   TESTRC,TESTRC                                       1251 05576000
         BZ    @RF01251                                            1251 05577000
*                RETURN CODE(LASTCC04);                    /*@Y30SSFR*/ 05578000
*                                                                  1252 05579000
         LA    @15,4                                               1252 05580000
         L     @14,@SA00010                                        1252 05581000
         LM    @00,@05,@SA00010+8                                  1252 05582000
         LM    @07,@12,@SA00010+32                                 1252 05583000
         BR    @14                                                 1252 05584000
*            /********************************************************/ 05585000
*            /*                                              @Y30SSFR*/ 05586000
*            /*  TURN ON CTGBYPSS SO THAT DOS WILL BYPASS    @Y30SSFR*/ 05587000
*            /*  SECURITY.                                   @Y30SSFR*/ 05588000
*            /*                                              @Y30SSFR*/ 05589000
*            /********************************************************/ 05590000
*                                                                  1253 05591000
*            CTGPLPTR = RCPCPLPT;                          /*@Y30SSFR*/ 05592000
@RF01251 L     @07,RCPCPLPT                                        1253 05593000
         ST    @07,CTGPLPTR                                        1253 05594000
*            CTGBYPSS = ON;                                /*@Y30SSFR*/ 05595000
*                                                                  1254 05596000
         OI    CTGBYPSS(@07),B'10000000'                           1254 05597000
*            /********************************************************/ 05598000
*            /*                                              @Y30SSFR*/ 05599000
*            /*  CALL CTLGPROC TO ISSUE A UCATLG TO DO THE   @Y30SSFR*/ 05600000
*            /*  ACTUAL LOCATE.                              @Y30SSFR*/ 05601000
*            /*                                              @Y30SSFR*/ 05602000
*            /********************************************************/ 05603000
*                                                                  1255 05604000
*            CALL CTLGPROC(RCPCPLPT);                      /*@Y30SSFR*/ 05605000
*                                                                  1255 05606000
         LA    @07,RCPCPLPT                                        1255 05607000
         ST    @07,@AL00001                                        1255 05608000
         LA    @01,@AL00001                                        1255 05609000
         BAL   @14,CTLGPROC                                        1255 05610000
*            RESPECIFY RTNREG RSTD;                                1256 05611000
*            TESTRC = RTNREG;                                      1257 05612000
         LR    TESTRC,RTNREG                                       1257 05613000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 05614000
*                                                                  1258 05615000
*            IF TESTRC ^= 0                                /*@Y30SSFR*/ 05616000
*              THEN                                        /*@Y30SSFR*/ 05617000
         LTR   TESTRC,TESTRC                                       1259 05618000
         BZ    @RF01259                                            1259 05619000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 05620000
*                                                                  1260 05621000
         LA    @15,12                                              1260 05622000
         L     @14,@SA00010                                        1260 05623000
         LM    @00,@05,@SA00010+8                                  1260 05624000
         LM    @07,@12,@SA00010+32                                 1260 05625000
         BR    @14                                                 1260 05626000
*            CTGFLPTR = CTGFIELD(KENTYPE);                 /*@Y30SSFR*/ 05627000
*                                                                  1261 05628000
@RF01259 L     @07,CTGPLPTR                                        1261 05629000
         L     CTGFLPTR,CTGFIELD(,@07)                             1261 05630000
*            /********************************************************/ 05631000
*            /*                                              @Y30SSFR*/ 05632000
*            /*  TEST TO BE SURE THAT THE OBJECT LOCATED     @Y30SSFR*/ 05633000
*            /*  UPON IS A PATH.                             @Y30SSFR*/ 05634000
*            /*                                              @Y30SSFR*/ 05635000
*            /********************************************************/ 05636000
*                                                                  1262 05637000
*            IF FENTYPE ^= CTGTPTH                         /*@Y30SSFR*/ 05638000
*              THEN                                        /*@Y30SSFR*/ 05639000
         L     @07,CTGFLPT(,CTGFLPTR)                              1262 05640000
         CLI   FENTYPE(@07),C'R'                                   1262 05641000
         BE    @RF01262                                            1262 05642000
*                DO;                                       /*@Y30SSFR*/ 05643000
*                DARGSMOD = UNIVMSG;                       /*@Y30SSFR*/ 05644000
         L     @07,DDSTRU                                          1264 05645000
         MVC   DARGSMOD(3,@07),@CC00930                            1264 05646000
*                DEFSTID = NOMATMSG;                       /*@Y30SSFR*/ 05647000
         LA    DEFSTID,11                                          1265 05648000
*                DARGILP = LENGTH(ENTVAL);                 /*@Y30SSFR*/ 05649000
         MVC   DARGILP(2,@07),@CH00604                             1266 05650000
*                DARGDBP = ADDR(ENTVAL);                   /*@Y30SSFR*/ 05651000
         L     @15,@PC00001+4                                      1267 05652000
         L     @01,FDTPTR(,@15)                                    1267 05653000
         LA    @15,ENTVAL(,@01)                                    1267 05654000
         ST    @15,DARGDBP(,@07)                                   1267 05655000
*                RETURN CODE(LASTCC12);                    /*@Y30SSFR*/ 05656000
         LA    @15,12                                              1268 05657000
         L     @14,@SA00010                                        1268 05658000
         LM    @00,@05,@SA00010+8                                  1268 05659000
         LM    @07,@12,@SA00010+32                                 1268 05660000
         BR    @14                                                 1268 05661000
*                END;                                      /*@Y30SSFR*/ 05662000
*                                                                  1269 05663000
*              ELSE                                                1270 05664000
*                                                                  1270 05665000
*                /****************************************************/ 05666000
*                /*                                          @Y30SSFR*/ 05667000
*                /*  DO ANOTHER LOCATE TO DETERMINE IF THE   @Y30SSFR*/ 05668000
*                /*  PATH IS OVER THE OBJECT BEING EXPORTED. @Y30SSFR*/ 05669000
*                /*  IF NOT, TERMINATE THE COMMAND.          @Y30SSFR*/ 05670000
*                /*                                          @Y30SSFR*/ 05671000
*                /****************************************************/ 05672000
*                                                                  1270 05673000
*                DO;                                       /*@Y30SSFR*/ 05674000
@RF01262 DS    0H                                                  1271 05675000
*                CTGFLPTR = CTGFIELD(KNAMEDS);             /*@Y30SSFR*/ 05676000
         L     @07,CTGPLPTR                                        1271 05677000
         L     CTGFLPTR,CTGFIELD+4(,@07)                           1271 05678000
*                FNMPTR = CTGFLPT(1);                      /*@Y30SSFR*/ 05679000
         L     FNMPTR,CTGFLPT(,CTGFLPTR)                           1272 05680000
*                IF FTYPE ^= CTGTCL & FTYPE ^= CTGTAIX     /*@Y30SSFR*/ 05681000
*                  THEN                                    /*@Y30SSFR*/ 05682000
         CLI   FTYPE(FNMPTR),C'C'                                  1273 05683000
         BE    @RF01273                                            1273 05684000
         CLI   FTYPE(FNMPTR),C'G'                                  1273 05685000
         BE    @RF01273                                            1273 05686000
*                    DO;                                   /*@Y30SSFR*/ 05687000
*                    DARGSMOD = UNIVMSG;                   /*@Y30SSFR*/ 05688000
         L     @07,DDSTRU                                          1275 05689000
         MVC   DARGSMOD(3,@07),@CC00930                            1275 05690000
*                    DEFSTID = NOMATMSG;                   /*@Y30SSFR*/ 05691000
         LA    DEFSTID,11                                          1276 05692000
*                    DARGILP = LENGTH(ENTVAL);             /*@Y30SSFR*/ 05693000
         MVC   DARGILP(2,@07),@CH00604                             1277 05694000
*                    DARGDBP = ADDR(ENTVAL);               /*@Y30SSFR*/ 05695000
*                                                                  1278 05696000
         L     @15,@PC00001+4                                      1278 05697000
         L     @01,FDTPTR(,@15)                                    1278 05698000
         LA    @15,ENTVAL(,@01)                                    1278 05699000
         ST    @15,DARGDBP(,@07)                                   1278 05700000
*                    RETURN CODE(LASTCC12);                /*@Y30SSFR*/ 05701000
*                                                                  1279 05702000
         LA    @15,12                                              1279 05703000
         L     @14,@SA00010                                        1279 05704000
         LM    @00,@05,@SA00010+8                                  1279 05705000
         LM    @07,@12,@SA00010+32                                 1279 05706000
         BR    @14                                                 1279 05707000
*                    END;                                  /*@Y30SSFR*/ 05708000
*                                                                  1280 05709000
*                  ELSE                                    /*@Y30SSFR*/ 05710000
*                                                                  1281 05711000
*                    DO;                                   /*@Y30SSFR*/ 05712000
*                                                                  1281 05713000
@RF01273 DS    0H                                                  1282 05714000
*                    /************************************************/ 05715000
*                    /*                                      @Y30SSFR*/ 05716000
*                    /*  CALL LOCPROC TO BUILD THE CPL AND   @Y30SSFR*/ 05717000
*                    /*  FPL'S TO DO THE LOCATE.             @Y30SSFR*/ 05718000
*                    /*                                      @Y30SSFR*/ 05719000
*                    /************************************************/ 05720000
*                                                                  1282 05721000
*                    CALL LOCPROC(NULLPARM,FNAME,PTRCTACB, /*@Y30SSFR*/ 05722000
*                       FLIST2,F2NUM,RCPCPLPT);            /*@Y30SSFR*/ 05723000
*                                                                  1282 05724000
         LA    @07,NULLPARM                                        1282 05725000
         ST    @07,@AL00001                                        1282 05726000
         LA    @07,FNAME(,FNMPTR)                                  1282 05727000
         ST    @07,@AL00001+4                                      1282 05728000
         LA    @07,PTRCTACB                                        1282 05729000
         ST    @07,@AL00001+8                                      1282 05730000
         LA    @07,FLIST2                                          1282 05731000
         ST    @07,@AL00001+12                                     1282 05732000
         LA    @07,F2NUM                                           1282 05733000
         ST    @07,@AL00001+16                                     1282 05734000
         LA    @07,RCPCPLPT                                        1282 05735000
         ST    @07,@AL00001+20                                     1282 05736000
         LA    @01,@AL00001                                        1282 05737000
         BAL   @14,LOCPROC                                         1282 05738000
*                    RESPECIFY RTNREG RSTD;                        1283 05739000
*                    TESTRC = RTNREG;                              1284 05740000
         LR    TESTRC,RTNREG                                       1284 05741000
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSFR*/ 05742000
*                                                                  1285 05743000
*                    IF TESTRC ^= 0                        /*@Y30SSFR*/ 05744000
*                      THEN                                /*@Y30SSFR*/ 05745000
         LTR   TESTRC,TESTRC                                       1286 05746000
         BZ    @RF01286                                            1286 05747000
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/ 05748000
*                                                                  1287 05749000
         LA    @15,12                                              1287 05750000
         L     @14,@SA00010                                        1287 05751000
         LM    @00,@05,@SA00010+8                                  1287 05752000
         LM    @07,@12,@SA00010+32                                 1287 05753000
         BR    @14                                                 1287 05754000
*                    /************************************************/ 05755000
*                    /*                                      @Y30SSFR*/ 05756000
*                    /*  SET CTGBYPSS TO ON TO CAUSE DOS TO  @Y30SSFR*/ 05757000
*                    /*  BYPASS SECURITY VERIFICATION.       @Y30SSFR*/ 05758000
*                    /*                                      @Y30SSFR*/ 05759000
*                    /************************************************/ 05760000
*                                                                  1288 05761000
*                    CTGBYPSS = ON;                        /*@Y30SSFR*/ 05762000
*                                                                  1288 05763000
@RF01286 L     @07,CTGPLPTR                                        1288 05764000
         OI    CTGBYPSS(@07),B'10000000'                           1288 05765000
*                    /************************************************/ 05766000
*                    /*                                      @Y30SSFR*/ 05767000
*                    /*  CALL VSAM CATALOG MANAGEMENT TO DO  @Y30SSFR*/ 05768000
*                    /*  THE ACTUAL LOCATE.                  @Y30SSFR*/ 05769000
*                    /*                                      @Y30SSFR*/ 05770000
*                    /************************************************/ 05771000
*                                                                  1289 05772000
*                    CALL CTLGPROC(RCPCPLPT);              /*@Y30SSFR*/ 05773000
*                                                                  1289 05774000
         LA    @07,RCPCPLPT                                        1289 05775000
         ST    @07,@AL00001                                        1289 05776000
         LA    @01,@AL00001                                        1289 05777000
         BAL   @14,CTLGPROC                                        1289 05778000
*                    RESPECIFY RTNREG RSTD;                        1290 05779000
*                    TESTRC = RTNREG;                              1291 05780000
         LR    TESTRC,RTNREG                                       1291 05781000
*                    RESPECIFY RTNREG UNRSTD;              /*@Y30SSFR*/ 05782000
*                                                                  1292 05783000
*                    IF TESTRC ^= 0                        /*@Y30SSFR*/ 05784000
*                      THEN                                /*@Y30SSFR*/ 05785000
         LTR   TESTRC,TESTRC                                       1293 05786000
         BZ    @RF01293                                            1293 05787000
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/ 05788000
*                                                                  1294 05789000
         LA    @15,12                                              1294 05790000
         L     @14,@SA00010                                        1294 05791000
         LM    @00,@05,@SA00010+8                                  1294 05792000
         LM    @07,@12,@SA00010+32                                 1294 05793000
         BR    @14                                                 1294 05794000
*                    /************************************************/ 05795000
*                    /*                                      @Y30SSFR*/ 05796000
*                    /*  COMPARE THE NAME OF THE OBJECT      @Y30SSFR*/ 05797000
*                    /*  BEING EXPORTED WITH THAT ACTUALLY   @Y30SSFR*/ 05798000
*                    /*  OPENED.  IF THEY ARE NOT EQUAL,     @Y30SSFR*/ 05799000
*                    /*  SET UP TO PRINT AN ERROR MESSAGE,   @Y30SSFR*/ 05800000
*                    /*  AND RETURN TO THE CALLING ROUTINE.  @Y30SSFR*/ 05801000
*                    /*                                      @Y30SSFR*/ 05802000
*                    /************************************************/ 05803000
*                                                                  1295 05804000
*                    CTGFLPTR = CTGFIELD(KENTNAME);        /*@Y30SSFR*/ 05805000
@RF01293 L     @07,CTGPLPTR                                        1295 05806000
         L     CTGFLPTR,CTGFIELD(,@07)                             1295 05807000
*                    IF FENTNAME ^= ENTVAL                 /*@Y30SSFR*/ 05808000
*                      THEN                                /*@Y30SSFR*/ 05809000
         L     @07,CTGFLPT(,CTGFLPTR)                              1296 05810000
         L     @03,@PC00001+4                                      1296 05811000
         L     @03,FDTPTR(,@03)                                    1296 05812000
         CLC   FENTNAME(44,@07),ENTVAL(@03)                        1296 05813000
         BE    @RF01296                                            1296 05814000
*                        DO;                               /*@Y30SSFR*/ 05815000
*                        DARGSMOD = UNIVMSG;               /*@Y30SSFR*/ 05816000
         L     @07,DDSTRU                                          1298 05817000
         MVC   DARGSMOD(3,@07),@CC00930                            1298 05818000
*                        DEFSTID = NOMATMSG;               /*@Y30SSFR*/ 05819000
         LA    DEFSTID,11                                          1299 05820000
*                        DARGDBP = ADDR(ENTVAL);           /*@Y30SSFR*/ 05821000
         LA    @15,ENTVAL(,@03)                                    1300 05822000
         ST    @15,DARGDBP(,@07)                                   1300 05823000
*                        DARGILP = LENGTH(ENTVAL);         /*@Y30SSFR*/ 05824000
*                                                                  1301 05825000
         MVC   DARGILP(2,@07),@CH00604                             1301 05826000
*                        RETURN CODE(LASTCC12);            /*@Y30SSFR*/ 05827000
*                                                                  1302 05828000
         LA    @15,12                                              1302 05829000
         L     @14,@SA00010                                        1302 05830000
         LM    @00,@05,@SA00010+8                                  1302 05831000
         LM    @07,@12,@SA00010+32                                 1302 05832000
         BR    @14                                                 1302 05833000
*                        END;                              /*@Y30SSFR*/ 05834000
*                                                                  1303 05835000
*                    END;                                  /*@Y30SSFR*/ 05836000
@RF01296 DS    0H                                                  1305 05837000
*                END;                                      /*@Y30SSFR*/ 05838000
*            END NAMEOPEN;                                 /*@Y30SSFR*/ 05839000
*                                                                  1306 05840000
*        /************************************************************/ 05841000
*        /*                                                          */ 05842000
*        /*  COPY DATA BY RECORD FROM THE CLUSTER TO THE PORTABILITY */ 05843000
*        /*  DATA SET.  IF ANY ERRORS ARE ENCOUNTERED, RETURN TO THE */ 05844000
*        /*  CALLING PROCESSOR WITH ERROR INDICATED                  */ 05845000
*        /*                                                          */ 05846000
*        /************************************************************/ 05847000
*                                                                  1307 05848000
*        CALL IDCIOCO0 (GDTTBL,PINIOCS,POUTIOCS);                  1307 05849000
*                                                                  1307 05850000
@RF01245 L     @07,@PC00001                                        1307 05851000
         ST    @07,@AL00001                                        1307 05852000
         LA    @03,PINIOCS                                         1307 05853000
         ST    @03,@AL00001+4                                      1307 05854000
         LA    @03,POUTIOCS                                        1307 05855000
         ST    @03,@AL00001+8                                      1307 05856000
         MVI   @AL00001+8,X'80'                                    1307 05857000
         L     @15,GDTCPY(,@07)                                    1307 05858000
         LA    @01,@AL00001                                        1307 05859000
         BALR  @14,@15                                             1307 05860000
*        RESPECIFY RTNREG RSTD;                                    1308 05861000
*        TESTRC = RTNREG;                                          1309 05862000
         LR    TESTRC,RTNREG                                       1309 05863000
*        RESPECIFY RTNREG UNRSTD;                                  1310 05864000
*        IF TESTRC ^= 0                                            1311 05865000
*          THEN                                                    1311 05866000
         LTR   TESTRC,TESTRC                                       1311 05867000
         BZ    @RF01311                                            1311 05868000
*            RETURN CODE(LASTCC12);                                1312 05869000
*                                                                  1312 05870000
         LA    @15,12                                              1312 05871000
         L     @14,@SA00010                                        1312 05872000
         LM    @00,@05,@SA00010+8                                  1312 05873000
         LM    @07,@12,@SA00010+32                                 1312 05874000
         BR    @14                                                 1312 05875000
*        /************************************************************/ 05876000
*        /*                                                          */ 05877000
*        /*  CLOSE THE INPUT DATA SET (THE VSAM CLUSTER).  IF THE    */ 05878000
*        /*  CLOSE FAILS, RETURN TO THE CALLING PROCESSOR WITH ERROR */ 05879000
*        /*  INDICATED.                                              */ 05880000
*        /*                                                          */ 05881000
*        /************************************************************/ 05882000
*                                                                  1313 05883000
*        CALL IDCIOCL0 (GDTTBL,PINIOCS);                           1313 05884000
*                                                                  1313 05885000
@RF01311 L     @07,@PC00001                                        1313 05886000
         ST    @07,@AL00001                                        1313 05887000
         LA    @03,PINIOCS                                         1313 05888000
         ST    @03,@AL00001+4                                      1313 05889000
         MVI   @AL00001+4,X'80'                                    1313 05890000
         L     @15,GDTCLS(,@07)                                    1313 05891000
         LA    @01,@AL00001                                        1313 05892000
         BALR  @14,@15                                             1313 05893000
*        RESPECIFY RTNREG RSTD;                                    1314 05894000
*        TESTRC = RTNREG;                                          1315 05895000
         LR    TESTRC,RTNREG                                       1315 05896000
*        RESPECIFY RTNREG UNRSTD;                                  1316 05897000
*        PINIOCS = NULLPTR;                                        1317 05898000
         SLR   @07,@07                                             1317 05899000
         ST    @07,PINIOCS                                         1317 05900000
*        IF TESTRC ^= 0                                            1318 05901000
*          THEN                                                    1318 05902000
         CR    TESTRC,@07                                          1318 05903000
         BE    @RF01318                                            1318 05904000
*            RETURN CODE(LASTCC12);                                1319 05905000
*                                                                  1319 05906000
         LA    @15,12                                              1319 05907000
         L     @14,@SA00010                                        1319 05908000
         LM    @00,@05,@SA00010+8                                  1319 05909000
         LM    @07,@12,@SA00010+32                                 1319 05910000
         BR    @14                                                 1319 05911000
*        /************************************************************/ 05912000
*        /*                                                          */ 05913000
*        /*  RETURN TO THE CALLING PROCESSOR WITH SUCCESSFUL         */ 05914000
*        /*  COMPLETION INDICATED                                    */ 05915000
*        /*                                                          */ 05916000
*        /************************************************************/ 05917000
*                                                                  1320 05918000
*        RETURN CODE(LASTCC00);                                    1320 05919000
@RF01318 SLR   @15,@15                                             1320 05920000
         L     @14,@SA00010                                        1320 05921000
         LM    @00,@05,@SA00010+8                                  1320 05922000
         LM    @07,@12,@SA00010+32                                 1320 05923000
         BR    @14                                                 1320 05924000
*END RECPROC;                                                      1321 05925000
*        /************************************************************/ 05926000
*        /*                                                  @Y30SSFR*/ 05927000
*        /*  PROCEDURE NAME - MVDAPROC                       @Y30SSFR*/ 05928000
*        /*                                                  @Y30SSFR*/ 05929000
*        /*  FUNCTION - MOVES DATA FROM ONE LOCATION IN CORE @Y30SSFR*/ 05930000
*        /*  TO ANOTHER AS SPECIFIED BY INPUT ARGUMENTS,     @Y30SSFR*/ 05931000
*        /*  OR ZEROS OUT AN AREA OF CORE IF SPECIFIED BY    @Y30SSFR*/ 05932000
*        /*  ITS ARGUMENTS.                                  @Y30SSFR*/ 05933000
*        /*                                                  @Y30SSFR*/ 05934000
*        /*  INPUT -                                         @Y30SSFR*/ 05935000
*        /*    .MSIZE - LENGTH OF DATA TO BE MOVED           @Y30SSFR*/ 05936000
*        /*    .MF1PTR- FROM LOCATION                        @Y30SSFR*/ 05937000
*        /*    .MT1PTR- TO LOCATION                          @Y30SSFR*/ 05938000
*        /*    .ZEROOUT - FLAG TO INDICATE WHETHER MDVAPROC  @Y30SSFR*/ 05939000
*        /*        IS TO ZERO OUT CORE                       @Y30SSFR*/ 05940000
*        /*                                                  @Y30SSFR*/ 05941000
*        /*  OUTPUT - DATA WILL BE MOVED TO LOCATION INDICATED BY    */ 05942000
*        /*  THE "TO" AGRUMENT (MPTR) IF IT IS SPECIFIED.    @Y30SSFR*/ 05943000
*        /*  IF ZEROOUT IS SET TO A NONZERO VALUE, THEN      @Y30SSFR*/ 05944000
*        /*  THE AREA OF CORE STARTING AT MF1PTR AND         @Y30SSFR*/ 05945000
*        /*  EXTENDING A LENGTH OF MSIZE IS ZEROED OUT.      @Y30SSFR*/ 05946000
*        /*                                                  @Y30SSFR*/ 05947000
*        /************************************************************/ 05948000
*                                                                  1322 05949000
*MVDAPROC: PROCEDURE(MSIZE,            /*SIZE OF DATA TO BE MOVED    */ 05950000
*                    MF1PTR,           /*LOCATION TO MOVE FROM       */ 05951000
*                    MT1PTR,           /*LOCATION TO MOVE DATA INTO  */ 05952000
*                    ZEROOUT);         /*FLAG INDICATING THAT@Y30SSFR*/ 05953000
MVDAPROC STM   @14,@12,12(@13)                                     1322 05954000
         MVC   @PC00011(16),0(@01)                                 1322 05955000
*                                      /*THIS IS A REQUEST   @Y30SSFR*/ 05956000
*                                      /*ZERO OUT CORE       @Y30SSFR*/ 05957000
*                                                                  1323 05958000
*        /************************************************************/ 05959000
*        /*                                                  @Y30SSFR*/ 05960000
*        /*  ARGUMENTS OF INVOCATION                         @Y30SSFR*/ 05961000
*        /*                                                  @Y30SSFR*/ 05962000
*        /************************************************************/ 05963000
*                                                                  1323 05964000
*        DCL MSIZE    FIXED(15),                                   1323 05965000
*            MF1PTR   PTR(31),                                     1323 05966000
*            MT1PTR   PTR(31),                             /*@Y30SSFR*/ 05967000
*            ZEROOUT CHAR(4);                              /*@Y30SSFR*/ 05968000
*                                                                  1323 05969000
*        /************************************************************/ 05970000
*        /*                                                  @Y30SSFR*/ 05971000
*        /*  LOCAL DECLARATIONS                              @Y30SSFR*/ 05972000
*        /*                                                  @Y30SSFR*/ 05973000
*        /************************************************************/ 05974000
*                                                                  1324 05975000
*        DCL MFPTR PTR(31);                                /*@Y30SSFR*/ 05976000
*        DCL MTPTR PTR(31);                                /*@Y30SSFR*/ 05977000
*        DCL FROMAREA CHAR(*) BASED(MFPTR);                /*@Y30SSFR*/ 05978000
*        DCL TOAREA   CHAR(*) BASED(MTPTR);                /*@Y30SSFR*/ 05979000
*        DCL M1SIZE FIXED(15);                             /*@Y30SSFR*/ 05980000
*        DCL CNTRL  BIT(1);                                /*@Y30SSFR*/ 05981000
*        DCL ZERO CHAR(256) INIT('00'X);                   /*@Y30SSFR*/ 05982000
*                                      /*ZEROS USED TO ZERO  @Y30SSFR*/ 05983000
*                                      /*OUT AN AREA         @Y30SSFR*/ 05984000
*                                                                  1331 05985000
*        /************************************************************/ 05986000
*        /*                                                  @Y30SSFR*/ 05987000
*        /*  TEST TO SEE IF SETZERO HAS BEEN SPECIFIED AS    @Y30SSFR*/ 05988000
*        /*  LAST ARGUMENT.  IF SO, ZERO OUT THE TARGET      @Y30SSFR*/ 05989000
*        /*  AREA.                                           @Y30SSFR*/ 05990000
*        /*                                                  @Y30SSFR*/ 05991000
*        /************************************************************/ 05992000
*                                                                  1331 05993000
*        IF ZEROOUT = SETZERO                              /*@Y30SSFR*/ 05994000
*          THEN                                            /*@Y30SSFR*/ 05995000
         L     @15,@PC00011+12                                     1331 05996000
         CLC   ZEROOUT(4,@15),SETZERO                              1331 05997000
         BNE   @RF01331                                            1331 05998000
*            DO;                                           /*@Y30SSFR*/ 05999000
*                                                                  1332 06000000
*            /********************************************************/ 06001000
*            /*                                              @Y30SSFR*/ 06002000
*            /*  SET MTPTR TO MT1PTR AND M1SIZE TO MSIZE.    @Y30SSFR*/ 06003000
*            /*  SET CNTRL TO ON AND LOOP.                   @Y30SSFR*/ 06004000
*            /*                                              @Y30SSFR*/ 06005000
*            /********************************************************/ 06006000
*                                                                  1333 06007000
*            MTPTR = MT1PTR;                               /*@Y30SSFR*/ 06008000
         L     @15,@PC00011+8                                      1333 06009000
         L     MTPTR,MT1PTR(,@15)                                  1333 06010000
*            M1SIZE = MSIZE;                               /*@Y30SSFR*/ 06011000
         L     @15,@PC00011                                        1334 06012000
         LH    M1SIZE,MSIZE(,@15)                                  1334 06013000
*            CNTRL = ON;                                   /*@Y30SSFR*/ 06014000
         OI    CNTRL,B'10000000'                                   1335 06015000
*            DO WHILE (CNTRL = ON);                        /*@Y30SSFR*/ 06016000
*                                                                  1336 06017000
         B     @DE01336                                            1336 06018000
@DL01336 DS    0H                                                  1337 06019000
*              /******************************************************/ 06020000
*              /*                                            @Y30SSFR*/ 06021000
*              /*  TEST M1SIZE AGAINST 256.  IF M1SIZE > 256 @Y30SSFR*/ 06022000
*              /*  THEN MOVE 256 BYTES OF ZEROS, AND LOOP    @Y30SSFR*/ 06023000
*              /*  AGAIN.  OTHERWISE, ZERO THE REMAINING     @Y30SSFR*/ 06024000
*              /*  AND SET CNTRL TO OFF.                     @Y30SSFR*/ 06025000
*              /*                                            @Y30SSFR*/ 06026000
*              /******************************************************/ 06027000
*                                                                  1337 06028000
*              IF M1SIZE > 256                             /*@Y30SSFR*/ 06029000
*                THEN                                      /*@Y30SSFR*/ 06030000
         LA    @15,256                                             1337 06031000
         CR    M1SIZE,@15                                          1337 06032000
         BNH   @RF01337                                            1337 06033000
*                  DO;                                     /*@Y30SSFR*/ 06034000
*                  TOAREA(1:256) = ZERO(1:256);            /*@Y30SSFR*/ 06035000
         MVC   TOAREA(256,MTPTR),ZERO                              1339 06036000
*                  M1SIZE = M1SIZE - 256;                  /*@Y30SSFR*/ 06037000
         SLR   M1SIZE,@15                                          1340 06038000
*                  MTPTR = MTPTR + 256;                    /*@Y30SSFR*/ 06039000
         ALR   MTPTR,@15                                           1341 06040000
*                  END;                                    /*@Y30SSFR*/ 06041000
*                ELSE                                              1343 06042000
*                  DO;                                     /*@Y30SSFR*/ 06043000
         B     @RC01337                                            1343 06044000
@RF01337 DS    0H                                                  1344 06045000
*                  TOAREA(1:M1SIZE) = ZERO(1:M1SIZE);      /*@Y30SSFR*/ 06046000
         LR    @15,M1SIZE                                          1344 06047000
         BCTR  @15,0                                               1344 06048000
         EX    @15,@SM01375                                        1344 06049000
*                  CNTRL = OFF;                            /*@Y30SSFR*/ 06050000
         NI    CNTRL,B'01111111'                                   1345 06051000
*                  END;                                    /*@Y30SSFR*/ 06052000
*            END;                                          /*@Y30SSFR*/ 06053000
@RC01337 DS    0H                                                  1347 06054000
@DE01336 TM    CNTRL,B'10000000'                                   1347 06055000
         BO    @DL01336                                            1347 06056000
*            END;                                          /*@Y30SSFR*/ 06057000
*          ELSE                                                    1349 06058000
*                                                                  1349 06059000
*            /********************************************************/ 06060000
*            /*                                              @Y30SSFR*/ 06061000
*            /*  LOOP MOVING 256 BYTES AT A TIME             @Y30SSFR*/ 06062000
*            /*                                              @Y30SSFR*/ 06063000
*            /********************************************************/ 06064000
*            DO;                                           /*@Y30SSFR*/ 06065000
         B     @RC01331                                            1349 06066000
@RF01331 DS    0H                                                  1350 06067000
*            MFPTR = MF1PTR;                               /*@Y30SSFR*/ 06068000
         L     @15,@PC00011+4                                      1350 06069000
         L     MFPTR,MF1PTR(,@15)                                  1350 06070000
*            MTPTR = MT1PTR;                               /*@Y30SSFR*/ 06071000
         L     @05,@PC00011+8                                      1351 06072000
         L     MTPTR,MT1PTR(,@05)                                  1351 06073000
*            M1SIZE = MSIZE;                               /*@Y30SSFR*/ 06074000
         L     @05,@PC00011                                        1352 06075000
         LH    M1SIZE,MSIZE(,@05)                                  1352 06076000
*            DOCNTRL = ON;                                 /*@Y30SSFR*/ 06077000
         OI    DOCNTRL,B'10000000'                                 1353 06078000
*            DO WHILE (DOCNTRL = ON);                      /*@Y30SSFR*/ 06079000
*                                                                  1354 06080000
         B     @DE01354                                            1354 06081000
@DL01354 DS    0H                                                  1355 06082000
*              /******************************************************/ 06083000
*              /*                                            @Y30SSFR*/ 06084000
*              /*  CHECK FOR MORE THAN 256 BYTES TO MOVE     @Y30SSFR*/ 06085000
*              /*                                            @Y30SSFR*/ 06086000
*              /******************************************************/ 06087000
*                                                                  1355 06088000
*              IF M1SIZE > 256                             /*@Y30SSFR*/ 06089000
*                THEN                                      /*@Y30SSFR*/ 06090000
         LA    @05,256                                             1355 06091000
         CR    M1SIZE,@05                                          1355 06092000
         BNH   @RF01355                                            1355 06093000
*                  DO;                                     /*@Y30SSFR*/ 06094000
*                  /**************************************************/ 06095000
*                  /*                                        @Y30SSFR*/ 06096000
*                  /*  MOVE 256 BYTES AT A TIME AND UPDATE SIZE AND  */ 06097000
*                  /*  POINTER VARIABLES FOR NEXT ITERATION  @Y30SSFR*/ 06098000
*                  /*                                        @Y30SSFR*/ 06099000
*                  /**************************************************/ 06100000
*                                                                  1357 06101000
*                  TOAREA(1:256) = FROMAREA(1:256);        /*@Y30SSFR*/ 06102000
         MVC   TOAREA(256,MTPTR),FROMAREA(MFPTR)                   1357 06103000
*                  M1SIZE = M1SIZE - 256;                  /*@Y30SSFR*/ 06104000
         SLR   M1SIZE,@05                                          1358 06105000
*                  MTPTR = MTPTR +256;                     /*@Y30SSFR*/ 06106000
         ALR   MTPTR,@05                                           1359 06107000
*                  MFPTR = MFPTR + 256;                    /*@Y30SSFR*/ 06108000
         ALR   MFPTR,@05                                           1360 06109000
*                  END;                                    /*@Y30SSFR*/ 06110000
*                                                                  1361 06111000
*                ELSE                                      /*@Y30SSFR*/ 06112000
*                  DO;                                     /*@Y30SSFR*/ 06113000
         B     @RC01355                                            1362 06114000
@RF01355 DS    0H                                                  1363 06115000
*                  /**************************************************/ 06116000
*                  /*                                        @Y30SSFR*/ 06117000
*                  /*  MOVE NUMBER OF BYTES INDICATED        @Y30SSFR*/ 06118000
*                  /*                                        @Y30SSFR*/ 06119000
*                  /**************************************************/ 06120000
*                                                                  1363 06121000
*                  TOAREA(1:M1SIZE) = FROMAREA(1:M1SIZE);  /*@Y30SSFR*/ 06122000
         LR    @05,M1SIZE                                          1363 06123000
         BCTR  @05,0                                               1363 06124000
         EX    @05,@SM01377                                        1363 06125000
*                  DOCNTRL = OFF;                          /*@Y30SSFR*/ 06126000
         NI    DOCNTRL,B'01111111'                                 1364 06127000
*                  END;                                    /*@Y30SSFR*/ 06128000
*              END;                                        /*@Y30SSFR*/ 06129000
@RC01355 DS    0H                                                  1366 06130000
@DE01354 TM    DOCNTRL,B'10000000'                                 1366 06131000
         BO    @DL01354                                            1366 06132000
*            END;                                          /*@Y30SSFR*/ 06133000
*        /************************************************************/ 06134000
*        /*                                                  @Y30SSFR*/ 06135000
*        /*  RETURN TO CALLER, INDICATING SUCCESSFUL COMPLETION.     */ 06136000
*        /*                                                  @Y30SSFR*/ 06137000
*        /************************************************************/ 06138000
*                                                                  1368 06139000
*        RETURN CODE(0);                                   /*@Y30SSFR*/ 06140000
@RC01331 SLR   @15,@15                                             1368 06141000
         L     @14,12(,@13)                                        1368 06142000
         LM    @00,@12,20(@13)                                     1368 06143000
         BR    @14                                                 1368 06144000
*END MVDAPROC;                                             /*@Y30SSFR*/ 06145000
*        /************************************************************/ 06146000
*        /*                                                  @Y30SSFR*/ 06147000
*        /*  PROCEDURE NAME - CONTRBL                        @Y30SSFR*/ 06148000
*        /*                                                  @Y30SSFR*/ 06149000
*        /*  FUNCTION - BUILD A DICTIONARY CONTROL RECORD    @Y30SSFR*/ 06150000
*        /*  AND WRITE IT AND THE APPROPRIATE CATALOG        @Y30SSFR*/ 06151000
*        /*  WORK AREA OUT THE PORTABILITY DATA SET.         @Y30SSFR*/ 06152000
*        /*                                                  @Y30SSFR*/ 06153000
*        /*  INPUT - POINTER TO THE CPL USED TO LOCATE THE   @Y30SSFR*/ 06154000
*        /*  INFORMATION TO BE WRITTEN OUT AND A FLAG        @Y30SSFR*/ 06155000
*        /*  INDICATING WHETHER OR NOT THE OBJECT IS A PATH  @Y30SSFR*/ 06156000
*        /*                                                  @Y30SSFR*/ 06157000
*        /*  OUTPUT - THE PORTABILITY DATA SET WILL HAVE     @Y30SSFR*/ 06158000
*        /*  A CATALOG DICTIONARY AND A CATALOG WORK AREA    @Y30SSFR*/ 06159000
*        /*  ADDED TO ITS HEADING.                           @Y30SSFR*/ 06160000
*        /*                                                  @Y30SSFR*/ 06161000
*        /************************************************************/ 06162000
*                                                                  1370 06163000
*CONTRBL: PROCEDURE(INDCTGPL,TYPE);                        /*@Y30SSFR*/ 06164000
*                                                                  1370 06165000
CONTRBL  STM   @14,@05,@SA00012                                    1370 06166000
         STM   @07,@12,@SA00012+32                                 1370 06167000
         MVC   @PC00012(8),0(@01)                                  1370 06168000
*        /************************************************************/ 06169000
*        /*                                                  @Y30SSFR*/ 06170000
*        /*  ARGUMENTS OF INVOCATION                         @Y30SSFR*/ 06171000
*        /*                                                  @Y30SSFR*/ 06172000
*        /************************************************************/ 06173000
*                                                                  1371 06174000
*        DCL INDCTGPL FIXED(31); /*INDEX TO A CPL            @Y30SSFR*/ 06175000
*        DCL TYPE CHAR(1);    /*TYPE OF CONTROL RECORD       @Y30SSFR*/ 06176000
*                                                                  1372 06177000
*        DCL ICONTRBL FIXED(31);   /*INDEX FOR CLEARING      @Y30SSFR*/ 06178000
*                                  /*DICTIONARY AREAS        @Y30SSFR*/ 06179000
*        OLDERID2 = NEWERID2;                                      1374 06180000
         L     @07,@PC00001                                        1374 06181000
         L     @07,GDTTR2(,@07)                                    1374 06182000
         MVC   @TS00001(95),NEWERID2(@07)                          1374 06183000
         MVC   OLDERID2(95,@07),@TS00001                           1374 06184000
*        NEWID2 = 'XPCR';                                  /*@Y30SSFR*/ 06185000
*                                                                  1375 06186000
         MVC   NEWID2(4,@07),@CC01318                              1375 06187000
*        /************************************************************/ 06188000
*        /*                                                  @Y30SSFR*/ 06189000
*        /*  CLEAR THE CONTROL RECORD BUFFER AND INITIALIZE  @Y30SSFR*/ 06190000
*        /*  POINTERS.                                       @Y30SSFR*/ 06191000
*        /*                                                  @Y30SSFR*/ 06192000
*        /************************************************************/ 06193000
*                                                                  1376 06194000
*        CALL MVDAPROC(LENGTH(CONREC),NULLPARM,CONRCPTR,   /*@Y30SSFR*/ 06195000
*           SETZERO);                                      /*@Y30SSFR*/ 06196000
         MVC   @AL00001(16),@AL01376                               1376 06197000
         LA    @07,CONRCPTR                                        1376 06198000
         ST    @07,@AL00001+8                                      1376 06199000
         LA    @01,@AL00001                                        1376 06200000
         BAL   @14,MVDAPROC                                        1376 06201000
*        CTGPLPTR = PTRCPL(INDCTGPL);                      /*@Y30SSFR*/ 06202000
*                                                                  1377 06203000
         L     @07,@PC00012                                        1377 06204000
         L     @07,INDCTGPL(,@07)                                  1377 06205000
         SLA   @07,2                                               1377 06206000
         L     @07,PTRCPL-4(@07)                                   1377 06207000
         ST    @07,CTGPLPTR                                        1377 06208000
*        /***********************************************************/  06209000
*        /*                                                  @Y30SSFR*/ 06210000
*        /*  SET HEADER FLAGS IN CONTROL RECORD TO INDICATE  @Y30SSFR*/ 06211000
*        /*  A CATALOG RECORD AND ENTYPE                     @Y30SSFR*/ 06212000
*        /*  ALSO SET LENGTH OF ASSOCIATED CATALOG RECORD    @Y30SSFR*/ 06213000
*        /*  IF NO INFORMATION AVAILABLE ON THE ENTYPE - TERMINATE   */ 06214000
*        /*                                                  @Y30SSFR*/ 06215000
*        /************************************************************/ 06216000
*                                                                  1378 06217000
*        HEADLN = LENGTH(CONREC);                          /*@Y30SSFR*/ 06218000
         L     @03,CONRCPTR                                        1378 06219000
         MVC   HEADLN(2,@03),@CH00891                              1378 06220000
*        CTGFLPTR = CTGFIELD(IENTYPE);                     /*@Y30SSFR*/ 06221000
         L     CTGFLPTR,CTGFIELD(,@07)                             1379 06222000
*        HEADFLG1 = HDFL1CAT;                              /*@Y30SSFR*/ 06223000
         MVI   HEADFLG1(@03),X'FF'                                 1380 06224000
*        IF CTGFLPT(1) = NULLPTR                           /*@Y30SSFR*/ 06225000
*          THEN                                            /*@Y30SSFR*/ 06226000
         L     @07,CTGFLPT(,CTGFLPTR)                              1381 06227000
         LTR   @07,@07                                             1381 06228000
         BNZ   @RF01381                                            1381 06229000
*            DO;                                           /*@Y30SSFR*/ 06230000
*            DEFSTID = NOCTFLD;                            /*@Y30SSFR*/ 06231000
         LA    DEFSTID,4                                           1383 06232000
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/ 06233000
         LA    @15,12                                              1384 06234000
         L     @14,@SA00012                                        1384 06235000
         LM    @00,@05,@SA00012+8                                  1384 06236000
         LM    @07,@12,@SA00012+32                                 1384 06237000
         BR    @14                                                 1384 06238000
*            END;                                          /*@Y30SSFR*/ 06239000
*        HEADFLG2 = FENTYPE;                               /*@Y30SSFR*/ 06240000
*                                                                  1386 06241000
@RF01381 L     @07,CONRCPTR                                        1386 06242000
         L     @03,CTGFLPT(,CTGFLPTR)                              1386 06243000
         MVC   HEADFLG2(1,@07),FENTYPE(@03)                        1386 06244000
*        ASSRECLN = RETURNLN + LENGTH(PATHREL);            /*@Y30SSFR*/ 06245000
         L     @03,CTGPLPTR                                        1387 06246000
         L     @03,CTGWKA(,@03)                                    1387 06247000
         LA    @15,52                                              1387 06248000
         AH    @15,RETURNLN(,@03)                                  1387 06249000
         STH   @15,ASSRECLN(,@07)                                  1387 06250000
*        ASSRECNM = ASSRECLN / RECSZ;                      /*@Y30SSFR*/ 06251000
         L     @03,RECSZ                                           1388 06252000
         LR    @00,@15                                             1388 06253000
         SRDA  @00,32                                              1388 06254000
         DR    @00,@03                                             1388 06255000
         STH   @01,ASSRECNM(,@07)                                  1388 06256000
*        ASSREMD = ASSRECLN // RECSZ;                      /*@Y30SSFR*/ 06257000
         LR    @04,@15                                             1389 06258000
         SRDA  @04,32                                              1389 06259000
         DR    @04,@03                                             1389 06260000
         LR    ASSREMD,@04                                         1389 06261000
*        IF ASSREMD > 0                                    /*@Y30SSFR*/ 06262000
*          THEN                                            /*@Y30SSFR*/ 06263000
         LTR   ASSREMD,ASSREMD                                     1390 06264000
         BNP   @RF01390                                            1390 06265000
*            ASSRECNM = ASSRECNM + 1;                      /*@Y30SSFR*/ 06266000
         AL    @01,@CF00220                                        1391 06267000
         STH   @01,ASSRECNM(,@07)                                  1391 06268000
*        DICTNM = (DIM(FIELDLST) - 2) + 11;                /*@Y30SSFR*/ 06269000
*                                                                  1392 06270000
*                                                                  1392 06271000
@RF01390 L     @07,CONRCPTR                                        1392 06272000
         MVC   DICTNM+8(4,@07),@CF01346                            1392 06273000
*        /************************************************************/ 06274000
*        /*                                                  @Y30SSFR*/ 06275000
*        /*  INTERROGATE FPL FIELDS SETTING UP THE           @Y30SSFR*/ 06276000
*        /*  DICTIONARY FOR EACH COMPONENT.                  @Y30SSFR*/ 06277000
*        /*  RGATTR WILL BE THE LAST ENTRY PROCESSED BY THE  @Z40RSSA*/ 06278000
*        /*  DICTBLD PROCEDURE.                              @Z40RSSA*/ 06279000
*        /*                                                  @Z40RSSA*/ 06280000
*        /************************************************************/ 06281000
*                                                                  1393 06282000
*        DINDX = 1;                                        /*@Y30SSFR*/ 06283000
*                                                                  1393 06284000
         LA    DINDX,1                                             1393 06285000
*DICTBLD: DO INDX = 1 TO IRGATTR;                          /*@Z40RSSA*/ 06286000
DICTBLD  LA    INDX,1                                              1394 06287000
@DL01394 DS    0H                                                  1395 06288000
*          CTGFLPTR = CTGFIELD(INDX);                      /*@Y30SSFR*/ 06289000
         LR    @07,INDX                                            1395 06290000
         SLA   @07,2                                               1395 06291000
         L     @01,CTGPLPTR                                        1395 06292000
         L     CTGFLPTR,CTGFIELD-4(@07,@01)                        1395 06293000
*          LGNFLD  = CTGFLNG(1);                           /*@Y30SSFR*/ 06294000
*                                                                  1396 06295000
         L     @07,CTGFLNG(,CTGFLPTR)                              1396 06296000
         LR    LGNFLD,@07                                          1396 06297000
*          /**********************************************************/ 06298000
*          /*                                                @Y30SSFR*/ 06299000
*          /*  TEST FOR NON EXISTANT OR NON-INITIALIZED FIELDS       */ 06300000
*          /*                                                @Y30SSFR*/ 06301000
*          /**********************************************************/ 06302000
*                                                                  1397 06303000
*          /**********************************************************/ 06304000
*          /*                                                @Y30SSFR*/ 06305000
*          /*  TEST FOR PASSWORD SUPPRESSION. IF PASSWORDS ARE       */ 06306000
*          /*  BEING SUPPRESSED DUE TO INCORRECT LEVEL OF PASSWORD   */ 06307000
*          /*  SUPPLIED TO LOCATE, AN INFORMATIONAL MESSAGE WILL     */ 06308000
*          /*  BE ISSUED                                     @Y30SSFR*/ 06309000
*          /*                                                @Y30SSFR*/ 06310000
*          /**********************************************************/ 06311000
*                                                                  1397 06312000
*          IF INDX = IPASSWOR                              /*@Y30SSFR*/ 06313000
*            THEN                                          /*@Y30SSFR*/ 06314000
         C     INDX,@CF00037                                       1397 06315000
         BNE   @RF01397                                            1397 06316000
*              IF CTGFLNG(1) = 1 &                         /*@Y30SSFR*/ 06317000
*                  CTGFLPT(1) = NULLPTR                    /*@Y30SSFR*/ 06318000
*                THEN                                      /*@Y30SSFR*/ 06319000
         C     @07,@CF00220                                        1398 06320000
         BNE   @RF01398                                            1398 06321000
         L     @07,CTGFLPT(,CTGFLPTR)                              1398 06322000
         LTR   @07,@07                                             1398 06323000
         BNZ   @RF01398                                            1398 06324000
*                  SUPPRESS = ON;                          /*@Y30SSFR*/ 06325000
*                                                                  1399 06326000
         OI    SUPPRESS,B'10000000'                                1399 06327000
*          /**********************************************************/ 06328000
*          /*                                                @Y30SSFR*/ 06329000
*          /*  IF A VARIABLE LENGTH CATALOG FIELD SUCH AS LOKEYV     */ 06330000
*          /*  IS BEING INTERROGATED, THE FIRST TWO BYTES OF THE     */ 06331000
*          /*  THE FIELD IS A LENGTH                         @Y30SSFR*/ 06332000
*          /*  VARIABLE LENGTH CATALOG FIELDS ARE USERAREC,  @Y30SSFR*/ 06333000
*          /*  LOKEYV, AND HIKEYV                            @Y30SSFR*/ 06334000
*          /*                                                @Y30SSFR*/ 06335000
*          /**********************************************************/ 06336000
*                                                                  1400 06337000
*          IF (INDX = IUSRAREC |                           /*@Y30SSFR*/ 06338000
*              INDX = ILOKEYV |                            /*@Y30SSFR*/ 06339000
*              INDX = IHIKEYV)                             /*@Y30SSFR*/ 06340000
*            THEN                                          /*@Y30SSFR*/ 06341000
@RF01398 DS    0H                                                  1400 06342000
@RF01397 C     INDX,@CF00641                                       1400 06343000
         BE    @RT01400                                            1400 06344000
         C     INDX,@CF00229                                       1400 06345000
         BE    @RT01400                                            1400 06346000
         C     INDX,@CF00483                                       1400 06347000
         BNE   @RF01400                                            1400 06348000
@RT01400 DS    0H                                                  1401 06349000
*              IF LGNFLD = 0 | FIELDLN = 0                 /*@Y30SSFR*/ 06350000
*                THEN                                      /*@Y30SSFR*/ 06351000
         SLR   @07,@07                                             1401 06352000
         CR    LGNFLD,@07                                          1401 06353000
         BE    @RT01401                                            1401 06354000
         L     @01,CTGFLPT(,CTGFLPTR)                              1401 06355000
         CH    @07,FIELDLN(,@01)                                   1401 06356000
         BNE   @RF01401                                            1401 06357000
@RT01401 DS    0H                                                  1402 06358000
*                  DO;                                     /*@Y30SSFR*/ 06359000
*                                                                  1402 06360000
*                  /**************************************************/ 06361000
*                  /*                                        @Y30SSFR*/ 06362000
*                  /*  IF A VARIABLE LENGTH FIELD IS NOT     @Y30SSFR*/ 06363000
*                  /*  INITIALIZED OR NON-EXISTANT, THE LENGTH       */ 06364000
*                  /*  FIELD WITHIN THE DATA RETURNED BY LOCATE      */ 06365000
*                  /*  IS ZERO.  SET THE DICTIONARY LENGTH AND       */ 06366000
*                  /*  DISPLACEMENT TO ZERO.                 @Y30SSFR*/ 06367000
*                  /*                                        @Y30SSFR*/ 06368000
*                  /**************************************************/ 06369000
*                                                                  1403 06370000
*                  DICTLN(DINDX) = 0;                      /*@Y30SSFR*/ 06371000
         SLR   @07,@07                                             1403 06372000
         LR    @05,DINDX                                           1403 06373000
         SLA   @05,3                                               1403 06374000
         LA    @02,8                                               1403 06375000
         AL    @02,CONRCPTR                                        1403 06376000
         LA    @01,0(@05,@02)                                      1403 06377000
         AL    @01,@CF01379                                        1403 06378000
         ST    @07,DICTLN-4(,@01)                                  1403 06379000
*                  DICTDL(DINDX) = NULLPTR;                /*@Y30SSFR*/ 06380000
         ST    @07,DICTDL-8(@05,@02)                               1404 06381000
*                  END;                                    /*@Y30SSFR*/ 06382000
*                                                                  1405 06383000
*                ELSE                                      /*@Y30SSFR*/ 06384000
*                  DO;                                     /*@Y30SSFR*/ 06385000
         B     @RC01401                                            1406 06386000
@RF01401 DS    0H                                                  1407 06387000
*                  DICTLN(DINDX) = CTGFLNG(1);             /*@Y30SSFR*/ 06388000
         LR    @07,DINDX                                           1407 06389000
         SLA   @07,3                                               1407 06390000
         LA    @05,8                                               1407 06391000
         AL    @05,CONRCPTR                                        1407 06392000
         L     @15,CTGFLNG(,CTGFLPTR)                              1407 06393000
         LA    @14,0(@07,@05)                                      1407 06394000
         AL    @14,@CF01379                                        1407 06395000
         ST    @15,DICTLN-4(,@14)                                  1407 06396000
*                  DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;    /*@Y30SSFR*/ 06397000
         L     @15,CTGFLPT(,CTGFLPTR)                              1408 06398000
         L     @14,CTGPLPTR                                        1408 06399000
         SL    @15,CTGWKA(,@14)                                    1408 06400000
         ST    @15,DICTDL-8(@07,@05)                               1408 06401000
*                  END;                                    /*@Y30SSFR*/ 06402000
*                                                                  1409 06403000
*            /********************************************************/ 06404000
*            /*                                              @Y30SSFR*/ 06405000
*            /*  FIELDS EXAMINED HERE ARE FIXED LENGTH FIELDS.       */ 06406000
*            /*  IF THE FIELDS IS NON-EXISTANT OR NOT INITIALIZED    */ 06407000
*            /*  THE ENTIRE FIELD WILL HAVE BEEN SET TO BINARY FF'S  */ 06408000
*            /*  BY LOCATE.  SET DICTIONARY LENGTH AND DISPLACEMENT  */ 06409000
*            /*  TO ZERO FOR SUCH FIELDS                     @Y30SSFR*/ 06410000
*            /*                                              @Y30SSFR*/ 06411000
*            /********************************************************/ 06412000
*                                                                  1410 06413000
*            ELSE                                          /*@Y30SSFR*/ 06414000
*              DO;                                         /*@Y30SSFR*/ 06415000
         B     @RC01400                                            1410 06416000
@RF01400 DS    0H                                                  1411 06417000
*              IF (CTGFLNG(1) = 0 |                        /*@Y30SSFR*/ 06418000
*                  CTGFLPT(1) = NULLPTR |                  /*@Y30SSFR*/ 06419000
*                  FIELD(1:LGNFLD) = NOTINIT(1:LGNFLD))    /*@Y30SSFR*/ 06420000
*                THEN                                      /*@Y30SSFR*/ 06421000
         SLR   @07,@07                                             1411 06422000
         C     @07,CTGFLNG(,CTGFLPTR)                              1411 06423000
         BE    @RT01411                                            1411 06424000
         L     @15,CTGFLPT(,CTGFLPTR)                              1411 06425000
         CR    @15,@07                                             1411 06426000
         BE    @RT01411                                            1411 06427000
         LR    @07,LGNFLD                                          1411 06428000
         BCTR  @07,0                                               1411 06429000
         EX    @07,@SC01380                                        1411 06430000
         BNE   @RF01411                                            1411 06431000
@RT01411 DS    0H                                                  1412 06432000
*                  DO;                                     /*@Y30SSFR*/ 06433000
*                  DICTLN(DINDX) = 0;                      /*@Y30SSFR*/ 06434000
         SLR   @07,@07                                             1413 06435000
         LR    @05,DINDX                                           1413 06436000
         SLA   @05,3                                               1413 06437000
         LA    @02,8                                               1413 06438000
         AL    @02,CONRCPTR                                        1413 06439000
         LA    @01,0(@05,@02)                                      1413 06440000
         AL    @01,@CF01379                                        1413 06441000
         ST    @07,DICTLN-4(,@01)                                  1413 06442000
*                  DICTDL(DINDX) = NULLPTR;                /*@Y30SSFR*/ 06443000
         ST    @07,DICTDL-8(@05,@02)                               1414 06444000
*                  END;                                    /*@Y30SSFR*/ 06445000
*                ELSE                                      /*@Y30SSFR*/ 06446000
*                  DO;                                     /*@Y30SSFR*/ 06447000
         B     @RC01411                                            1416 06448000
@RF01411 DS    0H                                                  1417 06449000
*                  DICTLN(DINDX) = CTGFLNG(1);             /*@Y30SSFR*/ 06450000
         LR    @07,DINDX                                           1417 06451000
         SLA   @07,3                                               1417 06452000
         LA    @05,8                                               1417 06453000
         AL    @05,CONRCPTR                                        1417 06454000
         L     @15,CTGFLNG(,CTGFLPTR)                              1417 06455000
         LA    @14,0(@07,@05)                                      1417 06456000
         AL    @14,@CF01379                                        1417 06457000
         ST    @15,DICTLN-4(,@14)                                  1417 06458000
*                  DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;    /*@Y30SSFR*/ 06459000
*                                                                  1418 06460000
         L     @15,CTGFLPT(,CTGFLPTR)                              1418 06461000
         L     @14,CTGPLPTR                                        1418 06462000
         SL    @15,CTGWKA(,@14)                                    1418 06463000
         ST    @15,DICTDL-8(@07,@05)                               1418 06464000
*                  /**************************************************/ 06465000
*                  /*                                        @Y30SSFR*/ 06466000
*                  /*  IF THE TEMPORARY EXPORT FLAG IS ON, TURN      */ 06467000
*                  /*  IT OFF.                               @Y30SSFR*/ 06468000
*                  /*  IF THE INHIBIT UPDATE FLAG IS ON TURN @Y30SSFR*/ 06469000
*                  /*  IT OFF AS WELL.                       @Y30SSFR*/ 06470000
*                  /*                                        @Y30SSFR*/ 06471000
*                  /**************************************************/ 06472000
*                                                                  1419 06473000
*                  IF INDX = IDSATTR &                     /*@Y30SSFR*/ 06474000
*                      (INDCTGPL = 2 | INDCTGPL = 3)       /*@Y30SSFR*/ 06475000
*                    THEN                                  /*@Y30SSFR*/ 06476000
         LA    @07,3                                               1419 06477000
         CR    INDX,@07                                            1419 06478000
         BNE   @RF01419                                            1419 06479000
         L     @05,@PC00012                                        1419 06480000
         L     @05,INDCTGPL(,@05)                                  1419 06481000
         C     @05,@CF00154                                        1419 06482000
         BE    @RT01419                                            1419 06483000
         CR    @05,@07                                             1419 06484000
         BNE   @RF01419                                            1419 06485000
@RT01419 DS    0H                                                  1420 06486000
*                      DO;                                 /*@Y30SSFR*/ 06487000
*                      FDSINHUP = OFF;                     /*@Y30SSFR*/ 06488000
*                      FDSTMPEX = OFF;                     /*@Y30SSFR*/ 06489000
         L     @07,CTGFLPT(,CTGFLPTR)                              1422 06490000
         NI    FDSINHUP(@07),B'11111001'                           1422 06491000
*                      END;                                /*@Y30SSFR*/ 06492000
*                  END;                                    /*@Y30SSFR*/ 06493000
*                                                                  1424 06494000
@RF01419 DS    0H                                                  1425 06495000
*              /******************************************************/ 06496000
*              /*                                            @Y30SSFR*/ 06497000
*              /*  SPECIAL HANDLING IS REQUIRED FOR AMDSBCAT FIELD   */ 06498000
*              /*  FIELDS NORMALLY DEFINED (VIA CATALOG DEFINE) ARE  */ 06499000
*              /*  EXTRACTED AND A DICTIONARY ENTRY IS BUILT FOR     */ 06500000
*              /*  EACH FIELD.                               @Y30SSFR*/ 06501000
*              /*  IF NO INFORMATION IS RETURNED OR THE FIELDS ARE   */ 06502000
*              /*  INITIALIZED(SET TO ALL X'FF') THEN THE    @Y30SSFR*/ 06503000
*              /*  DICTIONARY ENTRIES ARE SET TO ZERO        @Y30SSFR*/ 06504000
*              /*                                            @Y30SSFR*/ 06505000
*              /******************************************************/ 06506000
*                                                                  1425 06507000
*              IF INDX = IAMDSB                            /*@Y30SSFR*/ 06508000
*                THEN                                      /*@Y30SSFR*/ 06509000
@RC01411 C     INDX,@CF00610                                       1425 06510000
         BNE   @RF01425                                            1425 06511000
*                  DO;                                     /*@Y30SSFR*/ 06512000
*                  CTGFLPTR = CTGFIELD(INDX);              /*@Y30SSFR*/ 06513000
         L     @07,CTGPLPTR                                        1427 06514000
         LR    @15,INDX                                            1427 06515000
         SLA   @15,2                                               1427 06516000
         L     CTGFLPTR,CTGFIELD-4(@15,@07)                        1427 06517000
*                  DSCCATPT = CTGFLPT(1);                  /*@Y30SSFR*/ 06518000
         L     @15,CTGFLPT(,CTGFLPTR)                              1428 06519000
         ST    @15,DSCCATPT                                        1428 06520000
*                  RESPECIFY IDAAMDSB BASED(DSCCATPT);     /*@Y30SSFR*/ 06521000
*                                                                  1429 06522000
*                  LGNFLD = CTGFLNG(1);                    /*@Y30SSFR*/ 06523000
         L     @14,CTGFLNG(,CTGFLPTR)                              1430 06524000
         LR    LGNFLD,@14                                          1430 06525000
*                  IF (CTGFLNG(1) ^= 0 & CTGFLPT(1) ^= NULLPTR  &  1431 06526000
*                      FIELD(1:LGNFLD) ^= NOTINIT(1:LGNFLD))       1431 06527000
*                    THEN                                  /*@Y30SSFR*/ 06528000
         SLR   @01,@01                                             1431 06529000
         CR    @14,@01                                             1431 06530000
         BE    @RF01431                                            1431 06531000
         CR    @15,@01                                             1431 06532000
         BE    @RF01431                                            1431 06533000
         LR    @14,LGNFLD                                          1431 06534000
         BCTR  @14,0                                               1431 06535000
         EX    @14,@SC01380                                        1431 06536000
         BE    @RF01431                                            1431 06537000
*                      DO;                                 /*@Y30SSFR*/ 06538000
*                      DICTLN(DINDX+1) = LENGTH(AMDATTR);  /*@Y30SSFR*/ 06539000
         LA    @05,1                                               1433 06540000
         LR    @02,DINDX                                           1433 06541000
         SLA   @02,3                                               1433 06542000
         LA    @14,8                                               1433 06543000
         L     @01,CONRCPTR                                        1433 06544000
         ALR   @01,@14                                             1433 06545000
         ST    @05,DICTLN(@02,@01)                                 1433 06546000
*                      DICTDL(DINDX+1) = ADDR(AMDATTR) - CTGWKA;   1434 06547000
         LA    @00,AMDATTR(,@15)                                   1434 06548000
         L     @07,CTGWKA(,@07)                                    1434 06549000
         SLR   @00,@07                                             1434 06550000
         ST    @00,DICTDL(@02,@01)                                 1434 06551000
*                      DICTLN(DINDX+2) = LENGTH(AMDRKP);   /*@Y30SSFR*/ 06552000
         LA    @00,2                                               1435 06553000
         ST    @00,DICTLN+8(@02,@01)                               1435 06554000
*                      DICTDL(DINDX+2) = ADDR(AMDRKP) - CTGWKA;    1436 06555000
         LA    @07,AMDRKP(,@15)                                    1436 06556000
         L     @05,CTGPLPTR                                        1436 06557000
         L     @05,CTGWKA(,@05)                                    1436 06558000
         SLR   @07,@05                                             1436 06559000
         ST    @07,DICTDL+8(@02,@01)                               1436 06560000
*                      DICTLN(DINDX+3) = LENGTH(AMDKEYLN); /*@Y30SSFR*/ 06561000
         ST    @00,DICTLN+16(@02,@01)                              1437 06562000
*                      DICTDL(DINDX+3) = ADDR(AMDKEYLN)-CTGWKA;    1438 06563000
         LA    @07,AMDKEYLN(,@15)                                  1438 06564000
         SLR   @07,@05                                             1438 06565000
         ST    @07,DICTDL+16(@02,@01)                              1438 06566000
*                      DICTLN(DINDX+4) = LENGTH(AMDCINV);  /*@Y30SSFR*/ 06567000
         LA    @07,4                                               1439 06568000
         ST    @07,DICTLN+24(@02,@01)                              1439 06569000
*                      DICTDL(DINDX+4) = ADDR(AMDCINV) - CTGWKA;   1440 06570000
         LA    @07,AMDCINV(,@15)                                   1440 06571000
         SLR   @07,@05                                             1440 06572000
         ST    @07,DICTDL+24(@02,@01)                              1440 06573000
*                      DICTLN(DINDX+5) = LENGTH(AMDLRECL); /*@Y30SSFR*/ 06574000
         LA    @07,4                                               1441 06575000
         ST    @07,DICTLN+32(@02,@01)                              1441 06576000
*                      DICTDL(DINDX+5) = ADDR(AMDLRECL) - CTGWKA;  1442 06577000
         LA    @07,AMDLRECL(,@15)                                  1442 06578000
         SLR   @07,@05                                             1442 06579000
         ST    @07,DICTDL+32(@02,@01)                              1442 06580000
*                      DICTLN(DINDX+6) = LENGTH(AMDPCTCA); /*@Y30SSFR*/ 06581000
         LA    @07,1                                               1443 06582000
         ST    @07,DICTLN+40(@02,@01)                              1443 06583000
*                      DICTDL(DINDX+6) = ADDR(AMDPCTCA) - CTGWKA;  1444 06584000
         LA    @07,AMDPCTCA(,@15)                                  1444 06585000
         SLR   @07,@05                                             1444 06586000
         ST    @07,DICTDL+40(@02,@01)                              1444 06587000
*                      DICTLN(DINDX+7) = LENGTH(AMDPCTCI); /*@Y30SSFR*/ 06588000
         LA    @07,1                                               1445 06589000
         ST    @07,DICTLN+48(@02,@01)                              1445 06590000
*                      DICTDL(DINDX+7) = ADDR(AMDPCTCI) - CTGWKA;  1446 06591000
         LA    @07,AMDPCTCI(,@15)                                  1446 06592000
         SLR   @07,@05                                             1446 06593000
         ST    @07,DICTDL+48(@02,@01)                              1446 06594000
*                      DICTLN(DINDX+8) = LENGTH(AMDATTR3); /*@Y30SSFR*/ 06595000
         ST    @14,DICTLN+56(@02,@01)                              1447 06596000
*                      DICTDL(DINDX+8) = ADDR(AMDATTR3)-CTGWKA;    1448 06597000
         LA    @07,AMDATTR3(,@15)                                  1448 06598000
         SLR   @07,@05                                             1448 06599000
         ST    @07,DICTDL+56(@02,@01)                              1448 06600000
*                      DICTLN(DINDX+9) = LENGTH(AMDAXRKP); /*@Y30SSFR*/ 06601000
         ST    @00,DICTLN+64(@02,@01)                              1449 06602000
*                      DICTDL(DINDX+9) = ADDR(AMDAXRKP)-CTGWKA;    1450 06603000
         LA    @07,AMDAXRKP(,@15)                                  1450 06604000
         SLR   @07,@05                                             1450 06605000
         ST    @07,DICTDL+64(@02,@01)                              1450 06606000
*                      END;                                /*@Y30SSFR*/ 06607000
*                    ELSE                                  /*@Y30SSFR*/ 06608000
*                      DO ICONTRBL = 1 TO 9;               /*@Y30SSFR*/ 06609000
         B     @RC01431                                            1452 06610000
@RF01431 LA    ICONTRBL,1                                          1452 06611000
@DL01452 DS    0H                                                  1453 06612000
*                        DICTLN(DINDX+ICONTRBL) = 0;       /*@Y30SSFR*/ 06613000
         SLR   @07,@07                                             1453 06614000
         LR    @05,DINDX                                           1453 06615000
         ALR   @05,ICONTRBL                                        1453 06616000
         SLA   @05,3                                               1453 06617000
         LA    @15,8                                               1453 06618000
         AL    @15,CONRCPTR                                        1453 06619000
         LA    @01,0(@05,@15)                                      1453 06620000
         AL    @01,@CF01379                                        1453 06621000
         ST    @07,DICTLN-4(,@01)                                  1453 06622000
*                        DICTDL(DINDX+ICONTRBL) = NULLPTR; /*@Y30SSFR*/ 06623000
         ST    @07,DICTDL-8(@05,@15)                               1454 06624000
*                      END;                                /*@Y30SSFR*/ 06625000
*                                                                  1455 06626000
         AL    ICONTRBL,@CF00220                                   1455 06627000
         C     ICONTRBL,@CF00038                                   1455 06628000
         BNH   @DL01452                                            1455 06629000
*                  DINDX = DINDX + 9;                      /*@Y30SSFR*/ 06630000
@RC01431 AL    DINDX,@CF00038                                      1456 06631000
*                  END;                                    /*@Y30SSFR*/ 06632000
*               END;                                       /*@Y30SSFR*/ 06633000
*                                                                  1458 06634000
@RF01425 DS    0H                                                  1459 06635000
*        /************************************************************/ 06636000
*        /*                                                  @Y30SSFR*/ 06637000
*        /*  INCREMENT INDEX INTO DICTIONARY                 @Y30SSFR*/ 06638000
*        /*                                                  @Y30SSFR*/ 06639000
*        /************************************************************/ 06640000
*                                                                  1459 06641000
*          DINDX = DINDX + 1;                              /*@Y30SSFR*/ 06642000
@RC01400 AL    DINDX,@CF00220                                      1459 06643000
*        END DICTBLD;                                      /*@Y30SSFR*/ 06644000
*                                                                  1460 06645000
*                                                                  1460 06646000
         AL    INDX,@CF00220                                       1460 06647000
         C     INDX,@CF00625                                       1460 06648000
         BNH   @DL01394                                            1460 06649000
*        /************************************************************/ 06650000
*        /*                                                  @Y30SSFR*/ 06651000
*        /*  IF EXPORTING AN AIX, WRITE OUT THE RELATED      @Y30SSFR*/ 06652000
*        /*  NAME.                                           @Y30SSFR*/ 06653000
*        /*                                                  @Y30SSFR*/ 06654000
*        /************************************************************/ 06655000
*                                                                  1461 06656000
*        IF TYPE = CTGTAIX                                 /*@Y30SSFR*/ 06657000
*          THEN                                            /*@Y30SSFR*/ 06658000
         L     @07,@PC00012+4                                      1461 06659000
         CLI   TYPE(@07),C'G'                                      1461 06660000
         BNE   @RF01461                                            1461 06661000
*            DO;                                           /*@Y30SSFR*/ 06662000
*            DICTLN(DINDX) = RELLEN;                       /*@Y30SSFR*/ 06663000
         LR    @07,DINDX                                           1463 06664000
         SLA   @07,3                                               1463 06665000
         LA    @02,8                                               1463 06666000
         AL    @02,CONRCPTR                                        1463 06667000
         LA    @15,44                                              1463 06668000
         LA    @14,0(@07,@02)                                      1463 06669000
         AL    @14,@CF01379                                        1463 06670000
         ST    @15,DICTLN-4(,@14)                                  1463 06671000
*            DICTDL(DINDX) = ADDR(RELATE) - CTGWKA;        /*@Y30SSFR*/ 06672000
         L     @01,CTGPLPTR                                        1464 06673000
         L     @15,CTGWKA(,@01)                                    1464 06674000
         LH    @14,RETURNLN(,@15)                                  1464 06675000
         ALR   @14,@15                                             1464 06676000
         LCR   @15,@15                                             1464 06677000
         ALR   @15,@14                                             1464 06678000
         ST    @15,DICTDL-8(@07,@02)                               1464 06679000
*            RELATE = RELNAME;                             /*@Y30SSFR*/ 06680000
         MVC   RELATE(44,@14),RELNAME                              1465 06681000
*            DICTLN(DINDX+1) = 0;                          /*@Y30SSFR*/ 06682000
         SLR   @15,@15                                             1466 06683000
         ST    @15,DICTLN(@07,@02)                                 1466 06684000
*            DICTDL(DINDX+1) = NULLPTR;                    /*@Y30SSFR*/ 06685000
         ST    @15,DICTDL(@07,@02)                                 1467 06686000
*            END;                                          /*@Y30SSFR*/ 06687000
*                                                                  1468 06688000
*          ELSE                                            /*@Y30SSFR*/ 06689000
*                                                                  1469 06690000
*          /**********************************************************/ 06691000
*          /*                                                @Y30SSFR*/ 06692000
*          /*  IF WRITING OUT A PATH RECORD, WRITE OUT THE   @Y30SSFR*/ 06693000
*          /*  NAME AND PASSWORD OF THE DATA SET BEING       @Y30SSFR*/ 06694000
*          /*  EXPORTED AS THE PATHENTRY AND PATHPASS        @Y30SSFR*/ 06695000
*          /*  ENTRIES IN THE DICTIONARY.                    @Y30SSFR*/ 06696000
*          /*                                                @Y30SSFR*/ 06697000
*          /**********************************************************/ 06698000
*                                                                  1469 06699000
*            IF TYPE = CTGTPTH                                     1469 06700000
*              THEN                                                1469 06701000
         B     @RC01461                                            1469 06702000
@RF01461 L     @07,@PC00012+4                                      1469 06703000
         CLI   TYPE(@07),C'R'                                      1469 06704000
         BNE   @RF01469                                            1469 06705000
*                DO;                                       /*@Y30SSFR*/ 06706000
*                DICTLN(DINDX) = LENGTH(PATHENT);          /*@Y30SSFR*/ 06707000
         LR    @07,DINDX                                           1471 06708000
         SLA   @07,3                                               1471 06709000
         LA    @02,8                                               1471 06710000
         L     @15,CONRCPTR                                        1471 06711000
         ALR   @15,@02                                             1471 06712000
         LA    @14,44                                              1471 06713000
         LA    @01,0(@07,@15)                                      1471 06714000
         AL    @01,@CF01379                                        1471 06715000
         ST    @14,DICTLN-4(,@01)                                  1471 06716000
*                DICTDL(DINDX) = ADDR(PATHENT) - CTGWKA;   /*@Y30SSFR*/ 06717000
         L     @01,CTGPLPTR                                        1472 06718000
         L     @14,CTGWKA(,@01)                                    1472 06719000
         LH    @05,RETURNLN(,@14)                                  1472 06720000
         ALR   @05,@14                                             1472 06721000
         LR    @04,@05                                             1472 06722000
         SLR   @04,@14                                             1472 06723000
         ST    @04,DICTDL-8(@07,@15)                               1472 06724000
*                PATHENT = PTRCPL(1) ->                    /*@Y30SSFR*/ 06725000
*                   CTGFIELD(IENTNAME) -> CTGFLPT(1)       /*@Y30SSFR*/ 06726000
*                   -> FENTNAME;                           /*@Y30SSFR*/ 06727000
         L     @04,PTRCPL                                          1473 06728000
         L     @01,CTGFIELD+4(,@04)                                1473 06729000
         L     @01,CTGFLPT(,@01)                                   1473 06730000
         MVC   PATHENT(44,@05),FENTNAME(@01)                       1473 06731000
*                IF (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLPT(1)     1474 06732000
*                  ^= NULLPTR) &                                   1474 06733000
*                  (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLNG(1)      1474 06734000
*                  ^= 0) &                                         1474 06735000
*                  (PTRCPL(1)->CTGFIELD(IPASSWOR)->CTGFLPT(1)      1474 06736000
*                  ->FPASSMWR) ^= NOTINIT(1:8)                     1474 06737000
*                  THEN                                            1474 06738000
         SLR   @01,@01                                             1474 06739000
         L     @04,CTGFIELD+36(,@04)                               1474 06740000
         L     @00,CTGFLPT(,@04)                                   1474 06741000
         CR    @00,@01                                             1474 06742000
         BE    @RF01474                                            1474 06743000
         C     @01,CTGFLNG(,@04)                                   1474 06744000
         BE    @RF01474                                            1474 06745000
         LR    @01,@00                                             1474 06746000
         CLC   FPASSMWR(8,@01),NOTINIT                             1474 06747000
         BE    @RF01474                                            1474 06748000
*                    DO;                                   /*@Y30SSFR*/ 06749000
*                    DICTLN(DINDX+1) = LENGTH(PATHPASS);   /*@Y30SSFR*/ 06750000
         ST    @02,DICTLN(@07,@15)                                 1476 06751000
*                    DICTDL(DINDX+1) = ADDR(PATHPASS)      /*@Y30SSFR*/ 06752000
*                       - CTGWKA;                          /*@Y30SSFR*/ 06753000
         LA    @02,PATHPASS(,@05)                                  1477 06754000
         SLR   @02,@14                                             1477 06755000
         ST    @02,DICTDL(@07,@15)                                 1477 06756000
*                    PATHPASS = PTRCPL(1) ->               /*@Y30SSFR*/ 06757000
*                       CTGFIELD(IPASSWOR) ->              /*@Y30SSFR*/ 06758000
*                       CTGFLPT(1) -> FPASSMWR;            /*@Y30SSFR*/ 06759000
         LR    @07,@00                                             1478 06760000
         MVC   PATHPASS(8,@05),FPASSMWR(@07)                       1478 06761000
*                    END;                                  /*@Y30SSFR*/ 06762000
*                END;                                      /*@Y30SSFR*/ 06763000
*                                                                  1480 06764000
*              ELSE                                                1481 06765000
*                                                                  1481 06766000
*              /******************************************************/ 06767000
*              /*                                            @Y30SSFR*/ 06768000
*              /*  THE COMPONENT IS NEITHER AIX NOR PATH     @Y30SSFR*/ 06769000
*              /*  ZERO OUT THE NEXT TWO FIELDS IN THE       @Z40RSSA*/ 06770000
*              /*  DICTIONARY.                               @Y30SSFR*/ 06771000
*              /*                                            @Y30SSFR*/ 06772000
*              /******************************************************/ 06773000
*                                                                  1481 06774000
*                DO;                                       /*@Y30SSFR*/ 06775000
         B     @RC01469                                            1481 06776000
@RF01469 DS    0H                                                  1482 06777000
*                DICTLN(DINDX) = 0;                        /*@Y30SSFR*/ 06778000
         SLR   @07,@07                                             1482 06779000
         LR    @02,DINDX                                           1482 06780000
         SLA   @02,3                                               1482 06781000
         LA    @15,8                                               1482 06782000
         AL    @15,CONRCPTR                                        1482 06783000
         LA    @01,0(@02,@15)                                      1482 06784000
         AL    @01,@CF01379                                        1482 06785000
         ST    @07,DICTLN-4(,@01)                                  1482 06786000
*                DICTDL(DINDX) = NULLPTR;                  /*@Y30SSFR*/ 06787000
         ST    @07,DICTDL-8(@02,@15)                               1483 06788000
*                DICTLN(DINDX+1) = 0;                      /*@Y30SSFR*/ 06789000
         ST    @07,DICTLN(@02,@15)                                 1484 06790000
*                DICTDL(DINDX+1) = NULLPTR;                /*@Y30SSFR*/ 06791000
         ST    @07,DICTDL(@02,@15)                                 1485 06792000
*                END;                                      /*@Y30SSFR*/ 06793000
*                                                                  1486 06794000
*        DINDX = DINDX + 2;                                /*@Y30SSFR*/ 06795000
*                                                                  1487 06796000
@RC01469 DS    0H                                                  1487 06797000
@RC01461 AL    DINDX,@CF00154                                      1487 06798000
*        /************************************************************/ 06799000
*        /*                                                  @Z40RSSA*/ 06800000
*        /*  INSERT THE REMAINING ENTRIES INTO THE DICTIONARY        */ 06801000
*        /*  THESE ENTRIES WERE MADE AFTER RELEASE 2 OF VSAM @Z40RSSA*/ 06802000
*        /*  NOTE, THAT THE DICTIONARY ENTIRES FOLLOW THE    @Z40RSSA*/ 06803000
*        /*  PASSREL ENTRY WHILE THE WORK AREAS POINTED TO   @Z40RSSA*/ 06804000
*        /*  BY THE DICT ENTRY PRECEDE THE RELATE OR PATHENTRY       */ 06805000
*        /*                                                  @Z40RSSA*/ 06806000
*        /************************************************************/ 06807000
*                                                                  1488 06808000
*MORBILD: DO INDX =  ISECFLGS TO ONUM;                     /*@Z40RSSA*/ 06809000
MORBILD  LA    INDX,21                                             1488 06810000
         B     @DE01488                                            1488 06811000
@DL01488 DS    0H                                                  1489 06812000
*           CTGFLPTR = CTGFIELD(INDX);                     /*@Z40RSSA*/ 06813000
         LR    @07,INDX                                            1489 06814000
         SLA   @07,2                                               1489 06815000
         L     @01,CTGPLPTR                                        1489 06816000
         L     CTGFLPTR,CTGFIELD-4(@07,@01)                        1489 06817000
*           LGNFLD = CTGFLNG(1);                           /*@Z40RSSA*/ 06818000
         L     @07,CTGFLNG(,CTGFLPTR)                              1490 06819000
         LR    LGNFLD,@07                                          1490 06820000
*           IF (CTGFLNG(1) = 0 |                           /*@Z40RSSA*/ 06821000
*               CTGFLPT(1) = NULLPTR |                     /*@Z40RSSA*/ 06822000
*               FIELD(1:LGNFLD) = NOTINIT(1:LGNFLD))       /*@Z40RSSA*/ 06823000
*           THEN                                           /*@Z40RSSA*/ 06824000
         SLR   @15,@15                                             1491 06825000
         CR    @07,@15                                             1491 06826000
         BE    @RT01491                                            1491 06827000
         L     @07,CTGFLPT(,CTGFLPTR)                              1491 06828000
         CR    @07,@15                                             1491 06829000
         BE    @RT01491                                            1491 06830000
         LR    @15,LGNFLD                                          1491 06831000
         BCTR  @15,0                                               1491 06832000
         EX    @15,@SC01382                                        1491 06833000
         BNE   @RF01491                                            1491 06834000
@RT01491 DS    0H                                                  1492 06835000
*             DO;                                          /*@Z40RSSA*/ 06836000
*             DICTLN(DINDX) = 0;                           /*@Z40RSSA*/ 06837000
         SLR   @07,@07                                             1493 06838000
         LR    @05,DINDX                                           1493 06839000
         SLA   @05,3                                               1493 06840000
         LA    @02,8                                               1493 06841000
         AL    @02,CONRCPTR                                        1493 06842000
         LA    @01,0(@05,@02)                                      1493 06843000
         AL    @01,@CF01379                                        1493 06844000
         ST    @07,DICTLN-4(,@01)                                  1493 06845000
*             DICTDL(DINDX) = NULLPTR;                     /*@Z40RSSA*/ 06846000
         ST    @07,DICTDL-8(@05,@02)                               1494 06847000
*             END;                                         /*@Z40RSSA*/ 06848000
*           ELSE                                           /*@Z40RSSA*/ 06849000
*             DO;                                          /*@Z40RSSA*/ 06850000
         B     @RC01491                                            1496 06851000
@RF01491 DS    0H                                                  1497 06852000
*             DICTLN(DINDX) = CTGFLNG(1);                  /*@Z40RSSA*/ 06853000
         LR    @07,DINDX                                           1497 06854000
         SLA   @07,3                                               1497 06855000
         LA    @05,8                                               1497 06856000
         AL    @05,CONRCPTR                                        1497 06857000
         L     @15,CTGFLNG(,CTGFLPTR)                              1497 06858000
         LA    @14,0(@07,@05)                                      1497 06859000
         AL    @14,@CF01379                                        1497 06860000
         ST    @15,DICTLN-4(,@14)                                  1497 06861000
*             DICTDL(DINDX) = CTGFLPT(1) - CTGWKA;         /*@Z40RSSA*/ 06862000
         L     @15,CTGFLPT(,CTGFLPTR)                              1498 06863000
         L     @14,CTGPLPTR                                        1498 06864000
         SL    @15,CTGWKA(,@14)                                    1498 06865000
         ST    @15,DICTDL-8(@07,@05)                               1498 06866000
*             DINDX = DINDX + 1;                           /*@Z40RSSA*/ 06867000
         AL    DINDX,@CF00220                                      1499 06868000
*             END;                                         /*@Z40RSSA*/ 06869000
*        END   MORBILD;                                    /*@Z40RSSA*/ 06870000
@RC01491 AL    INDX,@CF00220                                       1501 06871000
@DE01488 SLR   @07,@07                                             1501 06872000
         IC    @07,ONUM                                            1501 06873000
         CR    INDX,@07                                            1501 06874000
         BNH   @DL01488                                            1501 06875000
*        /************************************************************/ 06876000
*        /*                                                  #Y30SSFR*/ 06877000
*        /*  WRITE CONTROL RECORD OUT TO PORTABILITY DATA SET        */ 06878000
*        /*  THEN WRITE OUT THE WORK AREA AS A SEPARATE RECORD       */ 06879000
*        /*  IF AN ERROR IS ENCOUNTERED, CONTROL IS RETURNED TO THE  */ 06880000
*        /*  CALLING PROCESSOR                               #Y30SSFR*/ 06881000
*        /*                                                  #Y30SSFR*/ 06882000
*        /************************************************************/ 06883000
*                                                                  1502 06884000
*        OLDERID2 = NEWERID2;                                      1502 06885000
         L     @07,@PC00001                                        1502 06886000
         L     @07,GDTTR2(,@07)                                    1502 06887000
         MVC   @TS00001(95),NEWERID2(@07)                          1502 06888000
         MVC   OLDERID2(95,@07),@TS00001                           1502 06889000
*        NEWID2 = 'XPCW';                                  /*#Y30SSFR*/ 06890000
         MVC   NEWID2(4,@07),@CC01324                              1503 06891000
*        TOTLEN = HEADLN;                                  /*#Y30SSFR*/ 06892000
*                                                                  1504 06893000
*                                                                  1504 06894000
*                                                                  1504 06895000
         L     @07,CONRCPTR                                        1504 06896000
         LH    @07,HEADLN(,@07)                                    1504 06897000
         ST    @07,TOTLEN                                          1504 06898000
*        CALL PUTPROC(TOTLEN,CONRCPTR);                    /*@Y30SSFR*/ 06899000
*                                                                  1505 06900000
         LA    @07,TOTLEN                                          1505 06901000
         ST    @07,@AL00001                                        1505 06902000
         LA    @07,CONRCPTR                                        1505 06903000
         ST    @07,@AL00001+4                                      1505 06904000
         LA    @01,@AL00001                                        1505 06905000
         BAL   @14,PUTPROC                                         1505 06906000
*        RESPECIFY RTNREG RSTD;                                    1506 06907000
*        TESTRC = RTNREG;                                          1507 06908000
         LR    TESTRC,RTNREG                                       1507 06909000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSFR*/ 06910000
*        IF TESTRC ^= 0                                    /*@Y30SSFR*/ 06911000
*          THEN                                            /*@Y30SSFR*/ 06912000
         LTR   TESTRC,TESTRC                                       1509 06913000
         BZ    @RF01509                                            1509 06914000
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/ 06915000
*                                                                  1510 06916000
         LA    @15,12                                              1510 06917000
         L     @14,@SA00012                                        1510 06918000
         LM    @00,@05,@SA00012+8                                  1510 06919000
         LM    @07,@12,@SA00012+32                                 1510 06920000
         BR    @14                                                 1510 06921000
*        TOTLEN = RETURNLN + LENGTH(PATHREL);              /*@Y30SSFR*/ 06922000
@RF01509 L     @07,CTGPLPTR                                        1511 06923000
         L     @01,CTGWKA(,@07)                                    1511 06924000
         LA    @00,52                                              1511 06925000
         AH    @00,RETURNLN(,@01)                                  1511 06926000
         ST    @00,TOTLEN                                          1511 06927000
*        CALL PUTPROC(TOTLEN,CTGWKA);                      /*@Y30SSFR*/ 06928000
*                                                                  1512 06929000
         LA    @15,TOTLEN                                          1512 06930000
         ST    @15,@AL00001                                        1512 06931000
         LA    @07,CTGWKA(,@07)                                    1512 06932000
         ST    @07,@AL00001+4                                      1512 06933000
         LA    @01,@AL00001                                        1512 06934000
         BAL   @14,PUTPROC                                         1512 06935000
*        RESPECIFY RTNREG RSTD;                                    1513 06936000
*        TESTRC = RTNREG;                                          1514 06937000
         LR    TESTRC,RTNREG                                       1514 06938000
*        RESPECIFY RTNREG UNRSTD;                          /*@Y30SSFR*/ 06939000
*        IF TESTRC ^= 0                                    /*@Y30SSFR*/ 06940000
*          THEN                                            /*@Y30SSFR*/ 06941000
         LTR   TESTRC,TESTRC                                       1516 06942000
         BZ    @RF01516                                            1516 06943000
*            RETURN CODE(LASTCC12);                        /*@Y30SSFR*/ 06944000
*                                                                  1517 06945000
         LA    @15,12                                              1517 06946000
         L     @14,@SA00012                                        1517 06947000
         LM    @00,@05,@SA00012+8                                  1517 06948000
         LM    @07,@12,@SA00012+32                                 1517 06949000
         BR    @14                                                 1517 06950000
*        /************************************************************/ 06951000
*        /*                                                  @Y30SSFR*/ 06952000
*        /*  RETURN TO THE CALLING PROCESSOR INDICATING      @Y30SSFR*/ 06953000
*        /*  SUCCESS.                                        @Y30SSFR*/ 06954000
*        /*                                                  @Y30SSFR*/ 06955000
*        /************************************************************/ 06956000
*                                                                  1518 06957000
*        RETURN CODE(LASTCC00);                            /*@Y30SSFR*/ 06958000
*                                                                  1518 06959000
@RF01516 SLR   @15,@15                                             1518 06960000
         L     @14,@SA00012                                        1518 06961000
         LM    @00,@05,@SA00012+8                                  1518 06962000
         LM    @07,@12,@SA00012+32                                 1518 06963000
         BR    @14                                                 1518 06964000
*END CONTRBL;                                              /*@Y30SSFR*/ 06965000
*        /************************************************************/ 06966000
*        /*                                                  @Y30SSFR*/ 06967000
*        /*  PROCEDURE NAME - MORESP                         @Y30SSFR*/ 06968000
*        /*                                                  @Y30SSFR*/ 06969000
*        /*  FUNCTION - HANDLE THE SITUATION IN WHICH VSAM   @Y30SSFR*/ 06970000
*        /*  MANAGEMENT HAS USED ALL OF ITS WORK AREA        @Y30SSFR*/ 06971000
*        /*  BY PRINTING THE NAMES OF THE                    @Y30SSFR*/ 06972000
*        /*  ITEMS ALREADY DELETED.  THEN EITHER THE         @Y30SSFR*/ 06973000
*        /*  WORK AREA IS CLEARED OR A NEW WORK AREA IS      @Y30SSFR*/ 06974000
*        /*  OBTAINED.  VSAM CATALOG IS THEN INVOKED         @Y30SSFR*/ 06975000
*        /*  AGAIN BY DELTPROC.                              @Y30SSFR*/ 06976000
*        /*                                                  @Y30SSFR*/ 06977000
*        /*  INPUT - A CPL BUILT BY CPLPROC, THE             @Y30SSFR*/ 06978000
*        /*  WORK AREA USED BY VSAM CATALOG,                 @Y30SSFR*/ 06979000
*        /*  AND THE NUMBER OF ENTRIES FOUND IN THE WORK     @Y30SSFR*/ 06980000
*        /*  AREA BY CATCALL.                                @Y30SSFR*/ 06981000
*        /*                                                  @Y30SSFR*/ 06982000
*        /*  OUTPUT - EITHER THE SAME CATALOG WORKAREA       @Y30SSFR*/ 06983000
*        /*  CLEARED OF THE NAMES PLACED THERE BY THE        @Y30SSFR*/ 06984000
*        /*  PREVIOUS CALL TO CATALOG OR A NEW WORKAREA      @Y30SSFR*/ 06985000
*        /*  POINTED TO BY AN UPDATED CTGWKA POINTER.        @Y30SSFR*/ 06986000
*        /*                                                  @Y30SSFR*/ 06987000
*        /************************************************************/ 06988000
*                                                                  1520 06989000
*MORESP:  PROCEDURE(MMNOENT);                              /*@Y30SSFR*/ 06990000
*                                                                  1520 06991000
MORESP   STM   @14,@12,@SA00013                                    1520 06992000
         MVC   @PC00013(4),0(@01)                                  1520 06993000
*        /************************************************************/ 06994000
*        /*                                                  @Y30SSFR*/ 06995000
*        /*  ARGUMENT OF INVOCATION                          @Y30SSFR*/ 06996000
*        /*                                                  @Y30SSFR*/ 06997000
*        /************************************************************/ 06998000
*                                                                  1521 06999000
*        DCL MMNOENT FIXED(31);        /*NUMBER OF VALID     @Y30SSFR*/ 07000000
*                                      /*ENTRIES FOUND IN    @Y30SSFR*/ 07001000
*                                      /*THE WORK AREA BY    @Y30SSFR*/ 07002000
*                                      /*CATCALL             @Y30SSFR*/ 07003000
*                                                                  1522 07004000
*        /************************************************************/ 07005000
*        /*                                                  @Y30SSFR*/ 07006000
*        /*  LOCAL DECLARATIONS FOR MORESP                   @Y30SSFR*/ 07007000
*        /*                                                  @Y30SSFR*/ 07008000
*        /************************************************************/ 07009000
*                                                                  1522 07010000
*        DCL J FIXED(31);              /*LOOP CONTROL        @Y30SSFR*/ 07011000
*                                      /*FOR CLEARING        @Y30SSFR*/ 07012000
*                                      /*CATALOG WORK AREA   @Y30SSFR*/ 07013000
*        DCL SIZENEED FIXED(31);       /*SIZE OF WORKAREA    @Y30SSFR*/ 07014000
*                                      /*NEEDED              @Y30SSFR*/ 07015000
*        DCL CURSIZE FIXED(15);        /*SIZE OF CURRENT     @Y30SSFR*/ 07016000
*                                      /*WORK AREA           @Y30SSFR*/ 07017000
*        DCL COREFLAG BIT(1);          /*FLAG TO INDICATE IF @Y30SSFR*/ 07018000
*                                      /*CORE HAS BEEN       @Y30SSFR*/ 07019000
*                                      /*GOTTEN FOR A CMS    @Y30SSFR*/ 07020000
*                                      /*WORKAREA            @Y30SSFR*/ 07021000
*        OLDERID2 = NEWERID2;                                      1526 07022000
         L     @03,@PC00001                                        1526 07023000
         L     @15,GDTTR2(,@03)                                    1526 07024000
         MVC   @TS00001(95),NEWERID2(@15)                          1526 07025000
         MVC   OLDERID2(95,@15),@TS00001                           1526 07026000
*        NEWID2 = 'DLMS';                                  /*@Y30SSFR*/ 07027000
*                                                                  1527 07028000
         MVC   NEWID2(4,@15),@CC01334                              1527 07029000
*        /************************************************************/ 07030000
*        /*                                                  @Y30SSFR*/ 07031000
*        /*  INTIALIZATIONS FOR THE PROCEDURE                @Y30SSFR*/ 07032000
*        /*                                                  @Y30SSFR*/ 07033000
*        /************************************************************/ 07034000
*                                                                  1528 07035000
*        CURSIZE = AREALN;                                 /*@Y30SSFR*/ 07036000
         L     @15,CTGPLPTR                                        1528 07037000
         L     @01,CTGWKA(,@15)                                    1528 07038000
         LH    CURSIZE,AREALN(,@01)                                1528 07039000
*        COREFLAG = OFF;                                   /*@Y30SSFR*/ 07040000
*                                                                  1529 07041000
         NI    COREFLAG,B'01111111'                                1529 07042000
*        /************************************************************/ 07043000
*        /*                                                  @Y30SSFR*/ 07044000
*        /*  RESTORE THE CPL.    SET CTGERASE TO OFF AND     @Y30SSFR*/ 07045000
*        /*  CTGOVRID TO ON TO PREVENT CMS FROM REERASING    @Y30SSFR*/ 07046000
*        /*  THE OBJECT ON SUBSEQUENT CALLS TO CATALOG.      @Y30SSFR*/ 07047000
*        /*                                                  @Y30SSFR*/ 07048000
*        /************************************************************/ 07049000
*                                                                  1530 07050000
*        CTGPL = DSAVCPL;                                  /*@Y30SSFR*/ 07051000
         MVC   CTGPL(28,@15),DSAVCPL                               1530 07052000
*        CTGERASE = OFF;                                   /*@Y30SSFR*/ 07053000
*        CTGOVRID = ON;                                    /*@Y30SSFR*/ 07054000
*                                                                  1532 07055000
         OI    CTGOVRID(@15),B'00000100'                           1532 07056000
         NI    CTGERASE(@15),B'10111111'                           1532 07057000
*        /************************************************************/ 07058000
*        /*                                                  @Y30SSFR*/ 07059000
*        /*  COMPUTE THE SIZE NEEDED AND COMPARE THAT        @Y30SSFR*/ 07060000
*        /*  TO THE CURRENT SIZE OF THE WORK AREA            @Y30SSFR*/ 07061000
*        /*                                                  @Y30SSFR*/ 07062000
*        /************************************************************/ 07063000
*                                                                  1533 07064000
*        SIZENEED = RETURNLN - (LENGTH(ENTITEM)            /*@Y30SSFR*/ 07065000
*                        * MMNOENT);                       /*@Y30SSFR*/ 07066000
*                                                                  1533 07067000
         L     @01,CTGWKA(,@15)                                    1533 07068000
         L     @14,@PC00013                                        1533 07069000
         L     @00,MMNOENT(,@14)                                   1533 07070000
         MH    @00,@CH00912                                        1533 07071000
         LCR   @00,@00                                             1533 07072000
         AH    @00,RETURNLN(,@01)                                  1533 07073000
         ST    @00,SIZENEED                                        1533 07074000
*        IF SIZENEED > CURSIZE                             /*@Y30SSFR*/ 07075000
*          THEN                                            /*@Y30SSFR*/ 07076000
*                                                                  1534 07077000
         CR    @00,CURSIZE                                         1534 07078000
         BNH   @RF01534                                            1534 07079000
*            /********************************************************/ 07080000
*            /*                                              @Y30SSFR*/ 07081000
*            /*  IF THE CURRENT WORK AREA IS GOTTEN          @Y30SSFR*/ 07082000
*            /*  CORE, FREE IT.  THEN GET A WORK AREA OF     @Y30SSFR*/ 07083000
*            /*  APPROPRIATE SIZE AND CHANGE THE CPL TO      @Y30SSFR*/ 07084000
*            /*  POINT TO IT.                                @Y30SSFR*/ 07085000
*            /*                                              @Y30SSFR*/ 07086000
*            /********************************************************/ 07087000
*                                                                  1535 07088000
*            DO;                                           /*@Y30SSFR*/ 07089000
*            IF COREFLAG = ON                              /*@Y30SSFR*/ 07090000
*              THEN                                        /*@Y30SSFR*/ 07091000
         TM    COREFLAG,B'10000000'                                1536 07092000
         BNO   @RF01536                                            1536 07093000
*                CALL IDCSAFS0(GDTTBL,CTGWKA);             /*@Y30SSFR*/ 07094000
         ST    @03,@AL00001                                        1537 07095000
         LA    @02,CTGWKA(,@15)                                    1537 07096000
         ST    @02,@AL00001+4                                      1537 07097000
         L     @15,GDTFSP(,@03)                                    1537 07098000
         LA    @01,@AL00001                                        1537 07099000
         BALR  @14,@15                                             1537 07100000
*            COREFLAG = ON;                                /*@Y30SSFR*/ 07101000
*                                                                  1538 07102000
@RF01536 OI    COREFLAG,B'10000000'                                1538 07103000
*            CALL IDCSAGP0(GDTTBL,SIZENEED,                /*@Y30SSFR*/ 07104000
*                    CTGWKA,GPID,SETZERO);                 /*@Y30SSFR*/ 07105000
*                                                                  1539 07106000
         L     @03,@PC00001                                        1539 07107000
         ST    @03,@AL00001                                        1539 07108000
         LA    @15,SIZENEED                                        1539 07109000
         ST    @15,@AL00001+4                                      1539 07110000
         L     @01,CTGPLPTR                                        1539 07111000
         LA    @15,CTGWKA(,@01)                                    1539 07112000
         ST    @15,@AL00001+8                                      1539 07113000
         LA    @15,GPID                                            1539 07114000
         ST    @15,@AL00001+12                                     1539 07115000
         LA    @15,SETZERO                                         1539 07116000
         ST    @15,@AL00001+16                                     1539 07117000
         MVI   @AL00001+16,X'80'                                   1539 07118000
         L     @15,GDTGPL(,@03)                                    1539 07119000
         LA    @01,@AL00001                                        1539 07120000
         BALR  @14,@15                                             1539 07121000
*            RESPECIFY RTNREG RSTD;                                1540 07122000
*            TESTRC = RTNREG;                                      1541 07123000
         LR    TESTRC,RTNREG                                       1541 07124000
*            RESPECIFY RTNREG UNRSTD;                      /*@Y30SSFR*/ 07125000
*                                                                  1542 07126000
*            IF TESTRC ^= 0                                /*@Y30SSFR*/ 07127000
*              THEN                                        /*@Y30SSFR*/ 07128000
         SLR   @03,@03                                             1543 07129000
         CR    TESTRC,@03                                          1543 07130000
         BE    @RF01543                                            1543 07131000
*                DO;                                       /*@Y30SSFR*/ 07132000
*                DARGSMOD = UNIVMSG;                       /*@Y30SSFR*/ 07133000
         L     @02,DDSTRU                                          1545 07134000
         MVC   DARGSMOD(3,@02),@CC00930                            1545 07135000
*                DARGSENT = NOSTORAG;                      /*@Y30SSFR*/ 07136000
         MVI   DARGSENT(@02),X'04'                                 1546 07137000
*                DARGDBP = NULLPTR;                        /*@Y30SSFR*/ 07138000
         ST    @03,DARGDBP(,@02)                                   1547 07139000
*                DARGILP = 0;                              /*@Y30SSFR*/ 07140000
*                                                                  1548 07141000
         STH   @03,DARGILP(,@02)                                   1548 07142000
*                CALL AMSTP011(GDTTBL,PRTFILE,DDSTRU);     /*@Y30SSFR*/ 07143000
*                                                                  1549 07144000
         L     @15,@PC00001                                        1549 07145000
         ST    @15,@AL00001                                        1549 07146000
         LA    @14,@CF00116                                        1549 07147000
         ST    @14,@AL00001+4                                      1549 07148000
         LA    @14,DDSTRU                                          1549 07149000
         ST    @14,@AL00001+8                                      1549 07150000
         MVI   @AL00001+8,X'80'                                    1549 07151000
         L     @15,GDTPRT(,@15)                                    1549 07152000
         LA    @01,@AL00001                                        1549 07153000
         BALR  @14,@15                                             1549 07154000
*                SETRC = LASTCC08;                         /*@Y30SSFR*/ 07155000
         LA    @15,8                                               1550 07156000
         STH   @15,SETRC                                           1550 07157000
*                RETURN CODE(SETRC);                       /*@Y30SSFR*/ 07158000
         L     @14,@SA00013                                        1551 07159000
         LM    @00,@12,@SA00013+8                                  1551 07160000
         BR    @14                                                 1551 07161000
*                END;                                      /*@Y30SSFR*/ 07162000
*                                                                  1552 07163000
*            CURSIZE = SIZENEED;                           /*@Y30SSFR*/ 07164000
@RF01543 L     CURSIZE,SIZENEED                                    1553 07165000
*            AREALN = CURSIZE;                             /*@Y30SSFR*/ 07166000
*                                                                  1554 07167000
         L     @03,CTGPLPTR                                        1554 07168000
         L     @03,CTGWKA(,@03)                                    1554 07169000
         STH   CURSIZE,AREALN(,@03)                                1554 07170000
*            END;                                          /*@Y30SSFR*/ 07171000
*                                                                  1555 07172000
*          ELSE                                                    1556 07173000
*                                                                  1556 07174000
*            /********************************************************/ 07175000
*            /*                                              @Y30SSFR*/ 07176000
*            /*  IF CURRENT WORK AREA IS LARGE ENOUGH        @Y30SSFR*/ 07177000
*            /*  FOR THE NEXT CALL TO CATALOG, CLEAR IT.     @Y30SSFR*/ 07178000
*            /*                                              @Y30SSFR*/ 07179000
*            /********************************************************/ 07180000
*                                                                  1556 07181000
*              DO;                                         /*@Y30SSFR*/ 07182000
         B     @RC01534                                            1556 07183000
@RF01534 DS    0H                                                  1557 07184000
*              RETURNLN = 0;                               /*@Y30SSFR*/ 07185000
*                                                                  1557 07186000
         L     @01,CTGPLPTR                                        1557 07187000
         L     @01,CTGWKA(,@01)                                    1557 07188000
         SLR   @00,@00                                             1557 07189000
         STH   @00,RETURNLN(,@01)                                  1557 07190000
*              DO J = 1 TO LIMIT;                          /*@Y30SSFR*/ 07191000
         LA    J,1                                                 1558 07192000
         B     @DE01558                                            1558 07193000
@DL01558 DS    0H                                                  1559 07194000
*                ENTLIST(J) = ''B;                         /*@Y30SSFR*/ 07195000
         LR    @03,J                                               1559 07196000
         MH    @03,@CH00912                                        1559 07197000
         L     @01,CTGPLPTR                                        1559 07198000
         L     @01,CTGWKA(,@01)                                    1559 07199000
         ALR   @01,@03                                             1559 07200000
         AL    @01,@CF01373                                        1559 07201000
         XC    ENTLIST-4(45,@01),ENTLIST-4(@01)                    1559 07202000
*              END;                                        /*@Y30SSFR*/ 07203000
*                                                                  1560 07204000
         AL    J,@CF00220                                          1560 07205000
@DE01558 C     J,LIMIT                                             1560 07206000
         BNH   @DL01558                                            1560 07207000
*              END;                                        /*@Y30SSFR*/ 07208000
*                                                                  1561 07209000
*        RETURN CODE(SETRC);                               /*@Y30SSFR*/ 07210000
@RC01534 LH    @15,SETRC                                           1562 07211000
         L     @14,@SA00013                                        1562 07212000
         LM    @00,@12,@SA00013+8                                  1562 07213000
         BR    @14                                                 1562 07214000
*END MORESP;                                               /*@Y30SSFR*/ 07215000
*END IDCXP01                                                       1564 07216000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 07217000
*/*%INCLUDE SYSLIB  (AMSDF01 )                                        * 07218000
*/*%INCLUDE SYSLIB  (AMSDF00 )                                        * 07219000
*/*@INCLUDE SYSLIB  (AMSDF02 )                                        * 07220000
*/*%INCLUDE SYSLIB  (IDCCSXP )                                        * 07221000
*/*%INCLUDE SYSLIB  (IEZCTGPL)                                        * 07222000
*/*%INCLUDE SYSLIB  (IEZCTGFL)                                        * 07223000
*/*%INCLUDE SYSLIB  (IEZCTGFV)                                        * 07224000
*/*%INCLUDE SYSLIB  (IDAAMDSB)                                        * 07225000
*;                                                                 1564 07226000
@DATA    DS    0H                                                       07227000
@CH00311 DC    H'24'                                                    07228000
@CH00604 DC    H'44'                                                    07229000
@CH01116 DC    H'110'                                                   07230000
@CH01341 DC    H'588'                                                   07231000
@CH00894 DC    H'1000'                                                  07232000
@SM01375 MVC   TOAREA(0,MTPTR),ZERO                                     07233000
@SM01377 MVC   TOAREA(0,MTPTR),FROMAREA(MFPTR)                          07234000
@SC01380 CLC   FIELD(0,@15),NOTINIT                                     07235000
@SC01382 CLC   FIELD(0,@07),NOTINIT                                     07236000
         DS    0F                                                       07237000
@AL00417 DC    A(NULLPARM)             LIST WITH   4 ARGUMENT(S)        07238000
         DC    A(NULLPARM)                                              07239000
         DC    A(FIELDLST)                                              07240000
         DC    A(CNUM)                                                  07241000
@AL00557 DC    A(@CF00891)             LIST WITH   4 ARGUMENT(S)        07242000
         DS    F                                                        07243000
         DC    A(GPID)                                                  07244000
         DC    AL1(X'80')                                               07245000
         DC    AL3(SETZERO)                                             07246000
@AL00635 EQU   *                       LIST WITH   2 ARGUMENT(S)        07247000
@AL00659 DC    A(@CF00287)             LIST WITH   2 ARGUMENT(S)        07248000
         DC    A(@CC00740)                                              07249000
@AL00645 DC    A(@CF01342)             LIST WITH   4 ARGUMENT(S)        07250000
         DC    A(NULLPARM)                                              07251000
         DS    F                                                        07252000
         DC    A(SETZERO)                                               07253000
@AL00780 DC    A(@CF01342)             LIST WITH   4 ARGUMENT(S)        07254000
         DS    F                                                        07255000
         DC    A(GPID)                                                  07256000
         DC    AL1(X'80')                                               07257000
         DC    AL3(SETZERO)                                             07258000
@AL00990 DC    A(@CF01340)             LIST WITH   4 ARGUMENT(S)        07259000
         DS    F                                                        07260000
         DC    A(GPID)                                                  07261000
         DC    AL1(X'80')                                               07262000
         DC    AL3(SETZERO)                                             07263000
@AL01237 EQU   *                       LIST WITH   5 ARGUMENT(S)        07264000
@AL01238 DC    A(@CC00728)             LIST WITH   5 ARGUMENT(S)        07265000
         DS    F                                                        07266000
         DC    A(NULLPARM)                                              07267000
         DC    A(@CF00116)                                              07268000
         DC    A(@CF00116)                                              07269000
@AL01376 DC    A(@CF00891)             LIST WITH   4 ARGUMENT(S)        07270000
         DC    A(NULLPARM)                                              07271000
         DS    F                                                        07272000
         DC    A(SETZERO)                                               07273000
@DATD    DSECT                                                          07274000
         DS    0F                                                       07275000
@SA00001 DS    18F                                                      07276000
@PC00001 DS    3F                                                       07277000
@SA00003 DS    14F                                                      07278000
@SA00002 DS    14F                                                      07279000
@SA00004 DS    14F                                                      07280000
@PC00004 DS    6F                                                       07281000
@SA00005 DS    14F                                                      07282000
@PC00005 DS    1F                                                       07283000
@SA00006 DS    15F                                                      07284000
@PC00006 DS    6F                                                       07285000
@SA00009 DS    15F                                                      07286000
@PC00009 DS    2F                                                       07287000
@SA00012 DS    14F                                                      07288000
@PC00012 DS    2F                                                       07289000
@PC00011 DS    4F                                                       07290000
@SA00010 DS    14F                                                      07291000
@SA00008 DS    14F                                                      07292000
@PC00008 DS    3F                                                       07293000
@SA00007 DS    14F                                                      07294000
@PC00007 DS    1F                                                       07295000
@SA00013 DS    15F                                                      07296000
@PC00013 DS    1F                                                       07297000
@AL00001 DS    6A                                                       07298000
@AFTEMPS DS    7F                                                       07299000
IDCXP01  CSECT                                                          07300000
         DS    0F                                                       07301000
@CF00116 DC    F'0'                                                     07302000
@CF00220 DC    F'1'                                                     07303000
@CH00220 EQU   @CF00220+2                                               07304000
@CF00154 DC    F'2'                                                     07305000
@CH00154 EQU   @CF00154+2                                               07306000
@CF00043 DC    F'4'                                                     07307000
@CH00043 EQU   @CF00043+2                                               07308000
@CF00287 DC    F'5'                                                     07309000
@CF00180 DC    F'8'                                                     07310000
@CH00180 EQU   @CF00180+2                                               07311000
@CF00038 DC    F'9'                                                     07312000
@CF00037 DC    F'10'                                                    07313000
@CF00641 DC    F'14'                                                    07314000
@CF00229 DC    F'15'                                                    07315000
@CF00483 DC    F'16'                                                    07316000
@CF00988 DC    F'17'                                                    07317000
@CF00610 DC    F'18'                                                    07318000
@CF00625 DC    F'20'                                                    07319000
@CF01340 DC    F'28'                                                    07320000
@CH01340 EQU   @CF01340+2                                               07321000
@CF01346 DC    F'33'                                                    07322000
@CF01110 DC    F'40'                                                    07323000
@CH01110 EQU   @CF01110+2                                               07324000
@CF00912 DC    F'45'                                                    07325000
@CH00912 EQU   @CF00912+2                                               07326000
@CF01112 DC    F'72'                                                    07327000
@CF01114 DC    F'76'                                                    07328000
@CF00891 DC    F'268'                                                   07329000
@CH00891 EQU   @CF00891+2                                               07330000
@CF01342 DC    F'1052'                                                  07331000
@CF01144 DC    F'2048'                                                  07332000
@CF01373 DC    F'-41'                                                   07333000
@CF01374 DC    F'-40'                                                   07334000
@CF01368 DC    F'-8'                                                    07335000
@CF01379 DC    F'-4'                                                    07336000
@DATD    DSECT                                                          07337000
         DS    0D                                                       07338000
LISTSCAN DS    A                                                        07339000
DDSTRU   DS    A                                                        07340000
FSADDR   DS    A                                                        07341000
ERCNVADR DS    A                                                        07342000
DMPINDEX DS    A                                                        07343000
CTGPLPTR DS    A                                                        07344000
DSCCATPT DS    A                                                        07345000
RECSZ    DS    F                                                        07346000
BLKSIZ   DS    F                                                        07347000
TOTLEN   DS    F                                                        07348000
DCPLPTR  DS    A                                                        07349000
RCPCPLPT DS    A                                                        07350000
PINIOCS  DS    A                                                        07351000
POUTIOCS DS    A                                                        07352000
PTRCTACB DS    A                                                        07353000
CONRCPTR DS    A                                                        07354000
ALLPTR   DS    A                                                        07355000
LIMIT    DS    F                                                        07356000
INDXCPL  DS    F                                                        07357000
A1CPLPTR DS    A                                                        07358000
DSIZE    DS    F                                                        07359000
MNOENT   DS    F                                                        07360000
SIZENEED DS    F                                                        07361000
CTGFVPTR DS    A                                                        07362000
LISTPTR  DS    A                                                        07363000
SETRC    DS    H                                                        07364000
NUMASSOC DS    H                                                        07365000
NUMOBJ   DS    H                                                        07366000
SAPLLEN  DS    H                                                        07367000
QUALLEN  DS    H                                                        07368000
LISTLN   DS    FL1                                                      07369000
@TS00001 DS    CL95                                                     07370000
SUPPRESS DS    BL1                                                      07371000
ERRORTAB DS    CL32                                                     07372000
         DS    CL1                                                      07373000
@NM00047 DS    CL10                                                     07374000
         ORG   @NM00047                                                 07375000
CATRTNID DS    CL8                                                      07376000
CATLGRC  DS    FL2                                                      07377000
         ORG   @NM00047+10                                              07378000
RELNAME  DS    CL44                                                     07379000
DSAVCPL  DS    CL28                                                     07380000
SAVEPL   DS    CL588                                                    07381000
         ORG   SAVEPL                                                   07382000
@NM00053 DS    CL28                                                     07383000
@NM00054 DS    20CL4                                                    07384000
@NM00055 DS    20CL24                                                   07385000
         ORG   SAVEPL+588                                               07386000
DOCNTRL  DS    BL1                                                      07387000
PORTTIME DS    CL8                                                      07388000
PORTDATE DS    CL8                                                      07389000
ALLLIST  DS    CL29                                                     07390000
DEALLOC  DS    BL1                                                      07391000
         DS    CL3                                                      07392000
QUALLIST DS    CL12                                                     07393000
         ORG   QUALLIST                                                 07394000
QUALADDR DS    AL4                                                      07395000
QUALCAT  DS    AL4                                                      07396000
QUALPAS  DS    AL4                                                      07397000
         ORG   QUALLIST+12                                              07398000
FLGS     DS    CL1                                                      07399000
         ORG   FLGS                                                     07400000
AIXFLAG  DS    BL1                                                      07401000
KSDSFLAG EQU   FLGS+0                                                   07402000
PATHFLAG EQU   FLGS+0                                                   07403000
RRDSFLAG EQU   FLGS+0                                                   07404000
FIRFLAG  EQU   FLGS+0                                                   07405000
@NM00056 EQU   FLGS+0                                                   07406000
         ORG   FLGS+1                                                   07407000
         DS    CL3                                                      07408000
OPENLIST DS    BL48                                                     07409000
DEFINED  DS    BL1                                                      07410000
CNTRL    DS    BL1                                                      07411000
COREFLAG DS    BL1                                                      07412000
DEFSTMOD DS    CL3                                                      07413000
         DS    CL2                                                      07414000
PRINTTAB DS    9F                                                       07415000
PTRCPL   DS    5A                                                       07416000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                07417000
@ENDDATD EQU   *                                                        07418000
IDCXP01  CSECT                                                          07419000
         DS    0F                                                       07420000
@SIZDATD DC    AL1(0)                                                   07421000
         DC    AL3(@ENDDATD-@DATD)                                      07422000
         DS    0D                                                       07423000
MINRECSZ DC    F'268'                                                   07424000
NULLPARM DC    A(0)                                                     07425000
NMLENGTH DC    H'45'                                                    07426000
ASSOBJNM DC    AL2(3-1)                                                 07427000
CNUM     DC    AL1(24)                                                  07428000
ONUM     DC    AL1(24-3)                                                07429000
RNUM     DC    AL1(2)                                                   07430000
AIXNUM   DC    AL1(2)                                                   07431000
F1NUM    DC    AL1(2)                                                   07432000
F2NUM    DC    AL1(1)                                                   07433000
@CC01209 DC    C'CATLGRTN'                                              07434000
@CC00896 DC    C'XP01'                                                  07435000
@CC01134 DC    C'XPBG'                                                  07436000
@CC01139 DC    C'XPFN'                                                  07437000
@CC01140 DC    C'XPED'                                                  07438000
@CC01145 DC    C'XPCP'                                                  07439000
@CC01150 DC    C'XPAO'                                                  07440000
@CC01156 DC    C'XPWC'                                                  07441000
@CC01172 DC    C'XPPM'                                                  07442000
@CC01176 DC    C'XPTM'                                                  07443000
@CC01181 DC    C'XPUC'                                                  07444000
@CC01200 DC    C'XPLP'                                                  07445000
@CC01208 DC    C'XPSP'                                                  07446000
@CC01210 DC    C'XPZZ'                                                  07447000
@CC01230 DC    C'XPOP'                                                  07448000
@CC01238 DC    C'XPAP'                                                  07449000
@CC01254 DC    C'XPDP'                                                  07450000
@CC01259 DC    C'XPZY'                                                  07451000
@CC01283 DC    C'XPPP'                                                  07452000
@CC01289 DC    C'XPRP'                                                  07453000
@CC01318 DC    C'XPCR'                                                  07454000
@CC01324 DC    C'XPCW'                                                  07455000
@CC01334 DC    C'DLMS'                                                  07456000
@CC00914 EQU   @CC00896                                                 07457000
@CC00930 DC    C'UV0'                                                   07458000
@CC00938 DC    C'DL0'                                                   07459000
@CC00728 DC    C'I'                                                     07460000
@CC00732 EQU   @CC00930                                                 07461000
@CC00736 EQU   @CC01209                                                 07462000
@CC00738 DC    C'G'                                                     07463000
@CC00740 DC    C'R'                                                     07464000
@CC01155 DC    C'O'                                                     07465000
@CC01159 DC    C'N'                                                     07466000
ALL      DC    CL3'ALL'                                                 07467000
FORMAT   DC    CL4'FORM'                                                07468000
HSECOND  DC    CL4'HSEC'                                                07469000
CLOCK    DC    CL4'KLOK'                                                07470000
SETZERO  DC    CL4'ZERO'                                                07471000
SETBLANK DC    CL4'BLNK'                                                07472000
NOSET    DC    CL4'NSET'                                                07473000
OVERRIDE DC    CL4'OVRD'                                                07474000
ACQUIRE  DC    CL8'ACQUIRE '                                            07475000
RELINQ   DC    CL8'RELINQ  '                                            07476000
MOUNT    DC    CL8'MOUNT   '                                            07477000
DEMOUNT  DC    CL8'DEMOUNT '                                            07478000
DEFINE   DC    CL8'DEFINE  '                                            07479000
MOVE     DC    CL8'MOVE    '                                            07480000
TRACEQ   DC    CL8'TRACEQ  '                                            07481000
COPYTABL DC    CL8'COPYTABL'                                            07482000
COPYCRTG DC    CL8'COPYCRTG'                                            07483000
COPYVOL  DC    CL8'COPYVOL '                                            07484000
VVIC     DC    CL8'VVIC    '                                            07485000
TUNE     DC    CL8'TUNE    '                                            07486000
NAMES    DC    CL4'NAME'                                                07487000
UNIT     DC    CL4'UNIT'                                                07488000
SHR      DC    CL4'SHR '                                                07489000
EXCL     DC    CL4'EXCL'                                                07490000
NOWAIT   DC    CL4'NWAI'                                                07491000
WAIT     DC    CL4'WAIT'                                                07492000
MODID    DC    CL4'XP01'                                                07493000
GPID     DC    CL4'XP01'                                                07494000
FIXAREA  DS    CL400                                                    07495000
         ORG   FIXAREA                                                  07496000
@NM00043 DS    CL256                                                    07497000
         ORG   @NM00043                                                 07498000
@NM00044 DC    256X'00'                                                 07499000
         ORG   FIXAREA+256                                              07500000
@NM00045 DS    CL144                                                    07501000
         ORG   @NM00045                                                 07502000
@NM00046 DC    144X'00'                                                 07503000
         ORG   FIXAREA+400                                              07504000
FLIST2   DC    CL8'ENTNAME '                                            07505000
NOTINIT  DS    CL255                                                    07506000
         ORG   NOTINIT                                                  07507000
@NM00051 DC    255X'FF'                                                 07508000
         ORG   NOTINIT+255                                              07509000
EXPTYPE1 DC    X'F2'                                                    07510000
CITYPEXT DC    CL8'ITYPEXT '                                            07511000
SSFLAG   DC    X'80'                                                    07512000
ZERO     DC    X'00'                                                    07513000
         DC    XL255'0'                                                 07514000
FIELDLST DC    CL8'ENTYPE  '                                            07515000
         DC    CL8'ENTNAME '                                            07516000
         DC    CL8'DSATTR  '                                            07517000
         DC    CL8'OWNERID '                                            07518000
         DC    CL8'DSETCRDT'                                            07519000
         DC    CL8'DSETEXDT'                                            07520000
         DC    CL8'BUFSIZE '                                            07521000
         DC    CL8'LRECL   '                                            07522000
         DC    CL8'SPACPARM'                                            07523000
         DC    CL8'PASSWORD'                                            07524000
         DC    CL8'PASSPRMT'                                            07525000
         DC    CL8'PASSATMP'                                            07526000
         DC    CL8'USVRMDUL'                                            07527000
         DC    CL8'USERAREC'                                            07528000
         DC    CL8'LOKEYV  '                                            07529000
         DC    CL8'HIKEYV  '                                            07530000
         DC    CL8'VOLSER  '                                            07531000
         DC    CL8'AMDSBCAT'                                            07532000
         DC    CL8'EXCPEXIT'                                            07533000
         DC    CL8'RGATTR  '                                            07534000
         DC    CL8'SECFLAGS'                                            07535000
         DC    CL8'NAMEDS  '                                            07536000
         DC    CL8'CATACB  '                                            07537000
         DC    CL8'CATTR   '                                            07538000
FLIST1   DC    CL8'ENTYPE  '                                            07539000
         DC    CL8'NAMEDS  '                                            07540000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07541000
@01      EQU   01                                                       07542000
@02      EQU   02                                                       07543000
@03      EQU   03                                                       07544000
@04      EQU   04                                                       07545000
@05      EQU   05                                                       07546000
@06      EQU   06                                                       07547000
@07      EQU   07                                                       07548000
@08      EQU   08                                                       07549000
@09      EQU   09                                                       07550000
@10      EQU   10                                                       07551000
@11      EQU   11                                                       07552000
@12      EQU   12                                                       07553000
@13      EQU   13                                                       07554000
@14      EQU   14                                                       07555000
@15      EQU   15                                                       07556000
CURSIZE  EQU   @02                                                      07557000
J        EQU   @02                                                      07558000
ICONTRBL EQU   @02                                                      07559000
M1SIZE   EQU   @02                                                      07560000
MTPTR    EQU   @03                                                      07561000
MFPTR    EQU   @04                                                      07562000
PAD      EQU   @04                                                      07563000
PLN      EQU   @05                                                      07564000
IX       EQU   @02                                                      07565000
IND1     EQU   @02                                                      07566000
ALLOINDX EQU   @03                                                      07567000
AFVTPTR  EQU   @02                                                      07568000
WSIZE    EQU   @03                                                      07569000
LGNFLD   EQU   @05                                                      07570000
DINDX    EQU   @03                                                      07571000
INDX     EQU   @04                                                      07572000
I        EQU   @04                                                      07573000
ENTRYNO  EQU   @02                                                      07574000
ASSREMD  EQU   @02                                                      07575000
CLRFDCTR EQU   @03                                                      07576000
NUMOBJCT EQU   @05                                                      07577000
NUMCPL   EQU   @05                                                      07578000
FNMPTR   EQU   @03                                                      07579000
DEFSTID  EQU   @06                                                      07580000
CTGFLPTR EQU   @02                                                      07581000
OPNPTR   EQU   @03                                                      07582000
IOCSPTR  EQU   @03                                                      07583000
TESTRC   EQU   @02                                                      07584000
RTNREG   EQU   @15                                                      07585000
REG15    EQU   @15                                                      07586000
REG0     EQU   @00                                                      07587000
REG1     EQU   @01                                                      07588000
REG10    EQU   @10                                                      07589000
REG11    EQU   @11                                                      07590000
REG12    EQU   @12                                                      07591000
REG13    EQU   @13                                                      07592000
REG14    EQU   @14                                                      07593000
REG2     EQU   @02                                                      07594000
REG3     EQU   @03                                                      07595000
REG4     EQU   @04                                                      07596000
REG5     EQU   @05                                                      07597000
REG6     EQU   @06                                                      07598000
REG7     EQU   @07                                                      07599000
REG8     EQU   @08                                                      07600000
REG9     EQU   @09                                                      07601000
IDCSAEP0 EQU   0                                                        07602000
IDCSAFS0 EQU   0                                                        07603000
IDCSAGP0 EQU   0                                                        07604000
IDCSAFP0 EQU   0                                                        07605000
IDCSATI0 EQU   0                                                        07606000
IDCSACA0 EQU   0                                                        07607000
IDCSAAL0 EQU   0                                                        07608000
IDCSADL0 EQU   0                                                        07609000
IDCSAQL0 EQU   0                                                        07610000
TRACE1   EQU   0                                                        07611000
OLDERID1 EQU   TRACE1                                                   07612000
TRACE2   EQU   0                                                        07613000
OLDERID2 EQU   TRACE2                                                   07614000
NEWID2   EQU   TRACE2+95                                                07615000
NEWERID2 EQU   5                                                        07616000
CIRAGL   EQU   0                                                        07617000
CIRTYPE  EQU   CIRAGL                                                   07618000
ALLAGL   EQU   0                                                        07619000
ALLDSN   EQU   ALLAGL                                                   07620000
ALLDDN   EQU   ALLAGL+4                                                 07621000
ALLPWD   EQU   ALLAGL+20                                                07622000
ALLSTS   EQU   ALLAGL+24                                                07623000
ALLSTSOD EQU   ALLSTS                                                   07624000
ALLDSP   EQU   ALLAGL+25                                                07625000
ALLDSPKP EQU   ALLDSP                                                   07626000
ALLORG   EQU   ALLAGL+26                                                07627000
ALLOPT   EQU   ALLAGL+28                                                07628000
ALLOPTVL EQU   ALLOPT                                                   07629000
ALLOPTDS EQU   ALLOPT                                                   07630000
UNITABL  EQU   0                                                        07631000
UNITADR  EQU   UNITABL+4                                                07632000
@NM00010 EQU   UNITADR                                                  07633000
UNITSTAT EQU   UNITABL+6                                                07634000
IDCIOOP0 EQU   0                                                        07635000
IDCIOCL0 EQU   0                                                        07636000
IDCIOPT0 EQU   0                                                        07637000
IDCIOCO0 EQU   0                                                        07638000
IOCSTR   EQU   0                                                        07639000
IOCDAD   EQU   IOCSTR                                                   07640000
IOCDLN   EQU   IOCSTR+4                                                 07641000
IOCTRN   EQU   IOCSTR+8                                                 07642000
IOCDSO   EQU   IOCSTR+16                                                07643000
IOCRFM   EQU   IOCSTR+17                                                07644000
IOCMAC   EQU   IOCSTR+18                                                07645000
IOCMAC2  EQU   IOCSTR+19                                                07646000
IOCCHP   EQU   IOCSTR+20                                                07647000
IOCMSG   EQU   IOCSTR+21                                                07648000
IOCMSGOP EQU   IOCMSG                                                   07649000
IOCDSN   EQU   IOCSTR+32                                                07650000
IOCRBA   EQU   IOCSTR+40                                                07651000
IOCTTR   EQU   IOCRBA                                                   07652000
IOCMEM   EQU   IOCSTR+44                                                07653000
IOCNWM   EQU   IOCSTR+48                                                07654000
IOCREL   EQU   IOCSTR+60                                                07655000
OPNAGL   EQU   0                                                        07656000
OPNOPT   EQU   OPNAGL                                                   07657000
OPNOPTIN EQU   OPNOPT                                                   07658000
OPNOPTOT EQU   OPNOPT                                                   07659000
OPNRFM   EQU   OPNAGL+1                                                 07660000
OPNRFMSF EQU   OPNRFM                                                   07661000
OPNRFMBK EQU   OPNRFM                                                   07662000
OPNTYP   EQU   OPNAGL+2                                                 07663000
OPNTYPXM EQU   OPNTYP                                                   07664000
OPNMOD   EQU   OPNAGL+3                                                 07665000
OPNMODAX EQU   OPNMOD                                                   07666000
OPNIOC   EQU   OPNAGL+4                                                 07667000
OPNDDN   EQU   OPNAGL+8                                                 07668000
OPNPWA   EQU   OPNAGL+12                                                07669000
OPNDSN   EQU   OPNAGL+16                                                07670000
OPNDEV   EQU   OPNAGL+24                                                07671000
OPNDEVDT EQU   OPNDEV                                                   07672000
OPNREC   EQU   OPNAGL+32                                                07673000
OPNBLK   EQU   OPNAGL+36                                                07674000
OPNDSO   EQU   OPNAGL+41                                                07675000
OPNOPT2  EQU   OPNAGL+42                                                07676000
IOINFOPT EQU   0                                                        07677000
UVOLLIST EQU   0                                                        07678000
UVOLENT  EQU   UVOLLIST+2                                               07679000
AMSTP011 EQU   0                                                        07680000
IDCTPER0 EQU   0                                                        07681000
DARGLIST EQU   0                                                        07682000
DARGDBP  EQU   DARGLIST                                                 07683000
DARGSTID EQU   DARGLIST+8                                               07684000
DARGSMOD EQU   DARGSTID                                                 07685000
DARGSENT EQU   DARGSTID+3                                               07686000
DARGILP  EQU   DARGLIST+12                                              07687000
DARGCNT  EQU   DARGLIST+14                                              07688000
DARGFLGS EQU   DARGLIST+19                                              07689000
DARGARY  EQU   DARGLIST+20                                              07690000
DARGINS  EQU   DARGARY                                                  07691000
DARGINL  EQU   DARGARY+2                                                07692000
DARGDTM  EQU   DARGARY+4                                                07693000
FMTLIST  EQU   0                                                        07694000
FMTFLGS  EQU   FMTLIST                                                  07695000
FMTSPF   EQU   FMTLIST+2                                                07696000
FMTRFNO  EQU   FMTSPF                                                   07697000
FMTILEN  EQU   FMTRFNO                                                  07698000
FMTIOFF  EQU   FMTLIST+4                                                07699000
FMTTRBC  EQU   FMTIOFF                                                  07700000
FMTSTO   EQU   FMTTRBC                                                  07701000
FMTOCOL  EQU   FMTLIST+6                                                07702000
FMTCNVF  EQU   FMTLIST+10                                               07703000
ERCNVTAB EQU   0                                                        07704000
ERTYPE   EQU   ERCNVTAB                                                 07705000
ERCATLG  EQU   ERTYPE                                                   07706000
EROPER   EQU   ERCNVTAB+1                                               07707000
ERCATLC  EQU   EROPER                                                   07708000
ERCATDL  EQU   EROPER                                                   07709000
ERCATAL  EQU   EROPER                                                   07710000
EROSOPER EQU   ERCNVTAB+2                                               07711000
ERDSNM   EQU   ERCNVTAB+12                                              07712000
ERCATRC  EQU   ERCNVTAB+16                                              07713000
ERCPLPT  EQU   ERCNVTAB+20                                              07714000
IDCDB010 EQU   0                                                        07715000
DMPITM   EQU   0                                                        07716000
DMPARY   EQU   0                                                        07717000
ENT      EQU   0                                                        07718000
ENTPLN   EQU   ENT                                                      07719000
ENTPAS   EQU   ENT+1                                                    07720000
ENTFLG   EQU   ENT+10                                                   07721000
ENTFUQ   EQU   ENTFLG                                                   07722000
ENTLEN   EQU   ENT+20                                                   07723000
ENTVAL   EQU   ENT+21                                                   07724000
INDD     EQU   0                                                        07725000
INDDVAL  EQU   INDD+1                                                   07726000
OUT      EQU   0                                                        07727000
OUTDS    EQU   0                                                        07728000
OUTDSPLN EQU   OUTDS                                                    07729000
OUTDSPAS EQU   OUTDS+1                                                  07730000
OUTDSFLG EQU   OUTDS+10                                                 07731000
OUTDSFUQ EQU   OUTDSFLG                                                 07732000
OUTDSLEN EQU   OUTDS+20                                                 07733000
OUTDSVAL EQU   OUTDS+21                                                 07734000
OUTDD    EQU   0                                                        07735000
OUTDDVAL EQU   OUTDD+1                                                  07736000
ENVIR    EQU   0                                                        07737000
PDEV     EQU   0                                                        07738000
PDEVVAL  EQU   PDEV+1                                                   07739000
BLKSZ    EQU   0                                                        07740000
BLKSZVAL EQU   BLKSZ                                                    07741000
PERM     EQU   0                                                        07742000
INHBS    EQU   0                                                        07743000
INHBT    EQU   0                                                        07744000
ERASE    EQU   0                                                        07745000
NOERS    EQU   0                                                        07746000
PURGE    EQU   0                                                        07747000
DISCT    EQU   0                                                        07748000
CTGPL    EQU   0                                                        07749000
CTGOPTN1 EQU   CTGPL                                                    07750000
CTGBYPSS EQU   CTGOPTN1                                                 07751000
CTGNAME  EQU   CTGOPTN1                                                 07752000
CTGCNAME EQU   CTGOPTN1                                                 07753000
CTGOPTN2 EQU   CTGPL+1                                                  07754000
CTGEXT   EQU   CTGOPTN2                                                 07755000
CTGERASE EQU   CTGOPTN2                                                 07756000
CTGSMF   EQU   CTGERASE                                                 07757000
CTGREL   EQU   CTGSMF                                                   07758000
CTGPURG  EQU   CTGOPTN2                                                 07759000
CTGVMNT  EQU   CTGPURG                                                  07760000
CTGRCATN EQU   CTGVMNT                                                  07761000
CTGDISC  EQU   CTGOPTN2                                                 07762000
CTGOVRID EQU   CTGOPTN2                                                 07763000
CTGOPTN3 EQU   CTGPL+2                                                  07764000
CTGFUNC  EQU   CTGOPTN3                                                 07765000
CTGNUM   EQU   CTGOPTN3                                                 07766000
CTGAM0   EQU   CTGOPTN3                                                 07767000
CTGOPTN4 EQU   CTGPL+3                                                  07768000
CTGENT   EQU   CTGPL+4                                                  07769000
CTGFVT   EQU   CTGENT                                                   07770000
CTGCAT   EQU   CTGPL+8                                                  07771000
CTGWKA   EQU   CTGPL+12                                                 07772000
CTGDSORG EQU   CTGPL+16                                                 07773000
CTGOPTNS EQU   CTGDSORG                                                 07774000
CTGTYPE  EQU   CTGPL+18                                                 07775000
CTGNOFLD EQU   CTGPL+19                                                 07776000
CTGDDNM  EQU   CTGPL+20                                                 07777000
CTGNEWNM EQU   CTGDDNM                                                  07778000
CTGFBFLG EQU   CTGNEWNM+2                                               07779000
CTGJSCB  EQU   CTGPL+24                                                 07780000
CTGPSWD  EQU   CTGJSCB                                                  07781000
CTGFIELD EQU   CTGPL+28                                                 07782000
CTGFL    EQU   0                                                        07783000
CTGFLDNO EQU   CTGFL                                                    07784000
CTGFLDCD EQU   CTGFL+1                                                  07785000
CTGFLDRE EQU   CTGFL+3                                                  07786000
CTGFLDWA EQU   CTGFL+4                                                  07787000
CTGFLDNM EQU   CTGFL+8                                                  07788000
CTGFLCHN EQU   CTGFL+12                                                 07789000
CTGFLDAT EQU   CTGFL+16                                                 07790000
CTGFLNG  EQU   CTGFLDAT                                                 07791000
CTGFLPT  EQU   CTGFLDAT+4                                               07792000
CTGFV    EQU   0                                                        07793000
CTGFVTYP EQU   CTGFV                                                    07794000
CTGFVPRO EQU   CTGFV+1                                                  07795000
CTGFVIND EQU   CTGFV+16                                                 07796000
CTGFVENT EQU   CTGFV+20                                                 07797000
CTGFVSPC EQU   CTGFV+52                                                 07798000
CTGFVAMD EQU   CTGFV+56                                                 07799000
CTGFVATR EQU   CTGFV+60                                                 07800000
CTGFVLMT EQU   CTGFV+72                                                 07801000
CTGFVGAT EQU   CTGFV+76                                                 07802000
CTGFVPWD EQU   CTGFV+84                                                 07803000
IDAAMDSB EQU   0                                                        07804000
AMDATTR  EQU   IDAAMDSB+1                                               07805000
AMDRRDS  EQU   AMDATTR                                                  07806000
AMDNEST  EQU   IDAAMDSB+4                                               07807000
AMDAXRKP EQU   AMDNEST                                                  07808000
AMDRKP   EQU   IDAAMDSB+6                                               07809000
AMDKEYLN EQU   IDAAMDSB+8                                               07810000
AMDPCTCA EQU   IDAAMDSB+10                                              07811000
AMDPCTCI EQU   IDAAMDSB+11                                              07812000
AMDCINV  EQU   IDAAMDSB+20                                              07813000
AMDLRECL EQU   IDAAMDSB+24                                              07814000
AMDHLRBA EQU   IDAAMDSB+28                                              07815000
AMDSSRBA EQU   IDAAMDSB+32                                              07816000
AMDATTR3 EQU   IDAAMDSB+40                                              07817000
AMDSTAT  EQU   IDAAMDSB+48                                              07818000
FENTYPE  EQU   0                                                        07819000
FENTNAME EQU   0                                                        07820000
FNAMEDS  EQU   0                                                        07821000
FTYPE    EQU   FNAMEDS                                                  07822000
FNAME    EQU   FNAMEDS+1                                                07823000
FCATACB  EQU   0                                                        07824000
FDSATTR  EQU   0                                                        07825000
FDSINHUP EQU   FDSATTR                                                  07826000
FDSTMPEX EQU   FDSATTR                                                  07827000
FDSNTUSE EQU   FDSATTR+1                                                07828000
FCATTR   EQU   0                                                        07829000
PAGESPC  EQU   FCATTR                                                   07830000
FPASSMWR EQU   0                                                        07831000
FIELD    EQU   0                                                        07832000
FIELDLN  EQU   FIELD                                                    07833000
WORKAREA EQU   0                                                        07834000
AREALN   EQU   WORKAREA                                                 07835000
RETURNLN EQU   WORKAREA+2                                               07836000
ENTLIST  EQU   WORKAREA+4                                               07837000
ENTITEM  EQU   ENTLIST                                                  07838000
ENTRYTYP EQU   ENTITEM                                                  07839000
ENTRYNM  EQU   ENTITEM+1                                                07840000
PATHREL  EQU   0                                                        07841000
RELATE   EQU   PATHREL                                                  07842000
PATHENT  EQU   RELATE                                                   07843000
@NM00052 EQU   PATHREL+44                                               07844000
PATHPASS EQU   @NM00052                                                 07845000
CONREC   EQU   0                                                        07846000
HEADER   EQU   CONREC                                                   07847000
HEADLN   EQU   HEADER                                                   07848000
HEADFLG1 EQU   HEADER+2                                                 07849000
HEADFLG2 EQU   HEADER+3                                                 07850000
ASSRECLN EQU   HEADER+4                                                 07851000
ASSRECNM EQU   HEADER+6                                                 07852000
VARDATA  EQU   CONREC+8                                                 07853000
DICT     EQU   0                                                        07854000
DICTNM   EQU   DICT                                                     07855000
DICTEN   EQU   DICT+4                                                   07856000
DICTLN   EQU   DICTEN                                                   07857000
DICTDL   EQU   DICTEN+4                                                 07858000
TIMESTMP EQU   0                                                        07859000
TEXOJCT  EQU   TIMESTMP                                                 07860000
TEXFLG   EQU   TIMESTMP+1                                               07861000
TEXINHTG EQU   TEXFLG                                                   07862000
TEXASSOC EQU   TEXFLG                                                   07863000
TEXBASE  EQU   TEXFLG                                                   07864000
TEXFLG2  EQU   TIMESTMP+2                                               07865000
TIMEODAY EQU   TIMESTMP+4                                               07866000
TIMEDATE EQU   TIMESTMP+12                                              07867000
DSNAME   EQU   0                                                        07868000
OIOCSPTR EQU   0                                                        07869000
FROMAREA EQU   0                                                        07870000
TOAREA   EQU   0                                                        07871000
AMSTP041 EQU   0                                                        07872000
AMSTP042 EQU   0                                                        07873000
AMSTP043 EQU   0                                                        07874000
AMSTP044 EQU   0                                                        07875000
DMPTRM   EQU   0                                                        07876000
IDCIOGT0 EQU   0                                                        07877000
IDCIOIT0 EQU   0                                                        07878000
IDCIOPO0 EQU   0                                                        07879000
IDCIOSI0 EQU   0                                                        07880000
IDCIOST0 EQU   0                                                        07881000
IDCIOTM0 EQU   0                                                        07882000
IDCIOVY0 EQU   0                                                        07883000
IDCIO050 EQU   0                                                        07884000
IDCSACL0 EQU   0                                                        07885000
IDCSACR0 EQU   0                                                        07886000
IDCSADE0 EQU   0                                                        07887000
IDCSADQ0 EQU   0                                                        07888000
IDCSAGS0 EQU   0                                                        07889000
IDCSAID0 EQU   0                                                        07890000
IDCSALC0 EQU   0                                                        07891000
IDCSALD0 EQU   0                                                        07892000
IDCSALK0 EQU   0                                                        07893000
IDCSANQ0 EQU   0                                                        07894000
IDCSAPR0 EQU   0                                                        07895000
IDCSAPT0 EQU   0                                                        07896000
IDCSARC0 EQU   0                                                        07897000
IDCSARV0 EQU   0                                                        07898000
IDCSASC0 EQU   0                                                        07899000
IDCSASI0 EQU   0                                                        07900000
IDCSASN0 EQU   0                                                        07901000
IDCSASS0 EQU   0                                                        07902000
IDCSAST0 EQU   0                                                        07903000
IDCSAUC0 EQU   0                                                        07904000
IDCSAWO0 EQU   0                                                        07905000
IDCSA060 EQU   0                                                        07906000
IDCST010 EQU   0                                                        07907000
LISTTEST EQU   0                                                        07908000
NEWERID1 EQU   5                                                        07909000
NINHS    EQU   0                                                        07910000
NINHT    EQU   0                                                        07911000
NPRG     EQU   0                                                        07912000
TEMP     EQU   0                                                        07913000
GDTTBL   EQU   0                                                        07914000
GDTTR1   EQU   GDTTBL+8                                                 07915000
GDTTR2   EQU   GDTTBL+12                                                07916000
GDTDBG   EQU   GDTTBL+40                                                07917000
GDTSTC   EQU   GDTTBL+44                                                07918000
GDTPRT   EQU   GDTTBL+48                                                07919000
GDTESS   EQU   GDTTBL+52                                                07920000
GDTESA   EQU   GDTTBL+56                                                07921000
GDTRST   EQU   GDTTBL+60                                                07922000
GDTRES   EQU   GDTTBL+64                                                07923000
GDTCAL   EQU   GDTTBL+68                                                07924000
GDTGSP   EQU   GDTTBL+72                                                07925000
GDTFSP   EQU   GDTTBL+76                                                07926000
GDTGPL   EQU   GDTTBL+80                                                07927000
GDTFPL   EQU   GDTTBL+84                                                07928000
GDTLOD   EQU   GDTTBL+88                                                07929000
GDTDEL   EQU   GDTTBL+92                                                07930000
GDTPRL   EQU   GDTTBL+96                                                07931000
GDTEPL   EQU   GDTTBL+100                                               07932000
GDTTIM   EQU   GDTTBL+104                                               07933000
GDTIIO   EQU   GDTTBL+108                                               07934000
GDTTIO   EQU   GDTTBL+112                                               07935000
GDTOPN   EQU   GDTTBL+124                                               07936000
GDTCLS   EQU   GDTTBL+128                                               07937000
GDTGET   EQU   GDTTBL+132                                               07938000
GDTPUT   EQU   GDTTBL+136                                               07939000
GDTPOS   EQU   GDTTBL+140                                               07940000
GDTCPY   EQU   GDTTBL+144                                               07941000
GDTCAT   EQU   GDTTBL+148                                               07942000
GDTSNP   EQU   GDTTBL+164                                               07943000
GDTVFY   EQU   GDTTBL+172                                               07944000
GDTECT   EQU   GDTTBL+188                                               07945000
GDTUID   EQU   GDTTBL+192                                               07946000
GDTPMT   EQU   GDTTBL+196                                               07947000
GDTCIR   EQU   GDTTBL+200                                               07948000
GDTLNK   EQU   GDTTBL+204                                               07949000
GDTALC   EQU   GDTTBL+208                                               07950000
GDTDLC   EQU   GDTTBL+212                                               07951000
GDTQAL   EQU   GDTTBL+216                                               07952000
GDTSTW   EQU   GDTTBL+220                                               07953000
GDTSSC   EQU   GDTTBL+224                                               07954000
GDTENQ   EQU   GDTTBL+228                                               07955000
GDTRSV   EQU   GDTTBL+232                                               07956000
GDTDEQ   EQU   GDTTBL+236                                               07957000
GDTSFO   EQU   GDTTBL+240                                               07958000
GDTWTO   EQU   GDTTBL+244                                               07959000
GDTSCR   EQU   GDTTBL+248                                               07960000
GDTUNT   EQU   GDTTBL+252                                               07961000
GDTRCT   EQU   GDTTBL+256                                               07962000
GDTIFO   EQU   GDTTBL+260                                               07963000
GDTEXP   EQU   GDTTBL+264                                               07964000
GDTSTA   EQU   GDTTBL+268                                               07965000
GDTERR   EQU   GDTTBL+272                                               07966000
GDTUNC   EQU   GDTTBL+276                                               07967000
GDTLOC   EQU   GDTTBL+280                                               07968000
FDTTBL   EQU   0                                                        07969000
FDTPTR   EQU   FDTTBL+8                                                 07970000
LASTCC   EQU   0                                                        07971000
LNAME    EQU   0                                                        07972000
LCINUM   EQU   0                                                        07973000
LCATACB  EQU   0                                                        07974000
LFLDLST  EQU   0                                                        07975000
LFLDNUM  EQU   0                                                        07976000
LCPLPTR  EQU   0                                                        07977000
SCPLPTR  EQU   0                                                        07978000
OTYPE    EQU   0                                                        07979000
ODD      EQU   0                                                        07980000
ODSN     EQU   0                                                        07981000
OREC     EQU   0                                                        07982000
OBLK     EQU   0                                                        07983000
OIOCS    EQU   0                                                        07984000
ACPLPTR  EQU   0                                                        07985000
DTYPE    EQU   0                                                        07986000
DENTVAL  EQU   0                                                        07987000
DCPL     EQU   0                                                        07988000
PLNINIT  EQU   0                                                        07989000
PADINIT  EQU   0                                                        07990000
MSIZE    EQU   0                                                        07991000
MF1PTR   EQU   0                                                        07992000
MT1PTR   EQU   0                                                        07993000
ZEROOUT  EQU   0                                                        07994000
INDCTGPL EQU   0                                                        07995000
TYPE     EQU   0                                                        07996000
MMNOENT  EQU   0                                                        07997000
@NM00037 EQU   CTGDDNM                                                  07998000
CTGPROB  EQU   @NM00037                                                 07999000
CTGREASN EQU   CTGPROB+2                                                08000000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08001000
CTGREAS2 EQU   CTGREASN+1                                               08002000
CTGREAS1 EQU   CTGREASN                                                 08003000
CTGMODID EQU   CTGPROB                                                  08004000
FDTVERB  EQU   FDTTBL                                                   08005000
GDTPSB   EQU   GDTTBL+184                                               08006000
GDTUPT   EQU   GDTTBL+180                                               08007000
GDTCMB   EQU   GDTTBL+176                                               08008000
GDTSPR   EQU   GDTTBL+168                                               08009000
@NM00001 EQU   GDTTBL+160                                               08010000
GDTABH   EQU   GDTTBL+156                                               08011000
GDTABT   EQU   GDTTBL+152                                               08012000
GDTTOH   EQU   GDTTBL+120                                               08013000
GDTRIP   EQU   GDTTBL+116                                               08014000
GDTIOH   EQU   GDTTBL+36                                                08015000
GDTSAH   EQU   GDTTBL+32                                                08016000
GDTTPH   EQU   GDTTBL+28                                                08017000
GDTRIH   EQU   GDTTBL+24                                                08018000
GDTSTH   EQU   GDTTBL+20                                                08019000
GDTDBH   EQU   GDTTBL+16                                                08020000
GDTPRM   EQU   GDTTBL+4                                                 08021000
GDTHDR   EQU   GDTTBL                                                   08022000
TEXRESV  EQU   TIMESTMP+3                                               08023000
TEXUNIQ  EQU   TEXFLG                                                   08024000
FIELDCT  EQU   FIELD+2                                                  08025000
@NM00050 EQU   FCATTR                                                   08026000
@NM00049 EQU   FDSATTR+1                                                08027000
@NM00048 EQU   FDSATTR                                                  08028000
FDSOTHER EQU   FDSATTR                                                  08029000
AMDEXCP  EQU   AMDSTAT+44                                               08030000
AMDNCAS  EQU   AMDSTAT+40                                               08031000
AMDNCIS  EQU   AMDSTAT+36                                               08032000
AMDASPA  EQU   AMDSTAT+32                                               08033000
AMDRETR  EQU   AMDSTAT+28                                               08034000
AMDUPR   EQU   AMDSTAT+24                                               08035000
AMDIREC  EQU   AMDSTAT+20                                               08036000
AMDDELR  EQU   AMDSTAT+16                                               08037000
AMDNLR   EQU   AMDSTAT+12                                               08038000
AMDNEXT  EQU   AMDSTAT+10                                               08039000
AMDNIL   EQU   AMDSTAT+8                                                08040000
AMDSTSP  EQU   AMDSTAT                                                  08041000
@NM00042 EQU   IDAAMDSB+41                                              08042000
@NM00041 EQU   AMDATTR3                                                 08043000
AMDLM    EQU   AMDATTR3                                                 08044000
AMDWAIT  EQU   AMDATTR3                                                 08045000
AMDBIND  EQU   AMDATTR3                                                 08046000
AMDFAULT EQU   AMDATTR3                                                 08047000
AMDUNQ   EQU   AMDATTR3                                                 08048000
AMDPARDB EQU   IDAAMDSB+36                                              08049000
AMDMAXRR EQU   AMDSSRBA                                                 08050000
AMDNSLOT EQU   AMDHLRBA                                                 08051000
AMDFSCI  EQU   IDAAMDSB+16                                              08052000
AMDFSCA  EQU   IDAAMDSB+14                                              08053000
AMDCIPCA EQU   IDAAMDSB+12                                              08054000
AMDLEN   EQU   IDAAMDSB+2                                               08055000
AMDSPAN  EQU   AMDATTR                                                  08056000
AMDRANGE EQU   AMDATTR                                                  08057000
AMDORDER EQU   AMDATTR                                                  08058000
AMDREPL  EQU   AMDATTR                                                  08059000
AMDSDT   EQU   AMDATTR                                                  08060000
AMDWCK   EQU   AMDATTR                                                  08061000
AMDDST   EQU   AMDATTR                                                  08062000
AMDSBID  EQU   IDAAMDSB                                                 08063000
CTGFVWKA EQU   CTGFV+88                                                 08064000
CTGFVCPP EQU   CTGFVPWD                                                 08065000
CTGFVNAM EQU   CTGFV+80                                                 08066000
CTGFVUPG EQU   CTGFVGAT                                                 08067000
CTGFVEXT EQU   CTGFVLMT                                                 08068000
CTGFVLRS EQU   CTGFV+68                                                 08069000
CTGFVBUF EQU   CTGFV+64                                                 08070000
CTGFVFSN EQU   CTGFVAMD                                                 08071000
CTGFVTTR EQU   CTGFVSPC                                                 08072000
CTGFVDVT EQU   CTGFV+48                                                 08073000
CTGFVRNG EQU   CTGFV+44                                                 08074000
CTGFVVLT EQU   CTGFV+40                                                 08075000
CTGFVCRE EQU   CTGFV+36                                                 08076000
CTGFVEXP EQU   CTGFV+32                                                 08077000
CTGFVOWN EQU   CTGFV+28                                                 08078000
CTGFVSTY EQU   CTGFV+24                                                 08079000
CTGFVVCH EQU   CTGFV+12                                                 08080000
CTGFVICH EQU   CTGFV+8                                                  08081000
CTGFVDCH EQU   CTGFV+4                                                  08082000
@NM00040 EQU   CTGFV+3                                                  08083000
CTGFVELM EQU   CTGFV+2                                                  08084000
@NM00039 EQU   CTGFVPRO                                                 08085000
CTGFVROF EQU   CTGFVPRO                                                 08086000
CTGFVRON EQU   CTGFVPRO                                                 08087000
CTGFVDRC EQU   CTGFVPRO                                                 08088000
CTGFVNDC EQU   CTGFVPRO                                                 08089000
CTGFVRVL EQU   CTGFVPRO                                                 08090000
CTGFVAVL EQU   CTGFVPRO                                                 08091000
CTGFLDTS EQU   CTGFLDRE                                                 08092000
@NM00038 EQU   CTGFLDRE                                                 08093000
CTGFLDGC EQU   CTGFL+2                                                  08094000
@NM00036 EQU   CTGFBFLG                                                 08095000
CTGNGDSN EQU   CTGFBFLG                                                 08096000
CTGGDGB  EQU   CTGFBFLG                                                 08097000
CTGKEEP  EQU   CTGFBFLG                                                 08098000
CTGPAR   EQU   CTGFBFLG                                                 08099000
CTGFDBK  EQU   CTGNEWNM                                                 08100000
@NM00035 EQU   CTGDSORG                                                 08101000
CTGCVOL  EQU   CTGCAT                                                   08102000
@NM00034 EQU   CTGOPTN4                                                 08103000
CTGBYPMT EQU   CTGOPTN4                                                 08104000
@NM00033 EQU   CTGOPTN4                                                 08105000
CTGNPROF EQU   CTGOPTN4                                                 08106000
CTGDOCAT EQU   CTGOPTN4                                                 08107000
CTGLBASE EQU   CTGOPTN4                                                 08108000
CTGSRH   EQU   CTGOPTN3                                                 08109000
CTGGDGL  EQU   CTGOPTN3                                                 08110000
CTGSUPLT EQU   CTGOPTN3                                                 08111000
@NM00032 EQU   CTGOPTN2                                                 08112000
CTGSCR   EQU   CTGOPTN2                                                 08113000
CTGGTNXT EQU   CTGOPTN2                                                 08114000
CTGSWAP  EQU   CTGRCATN                                                 08115000
CTGGTALL EQU   CTGREL                                                   08116000
CTGNSVS  EQU   CTGEXT                                                   08117000
CTGGENLD EQU   CTGOPTN1                                                 08118000
CTGREAD  EQU   CTGOPTN1                                                 08119000
CTGUPD   EQU   CTGOPTN1                                                 08120000
CTGCI    EQU   CTGOPTN1                                                 08121000
CTGMAST  EQU   CTGOPTN1                                                 08122000
PDEVLEN  EQU   PDEV                                                     08123000
OUTDDLEN EQU   OUTDD                                                    08124000
OUTDSMEM EQU   OUTDS+12                                                 08125000
OUTDSMLN EQU   OUTDS+11                                                 08126000
OUTDSPOS EQU   OUTDS+9                                                  08127000
INDDLEN  EQU   INDD                                                     08128000
ENTMEM   EQU   ENT+12                                                   08129000
ENTMLN   EQU   ENT+11                                                   08130000
ENTPOS   EQU   ENT+9                                                    08131000
@NM00031 EQU   DMPARY+15                                                08132000
DMPARYTP EQU   DMPARY+14                                                08133000
DMPARYEX EQU   DMPARY+12                                                08134000
DMPARYIC EQU   DMPARY+10                                                08135000
DMPARYSZ EQU   DMPARY+8                                                 08136000
DMPARYNM EQU   DMPARY                                                   08137000
@NM00030 EQU   DMPITM+15                                                08138000
DMPITMTP EQU   DMPITM+14                                                08139000
DMPITMLN EQU   DMPITM+12                                                08140000
DMPITMPT EQU   DMPITM+8                                                 08141000
DMPITMNM EQU   DMPITM                                                   08142000
@NM00029 EQU   ERCNVTAB+24                                              08143000
ERDARBPT EQU   ERCPLPT                                                  08144000
ERDYNRC  EQU   ERCATRC                                                  08145000
@NM00028 EQU   ERCNVTAB+4                                               08146000
@NM00027 EQU   ERCNVTAB+3                                               08147000
@NM00026 EQU   EROSOPER                                                 08148000
EROSUCDX EQU   EROSOPER                                                 08149000
EROSCATL EQU   EROSOPER                                                 08150000
@NM00025 EQU   EROPER                                                   08151000
ERCATDE  EQU   EROPER                                                   08152000
@NM00024 EQU   ERTYPE                                                   08153000
ERDYNAL  EQU   ERTYPE                                                   08154000
EROSCAT  EQU   ERTYPE                                                   08155000
@NM00023 EQU   FMTCNVF+1                                                08156000
FMTAR    EQU   FMTCNVF+1                                                08157000
FMTBS    EQU   FMTCNVF+1                                                08158000
FMTSS    EQU   FMTCNVF+1                                                08159000
FMTAL    EQU   FMTCNVF+1                                                08160000
FMTZS    EQU   FMTCNVF+1                                                08161000
@NM00022 EQU   FMTCNVF                                                  08162000
FMTPU    EQU   FMTCNVF                                                  08163000
FMTBD    EQU   FMTCNVF                                                  08164000
FMTBHD   EQU   FMTCNVF                                                  08165000
FMTBHA   EQU   FMTCNVF                                                  08166000
FMTBH    EQU   FMTCNVF                                                  08167000
FMTOLEN  EQU   FMTLIST+8                                                08168000
FMTRIO   EQU   FMTOCOL                                                  08169000
FMTSPT   EQU   FMTSTO                                                   08170000
FMTSTL   EQU   FMTILEN                                                  08171000
@NM00021 EQU   FMTFLGS+1                                                08172000
FMTSMSG  EQU   FMTFLGS+1                                                08173000
FMTHDF   EQU   FMTFLGS                                                  08174000
FMTDFF   EQU   FMTFLGS                                                  08175000
FMTSTF   EQU   FMTFLGS                                                  08176000
FMTREPF  EQU   FMTFLGS                                                  08177000
FMTBDF   EQU   FMTFLGS                                                  08178000
FMTIDF   EQU   FMTFLGS                                                  08179000
FMTSCF   EQU   FMTFLGS                                                  08180000
FMTEOLF  EQU   FMTFLGS                                                  08181000
DARGPCT  EQU   DARGINL                                                  08182000
DARGREP  EQU   DARGINS                                                  08183000
@NM00020 EQU   DARGFLGS                                                 08184000
DARGFULL EQU   DARGFLGS                                                 08185000
DARGIND  EQU   DARGLIST+18                                              08186000
DARGRETL EQU   DARGLIST+16                                              08187000
DARGRETP EQU   DARGLIST+4                                               08188000
UVOLVOL  EQU   UVOLENT+4                                                08189000
UVOLDEV  EQU   UVOLENT                                                  08190000
UVOLCNT  EQU   UVOLLIST                                                 08191000
@NM00019 EQU   IOINFOPT                                                 08192000
IOINFLUB EQU   IOINFOPT                                                 08193000
IOINFTMS EQU   IOINFOPT                                                 08194000
IOINFSUP EQU   IOINFOPT                                                 08195000
IOINFDSN EQU   IOINFOPT                                                 08196000
IOINFVOL EQU   IOINFOPT                                                 08197000
IOINFDVT EQU   IOINFOPT                                                 08198000
OPNVOL   EQU   OPNAGL+44                                                08199000
OPNSTRNO EQU   OPNAGL+43                                                08200000
@NM00018 EQU   OPNOPT2                                                  08201000
OPNOPTJM EQU   OPNOPT2                                                  08202000
OPNOPTNM EQU   OPNOPT2                                                  08203000
OPNOPTAS EQU   OPNOPT2                                                  08204000
@NM00017 EQU   OPNDSO                                                   08205000
OPNDSOPO EQU   OPNDSO                                                   08206000
OPNDSOIS EQU   OPNDSO                                                   08207000
OPNDSOPS EQU   OPNDSO                                                   08208000
OPNDSOAM EQU   OPNDSO                                                   08209000
OPNKYL   EQU   OPNAGL+40                                                08210000
OPNDEVIX EQU   OPNDEV+4                                                 08211000
OPNCBP   EQU   OPNAGL+20                                                08212000
OPNMODRP EQU   OPNMOD                                                   08213000
OPNMODUB EQU   OPNMOD                                                   08214000
OPNMODRS EQU   OPNMOD                                                   08215000
OPNMODRR EQU   OPNMOD                                                   08216000
OPNMODRC EQU   OPNMOD                                                   08217000
OPNMODAC EQU   OPNMOD                                                   08218000
OPNMODPD EQU   OPNMOD                                                   08219000
OPNTYPSY EQU   OPNTYP                                                   08220000
OPNTYPRV EQU   OPNTYP                                                   08221000
OPNTYPEX EQU   OPNTYP                                                   08222000
OPNTYPRA EQU   OPNTYP                                                   08223000
OPNTYPCI EQU   OPNTYP                                                   08224000
OPNTYPSO EQU   OPNTYP                                                   08225000
OPNTYPSI EQU   OPNTYP                                                   08226000
@NM00016 EQU   OPNRFM                                                   08227000
OPNRFMUN EQU   OPNRFM                                                   08228000
OPNRFMVR EQU   OPNRFM                                                   08229000
OPNRFMFX EQU   OPNRFM                                                   08230000
OPNOPTSK EQU   OPNOPT                                                   08231000
OPNOPTDR EQU   OPNOPT                                                   08232000
OPNOPTCR EQU   OPNOPT                                                   08233000
OPNOPTKS EQU   OPNOPT                                                   08234000
OPNOPTBK EQU   OPNOPT                                                   08235000
OPNOPTUP EQU   OPNOPT                                                   08236000
IOCEXT   EQU   IOCSTR+64                                                08237000
IOCTSML  EQU   IOCREL+2                                                 08238000
IOCTPML  EQU   IOCREL                                                   08239000
IOCWORK  EQU   IOCSTR+56                                                08240000
IOCRRN   EQU   IOCSTR+52                                                08241000
IOCPNM   EQU   IOCNWM+2                                                 08242000
IOCPTL   EQU   IOCNWM                                                   08243000
IOCKYA   EQU   IOCMEM                                                   08244000
IOCVRC   EQU   IOCTTR                                                   08245000
IOCCBP   EQU   IOCSTR+36                                                08246000
IOCHURBA EQU   IOCSTR+28                                                08247000
IOCVOLSR EQU   IOCSTR+22                                                08248000
@NM00015 EQU   IOCMSG                                                   08249000
IOCMSGSM EQU   IOCMSG                                                   08250000
IOCMSGAE EQU   IOCMSG                                                   08251000
IOCMSGCE EQU   IOCMSG                                                   08252000
IOCMSGOE EQU   IOCMSG                                                   08253000
IOCCHPKG EQU   IOCMSG                                                   08254000
IOCCHPKE EQU   IOCMSG                                                   08255000
IOCCHPNU EQU   IOCCHP                                                   08256000
IOCCHPUP EQU   IOCCHP                                                   08257000
IOCCHPBK EQU   IOCCHP                                                   08258000
IOCCHPCR EQU   IOCCHP                                                   08259000
IOCCHPKS EQU   IOCCHP                                                   08260000
IOCCHPSK EQU   IOCCHP                                                   08261000
IOCCHPDR EQU   IOCCHP                                                   08262000
IOCCHPSQ EQU   IOCCHP                                                   08263000
IOCMACNT EQU   IOCMAC2                                                  08264000
IOCMACER EQU   IOCMAC2                                                  08265000
IOCMACPA EQU   IOCMAC2                                                  08266000
IOCMACEN EQU   IOCMAC2                                                  08267000
IOCMACCP EQU   IOCMAC2                                                  08268000
IOCMACRR EQU   IOCMAC2                                                  08269000
IOCMACAS EQU   IOCMAC2                                                  08270000
IOCMACSK EQU   IOCMAC2                                                  08271000
@NM00014 EQU   IOCMAC                                                   08272000
IOCMACCC EQU   IOCMAC                                                   08273000
IOCMACDR EQU   IOCMAC                                                   08274000
IOCMACBK EQU   IOCMAC                                                   08275000
IOCMACCR EQU   IOCMAC                                                   08276000
IOCMACUP EQU   IOCMAC                                                   08277000
IOCMACOT EQU   IOCMAC                                                   08278000
IOCMACIN EQU   IOCMAC                                                   08279000
@NM00013 EQU   IOCRFM                                                   08280000
IOCRFMBK EQU   IOCRFM                                                   08281000
IOCRFMSF EQU   IOCRFM                                                   08282000
IOCRFMUN EQU   IOCRFM                                                   08283000
IOCRFMVR EQU   IOCRFM                                                   08284000
IOCRFMFX EQU   IOCRFM                                                   08285000
@NM00012 EQU   IOCDSO                                                   08286000
IOCDSOPO EQU   IOCDSO                                                   08287000
IOCDSOIS EQU   IOCDSO                                                   08288000
IOCDSOPS EQU   IOCDSO                                                   08289000
IOCDSOAM EQU   IOCDSO                                                   08290000
IOCRKP   EQU   IOCSTR+13                                                08291000
IOCKYL   EQU   IOCSTR+12                                                08292000
UNITVTOC EQU   UNITABL+7                                                08293000
@NM00011 EQU   UNITSTAT                                                 08294000
UNITUSHR EQU   UNITSTAT                                                 08295000
UNITXSHR EQU   UNITSTAT                                                 08296000
UNITISHR EQU   UNITSTAT                                                 08297000
UNITUA   EQU   @NM00010+1                                               08298000
UNITCHA  EQU   @NM00010                                                 08299000
UNITUCB  EQU   UNITABL                                                  08300000
ALLUNCNT EQU   ALLAGL+30                                                08301000
ALLVLCNT EQU   ALLAGL+29                                                08302000
@NM00009 EQU   ALLOPT                                                   08303000
ALLOPTUN EQU   ALLOPT                                                   08304000
ALLOPTPV EQU   ALLOPT                                                   08305000
@NM00008 EQU   ALLORG+1                                                 08306000
ALLORGVS EQU   ALLORG+1                                                 08307000
@NM00007 EQU   ALLORG+1                                                 08308000
ALLORGGS EQU   ALLORG+1                                                 08309000
ALLORGUN EQU   ALLORG                                                   08310000
ALLORGPO EQU   ALLORG                                                   08311000
ALLORGMQ EQU   ALLORG                                                   08312000
ALLORGCQ EQU   ALLORG                                                   08313000
ALLORGCX EQU   ALLORG                                                   08314000
ALLORGDA EQU   ALLORG                                                   08315000
ALLORGPS EQU   ALLORG                                                   08316000
ALLORGIS EQU   ALLORG                                                   08317000
ALLDSPUN EQU   ALLDSP                                                   08318000
ALLDSPCG EQU   ALLDSP                                                   08319000
ALLDSPDE EQU   ALLDSP                                                   08320000
@NM00006 EQU   ALLDSP                                                   08321000
ALLSTSMD EQU   ALLSTS                                                   08322000
ALLSTSNW EQU   ALLSTS                                                   08323000
ALLSTSSR EQU   ALLSTS                                                   08324000
@NM00005 EQU   ALLSTS                                                   08325000
ALLVLP   EQU   ALLAGL+16                                                08326000
ALLULP   EQU   ALLAGL+12                                                08327000
CIRPID   EQU   CIRAGL+28                                                08328000
CIRPWD   EQU   CIRAGL+24                                                08329000
CIRCAT   EQU   CIRAGL+20                                                08330000
CIRWKP   EQU   CIRAGL+16                                                08331000
CIRTLR   EQU   CIRAGL+12                                                08332000
CIRHDR   EQU   CIRAGL+8                                                 08333000
CIRTLN   EQU   CIRAGL+6                                                 08334000
CIRHLN   EQU   CIRAGL+4                                                 08335000
@NM00004 EQU   CIRAGL+1                                                 08336000
@NM00003 EQU   CIRTYPE                                                  08337000
CIRTYPAQ EQU   CIRTYPE                                                  08338000
CIRTYP1Q EQU   CIRTYPE                                                  08339000
NEWID1   EQU   TRACE1+95                                                08340000
CALLID   EQU   OLDERID1+90                                              08341000
@NM00002 EQU   OLDERID1                                                 08342000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      08343000
@RC00434 EQU   @RC00431                                                 08344000
@RC00432 EQU   @RC00431                                                 08345000
@RC00508 EQU   @RC00470                                                 08346000
@RF00507 EQU   @RC00470                                                 08347000
@RF00598 EQU   @RC00592                                                 08348000
@RC00618 EQU   @RC00617                                                 08349000
@RF00663 EQU   @RC00617                                                 08350000
@RF00711 EQU   @RC00701                                                 08351000
@RC01401 EQU   @RC01400                                                 08352000
@RF01474 EQU   @RC01469                                                 08353000
@PB00013 EQU   @EL00001                                                 08354000
@RF00437 EQU   @RC00434                                                 08355000
@RC00513 EQU   @RC00508                                                 08356000
@RF00523 EQU   @RC00508                                                 08357000
@RF00639 EQU   @RC00618                                                 08358000
@PB00012 EQU   @PB00013                                                 08359000
@PB00011 EQU   @PB00012                                                 08360000
@PB00010 EQU   @PB00011                                                 08361000
@PB00009 EQU   @PB00010                                                 08362000
@PB00008 EQU   @PB00009                                                 08363000
@PB00007 EQU   @PB00008                                                 08364000
@PB00006 EQU   @PB00007                                                 08365000
@PB00005 EQU   @PB00006                                                 08366000
@PB00004 EQU   @PB00005                                                 08367000
@PB00003 EQU   @PB00004                                                 08368000
@PB00002 EQU   @PB00003                                                 08369000
@ENDDATA EQU   *                                                        08370000
         END   IDCXP01,(C'PLS0340',0701,77127)                          08371000
