         TITLE 'ILRASRIM-ASM INITIALIZATION MODULE                     *00001000
                        '                                               00002000
ILRASRIM CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ILRASRIM  77.272'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @09,0                                               0001 00011000
@PSTART  LA    @10,4095(,@09)                                      0001 00012000
         LA    @11,4095(,@10)                                      0001 00013000
         LA    @12,4095(,@11)                                      0001 00014000
         USING @PSTART,@09                                         0001 00015000
         USING @PSTART+4095,@10                                    0001 00016000
         USING @PSTART+8190,@11                                    0001 00017000
         USING @PSTART+12285,@12                                   0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LA    @14,@SA00001                                        0001 00020000
         ST    @14,8(,@13)                                         0001 00021000
         LR    @13,@14                                             0001 00022000
*                                                                       00023000
* REFS ARE GENERATED FOR NVT FIELDS THAT CONTAIN ADDRESSES OF           00024000
* NIP SERVICE ROUTINES, SO IEAPMNIP MACRO CALLS TO THESE ROUTINES       00025000
* WILL ASSEMBLE PROPERLY.                                               00026000
*                                                                  0165 00027000
*/*ILRASRIM: CHART                                                   */ 00028000
*/*HEADER                                                          0165 00029000
*/*  ILRASRIM GENERAL FLOW OF CHART SEGMENTS                         */ 00030000
*/*ILRASRIM: E ENTRY TO SHOW FLOW OF SEGMENTS                        */ 00031000
*/*          S RIMINIT: SET UP                                       */ 00032000
*/*          S OPENPLPA: OPEN PLPA DATA SET                          */ 00033000
*/*          S OPENDPLX: OPEN DUPLEX DATA SET                        */ 00034000
*/*          S OPENCOMM: OPEN COMMON DATA SET                        */ 00035000
*/*          D (YES,,NO,%A1) QUICK OR WARM START?                    */ 00036000
*/*          S RBLDPLPA: REBUILD THE PLPA PAGE INFO                  */ 00037000
*/*          D (YES,,NO,%A1) WARM START?                             */ 00038000
*/*          S NEEDLOCL: LOCATE AND OPEN PREVIOUS LOCALS             */ 00039000
*/*%A1:      S OPENLOCL: OPEN ALL LOCAL DATA SETS                    */ 00040000
*/*          S TIMESTMP: TIMESTAMP TPARB, QSR, COMMON & DUPLEX       */ 00041000
*/*          S MOVEPCT: COPY PCT TO SQA                              */ 00042000
*/*          S BLDPART: BUILD PART FROM ILRTPARB                     */ 00043000
*/*          D (NO,,YES,%A3) COLD START?                             */ 00044000
*/*          S QSRTPARB: FREE QSR AND WRITE TPARB                    */ 00045000
*/*%A3:      S INITSART: BEGIN SWAP PROCESSING                       */ 00046000
*/*          D (YES,,NO,%A4) ANY SWAP DATA SETS?                     */ 00047000
*/*          S OPENSWAP: OPEN SWAP DATA SETS                         */ 00048000
*/*%A4:      S INITSCCW: BUILD SCCW'S                                */ 00049000
*/*          S LGVTSRB: INITIALIZE ILRLGVT AND SRB'S                 */ 00050000
*/*          S MSGBUF:  BUILD ASM MESSAGE BUFFERS                    */ 00051000
*/*          S BLDCELLS: BUILD CELLPOOLS AND INITIALIZE              */ 00052000
*/*          S LISTMSG: LIST PAGING DATA SETS FOR THIS IPL           */ 00053000
*/*          R RETURN TO IEAVNIPM                                    */ 00054000
*/*ILRASRIM: END                                                     */ 00055000
*                                                                  0165 00056000
*                                                                  0165 00057000
*/********************************************************************/ 00058000
*/*                                                                  */ 00059000
*/* RIMINIT: PRELIMINARY WORK IN ASM RIM                             */ 00060000
*/*                                                                  */ 00061000
*/* INPUT: ADDRESS OF NVT                                            */ 00062000
*/*        ADDRESS OF CVT                                            */ 00063000
*/*                                                                  */ 00064000
*/* PROCESS: INIT RIM PROCESS SWITCHES.  GETMAIN PARSE LIST          */ 00065000
*/*          (ILRDSTBL), 4K BUFFER, AREA FOR ILRTPARB(TEMPORARY      */ 00066000
*/*          PAGE DATA SET INFORMATION, AND ILRQSTCD(QUICK START     */ 00067000
*/*          RECORD).  PARSE PARAMETER STRINGS OF PAGNUM= AND        */ 00068000
*/*          PAGE=.  CHECK THAT PLPA AND COMMON DATA SETS WERE       */ 00069000
*/*          SPECIFIED. ALSO AT LEAST ONE LOCAL DATA SET IF COLD     */ 00070000
*/*          START.                                                  */ 00071000
*/*                                                                  */ 00072000
*/* OUTPUT: ILRDSTBL, BUFFER, ILRTPARB, AND ILRQSRCD AREAS           */ 00073000
*/*         ILRDSTBL CONTAINS PAGE DATA SET NAMES SPECIFIED AND      */ 00074000
*/*              THIRD ENTRY RESERVED FOR ANY DUPLEX DATA SET        */ 00075000
*/*         PAGE AND SWAP SPECIFIED EXPANSION NUMBERS                */ 00076000
*/*                                                                  */ 00077000
*/********************************************************************/ 00078000
*/*RIMINIT: CHART (SEQ)                                              */ 00079000
*/*HEADER                                                          0165 00080000
*/*  ILRASRIM                                                      0165 00081000
*/* RIMINIT: PRELIMINARY WORK IN ASM RIM                             */ 00082000
*/*RIMINIT: E ENTRY TO ASM RIM                                       */ 00083000
*/*         P ZERO PROCESS SWITCHES                                  */ 00084000
*/*         M LOAD ILROPS00 AND ILRPREAD MODULES                     */ 00085000
*/*         L UNCONDTIONAL GETMAIN FOR ILRDSTBL AND BUFFER           */ 00086000
*/*         S GGETMAIN: OBTAIN SPACE FOR ILRTPARB AND ILRQSRCD       */ 00087000
*/*         N WILL ZERO AREAS IF NECESSARY LATER                     */ 00088000
*/*%A1:     P CHARPTR POINT TO PAGNUM STRING                         */ 00089000
*/*         D (YES,,NO,%A2) CHARPTR IS ZERO?                         */ 00090000
*/*         P (,%A3) PAGE AND SWAP DEFAULT TO 1                      */ 00091000
*/*%A2:     D (NO,,YES,%A5) CHAR IS '('?                             */ 00092000
*/*%A4:     S ILRIMMSG: ISSUE MESSAGE IEA916E(PAGNUM)                */ 00093000
*/*         S (,%A1) NIPPRMPT: PROMPT OPERATOR FOR REPLY             */ 00094000
*/*%A5:     P NEXT CHAR                                              */ 00095000
*/*         P PAGE NUMBER STARTS AT CHARPTR                          */ 00096000
*/*         D (YES,,NO,%A4) CHAR SOME NUMBER?                        */ 00097000
*/*         P NEXT CHAR                                              */ 00098000
*/*         D (YES,,NO,%A8) CHAR A COMMA?                            */ 00099000
*/*         P (,%A9) PAGNUM LENGTH IS 1                              */ 00100000
*/*%A8:     D (YES,,NO,%A4) CHAR SOME NUMBER?                        */ 00101000
*/*         P PAGNUM LENGTH IS 2                                     */ 00102000
*/*         P NEXT CHAR                                              */ 00103000
*/*         D (YES,,NO,%A4) CHAR A COMMA?                            */ 00104000
*/*%A9:     P NEXT CHAR                                              */ 00105000
*/*         P SWAP NUMBER STARTS AT CHARPTR                          */ 00106000
*/*         D (YES,,NO,%A4) CHAR SOME NUMBER?                        */ 00107000
*/*         P NEXT CHAR                                              */ 00108000
*/*         D (YES,,NO,%A4) CHAR A ')'?                              */ 00109000
*/*         P NEXT CHAR                                              */ 00110000
*/*         D (YES,,NO,%A4) CHAR A QUOTE?                            */ 00111000
*/*         P PAGE AND SWAP NUMBERS SAVED                            */ 00112000
*/*%A3:     S PARSE: PARSE THE PAGE= PARAMETER INFO                  */ 00113000
*/*         D (YES,,NO,%A6) PLPA DATA SET SPECIFIED?                 */ 00114000
*/*         D (YES,,NO,%A6) COMMON DATA SET SPECIFIED?               */ 00115000
*/*         D (NO,,YES,%A7) WARM START?                              */ 00116000
*/*         D (NO,,YES,%A7) LOCAL DATA SET SPECIFIED?                */ 00117000
*/*%A6:     S ILRIMMSG: ISSUE MESSAGE IEA935W                        */ 00118000
*/*         R WAIT STATE 3C                                          */ 00119000
*/*%A7:     R FLOW CONTINUES AT OPENPLPA                             */ 00120000
*/*RIMINIT: END                                                      */ 00121000
*                                                                  0165 00122000
*                                                                  0165 00123000
*   /*****************************************************************/ 00124000
*   /*                                                               */ 00125000
*   /* RIMINIT                                                       */ 00126000
*   /*                                                               */ 00127000
*   /*****************************************************************/ 00128000
*                                                                  0165 00129000
*   STM(R2,R3,NIPPTRS);             /* STORE NVT AND CVT ADDRESSES   */ 00130000
         STM   R2,R3,NIPPTRS                                       0165 00131000
*   IF NVTFLQS=NO THEN                                             0166 00132000
         L     @08,NVTPTR                                          0166 00133000
         TM    NVTFLQS(@08),B'00001000'                            0166 00134000
         BNZ   @RF00166                                            0166 00135000
*     NVTFLWS=NO;                   /* CLPA IMPLIES CVIO             */ 00136000
         NI    NVTFLWS(@08),B'11111011'                            0167 00137000
*   ASMBURST=BURSTIME;              /* BURST TIME SET FOR ALL OF ASM */ 00138000
@RF00166 L     @08,CVTPTR                                          0168 00139000
         L     @08,ASMVTPTR(,@08)                                  0168 00140000
         MVC   ASMBURST(4,@08),@CF02525                            0168 00141000
*/* ASMPCMPD=ASMPCMPD | MASK;    -- THIS INSTRUCTION WAS DELETED IN  */ 00142000
*/* SUPPORT OF APAR  AZ25620                                 @ZA25907*/ 00143000
*                                                                  0169 00144000
*   DVTPTR=ADDR(DVTAB);             /* ADDRESS DEVICE TABLE          */ 00145000
         LA    DVTPTR,DVTAB                                        0169 00146000
*   PRMTBPTR=NVTPTAB;               /* ADDRESS THE PARMTAB           */ 00147000
         L     @08,NVTPTR                                          0170 00148000
         L     @08,NVTPTAB(,@08)                                   0170 00149000
         ST    @08,PRMTBPTR                                        0170 00150000
*   RFY                                                            0171 00151000
*     R0 RSTD;                                                     0171 00152000
*                                                                  0171 00153000
*/*      LOAD ILROPS00 AND ILRPREAD                                  */ 00154000
*                                                                  0172 00155000
*   DO;                             /* LOAD EP('ILROPS00')           */ 00156000
*     RESPECIFY                                                    0173 00157000
*      (GPR00P,                                                    0173 00158000
*       GPR01P) RESTRICTED;                                        0173 00159000
*     GPR00P=ADDR('ILROPS00');      /* LOAD ENTRY POINT NAME ADDRESS */ 00160000
         LA    GPR00P,@CC02762                                     0174 00161000
*     GPR01P=0;                     /* JOBLIB OR LINKLIB DCB         */ 00162000
         SLR   GPR01P,GPR01P                                       0175 00163000
*     SVC(8);                       /* ISSUE LOAD SVC                */ 00164000
         SVC   8                                                   0176 00165000
*     RESPECIFY                                                    0177 00166000
*      (GPR00P,                                                    0177 00167000
*       GPR01P) UNRESTRICTED;                                      0177 00168000
*   END;                            /* LOAD EP('ILROPS00')           */ 00169000
*   OPENPTR=R0;                     /* ILROPS00 LOADED               */ 00170000
         ST    R0,OPENPTR                                          0179 00171000
*   DO;                             /* LOAD EP('ILRPREAD')           */ 00172000
*     RESPECIFY                                                    0181 00173000
*      (GPR00P,                                                    0181 00174000
*       GPR01P) RESTRICTED;                                        0181 00175000
*     GPR00P=ADDR('ILRPREAD');      /* LOAD ENTRY POINT NAME ADDRESS */ 00176000
         LA    GPR00P,@CC02764                                     0182 00177000
*     GPR01P=0;                     /* JOBLIB OR LINKLIB DCB         */ 00178000
         SLR   GPR01P,GPR01P                                       0183 00179000
*     SVC(8);                       /* ISSUE LOAD SVC                */ 00180000
         SVC   8                                                   0184 00181000
*     RESPECIFY                                                    0185 00182000
*      (GPR00P,                                                    0185 00183000
*       GPR01P) UNRESTRICTED;                                      0185 00184000
*   END;                            /* LOAD EP('ILRPREAD')           */ 00185000
*   RDWTPTR=R0;                     /* ILRPREAD LOADED               */ 00186000
         ST    R0,RDWTPTR                                          0187 00187000
*/*   GETMAIN ILRTPARB,ILRQSRCD,BUFFER, AND ILRDSTBL ON 4K BOUNDARY  */ 00188000
*/*      (BUFFER TO READ AND WRITE TO COMMON AND DUPLEX DATA SETS)   */ 00189000
*                                                                  0188 00190000
*   R0=LENGTH(TPARTBLE)+LENGTH(QSR)+FOURK+LENGTH(DSTBL);/* LENGTH    */ 00191000
         L     R0,@CF02877                                         0188 00192000
*   CALL GGETMAIN;                  /* TPARB AND QSR AREA            */ 00193000
         BAL   @14,GGETMAIN                                        0189 00194000
*   TPARPTR=R1;                     /* FIRST PART OF AREA IS ILRTPARB*/ 00195000
         ST    R1,TPARPTR                                          0190 00196000
*   QSRPTR=TPARPTR+LENGTH(TPARTBLE);/* NEXT IS ILRQSRCD              */ 00197000
         L     @08,TPARPTR                                         0191 00198000
         AL    @08,@CF02873                                        0191 00199000
         ST    @08,QSRPTR                                          0191 00200000
*   BUFFPTR=QSRPTR+LENGTH(QSR);     /* NEXT IS BUFFER                */ 00201000
         AL    @08,@CF02874                                        0192 00202000
         ST    @08,BUFFPTR                                         0192 00203000
*   DSTBLPTR=BUFFPTR+FOURK;         /* REST IS ILRDSTBL(WORKAREA)    */ 00204000
         AL    @08,@CF02516                                        0193 00205000
         ST    @08,DSTBLPTR                                        0193 00206000
*   RFY                                                            0194 00207000
*     R0 UNRSTD;                                                   0194 00208000
*                                                                  0195 00209000
*   /*****************************************************************/ 00210000
*   /*                                                               */ 00211000
*   /* PARSE PAGNUM PARAMETER                                        */ 00212000
*   /*                                                               */ 00213000
*   /*****************************************************************/ 00214000
*                                                                  0195 00215000
*   DO UNTIL PROBLEM=NO;            /* GET GOOD PAGNUM INFO          */ 00216000
@DL00195 DS    0H                                                  0196 00217000
*     PAGEZONE=''B;                 /* CLEAR AREA FOR PAGE #         */ 00218000
         XC    PAGEZONE(2),PAGEZONE                                0196 00219000
*     SWAPZONE=''B;                 /* CLEAR AREA FOR SWAP #         */ 00220000
         XC    SWAPZONE(2),SWAPZONE                                0197 00221000
*     PAGEQPTR=ADDR(PAGNUM);        /* GET PAGNUM PARM ADDRESS       */ 00222000
         L     @08,PRMTBPTR                                        0198 00223000
         LA    @08,PAGNUM(,@08)                                    0198 00224000
         ST    @08,PAGEQPTR                                        0198 00225000
*     CHARPTR=PGSTRNGP;             /* GET PAGNUM STRING ADDRESS     */ 00226000
         L     CHARPTR,PGSTRNGP(,@08)                              0199 00227000
*     PROBLEM=NO;                   /* TO FLAG ERRORS                */ 00228000
         NI    PROBLEM,B'11011111'                                 0200 00229000
*     IF CHARPTR=ZERO THEN                                         0201 00230000
         LTR   CHARPTR,CHARPTR                                     0201 00231000
         BNZ   @RF00201                                            0201 00232000
*       DO;                         /* NONE SPECIFIED?               */ 00233000
*         PAGEEXP=ONE;              /* DEFAULT EXPANSION IS ONE      */ 00234000
         LA    @08,1                                               0203 00235000
         STH   @08,PAGEEXP                                         0203 00236000
*         SWAPEXP=ONE;              /* DEFAULT EXPANSION IS ONE      */ 00237000
         STH   @08,SWAPEXP                                         0204 00238000
*       END;                        /* NONE SPECIFIED                */ 00239000
*     ELSE                                                         0206 00240000
*       DO;                         /* PAGNUM WAS SPECIFIED          */ 00241000
         B     @RC00201                                            0206 00242000
@RF00201 DS    0H                                                  0207 00243000
*         IF PTCHAR=LEFTPAR THEN                                   0207 00244000
         CLI   PTCHAR(CHARPTR),C'('                                0207 00245000
         BNE   @RF00207                                            0207 00246000
*           DO;                     /* 1ST CHAR IS '('?              */ 00247000
*             CHARPTR=CHARPTR+ONE;  /* SCAN ON                       */ 00248000
         LA    @08,1                                               0209 00249000
         ALR   CHARPTR,@08                                         0209 00250000
*             PAGEPTR=CHARPTR;      /* EXPECT PAGE EXPANSION #       */ 00251000
         LR    PAGEPTR,CHARPTR                                     0210 00252000
*             IF PTCHAR>='0'&PTCHAR<='9' THEN                      0211 00253000
         CLI   PTCHAR(CHARPTR),C'0'                                0211 00254000
         BL    @RF00211                                            0211 00255000
         CLI   PTCHAR(CHARPTR),C'9'                                0211 00256000
         BH    @RF00211                                            0211 00257000
*               DO;                 /* NUMBER?                       */ 00258000
*                 CHARPTR=CHARPTR+ONE;/* SCAN ON                     */ 00259000
         ALR   CHARPTR,@08                                         0213 00260000
*                 IF PTCHAR^=COMMA THEN                            0214 00261000
         CLI   PTCHAR(CHARPTR),C','                                0214 00262000
         BE    @RF00214                                            0214 00263000
*                   DO;             /* NOT END OF PAGE EXPAN?        */ 00264000
*                     IF PTCHAR>='0'&PTCHAR<='9' THEN              0216 00265000
         CLI   PTCHAR(CHARPTR),C'0'                                0216 00266000
         BL    @RF00216                                            0216 00267000
         CLI   PTCHAR(CHARPTR),C'9'                                0216 00268000
         BH    @RF00216                                            0216 00269000
*                       DO;         /* NUMBER?                       */ 00270000
*                         CHARPTR=CHARPTR+ONE;/* SCAN ON             */ 00271000
         ALR   CHARPTR,@08                                         0218 00272000
*                         IF PTCHAR=COMMA THEN/* END OF PAGE EXPAN   */ 00273000
         CLI   PTCHAR(CHARPTR),C','                                0219 00274000
         BNE   @RF00219                                            0219 00275000
*                           PAGEZONE=PAGEPTR->EXPAN;/* GET NUMBER    */ 00276000
         MVC   PAGEZONE(2),EXPAN(PAGEPTR)                          0220 00277000
*                         ELSE                                     0221 00278000
*                           PROBLEM=YES;/* NOT END AFTER 2 NUMBERS   */ 00279000
         B     @RC00219                                            0221 00280000
@RF00219 OI    PROBLEM,B'00100000'                                 0221 00281000
*                       END;        /* NUMBER                        */ 00282000
*                     ELSE                                         0223 00283000
*                       PROBLEM=YES;/* NOT EXPECTED NUMBER           */ 00284000
         B     @RC00216                                            0223 00285000
@RF00216 OI    PROBLEM,B'00100000'                                 0223 00286000
*                   END;            /* NOT END OF PAGE EXPAN         */ 00287000
*                 ELSE                                             0225 00288000
*                   PAGEZONE(2)=PAGEPTR->EXPAN(1);/* GET 1 CHAR    0225 00289000
*                                      NUMBER                        */ 00290000
         B     @RC00214                                            0225 00291000
@RF00214 MVC   PAGEZONE+1(1),EXPAN(PAGEPTR)                        0225 00292000
*               END;                /* NUMBER                        */ 00293000
*             ELSE                                                 0227 00294000
*               PROBLEM=YES;        /* NOT EXPECTED NUMBER           */ 00295000
         B     @RC00211                                            0227 00296000
@RF00211 OI    PROBLEM,B'00100000'                                 0227 00297000
*           END;                    /* 1ST CHAR IS '('               */ 00298000
*         ELSE                                                     0229 00299000
*           PROBLEM=YES;            /* 1ST CHAR NOT AS EXPECTED      */ 00300000
         B     @RC00207                                            0229 00301000
@RF00207 OI    PROBLEM,B'00100000'                                 0229 00302000
*         IF PROBLEM=NO THEN                                       0230 00303000
@RC00207 TM    PROBLEM,B'00100000'                                 0230 00304000
         BNZ   @RF00230                                            0230 00305000
*           DO;                     /* PAGEEXP O.K.?                 */ 00306000
*             CHARPTR=CHARPTR+ONE;  /* SCAN ON                       */ 00307000
         LA    @08,1                                               0232 00308000
         ALR   CHARPTR,@08                                         0232 00309000
*             SWAPPTR=CHARPTR;      /* EXPECT SWAP NUMBER HERE       */ 00310000
         LR    SWAPPTR,CHARPTR                                     0233 00311000
*             IF PTCHAR>='0'&PTCHAR<='9' THEN                      0234 00312000
         CLI   PTCHAR(CHARPTR),C'0'                                0234 00313000
         BL    @RF00234                                            0234 00314000
         CLI   PTCHAR(CHARPTR),C'9'                                0234 00315000
         BH    @RF00234                                            0234 00316000
*               DO;                 /* NUMBER?                       */ 00317000
*                 CHARPTR=CHARPTR+ONE;/* SCAN ON                     */ 00318000
         ALR   CHARPTR,@08                                         0236 00319000
*                 IF PTCHAR=RIGHTPAR THEN                          0237 00320000
         CLI   PTCHAR(CHARPTR),C')'                                0237 00321000
         BNE   @RF00237                                            0237 00322000
*                   DO;             /* RIGHT PAREN?                  */ 00323000
*                     CHARPTR=CHARPTR+ONE;/* NEXT CHAR               */ 00324000
         ALR   CHARPTR,@08                                         0239 00325000
*                     IF PTCHAR=QUOTE THEN/* STRING SYNTAX IS O.K.   */ 00326000
         CLI   PTCHAR(CHARPTR),C''''                               0240 00327000
         BNE   @RF00240                                            0240 00328000
*                       SWAPZONE(2)=SWAPPTR->EXPAN(1);/* GET SWAP  0241 00329000
*                                      NUMBER                        */ 00330000
         MVC   SWAPZONE+1(1),EXPAN(SWAPPTR)                        0241 00331000
*                     ELSE                                         0242 00332000
*                       PROBLEM=YES;/* NOT END                       */ 00333000
         B     @RC00240                                            0242 00334000
@RF00240 OI    PROBLEM,B'00100000'                                 0242 00335000
*                   END;            /* RIGHT PAREN                   */ 00336000
*                 ELSE                                             0244 00337000
*                   PROBLEM=YES;    /* NOT ')' AS EXPECTED           */ 00338000
         B     @RC00237                                            0244 00339000
@RF00237 OI    PROBLEM,B'00100000'                                 0244 00340000
*               END;                /* NUMBER                        */ 00341000
*             ELSE                                                 0246 00342000
*               PROBLEM=YES;        /* NOT SWAP NUMBER AS EXPECTED   */ 00343000
         B     @RC00234                                            0246 00344000
@RF00234 OI    PROBLEM,B'00100000'                                 0246 00345000
*           END;                    /* PAGEEXP O.K.                  */ 00346000
*         ELSE                                                     0248 00347000
*           ;                       /* SOME PROBLEM, PASS IT ON      */ 00348000
@RF00230 DS    0H                                                  0249 00349000
*         IF PROBLEM=YES THEN                                      0249 00350000
@RC00230 TM    PROBLEM,B'00100000'                                 0249 00351000
         BNO   @RF00249                                            0249 00352000
*           DO;                     /* ANY PROBLEMS IN PAGE OR SWAP     00353000
*                                      SCAN?                         */ 00354000
*/*     PROMPT OPER TO RESPECIFY THE PAGNUM PARAMETER  AFTER MESSAGE */ 00355000
*                                                                  0251 00356000
*             FLAGS=PAGEN;          /* PAGENUM IN MESSAGE            */ 00357000
         MVI   FLAGS,X'10'                                         0251 00358000
*             MSGID=M916E;          /* SYNTAX ERROR IN PARAMETER     */ 00359000
         MVC   MSGID(4),@CC02545                                   0252 00360000
*             R1=ADDR(MSGPL);       /* PARMS TO ILRIMMSG             */ 00361000
         LA    R1,MSGPL                                            0253 00362000
*             CALL ILRIMMSG;        /* MESSAGE MODULE                */ 00363000
         L     @15,@CV02592                                        0254 00364000
         BALR  @14,@15                                             0254 00365000
*             RFY                                                  0255 00366000
*              (R2,                                                0255 00367000
*               R3) RSTD;                                          0255 00368000
*             LM(R2,R3,NIPPTRS);    /* NEEDED BY NIP PROMPT          */ 00369000
         LM    R2,R3,NIPPTRS                                       0256 00370000
*             GEN REFS(NIPPTRS,NVTPRMPT,PAGNUMPM) SETS(PAGNUM);    0257 00371000
*                                                 /* CALL NIP PROMPT*/  00372000
    IEAPMNIP TYPE=PRMPT,PARAM=PAGNUMPM,OPT=ERROR                        00373000
*             RFY                                                  0258 00374000
*              (R2,                                                0258 00375000
*               R3) UNRSTD;                                        0258 00376000
*           END;                    /* END PROMPTPN                  */ 00377000
*         ELSE                                                     0260 00378000
*           DO;                     /* NO PROBLEMS, CONVERT NUMBERS  */ 00379000
         B     @RC00249                                            0260 00380000
@RF00249 DS    0H                                                  0261 00381000
*             PACK(WORKAREA,PAGEZONE);/* PACKED DECIMAL              */ 00382000
         PACK  WORKAREA(8),PAGEZONE(2)                             0261 00383000
*             CVB(PAGEEXP,WORKAREA);/* BINARY NUMBER                 */ 00384000
         CVB   @08,WORKAREA                                        0262 00385000
         STH   @08,PAGEEXP                                         0262 00386000
*             PACK(WORKAREA,SWAPZONE);/* PACKED DECIMAL              */ 00387000
         PACK  WORKAREA(8),SWAPZONE(2)                             0263 00388000
*             CVB(SWAPEXP,WORKAREA);/* BINARY NUMBER                 */ 00389000
         CVB   @08,WORKAREA                                        0264 00390000
         STH   @08,SWAPEXP                                         0264 00391000
*           END;                    /* NO PROBLEMS                   */ 00392000
*       END;                        /* PAGNUM WAS SPECIFIED          */ 00393000
@RC00249 DS    0H                                                  0267 00394000
*   END;                            /* GET GOOD PAGNUM INFO          */ 00395000
@RC00201 DS    0H                                                  0267 00396000
@DE00195 TM    PROBLEM,B'00100000'                                 0267 00397000
         BNZ   @DL00195                                            0267 00398000
*                                                                  0268 00399000
*/*     SET UP ENTRY POINTERS                                        */ 00400000
*                                                                  0268 00401000
*   PLPTPTR=ADDR(TPARPENT(PARTPLPN+ONE));/* PLPA ENTRY IN TPARB      */ 00402000
         L     @08,TPARPTR                                         0268 00403000
         LA    @03,TPARPENT(,@08)                                  0268 00404000
         ST    @03,PLPTPTR                                         0268 00405000
*   COMTPTR=ADDR(TPARPENT(PARTCOMN+ONE));/* COMMON ENTRY IN TPARB    */ 00406000
         LA    @03,TPARPENT+96(,@08)                               0269 00407000
         ST    @03,COMTPTR                                         0269 00408000
*   DPLTPTR=ADDR(TPARPENT(PARTDUPN+ONE));/* DUPLEX ENTRY IN TPARB    */ 00409000
         LA    @03,TPARPENT+192(,@08)                              0270 00410000
         ST    @03,DPLTPTR                                         0270 00411000
*   LOCTPTR=ADDR(TPARPENT(PARTLOCN+ONE));/* 1ST LOCAL IN TPARB       */ 00412000
         LA    @08,TPARPENT+288(,@08)                              0271 00413000
         ST    @08,LOCTPTR                                         0271 00414000
*   PLPAPTR=ADDR(DSTBENT(PARTPLPN+ONE));/* PLPA ENTRY IN ILRDSTBL    */ 00415000
         L     @08,DSTBLPTR                                        0272 00416000
         LR    PLPAPTR,@08                                         0272 00417000
*   COMMPTR=ADDR(DSTBENT(PARTCOMN+ONE));/* COMMON ENTRY IN ILRDSTBL  */ 00418000
         LA    @03,DSTBENT+48(,@08)                                0273 00419000
         ST    @03,COMMPTR                                         0273 00420000
*   DUPLPTR=ADDR(DSTBENT(PARTDUPN+ONE));/* DUPLEX ENTRY IN ILRDSTBL  */ 00421000
         LA    @03,DSTBENT+96(,@08)                                0274 00422000
         ST    @03,DUPLPTR                                         0274 00423000
*   LOCLPTR=ADDR(DSTBENT(PARTLOCN+ONE));/* 1ST LOCAL IN ILRDSTBL     */ 00424000
*                                                                  0275 00425000
         LA    @08,DSTBENT+144(,@08)                               0275 00426000
         ST    @08,LOCLPTR                                         0275 00427000
*   /*****************************************************************/ 00428000
*   /*                                                               */ 00429000
*   /* PROCESS THE PAGE DATA SET NAMES STRINGS                       */ 00430000
*   /*                                                               */ 00431000
*   /*****************************************************************/ 00432000
*                                                                  0276 00433000
*   CALL PARSE;                     /* PARSE PAGE DATA SET NAMES     */ 00434000
         BAL   @14,PARSE                                           0276 00435000
*/*    CHECK FOR NECESSARY DATA SETS SPECIFIED                       */ 00436000
*/*        PLPA, COMMON,(AND LOCAL, IF NOT WARM START)               */ 00437000
*                                                                  0277 00438000
*   IF PLPAPTR->DSTDSNC=0|COMMPTR->DSTDSNC=0|(NVTFLWS=OFF&LOCLPTR->     00439000
*       DSTDSNC=0) THEN                                            0277 00440000
         CLI   DSTDSNC(PLPAPTR),0                                  0277 00441000
         BE    @RT00277                                            0277 00442000
         L     @08,COMMPTR                                         0277 00443000
         CLI   DSTDSNC(@08),0                                      0277 00444000
         BE    @RT00277                                            0277 00445000
         L     @08,NVTPTR                                          0277 00446000
         TM    NVTFLWS(@08),B'00000100'                            0277 00447000
         BNZ   @RF00277                                            0277 00448000
         L     @08,LOCLPTR                                         0277 00449000
         CLI   DSTDSNC(@08),0                                      0277 00450000
         BNE   @RF00277                                            0277 00451000
@RT00277 DS    0H                                                  0278 00452000
*     DO;                           /* PROBLEMS?                     */ 00453000
*       MSGID=M935W;                /* TERMINATE IPL                 */ 00454000
         MVC   MSGID(4),@CC02567                                   0279 00455000
*       R1=ADDR(MSGPL);             /* PARM TO ILRIMMSG              */ 00456000
         LA    R1,MSGPL                                            0280 00457000
*       CALL ILRIMMSG;              /* MESSAGE MODULE                */ 00458000
         L     @15,@CV02592                                        0281 00459000
         BALR  @14,@15                                             0281 00460000
*     END;                                                         0282 00461000
*   ELSE                                                           0283 00462000
*     ;                                                            0283 00463000
@RF00277 DS    0H                                                  0284 00464000
*                                                                  0284 00465000
*/********************************************************************/ 00466000
*/*                                                                  */ 00467000
*/* OPENPLPA: SEGMENT TO OPEN THE PLPA DATA SET. IF NECESSARY, READ  */ 00468000
*/*           ILRTPARB AND ILRQSRCD FROM IT. AND PREPARE THESE       */ 00469000
*/*           CONTROL BLOCKS FOR THIS IPL CONDITIONS.                */ 00470000
*/*                                                                  */ 00471000
*/* INPUT: OUTPUT OF RIMINIT                                         */ 00472000
*/*                                                                  */ 00473000
*/* PROCESS: ON PLPA OPEN, STOP IPL IF OPERATOR REPLIES 'IGNORE'     */ 00474000
*/*          TO RESPECIFICATION OR IF TPARPATS SUBROUTINE FAILS.     */ 00475000
*/*             USE ILRPREAD TO READ FIRST 6 SLOTS ON PLPA DATA SET, */ 00476000
*/*          IF QUICK OR WARM START.  THESE SLOTS ARE THE PREVIOUS   */ 00477000
*/*          ILRTPARB (2 SLOTS) AND ILRQSRCD (4 SLOTS)               */ 00478000
*/*          RESPECTIVELY.  THE AREAS ARE MODIFIED FOR THIS IPL      */ 00479000
*/*          OR, IF COLD START, INITIALIZED.                         */ 00480000
*/*                                                                  */ 00481000
*/* OUTPUT: PLPA DATA SET- OPEN AND ILRPAT BUILT FOR IT              */ 00482000
*/*         ILRTPARB- ANY PREVIOUS ENTRIES, MODIFIED FLAGS           */ 00483000
*/*                   PLPA ENTRY COMPLETELY FILLED IN                */ 00484000
*/*         ILRQSRCD- IS AS IN PREVIOUS IPL OR HEADER INITIALIZED    */ 00485000
*/*                                                                  */ 00486000
*/********************************************************************/ 00487000
*/*OPENPLPA: CHART (SEQ)                                             */ 00488000
*/*HEADER                                                          0284 00489000
*/*  OPENPLPA SEGMENT                                                */ 00490000
*/*OPENPLPA: E ENTRY TO OPEN AND POSSIBLY READ PLPA                  */ 00491000
*/*%A2:      P USE FIRST ILRDSTBL ENTRY (PLPA)                       */ 00492000
*/*          S OPEN: OPEN PLPA DATA SET                              */ 00493000
*/*          D (NO,,YES,%A9) SUCCESSFUL OPEN?                        */ 00494000
*/*          D (YES,,NO,%A1) MOUNT FAIL?                             */ 00495000
*/*          S ILRIMMSG: ISSUE MOUNT MESSAGE                         */ 00496000
*/*          D (YES,,NO,%A2) OPERATOR REPLY 'IGNORE'?                */ 00497000
*/*          S OPENA: ASK FOR NEW NAME                               */ 00498000
*/*          D (YES,,NO,%A2) IGNORE ON NEW NAME?                     */ 00499000
*/*%A3:      S ILRIMMSG: ISSUE MESSAGE IEA935W                       */ 00500000
*/*          R WAIT STATE 3C                                         */ 00501000
*/*%A1:      N LOCATE FAILED                                         */ 00502000
*/*          S OPENA: ASK FOR NEW NAME                               */ 00503000
*/*          D (NO,,YES,%A3) IGNORE LOCATE FAILURE?                  */ 00504000
*/*          N (,%A2) GIVEN NEW NAME                                 */ 00505000
*/*%A9:      D (YES,,NO,%A5) QUICK OR WARM START?                    */ 00506000
*/*          P DUMMY PART ENTRY WITH UCB, IORB, AND EDB              */ 00507000
*/*          S ILRPREAD: READ PLPA GIVEN DUMMY PART                  */ 00508000
*/*          D (NO,,YES,%A6) READ O.K.?                              */ 00509000
*/*          S ILRIMMSG: ISSUE MESSAGE TO RE-IPL OR CONT.            */ 00510000
*/*          N IF RE-IPL NO CONTROL IS RETURNED                      */ 00511000
*/*          S ILRIMMSG: ISSUE FORCE COLD START MESSAGE              */ 00512000
*/*          P (,%A5) CHANGE NVT IPL FLAGS TO COLD                   */ 00513000
*/*%A6:      P MOVE PLPA RANGE FROM QSR TO NVT                       */ 00514000
*/*          P ZERO SOME HEADER COUNTS IN ILRTPARB                   */ 00515000
*/*          P EACH ACTIVE ILRTPARB ENTRY, MARK PREVIOUS IPL FLAG    */ 00516000
*/*          D (YES,,NO,%A7) DUPLEX DATA SET NAME?                   */ 00517000
*/*          P MARK ASMVT AS DUPLEXING IPL                           */ 00518000
*/*          P MARK ENTRY NOT TO BE SKIPPED                          */ 00519000
*/*%A7:      D (YES,,NO,%A8) QUICK START?                            */ 00520000
*/*          P ZERO ALL LOCAL ENTRIES                                */ 00521000
*/*          P (,%A8) CHANGE ENTRY USE COUNT TO 3                    */ 00522000
*/*%A5:      N COLD START PROCESSING                                 */ 00523000
*/*          P ZERO ILRTPARB                                         */ 00524000
*/*          P FILL IN BLOCK ID, USE COUNT AT 3, PLPA NAME           */ 00525000
*/*          P ZERO ILRQSRCD HEADER AND FILL IN ID                   */ 00526000
*/*%A8:      N QUICK AND WARM PROCESSING COMMON TO COLD              */ 00527000
*/*          S TPARPATS: FILL IN PLPA ENTRY AND ILRPAT               */ 00528000
*/*          D (YES,,NO,%A3) O.K.?                                   */ 00529000
*/*          S MARKPAT: MARK PLPA PAT--6 SLOTS                       */ 00530000
*/*          N SLOTS THAT CONTAIN ILRTPARB AND ILRQSRCD              */ 00531000
*/*          P SET PLPA USE COUNT TO 6                               */ 00532000
*/*          P PAGE EXPAND NUMBER IN ILRTPARB                        */ 00533000
*/*          R FLOW CONTINUES AT OPENDPLX                            */ 00534000
*/*OPENPLPA: END                                                     */ 00535000
*                                                                  0284 00536000
*                                                                  0284 00537000
*   /*****************************************************************/ 00538000
*   /*                                                               */ 00539000
*   /* OPENPLPA                                                      */ 00540000
*   /*                                                               */ 00541000
*   /*****************************************************************/ 00542000
*                                                                  0284 00543000
*   TPAEPTR=PLPTPTR;                /* PLPA ENTRY IN ILRTPARB        */ 00544000
         L     @08,PLPTPTR                                         0284 00545000
         ST    @08,TPAEPTR                                         0284 00546000
*   DSTEPTR=PLPAPTR;                /* PLPA ENTRY IN ILRDSTBL        */ 00547000
         LR    DSTEPTR,PLPAPTR                                     0285 00548000
*REDOPLPA:                                                         0286 00549000
*   PARMDSN=DSTDSN;                 /* PLPA DSN IN OPS PARMLIST      */ 00550000
REDOPLPA MVC   PARMDSN(44),DSTDSN(DSTEPTR)                         0286 00551000
*   PARMFLG=PARMPG;                 /* FLAG AS REGULAR PAGE          */ 00552000
         MVI   PARMFLG,X'80'                                       0287 00553000
*   RFY                                                            0288 00554000
*     R15 RSTD;                                                    0288 00555000
*   CALL OPEN;                      /* OPEN SUBROUTINE PLPA          */ 00556000
         BAL   @14,OPEN                                            0289 00557000
*   IF R15^=ZERO THEN               /* NOT SUCCESSFUL?               */ 00558000
         LTR   R15,R15                                             0290 00559000
         BZ    @RF00290                                            0290 00560000
*     DO;                                                          0291 00561000
*       IF R15=NOVOLMNT THEN        /* MOUNT FAILURE?                */ 00562000
         C     R15,@CF00056                                        0292 00563000
         BNE   @RF00292                                            0292 00564000
*         DO;                                                      0293 00565000
*           MSGDATA1=ADDR(VOLSER);  /* VOL SER RETURNED ILROPS00     */ 00566000
         LA    @14,PARMDSN                                         0294 00567000
         LA    @14,VOLSER(,@14)                                    0294 00568000
         ST    @14,MSGDATA1                                        0294 00569000
*           MSGID=M924D;            /* PLEASE MOUNT PACK             */ 00570000
         MVC   MSGID(4),@CC02557                                   0295 00571000
*           FLAGS=PLPAEQ;           /* MSG TYPE FOR PLPA             */ 00572000
         MVI   FLAGS,X'04'                                         0296 00573000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 00574000
         LA    R1,MSGPL                                            0297 00575000
*           CALL ILRIMMSG;          /* MESSAGE MODULE                */ 00576000
         L     @15,@CV02592                                        0298 00577000
         BALR  @14,@15                                             0298 00578000
*           IF R1->MSGBUF(1:LENGTH(IGNORE))=IGNORE THEN            0299 00579000
         CLC   MSGBUF(6,R1),@CC02477                               0299 00580000
         BNE   @RF00299                                            0299 00581000
*             DO;                   /* OPER SAY TO IGNORE MOUNT?     */ 00582000
*               CALL OPENA;         /* REQUEST NEW NAME              */ 00583000
         BAL   @14,OPENA                                           0301 00584000
*               IF R15=IGNORVOL THEN                               0302 00585000
         C     R15,@CF00069                                        0302 00586000
         BNE   @RF00302                                            0302 00587000
*                 DO;               /* WAIT STATE SYSTEM             */ 00588000
*                   MSGID=M935W;    /* MISSING RESOURCE              */ 00589000
         MVC   MSGID(4),@CC02567                                   0304 00590000
*                   R1=ADDR(MSGPL); /* PARM TO ILRIMMSG              */ 00591000
         LA    R1,MSGPL                                            0305 00592000
*                   CALL ILRIMMSG;  /* WAIT STATE                    */ 00593000
         L     @15,@CV02592                                        0306 00594000
         BALR  @14,@15                                             0306 00595000
*                 END;              /* WAIT STATE SYSTEM             */ 00596000
*               ELSE                                               0308 00597000
*                 GOTO REDOPLPA;    /* NEW NAME, TRY OPEN            */ 00598000
*             END;                  /* END IGNORE TO MOUNT           */ 00599000
*           ELSE                                                   0310 00600000
*             GOTO REDOPLPA;        /* TRY TO OPEN AGAIN             */ 00601000
*         END;                      /* END MOUNT FAILURE             */ 00602000
*       ELSE                                                       0312 00603000
*         DO;                       /* LOCATE FAILURE                */ 00604000
         B     @RC00292                                            0312 00605000
@RF00292 DS    0H                                                  0313 00606000
*           CALL OPENA;             /* REQUEST NEW NAME              */ 00607000
         BAL   @14,OPENA                                           0313 00608000
*           IF R15=IGNORVOL THEN    /* OPER SAYS IGNORE LOCATE?      */ 00609000
         C     R15,@CF00069                                        0314 00610000
         BNE   @RF00314                                            0314 00611000
*             DO;                                                  0315 00612000
*               RFY                                                0316 00613000
*                 R15 UNRSTD;                                      0316 00614000
*               MSGID=M935W;        /* MISSING RESOURCES             */ 00615000
         MVC   MSGID(4),@CC02567                                   0317 00616000
*               R1=ADDR(MSGPL);     /* PARM TO ILROPS00              */ 00617000
         LA    R1,MSGPL                                            0318 00618000
*               CALL ILRIMMSG;      /* WAIT STATE                    */ 00619000
         L     @15,@CV02592                                        0319 00620000
         BALR  @14,@15                                             0319 00621000
*             END;                  /* IGNORE LOCATE FAILURE         */ 00622000
*           ELSE                                                   0321 00623000
*             GOTO REDOPLPA;        /* NEW UNIQUE NAME TO OPEN       */ 00624000
*         END;                      /* END LOCATE FAILURE            */ 00625000
*     END;                          /* NOT SUCCESSFUL                */ 00626000
*   ELSE                                                           0324 00627000
*     ;                             /* OPENED SUCCESSFULLY           */ 00628000
@RF00290 DS    0H                                                  0325 00629000
*   IF NVTFLQS=YES THEN             /* QUICK OR WARM START?          */ 00630000
@RC00290 L     @08,NVTPTR                                          0325 00631000
         TM    NVTFLQS(@08),B'00001000'                            0325 00632000
         BNO   @RF00325                                            0325 00633000
*     DO;                                                          0326 00634000
*                                                                  0326 00635000
*/*       PREPARE FOR ILRPREAD                                       */ 00636000
*                                                                  0327 00637000
*       PAREPTR=BUFFPTR;            /* USE BUFFER FOR DUMMY PARE     */ 00638000
         L     PAREPTR,BUFFPTR                                     0327 00639000
*       PAREEDBP=RTNEDBP;           /* PLPA EDB FROM ILROPS00        */ 00640000
         LA    @08,PARMDSN                                         0328 00641000
         L     @06,RTNEDBP(,@08)                                   0328 00642000
         ST    @06,PAREEDBP(,PAREPTR)                              0328 00643000
*       PAREUCBP=RTNUCBP;           /* PLPA UCB FROM ILROPS00        */ 00644000
         L     @08,RTNUCBP(,@08)                                   0329 00645000
         ST    @08,PAREUCBP(,PAREPTR)                              0329 00646000
*       PWRITE=OFF;                 /* DO A READ                     */ 00647000
*       PTPARB=OFF;                 /* USE A DUMMY PART ENTRY        */ 00648000
         NI    PWRITE,B'00111111'                                  0331 00649000
*       PSLOTNO=(LENGTH(TPARTBLE)+LENGTH(QSR))/FOURK;/* # OF SLOTS   */ 00650000
         MVI   PSLOTNO,X'06'                                       0332 00651000
*       PSLOT=''B;                  /* RELATIVE SLOT TO START        */ 00652000
         SLR   @08,@08                                             0333 00653000
         STH   @08,PSLOT                                           0333 00654000
*       PENTRY=PAREPTR;             /* ADDR OF PART ENTRY            */ 00655000
         ST    PAREPTR,PENTRY                                      0334 00656000
*       PBUFF=TPARPTR;              /* READ INTO TPAR AND QSR        */ 00657000
         L     @08,TPARPTR                                         0335 00658000
         ST    @08,PBUFF                                           0335 00659000
*       R1=ADDR(READPARM);          /* PARM TO ILRPREAD              */ 00660000
         LA    R1,READPARM                                         0336 00661000
*       RFY                                                        0337 00662000
*         R15 RSTD;                                                0337 00663000
*       CALL ILRPREAD;              /* CALL ILRPREAD TO READ         */ 00664000
         L     @15,RDWTPTR                                         0338 00665000
         BALR  @14,@15                                             0338 00666000
*       IF R15^=ZERO|TPARIDNT^=TPARID|QSRIDNT^=QSRID THEN          0339 00667000
         LTR   R15,R15                                             0339 00668000
         BNZ   @RT00339                                            0339 00669000
         L     @14,TPARPTR                                         0339 00670000
         CLC   TPARIDNT(8,@14),@CC02481                            0339 00671000
         BNE   @RT00339                                            0339 00672000
         L     @14,QSRPTR                                          0339 00673000
         CLC   QSRIDNT(8,@14),@CC02483                             0339 00674000
         BE    @RF00339                                            0339 00675000
@RT00339 DS    0H                                                  0340 00676000
*         DO;                       /* READ FAIL?                    */ 00677000
*           RFY                                                    0341 00678000
*             R15 UNRSTD;                                          0341 00679000
*           MSGID=M939D;            /* RE-IPL OR FORCE COLD?         */ 00680000
         MVC   MSGID(4),@CC02573                                   0342 00681000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 00682000
         LA    R1,MSGPL                                            0343 00683000
*           CALL ILRIMMSG;          /* MESSAGE MODULE                */ 00684000
*                                                                  0344 00685000
         L     @15,@CV02592                                        0344 00686000
         BALR  @14,@15                                             0344 00687000
*           /*********************************************************/ 00688000
*           /*                                                       */ 00689000
*           /* CONTROL RETURN HERE ONLY IF RE-IPL NOT DONE           */ 00690000
*           /*                                                       */ 00691000
*           /*********************************************************/ 00692000
*                                                                  0345 00693000
*           NVTFLWS=NO;             /* NO MORE WARM START            */ 00694000
*           NVTFLQS=NO;             /* NO MORE QUICK START           */ 00695000
         L     @08,NVTPTR                                          0346 00696000
         NI    NVTFLWS(@08),B'11110011'                            0346 00697000
*           MSGID=M929I;            /* FORCE COLD START              */ 00698000
         MVC   MSGID(4),@CC02563                                   0347 00699000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 00700000
         LA    R1,MSGPL                                            0348 00701000
*           CALL ILRIMMSG;          /* MESSAGE MODULE                */ 00702000
         L     @15,@CV02592                                        0349 00703000
         BALR  @14,@15                                             0349 00704000
*         END;                      /* END READ FAIL                 */ 00705000
*       ELSE                                                       0351 00706000
*         DO;                       /* READ O.K.                     */ 00707000
         B     @RC00339                                            0351 00708000
@RF00339 DS    0H                                                  0352 00709000
*           NVTLPAHA=QSRLPAHA;      /* MOVE PLPA INFO TO NVT         */ 00710000
         L     @08,NVTPTR                                          0352 00711000
         L     @06,QSRPTR                                          0352 00712000
         L     @00,QSRLPAHA(,@06)                                  0352 00713000
         ST    @00,NVTLPAHA(,@08)                                  0352 00714000
*           NVTLPAND=QSRLPAHI;      /* HIGH RANGE OF PLPA            */ 00715000
         L     @00,QSRLPAHI(,@06)                                  0353 00716000
         ST    @00,NVTLPAND(,@08)                                  0353 00717000
*           NVTLPALO=QSRLPALO;      /* LOW RANGE OF PLPA             */ 00718000
         L     @06,QSRLPALO(,@06)                                  0354 00719000
         ST    @06,NVTLPALO(,@08)                                  0354 00720000
*           TPARFLAG=''B;           /* EMPTY HEADER FLAGS            */ 00721000
         L     @06,TPARPTR                                         0355 00722000
         MVI   TPARFLAG(@06),X'00'                                 0355 00723000
*           TPARNPGS=''B;           /* NO D.S. ARE ACTIVE            */ 00724000
         SLR   @15,@15                                             0356 00725000
         ST    @15,TPARNPGS(,@06)                                  0356 00726000
*           TPARPCTQ=''B;           /* PCT CHAIN EMPTY               */ 00727000
         ST    @15,TPARPCTQ(,@06)                                  0357 00728000
*           IF NVTFLWS=NO THEN      /* QUICK START?                  */ 00729000
         TM    NVTFLWS(@08),B'00000100'                            0358 00730000
         BNZ   @RF00358                                            0358 00731000
*             DO;                                                  0359 00732000
*               RFY                                                0360 00733000
*                (R0,                                              0360 00734000
*                 R14,                                             0360 00735000
*                 R15) RSTD;                                       0360 00736000
*                                                                  0360 00737000
*/*             ZERO ALL LOCAL ENTRIES FROM LAST IPL                 */ 00738000
*                                                                  0361 00739000
*               R0=LOCTPTR;         /* 1ST LOCAL IN ILRTPARB 1ST     */ 00740000
         L     R0,LOCTPTR                                          0361 00741000
*               R1=(TPARUSE-INITUSE)*(LENGTH(TPARENT));/* LENGTH     */ 00742000
         L     R1,TPARUSE(,@06)                                    0362 00743000
         SL    R1,@CF00092                                         0362 00744000
         MH    R1,@CH00073                                         0362 00745000
*               R15=ZERO;                                          0363 00746000
         SLR   R15,R15                                             0363 00747000
*               MVCL(R0,R14);       /* ZEROES ALL PREVIOUS LOCALS    */ 00748000
         MVCL  R0,R14                                              0364 00749000
*               RFY                                                0365 00750000
*                (R0,                                              0365 00751000
*                 R14,                                             0365 00752000
*                 R15) UNRSTD;                                     0365 00753000
*               TPARUSE=INITUSE;    /* ENTRIES IN USE NOW            */ 00754000
         L     @08,TPARPTR                                         0366 00755000
         MVC   TPARUSE(4,@08),@CF00092                             0366 00756000
*             END;                  /* END QUICK START               */ 00757000
*           ELSE                                                   0368 00758000
*             ;                     /* WARM START                    */ 00759000
@RF00358 DS    0H                                                  0369 00760000
*           SCHPTR=ADDR(TPARPENT);  /* FIRST ENTRY                   */ 00761000
         L     @06,TPARPTR                                         0369 00762000
         LA    SCHPTR,TPARPENT(,@06)                               0369 00763000
*           DO COUNT=TPARUSE TO 1 BY-1;/* LOOP THROUGH ILRTPARB      */ 00764000
         L     @06,TPARUSE(,@06)                                   0370 00765000
         STH   @06,COUNT                                           0370 00766000
         B     @DE00370                                            0370 00767000
@DL00370 DS    0H                                                  0371 00768000
*             IF SCHPTR->TPAEVALD=ON THEN/* WAS VALID LAST IPL?      */ 00769000
         TM    TPAEVALD(SCHPTR),B'00001000'                        0371 00770000
         BNO   @RF00371                                            0371 00771000
*               DO;                                                0372 00772000
*                 SCHPTR->TPAESTAT=''B;/* ZERO ALL STATUS FLAGS      */ 00773000
         MVI   TPAESTAT(SCHPTR),X'00'                              0373 00774000
*                 SCHPTR->TPAEPRVI=ON;/* PUT ON STATUS ON- PREV.     */ 00775000
         OI    TPAEPRVI(SCHPTR),B'01000000'                        0374 00776000
*               END;                /* END OF VALID ENTRY            */ 00777000
*             ELSE                                                 0376 00778000
*               ;                   /* INVALID LEFT ALONE            */ 00779000
@RF00371 DS    0H                                                  0377 00780000
*             IF SCHPTR->TPAEDPLX=ON THEN                          0377 00781000
         TM    TPAEDPLX(SCHPTR),B'00100000'                        0377 00782000
         BNO   @RF00377                                            0377 00783000
*               DO;                 /* DUPLEX ENTRY?                 */ 00784000
*                 IF SCHPTR->TPAEDSN=ZERODSN THEN                  0379 00785000
         CLC   TPAEDSN(44,SCHPTR),ZERODSN                          0379 00786000
         BNE   @RF00379                                            0379 00787000
*                   SCHPTR->TPAESKIP=ON;/* SKIP ENTRY                */ 00788000
         OI    TPAESKIP(SCHPTR),B'00010000'                        0380 00789000
*                 ELSE                                             0381 00790000
*                   ASMDUPLX=ON;    /* DUPLEX THIS TIME TOO          */ 00791000
         B     @RC00379                                            0381 00792000
@RF00379 L     @06,CVTPTR                                          0381 00793000
         L     @06,ASMVTPTR(,@06)                                  0381 00794000
         OI    ASMDUPLX(@06),B'10000000'                           0381 00795000
*               END;                /* DUPLEX ENTRY                  */ 00796000
*             ELSE                                                 0383 00797000
*               ;                   /* IGNORE IF NOT DUPLEX          */ 00798000
@RF00377 DS    0H                                                  0384 00799000
*             SCHPTR=SCHPTR+LENGTH(TPARENT);/* NEXT ENTRY            */ 00800000
@RC00377 AL    SCHPTR,@CF00073                                     0384 00801000
*           END;                    /* END DO WHILE                  */ 00802000
         SLR   @06,@06                                             0385 00803000
         BCTR  @06,0                                               0385 00804000
         AH    @06,COUNT                                           0385 00805000
         STH   @06,COUNT                                           0385 00806000
@DE00370 LTR   @06,@06                                             0385 00807000
         BP    @DL00370                                            0385 00808000
*         END;                      /* READ O.K.                     */ 00809000
*     END;                          /* QUICK OR WARM START           */ 00810000
*   ELSE                                                           0388 00811000
*     ;                             /* COLD START (ORIGINALLY)       */ 00812000
@RF00325 DS    0H                                                  0389 00813000
*   IF NVTFLQS=NO THEN                                             0389 00814000
@RC00325 L     @08,NVTPTR                                          0389 00815000
         TM    NVTFLQS(@08),B'00001000'                            0389 00816000
         BNZ   @RF00389                                            0389 00817000
*     DO;                           /* COLD START?                   */ 00818000
*       RFY                                                        0391 00819000
*        (R0,                                                      0391 00820000
*         R14,                                                     0391 00821000
*         R15) RSTD;                                               0391 00822000
*       R0=TPARPTR;                 /* ZERO ALL ILRTPARB             */ 00823000
         L     R0,TPARPTR                                          0392 00824000
*       R1=LENGTH(TPARTBLE);        /* GET LENGTH TO ZERO            */ 00825000
         L     R1,@CF02873                                         0393 00826000
*       R15=ZERO;                                                  0394 00827000
         SLR   R15,R15                                             0394 00828000
*       MVCL(R0,R14);               /* ZEROED                        */ 00829000
         MVCL  R0,R14                                              0395 00830000
*       RFY                                                        0396 00831000
*        (R0,                                                      0396 00832000
*         R14,                                                     0396 00833000
*         R15) UNRSTD;                                             0396 00834000
*       TPARIDNT=TPARID;            /* PUT TPARTBLE IN ILRTPARB      */ 00835000
         L     @08,TPARPTR                                         0397 00836000
         MVC   TPARIDNT(8,@08),@CC02481                            0397 00837000
*       TPARUSE=INITUSE;            /* ENTRIES IN USE                */ 00838000
         MVC   TPARUSE(4,@08),@CF00092                             0398 00839000
*       TPAEDSN=DSTDSN;             /* FROM WORKAREA TO ILRTPARB     */ 00840000
         L     @08,TPAEPTR                                         0399 00841000
         MVC   TPAEDSN(44,@08),DSTDSN(DSTEPTR)                     0399 00842000
*       TPAEDSNL=DSTLNG;            /* LENGTH TOO                    */ 00843000
         IC    @06,DSTLNG(,DSTEPTR)                                0400 00844000
         STC   @06,TPAEDSNL(,@08)                                  0400 00845000
*       TPAEPLPA=YES;               /* IT IS PLPA ENTRY              */ 00846000
         OI    TPAEPLPA(@08),B'10000000'                           0401 00847000
*       QSRHDR=''B;                 /* ZERO QSR HEADER               */ 00848000
         L     @08,QSRPTR                                          0402 00849000
         XC    QSRHDR(32,@08),QSRHDR(@08)                          0402 00850000
*       QSRIDNT=QSRID;              /* PUT IN IDENTIFIER             */ 00851000
         MVC   QSRIDNT(8,@08),@CC02483                             0403 00852000
*     END;                          /* COLD START                    */ 00853000
*   ELSE                                                           0405 00854000
*     ;                             /* QUICK OR WARM START           */ 00855000
@RF00389 DS    0H                                                  0406 00856000
*   RFY                                                            0406 00857000
*     R15 RSTD;                                                    0406 00858000
*   CALL TPARPATS;                  /* FILL IN TPARB AND BUILD PAT   */ 00859000
         BAL   @14,TPARPATS                                        0407 00860000
*   IF R15^=ZERO THEN               /* WARM START AND SLOTS NOT SAME */ 00861000
         LTR   R15,R15                                             0408 00862000
         BZ    @RF00408                                            0408 00863000
*     DO;                                                          0409 00864000
*       RFY                                                        0410 00865000
*         R15 UNRSTD;                                              0410 00866000
*       MSGID=M935W;                /* RESOURCES PROBLEM             */ 00867000
         MVC   MSGID(4),@CC02567                                   0411 00868000
*       R1=ADDR(MSGPL);             /* PARM TO ILRIMMSG              */ 00869000
         LA    R1,MSGPL                                            0412 00870000
*       CALL ILRIMMSG;              /* WAIT STATE                    */ 00871000
         L     @15,@CV02592                                        0413 00872000
         BALR  @14,@15                                             0413 00873000
*     END;                          /* END PROBLEM                   */ 00874000
*   ELSE                                                           0415 00875000
*     DO;                                                          0415 00876000
         B     @RC00408                                            0415 00877000
@RF00408 DS    0H                                                  0416 00878000
*       TPAREXPD=PAGEEXP;           /* EXPANSION # FOR PAGES         */ 00879000
         LH    @08,PAGEEXP                                         0416 00880000
         L     @15,TPARPTR                                         0416 00881000
         ST    @08,TPAREXPD(,@15)                                  0416 00882000
*       NVTQSBUF=QSRPTR;            /* SO ILRQSRIT CAN FIND QSR      */ 00883000
*                                                                  0417 00884000
         L     @08,QSRPTR                                          0417 00885000
         L     @15,NVTPTR                                          0417 00886000
         ST    @08,NVTQSBUF(,@15)                                  0417 00887000
*       /*************************************************************/ 00888000
*       /*                                                           */ 00889000
*       /* MARK PLPA AS HAVING ILRTPARB AND ILRQSRCD IN 1ST SLOTS    */ 00890000
*       /*                                                           */ 00891000
*       /*************************************************************/ 00892000
*                                                                  0418 00893000
*       PATPTR=TPAEPATP;            /* GET PLPA PAT                  */ 00894000
         L     @08,TPAEPTR                                         0418 00895000
         L     @08,TPAEPATP(,@08)                                  0418 00896000
         ST    @08,PATPTR                                          0418 00897000
*       COUNT=(LENGTH(TPARTBLE)+LENGTH(QSR))/FOURK;/* GET NUMBER OF     00898000
*                                      SLOTS THEY NEED               */ 00899000
         LA    @08,6                                               0419 00900000
         STH   @08,COUNT                                           0419 00901000
*       ASMDSSFS=COUNT;             /* SAVE SLOT # OF FIRST SLOT   0420 00902000
*                                      RESERVED FOR DSS      @ZA14260*/ 00903000
         L     @15,CVTPTR                                          0420 00904000
         L     @15,ASMVTPTR(,@15)                                  0420 00905000
         STH   @08,ASMDSSFS(,@15)                                  0420 00906000
*       COUNT=COUNT+16;             /* ADD NUMBER OF SLOTS RESERVED     00907000
*                                      FOR DSS USE           @ZA14260*/ 00908000
         AL    @08,@CF00111                                        0421 00909000
         STH   @08,COUNT                                           0421 00910000
*       PLPASUSE=COUNT;             /* FIRST PLPA SLOTS USED         */ 00911000
         ST    @08,PLPASUSE                                        0422 00912000
*       DO WHILE COUNT^=ZERO;       /* MARK THE SLOTS IN PAT         */ 00913000
         B     @DE00423                                            0423 00914000
@DL00423 DS    0H                                                  0424 00915000
*         COUNT=COUNT-ONE;          /* RELATIVE SLOT                 */ 00916000
         LH    @08,COUNT                                           0424 00917000
         BCTR  @08,0                                               0424 00918000
         STH   @08,COUNT                                           0424 00919000
*         SLOT=COUNT;               /* INPUT TO MARKPAT              */ 00920000
         LR    SLOT,@08                                            0425 00921000
*         CALL MARKPAT;             /* MARK THIS BIT IN MAP          */ 00922000
         BAL   @14,MARKPAT                                         0426 00923000
*       END;                        /* MARKING                       */ 00924000
@DE00423 LH    @08,COUNT                                           0427 00925000
         LTR   @08,@08                                             0427 00926000
         BNZ   @DL00423                                            0427 00927000
*     END;                          /* TPARPATS O.K.                 */ 00928000
*                                                                  0429 00929000
*/********************************************************************/ 00930000
*/*                                                                  */ 00931000
*/* OPENDPLX: SEGMENT PARSE DUPLEX NAME AND OPEN DATA SET            */ 00932000
*/*                                                                  */ 00933000
*/* INPUT: ILRTPARB FORM OPENPLPA SEGMENT                            */ 00934000
*/*        ILRDSTBL WITH DUPLEX ENTRY RESERVED                       */ 00935000
*/*        IHANVT AND ILRASMVT                                       */ 00936000
*/*                                                                  */ 00937000
*/* PROCESS: UTILIZE THIRD ENTRY IN ILRTPARB AND ILRDSTBL FOR DUPLEX */ 00938000
*/*          DATA SET.  PARSE NAME INTO ILRDSTBL OR MOVE PREVIOUS ONE*/ 00939000
*/*          IN ILRTPARB TO ILRDSTBL.  ATTEMPT TO OPEN DATA SET.     */ 00940000
*/*          RESPECIFICATION IS ALLOWED ON COLD START--HAVEN'T USED  */ 00941000
*/*          DATA SET, SO CAN BE REPLACED.  THERE WILL NOT BE        */ 00942000
*/*          DUPLEXING THIS IPL IF:                                  */ 00943000
*/*                 1. QUICK AND WARM START FOR WHICH THE COLD       */ 00944000
*/*                       START HAD NONE                             */ 00945000
*/*                 2. NO DUPLEX SPECIFIED ON COLD START             */ 00946000
*/*                 3. OPERATOR SAYS IGNORE TO MOUNT OR LOCATE       */ 00947000
*/*                 4. LOCATE FAILS ON QUICK OR WARM START           */ 00948000
*/*                 5. TIMESTAMP NOT MATCH ON QUICK OR WARM          */ 00949000
*/*                 6. NOT ENOUGH SLOTS                              */ 00950000
*/*     IF NO DUPLEXING ON QUICK OR WARM START THAT A DUPLEX DATA    */ 00951000
*/*     SET WAS IN TPARB, THE DUPLEX DATA SET NAME IS LEFT IN DSTBL  */ 00952000
*/*     SO IT CAN NOT BE USED FOR RESPECIFICATION OF COMMON OR       */ 00953000
*/*     LOCAL DATA SETS.  THE DUPLEX DATA SET WILL STILL BE GOOD FOR */ 00954000
*/*     FOR NEXT QUICK OR WARM START.                                */ 00955000
*/*                                                                  */ 00956000
*/* OUTPUT: NO DUPLEXING THIS IPL OR DATA SET OPEN AND ILRTPARB ENTRY*/ 00957000
*/*          FILLED IN                                               */ 00958000
*/*                                                                  */ 00959000
*/********************************************************************/ 00960000
*/*OPENDPLX: CHART (SEQ)                                             */ 00961000
*/*HEADER                                                          0429 00962000
*/*  OPENDPLX SEGMENT                                                */ 00963000
*/*OPENDPLX: E ENTRY TO OPEN DUPLEX DATA SET                         */ 00964000
*/*          P POINT TO 3RD ENTRY IN ILRTPARB AND ILRDSTBL           */ 00965000
*/*          P TURN ON DUPLEX PROCESS SWITCH                         */ 00966000
*/*          D (YES,,NO,%A1) QUICK OR WARM START?                    */ 00967000
*/*          D (NO,,YES,%A2) PREVIOUS DATA SET NAME?                 */ 00968000
*/*%A6:      D (YES,,NO,%E1) QUICK OR WARM START?                    */ 00969000
*/*          D (YES,,NO,%E1) PLPA AND COMM OVERFLOW?                 */ 00970000
*/*          S ILRIMMSG: DUPLEX DEPENDENCY MESSAGE                   */ 00971000
*/*          D (YES,,NO,%E1) DUPLEXING?                              */ 00972000
*/*          S ILRIMMSG: FORCE COLD START                            */ 00973000
*/*          D (YES,,NO,%E2) WARM START?                             */ 00974000
*/*          P ZERO ALL TPARB LOCAL ENTRIES                          */ 00975000
*/*          P RESET ENTRIES IN USE COUNT                            */ 00976000
*/*%E2:      P CHANGE NVT IPL FLAGS                                  */ 00977000
*/*          P REINIT QSR                                            */ 00978000
*/*          P ZERO PLPA INFORMATION IN NVT                          */ 00979000
*/*%E1:      P TURN OFF DUPLEX PROCESS SWITCH                        */ 00980000
*/*          R FLOW CONTINUES AT OPENCOMM                            */ 00981000
*/*%A2:      P MOVE NAME FROM ILRTPARB TO ILRDSTBL                   */ 00982000
*/*          P UNIQUE NAME IN ILRDSTBL?                              */ 00983000
*/*          D (NO,,YES,%A3) NO MATCH?                               */ 00984000
*/*          N MATCHES EITHER COMMON OR LOCAL DATA SET               */ 00985000
*/*          D (NO,,YES,%A4) MATCHES COMMON DATA SET?                */ 00986000
*/*          P (,%A3) MARK LOCAL AS ALREADY IN USE AS DUPLEX         */ 00987000
*/*%A4:      P MOVE PREVIOUS COMMON TO ILRDSTBL ENTRY FOR COMMON     */ 00988000
*/*          P (,%A3) TURN ON OLD COMMON SWITCH                      */ 00989000
*/*%A1:      P POINT TO DUPLEX PARAMETER STRING                      */ 00990000
*/*          D (YES,,NO,%A5) POINTING TO ZEROES?                     */ 00991000
*/*          P (,%A6) MARK ILRTPARB DUPLEX ENTRY TO BE SKIPPED       */ 00992000
*/*%A5:      D (YES,,NO,%A7) CHAR IS '('?                            */ 00993000
*/*          P NEXT CHAR                                             */ 00994000
*/*%A7:      N SCAN UNTIL QUOTE, ')', OR A PROBLEM                   */ 00995000
*/*          D (NO,,YES,%A8) SCAN CONTINUE?                          */ 00996000
*/*          D (YES,,NO,%A9) PROBLEMS?                               */ 00997000
*/*          S ILRIMMSG: ASK FOR NEW STRING                          */ 00998000
*/*          S (,%A1) NIPPRMPT: PROMPT OPERATOR FOR REPLY            */ 00999000
*/*%A8:      D (YES,,NO,%B1) CHAR IS COMMA OR '('?                   */ 01000000
*/*          P (,%A7) PROBLEMS                                       */ 01001000
*/*%B1:      S NEXDSN: PARSE NAME                                    */ 01002000
*/*          D (NO,,YES,%B5) NO PROBLEM AND NEXT CHAR IS QUOTE?      */ 01003000
*/*          P (,%A7) MARK AS PROBLEM                                */ 01004000
*/*%B5:      P MOVE NAME INTO ILRDSTBL                               */ 01005000
*/*%A9:      P MATCH NAME IN ILRDSTBL?                               */ 01006000
*/*          D (YES,,NO,%A3) MATCH?                                  */ 01007000
*/*          S OPENB: NOT ACCEPTABLE NAME                            */ 01008000
*/*          S OPENA: ASK FOR A NEW NAME                             */ 01009000
*/*          D (NO,,YES,%B2) OPERATOR REPLY 'IGNORE'?                */ 01010000
*/*%A3:      S OPEN: OPEN DUPLEX DATA SET                            */ 01011000
*/*          D (NO,,YES,%D1) SUCCESSFUL OPEN?                        */ 01012000
*/*          D (YES,,NO,%B3) MOUNT FAIL?                             */ 01013000
*/*          S ILRIMMSG: ISSUE MOUNT MESSAGE                         */ 01014000
*/*          D (YES,,NO,%A3) OPERATOR REPLY 'IGNORE'                 */ 01015000
*/*%B2:      P REASON IS NO DATA SET (MESSAGE)                       */ 01016000
*/*%B4:      P ASMVT DUPLEX FLAG OFF                                 */ 01017000
*/*          N NAME IN ILRTPARB, IF ANY, IS NOT REMOVED              */ 01018000
*/*          P MARK ILRTPARB ENTRY TO BE SKIPPED THOUGH              */ 01019000
*/*          D (YES,,NO,%C1) COLD START?                             */ 01020000
*/*          P ZERO NAME IN ILRDSTBL ENTRY                           */ 01021000
*/*%C1:      S (,%A6) ILRIMMSG: 'NO DUPLEXING' MESSAGE               */ 01022000
*/*%B3:      N LOCATE FAILED                                         */ 01023000
*/*          D (YES,,NO,%B2) COLD START?                             */ 01024000
*/*          S OPENA: ASK FOR NEW NAME                               */ 01025000
*/*          D (NO,,YES,%B2) REPLY 'IGNORE'?                         */ 01026000
*/*          N (,%A3) GIVEN NEW NAME                                 */ 01027000
*/*%D1:      S TPARPATS: FILL IN ILRTPARB AND BUILD PAT              */ 01028000
*/*          D (YES,,NO,%B2) FILLED O.K.?                            */ 01029000
*/*          D (YES,,NO,%B6) QUICK OR WARM START?                    */ 01030000
*/*          N PARMLIST HAS ILRTPARB ENTRY, BUFFER, AND 1 SLOT       */ 01031000
*/*          S ILRPREAD: READ FIRST SLOT OF DUPLEX D.S.              */ 01032000
*/*          D (YES,,NO,%B7) READ O.K.?                              */ 01033000
*/*          D (NO,,YES,%B9) QSR AND DUPLEX TIMESTAMP MATCH?         */ 01034000
*/*%B7:      N EVEN FURTHER IPLS WILL BE UNABLE TO USE DATA SET      */ 01035000
*/*          P ZERO ILRTPARB DUPLEX ENTRY                            */ 01036000
*/*          P (,%B4) REASON IS BAD TIMESTAMP                        */ 01037000
*/*%B6:      P ASMVT DUPLEXING SWITCH ON                             */ 01038000
*/*          P MOVE DUPLEX NAME TO ILRTPARB ENTRY                    */ 01039000
*/*%B9:      S MARKPAT: MARK DUPLEX PAT-- 1 SLOT                     */ 01040000
*/*          P (,%A6) SET DUPLEX USE COUNT TO 1                      */ 01041000
*/*OPENDPLX: END                                                     */ 01042000
*                                                                  0429 01043000
*                                                                  0429 01044000
*   /*****************************************************************/ 01045000
*   /*                                                               */ 01046000
*   /* OPENDPLX                                                      */ 01047000
*   /*                                                               */ 01048000
*   /*****************************************************************/ 01049000
*                                                                  0429 01050000
*   DSTEPTR=DUPLPTR;                /* DUPLEX IN WORKAREA            */ 01051000
@RC00408 L     DSTEPTR,DUPLPTR                                     0429 01052000
*   TPAEPTR=DPLTPTR;                /* DUPLEX IN ILRTPARB            */ 01053000
         L     @08,DPLTPTR                                         0430 01054000
         ST    @08,TPAEPTR                                         0430 01055000
*   DUPLEXSW=ON;                    /* PROCESSIN DUPLEX DATA SET     */ 01056000
         OI    DUPLEXSW,B'00000100'                                0431 01057000
*   IF NVTFLQS=YES THEN                                            0432 01058000
         L     @06,NVTPTR                                          0432 01059000
         TM    NVTFLQS(@06),B'00001000'                            0432 01060000
         BNO   @RF00432                                            0432 01061000
*     DO;                           /* QUICK OR WARM START?          */ 01062000
*       IF ASMDUPLX=YES THEN                                       0434 01063000
         L     @06,CVTPTR                                          0434 01064000
         L     @06,ASMVTPTR(,@06)                                  0434 01065000
         TM    ASMDUPLX(@06),B'10000000'                           0434 01066000
         BNO   @RF00434                                            0434 01067000
*         DO;                       /* DUPLEXING BEFORE?             */ 01068000
*           DSTDSN=TPAEDSN;         /* MOVE TO WORKAREA              */ 01069000
         L     @06,TPAEPTR                                         0436 01070000
         MVC   DSTDSN(44,DSTEPTR),TPAEDSN(@06)                     0436 01071000
*           DSTLNG=TPAEDSNL;                                       0437 01072000
         IC    @00,TPAEDSNL(,@06)                                  0437 01073000
         STC   @00,DSTLNG(,DSTEPTR)                                0437 01074000
*           SCHPTR=DSTBLPTR;        /* START AT TOP OF WORKAREA      */ 01075000
         L     SCHPTR,DSTBLPTR                                     0438 01076000
*           DO WHILE                /* NOT MATCH & NOT LIST END      */ 01077000
*                 (SCHPTR->DSTDSN^=DSTDSN&SCHPTR->DSTDSNC^=0)|SCHPTR=   01078000
*                 DSTEPTR;          /* OR IS THE SAME ENTRY          */ 01079000
         B     @DE00439                                            0439 01080000
@DL00439 DS    0H                                                  0440 01081000
*             SCHPTR=SCHPTR+LENGTH(DSTENT);/* NEXT ENTRY             */ 01082000
         AL    SCHPTR,@CF00076                                     0440 01083000
*           END;                    /* NO MATCH OR FOUND MATCH       */ 01084000
@DE00439 CLC   DSTDSN(44,SCHPTR),DSTDSN(DSTEPTR)                   0441 01085000
         BE    @GL00009                                            0441 01086000
         CLI   DSTDSNC(SCHPTR),0                                   0441 01087000
         BNE   @DL00439                                            0441 01088000
@GL00009 CR    SCHPTR,DSTEPTR                                      0441 01089000
         BE    @DL00439                                            0441 01090000
*           IF SCHPTR->DSTDSNC^=0 THEN                             0442 01091000
         CLI   DSTDSNC(SCHPTR),0                                   0442 01092000
         BE    @RF00442                                            0442 01093000
*             DO;                   /* NOT UNIQUE?                   */ 01094000
*               IF SCHPTR=COMMPTR THEN                             0444 01095000
         L     @06,COMMPTR                                         0444 01096000
         CR    SCHPTR,@06                                          0444 01097000
         BNE   @RF00444                                            0444 01098000
*                 DO;               /* MATCH COMMON IN W.A.?         */ 01099000
*                   COMMPTR->DSTDSN=COMTPTR->TPAEDSN;/* MOVE COMMON  */ 01100000
         L     @08,COMTPTR                                         0446 01101000
         MVC   DSTDSN(44,@06),TPAEDSN(@08)                         0446 01102000
*                   COMMPTR->DSTLNG=COMTPTR->TPAEDSNL;/* LENGTH TOO  */ 01103000
         IC    @00,TPAEDSNL(,@08)                                  0447 01104000
         STC   @00,DSTLNG(,@06)                                    0447 01105000
*                   LIST=ON;        /* CHANGED -- ISSUE IEA940I      */ 01106000
         OI    LIST,B'01000000'                                    0448 01107000
*                 END;              /* MATCH COMMON                  */ 01108000
*               ELSE                                               0450 01109000
*                 DO;               /* MATCHES A LOCAL               */ 01110000
         B     @RC00444                                            0450 01111000
@RF00444 DS    0H                                                  0451 01112000
*                   SCHPTR->DSTUSED=ON;/* NAME USED                  */ 01113000
*                   SCHPTR->DSTDPLX=ON;/* USED AS DUPLEX DATA SET    */ 01114000
         OI    DSTUSED(SCHPTR),B'11000000'                         0452 01115000
*                 END;              /* MATCH LOCAL                   */ 01116000
*             END;                  /* NOT UNIQUE                    */ 01117000
*           ELSE                                                   0455 01118000
*             ;                     /* OPEN NAME                     */ 01119000
@RF00442 DS    0H                                                  0456 01120000
*         END;                      /* DUPLEXING ON                  */ 01121000
*       ELSE                                                       0457 01122000
*         GOTO DUPCOMP;             /* Q OR WARM, BUT NO DUPLEXING   */ 01123000
*     END;                          /* QUICK OR WARM                 */ 01124000
*   ELSE                                                           0459 01125000
*     DO;                           /* COLD START                    */ 01126000
         B     @RC00432                                            0459 01127000
@RF00432 DS    0H                                                  0460 01128000
*       TPAEDPLX=YES;               /* MARK AS DUPLEX ENTRY          */ 01129000
         L     @08,TPAEPTR                                         0460 01130000
         OI    TPAEDPLX(@08),B'00100000'                           0460 01131000
*       PAGEQPTR=ADDR(DUPLEX);      /* DUPLEX IN PARMTAB             */ 01132000
         L     @08,PRMTBPTR                                        0461 01133000
         LA    @08,DUPLEX(,@08)                                    0461 01134000
         ST    @08,PAGEQPTR                                        0461 01135000
*PARDP:                                                            0462 01136000
*       CHARPTR=PGSTRNGP;           /* ADDRESS OF STRING             */ 01137000
PARDP    L     @08,PAGEQPTR                                        0462 01138000
         L     CHARPTR,PGSTRNGP(,@08)                              0462 01139000
*       PROBLEM=NO;                 /* FLAG FOR SYNTAX ERRORS        */ 01140000
         NI    PROBLEM,B'11011111'                                 0463 01141000
*       IF CHARPTR^=ZERO THEN                                      0464 01142000
         LTR   CHARPTR,CHARPTR                                     0464 01143000
         BZ    @RF00464                                            0464 01144000
*         DO;                       /* NAME IN STRING                */ 01145000
*           IF PTCHAR=LEFTPAR THEN  /* O.K. NEXT CHAR                */ 01146000
         CLI   PTCHAR(CHARPTR),C'('                                0466 01147000
         BNE   @RF00466                                            0466 01148000
*             CHARPTR=CHARPTR+ONE;                                 0467 01149000
         AL    CHARPTR,@CF00059                                    0467 01150000
*           ELSE                                                   0468 01151000
*             ;                                                    0468 01152000
@RF00466 DS    0H                                                  0469 01153000
*           IF PTCHAR=LEFTPAR|PTCHAR=COMMA THEN                    0469 01154000
         CLI   PTCHAR(CHARPTR),C'('                                0469 01155000
         BE    @RT00469                                            0469 01156000
         CLI   PTCHAR(CHARPTR),C','                                0469 01157000
         BNE   @RF00469                                            0469 01158000
@RT00469 DS    0H                                                  0470 01159000
*             PROBLEM=YES;                                         0470 01160000
         OI    PROBLEM,B'00100000'                                 0470 01161000
*           ELSE                                                   0471 01162000
*             DO;                   /* THERE IS A DSNAME             */ 01163000
         B     @RC00469                                            0471 01164000
@RF00469 DS    0H                                                  0472 01165000
*               CALL NEXDSN;        /* SCANS DSNAME                  */ 01166000
         BAL   @14,NEXDSN                                          0472 01167000
*               IF PTCHAR=QUOTE&PROBLEM=NO THEN                    0473 01168000
         CLI   PTCHAR(CHARPTR),C''''                               0473 01169000
         BNE   @RF00473                                            0473 01170000
         TM    PROBLEM,B'00100000'                                 0473 01171000
         BNZ   @RF00473                                            0473 01172000
*                 DO;                                              0474 01173000
*                   DSTDSN='';      /* BLANK NAME AREA               */ 01174000
         MVI   DSTDSN(DSTEPTR),C' '                                0475 01175000
         MVC   DSTDSN+1(43,DSTEPTR),DSTDSN(DSTEPTR)                0475 01176000
*                   DSTDSN=PTDSN(1:DSNLNG);/* OUTPUT OF NEXDSN       */ 01177000
         MVI   DSTDSN+1(DSTEPTR),C' '                              0476 01178000
         MVC   DSTDSN+2(42,DSTEPTR),DSTDSN+1(DSTEPTR)              0476 01179000
         LR    @08,DSNLNG                                          0476 01180000
         BCTR  @08,0                                               0476 01181000
         L     @06,DSNPTR                                          0476 01182000
         EX    @08,@SM02904                                        0476 01183000
*                   DSTLNG=DSNLNG;  /* OUTPUT OF NEXDSN              */ 01184000
         STC   DSNLNG,DSTLNG(,DSTEPTR)                             0477 01185000
*                 END;              /* END OF QUOTE AND NO PROB      */ 01186000
*               ELSE                                               0479 01187000
*                 PROBLEM=YES;      /* IF NO QUOTE ALSO PROBLEM      */ 01188000
         B     @RC00473                                            0479 01189000
@RF00473 OI    PROBLEM,B'00100000'                                 0479 01190000
*             END;                  /* THERE IS A DSNAME             */ 01191000
@RC00473 DS    0H                                                  0481 01192000
*           IF PROBLEM=YES THEN                                    0481 01193000
@RC00469 TM    PROBLEM,B'00100000'                                 0481 01194000
         BNO   @RF00481                                            0481 01195000
*             DO;                   /* ASK FOR A RESPECIFICATION     */ 01196000
*               FLAGS=DUPEQ;        /* DUPLEX SYNTAX                 */ 01197000
         MVI   FLAGS,X'20'                                         0483 01198000
*               MSGID=M916E;        /* SYNTAX ERROR IN PARAMETER     */ 01199000
         MVC   MSGID(4),@CC02545                                   0484 01200000
*               RFY                                                0485 01201000
*                (R2,                                              0485 01202000
*                 R3) RSTD;                                        0485 01203000
*               R1=ADDR(MSGPL);     /* PARM TO ILRIMMSG              */ 01204000
         LA    R1,MSGPL                                            0486 01205000
*               CALL ILRIMMSG;      /* MESSAGE MODULE                */ 01206000
         L     @15,@CV02592                                        0487 01207000
         BALR  @14,@15                                             0487 01208000
*               LM(R2,R3,NIPPTRS);                                 0488 01209000
         LM    R2,R3,NIPPTRS                                       0488 01210000
*               GEN REFS(NIPPTRS,NVTPRMPT,DPLXPARM) SETS(DUPLEX);  0489 01211000
           IEAPMNIP TYPE=PRMPT,PARAM=DPLXPARM,OPT=ERROR                 01212000
*               RFY                                                0490 01213000
*                (R2,                                              0490 01214000
*                 R3) UNRSTD;                                      0490 01215000
*               GOTO PARDP;         /* PARSE THE NEXT STRING         */ 01216000
         B     PARDP                                               0491 01217000
*             END;                  /* END RESPECIFICATION           */ 01218000
*           ELSE                                                   0493 01219000
*             ;                     /* PROBLEM IS NO                 */ 01220000
@RF00481 DS    0H                                                  0494 01221000
*         END;                      /* END STRING HAS SOMETHING      */ 01222000
*       ELSE                                                       0495 01223000
*         DO;                       /* EMPTY STRING                  */ 01224000
         B     @RC00464                                            0495 01225000
@RF00464 DS    0H                                                  0496 01226000
*           TPAESKIP=ON;            /* SKIP TPARB ENTRY              */ 01227000
         L     @08,TPAEPTR                                         0496 01228000
         OI    TPAESKIP(@08),B'00010000'                           0496 01229000
*           GOTO DUPCOMP;           /* FINISHED WITH DUPLEX PROCESS  */ 01230000
         B     DUPCOMP                                             0497 01231000
*         END;                      /* NOTHING IN STRING             */ 01232000
*       SCHPTR=DSTBLPTR;            /* START AT TOP OF WORKAREA      */ 01233000
@RC00464 L     SCHPTR,DSTBLPTR                                     0499 01234000
*       DO WHILE                    /* NOT MATCH & NOT LIST END      */ 01235000
*             (SCHPTR->DSTDSN^=DSTDSN&SCHPTR->DSTDSNC^=0)|SCHPTR=  0500 01236000
*             DSTEPTR;              /* OR IS THE SAME ENTRY          */ 01237000
         B     @DE00500                                            0500 01238000
@DL00500 DS    0H                                                  0501 01239000
*         SCHPTR=SCHPTR+LENGTH(DSTENT);/* NEXT ENTRY                 */ 01240000
         AL    SCHPTR,@CF00076                                     0501 01241000
*       END;                        /* NO MATCH OR FOUND MATCH       */ 01242000
@DE00500 CLC   DSTDSN(44,SCHPTR),DSTDSN(DSTEPTR)                   0502 01243000
         BE    @GL00013                                            0502 01244000
         CLI   DSTDSNC(SCHPTR),0                                   0502 01245000
         BNE   @DL00500                                            0502 01246000
@GL00013 CR    SCHPTR,DSTEPTR                                      0502 01247000
         BE    @DL00500                                            0502 01248000
*       IF SCHPTR->DSTDSNC^=0 THEN                                 0503 01249000
         CLI   DSTDSNC(SCHPTR),0                                   0503 01250000
         BE    @RF00503                                            0503 01251000
*         DO;                       /* NOT UNIQUE?                   */ 01252000
*           CALL OPENB;             /* BAD NAME TRY AGAIN            */ 01253000
         BAL   @14,OPENB                                           0505 01254000
*           CALL OPENA;             /* TRY AGAIN                     */ 01255000
         BAL   @14,OPENA                                           0506 01256000
*           RFY                                                    0507 01257000
*             R15 RSTD;                                            0507 01258000
*           IF R15=IGNORVOL THEN                                   0508 01259000
         C     R15,@CF00069                                        0508 01260000
         BNE   @RF00508                                            0508 01261000
*             DO;                   /* OPER SAID TO IGNORE?          */ 01262000
*               BADDS=YES;          /* TYPE OF MESSAGE               */ 01263000
         OI    BADDS,B'00000001'                                   0510 01264000
*               CALL BADDUP;        /* MESSAGE AND NO DUPLEXING      */ 01265000
         BAL   @14,BADDUP                                          0511 01266000
*               GOTO DUPCOMP;       /* FINISHED WITH DUPLEX PROCESS  */ 01267000
         B     DUPCOMP                                             0512 01268000
*             END;                  /* OPER SAID TO IGNORE           */ 01269000
*           ELSE                                                   0514 01270000
*             ;                     /* GIVEN NEW UNIQUE NAME         */ 01271000
@RF00508 DS    0H                                                  0515 01272000
*         END;                      /* NOT UNIQUE                    */ 01273000
*       ELSE                                                       0516 01274000
*         ;                         /* NAME UNIQUE                   */ 01275000
@RF00503 DS    0H                                                  0517 01276000
*     END;                          /* COLD START                    */ 01277000
*OPENDP:                                                           0518 01278000
*   PARMDSN=DSTDSN;                 /* NAME IN ILROPS00 PARMLIST     */ 01279000
@RC00432 DS    0H                                                  0518 01280000
OPENDP   MVC   PARMDSN(44),DSTDSN(DSTEPTR)                         0518 01281000
*   PARMFLG=PARMPG;                 /* OPEN A PAGE DATA SET          */ 01282000
         MVI   PARMFLG,X'80'                                       0519 01283000
*   CALL OPEN;                      /* OPEN SUBROUTINE               */ 01284000
         BAL   @14,OPEN                                            0520 01285000
*   IF R15^=ZERO THEN                                              0521 01286000
         LTR   R15,R15                                             0521 01287000
         BZ    @RF00521                                            0521 01288000
*     DO;                           /* OPEN FAILED?                  */ 01289000
*       IF R15=NOVOLMNT THEN                                       0523 01290000
         C     R15,@CF00056                                        0523 01291000
         BNE   @RF00523                                            0523 01292000
*         DO;                       /* MOUNT FAILURE?                */ 01293000
*           MSGID=M941D;            /* ASK TO MOUNT                  */ 01294000
         MVC   MSGID(4),@CC02577                                   0525 01295000
*           MSGDATA1=ADDR(VOLSER);  /* RETURNED FROM ILROPS00        */ 01296000
         LA    @14,PARMDSN                                         0526 01297000
         LA    @14,VOLSER(,@14)                                    0526 01298000
         ST    @14,MSGDATA1                                        0526 01299000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 01300000
         LA    R1,MSGPL                                            0527 01301000
*           CALL ILRIMMSG;          /* MESSAGE MODULE                */ 01302000
         L     @15,@CV02592                                        0528 01303000
         BALR  @14,@15                                             0528 01304000
*           IF R1->MSGBUF(1:LENGTH(IGNORE))=IGNORE THEN            0529 01305000
         CLC   MSGBUF(6,R1),@CC02477                               0529 01306000
         BNE   @RF00529                                            0529 01307000
*             DO;                                                  0530 01308000
*               BADDS=YES;          /* OPER SAID TO IGNORE FAILURE   */ 01309000
         OI    BADDS,B'00000001'                                   0531 01310000
*               CALL BADDUP;        /* MESSAGE AND NO DUPLEXING      */ 01311000
         BAL   @14,BADDUP                                          0532 01312000
*             END;                  /* OPER SAID TO IGNORE FAILURE   */ 01313000
*           ELSE                                                   0534 01314000
*             GOTO OPENDP;          /* TRY NOW TO OPEN               */ 01315000
*         END;                      /* MOUNT FAIL                    */ 01316000
*       ELSE                                                       0536 01317000
*         DO;                       /* LOCATE FAIL                   */ 01318000
         B     @RC00523                                            0536 01319000
@RF00523 DS    0H                                                  0537 01320000
*           IF NVTFLQS=NO THEN                                     0537 01321000
         L     @14,NVTPTR                                          0537 01322000
         TM    NVTFLQS(@14),B'00001000'                            0537 01323000
         BNZ   @RF00537                                            0537 01324000
*             DO;                   /* COLD START?                   */ 01325000
*               CALL OPENA;         /* ASK FOR ANOTHER NAME          */ 01326000
         BAL   @14,OPENA                                           0539 01327000
*               IF R15=IGNORVOL THEN                               0540 01328000
         C     R15,@CF00069                                        0540 01329000
         BNE   @RF00540                                            0540 01330000
*                 DO;               /* OPER SAID TO IGNORE           */ 01331000
*                   BADDS=YES;      /* TYPE OF MESSAGE               */ 01332000
         OI    BADDS,B'00000001'                                   0542 01333000
*                   CALL BADDUP;    /* MESSAGE AND NO DUPLEXING      */ 01334000
         BAL   @14,BADDUP                                          0543 01335000
*                 END;              /* OPER SAID TO IGNORE           */ 01336000
*               ELSE                                               0545 01337000
*                 GO TO OPENDP;     /* NEW UNIQUE NAME TO OPEN       */ 01338000
*             END;                  /* COLD START                    */ 01339000
*           ELSE                                                   0547 01340000
*             DO;                   /* CANNOT ASK FOR NEW ON Q OR W  */ 01341000
         B     @RC00537                                            0547 01342000
@RF00537 DS    0H                                                  0548 01343000
*               BADDS=YES;          /* TYPE OF MESSAGE               */ 01344000
         OI    BADDS,B'00000001'                                   0548 01345000
*               CALL BADDUP;        /* MESSAGE AND NO DUPLEXING      */ 01346000
         BAL   @14,BADDUP                                          0549 01347000
*             END;                  /* CANNOT ASK FOR NEW ON Q OR W  */ 01348000
*         END;                      /* LOCATE FAIL                   */ 01349000
*     END;                          /* OPEN FAIL                     */ 01350000
*   ELSE                                                           0553 01351000
*     DO;                           /* OPEN O.K.                     */ 01352000
         B     @RC00521                                            0553 01353000
@RF00521 DS    0H                                                  0554 01354000
*       CALL TPARPATS;              /* FILL IN TPARB AND BUILD PAT   */ 01355000
         BAL   @14,TPARPATS                                        0554 01356000
*       IF R15=ZERO THEN                                           0555 01357000
         SLR   @14,@14                                             0555 01358000
         CR    R15,@14                                             0555 01359000
         BNE   @RF00555                                            0555 01360000
*         DO;                       /* TPARPATS O.K.?                */ 01361000
*           IF NVTFLQS=YES THEN                                    0557 01362000
         L     @08,NVTPTR                                          0557 01363000
         TM    NVTFLQS(@08),B'00001000'                            0557 01364000
         BNO   @RF00557                                            0557 01365000
*             DO;                   /* Q OR W START?                 */ 01366000
*                                                                  0558 01367000
*               /*****************************************************/ 01368000
*               /*                                                   */ 01369000
*               /* PREPARE INPUT TO ILRPREAD                         */ 01370000
*               /*                                                   */ 01371000
*               /*****************************************************/ 01372000
*                                                                  0559 01373000
*               PWRITE=OFF;         /* READ                          */ 01374000
*               PTPARB=ON;          /* TPARTBLE ENTRY                */ 01375000
         OI    PTPARB,B'01000000'                                  0560 01376000
         NI    PWRITE,B'01111111'                                  0560 01377000
*               PSLOT=ZERO;         /* RELATIVE SLOT ZERO            */ 01378000
         STH   @14,PSLOT                                           0561 01379000
*               PSLOTNO=ONE;        /* ONE SLOT TO READ              */ 01380000
         MVI   PSLOTNO,X'01'                                       0562 01381000
*               PENTRY=TPAEPTR;     /* ADDR OF TPARB ENTRY           */ 01382000
         L     @14,TPAEPTR                                         0563 01383000
         ST    @14,PENTRY                                          0563 01384000
*               PBUFF=BUFFPTR;      /* WHERE TO PUT READ DATA        */ 01385000
         L     @14,BUFFPTR                                         0564 01386000
         ST    @14,PBUFF                                           0564 01387000
*               R1=ADDR(READPARM);  /* PARM TO ILRPREAD              */ 01388000
         LA    R1,READPARM                                         0565 01389000
*               CALL ILRPREAD;      /* CALL ILRPREAD TO DO ONE READ  */ 01390000
         L     @15,RDWTPTR                                         0566 01391000
         BALR  @14,@15                                             0566 01392000
*               IF R15=ZERO THEN                                   0567 01393000
         LTR   R15,R15                                             0567 01394000
         BNZ   @RF00567                                            0567 01395000
*                 DO;               /* READ O.K.?                    */ 01396000
*                   RFY                                            0569 01397000
*                     R15 UNRSTD;                                  0569 01398000
*                   IF QSRSYNCH=BUFFPTR->TIMEBUF THEN              0570 01399000
         L     @08,QSRPTR                                          0570 01400000
         L     @06,BUFFPTR                                         0570 01401000
         CLC   QSRSYNCH(8,@08),TIMEBUF(@06)                        0570 01402000
         BNE   @RF00570                                            0570 01403000
*                     DO;           /* TIMESTAMPS MATCH?             */ 01404000
*                       SLOT=ZERO;  /* 1ST SLOT ( RELATIVE 0)        */ 01405000
         SLR   SLOT,SLOT                                           0572 01406000
*                       CALL MARKPAT;/* MARK SLOT IN USE             */ 01407000
         BAL   @14,MARKPAT                                         0573 01408000
*                       DUPXSUSE=ONE;/* 1ST DUPLEX SLOT USED         */ 01409000
         MVC   DUPXSUSE(4),@CF00059                                0574 01410000
*                     END;          /* END TIMESTAMP MATCH           */ 01411000
*                   ELSE                                           0576 01412000
*                     DO;           /* FAIL                          */ 01413000
         B     @RC00570                                            0576 01414000
@RF00570 DS    0H                                                  0577 01415000
*                       TPARENT=''B;/* ZERO ENTIRE TPARB ENTRY       */ 01416000
         L     @08,TPAEPTR                                         0577 01417000
         XC    TPARENT(96,@08),TPARENT(@08)                        0577 01418000
*                       TPAEDPLX=ON;/* PUT ONE FLAG IN ENTRY         */ 01419000
         OI    TPAEDPLX(@08),B'00100000'                           0578 01420000
*                       BADDS=NO;   /* TYPE OF MESSAGE               */ 01421000
         NI    BADDS,B'11111110'                                   0579 01422000
*                       CALL BADDUP;/* NO DUPLEXING                  */ 01423000
         BAL   @14,BADDUP                                          0580 01424000
*                     END;          /* FAILURES                      */ 01425000
*                 END;              /* READ O.K.                     */ 01426000
*               ELSE                                               0583 01427000
*                 DO;               /* FAILURES                      */ 01428000
         B     @RC00567                                            0583 01429000
@RF00567 DS    0H                                                  0584 01430000
*                   TPARENT=''B;    /* ZERO ENTIRE TPARB ENTRY       */ 01431000
         L     @08,TPAEPTR                                         0584 01432000
         XC    TPARENT(96,@08),TPARENT(@08)                        0584 01433000
*                   TPAEDPLX=ON;    /* PUT ONE FLAG IN ENTRY         */ 01434000
         OI    TPAEDPLX(@08),B'00100000'                           0585 01435000
*                   BADDS=NO;       /* TYPE OF MESSAGE               */ 01436000
         NI    BADDS,B'11111110'                                   0586 01437000
*                   CALL BADDUP;    /* NO DUPLEXING                  */ 01438000
         BAL   @14,BADDUP                                          0587 01439000
*                 END;              /* FAILURES                      */ 01440000
*             END;                  /* Q OR W START                  */ 01441000
*           ELSE                                                   0590 01442000
*             DO;                   /* COLD START                    */ 01443000
         B     @RC00557                                            0590 01444000
@RF00557 DS    0H                                                  0591 01445000
*               ASMDUPLX=YES;       /* WILL DUPLEX                   */ 01446000
         L     @08,CVTPTR                                          0591 01447000
         L     @08,ASMVTPTR(,@08)                                  0591 01448000
         OI    ASMDUPLX(@08),B'10000000'                           0591 01449000
*               TPAEDSN=DSTDSN;     /* PUT NAME IN TPARB             */ 01450000
         L     @08,TPAEPTR                                         0592 01451000
         MVC   TPAEDSN(44,@08),DSTDSN(DSTEPTR)                     0592 01452000
*               TPAEDSNL=DSTLNG;    /* PUT IN LENGTH                 */ 01453000
         IC    @06,DSTLNG(,DSTEPTR)                                0593 01454000
         STC   @06,TPAEDSNL(,@08)                                  0593 01455000
*               SLOT=ZERO;          /* RELATIVE SLOT 0               */ 01456000
         SLR   SLOT,SLOT                                           0594 01457000
*               CALL MARKPAT;       /* SLOT IN USE                   */ 01458000
         BAL   @14,MARKPAT                                         0595 01459000
*               DUPXSUSE=ONE;       /* 1ST SLOT USED                 */ 01460000
         MVC   DUPXSUSE(4),@CF00059                                0596 01461000
*             END;                  /* COLD START                    */ 01462000
*         END;                      /* TPARPATS O.K.                 */ 01463000
*       ELSE                                                       0599 01464000
*         DO;                       /* TPARPATS NOT O.K.             */ 01465000
         B     @RC00555                                            0599 01466000
@RF00555 DS    0H                                                  0600 01467000
*           BADDS=YES;              /* TYPE OF MESSAGE               */ 01468000
         OI    BADDS,B'00000001'                                   0600 01469000
*           CALL BADDUP;            /* MESSAGE AND NO DUPLEX         */ 01470000
         BAL   @14,BADDUP                                          0601 01471000
*         END;                      /* TPARPATS NOT O.K.             */ 01472000
*     END;                          /* OPEN O.K.                     */ 01473000
@RC00555 DS    0H                                                  0604 01474000
*DUPCOMP:                                                          0604 01475000
*   DUPLEXSW=OFF;                   /* DONE PROCESSING               */ 01476000
@RC00521 DS    0H                                                  0604 01477000
DUPCOMP  NI    DUPLEXSW,B'11111011'                                0604 01478000
*/*         IF QUICK OR WARM START AND PLPA HAD SLOTS SOLEY ON THE   */ 01479000
*/*       DUPLEX DATA SET, A MESSAGE TO WARN OF THIS IS ISSUED. ALSO */ 01480000
*/*       FORCE WAIT STATE, IF DUPLEXING WAS NOT OPENED THIS IPL.    */ 01481000
*                                                                  0605 01482000
*   IF NVTFLQS=YES THEN                                            0605 01483000
         L     @08,NVTPTR                                          0605 01484000
         TM    NVTFLQS(@08),B'00001000'                            0605 01485000
         BNO   @RF00605                                            0605 01486000
*     DO;                           /* QUICK OR WARM START?          */ 01487000
*       IF QSRPLPAF=ON&QSRCOMMF=ON THEN                            0607 01488000
         L     @08,QSRPTR                                          0607 01489000
         TM    QSRPLPAF(@08),B'11000000'                           0607 01490000
         BNO   @RF00607                                            0607 01491000
*         DO;                       /* BOTH OVERFLOW?                */ 01492000
*           MSGID=M927I;            /* WARNING MESSAGE               */ 01493000
         MVC   MSGID(4),@CC02561                                   0609 01494000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 01495000
         LA    R1,MSGPL                                            0610 01496000
*           CALL ILRIMMSG;          /* MESSAGE MODULE                */ 01497000
         L     @15,@CV02592                                        0611 01498000
         BALR  @14,@15                                             0611 01499000
*           IF ASMDUPLX=NO THEN                                    0612 01500000
         L     @08,CVTPTR                                          0612 01501000
         L     @08,ASMVTPTR(,@08)                                  0612 01502000
         TM    ASMDUPLX(@08),B'10000000'                           0612 01503000
         BNZ   @RF00612                                            0612 01504000
*             DO;                   /* NO DUPLEX DATA SET?           */ 01505000
*               MSGID=M935W;        /* RESOURCE NEEDED               */ 01506000
         MVC   MSGID(4),@CC02567                                   0614 01507000
*               R1=ADDR(MSGPL);     /* PARM TO ILRIMMSG              */ 01508000
         LA    R1,MSGPL                                            0615 01509000
*               CALL ILRIMMSG;      /* WAIT STATE                    */ 01510000
         L     @15,@CV02592                                        0616 01511000
         BALR  @14,@15                                             0616 01512000
*             END;                  /* NO DUPLEX DATA SET            */ 01513000
*           ELSE                                                   0618 01514000
*             ;                     /* WAS DUPLEX DATA SET           */ 01515000
@RF00612 DS    0H                                                  0619 01516000
*         END;                      /* BOTH OVERFLOW                 */ 01517000
*       ELSE                                                       0620 01518000
*         ;                         /* NOT BOTH OVERFLOWED           */ 01519000
@RF00607 DS    0H                                                  0621 01520000
*     END;                          /* QUICK OR WARM START           */ 01521000
*   ELSE                                                           0622 01522000
*     ;                             /* COLD START                    */ 01523000
@RF00605 DS    0H                                                  0623 01524000
*                                                                  0623 01525000
*/********************************************************************/ 01526000
*/*                                                                  */ 01527000
*/* OPENCOMM: SEGMENT TO OPEN COMMON DATA SET                        */ 01528000
*/*                                                                  */ 01529000
*/* INPUT: ILRDSTBL WITH COMMON DATA SET TO OPEN                     */ 01530000
*/*        ILRTPARB AS OUTPUT FROM OPENPLPA SEGMENT                  */ 01531000
*/*        ILRQSRCD FLAGS                                            */ 01532000
*/*        OLDCOM INTERNAL SWITCH                                    */ 01533000
*/*        NVT                                                       */ 01534000
*/*                                                                  */ 01535000
*/* PROCESS: USE COMMON IN ILRDSTBL IF COLD START OR QUICK START, OR */ 01536000
*/*          IF WARM START AND OLD ONE IS NOT NEEDED AND IS NOT      */ 01537000
*/*          A NEEDED LOCAL DATA SET.  UPON FAILURE TO OPEN,         */ 01538000
*/*          RESPECIFICATION IS ALLOWED.  IF THE OLD IS NEEDED, COLD */ 01539000
*/*          START IS FORCED.                                        */ 01540000
*/*              ON A NEEDED COMMON, THE TIMESTAMP OF DATA SET IS    */ 01541000
*/*          CHECKED AGAINST QSR TIMESTAMP. FAILURE HERE FORCES A    */ 01542000
*/*          COLD START.                                             */ 01543000
*/*                                                                  */ 01544000
*/* OUTPUT: A COMMON DATA SET OPEN, NAME IN ILRTPARB AND PAT BUILT   */ 01545000
*/*         COLD START FORCED IF BAD TIMESTAMP ON A NEEDED COMMON    */ 01546000
*/*         WAIT START IF UNABLE TO OPEN A COMMON DATA SET           */ 01547000
*/*                                                                  */ 01548000
*/********************************************************************/ 01549000
*/*OPENCOMM: CHART                                                   */ 01550000
*/*HEADER                                                          0623 01551000
*/*  OPENCOMM SEGMENT                                                */ 01552000
*/*OPENCOMM: E ENTRY TO OPEN COMMON DATA SET                         */ 01553000
*/*          D (YES,,NO,%A1) COMMONS MATCH?                          */ 01554000
*/*          P (,%A2) TURN ON OLDCOM SWITCH                          */ 01555000
*/*%A1:      D (YES,,NO,%A3) OLD COMMON NEEDED?                      */ 01556000
*/*          P MOVE OLD COMMON TO WORKAREA                           */ 01557000
*/*          P (,%A2) TURN ON OLDCOM SWITCH                          */ 01558000
*/*%A3:      D (YES,,NO,%A2) LOCALS IN TPARB?                        */ 01559000
*/*%A7:      D (YES,,NO,%A4) LOCAL MATCH COMMON?                     */ 01560000
*/*          D (YES,,NO,%A5) OLDCOM SWITCH ON?                       */ 01561000
*/*          S (,%A6) OPENB: NOT A GOOD COMMON                       */ 01562000
*/*%A5:      P MOVE OLD COMMON TO WORKAREA                           */ 01563000
*/*          P (,%A2) TURN ON OLDCOM SWITCH                          */ 01564000
*/*%A4:      P NEXT LOCAL IN TPARB                                   */ 01565000
*/*          D (NO,,YES,%A7) MORE LOCALS?                            */ 01566000
*/*%A2:      S OPEN: OPEN THIS COMMON                                */ 01567000
*/*          D (YES,,NO,%A8) OPEN O.K.?                              */ 01568000
*/*          D (NO,,YES,%A9) COMMONS MATCH?                          */ 01569000
*/*          P PUT NAME IN ILRTPARB                                  */ 01570000
*/*          P TURN ON COMMON FLAG IN ILRTPARB                       */ 01571000
*/*%A9:      S TPARPATS: FILL IN TPARB AND BUILD PAT                 */ 01572000
*/*          D (NO,,YES,%B1) PROBLEM AND COMMON NEEDED?              */ 01573000
*/*          D (YES,,NO,%B2) COMMON NEEDED?                          */ 01574000
*/*          S ILRPREAD: READ COMMON TIMESTAMP                       */ 01575000
*/*          D (YES,,NO,%B3) FAIL?                                   */ 01576000
*/*          S ILRIMMSG: BAD COMMON TIMESTAMP                        */ 01577000
*/*%B1:      S ILRIMMSG: RESOURCES NOT AVAILABLE                     */ 01578000
*/*          R WAIT STATE                                            */ 01579000
*/*%B3:      D (NO,,YES,%B2) TIMESTAMP O.K.?                         */ 01580000
*/*          S ILRIMMSG: BAD COMMON TIMESTAMP                        */ 01581000
*/*          S COMMCOLD: FORCE COLD START                            */ 01582000
*/*%B2:      S MARKPAT: MARK 1ST SLOT IN USE                         */ 01583000
*/*          P COMMON SLOT USE COUNT IS ONE                          */ 01584000
*/*          D (NO,,YES,%B5)  COLD START?                            */ 01585000
*/*          R FLOW CONTINUES AT RBLDPLPA                            */ 01586000
*/*%B5:      R FLOW CONTINUES AT OPENLOCL                            */ 01587000
*/*%A8:      D (YES,,NO,%B6) MOUNT FAIL?                             */ 01588000
*/*          S ILRIMMSG: ASK TO MOUNT MESSAGE                        */ 01589000
*/*          D (YES,,NO,%A2) OPER SAYS IGNORE IT?                    */ 01590000
*/*%B6:      D (YES,,NO,%A6) LOCATE FAIL ON NEEDED?                  */ 01591000
*/*          S COMMCOLD: FORCE COLD START                            */ 01592000
*/*%A6:      S OPENA: ASK FOR ANOTHER NAME                           */ 01593000
*/*          D (NO,,YES,%A3) NEW NAME?                               */ 01594000
*/*          D (NO,,YES,%B1) OLDCOM SWITCH ON & ^CLPA ?              */ 01595000
*/*          P MOVE OLD COMMON TO WORKAREA                           */ 01596000
*/*          P (,%A2) TURN ON OLDCOM SWITCH                          */ 01597000
*/*OPENCOMM: END                                                     */ 01598000
*                                                                  0623 01599000
*                                                                  0623 01600000
*   /*****************************************************************/ 01601000
*   /*                                                               */ 01602000
*   /* OPENCOMM                                                      */ 01603000
*   /*                                                               */ 01604000
*   /*****************************************************************/ 01605000
*                                                                  0623 01606000
*   TPAEPTR=COMTPTR;                /* COMMON IN ILRTPARB            */ 01607000
         L     @08,COMTPTR                                         0623 01608000
         ST    @08,TPAEPTR                                         0623 01609000
*   DSTEPTR=COMMPTR;                /* COMMON IN WORKAREA            */ 01610000
         L     DSTEPTR,COMMPTR                                     0624 01611000
*   IF DSTDSN=TPAEDSN THEN                                         0625 01612000
         CLC   DSTDSN(44,DSTEPTR),TPAEDSN(@08)                     0625 01613000
         BNE   @RF00625                                            0625 01614000
*     OLDCOM=YES;                   /* OLD COMMON?                   */ 01615000
         OI    OLDCOM,B'00010000'                                  0626 01616000
*   ELSE                                                           0627 01617000
*     DO;                           /* NOT OLD COMMON                */ 01618000
         B     @RC00625                                            0627 01619000
@RF00625 DS    0H                                                  0628 01620000
*       IF QSRPLPAF=ON THEN                                        0628 01621000
         L     @08,QSRPTR                                          0628 01622000
         TM    QSRPLPAF(@08),B'10000000'                           0628 01623000
         BNO   @RF00628                                            0628 01624000
*         DO;                       /* PLPA SPILLED TO COMMON?       */ 01625000
*           DSTDSN=TPAEDSN;         /* USE OLD COMMON                */ 01626000
         L     @08,TPAEPTR                                         0630 01627000
         MVC   DSTDSN(44,DSTEPTR),TPAEDSN(@08)                     0630 01628000
*           DSTLNG=TPAEDSNL;        /* LENGTH OF NAME                */ 01629000
         IC    @06,TPAEDSNL(,@08)                                  0631 01630000
         STC   @06,DSTLNG(,DSTEPTR)                                0631 01631000
*           LIST=ON;                /* CHANGED-- ISSUE IEA940I       */ 01632000
*           OLDCOM=YES;             /* MARK AS USED                  */ 01633000
         OI    LIST,B'01010000'                                    0633 01634000
*         END;                      /* PLPA SPILLED TO COMMON        */ 01635000
*       ELSE                                                       0635 01636000
*         DO;                       /* PLPA NOT SPILLED              */ 01637000
         B     @RC00628                                            0635 01638000
@RF00628 DS    0H                                                  0636 01639000
*           IF NVTFLWS=YES THEN                                    0636 01640000
         L     @08,NVTPTR                                          0636 01641000
         TM    NVTFLWS(@08),B'00000100'                            0636 01642000
         BNO   @RF00636                                            0636 01643000
*             DO;                   /* LOCALS IN ILRTPARB?           */ 01644000
*CHKCOMM:                                                          0638 01645000
*               SCHPTR=LOCTPTR;     /* 1ST LOCAL IN ILRTPARB         */ 01646000
CHKCOMM  L     SCHPTR,LOCTPTR                                      0638 01647000
*               MATCH=NO;           /* FLAG OFF                      */ 01648000
         NI    MATCH,B'01111111'                                   0639 01649000
*               COUNT=TPARUSE-INITUSE;/* COUNT OF LOCALS TO CHECK    */ 01650000
         L     @06,TPARPTR                                         0640 01651000
         L     @06,TPARUSE(,@06)                                   0640 01652000
         SL    @06,@CF00092                                        0640 01653000
         STH   @06,COUNT                                           0640 01654000
*               DO WHILE COUNT^=ZERO&MATCH=NO;/* LOCALS OR MATCH     */ 01655000
         B     @DE00641                                            0641 01656000
@DL00641 DS    0H                                                  0642 01657000
*                 IF SCHPTR->TPAEDSN=DSTDSN THEN/* MATCH COMMON?     */ 01658000
         CLC   TPAEDSN(44,SCHPTR),DSTDSN(DSTEPTR)                  0642 01659000
         BNE   @RF00642                                            0642 01660000
*                   IF OLDCOM=NO THEN                              0643 01661000
         TM    OLDCOM,B'00010000'                                  0643 01662000
         BNZ   @RF00643                                            0643 01663000
*                     DO;           /* NOT TRIED COMMON?             */ 01664000
*                       DSTDSN=TPAEDSN;/* USE OLD COMMON             */ 01665000
         L     @06,TPAEPTR                                         0645 01666000
         MVC   DSTDSN(44,DSTEPTR),TPAEDSN(@06)                     0645 01667000
*                       DSTLNG=TPAEDSNL;/* LENGTH TOO                */ 01668000
         IC    @00,TPAEDSNL(,@06)                                  0646 01669000
         STC   @00,DSTLNG(,DSTEPTR)                                0646 01670000
*                       LIST=ON;    /* CHANGED -- ISSUE IEA940I      */ 01671000
*                       OLDCOM=YES; /* MARK AS USED                  */ 01672000
         OI    LIST,B'01010000'                                    0648 01673000
*                       COUNT=ZERO; /* DATA SET TO USE-- STOP LOOP   */ 01674000
         SLR   @06,@06                                             0649 01675000
         STH   @06,COUNT                                           0649 01676000
*                     END;          /* NOT TRIED COMMON              */ 01677000
*                   ELSE                                           0651 01678000
*                     MATCH=YES;    /* MATCH AND NO SUBSTITUTE       */ 01679000
         B     @RC00643                                            0651 01680000
@RF00643 OI    MATCH,B'10000000'                                   0651 01681000
*                 ELSE                                             0652 01682000
*                   DO;             /* NOT MATCH                     */ 01683000
         B     @RC00642                                            0652 01684000
@RF00642 DS    0H                                                  0653 01685000
*                     COUNT=COUNT-ONE;/* ONE LOCAL DONE              */ 01686000
         LH    @06,COUNT                                           0653 01687000
         BCTR  @06,0                                               0653 01688000
         STH   @06,COUNT                                           0653 01689000
*                     SCHPTR=SCHPTR+LENGTH(TPARENT);/* NEXT LOCAL    */ 01690000
         AL    SCHPTR,@CF00073                                     0654 01691000
*                   END;            /* NOT MATCH                     */ 01692000
*               END;                /* LOCALS OR MATCH               */ 01693000
@RC00642 DS    0H                                                  0656 01694000
@DE00641 LH    @06,COUNT                                           0656 01695000
         LTR   @06,@06                                             0656 01696000
         BZ    @DC00641                                            0656 01697000
         TM    MATCH,B'10000000'                                   0656 01698000
         BZ    @DL00641                                            0656 01699000
@DC00641 DS    0H                                                  0657 01700000
*               IF MATCH=YES THEN                                  0657 01701000
         TM    MATCH,B'10000000'                                   0657 01702000
         BNO   @RF00657                                            0657 01703000
*                 DO;               /* CANNOT USE THE COMMON         */ 01704000
*                   CALL OPENB;     /* MESSAGE AND ASK FOR NEW NAME  */ 01705000
         BAL   @14,OPENB                                           0659 01706000
*                   GOTO ASKNAME;   /* CODE TO CHECK THE REPLY       */ 01707000
         B     ASKNAME                                             0660 01708000
*                 END;              /* CANNOT USE THE COMMON         */ 01709000
*               ELSE                                               0662 01710000
*                 ;                 /* CAN USE THE COMMON            */ 01711000
@RF00657 DS    0H                                                  0663 01712000
*             END;                  /* LOCALS IN ILRTPARB            */ 01713000
*           ELSE                                                   0664 01714000
*             ;                     /* NO LOCALS IN ILRTPARB         */ 01715000
@RF00636 DS    0H                                                  0665 01716000
*         END;                      /* PLPA NOT SPILLED              */ 01717000
*     END;                          /* NOT OLD COMMON                */ 01718000
@RC00628 DS    0H                                                  0667 01719000
*                                                                  0667 01720000
*/********************************************************************/ 01721000
*/*       ACTUAL OPEN OF COMMON                                      */ 01722000
*/********************************************************************/ 01723000
*                                                                  0667 01724000
*OPENCM:                                                           0667 01725000
*   PARMDSN=DSTDSN;                 /* WORKAREA NAME TO ILROPS00     */ 01726000
@RC00625 DS    0H                                                  0667 01727000
OPENCM   MVC   PARMDSN(44),DSTDSN(DSTEPTR)                         0667 01728000
*   PARMFLG=PARMPG;                 /* PAGE DATA SET TO OPEN         */ 01729000
         MVI   PARMFLG,X'80'                                       0668 01730000
*   RFY                                                            0669 01731000
*     R15 RSTD;                                                    0669 01732000
*   CALL OPEN;                      /* OPEN SUBROUTINE               */ 01733000
         BAL   @14,OPEN                                            0670 01734000
*   IF R15^=ZERO THEN                                              0671 01735000
         LTR   R15,R15                                             0671 01736000
         BZ    @RF00671                                            0671 01737000
*     DO;                           /* OPEN FAILED?                  */ 01738000
*       IF R15=NOVOLMNT THEN                                       0673 01739000
         C     R15,@CF00056                                        0673 01740000
         BNE   @RF00673                                            0673 01741000
*         DO;                       /* MOUNT FAIL?                   */ 01742000
*           MSGID=M924D;            /* ASK TO MOUNT                  */ 01743000
         MVC   MSGID(4),@CC02557                                   0675 01744000
*           MSGDATA1=ADDR(VOLSER);  /* VOL SER TO ILRIMMSG           */ 01745000
         LA    @14,PARMDSN                                         0676 01746000
         LA    @14,VOLSER(,@14)                                    0676 01747000
         ST    @14,MSGDATA1                                        0676 01748000
*           FLAGS=COMMEQ;           /* TYPE MSG FOR COMMON           */ 01749000
         MVI   FLAGS,X'08'                                         0677 01750000
*           R1=ADDR(MSGPL);         /* ADDR OF PARM                  */ 01751000
         LA    R1,MSGPL                                            0678 01752000
*           CALL ILRIMMSG;          /* MESSAGE MODULE                */ 01753000
         L     @15,@CV02592                                        0679 01754000
         BALR  @14,@15                                             0679 01755000
*           IF R1->MSGBUF(1:LENGTH(IGNORE))^=IGNORE THEN           0680 01756000
         CLC   MSGBUF(6,R1),@CC02477                               0680 01757000
         BE    @RF00680                                            0680 01758000
*             DO;                   /* GO?                           */ 01759000
*               GOTO OPENCM;        /* TRY TO OPEN AGAIN             */ 01760000
         B     OPENCM                                              0682 01761000
*             END;                  /* GO                            */ 01762000
*           ELSE                                                   0684 01763000
*             ;                     /* IGNORE WAS REPLY              */ 01764000
@RF00680 DS    0H                                                  0685 01765000
*         END;                      /* MOUNT FAIL                    */ 01766000
*       ELSE                                                       0686 01767000
*         ;                         /* LOCATE FAIL                   */ 01768000
*                                                                  0686 01769000
@RF00673 DS    0H                                                  0687 01770000
*       /*************************************************************/ 01771000
*       /*                                                           */ 01772000
*       /* LOCATE FAILURE TREATED SAME AS MOUNT IGNORE               */ 01773000
*       /*                                                           */ 01774000
*       /*************************************************************/ 01775000
*                                                                  0687 01776000
*       IF QSRPLPAF=ON THEN         /* THIS COMMON NEEDED?           */ 01777000
         L     @14,QSRPTR                                          0687 01778000
         TM    QSRPLPAF(@14),B'10000000'                           0687 01779000
         BNO   @RF00687                                            0687 01780000
*         CALL COMMCOLD;            /* FORCE COLD START              */ 01781000
         BAL   @14,COMMCOLD                                        0688 01782000
*       ELSE                                                       0689 01783000
*         ;                         /* DID NOT NEED THIS ONE         */ 01784000
@RF00687 DS    0H                                                  0690 01785000
*ASKNAME:                                                          0690 01786000
*       CALL OPENA;                 /* ASK FOR A NEW UNIQUE NAME     */ 01787000
ASKNAME  BAL   @14,OPENA                                           0690 01788000
*       IF R15=IGNORVOL THEN                                       0691 01789000
         C     R15,@CF00069                                        0691 01790000
         BNE   @RF00691                                            0691 01791000
*         DO;                       /* OPER SAID IGNORE?             */ 01792000
*           RFY                                                    0693 01793000
*             R15 UNRSTD;                                          0693 01794000
*           IF OLDCOM=NO&NVTFLQS=YES THEN                          0694 01795000
         TM    OLDCOM,B'00010000'                                  0694 01796000
         BNZ   @RF00694                                            0694 01797000
         L     @08,NVTPTR                                          0694 01798000
         TM    NVTFLQS(@08),B'00001000'                            0694 01799000
         BNO   @RF00694                                            0694 01800000
*             DO;                   /* PREVIOUS COMMON NOT TRIED?    */ 01801000
*               DSTDSN=TPAEDSN;     /* NAME TO WORKAREA              */ 01802000
         L     @08,TPAEPTR                                         0696 01803000
         MVC   DSTDSN(44,DSTEPTR),TPAEDSN(@08)                     0696 01804000
*               DSTLNG=TPAEDSNL;    /* LENGTH TO WORKAREA            */ 01805000
         IC    @06,TPAEDSNL(,@08)                                  0697 01806000
         STC   @06,DSTLNG(,DSTEPTR)                                0697 01807000
*               LIST=ON;            /* CHANGED -- ISSUE IEA940I      */ 01808000
*               OLDCOM=YES;         /* HAVE TRIED OLD COMMON NOW     */ 01809000
         OI    LIST,B'01010000'                                    0699 01810000
*               GOTO OPENCM;        /* TRY TO OPEN AGAIN             */ 01811000
         B     OPENCM                                              0700 01812000
*             END;                  /* PREVIOUS COMMON NOT TRIED     */ 01813000
*           ELSE                                                   0702 01814000
*             DO;                   /* OLD COMMON TRIED              */ 01815000
@RF00694 DS    0H                                                  0703 01816000
*               MSGID=M935W;        /* NO COMMON DATA SET            */ 01817000
         MVC   MSGID(4),@CC02567                                   0703 01818000
*               R1=ADDR(MSGPL);     /* PARM TO ILRIMMSG              */ 01819000
         LA    R1,MSGPL                                            0704 01820000
*               CALL ILRIMMSG;      /* WAIT STATE                    */ 01821000
         L     @15,@CV02592                                        0705 01822000
         BALR  @14,@15                                             0705 01823000
*             END;                  /* OLD COMMON TRIED              */ 01824000
*         END;                      /* OPER SAID IGNORE              */ 01825000
*       ELSE                                                       0708 01826000
*         DO;                       /* NEW NAME GIVEN                */ 01827000
         B     @RC00691                                            0708 01828000
@RF00691 DS    0H                                                  0709 01829000
*           IF NVTFLWS=YES THEN                                    0709 01830000
         L     @08,NVTPTR                                          0709 01831000
         TM    NVTFLWS(@08),B'00000100'                            0709 01832000
         BO    @RT00709                                            0709 01833000
*             GOTO CHKCOMM;         /* LOCALS TO CHECK?              */ 01834000
*           ELSE                                                   0711 01835000
*             DO;                   /* QUICK OF COLD START           */ 01836000
*               IF DSTDSN=TPAEDSN THEN                             0712 01837000
         L     @08,TPAEPTR                                         0712 01838000
         CLC   DSTDSN(44,DSTEPTR),TPAEDSN(@08)                     0712 01839000
         BNE   @RF00712                                            0712 01840000
*                 OLDCOM=YES;       /* USE IT NOW?                   */ 01841000
         OI    OLDCOM,B'00010000'                                  0713 01842000
*               GOTO OPENCM;        /* OPEN NEW NAME                 */ 01843000
         B     OPENCM                                              0714 01844000
*             END;                  /* QUICK OR COLD START           */ 01845000
*         END;                      /* NEW NAME GIVEN                */ 01846000
*     END;                          /* OPEN FAILED                   */ 01847000
*   ELSE                                                           0718 01848000
*     DO;                           /* OPEN O.K.                     */ 01849000
         B     @RC00671                                            0718 01850000
@RF00671 DS    0H                                                  0719 01851000
*       IF DSTDSN^=TPAEDSN THEN                                    0719 01852000
         L     @08,TPAEPTR                                         0719 01853000
         CLC   DSTDSN(44,DSTEPTR),TPAEDSN(@08)                     0719 01854000
         BE    @RF00719                                            0719 01855000
*         DO;                       /* NAME NOT ALREADY IN TPARB?    */ 01856000
*           TPARENT=''B;            /* ZERO THE TPARB ENTRY          */ 01857000
         XC    TPARENT(96,@08),TPARENT(@08)                        0721 01858000
*           TPAEDSN=DSTDSN;         /* NAME IN TPARB                 */ 01859000
         MVC   TPAEDSN(44,@08),DSTDSN(DSTEPTR)                     0722 01860000
*           TPAEDSNL=DSTLNG;        /* LENGTH IN TPARB               */ 01861000
         IC    @06,DSTLNG(,DSTEPTR)                                0723 01862000
         STC   @06,TPAEDSNL(,@08)                                  0723 01863000
*           TPAECOMM=ON;            /* THIS IS COMMON DATA SET       */ 01864000
         OI    TPAECOMM(@08),B'01000000'                           0724 01865000
*         END;                      /* NAME NOT ALREADY IN TPARB     */ 01866000
*       ELSE                                                       0726 01867000
*         ;                         /* NAME IN TPARB                 */ 01868000
@RF00719 DS    0H                                                  0727 01869000
*       RFY                                                        0727 01870000
*         R15 RSTD;                                                0727 01871000
*       CALL TPARPATS;              /* FILL IN REST AND PAT          */ 01872000
         BAL   @14,TPARPATS                                        0728 01873000
*       IF R15^=ZERO THEN                                          0729 01874000
         LTR   R15,R15                                             0729 01875000
         BZ    @RF00729                                            0729 01876000
*         DO;                       /* SLOTS DIFFERENT?              */ 01877000
*           MSGID=M935W;            /* NEEDED RESOURCE NOT RIGHT     */ 01878000
         MVC   MSGID(4),@CC02567                                   0731 01879000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 01880000
         LA    R1,MSGPL                                            0732 01881000
*           CALL ILRIMMSG;          /* WAIT STATE                    */ 01882000
         L     @15,@CV02592                                        0733 01883000
         BALR  @14,@15                                             0733 01884000
*         END;                      /* SLOTS DIFFERENT & NEED SAME   */ 01885000
*       ELSE                                                       0735 01886000
*         DO;                       /* TPARPATS O.K.                 */ 01887000
         B     @RC00729                                            0735 01888000
@RF00729 DS    0H                                                  0736 01889000
*           IF QSRPLPAF=ON THEN                                    0736 01890000
         L     @14,QSRPTR                                          0736 01891000
         TM    QSRPLPAF(@14),B'10000000'                           0736 01892000
         BNO   @RF00736                                            0736 01893000
*             DO;                   /* NEED TO CHECK TIMESTAMP?      */ 01894000
*               PWRITE=OFF;         /* READ                          */ 01895000
*               PTPARB=ON;          /* TPARTBLE ENTRY                */ 01896000
         OI    PTPARB,B'01000000'                                  0739 01897000
         NI    PWRITE,B'01111111'                                  0739 01898000
*               PSLOT=ZERO;         /* RELATIVE SLOT ZERO            */ 01899000
         SLR   @14,@14                                             0740 01900000
         STH   @14,PSLOT                                           0740 01901000
*               PSLOTNO=ONE;        /* ONE SLOT TO READ              */ 01902000
         MVI   PSLOTNO,X'01'                                       0741 01903000
*               PENTRY=TPAEPTR;     /* ADDR OF TPARB ENTRY           */ 01904000
         L     @14,TPAEPTR                                         0742 01905000
         ST    @14,PENTRY                                          0742 01906000
*               PBUFF=BUFFPTR;      /* WHERE TO PUT READ DATA        */ 01907000
         L     @14,BUFFPTR                                         0743 01908000
         ST    @14,PBUFF                                           0743 01909000
*               R1=ADDR(READPARM);  /* PARM TO ILRPREAD              */ 01910000
         LA    R1,READPARM                                         0744 01911000
*               CALL ILRPREAD;      /* READ AND WRITE MODULE         */ 01912000
         L     @15,RDWTPTR                                         0745 01913000
         BALR  @14,@15                                             0745 01914000
*               IF R15^=ZERO THEN                                  0746 01915000
         LTR   R15,R15                                             0746 01916000
         BZ    @RF00746                                            0746 01917000
*                 DO;               /* READ FAILED?                  */ 01918000
*                   RFY                                            0748 01919000
*                     R15 UNRSTD;                                  0748 01920000
*                   MSGID=M937I;    /* TIMESTAMP PROBLEM             */ 01921000
         MVC   MSGID(4),@CC02569                                   0749 01922000
*                   R1=ADDR(MSGPL); /* PARM TO ILRIMMSG              */ 01923000
         LA    R1,MSGPL                                            0750 01924000
*                   CALL ILRIMMSG;  /* MESSAGE MODULE                */ 01925000
         L     @15,@CV02592                                        0751 01926000
         BALR  @14,@15                                             0751 01927000
*                   MSGID=M935W;    /* COMMON NOT USEABLE            */ 01928000
         MVC   MSGID(4),@CC02567                                   0752 01929000
*                   R1=ADDR(MSGPL); /* PARM TO ILRIMMSG              */ 01930000
         LA    R1,MSGPL                                            0753 01931000
*                   CALL ILRIMMSG;  /* WAIT STATE                    */ 01932000
         L     @15,@CV02592                                        0754 01933000
         BALR  @14,@15                                             0754 01934000
*                 END;              /* READ FAIL                     */ 01935000
*               ELSE                                               0756 01936000
*                 DO;               /* READ O.K.                     */ 01937000
         B     @RC00746                                            0756 01938000
@RF00746 DS    0H                                                  0757 01939000
*                   IF QSRSYNCH^=BUFFPTR->TIMEBUF THEN             0757 01940000
         L     @08,QSRPTR                                          0757 01941000
         L     @06,BUFFPTR                                         0757 01942000
         CLC   QSRSYNCH(8,@08),TIMEBUF(@06)                        0757 01943000
         BE    @RF00757                                            0757 01944000
*                     DO;           /* BAD TIMESTAMP?                */ 01945000
*                       MSGID=M937I;/* BAD TIMESTAMP                 */ 01946000
         MVC   MSGID(4),@CC02569                                   0759 01947000
*                       R1=ADDR(MSGPL);/* PARM TO ILRIMMSG           */ 01948000
         LA    R1,MSGPL                                            0760 01949000
*                       CALL ILRIMMSG;/* MESSAGE MODULE              */ 01950000
         L     @15,@CV02592                                        0761 01951000
         BALR  @14,@15                                             0761 01952000
*                       CALL COMMCOLD;/* FORCE COLD START            */ 01953000
         BAL   @14,COMMCOLD                                        0762 01954000
*                     END;          /* BAD TIMESTAMP                 */ 01955000
*                   ELSE                                           0764 01956000
*                     ;             /* NOT BAD TIMESTAMP             */ 01957000
@RF00757 DS    0H                                                  0765 01958000
*                 END;              /* READ O.K.                     */ 01959000
*             END;                  /* NEED TO CHECK TIMESTAMP       */ 01960000
*           ELSE                                                   0767 01961000
*             ;                     /* NOT NEED TO CHECK TIMESTAMP   */ 01962000
@RF00736 DS    0H                                                  0768 01963000
*           SLOT=ZERO;              /* RELATIVE SLOT ZERO- TIMESTAMP */ 01964000
@RC00736 SLR   SLOT,SLOT                                           0768 01965000
*           CALL MARKPAT;           /* MARK THE PAT BIT ON           */ 01966000
         BAL   @14,MARKPAT                                         0769 01967000
*           COMMSUSE=ONE;           /* SET COMMON USE COUNT TO ONE   */ 01968000
         MVC   COMMSUSE(4),@CF00059                                0770 01969000
*           IF NVTFLQS=NO THEN                                     0771 01970000
         L     @08,NVTPTR                                          0771 01971000
         TM    NVTFLQS(@08),B'00001000'                            0771 01972000
         BZ    @RT00771                                            0771 01973000
*             GOTO OPENLOCL;        /* COLD IPL                      */ 01974000
*           ELSE                                                   0773 01975000
*             ;                     /* CONTINUE                      */ 01976000
*         END;                      /* TPARPATS O.K.                 */ 01977000
*     END;                          /* COMMON DATA SET OPEN O.K.     */ 01978000
@RC00729 DS    0H                                                  0776 01979000
*                                                                  0776 01980000
*/********************************************************************/ 01981000
*/*                                                                  */ 01982000
*/* RBLDPLPA: SEGMENT TO REBUILD PLPA SLOT INFORMATION IN XPTE'S     */ 01983000
*/*                                                                  */ 01984000
*/* INPUT: ILRQSRCD - SLOT INFORMATION FROM PREVIOUS IPL             */ 01985000
*/*        ILRPAT FOR PLPA DATA SET                                  */ 01986000
*/*        ILRPAT FOR COMMON DATA SET                                */ 01987000
*/*        ILRPAT FOR DUPLEX DATA SET, IF ANY                        */ 01988000
*/*        ILRASMVT AND ILRNVT                                       */ 01989000
*/*                                                                  */ 01990000
*/* PROCESS: ENTRY FROM OPENCOMM.  REBUILD PLPA ON QUICK OR WARM     */ 01991000
*/*          STARTS.  CALLS RSM'S RIM (IEAVNPB5) TO BUILD PAGE AND   */ 01992000
*/*          XPTE(EXTENDED PAGE) TABLES.  PUT SLOT INFORMATION INTO  */ 01993000
*/*          THE XPTE'S AND MARK SLOT IN USE IN ILRPAT FOR PLPA.  IF */ 01994000
*/*          DUPLEXING, ALSO MARK SLOT IN USE IN ILRPAT FOR DUPLEX.  */ 01995000
*/*            IF PROBLEMS, AND OPERATOR SAYS TO CONTINUE, COLD      */ 01996000
*/*          START IS FORCED, PAGE TABLES ARE FREED, AND ILRPAT(S)   */ 01997000
*/*          REINITIALIZED.                                          */ 01998000
*/*            IN ADDITION, ON ALL TYPES OF IPL, THE SLOTS IN PLPA   */ 01999000
*/*            THAT ARE TO BE ILRTPARB AND ILRQSRCD AREAS ARE MARKED */ 02000000
*/*            IN USE IN PLPA'S ILRPAT.                              */ 02001000
*/*                                                                  */ 02002000
*/* OUTPUT: ILRPAT'S OF PLPA AND DUPLEX ARE READY                    */ 02003000
*/*         IF STILL QUICK OR WARM START: PLPA DATA SET PAGE TABLES  */ 02004000
*/*         ARE BUILT AND SLOT INFORMATION FILLED IN                 */ 02005000
*/*                                                                  */ 02006000
*/********************************************************************/ 02007000
*/*RBLDPLPA: CHART (SEQ)                                             */ 02008000
*/*HEADER                                                          0776 02009000
*/*  RBLDPLPA SEGMENT                                                */ 02010000
*/*RBLDPLPA: E ENTRY TO REBUILD PLPA                                 */ 02011000
*/*          D (YES,,NO,%B5) PLPA D.S. FULL?                         */ 02012000
*/*          P MARK TWO BITS IN ASMVT                                */ 02013000
*/*          D (YES,,NO,%B5) COMMON D.S. FULL TOO?                   */ 02014000
*/*          P MARK BIT IN ASMVT                                     */ 02015000
*/*%B5:      S IEAVNPB5: BUILD PAGE TABLES                           */ 02016000
*/*          N FILL IN PAGE TABLES AND MARK PATS                     */ 02017000
*/*          P CALCULATE PAGES IN FIRST SEGMENT (PAGECTR)            */ 02018000
*/*          N ALL OTHER SEGMENTS HAVE 16 PAGES                      */ 02019000
*/*          P CALCULATE FIRST SEGMENT BOUNDARY                      */ 02020000
*/*%A4:      S IEAVFP1: LOCATE PAGE TABLE FOR THE PAGE               */ 02021000
*/*          D (NO,,YES,%A5) LOCATE IT?                              */ 02022000
*/*%A7:      S ILRIMMSG: ISSUE 'PAGE TABLE PROBLEM' MESSAGE          */ 02023000
*/*          R WAIT STATE                                            */ 02024000
*/*%A5:      D (NO,,YES,%A6) PAGECTR ZERO?                           */ 02025000
*/*          D (NO,,YES,%A7) EMPTY SLOT INFO?                        */ 02026000
*/*          D (NO,%A7,YES,%A8) VALID SLOT INFO?                     */ 02027000
*/*%A6:      P NEXT SEGMENT BOUNDARY                                 */ 02028000
*/*          D (YES,,NO,%B3) REACHED PLPA RANGE LIMIT?               */ 02029000
*/*          D (YES,,NO,%A2) WARM START?                             */ 02030000
*/*          R FLOW CONTINUES AT NEEDLOCL                            */ 02031000
*/*%A2:      R FLOW CONTINUES AT OPENLOCL                            */ 02032000
*/*%B3:      P (,%A4) PROCESS 16 PAGES (PAGECTR)                     */ 02033000
*/*%A8:      P MOVE QSR SLOT INFO INTO XPTE                          */ 02034000
*/*          P VALIDATE XPTE (BIT ON)                                */ 02035000
*/*          D (YES,,NO,%A1) FIRST PASS?                             */ 02036000
*/*          D (YES,,NO,%A3) PLPA?                                   */ 02037000
*/*          P (,%B1) INCREMENT PLPA COUNT                           */ 02038000
*/*%A3:      D (YES,,NO,%B2) COMMON?                                 */ 02039000
*/*          P (,%B1) INCREMENT COMMON COUNT                         */ 02040000
*/*%B2:      P INCREMENT DUPLEX COUNT                                */ 02041000
*/*%B1:      P (,%B4) PRIMARY SLOT INFORMATION PASSED                */ 02042000
*/*%A1:      P INCREMENT DUPLEX COUNT                                */ 02043000
*/*          P DUPLEX SLOT INFORMATION PASSED                        */ 02044000
*/*%B4:      S MARKPAT: MARK THE PAT FOR THIS SLOT                   */ 02045000
*/*          D (YES,,NO,%A5) CONE WITH THIS PAGE?                    */ 02046000
*/*          P NEXT QSR SLOT INFO                                    */ 02047000
*/*          P NEXT XPTE                                             */ 02048000
*/*          P (,%A5) DECREMENT PAGECTR BY ONE                       */ 02049000
*/*RBLDPLPA: END                                                     */ 02050000
*                                                                  0776 02051000
*RBLDPLPA:                                                         0776 02052000
*   IF QSRPLPAF=ON THEN                                            0776 02053000
@RC00671 DS    0H                                                  0776 02054000
RBLDPLPA L     @08,QSRPTR                                          0776 02055000
         TM    QSRPLPAF(@08),B'10000000'                           0776 02056000
         BNO   @RF00776                                            0776 02057000
*     DO;                           /* PLPA FULL AT NIP TIME?        */ 02058000
*       ASMPLPAF=ON;                /* MARK FULL IN ASMVT            */ 02059000
*       ASMPLPAS=ON;                /* ALSO PLPA SPILLED TO COMM     */ 02060000
         L     @06,CVTPTR                                          0779 02061000
         L     @06,ASMVTPTR(,@06)                                  0779 02062000
         OI    ASMPLPAF(@06),B'00000101'                           0779 02063000
*       IF QSRCOMMF=ON THEN                                        0780 02064000
         TM    QSRCOMMF(@08),B'01000000'                           0780 02065000
         BNO   @RF00780                                            0780 02066000
*         ASMCOMMF=ON;              /* COMMON FULL TOO               */ 02067000
         OI    ASMCOMMF(@06),B'00000010'                           0781 02068000
*       ELSE                                                       0782 02069000
*         ;                         /* COMMON NOT FULL               */ 02070000
@RF00780 DS    0H                                                  0783 02071000
*     END;                          /* PLPA FULL AT NIP TIME         */ 02072000
*   ELSE                                                           0784 02073000
*     ;                             /* PLPA NOT FULL AT NIP TIME     */ 02074000
@RF00776 DS    0H                                                  0785 02075000
*   RFY                                                            0785 02076000
*    (R2,                                                          0785 02077000
*     R3) RSTD;                                                    0785 02078000
*   LM(R2,R3,NIPPTRS);              /* NVT & CVT TO IEAVNPB5         */ 02079000
         LM    R2,R3,NIPPTRS                                       0786 02080000
*   CALL IEAVNPB5;                  /* BUILD PLPA PAGE TABLES        */ 02081000
         L     @15,@CV02597                                        0787 02082000
         BALR  @14,@15                                             0787 02083000
*   RFY                                                            0788 02084000
*    (R2,                                                          0788 02085000
*     R3) UNRSTD;                                                  0788 02086000
*   R1=QSRLPALO;                    /* LOW ADDRESS OF PLPA CORE      */ 02087000
         L     @06,QSRPTR                                          0789 02088000
         L     @15,QSRLPALO(,@06)                                  0789 02089000
         LR    R1,@15                                              0789 02090000
*   SLL(R1,SIXTEEN);                /* MOVE OUT SEGMENT PART         */ 02091000
         SLL   R1,16                                               0790 02092000
*   SRL(R1,28);                     /* MOVE PAGE PART WAY TO RGT     */ 02093000
         SRL   R1,28                                               0791 02094000
*   PAGECTR=SIXTEEN-R1;             /* # OF PLPA PAGES IN SEG        */ 02095000
         LA    @00,16                                              0792 02096000
         SLR   @00,R1                                              0792 02097000
         STH   @00,PAGECTR                                         0792 02098000
*   R1=QSRLPALO;                    /* LOW ADDRESS OF PLPA CORE      */ 02099000
         LR    R1,@15                                              0793 02100000
*   R1=R1&SEGMASK;                  /* GET SEGMENT ADDRESS           */ 02101000
         N     R1,SEGMASK                                          0794 02102000
*   SEGMAD=R1;                      /* FIRST SEGMENT ADDRESS         */ 02103000
         ST    R1,SEGMAD                                           0795 02104000
*   QSREPTR=ADDR(QSRMAP);           /* 1ST PLPA MAP IN QSR           */ 02105000
         LA    QSREPTR,QSRMAP(,@06)                                0796 02106000
*   FDPGPTR=QSRLPALO;               /* ADDRESS TO FIND XPTE FOR      */ 02107000
         ST    @15,FDPGPTR                                         0797 02108000
*   PROBLEM=NO;                     /* NO FAILURES YET               */ 02109000
         NI    PROBLEM,B'11011111'                                 0798 02110000
*   DO WHILE SEGMAD<QSRLPAHI&PROBLEM=NO;/* MARKING PATS              */ 02111000
         B     @DE00799                                            0799 02112000
@DL00799 DS    0H                                                  0800 02113000
*     R1=FDPGPTR;                   /* XPTE FOR THIS ADDRESS         */ 02114000
         L     R1,FDPGPTR                                          0800 02115000
*     RFY                                                          0801 02116000
*       R15 RSTD;                                                  0801 02117000
*     CALL IEAVFP1;                 /* FIND XPTE                     */ 02118000
         L     @06,CVTPTR                                          0802 02119000
         L     @15,CVTVFP(,@06)                                    0802 02120000
         BALR  @14,@15                                             0802 02121000
*     IF R15^=ZERO THEN                                            0803 02122000
         LTR   R15,R15                                             0803 02123000
         BZ    @RF00803                                            0803 02124000
*       PROBLEM=YES;                /* TROUBLE IN RSM                */ 02125000
         OI    PROBLEM,B'00100000'                                 0804 02126000
*     ELSE                                                         0805 02127000
*       DO;                         /* FOUND XPTE                    */ 02128000
         B     @RC00803                                            0805 02129000
@RF00803 DS    0H                                                  0806 02130000
*         RFY                                                      0806 02131000
*           R15 UNRSTD;                                            0806 02132000
*         XPTEPTR=R1;               /* PICK UP XPTE ADDRESS          */ 02133000
         ST    R1,XPTEPTR                                          0807 02134000
*         DO WHILE PAGECTR^=ZERO&PROBLEM=NO;/* DO PAGES IN SEGM      */ 02135000
         B     @DE00808                                            0808 02136000
@DL00808 DS    0H                                                  0809 02137000
*           IF QSRENTRY=ZERODW|     /* NO PLPA SLOT INFO             */ 02138000
*               QSRPTNN>PARTDUPN|   /* NOT VALID PRIMARY SLOT        */ 02139000
*               (QSRPTNN2^=ZERO&QSRPTNN2^=PARTDUPN) THEN           0809 02140000
         CLC   QSRENTRY(8,QSREPTR),ZERODW                          0809 02141000
         BE    @RT00809                                            0809 02142000
         CLI   QSRPTNN(QSREPTR),2                                  0809 02143000
         BH    @RT00809                                            0809 02144000
         CLI   QSRPTNN2(QSREPTR),0                                 0809 02145000
         BE    @RF00809                                            0809 02146000
         CLI   QSRPTNN2(QSREPTR),2                                 0809 02147000
         BE    @RF00809                                            0809 02148000
@RT00809 DS    0H                                                  0810 02149000
*             PROBLEM=YES;          /* EMPTY OR VALID DUPLEX SLOT    */ 02150000
         OI    PROBLEM,B'00100000'                                 0810 02151000
*           ELSE                                                   0811 02152000
*             DO;                   /* INFO IS O.K.                  */ 02153000
         B     @RC00809                                            0811 02154000
@RF00809 DS    0H                                                  0812 02155000
*               XPTVALID=ON;        /* ASM VALID FLAG                */ 02156000
         L     @06,XPTEPTR                                         0812 02157000
         OI    XPTVALID(@06),B'10000000'                           0812 02158000
*               XPTXAV=ON;          /* RSM VALID FLAG                */ 02159000
         OI    XPTXAV(@06),B'01000000'                             0813 02160000
*               XPTLPID=QSRENTRY;   /* PUT LSIDS IN XPTE             */ 02161000
         MVC   XPTLPID(8,@06),QSRENTRY(QSREPTR)                    0814 02162000
*               IF QSRPTNN=PARTPLPN THEN                           0815 02163000
         CLI   QSRPTNN(QSREPTR),0                                  0815 02164000
         BNE   @RF00815                                            0815 02165000
*                 DO;               /* PLPA DATA SET?                */ 02166000
*                   PATPTR=PLPTPTR->TPAEPATP;/* PLPA PAT             */ 02167000
         L     @06,PLPTPTR                                         0817 02168000
         L     @06,TPAEPATP(,@06)                                  0817 02169000
         ST    @06,PATPTR                                          0817 02170000
*                   PLPASUSE=PLPASUSE+ONE;/* ONE MORE SLOT           */ 02171000
         LA    @06,1                                               0818 02172000
         AL    @06,PLPASUSE                                        0818 02173000
         ST    @06,PLPASUSE                                        0818 02174000
*                 END;              /* PLPA DATA SET                 */ 02175000
*               ELSE                                               0820 02176000
*                 DO;               /* NOT PLPA DATA SET             */ 02177000
         B     @RC00815                                            0820 02178000
@RF00815 DS    0H                                                  0821 02179000
*                   IF QSRPTNN=PARTCOMN THEN                       0821 02180000
         CLI   QSRPTNN(QSREPTR),1                                  0821 02181000
         BNE   @RF00821                                            0821 02182000
*                     DO;           /* COMMON DATA SET?              */ 02183000
*                       PATPTR=COMTPTR->TPAEPATP;/* COMMON PAT       */ 02184000
         L     @06,COMTPTR                                         0823 02185000
         L     @06,TPAEPATP(,@06)                                  0823 02186000
         ST    @06,PATPTR                                          0823 02187000
*                       COMMSUSE=COMMSUSE+ONE;/* ONE MORE SLOT       */ 02188000
         LA    @06,1                                               0824 02189000
         AL    @06,COMMSUSE                                        0824 02190000
         ST    @06,COMMSUSE                                        0824 02191000
*                     END;          /* COMMON DATA SET               */ 02192000
*                   ELSE                                           0826 02193000
*                     DO;           /* OVERFLOWED TO DUPLEX ONLY     */ 02194000
         B     @RC00821                                            0826 02195000
@RF00821 DS    0H                                                  0827 02196000
*                       PATPTR=DPLTPTR->TPAEPATP;/* DUPLEX PAT       */ 02197000
         L     @06,DPLTPTR                                         0827 02198000
         L     @06,TPAEPATP(,@06)                                  0827 02199000
         ST    @06,PATPTR                                          0827 02200000
*                       DUPXSUSE=DUPXSUSE+ONE;/* ONE MORE SLOT       */ 02201000
         LA    @06,1                                               0828 02202000
         AL    @06,DUPXSUSE                                        0828 02203000
         ST    @06,DUPXSUSE                                        0828 02204000
*                     END;          /* DUPLEX DATA SET               */ 02205000
*                 END;              /* NOT PLPA DATA SET             */ 02206000
@RC00821 DS    0H                                                  0831 02207000
*               SLOT=QSRSLOT;       /* PRIMARY SLOT INFORMATION      */ 02208000
@RC00815 LH    SLOT,QSRSLOT(,QSREPTR)                              0831 02209000
         N     SLOT,@CF02910                                       0831 02210000
*               CALL MARKPAT;       /* MARK IN PAT-SLOT IN USE       */ 02211000
         BAL   @14,MARKPAT                                         0832 02212000
*               IF ASMDUPLX=YES&    /* SECONDARY SLOT TO DO?         */ 02213000
*                   QSRPTNN2^=ZERO THEN                            0833 02214000
         L     @06,CVTPTR                                          0833 02215000
         L     @06,ASMVTPTR(,@06)                                  0833 02216000
         TM    ASMDUPLX(@06),B'10000000'                           0833 02217000
         BNO   @RF00833                                            0833 02218000
         CLI   QSRPTNN2(QSREPTR),0                                 0833 02219000
         BE    @RF00833                                            0833 02220000
*                 DO;                                              0834 02221000
*                   PATPTR=DPLTPTR->TPAEPATP;/* DUPLEX PAT           */ 02222000
         L     @06,DPLTPTR                                         0835 02223000
         L     @06,TPAEPATP(,@06)                                  0835 02224000
         ST    @06,PATPTR                                          0835 02225000
*                   DUPXSUSE=DUPXSUSE+ONE;/* ONE MORE DUPLEX SLOT    */ 02226000
         LA    @06,1                                               0836 02227000
         AL    @06,DUPXSUSE                                        0836 02228000
         ST    @06,DUPXSUSE                                        0836 02229000
*                   SLOT=QSRSLOT2;  /* SECONDARY SLOT                */ 02230000
         LH    SLOT,QSRSLOT2(,QSREPTR)                             0837 02231000
         N     SLOT,@CF02910                                       0837 02232000
*                   CALL MARKPAT;   /* MARK IN PAT-SLOT              */ 02233000
         BAL   @14,MARKPAT                                         0838 02234000
*                 END;              /* SECONDARY SLOT TO DO          */ 02235000
*               ELSE                                               0840 02236000
*                 ;                 /* NO SECONDARY TO DO            */ 02237000
@RF00833 DS    0H                                                  0841 02238000
*             END;                  /* INFO IS O.K.                  */ 02239000
*           QSREPTR=QSREPTR+LENGTH(QSRENTRY);/* NEXT QSR MAP         */ 02240000
@RC00809 AL    QSREPTR,@CF00056                                    0842 02241000
*           XPTEPTR=XPTEPTR+LENGTH(XPTE);/* NEXT XPTE                */ 02242000
         LA    @06,12                                              0843 02243000
         AL    @06,XPTEPTR                                         0843 02244000
         ST    @06,XPTEPTR                                         0843 02245000
*           PAGECTR=PAGECTR-ONE;    /* ONE LESS PAGE                 */ 02246000
         LH    @06,PAGECTR                                         0844 02247000
         BCTR  @06,0                                               0844 02248000
         STH   @06,PAGECTR                                         0844 02249000
*         END;                      /* DO PAGES IN SEGMENT           */ 02250000
@DE00808 LH    @06,PAGECTR                                         0845 02251000
         LTR   @06,@06                                             0845 02252000
         BZ    @DC00808                                            0845 02253000
         TM    PROBLEM,B'00100000'                                 0845 02254000
         BZ    @DL00808                                            0845 02255000
@DC00808 DS    0H                                                  0846 02256000
*         SEGMAD=SEGMAD+SEGMENT;    /* NEXT SEGMENT ADDRESS          */ 02257000
         L     @06,@CF02518                                        0846 02258000
         AL    @06,SEGMAD                                          0846 02259000
         ST    @06,SEGMAD                                          0846 02260000
*         PAGECTR=SIXTEEN;          /* PAGES IN A SEGMENT            */ 02261000
         MVC   PAGECTR(2),@CH00111                                 0847 02262000
*         FDPGPTR=SEGMAD;           /* NEXT XPTE ADDRESS TO FINE     */ 02263000
         ST    @06,FDPGPTR                                         0848 02264000
*       END;                        /* FOUND XPTE                    */ 02265000
*   END;                            /* MARKING PATS                  */ 02266000
@RC00803 DS    0H                                                  0850 02267000
@DE00799 L     @06,QSRPTR                                          0850 02268000
         CLC   SEGMAD(4),QSRLPAHI(@06)                             0850 02269000
         BNL   @DC00799                                            0850 02270000
         TM    PROBLEM,B'00100000'                                 0850 02271000
         BZ    @DL00799                                            0850 02272000
@DC00799 DS    0H                                                  0851 02273000
*   IF PROBLEM=YES THEN                                            0851 02274000
         TM    PROBLEM,B'00100000'                                 0851 02275000
         BNO   @RF00851                                            0851 02276000
*     DO;                           /* TROUBLES IN MARKING PATS      */ 02277000
*       MSGID=M943W;                /* REBUILD PLPA FAILED           */ 02278000
         MVC   MSGID(4),@CC02581                                   0853 02279000
*       R1=ADDR(MSGPL);             /* PARM TO ILRIMMSG              */ 02280000
         LA    R1,MSGPL                                            0854 02281000
*       CALL ILRIMMSG;              /* WAIT STATE                    */ 02282000
         L     @15,@CV02592                                        0855 02283000
         BALR  @14,@15                                             0855 02284000
*     END;                          /* TROUBLES IN MARKING PATS      */ 02285000
*   ELSE                            /* COMPLETED MARKING O.K.        */ 02286000
*     IF NVTFLWS=NO THEN                                           0857 02287000
         B     @RC00851                                            0857 02288000
@RF00851 L     @08,NVTPTR                                          0857 02289000
         TM    NVTFLWS(@08),B'00000100'                            0857 02290000
         BZ    @RT00857                                            0857 02291000
*       GOTO OPENLOCL;              /* NO NEEDED LOCALS?             */ 02292000
*     ELSE                                                         0859 02293000
*       ;                           /* NEEDED LOCALS(WARM START)     */ 02294000
*                                                                  0860 02295000
*/********************************************************************/ 02296000
*/*                                                                  */ 02297000
*/* NEEDLOCL: SEGMENT TO IDENTIFY LOCALS SPECIFIED IN BOTH ILRTPARB  */ 02298000
*/*           (SPECIFIED PREVIOUS IPL) AND ILRDSTBL (SPECIFIED THIS  */ 02299000
*/*           IPL).  ALSO VERIGY THAT PREVIOUSLY SPECIFIED LOCALS    */ 02300000
*/*           ARE MOUNTED.                                           */ 02301000
*/*                                                                  */ 02302000
*/* INPUT: ILRTPARB AND ILRDSTBL UPON EXIT OF OPENDPLX               */ 02303000
*/*                                                                  */ 02304000
*/* PROCESS: LOOP THROUGH ILRDSTBL LOCAL ENTRIES FOR EACH ILRTPARB   */ 02305000
*/*          LOCAL ENTRY.  ANY MATCHES MARK ILRDSTBL ENTRY AS        */ 02306000
*/*          ALREADY BEING USED.  LOCATE AND MOUNT (ILROPS00) EACH   */ 02307000
*/*          ILRTPARB LOCAL (NEEDED LOCAL).  IF ALL NEEDED LOCALS    */ 02308000
*/*          ARE NOT MOUNTED, A CVIO START IS FORCED.                */ 02309000
*/*                                                                  */ 02310000
*/* OUTPUT: 1. CVIO FORCED IPL                                       */ 02311000
*/*          OR                                                      */ 02312000
*/*            NEEDED LOCALS MOUNTED                                 */ 02313000
*/*            ANY DUPLICATE NAMES IN ILRDSTBL MARKED AS SUCH        */ 02314000
*/*         2. NEEDEDL BIT ON                                        */ 02315000
*/*                                                                  */ 02316000
*/********************************************************************/ 02317000
*/*NEEDLOCL: CHART (SEQ)                                             */ 02318000
*/*HEADER                                                          0860 02319000
*/*  NEEDLOCL SEGMENT                                                */ 02320000
*/*NEEDLOCL: E ENTRY TO VERIFY NEEDED LOCALS ON WARM START           */ 02321000
*/*          P TURN ON NEEDEDL BIT                                   */ 02322000
*/*          P POINT TO FIRST LOCAL ENTRY IN ILRTPARB                */ 02323000
*/*%A1:      P POINT TO FIRST LOCAL ENTRY IN ILRDSTBL                */ 02324000
*/*%A2:      D (NO,,YES,%A3) CHECKED ALL ILRDSTBL ENTRIES?           */ 02325000
*/*          D (YES,,NO,%A4) MATCH LOCAL IN ILRTPARB?                */ 02326000
*/*          P (,%A3) MARK ILRDSTBL ENTRY AS ALREADY USED            */ 02327000
*/*%A4:      P (,%A2) NEXT ILRDSTBL ENTRY                            */ 02328000
*/*%A3:      P DSTEPTR POINTS TO DSNAME IN ILRTPARB ENTRY            */ 02329000
*/*          S LOCALN: LOCATE AND MOUNT LOCAL                        */ 02330000
*/*          D (NO,,YES,%A5) CVIO FORCED?                            */ 02331000
*/*          D (NO,,YES,%A6) MORE ILRTPARB ENTRIES?                  */ 02332000
*/*          R FLOW CONTINUES AT CHCKCOMM                            */ 02333000
*/*%A6:      P (,%A1) NEXT ILRTPARB ENTRY                            */ 02334000
*/*%A5:      P ZERO ILRTPARB ENTRIES FOR LOCALS                      */ 02335000
*/*          P REMOVE DUPLICATION MARKS IN ILRDSTBL                  */ 02336000
*/*          N DO NOT REMOVE DUPLICATE MARK IF OF DUPLEX D.S.        */ 02337000
*/*          R FLOW CONTINUES AT OPENLOCL                            */ 02338000
*/*NEEDLOCL: END                                                     */ 02339000
*                                                                  0860 02340000
*                                                                  0860 02341000
*   /*****************************************************************/ 02342000
*   /*                                                               */ 02343000
*   /* NEEDLOCL                                                      */ 02344000
*   /*                                                               */ 02345000
*   /*****************************************************************/ 02346000
*                                                                  0860 02347000
*   TPAEPTR=LOCTPTR;                /* 1ST LOCAL IN ILRTPARB         */ 02348000
@RC00851 L     @08,LOCTPTR                                         0860 02349000
         ST    @08,TPAEPTR                                         0860 02350000
*   NEEDEDL=YES;                    /* PROCESSING NEEDED LOCALS      */ 02351000
         OI    NEEDEDL,B'00000010'                                 0861 02352000
*   COUNT=TPARUSE-INITUSE;          /* COUNT OF LOCAL ENTRIES        */ 02353000
         L     @08,TPARPTR                                         0862 02354000
         L     @08,TPARUSE(,@08)                                   0862 02355000
         SL    @08,@CF00092                                        0862 02356000
         STH   @08,COUNT                                           0862 02357000
*   DO WHILE COUNT^=ZERO;           /* FOR ALL LOCALS IN TPARB       */ 02358000
         B     @DE00863                                            0863 02359000
@DL00863 DS    0H                                                  0864 02360000
*     SCHPTR=LOCLPTR;               /* 1ST LOCAL IN WORKAREA         */ 02361000
         L     SCHPTR,LOCLPTR                                      0864 02362000
*     MATCH=NO;                     /* MATCH INDICATOR               */ 02363000
         NI    MATCH,B'01111111'                                   0865 02364000
*     DO WHILE SCHPTR->DSTDSNC^=0&MATCH=NO;/* END OR MATCHES         */ 02365000
         B     @DE00866                                            0866 02366000
@DL00866 DS    0H                                                  0867 02367000
*       IF TPAEDSN=SCHPTR->DSTDSN THEN                             0867 02368000
         L     @06,TPAEPTR                                         0867 02369000
         CLC   TPAEDSN(44,@06),DSTDSN(SCHPTR)                      0867 02370000
         BNE   @RF00867                                            0867 02371000
*         DO;                       /* MATCHES?                      */ 02372000
*           SCHPTR->DSTUSED=ON;     /* NAME IS ALREADY BEING USED    */ 02373000
         OI    DSTUSED(SCHPTR),B'01000000'                         0869 02374000
*           MATCH=YES;              /* STOP SEARCH FOR MATCH         */ 02375000
         OI    MATCH,B'10000000'                                   0870 02376000
*         END;                      /* MATCHES                       */ 02377000
*       ELSE                                                       0872 02378000
*         SCHPTR=SCHPTR+LENGTH(DSTENT);/* NEXT WORKAREA ENTRY        */ 02379000
         B     @RC00867                                            0872 02380000
@RF00867 AL    SCHPTR,@CF00076                                     0872 02381000
*     END;                          /* END OR MATCH                  */ 02382000
@RC00867 DS    0H                                                  0873 02383000
@DE00866 CLI   DSTDSNC(SCHPTR),0                                   0873 02384000
         BE    @DC00866                                            0873 02385000
         TM    MATCH,B'10000000'                                   0873 02386000
         BZ    @DL00866                                            0873 02387000
@DC00866 DS    0H                                                  0874 02388000
*     PARMFLG=PARMPGSH;             /* INDICATE PAGE AND NO OPEN TO     02389000
*                                      ILROPS00                      */ 02390000
         MVI   PARMFLG,X'88'                                       0874 02391000
*     CALL LOCALN;                  /* HANDLE CALL TO ILROPS00       */ 02392000
         BAL   @14,LOCALN                                          0875 02393000
*     IF NVTFLWS=NO THEN                                           0876 02394000
         L     @08,NVTPTR                                          0876 02395000
         TM    NVTFLWS(@08),B'00000100'                            0876 02396000
         BNZ   @RF00876                                            0876 02397000
*       DO;                         /* CVIO WAS FORCED--STOP         */ 02398000
*         COUNT=ZERO;               /* STOP DO WHILE                 */ 02399000
*                                                                  0878 02400000
         SLR   @08,@08                                             0878 02401000
         STH   @08,COUNT                                           0878 02402000
*         /***********************************************************/ 02403000
*         /*                                                         */ 02404000
*         /* ZERO ALL LOCAL ENTRIES FROM LAST IPL                    */ 02405000
*         /*                                                         */ 02406000
*         /***********************************************************/ 02407000
*                                                                  0879 02408000
*         RFY                                                      0879 02409000
*          (R0,                                                    0879 02410000
*           R14,                                                   0879 02411000
*           R15) RSTD;                                             0879 02412000
*         R0=LOCTPTR;               /* 1ST LOCAL IN ILRTPARB         */ 02413000
         L     R0,LOCTPTR                                          0880 02414000
*         R1=(TPARUSE-INITUSE)*LENGTH(TPARENT);/* LENGTH OF LOCALS   */ 02415000
         L     @08,TPARPTR                                         0881 02416000
         L     R1,TPARUSE(,@08)                                    0881 02417000
         SL    R1,@CF00092                                         0881 02418000
         MH    R1,@CH00073                                         0881 02419000
*         R15=ZERO;                                                0882 02420000
         SLR   R15,R15                                             0882 02421000
*         MVCL(R0,R14);             /* ZERO ALL THE LOCAL ENTRIES    */ 02422000
         MVCL  R0,R14                                              0883 02423000
*         RFY                                                      0884 02424000
*          (R0,                                                    0884 02425000
*           R14,                                                   0884 02426000
*           R15) UNRSTD;                                           0884 02427000
*         TPARUSE=INITUSE;          /* ENTRIES IN USE NOW            */ 02428000
*                                                                  0885 02429000
         L     @08,TPARPTR                                         0885 02430000
         MVC   TPARUSE(4,@08),@CF00092                             0885 02431000
*         /***********************************************************/ 02432000
*         /*                                                         */ 02433000
*         /* UNMARK ANY DSTUSED FLAGS SET HERE -- NOT ALREADY BEING  */ 02434000
*         /* USED                                                    */ 02435000
*         /*                                                         */ 02436000
*         /***********************************************************/ 02437000
*                                                                  0886 02438000
*         DSTEPTR=LOCLPTR;          /* 1ST LOCAL ENTRY IN WORKAREA   */ 02439000
         L     DSTEPTR,LOCLPTR                                     0886 02440000
*         DO WHILE DSTDSNC^=0;      /* LOCALS TO END OF WORKAREA     */ 02441000
         B     @DE00887                                            0887 02442000
@DL00887 DS    0H                                                  0888 02443000
*           IF DSTUSED=ON&DSTDPLX=OFF/* MARKED IN NEEDLOCL?          */ 02444000
*             THEN                                                 0888 02445000
         TM    DSTUSED(DSTEPTR),B'01000000'                        0888 02446000
         BNO   @RF00888                                            0888 02447000
         TM    DSTDPLX(DSTEPTR),B'10000000'                        0888 02448000
         BNZ   @RF00888                                            0888 02449000
*             DSTUSED=OFF;                                         0889 02450000
         NI    DSTUSED(DSTEPTR),B'10111111'                        0889 02451000
*           ELSE                                                   0890 02452000
*             ;                     /* NOT MARKED IN NEEDLOCL        */ 02453000
@RF00888 DS    0H                                                  0891 02454000
*           DSTEPTR=DSTEPTR+LENGTH(DSTENT);/* NEXT LOCAL ENTRY       */ 02455000
         AL    DSTEPTR,@CF00076                                    0891 02456000
*         END;                      /* LOCALS TO END OF WORKAREA     */ 02457000
@DE00887 CLI   DSTDSNC(DSTEPTR),0                                  0892 02458000
         BNE   @DL00887                                            0892 02459000
*       END;                        /* CVIO WAS FORCED               */ 02460000
*     ELSE                                                         0894 02461000
*       DO;                         /* LOCALN WAS SUCCESSFUL         */ 02462000
         B     @RC00876                                            0894 02463000
@RF00876 DS    0H                                                  0895 02464000
*         COUNT=COUNT-ONE;          /* ONE LOCAL DONE                */ 02465000
         LH    @08,COUNT                                           0895 02466000
         BCTR  @08,0                                               0895 02467000
         STH   @08,COUNT                                           0895 02468000
*         TPAEPTR=TPAEPTR+LENGTH(TPARENT);/* NEXT TPARB ENTRY        */ 02469000
         LA    @08,96                                              0896 02470000
         AL    @08,TPAEPTR                                         0896 02471000
         ST    @08,TPAEPTR                                         0896 02472000
*       END;                        /* LOCALN WAS SUCCESSFUL         */ 02473000
*   END;                            /* LOOP THROUGH TPARB ENTRIES    */ 02474000
@RC00876 DS    0H                                                  0898 02475000
@DE00863 LH    @08,COUNT                                           0898 02476000
         LTR   @08,@08                                             0898 02477000
         BNZ   @DL00863                                            0898 02478000
*                                                                  0899 02479000
*/********************************************************************/ 02480000
*/*                                                                  */ 02481000
*/* OPENLOCL: OPEN BOTH NEEDED LOCALS AND THOSE SPECIFIED THIS IPL   */ 02482000
*/*                                                                  */ 02483000
*/* INPUT: ILRTPARB AND ILRDSTBL                                     */ 02484000
*/*        NEEDEDL BIT                                               */ 02485000
*/*                                                                  */ 02486000
*/* PROCESS: ENTERED FROM OPENCOMM OR NEEDLOCL.                      */ 02487000
*/*          OPEN ALL NEEDED LOCALS FIRST(THEY ARE IN ILRTPARB).     */ 02488000
*/*          SINCE NEEDLOCL SEGMENT VERIFIED ALL WERE MOUNTED, OPEN  */ 02489000
*/*          SHOULD NOT FAIL.  IF FAILURE DOES OCCUR LOCALS ALREADY  */ 02490000
*/*          OPENED WILL BE UTILIZED BY THIS IPL AS EMPTY DATA SETS. */ 02491000
*/*          THE ILRTPARB WILL BE CLEANED UP AND CVIO FORCED.        */ 02492000
*/*              AFTER TURNING OFF NEEDEDL BIT, OPENS ALL OTHER      */ 02493000
*/*          SPECIFIED LOCALS IN ILRDSTBL.  IF FAILURE AND NO NEW    */ 02494000
*/*          NAME GIVEN, THE DATA SET WILL BE IGNORED AND THE NEXT   */ 02495000
*/*          SPECIFIED DATA SET OPENED.                              */ 02496000
*/*             ALL ILRTPARB ENTRIES COMPLETE AND PAT FOR EACH DATA  */ 02497000
*/*          SET.                                                    */ 02498000
*/*                                                                  */ 02499000
*/* OUTPUT: NEEDEDL BIT OFF                                          */ 02500000
*/*         ALL LOCALS OPEN AND ILRTPARB ENTRIES FILLED IN           */ 02501000
*/*                                                                  */ 02502000
*/********************************************************************/ 02503000
*/*OPENLOCL: CHART                                                   */ 02504000
*/*HEADER                                                          0899 02505000
*/*  OPENLOCL SEGMENT                                                */ 02506000
*/*OPENLOCL: E ENTRY TO OPEN LOCAL PAGING DATA SETS                  */ 02507000
*/*          P POINT TO FIRST LOCAL IN ILRTPARB                      */ 02508000
*/*%A1:      D (YES,,NO,%A2) MORE LOCALS IN ILRTPARB?                */ 02509000
*/*          S LOCALN: OPEN NEEDED LOCAL                             */ 02510000
*/*          D (NO,,YES,%A3) CVIO FORCED?                            */ 02511000
*/*          S TPARPATS: FILL IN ILRTPARB AND BUILD PAT              */ 02512000
*/*          D (NO,,YES,%A4) TPARPATS O.K.?                          */ 02513000
*/*          S ILRIMMSG: ISSUE 'FORCE CVIO' MESSAGE                  */ 02514000
*/*          P (,%A3) CHANGE NVT IPL FLAGS                           */ 02515000
*/*%A4:      P INCREASE ASMSLOTS BY SIZE OF DATA SET                 */ 02516000
*/*          P (,%A1) NEXT ENTRY                                     */ 02517000
*/*%A3:      P DECREASE ILRTPARB USE COUNT (LOCALS NOT OPENED)       */ 02518000
*/*%A5:      D (NO,,YES,%A6) MORE LOCALS IN ILRTPARB?                */ 02519000
*/*          P (,%A1) ZERO UNUSED ENTRIES NOW                        */ 02520000
*/*%A6:      N LOOP THRU ILRDSTBL LOCALS FOR MATCH OF UNPROCESSED    */ 02521000
*/*          P POINT TO FIRST LOCAL IN ILRDSTBL                      */ 02522000
*/*%A8:      D (YES,,NO,%A5) MORE ILRDSTBL LOCALS?                   */ 02523000
*/*          D (YES,,NO,%A7) NAMES MATCH?                            */ 02524000
*/*          P (,%A5) UNMARK DUPLICATE NAMES (MARKED IN NEEDLOCL)    */ 02525000
*/*%A7:      P (,%A8) NEXT ENTRY                                     */ 02526000
*/*%A2:      P POINT TO FIRST LOCAL IN ILRDSTBL                      */ 02527000
*/*%B1:      D (NO,,YES,%B2) MORE LOCALS IN ILRDSTBL?                */ 02528000
*/*          D (NO,,YES,%B3) HAVE REQUIRED DATA SETS IN ILRTPARB?    */ 02529000
*/*          S ILRIMMSG: ISSUE MESSAGE IEA935W                       */ 02530000
*/*          R WAIT STATE 3C                                         */ 02531000
*/*%B3:      P BACKSLOTS SAME AS ASMSLOTS COUNT                      */ 02532000
*/*          P DECREMENT BACKSLOTS BY MASTER MEMORY SLOTS            */ 02533000
*/*          R FLOW CONTINUES AT TIMESTMP                            */ 02534000
*/*%B2:      D (YES,,NO,%B5) ILRTPARB FULL?                          */ 02535000
*/*          S ILRIMMSG: 'DATA SET NOT ACCEPTED' MESSAGE             */ 02536000
*/*          P (,%B1) MARK THIS ILRDSTBL ENTRY AS END OF  LIST       */ 02537000
*/*%B5:      D (NO,,YES,%C1) MARKED DUPLICATE OR MATCH COMMON?       */ 02538000
*/*%B6:      S OPEN: OPEN LOCAL                                      */ 02539000
*/*          D (NO,,YES,%C2) SUCCESSFUL OPEN?                        */ 02540000
*/*          D (YES,,NO,%B7) MOUNT FAIL?                             */ 02541000
*/*          S ILRIMMSG: 'MOUNT FAIL' MESSAGE                        */ 02542000
*/*          D (YES,,NO,%B6) OPERATOR REPLY 'IGNORE'?                */ 02543000
*/*%B8:      P (,%C1) MARK ENTRY TO NOT BE USED                      */ 02544000
*/*%B7:      N LOCATE FAILED                                         */ 02545000
*/*%B9:      S OPENA: ASK FOR NEW NAME                               */ 02546000
*/*          D (NO,,YES,%B8) REPLY 'IGNORE' TO LOCATE FAILURE?       */ 02547000
*/*          N GIVEN NEW NAME                                        */ 02548000
*/*          D (YES,,NO,%B6) WARM START?                             */ 02549000
*/*          N NEW NAME MUST BE UNIQUE IN ILRTPARB, NOT JUST ILRDSTBL*/ 02550000
*/*          P POINT TO FIRST LOCAL IN ILRTPARB                      */ 02551000
*/*%C3:      D (YES,,NO,%C4) NAMES MATCH?                            */ 02552000
*/*          S (,%B9) OPENB: NOT ACCEPTABLE, ASK FOR NEW NAME        */ 02553000
*/*%C4:      P NEXT ILRTPARB ENTRY                                   */ 02554000
*/*          D (YES,%C3,NO,%B6) MORE ILRTPARB ENTRIES?               */ 02555000
*/*%C2:      P MOVE NAME FROM ILRDSTBL TO ILRTPARB                   */ 02556000
*/*          S TPARPATS: FILL IN ILRTPARB ENTRY AND BUILD PAT        */ 02557000
*/*          P INCREASE ASMSLOTS BY SIZE OF DATA SET                 */ 02558000
*/*          P INCREASE ILRTPARB USE COUNT BY ONE                    */ 02559000
*/*          P NEXT ILRTPARB ENTRY                                   */ 02560000
*/*%C1:      P (,%B1) NEXT ILRDSTBL ENTRY                            */ 02561000
*/*OPENLOCL: END                                                     */ 02562000
*                                                                  0899 02563000
*OPENLOCL:                                                         0899 02564000
*   TPAEPTR=LOCTPTR;                /* 1ST LOCAL IN TPARB            */ 02565000
OPENLOCL L     @08,LOCTPTR                                         0899 02566000
         ST    @08,TPAEPTR                                         0899 02567000
*   COUNTL=TPARUSE-INITUSE;         /* NUMBER OF LOCALS IN TPARB     */ 02568000
         L     @08,TPARPTR                                         0900 02569000
         L     COUNTL,TPARUSE(,@08)                                0900 02570000
         SL    COUNTL,@CF00092                                     0900 02571000
*   PARMFLG=PARMPG;                 /* OPEN FLAG - PAGE DATA SETS    */ 02572000
         MVI   PARMFLG,X'80'                                       0901 02573000
*   DO WHILE COUNTL^=ZERO;          /* PROCESS LOCALS IN TPARB       */ 02574000
         B     @DE00902                                            0902 02575000
@DL00902 DS    0H                                                  0903 02576000
*     CALL LOCALN;                  /* OPEN DATA SET                 */ 02577000
         BAL   @14,LOCALN                                          0903 02578000
*     IF NVTFLWS=YES THEN                                          0904 02579000
         L     @08,NVTPTR                                          0904 02580000
         TM    NVTFLWS(@08),B'00000100'                            0904 02581000
         BNO   @RF00904                                            0904 02582000
*       DO;                         /* CVIO NOT FORCED?              */ 02583000
*         RFY                                                      0906 02584000
*           R15 RSTD;                                              0906 02585000
*         CALL TPARPATS;            /* FILL IN TPARB AND BUILD PAT   */ 02586000
         BAL   @14,TPARPATS                                        0907 02587000
*         IF R15^=ZERO THEN                                        0908 02588000
         LTR   R15,R15                                             0908 02589000
         BZ    @RF00908                                            0908 02590000
*           DO;                     /* TPARPATS ERROR?               */ 02591000
*             RFY                                                  0910 02592000
*               R15 UNRSTD;                                        0910 02593000
*             MSGID=M930I;          /* FORCE CVIO                    */ 02594000
         MVC   MSGID(4),@CC02565                                   0911 02595000
*             R1=ADDR(MSGPL);       /* PARM TO ILRIMMSG              */ 02596000
         LA    R1,MSGPL                                            0912 02597000
*             CALL ILRIMMSG;        /* MESSAGE MODULE                */ 02598000
         L     @15,@CV02592                                        0913 02599000
         BALR  @14,@15                                             0913 02600000
*             NVTFLWS=NO;           /* NOT WARM START NOW            */ 02601000
         L     @08,NVTPTR                                          0914 02602000
         NI    NVTFLWS(@08),B'11111011'                            0914 02603000
*           END;                    /* TPARPATS ERROR                */ 02604000
*         ELSE                                                     0916 02605000
*           DO;                     /* TPARPATS O.K.                 */ 02606000
         B     @RC00908                                            0916 02607000
@RF00908 DS    0H                                                  0917 02608000
*             ASMSLOTS=ASMSLOTS+TPAESZSL;/* TOTAL LOCAL SLOTS        */ 02609000
         L     @08,CVTPTR                                          0917 02610000
         L     @08,ASMVTPTR(,@08)                                  0917 02611000
         L     @06,TPAEPTR                                         0917 02612000
         L     @03,ASMSLOTS(,@08)                                  0917 02613000
         AL    @03,TPAESZSL(,@06)                                  0917 02614000
         ST    @03,ASMSLOTS(,@08)                                  0917 02615000
*             COUNTL=COUNTL-ONE;    /* ONE LESS LOCAL TO DO          */ 02616000
         BCTR  COUNTL,0                                            0918 02617000
*             TPAEPTR=TPAEPTR+LENGTH(TPARENT);/* NEXT LOCAL          */ 02618000
         AL    @06,@CF00073                                        0919 02619000
         ST    @06,TPAEPTR                                         0919 02620000
*           END;                    /* TPARPATS O.K.                 */ 02621000
*       END;                        /* CVIO NOT FORCED               */ 02622000
*     ELSE                                                         0922 02623000
*       ;                           /* CVIO FORCED BY LOCALN         */ 02624000
*                                                                  0922 02625000
@RF00904 DS    0H                                                  0923 02626000
*     /***************************************************************/ 02627000
*     /*                                                             */ 02628000
*     /* OPENING NEEDED LOCALS WITH SHORT PATH IN NEEDLOCL SEGMENT   */ 02629000
*     /* SHOULD MAKE THE BELOW SECTION OF CODE ALMOST IMPOSSIBLE TO  */ 02630000
*     /* OCCUR. IF SOME NEEDED LOCALS ARE OPEN NOW, CONTROL BLOCKS   */ 02631000
*     /* HAVE ALREADY BEEN BUILT, AND WILL BE USED BY ASM. THE REST  */ 02632000
*     /* OF NEEDED LOCALS WILL NOT BE OPENED, BUT IF SAME DATA SET IS*/ 02633000
*     /* IN ILRDSTBL(DSTUSED = ON) IT IS MADE AVAILABLE TO BE OPENED */ 02634000
*     /* FOR PROCESSING LOCALS IN WORKAREA. COUNT GOES TO ZERO, ALSO */ 02635000
*     /* IS ZERO FOR OUTER LOOP.                                     */ 02636000
*     /*                                                             */ 02637000
*     /***************************************************************/ 02638000
*                                                                  0923 02639000
*     IF NVTFLWS=NO THEN                                           0923 02640000
@RC00904 L     @08,NVTPTR                                          0923 02641000
         TM    NVTFLWS(@08),B'00000100'                            0923 02642000
         BNZ   @RF00923                                            0923 02643000
*       DO;                         /* CVIO FORCED- LOCALN OR ABOVE? */ 02644000
*         SAVECT=COUNTL;            /* SAVE THE COUNT                */ 02645000
         STH   COUNTL,SAVECT                                       0925 02646000
*         PLHPTR=TPAEPTR;           /* SAVE THIS ENTRY ADDRESS       */ 02647000
         L     @08,TPAEPTR                                         0926 02648000
         ST    @08,PLHPTR                                          0926 02649000
*         TPARUSE=TPARUSE-COUNTL;   /* REST OF LOCALS WILL BE ZEROED */ 02650000
         L     @08,TPARPTR                                         0927 02651000
         L     @06,TPARUSE(,@08)                                   0927 02652000
         SLR   @06,COUNTL                                          0927 02653000
         ST    @06,TPARUSE(,@08)                                   0927 02654000
*         DO WHILE COUNTL^=ZERO;    /* ALL OF THE REST               */ 02655000
         B     @DE00928                                            0928 02656000
@DL00928 DS    0H                                                  0929 02657000
*           SCHPTR=LOCLPTR;         /* CHECK WORKAREA FOR DUPS OF  0929 02658000
*                                      REST                          */ 02659000
         L     SCHPTR,LOCLPTR                                      0929 02660000
*           DO WHILE SCHPTR->DSTDSNC^=0&SCHPTR->DSTDSN^=TPAEDSN;   0930 02661000
         B     @DE00930                                            0930 02662000
@DL00930 DS    0H                                                  0931 02663000
*             SCHPTR=SCHPTR+LENGTH(DSTENT);/* NEXT WORKAREA ENTRY    */ 02664000
         AL    SCHPTR,@CF00076                                     0931 02665000
*           END;                    /* CHECK WORKAREA FOR DUPS OF  0932 02666000
*                                      REST                          */ 02667000
@DE00930 CLI   DSTDSNC(SCHPTR),0                                   0932 02668000
         BE    @DC00930                                            0932 02669000
         L     @06,TPAEPTR                                         0932 02670000
         CLC   DSTDSN(44,SCHPTR),TPAEDSN(@06)                      0932 02671000
         BNE   @DL00930                                            0932 02672000
@DC00930 DS    0H                                                  0933 02673000
*           IF SCHPTR->DSTDSN=TPAEDSN THEN/* IS A DUPLICATE          */ 02674000
         L     @06,TPAEPTR                                         0933 02675000
         CLC   DSTDSN(44,SCHPTR),TPAEDSN(@06)                      0933 02676000
         BNE   @RF00933                                            0933 02677000
*             SCHPTR->DSTUSED=OFF;  /* UNMARKED--ALREADY IN USE FLAG */ 02678000
         NI    DSTUSED(SCHPTR),B'10111111'                         0934 02679000
*           ELSE                                                   0935 02680000
*             ;                     /* NOT DUPLICATE                 */ 02681000
@RF00933 DS    0H                                                  0936 02682000
*           COUNTL=COUNTL-ONE;      /* ONE ENTRY DONE                */ 02683000
         BCTR  COUNTL,0                                            0936 02684000
*           TPAEPTR=TPAEPTR+LENGTH(TPARENT);/* NEXT TPAR ENTRY       */ 02685000
         LA    @08,96                                              0937 02686000
         AL    @08,TPAEPTR                                         0937 02687000
         ST    @08,TPAEPTR                                         0937 02688000
*         END;                      /* ALL OF THE REST               */ 02689000
@DE00928 LTR   COUNTL,COUNTL                                       0938 02690000
         BNZ   @DL00928                                            0938 02691000
*         RFY                                                      0939 02692000
*          (R0,                                                    0939 02693000
*           R14,                                                   0939 02694000
*           R15) RSTD;              /* ZERO THE REST OF LOCALS       */ 02695000
*         R0=PLHPTR;                /* FIRST ONE -- SAVED ADDRESS    */ 02696000
         L     R0,PLHPTR                                           0940 02697000
*         R1=SAVECT*LENGTH(TPARENT);/* LENGTH TO ZERO                */ 02698000
         LH    R1,SAVECT                                           0941 02699000
         MH    R1,@CH00073                                         0941 02700000
*         R15=ZERO;                                                0942 02701000
         SLR   R15,R15                                             0942 02702000
*         MVCL(R0,R14);             /* ZEROED                        */ 02703000
         MVCL  R0,R14                                              0943 02704000
*         RFY                                                      0944 02705000
*          (R0,                                                    0944 02706000
*           R14,                                                   0944 02707000
*           R15) UNRSTD;                                           0944 02708000
*         TPAEPTR=PLHPTR;           /* RESET NEXT TPARB ENTRY TO USE */ 02709000
         L     @08,PLHPTR                                          0945 02710000
         ST    @08,TPAEPTR                                         0945 02711000
*       END;                        /* CVIO FORCED BY LOCALN OR HERE */ 02712000
*     ELSE                                                         0947 02713000
*       ;                           /* CVIO NOT FORCED -- ALREADY  0947 02714000
*                                      DONE                          */ 02715000
@RF00923 DS    0H                                                  0948 02716000
*   END;                            /* PROCESS LOCALS IN TPARB       */ 02717000
@DE00902 LTR   COUNTL,COUNTL                                       0948 02718000
         BNZ   @DL00902                                            0948 02719000
*   NEEDEDL=OFF;                    /* DONE PROCESSING NEEDED LOCALS */ 02720000
         NI    NEEDEDL,B'11111101'                                 0949 02721000
*                                                                  0950 02722000
*   /*****************************************************************/ 02723000
*   /*                                                               */ 02724000
*   /* PROCESS LOCALS IN WORKAREA                                    */ 02725000
*   /*                                                               */ 02726000
*   /*****************************************************************/ 02727000
*                                                                  0950 02728000
*   DSTEPTR=LOCLPTR;                /* 1ST LOCAL IN WORKAREA         */ 02729000
         L     DSTEPTR,LOCLPTR                                     0950 02730000
*   DO WHILE DSTDSNC^=0;            /* DO ALL LOCALS IN WORKAREA     */ 02731000
         B     @DE00951                                            0951 02732000
@DL00951 DS    0H                                                  0952 02733000
*     IF TPARUSE=ENTSTPAR THEN                                     0952 02734000
         L     @08,TPARPTR                                         0952 02735000
         CLC   TPARUSE(4,@08),@CF00054                             0952 02736000
         BNE   @RF00952                                            0952 02737000
*       DO;                         /* TPARB FULL?                   */ 02738000
*         MSGID=M918I;              /* DSNAME NOT ACCEPTED           */ 02739000
         MVC   MSGID(4),@CC02547                                   0954 02740000
*         MSGDATA1=ADDR(DSTDSN);    /* DSNAME TO ILRIMMSG            */ 02741000
         ST    DSTEPTR,MSGDATA1                                    0955 02742000
*         FLAGS=PAGEQ;              /* PAGE NOT ACCEPTED             */ 02743000
         MVI   FLAGS,X'80'                                         0956 02744000
*         R1=ADDR(MSGPL);           /* PASS PARMS                    */ 02745000
         LA    R1,MSGPL                                            0957 02746000
*         CALL ILRIMMSG;            /* MESSAGE MODULE                */ 02747000
         L     @15,@CV02592                                        0958 02748000
         BALR  @14,@15                                             0958 02749000
*       END;                        /* TPARB FULL                    */ 02750000
*     ELSE                                                         0960 02751000
*       DO;                         /* TPARB NOT FULL                */ 02752000
         B     @RC00952                                            0960 02753000
@RF00952 DS    0H                                                  0961 02754000
*         IF DSTUSED=OFF&           /* NOT ALREADY IN TPARB & OPEN   */ 02755000
*             DSTDSN^=COMTPTR->DSTDSN THEN/* NOT USED AS COMMON D.S. */ 02756000
         TM    DSTUSED(DSTEPTR),B'01000000'                        0961 02757000
         BNZ   @RF00961                                            0961 02758000
         L     @08,COMTPTR                                         0961 02759000
         CLC   DSTDSN(44,DSTEPTR),DSTDSN(@08)                      0961 02760000
         BE    @RF00961                                            0961 02761000
*           DO;                                                    0962 02762000
*REDO:                                                             0963 02763000
*             PARMDSN=DSTDSN;       /* PUT IN WORKAREA NAME          */ 02764000
REDO     MVC   PARMDSN(44),DSTDSN(DSTEPTR)                         0963 02765000
*             RFY                                                  0964 02766000
*               R15 RSTD;                                          0964 02767000
*             CALL OPEN;            /* OPEN SUBROUTINE               */ 02768000
         BAL   @14,OPEN                                            0965 02769000
*             IF R15^=ZERO THEN                                    0966 02770000
         LTR   R15,R15                                             0966 02771000
         BZ    @RF00966                                            0966 02772000
*               DO;                 /* NOT OPEN SUCCESSFULLY         */ 02773000
*                 IF R15=NOVOLMNT THEN                             0968 02774000
         C     R15,@CF00056                                        0968 02775000
         BNE   @RF00968                                            0968 02776000
*                   DO;             /* MOUNT FAILED?                 */ 02777000
*                     MSGID=M923D;  /* ASK TO MOUNT                  */ 02778000
         MVC   MSGID(4),@CC02555                                   0970 02779000
*                     MSGDATA1=ADDR(VOLSER);/* VOL SER               */ 02780000
         LA    @14,PARMDSN                                         0971 02781000
         LA    @14,VOLSER(,@14)                                    0971 02782000
         ST    @14,MSGDATA1                                        0971 02783000
*                     FLAGS=PAGEQ;  /* TYPE OF D.S. IS PAGE          */ 02784000
         MVI   FLAGS,X'80'                                         0972 02785000
*                     R1=ADDR(MSGPL);/* PARM TO ILRIMMSG             */ 02786000
         LA    R1,MSGPL                                            0973 02787000
*                     CALL ILRIMMSG;/* MESSAGE MODULE                */ 02788000
         L     @15,@CV02592                                        0974 02789000
         BALR  @14,@15                                             0974 02790000
*                     IF R1->MSGBUF(1:LENGTH(IGNORE))^=IGNORE THEN 0975 02791000
         CLC   MSGBUF(6,R1),@CC02477                               0975 02792000
         BNE   @RT00975                                            0975 02793000
*                       GOTO REDO;  /* DID NOT SAY IGNORE            */ 02794000
*                     ELSE                                         0977 02795000
*                       DSTNUSED=ON;/* OPER SAID IGNORE(NOT TO USE)  */ 02796000
         OI    DSTNUSED(DSTEPTR),B'00100000'                       0977 02797000
*                   END;            /* MOUNT FAILED                  */ 02798000
*                 ELSE                                             0979 02799000
*                   DO;             /* LOCATE FAILED                 */ 02800000
         B     @RC00968                                            0979 02801000
@RF00968 DS    0H                                                  0980 02802000
*NAMEASK:                                                          0980 02803000
*                     CALL OPENA;   /* ASK FOR A DIFFERENT NAME      */ 02804000
NAMEASK  BAL   @14,OPENA                                           0980 02805000
*                     IF R15=IGNORVOL THEN                         0981 02806000
         C     R15,@CF00069                                        0981 02807000
         BNE   @RF00981                                            0981 02808000
*                       DO;         /* OPER SAID IGNORE?             */ 02809000
*                         RFY                                      0983 02810000
*                           R15 UNRSTD;                            0983 02811000
*                         DSTNUSED=ON;/* MARK AS NOT TO USE          */ 02812000
         OI    DSTNUSED(DSTEPTR),B'00100000'                       0984 02813000
*                       END;        /* OPER SAID IGNORE              */ 02814000
*/*             UNIQUE NEW NAME IN WORKAREA -- CHECK UNIQUE IN TPARB */ 02815000
*/*             IF THERE ARE LOCALS BECAUSE OF WARM START            */ 02816000
*                                                                  0986 02817000
*                     ELSE                                         0986 02818000
*                       DO;         /* UNIQUE NAME                   */ 02819000
         B     @RC00981                                            0986 02820000
@RF00981 DS    0H                                                  0987 02821000
*                         IF NVTFLWS=YES THEN                      0987 02822000
         L     @08,NVTPTR                                          0987 02823000
         TM    NVTFLWS(@08),B'00000100'                            0987 02824000
         BNO   @RF00987                                            0987 02825000
*                           DO;     /* LOCALS TO CHECK?              */ 02826000
*                             SCHPTR=LOCTPTR;/* 1ST LOCAL IN TPARB   */ 02827000
         L     SCHPTR,LOCTPTR                                      0989 02828000
*                             COUNT=TPARUSE-INITUSE;/* COUNT OF    0990 02829000
*                                      LOCALS                        */ 02830000
         L     @06,TPARPTR                                         0990 02831000
         L     @06,TPARUSE(,@06)                                   0990 02832000
         SL    @06,@CF00092                                        0990 02833000
         STH   @06,COUNT                                           0990 02834000
*                             DO WHILE COUNT^=ZERO&SCHPTR->TPAEDSN^=    02835000
*                                   DSTDSN;                        0991 02836000
         B     @DE00991                                            0991 02837000
@DL00991 DS    0H                                                  0992 02838000
*                               COUNT=COUNT-ONE;/* ONE LESS LOCAL TO    02839000
*                                      DO                            */ 02840000
         LH    @06,COUNT                                           0992 02841000
         BCTR  @06,0                                               0992 02842000
         STH   @06,COUNT                                           0992 02843000
*                               SCHPTR=SCHPTR+LENGTH(TPARENT);/* NEXT*/ 02844000
         AL    SCHPTR,@CF00073                                     0993 02845000
*                             END;  /* END OF SEARCH FOR MATCH       */ 02846000
@DE00991 LH    @06,COUNT                                           0994 02847000
         LTR   @06,@06                                             0994 02848000
         BZ    @DC00991                                            0994 02849000
         CLC   TPAEDSN(44,SCHPTR),DSTDSN(DSTEPTR)                  0994 02850000
         BNE   @DL00991                                            0994 02851000
@DC00991 DS    0H                                                  0995 02852000
*                             IF COUNT^=ZERO THEN                  0995 02853000
         LH    @08,COUNT                                           0995 02854000
         LTR   @08,@08                                             0995 02855000
         BZ    @RF00995                                            0995 02856000
*                               DO; /* FOUND A MATCH?                */ 02857000
*                                 CALL OPENB;/* BAD AND ASK AGAIN    */ 02858000
         BAL   @14,OPENB                                           0997 02859000
*                                 GOTO NAMEASK;/* CHECK OPER REPLY   */ 02860000
         B     NAMEASK                                             0998 02861000
*                               END;/* FOUND A MATCH IN TPARB        */ 02862000
*                             ELSE                                 1000 02863000
*                               GOTO REDO;/* NAME UNIQUE IN TPARB TOO*/ 02864000
*                           END;    /* LOCALS TO CHECK               */ 02865000
*                         ELSE                                     1002 02866000
*                           GOTO REDO;/* NOT LOCALS TO CHECK         */ 02867000
*                       END;        /* UNIQUE NAME                   */ 02868000
*                   END;            /* LOCATE FAILED                 */ 02869000
*               END;                /* NOT OPEN SUCCESSFULLY         */ 02870000
*             ELSE                                                 1006 02871000
*               DO;                 /* OPENED O.K.                   */ 02872000
         B     @RC00966                                            1006 02873000
@RF00966 DS    0H                                                  1007 02874000
*                 TPAEDSN=DSTDSN;   /* PUT IN NAME                   */ 02875000
         L     @08,TPAEPTR                                         1007 02876000
         MVC   TPAEDSN(44,@08),DSTDSN(DSTEPTR)                     1007 02877000
*                 TPAEDSNL=DSTLNG;  /* PUT IN LENGTH                 */ 02878000
         IC    @06,DSTLNG(,DSTEPTR)                                1008 02879000
         STC   @06,TPAEDSNL(,@08)                                  1008 02880000
*                 TPAELOCL=ON;      /* MARK AS LOCAL                 */ 02881000
         OI    TPAELOCL(@08),B'00010000'                           1009 02882000
*                 CALL TPARPATS;    /* FILL IN TPARB ENTRY & BUILD 1010 02883000
*                                      PAT                           */ 02884000
         BAL   @14,TPARPATS                                        1010 02885000
*                 ASMSLOTS=ASMSLOTS+TPAESZSL;/* ADD TO TOTAL LOCAL 1011 02886000
*                                      SLOT                          */ 02887000
         L     @08,CVTPTR                                          1011 02888000
         L     @08,ASMVTPTR(,@08)                                  1011 02889000
         L     @06,TPAEPTR                                         1011 02890000
         L     @00,ASMSLOTS(,@08)                                  1011 02891000
         AL    @00,TPAESZSL(,@06)                                  1011 02892000
         ST    @00,ASMSLOTS(,@08)                                  1011 02893000
*                 TPAEPTR=TPAEPTR+LENGTH(TPARENT);/* NEXT TPARB ENTRY*/ 02894000
         AL    @06,@CF00073                                        1012 02895000
         ST    @06,TPAEPTR                                         1012 02896000
*                 TPARUSE=TPARUSE+ONE;/* ONE MORE ENTRY IS USED      */ 02897000
         L     @08,TPARPTR                                         1013 02898000
         LA    @06,1                                               1013 02899000
         AL    @06,TPARUSE(,@08)                                   1013 02900000
         ST    @06,TPARUSE(,@08)                                   1013 02901000
*               END;                /* OPENED O.K                    */ 02902000
*           END;                    /* NOT ALREADY IN TPARB & OPEN   */ 02903000
*         ELSE                                                     1016 02904000
*           ;                       /* ALREADY IN TPARB & OPEN       */ 02905000
@RF00961 DS    0H                                                  1017 02906000
*       END;                        /* TPARB NOT FULL                */ 02907000
@RC00961 DS    0H                                                  1018 02908000
*     DSTEPTR=DSTEPTR+LENGTH(DSTENT);/* NEXT WORKAREA ENTRY          */ 02909000
@RC00952 AL    DSTEPTR,@CF00076                                    1018 02910000
*   END;                            /* DO ALL LOCALS IN WORKAREA     */ 02911000
@DE00951 CLI   DSTDSNC(DSTEPTR),0                                  1019 02912000
         BNE   @DL00951                                            1019 02913000
*   IF TPARUSE<MINPGSC THEN                                        1020 02914000
         L     @08,TPARPTR                                         1020 02915000
         L     @08,TPARUSE(,@08)                                   1020 02916000
         C     @08,@CF00069                                        1020 02917000
         BNL   @RF01020                                            1020 02918000
*     DO;                           /* NOT ENOUGH DATA SETS?         */ 02919000
*       MSGID=M935W;                /* NEEDED RESOURCES              */ 02920000
         MVC   MSGID(4),@CC02567                                   1022 02921000
*       R1=ADDR(MSGPL);             /* PARM TO ILRIMMSG              */ 02922000
         LA    R1,MSGPL                                            1023 02923000
*       CALL ILRIMMSG;              /* MESSAGE MODULE                */ 02924000
         L     @15,@CV02592                                        1024 02925000
         BALR  @14,@15                                             1024 02926000
*     END;                          /* NOT ENOUGH DATA SETS          */ 02927000
*   ELSE                            /* ENOUGH DATA SETS              */ 02928000
*     ASMBKSLT=ASMSLOTS;            /* INITIALIZE BACKING SLOTS      */ 02929000
         B     @RC01020                                            1026 02930000
@RF01020 L     @08,CVTPTR                                          1026 02931000
         L     @08,ASMVTPTR(,@08)                                  1026 02932000
         L     @00,ASMSLOTS(,@08)                                  1026 02933000
         ST    @00,ASMBKSLT(,@08)                                  1026 02934000
*                                                                  1027 02935000
*/********************************************************************/ 02936000
*/*                                                                  */ 02937000
*/* TIMESTMP: SEGMENT TO DO NECESSARY UNIQUE MARKING OF ILRTPARB,    */ 02938000
*/*           ILRQSRCD, AND DUPLEX DATA SET.                         */ 02939000
*/*                                                                  */ 02940000
*/* INPUT: ILRTPARB,ILRQSTCD, OPENED COMMON DATA SET,                */ 02941000
*/*        AND OPENED DUPLEX DATA SET(IF DUPLEXING)                  */ 02942000
*/*                                                                  */ 02943000
*/* PROCESS: ENTRY FROM OPENLOCL SEGMENT. TYPE OF IPL WILL NO LONGER */ 02944000
*/*          CHANGE IN ILRASRIM.  SINCE ILRTMI00 EXECUTES AFTER NVT  */ 02945000
*/*          (IPL FLAGS) IS AVAILABLE, WARM OR NOT WARM START IS     */ 02946000
*/*          INDICATED IN ILRTPARB.  TIMESTAMPS ARE DEPENDENT ON     */ 02947000
*/*          TYPE OF IPL.  IF WARM START, LEAVE TIMESTAMPS ALONE.    */ 02948000
*/*          IF COLD START ALL FOUR  MUST BE MARKED.  IF CVIO        */ 02949000
*/*          (QUICK START), PLPA RELATED ITEMS ARE UNCHANGED. ONLY   */ 02950000
*/*          ILRTPARB IS MARKED.                                     */ 02951000
*/*                                                                  */ 02952000
*/* OUTPUT: WARM START-  ILRTPARB INDICATES WARM START               */ 02953000
*/*         CVIO-        ILRTPARB HAS NEW TIMESTAMP                  */ 02954000
*/*         CLPA-        ILRTPARB, ILRQSRCD, COMMON DATA SET, AND    */ 02955000
*/*                          DUPLEX DATA SET HAVE A TIMESTAMP.       */ 02956000
*/*                                                                  */ 02957000
*/********************************************************************/ 02958000
*/*TIMESTMP: CHART                                                   */ 02959000
*/*HEADER                                                          1027 02960000
*/*  TIMESTMP SEGMENT                                                */ 02961000
*/*TIMESTMP: E ENTRY TO DO NECESSARY TIMESTAMPING                    */ 02962000
*/*          D (YES,,NO,%A1) WARM START?                             */ 02963000
*/*          P MARK WARM START IN ILRTPARB                           */ 02964000
*/*          P MARK NO LOCALS USEABLE (ASMVT)                        */ 02965000
*/*%A2:      R FLOW CONTINUES AT MOVEPCT                             */ 02966000
*/*%A1:      P TIMESTAMP ILRTPARB                                    */ 02967000
*/*          D (NO,,YES,%A3) TIMESTAMP O.K.?                         */ 02968000
*/*          S ILRIMMSG:ISSUE 'BAD CLOCK' MESSAGE                    */ 02969000
*/*          R WAIT STATE                                            */ 02970000
*/*%A3:      D (YES,,NO,%A2) COLD START?                             */ 02971000
*/*          P COPY TIMESTAMP TO ILRQSRCD                            */ 02972000
*/*          P ZERO 4K BUFFER AND PUT IN TIMESTAMP                   */ 02973000
*/*          S ILRPREAD: WRITE TIMESTAMP TO COMMON                   */ 02974000
*/*          D (NO,,YES,%A4) WRITE O.K.?                             */ 02975000
*/*          S ILRIMMSG: BAD COMMON TIMESTAMP                        */ 02976000
*/*          S ILRIMMSG: NEEDED RESOURCE                             */ 02977000
*/*          R WAIT STATE                                            */ 02978000
*/*%A4:      D (YES,,NO,%A2) DUPLEX THIS IPL?                        */ 02979000
*/*          S ILRPREAD: WRITE BUFFER TO 1ST SLOT ON DUPLEX D.S.     */ 02980000
*/*          D (NO,,YES,%A2) WRITE O.K.?                             */ 02981000
*/*          S ILRIMMSG: ISSUE 'NO DUPLEXING' MESSAGE                */ 02982000
*/*          P ZERO DUPLEX NAME IN ILRTPARB                          */ 02983000
*/*          P MARK ENTRY AS TO BE SKIPPED                           */ 02984000
*/*          P (,%A2) TURN OFF ASMVT DUPLEX FLAG                     */ 02985000
*/*TIMESTMP: END                                                     */ 02986000
*                                                                  1027 02987000
*                                                                  1027 02988000
*/*       TIMESTAMP ILRTPARB,ILRQSRCD,DUPLEX D.S. & COMMON D.S       */ 02989000
*                                                                  1027 02990000
*   IF NVTFLWS=YES THEN                                            1027 02991000
@RC01020 L     @08,NVTPTR                                          1027 02992000
         TM    NVTFLWS(@08),B'00000100'                            1027 02993000
         BNO   @RF01027                                            1027 02994000
*     DO;                           /* WARM START?                   */ 02995000
*       TPARWARM=ON;                /* MARK WARM START IN TPARB (TMI)*/ 02996000
         L     @08,TPARPTR                                         1029 02997000
         OI    TPARWARM(@08),B'10000000'                           1029 02998000
*       ASMQUICK=ON;                /* MARK QUICK START IN ASMVT     */ 02999000
*       ASMWARM=ON;                 /* MARK WARM START IN ASMVT      */ 03000000
         L     @08,CVTPTR                                          1031 03001000
         L     @08,ASMVTPTR(,@08)                                  1031 03002000
         OI    ASMQUICK(@08),B'00001100'                           1031 03003000
*       ASMNOLCL=ON;                /* MARK NO LOCALS AVAILABLE (TMI)*/ 03004000
         OI    ASMNOLCL(@08),B'00100000'                           1032 03005000
*     END;                          /* WARM START                    */ 03006000
*   ELSE                                                           1034 03007000
*     DO;                           /* COLD OR QUICK(CVIO) START     */ 03008000
         B     @RC01027                                            1034 03009000
@RF01027 DS    0H                                                  1035 03010000
*       RFY                                                        1035 03011000
*         R15 RSTD;                                                1035 03012000
*       R15=TPARPTR;                /* ADDRESS TPARTBLE FOR STCK     */ 03013000
         L     R15,TPARPTR                                         1036 03014000
*       GEN SETS(TPARTIME);                                        1037 03015000
*                                 /* TIMESTAMP ILRTPARB             */  03016000
   STCK TPARTIME(15)              REG 15 IS TPARPTR                     03017000
*       BC(12,GOODCLK);             /* BIT0 OR BIT1 SET IS O.K.(CC)  */ 03018000
         BC    12,GOODCLK                                          1038 03019000
*       MSGID=M945W;                /* BAD CLOCK MESSAGE             */ 03020000
         MVC   MSGID(4),@CC02585                                   1039 03021000
*       R1=ADDR(MSGPL);             /* PARM TO ILRIMMSG              */ 03022000
         LA    R1,MSGPL                                            1040 03023000
*       CALL ILRIMMSG;              /* WAIT STATE                    */ 03024000
         L     @15,@CV02592                                        1041 03025000
         BALR  @14,@15                                             1041 03026000
*GOODCLK:                           /* STCK SUCCESSFUL               */ 03027000
*       IF NVTFLQS=NO THEN                                         1042 03028000
GOODCLK  L     @14,NVTPTR                                          1042 03029000
         TM    NVTFLQS(@14),B'00001000'                            1042 03030000
         BNZ   @RF01042                                            1042 03031000
*         DO;                       /* COLD START?- STAMP PLPA ITEMS */ 03032000
*           QSRSYNCH=TPARTIME;      /* TIMESTAMP ILRQSRCD            */ 03033000
*                                                                  1044 03034000
         L     @14,QSRPTR                                          1044 03035000
         L     @08,TPARPTR                                         1044 03036000
         MVC   QSRSYNCH(8,@14),TPARTIME(@08)                       1044 03037000
*           /*********************************************************/ 03038000
*           /*                                                       */ 03039000
*           /* TIME STAMP COMMON AND DUPLEX D.S.                     */ 03040000
*           /*                                                       */ 03041000
*           /*********************************************************/ 03042000
*                                                                  1045 03043000
*           RFY                                                    1045 03044000
*            (R0,                                                  1045 03045000
*             R14) RSTD;            /* ZERO ENTIRE BUFFER            */ 03046000
*           R0=BUFFPTR;             /* FOURK BUFFER                  */ 03047000
         L     R0,BUFFPTR                                          1046 03048000
*           R1=FOURK;                                              1047 03049000
         L     R1,@CF02516                                         1047 03050000
*           R15=ZERO;                                              1048 03051000
         SLR   R15,R15                                             1048 03052000
*           MVCL(R0,R14);           /* ZEROED                        */ 03053000
         MVCL  R0,R14                                              1049 03054000
*           RFY                                                    1050 03055000
*            (R0,                                                  1050 03056000
*             R14,                                                 1050 03057000
*             R15) UNRSTD;                                         1050 03058000
*           BUFFPTR->TIMEBUF=TPARTIME;/* PUT TIMESTAMP IN BUFFER     */ 03059000
         L     @08,BUFFPTR                                         1051 03060000
         L     @15,TPARPTR                                         1051 03061000
         MVC   TIMEBUF(8,@08),TPARTIME(@15)                        1051 03062000
*           PWRITE=ON;              /* A WRITE REQUEST               */ 03063000
*           PTPARB=ON;              /* USE ILRTPARB ENTRY ADDRESS    */ 03064000
         OI    PWRITE,B'11000000'                                  1053 03065000
*           PSLOTNO=ONE;            /* ONE SLOT TO DO                */ 03066000
         MVI   PSLOTNO,X'01'                                       1054 03067000
*           PSLOT=''B;              /* RELATIVE SLOT ZERO            */ 03068000
         SLR   @00,@00                                             1055 03069000
         STH   @00,PSLOT                                           1055 03070000
*           PENTRY=COMTPTR;         /* COMMON D.S. ENTRY             */ 03071000
         L     @00,COMTPTR                                         1056 03072000
         ST    @00,PENTRY                                          1056 03073000
*           PBUFF=BUFFPTR;          /* BUFFER ADDRESS                */ 03074000
         ST    @08,PBUFF                                           1057 03075000
*           R1=ADDR(READPARM);      /* PARM TO ILRPREAD              */ 03076000
         LA    R1,READPARM                                         1058 03077000
*           RFY                                                    1059 03078000
*             R15 RSTD;                                            1059 03079000
*           CALL ILRPREAD;          /* CALL ILRPREAD                 */ 03080000
         L     @15,RDWTPTR                                         1060 03081000
         BALR  @14,@15                                             1060 03082000
*           IF R15^=ZERO THEN                                      1061 03083000
         LTR   R15,R15                                             1061 03084000
         BZ    @RF01061                                            1061 03085000
*             DO;                   /* FAIL?                         */ 03086000
*               MSGID=M937I;        /* COMMON HAS BAD TIMESTAMP      */ 03087000
         MVC   MSGID(4),@CC02569                                   1063 03088000
*               R1=ADDR(MSGPL);     /* PARM TO ILRIMMSG              */ 03089000
         LA    R1,MSGPL                                            1064 03090000
*               CALL ILRIMMSG;      /* MESSAGE MODULE                */ 03091000
         L     @15,@CV02592                                        1065 03092000
         BALR  @14,@15                                             1065 03093000
*               MSGID=M935W;        /* NEED RESOURCE PROBLEM         */ 03094000
         MVC   MSGID(4),@CC02567                                   1066 03095000
*               R1=ADDR(MSGPL);     /* PARM TO ILRIMMSG              */ 03096000
         LA    R1,MSGPL                                            1067 03097000
*               CALL ILRIMMSG;      /* WAIT STATE                    */ 03098000
         L     @15,@CV02592                                        1068 03099000
         BALR  @14,@15                                             1068 03100000
*             END;                  /* FAIL                          */ 03101000
*           ELSE                                                   1070 03102000
*             DO;                   /* IS O.K.                       */ 03103000
         B     @RC01061                                            1070 03104000
@RF01061 DS    0H                                                  1071 03105000
*               IF ASMDUPLX=YES THEN                               1071 03106000
         L     @14,CVTPTR                                          1071 03107000
         L     @14,ASMVTPTR(,@14)                                  1071 03108000
         TM    ASMDUPLX(@14),B'10000000'                           1071 03109000
         BNO   @RF01071                                            1071 03110000
*                 DO;               /* DUPLEXING THIS IPL?           */ 03111000
*                   PENTRY=DPLTPTR; /* CHANGE PARM TO DUPLEX D.S   1073 03112000
*                                      ENTRY                         */ 03113000
         L     @14,DPLTPTR                                         1073 03114000
         ST    @14,PENTRY                                          1073 03115000
*                   R1=ADDR(READPARM);/* PARM TO ILRPREAD            */ 03116000
         LA    R1,READPARM                                         1074 03117000
*                   CALL ILRPREAD;  /* CALL ILRPREAD                 */ 03118000
         L     @15,RDWTPTR                                         1075 03119000
         BALR  @14,@15                                             1075 03120000
*                   IF R15^=ZERO THEN                              1076 03121000
         LTR   R15,R15                                             1076 03122000
         BZ    @RF01076                                            1076 03123000
*                     DO;           /* FAIL?                         */ 03124000
*                       RFY                                        1078 03125000
*                         R15 UNRSTD;                              1078 03126000
*                       MSGID=M942I;/* DUPLEX HAS BAD TIMESTAMP      */ 03127000
         MVC   MSGID(4),@CC02579                                   1079 03128000
*                       MSGDATA1=ADDR(BADCLCK);/* PART OF MESSAGE    */ 03129000
         LA    @08,BADCLCK                                         1080 03130000
         ST    @08,MSGDATA1                                        1080 03131000
*                       R1=ADDR(MSGPL);/* PARM TO ILRIMMSG           */ 03132000
         LA    R1,MSGPL                                            1081 03133000
*                       CALL ILRIMMSG;/* MESSAGE MODULE              */ 03134000
         L     @15,@CV02592                                        1082 03135000
         BALR  @14,@15                                             1082 03136000
*                       DPLTPTR->TPARENT=''B;/* ZERO DUPLEX D.S.   1083 03137000
*                                      ENTRY                         */ 03138000
         L     @08,DPLTPTR                                         1083 03139000
         XC    TPARENT(96,@08),TPARENT(@08)                        1083 03140000
*                       DPLTPTR->TPAEDPLX=ON;/* FLAG AS DUPLEX       */ 03141000
         OI    TPAEDPLX(@08),B'00100000'                           1084 03142000
*                       DPLTPTR->TPAESKIP=ON;/* FLAG AS ENTRY TO SKIP*/ 03143000
         OI    TPAESKIP(@08),B'00010000'                           1085 03144000
*                       ASMDUPLX=NO;/* DUPLEXING NO MORE             */ 03145000
         L     @08,CVTPTR                                          1086 03146000
         L     @08,ASMVTPTR(,@08)                                  1086 03147000
         NI    ASMDUPLX(@08),B'01111111'                           1086 03148000
*                     END;          /* FAIL                          */ 03149000
*                   ELSE                                           1088 03150000
*                     ;             /* O.K.                          */ 03151000
@RF01076 DS    0H                                                  1089 03152000
*                 END;              /* DUPLEXING THIS IPL            */ 03153000
*               ELSE                                               1090 03154000
*                 ;                 /* NOT DUPLEXING THIS IPL        */ 03155000
@RF01071 DS    0H                                                  1091 03156000
*             END;                  /* COMMON WRITE O.K.             */ 03157000
*         END;                      /* COLD START                    */ 03158000
*       ELSE                                                       1093 03159000
*         ASMQUICK=ON;              /* QUICK START (MARK IN ASMVT)   */ 03160000
         B     @RC01042                                            1093 03161000
@RF01042 L     @08,CVTPTR                                          1093 03162000
         L     @08,ASMVTPTR(,@08)                                  1093 03163000
         OI    ASMQUICK(@08),B'00001000'                           1093 03164000
*     END;                          /* COLD OR QUICK(CVIO START      */ 03165000
@RC01042 DS    0H                                                  1095 03166000
*                                                                  1095 03167000
*/********************************************************************/ 03168000
*/*                                                                  */ 03169000
*/* MOVEPCT: SEGMENT TO MOVE PCT'S TO SQA AREA AND UPDATE POINTERS   */ 03170000
*/*          IN ILRTPARB ENTRIES                                     */ 03171000
*/*                                                                  */ 03172000
*/* INPUT: DEVTAB - HARDCODED AREA IN ILRASRIM WHOSE ENTRIES ARE PCTS*/ 03173000
*/*        ILRTPARB                                                  */ 03174000
*/*                                                                  */ 03175000
*/* PROCESS: ENTRY FROM TIMESTMP.  LOOP THROUGH ILRTPARB FOR EACH    */ 03176000
*/*          DEVTAB ENTRY (PCT).  CHANGE POINTER TO PCT FOR          */ 03177000
*/*          ALL ILRTPARB ENTRIES THAT ARE THIS DEVICE.              */ 03178000
*/*             PCTS WILL BE CHAINED AND ADDRESS OF FIRST IN ILRTPARB*/ 03179000
*/*                                                                  */ 03180000
*/* OUTPUT: PCTS FOR THIS IPL IN SQA, CHAINED(FAST TO SLOW DEVICE    */ 03181000
*/*            ORDER), AND POINTED TO BY ILRTPARB                    */ 03182000
*/*         ILRTPARB ENTRIES POINT TO PCTS IN SQA                    */ 03183000
*/*                                                                  */ 03184000
*/********************************************************************/ 03185000
*/*MOVEPCT: CHART                                                    */ 03186000
*/*HEADER                                                          1095 03187000
*/*  MOVEPCT SEGMENT                                                 */ 03188000
*/*MOVEPCT: E ENTRY TO COPY PCT'S                                    */ 03189000
*/*         L UNCONDITIONAL GETMAIN AREA FOR ALL PCT'S               */ 03190000
*/*         P ADDRESS OF PCT AREA IN TPARPCTQ                        */ 03191000
*/*         P SAVE END ADDRESS OF PCT AREA                           */ 03192000
*/*         P POINT TO FIRST DEVTAB ENTRY                            */ 03193000
*/*%A1:     P POINT TO FIRST ILRTPARB ENTRY                          */ 03194000
*/*         P MATCH INDICATOR IS OFF                                 */ 03195000
*/*%A2:     D (YES,,NO,%A3) DEVICE TYPE MATCH?                       */ 03196000
*/*         D (YES,,NO,%A4) FIRST MATCH?                             */ 03197000
*/*         P MATCH INDICATOR IS ON                                  */ 03198000
*/*         P COPY PCT FROM DEVTAB TO SQA                            */ 03199000
*/*         P FILL IN NEXT PCT ADDRESS                               */ 03200000
*/*%A4:     P UPDATE PCT ADDRESS IN ILRTPARB ENTRY                   */ 03201000
*/*%A3:     P NEXT ILRTPARB ENTRY                                    */ 03202000
*/*         D (NO,,YES,%A2) MORE ILRTPARB ENTRIES?                   */ 03203000
*/*         P NEXT DEVTAB ENTRY                                      */ 03204000
*/*         D (YES,,NO,%A5) MORE DEVTAB ENTRIES?                     */ 03205000
*/*         P (,%A1) NEXT PCT AREA                                   */ 03206000
*/*%A5:     P MARK PCT AS END OF PCT CHAIN                           */ 03207000
*/*         P CALCULATE REMAINDER OF PCT AREA                        */ 03208000
*/*         L FREEMAIN REMAINDER OF PCT AREA                         */ 03209000
*/*         R FLOW CONTINUES AT BLDPART                              */ 03210000
*/*MOVEPCT: END                                                      */ 03211000
*                                                                  1095 03212000
*                                                                  1095 03213000
*   /*****************************************************************/ 03214000
*   /*                                                               */ 03215000
*   /* MOVEPCT                                                       */ 03216000
*   /*                                                               */ 03217000
*   /*****************************************************************/ 03218000
*                                                                  1095 03219000
*   ENDPTR=ZERO;                    /* ZERO LENGTH                   */ 03220000
@RC01027 SLR   ENDPTR,ENDPTR                                       1095 03221000
*   DO I=1 TO DVTHEC BY 1;          /* TOTAL PCT LENGTH              */ 03222000
         LA    I,1                                                 1096 03223000
         B     @DE01096                                            1096 03224000
@DL01096 DS    0H                                                  1097 03225000
*     ENDPTR=ENDPTR+DVTLNG(I);      /* ADD LENGTH OF PCT             */ 03226000
         LR    @08,I                                               1097 03227000
         SLA   @08,2                                               1097 03228000
         AL    ENDPTR,DVTLNG-4(@08)                                1097 03229000
*   END;                            /* TOTAL PCT LENGTH              */ 03230000
         AL    I,@CF00059                                          1098 03231000
@DE01096 CH    I,DVTHEC                                            1098 03232000
         BNH   @DL01096                                            1098 03233000
*   RFY                                                            1099 03234000
*     R0 RSTD;                                                     1099 03235000
*   R0=ENDPTR;                      /* LENGTH TO GETMAIN             */ 03236000
         LR    R0,ENDPTR                                           1100 03237000
*   DO;                             /* GETMAIN (RU) LV(R0)         1101 03238000
*                                      SP(SQASPID)                   */ 03239000
*     RESPECIFY                                                    1102 03240000
*      (GPR01F,                                                    1102 03241000
*       GPR15F,                                                    1102 03242000
*       GPR00F) RESTRICTED;                                        1102 03243000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 03244000
         SLR   GPR01F,GPR01F                                       1103 03245000
*     GPR15F=2;                     /* RU-TYPE GETMAIN               */ 03246000
         LA    GPR15F,2                                            1104 03247000
*     GPR00F=R0;                    /* LENGTH REQUESTED              */ 03248000
*     GPR15F=GPR15F|((SQASPID)*256);/* SP IN BYTE 2                  */ 03249000
         O     GPR15F,@CF02881                                     1106 03250000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 03251000
         SVC   120                                                 1107 03252000
*     RESPECIFY                                                    1108 03253000
*      (GPR01F,                                                    1108 03254000
*       GPR15F,                                                    1108 03255000
*       GPR00F) UNRESTRICTED;                                      1108 03256000
*   END;                            /* GETMAIN (RU) LV(R0)         1109 03257000
*                                      SP(SQASPID)                   */ 03258000
*   RFY                                                            1110 03259000
*     R0 UNRSTD;                                                   1110 03260000
*   PCTPTR=R1;                      /* 1ST PCT IN SQA                */ 03261000
         ST    R1,PCTPTR                                           1111 03262000
*   ENDPTR=PCTPTR+ENDPTR;           /* END OF AREA GOTTEN            */ 03263000
         L     @06,PCTPTR                                          1112 03264000
         ALR   ENDPTR,@06                                          1112 03265000
*   SCHPTR=ADDR(DVTENT);            /* 1ST DEVTAB PCT                */ 03266000
         LA    SCHPTR,DVTENT                                       1113 03267000
*   DO J=1 TO DVTHEC;               /* EVERY DEVTAB PCT              */ 03268000
         LA    J,1                                                 1114 03269000
         B     @DE01114                                            1114 03270000
@DL01114 DS    0H                                                  1115 03271000
*     TPAEPTR=ADDR(TPARPENT);       /* 1ST ILRTPARB ENTRY            */ 03272000
         L     @06,TPARPTR                                         1115 03273000
         LA    @03,TPARPENT(,@06)                                  1115 03274000
         ST    @03,TPAEPTR                                         1115 03275000
*     ENTRIES=TPARUSE;              /* ALL TPARB ENTRIES             */ 03276000
         L     @06,TPARUSE(,@06)                                   1116 03277000
         STH   @06,ENTRIES                                         1116 03278000
*     MATCH=NO;                     /* USE TO MARK FIRST MATCH OF DEV*/ 03279000
         NI    MATCH,B'01111111'                                   1117 03280000
*     DO WHILE ENTRIES^=ZERO;       /* SEARCH ALL ILRTPARB ENTRIES   */ 03281000
         B     @DE01118                                            1118 03282000
@DL01118 DS    0H                                                  1119 03283000
*       IF TPAEPCT=SCHPTR THEN                                     1119 03284000
         L     @06,TPAEPTR                                         1119 03285000
         C     SCHPTR,TPAEPCT(,@06)                                1119 03286000
         BNE   @RF01119                                            1119 03287000
*         DO;                       /* FOUND RIGHT PCT?              */ 03288000
*           IF MATCH=NO THEN                                       1121 03289000
         TM    MATCH,B'10000000'                                   1121 03290000
         BNZ   @RF01121                                            1121 03291000
*             DO;                   /* 1ST TIME FOUND?               */ 03292000
*               MATCH=YES;          /* MARK AS FOUND                 */ 03293000
         OI    MATCH,B'10000000'                                   1123 03294000
*               RFY                                                1124 03295000
*                (R0,                                              1124 03296000
*                 R14,                                             1124 03297000
*                 R15) RSTD;                                       1124 03298000
*               R0=PCTPTR;          /* SQA POINTER                   */ 03299000
         L     R0,PCTPTR                                           1125 03300000
*               R14=SCHPTR;         /* HARDCODED PCT POINTER         */ 03301000
         LR    R14,SCHPTR                                          1126 03302000
*               R1=DVTLNG(J);       /* LENGTH OF PCT                 */ 03303000
         LR    @06,J                                               1127 03304000
         SLA   @06,2                                               1127 03305000
         L     R1,DVTLNG-4(@06)                                    1127 03306000
*               R15=R1;             /* LENGTH OF PCT                 */ 03307000
         LR    R15,R1                                              1128 03308000
*               MVCL(R0,R14);       /* COPY HARDCODED PCT TO SQA     */ 03309000
         MVCL  R0,R14                                              1129 03310000
*               RFY                                                1130 03311000
*                (R0,                                              1130 03312000
*                 R14,                                             1130 03313000
*                 R15) UNRSTD;                                     1130 03314000
*               PCTNEXT=TPARPCTQ;   /* CHAIN TO PREVIOUS SQA PCT     */ 03315000
         L     @06,PCTPTR                                          1131 03316000
         L     @03,TPARPTR                                         1131 03317000
         L     @00,TPARPCTQ(,@03)                                  1131 03318000
         ST    @00,PCTNEXT(,@06)                                   1131 03319000
*               TPARPCTQ=PCTPTR;    /* FASTEST DEVICE PCT IN TPARB   */ 03320000
         ST    @06,TPARPCTQ(,@03)                                  1132 03321000
*               PCTPTR=PCTPTR+DVTLNG(J);/* NEXT SQA PTR              */ 03322000
         LR    @03,J                                               1133 03323000
         SLA   @03,2                                               1133 03324000
         AL    @06,DVTLNG-4(@03)                                   1133 03325000
         ST    @06,PCTPTR                                          1133 03326000
*             END;                  /* 1ST TIME FOUND                */ 03327000
*           ELSE                                                   1135 03328000
*             ;                     /* MORE TIMES FOUND - NO COPY    */ 03329000
@RF01121 DS    0H                                                  1136 03330000
*           TPAEPCT=TPARPCTQ;       /* POINT TO LAST SQA PCT BUILT   */ 03331000
         L     @06,TPARPTR                                         1136 03332000
         L     @06,TPARPCTQ(,@06)                                  1136 03333000
         L     @03,TPAEPTR                                         1136 03334000
         ST    @06,TPAEPCT(,@03)                                   1136 03335000
*         END;                      /* FOUND RIGHT PCT               */ 03336000
*       ELSE                                                       1138 03337000
*         ;                         /* NOT RIGHT PCT                 */ 03338000
@RF01119 DS    0H                                                  1139 03339000
*       TPAEPTR=TPAEPTR+LENGTH(TPARENT);/* NEXT TPARB ENTRY          */ 03340000
         LA    @06,96                                              1139 03341000
         AL    @06,TPAEPTR                                         1139 03342000
         ST    @06,TPAEPTR                                         1139 03343000
*       ENTRIES=ENTRIES-ONE;        /* ONE ENTRY SEARCHED            */ 03344000
         LH    @06,ENTRIES                                         1140 03345000
         BCTR  @06,0                                               1140 03346000
         STH   @06,ENTRIES                                         1140 03347000
*     END;                          /* SEARCH ALL ILRTPARB ENTRIES   */ 03348000
@DE01118 LH    @06,ENTRIES                                         1141 03349000
         LTR   @06,@06                                             1141 03350000
         BNZ   @DL01118                                            1141 03351000
*     SCHPTR=SCHPTR+DVTLNG(J);      /* NEXT DEVTAB ENTRY (PCT)       */ 03352000
         LR    @06,J                                               1142 03353000
         SLA   @06,2                                               1142 03354000
         AL    SCHPTR,DVTLNG-4(@06)                                1142 03355000
*   END;                            /* EVERY DEVTAB PCT              */ 03356000
         AL    J,@CF00059                                          1143 03357000
@DE01114 CH    J,DVTHEC                                            1143 03358000
         BNH   @DL01114                                            1143 03359000
*   IF PCTPTR^=ENDPTR THEN                                         1144 03360000
         L     @08,PCTPTR                                          1144 03361000
         CR    @08,ENDPTR                                          1144 03362000
         BE    @RF01144                                            1144 03363000
*     DO;                           /* GETMAIN AREA LEFT OVER?       */ 03364000
*       PCTPTR=((PCTPTR+SEVEN)/EIGHT)*EIGHT;/* DWORD BOUNDARY TO FREE*/ 03365000
         LR    @02,@08                                             1146 03366000
         AL    @02,@CF00061                                        1146 03367000
         SRDA  @02,32                                              1146 03368000
         D     @02,@CF00056                                        1146 03369000
         SLA   @03,3                                               1146 03370000
         ST    @03,PCTPTR                                          1146 03371000
*       DO;                         /* FREEMAIN(RU)                1147 03372000
*                                      LV(ENDPTR-PCTPTR)A(PCT)     1147 03373000
*                                      SP(SQASPID)                   */ 03374000
*         RESPECIFY                                                1148 03375000
*          (GPR01F,                                                1148 03376000
*           GPR15F,                                                1148 03377000
*           GPR00F) RESTRICTED;                                    1148 03378000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 03379000
         SLR   GPR01F,GPR01F                                       1149 03380000
*         GPR15F=3;                 /* SET TYPE                      */ 03381000
         LA    GPR15F,3                                            1150 03382000
*         GPR00F=ENDPTR-PCTPTR;     /* LENGTH REQUESTED              */ 03383000
         LR    GPR00F,ENDPTR                                       1151 03384000
         SLR   GPR00F,@03                                          1151 03385000
*         GPR01F=ADDR(PCT);         /* SET REGISTER ONE              */ 03386000
         LR    GPR01F,@03                                          1152 03387000
*         GPR15F=GPR15F+((SQASPID)*256);/* SUBPOOL VALUE             */ 03388000
         AL    GPR15F,@CF02881                                     1153 03389000
*         SVC(120);                 /* RC/RU-FORM OF GETMAIN         */ 03390000
         SVC   120                                                 1154 03391000
*         RESPECIFY                                                1155 03392000
*          (GPR01F,                                                1155 03393000
*           GPR15F,                                                1155 03394000
*           GPR00F) UNRESTRICTED;                                  1155 03395000
*       END;                        /* FREEMAIN(RU)                1156 03396000
*                                      LV(ENDPTR-PCTPTR)A(PCT)     1156 03397000
*                                      SP(SQASPID)                   */ 03398000
*     END;                          /* GETMAIN AREA LEFT OVER        */ 03399000
*   ELSE                                                           1158 03400000
*     ;                             /* NO AREA LEFT OVER             */ 03401000
@RF01144 DS    0H                                                  1159 03402000
*                                                                  1159 03403000
*/********************************************************************/ 03404000
*/*                                                                  */ 03405000
*/* BLDPART: SEGMENT TO BUILD ILRPART FROM ILRTPARB                  */ 03406000
*/*                                                                  */ 03407000
*/* INPUT: ILRTPARB                                                  */ 03408000
*/*        PLPASUSE COUNT AND DUPXSUSE COUNT                         */ 03409000
*/*        IHANVT,ILRASMVT                                           */ 03410000
*/*                                                                  */ 03411000
*/* PROCESS: OBTAIN AREA FOR ILRPART. MOVE MOST INFORMATION IN       */ 03412000
*/*          ILRTPARB ENTRY TO ILRPART ENTRY. ILRPART WILL NOT HAVE  */ 03413000
*/*          THE DATA SET NAMES AND WILL ONLY HAVE ENOUGH ENTRIES    */ 03414000
*/*          FOR THIS IPL.  CHAIN THE ILRPART ENTIES TOGETHER IN     */ 03415000
*/*          ORDER TO PRODUCE BEST PERFORMANCE IN EXECUTING PAGING.  */ 03416000
*/*                                                                  */ 03417000
*/* OUTPUT: ILRPART INITIALIZED COMPLETELY                           */ 03418000
*/*                                                                  */ 03419000
*/********************************************************************/ 03420000
*/*BLDPART: CHART                                                    */ 03421000
*/*HEADER                                                          1159 03422000
*/*  BLDPART SEGMENT                                                 */ 03423000
*/*BLDPART: E ENTRY TO BUILD ILRPART                                 */ 03424000
*/*         L UNCONDITIONAL GETMAIN CORRECT AREA FOR PART            */ 03425000
*/*         P ZERO SPACE                                             */ 03426000
*/*         P ADDRESS OF PART IN ASMVT                               */ 03427000
*/*         P ADDRESS OF TPAR IN PART                                */ 03428000
*/*         P FILL IN BURST TIME (ASMVT)                             */ 03429000
*/*         P FILL IN ASM BURST TIME (ASMVT)                         */ 03430000
*/*         P FILL IN PART HEADER                                    */ 03431000
*/*         P POINT TO FIRST ENTRY IN BOTH TPARB AND PART            */ 03432000
*/*%A1:     D (YES,,NO,%A2) MORE TPARB ENTRIES?                      */ 03433000
*/*         P NUMBER PART ENTRY                                      */ 03434000
*/*         D (YES,,NO,%A3) SKIP FLAG IN TPARB ON?                   */ 03435000
*/*         P MARK ENTRY NOT IN USE                                  */ 03436000
*/*         P (,%A5) MARK PART ENTRY AS DUPLEX'S                     */ 03437000
*/*%A3:     P FILL IN MOST OF PART ENTRY                             */ 03438000
*/*         D (YES,,NO,%A4) DUPLEX ENTRY IN TPARB?                   */ 03439000
*/*         P MARK PART ENTRY AS DUPLEX'S                            */ 03440000
*/*         P DECREASE AVAILABLE SLOTS (DUPLEX USE)                  */ 03441000
*/*         P (,%A5) FILL IN WRITE QUEUE ADDRESS                     */ 03442000
*/*%A4:     D (YES,,NO,%A6) PLPA ENTRY IN TPARB?                     */ 03443000
*/*         P MARK PART ENTRY AS PLPA'S                              */ 03444000
*/*         P DECREASE AVAILABLE SLOTS (PLPA USE COUNT)              */ 03445000
*/*         D (YES,,NO,%A5) COLD START?                              */ 03446000
*/*         P (,%A5) FILL IN WRITE QUEUE ADDRESS (COMMON)            */ 03447000
*/*%A6:     D (YES,,NO,%A7) COMMON ENTRY IN TPARB?                   */ 03448000
*/*         P MARK PART ENTRY AS COMMON'S                            */ 03449000
*/*         D (NO,,YES,%A5) COLD START?                              */ 03450000
*/*         P (,%A5) FILL IN WRITE QUEUE ADDRESS                     */ 03451000
*/*%A7:     P MARK PART ENTRY AS A LOCAL                             */ 03452000
*/*         P FILL IN WRITE QUEUE ADDRESS                            */ 03453000
*/*%A5:     P NEXT TPAR ENTRY                                        */ 03454000
*/*         P (,%A1) NEXT PART ENTRY                                 */ 03455000
*/*%A2:     P CHAIN PART ENTRIES                                     */ 03456000
*/*         D (YES,,NO,%A8) COLD START?                              */ 03457000
*/*         R FLOW CONTINUES AT QSRTPARB                             */ 03458000
*/*%A8:     R FLOW CONTINUES AT INITSART                             */ 03459000
*/*BLDPART: END                                                      */ 03460000
*                                                                  1159 03461000
*                                                                  1159 03462000
*   /*****************************************************************/ 03463000
*   /*                                                               */ 03464000
*   /* BLDPART                                                       */ 03465000
*   /*                                                               */ 03466000
*   /*****************************************************************/ 03467000
*                                                                  1159 03468000
*   IF TPARUSE+TPAREXPD>ENTSTPAR THEN                              1159 03469000
         LA    @08,64                                              1159 03470000
         L     @15,TPARPTR                                         1159 03471000
         L     @00,TPARUSE(,@15)                                   1159 03472000
         AL    @00,TPAREXPD(,@15)                                  1159 03473000
         CR    @00,@08                                             1159 03474000
         BNH   @RF01159                                            1159 03475000
*     ENTRIES=ENTSTPAR;             /* SET TO MAXIMUM ENTRIES        */ 03476000
         STH   @08,ENTRIES                                         1160 03477000
*   ELSE                                                           1161 03478000
*     ENTRIES=TPARUSE+TPAREXPD;     /* NUMBER OF ENTRIES TO OBTAIN   */ 03479000
         B     @RC01159                                            1161 03480000
@RF01159 L     @08,TPARPTR                                         1161 03481000
         L     @00,TPARUSE(,@08)                                   1161 03482000
         AL    @00,TPAREXPD(,@08)                                  1161 03483000
         STH   @00,ENTRIES                                         1161 03484000
*   RFY                                                            1162 03485000
*     R0 RSTD;                                                     1162 03486000
@RC01159 DS    0H                                                  1163 03487000
*   R0=LENGTH(PARTHDR)+ENTRIES*LENGTH(PARTENT);                    1163 03488000
         LH    R0,ENTRIES                                          1163 03489000
         SLA   R0,6                                                1163 03490000
         AL    R0,@CF00238                                         1163 03491000
*   DO;                             /* GETMAIN (RU) LV(R0)         1164 03492000
*                                      SP(SQASPID)                   */ 03493000
*     RESPECIFY                                                    1165 03494000
*      (GPR01F,                                                    1165 03495000
*       GPR15F,                                                    1165 03496000
*       GPR00F) RESTRICTED;                                        1165 03497000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 03498000
         SLR   GPR01F,GPR01F                                       1166 03499000
*     GPR15F=2;                     /* RU-TYPE GETMAIN               */ 03500000
         LA    GPR15F,2                                            1167 03501000
*     GPR00F=R0;                    /* LENGTH REQUESTED              */ 03502000
*     GPR15F=GPR15F|((SQASPID)*256);/* SP IN BYTE 2                  */ 03503000
         O     GPR15F,@CF02881                                     1169 03504000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 03505000
         SVC   120                                                 1170 03506000
*     RESPECIFY                                                    1171 03507000
*      (GPR01F,                                                    1171 03508000
*       GPR15F,                                                    1171 03509000
*       GPR00F) UNRESTRICTED;                                      1171 03510000
*   END;                            /* GETMAIN (RU) LV(R0)         1172 03511000
*                                      SP(SQASPID) GETMAIN PART    1172 03512000
*                                      --NEVER FREED                 */ 03513000
*   PARTPTR=R1;                     /* SAVE RETURNED ADDRESS         */ 03514000
         LR    PARTPTR,R1                                          1173 03515000
*   RFY                                                            1174 03516000
*    (R14,                                                         1174 03517000
*     R15) RSTD;                    /* ZERO THE PART                 */ 03518000
*   R0=PARTPTR;                     /* PART ADDRESS                  */ 03519000
         LR    R0,PARTPTR                                          1175 03520000
*   R1=LENGTH(PARTHDR)+ENTRIES*LENGTH(PARTENT);/* LENGTH OF PART     */ 03521000
         LH    R1,ENTRIES                                          1176 03522000
         SLA   R1,6                                                1176 03523000
         AL    R1,@CF00238                                         1176 03524000
*   R15=ZERO;                                                      1177 03525000
         SLR   R15,R15                                             1177 03526000
*   MVCL(R0,R14);                   /* ZERO THE PART                 */ 03527000
         MVCL  R0,R14                                              1178 03528000
*   RFY                                                            1179 03529000
*    (R0,                                                          1179 03530000
*     R14,                                                         1179 03531000
*     R15) UNRSTD;                                                 1179 03532000
*   ASMPART=PARTPTR;                /* PART ADDRESS IN ASMVT         */ 03533000
         L     @08,CVTPTR                                          1180 03534000
         L     @08,ASMVTPTR(,@08)                                  1180 03535000
         ST    PARTPTR,ASMPART(,@08)                               1180 03536000
*   PARTIDEN=PARID;                 /* FILL IN PART HEADER           */ 03537000
         MVC   PARTIDEN(4,PARTPTR),@CC02489                        1181 03538000
*   PARTSIZE=ENTRIES;               /* NUMBER OF PART ENTRIES        */ 03539000
         LH    @08,ENTRIES                                         1182 03540000
         ST    @08,PARTSIZE(,PARTPTR)                              1182 03541000
*   PARTEUSE=TPARUSE;               /* NUMBER OF ENTRIES IN USE      */ 03542000
         L     @08,TPARPTR                                         1183 03543000
         L     @06,TPARUSE(,@08)                                   1183 03544000
         ST    @06,PARTEUSE(,PARTPTR)                              1183 03545000
*   PARTLCNT=PARTEUSE-INITUSE;      /* NUMBER OF LOCAL D.S.'S IN USE */ 03546000
         SL    @06,@CF00092                                        1184 03547000
         STH   @06,PARTLCNT(,PARTPTR)                              1184 03548000
*   PARTTPAR=TPARPTR;               /* ADDRESS OF ILRTPARB           */ 03549000
         ST    @08,PARTTPAR(,PARTPTR)                              1185 03550000
*   PARTPCTQ=TPARPCTQ;              /* 1ST PCCW IN CHAIN             */ 03551000
         L     @06,TPARPCTQ(,@08)                                  1186 03552000
         ST    @06,PARTPCTQ(,PARTPTR)                              1186 03553000
*                                                                  1187 03554000
*   /*****************************************************************/ 03555000
*   /*                                                               */ 03556000
*   /* FILL IN PART ENTRIES                                          */ 03557000
*   /*                                                               */ 03558000
*   /*****************************************************************/ 03559000
*                                                                  1187 03560000
*   TPAEPTR=ADDR(TPARPENT);         /* 1ST TPAR ENTRY                */ 03561000
         LA    @08,TPARPENT(,@08)                                  1187 03562000
         ST    @08,TPAEPTR                                         1187 03563000
*   PAREPTR=ADDR(PARTENTS);         /* 1ST PART ENTRY                */ 03564000
         LA    PAREPTR,PARTENTS(,PARTPTR)                          1188 03565000
*   COUNT=ZERO;                     /* COUNT 0 TO ONE LESS THAN IN 1189 03566000
*                                      USE                           */ 03567000
         SLR   @08,@08                                             1189 03568000
         STH   @08,COUNT                                           1189 03569000
*   DO WHILE COUNT<TPARUSE;         /* DO ALL ENTRIES IN USE         */ 03570000
         B     @DE01190                                            1190 03571000
@DL01190 DS    0H                                                  1191 03572000
*     PARENN=COUNT;                 /* PART NUMBER IN ENTRY          */ 03573000
         LH    @08,COUNT                                           1191 03574000
         STH   @08,PARENN(,PAREPTR)                                1191 03575000
*     IF TPAESKIP=ON THEN                                          1192 03576000
         L     @08,TPAEPTR                                         1192 03577000
         TM    TPAESKIP(@08),B'00010000'                           1192 03578000
         BNO   @RF01192                                            1192 03579000
*       DO;                         /* ENTRY NOT ACTIVE?             */ 03580000
*         PAREDPLX=ON;              /* IS DUPLEX ENTRY               */ 03581000
         OI    PAREDPLX(PAREPTR),B'00100000'                       1194 03582000
*         PARENUSE=ON;              /* ENTRY NOT REALLY IN USE       */ 03583000
         OI    PARENUSE(PAREPTR),B'10000000'                       1195 03584000
*       END;                        /* ENTRY NOT ACTIVE              */ 03585000
*     ELSE                                                         1197 03586000
*       DO;                         /* ENTRY IS ACTIVE AND IN USE    */ 03587000
         B     @RC01192                                            1197 03588000
@RF01192 DS    0H                                                  1198 03589000
*         PAREPCTP=TPAEPCT;         /* PCT ADDRESS FOR DEVICE        */ 03590000
         L     @06,TPAEPTR                                         1198 03591000
         L     @03,TPAEPCT(,@06)                                   1198 03592000
         ST    @03,PAREPCTP(,PAREPTR)                              1198 03593000
*         PAREPATP=TPAEPATP;        /* PAT ADDRESS FOR DATA SET      */ 03594000
         L     @00,TPAEPATP(,@06)                                  1199 03595000
         ST    @00,PAREPATP(,PAREPTR)                              1199 03596000
*         PARESZSL=TPAESZSL;        /* NUMBER OF SLOTS               */ 03597000
         L     @15,TPAESZSL(,@06)                                  1200 03598000
         ST    @15,PARESZSL(,PAREPTR)                              1200 03599000
*         PARESLTA=PARESZSL;        /* ALL SLOTS AVAILABLE           */ 03600000
         ST    @15,PARESLTA(,PAREPTR)                              1201 03601000
*         PAREEDBP=TPAEEDB;         /* EDB ADDRESS FOR DATA SET      */ 03602000
         L     @15,TPAEEDB(,@06)                                   1202 03603000
         ST    @15,PAREEDBP(,PAREPTR)                              1202 03604000
*         PAREUCBP=TPAEUCB;         /* UCB ADDRESS FOR DATA SET      */ 03605000
         L     @15,TPAEUCB(,@06)                                   1203 03606000
         ST    @15,PAREUCBP(,PAREPTR)                              1203 03607000
*         PARERQTM=TPAEPCT->PCTRQTIM;/* SERVICE BURST VALUE          */ 03608000
         L     @03,PCTRQTIM(,@03)                                  1204 03609000
         ST    @03,PARERQTM(,PAREPTR)                              1204 03610000
*         PAREIORN=TPAEIORB->IORNUM;/* NUMBER OF IORBS               */ 03611000
         L     @06,TPAEIORB(,@06)                                  1205 03612000
         IC    @03,IORNUM(,@06)                                    1205 03613000
         STC   @03,PAREIORN(,PAREPTR)                              1205 03614000
*         PAREIORB=TPAEIORB;        /* IORB ADDRESS                  */ 03615000
         ST    @06,PAREIORB(,PAREPTR)                              1206 03616000
*         PAREPATP->PATPART=PAREPTR;/* PAT BACKWARD POINT TO PARTE   */ 03617000
         LR    @03,@00                                             1207 03618000
         ST    PAREPTR,PATPART(,@03)                               1207 03619000
*         SCHPTR=PAREIORB;          /* POINT TO FIRST IORB           */ 03620000
         LR    SCHPTR,@06                                          1208 03621000
*         DO M=1 TO PAREIORN;       /* ALL IORBS                     */ 03622000
         LA    @06,1                                               1209 03623000
         B     @DE01209                                            1209 03624000
@DL01209 DS    0H                                                  1210 03625000
*           SCHPTR->IORPARTE=PAREPTR;/* BACK CHAIN TO PART ENTRY     */ 03626000
         ST    PAREPTR,IORPARTE(,SCHPTR)                           1210 03627000
*           SCHPTR=SCHPTR->IORIORB; /* GET NEXT IORB ADDRESS         */ 03628000
         L     SCHPTR,IORIORB(,SCHPTR)                             1211 03629000
*         END;                      /* ALL IORBS                     */ 03630000
         AL    @06,@CF00059                                        1212 03631000
@DE01209 ST    @06,M                                               1212 03632000
         SLR   @03,@03                                             1212 03633000
         IC    @03,PAREIORN(,PAREPTR)                              1212 03634000
         CR    @06,@03                                             1212 03635000
         BNH   @DL01209                                            1212 03636000
*         IF TPAELOCL=ON THEN                                      1213 03637000
         L     @08,TPAEPTR                                         1213 03638000
         TM    TPAELOCL(@08),B'00010000'                           1213 03639000
         BNO   @RF01213                                            1213 03640000
*           DO;                     /* LOCAL ENTRY?                  */ 03641000
*             PARELOCL=ON;          /* MARK AS A LOCAL DATA SET      */ 03642000
         OI    PARELOCL(PAREPTR),B'00010000'                       1215 03643000
*             PAREWTQE=ADDR(PARTLOCQ);/* POINT TO LOCAL WRITE      1216 03644000
*                                      REQUESTS                      */ 03645000
         LA    @08,PARTLOCQ(,PARTPTR)                              1216 03646000
         ST    @08,PAREWTQE(,PAREPTR)                              1216 03647000
*           END;                    /* LOCAL ENTRY                   */ 03648000
*         ELSE                                                     1218 03649000
*           DO;                     /* NOT LOCAL ENTRY               */ 03650000
         B     @RC01213                                            1218 03651000
@RF01213 DS    0H                                                  1219 03652000
*             IF TPAEPLPA=ON THEN                                  1219 03653000
         L     @08,TPAEPTR                                         1219 03654000
         TM    TPAEPLPA(@08),B'10000000'                           1219 03655000
         BNO   @RF01219                                            1219 03656000
*               DO;                 /* PLPA DATA SET?                */ 03657000
*                 PAREPLPA=ON;      /* MARK AS PLPA DATA SET         */ 03658000
         OI    PAREPLPA(PAREPTR),B'10000000'                       1221 03659000
*                 PARESLTA=PARESLTA-PLPASUSE;/* SLOTS NOT AVAILABLE  */ 03660000
         L     @08,PARESLTA(,PAREPTR)                              1222 03661000
         SL    @08,PLPASUSE                                        1222 03662000
         ST    @08,PARESLTA(,PAREPTR)                              1222 03663000
*                 IF NVTFLQS=OFF THEN                              1223 03664000
         L     @08,NVTPTR                                          1223 03665000
         TM    NVTFLQS(@08),B'00001000'                            1223 03666000
         BNZ   @RF01223                                            1223 03667000
*                   PAREWTQE=ADDR(PARTCOMQ);/* WRITE PLPA ON COLD  1224 03668000
*                                      START                         */ 03669000
         LA    @08,PARTCOMQ(,PARTPTR)                              1224 03670000
         ST    @08,PAREWTQE(,PAREPTR)                              1224 03671000
*                 ELSE                                             1225 03672000
*                   PAREWTQE=ADDR(PARTSPLQ);/* WRITE COMMON OVERFLOW */ 03673000
         B     @RC01223                                            1225 03674000
@RF01223 LA    @08,PARTSPLQ(,PARTPTR)                              1225 03675000
         ST    @08,PAREWTQE(,PAREPTR)                              1225 03676000
*               END;                /* PLPA DATA SET                 */ 03677000
*             ELSE                                                 1227 03678000
*               DO;                 /* NOT PLPA DATA SET             */ 03679000
         B     @RC01219                                            1227 03680000
@RF01219 DS    0H                                                  1228 03681000
*                 IF TPAECOMM=ON THEN                              1228 03682000
         L     @08,TPAEPTR                                         1228 03683000
         TM    TPAECOMM(@08),B'01000000'                           1228 03684000
         BNO   @RF01228                                            1228 03685000
*                   DO;             /* COMMON DATA SET?              */ 03686000
*                     PARECOMM=ON;  /* MARK AS COMMON DATA SET       */ 03687000
         OI    PARECOMM(PAREPTR),B'01000000'                       1230 03688000
*                     PARESLTA=PARESLTA-COMMSUSE;/* SLOTS NOT      1231 03689000
*                                      AVAILABLE                     */ 03690000
         L     @08,PARESLTA(,PAREPTR)                              1231 03691000
         SL    @08,COMMSUSE                                        1231 03692000
         ST    @08,PARESLTA(,PAREPTR)                              1231 03693000
*                     IF NVTFLQS=ON THEN/* WRITE IF NOT COLD         */ 03694000
         L     @08,NVTPTR                                          1232 03695000
         TM    NVTFLQS(@08),B'00001000'                            1232 03696000
         BNO   @RF01232                                            1232 03697000
*                       PAREWTQE=ADDR(PARTCOMQ);/* START             */ 03698000
         LA    @08,PARTCOMQ(,PARTPTR)                              1233 03699000
         ST    @08,PAREWTQE(,PAREPTR)                              1233 03700000
*                     ELSE                                         1234 03701000
*                       ;           /* IS COLD START                 */ 03702000
@RF01232 DS    0H                                                  1235 03703000
*                   END;            /* COMMON DATA SET               */ 03704000
*                 ELSE                                             1236 03705000
*                   DO;             /* NOT COMMON DATA SET           */ 03706000
         B     @RC01228                                            1236 03707000
@RF01228 DS    0H                                                  1237 03708000
*                     PAREDPLX=ON;  /* MARK AS DUPLEX DATA SET       */ 03709000
         OI    PAREDPLX(PAREPTR),B'00100000'                       1237 03710000
*                     PARESLTA=PARESLTA-DUPXSUSE;/* SLOTS NOT      1238 03711000
*                                      AVAILABLE                     */ 03712000
         L     @08,PARESLTA(,PAREPTR)                              1238 03713000
         SL    @08,DUPXSUSE                                        1238 03714000
         ST    @08,PARESLTA(,PAREPTR)                              1238 03715000
*                     PAREWTQE=ADDR(PARTDUPQ);/* POINT TO DUPLEX   1239 03716000
*                                      WRITE REQS                    */ 03717000
         LA    @08,PARTDUPQ(,PARTPTR)                              1239 03718000
         ST    @08,PAREWTQE(,PAREPTR)                              1239 03719000
*                   END;            /* NOT COMMON DATA SET           */ 03720000
*               END;                /* NOT PLPA DATA SET             */ 03721000
@RC01228 DS    0H                                                  1242 03722000
*           END;                    /* NOT LOCAL ENTRY               */ 03723000
@RC01219 DS    0H                                                  1243 03724000
*       END;                        /* ENTRY IS ACTIVE AND IN USE    */ 03725000
@RC01213 DS    0H                                                  1244 03726000
*     TPAEPTR=TPAEPTR+LENGTH(TPARENT);/* NEXT TPAR ENTRY             */ 03727000
@RC01192 LA    @08,96                                              1244 03728000
         AL    @08,TPAEPTR                                         1244 03729000
         ST    @08,TPAEPTR                                         1244 03730000
*     PAREPTR=PAREPTR+LENGTH(PARTENT);/* NEXT PART ENTRY             */ 03731000
         AL    PAREPTR,@CF00054                                    1245 03732000
*     COUNT=COUNT+ONE;              /* ONE MORE ENTRY COMPLETE       */ 03733000
         LH    @08,COUNT                                           1246 03734000
         LA    @08,1(,@08)                                         1246 03735000
         STH   @08,COUNT                                           1246 03736000
*   END;                            /* DO ALL ENTRIES IN USE         */ 03737000
@DE01190 LH    @08,COUNT                                           1247 03738000
         L     @06,TPARPTR                                         1247 03739000
         C     @08,TPARUSE(,@06)                                   1247 03740000
         BL    @DL01190                                            1247 03741000
*                                                                  1248 03742000
*   /*****************************************************************/ 03743000
*   /*                                                               */ 03744000
*   /* CHAIN THE PART ENTRIES FOR PERFORMANCE GAIN                   */ 03745000
*   /*                                                               */ 03746000
*   /*****************************************************************/ 03747000
*                                                                  1248 03748000
*   PAREPTR=ADDR(PARTENTS);         /* PLPA DATA SET                 */ 03749000
         LA    PAREPTR,PARTENTS(,PARTPTR)                          1248 03750000
*   PAREPARE=PAREPTR+LENGTH(PARTENT);/* CHAIN PLPA TO COMMON         */ 03751000
         LA    @08,64                                              1249 03752000
         LR    @06,PAREPTR                                         1249 03753000
         ALR   @06,@08                                             1249 03754000
         ST    @06,PAREPARE(,PAREPTR)                              1249 03755000
*   PAREPTR=PAREPARE;               /* POINT TO COMMON DATA SET      */ 03756000
         LR    PAREPTR,@06                                         1250 03757000
*   IF(PAREPTR+LENGTH(PARTENT))->PARENUSE=OFF/* DUPLEXING?           */ 03758000
*     THEN                                                         1251 03759000
         ALR   @08,PAREPTR                                         1251 03760000
         TM    PARENUSE(@08),B'10000000'                           1251 03761000
         BNZ   @RF01251                                            1251 03762000
*     PAREPARE=PAREPTR+LENGTH(PARTENT);/* CHAIN COMMON TO DUP        */ 03763000
         ST    @08,PAREPARE(,PAREPTR)                              1252 03764000
*   ELSE                                                           1253 03765000
*     ;                             /* END CHAIN WITH COMMON D.S.    */ 03766000
*                                                                  1253 03767000
@RF01251 DS    0H                                                  1254 03768000
*   /*****************************************************************/ 03769000
*   /*                                                               */ 03770000
*   /* TWO CHAINS OF LOCALS                                          */ 03771000
*   /*                                                               */ 03772000
*   /*****************************************************************/ 03773000
*                                                                  1254 03774000
*   COUNT=PARTLCNT;                 /* NUMBER OF LOCAL DATA SETS     */ 03775000
         LH    @08,PARTLCNT(,PARTPTR)                              1254 03776000
         STH   @08,COUNT                                           1254 03777000
*   PCTPTR=PARTPCTQ;                /* POINT FASTEST DEVICE IN USE   */ 03778000
         L     @08,PARTPCTQ(,PARTPTR)                              1255 03779000
         ST    @08,PCTPTR                                          1255 03780000
*   LSTFPTR=ADDR(PARTCIR1);         /* POINT FIRST FIXED DEVICE      */ 03781000
         LA    @08,PARTCIR1(,PARTPTR)                              1256 03782000
         ST    @08,LSTFPTR                                         1256 03783000
*   LSTMPTR=ADDR(PARTCIR2);         /* POINT FIRST MOVEABLE DEVICE   */ 03784000
         LA    @08,PARTCIR2(,PARTPTR)                              1257 03785000
         ST    @08,LSTMPTR                                         1257 03786000
*   DO WHILE PCTPTR^=ZERO;          /* ALL DEVICES IN USE(FAST -   1258 03787000
*                                      SLOW)                         */ 03788000
         B     @DE01258                                            1258 03789000
@DL01258 DS    0H                                                  1259 03790000
*     PAREPTR=ADDR(PARTENTS(PARTLOCN+ONE));/* 1ST LOCAL IN PART      */ 03791000
         LA    PAREPTR,PARTENTS+192(,PARTPTR)                      1259 03792000
*     DO K=1 TO COUNT BY ONE;       /* SEARCH ALL LOCALS FOR THIS DEV*/ 03793000
         LA    K,1                                                 1260 03794000
         B     @DE01260                                            1260 03795000
@DL01260 DS    0H                                                  1261 03796000
*       IF PAREPCTP=PCTPTR THEN                                    1261 03797000
         L     @08,PCTPTR                                          1261 03798000
         C     @08,PAREPCTP(,PAREPTR)                              1261 03799000
         BNE   @RF01261                                            1261 03800000
*         DO;                       /* FOUND THAT DEVICE?            */ 03801000
*           IF PCTDTYPE=D23051ET|PCTDTYPE=D23052ET THEN            1263 03802000
         CLC   PCTDTYPE(6,@08),D23051ET                            1263 03803000
         BE    @RT01263                                            1263 03804000
         CLC   PCTDTYPE(6,@08),D23052ET                            1263 03805000
         BNE   @RF01263                                            1263 03806000
@RT01263 DS    0H                                                  1264 03807000
*             DO;                   /* FIXED?                        */ 03808000
*               LSTFPTR->NEXTPTR=PAREPTR;/* POINT TO FIXED HEAD ENTRY*/ 03809000
         L     @08,LSTFPTR                                         1265 03810000
         ST    PAREPTR,NEXTPTR(,@08)                               1265 03811000
*               LSTFPTR=ADDR(PAREPARE);/* WHERE TO PUT NEXT FIXED    */ 03812000
         ST    PAREPTR,LSTFPTR                                     1266 03813000
*             END;                  /* FIXED HEAD DEVICE FOUND       */ 03814000
*           ELSE                                                   1268 03815000
*             DO;                   /* MOVEABLE HEAD DEVICE FOUND    */ 03816000
         B     @RC01263                                            1268 03817000
@RF01263 DS    0H                                                  1269 03818000
*               LSTMPTR->NEXTPTR=PAREPTR;/* POINT TO MOVEABLE HEAD 1269 03819000
*                                      ENT                           */ 03820000
         L     @08,LSTMPTR                                         1269 03821000
         ST    PAREPTR,NEXTPTR(,@08)                               1269 03822000
*               LSTMPTR=ADDR(PAREPARE);/* WHERE TO PUT NEXT MOVEABLE */ 03823000
         ST    PAREPTR,LSTMPTR                                     1270 03824000
*             END;                  /* MOVEABLE HEAD DEVICE FOUND    */ 03825000
*         END;                      /* FOUND THAT DEVICE             */ 03826000
*       ELSE                                                       1273 03827000
*         ;                         /* NOT THAT DEVICE               */ 03828000
@RF01261 DS    0H                                                  1274 03829000
*       PAREPTR=PAREPTR+LENGTH(PARTENT);/* TRY NEXT PART ENTRY       */ 03830000
@RC01261 AL    PAREPTR,@CF00054                                    1274 03831000
*     END;                          /* SEARCH ALL LOCALS FOR THIS DEV*/ 03832000
         AL    K,@CF00059                                          1275 03833000
@DE01260 CH    K,COUNT                                             1275 03834000
         BNH   @DL01260                                            1275 03835000
*     PCTPTR=PCTNEXT;               /* NEXT DEVICE IN USE            */ 03836000
         L     @08,PCTPTR                                          1276 03837000
         L     @08,PCTNEXT(,@08)                                   1276 03838000
         ST    @08,PCTPTR                                          1276 03839000
*   END;                            /* ALL DEVICES IN USE(FAST -   1277 03840000
*                                      SLOW)                         */ 03841000
@DE01258 L     @08,PCTPTR                                          1277 03842000
         LTR   @08,@08                                             1277 03843000
         BNZ   @DL01258                                            1277 03844000
*   LSTFPTR->NEXTPTR=PARTCIR1;      /* COMPLETE FIXED HEAD CIRCLE    */ 03845000
         L     @08,PARTCIR1(,PARTPTR)                              1278 03846000
         L     @06,LSTFPTR                                         1278 03847000
         ST    @08,NEXTPTR(,@06)                                   1278 03848000
*   LSTMPTR->NEXTPTR=PARTCIR2;      /* COMPLETE MOVE HEAD CIRCLE     */ 03849000
*                                                                  1279 03850000
         L     @08,PARTCIR2(,PARTPTR)                              1279 03851000
         L     @06,LSTMPTR                                         1279 03852000
         ST    @08,NEXTPTR(,@06)                                   1279 03853000
*   /*****************************************************************/ 03854000
*   /*                                                               */ 03855000
*   /* WHERE TO EXECUTE NEXT                                         */ 03856000
*   /*                                                               */ 03857000
*   /*****************************************************************/ 03858000
*                                                                  1280 03859000
*   IF NVTFLQS=NO                   /* QSRTPARB DONE BY ILRQSRIT     */ 03860000
*     THEN                                                         1280 03861000
         L     @08,NVTPTR                                          1280 03862000
         TM    NVTFLQS(@08),B'00001000'                            1280 03863000
         BZ    @RT01280                                            1280 03864000
*     GOTO INITSART;                /* COLD START                    */ 03865000
*   ELSE                                                           1282 03866000
*     ;                             /* MUST DO QSRTPARB WORK         */ 03867000
*                                                                  1283 03868000
*/********************************************************************/ 03869000
*/*                                                                  */ 03870000
*/* QSRTPARB: SEGMENT TO FREE QSR AND WRITE TPAR TO PLPA DATA SET,   */ 03871000
*/*           IF QUICK OR WARM START                                 */ 03872000
*/*                                                                  */ 03873000
*/* INPUT: ILRQSRCD AND ILRTPARB                                     */ 03874000
*/*                                                                  */ 03875000
*/* PROCESS: IF QUICK OR WARM START, FREE AREA OF ILRQSRCD AND WRITE */ 03876000
*/*          ILRTPARB TO FIRST SLOTS IN PLPA DATA SET. ON COLD       */ 03877000
*/*          START, ILRQSRIT WRITES ILRTPARB AND ILRQSRCD TOGETHER   */ 03878000
*/*          TO PLPA DATA SET AND FREES ILRQSRCD STORAGE.            */ 03879000
*/*                                                                  */ 03880000
*/* OUTPUT: ILRTPARB COPIED TO PLPA DATA SET       OR NOTHING        */ 03881000
*/*                                                                  */ 03882000
*/********************************************************************/ 03883000
*/*QSRTPARB: CHART                                                   */ 03884000
*/*HEADER                                                          1283 03885000
*/*   QSRTPARB SEGMENT                                               */ 03886000
*/*QSRTPARB: E ENTRY TO FREE QSR AND WRITE TPARB                     */ 03887000
*/*          L FREEMAIN ILRQSRCD                                     */ 03888000
*/*          P PREPARE INPUT TO ILRPREAD                             */ 03889000
*/*          S ILRPREAD: WRITE TPARB TO PLPA DATA SET                */ 03890000
*/*          D (YES,,NO,%A1) WRITE FAIL?                             */ 03891000
*/*          P MARK TPARTBLE AS BAD (ASMVT)                          */ 03892000
*/*          S ILRIMMSG: ISSUE 'FUTURE IPL'S PROBLEM' MESSAGE        */ 03893000
*/*          P TURN ON ASMNOTPT --TPARTBLE NO GOOD                   */ 03894000
*/*%A1:      R FLOW CONTINUES AT INITSART                            */ 03895000
*/*QSRTPARB: END                                                     */ 03896000
*                                                                  1283 03897000
*                                                                  1283 03898000
*   /*****************************************************************/ 03899000
*   /*                                                               */ 03900000
*   /* QSRTPARB (QUICK OR WARM)                                      */ 03901000
*   /*                                                               */ 03902000
*   /*****************************************************************/ 03903000
*                                                                  1283 03904000
*   DO;                             /* FREEMAIN(RU)                1283 03905000
*                                      LV(LENGTH(QSR))A(QSR)       1283 03906000
*                                      SP(SQASPID)                   */ 03907000
*     RESPECIFY                                                    1284 03908000
*      (GPR01F,                                                    1284 03909000
*       GPR15F,                                                    1284 03910000
*       GPR00F) RESTRICTED;                                        1284 03911000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 03912000
         SLR   GPR01F,GPR01F                                       1285 03913000
*     GPR15F=3;                     /* SET TYPE                      */ 03914000
         LA    GPR15F,3                                            1286 03915000
*     GPR00F=LENGTH(QSR);           /* LENGTH REQUESTED              */ 03916000
         L     GPR00F,@CF02874                                     1287 03917000
*     GPR01F=ADDR(QSR);             /* SET REGISTER ONE              */ 03918000
         L     GPR01F,QSRPTR                                       1288 03919000
*     GPR15F=GPR15F+((SQASPID)*256);/* SUBPOOL VALUE                 */ 03920000
         AL    GPR15F,@CF02881                                     1289 03921000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 03922000
         SVC   120                                                 1290 03923000
*     RESPECIFY                                                    1291 03924000
*      (GPR01F,                                                    1291 03925000
*       GPR15F,                                                    1291 03926000
*       GPR00F) UNRESTRICTED;                                      1291 03927000
*   END;                            /* FREEMAIN(RU)                1292 03928000
*                                      LV(LENGTH(QSR))A(QSR)       1292 03929000
*                                      SP(SQASPID)                   */ 03930000
*   RFY                                                            1293 03931000
*     R0 UNRSTD;                                                   1293 03932000
*   NVTQSBUF=''B;                   /* NO QSR ADDRESS ANYMORE        */ 03933000
*                                                                  1294 03934000
         SLR   @08,@08                                             1294 03935000
         L     @06,NVTPTR                                          1294 03936000
         ST    @08,NVTQSBUF(,@06)                                  1294 03937000
*   /*****************************************************************/ 03938000
*   /*                                                               */ 03939000
*   /* WRITE ILRTPARB TO PLPA DATA SET                               */ 03940000
*   /*                                                               */ 03941000
*   /*****************************************************************/ 03942000
*                                                                  1295 03943000
*   PBUFF=TPARPTR;                  /* WHAT TO WRITE                 */ 03944000
         L     @06,TPARPTR                                         1295 03945000
         ST    @06,PBUFF                                           1295 03946000
*   PWRITE=ON;                      /* WRITE                         */ 03947000
*   PTPARB=OFF;                     /* PASS PART ENTRY               */ 03948000
         OI    PWRITE,B'10000000'                                  1297 03949000
         NI    PTPARB,B'10111111'                                  1297 03950000
*   PSLOTNO=LENGTH(TPARTBLE)/FOURK; /* SLOTS TO WRITE                */ 03951000
         MVI   PSLOTNO,X'02'                                       1298 03952000
*   PSLOT=''B;                      /* RELATIVE SLOT ZERO            */ 03953000
         STH   @08,PSLOT                                           1299 03954000
*   PENTRY=ADDR(PARTENTS);          /* PLPA PART ENTRY               */ 03955000
         LA    @08,PARTENTS(,PARTPTR)                              1300 03956000
         ST    @08,PENTRY                                          1300 03957000
*   R1=ADDR(READPARM);              /* PARM TO ILRPREAD              */ 03958000
         LA    R1,READPARM                                         1301 03959000
*   RFY                                                            1302 03960000
*     R15 RSTD;                                                    1302 03961000
*   CALL ILRPREAD;                  /* ILRPREAD                      */ 03962000
         L     @15,RDWTPTR                                         1303 03963000
         BALR  @14,@15                                             1303 03964000
*   IF R15^=ZERO THEN                                              1304 03965000
         LTR   R15,R15                                             1304 03966000
         BZ    @RF01304                                            1304 03967000
*     DO;                           /* ILRPREAD FAIL?                */ 03968000
*       RFY                                                        1306 03969000
*         R15 UNRSTD;                                              1306 03970000
*       MSGID=M944I;                /* QUICK AND WARM RISKY          */ 03971000
         MVC   MSGID(4),@CC02583                                   1307 03972000
*       R1=ADDR(MSGPL);             /* PARM TO ILRIMMSG              */ 03973000
         LA    R1,MSGPL                                            1308 03974000
*       CALL ILRIMMSG;              /* MESSAGE MODULE                */ 03975000
         L     @15,@CV02592                                        1309 03976000
         BALR  @14,@15                                             1309 03977000
*       ASMNOTPT=YES;               /* TPARTBLE UNUSEABLE NOW        */ 03978000
         L     @08,CVTPTR                                          1310 03979000
         L     @08,ASMVTPTR(,@08)                                  1310 03980000
         OI    ASMNOTPT(@08),B'00010000'                           1310 03981000
*     END;                          /* ILRPREAD FAIL                 */ 03982000
*   ELSE                                                           1312 03983000
*     ;                             /* ILRPREAD O.K.                 */ 03984000
@RF01304 DS    0H                                                  1313 03985000
*                                                                  1313 03986000
*/********************************************************************/ 03987000
*/*                                                                  */ 03988000
*/* INITSART: SEGMENT TO PREPARE TO INITIALIZE SWAP CONTROL BLOCKS   */ 03989000
*/*                                                                  */ 03990000
*/* INPUT: HARDCODED ILRSDCT                                         */ 03991000
*/*        ADDRESS OF NVT                                            */ 03992000
*/*        DSTBLPTR POINT TO ILRDSTBL                                */ 03993000
*/*                                                                  */ 03994000
*/* PROCESS: GETMAIN AREA FOR ILRSDCT ADN COPY HARDCODED ON TO IT.   */ 03995000
*/*          PARSE SWAP DATA SET NAMES FOUND VIA PARMTAB.  GETMAIN   */ 03996000
*/*          AREA FOR ILRSART.  IF NO SWAP DATA SETS, ONLY THE       */ 03997000
*/*          EXPANSION ENTRIES ARE NEEDED, OTHERWISE MAXIMUM SIZE IS */ 03998000
*/*          OBTAINED (FREE EXTRA AFTER PROCESS DATA SETS)           */ 03999000
*/*                                                                  */ 04000000
*/* OUTPUT: ILRSDCT IN SQA                                           */ 04001000
*/*         SWAP DATA SETS, IF ANY, IN ILRDSTBL                      */ 04002000
*/*         ILRSART AREA OBTAINED AND SOME UPDATING                  */ 04003000
*/*                                                                  */ 04004000
*/********************************************************************/ 04005000
*/*INITSART: CHART                                                   */ 04006000
*/*HEADER                                                          1313 04007000
*/*  INITSART SEGMENT                                                */ 04008000
*/*INITSART: E ENTRY TO BEGIN SWAP CONTROL BLOCKS                    */ 04009000
*/*          P TURN SWAP SWITCH ON                                   */ 04010000
*/*          S PARSE: SWAP DATA SETS IN ILRDSTBL                     */ 04011000
*/*          D (YES,,NO,%A1) ANY DATA SETS?                          */ 04012000
*/*          L UNCONDITIONAL GETMAIN FOR MAXIMUM SART                */ 04013000
*/*          P ZERO SPACE                                            */ 04014000
*/*          P COMPLETE SART HEADER                                  */ 04015000
*/*          P (,%A2) SART ADDRESS IN ASMVT                          */ 04016000
*/*%A1:      L UNCONDITIONAL GETMAIN FOR EXPANSION ONLY SART         */ 04017000
*/*          P ZERO SPACE                                            */ 04018000
*/*          P COMPLETE SART HEADER                                  */ 04019000
*/*          P SART ADDRESS IN ASMVT                                 */ 04020000
*/*          D (YES,,NO,%A2) EXPANSION IS ZERO?                      */ 04021000
*/*          R FLOW CONTINUES AT LGVTSRB                             */ 04022000
*/*%A2:      L UNCONDITIONAL GETMAIN FOR ILRSDCT                     */ 04023000
*/*          P COPY HARDCODED SDCT TO AREA                           */ 04024000
*/*          P SDCT ADDRESS IN SART                                  */ 04025000
*/*          D (YES,,NO,%A3) ANY DATA SETS?                          */ 04026000
*/*          R FLOW CONTINUES AT OPENSWAP                            */ 04027000
*/*%A3:      R FLOW CONTINUES AT INITSCCW                            */ 04028000
*/*INITSART: END                                                     */ 04029000
*                                                                  1313 04030000
*INITSART:                                                         1313 04031000
*   SWAPSW=ON;                      /* DOING SWAP, NOT PAGE          */ 04032000
INITSART OI    SWAPSW,B'00001000'                                  1313 04033000
*/*      MOVE  SDCT TO SQA                                           */ 04034000
*                                                                  1314 04035000
*   DO;                             /* GETMAIN (RU) LV(LENGTH(HSDCT))   04036000
*                                      SP(SQASPID)                   */ 04037000
*     RESPECIFY                                                    1315 04038000
*      (GPR01F,                                                    1315 04039000
*       GPR15F,                                                    1315 04040000
*       GPR00F) RESTRICTED;                                        1315 04041000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 04042000
         SLR   GPR01F,GPR01F                                       1316 04043000
*     GPR15F=2;                     /* RU-TYPE GETMAIN               */ 04044000
         LA    GPR15F,2                                            1317 04045000
*     GPR00F=LENGTH(HSDCT);         /* LENGTH REQUESTED              */ 04046000
         LA    GPR00F,128                                          1318 04047000
*     GPR15F=GPR15F|((SQASPID)*256);/* SP IN BYTE 2                  */ 04048000
         O     GPR15F,@CF02881                                     1319 04049000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 04050000
         SVC   120                                                 1320 04051000
*     RESPECIFY                                                    1321 04052000
*      (GPR01F,                                                    1321 04053000
*       GPR15F,                                                    1321 04054000
*       GPR00F) UNRESTRICTED;                                      1321 04055000
*   END;                            /* GETMAIN (RU) LV(LENGTH(HSDCT))   04056000
*                                      SP(SQASPID) AREA FOR SDCT     */ 04057000
*   SDCTPTR=R1;                     /* SAVE SDCT ADDRESS             */ 04058000
         ST    R1,SDCTPTR                                          1323 04059000
*   MVC(SDCT,HSDCT);                /* COPY HARDCODED TO SQA SDCT    */ 04060000
         L     @08,SDCTPTR                                         1324 04061000
         MVC   SDCT(128,@08),HSDCT                                 1324 04062000
*   CALL PARSE;                     /* GET SWAP D.S. SPECIFIED       */ 04063000
         BAL   @14,PARSE                                           1325 04064000
*   IF DSTBLPTR->DSTDSNC=0 THEN     /* NONE SPECIFIED?               */ 04065000
         L     @08,DSTBLPTR                                        1326 04066000
         CLI   DSTDSNC(@08),0                                      1326 04067000
         BNE   @RF01326                                            1326 04068000
*     NUMBER=SWAPEXP;               /* EXPANDABLE SART ENTRIES       */ 04069000
         LH    NUMBER,SWAPEXP                                      1327 04070000
*   ELSE                                                           1328 04071000
*     NUMBER=ENTSART;               /* MAXIMUM SART ENTRIES          */ 04072000
         B     @RC01326                                            1328 04073000
@RF01326 LA    NUMBER,25                                           1328 04074000
*   GETREQ=LENGTH(SARTHDR)+(NUMBER*(LENGTH(SARTE)));/* LENGTH OF SART*/ 04075000
@RC01326 LR    GETREQ,NUMBER                                       1329 04076000
         MH    GETREQ,@CH00076                                     1329 04077000
         AL    GETREQ,@CF00238                                     1329 04078000
*   DO;                             /* GETMAIN (RU) LV(GETREQ)     1330 04079000
*                                      SP(SQASPID)                   */ 04080000
*     RESPECIFY                                                    1331 04081000
*      (GPR01F,                                                    1331 04082000
*       GPR15F,                                                    1331 04083000
*       GPR00F) RESTRICTED;                                        1331 04084000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 04085000
         SLR   GPR01F,GPR01F                                       1332 04086000
*     GPR15F=2;                     /* RU-TYPE GETMAIN               */ 04087000
         LA    GPR15F,2                                            1333 04088000
*     GPR00F=GETREQ;                /* LENGTH REQUESTED              */ 04089000
         LR    GPR00F,GETREQ                                       1334 04090000
*     GPR15F=GPR15F|((SQASPID)*256);/* SP IN BYTE 2                  */ 04091000
         O     GPR15F,@CF02881                                     1335 04092000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 04093000
         SVC   120                                                 1336 04094000
*     RESPECIFY                                                    1337 04095000
*      (GPR01F,                                                    1337 04096000
*       GPR15F,                                                    1337 04097000
*       GPR00F) UNRESTRICTED;                                      1337 04098000
*   END;                            /* GETMAIN (RU) LV(GETREQ)     1338 04099000
*                                      SP(SQASPID)                   */ 04100000
*   SARTPTR=R1;                     /* SAVE SART ADDRESS             */ 04101000
         ST    R1,SARTPTR                                          1339 04102000
*   RFY                                                            1340 04103000
*    (R0,                                                          1340 04104000
*     R14,                                                         1340 04105000
*     R15) RSTD;                    /* ZERO SART                     */ 04106000
*   R0=SARTPTR;                                                    1341 04107000
         L     @08,SARTPTR                                         1341 04108000
         LR    R0,@08                                              1341 04109000
*   R1=GETREQ;                                                     1342 04110000
         LR    R1,GETREQ                                           1342 04111000
*   R15=ZERO;                                                      1343 04112000
         SLR   R15,R15                                             1343 04113000
*   MVCL(R0,R14);                                                  1344 04114000
         MVCL  R0,R14                                              1344 04115000
*   RFY                                                            1345 04116000
*    (R0,                                                          1345 04117000
*     R14,                                                         1345 04118000
*     R15) UNRSTD;                                                 1345 04119000
*   ASMSART=SARTPTR;                /* SART ADDRESS IN ASMVT         */ 04120000
         L     @08,SARTPTR                                         1346 04121000
         L     @15,CVTPTR                                          1346 04122000
         L     @15,ASMVTPTR(,@15)                                  1346 04123000
         ST    @08,ASMSART(,@15)                                   1346 04124000
*   SARSDCT=SDCTPTR;                /* SDCT ADDRESS IN SART          */ 04125000
         L     @00,SDCTPTR                                         1347 04126000
         ST    @00,SARSDCT(,@08)                                   1347 04127000
*   SARID=SARTID;                   /* PUT IN IDENTIFIER             */ 04128000
         MVC   SARID(4,@08),@CC02485                               1348 04129000
*   SARSETSZ=SETSZ;                 /* SWAP SET SIZE CONSTANT        */ 04130000
         MVC   SARSETSZ(4,@08),@CF01569                            1349 04131000
*   IF DSTBLPTR->DSTDSNC=0 THEN                                    1350 04132000
         L     @15,DSTBLPTR                                        1350 04133000
         CLI   DSTDSNC(@15),0                                      1350 04134000
         BNE   @RF01350                                            1350 04135000
*     DO;                           /* NO SWAP DATA SET SPECIFIED    */ 04136000
*       SARSIZE=SWAPEXP;            /* TOTAL SIZE IS EXPANSION       */ 04137000
         LH    @00,SWAPEXP                                         1352 04138000
         ST    @00,SARSIZE(,@08)                                   1352 04139000
*       GOTO INITSCCW;              /* CREATE SCCW'S                 */ 04140000
         B     INITSCCW                                            1353 04141000
*     END;                          /* NO SWAP DATA SET SPECIFIED    */ 04142000
*   ELSE                                                           1355 04143000
*     ;                             /* SWAP DATA SETS SPECIFIED      */ 04144000
@RF01350 DS    0H                                                  1356 04145000
*                                                                  1356 04146000
*/********************************************************************/ 04147000
*/*                                                                  */ 04148000
*/* OPENSWAP: SEGMENT TO BUILD ILRSART, OPEN SWAP DATA SETS, AND     */ 04149000
*/*           BUILD ILRSAT'S.                                        */ 04150000
*/*                                                                  */ 04151000
*/* INPUT: ILRDSTBL WITH SWAP DATA SET NAMES                         */ 04152000
*/*        ILRSART,ILRSDCT, AND ILRTPARB                             */ 04153000
*/*                                                                  */ 04154000
*/* PROCESS: LOOP THROUGH ILRDSTBL ATTEMPTING TO OPEN DATA SETS.     */ 04155000
*/*          IF OPEN, FIND SDCT ENTRY, BUILD SAT, FILL IN SART ENTRY,*/ 04156000
*/*          FILL IN CONTROL INTERVAL INFO IN TPARB, AND FREEMAIN    */ 04157000
*/*          REMAINING AREA OF SART.                                 */ 04158000
*/*                                                                  */ 04159000
*/* OUTPUT: SART ENTRIES COMPLETE                                    */ 04160000
*/*         SAT'S COMPLETE                                           */ 04161000
*/*         TPARB UPDATED WITH SWAP CONTROL INTERVALS                */ 04162000
*/*                                                                  */ 04163000
*/********************************************************************/ 04164000
*/*OPENSWAP: CHART                                                   */ 04165000
*/*HEADER                                                          1356 04166000
*/*  OPENSWAP SEGMENT                                                */ 04167000
*/*OPENSWAP: E ENTRY TO OPEN SWAP DATA SETS                          */ 04168000
*/*          P ENTRY COUNT ZEROED                                    */ 04169000
*/*          P POINT TO FIRST SART AND TPAS ENTRIES                  */ 04170000
*/*%A1:      D (YES,,NO,%A2) MORE DATA SET NAMES?                    */ 04171000
*/*          D (YES,,NO,%A4) SART ALREADY FULL?                      */ 04172000
*/*          S ILRIMMSG: THIS DATA SET INVALID                       */ 04173000
*/*          P (,%A1) MARK AS NO MORE DATA SETS                      */ 04174000
*/*%A4:      S OPEN: OPEN DATA SET                                   */ 04175000
*/*          D (NO,,YES,%E1) SUCCESSFUL OPEN?                        */ 04176000
*/*          D (YES,,NO,%A5) MOUNT FAIL?                             */ 04177000
*/*          S ILRIMMSG: SWAP MOUNT FAILED MESSAGE                   */ 04178000
*/*          D (YES,,NO,%A4) REPLIED 'IGNORE'?                       */ 04179000
*/*%A6:      P (,%A7) MARK DSTBL ENTRY AS NOT USED                   */ 04180000
*/*%A5:      N LOCATE FAILED                                         */ 04181000
*/*          S OPENA: ASK FOR REPLACEMENT DATA SET                   */ 04182000
*/*%A8:      D (NO,,YES,%A6) 'IGNORE' TO LOCATE FAIL?                */ 04183000
*/*          N (,%A4) GIVEN NEW NAME                                 */ 04184000
*/*%E1:      P LOCATE SDCT FOR THIS DEVICE                           */ 04185000
*/*          P PUT ADDRESS OF SDCT IN SART ENTRY                     */ 04186000
*/*          P FILL IN OPEN INFO IN SART ENTRY                       */ 04187000
*/*          P UPDATE COUNTS IN SART HEADER                          */ 04188000
*/*          P PUT NAME AND CONTROL INTERVAL INFO IN TPAS            */ 04189000
*/*          P CALCULATE CYLINDERS AND MAP WORDS                     */ 04190000
*/*          P CALCULATE LENGTH OF SAT                               */ 04191000
*/*          L UNCONDITIONAL GETMAIN FOR SAT                         */ 04192000
*/*          P PUT SATPTR IN SART ENTRY                              */ 04193000
*/*          P ZERO AND FILL IN SAT HEADER                           */ 04194000
*/*          P COPY DEVICE MASK TO ALL MAP WORDS                     */ 04195000
*/*          P INCREMENT ENTRY COUNT                                 */ 04196000
*/*          P LSTPTR THIS SART ENTRY                                */ 04197000
*/*          P NEXT TPAS ENTRY                                       */ 04198000
*/*          P NEXT SART ENTRY                                       */ 04199000
*/*%A7:      P (,%A1) NEXT DSTBL ENTRY                               */ 04200000
*/*%A2:      D (YES,,NO,%A9) OPEN AT LEAST ONE DATA SET?             */ 04201000
*/*          P PUT 1ST SART ENTRY ADDRESS IN SART HDR                */ 04202000
*/*          P POINT LAST ENTRY TO THE FIRST ENTRY                   */ 04203000
*/*%A9:      P MARK LAST TPAS ENTRY AS LAST                          */ 04204000
*/*          P CALCULATE SART SIZE                                   */ 04205000
*/*          L FREEMAIN ANY REMAINING SART                           */ 04206000
*/*          R FLOW CONTINUES AT INITSCCW                            */ 04207000
*/*OPENSWAP: END                                                     */ 04208000
*                                                                  1356 04209000
*                                                                  1356 04210000
*   /*****************************************************************/ 04211000
*   /*                                                               */ 04212000
*   /* OPENSWAP                                                      */ 04213000
*   /*                                                               */ 04214000
*   /*****************************************************************/ 04215000
*                                                                  1356 04216000
*   PARMFLG=PARMSW;                 /* SET FLAG IN ILROPS00 PARM     */ 04217000
         MVI   PARMFLG,X'00'                                       1356 04218000
*   ENTRIES=0;                      /* INITIALIZE COUNT OF SWAP D.S. */ 04219000
         SLR   @08,@08                                             1357 04220000
         STH   @08,ENTRIES                                         1357 04221000
*   DSTEPTR=DSTBLPTR;               /* FIRST SWAP SPECIFIED          */ 04222000
         L     DSTEPTR,DSTBLPTR                                    1358 04223000
*   SAREPTR=ADDR(SARENTS);          /* FIRST ENTRY IN SART           */ 04224000
         L     @08,SARTPTR                                         1359 04225000
         LA    SAREPTR,SARENTS(,@08)                               1359 04226000
*   TPASPTR=ADDR(TPARSENT);         /* FIRST TPARB SWAP ENTRY        */ 04227000
         L     @06,TPARPTR                                         1360 04228000
         AL    @06,@CF02914                                        1360 04229000
         ST    @06,TPASPTR                                         1360 04230000
*   LSTFPTR=ADDR(SARFXDNX);         /* CHAIN FOR FIXED HEAD DEVICES  */ 04231000
         LA    @06,SARFXDNX(,@08)                                  1361 04232000
         ST    @06,LSTFPTR                                         1361 04233000
*   LSTMPTR=ADDR(SARMOVNX);         /* CHAIN FOR MOVEABLE HEAD     1362 04234000
*                                      DEVICES                       */ 04235000
         LA    @08,SARMOVNX(,@08)                                  1362 04236000
         ST    @08,LSTMPTR                                         1362 04237000
*   DO WHILE DSTDSNC^=0;            /* DO WHILE MORE SWAPS SPECIFIED */ 04238000
         B     @DE01363                                            1363 04239000
@DL01363 DS    0H                                                  1364 04240000
*     IF SARUSE=ENTSART THEN                                       1364 04241000
         L     @08,SARTPTR                                         1364 04242000
         CLC   SARUSE(4,@08),@CF00075                              1364 04243000
         BNE   @RF01364                                            1364 04244000
*       DO;                         /* SART FULL?                    */ 04245000
*         MSGID=M918I;              /* UNABLE TO PROCESS DATA SET    */ 04246000
         MVC   MSGID(4),@CC02547                                   1366 04247000
*         MSGDATA1=ADDR(DSTDSN);    /* SEND DATA SET NAME            */ 04248000
         ST    DSTEPTR,MSGDATA1                                    1367 04249000
*         FLAGS=SWAPEQ;             /* SWAP DATA SET                 */ 04250000
         MVI   FLAGS,X'40'                                         1368 04251000
*         R1=ADDR(MSGPL);           /* PARM TO MESSAGE MODULE        */ 04252000
         LA    R1,MSGPL                                            1369 04253000
*         CALL ILRIMMSG;            /* MESSAGE MODULE                */ 04254000
         L     @15,@CV02592                                        1370 04255000
         BALR  @14,@15                                             1370 04256000
*       END;                        /* SART FULL                     */ 04257000
*     ELSE                                                         1372 04258000
*       DO;                         /* ROOM IN SART                  */ 04259000
         B     @RC01364                                            1372 04260000
@RF01364 DS    0H                                                  1373 04261000
*REDOSWAP:                                                         1373 04262000
*         PARMDSN=DSTDSN;           /* DATA SET NAME TO OPEN ROUTINE */ 04263000
REDOSWAP MVC   PARMDSN(44),DSTDSN(DSTEPTR)                         1373 04264000
*         RFY                                                      1374 04265000
*           R15 RSTD;                                              1374 04266000
*         CALL OPEN;                /* OPEN SUBROUTINE               */ 04267000
         BAL   @14,OPEN                                            1375 04268000
*         IF R15^=0 THEN                                           1376 04269000
         LTR   R15,R15                                             1376 04270000
         BZ    @RF01376                                            1376 04271000
*           DO;                     /* NOT OPEN?                     */ 04272000
*             IF R15=NOVOLMNT THEN                                 1378 04273000
         C     R15,@CF00056                                        1378 04274000
         BNE   @RF01378                                            1378 04275000
*               DO;                 /* MOUNT FAIL?                   */ 04276000
*                 MSGID=M923D;      /* MOUNT FAIL ON SWAP            */ 04277000
         MVC   MSGID(4),@CC02555                                   1380 04278000
*                 MSGDATA1=ADDR(VOLSER);/* SEND VOLID                */ 04279000
         LA    @14,PARMDSN                                         1381 04280000
         LA    @14,VOLSER(,@14)                                    1381 04281000
         ST    @14,MSGDATA1                                        1381 04282000
*                 FLAGS=SWAPEQ;     /* SWAP DATA SET                 */ 04283000
         MVI   FLAGS,X'40'                                         1382 04284000
*                 R1=ADDR(MSGPL);   /* SEND PARM TO MESSAGE MODULE   */ 04285000
         LA    R1,MSGPL                                            1383 04286000
*                 CALL ILRIMMSG;    /* MESSAGE MODULE                */ 04287000
         L     @15,@CV02592                                        1384 04288000
         BALR  @14,@15                                             1384 04289000
*                 IF R1->MSGBUF(1:LENGTH(IGNORE))^=IGNORE THEN     1385 04290000
         CLC   MSGBUF(6,R1),@CC02477                               1385 04291000
         BNE   @RT01385                                            1385 04292000
*                   GOTO REDOSWAP;  /* SAID TO TRY AGAIN             */ 04293000
*                 ELSE                                             1387 04294000
*                   DSTNUSED=ON;    /* OPERATOR SAID IGNORE          */ 04295000
         OI    DSTNUSED(DSTEPTR),B'00100000'                       1387 04296000
*               END;                /* MOUNT FAILED                  */ 04297000
*             ELSE                                                 1389 04298000
*               DO;                 /* LOCATE FAILED                 */ 04299000
         B     @RC01378                                            1389 04300000
@RF01378 DS    0H                                                  1390 04301000
*                 CALL OPENA;       /* ASK FOR A NEW NAME            */ 04302000
         BAL   @14,OPENA                                           1390 04303000
*                 IF R15=IGNORVOL THEN                             1391 04304000
         C     R15,@CF00069                                        1391 04305000
         BNE   @RF01391                                            1391 04306000
*                   DO;             /* NO NEW NAME?                  */ 04307000
*                     RFY                                          1393 04308000
*                       R15 UNRSTD;                                1393 04309000
*                     DSTNUSED=ON;  /* MARK AS NOT TO USE            */ 04310000
         OI    DSTNUSED(DSTEPTR),B'00100000'                       1394 04311000
*                   END;            /* NO NEW NAME                   */ 04312000
*                 ELSE                                             1396 04313000
*                   GOTO REDOSWAP;  /* NEW UNIQUE SWAP D.S. NAME     */ 04314000
*               END;                /* LOCATE FAILED                 */ 04315000
*           END;                    /* NOT OPEN                      */ 04316000
*         ELSE                                                     1399 04317000
*           DO;                     /* OPENED SUCCESSFUL             */ 04318000
         B     @RC01376                                            1399 04319000
@RF01376 DS    0H                                                  1400 04320000
*             SDCTEPTR=ADDR(SDCENTS);/* SEARCH FOR CORRECT SDCTE     */ 04321000
         L     @08,SDCTPTR                                         1400 04322000
         LA    @06,SDCENTS(,@08)                                   1400 04323000
         ST    @06,SDCTEPTR                                        1400 04324000
*             COUNTER=SDCSIZE;      /* NUMBER TO SEARCH              */ 04325000
         LH    COUNTER,SDCSIZE(,@08)                               1401 04326000
         N     COUNTER,@CF02910                                    1401 04327000
*             DO WHILE COUNTER^=0&DEVTYP^=SDCDTYPX;/* FIND OR NO MORE*/ 04328000
         B     @DE01402                                            1402 04329000
@DL01402 DS    0H                                                  1403 04330000
*               COUNTER=COUNTER-ONE;/* NOT THIS ONE                  */ 04331000
         BCTR  COUNTER,0                                           1403 04332000
*               SDCTEPTR=SDCTEPTR+LENGTH(SDCTE);/* TRY NEXT SDCTE    */ 04333000
         LA    @08,20                                              1404 04334000
         AL    @08,SDCTEPTR                                        1404 04335000
         ST    @08,SDCTEPTR                                        1404 04336000
*             END;                  /* FIND OR NO MORE               */ 04337000
@DE01402 LTR   COUNTER,COUNTER                                     1405 04338000
         BZ    @DC01402                                            1405 04339000
         LA    @08,PARMDSN                                         1405 04340000
         L     @06,SDCTEPTR                                        1405 04341000
         CLC   DEVTYP(2,@08),SDCDTYPX(@06)                         1405 04342000
         BNE   @DL01402                                            1405 04343000
@DC01402 DS    0H                                                  1406 04344000
*             IF COUNTER=0 THEN     /* NOT A SUPPORTED DEVICE?       */ 04345000
         LTR   COUNTER,COUNTER                                     1406 04346000
         BNZ   @RF01406                                            1406 04347000
*               DSTNUSED=ON;        /* MARK AS NOT TO USE            */ 04348000
         OI    DSTNUSED(DSTEPTR),B'00100000'                       1407 04349000
*                                                                  1408 04350000
*             /*******************************************************/ 04351000
*             /*                                                     */ 04352000
*             /* FILL IN SART ENTRY ,SART HEADER, TPAS, & CHAIN ENT. */ 04353000
*             /*                                                     */ 04354000
*             /*******************************************************/ 04355000
*                                                                  1408 04356000
*             ELSE                                                 1408 04357000
*               DO;                 /* DEVICE SUPPORTED              */ 04358000
         B     @RC01406                                            1408 04359000
@RF01406 DS    0H                                                  1409 04360000
*                 SRESDCTE=SDCTEPTR;/* PUT SDCTE IN SARTE            */ 04361000
         L     @06,SDCTEPTR                                        1409 04362000
         ST    @06,SRESDCTE(,SAREPTR)                              1409 04363000
*                 SRENN=ENTRIES;    /* SARTE # (ZERO ORIGIN)         */ 04364000
         LH    @06,ENTRIES                                         1410 04365000
         STH   @06,SRENN(,SAREPTR)                                 1410 04366000
*                 SREIORB=RTNIORBP; /* IORB RETURN FROM OPEN ROUTINE */ 04367000
         LA    @06,PARMDSN                                         1411 04368000
         L     @03,RTNIORBP(,@06)                                  1411 04369000
         ST    @03,SREIORB(,SAREPTR)                               1411 04370000
*                 SREEDB=RTNEDBP;   /* EDB RETURNED                  */ 04371000
         L     @00,RTNEDBP(,@06)                                   1412 04372000
         ST    @00,SREEDB(,SAREPTR)                                1412 04373000
*                 SREUCB=RTNUCBP;   /* UCB RETURNED                  */ 04374000
         L     @06,RTNUCBP(,@06)                                   1413 04375000
         ST    @06,SREUCB(,SAREPTR)                                1413 04376000
*                 SCHPTR=SREIORB;   /* POINT TO FIRST IORB           */ 04377000
         LR    SCHPTR,@03                                          1414 04378000
*                 DO UNTIL SCHPTR=0;/* DO ALL IORBS ON CHAIN         */ 04379000
@DL01415 DS    0H                                                  1416 04380000
*                   SCHPTR->IORPARTE=SAREPTR;/* BACK POINT TO SARTE  */ 04381000
         ST    SAREPTR,IORPARTE(,SCHPTR)                           1416 04382000
*                   SCHPTR=SCHPTR->IORIORB;/* POINT TO NEXT IORB     */ 04383000
         L     SCHPTR,IORIORB(,SCHPTR)                             1417 04384000
*                 END;              /* DO ALL IORBS ON CHAIN         */ 04385000
*                                                                  1418 04386000
@DE01415 LTR   SCHPTR,SCHPTR                                       1418 04387000
         BNZ   @DL01415                                            1418 04388000
*                 /***************************************************/ 04389000
*                 /*                                                 */ 04390000
*                 /* CALCULATING NUMBER OF SWAP SETS AVAILABLE.      */ 04391000
*                 /* CANNOT SIMPLY DIVIDE SLOT NUMBER BY SWAP SET    */ 04392000
*                 /* SIZE. EXTRA SLOTS IN A CYLINDER ARE NOT USED.   */ 04393000
*                 /* DROP REMAINDERS.                                */ 04394000
*                 /*                                                 */ 04395000
*                 /***************************************************/ 04396000
*                                                                  1419 04397000
*                 SRETOTSL=(SLOTNBR/SDCCYLSZ)*(SDCCYLSZ/SETSZ);/*  1419 04398000
*                                      CYLS MULTIPLIED BY SWAP SETS     04399000
*                                      PER CYLINDER                  */ 04400000
         LA    @08,PARMDSN                                         1419 04401000
         L     @06,SDCTEPTR                                        1419 04402000
         LH    @03,SDCCYLSZ(,@06)                                  1419 04403000
         N     @03,@CF02910                                        1419 04404000
         L     @05,SLOTNBR(,@08)                                   1419 04405000
         SLR   @04,@04                                             1419 04406000
         DR    @04,@03                                             1419 04407000
         LR    @15,@03                                             1419 04408000
         SLR   @14,@14                                             1419 04409000
         D     @14,@CF01569                                        1419 04410000
         MR    @04,@15                                             1419 04411000
         ST    @05,SRETOTSL(,SAREPTR)                              1419 04412000
*                 SREAVLSL=SRETOTSL;/* ALL SWAP SETS AVAILABLE       */ 04413000
         ST    @05,SREAVLSL(,SAREPTR)                              1420 04414000
*                 SARSETCT=SARSETCT+SRETOTSL;/* ADD TO ALL SWAP SETS */ 04415000
         L     @08,SARTPTR                                         1421 04416000
         AL    @05,SARSETCT(,@08)                                  1421 04417000
         ST    @05,SARSETCT(,@08)                                  1421 04418000
*                 SARUSE=SARUSE+ONE;/* ONE MORE SWAP DATA SET        */ 04419000
         LA    @03,1                                               1422 04420000
         AL    @03,SARUSE(,@08)                                    1422 04421000
         ST    @03,SARUSE(,@08)                                    1422 04422000
*                 IF SDCDEVTP=H23051TP|SDCDEVTP=H23052TP THEN      1423 04423000
         CLC   SDCDEVTP(6,@06),H23051TP                            1423 04424000
         BE    @RT01423                                            1423 04425000
         CLC   SDCDEVTP(6,@06),H23052TP                            1423 04426000
         BNE   @RF01423                                            1423 04427000
@RT01423 DS    0H                                                  1424 04428000
*                   DO;             /* FIXED?                        */ 04429000
*                     SREFIXED=ON;  /* MARK AS FIXED HEAD DEVICE     */ 04430000
         OI    SREFIXED(SAREPTR),B'00010000'                       1425 04431000
*                     LSTFPTR->NEXTPTR=SAREPTR;/* PUT IN FIXED CHAIN */ 04432000
         L     @08,LSTFPTR                                         1426 04433000
         ST    SAREPTR,NEXTPTR(,@08)                               1426 04434000
*                     LSTFPTR=ADDR(SRENEXT);/* NEXT CHAIN ADDRESS  1427 04435000
*                                      LOCATION                      */ 04436000
         ST    SAREPTR,LSTFPTR                                     1427 04437000
*                   END;            /* FIXED                         */ 04438000
*                 ELSE                                             1429 04439000
*                   DO;             /* MOVEABLE HEAD DEVICE          */ 04440000
         B     @RC01423                                            1429 04441000
@RF01423 DS    0H                                                  1430 04442000
*                     LSTMPTR->NEXTPTR=SAREPTR;/* PUT IN MOVEABLE  1430 04443000
*                                      CHAIN                         */ 04444000
         L     @08,LSTMPTR                                         1430 04445000
         ST    SAREPTR,NEXTPTR(,@08)                               1430 04446000
*                     LSTMPTR=ADDR(SRENEXT);/* NEXT CHAIN ADDRESS  1431 04447000
*                                      LOCATION                      */ 04448000
         ST    SAREPTR,LSTMPTR                                     1431 04449000
*                   END;            /* MOVEABLE HEAD DEVICE          */ 04450000
*                 TPASDSN=DSTDSN;   /* D.S. IN TPARTBLE FOR TMI      */ 04451000
*                                                                  1433 04452000
@RC01423 L     @06,TPASPTR                                         1433 04453000
         MVC   TPASDSN(44,@06),DSTDSN(DSTEPTR)                     1433 04454000
*                 /***************************************************/ 04455000
*                 /*                                                 */ 04456000
*                 /* BUILD SAT                                       */ 04457000
*                 /*                                                 */ 04458000
*                 /***************************************************/ 04459000
*                                                                  1434 04460000
*                 CYLS=SLOTNBR/SDCCYLSZ;/* CYLINDERS IN DATA SET     */ 04461000
         LA    @06,PARMDSN                                         1434 04462000
         L     @15,SDCTEPTR                                        1434 04463000
         L     @05,SLOTNBR(,@06)                                   1434 04464000
         SLR   @04,@04                                             1434 04465000
         LH    CYLS,SDCCYLSZ(,@15)                                 1434 04466000
         N     CYLS,@CF02910                                       1434 04467000
         DR    @04,CYLS                                            1434 04468000
         LR    CYLS,@05                                            1434 04469000
*                 CYLMB=1;          /* PREPARE TO MULTIPLY BY EXP    */ 04470000
         LA    CYLMB,1                                             1435 04471000
*                 SLL(CYLMB,SDCMPEXP);/* NUMBER OF BYTES TO MAP CYL     04472000
*                                      SAT LENGTH ROUNDED DWORD      */ 04473000
         SLR   @06,@06                                             1436 04474000
         IC    @06,SDCMPEXP(,@15)                                  1436 04475000
         SLL   CYLMB,0(@06)                                        1436 04476000
*                 LEN=LENGTH(SATHDR)+((CYLS*CYLMB+7)/8)*8;         1437 04477000
         LR    @05,CYLMB                                           1437 04478000
         MR    @04,CYLS                                            1437 04479000
         LR    @14,@05                                             1437 04480000
         AL    @14,@CF00061                                        1437 04481000
         SRDA  @14,32                                              1437 04482000
         D     @14,@CF00056                                        1437 04483000
         SLA   @15,3                                               1437 04484000
         AL    @15,@CF00120                                        1437 04485000
         ST    @15,LEN                                             1437 04486000
*                 DO;               /* GETMAIN (RU) LV(LEN)        1438 04487000
*                                      SP(SQASPID)                   */ 04488000
*                   RESPECIFY                                      1439 04489000
*                    (GPR01F,                                      1439 04490000
*                     GPR15F,                                      1439 04491000
*                     GPR00F) RESTRICTED;                          1439 04492000
*                   GPR01F=0;       /* REG 1 MUST BE ZERO            */ 04493000
         SLR   GPR01F,GPR01F                                       1440 04494000
*                   GPR15F=2;       /* RU-TYPE GETMAIN               */ 04495000
         LA    GPR15F,2                                            1441 04496000
*                   GPR00F=LEN;     /* LENGTH REQUESTED              */ 04497000
         L     @14,LEN                                             1442 04498000
         LR    GPR00F,@14                                          1442 04499000
*                   GPR15F=GPR15F|((SQASPID)*256);/* SP IN BYTE 2    */ 04500000
         O     GPR15F,@CF02881                                     1443 04501000
*                   SVC(120);       /* RC/RU-FORM OF GETMAIN         */ 04502000
         SVC   120                                                 1444 04503000
*                   RESPECIFY                                      1445 04504000
*                    (GPR01F,                                      1445 04505000
*                     GPR15F,                                      1445 04506000
*                     GPR00F) UNRESTRICTED;                        1445 04507000
*                 END;              /* GETMAIN (RU) LV(LEN)        1446 04508000
*                                      SP(SQASPID) SAT AREA          */ 04509000
*                                                                  1446 04510000
*                 /***************************************************/ 04511000
*                 /*                                                 */ 04512000
*                 /* USED R1 AS SATPTR TO AVOID A PLS PROBLEM        */ 04513000
*                 /*                                                 */ 04514000
*                 /***************************************************/ 04515000
*                                                                  1447 04516000
*                 SRESAT=SATPTR;    /* PUT IN SARTE                  */ 04517000
         ST    SATPTR,SRESAT(,SAREPTR)                             1447 04518000
*                 SATHDR=''B;       /* ZERO SAT HEADER (INIT MAP)    */ 04519000
         XC    SATHDR(32,SATPTR),SATHDR(SATPTR)                    1448 04520000
*                 SATID=SATIDNT;    /* PUT IN IDENTIFIER             */ 04521000
         MVC   SATID(4,SATPTR),@CC02487                            1449 04522000
*                 SATBYTCL=SDCMPEXP;/* EXPONENT OF 2 TO MAP CYL      */ 04523000
         L     @06,SDCTEPTR                                        1450 04524000
         SLR   @00,@00                                             1450 04525000
         IC    @00,SDCMPEXP(,@06)                                  1450 04526000
         STH   @00,SATBYTCL(,SATPTR)                               1450 04527000
*                 SATSARTE=SAREPTR; /* POINT BACK TO SARTE           */ 04528000
         ST    SAREPTR,SATSARTE(,SATPTR)                           1451 04529000
*                 SATMAPLN=CYLS*CYLMB;/* BYTES IN MAP ACTUALLY TO USE*/ 04530000
         LR    @05,CYLMB                                           1452 04531000
         MR    @04,CYLS                                            1452 04532000
         STH   @05,SATMAPLN(,SATPTR)                               1452 04533000
*                 SATSCAN=ADDR(SATMAPS);/* WHERE TO BEGIN SCAN OF  1453 04534000
*                                      MAPS                          */ 04535000
*                                                                  1453 04536000
         LA    @06,SATMAPS(,SATPTR)                                1453 04537000
         ST    @06,SATSCAN(,SATPTR)                                1453 04538000
*                 /***************************************************/ 04539000
*                 /*                                                 */ 04540000
*                 /* INITIALIZE SAT MAP AREA WITH SATCYLMP AND       */ 04541000
*                 /* SDCCMASK AT FOUR BYTES, LARGEST BYTCL HANDLED IS*/ 04542000
*                 /* 2. IF EVER A DEVICE WITH LARGER MAP REQUIREMENT */ 04543000
*                 /* SO BYTCL GREATER THAN 2, NEED TO CHANGE FIELDS. */ 04544000
*                 /*                                                 */ 04545000
*                 /***************************************************/ 04546000
*                                                                  1454 04547000
*                 SATCYLA=ADDR(SATMAPS);/* START WITH 1ST SAT MAP    */ 04548000
         LR    SATCYLA,@06                                         1454 04549000
*                 ENDSAT=SATPTR+LEN;/* END OF SAT MAPS               */ 04550000
         LR    ENDSAT,SATPTR                                       1455 04551000
         AL    ENDSAT,LEN                                          1455 04552000
*                 DO WHILE SATCYLA<ENDSAT;/* DO ALL SAT MAPS         */ 04553000
         B     @DE01456                                            1456 04554000
@DL01456 DS    0H                                                  1457 04555000
*                   SATCYLMP=SDCCMASK;/* MASK THE FIRST MAP(WORD)    */ 04556000
         L     @06,SDCTEPTR                                        1457 04557000
         L     @06,SDCCMASK(,@06)                                  1457 04558000
         ST    @06,SATCYLMP(,SATCYLA)                              1457 04559000
*                   SATCYLA=SATCYLA+LENGTH(SATCYLMP);/* NEXT       1458 04560000
*                                      MAP(WORD)                     */ 04561000
         AL    SATCYLA,@CF00069                                    1458 04562000
*                 END;              /* DO ALL SAT MAPS               */ 04563000
@DE01456 CR    SATCYLA,ENDSAT                                      1459 04564000
         BL    @DL01456                                            1459 04565000
*                 TPASPTR=TPASPTR+LENGTH(TPARSENT);/* NEXT TPAS      */ 04566000
         LA    @08,48                                              1460 04567000
         L     @06,TPASPTR                                         1460 04568000
         ALR   @06,@08                                             1460 04569000
         ST    @06,TPASPTR                                         1460 04570000
*                 ENTRIES=ENTRIES+ONE;/* COMPLETED ONE SARTE         */ 04571000
         LH    @06,ENTRIES                                         1461 04572000
         LA    @06,1(,@06)                                         1461 04573000
         STH   @06,ENTRIES                                         1461 04574000
*                 SAREPTR=SAREPTR+LENGTH(SARTE);/* NEXT SARTE        */ 04575000
         ALR   SAREPTR,@08                                         1462 04576000
*               END;                /* DEVICE SUPPORTED              */ 04577000
*           END;                    /* OPEN SUCCESSFULLY             */ 04578000
@RC01406 DS    0H                                                  1465 04579000
*       END;                        /* ROOM IN SART                  */ 04580000
@RC01376 DS    0H                                                  1466 04581000
*     DSTEPTR=DSTEPTR+LENGTH(DSTENT);/* NEXT SWAP SPECIFIED          */ 04582000
@RC01364 AL    DSTEPTR,@CF00076                                    1466 04583000
*   END;                            /* DO WHILE MORE SWAPS SPECIFIED */ 04584000
@DE01363 CLI   DSTDSNC(DSTEPTR),0                                  1467 04585000
         BNE   @DL01363                                            1467 04586000
*                                                                  1468 04587000
*   /*****************************************************************/ 04588000
*   /*                                                               */ 04589000
*   /* HOUSEKEEP OF OPENSWAP                                         */ 04590000
*   /*                                                               */ 04591000
*   /*****************************************************************/ 04592000
*                                                                  1468 04593000
*   IF SARUSE>0 THEN                                               1468 04594000
         L     @08,SARTPTR                                         1468 04595000
         L     @03,SARUSE(,@08)                                    1468 04596000
         LTR   @03,@03                                             1468 04597000
         BNP   @RF01468                                            1468 04598000
*     DO;                           /* ANY SWAP DATA SETS COMPLETE?  */ 04599000
*       LSTFPTR->NEXTPTR=SARFXDNX;  /* COMPLETE FIXED CHAIN CIRCLE   */ 04600000
         L     @03,SARFXDNX(,@08)                                  1470 04601000
         L     @15,LSTFPTR                                         1470 04602000
         ST    @03,NEXTPTR(,@15)                                   1470 04603000
*       LSTMPTR->NEXTPTR=SARMOVNX;  /* COMPLETE MOVEABLE CHAIN CIRCLE*/ 04604000
         L     @08,SARMOVNX(,@08)                                  1471 04605000
         L     @03,LSTMPTR                                         1471 04606000
         ST    @08,NEXTPTR(,@03)                                   1471 04607000
*     END;                          /* ANY SWAP DATA SETS COMPLETE   */ 04608000
*   ELSE                                                           1473 04609000
*     ;                             /* NO SWAP DATAS COMPLETED       */ 04610000
@RF01468 DS    0H                                                  1474 04611000
*   ENTLEFT=ENTSART-SARUSE;         /* SARTE'S EMPTY                 */ 04612000
         L     @08,SARTPTR                                         1474 04613000
         L     @15,SARUSE(,@08)                                    1474 04614000
         LA    ENTLEFT,25                                          1474 04615000
         SLR   ENTLEFT,@15                                         1474 04616000
*   IF ENTLEFT>SWAPEXP THEN                                        1475 04617000
         LH    @14,SWAPEXP                                         1475 04618000
         CR    ENTLEFT,@14                                         1475 04619000
         BNH   @RF01475                                            1475 04620000
*     DO;                           /* MORE EMPTY THAN EXTRAS NEEDED?*/ 04621000
*       SARSIZE=SARUSE+SWAPEXP;     /* SIZE OF SART                  */ 04622000
         ALR   @15,@14                                             1477 04623000
         ST    @15,SARSIZE(,@08)                                   1477 04624000
*       ENTLEFT=ENTLEFT-SWAPEXP;    /* NOW WHAT LEFT TO FREE         */ 04625000
         SLR   ENTLEFT,@14                                         1478 04626000
*       SAREPTR=SAREPTR+(SWAPEXP*(LENGTH(SARTE)));/* WHAT TO FREE    */ 04627000
         LA    @08,48                                              1479 04628000
         LR    @05,@14                                             1479 04629000
         MR    @04,@08                                             1479 04630000
         ALR   SAREPTR,@05                                         1479 04631000
*       DO;                         /* FREEMAIN(RU) LV(ENTLEFT*LENGTH   04632000
*                                      (SARTE))A(SARTE) SP(SQASPID)  */ 04633000
*         RESPECIFY                                                1481 04634000
*          (GPR01F,                                                1481 04635000
*           GPR15F,                                                1481 04636000
*           GPR00F) RESTRICTED;                                    1481 04637000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 04638000
         SLR   GPR01F,GPR01F                                       1482 04639000
*         GPR15F=3;                 /* SET TYPE                      */ 04640000
         LA    GPR15F,3                                            1483 04641000
*         GPR00F=ENTLEFT*LENGTH(SARTE);/* LENGTH REQUESTED           */ 04642000
         LR    @05,@08                                             1484 04643000
         MR    @04,ENTLEFT                                         1484 04644000
         LR    GPR00F,@05                                          1484 04645000
*         GPR01F=ADDR(SARTE);       /* SET REGISTER ONE              */ 04646000
         LR    GPR01F,SAREPTR                                      1485 04647000
*         GPR15F=GPR15F+((SQASPID)*256);/* SUBPOOL VALUE             */ 04648000
         AL    GPR15F,@CF02881                                     1486 04649000
*         SVC(120);                 /* RC/RU-FORM OF GETMAIN         */ 04650000
         SVC   120                                                 1487 04651000
*         RESPECIFY                                                1488 04652000
*          (GPR01F,                                                1488 04653000
*           GPR15F,                                                1488 04654000
*           GPR00F) UNRESTRICTED;                                  1488 04655000
*       END;                        /* FREEMAIN(RU) LV(ENTLEFT*LENGTH   04656000
*                                      (SARTE))A(SARTE) SP(SQASPID)  */ 04657000
*     END;                          /* MORE EMPTY THAN EXTRAS NEEDED */ 04658000
*   ELSE                                                           1491 04659000
*     SARSIZE=ENTSART;              /* SIZE OF SART(MAX)             */ 04660000
         B     @RC01475                                            1491 04661000
@RF01475 L     @08,SARTPTR                                         1491 04662000
         MVC   SARSIZE(4,@08),@CF00075                             1491 04663000
*                                                                  1492 04664000
*/********************************************************************/ 04665000
*/*                                                                  */ 04666000
*/* INITSCCW: SEGMENT TO COMPLETE SART AND BUILD SCCW'S              */ 04667000
*/*                                                                  */ 04668000
*/* INPUT: SART AND ASMVT                                            */ 04669000
*/*                                                                  */ 04670000
*/* PROCESS: IF SARSIZE IS ZERO THERE WILL BE NO SWAP DATA SETS THIS */ 04671000
*/*          IPL, SO NO SCCW'S ARE CREATED. OTHERWISE, AREA OBTAINED */ 04672000
*/*          FROM NUCLEUS BUFFER FOR SCCWS.  CALCULATE HOW MANY AND  */ 04673000
*/*          PUT POINTER OF FIRST IN SART HEADER.  INITIALIZE THE    */ 04674000
*/*          SCCWS, CHAIN TOGETHER.                                  */ 04675000
*/*                                                                  */ 04676000
*/* OUTPUT: COMPLETED SART                                           */ 04677000
*/*         INITIALIZED SCCW'S                                       */ 04678000
*/*         ADDRESS OF FIRST SCCW IN SART                            */ 04679000
*/*                                                                  */ 04680000
*/********************************************************************/ 04681000
*/*INITSCCW: CHART                                                   */ 04682000
*/*HEADER                                                          1492 04683000
*/*  INITSCCW SEGMENT                                                */ 04684000
*/*INITSCCW: E ENTRY TO INIT SCCW'S                                  */ 04685000
*/*          D (NO,,YES,%A1) MORE SWAP DATA SETS THAN MINIMUM?       */ 04686000
*/*          P (,%A2) NUMBER IS MINIMUM                              */ 04687000
*/*%A1:      D (NO,,YES,%A6) LESS SWAP D.S. THAN MAXIMUM?            */ 04688000
*/*          P (,%A2) NUMBER IS MAXIMUM                              */ 04689000
*/*%A6:      P NUMBER IS NUMBER OF SWAP DATA SETS                    */ 04690000
*/*%A2:      P LENGTH OF SCCW MULTIPLIED BY NUMBER                   */ 04691000
*/*          P GET NUCLEUS BUFFER SPACE FOR SCCW'S                   */ 04692000
*/*          D (NO,,YES,%A5) ENOUGH NUCLEUS BUFFER SPACE?            */ 04693000
*/*          S ILRIMMSG: ISSUE MESSAGE IEA340I                       */ 04694000
*/*          R WAIT STATE 38                                         */ 04695000
*/*%A5:      P PUT ADDRESS OF FIRST IN SART                          */ 04696000
*/*%A3:      D (NO,,YES,%A4) NUMBER IS ZERO?                         */ 04697000
*/*          P FILL IN A SCCW                                        */ 04698000
*/*          P SAVE THIS SCCW ADDRESS                                */ 04699000
*/*          P PUT ADDRESS OF NEXT SCCW IN THIS SCCW                 */ 04700000
*/*          P NEXT SCCW                                             */ 04701000
*/*          P (,%A3) DECREMENT NUMBER                               */ 04702000
*/*%A4:      P LAST SCCW POINTS TO ZEROES (END CHAIN)                */ 04703000
*/*          R FLOW CONTINUES AT LGVTSRB                             */ 04704000
*/*INITSCCW: END                                                     */ 04705000
*                                                                  1492 04706000
*INITSCCW:                          /* SWAP CHANNEL CONTROL WORDS    */ 04707000
*   IF SARSIZE^=ZERO THEN                                          1492 04708000
@RC01475 DS    0H                                                  1492 04709000
INITSCCW L     @08,SARTPTR                                         1492 04710000
         L     @00,SARSIZE(,@08)                                   1492 04711000
         LTR   @00,@00                                             1492 04712000
         BZ    @RF01492                                            1492 04713000
*     DO;                           /* NEED TO CREATE SCCWS          */ 04714000
*       IF SARUSE<=3 THEN                                          1494 04715000
         L     @08,SARUSE(,@08)                                    1494 04716000
         C     @08,@CF00092                                        1494 04717000
         BH    @RF01494                                            1494 04718000
*         NUMBER=6;                 /* LOW LIMIT OF SCCW'S?          */ 04719000
         LA    NUMBER,6                                            1495 04720000
*       ELSE                                                       1496 04721000
*         IF SARUSE>5 THEN                                         1496 04722000
         B     @RC01494                                            1496 04723000
@RF01494 L     @08,SARTPTR                                         1496 04724000
         L     @08,SARUSE(,@08)                                    1496 04725000
         C     @08,@CF01215                                        1496 04726000
         BNH   @RF01496                                            1496 04727000
*           NUMBER=10;              /* HIGH LIMIT OF SCCW'S?         */ 04728000
         LA    NUMBER,10                                           1497 04729000
*         ELSE                                                     1498 04730000
*           NUMBER=2*SARUSE;        /* OTHERWISE 2 FOR EACH D.S.     */ 04731000
         B     @RC01496                                            1498 04732000
@RF01496 L     @08,SARTPTR                                         1498 04733000
         L     NUMBER,SARUSE(,@08)                                 1498 04734000
         ALR   NUMBER,NUMBER                                       1498 04735000
*       LEN=NUMBER*LENGTH(SCCW);    /* LENGTH NEEDED FOR SCCW'S      */ 04736000
*                                                                  1499 04737000
@RC01496 DS    0H                                                  1499 04738000
@RC01494 LR    @08,NUMBER                                          1499 04739000
         MH    @08,@CH01553                                        1499 04740000
         ST    @08,LEN                                             1499 04741000
*       /*************************************************************/ 04742000
*       /*                                                           */ 04743000
*       /* SAVE ADDRESS OF NEXT AVAILABLE                            */ 04744000
*       /*                                                           */ 04745000
*       /*************************************************************/ 04746000
*                                                                  1500 04747000
*       NVTNUCND=(NVTNUCND+SEVEN)/EIGHT*EIGHT;/* ROUND TO DOUBLEWORD */ 04748000
         L     @06,NVTPTR                                          1500 04749000
         LA    @02,7                                               1500 04750000
         AL    @02,NVTNUCND(,@06)                                  1500 04751000
         SRDA  @02,32                                              1500 04752000
         D     @02,@CF00056                                        1500 04753000
         SLA   @03,3                                               1500 04754000
         ST    @03,NVTNUCND(,@06)                                  1500 04755000
*       IF NVTNBFND-NVTNUCND<LEN THEN                              1501 04756000
         LCR   @03,@03                                             1501 04757000
         AL    @03,NVTNBFND(,@06)                                  1501 04758000
         CR    @03,@08                                             1501 04759000
         BNL   @RF01501                                            1501 04760000
*         DO;                       /* STORAGE SHORT?                */ 04761000
*           MSGID=M340I;            /* MESSAGE.SHORT OF NUCLEUS    1503 04762000
*                                      BUFFER                        */ 04763000
         MVC   MSGID(4),@CC02541                                   1503 04764000
*           R1=ADDR(MSGPL);         /* PARM TO MESSAGE MODULE        */ 04765000
         LA    R1,MSGPL                                            1504 04766000
*           CALL ILRIMMSG;          /* WAIT STATE                    */ 04767000
         L     @15,@CV02592                                        1505 04768000
         BALR  @14,@15                                             1505 04769000
*         END;                      /* STORAGE SHORT                 */ 04770000
*       ELSE                                                       1507 04771000
*         ;                         /* CONTINUE                      */ 04772000
@RF01501 DS    0H                                                  1508 04773000
*       SCCWPTR=NVTNUCND;           /* FIRST SCCW IN NUCLEUS BUFFER  */ 04774000
         L     @08,NVTPTR                                          1508 04775000
         L     @06,NVTNUCND(,@08)                                  1508 04776000
         LR    SCCWPTR,@06                                         1508 04777000
*       NVTNUCND=NVTNUCND+LEN;      /* NEW AVAILABLE POINTER         */ 04778000
         L     @03,LEN                                             1509 04779000
         ALR   @06,@03                                             1509 04780000
         ST    @06,NVTNUCND(,@08)                                  1509 04781000
*       SARSCCWQ=SCCWPTR;           /* ANCHOR SCCW CHAIN IN SART     */ 04782000
         L     @08,SARTPTR                                         1510 04783000
         ST    SCCWPTR,SARSCCWQ(,@08)                              1510 04784000
*       RFY                                                        1511 04785000
*        (R0,                                                      1511 04786000
*         R14,                                                     1511 04787000
*         R15) RSTD;                                               1511 04788000
*       R0=SCCWPTR;                 /* START ZEROING HERE            */ 04789000
         LR    R0,SCCWPTR                                          1512 04790000
*       R1=LEN;                     /* ZERO THIS LENGTH              */ 04791000
         LR    R1,@03                                              1513 04792000
*       R15=ZERO;                   /* CHARACTER ZERO                */ 04793000
         SLR   R15,R15                                             1514 04794000
*       MVCL(R0,R14);               /* ZEROED                        */ 04795000
         MVCL  R0,R14                                              1515 04796000
*       DO L=1 TO NUMBER;           /* INITIALIZE ALL SCCW'S         */ 04797000
         LA    L,1                                                 1516 04798000
         B     @DE01516                                            1516 04799000
@DL01516 DS    0H                                                  1517 04800000
*         R0=SCCWPTR;               /* FILL IN SCCW CONSTANTS        */ 04801000
         LR    R0,SCCWPTR                                          1517 04802000
*         R1=LENGTH(SCCW);          /* LENGTH TO FILL IN             */ 04803000
         LA    @06,400                                             1518 04804000
         LR    R1,@06                                              1518 04805000
*         R14=ADDR(SKELETON);       /* WHERE TO GET CONSTANTS        */ 04806000
         LA    R14,SKELETON                                        1519 04807000
*         R15=LENGTH(SKELETON);     /* LENGTH OF CONSTANTS           */ 04808000
         LR    R15,@06                                             1520 04809000
*         MVCL(R0,R14);             /* ACTUAL MOVE OF CONSTANTS      */ 04810000
         MVCL  R0,R14                                              1521 04811000
*         SCCWSROP(1)='31'X;        /* 1ST SEARCH IS NOT MULTI-TRACK */ 04812000
         MVI   SCCWSROP(SCCWPTR),X'31'                             1522 04813000
*         SCCWSKAD=ADDR(SCCWBB);    /* INIT SEEK ARGUMENT            */ 04814000
         LA    @06,SCCWBB(,SCCWPTR)                                1523 04815000
         STCM  @06,7,SCCWSKAD(SCCWPTR)                             1523 04816000
*         SCCWSSAD=ADDR(SCCWSECT);  /* INIT SET SECTOR ARGUMENT      */ 04817000
         LA    @06,SCCWSECT(,SCCWPTR)                              1524 04818000
         STCM  @06,7,SCCWSSAD(SCCWPTR)                             1524 04819000
*         DO M=1 TO SETSZ;          /* EACH SLOT IN SWAP SET         */ 04820000
         LA    @06,1                                               1525 04821000
         ST    @06,M                                               1525 04822000
@DL01525 DS    0H                                                  1526 04823000
*           SCCWSRAD(M)=ADDR(SCCWCC(M));/* INIT SEARCH ID ARGUMENT   */ 04824000
         LR    @03,@06                                             1526 04825000
         MH    @03,@CH00063                                        1526 04826000
         LR    @05,@06                                             1526 04827000
         MH    @05,@CH01215                                        1526 04828000
         LA    @05,SCCWCC-5(@05,SCCWPTR)                           1526 04829000
         ST    @03,@TF00001                                        1526 04830000
         ALR   @03,SCCWPTR                                         1526 04831000
         STCM  @05,7,SCCWSRAD-24(@03)                              1526 04832000
*           SCCWTIAD(M)=ADDR(SCCWSRCH(M));/* INIT TIC ADDRESS        */ 04833000
         L     @03,@TF00001                                        1527 04834000
         LA    @03,SCCWSRCH-24(@03,SCCWPTR)                        1527 04835000
         LR    @05,SCCWPTR                                         1527 04836000
         AL    @05,@TF00001                                        1527 04837000
         STCM  @03,7,SCCWTIAD-24(@05)                              1527 04838000
*         END;                      /* EACH SLOT IN SWAP SET         */ 04839000
         AL    @06,@CF00059                                        1528 04840000
         ST    @06,M                                               1528 04841000
         C     @06,@CF01569                                        1528 04842000
         BNH   @DL01525                                            1528 04843000
*         SCCWLCCW=ADDR(SCCWRW(SETSZ));/* ADDRESS OF LAST CCW IN SCCW*/ 04844000
         LA    @06,SCCWRW+264(,SCCWPTR)                            1529 04845000
         ST    @06,SCCWLCCW(,SCCWPTR)                              1529 04846000
*         SCCWSCCW=SCCWPTR+LENGTH(SCCW);/* CHAIN TO NEXT SCCW        */ 04847000
         LA    @06,400                                             1530 04848000
         ALR   @06,SCCWPTR                                         1530 04849000
         ST    @06,SCCWSCCW(,SCCWPTR)                              1530 04850000
*         SCCWPTR=SCCWSCCW;         /* NEXT SCCW                     */ 04851000
         LR    SCCWPTR,@06                                         1531 04852000
*       END;                        /* INITIALIZE ALL SCCW'S         */ 04853000
         AL    L,@CF00059                                          1532 04854000
@DE01516 CR    L,NUMBER                                            1532 04855000
         BNH   @DL01516                                            1532 04856000
*       RFY                                                        1533 04857000
*        (R0,                                                      1533 04858000
*         R14,                                                     1533 04859000
*         R15) UNRSTD;                                             1533 04860000
*       SCCWPTR=SCCWPTR-LENGTH(SCCW);/* BACK ONE SCCW'S              */ 04861000
         SL    SCCWPTR,@CF01553                                    1534 04862000
*       SCCWSCCW=0;                 /* MARK END OF SCCW CHAIN        */ 04863000
         SLR   @08,@08                                             1535 04864000
         ST    @08,SCCWSCCW(,SCCWPTR)                              1535 04865000
*     END;                          /* NEED TO CREATE SCCWS          */ 04866000
*                                                                  1537 04867000
*/********************************************************************/ 04868000
*/*                                                                  */ 04869000
*/* LGVTSRB: SEGMENT TO INITIALIZE LGVT AND TWO SRB CONTROL BLOCKS   */ 04870000
*/*          ALSO DELETE ILROPS00 AND ILRPREAD                       */ 04871000
*/*                                                                  */ 04872000
*/* INPUT: POINTER TO BUFFER WITH ILRDSTBL FOLLOWING IT IN SQA       */ 04873000
*/*        LGVT SIZE AND NUMBER OF ENTRIES                           */ 04874000
*/*        ILRASMVT                                                  */ 04875000
*/*                                                                  */ 04876000
*/* PROCESS: USING BUFFER AREA, BUILD LGVT IN FIRST K OF BUFFER.     */ 04877000
*/*          INITIALIZE TWO SRBS IN AREA FOLLOWING LGVT. PUT POINTER */ 04878000
*/*          OF LGVT AND ONE SRB IN ASMVT. PUT POINTER OF OTHER SRB  */ 04879000
*/*          IN SART. INITIALIZE ALL LGVT ENTRIES AS AVAILABLE.      */ 04880000
*/*                                                                  */ 04881000
*/* OUTPUT: POINTER TO LGVT AND ONE SRB IN ILRASMVT                  */ 04882000
*/*         LGVT AND LGVT ENTRIES INITIALIZED                        */ 04883000
*/*         POINTER TO OTHER SRB IN ILRSART                          */ 04884000
*/*         ILROPS00 AND ILRPREAD DELETED                            */ 04885000
*/*         PLHPTR POINT TO NEXT AVAILABLE SPOT IN AREA              */ 04886000
*/********************************************************************/ 04887000
*/*LGVTSRB: CHART                                                    */ 04888000
*/*HEADER                                                          1537 04889000
*/*  LGVTSRB SEGMENT                                                 */ 04890000
*/*LGVTSRB: E ENTRY TO INITIALIZE LGVT AND SRB'S                     */ 04891000
*/*         M DELETE ILROPS00 AND ILRPREAD                           */ 04892000
*/*         P ZERO 8K OF ILRDSTBL AND BUFFER                         */ 04893000
*/*         P PUT POINTER OF LGVT IN ILRASMVT                        */ 04894000
*/*         P PUT POINTER OF ON SRB IN ASMVT                         */ 04895000
*/*         P ENTRY POINT TO ILRPTM00 IN SRB                         */ 04896000
*/*         P PUT POINTER OF OTHER SRB IN SART                       */ 04897000
*/*         P ENTRY POINT TO ILRSWPDR IN SRB                         */ 04898000
*/*         P SAVE POINTER TO NEXT AREA AVAILABLE                    */ 04899000
*/*         P FILL IN SRB ID'S, ASCB, ASID, PRIOR                    */ 04900000
*/*         P FILL IN LGVT HEADER                                    */ 04901000
*/*         P SET ENTRY COUNT TO ZERO                                */ 04902000
*/*         P POINT TO FIRST ENTRY                                   */ 04903000
*/*%A1:     P FILL IN ENTRY                                          */ 04904000
*/*         D (YES,,NO,%A2) COMPLETED LGVTE'S?                       */ 04905000
*/*         P POINTER TO NEXT LGVTE IS ZERO                          */ 04906000
*/*         R FLOW CONTINUES AT MSGBUF                               */ 04907000
*/*%A2:     P INCREMENT ENTRY COUNT                                  */ 04908000
*/*         P (,%A1) NEXT LGVTE                                      */ 04909000
*/*LGVTSRB: END                                                      */ 04910000
*                                                                  1537 04911000
*LGVTSRB:                           /* BUILD LGVT & 2 SRB'S          */ 04912000
*   DO;                             /* DELETE EP('ILROPS00')         */ 04913000
@RF01492 DS    0H                                                  1537 04914000
LGVTSRB  DS    0H                                                  1538 04915000
*     RESPECIFY                                                    1538 04916000
*      (GPR00P) RESTRICTED;                                        1538 04917000
*     GPR00P=ADDR('ILROPS00');      /* ->ENTRY NAME                  */ 04918000
         LA    GPR00P,@CC02762                                     1539 04919000
*     SVC(9);                       /* DELETE SVC                    */ 04920000
         SVC   9                                                   1540 04921000
*     RESPECIFY                                                    1541 04922000
*      (GPR00P) UNRESTRICTED;                                      1541 04923000
*   END;                            /* DELETE EP('ILROPS00') DONE  1542 04924000
*                                      OPENING DATA SETS             */ 04925000
*   DO;                             /* DELETE EP('ILRPREAD')         */ 04926000
*     RESPECIFY                                                    1544 04927000
*      (GPR00P) RESTRICTED;                                        1544 04928000
*     GPR00P=ADDR('ILRPREAD');      /* ->ENTRY NAME                  */ 04929000
         LA    GPR00P,@CC02764                                     1545 04930000
*     SVC(9);                       /* DELETE SVC                    */ 04931000
         SVC   9                                                   1546 04932000
*     RESPECIFY                                                    1547 04933000
*      (GPR00P) UNRESTRICTED;                                      1547 04934000
*   END;                            /* DELETE EP('ILRPREAD') DONE  1548 04935000
*                                      READING AND WRITING           */ 04936000
*   RFY                                                            1549 04937000
*    (R0,                                                          1549 04938000
*     R14,                                                         1549 04939000
*     R15) RSTD;                    /* USE DSTBL AND BUFFER AREAS    */ 04940000
*   R0=BUFFPTR;                     /* ZERO STARTING AT DSTBL        */ 04941000
         L     R0,BUFFPTR                                          1550 04942000
*   R1=FOURK+LENGTH(DSTBL);         /* LENGTH                        */ 04943000
         L     R1,@CF02873                                         1551 04944000
*   R15=ZERO;                                                      1552 04945000
         SLR   R15,R15                                             1552 04946000
*   MVCL(R0,R14);                   /* ZEROED                        */ 04947000
         MVCL  R0,R14                                              1553 04948000
*   RFY                                                            1554 04949000
*    (R0,                                                          1554 04950000
*     R14,                                                         1554 04951000
*     R15) UNRSTD;                                                 1554 04952000
*   LGVTPTR=BUFFPTR;                /* LGVT 1ST K IN DSTBL           */ 04953000
         L     LGVTPTR,BUFFPTR                                     1555 04954000
*   ASMLGVT=LGVTPTR;                /* POINTER IN ASMVT              */ 04955000
         L     @08,CVTPTR                                          1556 04956000
         L     @08,ASMVTPTR(,@08)                                  1556 04957000
         ST    LGVTPTR,ASMLGVT(,@08)                               1556 04958000
*   ASMPSRB=LGVTPTR+LNGLGVT;        /* PTM00 SRB POINTER IN ASMVT    */ 04959000
         LA    @06,1024                                            1557 04960000
         ALR   @06,LGVTPTR                                         1557 04961000
         ST    @06,ASMPSRB(,@08)                                   1557 04962000
*   SARSRBP=ASMPSRB+LENGTH(SRB);    /* SWAP DR SRB POINTER IN SART   */ 04963000
         LA    @08,44                                              1558 04964000
         LR    @03,@06                                             1558 04965000
         ALR   @03,@08                                             1558 04966000
         L     @15,SARTPTR                                         1558 04967000
         ST    @03,SARSRBP(,@15)                                   1558 04968000
*   PLHPTR=SARSRBP+LENGTH(SRB);     /* INITIALIZE SRB'S              */ 04969000
*                                                                  1559 04970000
         ALR   @03,@08                                             1559 04971000
         ST    @03,PLHPTR                                          1559 04972000
*   /*****************************************************************/ 04973000
*   /*                                                               */ 04974000
*   /* INITIALIZE SRBS                                               */ 04975000
*   /*                                                               */ 04976000
*   /*****************************************************************/ 04977000
*                                                                  1560 04978000
*   SRBPTR=ASMPSRB;                 /* POINT TO FIRST SRB            */ 04979000
         LR    SRBPTR,@06                                          1560 04980000
*   COUNT=ZERO;                     /* FLAG FOR COMPLETED            */ 04981000
         SLR   @08,@08                                             1561 04982000
         STH   @08,COUNT                                           1561 04983000
*   DO WHILE COUNT=ZERO;            /* DO UNTIL FLAG IS ON           */ 04984000
         B     @DE01562                                            1562 04985000
@DL01562 DS    0H                                                  1563 04986000
*     SRBID=SRBIDNT;                /* PUT IN IDENT                  */ 04987000
         MVC   SRBID(4,SRBPTR),@CC02493                            1563 04988000
*     SRBASCB=ASCBPTR;              /* MASTER'S ASCB                 */ 04989000
         L     @08,ASCBPTR                                         1564 04990000
         ST    @08,SRBASCB(,SRBPTR)                                1564 04991000
*     SRBPRIOR=NONQ;                /* NON- QUIESCABLE PRIORITY      */ 04992000
         MVI   SRBPRIOR(SRBPTR),X'04'                              1565 04993000
*     SRBPASID=ASCBASID;            /* MASTER'S ASID                 */ 04994000
         LH    @08,ASCBASID(,@08)                                  1566 04995000
         N     @08,@CF02910                                        1566 04996000
         STH   @08,SRBPASID(,SRBPTR)                               1566 04997000
*     SRBRMTR=ASMPSRMT;             /* ADDR OF RMTR TO GET CONTROL   */ 04998000
         L     @08,CVTPTR                                          1567 04999000
         L     @08,ASMVTPTR(,@08)                                  1567 05000000
         L     @06,ASMPSRMT(,@08)                                  1567 05001000
         ST    @06,SRBRMTR(,SRBPTR)                                1567 05002000
*     IF SRBPTR=SARSRBP THEN                                       1568 05003000
         L     @06,SARTPTR                                         1568 05004000
         C     SRBPTR,SARSRBP(,@06)                                1568 05005000
         BNE   @RF01568                                            1568 05006000
*       DO;                         /* SWAP DRIVER'S SRB?            */ 05007000
*         SRBEP=ASMPSWPD;           /* ENTRY POINT IS SWAP DRIVER    */ 05008000
         L     @08,ASMPSWPD(,@08)                                  1570 05009000
         ST    @08,SRBEP(,SRBPTR)                                  1570 05010000
*         COUNT=ONE;                /* COMPLETION FLAG ON            */ 05011000
         MVC   COUNT(2),@CH00059                                   1571 05012000
*       END;                        /* SWAP DRIVER'S SRB             */ 05013000
*     ELSE                                                         1573 05014000
*       DO;                         /* ILRPTM00'S SRB                */ 05015000
         B     @RC01568                                            1573 05016000
@RF01568 DS    0H                                                  1574 05017000
*         SRBEP=ASMPTM;             /* ENTRY POINT IS ILRPTM         */ 05018000
         L     @08,CVTPTR                                          1574 05019000
         L     @08,ASMVTPTR(,@08)                                  1574 05020000
         L     @08,ASMPTM(,@08)                                    1574 05021000
         ST    @08,SRBEP(,SRBPTR)                                  1574 05022000
*         SRBPTR=SARSRBP;           /* POINT TO SWAP DRIVER SRB      */ 05023000
         L     @08,SARTPTR                                         1575 05024000
         L     SRBPTR,SARSRBP(,@08)                                1575 05025000
*       END;                        /* ILRPTM00'S SRB                */ 05026000
*   END;                            /* DO UNTIL FLAG IS ON           */ 05027000
*                                                                  1577 05028000
@RC01568 DS    0H                                                  1577 05029000
@DE01562 LH    @08,COUNT                                           1577 05030000
         LTR   @08,@08                                             1577 05031000
         BZ    @DL01562                                            1577 05032000
*   /*****************************************************************/ 05033000
*   /*                                                               */ 05034000
*   /* INITIALIZE LGVT                                               */ 05035000
*   /*                                                               */ 05036000
*   /*****************************************************************/ 05037000
*                                                                  1578 05038000
*   LGVIDENT=LGVTID;                /* INITIALIZE LGVT (ID)          */ 05039000
         MVC   LGVIDENT(4,LGVTPTR),@CC02491                        1578 05040000
*   LGVLGVEP=ADDR(LGVENTRS)+LENGTH(LGVTE);/* VIO CANNOT HANDLE A LGID   05041000
*                                      OF ZERO --FIRST LGVTE         */ 05042000
         LA    @08,LGVENTRS(,LGVTPTR)                              1579 05043000
         AL    @08,@CF00056                                        1579 05044000
         ST    @08,LGVLGVEP(,LGVTPTR)                              1579 05045000
*   LGVMAXLG=ENTLGVT-ONE;           /* HIGHEST LGN (ZERO ORIGIN)     */ 05046000
         MVC   LGVMAXLG(4,LGVTPTR),@CF02512                        1580 05047000
*   LGVSIZE=LNGLGVT;                /* SIZE OF LGVT                  */ 05048000
         MVC   LGVSIZE(4,LGVTPTR),@CF02514                         1581 05049000
*   COUNT=ONE;                      /* LGN STARTS AT ZERO            */ 05050000
         MVC   COUNT(2),@CH00059                                   1582 05051000
*   LGVTEPTR=LGVLGVEP;              /* POINT TO FIRST ENTRY TO USE   */ 05052000
         LR    LGVTEPTR,@08                                        1583 05053000
*   DO WHILE COUNT<=LGVMAXLG;       /* DO ALL ENTRIES                */ 05054000
         B     @DE01584                                            1584 05055000
@DL01584 DS    0H                                                  1585 05056000
*     LGVENEXT=LGVTEPTR+LENGTH(LGVTE);/* CHAIN ENTRY TO NEXT         */ 05057000
         LA    @08,8                                               1585 05058000
         ALR   @08,LGVTEPTR                                        1585 05059000
         ST    @08,LGVENEXT(,LGVTEPTR)                             1585 05060000
*     LGVELGID=COUNT;               /* PUT IN LGN                    */ 05061000
         LH    @15,COUNT                                           1586 05062000
         ST    @15,LGVELGID(,LGVTEPTR)                             1586 05063000
*     LGVTEPTR=LGVENEXT;            /* NEXT ENTRY                    */ 05064000
         LR    LGVTEPTR,@08                                        1587 05065000
*     COUNT=COUNT+ONE;              /* NEXT LGN                      */ 05066000
         LA    @15,1(,@15)                                         1588 05067000
         STH   @15,COUNT                                           1588 05068000
*   END;                            /* DO ALL ENTRIES                */ 05069000
@DE01584 LH    @08,COUNT                                           1589 05070000
         C     @08,LGVMAXLG(,LGVTPTR)                              1589 05071000
         BNH   @DL01584                                            1589 05072000
*   LGVTEPTR=LGVTEPTR-LENGTH(LGVTE);/* BACK TO LAST ONE BUILT        */ 05073000
         LA    @08,8                                               1590 05074000
         SLR   LGVTEPTR,@08                                        1590 05075000
*   LGVENEXT=''B;                   /* CHAIN OF LAST ENTRY IS ZERO   */ 05076000
         SLR   @06,@06                                             1591 05077000
         ST    @06,LGVENEXT(,LGVTEPTR)                             1591 05078000
*                                                                  1592 05079000
*/********************************************************************/ 05080000
*/*                                                                  */ 05081000
*/* MSGBUF: SEGMENT TO INITIALIZE ASM MESSAGE BUFFER                 */ 05082000
*/*                                                                  */ 05083000
*/* INPUT: PLHPTR POINTER FROM LGVTSRB SEGMENT                       */ 05084000
*/*                                                                  */ 05085000
*/* PROCESS: MOVE PLHPTR DISTANCE OF MESSAGE BUFFER                  */ 05086000
*/*          INITIALIZE AND CHAIN BUFFER TO ASMVT                    */ 05087000
*/*                                                                  */ 05088000
*/* OUTPUT: INITIALIZED BUFFER                                       */ 05089000
*/*         PLHPTR POINTS TO NEXT AVAILABLE AREA                     */ 05090000
*/*                                                                  */ 05091000
*/********************************************************************/ 05092000
*/*MSGBUF: CHART                                                     */ 05093000
*/*HEADER                                                          1592 05094000
*/*  MSGBUF SEGMENT                                                1592 05095000
*/*MSGBUF: E ENTRY TO INITIALIZE BUFFER                              */ 05096000
*/*        P SET PLHPTR ON DOUBLEWORD BOUNDARY                       */ 05097000
*/*        P INIT THE POINTS IN MSGBUF HEADER                        */ 05098000
*/*        N BUFFERS ARE ZERO (AREA ZEROED)                          */ 05099000
*/*        R FLOW CONTINUES AT BLDCELLS                              */ 05100000
*/*MSGBUF: END                                                       */ 05101000
*                                                                  1592 05102000
*   PLHPTR=((PLHPTR+SEVEN)/EIGHT)*EIGHT;/* DOUBLEWORD BOUNDARY       */ 05103000
         LA    @02,7                                               1592 05104000
         AL    @02,PLHPTR                                          1592 05105000
         SRDA  @02,32                                              1592 05106000
         DR    @02,@08                                             1592 05107000
         SLA   @03,3                                               1592 05108000
         ST    @03,PLHPTR                                          1592 05109000
*   ASMMSGBF=PLHPTR;                /* WHERE MSGBUFFER BEGINS        */ 05110000
         L     @08,CVTPTR                                          1593 05111000
         L     @08,ASMVTPTR(,@08)                                  1593 05112000
         ST    @03,ASMMSGBF(,@08)                                  1593 05113000
*   MSGCURR=ADDR(MSGBFRS);          /* POINT TO FIRST BUFFER         */ 05114000
         LA    @06,MSGBFRS(,@03)                                   1594 05115000
         ST    @06,MSGCURR(,@03)                                   1594 05116000
*   MSGFIRST=MSGCURR;               /* CURRENT SET TO FIRST          */ 05117000
         ST    @06,MSGFIRST(,@03)                                  1595 05118000
*   MSGLAST=ADDR(MSGBFRS(DIM(MSGBFRS)));/* POINT TO LAST BUFFER      */ 05119000
         LA    @06,MSGBFRS+160(,@03)                               1596 05120000
         ST    @06,MSGLAST(,@03)                                   1596 05121000
*   MSGTERM=ADDR(MSGTBFR);          /* POINT TO TERMINATION BUFFER   */ 05122000
         LA    @06,MSGTBFR(,@03)                                   1597 05123000
         ST    @06,MSGTERM(,@03)                                   1597 05124000
*   PLHPTR=PLHPTR+LENGTH(MSGBUFER); /* NEXT AVAILABLE AREA           */ 05125000
         AL    @03,@CF02432                                        1598 05126000
         ST    @03,PLHPTR                                          1598 05127000
*                                                                  1599 05128000
*/********************************************************************/ 05129000
*/*                                                                  */ 05130000
*/* BLDCELLS: SEGMENT TO BUILD CELLPOOLS AND UPDATE ILRASMVT         */ 05131000
*/*                                                                  */ 05132000
*/* INPUT: DECLARES WITH FACTS ABOUT CELLS                           */ 05133000
*/*        ILRASMVT (CELLPOOL AREAS)                                 */ 05134000
*/*        PLHPTR POINT TO AREA TO BUILD CELLPOOLS                   */ 05135000
*/*                                                                  */ 05136000
*/* PROCESS: USE SAME CODE TO BUILD THREE CELLPOOLS (IOE, BWK,       */ 05137000
*/*          AND ACE).       CALCULATE NUMBER OF IOES NEEDED THIS    */ 05138000
*/*          IPL. CALCULATE LENGTH OF CELLPOOL AND USE EITHER ROOM   */ 05139000
*/*          IN REST OF BUFFER AREA AND ILRDSTBL OR DO A GETMAIN FOR */ 05140000
*/*          THE POOL.  INITIALIZE CELLS.  IF ACE POOL, INITIALIZE   */ 05141000
*/*          RESERVE CELLS AND COMPLETE ASMVT.                       */ 05142000
*/*                                                                  */ 05143000
*/* OUTPUT: ASMVT CELL AREAS INITIALIZED WITH INFORMATION AND POINTER*/ 05144000
*/*            TO FIRST CELL FOR CELLPOOL                            */ 05145000
*/*         ASMVT ACE CELLPOOL HAVE A POINTER TO THE FIRST RESERVE   */ 05146000
*/*            CELL ALSO                                             */ 05147000
*/*         ALL CELLS INITIALIZED, CORRECT SIZE AND FIRST WORD       */ 05148000
*/*             POINTING TO NEXT CELL IN CELLPOOL                    */ 05149000
*/*                                                                  */ 05150000
*/********************************************************************/ 05151000
*/*BLDCELLS: CHART                                                   */ 05152000
*/*HEADER                                                          1599 05153000
*/*  BLDCELLS SEGMENT                                                */ 05154000
*/*BLDCELLS: E ENTRY TO BUILD CELLPOOLS                              */ 05155000
*/*          P CALCULATE NUMBER OF IOES (CELLNUM)                    */ 05156000
*/*          P POINT TO REST OF BUFFER AND DSTBL                     */ 05157000
*/*          P START WITH LAST CELLPOOL                              */ 05158000
*/*%A4:      P CALCULATE CELLPOOL LENGTH                             */ 05159000
*/*          D (NO,,YES,%A1) ROOM IN BUFFER?                         */ 05160000
*/*          P UNCONDITIONAL GETMAIN FOR POOL                        */ 05161000
*/*          P CLEAR AREA                                            */ 05162000
*/*%A1:      P FILL IN 8 BYTE HEADER OF CELLPOOL                     */ 05163000
*/*          P POINT TO FIRST CELL IN CELLPOOL                       */ 05164000
*/*          P POINT TO CORRECT CELLPOOL IN ASMVT                    */ 05165000
*/*          P FILL IN ASMVT                                         */ 05166000
*/*          P SET CELL COUNT TO ZERO                                */ 05167000
*/*%A2:      D (NO,,YES,%A3) COMPLETED CELLS?                        */ 05168000
*/*          P POINTER TO NEXT CELL IN THIS CELL                     */ 05169000
*/*          P SAVE POINTER TO THIS CELL                             */ 05170000
*/*          P NEXT CELL                                             */ 05171000
*/*          P (,%A2) INCREMENT CELL COUNT                           */ 05172000
*/*%A3:      P LAST CELL POINTS TO ZERO                              */ 05173000
*/*          D (YES,,NO,%A8) RESERVE CELLS?                          */ 05174000
*/*          P FILL IN ASMVT FOR RESERVE CELLS                       */ 05175000
*/*          P SET CELL COUNT TO ZERO                                */ 05176000
*/*%A5:      D (YES,,NO,%A6) COMPLETED RESERVE CELLS?                */ 05177000
*/*          P POINT TO NEXT CELL IN THIS CELL                       */ 05178000
*/*          P SAVE POINTER TO THIS CELL                             */ 05179000
*/*          P NEXT CELL                                             */ 05180000
*/*          P (,%A5) INCREMENT CELL COUNT                           */ 05181000
*/*%A6:      P LAST CELL POINTS TO ZERO                              */ 05182000
*/*%A8:      P DECREMENT CELLPOOL COUNT                              */ 05183000
*/*          D (NO,,YES,%A4) MORE CELLPOOLS?                         */ 05184000
*/*          D (YES,,NO,%A7) MORE ROOM IN BUFFER,DSTBL?              */ 05185000
*/*          P FREE THE EXTRA AREA                                   */ 05186000
*/*%A7:      R FLOW CONTINUES AT LISTMSG                             */ 05187000
*/*BLDCELLS: END                                                     */ 05188000
*                                                                  1599 05189000
*                                                                  1599 05190000
*   /*****************************************************************/ 05191000
*   /*                                                               */ 05192000
*   /* CALCULATE NUMBER OF IOE'S IN IOE POOL                         */ 05193000
*   /*                                                               */ 05194000
*   /*****************************************************************/ 05195000
*                                                                  1599 05196000
*   CELLNUM(1)=(ASMPCCWN*IOEMPYN)/IOEMPYD;/* NUMBER OF IOE'S         */ 05197000
*                                                                  1599 05198000
         SLR   @03,@03                                             1599 05199000
         IC    @03,IOEMPYN                                         1599 05200000
         M     @02,ASMPCCWN(,@08)                                  1599 05201000
         SLR   @06,@06                                             1599 05202000
         IC    @06,IOEMPYD                                         1599 05203000
         DR    @02,@06                                             1599 05204000
         ST    @03,CELLNUM                                         1599 05205000
*   /*****************************************************************/ 05206000
*   /*                                                               */ 05207000
*   /* BUILD CELLPOOLS FROM BUFFER AND DSTBL                         */ 05208000
*   /*                                                               */ 05209000
*   /*****************************************************************/ 05210000
*                                                                  1600 05211000
*   ENDPTR=DSTBLPTR+LENGTH(DSTBL);  /* END OF BUFFER AREA            */ 05212000
         L     ENDPTR,@CF02516                                     1600 05213000
         AL    ENDPTR,DSTBLPTR                                     1600 05214000
*   POOLADDR(1)=ADDR(ASMIOEPC);     /* FIRST POOL ADDRESS            */ 05215000
         LA    @06,ASMIOEPC(,@08)                                  1601 05216000
         ST    @06,POOLADDR                                        1601 05217000
*   POOLADDR(2)=ADDR(ASMBWKPC);     /* SECOND POOL ADDRESS IN ASMVT  */ 05218000
         LA    @06,ASMBWKPC(,@08)                                  1602 05219000
         ST    @06,POOLADDR+4                                      1602 05220000
*   POOLADDR(3)=ADDR(ASMACEPC);     /* FOURTH POOL ADDRESS IN ASMVT  */ 05221000
         LA    @08,ASMACEPC(,@08)                                  1603 05222000
         ST    @08,POOLADDR+8                                      1603 05223000
*   DO J=DIM(CELLTYP) TO 1 BY-1;    /* ALL CELL POOLS                */ 05224000
         LA    J,3                                                 1604 05225000
@DL01604 DS    0H                                                  1605 05226000
*     LEN=LENGTH(CELLTYP)+(POOLADDR(J)->ASMCPSIZ)*(CELLNUM(J)+CELLRESV( 05227000
*         J));                      /* LENGTH OF CELL POOL           */ 05228000
         LR    @08,J                                               1605 05229000
         SLA   @08,2                                               1605 05230000
         L     @06,POOLADDR-4(@08)                                 1605 05231000
         L     @03,CELLNUM-4(@08)                                  1605 05232000
         AL    @03,CELLRESV-4(@08)                                 1605 05233000
         MH    @03,ASMCPSIZ(,@06)                                  1605 05234000
         AL    @03,@CF00056                                        1605 05235000
         ST    @03,LEN                                             1605 05236000
*     IF PLHPTR+LEN>ENDPTR THEN                                    1606 05237000
         L     @08,PLHPTR                                          1606 05238000
         ALR   @08,@03                                             1606 05239000
         CR    @08,ENDPTR                                          1606 05240000
         BNH   @RF01606                                            1606 05241000
*       DO;                         /* NOT FIT IN BUFFER,DSTBL?      */ 05242000
*         DO;                       /* GETMAIN (RU) LV(LEN)        1608 05243000
*                                      SP(SQASPID)                   */ 05244000
*           RESPECIFY                                              1609 05245000
*            (GPR01F,                                              1609 05246000
*             GPR15F,                                              1609 05247000
*             GPR00F) RESTRICTED;                                  1609 05248000
*           GPR01F=0;               /* REG 1 MUST BE ZERO            */ 05249000
         SLR   GPR01F,GPR01F                                       1610 05250000
*           GPR15F=2;               /* RU-TYPE GETMAIN               */ 05251000
         LA    GPR15F,2                                            1611 05252000
*           GPR00F=LEN;             /* LENGTH REQUESTED              */ 05253000
         LR    GPR00F,@03                                          1612 05254000
*           GPR15F=GPR15F|((SQASPID)*256);/* SP IN BYTE 2            */ 05255000
         O     GPR15F,@CF02881                                     1613 05256000
*           SVC(120);               /* RC/RU-FORM OF GETMAIN         */ 05257000
         SVC   120                                                 1614 05258000
*           RESPECIFY                                              1615 05259000
*            (GPR01F,                                              1615 05260000
*             GPR15F,                                              1615 05261000
*             GPR00F) UNRESTRICTED;                                1615 05262000
*         END;                      /* GETMAIN (RU) LV(LEN)        1616 05263000
*                                      SP(SQASPID) GET SQA SPACE FOR    05264000
*                                      IT                            */ 05265000
*         SAVEADDR=R1;              /* SAVE ADDRESS OF AREA          */ 05266000
         LR    SAVEADDR,R1                                         1617 05267000
*         RFY                                                      1618 05268000
*          (R0,                                                    1618 05269000
*           R14,                                                   1618 05270000
*           R15) RSTD;                                             1618 05271000
*         R0=SAVEADDR;              /* WHERE TO START ZEROING        */ 05272000
         LR    R0,SAVEADDR                                         1619 05273000
*         R1=LEN;                   /* HOW MUCH TO ZERO              */ 05274000
         L     R1,LEN                                              1620 05275000
*         R15=ZERO;                 /* PADDING CHARACTER             */ 05276000
         SLR   R15,R15                                             1621 05277000
*         MVCL(R0,R14);             /* ZERO IT                       */ 05278000
         MVCL  R0,R14                                              1622 05279000
*         RFY                                                      1623 05280000
*          (R0,                                                    1623 05281000
*           R14,                                                   1623 05282000
*           R15) UNRSTD;                                           1623 05283000
*         R1=SAVEADDR;              /* PUT ADDRESS IN REGISTER ONE   */ 05284000
         LR    R1,SAVEADDR                                         1624 05285000
*       END;                        /* NOT FIT IN BUFFER,DSTBL       */ 05286000
*     ELSE                                                         1626 05287000
*       DO;                         /* USE BUFFER,DSTBL              */ 05288000
         B     @RC01606                                            1626 05289000
@RF01606 DS    0H                                                  1627 05290000
*         R1=PLHPTR;                /* PUT ADDRESS IN REGISTER ONE   */ 05291000
         L     @08,PLHPTR                                          1627 05292000
         LR    R1,@08                                              1627 05293000
*         PLHPTR=PLHPTR+LEN;        /* MOVE AVAILABLE AREA POINT     */ 05294000
         AL    @08,LEN                                             1628 05295000
         ST    @08,PLHPTR                                          1628 05296000
*       END;                        /* USE BUFFER,DSTBL              */ 05297000
*     R1->AREA(1:LENGTH(CELLTYP))=CELLTYP(J);/* PUT IN HEADER        */ 05298000
@RC01606 LR    @08,J                                               1630 05299000
         SLA   @08,3                                               1630 05300000
         LA    @06,CELLTYP-8(@08)                                  1630 05301000
         MVC   AREA(8,R1),0(@06)                                   1630 05302000
*     CELLPTR=R1+LENGTH(CELLTYP);   /* 1ST CELL JUST BEYOND HEADER   */ 05303000
         LA    CELLPTR,8                                           1631 05304000
         ALR   CELLPTR,R1                                          1631 05305000
*     POOLPTR=POOLADDR(J);          /* POINT TO POOL IN ASMVT        */ 05306000
         LR    @08,J                                               1632 05307000
         SLA   @08,2                                               1632 05308000
         L     POOLPTR,POOLADDR-4(@08)                             1632 05309000
*     ASMCPAVL=CELLPTR;             /* FIRST AVAILABLE CELL          */ 05310000
         ST    CELLPTR,ASMCPAVL(,POOLPTR)                          1633 05311000
*     DO K=1 TO CELLNUM(J);         /* DO ALL CELLS IN THIS POOL     */ 05312000
         LA    K,1                                                 1634 05313000
         B     @DE01634                                            1634 05314000
@DL01634 DS    0H                                                  1635 05315000
*       CELLNXT=CELLPTR+ASMCPSIZ;   /* CHAIN TO NEXT CELL            */ 05316000
         LR    @08,CELLPTR                                         1635 05317000
         AH    @08,ASMCPSIZ(,POOLPTR)                              1635 05318000
         ST    @08,CELLNXT(,CELLPTR)                               1635 05319000
*       LSTPTR=CELLPTR;             /* SAVE ADDRESS OF THIS CELL     */ 05320000
         ST    CELLPTR,LSTPTR                                      1636 05321000
*       CELLPTR=CELLNXT;            /* NEXT CELL                     */ 05322000
         LR    CELLPTR,@08                                         1637 05323000
*     END;                          /* DO ALL CELLS IN THIS POOL     */ 05324000
         AL    K,@CF00059                                          1638 05325000
@DE01634 LR    @08,J                                               1638 05326000
         SLA   @08,2                                               1638 05327000
         C     K,CELLNUM-4(@08)                                    1638 05328000
         BNH   @DL01634                                            1638 05329000
*     LSTPTR->CELLNXT=''B;          /* END CHAIN OF CELLS THIS POOL  */ 05330000
         SLR   @08,@08                                             1639 05331000
         L     @06,LSTPTR                                          1639 05332000
         ST    @08,CELLNXT(,@06)                                   1639 05333000
*     IF CELLRESV(J)^=0 THEN                                       1640 05334000
         LR    @08,J                                               1640 05335000
         SLA   @08,2                                               1640 05336000
         L     @08,CELLRESV-4(@08)                                 1640 05337000
         LTR   @08,@08                                             1640 05338000
         BZ    @RF01640                                            1640 05339000
*       DO;                         /* RESERVE CELLS?                */ 05340000
*                                                                  1641 05341000
*         /***********************************************************/ 05342000
*         /*                                                         */ 05343000
*         /* CELLPOOL HAS RESERVE CELLS                              */ 05344000
*         /*                                                         */ 05345000
*         /***********************************************************/ 05346000
*                                                                  1642 05347000
*         ASMCPRES=CELLPTR;         /* 1ST AVAILABLE RESERVE CELL    */ 05348000
         ST    CELLPTR,ASMCPRES(,POOLPTR)                          1642 05349000
*         DO K=1 TO CELLRESV(J);    /* DO ALL RESERVE CELLS          */ 05350000
         LA    K,1                                                 1643 05351000
         B     @DE01643                                            1643 05352000
@DL01643 DS    0H                                                  1644 05353000
*           CELLNXT=CELLPTR+ASMCPSIZ;/* CHAIN TO NEXT CELL           */ 05354000
         LR    @08,CELLPTR                                         1644 05355000
         AH    @08,ASMCPSIZ(,POOLPTR)                              1644 05356000
         ST    @08,CELLNXT(,CELLPTR)                               1644 05357000
*           LSTPTR=CELLPTR;         /* SAVE THIS CELL ADDRESS        */ 05358000
         ST    CELLPTR,LSTPTR                                      1645 05359000
*           CELLPTR=CELLNXT;        /* NEXT CELL                     */ 05360000
         LR    CELLPTR,@08                                         1646 05361000
*         END;                      /* DO ALL CELLS                  */ 05362000
         AL    K,@CF00059                                          1647 05363000
@DE01643 LR    @08,J                                               1647 05364000
         SLA   @08,2                                               1647 05365000
         C     K,CELLRESV-4(@08)                                   1647 05366000
         BNH   @DL01643                                            1647 05367000
*         LSTPTR->CELLNXT=''B;      /* END CHAIN                     */ 05368000
         SLR   @08,@08                                             1648 05369000
         L     @06,LSTPTR                                          1648 05370000
         ST    @08,CELLNXT(,@06)                                   1648 05371000
*       END;                        /* RESERVE CELLS                 */ 05372000
*     ELSE                                                         1650 05373000
*       ;                           /* NO RESERVE CELLS              */ 05374000
@RF01640 DS    0H                                                  1651 05375000
*   END;                            /* ALL CELL POOLS                */ 05376000
         BCTR  J,0                                                 1651 05377000
         LTR   J,J                                                 1651 05378000
         BP    @DL01604                                            1651 05379000
*   IF ENDPTR>PLHPTR THEN                                          1652 05380000
         L     @08,PLHPTR                                          1652 05381000
         CR    ENDPTR,@08                                          1652 05382000
         BNH   @RF01652                                            1652 05383000
*     DO;                           /* NOT USE ALL OF BUFFER,DSTBL?  */ 05384000
*       FREEPTR=((PLHPTR+7)/8)*8;   /* WHERE TO START FREEING        */ 05385000
         LA    FREEPTR,7                                           1654 05386000
         ALR   FREEPTR,@08                                         1654 05387000
         SRDA  FREEPTR,32                                          1654 05388000
         D     FREEPTR,@CF00056                                    1654 05389000
         SLA   @03,3                                               1654 05390000
         LR    FREEPTR,@03                                         1654 05391000
*       DO;                         /* FREEMAIN(RU)                1655 05392000
*                                      LV(ENDPTR-PLHPTR)A(FREEAREA)     05393000
*                                      SP(SQASPID)                   */ 05394000
*         RESPECIFY                                                1656 05395000
*          (GPR01F,                                                1656 05396000
*           GPR15F,                                                1656 05397000
*           GPR00F) RESTRICTED;                                    1656 05398000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 05399000
         SLR   GPR01F,GPR01F                                       1657 05400000
*         GPR15F=3;                 /* SET TYPE                      */ 05401000
         LA    GPR15F,3                                            1658 05402000
*         GPR00F=ENDPTR-PLHPTR;     /* LENGTH REQUESTED              */ 05403000
         LCR   @08,@08                                             1659 05404000
         ALR   @08,ENDPTR                                          1659 05405000
         LR    GPR00F,@08                                          1659 05406000
*         GPR01F=ADDR(FREEAREA);    /* SET REGISTER ONE              */ 05407000
         LR    GPR01F,FREEPTR                                      1660 05408000
*         GPR15F=GPR15F+((SQASPID)*256);/* SUBPOOL VALUE             */ 05409000
         AL    GPR15F,@CF02881                                     1661 05410000
*         SVC(120);                 /* RC/RU-FORM OF GETMAIN         */ 05411000
         SVC   120                                                 1662 05412000
*         RESPECIFY                                                1663 05413000
*          (GPR01F,                                                1663 05414000
*           GPR15F,                                                1663 05415000
*           GPR00F) UNRESTRICTED;                                  1663 05416000
*       END;                        /* FREEMAIN(RU)                1664 05417000
*                                      LV(ENDPTR-PLHPTR)A(FREEAREA)     05418000
*                                      SP(SQASPID)                   */ 05419000
*     END;                          /* NOT USE ALL OF BUFFER,DSTBL   */ 05420000
*   ELSE                                                           1666 05421000
*     ;                             /* USED ALL OF BUFFER,DSTBL      */ 05422000
@RF01652 DS    0H                                                  1667 05423000
*                                                                  1667 05424000
*/********************************************************************/ 05425000
*/*                                                                  */ 05426000
*/* LISTMSG: SEGMENT TO ISSUE LIST OF PAGING DATA SETS, IF REQUESTED */ 05427000
*/*                                                                  */ 05428000
*/* INPUT: ILRTPARB                                                  */ 05429000
*/*        LIST INDICATOR USED IN PARSE SUBROUTINE                   */ 05430000
*/*                                                                  */ 05431000
*/* PROCESS: IF LIST INDICATOR ON, THEN ILRIMMSG IS PASSED ADDRESS   */ 05432000
*/*          OF ILRTPARB TO PUT OUT A MESSAGE CONTAINING ALL PAGING  */ 05433000
*/*          DATA SETS BEING USED THIS IPL.                          */ 05434000
*/*                                                                  */ 05435000
*/* OUTPUT: NOTHING   OR MESSAGE                                     */ 05436000
*/*                                                                  */ 05437000
*/********************************************************************/ 05438000
*/*LISTMSG: CHART                                                    */ 05439000
*/*HEADER                                                          1667 05440000
*/*  LISTMSG SEGMENT                                                 */ 05441000
*/*LISTMSG: E ENTRY TO LIST PAGE DATA SETS                           */ 05442000
*/*         D (YES,,NO,%A1) LIST SWITCH ON?                          */ 05443000
*/*         S ILRIMMSG: 'LIST PAGE DATA SETS' MESSAGE                */ 05444000
*/*%A1:     R RETURN TO IEAVNIPM                                     */ 05445000
*/*LISTMSG: END                                                      */ 05446000
*                                                                  1667 05447000
*   IF LIST=ON THEN                                                1667 05448000
         TM    LIST,B'01000000'                                    1667 05449000
         BNO   @RF01667                                            1667 05450000
*     DO;                           /* LIST PAGE DATA SET NAMES?     */ 05451000
*       MSGID=M940I;                /* LISTING MESSAGE               */ 05452000
         MVC   MSGID(4),@CC02575                                   1669 05453000
*       MSGDATA1=TPARPTR;           /* POINTER TO ILRTPARB           */ 05454000
         L     @08,TPARPTR                                         1670 05455000
         ST    @08,MSGDATA1                                        1670 05456000
*       R1=ADDR(MSGPL);             /* PARM TO ILRIMMSG              */ 05457000
         LA    R1,MSGPL                                            1671 05458000
*       CALL ILRIMMSG;              /* MESSAGE MODULE                */ 05459000
         L     @15,@CV02592                                        1672 05460000
         BALR  @14,@15                                             1672 05461000
*     END;                          /* LIST PAGE DATA SET NAMES      */ 05462000
*   ELSE                                                           1674 05463000
*     ;                             /* NO LISTING                    */ 05464000
@RF01667 DS    0H                                                  1675 05465000
*   RETURN;                         /* RETURN TO IEAVNIPM            */ 05466000
@EL00001 L     @13,4(,@13)                                         1675 05467000
@EF00001 DS    0H                                                  1675 05468000
@ER00001 LM    @14,@12,12(@13)                                     1675 05469000
         BR    @14                                                 1675 05470000
*                                                                  1676 05471000
*/********************************************************************/ 05472000
*/*                                                                  */ 05473000
*/* GGETMAIN: SUBROUTINE TO ISSUE UNCONDITIONAL GETMAIN FOR SQA      */ 05474000
*/*           ON 4K BOUNDARY                                         */ 05475000
*/*                                                                  */ 05476000
*/* INPUT: LENGTH OF AREA REQUIRED IN REGISTER 0                     */ 05477000
*/*                                                                  */ 05478000
*/* PROCESS: GETMAIN SVC(120) INVOKED VIA MACRO.                     */ 05479000
*/*          IF SUCCESSFUL, CONTROL IS RETURNED.                     */ 05480000
*/*                                                                  */ 05481000
*/* OUTPUT: ADDRESS OF GOTTEN STORAGE IN REGISTER 1.                 */ 05482000
*/*                                                                  */ 05483000
*/********************************************************************/ 05484000
*/*GGETMAIN: CHART                                                   */ 05485000
*/*HEADER                                                          1676 05486000
*/*  ILRASRIM                                                      1676 05487000
*/* GGETMAIN: GET SQA STORAGE ON 4K BOUNDARY                         */ 05488000
*/*GGETMAIN: E ENTRY TO GET SQA STORAGE                              */ 05489000
*/*          P SAVE ORIGINAL REQUEST                                 */ 05490000
*/*          P MODIFY ORIGINAL REQUEST                               */ 05491000
*/*          L ISSUE UNCONDITIONAL GETMAIN FOR SQA STORAGE           */ 05492000
*/*          P MODIFY ADDRESS UP TO 4K BOUNDARY                      */ 05493000
*/*          P CALCULATE FRONT PORTION OF GOTTEN STORAGE             */ 05494000
*/*          L FREEMAIN FRONT PORTION                                */ 05495000
*/*          P CALCULATE BACK PORTION OF GOTTEN STORAGE              */ 05496000
*/*          L FREEMAIN BACK PORTION                                 */ 05497000
*/*          P PUT BDY ALIGNED ADDRESS IN REGISTER ONE               */ 05498000
*/*          R RETURN                                                */ 05499000
*/*GGETMAIN: END                                                     */ 05500000
*                                                                  1676 05501000
*GGETMAIN:                                                         1676 05502000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1676 05503000
GGETMAIN DS    0H                                                  1677 05504000
*   RFY                                                            1677 05505000
*     R14 RSTD;                                                    1677 05506000
*   SAVER14A=R14;                   /* SAVE RETURN ADDRESS           */ 05507000
         ST    R14,SAVER14A                                        1678 05508000
*   RFY                                                            1679 05509000
*     R0 RSTD;                                                     1679 05510000
*   RFY                                                            1680 05511000
*     R14 UNRSTD;                                                  1680 05512000
*   ORIGREQ=R0;                     /* SAVE ORIGINAL REQUEST         */ 05513000
         ST    R0,ORIGREQ                                          1681 05514000
*   MDFDREQ=ORIGREQ+FOURK;          /* MODIFIED REQUEST              */ 05515000
         L     @08,ORIGREQ                                         1682 05516000
         AL    @08,@CF02516                                        1682 05517000
         ST    @08,MDFDREQ                                         1682 05518000
*   R0=MDFDREQ;                     /* LENGTH TO GETMAIN             */ 05519000
         LR    R0,@08                                              1683 05520000
*   DO;                             /* GETMAIN (RU) LV(R0)         1684 05521000
*                                      SP(SQASPID)                   */ 05522000
*     RESPECIFY                                                    1685 05523000
*      (GPR01F,                                                    1685 05524000
*       GPR15F,                                                    1685 05525000
*       GPR00F) RESTRICTED;                                        1685 05526000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 05527000
         SLR   GPR01F,GPR01F                                       1686 05528000
*     GPR15F=2;                     /* RU-TYPE GETMAIN               */ 05529000
         LA    GPR15F,2                                            1687 05530000
*     GPR00F=R0;                    /* LENGTH REQUESTED              */ 05531000
*     GPR15F=GPR15F|((SQASPID)*256);/* SP IN BYTE 2                  */ 05532000
         O     GPR15F,@CF02881                                     1689 05533000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 05534000
         SVC   120                                                 1690 05535000
*     RESPECIFY                                                    1691 05536000
*      (GPR01F,                                                    1691 05537000
*       GPR15F,                                                    1691 05538000
*       GPR00F) UNRESTRICTED;                                      1691 05539000
*   END;                            /* GETMAIN (RU) LV(R0)         1692 05540000
*                                      SP(SQASPID)                   */ 05541000
*   SAVEADDR=R1;                    /* SAVE GETMAINED ADDRESS        */ 05542000
         LR    SAVEADDR,R1                                         1693 05543000
*   SRL(R1,12);                     /* RID OF THE RELATIVE BYTE IN 1694 05544000
*                                      PAGE                          */ 05545000
         SRL   R1,12                                               1694 05546000
*   SLL(R1,12);                     /* MOVE BACK TO ORIGINAL PLACE   */ 05547000
         SLL   R1,12                                               1695 05548000
*   IF SAVEADDR=R1 THEN                                            1696 05549000
         CR    SAVEADDR,R1                                         1696 05550000
         BNE   @RF01696                                            1696 05551000
*     BDYADDR=SAVEADDR;             /* SAVEADDR WAS PAGE BDY?        */ 05552000
         LR    BDYADDR,SAVEADDR                                    1697 05553000
*   ELSE                                                           1698 05554000
*     DO;                           /* SAVEADDR WAS NOT PAGE BDY     */ 05555000
         B     @RC01696                                            1698 05556000
@RF01696 DS    0H                                                  1699 05557000
*       BDYADDR=R1+FOURK;           /* SAVE PAGE BDY WITHIN AREA     */ 05558000
         LR    BDYADDR,R1                                          1699 05559000
         AL    BDYADDR,@CF02516                                    1699 05560000
*       FREEPTR=SAVEADDR;           /* WHERE TO START FREEING        */ 05561000
         LR    FREEPTR,SAVEADDR                                    1700 05562000
*       DO;                         /* FREEMAIN(RU) LV(BDYADDR-SAVEAD   05563000
*                                      DR)A(FREEAREA) SP(SQASPID)    */ 05564000
*         RESPECIFY                                                1702 05565000
*          (GPR01F,                                                1702 05566000
*           GPR15F,                                                1702 05567000
*           GPR00F) RESTRICTED;                                    1702 05568000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 05569000
         SLR   GPR01F,GPR01F                                       1703 05570000
*         GPR15F=3;                 /* SET TYPE                      */ 05571000
         LA    GPR15F,3                                            1704 05572000
*         GPR00F=BDYADDR-SAVEADDR;  /* LENGTH REQUESTED              */ 05573000
         LR    GPR00F,BDYADDR                                      1705 05574000
         SLR   GPR00F,SAVEADDR                                     1705 05575000
*         GPR01F=ADDR(FREEAREA);    /* SET REGISTER ONE              */ 05576000
         LR    GPR01F,FREEPTR                                      1706 05577000
*         GPR15F=GPR15F+((SQASPID)*256);/* SUBPOOL VALUE             */ 05578000
         AL    GPR15F,@CF02881                                     1707 05579000
*         SVC(120);                 /* RC/RU-FORM OF GETMAIN         */ 05580000
         SVC   120                                                 1708 05581000
*         RESPECIFY                                                1709 05582000
*          (GPR01F,                                                1709 05583000
*           GPR15F,                                                1709 05584000
*           GPR00F) UNRESTRICTED;                                  1709 05585000
*       END;                        /* FREEMAIN(RU) LV(BDYADDR-SAVEAD   05586000
*                                      DR)A(FREEAREA) SP(SQASPID)    */ 05587000
*     END;                          /* SAVEADDR WAS NOT PAGE BDY     */ 05588000
*   FREEPTR=BDYADDR+ORIGREQ;        /* POINTER TO AREA TO FREE       */ 05589000
@RC01696 LR    FREEPTR,BDYADDR                                     1712 05590000
         AL    FREEPTR,ORIGREQ                                     1712 05591000
*   DO;                             /* FREEMAIN(RU) LV((SAVEADDR+MDFD   05592000
*                                      REQ)-FREEPTR)A(FREEAREA)    1713 05593000
*                                      SP(SQASPID)                   */ 05594000
*     RESPECIFY                                                    1714 05595000
*      (GPR01F,                                                    1714 05596000
*       GPR15F,                                                    1714 05597000
*       GPR00F) RESTRICTED;                                        1714 05598000
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */ 05599000
         SLR   GPR01F,GPR01F                                       1715 05600000
*     GPR15F=3;                     /* SET TYPE                      */ 05601000
         LA    GPR15F,3                                            1716 05602000
*     GPR00F=(SAVEADDR+MDFDREQ)-FREEPTR;/* LENGTH REQUESTED          */ 05603000
         LR    GPR00F,SAVEADDR                                     1717 05604000
         AL    GPR00F,MDFDREQ                                      1717 05605000
         SLR   GPR00F,FREEPTR                                      1717 05606000
*     GPR01F=ADDR(FREEAREA);        /* SET REGISTER ONE              */ 05607000
         LR    GPR01F,FREEPTR                                      1718 05608000
*     GPR15F=GPR15F+((SQASPID)*256);/* SUBPOOL VALUE                 */ 05609000
         AL    GPR15F,@CF02881                                     1719 05610000
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */ 05611000
         SVC   120                                                 1720 05612000
*     RESPECIFY                                                    1721 05613000
*      (GPR01F,                                                    1721 05614000
*       GPR15F,                                                    1721 05615000
*       GPR00F) UNRESTRICTED;                                      1721 05616000
*   END;                            /* FREEMAIN(RU) LV((SAVEADDR+MDFD   05617000
*                                      REQ)-FREEPTR)A(FREEAREA)    1722 05618000
*                                      SP(SQASPID)                   */ 05619000
*   R1=BDYADDR;                     /* AREA POINTER TO RETURN TO   1723 05620000
*                                      CALLER                        */ 05621000
         LR    R1,BDYADDR                                          1723 05622000
*   RFY                                                            1724 05623000
*     R0 UNRSTD;                                                   1724 05624000
*   RFY                                                            1725 05625000
*     R14 RSTD;                                                    1725 05626000
*   R14=SAVER14A;                   /* RESTORE RETURN ADDRESS        */ 05627000
         L     R14,SAVER14A                                        1726 05628000
*   RFY                                                            1727 05629000
*     R14 UNRSTD;                                                  1727 05630000
*   END GGETMAIN;                                                  1728 05631000
@EL00002 DS    0H                                                  1728 05632000
@EF00002 DS    0H                                                  1728 05633000
@ER00002 BR    @14                                                 1728 05634000
*                                                                  1729 05635000
*/********************************************************************/ 05636000
*/*                                                                  */ 05637000
*/* PARSE: SUBROUTINE TO DEAL WITH THE PARMTAB:                      */ 05638000
*/*        PAGE= DATA STRING FROM PARMLIB(IEASYSNN),                 */ 05639000
*/*        PAGE= DATA STRING FROM SYSTEM PARAMETER, AND              */ 05640000
*/*        SWAP= DATA STRING.                                        */ 05641000
*/*                                                                  */ 05642000
*/* INPUT: ADDRESS OF NVT                                            */ 05643000
*/*        ADDRESS OF ILRDSTBL                                       */ 05644000
*/*        INDICATOR TO PROCESS PAGE OR SWAP DATA SETS               */ 05645000
*/*                                                                  */ 05646000
*/* PROCESS: SUBROUTINE IS INVOKED TWICE. ONCE EACH FOR PAGE AND     */ 05647000
*/*          SWAP DATA SETS.  WHENEVER WHAT IS ASSUMED TO BE A DATA  */ 05648000
*/*          SET NAME IS DETECTED, SUBROUTINE NEXDSN IS INVOKED TO   */ 05649000
*/*          PARSE THE NAME.                                         */ 05650000
*/*          NEXDSN RETURNS WITH AN ERROR INDICATION OR WITH THE     */ 05651000
*/*          ADDRESS AND LENGTH OF THE NAME.  CONTROL RETURNS TO     */ 05652000
*/*          PARSE WITH THE STRING POSITION POINTER POINTING TO NEXT */ 05653000
*/*          DATA SET NAME OR A STRING TERMINATING DELIMITER (RIGHT  */ 05654000
*/*          PARENTHSIS OR QUOTE).  OTHERWISE A SYNTAX ERROR IS      */ 05655000
*/*          ASSUMED.                                                */ 05656000
*/*            NO ERROR AND THE NAME IS CHECKED FOR UNIQUENESS AND   */ 05657000
*/*          MOVED INTO AN AVAILABLE ENTRY IN ILRDSTBL OR IGNORED    */ 05658000
*/*          WHEN SAME NAME ALREADY IN ILRDSTBL.                     */ 05659000
*/*            PARSE PROMPTS THE OPERATOR FOR A COMPLETE NEW LIST.   */ 05660000
*/*            IF SYNTAX ERROR VIA NIPPRMPT. PARSE PROCESSES THE NEW */ 05661000
*/*            LIST AS IF THE PRVIOUS LIST HAD NEVER EXISTED.        */ 05662000
*/*                                                                  */ 05663000
*/* OUTPUT: ILRDSTBL UPDATED WITH A UNIQUE LIST OF SWAP OR PAGE DATA */ 05664000
*/*         SETS.  IT COULD BE EMPTY IF NO DATA SETS WERE SPECIFIED. */ 05665000
*/*                                                                  */ 05666000
*/********************************************************************/ 05667000
*/*PARSE: CHART                                                      */ 05668000
*/*HEADER                                                          1729 05669000
*/*  ILRASRIM                                                      1729 05670000
*/* PARSE: PARSE PAGE AND SWAP DATA SET NAMES                        */ 05671000
*/*PARSE: E ENTRY TO PARSE PARMTAB STRING                            */ 05672000
*/*       P ZERO ENTIRE ILRDSTBL                                     */ 05673000
*/*       P AVLPTR IS FIRST ILRDSTBL ENTRY                           */ 05674000
*/*       P LIMIT IS NEXT TO LAST ILRDSTBL ENTRY                     */ 05675000
*/*       P PASS IS 1 OR FIRST PASS                                  */ 05676000
*/*       D (NO,,YES,%A1) DO PAGE= PROCESS?                          */ 05677000
*/*       P (,%A2) STRINGPTR POINT TO SWAP DATA SET NAMES            */ 05678000
*/*%A1:   P STRINGPTR POINT TO PARMLIB PAGE DATA SET NAMES           */ 05679000
*/*       P SAVEPTR POINTS TO OPERATOR PAGE DATA SET NAMES           */ 05680000
*/*       P RESERVE 3RD ILRDSTBL ENTRY FOR DUPLEX D.S.               */ 05681000
*/*       D (YES,,NO,%A2) LIST PAGE DATA SETS?                       */ 05682000
*/*       P TURN ON LIST INDICATOR                                   */ 05683000
*/*%A2:   P PLACE HOLDER IS AVLPTR                                   */ 05684000
*/*       P NO PROBLEM                                               */ 05685000
*/*       D (YES,,NO,%A3) PASS MARKED AS 3?                          */ 05686000
*/*       P MARK END OF LIST, ZERO AVAILABLE ILRDSTBL ENTRY          */ 05687000
*/*       R RETURN                                                   */ 05688000
*/*%A3:   D (YES,,NO,%A4) PASS MARKED AS 2?                          */ 05689000
*/*       P STRINGPTR POINT TO SAVED OPERATOR PAGE DATA SETS         */ 05690000
*/*       D (YES,,NO,%A4) LIST PAGE DATA SETS?                       */ 05691000
*/*       P TURN ON LIST INDICATOR                                   */ 05692000
*/*%A4:   D (YES,,NO,%A5) STRING IS EMPTY?                           */ 05693000
*/*%A9:   D (NO,,YES,%A6) ANOTHER STRING TO PROCESS?                 */ 05694000
*/*       P (,%A2) MARK PASS AS 3                                    */ 05695000
*/*%A6:   P (,%A2) MARK PASS AS 2 - ANOTHER STRING                   */ 05696000
*/*%A5:   D (YES,,NO,%A7) STRING BEGIN WITH '('?                     */ 05697000
*/*       P POINT TO NEXT CHAR IN STRING                             */ 05698000
*/*%A7:   N DONE SCANNING STRING IF ')' OR QUOTE FOUND OR PROBLEMS   */ 05699000
*/*       D (YES,,NO,%A8) DONE SCANNING?                             */ 05700000
*/*       D (YES,,NO,%A9) PROBLEMS HAVE BEEN FOUND?                  */ 05701000
*/*       S ILRIMMSG: ISSUE MESSAGE ABOUT PROBLEM                    */ 05702000
*/*       S NIPPRMPT: PROMPT OPERATOR FOR NEW STRING                 */ 05703000
*/*       P (,%A2) NEXT AVAILABLE ENTRY IS WHERE PLACE HOLDER POINTS */ 05704000
*/*%A8:   N ASSUME A DATA SET NAME IS NOT '(' OR COMMA               */ 05705000
*/*       D (NO,,YES,%B1) DATA SET NAME?                             */ 05706000
*/*       P (,%A7) MARK AS A PROBLEM                                 */ 05707000
*/*%B1:   S NEXDSN: PARSE THE DATA SET NAME                          */ 05708000
*/*       D (NO,,YES,%A7) RETURNED WITH PROBLEM?                     */ 05709000
*/*       N SEARCH ILRDSTBL FOR A DUPLICATE OF THIS NAME             */ 05710000
*/*       N ON MATCH, AVAILABLE ENTRY WILL BE REUSED                 */ 05711000
*/*       D (NO,,YES,%A7) MATCHING NAME FOUND?                       */ 05712000
*/*       P NEXT AVAILABLE ENTRY                                     */ 05713000
*/*       D (YES,,NO,%B2) THIS ENTRY DUPLEX ENTRY?                   */ 05714000
*/*       P NEXT AVAILABLE ENTRY                                     */ 05715000
*/*%B2:   D (YES,,NO,%A7) REACHED LIMIT OF ILRDSTBL?                 */ 05716000
*/*       P (,%A2) MARK PASS AS 3 - DONE                             */ 05717000
*/*PARSE: END                                                        */ 05718000
*                                                                  1729 05719000
*PARSE:                                                            1729 05720000
*   PROC;                           /* ZERO WORKAREA                 */ 05721000
PARSE    STM   @14,@12,@SA00003                                    1729 05722000
*   RFY                                                            1730 05723000
*    (R0,                                                          1730 05724000
*     R14,                                                         1730 05725000
*     R15) RSTD;                                                   1730 05726000
*   R0=DSTBLPTR;                    /* POINT TO WORKAREA             */ 05727000
         L     R0,DSTBLPTR                                         1731 05728000
*   R1=LENGTH(DSTBL);               /* LENGTH OF WORKAREA            */ 05729000
         L     R1,@CF02516                                         1732 05730000
*   R15=ZERO;                                                      1733 05731000
         SLR   R15,R15                                             1733 05732000
*   MVCL(R0,R14);                   /* WORKAREA ZEROED               */ 05733000
         MVCL  R0,R14                                              1734 05734000
*   RFY                                                            1735 05735000
*    (R0,                                                          1735 05736000
*     R14,                                                         1735 05737000
*     R15) UNRSTD;                                                 1735 05738000
*   AVLPTR=DSTBLPTR;                /* POINTER TO FIRST ENTRY        */ 05739000
         L     @08,DSTBLPTR                                        1736 05740000
         ST    @08,AVLPTR                                          1736 05741000
*   LIMIT=DSTBLPTR+LENGTH(DSTBL)-LENGTH(DSTBENT);/* NEXT TO LAST     */ 05742000
         SL    @08,@CF02885                                        1737 05743000
         ST    @08,LIMIT                                           1737 05744000
*   PASS=ONE;                       /* FIRST TIME THROUGH            */ 05745000
         MVI   PASS,X'01'                                          1738 05746000
*   IF SWAPSW=OFF THEN                                             1739 05747000
         TM    SWAPSW,B'00001000'                                  1739 05748000
         BNZ   @RF01739                                            1739 05749000
*     DO;                           /* PAGE STRING?                  */ 05750000
*       PAGEQPTR=ADDR(PAGEP);       /* POINT TO FIRST STRING         */ 05751000
         L     @08,PRMTBPTR                                        1741 05752000
         LA    @00,PAGEP(,@08)                                     1741 05753000
         ST    @00,PAGEQPTR                                        1741 05754000
*       SAVOPERD=PAGEO;             /* ADDR OF OPER NAMES            */ 05755000
         L     @08,PAGEO(,@08)                                     1742 05756000
         ST    @08,SAVOPERD                                        1742 05757000
*       DUPLPTR->DSTDPLX=ON;        /* MARK ENTRY TO BE SKIPPED      */ 05758000
         L     @08,DUPLPTR                                         1743 05759000
         OI    DSTDPLX(@08),B'10000000'                            1743 05760000
*       IF NIPPTLST=ON THEN                                        1744 05761000
         LR    @08,@00                                             1744 05762000
         TM    NIPPTLST(@08),B'01000000'                           1744 05763000
         BNO   @RF01744                                            1744 05764000
*         LIST=YES;                 /* INPUT TO LISTMSG SEGMENT      */ 05765000
         OI    LIST,B'01000000'                                    1745 05766000
*       ELSE                                                       1746 05767000
*         ;                         /* NO LIST REQUEST               */ 05768000
@RF01744 DS    0H                                                  1747 05769000
*     END;                          /* PAGE STRING                   */ 05770000
*   ELSE                                                           1748 05771000
*     PAGEQPTR=ADDR(SWAP);          /* SWAP STRING                   */ 05772000
         B     @RC01739                                            1748 05773000
@RF01739 L     @08,PRMTBPTR                                        1748 05774000
         LA    @08,SWAP(,@08)                                      1748 05775000
         ST    @08,PAGEQPTR                                        1748 05776000
*   PROBLEM=NO;                     /* NO PROBLEMS AT FIRST          */ 05777000
@RC01739 NI    PROBLEM,B'11011111'                                 1749 05778000
*   DO WHILE PASS<THREE;            /* FINISHED IF PASS IS THREE     */ 05779000
         B     @DE01750                                            1750 05780000
@DL01750 DS    0H                                                  1751 05781000
*     PLHPTR=AVLPTR;                /* SAVE 1ST ENTRY OF THIS STRING */ 05782000
         L     @08,AVLPTR                                          1751 05783000
         ST    @08,PLHPTR                                          1751 05784000
*     IF PASS=TWO THEN                                             1752 05785000
         CLI   PASS,2                                              1752 05786000
         BNE   @RF01752                                            1752 05787000
*       DO;                         /* DOING OPERATOR PAGE STRING?   */ 05788000
*         PAGEQPTR=ADDR(PAGEO);     /* POINT TO CORRECT PARMTAB ENTRY*/ 05789000
         L     @08,PRMTBPTR                                        1754 05790000
         LA    @08,PAGEO(,@08)                                     1754 05791000
         ST    @08,PAGEQPTR                                        1754 05792000
*         IF PROBLEM=NO THEN        /* FIRST TIME THROUGH THIS PASS  */ 05793000
         TM    PROBLEM,B'00100000'                                 1755 05794000
         BNZ   @RF01755                                            1755 05795000
*           PGSTRNGP=SAVOPERD;      /* RESTORE OPER PAGE STRING      */ 05796000
         L     @00,SAVOPERD                                        1756 05797000
         ST    @00,PGSTRNGP(,@08)                                  1756 05798000
*         ELSE                                                     1757 05799000
*           ;                       /* USE PGSTRNGP AS IT IS         */ 05800000
@RF01755 DS    0H                                                  1758 05801000
*         IF NIPPTLST=ON THEN                                      1758 05802000
         L     @08,PAGEQPTR                                        1758 05803000
         TM    NIPPTLST(@08),B'01000000'                           1758 05804000
         BNO   @RF01758                                            1758 05805000
*           LIST=YES;               /* LIST REQUEST FROM OPER?       */ 05806000
         OI    LIST,B'01000000'                                    1759 05807000
*         ELSE                                                     1760 05808000
*           ;                       /* NO LIST REQUEST               */ 05809000
@RF01758 DS    0H                                                  1761 05810000
*       END;                        /* DOING OPERATOR PAGE STRING    */ 05811000
*     ELSE                                                         1762 05812000
*       ;                           /* SPECIAL FOR PASS ONE          */ 05813000
@RF01752 DS    0H                                                  1763 05814000
*     PROBLEM=NO;                   /* NO PROBLEMS ON THIS TIME YET  */ 05815000
         NI    PROBLEM,B'11011111'                                 1763 05816000
*     CHARPTR=PGSTRNGP;             /* BEGINNING OF STRING           */ 05817000
         L     @08,PAGEQPTR                                        1764 05818000
         L     CHARPTR,PGSTRNGP(,@08)                              1764 05819000
*     IF CHARPTR=ZERO THEN                                         1765 05820000
         LTR   CHARPTR,CHARPTR                                     1765 05821000
         BNZ   @RF01765                                            1765 05822000
*       DO;                         /* NOTHING IN STRING?            */ 05823000
*         IF SWAPSW=OFF&PASS=ONE THEN                              1767 05824000
         TM    SWAPSW,B'00001000'                                  1767 05825000
         BNZ   @RF01767                                            1767 05826000
         CLI   PASS,1                                              1767 05827000
         BNE   @RF01767                                            1767 05828000
*           PASS=TWO;               /* MORE TO DO?                   */ 05829000
         MVI   PASS,X'02'                                          1768 05830000
*         ELSE                                                     1769 05831000
*           PASS=THREE;             /* DONE PROCESSING               */ 05832000
         B     @RC01767                                            1769 05833000
@RF01767 MVI   PASS,X'03'                                          1769 05834000
*       END;                        /* NOTHING IN STRING             */ 05835000
*     ELSE                                                         1771 05836000
*       DO;                         /* SOMETHING IN STRING           */ 05837000
         B     @RC01765                                            1771 05838000
@RF01765 DS    0H                                                  1772 05839000
*         IF PTCHAR=LEFTPAR THEN                                   1772 05840000
         CLI   PTCHAR(CHARPTR),C'('                                1772 05841000
         BNE   @RF01772                                            1772 05842000
*           CHARPTR=CHARPTR+ONE;    /* PASS A '('                    */ 05843000
         AL    CHARPTR,@CF00059                                    1773 05844000
*         ELSE                                                     1774 05845000
*           ;                       /* START HERE IF NO '('          */ 05846000
@RF01772 DS    0H                                                  1775 05847000
*         DO WHILE PTCHAR^=RIGHTPAR&/* END SCAN ON SECOND RIGHT PAREN*/ 05848000
*               PTCHAR^=QUOTE&      /* OR QUOTE(END DELIMITER)       */ 05849000
*               PROBLEM=NO&PASS<THREE;/* OR PROBLEM OR DONE          */ 05850000
         B     @DE01775                                            1775 05851000
@DL01775 DS    0H                                                  1776 05852000
*           IF PTCHAR=LEFTPAR|      /* EXPECT DSNAME NOT '(' OR COMMA*/ 05853000
*               PTCHAR=COMMA THEN                                  1776 05854000
         CLI   PTCHAR(CHARPTR),C'('                                1776 05855000
         BE    @RT01776                                            1776 05856000
         CLI   PTCHAR(CHARPTR),C','                                1776 05857000
         BNE   @RF01776                                            1776 05858000
@RT01776 DS    0H                                                  1777 05859000
*             PROBLEM=YES;                                         1777 05860000
         OI    PROBLEM,B'00100000'                                 1777 05861000
*           ELSE                                                   1778 05862000
*             DO;                   /* EXPECT DSNAME                 */ 05863000
         B     @RC01776                                            1778 05864000
@RF01776 DS    0H                                                  1779 05865000
*               CALL NEXDSN;        /* SCAN DSNAME                   */ 05866000
         BAL   @14,NEXDSN                                          1779 05867000
*               IF PROBLEM=NO THEN                                 1780 05868000
         TM    PROBLEM,B'00100000'                                 1780 05869000
         BNZ   @RF01780                                            1780 05870000
*                 DO;               /* NEXDSN O.K.?                  */ 05871000
*                   SCHPTR=DSTBLPTR;/* CHECK IT IS UNIQUE NAME       */ 05872000
         L     SCHPTR,DSTBLPTR                                     1782 05873000
*                   AVLPTR->DSTDSN='';/* PUT NAME IN WORKAREA        */ 05874000
         L     @15,AVLPTR                                          1783 05875000
         MVI   DSTDSN(@15),C' '                                    1783 05876000
         MVC   DSTDSN+1(43,@15),DSTDSN(@15)                        1783 05877000
*                   AVLPTR->DSTDSN(1:DSNLNG)=PTDSN(1:DSNLNG);      1784 05878000
         LR    @14,DSNLNG                                          1784 05879000
         BCTR  @14,0                                               1784 05880000
         L     @07,DSNPTR                                          1784 05881000
         EX    @14,@SM02915                                        1784 05882000
*                   DO WHILE SCHPTR->DSTDSN^=AVLPTR->DSTDSN;/*     1785 05883000
*                                      UNIQUE?                       */ 05884000
         B     @DE01785                                            1785 05885000
@DL01785 DS    0H                                                  1786 05886000
*                     SCHPTR=SCHPTR+LENGTH(DSTENT);/* NEXT ENTRY     */ 05887000
         AL    SCHPTR,@CF00076                                     1786 05888000
*                   END;            /* UNIQUE                        */ 05889000
@DE01785 L     @15,AVLPTR                                          1787 05890000
         CLC   DSTDSN(44,SCHPTR),DSTDSN(@15)                       1787 05891000
         BNE   @DL01785                                            1787 05892000
*                   IF SCHPTR=AVLPTR THEN                          1788 05893000
         CR    SCHPTR,@15                                          1788 05894000
         BNE   @RF01788                                            1788 05895000
*                     DO;           /* ONLY MATCH IS ITSELF?         */ 05896000
*                       AVLPTR->DSTLNG=DSNLNG;/* LENGTH OF DSNAME    */ 05897000
         STC   DSNLNG,DSTLNG(,@15)                                 1790 05898000
*                       AVLPTR=AVLPTR+LENGTH(DSTENT);/* NEXT ENTRY   */ 05899000
         LA    @08,48                                              1791 05900000
         ALR   @15,@08                                             1791 05901000
         ST    @15,AVLPTR                                          1791 05902000
*                       IF AVLPTR->DSTDPLX=ON THEN/* SKIP DUPLEX   1792 05903000
*                                      ENTRY                         */ 05904000
         TM    DSTDPLX(@15),B'10000000'                            1792 05905000
         BNO   @RF01792                                            1792 05906000
*                         AVLPTR=AVLPTR+LENGTH(DSTENT);            1793 05907000
         ALR   @15,@08                                             1793 05908000
         ST    @15,AVLPTR                                          1793 05909000
*                       ELSE                                       1794 05910000
*                         ;         /* NOT DUPLEX ENTRY              */ 05911000
@RF01792 DS    0H                                                  1795 05912000
*                       IF AVLPTR=LIMIT THEN                       1795 05913000
         CLC   AVLPTR(4),LIMIT                                     1795 05914000
         BNE   @RF01795                                            1795 05915000
*                         PASS=THREE;/* DONE?                        */ 05916000
         MVI   PASS,X'03'                                          1796 05917000
*                       ELSE                                       1797 05918000
*                         ;         /* NOT DONE                      */ 05919000
@RF01795 DS    0H                                                  1798 05920000
*                     END;          /* ONLY MATCH IS ITSELF          */ 05921000
*                   ELSE                                           1799 05922000
*                     ;             /* IGNORE AND SCAN ON (MATCHES)  */ 05923000
@RF01788 DS    0H                                                  1800 05924000
*                 END;              /* NEXDSN O.K.                   */ 05925000
*               ELSE                                               1801 05926000
*                 ;                 /* PASS ON PROBLEM               */ 05927000
@RF01780 DS    0H                                                  1802 05928000
*             END;                  /* EXPECT DSNAME                 */ 05929000
*         END;                      /* END SCAN                      */ 05930000
@RC01776 DS    0H                                                  1803 05931000
@DE01775 CLI   PTCHAR(CHARPTR),C')'                                1803 05932000
         BE    @DC01775                                            1803 05933000
         CLI   PTCHAR(CHARPTR),C''''                               1803 05934000
         BE    @DC01775                                            1803 05935000
         TM    PROBLEM,B'00100000'                                 1803 05936000
         BNZ   @DC01775                                            1803 05937000
         CLI   PASS,3                                              1803 05938000
         BL    @DL01775                                            1803 05939000
@DC01775 DS    0H                                                  1804 05940000
*         IF PROBLEM=YES THEN                                      1804 05941000
         TM    PROBLEM,B'00100000'                                 1804 05942000
         BNO   @RF01804                                            1804 05943000
*           DO;                     /* NEED NEW STRING?              */ 05944000
*             IF SWAPSW=OFF THEN                                   1806 05945000
         TM    SWAPSW,B'00001000'                                  1806 05946000
         BNZ   @RF01806                                            1806 05947000
*               DO;                 /* PAGE STRING?                  */ 05948000
*                 IF PASS=ONE THEN                                 1808 05949000
         CLI   PASS,1                                              1808 05950000
         BNE   @RF01808                                            1808 05951000
*                   DO;             /* SYSP PAGE STRING?             */ 05952000
*                     MSGID=M915E;  /* IEASYSP SYNTAX ERROR          */ 05953000
         MVC   MSGID(4),@CC02543                                   1810 05954000
*                     PAGEQPTR=ADDR(PAGEO);/* INPUT FROM OPERATOR    */ 05955000
         L     @08,PRMTBPTR                                        1811 05956000
         LA    @08,PAGEO(,@08)                                     1811 05957000
         ST    @08,PAGEQPTR                                        1811 05958000
*                   END;            /* SYSP PAGE STRING              */ 05959000
*                 ELSE                                             1813 05960000
*                   DO;             /* OPERATOR SPECIFIED PAGE STRING*/ 05961000
         B     @RC01808                                            1813 05962000
@RF01808 DS    0H                                                  1814 05963000
*                     MSGID=M916E;  /* SYSTEM PARM ERROR             */ 05964000
         MVC   MSGID(4),@CC02545                                   1814 05965000
*                     FLAGS=PAGEQ;  /* PAGE PARM                     */ 05966000
         MVI   FLAGS,X'80'                                         1815 05967000
*                   END;            /* OPERATOR SPECIFIED PAGE STRING*/ 05968000
*                 DATAPARM=PAGEPARM;/* PARM TO PROMPT                */ 05969000
@RC01808 MVC   DATAPARM(8),PAGEPARM                                1817 05970000
*               END;                /* PAGE STRING                   */ 05971000
*             ELSE                                                 1819 05972000
*               DO;                 /* SWAP STRING                   */ 05973000
         B     @RC01806                                            1819 05974000
@RF01806 DS    0H                                                  1820 05975000
*                 MSGID=M916E;      /* SYSTEM PARM                   */ 05976000
         MVC   MSGID(4),@CC02545                                   1820 05977000
*                 FLAGS=SWAPEQ;     /* SWAP PARM                     */ 05978000
         MVI   FLAGS,X'40'                                         1821 05979000
*                 DATAPARM=SWAPPARM;/* PARM TO PROMPT                */ 05980000
         MVC   DATAPARM(8),SWAPPARM                                1822 05981000
*               END;                /* SWAP STRING                   */ 05982000
*             R1=ADDR(MSGPL);       /* PARM TO ILRIMMSG              */ 05983000
@RC01806 LA    R1,MSGPL                                            1824 05984000
*             CALL ILRIMMSG;        /* MESSAGE MODULE                */ 05985000
         L     @15,@CV02592                                        1825 05986000
         BALR  @14,@15                                             1825 05987000
*             RFY                                                  1826 05988000
*              (R2,                                                1826 05989000
*               R3) RSTD;                                          1826 05990000
*             LM(R2,R3,NIPPTRS);    /* PASS NVT & CVT TO PROMPT      */ 05991000
         LM    R2,R3,NIPPTRS                                       1827 05992000
*             GEN REFS(NIPPTRS,NVTPRMPT,DATAPARM) SETS(PAGEO,SWAP);     05993000
          IEAPMNIP TYPE=PRMPT,PARAM=DATAPARM,OPT=ERROR                  05994000
*             RFY                                                  1829 05995000
*              (R2,                                                1829 05996000
*               R3) UNRSTD;                                        1829 05997000
*             AVLPTR=PLHPTR;        /* RETURN AVLPTR TO 1ST THIS STRG*/ 05998000
         L     @08,PLHPTR                                          1830 05999000
         ST    @08,AVLPTR                                          1830 06000000
*           END;                    /* NEED NEW STRING               */ 06001000
*         ELSE                                                     1832 06002000
*           IF SWAPSW=OFF&PASS=ONE THEN                            1832 06003000
         B     @RC01804                                            1832 06004000
@RF01804 TM    SWAPSW,B'00001000'                                  1832 06005000
         BNZ   @RF01832                                            1832 06006000
         CLI   PASS,1                                              1832 06007000
         BNE   @RF01832                                            1832 06008000
*             PASS=TWO;             /* NO PROBLEMS                   */ 06009000
         MVI   PASS,X'02'                                          1833 06010000
*           ELSE                                                   1834 06011000
*             PASS=THREE;           /* DONE OR SECOND PASS           */ 06012000
         B     @RC01832                                            1834 06013000
@RF01832 MVI   PASS,X'03'                                          1834 06014000
*       END;                        /* SOMETHING IN STRING           */ 06015000
@RC01832 DS    0H                                                  1835 06016000
@RC01804 DS    0H                                                  1836 06017000
*   END;                            /* FINISHED IF PASS IS THREE     */ 06018000
@RC01765 DS    0H                                                  1836 06019000
@DE01750 CLI   PASS,3                                              1836 06020000
         BL    @DL01750                                            1836 06021000
*   AVLPTR->DSTENT=''B;             /* ZERO ENTRY TO MARK END OF LIST*/ 06022000
         L     @08,AVLPTR                                          1837 06023000
         XC    DSTENT(48,@08),DSTENT(@08)                          1837 06024000
*   END PARSE;                                                     1838 06025000
@EL00003 DS    0H                                                  1838 06026000
@EF00003 DS    0H                                                  1838 06027000
@ER00003 LM    @14,@12,@SA00003                                    1838 06028000
         BR    @14                                                 1838 06029000
*                                                                  1839 06030000
*/********************************************************************/ 06031000
*/*                                                                  */ 06032000
*/* NEXDSN: SUBROUTINE TO PARSE A DATA SET NAME                      */ 06033000
*/*                                                                  */ 06034000
*/* INPUT: CHARPTR POINTING TO FIRST CHARACTER OF NAME               */ 06035000
*/*        PROBLEM INDICATOR OFF                                     */ 06036000
*/*                                                                  */ 06037000
*/* PROCESS: NEXDSN IS INVOKED BY PARSE OR OPENA SUBROUTINES.        */ 06038000
*/*          SCAN UNTIL QUOTE, RIGHT PARENTHSIS, OR COMMA IS FOUND.  */ 06039000
*/*           CHECKS FOR VALID LENGTH.                               */ 06040000
*/*                                                                  */ 06041000
*/* OUTPUT: PROBLEM INDICATOR ON                                     */ 06042000
*/*        OR                                                        */ 06043000
*/*         CHARPTR POINTS AT QUORE OR JUST BEYOND COMMA OR RIGHT    */ 06044000
*/*            PARENTHSIS                                            */ 06045000
*/*         DSNPTR POINT TO NAME                                     */ 06046000
*/*         DSNLNG CONTAINS LENGTH OF NAME                           */ 06047000
*/*                                                                  */ 06048000
*/********************************************************************/ 06049000
*/*NEXDSN: CHART                                                     */ 06050000
*/*HEADER                                                          1839 06051000
*/*  ILRASRIM                                                      1839 06052000
*/* NEXDSN: PARSE DATA SET NAME                                      */ 06053000
*/*NEXDSN: E ENTRY TO PARSE DATA SET NAME                            */ 06054000
*/*        P DSNPTR IS CHARPTR                                       */ 06055000
*/*%A4:    D (NO,,YES,%A1) CHAR IS QUOTE, ')', OR COMMA?             */ 06056000
*/*        P (,%A4) NEXT CHAR                                        */ 06057000
*/*%A1:    P CALCULATE NAME LENGTH                                   */ 06058000
*/*        D (YES,,NO,%A2) VALID LENGTH?                             */ 06059000
*/*        D (NO,,YES,%A3) CHAR IS QUOTE?                            */ 06060000
*/*        P (,%A3) NEXT CHARACTER                                   */ 06061000
*/*%A2:    P MARK AS PROBLEM                                         */ 06062000
*/*%A3:    R RETURN                                                  */ 06063000
*/*NEXDSN: END                                                       */ 06064000
*                                                                  1839 06065000
*NEXDSN:                                                           1839 06066000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1839 06067000
NEXDSN   DS    0H                                                  1840 06068000
*   RFY                                                            1840 06069000
*     R14 RSTD;                                                    1840 06070000
*   SAVER14A=R14;                   /* SAVE RETURN ADDRESS           */ 06071000
         ST    R14,SAVER14A                                        1841 06072000
*   RFY                                                            1842 06073000
*     R14 UNRSTD;                                                  1842 06074000
*   DSNPTR=CHARPTR;                 /* BEGIN DSNAME                  */ 06075000
         ST    CHARPTR,DSNPTR                                      1843 06076000
*   DO WHILE PTCHAR^=COMMA&         /* FIND DELIMITOR                */ 06077000
*         PTCHAR^=RIGHTPAR&PTCHAR^=QUOTE;                          1844 06078000
         B     @DE01844                                            1844 06079000
@DL01844 DS    0H                                                  1845 06080000
*     CHARPTR=CHARPTR+ONE;          /* NEXT CHARACTER                */ 06081000
         AL    CHARPTR,@CF00059                                    1845 06082000
*   END;                            /* FIND DELIMITOR                */ 06083000
@DE01844 CLI   PTCHAR(CHARPTR),C','                                1846 06084000
         BE    @DC01844                                            1846 06085000
         CLI   PTCHAR(CHARPTR),C')'                                1846 06086000
         BE    @DC01844                                            1846 06087000
         CLI   PTCHAR(CHARPTR),C''''                               1846 06088000
         BNE   @DL01844                                            1846 06089000
@DC01844 DS    0H                                                  1847 06090000
*   DSNLNG=CHARPTR-DSNPTR;          /* LENGTH OF DSNAME              */ 06091000
         LR    DSNLNG,CHARPTR                                      1847 06092000
         SL    DSNLNG,DSNPTR                                       1847 06093000
*   IF DSNLNG>44|DSNLNG=0 THEN                                     1848 06094000
         C     DSNLNG,@CF00102                                     1848 06095000
         BH    @RT01848                                            1848 06096000
         LTR   DSNLNG,DSNLNG                                       1848 06097000
         BNZ   @RF01848                                            1848 06098000
@RT01848 DS    0H                                                  1849 06099000
*     PROBLEM=YES;                  /* INVALID LENGTH?               */ 06100000
         OI    PROBLEM,B'00100000'                                 1849 06101000
*   ELSE                                                           1850 06102000
*     IF PTCHAR^=QUOTE THEN         /* VALID, BUT NOT END OF STRING? */ 06103000
         B     @RC01848                                            1850 06104000
@RF01848 CLI   PTCHAR(CHARPTR),C''''                               1850 06105000
         BE    @RF01850                                            1850 06106000
*       CHARPTR=CHARPTR+ONE;        /* NEXT CHARACTER                */ 06107000
         AL    CHARPTR,@CF00059                                    1851 06108000
*     ELSE                                                         1852 06109000
*       ;                           /* END OF STRING IS QUOTE        */ 06110000
@RF01850 DS    0H                                                  1853 06111000
*   RFY                                                            1853 06112000
*     R14 RSTD;                                                    1853 06113000
@RC01848 DS    0H                                                  1854 06114000
*   R14=SAVER14A;                   /* RESTORE RETURN ADDRESS        */ 06115000
         L     R14,SAVER14A                                        1854 06116000
*   RFY                                                            1855 06117000
*     R14 UNRSTD;                                                  1855 06118000
*   END NEXDSN;                                                    1856 06119000
@EL00004 DS    0H                                                  1856 06120000
@EF00004 DS    0H                                                  1856 06121000
@ER00004 BR    @14                                                 1856 06122000
*                                                                  1857 06123000
*/********************************************************************/ 06124000
*/*                                                                  */ 06125000
*/* OPEN: SUBROUTINE TO CALL ILROPS00 (OPEN MODULE) AND PROCESS AND  */ 06126000
*/*        HANDLE RESULTS UPON RETURN                                */ 06127000
*/*                                                                  */ 06128000
*/* INPUT: FILLED IN ILROPS00 PARAMETER LIST, ALL CASES              */ 06129000
*/*        DSTEPTR TO POINT TO 44 CHARACTER DATA SET NAME            */ 06130000
*/*          (DO NOT ASSUME A VALID ILRDSTBL ENTRY, ALTHOUGH IT IS   */ 06131000
*/*           EXCEPT WHEN PROCESSING NEEDED LOCAL DATA SETS)         */ 06132000
*/*        SWAP, NEEDEDL, AND DUPLEX INDICATORS                      */ 06133000
*/*                                                                  */ 06134000
*/* PROCESS: CALL ILROPS00 AND HANDLE THE POSSIBLE RETURN CODES      */ 06135000
*/*                                                                  */ 06136000
*/* OUTPUT: NO MORE NUCLEUS BUFFER SPACE- ISSUE MESSAGE IEA340I AND  */ 06137000
*/*                WAIT STATE SYSTEM WITH CODE 38                    */ 06138000
*/*         NO MORE SQA SPACE- ISSUE MESSAGE IEA938W AND WAIT STATE  */ 06139000
*/*                SYSTEM WITH CODE 63                               */ 06140000
*/*         MOUNT FAILURE- RETURN TO CALLER WITH ILROPS00'S RETURN   */ 06141000
*/*                CODE (08)                                         */ 06142000
*/*         LOCATE FAILURE- ISSUE MESSAGE IEA920I AND RETURN TO      */ 06143000
*/*               CALLER WITH ILROPS12'S RETURN CODE(00)             */ 06144000
*/*         OPEN O.K.- RETURN TO CALLER WITH ILROPS00'S RETURN       */ 06145000
*/*               CODE (00)                                          */ 06146000
*/*                                                                  */ 06147000
*/********************************************************************/ 06148000
*/*OPEN: CHART                                                       */ 06149000
*/*HEADER                                                          1857 06150000
*/*  ILRASRIM                                                      1857 06151000
*/* OPEN: OPEN SWAP AND PAGE DATA SETS                               */ 06152000
*/*OPEN: E ENTRY TO HANDLE OPEN RETURN CONDITIONS                    */ 06153000
*/*      S ILROPS00: LOCATE, MOUNT, AND OPEN DATA SET                */ 06154000
*/*      D (YES,,NO,%A1) NUCLEUS BUFFER PROBLEM?                     */ 06155000
*/*      S ILRIMMSG:ISSUE MESSAGE IEA340I                            */ 06156000
*/*      R WAIT STATE 38                                             */ 06157000
*/*%A1:  D (YES,,NO,%A2) SQA PROBLEM?                                */ 06158000
*/*      S ILRIMMSG: ISSUE MESSAGE IEA938W                           */ 06159000
*/*      R WAIT STATE 63                                             */ 06160000
*/*%A2:  D (YES,,NO,%A3) MOUNT FAIL?                                 */ 06161000
*/*%A4:  R RETURN WITH ILROPS00'S RETURN CODE                        */ 06162000
*/*%A3:  D (YES,,NO,%A4) LOCATE FAIL?                                */ 06163000
*/*      S (,%A4) ILRIMMSG: ISSUE MESSAGE IEA920I                    */ 06164000
*/*OPEN: END                                                         */ 06165000
*                                                                  1857 06166000
*OPEN:                                                             1857 06167000
*   PROC;                           /* OPEN SUBROUTINE               */ 06168000
OPEN     STM   @14,@12,@SA00005                                    1857 06169000
*   RFY                                                            1858 06170000
*    (R2,                                                          1858 06171000
*     R3) RSTD;                                                    1858 06172000
*   LM(R2,R3,NIPPTRS);              /* PUT NVT AND CVT POINTERS IN   */ 06173000
         LM    R2,R3,NIPPTRS                                       1859 06174000
*   R1=PARMPTR;                     /* PARMS TO ILROPS00             */ 06175000
         L     R1,PARMPTR                                          1860 06176000
*   CALL ILROPS00;                  /* CALL ILROPS00                 */ 06177000
         L     @15,OPENPTR                                         1861 06178000
         BALR  @14,@15                                             1861 06179000
*   RFY                                                            1862 06180000
*    (R2,                                                          1862 06181000
*     R3) UNRSTD;                                                  1862 06182000
*   RFY                                                            1863 06183000
*     R15 RSTD;                     /* SAVE RETURN CODE              */ 06184000
*   IF R15^=ZERO THEN                                              1864 06185000
         LTR   R15,R15                                             1864 06186000
         BZ    @RF01864                                            1864 06187000
*     DO;                           /* OPEN FAILED?                  */ 06188000
*       IF R15=NONUCSTG THEN                                       1866 06189000
         C     R15,@CF00267                                        1866 06190000
         BNE   @RF01866                                            1866 06191000
*         DO;                       /* NO NUCLEUS BUFFER SPACE?      */ 06192000
*           MSGID=M340I;            /* BUFFER PROBLEM                */ 06193000
         MVC   MSGID(4),@CC02541                                   1868 06194000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 06195000
         LA    R1,MSGPL                                            1869 06196000
*           CALL ILRIMMSG;          /* WAIT STATE                    */ 06197000
         L     @15,@CV02592                                        1870 06198000
         BALR  @14,@15                                             1870 06199000
*         END;                      /* BUFFER PROBLEM                */ 06200000
*       ELSE                                                       1872 06201000
*         ;                         /* NOT NUCLEUS BUFFER PROBLEM    */ 06202000
@RF01866 DS    0H                                                  1873 06203000
*       IF R15=NOSQASTG THEN                                       1873 06204000
         C     R15,@CF00111                                        1873 06205000
         BNE   @RF01873                                            1873 06206000
*         DO;                       /* NO SQA CONTROL BLOCK STORAGE? */ 06207000
*           MSGID=M938W;            /* SQA SHORTAGE                  */ 06208000
         MVC   MSGID(4),@CC02571                                   1875 06209000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 06210000
         LA    R1,MSGPL                                            1876 06211000
*           CALL ILRIMMSG;          /* WAIT STATE                    */ 06212000
         L     @15,@CV02592                                        1877 06213000
         BALR  @14,@15                                             1877 06214000
*         END;                      /* NO SQA                        */ 06215000
*       ELSE                                                       1879 06216000
*         ;                         /* NOT SQA PROBLEM               */ 06217000
@RF01873 DS    0H                                                  1880 06218000
*       IF R15=LOCFAIL THEN                                        1880 06219000
         C     R15,@CF01569                                        1880 06220000
         BNE   @RF01880                                            1880 06221000
*         DO;                       /* LOCATE FAILED?                */ 06222000
*           MSGID=M920I;            /* LOCATE FAIL                   */ 06223000
         MVC   MSGID(4),@CC02549                                   1882 06224000
*           IF NEEDEDL=ON THEN      /* NEEDED LOCAL NAME IN ILRTPARB */ 06225000
         TM    NEEDEDL,B'00000010'                                 1883 06226000
         BNO   @RF01883                                            1883 06227000
*             MSGDATA1=ADDR(TPAEDSN);                              1884 06228000
         L     @14,TPAEPTR                                         1884 06229000
         LA    @14,TPAEDSN(,@14)                                   1884 06230000
         ST    @14,MSGDATA1                                        1884 06231000
*           ELSE                                                   1885 06232000
*             MSGDATA1=DSTEPTR;     /* DSNAME THAT FAILED            */ 06233000
         B     @RC01883                                            1885 06234000
@RF01883 ST    DSTEPTR,MSGDATA1                                    1885 06235000
*           IF SWAPSW=OFF THEN                                     1886 06236000
@RC01883 TM    SWAPSW,B'00001000'                                  1886 06237000
         BNZ   @RF01886                                            1886 06238000
*             DO;                   /* NOT SWAP DATA SET?            */ 06239000
*               IF DUPLEXSW=ON THEN                                1888 06240000
         TM    DUPLEXSW,B'00000100'                                1888 06241000
         BNO   @RF01888                                            1888 06242000
*                 FLAGS=DUPEQ;      /* PUT DUPLEX IN MESSAGE         */ 06243000
         MVI   FLAGS,X'20'                                         1889 06244000
*               ELSE                                               1890 06245000
*                 FLAGS=PAGEQ;      /* PUT PAGE IN MESSAGE           */ 06246000
         B     @RC01888                                            1890 06247000
@RF01888 MVI   FLAGS,X'80'                                         1890 06248000
*             END;                                                 1891 06249000
*           ELSE                                                   1892 06250000
*             FLAGS=SWAPEQ;         /* SWAP DATA SET                 */ 06251000
         B     @RC01886                                            1892 06252000
@RF01886 MVI   FLAGS,X'40'                                         1892 06253000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 06254000
@RC01886 LA    R1,MSGPL                                            1893 06255000
*           CALL ILRIMMSG;          /* MESSAGE MODULE                */ 06256000
         L     @15,@CV02592                                        1894 06257000
         BALR  @14,@15                                             1894 06258000
*           R15=LOCFAIL;            /* RESET--CLOBBERED BY ILRIMMSG  */ 06259000
         LA    R15,12                                              1895 06260000
*         END;                      /* LOCATE FAILED                 */ 06261000
*       ELSE                                                       1897 06262000
*         ;                         /* MOUNT FAIL                    */ 06263000
@RF01880 DS    0H                                                  1898 06264000
*     END;                          /* OPEN FAILED                   */ 06265000
*   ELSE                                                           1899 06266000
*     ;                             /* OPEN SUCCESSFULLY             */ 06267000
@RF01864 DS    0H                                                  1900 06268000
*   RETURN CODE(R15);               /* RETURN ILROPS00 R.C.          */ 06269000
         L     @14,@SA00005                                        1900 06270000
         LM    @00,@12,@SA00005+8                                  1900 06271000
         BR    @14                                                 1900 06272000
*   RFY                                                            1901 06273000
*     R15 UNRSTD;                                                  1901 06274000
*   END OPEN;                                                      1902 06275000
*                                                                  1903 06276000
*/********************************************************************/ 06277000
*/*                                                                  */ 06278000
*/* OPENA: SUBROUTINE TO OBTAIN A NEW DATA SET (RESPECIFICATION)     */ 06279000
*/*                                                                  */ 06280000
*/* INPUT: DSTEPTR POINTING TO ILRDSTBL ENTRY TO USE                 */ 06281000
*/*        SWAP INDICATOR                                            */ 06282000
*/*                                                                  */ 06283000
*/* PROCESS: INVOKED WHEN:                                           */ 06284000
*/*              1. TPARPATS FAILS FOR PAGE DATA SETS OTHER THAN     */ 06285000
*/*                    PLPA, PREVIOUS DUPLEX, OR NEEDED LOCALS       */ 06286000
*/*              2. MOUNT FAILS FOR PLPA OR COMMON AND OPERATOR      */ 06287000
*/*                    REPLIES IGNORE TO IEA924D.                    */ 06288000
*/*              3. LOCATE FAILS FOR PAGE DATA SETS OTHER THAN       */ 06289000
*/*                    PREVIOUS DUPLEX OR NEEDED LOCALS              */ 06290000
*/*              4. LOCATE FAILS FOR SWAP DATA SET                   */ 06291000
*/*              5. MAIN LINE HAS JUST RETURNED FROM OPENB           */ 06292000
*/*           OPENA ASKS OPERATOR FOR A DIFFERENT DATA SET NAME,     */ 06293000
*/*           PARSES NAME, AND CHECKS ILRDSTBL FOR THE SAME NAME     */ 06294000
*/*           ALREADY THERE.                                         */ 06295000
*/*                                                                  */ 06296000
*/* OUTPUT: RETURN CODE 4-  OPERATOR REPLIED IGNORE TO REQUEST OF    */ 06297000
*/*            NEW NAME                                              */ 06298000
*/*         RETURN CODE 16- NEW UNIQUE NAME IN ILRDSTBL ENTRY        */ 06299000
*/*                                                                  */ 06300000
*/********************************************************************/ 06301000
*/*OPENA: CHART                                                      */ 06302000
*/*HEADER                                                          1903 06303000
*/*  ILRASRIM                                                      1903 06304000
*/* OPENA: HAVE OPERATOR RESPECIFY DATA SET NAME                     */ 06305000
*/*OPENA:  E ENTRY TO DATA SET RESPECIFICATION                       */ 06306000
*/*%A2:    S ILRIMMSG: ASK OPERATOR FOR NAME                         */ 06307000
*/*        D (NO,,YES,%A1) GIVE A NAME?                              */ 06308000
*/*        P (,%A5) RETURN CODE IS 4                                 */ 06309000
*/*%A1:    P SETUP INPUT TO NEXDSN                                   */ 06310000
*/*        S NEXDSN: PARSE THE NAME                                  */ 06311000
*/*        D (YES,,NO,%A2) NO PROBLEM AND NEXT CHAR IS QUOTE?        */ 06312000
*/*        P PUT NAME IN ILRDSTBL ENTRY                              */ 06313000
*/*        N CHECK NAME IS UNIQUE                                    */ 06314000
*/*        P POINT TO FIRST ILRDSTBL ENTRY                           */ 06315000
*/*%A3:    D (NO,,YES,%A4) ENTRY NOT BEING USED?                     */ 06316000
*/*        D (NO,,YES,%A6) MATCHES NEW NAME?                         */ 06317000
*/*%A4:    P NEXT ENTRY                                              */ 06318000
*/*        D (YES,,NO,%A3) NAME(THIS ENTRY) IS ZERO?                 */ 06319000
*/*        D (NO,,YES,%A4) MORE ENTRIES?                             */ 06320000
*/*        P NEW NAME IS O.K.,R.C.16                                 */ 06321000
*/*%A5:    R RETURN                                                  */ 06322000
*/*%A6:    S (,%A2) OPENB: NOT ACCEPTED DSNAME                       */ 06323000
*/*OPENA:  END                                                       */ 06324000
*                                                                  1903 06325000
*OPENA:                                                            1903 06326000
*   PROC;                           /* ASK FOR NEW NAME              */ 06327000
OPENA    STM   @14,@12,@SA00006                                    1903 06328000
*OPENAAGN:                                                         1904 06329000
*   MSGID=M922D;                                                   1904 06330000
OPENAAGN MVC   MSGID(4),@CC02553                                   1904 06331000
*   R1=ADDR(MSGPL);                 /* PARM TO ILRIMMSG              */ 06332000
         LA    R1,MSGPL                                            1905 06333000
*   CALL ILRIMMSG;                  /* MESSAGE MODULE                */ 06334000
         L     @15,@CV02592                                        1906 06335000
         BALR  @14,@15                                             1906 06336000
*   IF R1->MSGBUF(1:LENGTH(IGNORE))^=IGNORE THEN                   1907 06337000
         CLC   MSGBUF(6,R1),@CC02477                               1907 06338000
         BE    @RF01907                                            1907 06339000
*     DO;                           /* NOT IGNORE?                   */ 06340000
*       PROBLEM=NO;                 /* PREPARE FOR NEXDSN- NO PROBLEM*/ 06341000
         NI    PROBLEM,B'11011111'                                 1909 06342000
*       CHARPTR=R1+LENGTH(DSNEQ);   /* EXPECT DSNAME                 */ 06343000
         LA    CHARPTR,4                                           1910 06344000
         ALR   CHARPTR,R1                                          1910 06345000
*       CALL NEXDSN;                /* SCAN DSNAME                   */ 06346000
         BAL   @14,NEXDSN                                          1911 06347000
*       IF PROBLEM=NO&              /* NO PROBLEMS IN REPLY          */ 06348000
*           PTCHAR=QUOTE THEN                                      1912 06349000
         TM    PROBLEM,B'00100000'                                 1912 06350000
         BNZ   @RF01912                                            1912 06351000
         CLI   PTCHAR(CHARPTR),C''''                               1912 06352000
         BNE   @RF01912                                            1912 06353000
*         DO;                                                      1913 06354000
*           DSTDSN='';              /* PUT INFO IN WORKAREA          */ 06355000
         MVI   DSTDSN(DSTEPTR),C' '                                1914 06356000
         MVC   DSTDSN+1(43,DSTEPTR),DSTDSN(DSTEPTR)                1914 06357000
*           DSTDSN(1:DSNLNG)=PTDSN(1:DSNLNG);                      1915 06358000
         LR    @06,DSNLNG                                          1915 06359000
         BCTR  @06,0                                               1915 06360000
         L     @02,DSNPTR                                          1915 06361000
         EX    @06,@SM02917                                        1915 06362000
*           DSTLNG=DSNLNG;                                         1916 06363000
         STC   DSNLNG,DSTLNG(,DSTEPTR)                             1916 06364000
*           SCHPTR=DSTBLPTR;        /* CHECK NEW NAME IS UNIQUE      */ 06365000
         L     SCHPTR,DSTBLPTR                                     1917 06366000
*           DO WHILE                /* NOT MATCH AND NOT END OF LIST */ 06367000
*                 (SCHPTR->DSTDSN^=DSTDSN&SCHPTR->DSTDSNC^=0)|DSTEPTR=  06368000
*                 SCHPTR|           /* SAME ENTRY                    */ 06369000
*                 SCHPTR->DSTNUSED=ON|/* TOLD TO IGNORE THIS ONE   1918 06370000
*                                      BEFORE                        */ 06371000
*                 (SCHPTR->DSTDPLX=ON&SCHPTR->DSTDSNC=0);/* NO DUPLEX*/ 06372000
         B     @DE01918                                            1918 06373000
@DL01918 DS    0H                                                  1919 06374000
*             SCHPTR=SCHPTR+LENGTH(DSTENT);/* NEXT ENTRY             */ 06375000
         AL    SCHPTR,@CF00076                                     1919 06376000
*           END;                    /* CHECK UNIQUE                  */ 06377000
@DE01918 CLC   DSTDSN(44,SCHPTR),DSTDSN(DSTEPTR)                   1920 06378000
         BE    @GL00042                                            1920 06379000
         CLI   DSTDSNC(SCHPTR),0                                   1920 06380000
         BNE   @DL01918                                            1920 06381000
@GL00042 CR    DSTEPTR,SCHPTR                                      1920 06382000
         BE    @DL01918                                            1920 06383000
         TM    DSTNUSED(SCHPTR),B'00100000'                        1920 06384000
         BO    @DL01918                                            1920 06385000
         TM    DSTDPLX(SCHPTR),B'10000000'                         1920 06386000
         BNO   @DC01918                                            1920 06387000
         CLI   DSTDSNC(SCHPTR),0                                   1920 06388000
         BE    @DL01918                                            1920 06389000
@DC01918 DS    0H                                                  1921 06390000
*           IF SCHPTR->DSTDSNC^=0 THEN                             1921 06391000
         CLI   DSTDSNC(SCHPTR),0                                   1921 06392000
         BE    @RF01921                                            1921 06393000
*             DO;                   /* FOUND A MATCH? BAD            */ 06394000
*               CALL OPENB;         /* NOT ACCEPTABLE DSNAME         */ 06395000
         BAL   @14,OPENB                                           1923 06396000
*               GOTO OPENAAGN;      /* ASK AGAIN                     */ 06397000
         B     OPENAAGN                                            1924 06398000
*             END;                  /* FOUND A MATCH                 */ 06399000
*           ELSE                                                   1926 06400000
*             DO;                   /* END OF LIST --NO MATCH        */ 06401000
@RF01921 DS    0H                                                  1927 06402000
*               IF SWAPSW=OFF THEN                                 1927 06403000
         TM    SWAPSW,B'00001000'                                  1927 06404000
         BNZ   @RF01927                                            1927 06405000
*                 LIST=ON;          /* CHANGED--ISSUE IEA940I        */ 06406000
         OI    LIST,B'01000000'                                    1928 06407000
*               RETURN CODE(SIXTEEN);/* NEW NAME RETURN CODE         */ 06408000
@RF01927 LA    @15,16                                              1929 06409000
         L     @14,@SA00006                                        1929 06410000
         LM    @00,@12,@SA00006+8                                  1929 06411000
         BR    @14                                                 1929 06412000
*             END;                  /* END OF LIST -- NO MATCH       */ 06413000
*         END;                      /* NO PROBLEMS IN REPLY          */ 06414000
*       ELSE                                                       1932 06415000
*         GOTO OPENAAGN;            /* ARE PROBLEMS IN REPLY         */ 06416000
*     END;                          /* NOT IGNORE                    */ 06417000
*   ELSE                                                           1934 06418000
*     RETURN CODE(IGNORVOL);        /* SAID IGNORE                   */ 06419000
@RF01907 LA    @15,4                                               1934 06420000
         L     @14,@SA00006                                        1934 06421000
         LM    @00,@12,@SA00006+8                                  1934 06422000
         BR    @14                                                 1934 06423000
*   END OPENA;                                                     1935 06424000
*                                                                  1936 06425000
*/********************************************************************/ 06426000
*/*                                                                  */ 06427000
*/* OPENB: SUBROUTINE TO PUT OUT MESSAGE                             */ 06428000
*/*                                                                  */ 06429000
*/* INPUT: DSTEPTR POINTING TO ILRDSTBL ENTRY TO USE                 */ 06430000
*/*        SWAP AND DUPLEX INDICATORS                                */ 06431000
*/*                                                                  */ 06432000
*/* PROCESS: CAN BE INVOKED BY: OPENA SUBROUTINE                     */ 06433000
*/*                             MAIN ROUTINE:                        */ 06434000
*/*                1. COLD START AND SPECIFY NON-UNIQUE DUPLEX D.S.  */ 06435000
*/*                2. WARM START- UPON RESPECIFYING COMMON DATA SET  */ 06436000
*/*                    UNIQUE IN ILRDSTBL, BUT MATCHES A NEEDED      */ 06437000
*/*                    LOCAL DATA SET.  ALSO PREVIOUS COMMON HAS     */ 06438000
*/*                    ATTEMPTED THIS IPL TOO.                       */ 06439000
*/*               PUTS OUT MESSAGE IEA918I                           */ 06440000
*/*                                                                  */ 06441000
*/* OUTPUT: MESSAGE IEA918I                                          */ 06442000
*/*                                                                  */ 06443000
*/********************************************************************/ 06444000
*/*OPENB: CHART                                                      */ 06445000
*/*HEADER                                                          1936 06446000
*/*  ILRASRIM                                                      1936 06447000
*/* OPENB: PUT OUT MESSAGE IEA918I BEFORE OPENA CALLED               */ 06448000
*/*OPENB:  E ENTRY TO ISSUE IEA918I                                  */ 06449000
*/*        S ILRIMMSG: ISSUE MESSAGES IEA918I                        */ 06450000
*/*        R RETURN TO CALLER                                        */ 06451000
*/*OPENB: END                                                        */ 06452000
*                                                                  1936 06453000
*OPENB:                                                            1936 06454000
*   PROC;                           /* ISSUE MESSAGE IEA918I         */ 06455000
OPENB    STM   @14,@12,@SA00007                                    1936 06456000
*   MSGID=M918I;                    /* MSG ID                        */ 06457000
         MVC   MSGID(4),@CC02547                                   1937 06458000
*   MSGDATA1=DSTEPTR;               /* DSNAME                        */ 06459000
         ST    DSTEPTR,MSGDATA1                                    1938 06460000
*   IF SWAPSW=ON THEN                                              1939 06461000
         TM    SWAPSW,B'00001000'                                  1939 06462000
         BNO   @RF01939                                            1939 06463000
*     FLAGS=SWAPEQ;                 /* SWAP IN MESSAGE               */ 06464000
         MVI   FLAGS,X'40'                                         1940 06465000
*   ELSE                                                           1941 06466000
*     DO;                           /* NOT SWAP                      */ 06467000
         B     @RC01939                                            1941 06468000
@RF01939 DS    0H                                                  1942 06469000
*       IF DUPLEXSW=ON THEN                                        1942 06470000
         TM    DUPLEXSW,B'00000100'                                1942 06471000
         BNO   @RF01942                                            1942 06472000
*         FLAGS=DUPEQ;              /* DUPLEX IN MESSAGE             */ 06473000
         MVI   FLAGS,X'20'                                         1943 06474000
*       ELSE                                                       1944 06475000
*         FLAGS=PAGEQ;              /* PAGE IN MESSAGE               */ 06476000
         B     @RC01942                                            1944 06477000
@RF01942 MVI   FLAGS,X'80'                                         1944 06478000
*     END;                          /* NOT SWAP                      */ 06479000
@RC01942 DS    0H                                                  1946 06480000
*   R1=ADDR(MSGPL);                 /* PARM TO ILRIMMSG              */ 06481000
@RC01939 LA    R1,MSGPL                                            1946 06482000
*   CALL ILRIMMSG;                  /* MESSAGE MODULE                */ 06483000
         L     @15,@CV02592                                        1947 06484000
         BALR  @14,@15                                             1947 06485000
*   END OPENB;                                                     1948 06486000
@EL00007 DS    0H                                                  1948 06487000
@EF00007 DS    0H                                                  1948 06488000
@ER00007 LM    @14,@12,@SA00007                                    1948 06489000
         BR    @14                                                 1948 06490000
*                                                                  1949 06491000
*/****************************************************************** */ 06492000
*/*                                                                  */ 06493000
*/* TPARPATS: SUBROUTINE TO FILL IN ILRTPARB ENTRY WITH OPEN         */ 06494000
*/*           INFORMATION AND INITIALIZE ILRPAT FOR DATA SET         */ 06495000
*/*                                                                  */ 06496000
*/* INPUT: TPAEPTR POINTING TO ILRTPAR ENTRY TO USE                  */ 06497000
*/*        RETURN PARAMETER LIST FROM ILROPS00                       */ 06498000
*/*        DSTEPTR POINTS TO DUPLEX ENTRY OF ILRDSTBL, IF DUPLEX D.S.*/ 06499000
*/*                                                                  */ 06500000
*/* PROCESS: PUT INFORMATION ABOUT THE DATA SET IN ILRTPARB ENTRY.   */ 06501000
*/*          VERIFY SOME INFORMATION IF DATA SET USED PREVIOUSLY AND */ 06502000
*/*          ISSUE MESSAGE RELATING TO PROBLEMS.  GETMAIN AND        */ 06503000
*/*          INITIALIZE ILRPAT FOR THE DATA SET.  UPDATE FLAGS IN    */ 06504000
*/*          ILRTPARB ENTRY.                                         */ 06505000
*/*                                                                  */ 06506000
*/* OUTPUT: COMPLETED ILRTPARB ENTRY                                 */ 06507000
*/*         INITIALIZED ILRPAT FOR THE ENTRY                         */ 06508000
*/*         IF ERROR, A NON-ZERO RETURN CODE AND NONE OF THE ABOVE   */ 06509000
*/*                                                                  */ 06510000
*/********************************************************************/ 06511000
*/*TPARPATS: CHART                                                   */ 06512000
*/*HEADER                                                          1949 06513000
*/*  ILRASRIM                                                      1949 06514000
*/* TPARPATS: FILL IN ILRTPARB ENTRY AND ILRPAT FOR A DATA SET       */ 06515000
*/*TPARPATS: E ENTRY TO DO ILRTPARB ENTRY AND BUILD PAT              */ 06516000
*/*          P PUT DATA SET INFO INTO ILRTPARB ENTRY                 */ 06517000
*/*          N SCAN HARDCODED DEVTAB FOR PCT FOR THIS DEVICE         */ 06518000
*/*          D (YES,,NO,%A1) FOUND DEVICE INFO(PCT)?                 */ 06519000
*/*          N CHECK SLOTS OF PREVIOUS PLPA, DUPLEX, OR LOCAL D.S.   */ 06520000
*/*          D (NO,,YES,%A2) NO NEED TO CHECK SLOTS OR SLOTS O.K.?   */ 06521000
*/*%A1:      S ILRIMMSG: ISSUE MESSAGE IEA921I                       */ 06522000
*/*          P (,%A4) RETURN CODE IS 4                               */ 06523000
*/*%A2:      P PUT NUMBER OF SLOTS IN TPARB ENTRY                    */ 06524000
*/*          P CALCULATE SIZE OF ILRPAT                              */ 06525000
*/*          L UNCONDITIONAL GETMAIN FOR PAT                         */ 06526000
*/*          P ZERO AND FILL IN PAT HEADER                           */ 06527000
*/*          P INITIALIZE CYLINDER MAPS IN PAT                       */ 06528000
*/*          P INCREASE ACTIVE DATA SET COUNT                        */ 06529000
*/*          P VALIDATE ENTRY                                        */ 06530000
*/*          D (YES,,NO,%A3) IS NOT PREVIOUSLY USED DATA SET?        */ 06531000
*/*          P MARK ENTRY AS SPECIFIED BY PARAMETERS                 */ 06532000
*/*%A3:      P RETURN CODE 0                                         */ 06533000
*/*%A4:      R RETURN                                                */ 06534000
*/*TPARPATS: END                                                     */ 06535000
*                                                                  1949 06536000
*TPARPATS:                                                         1949 06537000
*   PROC;                           /* FILL IN TPAE & BUILD PAT      */ 06538000
TPARPATS STM   @14,@12,@SA00008                                    1949 06539000
*   TPAEIORB=RTNIORBP;              /* IORB POINTER                  */ 06540000
         L     @08,TPAEPTR                                         1950 06541000
         LA    @06,PARMDSN                                         1950 06542000
         L     @00,RTNIORBP(,@06)                                  1950 06543000
         ST    @00,TPAEIORB(,@08)                                  1950 06544000
*   TPAEEDB=RTNEDBP;                /* EDB POINTER                   */ 06545000
         L     @00,RTNEDBP(,@06)                                   1951 06546000
         ST    @00,TPAEEDB(,@08)                                   1951 06547000
*   TPAEUCB=RTNUCBP;                /* UCB POINTER                   */ 06548000
         L     @00,RTNUCBP(,@06)                                   1952 06549000
         ST    @00,TPAEUCB(,@08)                                   1952 06550000
*   TPAETYPE=DEVTYP;                /* DEVICE TYPE                   */ 06551000
         MVC   TPAETYPE(2,@08),DEVTYP(@06)                         1953 06552000
*   PCTPTR=ADDR(DVTENT);            /* 1ST PCT IN DEVTAB             */ 06553000
         LA    @08,DVTENT                                          1954 06554000
         ST    @08,PCTPTR                                          1954 06555000
*   COUNT=ONE;                      /* NUMBER OF PCTS TO SEARCH      */ 06556000
         MVC   COUNT(2),@CH00059                                   1955 06557000
*   DO WHILE COUNT<=DVTHEC&PCTDTYPX^=TPAETYPE;/* ALL OR FIND DEV TYPE*/ 06558000
         B     @DE01956                                            1956 06559000
@DL01956 DS    0H                                                  1957 06560000
*     PCTPTR=PCTPTR+DVTLNG(COUNT);  /* NEXT DEVTAB ENTRY (PCT)       */ 06561000
         LH    @08,COUNT                                           1957 06562000
         LR    @06,@08                                             1957 06563000
         SLA   @06,2                                               1957 06564000
         L     @00,PCTPTR                                          1957 06565000
         AL    @00,DVTLNG-4(@06)                                   1957 06566000
         ST    @00,PCTPTR                                          1957 06567000
*     COUNT=COUNT+ONE;              /* LOOKED AT ONE DEVICE          */ 06568000
         LA    @08,1(,@08)                                         1958 06569000
         STH   @08,COUNT                                           1958 06570000
*   END;                            /* ALL OR FIND DEVICE TYPE       */ 06571000
@DE01956 LH    @08,COUNT                                           1959 06572000
         CH    @08,DVTHEC                                          1959 06573000
         BH    @DC01956                                            1959 06574000
         L     @08,PCTPTR                                          1959 06575000
         L     @06,TPAEPTR                                         1959 06576000
         CLC   PCTDTYPX(2,@08),TPAETYPE(@06)                       1959 06577000
         BNE   @DL01956                                            1959 06578000
@DC01956 DS    0H                                                  1960 06579000
*   IF COUNT>DVTHEC|                /* PROBLEMS-NOT VALID DEVICE TYPE*/ 06580000
*       (TPAEPRVI=ON&TPAESZSL^=SLOTNBR) THEN                       1960 06581000
         LH    @08,COUNT                                           1960 06582000
         CH    @08,DVTHEC                                          1960 06583000
         BH    @RT01960                                            1960 06584000
         L     @08,TPAEPTR                                         1960 06585000
         TM    TPAEPRVI(@08),B'01000000'                           1960 06586000
         BNO   @RF01960                                            1960 06587000
         LA    @06,PARMDSN                                         1960 06588000
         CLC   TPAESZSL(4,@08),SLOTNBR(@06)                        1960 06589000
         BE    @RF01960                                            1960 06590000
@RT01960 DS    0H                                                  1961 06591000
*     DO;                           /* OR SLOTS NOT SAME             */ 06592000
*       IF DUPLEXSW=ON THEN                                        1962 06593000
         TM    DUPLEXSW,B'00000100'                                1962 06594000
         BNO   @RF01962                                            1962 06595000
*         MSGDATA1=ADDR(DSTDSN);    /* NOT IN TPARB                  */ 06596000
         ST    DSTEPTR,MSGDATA1                                    1963 06597000
*       ELSE                                                       1964 06598000
*         MSGDATA1=ADDR(TPAEDSN);   /* NAME HAS BEEN PUT IN TPARB    */ 06599000
         B     @RC01962                                            1964 06600000
@RF01962 L     @08,TPAEPTR                                         1964 06601000
         LA    @08,TPAEDSN(,@08)                                   1964 06602000
         ST    @08,MSGDATA1                                        1964 06603000
*       MSGID=M921I;                /* DATA SET INVALID              */ 06604000
@RC01962 MVC   MSGID(4),@CC02551                                   1965 06605000
*       R1=ADDR(MSGPL);             /* PARM TO MESSAGE MODULE        */ 06606000
         LA    R1,MSGPL                                            1966 06607000
*       CALL ILRIMMSG;              /* MESSAGE MODULE                */ 06608000
         L     @15,@CV02592                                        1967 06609000
         BALR  @14,@15                                             1967 06610000
*       RETURN CODE(4);             /* FLAG AS ERROR                 */ 06611000
         LA    @15,4                                               1968 06612000
         L     @14,@SA00008                                        1968 06613000
         LM    @00,@12,@SA00008+8                                  1968 06614000
         BR    @14                                                 1968 06615000
*     END;                          /* PROBLEMS                      */ 06616000
*   ELSE                                                           1970 06617000
*     DO;                           /* NO PROBLEMS                   */ 06618000
@RF01960 DS    0H                                                  1971 06619000
*       TPAEPCT=PCTPTR;             /* POINTER TO MATCHING DEVTAB ENT*/ 06620000
         L     @06,PCTPTR                                          1971 06621000
         L     @03,TPAEPTR                                         1971 06622000
         ST    @06,TPAEPCT(,@03)                                   1971 06623000
*       TPAESZSL=SLOTNBR;           /* SIZE IS NUMBER OF SLOTS       */ 06624000
         LA    @15,PARMDSN                                         1972 06625000
         L     @15,SLOTNBR(,@15)                                   1972 06626000
         ST    @15,TPAESZSL(,@03)                                  1972 06627000
*       CYLS=SLOTNBR/PCTCYLSZ;      /* SLOTS/ SLOTS PER CYLINDER     */ 06628000
         LH    @06,PCTCYLSZ(,@06)                                  1973 06629000
         SLR   @14,@14                                             1973 06630000
         DR    @14,@06                                             1973 06631000
         LR    CYLS,@15                                            1973 06632000
*       RFY                                                        1974 06633000
*        (R14,                                                     1974 06634000
*         R15) RSTD;                                               1974 06635000
*       R14=0;                      /* CLEAR EVEN REGISTER           */ 06636000
         SLR   R14,R14                                             1975 06637000
*       R15=PCTCYLSZ;               /* SLOTS PER CYL                 */ 06638000
         LR    R15,@06                                             1976 06639000
*       R1=N32;                     /* BITS IN A WORD                */ 06640000
         LA    R1,32                                               1977 06641000
*       GENERATE REFS(R1,R14,R15) SETS(R14,R15);                   1978 06642000
    DR R14,R1                                                           06643000
*       CYLMW=R15;                  /* WORDS NEEDED TO MAP A CYLINDER*/ 06644000
         LR    CYLMW,R15                                           1979 06645000
*       IF R14^=0 THEN                                             1980 06646000
         LTR   R14,R14                                             1980 06647000
         BZ    @RF01980                                            1980 06648000
*         CYLMW=CYLMW+ONE;          /* MAP THE REMAINDER             */ 06649000
         AL    CYLMW,@CF00059                                      1981 06650000
*       RFY                                                        1982 06651000
*        (R14,                                                     1982 06652000
*         R15) UNRSTD;                                             1982 06653000
@RF01980 DS    0H                                                  1983 06654000
*       RFY                                                        1983 06655000
*        (R0) RSTD;                                                1983 06656000
*                                                                  1983 06657000
*/*  LENGTH OF PAT IS PAT HEADER + PATMAP (IN BYTES IN NEAREST DWORD)*/ 06658000
*                                                                  1984 06659000
*       R0=LENGTH(PATHDR)+((CYLS*FOUR*CYLMW+SEVEN)/EIGHT)*EIGHT;   1984 06660000
         LR    @05,CYLS                                            1984 06661000
         SLA   @05,2                                               1984 06662000
         MR    @04,CYLMW                                           1984 06663000
         LR    @14,@05                                             1984 06664000
         AL    @14,@CF00061                                        1984 06665000
         SRDA  @14,32                                              1984 06666000
         D     @14,@CF00056                                        1984 06667000
         SLA   @15,3                                               1984 06668000
         AL    @15,@CF00111                                        1984 06669000
         LR    R0,@15                                              1984 06670000
*       TPAEPATB=R0;                /* PUT LENGTH OF PAT IN TPARB    */ 06671000
         L     @06,TPAEPTR                                         1985 06672000
         ST    R0,TPAEPATB(,@06)                                   1985 06673000
*       DO;                         /* GETMAIN (RU) LV(R0)         1986 06674000
*                                      SP(SQASPID)                   */ 06675000
*         RESPECIFY                                                1987 06676000
*          (GPR01F,                                                1987 06677000
*           GPR15F,                                                1987 06678000
*           GPR00F) RESTRICTED;                                    1987 06679000
*         GPR01F=0;                 /* REG 1 MUST BE ZERO            */ 06680000
         SLR   GPR01F,GPR01F                                       1988 06681000
*         GPR15F=2;                 /* RU-TYPE GETMAIN               */ 06682000
         LA    GPR15F,2                                            1989 06683000
*         GPR00F=R0;                /* LENGTH REQUESTED              */ 06684000
*         GPR15F=GPR15F|((SQASPID)*256);/* SP IN BYTE 2              */ 06685000
         O     GPR15F,@CF02881                                     1991 06686000
*         SVC(120);                 /* RC/RU-FORM OF GETMAIN         */ 06687000
         SVC   120                                                 1992 06688000
*         RESPECIFY                                                1993 06689000
*          (GPR01F,                                                1993 06690000
*           GPR15F,                                                1993 06691000
*           GPR00F) UNRESTRICTED;                                  1993 06692000
*       END;                        /* GETMAIN (RU) LV(R0)         1994 06693000
*                                      SP(SQASPID)                   */ 06694000
*       RFY                                                        1995 06695000
*        (R0) UNRSTD;                                              1995 06696000
*       TPAEPATP=R1;                /* POINTER TO PAT                */ 06697000
         L     @06,TPAEPTR                                         1996 06698000
         ST    R1,TPAEPATP(,@06)                                   1996 06699000
*       PATPTR=TPAEPATP;            /* INIT PAT ADDRESS              */ 06700000
         L     @03,TPAEPTR                                         1997 06701000
         L     @03,TPAEPATP(,@03)                                  1997 06702000
         ST    @03,PATPTR                                          1997 06703000
*       PATHDR=''B;                 /* ZERO PAT HEADER               */ 06704000
         XC    PATHDR(16,@03),PATHDR(@03)                          1998 06705000
*       PATIDENT=PATID;             /* PAT IDENTIFIER                */ 06706000
         MVC   PATIDENT(4,@03),@CC02479                            1999 06707000
*       PATCYLNO=CYLS;              /* NUMBER OF CYLINDERS           */ 06708000
         STH   CYLS,PATCYLNO(,@03)                                 2000 06709000
*       PATCYLSZ=PCTCYLSZ;          /* SLOTS IN CYLINDER             */ 06710000
         L     @15,PCTPTR                                          2001 06711000
         LH    @00,PCTCYLSZ(,@15)                                  2001 06712000
         STH   @00,PATCYLSZ(,@03)                                  2001 06713000
*       PATCYLMW=CYLMW;             /* NUMBER OF WORDS TO MAP A CYL  */ 06714000
         STH   CYLMW,PATCYLMW(,@03)                                2002 06715000
*/*    INITIALIZE THE PAT MAP AREA                                   */ 06716000
*                                                                  2003 06717000
*       PATCYLA=ADDR(PATCYLS(1));   /* ADDRESS OF FIRST MAP          */ 06718000
         LA    PATCYLA,PATCYLS(,@03)                               2003 06719000
*       ENDPAT=PATPTR+TPAEPATB;     /* END OF PAT                    */ 06720000
         AL    @03,TPAEPATB(,@06)                                  2004 06721000
         LR    ENDPAT,@03                                          2004 06722000
*       DO WHILE PATCYLA^=ENDPAT;   /* DO ALL OF PAT MAP             */ 06723000
         B     @DE02005                                            2005 06724000
@DL02005 DS    0H                                                  2006 06725000
*         PATCYLMP=PCTDMASK;        /* COPY IN 8 BYTE MASK FOR DEVICE*/ 06726000
         L     @06,PCTPTR                                          2006 06727000
         MVC   PATCYLMP(8,PATCYLA),PCTDMASK(@06)                   2006 06728000
*         PATCYLA=PATCYLA+LENGTH(PATCYLMP);/* NEXT 8 BYTES           */ 06729000
         AL    PATCYLA,@CF00056                                    2007 06730000
*       END;                        /* DO ALL OF PAT MAP             */ 06731000
@DE02005 CR    PATCYLA,ENDPAT                                      2008 06732000
         BNE   @DL02005                                            2008 06733000
*       TPARNPGS=TPARNPGS+ONE;      /* ONE MORE ACTIVE DATA SET      */ 06734000
         L     @08,TPARPTR                                         2009 06735000
         LA    @06,1                                               2009 06736000
         AL    @06,TPARNPGS(,@08)                                  2009 06737000
         ST    @06,TPARNPGS(,@08)                                  2009 06738000
*       TPAEVALD=YES;               /* DATA SET IS VALID             */ 06739000
         L     @08,TPAEPTR                                         2010 06740000
         OI    TPAEVALD(@08),B'00001000'                           2010 06741000
*       IF TPAEPRVI=OFF THEN                                       2011 06742000
         TM    TPAEPRVI(@08),B'01000000'                           2011 06743000
         BNZ   @RF02011                                            2011 06744000
*         TPAEPARM=ON;              /* IF NOT LAST IPL , THIS IPL    */ 06745000
         OI    TPAEPARM(@08),B'10000000'                           2012 06746000
*       ELSE                                                       2013 06747000
*         ;                         /* LAST IPL                      */ 06748000
@RF02011 DS    0H                                                  2014 06749000
*       RETURN CODE(0);             /* RETURN SUCCESSFULLY           */ 06750000
         SLR   @15,@15                                             2014 06751000
         L     @14,@SA00008                                        2014 06752000
         LM    @00,@12,@SA00008+8                                  2014 06753000
         BR    @14                                                 2014 06754000
*     END;                          /* NO PROBLEMS                   */ 06755000
*   END TPARPATS;                                                  2016 06756000
*                                                                  2017 06757000
*/****************************************************************** */ 06758000
*/*                                                                  */ 06759000
*/* LOCALN: SUBROUTINE TO OPEN NEEDED LOCAL PAGE DATA SETS ON A WARM */ 06760000
*/*         START                                                    */ 06761000
*/*                                                                  */ 06762000
*/* INPUT: PARAMETER LIST FILLED IN FOR ROUTINE ILROPS00             */ 06763000
*/*                                                                  */ 06764000
*/* PROCESS: INVOKED DURING NEEDLOCL AND OPENLOCL PROCESSING         */ 06765000
*/*          CALL OPEN SUBROUTINE AND PROCESS THE RETURN CODES       */ 06766000
*/*          ACCORDING TO NEEDED LOCALS REQUIREMENTS.                */ 06767000
*/*                                                                  */ 06768000
*/* OUTPUT: EITHER DATA SET OPENED SATISFACTORILY OR IPL IS NOW A    */ 06769000
*/*         QUICK(CVIO) START                                        */ 06770000
*/*                                                                  */ 06771000
*/********************************************************************/ 06772000
*/*LOCALN: CHART                                                     */ 06773000
*/*HEADER                                                          2017 06774000
*/*  ILRASRIM                                                      2017 06775000
*/* LOCALN: MOUNT OR OPEN NEEDED LOCALS ON WARM START                */ 06776000
*/*LOCALN: E ENTRY TO MOUNT OR OPEN NEEDED LOCALS                    */ 06777000
*/*%A1:    S OPEN: COMMON SUBROUTINE TO CALL ILROPS00                */ 06778000
*/*        D (NO,,YES,%A3) SUCCESSFUL?                               */ 06779000
*/*        D (YES,,NO,%A2) MOUNT FAIL?                               */ 06780000
*/*        S ILRIMMSG: ISSUE MESSAGE IEA925D                         */ 06781000
*/*        D (YES,,NO,%A1) OPERATOR REPLIED 'IGNORE'?                */ 06782000
*/*%A2:    N LOCATE FAILED OR 'IGNORE' TO MOUNT FAIL                 */ 06783000
*/*        P CHANGE IPL INDICATORS IN IHANVT                         */ 06784000
*/*        S ILRIMMSG: ISSUE MESSAGE IEA930I(FORCE CVIO)             */ 06785000
*/*%A3:    R RETURN, SUCCESSFUL OR CVIO                              */ 06786000
*/*LOCALN: END                                                       */ 06787000
*                                                                  2017 06788000
*LOCALN:                                                           2017 06789000
*   PROC;                           /* OPEN NEEDED LOCALS            */ 06790000
LOCALN   STM   @14,@12,@SA00009                                    2017 06791000
*REDOL:                                                            2018 06792000
*   PARMDSN=TPAEDSN;                /* DATA SET NAME (OVERLAID BY  2018 06793000
*                                      OPS)                          */ 06794000
REDOL    L     @08,TPAEPTR                                         2018 06795000
         MVC   PARMDSN(44),TPAEDSN(@08)                            2018 06796000
*   RFY                                                            2019 06797000
*     R15 RSTD;                                                    2019 06798000
*   CALL OPEN;                      /* OPEN SUBROUTINE               */ 06799000
         BAL   @14,OPEN                                            2020 06800000
*   IF R15^=ZERO THEN                                              2021 06801000
         LTR   R15,R15                                             2021 06802000
         BZ    @RF02021                                            2021 06803000
*     DO;                           /* NOT SUCCESSFUL?               */ 06804000
*       IF R15=NOVOLMNT THEN                                       2023 06805000
         C     R15,@CF00056                                        2023 06806000
         BNE   @RF02023                                            2023 06807000
*         DO;                       /* MOUNT FAILED?                 */ 06808000
*           RFY                                                    2025 06809000
*             R15 UNRSTD;                                          2025 06810000
*           MSGID=M925D;            /* ASK TO MOUNT                  */ 06811000
         MVC   MSGID(4),@CC02559                                   2026 06812000
*           MSGDATA1=ADDR(VOLSER);  /* VOL SER                       */ 06813000
         LA    @08,PARMDSN                                         2027 06814000
         LA    @08,VOLSER(,@08)                                    2027 06815000
         ST    @08,MSGDATA1                                        2027 06816000
*           R1=ADDR(MSGPL);         /* PARM TO ILRIMMSG              */ 06817000
         LA    R1,MSGPL                                            2028 06818000
*           CALL ILRIMMSG;          /* MESSAGE MODULE                */ 06819000
         L     @15,@CV02592                                        2029 06820000
         BALR  @14,@15                                             2029 06821000
*           IF R1->MSGBUF(1:LENGTH(IGNORE))^=IGNORE THEN           2030 06822000
         CLC   MSGBUF(6,R1),@CC02477                               2030 06823000
         BNE   @RT02030                                            2030 06824000
*             GOTO REDOL;                                          2031 06825000
*           ELSE                                                   2032 06826000
*             ;                     /* OPER SAID IGNORE              */ 06827000
*         END;                      /* MOUNT FAILED                  */ 06828000
*       ELSE                                                       2034 06829000
*         ;                         /* LOCATE FAILED                 */ 06830000
*                                                                  2034 06831000
@RF02023 DS    0H                                                  2035 06832000
*       /*************************************************************/ 06833000
*       /*                                                           */ 06834000
*       /* EITHER OPER SAID IGNORE OR LOCATE FAILED , FORCE CVIO     */ 06835000
*       /*                                                           */ 06836000
*       /*************************************************************/ 06837000
*                                                                  2035 06838000
*       MSGID=M930I;                /* FORCE CVIO                    */ 06839000
         MVC   MSGID(4),@CC02565                                   2035 06840000
*       R1=ADDR(MSGPL);             /* PARM TO ILRIMMSG              */ 06841000
         LA    R1,MSGPL                                            2036 06842000
*       CALL ILRIMMSG;              /* MESSAGE MODULE                */ 06843000
         L     @15,@CV02592                                        2037 06844000
         BALR  @14,@15                                             2037 06845000
*       NVTFLWS=NO;                 /* NOT WARM START NOW            */ 06846000
         L     @08,NVTPTR                                          2038 06847000
         NI    NVTFLWS(@08),B'11111011'                            2038 06848000
*     END;                          /* NOT SUCCESSFUL                */ 06849000
*   ELSE                                                           2040 06850000
*     ;                             /* SUCCESSFUL                    */ 06851000
@RF02021 DS    0H                                                  2041 06852000
*   END LOCALN;                                                    2041 06853000
@EL00009 DS    0H                                                  2041 06854000
@EF00009 DS    0H                                                  2041 06855000
@ER00009 LM    @14,@12,@SA00009                                    2041 06856000
         BR    @14                                                 2041 06857000
*                                                                  2042 06858000
*/********************************************************************/ 06859000
*/*                                                                  */ 06860000
*/* BADDUP: SUBROUTINE TO PUT OUT MESSAGE IEA942I AND                */ 06861000
*/*         SHUT OFF DUPLEXING THIS IPL                              */ 06862000
*/*                                                                  */ 06863000
*/* INPUT: BADDS SWITCH                                              */ 06864000
*/*                                                                  */ 06865000
*/* PROCESS: TURN OFF DUPLEXING IN ASMVT.  MARK TPARB ENTRY TO BE    */ 06866000
*/*          SHIPPED THIS IPL.  ON COLD START, REMOVE DUPLEX NAME    */ 06867000
*/*          FROM ILRDSTBL, SO IT IS NOT USED LATER WHEN CHECKING    */ 06868000
*/*          FOR DUPLICATES. PUT OUT MESSAGE TO INFORM OPERATOR OF   */ 06869000
*/*          ACTION.                                                 */ 06870000
*/*                                                                  */ 06871000
*/* OUTPUT: DUPLEXING OFF FOR THIS IPL                               */ 06872000
*/*         MESSAGE IEA942I ISSUED                                   */ 06873000
*/*                                                                  */ 06874000
*/********************************************************************/ 06875000
*                                                                  2042 06876000
*BADDUP:                                                           2042 06877000
*   PROC;                                                          2042 06878000
BADDUP   STM   @14,@12,@SA00010                                    2042 06879000
*   IF BADDS=YES THEN                                              2043 06880000
         TM    BADDS,B'00000001'                                   2043 06881000
         BNO   @RF02043                                            2043 06882000
*     MSGDATA1=ADDR(NODATST);       /* DIDNOT GET GOOD DS            */ 06883000
         LA    @08,NODATST                                         2044 06884000
         ST    @08,MSGDATA1                                        2044 06885000
*   ELSE                                                           2045 06886000
*     MSGDATA1=ADDR(BADCLCK);       /* BAD TIMESTAMP                 */ 06887000
         B     @RC02043                                            2045 06888000
@RF02043 LA    @08,BADCLCK                                         2045 06889000
         ST    @08,MSGDATA1                                        2045 06890000
*   TPAESKIP=ON;                    /* SKIP TPARB ENTRY              */ 06891000
@RC02043 L     @08,TPAEPTR                                         2046 06892000
         OI    TPAESKIP(@08),B'00010000'                           2046 06893000
*   ASMDUPLX=OFF;                   /* NO LONGER DUPLEXING           */ 06894000
         L     @08,CVTPTR                                          2047 06895000
         L     @08,ASMVTPTR(,@08)                                  2047 06896000
         NI    ASMDUPLX(@08),B'01111111'                           2047 06897000
*   IF NVTFLQS=OFF THEN                                            2048 06898000
         L     @08,NVTPTR                                          2048 06899000
         TM    NVTFLQS(@08),B'00001000'                            2048 06900000
         BNZ   @RF02048                                            2048 06901000
*     DSTDSN=''B;                   /* WILL NEVER USE DATA SET       */ 06902000
         XC    DSTDSN(44,DSTEPTR),DSTDSN(DSTEPTR)                  2049 06903000
*   ELSE                                                           2050 06904000
*     ;                             /* QUICK OR WARM                 */ 06905000
@RF02048 DS    0H                                                  2051 06906000
*   MSGID=M942I;                    /* NO MORE DUPLEX                */ 06907000
         MVC   MSGID(4),@CC02579                                   2051 06908000
*   R1=ADDR(MSGPL);                 /* PARM TO ILRIMMSG              */ 06909000
         LA    R1,MSGPL                                            2052 06910000
*   CALL ILRIMMSG;                  /* MESSAGE MODULE                */ 06911000
         L     @15,@CV02592                                        2053 06912000
         BALR  @14,@15                                             2053 06913000
*   END BADDUP;                                                    2054 06914000
@EL00010 DS    0H                                                  2054 06915000
@EF00010 DS    0H                                                  2054 06916000
@ER00010 LM    @14,@12,@SA00010                                    2054 06917000
         BR    @14                                                 2054 06918000
*                                                                  2055 06919000
*/********************************************************************/ 06920000
*/*                                                                  */ 06921000
*/* COMMCOLD: SUBROUTINE TO FORCE A COLD START AFTER ILRTPARB AND    */ 06922000
*/*           ILRQSRCD ARE ALREADY INITIALIZED, BUT LOCALS HAVE NOT  */ 06923000
*/*           BEEN PROCESSED.                                        */ 06924000
*/*                                                                  */ 06925000
*/* INPUT: NVT                                                       */ 06926000
*/*        ILRTPARB                                                  */ 06927000
*/*        ILRQSRCD                                                  */ 06928000
*/*                                                                  */ 06929000
*/* PROCESS: ISSUE MESSAGE IEA929I. REMOVE ANY NEEDED LOCALS IN      */ 06930000
*/*          ILRTPARB AND RESET TPARUSE. REINITIALIZE ILRQSRCD       */ 06931000
*/*          HEADER. UPDATE NVT FLAGS AND PLPA RANGE FIELDS.         */ 06932000
*/*                                                                  */ 06933000
*/* OUTPUT: UPDATED NVT, ILRTPARB, ILRQSRCD                          */ 06934000
*/*         MESSAGE IEA929I                                          */ 06935000
*/********************************************************************/ 06936000
*/*COMMCOLD: CHART                                                   */ 06937000
*/*HEADER                                                          2055 06938000
*/*  ILRASRIM                                                      2055 06939000
*/* COMMCOLD: FORCE COLD START                                       */ 06940000
*/*COMMCOLD: E ENTRY TO FORCE COLD START                             */ 06941000
*/*          S ILRIMMSG: FORCE COLD START                            */ 06942000
*/*          D (YES,,NO,%A1) LOCALS IN TPARB?                        */ 06943000
*/*          P ZERO TPARB LOCAL ENTRIES                              */ 06944000
*/*          P RESET TPARB ENTRIES COUNT                             */ 06945000
*/*%A1:      P REINIT QSR HEADER                                     */ 06946000
*/*          P REINIT PLPA INFO IN QSR                               */ 06947000
*/*          P REINIT NVT IPL FLAGS                                  */ 06948000
*/*COMMCOLD: END                                                     */ 06949000
*                                                                  2055 06950000
*COMMCOLD:                                                         2055 06951000
*   PROC;                                                          2055 06952000
COMMCOLD STM   @14,@12,@SA00011                                    2055 06953000
*   MSGID=M929I;                    /* COLD START FORCED             */ 06954000
         MVC   MSGID(4),@CC02563                                   2056 06955000
*   R1=ADDR(MSGPL);                 /* PARM TO ILRIMMSG              */ 06956000
         LA    R1,MSGPL                                            2057 06957000
*   CALL ILRIMMSG;                  /* MESSAGE MODULE                */ 06958000
         L     @15,@CV02592                                        2058 06959000
         BALR  @14,@15                                             2058 06960000
*   IF NVTFLWS=YES THEN                                            2059 06961000
         L     @08,NVTPTR                                          2059 06962000
         TM    NVTFLWS(@08),B'00000100'                            2059 06963000
         BNO   @RF02059                                            2059 06964000
*     DO;                           /* LOCALS IN TPARB?              */ 06965000
*       RFY                                                        2061 06966000
*        (R0,                                                      2061 06967000
*         R14,                                                     2061 06968000
*         R15) RSTD;                                               2061 06969000
*                                                                  2061 06970000
*/*                   ZERO ALL LOCAL ENTRIES FROM LAST IPL           */ 06971000
*                                                                  2062 06972000
*       R0=LOCTPTR;                 /* 1ST LOCAL IN ILRTPARB 1ST     */ 06973000
         L     R0,LOCTPTR                                          2062 06974000
*       R1=(TPARUSE-INITUSE)*(LENGTH(TPARENT));/* LENGTH             */ 06975000
         L     @08,TPARPTR                                         2063 06976000
         L     R1,TPARUSE(,@08)                                    2063 06977000
         SL    R1,@CF00092                                         2063 06978000
         MH    R1,@CH00073                                         2063 06979000
*       R15=ZERO;                                                  2064 06980000
         SLR   R15,R15                                             2064 06981000
*       MVCL(R0,R14);               /* ZEROES ALL PREVIOUS LOCALS    */ 06982000
         MVCL  R0,R14                                              2065 06983000
*       RFY                                                        2066 06984000
*        (R0,                                                      2066 06985000
*         R14,                                                     2066 06986000
*         R15) UNRSTD;                                             2066 06987000
*       TPARUSE=INITUSE;            /* ENTRIES IN USE NOW            */ 06988000
         L     @08,TPARPTR                                         2067 06989000
         MVC   TPARUSE(4,@08),@CF00092                             2067 06990000
*     END;                          /* LOCALS IN TPARB               */ 06991000
*   ELSE                                                           2069 06992000
*     ;                             /* COLD OR QUICK START           */ 06993000
@RF02059 DS    0H                                                  2070 06994000
*   QSRHDR=''B;                     /* ZERO HEADER                   */ 06995000
         L     @08,QSRPTR                                          2070 06996000
         XC    QSRHDR(32,@08),QSRHDR(@08)                          2070 06997000
*   QSRIDNT=QSRID;                  /* PUT IN IDENTIFIER             */ 06998000
         MVC   QSRIDNT(8,@08),@CC02483                             2071 06999000
*   NVTLPALO=''B;                   /* LPA NOT WRITTEN               */ 07000000
         SLR   @08,@08                                             2072 07001000
         L     @15,NVTPTR                                          2072 07002000
         ST    @08,NVTLPALO(,@15)                                  2072 07003000
*   NVTLPAND=''B;                   /* HIGH RANGE                    */ 07004000
         ST    @08,NVTLPAND(,@15)                                  2073 07005000
*   NVTLPAHA=''B;                   /* NO HASH VALUE                 */ 07006000
         ST    @08,NVTLPAHA(,@15)                                  2074 07007000
*   NVTFLQS=NO;                     /* FORCED COLD START             */ 07008000
*   NVTFLWS=NO;                     /* FORCED COLD START             */ 07009000
         NI    NVTFLQS(@15),B'11110011'                            2076 07010000
*   END COMMCOLD;                                                  2077 07011000
@EL00011 DS    0H                                                  2077 07012000
@EF00011 DS    0H                                                  2077 07013000
@ER00011 LM    @14,@12,@SA00011                                    2077 07014000
         BR    @14                                                 2077 07015000
*                                                                  2078 07016000
*/********************************************************************/ 07017000
*/*                                                                  */ 07018000
*/* MARKPAT: MARK ONE BIT ON IN A ILRPAT                             */ 07019000
*/*                                                                  */ 07020000
*/* INPUT: PATPTR AND RELATIVE SLOT IN AREA CALLED SLOT              */ 07021000
*/*                                                                  */ 07022000
*/* PROCESS: CALCULATE THE CORRECT PAT MAP WORD AND THE RELATIVE     */ 07023000
*/*          BIT IN THAT WORD. USE MACRO ILRBITMM TO TURN THE BIT ON */ 07024000
*/*                                                                  */ 07025000
*/* OUTPUT: ONE BIT ON IN THE PAT SPECIFIED                          */ 07026000
*/*                                                                  */ 07027000
*/********************************************************************/ 07028000
*/*MARKPAT: CHART                                                    */ 07029000
*/*HEADER                                                          2078 07030000
*/*  ILRASRIM                                                      2078 07031000
*/* MARKPAT: TURN ON A BIT IN A PAT                                  */ 07032000
*/*MARKPAT: E ENTRY TO MARK A SLOT IN USE                            */ 07033000
*/*         P CALCULATE THE CORRECT CYLINDER MAP                     */ 07034000
*/*         D (NO,,YES,%A1) BIT IN FIRST WORD OF MAP                 */ 07035000
*/*         P MOVE TO THE SECOND WORD                                */ 07036000
*/*         P SUBTRACT ONE WORD OF BITS                              */ 07037000
*/*%A1:     M ILRBITMM THE BIT IN THIS WORD                          */ 07038000
*/*         R RETURN                                                 */ 07039000
*/*MARKPAT: END                                                      */ 07040000
*                                                                  2078 07041000
*MARKPAT:                                                          2078 07042000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               2078 07043000
MARKPAT  DS    0H                                                  2079 07044000
*   RFY                                                            2079 07045000
*    (R14,                                                         2079 07046000
*     R15) RSTD;                                                   2079 07047000
*   SAVER14A=R14;                   /* SAVE RETURN ADDRESS           */ 07048000
         ST    R14,SAVER14A                                        2080 07049000
*   R14=0;                          /* CLEAR EVEN REGISTER           */ 07050000
         SLR   R14,R14                                             2081 07051000
*   R15=SLOT;                       /* RELATIVE SLOT                 */ 07052000
         LR    R15,SLOT                                            2082 07053000
*   R1=PATCYLSZ;                    /* SLOTS PER CYL                 */ 07054000
         L     @06,PATPTR                                          2083 07055000
         LH    R1,PATCYLSZ(,@06)                                   2083 07056000
*   GENERATE REFS(R1,R14,R15) SETS(R14,R15);                       2084 07057000
   DR  R14,R1                                                           07058000
*   R1=ADDR(PATCYLS(R15*PATCYLMW+1));/* CORRECT CYL MAP              */ 07059000
         L     @06,PATPTR                                          2085 07060000
         LR    @05,R15                                             2085 07061000
         MH    @05,PATCYLMW(,@06)                                  2085 07062000
         SLA   @05,2                                               2085 07063000
         LA    R1,PATCYLS(@05,@06)                                 2085 07064000
*   IF R14>=N32 THEN                                               2086 07065000
         LA    @06,32                                              2086 07066000
         CR    R14,@06                                             2086 07067000
         BL    @RF02086                                            2086 07068000
*     DO;                           /* BIGGER THAN A WORD?           */ 07069000
*       R14=R14-N32;                /* REMAINDER OVER ONE WORD       */ 07070000
         SLR   R14,@06                                             2088 07071000
*       R1=R1+FOUR;                 /* POINT TO NEXT WORD            */ 07072000
         AL    R1,@CF00069                                         2089 07073000
*     END;                          /* BIGGER THAN A WORD            */ 07074000
*   ELSE                                                           2091 07075000
*     ;                             /* NOT BIGGER                    */ 07076000
@RF02086 DS    0H                                                  2092 07077000
*   R15=R14;                        /* REMAINDER(DISPLACEMENT) IN REG   07078000
*                                      15                            */ 07079000
         LR    R15,R14                                             2092 07080000
*/*   ILRBITMM INVOCATION                                          2093 07081000
*       BITMAP(R1,ONEWRD)SET(ON,NOMP)BIT(R15)                        */ 07082000
*                                                                  2093 07083000
*   DCL                                                            2093 07084000
*     BITMMCB1 BIT(32) CONSTANT('80000000'X);                      2093 07085000
*   DCL                                                            2094 07086000
*     BITMMWRD FIXED(31) BDY(WORD) BASED(R1);                      2094 07087000
*   DCL                                                            2095 07088000
*     BITMSK31 FIXED(8) CONSTANT(31);                              2095 07089000
*   DCL                                                            2096 07090000
*     BITMMC32 FIXED(8) CONSTANT(32);                              2096 07091000
*   DO;                                                            2097 07092000
*     RFY                                                          2098 07093000
*      (R0,                                                        2098 07094000
*       R1,                                                        2098 07095000
*       R2,                                                        2098 07096000
*       R14,                                                       2098 07097000
*       R15) RSTD;                  /* RESTRICT WORK REGS    @Z40WPWG*/ 07098000
*     R14=BITMMCB1;                 /* BUILD MASK                    */ 07099000
         L     R14,@CF01386                                        2099 07100000
*     GEN(SRL   R14,0(R15));                                       2100 07101000
         SRL   R14,0(R15)                                               07102000
*     BITMMWRD=BITMMWRD|R14;        /* TURN BIT ON                   */ 07103000
         L     @06,BITMMWRD(,R1)                                   2101 07104000
         OR    @06,R14                                             2101 07105000
         ST    @06,BITMMWRD(,R1)                                   2101 07106000
*BITMMX37:                                                         2102 07107000
*     RFY                                                          2102 07108000
*      (R0,                                                        2102 07109000
*       R1,                                                        2102 07110000
*       R2,                                                        2102 07111000
*       R14,                                                       2102 07112000
*       R15) UNRSTD;                /* RELEASE WRK REGS      @Z40WPWG*/ 07113000
BITMMX37 DS    0H                                                  2103 07114000
*   END;                            /* END OF ILRBITMM PROCESSING  2103 07115000
*                                      TURN ON BIT                   */ 07116000
*   RFY                                                            2104 07117000
*     R14 RSTD;                                                    2104 07118000
*   R14=SAVER14A;                   /* RESTORE RETURN ADDRESS        */ 07119000
         L     R14,SAVER14A                                        2105 07120000
*   END MARKPAT;                                                   2106 07121000
@EL00012 DS    0H                                                  2106 07122000
@EF00012 DS    0H                                                  2106 07123000
@ER00012 BR    @14                                                 2106 07124000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 07125000
*     GPR00F FIXED(31) REG(0),                                     2107 07126000
*     GPR01F FIXED(31) REG(1),                                     2107 07127000
*     GPR15F FIXED(31) REG(15),                                    2107 07128000
*     GPR00P PTR(31) REG(0),                                       2107 07129000
*     GPR01P PTR(31) REG(1);                                       2107 07130000
*   DECLARE                         /* COMMON VARIABLES              */ 07131000
*     I256C CHAR(256) BASED,                                       2108 07132000
*     I031F FIXED(31) BASED,                                       2108 07133000
*     I031P PTR(31) BASED,                                         2108 07134000
*     I015F FIXED(15) BASED,                                       2108 07135000
*     I015P PTR(15) BASED,                                         2108 07136000
*     I008P PTR(8) BASED,                                          2108 07137000
*     I001C CHAR(1) BASED;                                         2108 07138000
*   END ILRASRIM                                                   2109 07139000
*                                                                  2109 07140000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 07141000
*/*%INCLUDE SYSLIB  (ILRTPARB)                                       */ 07142000
*/*%INCLUDE SYSLIB  (ILRQSRCD)                                       */ 07143000
*/*%INCLUDE SYSLIB  (ILRASMVT)                                       */ 07144000
*/*%INCLUDE SYSLIB  (IHANVT  )                                       */ 07145000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 07146000
*/*%INCLUDE SYSLIB  (IEAPPNIP)                                       */ 07147000
*/*%INCLUDE SYSLIB  (IHAXPTE )                                       */ 07148000
*/*%INCLUDE SYSLIB  (ILRPCT  )                                       */ 07149000
*/*%INCLUDE SYSLIB  (ILRPAT  )                                       */ 07150000
*/*%INCLUDE SYSLIB  (ILRPART )                                       */ 07151000
*/*%INCLUDE SYSLIB  (ILRIORB )                                       */ 07152000
*/*%INCLUDE SYSLIB  (ILRSDCT )                                       */ 07153000
*/*%INCLUDE SYSLIB  (ILRSART )                                       */ 07154000
*/*%INCLUDE SYSLIB  (ILRSAT  )                                       */ 07155000
*/*%INCLUDE SYSLIB  (ILRSCCW )                                       */ 07156000
*/*%INCLUDE SYSLIB  (ILRLGVT )                                       */ 07157000
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */ 07158000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 07159000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 07160000
*/*%INCLUDE SYSLIB  (ILRDVTAB)                                       */ 07161000
*                                                                  2109 07162000
*       ;                                                          2109 07163000
@DATA    DS    0H                                                       07164000
@CH00063 DC    H'24'                                                    07165000
@SM02904 MVC   DSTDSN(0,DSTEPTR),PTDSN(@06)                             07166000
@SM02915 MVC   DSTDSN(0,@15),PTDSN(@07)                                 07167000
@SM02917 MVC   DSTDSN(0,DSTEPTR),PTDSN(@02)                             07168000
         DS    0F                                                       07169000
@SA00001 DS    18F                                                      07170000
@SA00003 DS    15F                                                      07171000
@SA00005 DS    15F                                                      07172000
@SA00006 DS    15F                                                      07173000
@SA00008 DS    15F                                                      07174000
@SA00009 DS    15F                                                      07175000
@SA00011 DS    0F                                                       07176000
@SA00010 DS    0F                                                       07177000
@SA00007 DS    0F                                                       07178000
         DS    15F                                                      07179000
@TF00001 DS    F                                                        07180000
         DS    0F                                                       07181000
@CF00059 DC    F'1'                                                     07182000
@CH00059 EQU   @CF00059+2                                               07183000
@CF00092 DC    F'3'                                                     07184000
@CF00069 DC    F'4'                                                     07185000
@CF01215 DC    F'5'                                                     07186000
@CH01215 EQU   @CF01215+2                                               07187000
@CF00061 DC    F'7'                                                     07188000
@CF00056 DC    F'8'                                                     07189000
@CF01569 DC    F'12'                                                    07190000
@CF00111 DC    F'16'                                                    07191000
@CH00111 EQU   @CF00111+2                                               07192000
@CF00267 DC    F'20'                                                    07193000
@CF00075 DC    F'25'                                                    07194000
@CF00120 DC    F'32'                                                    07195000
@CF00102 DC    F'44'                                                    07196000
@CF00076 DC    F'48'                                                    07197000
@CH00076 EQU   @CF00076+2                                               07198000
@CF00054 DC    F'64'                                                    07199000
@CF00238 DC    F'80'                                                    07200000
@CF00073 DC    F'96'                                                    07201000
@CH00073 EQU   @CF00073+2                                               07202000
@CF02512 DC    F'125'                                                   07203000
@CF02432 DC    F'376'                                                   07204000
@CF01553 DC    F'400'                                                   07205000
@CH01553 EQU   @CF01553+2                                               07206000
@CF02514 DC    F'1024'                                                  07207000
@CF02516 DC    F'4096'                                                  07208000
@CF02914 DC    F'6208'                                                  07209000
@CF02873 DC    F'8192'                                                  07210000
@CF02874 DC    F'16384'                                                 07211000
@CF02877 DC    F'32768'                                                 07212000
@CF02525 DC    F'50000'                                                 07213000
@CF02881 DC    F'62720'                                                 07214000
@CF02518 DC    F'65536'                                                 07215000
@CF02885 DC    F'-4048'                                                 07216000
@CF01386 DC    XL4'80000000'                                            07217000
@CF02910 DC    XL4'0000FFFF'                                            07218000
@CV02592 DC    V(ILRIMMSG)                                              07219000
@CV02597 DC    V(IEAVNPB5)                                              07220000
         DS    0D                                                       07221000
TPARPTR  DS    A                                                        07222000
TPAEPTR  DS    A                                                        07223000
TPASPTR  DS    A                                                        07224000
QSRPTR   DS    A                                                        07225000
XPTEPTR  DS    A                                                        07226000
PCTPTR   DS    A                                                        07227000
PATPTR   DS    A                                                        07228000
SDCTPTR  DS    A                                                        07229000
SDCTEPTR DS    A                                                        07230000
SARTPTR  DS    A                                                        07231000
SEGMASK  DC    XL4'00FF0000'                                            07232000
MASK     DC    XL4'80000000'                                            07233000
PRMTBPTR DS    A                                                        07234000
SAVER14A DS    A                                                        07235000
OPENPTR  DS    A                                                        07236000
RDWTPTR  DS    A                                                        07237000
AVLPTR   DS    A                                                        07238000
PLHPTR   DS    A                                                        07239000
LSTPTR   DS    A                                                        07240000
LSTFPTR  DS    A                                                        07241000
LSTMPTR  DS    A                                                        07242000
BUFFPTR  DS    A                                                        07243000
SEGMAD   DS    A                                                        07244000
LIMIT    DS    A                                                        07245000
PLPTPTR  DS    A                                                        07246000
COMTPTR  DS    A                                                        07247000
DPLTPTR  DS    A                                                        07248000
LOCTPTR  DS    A                                                        07249000
COMMPTR  DS    A                                                        07250000
DUPLPTR  DS    A                                                        07251000
LOCLPTR  DS    A                                                        07252000
FDPGPTR  DS    A                                                        07253000
ORIGREQ  DS    F                                                        07254000
MDFDREQ  DS    F                                                        07255000
M        DS    F                                                        07256000
PLPASUSE DC    F'0'                                                     07257000
DUPXSUSE DC    F'0'                                                     07258000
COMMSUSE DC    F'0'                                                     07259000
LEN      DS    F                                                        07260000
DSNPTR   DS    A                                                        07261000
PAGEQPTR DS    A                                                        07262000
SAVOPERD DS    A                                                        07263000
DSTBLPTR DS    A                                                        07264000
PARMPTR  DC    AL4(OPSPARM)                                             07265000
PAGEEXP  DS    H                                                        07266000
SWAPEXP  DS    H                                                        07267000
PAGECTR  DS    H                                                        07268000
COUNT    DS    H                                                        07269000
SAVECT   DS    H                                                        07270000
ENTRIES  DS    H                                                        07271000
PASS     DS    FL1                                                      07272000
IOEMPYN  DC    AL1(3)                                                   07273000
IOEMPYD  DC    AL1(2)                                                   07274000
@CC02481 DC    C'TPARTBLE'                                              07275000
@CC02483 DC    C'QSRECORD'                                              07276000
@CC02762 DC    C'ILROPS00'                                              07277000
@CC02764 DC    C'ILRPREAD'                                              07278000
@CC02477 DC    C'IGNORE'                                                07279000
@CC02479 DC    C'PAT '                                                  07280000
@CC02485 DC    C'SART'                                                  07281000
@CC02487 DC    C'SAT '                                                  07282000
@CC02489 DC    C'PART'                                                  07283000
@CC02491 DC    C'LGVT'                                                  07284000
@CC02493 DC    C'SRB '                                                  07285000
@CC02541 DC    C'340I'                                                  07286000
@CC02543 DC    C'915E'                                                  07287000
@CC02545 DC    C'916E'                                                  07288000
@CC02547 DC    C'918I'                                                  07289000
@CC02549 DC    C'920I'                                                  07290000
@CC02551 DC    C'921I'                                                  07291000
@CC02553 DC    C'922D'                                                  07292000
@CC02555 DC    C'923D'                                                  07293000
@CC02557 DC    C'924D'                                                  07294000
@CC02559 DC    C'925D'                                                  07295000
@CC02561 DC    C'927I'                                                  07296000
@CC02563 DC    C'929I'                                                  07297000
@CC02565 DC    C'930I'                                                  07298000
@CC02567 DC    C'935W'                                                  07299000
@CC02569 DC    C'937I'                                                  07300000
@CC02571 DC    C'938W'                                                  07301000
@CC02573 DC    C'939D'                                                  07302000
@CC02575 DC    C'940I'                                                  07303000
@CC02577 DC    C'941D'                                                  07304000
@CC02579 DC    C'942I'                                                  07305000
@CC02581 DC    C'943W'                                                  07306000
@CC02583 DC    C'944I'                                                  07307000
@CC02585 DC    C'945W'                                                  07308000
         DS    CL3                                                      07309000
DVTAB    DS    CL1004                                                   07310000
         ORG   DVTAB                                                    07311000
DVTHDR   DS    CL36                                                     07312000
         ORG   DVTHDR                                                   07313000
DVTABID  DC    CL4'DVTB'                                                07314000
DVTHEC   DC    H'7'                                                     07315000
@NM00134 DS    CL2                                                      07316000
DVTLNG   DC    AL4(52)                                                  07317000
         DC    AL4(48)                                                  07318000
         DC    AL4(272)                                                 07319000
         DC    AL4(272)                                                 07320000
         DC    AL4(92)                                                  07321000
         DC    AL4(92)                                                  07322000
         DC    AL4(140)                                                 07323000
         ORG   DVTAB+36                                                 07324000
DVTENT   DS    CL968                                                    07325000
         ORG   DVTENT                                                   07326000
D2314    DS    CL52                                                     07327000
         ORG   D2314                                                    07328000
D2314ID  DC    CL4'PCT'                                                 07329000
D2314ET  DC    CL6'2314'                                                07330000
D2314MS  DC    AL2(6000)                                                07331000
D2314HT  DC    X'2008'                                                  07332000
D2314SC  DC    H'30'                                                    07333000
D2314CH  DC    A(0)                                                     07334000
D2314MK  DC    X'0000000300000003'                                      07335000
D2314PW  DC    H'5'                                                     07336000
D2314SS  DC    H'3'                                                     07337000
D2314MT  DC    F'16666'                                                 07338000
D2314RT  DC    XL2'1800'                                                07339000
D2314BV  DC    AL2(432)                                                 07340000
D2314ST  DC    X'00000000'                                              07341000
         DC    X'81001000'                                              07342000
         DC    X'02000800'                                              07343000
         ORG   DVTENT+52                                                07344000
D3340    DS    CL48                                                     07345000
         ORG   D3340                                                    07346000
D3340ID  DC    CL4'PCT'                                                 07347000
D3340ET  DC    CL6'3340'                                                07348000
D3340MS  DC    AL2(16704)                                               07349000
D3340HT  DC    X'200A'                                                  07350000
D3340SC  DC    H'24'                                                    07351000
D3340CH  DC    A(0)                                                     07352000
D3340MK  DC    X'000000FF000000FF'                                      07353000
D3340PW  DC    H'15'                                                    07354000
D3340SS  DC    H'2'                                                     07355000
D3340MT  DC    F'5000'                                                  07356000
D3340RT  DC    XL2'2000'                                                07357000
D3340BV  DC    AL2(432)                                                 07358000
D3340ST  DC    X'00020000'                                              07359000
         DC    X'01201000'                                              07360000
         ORG   DVTENT+100                                               07361000
D3330    DS    CL272                                                    07362000
         ORG   D3330                                                    07363000
D3330ID  DC    CL4'PCT'                                                 07364000
D3330ET  DC    CL6'3330'                                                07365000
D3330MS  DC    AL2(23432)                                               07366000
D3330HT  DC    X'2009'                                                  07367000
D3330SC  DC    H'58'                                                    07368000
D3330CH  DC    A(0)                                                     07369000
D3330MK  DC    X'000000000000003F'                                      07370000
D3330PW  DC    H'30'                                                    07371000
D3330SS  DC    H'58'                                                    07372000
D3330MT  DC    F'5000'                                                  07373000
D3330RT  DC    XL2'30D8'                                                07374000
D3330BV  DC    AL2(432)                                                 07375000
D3330ST  DC    X'00020000'                                              07376000
         DC    X'012A1000'                                              07377000
         DC    X'02532000'                                              07378000
         DC    X'837B3000'                                              07379000
         DC    X'04280F28'                                              07380000
         DC    X'05501F28'                                              07381000
         DC    X'86792F28'                                              07382000
         DC    X'07260E50'                                              07383000
         DC    X'084E1E50'                                              07384000
         DC    X'89772E50'                                              07385000
         DC    X'0A240D78'                                              07386000
         DC    X'0B4C1D78'                                              07387000
         DC    X'8C752D78'                                              07388000
         DC    X'0D220CA0'                                              07389000
         DC    X'0E4A1CA0'                                              07390000
         DC    X'8F732CA0'                                              07391000
         DC    X'10200BC8'                                              07392000
         DC    X'11481BC8'                                              07393000
         DC    X'92712BC8'                                              07394000
         DC    X'131E0AF0'                                              07395000
         DC    X'14461AF0'                                              07396000
         DC    X'956E2AF0'                                              07397000
         DC    X'161C0A18'                                              07398000
         DC    X'17441A18'                                              07399000
         DC    X'986C2A18'                                              07400000
         DC    X'191A0940'                                              07401000
         DC    X'1A421940'                                              07402000
         DC    X'9B6A2940'                                              07403000
         DC    X'1C180868'                                              07404000
         DC    X'1D401868'                                              07405000
         DC    X'9E682868'                                              07406000
         DC    X'1F160790'                                              07407000
         DC    X'203E1790'                                              07408000
         DC    X'A1662790'                                              07409000
         DC    X'221406B8'                                              07410000
         DC    X'233C16B8'                                              07411000
         DC    X'A46426B8'                                              07412000
         DC    X'251205E0'                                              07413000
         DC    X'263A15E0'                                              07414000
         DC    X'A76225E0'                                              07415000
         DC    X'280F0508'                                              07416000
         DC    X'29381508'                                              07417000
         DC    X'AA602508'                                              07418000
         DC    X'2B0D0430'                                              07419000
         DC    X'2C361430'                                              07420000
         DC    X'AD5E2430'                                              07421000
         DC    X'2E0B0358'                                              07422000
         DC    X'2F341358'                                              07423000
         DC    X'B05C2358'                                              07424000
         DC    X'31090280'                                              07425000
         DC    X'32321280'                                              07426000
         DC    X'B35A2280'                                              07427000
         DC    X'340701A8'                                              07428000
         DC    X'353011A8'                                              07429000
         DC    X'B65821A8'                                              07430000
         DC    X'370500D0'                                              07431000
         DC    X'382D10D0'                                              07432000
         DC    X'395620D0'                                              07433000
         ORG   DVTENT+372                                               07434000
D33301   DS    CL272                                                    07435000
         ORG   D33301                                                   07436000
D33301ID DC    CL4'PCT'                                                 07437000
D33301ET DC    CL6'3330-1'                                              07438000
D33301MS DC    AL2(46864)                                               07439000
D33301HT DC    X'200D'                                                  07440000
D33301SC DC    H'58'                                                    07441000
D33301CH DC    A(0)                                                     07442000
D33301MK DC    X'000000000000003F'                                      07443000
D33301PW DC    H'35'                                                    07444000
D33301SS DC    H'58'                                                    07445000
D33301MT DC    F'5000'                                                  07446000
D33301RT DC    XL2'30D8'                                                07447000
D33301BV DC    AL2(432)                                                 07448000
D33301ST DC    X'00020000'                                              07449000
         DC    X'012A1000'                                              07450000
         DC    X'02532000'                                              07451000
         DC    X'837B3000'                                              07452000
         DC    X'04280F28'                                              07453000
         DC    X'05501F28'                                              07454000
         DC    X'86792F28'                                              07455000
         DC    X'07260E50'                                              07456000
         DC    X'084E1E50'                                              07457000
         DC    X'89772E50'                                              07458000
         DC    X'0A240D78'                                              07459000
         DC    X'0B4C1D78'                                              07460000
         DC    X'8C752D78'                                              07461000
         DC    X'0D220CA0'                                              07462000
         DC    X'0E4A1CA0'                                              07463000
         DC    X'8F732CA0'                                              07464000
         DC    X'10200BC8'                                              07465000
         DC    X'11481BC8'                                              07466000
         DC    X'92712BC8'                                              07467000
         DC    X'131E0AF0'                                              07468000
         DC    X'14461AF0'                                              07469000
         DC    X'956E2AF0'                                              07470000
         DC    X'161C0A18'                                              07471000
         DC    X'17441A18'                                              07472000
         DC    X'986C2A18'                                              07473000
         DC    X'191A0940'                                              07474000
         DC    X'1A421940'                                              07475000
         DC    X'9B6A2940'                                              07476000
         DC    X'1C180868'                                              07477000
         DC    X'1D401868'                                              07478000
         DC    X'9E682868'                                              07479000
         DC    X'1F160790'                                              07480000
         DC    X'203E1790'                                              07481000
         DC    X'A1662790'                                              07482000
         DC    X'221406B8'                                              07483000
         DC    X'233C16B8'                                              07484000
         DC    X'A46426B8'                                              07485000
         DC    X'251205E0'                                              07486000
         DC    X'263A15E0'                                              07487000
         DC    X'A76225E0'                                              07488000
         DC    X'280F0508'                                              07489000
         DC    X'29381508'                                              07490000
         DC    X'AA602508'                                              07491000
         DC    X'2B0D0430'                                              07492000
         DC    X'2C361430'                                              07493000
         DC    X'AD5E2430'                                              07494000
         DC    X'2E0B0358'                                              07495000
         DC    X'2F341358'                                              07496000
         DC    X'B05C2358'                                              07497000
         DC    X'31090280'                                              07498000
         DC    X'32321280'                                              07499000
         DC    X'B35A2280'                                              07500000
         DC    X'340701A8'                                              07501000
         DC    X'353011A8'                                              07502000
         DC    X'B65821A8'                                              07503000
         DC    X'370500D0'                                              07504000
         DC    X'382D10D0'                                              07505000
         DC    X'395620D0'                                              07506000
         ORG   DVTENT+644                                               07507000
D3350    DS    CL92                                                     07508000
         ORG   D3350                                                    07509000
D3350ID  DC    CL4'PCT'                                                 07510000
D3350ET  DC    CL6'3350'                                                07511000
D3350MS  DC    AL2(65520)                                               07512000
D3350HT  DC    X'200B'                                                  07513000
D3350SC  DC    H'26'                                                    07514000
D3350CH  DC    A(0)                                                     07515000
D3350MK  DC    X'0000003F0000003F'                                      07516000
D3350PW  DC    H'50'                                                    07517000
D3350SS  DC    H'13'                                                    07518000
D3350MT  DC    F'3500'                                                  07519000
D3350RT  DC    XL2'4556'                                                07520000
D3350BV  DC    AL2(432)                                                 07521000
D3350ST  DC    X'00020000'                                              07522000
         DC    X'011D1000'                                              07523000
         DC    X'02392000'                                              07524000
         DC    X'03543000'                                              07525000
         DC    X'84704000'                                              07526000
         DC    X'05150AAA'                                              07527000
         DC    X'06301AAA'                                              07528000
         DC    X'074C2AAA'                                              07529000
         DC    X'88673AAA'                                              07530000
         DC    X'090C0554'                                              07531000
         DC    X'0A271554'                                              07532000
         DC    X'0B432554'                                              07533000
         DC    X'0C5E3554'                                              07534000
         ORG   DVTENT+736                                               07535000
D23052   DS    CL92                                                     07536000
         ORG   D23052                                                   07537000
D23052ID DC    CL4'PCT'                                                 07538000
D23052ET DC    CL6'2305-2'                                              07539000
D23052MS DC    AL2(2496)                                                07540000
D23052HT DC    X'2007'                                                  07541000
D23052SC DC    H'26'                                                    07542000
D23052CH DC    A(0)                                                     07543000
D23052MK DC    X'0000003F0000003F'                                      07544000
D23052PW DC    H'100'                                                   07545000
D23052SS DC    H'13'                                                    07546000
D23052MT DC    F'3070'                                                  07547000
D23052RT DC    XL2'3400'                                                07548000
D23052BV DC    AL2(432)                                                 07549000
D23052ST DC    X'00030000'                                              07550000
         DC    X'01361000'                                              07551000
         DC    X'026A2000'                                              07552000
         DC    X'839D3000'                                              07553000
         DC    X'042A0C00'                                              07554000
         DC    X'055D1C00'                                              07555000
         DC    X'86912C00'                                              07556000
         DC    X'071E0800'                                              07557000
         DC    X'08511800'                                              07558000
         DC    X'89842800'                                              07559000
         DC    X'0A120400'                                              07560000
         DC    X'0B451400'                                              07561000
         DC    X'0C782400'                                              07562000
         ORG   DVTENT+828                                               07563000
D23051   DS    CL140                                                    07564000
         ORG   D23051                                                   07565000
D23051ID DC    CL4'PCT'                                                 07566000
D23051ET DC    CL6'2305-1'                                              07567000
D23051MS DC    AL2(1200)                                                07568000
D23051HT DC    X'2006'                                                  07569000
D23051SC DC    H'25'                                                    07570000
D23051CH DC    A(0)                                                     07571000
D23051MK DC    X'0000007F0000007F'                                      07572000
D23051PW DC    H'175'                                                   07573000
D23051SS DC    H'25'                                                    07574000
D23051MT DC    F'1600'                                                  07575000
D23051RT DC    XL2'3200'                                                07576000
D23051BV DC    AL2(432)                                                 07577000
D23051ST DC    X'00030000'                                              07578000
         DC    X'011E1000'                                              07579000
         DC    X'02392000'                                              07580000
         DC    X'83543000'                                              07581000
         DC    X'041B0E00'                                              07582000
         DC    X'05361E00'                                              07583000
         DC    X'86512E00'                                              07584000
         DC    X'07180C00'                                              07585000
         DC    X'08331C00'                                              07586000
         DC    X'894E2C00'                                              07587000
         DC    X'0A150A00'                                              07588000
         DC    X'0B301A00'                                              07589000
         DC    X'8C4B2A00'                                              07590000
         DC    X'0D120800'                                              07591000
         DC    X'0E2D1800'                                              07592000
         DC    X'8F482800'                                              07593000
         DC    X'100F0600'                                              07594000
         DC    X'112A1600'                                              07595000
         DC    X'92452600'                                              07596000
         DC    X'130C0400'                                              07597000
         DC    X'14271400'                                              07598000
         DC    X'95422400'                                              07599000
         DC    X'16090200'                                              07600000
         DC    X'17241200'                                              07601000
         DC    X'183F2200'                                              07602000
         ORG   DVTAB+1004                                               07603000
HSDCT    DS    CL128                                                    07604000
         ORG   HSDCT                                                    07605000
HSDCHDR  DS    CL8                                                      07606000
         ORG   HSDCHDR                                                  07607000
HSDCID   DC    CL4'SDCT'                                                07608000
HSDCSIZE DC    AL2(6)                                                   07609000
HSDCRSV1 DC    AL2(0)                                                   07610000
         ORG   HSDCT+8                                                  07611000
H3340    DS    CL20                                                     07612000
         ORG   H3340                                                    07613000
H3340TP  DC    CL6'3340'                                                07614000
H3340TX  DC    X'200A'                                                  07615000
H3340TK  DC    AL2(2)                                                   07616000
H3340SC  DC    AL2(24)                                                  07617000
H3340MK  DC    XL4'3F3F3F3F'                                            07618000
H3340SS  DC    XL1'02'                                                  07619000
H3340XP  DC    AL1(0)                                                   07620000
H3340RV  DC    X'0000'                                                  07621000
         ORG   HSDCT+28                                                 07622000
H3330    DS    CL20                                                     07623000
         ORG   H3330                                                    07624000
H3330TP  DC    CL6'3330'                                                07625000
H3330TX  DC    X'2009'                                                  07626000
H3330TK  DC    AL2(3)                                                   07627000
H3330SC  DC    AL2(57)                                                  07628000
H3330MK  DC    XL4'0F0F0F0F'                                            07629000
H3330SS  DC    XL1'02'                                                  07630000
H3330XP  DC    AL1(0)                                                   07631000
H3330RV  DC    X'0000'                                                  07632000
         ORG   HSDCT+48                                                 07633000
H33301   DS    CL20                                                     07634000
         ORG   H33301                                                   07635000
H33301TP DC    CL6'3330-1'                                              07636000
H33301TX DC    X'200D'                                                  07637000
H33301TK DC    AL2(3)                                                   07638000
H33301SC DC    AL2(57)                                                  07639000
H33301MK DC    XL4'0F0F0F0F'                                            07640000
H33301SS DC    XL1'02'                                                  07641000
H33301XP DC    AL1(0)                                                   07642000
H33301R  DC    X'0000'                                                  07643000
         ORG   HSDCT+68                                                 07644000
H3350    DS    CL20                                                     07645000
         ORG   H3350                                                    07646000
H3350TP  DC    CL6'3350'                                                07647000
H3350TX  DC    X'200B'                                                  07648000
H3350TK  DC    AL2(4)                                                   07649000
H3350SC  DC    AL2(120)                                                 07650000
H3350MK  DC    XL4'003F003F'                                            07651000
H3350SS  DC    XL1'02'                                                  07652000
H3350XP  DC    AL1(1)                                                   07653000
H3350RV  DC    X'0000'                                                  07654000
         ORG   HSDCT+88                                                 07655000
H23052   DS    CL20                                                     07656000
         ORG   H23052                                                   07657000
H23052TP DC    CL6'2305-2'                                              07658000
H23052TX DC    X'2007'                                                  07659000
H23052TK DC    AL2(3)                                                   07660000
H23052SC DC    AL2(24)                                                  07661000
H23052MK DC    XL4'3F3F3F3F'                                            07662000
H23052SS DC    XL1'03'                                                  07663000
H23052XP DC    AL1(0)                                                   07664000
H23052R  DC    X'0000'                                                  07665000
         ORG   HSDCT+108                                                07666000
H23051   DS    CL20                                                     07667000
         ORG   H23051                                                   07668000
H23051TP DC    CL6'2305-1'                                              07669000
H23051TX DC    X'2006'                                                  07670000
H23051TK DC    AL2(3)                                                   07671000
H23051SC DC    AL2(24)                                                  07672000
H23051MK DC    XL4'3F3F3F3F'                                            07673000
H23051SS DC    XL1'03'                                                  07674000
H23051XP DC    AL1(0)                                                   07675000
H23051R  DC    X'0000'                                                  07676000
         ORG   HSDCT+128                                                07677000
SKELETON DS    CL400                                                    07678000
         ORG   SKELETON                                                 07679000
SKELID   DC    X'87'                                                    07680000
SKELZERO DC    XL87'0'                                                  07681000
SKELSEEK DC    X'0B00000040000006'                                      07682000
SKELSSEC DC    X'2300000040000001'                                      07683000
SKELSLOT DS    CL24                                                     07684000
         ORG   SKELSLOT+0                                               07685000
SKELSRCH DC    X'B100000040000005'                                      07686000
SKELTIC  DC    X'0800000040000000'                                      07687000
SKELRW   DC    X'0500000040001000'                                      07688000
         ORG   SKELSLOT+24                                              07689000
         ORG   SKELSLOT+24                                              07690000
         DC    X'B100000040000005'                                      07691000
         DC    X'0800000040000000'                                      07692000
         DC    X'0500000040001000'                                      07693000
         ORG   SKELSLOT+48                                              07694000
         ORG   SKELSLOT+48                                              07695000
         DC    X'B100000040000005'                                      07696000
         DC    X'0800000040000000'                                      07697000
         DC    X'0500000040001000'                                      07698000
         ORG   SKELSLOT+72                                              07699000
         ORG   SKELSLOT+72                                              07700000
         DC    X'B100000040000005'                                      07701000
         DC    X'0800000040000000'                                      07702000
         DC    X'0500000040001000'                                      07703000
         ORG   SKELSLOT+96                                              07704000
         ORG   SKELSLOT+96                                              07705000
         DC    X'B100000040000005'                                      07706000
         DC    X'0800000040000000'                                      07707000
         DC    X'0500000040001000'                                      07708000
         ORG   SKELSLOT+120                                             07709000
         ORG   SKELSLOT+120                                             07710000
         DC    X'B100000040000005'                                      07711000
         DC    X'0800000040000000'                                      07712000
         DC    X'0500000040001000'                                      07713000
         ORG   SKELSLOT+144                                             07714000
         ORG   SKELSLOT+144                                             07715000
         DC    X'B100000040000005'                                      07716000
         DC    X'0800000040000000'                                      07717000
         DC    X'0500000040001000'                                      07718000
         ORG   SKELSLOT+168                                             07719000
         ORG   SKELSLOT+168                                             07720000
         DC    X'B100000040000005'                                      07721000
         DC    X'0800000040000000'                                      07722000
         DC    X'0500000040001000'                                      07723000
         ORG   SKELSLOT+192                                             07724000
         ORG   SKELSLOT+192                                             07725000
         DC    X'B100000040000005'                                      07726000
         DC    X'0800000040000000'                                      07727000
         DC    X'0500000040001000'                                      07728000
         ORG   SKELSLOT+216                                             07729000
         ORG   SKELSLOT+216                                             07730000
         DC    X'B100000040000005'                                      07731000
         DC    X'0800000040000000'                                      07732000
         DC    X'0500000040001000'                                      07733000
         ORG   SKELSLOT+240                                             07734000
         ORG   SKELSLOT+240                                             07735000
         DC    X'B100000040000005'                                      07736000
         DC    X'0800000040000000'                                      07737000
         DC    X'0500000040001000'                                      07738000
         ORG   SKELSLOT+264                                             07739000
         ORG   SKELSLOT+264                                             07740000
         DC    X'B100000040000005'                                      07741000
         DC    X'0800000040000000'                                      07742000
         DC    X'0500000040001000'                                      07743000
         ORG   SKELETON+392                                             07744000
SKELLTIC DC    X'0300000020000001'                                      07745000
         ORG   SKELETON+400                                             07746000
SWAPPARM DC    CL8'SWAP'                                                07747000
DPLXPARM DC    CL8'DUPLEX'                                              07748000
PAGEPARM DC    CL8'PAGE'                                                07749000
PAGNUMPM DC    CL8'PAGNUM'                                              07750000
DATAPARM DC    CL8' '                                                   07751000
BADCLCK  DC    CL13'BAD TIMESTAMP'                                      07752000
NODATST  DC    CL13'NO DATA SET'                                        07753000
ZERODSN  DC    X'000000000000000000000000000000000000000000000000000000C07754000
               0000000000000000000000000000000000'                      07755000
         ORG   ZERODSN                                                  07756000
ZERODW   DS    CL8                                                      07757000
         ORG   ZERODSN+44                                               07758000
PAGEZONE DC    CL2'00'                                                  07759000
SWAPZONE DC    CL2'00'                                                  07760000
         DS    CL6                                                      07761000
WORKAREA DS    CL8                                                      07762000
RMPATCH  DC    XL200'0'                                                 07763000
READPARM DS    CL12                                                     07764000
         ORG   READPARM                                                 07765000
PFLAG    DS    BL1                                                      07766000
         ORG   PFLAG                                                    07767000
PWRITE   DS    BL1                                                      07768000
PTPARB   EQU   PFLAG+0                                                  07769000
         ORG   READPARM+1                                               07770000
PSLOTNO  DS    FL1                                                      07771000
PSLOT    DS    FL2                                                      07772000
PENTRY   DS    AL4                                                      07773000
PBUFF    DS    AL4                                                      07774000
         ORG   READPARM+12                                              07775000
MSGPL    DS    CL24                                                     07776000
         ORG   MSGPL                                                    07777000
MSGID    DS    CL4                                                      07778000
NIPPTRS  DS    CL8                                                      07779000
         ORG   NIPPTRS                                                  07780000
NVTPTR   DS    AL4                                                      07781000
CVTPTR   DS    AL4                                                      07782000
         ORG   MSGPL+12                                                 07783000
MSGDATA1 DS    AL4                                                      07784000
MSGDATA2 DS    AL4                                                      07785000
         ORG   MSGDATA2                                                 07786000
FLAGS    DS    FL1                                                      07787000
         ORG   MSGPL+20                                                 07788000
MSGDATA3 DS    AL4                                                      07789000
         ORG   MSGPL+24                                                 07790000
OPSPARM  DS    CL48                                                     07791000
         ORG   OPSPARM                                                  07792000
PARMFLG  DS    FL1                                                      07793000
@NM00137 DS    CL3                                                      07794000
PARMDSN  DS    CL44                                                     07795000
         ORG   OPSPARM+48                                               07796000
WRKFLGS  DC    X'0000'                                                  07797000
         ORG   WRKFLGS                                                  07798000
MATCH    DS    BL1                                                      07799000
LIST     EQU   WRKFLGS+0                                                07800000
PROBLEM  EQU   WRKFLGS+0                                                07801000
OLDCOM   EQU   WRKFLGS+0                                                07802000
SWAPSW   EQU   WRKFLGS+0                                                07803000
DUPLEXSW EQU   WRKFLGS+0                                                07804000
NEEDEDL  EQU   WRKFLGS+0                                                07805000
BADDS    EQU   WRKFLGS+0                                                07806000
@NM00138 DS    BL1                                                      07807000
         ORG   WRKFLGS+2                                                07808000
CELLTYP  DC    CL8'IOE POOL'                                            07809000
         DC    CL8'BWK POOL'                                            07810000
         DC    CL8'ACE POOL'                                            07811000
         DS    CL2                                                      07812000
POOLADDR DC    A(0)                                                     07813000
         DC    A(0)                                                     07814000
         DC    A(0)                                                     07815000
CELLNUM  DC    F'0'                                                     07816000
         DC    F'8'                                                     07817000
         DC    F'50'                                                    07818000
CELLRESV DC    F'0'                                                     07819000
         DC    F'0'                                                     07820000
         DC    F'10'                                                    07821000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07822000
@01      EQU   01                                                       07823000
@02      EQU   02                                                       07824000
@03      EQU   03                                                       07825000
@04      EQU   04                                                       07826000
@05      EQU   05                                                       07827000
@06      EQU   06                                                       07828000
@07      EQU   07                                                       07829000
@08      EQU   08                                                       07830000
@09      EQU   09                                                       07831000
@10      EQU   10                                                       07832000
@11      EQU   11                                                       07833000
@12      EQU   12                                                       07834000
@13      EQU   13                                                       07835000
@14      EQU   14                                                       07836000
@15      EQU   15                                                       07837000
CELLPTR  EQU   @03                                                      07838000
DSTEPTR  EQU   @07                                                      07839000
DSNLNG   EQU   @03                                                      07840000
CHARPTR  EQU   @02                                                      07841000
NUMBER   EQU   @07                                                      07842000
L        EQU   @08                                                      07843000
K        EQU   @04                                                      07844000
J        EQU   @02                                                      07845000
I        EQU   @02                                                      07846000
ENTLEFT  EQU   @03                                                      07847000
COUNTER  EQU   @03                                                      07848000
COUNTL   EQU   @02                                                      07849000
SLOT     EQU   @02                                                      07850000
GETREQ   EQU   @02                                                      07851000
CYLMB    EQU   @03                                                      07852000
CYLMW    EQU   @02                                                      07853000
CYLS     EQU   @08                                                      07854000
ENDPTR   EQU   @07                                                      07855000
FREEPTR  EQU   @02                                                      07856000
PLPAPTR  EQU   @02                                                      07857000
SCHPTR   EQU   @08                                                      07858000
SWAPPTR  EQU   @03                                                      07859000
PAGEPTR  EQU   @03                                                      07860000
BDYADDR  EQU   @07                                                      07861000
SAVEADDR EQU   @08                                                      07862000
ENDSAT   EQU   @08                                                      07863000
ENDPAT   EQU   @08                                                      07864000
SATCYLA  EQU   @03                                                      07865000
PATCYLA  EQU   @02                                                      07866000
DVTPTR   EQU   @02                                                      07867000
POOLPTR  EQU   @05                                                      07868000
SRBPTR   EQU   @07                                                      07869000
LGVTEPTR EQU   @03                                                      07870000
LGVTPTR  EQU   @02                                                      07871000
SCCWPTR  EQU   @02                                                      07872000
SAREPTR  EQU   @02                                                      07873000
PAREPTR  EQU   @02                                                      07874000
PARTPTR  EQU   @07                                                      07875000
QSREPTR  EQU   @08                                                      07876000
R9       EQU   @09                                                      07877000
R10      EQU   @10                                                      07878000
R11      EQU   @11                                                      07879000
R12      EQU   @12                                                      07880000
R0       EQU   @00                                                      07881000
R1       EQU   @01                                                      07882000
R2       EQU   @02                                                      07883000
R3       EQU   @03                                                      07884000
R14      EQU   @14                                                      07885000
R15      EQU   @15                                                      07886000
SATPTR   EQU   @01                                                      07887000
RNVT     EQU   @02                                                      07888000
GPR00P   EQU   @00                                                      07889000
GPR01P   EQU   @01                                                      07890000
GPR01F   EQU   @01                                                      07891000
GPR15F   EQU   @15                                                      07892000
GPR00F   EQU   @00                                                      07893000
RCVT     EQU   @03                                                      07894000
RENTRY   EQU   @15                                                      07895000
REXIT    EQU   @14                                                      07896000
RPARM    EQU   @01                                                      07897000
R13      EQU   @13                                                      07898000
R4       EQU   @04                                                      07899000
R5       EQU   @05                                                      07900000
R6       EQU   @06                                                      07901000
R7       EQU   @07                                                      07902000
R8       EQU   @08                                                      07903000
PSA      EQU   0                                                        07904000
FLCRNPSW EQU   PSA                                                      07905000
FLCROPSW EQU   PSA+8                                                    07906000
FLCICCW2 EQU   PSA+16                                                   07907000
PSAEEPSW EQU   PSA+132                                                  07908000
PSAESPSW EQU   PSA+136                                                  07909000
FLCSVILC EQU   PSAESPSW+1                                               07910000
PSAEPPSW EQU   PSA+140                                                  07911000
FLCPIILC EQU   PSAEPPSW+1                                               07912000
FLCPICOD EQU   PSAEPPSW+2                                               07913000
PSAPICOD EQU   FLCPICOD+1                                               07914000
FLCTEA   EQU   PSAEPPSW+4                                               07915000
FLCPER   EQU   PSA+152                                                  07916000
FLCMCLA  EQU   PSA+168                                                  07917000
FLCIOEL  EQU   FLCMCLA+4                                                07918000
FLCIOA   EQU   FLCMCLA+16                                               07919000
FLCFSA   EQU   FLCMCLA+80                                               07920000
PSAAOLD  EQU   PSA+548                                                  07921000
PSASUPER EQU   PSA+552                                                  07922000
PSASUP1  EQU   PSASUPER                                                 07923000
PSASUP2  EQU   PSASUPER+1                                               07924000
PSASUP3  EQU   PSASUPER+2                                               07925000
PSASUP4  EQU   PSASUPER+3                                               07926000
PSACLHT  EQU   PSA+640                                                  07927000
PSALKSA  EQU   PSA+696                                                  07928000
PSAHLHI  EQU   PSA+760                                                  07929000
PSADSSFL EQU   PSA+836                                                  07930000
PSADSSF1 EQU   PSADSSFL                                                 07931000
PSADSSF3 EQU   PSADSSFL+2                                               07932000
PSADSSF4 EQU   PSADSSFL+3                                               07933000
PSARSVT  EQU   PSA+896                                                  07934000
TPARTBLE EQU   0                                                        07935000
TPARHEAD EQU   TPARTBLE                                                 07936000
TPARIDNT EQU   TPARHEAD                                                 07937000
TPARFLAG EQU   TPARHEAD+8                                               07938000
TPARWARM EQU   TPARFLAG                                                 07939000
TPARUSE  EQU   TPARHEAD+12                                              07940000
TPARNPGS EQU   TPARHEAD+16                                              07941000
TPAREXPD EQU   TPARHEAD+20                                              07942000
TPARPCTQ EQU   TPARHEAD+24                                              07943000
TPARTIME EQU   TPARHEAD+32                                              07944000
TPARPENT EQU   TPARTBLE+64                                              07945000
TPARSENT EQU   TPARTBLE+6208                                            07946000
TPARENT  EQU   0                                                        07947000
TPAETYPE EQU   TPARENT                                                  07948000
TPAESTAT EQU   TPARENT+2                                                07949000
TPAEPARM EQU   TPAESTAT                                                 07950000
TPAEPRVI EQU   TPAESTAT                                                 07951000
TPAESKIP EQU   TPAESTAT                                                 07952000
TPAEVALD EQU   TPAESTAT                                                 07953000
TPAECLAS EQU   TPARENT+3                                                07954000
TPAEPLPA EQU   TPAECLAS                                                 07955000
TPAECOMM EQU   TPAECLAS                                                 07956000
TPAEDPLX EQU   TPAECLAS                                                 07957000
TPAELOCL EQU   TPAECLAS                                                 07958000
TPAEDSNL EQU   TPARENT+4                                                07959000
TPAEDSN  EQU   TPARENT+8                                                07960000
TPAEEDB  EQU   TPARENT+52                                               07961000
TPAEUCB  EQU   TPARENT+56                                               07962000
TPAEPCT  EQU   TPARENT+60                                               07963000
TPAESZSL EQU   TPARENT+64                                               07964000
TPAEPATB EQU   TPARENT+68                                               07965000
TPAEPATP EQU   TPARENT+72                                               07966000
TPAEIORB EQU   TPARENT+76                                               07967000
TPASENT  EQU   0                                                        07968000
TPASDSN  EQU   TPASENT+4                                                07969000
QSR      EQU   0                                                        07970000
QSRHDR   EQU   QSR                                                      07971000
QSRIDNT  EQU   QSRHDR                                                   07972000
QSRLPAHA EQU   QSRHDR+8                                                 07973000
QSRLPALO EQU   QSRHDR+12                                                07974000
QSRLPAHI EQU   QSRHDR+16                                                07975000
QSRFLAGS EQU   QSRHDR+20                                                07976000
QSRPLPAF EQU   QSRFLAGS                                                 07977000
QSRCOMMF EQU   QSRFLAGS                                                 07978000
QSRSYNCH EQU   QSRHDR+24                                                07979000
QSRMAP   EQU   QSR+32                                                   07980000
QSRENTRY EQU   0                                                        07981000
QSRLSID  EQU   QSRENTRY                                                 07982000
QSRPTNN  EQU   QSRLSID+1                                                07983000
QSRSLOT  EQU   QSRLSID+2                                                07984000
QSRLSID2 EQU   QSRENTRY+4                                               07985000
QSRPTNN2 EQU   QSRLSID2+1                                               07986000
QSRSLOT2 EQU   QSRLSID2+2                                               07987000
ASMVT    EQU   0                                                        07988000
ASMFLAG1 EQU   ASMVT                                                    07989000
ASMDUPLX EQU   ASMFLAG1                                                 07990000
ASMNOLCL EQU   ASMFLAG1                                                 07991000
ASMPLPAF EQU   ASMFLAG1                                                 07992000
ASMCOMMF EQU   ASMFLAG1                                                 07993000
ASMPLPAS EQU   ASMFLAG1                                                 07994000
ASMFLAG2 EQU   ASMVT+1                                                  07995000
ASMNOTPT EQU   ASMFLAG2                                                 07996000
ASMQUICK EQU   ASMFLAG2                                                 07997000
ASMWARM  EQU   ASMFLAG2                                                 07998000
ASMDSSFS EQU   ASMVT+2                                                  07999000
ASMSART  EQU   ASMVT+4                                                  08000000
ASMPART  EQU   ASMVT+8                                                  08001000
ASMMSGBF EQU   ASMVT+24                                                 08002000
ASMSTAGQ EQU   ASMVT+32                                                 08003000
ASMPCCWQ EQU   ASMVT+64                                                 08004000
ASMPCCWN EQU   ASMVT+72                                                 08005000
ASMBURST EQU   ASMVT+76                                                 08006000
ASMPSRB  EQU   ASMVT+88                                                 08007000
ASMBKSLT EQU   ASMVT+108                                                08008000
ASMSLOTS EQU   ASMVT+112                                                08009000
ASMLGVT  EQU   ASMVT+132                                                08010000
ASMLSAI  EQU   ASMVT+144                                                08011000
ASMGOSQS EQU   ASMVT+152                                                08012000
ASMPTM   EQU   ASMVT+204                                                08013000
ASMPSWPD EQU   ASMVT+208                                                08014000
ASMPSRMT EQU   ASMVT+212                                                08015000
ASMIOEPC EQU   ASMVT+296                                                08016000
ASMBWKPC EQU   ASMVT+312                                                08017000
ASMACEPC EQU   ASMVT+344                                                08018000
ASMWKSA1 EQU   ASMVT+368                                                08019000
ASMWKSA2 EQU   ASMVT+448                                                08020000
ASMWKSA3 EQU   ASMVT+528                                                08021000
ASMWKSA4 EQU   ASMVT+608                                                08022000
ASMWKSA5 EQU   ASMVT+688                                                08023000
ASMPOOLS EQU   0                                                        08024000
ASMCPSIZ EQU   ASMPOOLS+4                                               08025000
ASMCPAVQ EQU   ASMPOOLS+8                                               08026000
ASMCPAVL EQU   ASMCPAVQ                                                 08027000
ASMCPRSQ EQU   ASMPOOLS+16                                              08028000
ASMCPRES EQU   ASMCPRSQ+4                                               08029000
NVT      EQU   0                                                        08030000
NVTNPATR EQU   NVT+54                                                   08031000
NVTNPREN EQU   NVTNPATR                                                 08032000
NVTFLLB  EQU   NVT+55                                                   08033000
NVTABSAV EQU   NVT+140                                                  08034000
NVTNUCND EQU   NVT+180                                                  08035000
NVTNBFND EQU   NVT+184                                                  08036000
NVTFLCN  EQU   NVT+211                                                  08037000
NVTWTPSW EQU   NVT+224                                                  08038000
NVTWPSW2 EQU   NVTWTPSW+4                                               08039000
NVTFLWSC EQU   NVTWPSW2+3                                               08040000
NVTLOAD  EQU   NVT+232                                                  08041000
NVTSENSE EQU   NVT+236                                                  08042000
NVTSWAIT EQU   NVT+240                                                  08043000
NVTTIME  EQU   NVT+244                                                  08044000
NVTUCBFN EQU   NVT+248                                                  08045000
NVTWTO   EQU   NVT+252                                                  08046000
NVTWTOR  EQU   NVT+256                                                  08047000
NVTWTOR2 EQU   NVT+260                                                  08048000
NVTOPEN  EQU   NVT+264                                                  08049000
NVTMOUNT EQU   NVT+268                                                  08050000
NVTPRMPT EQU   NVT+272                                                  08051000
NVTVIRT  EQU   NVT+276                                                  08052000
NVTREAL  EQU   NVT+280                                                  08053000
NVTSCHED EQU   NVT+284                                                  08054000
NVTOPIO  EQU   NVT+288                                                  08055000
NVTPTAB  EQU   NVT+372                                                  08056000
NVTQSBUF EQU   NVT+376                                                  08057000
NVTXCTL  EQU   NVT+428                                                  08058000
NVTLOCAT EQU   NVT+436                                                  08059000
NVTLPAND EQU   NVT+476                                                  08060000
NVTFLPO  EQU   NVT+528                                                  08061000
NVTFLQS  EQU   NVTFLPO                                                  08062000
NVTFLWS  EQU   NVTFLPO                                                  08063000
NVTLPALO EQU   NVT+544                                                  08064000
NVTLPAHA EQU   NVT+548                                                  08065000
CVTMAP   EQU   0                                                        08066000
CVTDAR   EQU   CVTMAP+72                                                08067000
CVTFLGS1 EQU   CVTDAR                                                   08068000
CVTDCB   EQU   CVTMAP+116                                               08069000
CVTIOQET EQU   CVTMAP+120                                               08070000
CVTIERLC EQU   CVTMAP+144                                               08071000
CVTHEAD  EQU   CVTMAP+160                                               08072000
CVTSV76C EQU   CVTHEAD                                                  08073000
CVTOPTA  EQU   CVTMAP+182                                               08074000
CVTOPTB  EQU   CVTMAP+183                                               08075000
CVTGTF   EQU   CVTMAP+236                                               08076000
CVTGTFST EQU   CVTGTF                                                   08077000
CVTGTFS  EQU   CVTGTFST                                                 08078000
CVTSTATE EQU   CVTGTFST                                                 08079000
CVTTMODE EQU   CVTGTFST                                                 08080000
CVTFORM  EQU   CVTGTFST                                                 08081000
CVTAQAVT EQU   CVTMAP+240                                               08082000
CVTTCMFG EQU   CVTAQAVT                                                 08083000
CVTVOLM2 EQU   CVTMAP+244                                               08084000
CVTTATA  EQU   CVTVOLM2                                                 08085000
CVTTSKS  EQU   CVTTATA                                                  08086000
CVTVOLF2 EQU   CVTTSKS                                                  08087000
CVTTAT   EQU   CVTTATA+1                                                08088000
CVTATER  EQU   CVTMAP+248                                               08089000
CVTEXT1  EQU   CVTMAP+252                                               08090000
CVTPURG  EQU   CVTMAP+260                                               08091000
CVTQMSG  EQU   CVTMAP+268                                               08092000
CVTDMSR  EQU   CVTMAP+272                                               08093000
CVTRSV37 EQU   CVTDMSR                                                  08094000
CVTDMSRF EQU   CVTRSV37                                                 08095000
CVTERPV  EQU   CVTMAP+316                                               08096000
CVTINTLA EQU   CVTMAP+320                                               08097000
CVTAPF   EQU   CVTMAP+324                                               08098000
CVTEXT2  EQU   CVTMAP+328                                               08099000
CVTHJES  EQU   CVTMAP+332                                               08100000
CVTPGSIA EQU   CVTMAP+348                                               08101000
CVTA1F1  EQU   CVTMAP+356                                               08102000
CVTSYSK  EQU   CVTMAP+357                                               08103000
CVTVOLM1 EQU   CVTMAP+380                                               08104000
CVTVOLF1 EQU   CVTVOLM1                                                 08105000
CVTATMCT EQU   CVTMAP+388                                               08106000
CVTXTNT1 EQU   0                                                        08107000
CVTXTNT2 EQU   0                                                        08108000
CVTDSSV  EQU   CVTXTNT2                                                 08109000
CVTFLGBT EQU   CVTXTNT2+5                                               08110000
CVTQID   EQU   CVTXTNT2+24                                              08111000
CVTRV400 EQU   CVTXTNT2+52                                              08112000
CVTRV409 EQU   CVTXTNT2+53                                              08113000
CVTATCVT EQU   CVTXTNT2+64                                              08114000
CVTRV429 EQU   CVTXTNT2+84                                              08115000
CVTRV438 EQU   CVTXTNT2+85                                              08116000
CVTRV457 EQU   CVTXTNT2+112                                             08117000
CVTRV466 EQU   CVTXTNT2+113                                             08118000
CVTFIX   EQU   0                                                        08119000
CVTRELNO EQU   CVTFIX+252                                               08120000
NIPPAHDR EQU   0                                                        08121000
NIPPAREA EQU   0                                                        08122000
NIPPABDL EQU   NIPPAREA+12                                              08123000
NIPPABDH EQU   NIPPABDL                                                 08124000
NIPPAIOD EQU   NIPPAREA+32                                              08125000
NIPPAECB EQU   NIPPAIOD+84                                              08126000
PARMTAB  EQU   0                                                        08127000
PAGEP    EQU   PARMTAB+184                                              08128000
PAGEO    EQU   PARMTAB+192                                              08129000
@NM00077 EQU   PARMTAB+272                                              08130000
NIPPAFLG EQU   @NM00077                                                 08131000
SWAP     EQU   PARMTAB+288                                              08132000
PAGNUM   EQU   PARMTAB+296                                              08133000
DUPLEX   EQU   PARMTAB+304                                              08134000
NIPPTE   EQU   0                                                        08135000
NIPPTOPF EQU   NIPPTE+4                                                 08136000
NIPPTLST EQU   NIPPTOPF                                                 08137000
NIPPTATF EQU   NIPPTE+5                                                 08138000
XPTE     EQU   0                                                        08139000
XPTFLAGS EQU   XPTE+2                                                   08140000
XPTXAV   EQU   XPTFLAGS                                                 08141000
XPTFLAG2 EQU   XPTE+3                                                   08142000
XPTVALID EQU   XPTFLAG2                                                 08143000
XPTLPID  EQU   XPTE+4                                                   08144000
XPTLGN   EQU   XPTLPID                                                  08145000
XPTLPN   EQU   XPTLPID+4                                                08146000
PCT      EQU   0                                                        08147000
PCTDTYPE EQU   PCT+4                                                    08148000
PCTDTYPX EQU   PCT+12                                                   08149000
PCTCYLSZ EQU   PCT+14                                                   08150000
PCTNEXT  EQU   PCT+16                                                   08151000
PCTDMASK EQU   PCT+20                                                   08152000
PCTRQTIM EQU   PCT+32                                                   08153000
PCTABLE  EQU   PCT+40                                                   08154000
PCTSECT  EQU   PCTABLE                                                  08155000
PCTSLTNM EQU   PCTSECT                                                  08156000
PAT      EQU   0                                                        08157000
PATHDR   EQU   PAT                                                      08158000
PATIDENT EQU   PATHDR                                                   08159000
PATPART  EQU   PATHDR+4                                                 08160000
PATCYLNO EQU   PATHDR+8                                                 08161000
PATCYLSZ EQU   PATHDR+10                                                08162000
PATCYLMW EQU   PATHDR+12                                                08163000
PATMAP   EQU   PAT+16                                                   08164000
PATCYLS  EQU   PATMAP                                                   08165000
PATCYLMP EQU   0                                                        08166000
PART     EQU   0                                                        08167000
PARTHDR  EQU   PART                                                     08168000
PARTIDEN EQU   PARTHDR                                                  08169000
PARTSIZE EQU   PARTHDR+4                                                08170000
PARTEUSE EQU   PARTHDR+8                                                08171000
PARTCIR1 EQU   PARTHDR+16                                               08172000
PARTCIR2 EQU   PARTHDR+20                                               08173000
PARTTPAR EQU   PARTHDR+24                                               08174000
PARTPCTQ EQU   PARTHDR+28                                               08175000
PARTLCNT EQU   PARTHDR+32                                               08176000
PARTCOMQ EQU   PARTHDR+48                                               08177000
PARTSPLQ EQU   PARTHDR+56                                               08178000
PARTDUPQ EQU   PARTHDR+64                                               08179000
PARTLOCQ EQU   PARTHDR+72                                               08180000
PARTENTS EQU   PART+80                                                  08181000
PARTENT  EQU   0                                                        08182000
PAREPARE EQU   PARTENT                                                  08183000
PARELKUP EQU   PARTENT+4                                                08184000
PARELKFL EQU   PARELKUP                                                 08185000
PAREIORN EQU   PARELKUP+1                                               08186000
PARETYPE EQU   PARTENT+8                                                08187000
PAREPLPA EQU   PARETYPE                                                 08188000
PARECOMM EQU   PARETYPE                                                 08189000
PAREDPLX EQU   PARETYPE                                                 08190000
PARELOCL EQU   PARETYPE                                                 08191000
PAREFLG1 EQU   PARTENT+9                                                08192000
PARENUSE EQU   PAREFLG1                                                 08193000
PARENN   EQU   PARTENT+10                                               08194000
PARESZSL EQU   PARTENT+16                                               08195000
PARESLTA EQU   PARTENT+20                                               08196000
PAREIORB EQU   PARTENT+28                                               08197000
PAREPATP EQU   PARTENT+32                                               08198000
PAREPCTP EQU   PARTENT+36                                               08199000
PAREEDBP EQU   PARTENT+40                                               08200000
PAREUCBP EQU   PARTENT+44                                               08201000
PAREWTQE EQU   PARTENT+52                                               08202000
PARERQTM EQU   PARTENT+56                                               08203000
IORB     EQU   0                                                        08204000
IORNUM   EQU   IORB+1                                                   08205000
IORFLGS  EQU   IORB+3                                                   08206000
IORAPND  EQU   IORFLGS                                                  08207000
IORIORB  EQU   IORB+4                                                   08208000
IORPCCW  EQU   IORB+8                                                   08209000
IORPARTE EQU   IORB+32                                                  08210000
SDCT     EQU   0                                                        08211000
SDCHDR   EQU   SDCT                                                     08212000
SDCSIZE  EQU   SDCHDR+4                                                 08213000
SDCENTS  EQU   SDCT+8                                                   08214000
SDCTE    EQU   0                                                        08215000
SDCDEVTP EQU   SDCTE                                                    08216000
SDCDTYPX EQU   SDCTE+6                                                  08217000
SDCCYLSZ EQU   SDCTE+10                                                 08218000
SDCCMASK EQU   SDCTE+12                                                 08219000
SDCMPEXP EQU   SDCTE+17                                                 08220000
SART     EQU   0                                                        08221000
SARTHDR  EQU   SART                                                     08222000
SARID    EQU   SARTHDR                                                  08223000
SARSIZE  EQU   SARTHDR+4                                                08224000
SARUSE   EQU   SARTHDR+8                                                08225000
SARFXDNX EQU   SARTHDR+16                                               08226000
SARMOVNX EQU   SARTHDR+20                                               08227000
SARSDCT  EQU   SARTHDR+28                                               08228000
SARSCCWQ EQU   SARTHDR+32                                               08229000
SARSETCT EQU   SARTHDR+36                                               08230000
SARWAITQ EQU   SARTHDR+40                                               08231000
SARSRBP  EQU   SARTHDR+48                                               08232000
SARSETSZ EQU   SARTHDR+56                                               08233000
SARENTS  EQU   SART+80                                                  08234000
SARTE    EQU   0                                                        08235000
SRENEXT  EQU   SARTE                                                    08236000
SREFLG   EQU   SARTE+9                                                  08237000
SREFIXED EQU   SREFLG                                                   08238000
SRENN    EQU   SARTE+10                                                 08239000
SRETOTSL EQU   SARTE+16                                                 08240000
SREAVLSL EQU   SARTE+20                                                 08241000
SREIORB  EQU   SARTE+28                                                 08242000
SRESAT   EQU   SARTE+32                                                 08243000
SRESDCTE EQU   SARTE+36                                                 08244000
SREEDB   EQU   SARTE+40                                                 08245000
SREUCB   EQU   SARTE+44                                                 08246000
SAT      EQU   0                                                        08247000
SATHDR   EQU   SAT                                                      08248000
SATID    EQU   SATHDR                                                   08249000
SATSARTE EQU   SATHDR+4                                                 08250000
SATMAPLN EQU   SATHDR+8                                                 08251000
SATBYTCL EQU   SATHDR+10                                                08252000
SATSCAN  EQU   SATHDR+16                                                08253000
SATMAPS  EQU   SAT+32                                                   08254000
SATCYLMP EQU   0                                                        08255000
SCCW     EQU   0                                                        08256000
SCCWHDR  EQU   SCCW                                                     08257000
SCCWSECT EQU   SCCWHDR+1                                                08258000
SCCWFLAG EQU   SCCWHDR+2                                                08259000
SCCWSCCW EQU   SCCWHDR+4                                                08260000
SCCWSARG EQU   SCCWHDR+16                                               08261000
SCCWBB   EQU   SCCWSARG+1                                               08262000
SCCWSRH  EQU   SCCWSARG+3                                               08263000
SCCWCCHH EQU   SCCWSRH                                                  08264000
SCCWCC   EQU   SCCWCCHH                                                 08265000
SCCWLCCW EQU   SCCWHDR+80                                               08266000
SCCWCCW  EQU   SCCW+88                                                  08267000
SCCWSEEK EQU   SCCWCCW                                                  08268000
SCCWSKAD EQU   SCCWSEEK+1                                               08269000
SCCWSSEC EQU   SCCWCCW+8                                                08270000
SCCWSSAD EQU   SCCWSSEC+1                                               08271000
SCCWSLOT EQU   SCCWCCW+16                                               08272000
SCCWSRCH EQU   SCCWSLOT                                                 08273000
SCCWSROP EQU   SCCWSRCH                                                 08274000
SCCWSRAD EQU   SCCWSRCH+1                                               08275000
SCCWTIC  EQU   SCCWSLOT+8                                               08276000
SCCWTIAD EQU   SCCWTIC+1                                                08277000
SCCWRW   EQU   SCCWSLOT+16                                              08278000
SCCWLTIC EQU   SCCWCCW+304                                              08279000
LGVT     EQU   0                                                        08280000
LGVIDENT EQU   LGVT                                                     08281000
LGVLGVEP EQU   LGVT+4                                                   08282000
LGVMAXLG EQU   LGVT+8                                                   08283000
LGVSIZE  EQU   LGVT+12                                                  08284000
LGVENTRS EQU   LGVT+16                                                  08285000
LGVTE    EQU   0                                                        08286000
LGVLGVTE EQU   LGVTE                                                    08287000
LGVELGEP EQU   LGVLGVTE                                                 08288000
LGVENEXT EQU   LGVELGEP                                                 08289000
LGVEASCB EQU   LGVLGVTE+4                                               08290000
LGVELGID EQU   LGVEASCB                                                 08291000
SRBSECT  EQU   0                                                        08292000
SRB      EQU   SRBSECT                                                  08293000
SRBID    EQU   SRB                                                      08294000
SRBASCB  EQU   SRB+8                                                    08295000
SRBFLC   EQU   SRB+12                                                   08296000
SRBPASID EQU   SRBFLC+2                                                 08297000
SRBEP    EQU   SRB+20                                                   08298000
SRBRMTR  EQU   SRB+24                                                   08299000
SRBPRIOR EQU   SRB+37                                                   08300000
ASCB     EQU   0                                                        08301000
ASCBSUPC EQU   ASCB+16                                                  08302000
ASCBASID EQU   ASCB+36                                                  08303000
ASCBRSM  EQU   ASCB+52                                                  08304000
ASCBRSMF EQU   ASCBRSM                                                  08305000
ASCBFW1  EQU   ASCB+100                                                 08306000
ASCBRCTF EQU   ASCBFW1+2                                                08307000
ASCBFLG1 EQU   ASCBFW1+3                                                08308000
ASCBDSP1 EQU   ASCB+114                                                 08309000
ASCBFLG2 EQU   ASCB+115                                                 08310000
ASCBLKGP EQU   ASCB+128                                                 08311000
ASCBSRQ  EQU   ASCB+180                                                 08312000
ASCBSRQ1 EQU   ASCBSRQ                                                  08313000
ASCBSRQ2 EQU   ASCBSRQ+1                                                08314000
ASCBSRQ3 EQU   ASCBSRQ+2                                                08315000
ASCBSRQ4 EQU   ASCBSRQ+3                                                08316000
MSGBUFER EQU   0                                                        08317000
MSGCURR  EQU   MSGBUFER                                                 08318000
MSGFIRST EQU   MSGBUFER+4                                               08319000
MSGLAST  EQU   MSGBUFER+8                                               08320000
MSGTERM  EQU   MSGBUFER+12                                              08321000
MSGBFRS  EQU   MSGBUFER+16                                              08322000
MSGTBFR  EQU   MSGBUFER+256                                             08323000
ILROPS00 EQU   0                                                        08324000
ILRPREAD EQU   0                                                        08325000
IEAVFP1  EQU   0                                                        08326000
NEXTPTR  EQU   0                                                        08327000
MSGBUF   EQU   0                                                        08328000
TIMEBUF  EQU   0                                                        08329000
AREA     EQU   0                                                        08330000
EXPAN    EQU   0                                                        08331000
FREEAREA EQU   0                                                        08332000
PTCHAR   EQU   0                                                        08333000
PTDSN    EQU   0                                                        08334000
PGSTRNGP EQU   0                                                        08335000
DSTBL    EQU   0                                                        08336000
DSTBENT  EQU   DSTBL                                                    08337000
DSTENT   EQU   0                                                        08338000
DSTDSN   EQU   DSTENT                                                   08339000
DSTDSNC  EQU   DSTDSN                                                   08340000
DSTLNG   EQU   DSTENT+44                                                08341000
DSTFLG   EQU   DSTENT+45                                                08342000
DSTDPLX  EQU   DSTFLG                                                   08343000
DSTUSED  EQU   DSTFLG                                                   08344000
DSTNUSED EQU   DSTFLG                                                   08345000
CELL     EQU   0                                                        08346000
CELLNXT  EQU   CELL                                                     08347000
OPNRTNPL EQU   0                                                        08348000
RTNIORBP EQU   OPNRTNPL                                                 08349000
RTNUCBP  EQU   OPNRTNPL+4                                               08350000
RTNEDBP  EQU   OPNRTNPL+8                                               08351000
SLOTNBR  EQU   OPNRTNPL+12                                              08352000
DEVTYP   EQU   OPNRTNPL+16                                              08353000
VOLSER   EQU   OPNRTNPL+18                                              08354000
BITMMWRD EQU   0                                                        08355000
I001C    EQU   0                                                        08356000
I008P    EQU   0                                                        08357000
I015F    EQU   0                                                        08358000
I015P    EQU   0                                                        08359000
I031F    EQU   0                                                        08360000
I031P    EQU   0                                                        08361000
I256C    EQU   0                                                        08362000
PATCYL   EQU   0                                                        08363000
CVTS01   EQU   CVTPGSIA                                                 08364000
CVTLPDIA EQU   CVTS01+12                                                08365000
CVTDIRST EQU   CVTLPDIA                                                 08366000
CVTSLIDA EQU   CVTS01+24                                                08367000
CVTCTLFG EQU   CVTS01+50                                                08368000
CVTASMVT EQU   CVTS01+356                                               08369000
CVTRV210 EQU   CVTS01+424                                               08370000
CVTRV219 EQU   CVTS01+425                                               08371000
CVTRV228 EQU   CVTS01+426                                               08372000
CVTRV237 EQU   CVTS01+427                                               08373000
CVTMFRTR EQU   CVTS01+452                                               08374000
CVTVFP   EQU   CVTS01+464                                               08375000
CVTRV262 EQU   CVTS01+468                                               08376000
CVTRV271 EQU   CVTS01+469                                               08377000
CVTRV280 EQU   CVTS01+470                                               08378000
CVTRV289 EQU   CVTS01+471                                               08379000
CVTGSDA  EQU   CVTS01+600                                               08380000
ASMVTPTR EQU   CVTASMVT                                                 08381000
ASM1WKSV EQU   ASMWKSA1                                                 08382000
ASM1RGSV EQU   ASM1WKSV                                                 08383000
ASM1WRKA EQU   ASM1WKSV+60                                              08384000
ASM2WKSV EQU   ASMWKSA2                                                 08385000
ASM2WRKA EQU   ASM2WKSV+52                                              08386000
ASM2FLGS EQU   ASM2WRKA+12                                              08387000
ASM3WKSV EQU   ASMWKSA3                                                 08388000
ASM4WKSV EQU   ASMWKSA4                                                 08389000
ASM4RGSV EQU   ASM4WKSV                                                 08390000
ASM5WKSV EQU   ASMWKSA5                                                 08391000
ASM5RGSV EQU   ASM5WKSV                                                 08392000
IORBPTR  EQU   TPAEIORB                                                 08393000
ASCBPTR  EQU   PSAAOLD                                                  08394000
PSARSVTE EQU   PSARSVT                                                  08395000
FLC      EQU   PSA                                                      08396000
SCCWSK   EQU   SCCWSARG                                                 08397000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08398000
PSARSAV  EQU   PSARSVTE+60                                              08399000
PSARSTK  EQU   PSARSVTE+56                                              08400000
PSAESAV3 EQU   PSARSVTE+52                                              08401000
PSAESTK3 EQU   PSARSVTE+48                                              08402000
PSAESAV2 EQU   PSARSVTE+44                                              08403000
PSAESTK2 EQU   PSARSVTE+40                                              08404000
PSAESAV1 EQU   PSARSVTE+36                                              08405000
PSAESTK1 EQU   PSARSVTE+32                                              08406000
PSAPSAV  EQU   PSARSVTE+28                                              08407000
PSAPSTK  EQU   PSARSVTE+24                                              08408000
PSAMSAV  EQU   PSARSVTE+20                                              08409000
PSAMSTK  EQU   PSARSVTE+16                                              08410000
PSASSAV  EQU   PSARSVTE+12                                              08411000
PSASSTK  EQU   PSARSVTE+8                                               08412000
PSANSTK  EQU   PSARSVTE+4                                               08413000
PSACSTK  EQU   PSARSVTE                                                 08414000
ASM5FLGS EQU   ASM5WKSV+64                                              08415000
ASM5AIA  EQU   ASM5WKSV+60                                              08416000
ASM5GCTR EQU   ASM5WKSV+56                                              08417000
ASM5SR14 EQU   ASM5WKSV+52                                              08418000
@NM00018 EQU   ASM5RGSV+4                                               08419000
ASM5RG2  EQU   ASM5RGSV                                                 08420000
@NM00017 EQU   ASM4RGSV+4                                               08421000
ASM4RG2  EQU   ASM4RGSV                                                 08422000
ASM3SR13 EQU   ASM3WKSV+28                                              08423000
ASM3R14B EQU   ASM3WKSV+24                                              08424000
ASM3R14A EQU   ASM3WKSV+20                                              08425000
ASM3GRPA EQU   ASM3WKSV+16                                              08426000
ASM3TMPA EQU   ASM3WKSV+12                                              08427000
ASM3PIOP EQU   ASM3WKSV+8                                               08428000
ASM3GENQ EQU   ASM3WKSV+4                                               08429000
ASM3SWPQ EQU   ASM3WKSV                                                 08430000
ASM2SR14 EQU   ASM2WRKA+16                                              08431000
@NM00016 EQU   ASM2WRKA+13                                              08432000
ASM2WFLG EQU   ASM2FLGS                                                 08433000
ASM2RFLG EQU   ASM2FLGS                                                 08434000
ASM2DUPQ EQU   ASM2WRKA+8                                               08435000
ASM2CAQ  EQU   ASM2WRKA+4                                               08436000
ASM2PAQ  EQU   ASM2WRKA                                                 08437000
ASM2RGSV EQU   ASM2WKSV                                                 08438000
ASM1NXTA EQU   ASM1WRKA+4                                               08439000
ASM1ASCB EQU   ASM1WRKA                                                 08440000
ASM1RG15 EQU   ASM1RGSV+56                                              08441000
@NM00015 EQU   ASM1RGSV+4                                               08442000
ASM1RG1  EQU   ASM1RGSV                                                 08443000
CVTRV628 EQU   CVTS01+728                                               08444000
CVTRV627 EQU   CVTS01+724                                               08445000
CVTRV626 EQU   CVTS01+720                                               08446000
CVTRV625 EQU   CVTS01+716                                               08447000
CVTRV624 EQU   CVTS01+712                                               08448000
CVTRV623 EQU   CVTS01+708                                               08449000
CVTRV622 EQU   CVTS01+704                                               08450000
CVTRV621 EQU   CVTS01+700                                               08451000
CVTIHASU EQU   CVTS01+696                                               08452000
CVTSUSP  EQU   CVTS01+692                                               08453000
CVTT6SVC EQU   CVTS01+688                                               08454000
CVTCDAL  EQU   CVTS01+684                                               08455000
CVTTCTL  EQU   CVTS01+680                                               08456000
CVTRSUME EQU   CVTS01+676                                               08457000
CVTJTERM EQU   CVTS01+672                                               08458000
CVTASMRM EQU   CVTS01+668                                               08459000
CVTTCASP EQU   CVTS01+664                                               08460000
CVT0PT03 EQU   CVTS01+660                                               08461000
CVT0PT0E EQU   CVTS01+656                                               08462000
CVTRV609 EQU   CVTS01+652                                               08463000
CVTCGK   EQU   CVTS01+648                                               08464000
CVTRAC   EQU   CVTS01+644                                               08465000
CVTRV606 EQU   CVTS01+640                                               08466000
CVTRV605 EQU   CVTS01+636                                               08467000
CVTRV604 EQU   CVTS01+632                                               08468000
CVTEFF02 EQU   CVTS01+628                                               08469000
CVTCBBR  EQU   CVTS01+624                                               08470000
CVTSSCR  EQU   CVTS01+620                                               08471000
CVTEVENT EQU   CVTS01+616                                               08472000
CVTCRCA  EQU   CVTS01+612                                               08473000
CVTTPIO  EQU   CVTS01+608                                               08474000
CVTADV   EQU   CVTS01+604                                               08475000
CVTGSDAB EQU   CVTGSDA                                                  08476000
CVTQV3   EQU   CVTS01+596                                               08477000
CVTQV2   EQU   CVTS01+592                                               08478000
CVTQV1   EQU   CVTS01+588                                               08479000
CVTRPT   EQU   CVTS01+584                                               08480000
CVTSSRB  EQU   CVTS01+580                                               08481000
CVTCSDRL EQU   CVTS01+576                                               08482000
CVTEXP1  EQU   CVTS01+572                                               08483000
CVTRMPMT EQU   CVTS01+568                                               08484000
CVTRMPTT EQU   CVTS01+564                                               08485000
CVTVPSA  EQU   CVTS01+560                                               08486000
CVTVSTOP EQU   CVTS01+556                                               08487000
CVTGTFR8 EQU   CVTS01+552                                               08488000
CVTQUIT  EQU   CVTS01+548                                               08489000
CVTVACR  EQU   CVTS01+544                                               08490000
CVTWTCB  EQU   CVTS01+540                                               08491000
CVTSTPRS EQU   CVTS01+536                                               08492000
CVT0PT02 EQU   CVTS01+532                                               08493000
CVTDARCM EQU   CVTS01+528                                               08494000
CVTIRECM EQU   CVTS01+524                                               08495000
CVTJRECM EQU   CVTS01+520                                               08496000
CVTVEMS0 EQU   CVTS01+516                                               08497000
CVTSPFRR EQU   CVTS01+512                                               08498000
CVTRLSTG EQU   CVTS01+508                                               08499000
CVT0TC0A EQU   CVTS01+504                                               08500000
CVTGMBR  EQU   CVTS01+500                                               08501000
CVTLFRM  EQU   CVTS01+496                                               08502000
CVTRMBR  EQU   CVTS01+492                                               08503000
CVTVIOP  EQU   CVTS01+488                                               08504000
CVTRV307 EQU   CVTS01+486                                               08505000
CVTRV306 EQU   CVTS01+484                                               08506000
CVTRV305 EQU   CVTS01+482                                               08507000
CVTRV304 EQU   CVTS01+480                                               08508000
CVTRV303 EQU   CVTS01+478                                               08509000
CVTRV302 EQU   CVTS01+476                                               08510000
CVTTRCA  EQU   CVTS01+472                                               08511000
CVTRV297 EQU   CVTRV289                                                 08512000
CVTRV296 EQU   CVTRV289                                                 08513000
CVTRV295 EQU   CVTRV289                                                 08514000
CVTRV294 EQU   CVTRV289                                                 08515000
CVTRV293 EQU   CVTRV289                                                 08516000
CVTRV292 EQU   CVTRV289                                                 08517000
CVTRV291 EQU   CVTRV289                                                 08518000
CVTRV290 EQU   CVTRV289                                                 08519000
CVTRV288 EQU   CVTRV280                                                 08520000
CVTRV287 EQU   CVTRV280                                                 08521000
CVTRV286 EQU   CVTRV280                                                 08522000
CVTRV285 EQU   CVTRV280                                                 08523000
CVTRV284 EQU   CVTRV280                                                 08524000
CVTRV283 EQU   CVTRV280                                                 08525000
CVTRV282 EQU   CVTRV280                                                 08526000
CVTRV281 EQU   CVTRV280                                                 08527000
CVTRV279 EQU   CVTRV271                                                 08528000
CVTRV278 EQU   CVTRV271                                                 08529000
CVTRV277 EQU   CVTRV271                                                 08530000
CVTRV276 EQU   CVTRV271                                                 08531000
CVTRV275 EQU   CVTRV271                                                 08532000
CVTRV274 EQU   CVTRV271                                                 08533000
CVTRV273 EQU   CVTRV271                                                 08534000
CVTRV272 EQU   CVTRV271                                                 08535000
CVTRV270 EQU   CVTRV262                                                 08536000
CVTRV269 EQU   CVTRV262                                                 08537000
CVTRV268 EQU   CVTRV262                                                 08538000
CVTRV267 EQU   CVTRV262                                                 08539000
CVTRV266 EQU   CVTRV262                                                 08540000
CVTRV265 EQU   CVTRV262                                                 08541000
CVTRV264 EQU   CVTRV262                                                 08542000
CVTRV263 EQU   CVTRV262                                                 08543000
CVTVSI   EQU   CVTS01+460                                               08544000
CVTVPSIB EQU   CVTS01+456                                               08545000
CVTMFACT EQU   CVTMFRTR                                                 08546000
CVTMFCTL EQU   CVTS01+448                                               08547000
CVTPVBP  EQU   CVTS01+444                                               08548000
CVTPWI   EQU   CVTS01+440                                               08549000
CVTRV254 EQU   CVTS01+438                                               08550000
CVTRV253 EQU   CVTS01+436                                               08551000
CVTRV252 EQU   CVTS01+434                                               08552000
CVTRV251 EQU   CVTS01+433                                               08553000
CVTRV250 EQU   CVTS01+432                                               08554000
CVTRV249 EQU   CVTS01+431                                               08555000
CVTRV248 EQU   CVTS01+430                                               08556000
CVTRV247 EQU   CVTS01+429                                               08557000
CVTRV246 EQU   CVTS01+428                                               08558000
CVTRV245 EQU   CVTRV237                                                 08559000
CVTRV244 EQU   CVTRV237                                                 08560000
CVTRV243 EQU   CVTRV237                                                 08561000
CVTRV242 EQU   CVTRV237                                                 08562000
CVTRV241 EQU   CVTRV237                                                 08563000
CVTRV240 EQU   CVTRV237                                                 08564000
CVTRV239 EQU   CVTRV237                                                 08565000
CVTRV238 EQU   CVTRV237                                                 08566000
CVTRV236 EQU   CVTRV228                                                 08567000
CVTRV235 EQU   CVTRV228                                                 08568000
CVTRV234 EQU   CVTRV228                                                 08569000
CVTRV233 EQU   CVTRV228                                                 08570000
CVTRV232 EQU   CVTRV228                                                 08571000
CVTRV231 EQU   CVTRV228                                                 08572000
CVTRV230 EQU   CVTRV228                                                 08573000
CVTRV229 EQU   CVTRV228                                                 08574000
CVTRV227 EQU   CVTRV219                                                 08575000
CVTRV226 EQU   CVTRV219                                                 08576000
CVTRV225 EQU   CVTRV219                                                 08577000
CVTRV224 EQU   CVTRV219                                                 08578000
CVTRV223 EQU   CVTRV219                                                 08579000
CVTRV222 EQU   CVTRV219                                                 08580000
CVTRV221 EQU   CVTRV219                                                 08581000
CVTRV220 EQU   CVTRV219                                                 08582000
CVTRV218 EQU   CVTRV210                                                 08583000
CVTRV217 EQU   CVTRV210                                                 08584000
CVTRV216 EQU   CVTRV210                                                 08585000
CVTRV215 EQU   CVTRV210                                                 08586000
CVTRV214 EQU   CVTRV210                                                 08587000
CVTRV213 EQU   CVTRV210                                                 08588000
CVTRV212 EQU   CVTRV210                                                 08589000
CVTRV211 EQU   CVTRV210                                                 08590000
CVTLCCAT EQU   CVTS01+420                                               08591000
CVTPCCAT EQU   CVTS01+416                                               08592000
CVTIPCRP EQU   CVTS01+412                                               08593000
CVTIPCRI EQU   CVTS01+408                                               08594000
CVTIPCDS EQU   CVTS01+404                                               08595000
CVTAIDVT EQU   CVTS01+400                                               08596000
CVTSSAP  EQU   CVTS01+396                                               08597000
CVTEHCIR EQU   CVTS01+392                                               08598000
CVTEHDEF EQU   CVTS01+388                                               08599000
CVTDAIR  EQU   CVTS01+384                                               08600000
CVTPERFM EQU   CVTS01+380                                               08601000
CVT044R2 EQU   CVTS01+376                                               08602000
CVTFETCH EQU   CVTS01+372                                               08603000
CVTRSTWD EQU   CVTS01+368                                               08604000
CVTSPOST EQU   CVTS01+364                                               08605000
CVTIOBP  EQU   CVTS01+360                                               08606000
CVTRECRQ EQU   CVTS01+352                                               08607000
CVTWSAC  EQU   CVTS01+348                                               08608000
CVTRV149 EQU   CVTS01+344                                               08609000
CVTWSAL  EQU   CVTS01+340                                               08610000
CVTSPSA  EQU   CVTS01+336                                               08611000
CVTGLMN  EQU   CVTS01+332                                               08612000
CVTVEAC0 EQU   CVTS01+328                                               08613000
CVT062R1 EQU   CVTS01+324                                               08614000
CVTRPOST EQU   CVTS01+320                                               08615000
CVTDQIQE EQU   CVTS01+316                                               08616000
CVTCSD   EQU   CVTS01+312                                               08617000
CVTLKRMA EQU   CVTS01+308                                               08618000
CVTRSPIE EQU   CVTS01+304                                               08619000
CVTRENQ  EQU   CVTS01+300                                               08620000
CVTLQCB  EQU   CVTS01+296                                               08621000
CVTFQCB  EQU   CVTS01+292                                               08622000
CVTQCS01 EQU   CVTS01+288                                               08623000
CVTAPFT  EQU   CVTS01+284                                               08624000
CVTPARRL EQU   CVTS01+280                                               08625000
CVTVWAIT EQU   CVTS01+276                                               08626000
CVTGSPL  EQU   CVTS01+272                                               08627000
CVTLSMQ  EQU   CVTS01+268                                               08628000
CVTGSMQ  EQU   CVTS01+264                                               08629000
CVTEXPRO EQU   CVTS01+260                                               08630000
CVTOPCTP EQU   CVTS01+256                                               08631000
CVTSIC   EQU   CVTS01+252                                               08632000
CVTTPIOS EQU   CVTS01+248                                               08633000
CVTRTMS  EQU   CVTS01+244                                               08634000
CVTSDBF  EQU   CVTS01+240                                               08635000
CVTSCBP  EQU   CVTS01+236                                               08636000
CVTSDMP  EQU   CVTS01+232                                               08637000
CVTSV60  EQU   CVTS01+228                                               08638000
CVTRTMCT EQU   CVTS01+224                                               08639000
CVTASCBL EQU   CVTS01+220                                               08640000
CVTASCBH EQU   CVTS01+216                                               08641000
CVTGDA   EQU   CVTS01+212                                               08642000
CVTASVT  EQU   CVTS01+208                                               08643000
CVTVVMDI EQU   CVTS01+204                                               08644000
CVTAQTOP EQU   CVTS01+200                                               08645000
CVTIOSCS EQU   CVTS01+196                                               08646000
CVTSDRM  EQU   CVTS01+192                                               08647000
CVTOPTE  EQU   CVTS01+188                                               08648000
CVTSTXU  EQU   CVTS01+184                                               08649000
CVTQUIS  EQU   CVTS01+180                                               08650000
CVTPARS  EQU   CVTS01+176                                               08651000
CVTS1EE  EQU   CVTS01+172                                               08652000
CVTFRAS  EQU   CVTS01+168                                               08653000
CVTQSAS  EQU   CVTS01+164                                               08654000
CVTCRAS  EQU   CVTS01+160                                               08655000
CVTCRMN  EQU   CVTS01+156                                               08656000
CVTDELCP EQU   CVTS01+152                                               08657000
CVTFRECL EQU   CVTS01+148                                               08658000
CVTGETCL EQU   CVTS01+144                                               08659000
CVTBLDCP EQU   CVTS01+140                                               08660000
CVTAUTHL EQU   CVTS01+136                                               08661000
CVTSCAN  EQU   CVTS01+132                                               08662000
CVTRV144 EQU   CVTS01+130                                               08663000
CVTMAXMP EQU   CVTS01+128                                               08664000
CVTSTCK  EQU   CVTS01+124                                               08665000
CVTRV139 EQU   CVTS01+123                                               08666000
CVTDSSAC EQU   CVTS01+122                                               08667000
CVTRV513 EQU   CVTS01+121                                               08668000
CVTIOSPL EQU   CVTS01+120                                               08669000
CVTPTGT  EQU   CVTS01+116                                               08670000
CVTCSPIE EQU   CVTS01+112                                               08671000
CVTSMFEX EQU   CVTS01+108                                               08672000
CVTOLT0A EQU   CVTS01+104                                               08673000
CVTSRBRT EQU   CVTS01+100                                               08674000
CVTPUTL  EQU   CVTS01+96                                                08675000
CVTASCRL EQU   CVTS01+92                                                08676000
CVTASCRF EQU   CVTS01+88                                                08677000
CVTRV326 EQU   CVTS01+84                                                08678000
CVTRV325 EQU   CVTS01+80                                                08679000
CVTRV324 EQU   CVTS01+76                                                08680000
CVT0VL01 EQU   CVTS01+72                                                08681000
CVTSHRVM EQU   CVTS01+68                                                08682000
CVTRV332 EQU   CVTS01+64                                                08683000
CVTTAS   EQU   CVTS01+60                                                08684000
CVTRSCN  EQU   CVTS01+56                                                08685000
CVTTRAC2 EQU   CVTS01+54                                                08686000
CVTTRACE EQU   CVTS01+52                                                08687000
CVTAPG   EQU   CVTS01+51                                                08688000
CVTSDTRC EQU   CVTCTLFG                                                 08689000
CVTGTRCE EQU   CVTCTLFG                                                 08690000
CVTNOMP  EQU   CVTCTLFG                                                 08691000
CVTRSV79 EQU   CVTCTLFG                                                 08692000
CVTDSTAT EQU   CVTCTLFG                                                 08693000
CVTRSV78 EQU   CVTCTLFG                                                 08694000
CVTRV333 EQU   CVTCTLFG                                                 08695000
CVTRV323 EQU   CVTCTLFG                                                 08696000
CVTSPVLK EQU   CVTS01+49                                                08697000
CVTRSV77 EQU   CVTS01+48                                                08698000
CVTRV331 EQU   CVTS01+44                                                08699000
CVTRV330 EQU   CVTS01+40                                                08700000
CVTRV329 EQU   CVTS01+36                                                08701000
CVTRV328 EQU   CVTS01+32                                                08702000
CVTRV322 EQU   CVTS01+28                                                08703000
CVTSLID  EQU   CVTSLIDA+1                                               08704000
CVTSYLK  EQU   CVTSLIDA                                                 08705000
CVTRV321 EQU   CVTS01+20                                                08706000
CVTRV320 EQU   CVTS01+16                                                08707000
CVTLPDIR EQU   CVTLPDIA+1                                               08708000
CVTRSV69 EQU   CVTDIRST                                                 08709000
CVTRSV68 EQU   CVTDIRST                                                 08710000
CVTRSV67 EQU   CVTDIRST                                                 08711000
CVTRSV66 EQU   CVTDIRST                                                 08712000
CVTRSV65 EQU   CVTDIRST                                                 08713000
CVTRSV64 EQU   CVTDIRST                                                 08714000
CVTRSV63 EQU   CVTDIRST                                                 08715000
CVTDICOM EQU   CVTDIRST                                                 08716000
CVTPVTP  EQU   CVTS01+8                                                 08717000
CVTLPDSR EQU   CVTS01+4                                                 08718000
CVTGETL  EQU   CVTS01                                                   08719000
@NM00136 EQU   DSTENT+46                                                08720000
@NM00135 EQU   DSTBL+4080                                               08721000
ASCBEND  EQU   ASCB+208                                                 08722000
ASCBSRBT EQU   ASCB+200                                                 08723000
ASCBSWTL EQU   ASCB+196                                                 08724000
ASCBRS14 EQU   ASCB+195                                                 08725000
ASCBSMCT EQU   ASCB+194                                                 08726000
ASCBRS12 EQU   ASCB+192                                                 08727000
ASCBPCTT EQU   ASCB+188                                                 08728000
ASCBVGTT EQU   ASCB+184                                                 08729000
ASCBRV43 EQU   ASCBSRQ4                                                 08730000
ASCBRV42 EQU   ASCBSRQ4                                                 08731000
ASCBRV41 EQU   ASCBSRQ4                                                 08732000
ASCBRV40 EQU   ASCBSRQ4                                                 08733000
ASCBRV39 EQU   ASCBSRQ4                                                 08734000
ASCBRV38 EQU   ASCBSRQ4                                                 08735000
ASCBRV37 EQU   ASCBSRQ4                                                 08736000
ASCBRV36 EQU   ASCBSRQ4                                                 08737000
ASCBRV35 EQU   ASCBSRQ3                                                 08738000
ASCBRV34 EQU   ASCBSRQ3                                                 08739000
ASCBRV33 EQU   ASCBSRQ3                                                 08740000
ASCBRV32 EQU   ASCBSRQ3                                                 08741000
ASCBRV31 EQU   ASCBSRQ3                                                 08742000
ASCBRV30 EQU   ASCBSRQ3                                                 08743000
ASCBRV29 EQU   ASCBSRQ3                                                 08744000
ASCBRV28 EQU   ASCBSRQ3                                                 08745000
ASCBRV27 EQU   ASCBSRQ2                                                 08746000
ASCBRV26 EQU   ASCBSRQ2                                                 08747000
ASCBRV25 EQU   ASCBSRQ2                                                 08748000
ASCBRV24 EQU   ASCBSRQ2                                                 08749000
ASCBRV23 EQU   ASCBSRQ2                                                 08750000
ASCBRV22 EQU   ASCBSRQ2                                                 08751000
ASCBRV21 EQU   ASCBSRQ2                                                 08752000
ASCBRV20 EQU   ASCBSRQ2                                                 08753000
ASCBRV19 EQU   ASCBSRQ1                                                 08754000
ASCBRV18 EQU   ASCBSRQ1                                                 08755000
ASCBRV17 EQU   ASCBSRQ1                                                 08756000
ASCBRV16 EQU   ASCBSRQ1                                                 08757000
ASCBRV15 EQU   ASCBSRQ1                                                 08758000
ASCBRV14 EQU   ASCBSRQ1                                                 08759000
ASCBRV13 EQU   ASCBSRQ1                                                 08760000
ASCBSTA  EQU   ASCBSRQ1                                                 08761000
ASCBJBNS EQU   ASCB+176                                                 08762000
ASCBJBNI EQU   ASCB+172                                                 08763000
ASCBMCC  EQU   ASCB+168                                                 08764000
ASCBRTWA EQU   ASCB+164                                                 08765000
ASCBIQEA EQU   ASCB+160                                                 08766000
ASCBXMPQ EQU   ASCB+156                                                 08767000
ASCBRS01 EQU   ASCB+154                                                 08768000
ASCBFMCT EQU   ASCB+152                                                 08769000
ASCBOUXB EQU   ASCB+148                                                 08770000
ASCBOUCB EQU   ASCB+144                                                 08771000
ASCBMECB EQU   ASCB+140                                                 08772000
ASCBQECB EQU   ASCB+136                                                 08773000
ASCBLSQH EQU   ASCBLKGP+4                                               08774000
ASCBLOCK EQU   ASCBLKGP                                                 08775000
ASCBTCBS EQU   ASCB+124                                                 08776000
ASCBNVSC EQU   ASCB+122                                                 08777000
ASCBVSC  EQU   ASCB+120                                                 08778000
ASCBSRBS EQU   ASCB+118                                                 08779000
ASCBSSRB EQU   ASCB+116                                                 08780000
ASCBRV06 EQU   ASCBFLG2                                                 08781000
ASCBRV05 EQU   ASCBFLG2                                                 08782000
ASCBRV04 EQU   ASCBFLG2                                                 08783000
ASCBSNQS EQU   ASCBFLG2                                                 08784000
ASCBS2S  EQU   ASCBFLG2                                                 08785000
ASCBCEXT EQU   ASCBFLG2                                                 08786000
ASCBPXMT EQU   ASCBFLG2                                                 08787000
ASCBXMPT EQU   ASCBFLG2                                                 08788000
ASCBRF07 EQU   ASCBDSP1                                                 08789000
ASCBRF06 EQU   ASCBDSP1                                                 08790000
ASCBRF05 EQU   ASCBDSP1                                                 08791000
ASCBRF04 EQU   ASCBDSP1                                                 08792000
ASCBRF03 EQU   ASCBDSP1                                                 08793000
ASCBRF02 EQU   ASCBDSP1                                                 08794000
ASCBFAIL EQU   ASCBDSP1                                                 08795000
ASCBNOQ  EQU   ASCBDSP1                                                 08796000
ASCBSWCT EQU   ASCB+112                                                 08797000
ASCBASXB EQU   ASCB+108                                                 08798000
ASCBTMCH EQU   ASCB+104                                                 08799000
ASCBNSWP EQU   ASCBFLG1                                                 08800000
ASCBTYP1 EQU   ASCBFLG1                                                 08801000
ASCBSTND EQU   ASCBFLG1                                                 08802000
ASCBABNT EQU   ASCBFLG1                                                 08803000
ASCBTERM EQU   ASCBFLG1                                                 08804000
ASCBS3S  EQU   ASCBFLG1                                                 08805000
ASCBCMSH EQU   ASCBFLG1                                                 08806000
ASCBTOFF EQU   ASCBFLG1                                                 08807000
ASCBRF01 EQU   ASCBRCTF                                                 08808000
ASCBTMLW EQU   ASCBRCTF                                                 08809000
ASCBOUT  EQU   ASCBRCTF                                                 08810000
ASCBWAIT EQU   ASCBRCTF                                                 08811000
ASCBRV08 EQU   ASCBRCTF                                                 08812000
ASCBFQU  EQU   ASCBRCTF                                                 08813000
ASCBFRS  EQU   ASCBRCTF                                                 08814000
ASCBTMNO EQU   ASCBRCTF                                                 08815000
ASCBAFFN EQU   ASCBFW1                                                  08816000
ASCBDUMP EQU   ASCB+96                                                  08817000
ASCBRV44 EQU   ASCB+92                                                  08818000
ASCBUBET EQU   ASCB+88                                                  08819000
ASCBECB  EQU   ASCB+84                                                  08820000
ASCBJSTL EQU   ASCB+80                                                  08821000
ASCBEWST EQU   ASCB+72                                                  08822000
ASCBEJST EQU   ASCB+64                                                  08823000
ASCBTSB  EQU   ASCB+60                                                  08824000
ASCBCSCB EQU   ASCB+56                                                  08825000
ASCBRSMA EQU   ASCBRSM+1                                                08826000
ASCBRV54 EQU   ASCBRSMF                                                 08827000
ASCBRV53 EQU   ASCBRSMF                                                 08828000
ASCBRV52 EQU   ASCBRSMF                                                 08829000
ASCBRV51 EQU   ASCBRSMF                                                 08830000
ASCBVEQR EQU   ASCBRSMF                                                 08831000
ASCBN2LP EQU   ASCBRSMF                                                 08832000
ASCB1LPU EQU   ASCBRSMF                                                 08833000
ASCB2LPU EQU   ASCBRSMF                                                 08834000
ASCBLDA  EQU   ASCB+48                                                  08835000
ASCBSTOR EQU   ASCB+44                                                  08836000
ASCBDP   EQU   ASCB+43                                                  08837000
ASCBRV07 EQU   ASCB+42                                                  08838000
ASCBIOSM EQU   ASCB+40                                                  08839000
ASCBSEQN EQU   ASCB+38                                                  08840000
ASCBCPUS EQU   ASCB+32                                                  08841000
ASCBSPL  EQU   ASCB+28                                                  08842000
ASCBIOSP EQU   ASCB+24                                                  08843000
ASCBSYNC EQU   ASCBSUPC+4                                               08844000
ASCBSVRB EQU   ASCBSUPC                                                 08845000
ASCBCMSF EQU   ASCB+12                                                  08846000
ASCBBWDP EQU   ASCB+8                                                   08847000
ASCBFWDP EQU   ASCB+4                                                   08848000
ASCBASCB EQU   ASCB                                                     08849000
ASCBEGIN EQU   ASCB                                                     08850000
@NM00109 EQU   SRB+40                                                   08851000
@NM00108 EQU   SRB+38                                                   08852000
SRBPKF   EQU   SRB+36                                                   08853000
SRBSAVE  EQU   SRB+32                                                   08854000
SRBPARM  EQU   SRB+28                                                   08855000
SRBPTCB  EQU   SRBFLC+4                                                 08856000
SRBCPAFF EQU   SRBFLC                                                   08857000
SRBFLNK  EQU   SRB+4                                                    08858000
@NM00107 EQU   SCCWLTIC+4                                               08859000
SCCWLTAD EQU   SCCWLTIC+1                                               08860000
SCCWLTOP EQU   SCCWLTIC                                                 08861000
SCCWRWCT EQU   SCCWRW+6                                                 08862000
@NM00106 EQU   SCCWRW+5                                                 08863000
SCCWRWFL EQU   SCCWRW+4                                                 08864000
SCCWRWAD EQU   SCCWRW+1                                                 08865000
SCCWRWOP EQU   SCCWRW                                                   08866000
@NM00105 EQU   SCCWTIC+4                                                08867000
SCCWTIOP EQU   SCCWTIC                                                  08868000
SCCWSRCT EQU   SCCWSRCH+6                                               08869000
@NM00104 EQU   SCCWSRCH+5                                               08870000
SCCWSRFL EQU   SCCWSRCH+4                                               08871000
SCCWFLCT EQU   SCCWSSEC+4                                               08872000
SCCWSSOP EQU   SCCWSSEC                                                 08873000
SCCWFGCT EQU   SCCWSEEK+4                                               08874000
SCCWSKOP EQU   SCCWSEEK                                                 08875000
SCCWSVOA EQU   SCCWHDR+84                                               08876000
SCCWRSV1 EQU   SCCWSARG+63                                              08877000
SCCWR    EQU   SCCWSRH+4                                                08878000
SCCWHH   EQU   SCCWCCHH+2                                               08879000
SCCWM    EQU   SCCWSARG                                                 08880000
SCCWIORB EQU   SCCWHDR+12                                               08881000
SCCWAIA  EQU   SCCWHDR+8                                                08882000
@NM00103 EQU   SCCWHDR+3                                                08883000
@NM00102 EQU   SCCWFLAG                                                 08884000
SCCWERR  EQU   SCCWFLAG                                                 08885000
SCCWID   EQU   SCCWHDR                                                  08886000
@NM00101 EQU   SATHDR+28                                                08887000
SATASGN  EQU   SATHDR+24                                                08888000
SATSLTNO EQU   SATHDR+20                                                08889000
@NM00100 EQU   SATHDR+15                                                08890000
SATMASK  EQU   SATHDR+14                                                08891000
SATOFFST EQU   SATHDR+12                                                08892000
SRERRCNT EQU   SARTE+24                                                 08893000
SRESCCW  EQU   SARTE+12                                                 08894000
@NM00099 EQU   SREFLG                                                   08895000
SREDRIVE EQU   SREFLG                                                   08896000
SREDSBD  EQU   SREFLG                                                   08897000
SRENUSE  EQU   SREFLG                                                   08898000
@NM00098 EQU   SARTE+8                                                  08899000
SRELOCK  EQU   SARTE+4                                                  08900000
@NM00097 EQU   SARTHDR+60                                               08901000
SARSRBCT EQU   SARTHDR+52                                               08902000
SARWAITL EQU   SARWAITQ+4                                               08903000
SARWAITF EQU   SARWAITQ                                                 08904000
SARDSNL  EQU   SARTHDR+24                                               08905000
@NM00096 EQU   SARTHDR+12                                               08906000
SDCRESV  EQU   SDCTE+18                                                 08907000
SDCSSECT EQU   SDCTE+16                                                 08908000
SDCSLTRK EQU   SDCTE+8                                                  08909000
@NM00095 EQU   SDCT+128                                                 08910000
SDCRSV1  EQU   SDCHDR+6                                                 08911000
SDCID    EQU   SDCHDR                                                   08912000
@NM00094 EQU   IORB+40                                                  08913000
IORRSV   EQU   IORB+36                                                  08914000
IORTSMP  EQU   IORB+24                                                  08915000
IORERR   EQU   IORB+20                                                  08916000
IORSAVE  EQU   IORB+16                                                  08917000
IORIOSB  EQU   IORB+12                                                  08918000
IORSCCW  EQU   IORPCCW                                                  08919000
IORFAE   EQU   IORAPND                                                  08920000
IORFNE   EQU   IORAPND                                                  08921000
IORFDI   EQU   IORAPND                                                  08922000
IORSWAP  EQU   IORFLGS                                                  08923000
@NM00093 EQU   IORFLGS                                                  08924000
IORFRPS  EQU   IORFLGS                                                  08925000
IORFUSE  EQU   IORFLGS                                                  08926000
IORRQSZ  EQU   IORB+2                                                   08927000
IORID    EQU   IORB                                                     08928000
@NM00092 EQU   PARTENT+62                                               08929000
PARELCYL EQU   PARTENT+60                                               08930000
PARENODE EQU   PARTENT+48                                               08931000
PARERRCT EQU   PARTENT+24                                               08932000
PAREIOEQ EQU   PARTENT+12                                               08933000
@NM00091 EQU   PAREFLG1                                                 08934000
PAREINCP EQU   PAREFLG1                                                 08935000
PAREDSBD EQU   PAREFLG1                                                 08936000
@NM00090 EQU   PARETYPE                                                 08937000
PARECPCT EQU   PARELKUP+2                                               08938000
@NM00089 EQU   PARELKFL                                                 08939000
PAREFSIP EQU   PARELKFL                                                 08940000
PARTLOCL EQU   PARTLOCQ+4                                               08941000
PARTLOCF EQU   PARTLOCQ                                                 08942000
PARTDUPL EQU   PARTDUPQ+4                                               08943000
PARTDUPF EQU   PARTDUPQ                                                 08944000
PARTSPLL EQU   PARTSPLQ+4                                               08945000
PARTSPLF EQU   PARTSPLQ                                                 08946000
PARTCOML EQU   PARTCOMQ+4                                               08947000
PARTCOMF EQU   PARTCOMQ                                                 08948000
PARTLOCK EQU   PARTHDR+44                                               08949000
PARTLKUP EQU   PARTHDR+40                                               08950000
@NM00088 EQU   PARTHDR+34                                               08951000
PARTDSNL EQU   PARTTPAR                                                 08952000
PARTAIAE EQU   PARTHDR+12                                               08953000
PATRSV1  EQU   PATHDR+14                                                08954000
PCTTRBA  EQU   PCTSECT+2                                                08955000
PCTSECNM EQU   PCTSECT+1                                                08956000
PCTSLOT  EQU   PCTSLTNM                                                 08957000
PCTFOVFL EQU   PCTSLTNM                                                 08958000
PCTMSSB  EQU   PCT+38                                                   08959000
PCTMAXTK EQU   PCT+36                                                   08960000
PCTSSECN EQU   PCT+30                                                   08961000
PCTDPGWT EQU   PCT+28                                                   08962000
PCTSMAX  EQU   PCT+10                                                   08963000
PCTID    EQU   PCT                                                      08964000
XPTLSID2 EQU   XPTLPN                                                   08965000
XPTLSID  EQU   XPTLGN                                                   08966000
@NM00087 EQU   XPTFLAG2                                                 08967000
XPTIOERR EQU   XPTFLAG2                                                 08968000
XPTPOINP EQU   XPTFLAG2                                                 08969000
XPTRES1  EQU   XPTFLAG2                                                 08970000
XPTRSV4  EQU   XPTFLAGS                                                 08971000
XPTDEFER EQU   XPTFLAGS                                                 08972000
XPTRES2  EQU   XPTFLAGS                                                 08973000
XPTVIO   EQU   XPTFLAGS                                                 08974000
@NM00086 EQU   XPTFLAGS                                                 08975000
XPTCKF   EQU   XPTFLAGS                                                 08976000
XPTVIOLP EQU   XPTFLAGS                                                 08977000
XPTRSV1  EQU   XPTE+1                                                   08978000
XPTPROT  EQU   XPTE                                                     08979000
NIPPTSID EQU   NIPPTE+6                                                 08980000
@NM00085 EQU   NIPPTATF                                                 08981000
NIPPTMRG EQU   NIPPTATF                                                 08982000
@NM00084 EQU   NIPPTOPF                                                 08983000
NIPPTCAN EQU   NIPPTOPF                                                 08984000
NIPPTOPI EQU   NIPPTOPF                                                 08985000
NIPPTADR EQU   NIPPTE                                                   08986000
PTABEND  EQU   PARMTAB+312                                              08987000
@NM00083 EQU   PARMTAB+308                                              08988000
@NM00082 EQU   PARMTAB+300                                              08989000
@NM00081 EQU   PARMTAB+292                                              08990000
@NM00080 EQU   PARMTAB+284                                              08991000
RSU      EQU   PARMTAB+280                                              08992000
@NM00079 EQU   @NM00077+1                                               08993000
@NM00078 EQU   NIPPAFLG                                                 08994000
NIPPAFL1 EQU   NIPPAFLG                                                 08995000
@NM00076 EQU   PARMTAB+268                                              08996000
PURGE    EQU   PARMTAB+264                                              08997000
@NM00075 EQU   PARMTAB+260                                              08998000
WTORPLY  EQU   PARMTAB+256                                              08999000
@NM00074 EQU   PARMTAB+252                                              09000000
WTOBFRS  EQU   PARMTAB+248                                              09001000
@NM00073 EQU   PARMTAB+244                                              09002000
VRREGN   EQU   PARMTAB+240                                              09003000
@NM00072 EQU   PARMTAB+236                                              09004000
VAL      EQU   PARMTAB+232                                              09005000
@NM00071 EQU   PARMTAB+228                                              09006000
SYSP     EQU   PARMTAB+224                                              09007000
@NM00070 EQU   PARMTAB+220                                              09008000
SQA      EQU   PARMTAB+216                                              09009000
@NM00069 EQU   PARMTAB+212                                              09010000
SMF      EQU   PARMTAB+208                                              09011000
@NM00068 EQU   PARMTAB+204                                              09012000
REAL     EQU   PARMTAB+200                                              09013000
@NM00067 EQU   PARMTAB+196                                              09014000
@NM00066 EQU   PARMTAB+188                                              09015000
@NM00065 EQU   PARMTAB+180                                              09016000
OPT      EQU   PARMTAB+176                                              09017000
@NM00064 EQU   PARMTAB+172                                              09018000
OPI      EQU   PARMTAB+168                                              09019000
@NM00063 EQU   PARMTAB+164                                              09020000
NUCMAP   EQU   PARMTAB+160                                              09021000
@NM00062 EQU   PARMTAB+156                                              09022000
MLPA     EQU   PARMTAB+152                                              09023000
@NM00061 EQU   PARMTAB+148                                              09024000
MAXUSER  EQU   PARMTAB+144                                              09025000
@NM00060 EQU   PARMTAB+140                                              09026000
LOGLMT   EQU   PARMTAB+136                                              09027000
@NM00059 EQU   PARMTAB+132                                              09028000
LOGCLS   EQU   PARMTAB+128                                              09029000
@NM00058 EQU   PARMTAB+124                                              09030000
LNK      EQU   PARMTAB+120                                              09031000
@NM00057 EQU   PARMTAB+116                                              09032000
IPS      EQU   PARMTAB+112                                              09033000
@NM00056 EQU   PARMTAB+108                                              09034000
HARDCPY  EQU   PARMTAB+104                                              09035000
@NM00055 EQU   PARMTAB+100                                              09036000
FIX      EQU   PARMTAB+96                                               09037000
@NM00054 EQU   PARMTAB+92                                               09038000
DUMP     EQU   PARMTAB+88                                               09039000
@NM00053 EQU   PARMTAB+84                                               09040000
CVIO     EQU   PARMTAB+80                                               09041000
@NM00052 EQU   PARMTAB+76                                               09042000
CSA      EQU   PARMTAB+72                                               09043000
@NM00051 EQU   PARMTAB+68                                               09044000
CPQE     EQU   PARMTAB+64                                               09045000
@NM00050 EQU   PARMTAB+60                                               09046000
CONT     EQU   PARMTAB+56                                               09047000
@NM00049 EQU   PARMTAB+52                                               09048000
CMD      EQU   PARMTAB+48                                               09049000
@NM00048 EQU   PARMTAB+44                                               09050000
CLPA     EQU   PARMTAB+40                                               09051000
@NM00047 EQU   PARMTAB+36                                               09052000
BLDLF    EQU   PARMTAB+32                                               09053000
@NM00046 EQU   PARMTAB+28                                               09054000
BLDL     EQU   PARMTAB+24                                               09055000
@NM00045 EQU   PARMTAB+20                                               09056000
APG      EQU   PARMTAB+16                                               09057000
@NM00044 EQU   PARMTAB+12                                               09058000
APF      EQU   PARMTAB+8                                                09059000
PTABSTRT EQU   PARMTAB                                                  09060000
NIPPABUF EQU   NIPPAREA+572                                             09061000
NIPPAPTB EQU   NIPPAREA+252                                             09062000
@NM00043 EQU   NIPPAREA+248                                             09063000
NIPPARCD EQU   NIPPAIOD+136                                             09064000
NIPPADEB EQU   NIPPAIOD+88                                              09065000
@NM00042 EQU   NIPPAECB+1                                               09066000
NIPPAECC EQU   NIPPAECB                                                 09067000
NIPPADCB EQU   NIPPAIOD+80                                              09068000
NIPPAIOB EQU   NIPPAIOD+40                                              09069000
@NM00041 EQU   NIPPAIOD+37                                              09070000
NIPPASID EQU   NIPPAIOD+32                                              09071000
NIPPATXT EQU   NIPPAIOD                                                 09072000
@NM00040 EQU   NIPPAREA+30                                              09073000
@NM00039 EQU   NIPPABDL+15                                              09074000
NIPPATTR EQU   NIPPABDL+12                                              09075000
NIPPANAM EQU   NIPPABDL+4                                               09076000
NIPPA2BF EQU   NIPPABDH                                                 09077000
NIPPARC  EQU   NIPPAREA+8                                               09078000
@NM00038 EQU   NIPPAREA                                                 09079000
NIPPABYT EQU   NIPPAHDR+4                                               09080000
NIPPAQ   EQU   NIPPAHDR                                                 09081000
CVTLEVL  EQU   CVTRELNO+2                                               09082000
CVTNUMB  EQU   CVTRELNO                                                 09083000
CVTMDL   EQU   CVTFIX+250                                               09084000
@NM00037 EQU   CVTFIX+248                                               09085000
@NM00036 EQU   CVTFIX                                                   09086000
CVTRV482 EQU   CVTXTNT2+128                                             09087000
CVTRV481 EQU   CVTXTNT2+124                                             09088000
CVTRV480 EQU   CVTXTNT2+120                                             09089000
CVTRV479 EQU   CVTXTNT2+118                                             09090000
CVTRV478 EQU   CVTXTNT2+117                                             09091000
CVTRV477 EQU   CVTXTNT2+116                                             09092000
CVTRV476 EQU   CVTXTNT2+115                                             09093000
CVTRV475 EQU   CVTXTNT2+114                                             09094000
CVTRV474 EQU   CVTRV466                                                 09095000
CVTRV473 EQU   CVTRV466                                                 09096000
CVTRV472 EQU   CVTRV466                                                 09097000
CVTRV471 EQU   CVTRV466                                                 09098000
CVTRV470 EQU   CVTRV466                                                 09099000
CVTRV469 EQU   CVTRV466                                                 09100000
CVTRV468 EQU   CVTRV466                                                 09101000
CVTRV467 EQU   CVTRV466                                                 09102000
CVTRV465 EQU   CVTRV457                                                 09103000
CVTRV464 EQU   CVTRV457                                                 09104000
CVTRV463 EQU   CVTRV457                                                 09105000
CVTRV462 EQU   CVTRV457                                                 09106000
CVTRV461 EQU   CVTRV457                                                 09107000
CVTRV460 EQU   CVTRV457                                                 09108000
CVTRV459 EQU   CVTRV457                                                 09109000
CVTRV458 EQU   CVTRV457                                                 09110000
CVTRV456 EQU   CVTXTNT2+108                                             09111000
CVTRV455 EQU   CVTXTNT2+104                                             09112000
CVTRV454 EQU   CVTXTNT2+100                                             09113000
CVTRV453 EQU   CVTXTNT2+96                                              09114000
CVTRV452 EQU   CVTXTNT2+94                                              09115000
CVTRV451 EQU   CVTXTNT2+92                                              09116000
CVTRV450 EQU   CVTXTNT2+90                                              09117000
CVTRV449 EQU   CVTXTNT2+88                                              09118000
CVTRV448 EQU   CVTXTNT2+87                                              09119000
CVTRV447 EQU   CVTXTNT2+86                                              09120000
CVTRV446 EQU   CVTRV438                                                 09121000
CVTRV445 EQU   CVTRV438                                                 09122000
CVTRV444 EQU   CVTRV438                                                 09123000
CVTRV443 EQU   CVTRV438                                                 09124000
CVTRV442 EQU   CVTRV438                                                 09125000
CVTRV441 EQU   CVTRV438                                                 09126000
CVTRV440 EQU   CVTRV438                                                 09127000
CVTRV439 EQU   CVTRV438                                                 09128000
CVTRV437 EQU   CVTRV429                                                 09129000
CVTRV436 EQU   CVTRV429                                                 09130000
CVTRV435 EQU   CVTRV429                                                 09131000
CVTRV434 EQU   CVTRV429                                                 09132000
CVTRV433 EQU   CVTRV429                                                 09133000
CVTRV432 EQU   CVTRV429                                                 09134000
CVTRV431 EQU   CVTRV429                                                 09135000
CVTRV430 EQU   CVTRV429                                                 09136000
CVTRV428 EQU   CVTXTNT2+80                                              09137000
CVTRV427 EQU   CVTXTNT2+76                                              09138000
CVTRV426 EQU   CVTXTNT2+72                                              09139000
CVTRV425 EQU   CVTXTNT2+68                                              09140000
CVTATACT EQU   CVTATCVT                                                 09141000
CVTRV423 EQU   CVTXTNT2+62                                              09142000
CVTRV422 EQU   CVTXTNT2+60                                              09143000
CVTRV421 EQU   CVTXTNT2+58                                              09144000
CVTRV420 EQU   CVTXTNT2+56                                              09145000
CVTRV419 EQU   CVTXTNT2+55                                              09146000
CVTRV418 EQU   CVTXTNT2+54                                              09147000
CVTRV417 EQU   CVTRV409                                                 09148000
CVTRV416 EQU   CVTRV409                                                 09149000
CVTRV415 EQU   CVTRV409                                                 09150000
CVTRV414 EQU   CVTRV409                                                 09151000
CVTRV413 EQU   CVTRV409                                                 09152000
CVTRV412 EQU   CVTRV409                                                 09153000
CVTRV411 EQU   CVTRV409                                                 09154000
CVTRV410 EQU   CVTRV409                                                 09155000
CVTRV408 EQU   CVTRV400                                                 09156000
CVTRV407 EQU   CVTRV400                                                 09157000
CVTRV406 EQU   CVTRV400                                                 09158000
CVTRV405 EQU   CVTRV400                                                 09159000
CVTRV404 EQU   CVTRV400                                                 09160000
CVTRV403 EQU   CVTRV400                                                 09161000
CVTRV402 EQU   CVTRV400                                                 09162000
CVTRV401 EQU   CVTRV400                                                 09163000
CVTICB   EQU   CVTXTNT2+48                                              09164000
CVTSKTA  EQU   CVTXTNT2+44                                              09165000
CVTRSV99 EQU   CVTXTNT2+40                                              09166000
CVTRSV98 EQU   CVTXTNT2+36                                              09167000
CVTRSV97 EQU   CVTXTNT2+34                                              09168000
CVTRSV96 EQU   CVTXTNT2+32                                              09169000
CVTOLTEP EQU   CVTXTNT2+28                                              09170000
CVTQIDA  EQU   CVTQID+1                                                 09171000
CVTRSV95 EQU   CVTQID                                                   09172000
CVTRSV94 EQU   CVTXTNT2+20                                              09173000
CVTRSV93 EQU   CVTXTNT2+16                                              09174000
CVTRSV92 EQU   CVTXTNT2+12                                              09175000
CVTDEBVR EQU   CVTXTNT2+8                                               09176000
CVTRSV91 EQU   CVTXTNT2+6                                               09177000
CVTRSV9H EQU   CVTFLGBT                                                 09178000
CVTRSV9G EQU   CVTFLGBT                                                 09179000
CVTRSV9F EQU   CVTFLGBT                                                 09180000
CVTRSV9E EQU   CVTFLGBT                                                 09181000
CVTRSV9D EQU   CVTFLGBT                                                 09182000
CVTRSV9C EQU   CVTFLGBT                                                 09183000
CVTVME   EQU   CVTFLGBT                                                 09184000
CVTNPE   EQU   CVTFLGBT                                                 09185000
CVTNUCLS EQU   CVTXTNT2+4                                               09186000
CVTDSSVA EQU   CVTDSSV+1                                                09187000
CVTRSV89 EQU   CVTDSSV                                                  09188000
CVTRSV88 EQU   CVTXTNT1+8                                               09189000
CVTRSV87 EQU   CVTXTNT1+4                                               09190000
CVTFACHN EQU   CVTXTNT1                                                 09191000
CVTRV488 EQU   CVTMAP+412                                               09192000
CVTRV487 EQU   CVTMAP+408                                               09193000
CVTRV486 EQU   CVTMAP+404                                               09194000
CVTRV485 EQU   CVTMAP+400                                               09195000
CVTACTAP EQU   CVTMAP+396                                               09196000
CVTAUTH  EQU   CVTMAP+392                                               09197000
CVTATMCA EQU   CVTATMCT+1                                               09198000
CVTATMST EQU   CVTATMCT                                                 09199000
CVTRSV61 EQU   CVTMAP+384                                               09200000
CVTVOLT1 EQU   CVTVOLM1+1                                               09201000
CVTVOLI1 EQU   CVTVOLF1                                                 09202000
CVTSTOA  EQU   CVTMAP+376                                               09203000
CVTRSV58 EQU   CVTMAP+374                                               09204000
CVTRSV57 EQU   CVTMAP+372                                               09205000
CVTDDCE  EQU   CVTMAP+368                                               09206000
CVTPNWFR EQU   CVTMAP+364                                               09207000
CVTSMF   EQU   CVTMAP+360                                               09208000
CVTSULK  EQU   CVTMAP+358                                               09209000
CVTSLKO  EQU   CVTSYSK                                                  09210000
CVTSLKP  EQU   CVTSYSK                                                  09211000
CVTSLKQ  EQU   CVTSYSK                                                  09212000
CVTSLKR  EQU   CVTSYSK                                                  09213000
CVTRSV56 EQU   CVTSYSK                                                  09214000
CVTRSV55 EQU   CVTSYSK                                                  09215000
CVTRSV54 EQU   CVTSYSK                                                  09216000
CVTRSV53 EQU   CVTSYSK                                                  09217000
CVTRSV52 EQU   CVTA1F1                                                  09218000
CVTRSV51 EQU   CVTA1F1                                                  09219000
CVTRSV50 EQU   CVTA1F1                                                  09220000
CVTRSV49 EQU   CVTA1F1                                                  09221000
CVTRSV48 EQU   CVTA1F1                                                  09222000
CVTRSV47 EQU   CVTA1F1                                                  09223000
CVTSRSW  EQU   CVTA1F1                                                  09224000
CVTPFSW  EQU   CVTA1F1                                                  09225000
CVTPCVT  EQU   CVTMAP+352                                               09226000
CVTRSV46 EQU   CVTMAP+344                                               09227000
CVTRSV45 EQU   CVTMAP+340                                               09228000
CVTRSV44 EQU   CVTMAP+338                                               09229000
CVTRSV43 EQU   CVTMAP+336                                               09230000
CVTHJESA EQU   CVTHJES+1                                                09231000
CVTRSV42 EQU   CVTHJES                                                  09232000
CVTEXT2A EQU   CVTEXT2+1                                                09233000
CVTRSV41 EQU   CVTEXT2                                                  09234000
CVTAPFA  EQU   CVTAPF+1                                                 09235000
CVTRSV40 EQU   CVTAPF                                                   09236000
CVTRV518 EQU   CVTINTLA                                                 09237000
CVTRV517 EQU   CVTERPV                                                  09238000
CVTEORM  EQU   CVTMAP+312                                               09239000
CVTMCHPR EQU   CVTMAP+308                                               09240000
CVTTZ    EQU   CVTMAP+304                                               09241000
CVTJEPS  EQU   CVTMAP+300                                               09242000
CVTJESCT EQU   CVTMAP+296                                               09243000
CVTMODE  EQU   CVTMAP+292                                               09244000
CVTPTRV  EQU   CVTMAP+288                                               09245000
CVTREAL  EQU   CVTMAP+284                                               09246000
CVTRSV39 EQU   CVTMAP+280                                               09247000
CVTRSV38 EQU   CVTMAP+276                                               09248000
CVTDMSRA EQU   CVTDMSR+1                                                09249000
CVTRV634 EQU   CVTDMSRF                                                 09250000
CVTRV633 EQU   CVTDMSRF                                                 09251000
CVTRV632 EQU   CVTDMSRF                                                 09252000
CVTRV631 EQU   CVTDMSRF                                                 09253000
CVTRV630 EQU   CVTDMSRF                                                 09254000
CVTRV629 EQU   CVTDMSRF                                                 09255000
CVTUDUMP EQU   CVTDMSRF                                                 09256000
CVTSDUMP EQU   CVTDMSRF                                                 09257000
CVTQMSGA EQU   CVTQMSG+1                                                09258000
CVTRSV36 EQU   CVTQMSG                                                  09259000
CVTAMFF  EQU   CVTMAP+264                                               09260000
CVTPURGA EQU   CVTPURG+1                                                09261000
CVTRSV35 EQU   CVTPURG                                                  09262000
CVTCBSP  EQU   CVTMAP+256                                               09263000
CVTATERA EQU   CVTATER+1                                                09264000
CVTSYST  EQU   CVTATER                                                  09265000
CVTVOLT2 EQU   CVTTAT                                                   09266000
CVTVOLI2 EQU   CVTVOLF2                                                 09267000
CVTAQAVB EQU   CVTAQAVT+1                                               09268000
CVTRSV34 EQU   CVTTCMFG                                                 09269000
CVTRSV33 EQU   CVTTCMFG                                                 09270000
CVTRSV32 EQU   CVTTCMFG                                                 09271000
CVTRSV31 EQU   CVTTCMFG                                                 09272000
CVTRSV30 EQU   CVTTCMFG                                                 09273000
CVTRSV29 EQU   CVTTCMFG                                                 09274000
CVTLDEV  EQU   CVTTCMFG                                                 09275000
CVTTCRDY EQU   CVTTCMFG                                                 09276000
CVTGTFA  EQU   CVTGTF+1                                                 09277000
CVTRSV27 EQU   CVTGTFST                                                 09278000
CVTRNIO  EQU   CVTGTFST                                                 09279000
CVTUSR   EQU   CVTGTFST                                                 09280000
CVTRV318 EQU   CVTFORM                                                  09281000
CVTRV317 EQU   CVTTMODE                                                 09282000
CVTRV316 EQU   CVTSTATE                                                 09283000
CVTRV315 EQU   CVTGTFS                                                  09284000
CVTGTFAV EQU   CVTGTFS                                                  09285000
CVT0SCR1 EQU   CVTMAP+232                                               09286000
CVTRV515 EQU   CVTMAP+228                                               09287000
CVTRMS   EQU   CVTMAP+224                                               09288000
CVTPATCH EQU   CVTMAP+220                                               09289000
CVTTSCE  EQU   CVTMAP+216                                               09290000
CVTLNKSC EQU   CVTMAP+214                                               09291000
CVTQABST EQU   CVTMAP+212                                               09292000
CVTMDLDS EQU   CVTMAP+208                                               09293000
CVTUSER  EQU   CVTMAP+204                                               09294000
CVTABEND EQU   CVTMAP+200                                               09295000
CVTSMCA  EQU   CVTMAP+196                                               09296000
CVTRSV18 EQU   CVTMAP+192                                               09297000
CVTQLPAQ EQU   CVTMAP+188                                               09298000
CVTQCDSR EQU   CVTMAP+184                                               09299000
CVTRSV17 EQU   CVTOPTB                                                  09300000
CVTRSV16 EQU   CVTOPTB                                                  09301000
CVTFP    EQU   CVTOPTB                                                  09302000
CVTAPTHR EQU   CVTOPTB                                                  09303000
CVTNLOG  EQU   CVTOPTB                                                  09304000
CVTTOD   EQU   CVTOPTB                                                  09305000
CVTCTIMS EQU   CVTOPTB                                                  09306000
CVTPROT  EQU   CVTOPTB                                                  09307000
CVTXPFP  EQU   CVTOPTA                                                  09308000
CVTASCII EQU   CVTOPTA                                                  09309000
CVTRSV13 EQU   CVTOPTA                                                  09310000
CVTRSV12 EQU   CVTOPTA                                                  09311000
CVTNIP   EQU   CVTOPTA                                                  09312000
CVTDDR   EQU   CVTOPTA                                                  09313000
CVTAPR   EQU   CVTOPTA                                                  09314000
CVTCCH   EQU   CVTOPTA                                                  09315000
CVTSNCTR EQU   CVTMAP+180                                               09316000
CVTQMWR  EQU   CVTMAP+176                                               09317000
CVTQOCR  EQU   CVTMAP+172                                               09318000
CVT1EF00 EQU   CVTMAP+168                                               09319000
CVTMZ00  EQU   CVTMAP+164                                               09320000
CVTSV76Q EQU   CVTSV76C                                                 09321000
CVTRSV11 EQU   CVTMAP+156                                               09322000
CVT0PT01 EQU   CVTMAP+152                                               09323000
CVTMSER  EQU   CVTMAP+148                                               09324000
CVTRV516 EQU   CVTIERLC                                                 09325000
CVTILCH  EQU   CVTMAP+140                                               09326000
CVT0DS   EQU   CVTMAP+136                                               09327000
CVTFBOSV EQU   CVTMAP+132                                               09328000
CVTNUCB  EQU   CVTMAP+128                                               09329000
CVTIXAVL EQU   CVTMAP+124                                               09330000
CVTSV76M EQU   CVTIOQET                                                 09331000
CVTDCBA  EQU   CVTMAP+117                                               09332000
CVTMVS2  EQU   CVTDCB                                                   09333000
CVT6DAT  EQU   CVTDCB                                                   09334000
CVT4MPS  EQU   CVTDCB                                                   09335000
CVTRSV09 EQU   CVTDCB                                                   09336000
CVT4MS1  EQU   CVTDCB                                                   09337000
CVT2SPS  EQU   CVTDCB                                                   09338000
CVT1SSS  EQU   CVTDCB                                                   09339000
CVTRSV08 EQU   CVTDCB                                                   09340000
CVTSTB   EQU   CVTMAP+112                                               09341000
CVTQTD00 EQU   CVTMAP+108                                               09342000
CVTQTE00 EQU   CVTMAP+104                                               09343000
CVTCUCB  EQU   CVTMAP+100                                               09344000
CVTSJQ   EQU   CVTMAP+96                                                09345000
CVTPBLDL EQU   CVTMAP+92                                                09346000
CVTTPC   EQU   CVTMAP+88                                                09347000
CVTSVDCB EQU   CVTMAP+84                                                09348000
CVTBRET  EQU   CVTMAP+82                                                09349000
CVTEXIT  EQU   CVTMAP+80                                                09350000
CVT0FN00 EQU   CVTMAP+76                                                09351000
CVTDARA  EQU   CVTDAR+1                                                 09352000
CVTRSV07 EQU   CVTFLGS1                                                 09353000
CVTRSV06 EQU   CVTFLGS1                                                 09354000
CVTRSV05 EQU   CVTFLGS1                                                 09355000
CVTRSV04 EQU   CVTFLGS1                                                 09356000
CVTRSV03 EQU   CVTFLGS1                                                 09357000
CVTRSV02 EQU   CVTFLGS1                                                 09358000
CVTRSV01 EQU   CVTFLGS1                                                 09359000
CVTDMPLK EQU   CVTFLGS1                                                 09360000
CVTXITP  EQU   CVTMAP+68                                                09361000
CVTZDTAB EQU   CVTMAP+64                                                09362000
CVTMSLT  EQU   CVTMAP+60                                                09363000
CVTDATE  EQU   CVTMAP+56                                                09364000
CVTBTERM EQU   CVTMAP+52                                                09365000
CVTSYSAD EQU   CVTMAP+48                                                09366000
CVTXTLER EQU   CVTMAP+44                                                09367000
CVTILK2  EQU   CVTMAP+40                                                09368000
CVTILK1  EQU   CVTMAP+36                                                09369000
CVTPRLTV EQU   CVTMAP+32                                                09370000
CVTPCNVT EQU   CVTMAP+28                                                09371000
CVT0VL00 EQU   CVTMAP+24                                                09372000
CVTXAPG  EQU   CVTMAP+20                                                09373000
CVTBUF   EQU   CVTMAP+16                                                09374000
CVTJOB   EQU   CVTMAP+12                                                09375000
CVTLINK  EQU   CVTMAP+8                                                 09376000
CVT0EF00 EQU   CVTMAP+4                                                 09377000
CVTTCBP  EQU   CVTMAP                                                   09378000
CVT      EQU   CVTMAP                                                   09379000
NVTRMSG  EQU   NVT+540                                                  09380000
NVTRLOCK EQU   NVT+536                                                  09381000
NVTRCODE EQU   NVT+532                                                  09382000
@NM00035 EQU   NVT+529                                                  09383000
@NM00034 EQU   NVTFLPO                                                  09384000
@NM00033 EQU   NVTFLPO                                                  09385000
NVTSYSP  EQU   NVTFLPO                                                  09386000
NVTFLLST EQU   NVTFLPO                                                  09387000
NVTRSV48 EQU   NVT+524                                                  09388000
NVTRSV47 EQU   NVT+520                                                  09389000
NVTRSV46 EQU   NVT+516                                                  09390000
@NM00032 EQU   NVT+512                                                  09391000
NVTREALR EQU   NVT+508                                                  09392000
NVTFASVT EQU   NVT+504                                                  09393000
NVTRSV45 EQU   NVT+496                                                  09394000
NVTVRLNG EQU   NVT+492                                                  09395000
NVTVRREG EQU   NVT+488                                                  09396000
NVTLVIRT EQU   NVT+484                                                  09397000
NVTRSV4A EQU   NVT+480                                                  09398000
NVTRMSS  EQU   NVT+472                                                  09399000
NVTRPQE  EQU   NVT+468                                                  09400000
NVTRLLE  EQU   NVT+464                                                  09401000
NVTRJPQ  EQU   NVT+460                                                  09402000
NVTVMSS  EQU   NVT+456                                                  09403000
NVTVPQE  EQU   NVT+452                                                  09404000
NVTVLLE  EQU   NVT+448                                                  09405000
NVTVJPQ  EQU   NVT+444                                                  09406000
NVTLSEC  EQU   NVTLOCAT+4                                               09407000
NVTLFST  EQU   NVTLOCAT                                                 09408000
NVTXSEC  EQU   NVTXCTL+4                                                09409000
NVTXFST  EQU   NVTXCTL                                                  09410000
@NM00031 EQU   NVT+425                                                  09411000
NVTLPACT EQU   NVT+424                                                  09412000
NVTCSLPG EQU   NVT+420                                                  09413000
NVTCSIOB EQU   NVT+416                                                  09414000
NVTCSLNM EQU   NVT+412                                                  09415000
NVTCSLIB EQU   NVT+408                                                  09416000
NVTBLDL  EQU   NVT+404                                                  09417000
NVTVRBLD EQU   NVT+400                                                  09418000
@NM00030 EQU   NVT+392                                                  09419000
NVTVRTCB EQU   NVT+388                                                  09420000
NVTVVTCB EQU   NVT+384                                                  09421000
NVTSPUCB EQU   NVT+382                                                  09422000
NVTRSV44 EQU   NVT+380                                                  09423000
NVTPAREA EQU   NVT+368                                                  09424000
NVTRSV43 EQU   NVT+364                                                  09425000
@NM00029 EQU   NVT+363                                                  09426000
NVTABWS1 EQU   NVT+362                                                  09427000
NVTABCD1 EQU   NVT+360                                                  09428000
@NM00028 EQU   NVT+358                                                  09429000
NVTCPUAD EQU   NVT+356                                                  09430000
NVTTOD   EQU   NVT+352                                                  09431000
NVTSPE   EQU   NVT+344                                                  09432000
NVTMBEND EQU   NVT+340                                                  09433000
NVTMBUF  EQU   NVT+336                                                  09434000
NVTDCBSN EQU   NVT+332                                                  09435000
NVTDCBOC EQU   NVT+328                                                  09436000
NVTDCBIC EQU   NVT+324                                                  09437000
@NM00027 EQU   NVT+308                                                  09438000
NVTNMBLD EQU   NVT+304                                                  09439000
NVTNIPM  EQU   NVT+292                                                  09440000
NVTIX    EQU   NVTFLWSC                                                 09441000
NVTFLWS1 EQU   NVTWPSW2+2                                               09442000
NVTIDPSW EQU   NVTWPSW2                                                 09443000
NVTWPSW1 EQU   NVTWTPSW                                                 09444000
NVTMCPSW EQU   NVT+216                                                  09445000
@NM00026 EQU   NVT+212                                                  09446000
@NM00025 EQU   NVTFLCN                                                  09447000
NVTFLRAC EQU   NVTFLCN                                                  09448000
NVTFLNCK EQU   NVTFLCN                                                  09449000
NVTFLNHC EQU   NVTFLCN                                                  09450000
NVTFLASM EQU   NVTFLCN                                                  09451000
NVTMP    EQU   NVTFLCN                                                  09452000
NVTFLIOC EQU   NVTFLCN                                                  09453000
NVTFLAC  EQU   NVTFLCN                                                  09454000
NVTFLSG  EQU   NVT+210                                                  09455000
NVTTRACE EQU   NVT+208                                                  09456000
NVTNXPTR EQU   NVT+204                                                  09457000
NVTNXSIZ EQU   NVT+202                                                  09458000
@NM00024 EQU   NVT+200                                                  09459000
NVTSGPSA EQU   NVT+196                                                  09460000
NVTN0MSG EQU   NVT+192                                                  09461000
NVTVVPG1 EQU   NVT+188                                                  09462000
NVTSTMAP EQU   NVT+176                                                  09463000
NVTRTMSA EQU   NVT+172                                                  09464000
NVTMFASA EQU   NVT+168                                                  09465000
NVTLSPQE EQU   NVT+164                                                  09466000
NVTALSQA EQU   NVT+160                                                  09467000
NVTPQSAV EQU   NVT+156                                                  09468000
NVTSVC60 EQU   NVT+148                                                  09469000
NVTABSEC EQU   NVTABSAV+4                                               09470000
NVTABFST EQU   NVTABSAV                                                 09471000
NVTNVSQA EQU   NVT+138                                                  09472000
NVTRSVMN EQU   NVT+136                                                  09473000
NVTNBMIN EQU   NVT+134                                                  09474000
NVTRGNAV EQU   NVT+132                                                  09475000
NVTLSQNO EQU   NVT+130                                                  09476000
NVTSQANO EQU   NVT+128                                                  09477000
NVTLSQAS EQU   NVT+124                                                  09478000
NVTLNGFX EQU   NVT+120                                                  09479000
NVTIGXER EQU   NVT+116                                                  09480000
@NM00023 EQU   NVT+112                                                  09481000
NVTRSV49 EQU   NVT+108                                                  09482000
NVTNVRSZ EQU   NVT+104                                                  09483000
NVTMFA   EQU   NVT+100                                                  09484000
NVTDSSNG EQU   NVT+96                                                   09485000
NVTMSLNK EQU   NVT+92                                                   09486000
NVTVVMDI EQU   NVT+88                                                   09487000
NVTIGCER EQU   NVT+84                                                   09488000
NVTVBLDL EQU   NVT+80                                                   09489000
NVTSVCTB EQU   NVT+76                                                   09490000
NVTRSV42 EQU   NVT+72                                                   09491000
NVTRSV41 EQU   NVT+68                                                   09492000
NVTMASCB EQU   NVT+64                                                   09493000
NVTCMTCB EQU   NVT+60                                                   09494000
NVTMSTCB EQU   NVT+56                                                   09495000
@NM00022 EQU   NVTFLLB                                                  09496000
NVTFLSLB EQU   NVTFLLB                                                  09497000
@NM00021 EQU   NVTNPATR                                                 09498000
NVTNPREU EQU   NVTNPREN                                                 09499000
@NM00020 EQU   NVTNPREN                                                 09500000
NVTNPSFX EQU   NVT+53                                                   09501000
@NM00019 EQU   NVT+52                                                   09502000
NVTNPSUF EQU   NVT                                                      09503000
ASMCPTAK EQU   ASMCPRSQ                                                 09504000
ASMCPCNT EQU   ASMCPAVQ+4                                               09505000
ASMCPEXT EQU   ASMPOOLS+6                                               09506000
ASMCPID  EQU   ASMPOOLS                                                 09507000
ASMRSV12 EQU   ASMVT+1000                                               09508000
ASMSAVE  EQU   ASMVT+928                                                09509000
ASMWKSA7 EQU   ASMVT+848                                                09510000
ASMWKSA6 EQU   ASMVT+768                                                09511000
ASMSWKPC EQU   ASMVT+328                                                09512000
ASMRSV10 EQU   ASMVT+280                                                09513000
ASMPVACE EQU   ASMVT+276                                                09514000
ASMPIOFR EQU   ASMVT+272                                                09515000
ASMPVACQ EQU   ASMVT+268                                                09516000
ASMPMSGS EQU   ASMVT+264                                                09517000
ASMPMSG0 EQU   ASMVT+260                                                09518000
ASMPFRLG EQU   ASMVT+256                                                09519000
ASMPRLG  EQU   ASMVT+252                                                09520000
ASMPACT  EQU   ASMVT+248                                                09521000
ASMPSAV  EQU   ASMVT+244                                                09522000
ASMPCMP  EQU   ASMVT+240                                                09523000
ASMPCMPA EQU   ASMVT+236                                                09524000
ASMPCMPN EQU   ASMVT+232                                                09525000
ASMPCMPD EQU   ASMVT+228                                                09526000
ASMPEX   EQU   ASMVT+224                                                09527000
ASMVRMTR EQU   ASMVT+220                                                09528000
ASMPSRBC EQU   ASMVT+216                                                09529000
ASMPFRSW EQU   ASMVT+200                                                09530000
ASMPFRSL EQU   ASMVT+196                                                09531000
ASMPQIOE EQU   ASMVT+192                                                09532000
ASMRSV8  EQU   ASMVT+188                                                09533000
ASMVSAMW EQU   ASMVT+184                                                09534000
ASMTASCB EQU   ASMVT+180                                                09535000
ASMRLGWQ EQU   ASMVT+176                                                09536000
ASMRLGRQ EQU   ASMVT+172                                                09537000
ASMTMECB EQU   ASMVT+168                                                09538000
ASMTCBPT EQU   ASMVT+164                                                09539000
ASMREQCT EQU   ASMVT+160                                                09540000
ASMGOSWK EQU   ASMGOSQS+4                                               09541000
ASMGOSWT EQU   ASMGOSQS                                                 09542000
ASMLSAIH EQU   ASMLSAI+4                                                09543000
ASMLSAIL EQU   ASMLSAI                                                  09544000
ASMCINV  EQU   ASMVT+140                                                09545000
ASMSTGXA EQU   ASMVT+136                                                09546000
ASMSLOTV EQU   ASMVT+128                                                09547000
ASMERRS  EQU   ASMVT+124                                                09548000
ASMNVSC  EQU   ASMVT+120                                                09549000
ASMVSC   EQU   ASMVT+116                                                09550000
ASMRSV7  EQU   ASMVT+92                                                 09551000
ASMSRBCT EQU   ASMVT+84                                                 09552000
ASMIOCNT EQU   ASMVT+80                                                 09553000
ASMPCCWC EQU   ASMPCCWQ+4                                               09554000
ASMPCCWA EQU   ASMPCCWQ                                                 09555000
ASMRSV6  EQU   ASMVT+48                                                 09556000
ASMIORQC EQU   ASMVT+44                                                 09557000
ASMIORQR EQU   ASMVT+40                                                 09558000
ASMSTAGL EQU   ASMSTAGQ+4                                               09559000
ASMSTAGF EQU   ASMSTAGQ                                                 09560000
ASMRSV5  EQU   ASMVT+28                                                 09561000
ASMEREC  EQU   ASMVT+20                                                 09562000
ASMTRPAG EQU   ASMVT+16                                                 09563000
ASMGOS   EQU   ASMVT+12                                                 09564000
ASMNOTMR EQU   ASMFLAG2                                                 09565000
ASMNOSAV EQU   ASMFLAG2                                                 09566000
ASMCALLQ EQU   ASMFLAG2                                                 09567000
ASMNODPX EQU   ASMFLAG1                                                 09568000
ASMRSV1  EQU   ASMFLAG1                                                 09569000
ASMNOCWQ EQU   ASMFLAG1                                                 09570000
QSRZERO2 EQU   QSRLSID2                                                 09571000
QSRZERO  EQU   QSRLSID                                                  09572000
@NM00014 EQU   QSR+16032                                                09573000
@NM00013 EQU   QSRHDR+21                                                09574000
@NM00012 EQU   QSRFLAGS                                                 09575000
@NM00011 EQU   TPASENT+1                                                09576000
TPASFLAG EQU   TPASENT                                                  09577000
@NM00010 EQU   TPARENT+80                                               09578000
@NM00009 EQU   TPARENT+5                                                09579000
@NM00008 EQU   TPAECLAS                                                 09580000
@NM00007 EQU   TPAESTAT                                                 09581000
TPAEXPND EQU   TPAESTAT                                                 09582000
@NM00006 EQU   TPARTBLE+8192                                            09583000
@NM00005 EQU   TPARTBLE+7408                                            09584000
@NM00004 EQU   TPARHEAD+40                                              09585000
@NM00003 EQU   TPARHEAD+28                                              09586000
@NM00002 EQU   TPARHEAD+9                                               09587000
@NM00001 EQU   TPARFLAG                                                 09588000
@NM00133 EQU   PSA+3668                                                 09589000
PSASTAK  EQU   PSA+3072                                                 09590000
@NM00132 EQU   PSA+1048                                                 09591000
PSAUSEND EQU   PSA+1048                                                 09592000
PSARV062 EQU   PSA+1044                                                 09593000
PSACDAL  EQU   PSA+1040                                                 09594000
PSAWTCOD EQU   PSA+1036                                                 09595000
PSAATCVT EQU   PSA+1032                                                 09596000
PSAPCPSW EQU   PSA+1024                                                 09597000
PSAPIR2  EQU   PSA+1020                                                 09598000
PSARV059 EQU   PSA+1018                                                 09599000
PSASVC13 EQU   PSA+1016                                                 09600000
PSALSFCC EQU   PSA+1012                                                 09601000
PSASFACC EQU   PSA+1008                                                 09602000
PSASTOP  EQU   PSA+992                                                  09603000
PSASTART EQU   PSA+976                                                  09604000
PSARSPSW EQU   PSA+968                                                  09605000
PSASRPSW EQU   PSA+960                                                  09606000
PSARV045 EQU   PSA+892                                                  09607000
PSARV044 EQU   PSA+888                                                  09608000
PSARV043 EQU   PSA+884                                                  09609000
PSARV042 EQU   PSA+880                                                  09610000
PSARV041 EQU   PSA+876                                                  09611000
PSARV040 EQU   PSA+872                                                  09612000
PSARV025 EQU   PSA+868                                                  09613000
PSADSSED EQU   PSA+868                                                  09614000
PSADSSPR EQU   PSA+864                                                  09615000
PSADSSFW EQU   PSA+860                                                  09616000
PSADSS14 EQU   PSA+856                                                  09617000
PSADSSPP EQU   PSA+848                                                  09618000
PSADSSRP EQU   PSA+840                                                  09619000
PSADSS05 EQU   PSADSSF4                                                 09620000
PSADSS10 EQU   PSADSSF4                                                 09621000
PSADSSVE EQU   PSADSSF4                                                 09622000
PSADSSDE EQU   PSADSSF4                                                 09623000
PSADSSC0 EQU   PSADSSF4                                                 09624000
PSADSSIE EQU   PSADSSF4                                                 09625000
PSADSS12 EQU   PSADSSF4                                                 09626000
PSADSSRC EQU   PSADSSF4                                                 09627000
PSARV057 EQU   PSADSSF3                                                 09628000
PSARV056 EQU   PSADSSF3                                                 09629000
PSARV055 EQU   PSADSSF3                                                 09630000
PSADSSMC EQU   PSADSSF3                                                 09631000
PSADSSRW EQU   PSADSSF3                                                 09632000
PSADSSNM EQU   PSADSSF3                                                 09633000
PSADSSES EQU   PSADSSF3                                                 09634000
PSADSSGP EQU   PSADSSF3                                                 09635000
PSADSSF2 EQU   PSADSSFL+1                                               09636000
PSADSSPI EQU   PSADSSF1                                                 09637000
PSADSSOI EQU   PSADSSF1                                                 09638000
PSADSSSP EQU   PSADSSF1                                                 09639000
PSADSSTP EQU   PSADSSF1                                                 09640000
PSADSSDW EQU   PSADSSF1                                                 09641000
PSADSSDD EQU   PSADSSF1                                                 09642000
PSADSSDM EQU   PSADSSF1                                                 09643000
PSADSSMV EQU   PSADSSF1                                                 09644000
PSADSSTS EQU   PSA+816                                                  09645000
PSADSSWK EQU   PSA+812                                                  09646000
PSADSSR3 EQU   PSA+808                                                  09647000
PSADSSR2 EQU   PSA+804                                                  09648000
PSADSSRS EQU   PSA+800                                                  09649000
PSASTOR  EQU   PSA+796                                                  09650000
PSACPUSA EQU   PSA+794                                                  09651000
PSAVSTAP EQU   PSA+792                                                  09652000
PSAWKVAP EQU   PSA+788                                                  09653000
PSAWKRAP EQU   PSA+784                                                  09654000
PSAMCHIC EQU   PSA+783                                                  09655000
PSARV061 EQU   PSA+782                                                  09656000
PSASYMSK EQU   PSA+781                                                  09657000
PSAMCHFL EQU   PSA+780                                                  09658000
PSACR0   EQU   PSA+776                                                  09659000
PSAPSWSV EQU   PSA+768                                                  09660000
PSALITA  EQU   PSA+764                                                  09661000
PSACLHS  EQU   PSAHLHI                                                  09662000
PSALKR15 EQU   PSALKSA+60                                               09663000
PSALKR14 EQU   PSALKSA+56                                               09664000
PSALKR13 EQU   PSALKSA+52                                               09665000
PSALKR12 EQU   PSALKSA+48                                               09666000
PSALKR11 EQU   PSALKSA+44                                               09667000
PSALKR10 EQU   PSALKSA+40                                               09668000
PSALKR9  EQU   PSALKSA+36                                               09669000
PSALKR8  EQU   PSALKSA+32                                               09670000
PSALKR7  EQU   PSALKSA+28                                               09671000
PSALKR6  EQU   PSALKSA+24                                               09672000
PSALKR5  EQU   PSALKSA+20                                               09673000
PSALKR4  EQU   PSALKSA+16                                               09674000
PSALKR3  EQU   PSALKSA+12                                               09675000
PSALKR2  EQU   PSALKSA+8                                                09676000
PSALKR1  EQU   PSALKSA+4                                                09677000
PSALKR0  EQU   PSALKSA                                                  09678000
PSARV023 EQU   PSACLHT+52                                               09679000
PSALOCAL EQU   PSACLHT+48                                               09680000
PSACMSL  EQU   PSACLHT+44                                               09681000
PSAOPTL  EQU   PSACLHT+40                                               09682000
PSATPACL EQU   PSACLHT+36                                               09683000
PSATPDNL EQU   PSACLHT+32                                               09684000
PSATPNCL EQU   PSACLHT+28                                               09685000
PSAIOSLL EQU   PSACLHT+24                                               09686000
PSAIOSUL EQU   PSACLHT+20                                               09687000
PSAIOSCL EQU   PSACLHT+16                                               09688000
PSAIOSSL EQU   PSACLHT+12                                               09689000
PSASALCL EQU   PSACLHT+8                                                09690000
PSAASML  EQU   PSACLHT+4                                                09691000
PSADISPL EQU   PSACLHT                                                  09692000
PSASRSA  EQU   PSA+636                                                  09693000
PSARV050 EQU   PSA+634                                                  09694000
PSADSSGO EQU   PSA+633                                                  09695000
PSARECUR EQU   PSA+632                                                  09696000
PSAHLHIS EQU   PSA+628                                                  09697000
PSAIPCSA EQU   PSA+624                                                  09698000
@NM00131 EQU   PSA+621                                                  09699000
PSAIPCDM EQU   PSA+620                                                  09700000
PSAIPCD  EQU   PSA+616                                                  09701000
@NM00130 EQU   PSA+613                                                  09702000
PSAIPCRM EQU   PSA+612                                                  09703000
PSAIPCR  EQU   PSA+608                                                  09704000
PSAMCHEX EQU   PSA+600                                                  09705000
PSAMPSW  EQU   PSA+592                                                  09706000
PSAEXPS2 EQU   PSA+584                                                  09707000
PSAEXPS1 EQU   PSA+576                                                  09708000
PSAPIREG EQU   PSA+572                                                  09709000
PSARSREG EQU   PSA+568                                                  09710000
PSAGPREG EQU   PSA+556                                                  09711000
PSARV022 EQU   PSASUP4                                                  09712000
PSARV021 EQU   PSASUP4                                                  09713000
PSARV020 EQU   PSASUP4                                                  09714000
PSARV019 EQU   PSASUP4                                                  09715000
PSARV018 EQU   PSASUP4                                                  09716000
PSARV017 EQU   PSASUP4                                                  09717000
PSARV016 EQU   PSASUP4                                                  09718000
PSARV015 EQU   PSASUP4                                                  09719000
PSARV014 EQU   PSASUP3                                                  09720000
PSARV013 EQU   PSASUP3                                                  09721000
PSARV012 EQU   PSASUP3                                                  09722000
PSAESTA  EQU   PSASUP3                                                  09723000
PSASPR   EQU   PSASUP3                                                  09724000
PSAPSREG EQU   PSASUP3                                                  09725000
PSAPI2   EQU   PSASUP3                                                  09726000
PSAIOSUP EQU   PSASUP3                                                  09727000
PSALCR   EQU   PSASUP2                                                  09728000
PSARTM   EQU   PSASUP2                                                  09729000
PSAACR   EQU   PSASUP2                                                  09730000
PSAIPCE2 EQU   PSASUP2                                                  09731000
PSAIPCES EQU   PSASUP2                                                  09732000
PSAIPCEC EQU   PSASUP2                                                  09733000
PSAGTF   EQU   PSASUP2                                                  09734000
PSAIPCRI EQU   PSASUP2                                                  09735000
PSATYPE6 EQU   PSASUP1                                                  09736000
PSATCTL  EQU   PSASUP1                                                  09737000
PSADISP  EQU   PSASUP1                                                  09738000
PSALOCK  EQU   PSASUP1                                                  09739000
PSAPI    EQU   PSASUP1                                                  09740000
PSAEXT   EQU   PSASUP1                                                  09741000
PSASVC   EQU   PSASUP1                                                  09742000
PSAIO    EQU   PSASUP1                                                  09743000
PSAANEW  EQU   PSA+544                                                  09744000
PSATOLD  EQU   PSA+540                                                  09745000
PSATNEW  EQU   PSA+536                                                  09746000
PSALCCAR EQU   PSA+532                                                  09747000
PSALCCAV EQU   PSA+528                                                  09748000
PSAPCCAR EQU   PSA+524                                                  09749000
PSAPCCAV EQU   PSA+520                                                  09750000
PSACPULA EQU   PSA+518                                                  09751000
PSACPUPA EQU   PSA+516                                                  09752000
PSAPSA   EQU   PSA+512                                                  09753000
FLCHDEND EQU   PSA+512                                                  09754000
FLCCRSAV EQU   FLCMCLA+280                                              09755000
FLCGRSAV EQU   FLCMCLA+216                                              09756000
FLCFPSAV EQU   FLCMCLA+184                                              09757000
FLCFLA   EQU   FLCMCLA+88                                               09758000
FLCRGNCD EQU   FLCMCLA+84                                               09759000
FLCFSAA  EQU   FLCFSA+1                                                 09760000
@NM00129 EQU   FLCFSA                                                   09761000
@NM00128 EQU   FLCMCLA+72                                               09762000
FLCMCIC  EQU   FLCMCLA+64                                               09763000
@NM00127 EQU   FLCMCLA+20                                               09764000
FLCIOAA  EQU   FLCIOA+1                                                 09765000
@NM00126 EQU   FLCIOA                                                   09766000
@NM00125 EQU   FLCMCLA+15                                               09767000
@NM00124 EQU   FLCMCLA+14                                               09768000
@NM00123 EQU   FLCMCLA+12                                               09769000
FLCLCL   EQU   FLCMCLA+8                                                09770000
FLCIOELA EQU   FLCIOEL+1                                                09771000
@NM00122 EQU   FLCIOEL                                                  09772000
FLCCHNID EQU   FLCMCLA                                                  09773000
@NM00121 EQU   PSA+160                                                  09774000
FLCMTRCD EQU   PSA+157                                                  09775000
@NM00120 EQU   PSA+156                                                  09776000
FLCPERA  EQU   FLCPER+1                                                 09777000
@NM00119 EQU   FLCPER                                                   09778000
@NM00118 EQU   PSA+151                                                  09779000
FLCPERCD EQU   PSA+150                                                  09780000
FLCMCNUM EQU   PSA+149                                                  09781000
@NM00117 EQU   PSA+148                                                  09782000
FLCTEAA  EQU   FLCTEA+1                                                 09783000
@NM00116 EQU   FLCTEA                                                   09784000
PSAPIPC  EQU   PSAPICOD                                                 09785000
PSAPIMC  EQU   PSAPICOD                                                 09786000
PSAPIPER EQU   PSAPICOD                                                 09787000
PSARV049 EQU   FLCPICOD                                                 09788000
FLCPILCB EQU   FLCPIILC                                                 09789000
@NM00115 EQU   FLCPIILC                                                 09790000
@NM00114 EQU   PSAEPPSW                                                 09791000
FLCSVCN  EQU   PSAESPSW+2                                               09792000
FLCSILCB EQU   FLCSVILC                                                 09793000
@NM00113 EQU   FLCSVILC                                                 09794000
@NM00112 EQU   PSAESPSW                                                 09795000
FLCEICOD EQU   PSAEEPSW+2                                               09796000
PSASPAD  EQU   PSAEEPSW                                                 09797000
@NM00111 EQU   PSA+128                                                  09798000
FLCINPSW EQU   PSA+120                                                  09799000
FLCMNPSW EQU   PSA+112                                                  09800000
FLCPNPSW EQU   PSA+104                                                  09801000
FLCSNPSW EQU   PSA+96                                                   09802000
FLCENPSW EQU   PSA+88                                                   09803000
FLCTRACE EQU   PSA+84                                                   09804000
FLCTIMER EQU   PSA+80                                                   09805000
FLCCVT2  EQU   PSA+76                                                   09806000
FLCCAW   EQU   PSA+72                                                   09807000
FLCCSW   EQU   PSA+64                                                   09808000
FLCIOPSW EQU   PSA+56                                                   09809000
FLCMOPSW EQU   PSA+48                                                   09810000
FLCPOPSW EQU   PSA+40                                                   09811000
FLCSOPSW EQU   PSA+32                                                   09812000
FLCEOPSW EQU   PSA+24                                                   09813000
@NM00110 EQU   FLCICCW2+4                                               09814000
FLCCVT   EQU   FLCICCW2                                                 09815000
FLCICCW1 EQU   FLCROPSW                                                 09816000
FLCIPPSW EQU   FLCRNPSW                                                 09817000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09818000
@RC00211 EQU   @RC00207                                                 09819000
@RC00234 EQU   @RC00230                                                 09820000
@RF00302 EQU   REDOPLPA                                                 09821000
@RF00299 EQU   REDOPLPA                                                 09822000
@RF00314 EQU   REDOPLPA                                                 09823000
@RC00292 EQU   @RC00290                                                 09824000
@RC00379 EQU   @RC00377                                                 09825000
@RC00339 EQU   @RC00325                                                 09826000
@RF00434 EQU   DUPCOMP                                                  09827000
@RC00434 EQU   @RC00432                                                 09828000
@RF00529 EQU   OPENDP                                                   09829000
@RF00540 EQU   OPENDP                                                   09830000
@RC00523 EQU   @RC00521                                                 09831000
@RC00537 EQU   @RC00521                                                 09832000
@RC00557 EQU   @RC00555                                                 09833000
@RC00643 EQU   @RC00642                                                 09834000
@RT00709 EQU   CHKCOMM                                                  09835000
@RF00712 EQU   OPENCM                                                   09836000
@RC00691 EQU   @RC00671                                                 09837000
@RC00746 EQU   @RC00736                                                 09838000
@RT00771 EQU   OPENLOCL                                                 09839000
@RT00857 EQU   OPENLOCL                                                 09840000
@RC00908 EQU   @RC00904                                                 09841000
@RT00975 EQU   REDO                                                     09842000
@RF00995 EQU   REDO                                                     09843000
@RF00987 EQU   REDO                                                     09844000
@RC00966 EQU   @RC00961                                                 09845000
@RC01061 EQU   @RC01042                                                 09846000
@RC01223 EQU   @RC01219                                                 09847000
@RC01263 EQU   @RC01261                                                 09848000
@RT01280 EQU   INITSART                                                 09849000
@RT01385 EQU   REDOSWAP                                                 09850000
@RF01391 EQU   REDOSWAP                                                 09851000
@RC01378 EQU   @RC01376                                                 09852000
@RC01767 EQU   @RC01765                                                 09853000
@RC01888 EQU   @RC01886                                                 09854000
@RF01912 EQU   OPENAAGN                                                 09855000
@RT02030 EQU   REDOL                                                    09856000
@RC00214 EQU   @RC00211                                                 09857000
@RC00237 EQU   @RC00234                                                 09858000
@RC00442 EQU   @RC00434                                                 09859000
@RC00567 EQU   @RC00557                                                 09860000
@RC00968 EQU   @RC00966                                                 09861000
@RC00981 EQU   @RC00966                                                 09862000
@RC00216 EQU   @RC00214                                                 09863000
@RC00240 EQU   @RC00237                                                 09864000
@RC00444 EQU   @RC00442                                                 09865000
@RC00570 EQU   @RC00567                                                 09866000
@RC00219 EQU   @RC00216                                                 09867000
@ENDDATA EQU   *                                                        09868000
         END   ILRASRIM,(C'PLS0913',0701,77272)                         09869000
